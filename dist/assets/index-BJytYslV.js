var qde=Object.defineProperty;var zde=(t,e,r)=>e in t?qde(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Br=(t,e,r)=>zde(t,typeof e!="symbol"?e+"":e,r);function Wde(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Mit=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uW={exports:{}},ZI={},dW={exports:{}},ca={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uw=Symbol.for("react.element"),Xde=Symbol.for("react.portal"),Yde=Symbol.for("react.fragment"),Jde=Symbol.for("react.strict_mode"),Zde=Symbol.for("react.profiler"),efe=Symbol.for("react.provider"),tfe=Symbol.for("react.context"),rfe=Symbol.for("react.forward_ref"),nfe=Symbol.for("react.suspense"),afe=Symbol.for("react.memo"),sfe=Symbol.for("react.lazy"),EL=Symbol.iterator;function ife(t){return t===null||typeof t!="object"?null:(t=EL&&t[EL]||t["@@iterator"],typeof t=="function"?t:null)}var fW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hW=Object.assign,AW={};function Zv(t,e,r){this.props=t,this.context=e,this.refs=AW,this.updater=r||fW}Zv.prototype.isReactComponent={};Zv.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zv.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mW(){}mW.prototype=Zv.prototype;function CO(t,e,r){this.props=t,this.context=e,this.refs=AW,this.updater=r||fW}var _O=CO.prototype=new mW;_O.constructor=CO;hW(_O,Zv.prototype);_O.isPureReactComponent=!0;var SL=Array.isArray,pW=Object.prototype.hasOwnProperty,EO={current:null},gW={key:!0,ref:!0,__self:!0,__source:!0};function xW(t,e,r){var n,a={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)pW.call(e,n)&&!gW.hasOwnProperty(n)&&(a[n]=e[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:uw,type:t,key:s,ref:o,props:a,_owner:EO.current}}function ofe(t,e){return{$$typeof:uw,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function SO(t){return typeof t=="object"&&t!==null&&t.$$typeof===uw}function lfe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var IL=/\/+/g;function K3(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lfe(""+t.key):e.toString(36)}function M_(t,e,r,n,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case uw:case Xde:o=!0}}if(o)return o=t,a=a(o),t=n===""?"."+K3(o,0):n,SL(a)?(r="",t!=null&&(r=t.replace(IL,"$&/")+"/"),M_(a,e,r,"",function(u){return u})):a!=null&&(SO(a)&&(a=ofe(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(IL,"$&/")+"/")+t)),e.push(a)),1;if(o=0,n=n===""?".":n+":",SL(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+K3(s,l);o+=M_(s,e,r,c,a)}else if(c=ife(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+K3(s,l++),o+=M_(s,e,r,c,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ON(t,e,r){if(t==null)return t;var n=[],a=0;return M_(t,n,"","",function(s){return e.call(r,s,a++)}),n}function cfe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kc={current:null},L_={transition:null},ufe={ReactCurrentDispatcher:kc,ReactCurrentBatchConfig:L_,ReactCurrentOwner:EO};function vW(){throw Error("act(...) is not supported in production builds of React.")}ca.Children={map:ON,forEach:function(t,e,r){ON(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ON(t,function(){e++}),e},toArray:function(t){return ON(t,function(e){return e})||[]},only:function(t){if(!SO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ca.Component=Zv;ca.Fragment=Yde;ca.Profiler=Zde;ca.PureComponent=CO;ca.StrictMode=Jde;ca.Suspense=nfe;ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ufe;ca.act=vW;ca.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=hW({},t.props),a=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=EO.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)pW.call(e,c)&&!gW.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:uw,type:t.type,key:a,ref:s,props:n,_owner:o}};ca.createContext=function(t){return t={$$typeof:tfe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:efe,_context:t},t.Consumer=t};ca.createElement=xW;ca.createFactory=function(t){var e=xW.bind(null,t);return e.type=t,e};ca.createRef=function(){return{current:null}};ca.forwardRef=function(t){return{$$typeof:rfe,render:t}};ca.isValidElement=SO;ca.lazy=function(t){return{$$typeof:sfe,_payload:{_status:-1,_result:t},_init:cfe}};ca.memo=function(t,e){return{$$typeof:afe,type:t,compare:e===void 0?null:e}};ca.startTransition=function(t){var e=L_.transition;L_.transition={};try{t()}finally{L_.transition=e}};ca.unstable_act=vW;ca.useCallback=function(t,e){return kc.current.useCallback(t,e)};ca.useContext=function(t){return kc.current.useContext(t)};ca.useDebugValue=function(){};ca.useDeferredValue=function(t){return kc.current.useDeferredValue(t)};ca.useEffect=function(t,e){return kc.current.useEffect(t,e)};ca.useId=function(){return kc.current.useId()};ca.useImperativeHandle=function(t,e,r){return kc.current.useImperativeHandle(t,e,r)};ca.useInsertionEffect=function(t,e){return kc.current.useInsertionEffect(t,e)};ca.useLayoutEffect=function(t,e){return kc.current.useLayoutEffect(t,e)};ca.useMemo=function(t,e){return kc.current.useMemo(t,e)};ca.useReducer=function(t,e,r){return kc.current.useReducer(t,e,r)};ca.useRef=function(t){return kc.current.useRef(t)};ca.useState=function(t){return kc.current.useState(t)};ca.useSyncExternalStore=function(t,e,r){return kc.current.useSyncExternalStore(t,e,r)};ca.useTransition=function(){return kc.current.useTransition()};ca.version="18.3.1";dW.exports=ca;var g=dW.exports;const Ni=jA(g),dfe=Wde({__proto__:null,default:Ni},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ffe=g,hfe=Symbol.for("react.element"),Afe=Symbol.for("react.fragment"),mfe=Object.prototype.hasOwnProperty,pfe=ffe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gfe={key:!0,ref:!0,__self:!0,__source:!0};function yW(t,e,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)mfe.call(e,n)&&!gfe.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:hfe,type:t,key:s,ref:o,props:a,_owner:pfe.current}}ZI.Fragment=Afe;ZI.jsx=yW;ZI.jsxs=yW;uW.exports=ZI;var i=uW.exports,MB={},bW={exports:{}},Ku={},wW={exports:{}},NW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ge,ne){var Oe=ge.length;ge.push(ne);e:for(;0<Oe;){var Ue=Oe-1>>>1,F=ge[Ue];if(0<a(F,ne))ge[Ue]=ne,ge[Oe]=F,Oe=Ue;else break e}}function r(ge){return ge.length===0?null:ge[0]}function n(ge){if(ge.length===0)return null;var ne=ge[0],Oe=ge.pop();if(Oe!==ne){ge[0]=Oe;e:for(var Ue=0,F=ge.length,H=F>>>1;Ue<H;){var K=2*(Ue+1)-1,U=ge[K],W=K+1,X=ge[W];if(0>a(U,Oe))W<F&&0>a(X,U)?(ge[Ue]=X,ge[W]=Oe,Ue=W):(ge[Ue]=U,ge[K]=Oe,Ue=K);else if(W<F&&0>a(X,Oe))ge[Ue]=X,ge[W]=Oe,Ue=W;else break e}}return ne}function a(ge,ne){var Oe=ge.sortIndex-ne.sortIndex;return Oe!==0?Oe:ge.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,A=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(ge){for(var ne=r(u);ne!==null;){if(ne.callback===null)n(u);else if(ne.startTime<=ge)n(u),ne.sortIndex=ne.expirationTime,e(c,ne);else break;ne=r(u)}}function w(ge){if(p=!1,b(ge),!m)if(r(c)!==null)m=!0,ce(j);else{var ne=r(u);ne!==null&&ue(w,ne.startTime-ge)}}function j(ge,ne){m=!1,p&&(p=!1,v(S),S=-1),h=!0;var Oe=A;try{for(b(ne),f=r(c);f!==null&&(!(f.expirationTime>ne)||ge&&!k());){var Ue=f.callback;if(typeof Ue=="function"){f.callback=null,A=f.priorityLevel;var F=Ue(f.expirationTime<=ne);ne=t.unstable_now(),typeof F=="function"?f.callback=F:f===r(c)&&n(c),b(ne)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var K=r(u);K!==null&&ue(w,K.startTime-ne),H=!1}return H}finally{f=null,A=Oe,h=!1}}var I=!1,_=null,S=-1,E=5,B=-1;function k(){return!(t.unstable_now()-B<E)}function P(){if(_!==null){var ge=t.unstable_now();B=ge;var ne=!0;try{ne=_(!0,ge)}finally{ne?O():(I=!1,_=null)}}else I=!1}var O;if(typeof y=="function")O=function(){y(P)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,oe=z.port2;z.port1.onmessage=P,O=function(){oe.postMessage(null)}}else O=function(){x(P,0)};function ce(ge){_=ge,I||(I=!0,O())}function ue(ge,ne){S=x(function(){ge(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ge){ge.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ce(j))},t.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<ge?Math.floor(1e3/ge):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(ge){switch(A){case 1:case 2:case 3:var ne=3;break;default:ne=A}var Oe=A;A=ne;try{return ge()}finally{A=Oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ge,ne){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var Oe=A;A=ge;try{return ne()}finally{A=Oe}},t.unstable_scheduleCallback=function(ge,ne,Oe){var Ue=t.unstable_now();switch(typeof Oe=="object"&&Oe!==null?(Oe=Oe.delay,Oe=typeof Oe=="number"&&0<Oe?Ue+Oe:Ue):Oe=Ue,ge){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=Oe+F,ge={id:d++,callback:ne,priorityLevel:ge,startTime:Oe,expirationTime:F,sortIndex:-1},Oe>Ue?(ge.sortIndex=Oe,e(u,ge),r(c)===null&&ge===r(u)&&(p?(v(S),S=-1):p=!0,ue(w,Oe-Ue))):(ge.sortIndex=F,e(c,ge),m||h||(m=!0,ce(j))),ge},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(ge){var ne=A;return function(){var Oe=A;A=ne;try{return ge.apply(this,arguments)}finally{A=Oe}}}})(NW);wW.exports=NW;var xfe=wW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vfe=g,Uu=xfe;function Dr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CW=new Set,Vb={};function Sg(t,e){bv(t,e),bv(t+"Capture",e)}function bv(t,e){for(Vb[t]=e,t=0;t<e.length;t++)CW.add(e[t])}var dA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),LB=Object.prototype.hasOwnProperty,yfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jL={},PL={};function bfe(t){return LB.call(PL,t)?!0:LB.call(jL,t)?!1:yfe.test(t)?PL[t]=!0:(jL[t]=!0,!1)}function wfe(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Nfe(t,e,r,n){if(e===null||typeof e>"u"||wfe(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fc(t,e,r,n,a,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Tl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tl[t]=new Fc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tl[e]=new Fc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tl[t]=new Fc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tl[t]=new Fc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tl[t]=new Fc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tl[t]=new Fc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tl[t]=new Fc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tl[t]=new Fc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tl[t]=new Fc(t,5,!1,t.toLowerCase(),null,!1,!1)});var IO=/[\-:]([a-z])/g;function jO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(IO,jO);Tl[e]=new Fc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(IO,jO);Tl[e]=new Fc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(IO,jO);Tl[e]=new Fc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tl[t]=new Fc(t,1,!1,t.toLowerCase(),null,!1,!1)});Tl.xlinkHref=new Fc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tl[t]=new Fc(t,1,!1,t.toLowerCase(),null,!0,!0)});function PO(t,e,r,n){var a=Tl.hasOwnProperty(e)?Tl[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Nfe(e,r,a,n)&&(r=null),n||a===null?bfe(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var PA=vfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,DN=Symbol.for("react.element"),Ox=Symbol.for("react.portal"),Dx=Symbol.for("react.fragment"),BO=Symbol.for("react.strict_mode"),UB=Symbol.for("react.profiler"),_W=Symbol.for("react.provider"),EW=Symbol.for("react.context"),TO=Symbol.for("react.forward_ref"),QB=Symbol.for("react.suspense"),VB=Symbol.for("react.suspense_list"),kO=Symbol.for("react.memo"),_0=Symbol.for("react.lazy"),SW=Symbol.for("react.offscreen"),BL=Symbol.iterator;function q1(t){return t===null||typeof t!="object"?null:(t=BL&&t[BL]||t["@@iterator"],typeof t=="function"?t:null)}var di=Object.assign,G3;function By(t){if(G3===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);G3=e&&e[1]||""}return`
`+G3+t}var q3=!1;function z3(t,e){if(!t||q3)return"";q3=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{q3=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?By(t):""}function Cfe(t){switch(t.tag){case 5:return By(t.type);case 16:return By("Lazy");case 13:return By("Suspense");case 19:return By("SuspenseList");case 0:case 2:case 15:return t=z3(t.type,!1),t;case 11:return t=z3(t.type.render,!1),t;case 1:return t=z3(t.type,!0),t;default:return""}}function HB(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Dx:return"Fragment";case Ox:return"Portal";case UB:return"Profiler";case BO:return"StrictMode";case QB:return"Suspense";case VB:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case EW:return(t.displayName||"Context")+".Consumer";case _W:return(t._context.displayName||"Context")+".Provider";case TO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case kO:return e=t.displayName||null,e!==null?e:HB(t.type)||"Memo";case _0:e=t._payload,t=t._init;try{return HB(t(e))}catch{}}return null}function _fe(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return HB(e);case 8:return e===BO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pm(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function IW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Efe(t){var e=IW(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function RN(t){t._valueTracker||(t._valueTracker=Efe(t))}function jW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=IW(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function IE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function $B(t,e){var r=e.checked;return di({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function TL(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=pm(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function PW(t,e){e=e.checked,e!=null&&PO(t,"checked",e,!1)}function KB(t,e){PW(t,e);var r=pm(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?GB(t,e.type,r):e.hasOwnProperty("defaultValue")&&GB(t,e.type,pm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function kL(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function GB(t,e,r){(e!=="number"||IE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ty=Array.isArray;function nv(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+pm(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function qB(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Dr(91));return di({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function FL(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Dr(92));if(Ty(r)){if(1<r.length)throw Error(Dr(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:pm(r)}}function BW(t,e){var r=pm(e.value),n=pm(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function OL(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function TW(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zB(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?TW(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var MN,kW=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(MN=MN||document.createElement("div"),MN.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=MN.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hb(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var nb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sfe=["Webkit","ms","Moz","O"];Object.keys(nb).forEach(function(t){Sfe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nb[e]=nb[t]})});function FW(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||nb.hasOwnProperty(t)&&nb[t]?(""+e).trim():e+"px"}function OW(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=FW(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var Ife=di({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function WB(t,e){if(e){if(Ife[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Dr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Dr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Dr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Dr(62))}}function XB(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var YB=null;function FO(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var JB=null,av=null,sv=null;function DL(t){if(t=hw(t)){if(typeof JB!="function")throw Error(Dr(280));var e=t.stateNode;e&&(e=aj(e),JB(t.stateNode,t.type,e))}}function DW(t){av?sv?sv.push(t):sv=[t]:av=t}function RW(){if(av){var t=av,e=sv;if(sv=av=null,DL(t),e)for(t=0;t<e.length;t++)DL(e[t])}}function MW(t,e){return t(e)}function LW(){}var W3=!1;function UW(t,e,r){if(W3)return t(e,r);W3=!0;try{return MW(t,e,r)}finally{W3=!1,(av!==null||sv!==null)&&(LW(),RW())}}function $b(t,e){var r=t.stateNode;if(r===null)return null;var n=aj(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Dr(231,e,typeof r));return r}var ZB=!1;if(dA)try{var z1={};Object.defineProperty(z1,"passive",{get:function(){ZB=!0}}),window.addEventListener("test",z1,z1),window.removeEventListener("test",z1,z1)}catch{ZB=!1}function jfe(t,e,r,n,a,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var ab=!1,jE=null,PE=!1,eT=null,Pfe={onError:function(t){ab=!0,jE=t}};function Bfe(t,e,r,n,a,s,o,l,c){ab=!1,jE=null,jfe.apply(Pfe,arguments)}function Tfe(t,e,r,n,a,s,o,l,c){if(Bfe.apply(this,arguments),ab){if(ab){var u=jE;ab=!1,jE=null}else throw Error(Dr(198));PE||(PE=!0,eT=u)}}function Ig(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function QW(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function RL(t){if(Ig(t)!==t)throw Error(Dr(188))}function kfe(t){var e=t.alternate;if(!e){if(e=Ig(t),e===null)throw Error(Dr(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return RL(a),t;if(s===n)return RL(a),e;s=s.sibling}throw Error(Dr(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(Dr(189))}}if(r.alternate!==n)throw Error(Dr(190))}if(r.tag!==3)throw Error(Dr(188));return r.stateNode.current===r?t:e}function VW(t){return t=kfe(t),t!==null?HW(t):null}function HW(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=HW(t);if(e!==null)return e;t=t.sibling}return null}var $W=Uu.unstable_scheduleCallback,ML=Uu.unstable_cancelCallback,Ffe=Uu.unstable_shouldYield,Ofe=Uu.unstable_requestPaint,Vi=Uu.unstable_now,Dfe=Uu.unstable_getCurrentPriorityLevel,OO=Uu.unstable_ImmediatePriority,KW=Uu.unstable_UserBlockingPriority,BE=Uu.unstable_NormalPriority,Rfe=Uu.unstable_LowPriority,GW=Uu.unstable_IdlePriority,ej=null,rh=null;function Mfe(t){if(rh&&typeof rh.onCommitFiberRoot=="function")try{rh.onCommitFiberRoot(ej,t,void 0,(t.current.flags&128)===128)}catch{}}var Af=Math.clz32?Math.clz32:Qfe,Lfe=Math.log,Ufe=Math.LN2;function Qfe(t){return t>>>=0,t===0?32:31-(Lfe(t)/Ufe|0)|0}var LN=64,UN=4194304;function ky(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function TE(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=ky(l):(s&=o,s!==0&&(n=ky(s)))}else o=r&~a,o!==0?n=ky(o):s!==0&&(n=ky(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Af(e),a=1<<r,n|=t[r],e&=~a;return n}function Vfe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hfe(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Af(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=Vfe(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function tT(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function qW(){var t=LN;return LN<<=1,!(LN&4194240)&&(LN=64),t}function X3(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function dw(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Af(e),t[e]=r}function $fe(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-Af(r),s=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~s}}function DO(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Af(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var ns=0;function zW(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WW,RO,XW,YW,JW,rT=!1,QN=[],J0=null,Z0=null,em=null,Kb=new Map,Gb=new Map,B0=[],Kfe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LL(t,e){switch(t){case"focusin":case"focusout":J0=null;break;case"dragenter":case"dragleave":Z0=null;break;case"mouseover":case"mouseout":em=null;break;case"pointerover":case"pointerout":Kb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gb.delete(e.pointerId)}}function W1(t,e,r,n,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},e!==null&&(e=hw(e),e!==null&&RO(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Gfe(t,e,r,n,a){switch(e){case"focusin":return J0=W1(J0,t,e,r,n,a),!0;case"dragenter":return Z0=W1(Z0,t,e,r,n,a),!0;case"mouseover":return em=W1(em,t,e,r,n,a),!0;case"pointerover":var s=a.pointerId;return Kb.set(s,W1(Kb.get(s)||null,t,e,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Gb.set(s,W1(Gb.get(s)||null,t,e,r,n,a)),!0}return!1}function ZW(t){var e=yp(t.target);if(e!==null){var r=Ig(e);if(r!==null){if(e=r.tag,e===13){if(e=QW(r),e!==null){t.blockedOn=e,JW(t.priority,function(){XW(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function U_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=nT(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);YB=n,r.target.dispatchEvent(n),YB=null}else return e=hw(r),e!==null&&RO(e),t.blockedOn=r,!1;e.shift()}return!0}function UL(t,e,r){U_(t)&&r.delete(e)}function qfe(){rT=!1,J0!==null&&U_(J0)&&(J0=null),Z0!==null&&U_(Z0)&&(Z0=null),em!==null&&U_(em)&&(em=null),Kb.forEach(UL),Gb.forEach(UL)}function X1(t,e){t.blockedOn===e&&(t.blockedOn=null,rT||(rT=!0,Uu.unstable_scheduleCallback(Uu.unstable_NormalPriority,qfe)))}function qb(t){function e(a){return X1(a,t)}if(0<QN.length){X1(QN[0],t);for(var r=1;r<QN.length;r++){var n=QN[r];n.blockedOn===t&&(n.blockedOn=null)}}for(J0!==null&&X1(J0,t),Z0!==null&&X1(Z0,t),em!==null&&X1(em,t),Kb.forEach(e),Gb.forEach(e),r=0;r<B0.length;r++)n=B0[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<B0.length&&(r=B0[0],r.blockedOn===null);)ZW(r),r.blockedOn===null&&B0.shift()}var iv=PA.ReactCurrentBatchConfig,kE=!0;function zfe(t,e,r,n){var a=ns,s=iv.transition;iv.transition=null;try{ns=1,MO(t,e,r,n)}finally{ns=a,iv.transition=s}}function Wfe(t,e,r,n){var a=ns,s=iv.transition;iv.transition=null;try{ns=4,MO(t,e,r,n)}finally{ns=a,iv.transition=s}}function MO(t,e,r,n){if(kE){var a=nT(t,e,r,n);if(a===null)i4(t,e,n,FE,r),LL(t,n);else if(Gfe(a,t,e,r,n))n.stopPropagation();else if(LL(t,n),e&4&&-1<Kfe.indexOf(t)){for(;a!==null;){var s=hw(a);if(s!==null&&WW(s),s=nT(t,e,r,n),s===null&&i4(t,e,n,FE,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else i4(t,e,n,null,r)}}var FE=null;function nT(t,e,r,n){if(FE=null,t=FO(n),t=yp(t),t!==null)if(e=Ig(t),e===null)t=null;else if(r=e.tag,r===13){if(t=QW(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return FE=t,null}function eX(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Dfe()){case OO:return 1;case KW:return 4;case BE:case Rfe:return 16;case GW:return 536870912;default:return 16}default:return 16}}var V0=null,LO=null,Q_=null;function tX(){if(Q_)return Q_;var t,e=LO,r=e.length,n,a="value"in V0?V0.value:V0.textContent,s=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===a[s-n];n++);return Q_=a.slice(t,1<n?1-n:void 0)}function V_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function VN(){return!0}function QL(){return!1}function Gu(t){function e(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?VN:QL,this.isPropagationStopped=QL,this}return di(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=VN)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=VN)},persist:function(){},isPersistent:VN}),e}var e1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},UO=Gu(e1),fw=di({},e1,{view:0,detail:0}),Xfe=Gu(fw),Y3,J3,Y1,tj=di({},fw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:QO,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Y1&&(Y1&&t.type==="mousemove"?(Y3=t.screenX-Y1.screenX,J3=t.screenY-Y1.screenY):J3=Y3=0,Y1=t),Y3)},movementY:function(t){return"movementY"in t?t.movementY:J3}}),VL=Gu(tj),Yfe=di({},tj,{dataTransfer:0}),Jfe=Gu(Yfe),Zfe=di({},fw,{relatedTarget:0}),Z3=Gu(Zfe),ehe=di({},e1,{animationName:0,elapsedTime:0,pseudoElement:0}),the=Gu(ehe),rhe=di({},e1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nhe=Gu(rhe),ahe=di({},e1,{data:0}),HL=Gu(ahe),she={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ihe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ohe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lhe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ohe[t])?!!e[t]:!1}function QO(){return lhe}var che=di({},fw,{key:function(t){if(t.key){var e=she[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=V_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ihe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:QO,charCode:function(t){return t.type==="keypress"?V_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?V_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uhe=Gu(che),dhe=di({},tj,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$L=Gu(dhe),fhe=di({},fw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:QO}),hhe=Gu(fhe),Ahe=di({},e1,{propertyName:0,elapsedTime:0,pseudoElement:0}),mhe=Gu(Ahe),phe=di({},tj,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ghe=Gu(phe),xhe=[9,13,27,32],VO=dA&&"CompositionEvent"in window,sb=null;dA&&"documentMode"in document&&(sb=document.documentMode);var vhe=dA&&"TextEvent"in window&&!sb,rX=dA&&(!VO||sb&&8<sb&&11>=sb),KL=" ",GL=!1;function nX(t,e){switch(t){case"keyup":return xhe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aX(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Rx=!1;function yhe(t,e){switch(t){case"compositionend":return aX(e);case"keypress":return e.which!==32?null:(GL=!0,KL);case"textInput":return t=e.data,t===KL&&GL?null:t;default:return null}}function bhe(t,e){if(Rx)return t==="compositionend"||!VO&&nX(t,e)?(t=tX(),Q_=LO=V0=null,Rx=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rX&&e.locale!=="ko"?null:e.data;default:return null}}var whe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qL(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!whe[t.type]:e==="textarea"}function sX(t,e,r,n){DW(n),e=OE(e,"onChange"),0<e.length&&(r=new UO("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ib=null,zb=null;function Nhe(t){pX(t,0)}function rj(t){var e=Ux(t);if(jW(e))return t}function Che(t,e){if(t==="change")return e}var iX=!1;if(dA){var e4;if(dA){var t4="oninput"in document;if(!t4){var zL=document.createElement("div");zL.setAttribute("oninput","return;"),t4=typeof zL.oninput=="function"}e4=t4}else e4=!1;iX=e4&&(!document.documentMode||9<document.documentMode)}function WL(){ib&&(ib.detachEvent("onpropertychange",oX),zb=ib=null)}function oX(t){if(t.propertyName==="value"&&rj(zb)){var e=[];sX(e,zb,t,FO(t)),UW(Nhe,e)}}function _he(t,e,r){t==="focusin"?(WL(),ib=e,zb=r,ib.attachEvent("onpropertychange",oX)):t==="focusout"&&WL()}function Ehe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return rj(zb)}function She(t,e){if(t==="click")return rj(e)}function Ihe(t,e){if(t==="input"||t==="change")return rj(e)}function jhe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yf=typeof Object.is=="function"?Object.is:jhe;function Wb(t,e){if(yf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!LB.call(e,a)||!yf(t[a],e[a]))return!1}return!0}function XL(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function YL(t,e){var r=XL(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=XL(r)}}function lX(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?lX(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function cX(){for(var t=window,e=IE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=IE(t.document)}return e}function HO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Phe(t){var e=cX(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&lX(r.ownerDocument.documentElement,r)){if(n!==null&&HO(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!t.extend&&s>n&&(a=n,n=s,s=a),a=YL(r,s);var o=YL(r,n);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Bhe=dA&&"documentMode"in document&&11>=document.documentMode,Mx=null,aT=null,ob=null,sT=!1;function JL(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;sT||Mx==null||Mx!==IE(n)||(n=Mx,"selectionStart"in n&&HO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ob&&Wb(ob,n)||(ob=n,n=OE(aT,"onSelect"),0<n.length&&(e=new UO("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Mx)))}function HN(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Lx={animationend:HN("Animation","AnimationEnd"),animationiteration:HN("Animation","AnimationIteration"),animationstart:HN("Animation","AnimationStart"),transitionend:HN("Transition","TransitionEnd")},r4={},uX={};dA&&(uX=document.createElement("div").style,"AnimationEvent"in window||(delete Lx.animationend.animation,delete Lx.animationiteration.animation,delete Lx.animationstart.animation),"TransitionEvent"in window||delete Lx.transitionend.transition);function nj(t){if(r4[t])return r4[t];if(!Lx[t])return t;var e=Lx[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in uX)return r4[t]=e[r];return t}var dX=nj("animationend"),fX=nj("animationiteration"),hX=nj("animationstart"),AX=nj("transitionend"),mX=new Map,ZL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fm(t,e){mX.set(t,e),Sg(e,[t])}for(var n4=0;n4<ZL.length;n4++){var a4=ZL[n4],The=a4.toLowerCase(),khe=a4[0].toUpperCase()+a4.slice(1);Fm(The,"on"+khe)}Fm(dX,"onAnimationEnd");Fm(fX,"onAnimationIteration");Fm(hX,"onAnimationStart");Fm("dblclick","onDoubleClick");Fm("focusin","onFocus");Fm("focusout","onBlur");Fm(AX,"onTransitionEnd");bv("onMouseEnter",["mouseout","mouseover"]);bv("onMouseLeave",["mouseout","mouseover"]);bv("onPointerEnter",["pointerout","pointerover"]);bv("onPointerLeave",["pointerout","pointerover"]);Sg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fhe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fy));function eU(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Tfe(n,e,void 0,t),t.currentTarget=null}function pX(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;eU(a,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;eU(a,l,u),s=c}}}if(PE)throw t=eT,PE=!1,eT=null,t}function Es(t,e){var r=e[uT];r===void 0&&(r=e[uT]=new Set);var n=t+"__bubble";r.has(n)||(gX(e,t,2,!1),r.add(n))}function s4(t,e,r){var n=0;e&&(n|=4),gX(r,t,n,e)}var $N="_reactListening"+Math.random().toString(36).slice(2);function Xb(t){if(!t[$N]){t[$N]=!0,CW.forEach(function(r){r!=="selectionchange"&&(Fhe.has(r)||s4(r,!1,t),s4(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$N]||(e[$N]=!0,s4("selectionchange",!1,e))}}function gX(t,e,r,n){switch(eX(e)){case 1:var a=zfe;break;case 4:a=Wfe;break;default:a=MO}r=a.bind(null,e,r,t),a=void 0,!ZB||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function i4(t,e,r,n,a){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=yp(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}UW(function(){var u=s,d=FO(r),f=[];e:{var A=mX.get(t);if(A!==void 0){var h=UO,m=t;switch(t){case"keypress":if(V_(r)===0)break e;case"keydown":case"keyup":h=uhe;break;case"focusin":m="focus",h=Z3;break;case"focusout":m="blur",h=Z3;break;case"beforeblur":case"afterblur":h=Z3;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=VL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Jfe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=hhe;break;case dX:case fX:case hX:h=the;break;case AX:h=mhe;break;case"scroll":h=Xfe;break;case"wheel":h=ghe;break;case"copy":case"cut":case"paste":h=nhe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=$L}var p=(e&4)!==0,x=!p&&t==="scroll",v=p?A!==null?A+"Capture":null:A;p=[];for(var y=u,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=$b(y,v),w!=null&&p.push(Yb(y,w,b)))),x)break;y=y.return}0<p.length&&(A=new h(A,m,null,r,d),f.push({event:A,listeners:p}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",A&&r!==YB&&(m=r.relatedTarget||r.fromElement)&&(yp(m)||m[fA]))break e;if((h||A)&&(A=d.window===d?d:(A=d.ownerDocument)?A.defaultView||A.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?yp(m):null,m!==null&&(x=Ig(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(p=VL,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=$L,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=h==null?A:Ux(h),b=m==null?A:Ux(m),A=new p(w,y+"leave",h,r,d),A.target=x,A.relatedTarget=b,w=null,yp(d)===u&&(p=new p(v,y+"enter",m,r,d),p.target=b,p.relatedTarget=x,w=p),x=w,h&&m)t:{for(p=h,v=m,y=0,b=p;b;b=Yg(b))y++;for(b=0,w=v;w;w=Yg(w))b++;for(;0<y-b;)p=Yg(p),y--;for(;0<b-y;)v=Yg(v),b--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=Yg(p),v=Yg(v)}p=null}else p=null;h!==null&&tU(f,A,h,p,!1),m!==null&&x!==null&&tU(f,x,m,p,!0)}}e:{if(A=u?Ux(u):window,h=A.nodeName&&A.nodeName.toLowerCase(),h==="select"||h==="input"&&A.type==="file")var j=Che;else if(qL(A))if(iX)j=Ihe;else{j=Ehe;var I=_he}else(h=A.nodeName)&&h.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(j=She);if(j&&(j=j(t,u))){sX(f,j,r,d);break e}I&&I(t,A,u),t==="focusout"&&(I=A._wrapperState)&&I.controlled&&A.type==="number"&&GB(A,"number",A.value)}switch(I=u?Ux(u):window,t){case"focusin":(qL(I)||I.contentEditable==="true")&&(Mx=I,aT=u,ob=null);break;case"focusout":ob=aT=Mx=null;break;case"mousedown":sT=!0;break;case"contextmenu":case"mouseup":case"dragend":sT=!1,JL(f,r,d);break;case"selectionchange":if(Bhe)break;case"keydown":case"keyup":JL(f,r,d)}var _;if(VO)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Rx?nX(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(rX&&r.locale!=="ko"&&(Rx||S!=="onCompositionStart"?S==="onCompositionEnd"&&Rx&&(_=tX()):(V0=d,LO="value"in V0?V0.value:V0.textContent,Rx=!0)),I=OE(u,S),0<I.length&&(S=new HL(S,t,null,r,d),f.push({event:S,listeners:I}),_?S.data=_:(_=aX(r),_!==null&&(S.data=_)))),(_=vhe?yhe(t,r):bhe(t,r))&&(u=OE(u,"onBeforeInput"),0<u.length&&(d=new HL("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=_))}pX(f,e)})}function Yb(t,e,r){return{instance:t,listener:e,currentTarget:r}}function OE(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=$b(t,r),s!=null&&n.unshift(Yb(t,s,a)),s=$b(t,e),s!=null&&n.push(Yb(t,s,a))),t=t.return}return n}function Yg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function tU(t,e,r,n,a){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=$b(r,s),c!=null&&o.unshift(Yb(r,c,l))):a||(c=$b(r,s),c!=null&&o.push(Yb(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Ohe=/\r\n?/g,Dhe=/\u0000|\uFFFD/g;function rU(t){return(typeof t=="string"?t:""+t).replace(Ohe,`
`).replace(Dhe,"")}function KN(t,e,r){if(e=rU(e),rU(t)!==e&&r)throw Error(Dr(425))}function DE(){}var iT=null,oT=null;function lT(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cT=typeof setTimeout=="function"?setTimeout:void 0,Rhe=typeof clearTimeout=="function"?clearTimeout:void 0,nU=typeof Promise=="function"?Promise:void 0,Mhe=typeof queueMicrotask=="function"?queueMicrotask:typeof nU<"u"?function(t){return nU.resolve(null).then(t).catch(Lhe)}:cT;function Lhe(t){setTimeout(function(){throw t})}function o4(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),qb(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);qb(e)}function tm(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function aU(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var t1=Math.random().toString(36).slice(2),Gf="__reactFiber$"+t1,Jb="__reactProps$"+t1,fA="__reactContainer$"+t1,uT="__reactEvents$"+t1,Uhe="__reactListeners$"+t1,Qhe="__reactHandles$"+t1;function yp(t){var e=t[Gf];if(e)return e;for(var r=t.parentNode;r;){if(e=r[fA]||r[Gf]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=aU(t);t!==null;){if(r=t[Gf])return r;t=aU(t)}return e}t=r,r=t.parentNode}return null}function hw(t){return t=t[Gf]||t[fA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ux(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Dr(33))}function aj(t){return t[Jb]||null}var dT=[],Qx=-1;function Om(t){return{current:t}}function Ts(t){0>Qx||(t.current=dT[Qx],dT[Qx]=null,Qx--)}function bs(t,e){Qx++,dT[Qx]=t.current,t.current=e}var gm={},oc=Om(gm),nu=Om(!1),Wp=gm;function wv(t,e){var r=t.type.contextTypes;if(!r)return gm;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function au(t){return t=t.childContextTypes,t!=null}function RE(){Ts(nu),Ts(oc)}function sU(t,e,r){if(oc.current!==gm)throw Error(Dr(168));bs(oc,e),bs(nu,r)}function xX(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(Dr(108,_fe(t)||"Unknown",a));return di({},r,n)}function ME(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gm,Wp=oc.current,bs(oc,t),bs(nu,nu.current),!0}function iU(t,e,r){var n=t.stateNode;if(!n)throw Error(Dr(169));r?(t=xX(t,e,Wp),n.__reactInternalMemoizedMergedChildContext=t,Ts(nu),Ts(oc),bs(oc,t)):Ts(nu),bs(nu,r)}var Lh=null,sj=!1,l4=!1;function vX(t){Lh===null?Lh=[t]:Lh.push(t)}function Vhe(t){sj=!0,vX(t)}function Dm(){if(!l4&&Lh!==null){l4=!0;var t=0,e=ns;try{var r=Lh;for(ns=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Lh=null,sj=!1}catch(a){throw Lh!==null&&(Lh=Lh.slice(t+1)),$W(OO,Dm),a}finally{ns=e,l4=!1}}return null}var Vx=[],Hx=0,LE=null,UE=0,xd=[],vd=0,Xp=null,$h=1,Kh="";function ap(t,e){Vx[Hx++]=UE,Vx[Hx++]=LE,LE=t,UE=e}function yX(t,e,r){xd[vd++]=$h,xd[vd++]=Kh,xd[vd++]=Xp,Xp=t;var n=$h;t=Kh;var a=32-Af(n)-1;n&=~(1<<a),r+=1;var s=32-Af(e)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,$h=1<<32-Af(e)+a|r<<a|n,Kh=s+t}else $h=1<<s|r<<a|n,Kh=t}function $O(t){t.return!==null&&(ap(t,1),yX(t,1,0))}function KO(t){for(;t===LE;)LE=Vx[--Hx],Vx[Hx]=null,UE=Vx[--Hx],Vx[Hx]=null;for(;t===Xp;)Xp=xd[--vd],xd[vd]=null,Kh=xd[--vd],xd[vd]=null,$h=xd[--vd],xd[vd]=null}var Ru=null,ku=null,Qs=!1,sf=null;function bX(t,e){var r=bd(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function oU(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ru=t,ku=tm(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ru=t,ku=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Xp!==null?{id:$h,overflow:Kh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=bd(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ru=t,ku=null,!0):!1;default:return!1}}function fT(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hT(t){if(Qs){var e=ku;if(e){var r=e;if(!oU(t,e)){if(fT(t))throw Error(Dr(418));e=tm(r.nextSibling);var n=Ru;e&&oU(t,e)?bX(n,r):(t.flags=t.flags&-4097|2,Qs=!1,Ru=t)}}else{if(fT(t))throw Error(Dr(418));t.flags=t.flags&-4097|2,Qs=!1,Ru=t}}}function lU(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ru=t}function GN(t){if(t!==Ru)return!1;if(!Qs)return lU(t),Qs=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!lT(t.type,t.memoizedProps)),e&&(e=ku)){if(fT(t))throw wX(),Error(Dr(418));for(;e;)bX(t,e),e=tm(e.nextSibling)}if(lU(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Dr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ku=tm(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ku=null}}else ku=Ru?tm(t.stateNode.nextSibling):null;return!0}function wX(){for(var t=ku;t;)t=tm(t.nextSibling)}function Nv(){ku=Ru=null,Qs=!1}function GO(t){sf===null?sf=[t]:sf.push(t)}var Hhe=PA.ReactCurrentBatchConfig;function J1(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Dr(309));var n=r.stateNode}if(!n)throw Error(Dr(147,t));var a=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Dr(284));if(!r._owner)throw Error(Dr(290,t))}return t}function qN(t,e){throw t=Object.prototype.toString.call(e),Error(Dr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cU(t){var e=t._init;return e(t._payload)}function NX(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=sm(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=m4(b,v.mode,w),y.return=v,y):(y=a(y,b),y.return=v,y)}function c(v,y,b,w){var j=b.type;return j===Dx?d(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===_0&&cU(j)===y.type)?(w=a(y,b.props),w.ref=J1(v,y,b),w.return=v,w):(w=W_(b.type,b.key,b.props,null,v.mode,w),w.ref=J1(v,y,b),w.return=v,w)}function u(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=p4(b,v.mode,w),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function d(v,y,b,w,j){return y===null||y.tag!==7?(y=Tp(b,v.mode,w,j),y.return=v,y):(y=a(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=m4(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case DN:return b=W_(y.type,y.key,y.props,null,v.mode,b),b.ref=J1(v,null,y),b.return=v,b;case Ox:return y=p4(y,v.mode,b),y.return=v,y;case _0:var w=y._init;return f(v,w(y._payload),b)}if(Ty(y)||q1(y))return y=Tp(y,v.mode,b,null),y.return=v,y;qN(v,y)}return null}function A(v,y,b,w){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case DN:return b.key===j?c(v,y,b,w):null;case Ox:return b.key===j?u(v,y,b,w):null;case _0:return j=b._init,A(v,y,j(b._payload),w)}if(Ty(b)||q1(b))return j!==null?null:d(v,y,b,w,null);qN(v,b)}return null}function h(v,y,b,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case DN:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,j);case Ox:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,j);case _0:var I=w._init;return h(v,y,b,I(w._payload),j)}if(Ty(w)||q1(w))return v=v.get(b)||null,d(y,v,w,j,null);qN(y,w)}return null}function m(v,y,b,w){for(var j=null,I=null,_=y,S=y=0,E=null;_!==null&&S<b.length;S++){_.index>S?(E=_,_=null):E=_.sibling;var B=A(v,_,b[S],w);if(B===null){_===null&&(_=E);break}t&&_&&B.alternate===null&&e(v,_),y=s(B,y,S),I===null?j=B:I.sibling=B,I=B,_=E}if(S===b.length)return r(v,_),Qs&&ap(v,S),j;if(_===null){for(;S<b.length;S++)_=f(v,b[S],w),_!==null&&(y=s(_,y,S),I===null?j=_:I.sibling=_,I=_);return Qs&&ap(v,S),j}for(_=n(v,_);S<b.length;S++)E=h(_,v,S,b[S],w),E!==null&&(t&&E.alternate!==null&&_.delete(E.key===null?S:E.key),y=s(E,y,S),I===null?j=E:I.sibling=E,I=E);return t&&_.forEach(function(k){return e(v,k)}),Qs&&ap(v,S),j}function p(v,y,b,w){var j=q1(b);if(typeof j!="function")throw Error(Dr(150));if(b=j.call(b),b==null)throw Error(Dr(151));for(var I=j=null,_=y,S=y=0,E=null,B=b.next();_!==null&&!B.done;S++,B=b.next()){_.index>S?(E=_,_=null):E=_.sibling;var k=A(v,_,B.value,w);if(k===null){_===null&&(_=E);break}t&&_&&k.alternate===null&&e(v,_),y=s(k,y,S),I===null?j=k:I.sibling=k,I=k,_=E}if(B.done)return r(v,_),Qs&&ap(v,S),j;if(_===null){for(;!B.done;S++,B=b.next())B=f(v,B.value,w),B!==null&&(y=s(B,y,S),I===null?j=B:I.sibling=B,I=B);return Qs&&ap(v,S),j}for(_=n(v,_);!B.done;S++,B=b.next())B=h(_,v,S,B.value,w),B!==null&&(t&&B.alternate!==null&&_.delete(B.key===null?S:B.key),y=s(B,y,S),I===null?j=B:I.sibling=B,I=B);return t&&_.forEach(function(P){return e(v,P)}),Qs&&ap(v,S),j}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Dx&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case DN:e:{for(var j=b.key,I=y;I!==null;){if(I.key===j){if(j=b.type,j===Dx){if(I.tag===7){r(v,I.sibling),y=a(I,b.props.children),y.return=v,v=y;break e}}else if(I.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===_0&&cU(j)===I.type){r(v,I.sibling),y=a(I,b.props),y.ref=J1(v,I,b),y.return=v,v=y;break e}r(v,I);break}else e(v,I);I=I.sibling}b.type===Dx?(y=Tp(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=W_(b.type,b.key,b.props,null,v.mode,w),w.ref=J1(v,y,b),w.return=v,v=w)}return o(v);case Ox:e:{for(I=b.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=p4(b,v.mode,w),y.return=v,v=y}return o(v);case _0:return I=b._init,x(v,y,I(b._payload),w)}if(Ty(b))return m(v,y,b,w);if(q1(b))return p(v,y,b,w);qN(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=m4(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return x}var Cv=NX(!0),CX=NX(!1),QE=Om(null),VE=null,$x=null,qO=null;function zO(){qO=$x=VE=null}function WO(t){var e=QE.current;Ts(QE),t._currentValue=e}function AT(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ov(t,e){VE=t,qO=$x=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zc=!0),t.firstContext=null)}function Td(t){var e=t._currentValue;if(qO!==t)if(t={context:t,memoizedValue:e,next:null},$x===null){if(VE===null)throw Error(Dr(308));$x=t,VE.dependencies={lanes:0,firstContext:t}}else $x=$x.next=t;return e}var bp=null;function XO(t){bp===null?bp=[t]:bp.push(t)}function _X(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,XO(e)):(r.next=a.next,a.next=r),e.interleaved=r,hA(t,n)}function hA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var E0=!1;function YO(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EX(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function eA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function rm(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ca&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,hA(t,r)}return a=n.interleaved,a===null?(e.next=e,XO(n)):(e.next=a.next,a.next=e),n.interleaved=e,hA(t,r)}function H_(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,DO(t,r)}}function uU(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=e:s=s.next=e}else a=s=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function HE(t,e,r,n){var a=t.updateQueue;E0=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;o=0,d=u=c=null,l=s;do{var A=l.lane,h=l.eventTime;if((n&A)===A){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(A=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(h,f,A);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,A=typeof m=="function"?m.call(h,f,A):m,A==null)break e;f=di({},f,A);break e;case 2:E0=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=a.effects,A===null?a.effects=[l]:A.push(l))}else h={eventTime:h,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=A;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;A=l,l=A.next,A.next=null,a.lastBaseUpdate=A,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);Jp|=o,t.lanes=o,t.memoizedState=f}}function dU(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Dr(191,a));a.call(n)}}}var Aw={},nh=Om(Aw),Zb=Om(Aw),e2=Om(Aw);function wp(t){if(t===Aw)throw Error(Dr(174));return t}function JO(t,e){switch(bs(e2,e),bs(Zb,t),bs(nh,Aw),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zB(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zB(e,t)}Ts(nh),bs(nh,e)}function _v(){Ts(nh),Ts(Zb),Ts(e2)}function SX(t){wp(e2.current);var e=wp(nh.current),r=zB(e,t.type);e!==r&&(bs(Zb,t),bs(nh,r))}function ZO(t){Zb.current===t&&(Ts(nh),Ts(Zb))}var ii=Om(0);function $E(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var c4=[];function eD(){for(var t=0;t<c4.length;t++)c4[t]._workInProgressVersionPrimary=null;c4.length=0}var $_=PA.ReactCurrentDispatcher,u4=PA.ReactCurrentBatchConfig,Yp=0,ui=null,No=null,Yo=null,KE=!1,lb=!1,t2=0,$he=0;function Ml(){throw Error(Dr(321))}function tD(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!yf(t[r],e[r]))return!1;return!0}function rD(t,e,r,n,a,s){if(Yp=s,ui=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$_.current=t===null||t.memoizedState===null?zhe:Whe,t=r(n,a),lb){s=0;do{if(lb=!1,t2=0,25<=s)throw Error(Dr(301));s+=1,Yo=No=null,e.updateQueue=null,$_.current=Xhe,t=r(n,a)}while(lb)}if($_.current=GE,e=No!==null&&No.next!==null,Yp=0,Yo=No=ui=null,KE=!1,e)throw Error(Dr(300));return t}function nD(){var t=t2!==0;return t2=0,t}function Kf(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yo===null?ui.memoizedState=Yo=t:Yo=Yo.next=t,Yo}function kd(){if(No===null){var t=ui.alternate;t=t!==null?t.memoizedState:null}else t=No.next;var e=Yo===null?ui.memoizedState:Yo.next;if(e!==null)Yo=e,No=t;else{if(t===null)throw Error(Dr(310));No=t,t={memoizedState:No.memoizedState,baseState:No.baseState,baseQueue:No.baseQueue,queue:No.queue,next:null},Yo===null?ui.memoizedState=Yo=t:Yo=Yo.next=t}return Yo}function r2(t,e){return typeof e=="function"?e(t):e}function d4(t){var e=kd(),r=e.queue;if(r===null)throw Error(Dr(311));r.lastRenderedReducer=t;var n=No,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((Yp&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,ui.lanes|=d,Jp|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,yf(n,e.memoizedState)||(Zc=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do s=a.lane,ui.lanes|=s,Jp|=s,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function f4(t){var e=kd(),r=e.queue;if(r===null)throw Error(Dr(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,s=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=t(s,o.action),o=o.next;while(o!==a);yf(s,e.memoizedState)||(Zc=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function IX(){}function jX(t,e){var r=ui,n=kd(),a=e(),s=!yf(n.memoizedState,a);if(s&&(n.memoizedState=a,Zc=!0),n=n.queue,aD(TX.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Yo!==null&&Yo.memoizedState.tag&1){if(r.flags|=2048,n2(9,BX.bind(null,r,n,a,e),void 0,null),tl===null)throw Error(Dr(349));Yp&30||PX(r,e,a)}return a}function PX(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ui.updateQueue,e===null?(e={lastEffect:null,stores:null},ui.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function BX(t,e,r,n){e.value=r,e.getSnapshot=n,kX(e)&&FX(t)}function TX(t,e,r){return r(function(){kX(e)&&FX(t)})}function kX(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!yf(t,r)}catch{return!0}}function FX(t){var e=hA(t,1);e!==null&&mf(e,t,1,-1)}function fU(t){var e=Kf();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r2,lastRenderedState:t},e.queue=t,t=t.dispatch=qhe.bind(null,ui,t),[e.memoizedState,t]}function n2(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ui.updateQueue,e===null?(e={lastEffect:null,stores:null},ui.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function OX(){return kd().memoizedState}function K_(t,e,r,n){var a=Kf();ui.flags|=t,a.memoizedState=n2(1|e,r,void 0,n===void 0?null:n)}function ij(t,e,r,n){var a=kd();n=n===void 0?null:n;var s=void 0;if(No!==null){var o=No.memoizedState;if(s=o.destroy,n!==null&&tD(n,o.deps)){a.memoizedState=n2(e,r,s,n);return}}ui.flags|=t,a.memoizedState=n2(1|e,r,s,n)}function hU(t,e){return K_(8390656,8,t,e)}function aD(t,e){return ij(2048,8,t,e)}function DX(t,e){return ij(4,2,t,e)}function RX(t,e){return ij(4,4,t,e)}function MX(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function LX(t,e,r){return r=r!=null?r.concat([t]):null,ij(4,4,MX.bind(null,e,t),r)}function sD(){}function UX(t,e){var r=kd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&tD(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function QX(t,e){var r=kd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&tD(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function VX(t,e,r){return Yp&21?(yf(r,e)||(r=qW(),ui.lanes|=r,Jp|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zc=!0),t.memoizedState=r)}function Khe(t,e){var r=ns;ns=r!==0&&4>r?r:4,t(!0);var n=u4.transition;u4.transition={};try{t(!1),e()}finally{ns=r,u4.transition=n}}function HX(){return kd().memoizedState}function Ghe(t,e,r){var n=am(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},$X(t))KX(e,r);else if(r=_X(t,e,r,n),r!==null){var a=Ic();mf(r,t,n,a),GX(r,e,n)}}function qhe(t,e,r){var n=am(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if($X(t))KX(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,yf(l,o)){var c=e.interleaved;c===null?(a.next=a,XO(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=_X(t,e,a,n),r!==null&&(a=Ic(),mf(r,t,n,a),GX(r,e,n))}}function $X(t){var e=t.alternate;return t===ui||e!==null&&e===ui}function KX(t,e){lb=KE=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function GX(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,DO(t,r)}}var GE={readContext:Td,useCallback:Ml,useContext:Ml,useEffect:Ml,useImperativeHandle:Ml,useInsertionEffect:Ml,useLayoutEffect:Ml,useMemo:Ml,useReducer:Ml,useRef:Ml,useState:Ml,useDebugValue:Ml,useDeferredValue:Ml,useTransition:Ml,useMutableSource:Ml,useSyncExternalStore:Ml,useId:Ml,unstable_isNewReconciler:!1},zhe={readContext:Td,useCallback:function(t,e){return Kf().memoizedState=[t,e===void 0?null:e],t},useContext:Td,useEffect:hU,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,K_(4194308,4,MX.bind(null,e,t),r)},useLayoutEffect:function(t,e){return K_(4194308,4,t,e)},useInsertionEffect:function(t,e){return K_(4,2,t,e)},useMemo:function(t,e){var r=Kf();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Kf();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Ghe.bind(null,ui,t),[n.memoizedState,t]},useRef:function(t){var e=Kf();return t={current:t},e.memoizedState=t},useState:fU,useDebugValue:sD,useDeferredValue:function(t){return Kf().memoizedState=t},useTransition:function(){var t=fU(!1),e=t[0];return t=Khe.bind(null,t[1]),Kf().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ui,a=Kf();if(Qs){if(r===void 0)throw Error(Dr(407));r=r()}else{if(r=e(),tl===null)throw Error(Dr(349));Yp&30||PX(n,e,r)}a.memoizedState=r;var s={value:r,getSnapshot:e};return a.queue=s,hU(TX.bind(null,n,s,t),[t]),n.flags|=2048,n2(9,BX.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Kf(),e=tl.identifierPrefix;if(Qs){var r=Kh,n=$h;r=(n&~(1<<32-Af(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=t2++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=$he++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Whe={readContext:Td,useCallback:UX,useContext:Td,useEffect:aD,useImperativeHandle:LX,useInsertionEffect:DX,useLayoutEffect:RX,useMemo:QX,useReducer:d4,useRef:OX,useState:function(){return d4(r2)},useDebugValue:sD,useDeferredValue:function(t){var e=kd();return VX(e,No.memoizedState,t)},useTransition:function(){var t=d4(r2)[0],e=kd().memoizedState;return[t,e]},useMutableSource:IX,useSyncExternalStore:jX,useId:HX,unstable_isNewReconciler:!1},Xhe={readContext:Td,useCallback:UX,useContext:Td,useEffect:aD,useImperativeHandle:LX,useInsertionEffect:DX,useLayoutEffect:RX,useMemo:QX,useReducer:f4,useRef:OX,useState:function(){return f4(r2)},useDebugValue:sD,useDeferredValue:function(t){var e=kd();return No===null?e.memoizedState=t:VX(e,No.memoizedState,t)},useTransition:function(){var t=f4(r2)[0],e=kd().memoizedState;return[t,e]},useMutableSource:IX,useSyncExternalStore:jX,useId:HX,unstable_isNewReconciler:!1};function nf(t,e){if(t&&t.defaultProps){e=di({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function mT(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:di({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var oj={isMounted:function(t){return(t=t._reactInternals)?Ig(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ic(),a=am(t),s=eA(n,a);s.payload=e,r!=null&&(s.callback=r),e=rm(t,s,a),e!==null&&(mf(e,t,a,n),H_(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ic(),a=am(t),s=eA(n,a);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=rm(t,s,a),e!==null&&(mf(e,t,a,n),H_(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ic(),n=am(t),a=eA(r,n);a.tag=2,e!=null&&(a.callback=e),e=rm(t,a,n),e!==null&&(mf(e,t,n,r),H_(e,t,n))}};function AU(t,e,r,n,a,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Wb(r,n)||!Wb(a,s):!0}function qX(t,e,r){var n=!1,a=gm,s=e.contextType;return typeof s=="object"&&s!==null?s=Td(s):(a=au(e)?Wp:oc.current,n=e.contextTypes,s=(n=n!=null)?wv(t,a):gm),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=oj,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function mU(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&oj.enqueueReplaceState(e,e.state,null)}function pT(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},YO(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=Td(s):(s=au(e)?Wp:oc.current,a.context=wv(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(mT(t,e,s,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&oj.enqueueReplaceState(a,a.state,null),HE(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Ev(t,e){try{var r="",n=e;do r+=Cfe(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function h4(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function gT(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Yhe=typeof WeakMap=="function"?WeakMap:Map;function zX(t,e,r){r=eA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){zE||(zE=!0,ST=n),gT(t,e)},r}function WX(t,e,r){r=eA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){gT(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){gT(t,e),typeof n!="function"&&(nm===null?nm=new Set([this]):nm.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function pU(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Yhe;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=dAe.bind(null,t,e,r),e.then(t,t))}function gU(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function xU(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=eA(-1,1),e.tag=2,rm(r,e,1))),r.lanes|=1),t)}var Jhe=PA.ReactCurrentOwner,Zc=!1;function bc(t,e,r,n){e.child=t===null?CX(e,null,r,n):Cv(e,t.child,r,n)}function vU(t,e,r,n,a){r=r.render;var s=e.ref;return ov(e,a),n=rD(t,e,r,n,s,a),r=nD(),t!==null&&!Zc?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,AA(t,e,a)):(Qs&&r&&$O(e),e.flags|=1,bc(t,e,n,a),e.child)}function yU(t,e,r,n,a){if(t===null){var s=r.type;return typeof s=="function"&&!hD(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,XX(t,e,s,n,a)):(t=W_(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Wb,r(o,n)&&t.ref===e.ref)return AA(t,e,a)}return e.flags|=1,t=sm(s,n),t.ref=e.ref,t.return=e,e.child=t}function XX(t,e,r,n,a){if(t!==null){var s=t.memoizedProps;if(Wb(s,n)&&t.ref===e.ref)if(Zc=!1,e.pendingProps=n=s,(t.lanes&a)!==0)t.flags&131072&&(Zc=!0);else return e.lanes=t.lanes,AA(t,e,a)}return xT(t,e,r,n,a)}function YX(t,e,r){var n=e.pendingProps,a=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},bs(Gx,Eu),Eu|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,bs(Gx,Eu),Eu|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,bs(Gx,Eu),Eu|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,bs(Gx,Eu),Eu|=n;return bc(t,e,a,r),e.child}function JX(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function xT(t,e,r,n,a){var s=au(r)?Wp:oc.current;return s=wv(e,s),ov(e,a),r=rD(t,e,r,n,s,a),n=nD(),t!==null&&!Zc?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,AA(t,e,a)):(Qs&&n&&$O(e),e.flags|=1,bc(t,e,r,a),e.child)}function bU(t,e,r,n,a){if(au(r)){var s=!0;ME(e)}else s=!1;if(ov(e,a),e.stateNode===null)G_(t,e),qX(e,r,n),pT(e,r,n,a),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Td(u):(u=au(r)?Wp:oc.current,u=wv(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&mU(e,o,n,u),E0=!1;var A=e.memoizedState;o.state=A,HE(e,n,o,a),c=e.memoizedState,l!==n||A!==c||nu.current||E0?(typeof d=="function"&&(mT(e,r,d,n),c=e.memoizedState),(l=E0||AU(e,r,l,n,A,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,EX(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:nf(e.type,l),o.props=u,f=e.pendingProps,A=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Td(c):(c=au(r)?Wp:oc.current,c=wv(e,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||A!==c)&&mU(e,o,n,c),E0=!1,A=e.memoizedState,o.state=A,HE(e,n,o,a);var m=e.memoizedState;l!==f||A!==m||nu.current||E0?(typeof h=="function"&&(mT(e,r,h,n),m=e.memoizedState),(u=E0||AU(e,r,u,n,A,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),n=!1)}return vT(t,e,r,n,s,a)}function vT(t,e,r,n,a,s){JX(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return a&&iU(e,r,!1),AA(t,e,s);n=e.stateNode,Jhe.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Cv(e,t.child,null,s),e.child=Cv(e,null,l,s)):bc(t,e,l,s),e.memoizedState=n.state,a&&iU(e,r,!0),e.child}function ZX(t){var e=t.stateNode;e.pendingContext?sU(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sU(t,e.context,!1),JO(t,e.containerInfo)}function wU(t,e,r,n,a){return Nv(),GO(a),e.flags|=256,bc(t,e,r,n),e.child}var yT={dehydrated:null,treeContext:null,retryLane:0};function bT(t){return{baseLanes:t,cachePool:null,transitions:null}}function eY(t,e,r){var n=e.pendingProps,a=ii.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),bs(ii,a&1),t===null)return hT(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=uj(o,n,0,null),t=Tp(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=bT(r),e.memoizedState=yT,t):iD(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return Zhe(t,e,o,n,l,a,r);if(s){s=n.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=sm(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=sm(l,s):(s=Tp(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?bT(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=yT,n}return s=t.child,t=s.sibling,n=sm(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function iD(t,e){return e=uj({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zN(t,e,r,n){return n!==null&&GO(n),Cv(e,t.child,null,r),t=iD(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Zhe(t,e,r,n,a,s,o){if(r)return e.flags&256?(e.flags&=-257,n=h4(Error(Dr(422))),zN(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,a=e.mode,n=uj({mode:"visible",children:n.children},a,0,null),s=Tp(s,a,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Cv(e,t.child,null,o),e.child.memoizedState=bT(o),e.memoizedState=yT,s);if(!(e.mode&1))return zN(t,e,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Dr(419)),n=h4(s,n,void 0),zN(t,e,o,n)}if(l=(o&t.childLanes)!==0,Zc||l){if(n=tl,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,hA(t,a),mf(n,t,a,-1))}return fD(),n=h4(Error(Dr(421))),zN(t,e,o,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=fAe.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,ku=tm(a.nextSibling),Ru=e,Qs=!0,sf=null,t!==null&&(xd[vd++]=$h,xd[vd++]=Kh,xd[vd++]=Xp,$h=t.id,Kh=t.overflow,Xp=e),e=iD(e,n.children),e.flags|=4096,e)}function NU(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),AT(t.return,e,r)}function A4(t,e,r,n,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function tY(t,e,r){var n=e.pendingProps,a=n.revealOrder,s=n.tail;if(bc(t,e,n.children,r),n=ii.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&NU(t,r,e);else if(t.tag===19)NU(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(bs(ii,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&$E(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),A4(e,!1,a,r,s);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&$E(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}A4(e,!0,r,null,s);break;case"together":A4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function G_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function AA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Jp|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Dr(153));if(e.child!==null){for(t=e.child,r=sm(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=sm(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function eAe(t,e,r){switch(e.tag){case 3:ZX(e),Nv();break;case 5:SX(e);break;case 1:au(e.type)&&ME(e);break;case 4:JO(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;bs(QE,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(bs(ii,ii.current&1),e.flags|=128,null):r&e.child.childLanes?eY(t,e,r):(bs(ii,ii.current&1),t=AA(t,e,r),t!==null?t.sibling:null);bs(ii,ii.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return tY(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),bs(ii,ii.current),n)break;return null;case 22:case 23:return e.lanes=0,YX(t,e,r)}return AA(t,e,r)}var rY,wT,nY,aY;rY=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};wT=function(){};nY=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,wp(nh.current);var s=null;switch(r){case"input":a=$B(t,a),n=$B(t,n),s=[];break;case"select":a=di({},a,{value:void 0}),n=di({},n,{value:void 0}),s=[];break;case"textarea":a=qB(t,a),n=qB(t,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=DE)}WB(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Vb.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Vb.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Es("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};aY=function(t,e,r,n){r!==n&&(e.flags|=4)};function Z1(t,e){if(!Qs)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ll(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function tAe(t,e,r){var n=e.pendingProps;switch(KO(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ll(e),null;case 1:return au(e.type)&&RE(),Ll(e),null;case 3:return n=e.stateNode,_v(),Ts(nu),Ts(oc),eD(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(GN(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sf!==null&&(PT(sf),sf=null))),wT(t,e),Ll(e),null;case 5:ZO(e);var a=wp(e2.current);if(r=e.type,t!==null&&e.stateNode!=null)nY(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Dr(166));return Ll(e),null}if(t=wp(nh.current),GN(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Gf]=e,n[Jb]=s,t=(e.mode&1)!==0,r){case"dialog":Es("cancel",n),Es("close",n);break;case"iframe":case"object":case"embed":Es("load",n);break;case"video":case"audio":for(a=0;a<Fy.length;a++)Es(Fy[a],n);break;case"source":Es("error",n);break;case"img":case"image":case"link":Es("error",n),Es("load",n);break;case"details":Es("toggle",n);break;case"input":TL(n,s),Es("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Es("invalid",n);break;case"textarea":FL(n,s),Es("invalid",n)}WB(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&KN(n.textContent,l,t),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&KN(n.textContent,l,t),a=["children",""+l]):Vb.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Es("scroll",n)}switch(r){case"input":RN(n),kL(n,s,!0);break;case"textarea":RN(n),OL(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=DE)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=TW(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Gf]=e,t[Jb]=n,rY(t,e,!1,!1),e.stateNode=t;e:{switch(o=XB(r,n),r){case"dialog":Es("cancel",t),Es("close",t),a=n;break;case"iframe":case"object":case"embed":Es("load",t),a=n;break;case"video":case"audio":for(a=0;a<Fy.length;a++)Es(Fy[a],t);a=n;break;case"source":Es("error",t),a=n;break;case"img":case"image":case"link":Es("error",t),Es("load",t),a=n;break;case"details":Es("toggle",t),a=n;break;case"input":TL(t,n),a=$B(t,n),Es("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=di({},n,{value:void 0}),Es("invalid",t);break;case"textarea":FL(t,n),a=qB(t,n),Es("invalid",t);break;default:a=n}WB(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?OW(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&kW(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Hb(t,c):typeof c=="number"&&Hb(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Vb.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Es("scroll",t):c!=null&&PO(t,s,c,o))}switch(r){case"input":RN(t),kL(t,n,!1);break;case"textarea":RN(t),OL(t);break;case"option":n.value!=null&&t.setAttribute("value",""+pm(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?nv(t,!!n.multiple,s,!1):n.defaultValue!=null&&nv(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=DE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ll(e),null;case 6:if(t&&e.stateNode!=null)aY(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Dr(166));if(r=wp(e2.current),wp(nh.current),GN(e)){if(n=e.stateNode,r=e.memoizedProps,n[Gf]=e,(s=n.nodeValue!==r)&&(t=Ru,t!==null))switch(t.tag){case 3:KN(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&KN(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gf]=e,e.stateNode=n}return Ll(e),null;case 13:if(Ts(ii),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qs&&ku!==null&&e.mode&1&&!(e.flags&128))wX(),Nv(),e.flags|=98560,s=!1;else if(s=GN(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Dr(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Dr(317));s[Gf]=e}else Nv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ll(e),s=!1}else sf!==null&&(PT(sf),sf=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ii.current&1?To===0&&(To=3):fD())),e.updateQueue!==null&&(e.flags|=4),Ll(e),null);case 4:return _v(),wT(t,e),t===null&&Xb(e.stateNode.containerInfo),Ll(e),null;case 10:return WO(e.type._context),Ll(e),null;case 17:return au(e.type)&&RE(),Ll(e),null;case 19:if(Ts(ii),s=e.memoizedState,s===null)return Ll(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)Z1(s,!1);else{if(To!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=$E(t),o!==null){for(e.flags|=128,Z1(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return bs(ii,ii.current&1|2),e.child}t=t.sibling}s.tail!==null&&Vi()>Sv&&(e.flags|=128,n=!0,Z1(s,!1),e.lanes=4194304)}else{if(!n)if(t=$E(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Z1(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Qs)return Ll(e),null}else 2*Vi()-s.renderingStartTime>Sv&&r!==1073741824&&(e.flags|=128,n=!0,Z1(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Vi(),e.sibling=null,r=ii.current,bs(ii,n?r&1|2:r&1),e):(Ll(e),null);case 22:case 23:return dD(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Eu&1073741824&&(Ll(e),e.subtreeFlags&6&&(e.flags|=8192)):Ll(e),null;case 24:return null;case 25:return null}throw Error(Dr(156,e.tag))}function rAe(t,e){switch(KO(e),e.tag){case 1:return au(e.type)&&RE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _v(),Ts(nu),Ts(oc),eD(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ZO(e),null;case 13:if(Ts(ii),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Dr(340));Nv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ts(ii),null;case 4:return _v(),null;case 10:return WO(e.type._context),null;case 22:case 23:return dD(),null;case 24:return null;default:return null}}var WN=!1,tc=!1,nAe=typeof WeakSet=="function"?WeakSet:Set,on=null;function Kx(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){_i(t,e,n)}else r.current=null}function NT(t,e,r){try{r()}catch(n){_i(t,e,n)}}var CU=!1;function aAe(t,e){if(iT=kE,t=cX(),HO(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=t,A=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)A=f,f=h;for(;;){if(f===t)break t;if(A===r&&++u===a&&(l=o),A===s&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=A,A=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(oT={focusedElem:t,selectionRange:r},kE=!1,on=e;on!==null;)if(e=on,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,on=t;else for(;on!==null;){e=on;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:nf(e.type,p),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Dr(163))}}catch(w){_i(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,on=t;break}on=e.return}return m=CU,CU=!1,m}function cb(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&NT(e,r,s)}a=a.next}while(a!==n)}}function lj(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function CT(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function sY(t){var e=t.alternate;e!==null&&(t.alternate=null,sY(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Gf],delete e[Jb],delete e[uT],delete e[Uhe],delete e[Qhe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function iY(t){return t.tag===5||t.tag===3||t.tag===4}function _U(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||iY(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _T(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=DE));else if(n!==4&&(t=t.child,t!==null))for(_T(t,e,r),t=t.sibling;t!==null;)_T(t,e,r),t=t.sibling}function ET(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(ET(t,e,r),t=t.sibling;t!==null;)ET(t,e,r),t=t.sibling}var yl=null,af=!1;function i0(t,e,r){for(r=r.child;r!==null;)oY(t,e,r),r=r.sibling}function oY(t,e,r){if(rh&&typeof rh.onCommitFiberUnmount=="function")try{rh.onCommitFiberUnmount(ej,r)}catch{}switch(r.tag){case 5:tc||Kx(r,e);case 6:var n=yl,a=af;yl=null,i0(t,e,r),yl=n,af=a,yl!==null&&(af?(t=yl,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):yl.removeChild(r.stateNode));break;case 18:yl!==null&&(af?(t=yl,r=r.stateNode,t.nodeType===8?o4(t.parentNode,r):t.nodeType===1&&o4(t,r),qb(t)):o4(yl,r.stateNode));break;case 4:n=yl,a=af,yl=r.stateNode.containerInfo,af=!0,i0(t,e,r),yl=n,af=a;break;case 0:case 11:case 14:case 15:if(!tc&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&NT(r,e,o),a=a.next}while(a!==n)}i0(t,e,r);break;case 1:if(!tc&&(Kx(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){_i(r,e,l)}i0(t,e,r);break;case 21:i0(t,e,r);break;case 22:r.mode&1?(tc=(n=tc)||r.memoizedState!==null,i0(t,e,r),tc=n):i0(t,e,r);break;default:i0(t,e,r)}}function EU(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new nAe),e.forEach(function(n){var a=hAe.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function zd(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:yl=l.stateNode,af=!1;break e;case 3:yl=l.stateNode.containerInfo,af=!0;break e;case 4:yl=l.stateNode.containerInfo,af=!0;break e}l=l.return}if(yl===null)throw Error(Dr(160));oY(s,o,a),yl=null,af=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){_i(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)lY(e,t),e=e.sibling}function lY(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zd(e,t),Of(t),n&4){try{cb(3,t,t.return),lj(3,t)}catch(p){_i(t,t.return,p)}try{cb(5,t,t.return)}catch(p){_i(t,t.return,p)}}break;case 1:zd(e,t),Of(t),n&512&&r!==null&&Kx(r,r.return);break;case 5:if(zd(e,t),Of(t),n&512&&r!==null&&Kx(r,r.return),t.flags&32){var a=t.stateNode;try{Hb(a,"")}catch(p){_i(t,t.return,p)}}if(n&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&PW(a,s),XB(l,o);var u=XB(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?OW(a,f):d==="dangerouslySetInnerHTML"?kW(a,f):d==="children"?Hb(a,f):PO(a,d,f,u)}switch(l){case"input":KB(a,s);break;case"textarea":BW(a,s);break;case"select":var A=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?nv(a,!!s.multiple,h,!1):A!==!!s.multiple&&(s.defaultValue!=null?nv(a,!!s.multiple,s.defaultValue,!0):nv(a,!!s.multiple,s.multiple?[]:"",!1))}a[Jb]=s}catch(p){_i(t,t.return,p)}}break;case 6:if(zd(e,t),Of(t),n&4){if(t.stateNode===null)throw Error(Dr(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(p){_i(t,t.return,p)}}break;case 3:if(zd(e,t),Of(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qb(e.containerInfo)}catch(p){_i(t,t.return,p)}break;case 4:zd(e,t),Of(t);break;case 13:zd(e,t),Of(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(cD=Vi())),n&4&&EU(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(tc=(u=tc)||d,zd(e,t),tc=u):zd(e,t),Of(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(on=t,d=t.child;d!==null;){for(f=on=d;on!==null;){switch(A=on,h=A.child,A.tag){case 0:case 11:case 14:case 15:cb(4,A,A.return);break;case 1:Kx(A,A.return);var m=A.stateNode;if(typeof m.componentWillUnmount=="function"){n=A,r=A.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){_i(n,r,p)}}break;case 5:Kx(A,A.return);break;case 22:if(A.memoizedState!==null){IU(f);continue}}h!==null?(h.return=A,on=h):IU(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=FW("display",o))}catch(p){_i(t,t.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){_i(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:zd(e,t),Of(t),n&4&&EU(t);break;case 21:break;default:zd(e,t),Of(t)}}function Of(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(iY(r)){var n=r;break e}r=r.return}throw Error(Dr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Hb(a,""),n.flags&=-33);var s=_U(t);ET(t,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=_U(t);_T(t,l,o);break;default:throw Error(Dr(161))}}catch(c){_i(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function sAe(t,e,r){on=t,cY(t)}function cY(t,e,r){for(var n=(t.mode&1)!==0;on!==null;){var a=on,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||WN;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||tc;l=WN;var u=tc;if(WN=o,(tc=c)&&!u)for(on=a;on!==null;)o=on,c=o.child,o.tag===22&&o.memoizedState!==null?jU(a):c!==null?(c.return=o,on=c):jU(a);for(;s!==null;)on=s,cY(s),s=s.sibling;on=a,WN=l,tc=u}SU(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,on=s):SU(t)}}function SU(t){for(;on!==null;){var e=on;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tc||lj(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!tc)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:nf(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&dU(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}dU(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&qb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Dr(163))}tc||e.flags&512&&CT(e)}catch(A){_i(e,e.return,A)}}if(e===t){on=null;break}if(r=e.sibling,r!==null){r.return=e.return,on=r;break}on=e.return}}function IU(t){for(;on!==null;){var e=on;if(e===t){on=null;break}var r=e.sibling;if(r!==null){r.return=e.return,on=r;break}on=e.return}}function jU(t){for(;on!==null;){var e=on;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{lj(4,e)}catch(c){_i(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(c){_i(e,a,c)}}var s=e.return;try{CT(e)}catch(c){_i(e,s,c)}break;case 5:var o=e.return;try{CT(e)}catch(c){_i(e,o,c)}}}catch(c){_i(e,e.return,c)}if(e===t){on=null;break}var l=e.sibling;if(l!==null){l.return=e.return,on=l;break}on=e.return}}var iAe=Math.ceil,qE=PA.ReactCurrentDispatcher,oD=PA.ReactCurrentOwner,Sd=PA.ReactCurrentBatchConfig,Ca=0,tl=null,io=null,Bl=0,Eu=0,Gx=Om(0),To=0,a2=null,Jp=0,cj=0,lD=0,ub=null,Yc=null,cD=0,Sv=1/0,Mh=null,zE=!1,ST=null,nm=null,XN=!1,H0=null,WE=0,db=0,IT=null,q_=-1,z_=0;function Ic(){return Ca&6?Vi():q_!==-1?q_:q_=Vi()}function am(t){return t.mode&1?Ca&2&&Bl!==0?Bl&-Bl:Hhe.transition!==null?(z_===0&&(z_=qW()),z_):(t=ns,t!==0||(t=window.event,t=t===void 0?16:eX(t.type)),t):1}function mf(t,e,r,n){if(50<db)throw db=0,IT=null,Error(Dr(185));dw(t,r,n),(!(Ca&2)||t!==tl)&&(t===tl&&(!(Ca&2)&&(cj|=r),To===4&&T0(t,Bl)),su(t,n),r===1&&Ca===0&&!(e.mode&1)&&(Sv=Vi()+500,sj&&Dm()))}function su(t,e){var r=t.callbackNode;Hfe(t,e);var n=TE(t,t===tl?Bl:0);if(n===0)r!==null&&ML(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&ML(r),e===1)t.tag===0?Vhe(PU.bind(null,t)):vX(PU.bind(null,t)),Mhe(function(){!(Ca&6)&&Dm()}),r=null;else{switch(zW(n)){case 1:r=OO;break;case 4:r=KW;break;case 16:r=BE;break;case 536870912:r=GW;break;default:r=BE}r=gY(r,uY.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function uY(t,e){if(q_=-1,z_=0,Ca&6)throw Error(Dr(327));var r=t.callbackNode;if(lv()&&t.callbackNode!==r)return null;var n=TE(t,t===tl?Bl:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=XE(t,n);else{e=n;var a=Ca;Ca|=2;var s=fY();(tl!==t||Bl!==e)&&(Mh=null,Sv=Vi()+500,Bp(t,e));do try{cAe();break}catch(l){dY(t,l)}while(!0);zO(),qE.current=s,Ca=a,io!==null?e=0:(tl=null,Bl=0,e=To)}if(e!==0){if(e===2&&(a=tT(t),a!==0&&(n=a,e=jT(t,a))),e===1)throw r=a2,Bp(t,0),T0(t,n),su(t,Vi()),r;if(e===6)T0(t,n);else{if(a=t.current.alternate,!(n&30)&&!oAe(a)&&(e=XE(t,n),e===2&&(s=tT(t),s!==0&&(n=s,e=jT(t,s))),e===1))throw r=a2,Bp(t,0),T0(t,n),su(t,Vi()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(Dr(345));case 2:sp(t,Yc,Mh);break;case 3:if(T0(t,n),(n&130023424)===n&&(e=cD+500-Vi(),10<e)){if(TE(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Ic(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=cT(sp.bind(null,t,Yc,Mh),e);break}sp(t,Yc,Mh);break;case 4:if(T0(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var o=31-Af(n);s=1<<o,o=e[o],o>a&&(a=o),n&=~s}if(n=a,n=Vi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*iAe(n/1960))-n,10<n){t.timeoutHandle=cT(sp.bind(null,t,Yc,Mh),n);break}sp(t,Yc,Mh);break;case 5:sp(t,Yc,Mh);break;default:throw Error(Dr(329))}}}return su(t,Vi()),t.callbackNode===r?uY.bind(null,t):null}function jT(t,e){var r=ub;return t.current.memoizedState.isDehydrated&&(Bp(t,e).flags|=256),t=XE(t,e),t!==2&&(e=Yc,Yc=r,e!==null&&PT(e)),t}function PT(t){Yc===null?Yc=t:Yc.push.apply(Yc,t)}function oAe(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!yf(s(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function T0(t,e){for(e&=~lD,e&=~cj,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Af(e),n=1<<r;t[r]=-1,e&=~n}}function PU(t){if(Ca&6)throw Error(Dr(327));lv();var e=TE(t,0);if(!(e&1))return su(t,Vi()),null;var r=XE(t,e);if(t.tag!==0&&r===2){var n=tT(t);n!==0&&(e=n,r=jT(t,n))}if(r===1)throw r=a2,Bp(t,0),T0(t,e),su(t,Vi()),r;if(r===6)throw Error(Dr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,sp(t,Yc,Mh),su(t,Vi()),null}function uD(t,e){var r=Ca;Ca|=1;try{return t(e)}finally{Ca=r,Ca===0&&(Sv=Vi()+500,sj&&Dm())}}function Zp(t){H0!==null&&H0.tag===0&&!(Ca&6)&&lv();var e=Ca;Ca|=1;var r=Sd.transition,n=ns;try{if(Sd.transition=null,ns=1,t)return t()}finally{ns=n,Sd.transition=r,Ca=e,!(Ca&6)&&Dm()}}function dD(){Eu=Gx.current,Ts(Gx)}function Bp(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Rhe(r)),io!==null)for(r=io.return;r!==null;){var n=r;switch(KO(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&RE();break;case 3:_v(),Ts(nu),Ts(oc),eD();break;case 5:ZO(n);break;case 4:_v();break;case 13:Ts(ii);break;case 19:Ts(ii);break;case 10:WO(n.type._context);break;case 22:case 23:dD()}r=r.return}if(tl=t,io=t=sm(t.current,null),Bl=Eu=e,To=0,a2=null,lD=cj=Jp=0,Yc=ub=null,bp!==null){for(e=0;e<bp.length;e++)if(r=bp[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}bp=null}return t}function dY(t,e){do{var r=io;try{if(zO(),$_.current=GE,KE){for(var n=ui.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}KE=!1}if(Yp=0,Yo=No=ui=null,lb=!1,t2=0,oD.current=null,r===null||r.return===null){To=1,a2=e,io=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=Bl,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var A=d.alternate;A?(d.updateQueue=A.updateQueue,d.memoizedState=A.memoizedState,d.lanes=A.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=gU(o);if(h!==null){h.flags&=-257,xU(h,o,l,s,e),h.mode&1&&pU(s,u,e),e=h,c=u;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){pU(s,u,e),fD();break e}c=Error(Dr(426))}}else if(Qs&&l.mode&1){var x=gU(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),xU(x,o,l,s,e),GO(Ev(c,l));break e}}s=c=Ev(c,l),To!==4&&(To=2),ub===null?ub=[s]:ub.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=zX(s,c,e);uU(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(nm===null||!nm.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=WX(s,l,e);uU(s,w);break e}}s=s.return}while(s!==null)}AY(r)}catch(j){e=j,io===r&&r!==null&&(io=r=r.return);continue}break}while(!0)}function fY(){var t=qE.current;return qE.current=GE,t===null?GE:t}function fD(){(To===0||To===3||To===2)&&(To=4),tl===null||!(Jp&268435455)&&!(cj&268435455)||T0(tl,Bl)}function XE(t,e){var r=Ca;Ca|=2;var n=fY();(tl!==t||Bl!==e)&&(Mh=null,Bp(t,e));do try{lAe();break}catch(a){dY(t,a)}while(!0);if(zO(),Ca=r,qE.current=n,io!==null)throw Error(Dr(261));return tl=null,Bl=0,To}function lAe(){for(;io!==null;)hY(io)}function cAe(){for(;io!==null&&!Ffe();)hY(io)}function hY(t){var e=pY(t.alternate,t,Eu);t.memoizedProps=t.pendingProps,e===null?AY(t):io=e,oD.current=null}function AY(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=rAe(r,e),r!==null){r.flags&=32767,io=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{To=6,io=null;return}}else if(r=tAe(r,e,Eu),r!==null){io=r;return}if(e=e.sibling,e!==null){io=e;return}io=e=t}while(e!==null);To===0&&(To=5)}function sp(t,e,r){var n=ns,a=Sd.transition;try{Sd.transition=null,ns=1,uAe(t,e,r,n)}finally{Sd.transition=a,ns=n}return null}function uAe(t,e,r,n){do lv();while(H0!==null);if(Ca&6)throw Error(Dr(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Dr(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if($fe(t,s),t===tl&&(io=tl=null,Bl=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||XN||(XN=!0,gY(BE,function(){return lv(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Sd.transition,Sd.transition=null;var o=ns;ns=1;var l=Ca;Ca|=4,oD.current=null,aAe(t,r),lY(r,t),Phe(oT),kE=!!iT,oT=iT=null,t.current=r,sAe(r),Ofe(),Ca=l,ns=o,Sd.transition=s}else t.current=r;if(XN&&(XN=!1,H0=t,WE=a),s=t.pendingLanes,s===0&&(nm=null),Mfe(r.stateNode),su(t,Vi()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(zE)throw zE=!1,t=ST,ST=null,t;return WE&1&&t.tag!==0&&lv(),s=t.pendingLanes,s&1?t===IT?db++:(db=0,IT=t):db=0,Dm(),null}function lv(){if(H0!==null){var t=zW(WE),e=Sd.transition,r=ns;try{if(Sd.transition=null,ns=16>t?16:t,H0===null)var n=!1;else{if(t=H0,H0=null,WE=0,Ca&6)throw Error(Dr(331));var a=Ca;for(Ca|=4,on=t.current;on!==null;){var s=on,o=s.child;if(on.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(on=u;on!==null;){var d=on;switch(d.tag){case 0:case 11:case 15:cb(8,d,s)}var f=d.child;if(f!==null)f.return=d,on=f;else for(;on!==null;){d=on;var A=d.sibling,h=d.return;if(sY(d),d===u){on=null;break}if(A!==null){A.return=h,on=A;break}on=h}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}on=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,on=o;else e:for(;on!==null;){if(s=on,s.flags&2048)switch(s.tag){case 0:case 11:case 15:cb(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,on=v;break e}on=s.return}}var y=t.current;for(on=y;on!==null;){o=on;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,on=b;else e:for(o=y;on!==null;){if(l=on,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:lj(9,l)}}catch(j){_i(l,l.return,j)}if(l===o){on=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,on=w;break e}on=l.return}}if(Ca=a,Dm(),rh&&typeof rh.onPostCommitFiberRoot=="function")try{rh.onPostCommitFiberRoot(ej,t)}catch{}n=!0}return n}finally{ns=r,Sd.transition=e}}return!1}function BU(t,e,r){e=Ev(r,e),e=zX(t,e,1),t=rm(t,e,1),e=Ic(),t!==null&&(dw(t,1,e),su(t,e))}function _i(t,e,r){if(t.tag===3)BU(t,t,r);else for(;e!==null;){if(e.tag===3){BU(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(nm===null||!nm.has(n))){t=Ev(r,t),t=WX(e,t,1),e=rm(e,t,1),t=Ic(),e!==null&&(dw(e,1,t),su(e,t));break}}e=e.return}}function dAe(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ic(),t.pingedLanes|=t.suspendedLanes&r,tl===t&&(Bl&r)===r&&(To===4||To===3&&(Bl&130023424)===Bl&&500>Vi()-cD?Bp(t,0):lD|=r),su(t,e)}function mY(t,e){e===0&&(t.mode&1?(e=UN,UN<<=1,!(UN&130023424)&&(UN=4194304)):e=1);var r=Ic();t=hA(t,e),t!==null&&(dw(t,e,r),su(t,r))}function fAe(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),mY(t,r)}function hAe(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Dr(314))}n!==null&&n.delete(e),mY(t,r)}var pY;pY=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||nu.current)Zc=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Zc=!1,eAe(t,e,r);Zc=!!(t.flags&131072)}else Zc=!1,Qs&&e.flags&1048576&&yX(e,UE,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;G_(t,e),t=e.pendingProps;var a=wv(e,oc.current);ov(e,r),a=rD(null,e,n,t,a,r);var s=nD();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,au(n)?(s=!0,ME(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,YO(e),a.updater=oj,e.stateNode=a,a._reactInternals=e,pT(e,n,t,r),e=vT(null,e,n,!0,s,r)):(e.tag=0,Qs&&s&&$O(e),bc(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(G_(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=mAe(n),t=nf(n,t),a){case 0:e=xT(null,e,n,t,r);break e;case 1:e=bU(null,e,n,t,r);break e;case 11:e=vU(null,e,n,t,r);break e;case 14:e=yU(null,e,n,nf(n.type,t),r);break e}throw Error(Dr(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),xT(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),bU(t,e,n,a,r);case 3:e:{if(ZX(e),t===null)throw Error(Dr(387));n=e.pendingProps,s=e.memoizedState,a=s.element,EX(t,e),HE(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=Ev(Error(Dr(423)),e),e=wU(t,e,n,r,a);break e}else if(n!==a){a=Ev(Error(Dr(424)),e),e=wU(t,e,n,r,a);break e}else for(ku=tm(e.stateNode.containerInfo.firstChild),Ru=e,Qs=!0,sf=null,r=CX(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Nv(),n===a){e=AA(t,e,r);break e}bc(t,e,n,r)}e=e.child}return e;case 5:return SX(e),t===null&&hT(e),n=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,o=a.children,lT(n,a)?o=null:s!==null&&lT(n,s)&&(e.flags|=32),JX(t,e),bc(t,e,o,r),e.child;case 6:return t===null&&hT(e),null;case 13:return eY(t,e,r);case 4:return JO(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Cv(e,null,n,r):bc(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),vU(t,e,n,a,r);case 7:return bc(t,e,e.pendingProps,r),e.child;case 8:return bc(t,e,e.pendingProps.children,r),e.child;case 12:return bc(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,s=e.memoizedProps,o=a.value,bs(QE,n._currentValue),n._currentValue=o,s!==null)if(yf(s.value,o)){if(s.children===a.children&&!nu.current){e=AA(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=eA(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),AT(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Dr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),AT(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}bc(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,ov(e,r),a=Td(a),n=n(a),e.flags|=1,bc(t,e,n,r),e.child;case 14:return n=e.type,a=nf(n,e.pendingProps),a=nf(n.type,a),yU(t,e,n,a,r);case 15:return XX(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),G_(t,e),e.tag=1,au(n)?(t=!0,ME(e)):t=!1,ov(e,r),qX(e,n,a),pT(e,n,a,r),vT(null,e,n,!0,t,r);case 19:return tY(t,e,r);case 22:return YX(t,e,r)}throw Error(Dr(156,e.tag))};function gY(t,e){return $W(t,e)}function AAe(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bd(t,e,r,n){return new AAe(t,e,r,n)}function hD(t){return t=t.prototype,!(!t||!t.isReactComponent)}function mAe(t){if(typeof t=="function")return hD(t)?1:0;if(t!=null){if(t=t.$$typeof,t===TO)return 11;if(t===kO)return 14}return 2}function sm(t,e){var r=t.alternate;return r===null?(r=bd(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function W_(t,e,r,n,a,s){var o=2;if(n=t,typeof t=="function")hD(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Dx:return Tp(r.children,a,s,e);case BO:o=8,a|=8;break;case UB:return t=bd(12,r,e,a|2),t.elementType=UB,t.lanes=s,t;case QB:return t=bd(13,r,e,a),t.elementType=QB,t.lanes=s,t;case VB:return t=bd(19,r,e,a),t.elementType=VB,t.lanes=s,t;case SW:return uj(r,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _W:o=10;break e;case EW:o=9;break e;case TO:o=11;break e;case kO:o=14;break e;case _0:o=16,n=null;break e}throw Error(Dr(130,t==null?t:typeof t,""))}return e=bd(o,r,e,a),e.elementType=t,e.type=n,e.lanes=s,e}function Tp(t,e,r,n){return t=bd(7,t,n,e),t.lanes=r,t}function uj(t,e,r,n){return t=bd(22,t,n,e),t.elementType=SW,t.lanes=r,t.stateNode={isHidden:!1},t}function m4(t,e,r){return t=bd(6,t,null,e),t.lanes=r,t}function p4(t,e,r){return e=bd(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function pAe(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=X3(0),this.expirationTimes=X3(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=X3(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function AD(t,e,r,n,a,s,o,l,c){return t=new pAe(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=bd(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},YO(s),t}function gAe(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ox,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function xY(t){if(!t)return gm;t=t._reactInternals;e:{if(Ig(t)!==t||t.tag!==1)throw Error(Dr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(au(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Dr(171))}if(t.tag===1){var r=t.type;if(au(r))return xX(t,r,e)}return e}function vY(t,e,r,n,a,s,o,l,c){return t=AD(r,n,!0,t,a,s,o,l,c),t.context=xY(null),r=t.current,n=Ic(),a=am(r),s=eA(n,a),s.callback=e??null,rm(r,s,a),t.current.lanes=a,dw(t,a,n),su(t,n),t}function dj(t,e,r,n){var a=e.current,s=Ic(),o=am(a);return r=xY(r),e.context===null?e.context=r:e.pendingContext=r,e=eA(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=rm(a,e,o),t!==null&&(mf(t,a,o,s),H_(t,a,o)),o}function YE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function TU(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function mD(t,e){TU(t,e),(t=t.alternate)&&TU(t,e)}function xAe(){return null}var yY=typeof reportError=="function"?reportError:function(t){console.error(t)};function pD(t){this._internalRoot=t}fj.prototype.render=pD.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Dr(409));dj(t,e,null,null)};fj.prototype.unmount=pD.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zp(function(){dj(null,t,null,null)}),e[fA]=null}};function fj(t){this._internalRoot=t}fj.prototype.unstable_scheduleHydration=function(t){if(t){var e=YW();t={blockedOn:null,target:t,priority:e};for(var r=0;r<B0.length&&e!==0&&e<B0[r].priority;r++);B0.splice(r,0,t),r===0&&ZW(t)}};function gD(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hj(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function kU(){}function vAe(t,e,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=YE(o);s.call(u)}}var o=vY(e,n,t,0,null,!1,!1,"",kU);return t._reactRootContainer=o,t[fA]=o.current,Xb(t.nodeType===8?t.parentNode:t),Zp(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=YE(c);l.call(u)}}var c=AD(t,0,!1,null,null,!1,!1,"",kU);return t._reactRootContainer=c,t[fA]=c.current,Xb(t.nodeType===8?t.parentNode:t),Zp(function(){dj(e,c,r,n)}),c}function Aj(t,e,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=YE(o);l.call(c)}}dj(e,o,t,a)}else o=vAe(r,e,t,a,n);return YE(o)}WW=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ky(e.pendingLanes);r!==0&&(DO(e,r|1),su(e,Vi()),!(Ca&6)&&(Sv=Vi()+500,Dm()))}break;case 13:Zp(function(){var n=hA(t,1);if(n!==null){var a=Ic();mf(n,t,1,a)}}),mD(t,1)}};RO=function(t){if(t.tag===13){var e=hA(t,134217728);if(e!==null){var r=Ic();mf(e,t,134217728,r)}mD(t,134217728)}};XW=function(t){if(t.tag===13){var e=am(t),r=hA(t,e);if(r!==null){var n=Ic();mf(r,t,e,n)}mD(t,e)}};YW=function(){return ns};JW=function(t,e){var r=ns;try{return ns=t,e()}finally{ns=r}};JB=function(t,e,r){switch(e){case"input":if(KB(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=aj(n);if(!a)throw Error(Dr(90));jW(n),KB(n,a)}}}break;case"textarea":BW(t,r);break;case"select":e=r.value,e!=null&&nv(t,!!r.multiple,e,!1)}};MW=uD;LW=Zp;var yAe={usingClientEntryPoint:!1,Events:[hw,Ux,aj,DW,RW,uD]},ey={findFiberByHostInstance:yp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bAe={bundleType:ey.bundleType,version:ey.version,rendererPackageName:ey.rendererPackageName,rendererConfig:ey.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:PA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=VW(t),t===null?null:t.stateNode},findFiberByHostInstance:ey.findFiberByHostInstance||xAe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var YN=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!YN.isDisabled&&YN.supportsFiber)try{ej=YN.inject(bAe),rh=YN}catch{}}Ku.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yAe;Ku.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gD(e))throw Error(Dr(200));return gAe(t,e,null,r)};Ku.createRoot=function(t,e){if(!gD(t))throw Error(Dr(299));var r=!1,n="",a=yY;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=AD(t,1,!1,null,null,r,!1,n,a),t[fA]=e.current,Xb(t.nodeType===8?t.parentNode:t),new pD(e)};Ku.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Dr(188)):(t=Object.keys(t).join(","),Error(Dr(268,t)));return t=VW(e),t=t===null?null:t.stateNode,t};Ku.flushSync=function(t){return Zp(t)};Ku.hydrate=function(t,e,r){if(!hj(e))throw Error(Dr(200));return Aj(null,t,e,!0,r)};Ku.hydrateRoot=function(t,e,r){if(!gD(t))throw Error(Dr(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=yY;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=vY(e,null,t,1,r??null,a,!1,s,o),t[fA]=e.current,Xb(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new fj(e)};Ku.render=function(t,e,r){if(!hj(e))throw Error(Dr(200));return Aj(null,t,e,!1,r)};Ku.unmountComponentAtNode=function(t){if(!hj(t))throw Error(Dr(40));return t._reactRootContainer?(Zp(function(){Aj(null,null,t,!1,function(){t._reactRootContainer=null,t[fA]=null})}),!0):!1};Ku.unstable_batchedUpdates=uD;Ku.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!hj(r))throw Error(Dr(200));if(t==null||t._reactInternals===void 0)throw Error(Dr(38));return Aj(t,e,r,!1,n)};Ku.version="18.3.1-next-f1338f8080-20240426";function bY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bY)}catch(t){console.error(t)}}bY(),bW.exports=Ku;var Mu=bW.exports,FU=Mu;MB.createRoot=FU.createRoot,MB.hydrateRoot=FU.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var OU="popstate";function wAe(t={}){function e(n,a){let{pathname:s,search:o,hash:l}=n.location;return BT("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:s2(a)}return CAe(e,r,null,t)}function qs(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function bf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function NAe(){return Math.random().toString(36).substring(2,10)}function DU(t,e){return{usr:t.state,key:t.key,idx:e}}function BT(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?r1(e):e,state:r,key:e&&e.key||n||NAe()}}function s2({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function r1(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function CAe(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let x=d(),v=x==null?null:x-u;u=x,c&&c({action:l,location:p.location,delta:v})}function A(x,v){l="PUSH";let y=BT(p.location,x,v);u=d()+1;let b=DU(y,u),w=p.createHref(y);try{o.pushState(b,"",w)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(w)}s&&c&&c({action:l,location:p.location,delta:1})}function h(x,v){l="REPLACE";let y=BT(p.location,x,v);u=d();let b=DU(y,u),w=p.createHref(y);o.replaceState(b,"",w),s&&c&&c({action:l,location:p.location,delta:0})}function m(x){return _Ae(x)}let p={get action(){return l},get location(){return t(a,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(OU,f),c=x,()=>{a.removeEventListener(OU,f),c=null}},createHref(x){return e(a,x)},createURL:m,encodeLocation(x){let v=m(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:A,replace:h,go(x){return o.go(x)}};return p}function _Ae(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),qs(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:s2(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function wY(t,e,r="/"){return EAe(t,e,r,!1)}function EAe(t,e,r,n){let a=typeof e=="string"?r1(e):e,s=mA(a.pathname||"/",r);if(s==null)return null;let o=NY(t);SAe(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=MAe(s);l=DAe(o[c],u,n)}return l}function NY(t,e=[],r=[],n="",a=!1){let s=(o,l,c=a,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;qs(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=tA([n,d.relativePath]),A=r.concat(d);o.children&&o.children.length>0&&(qs(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),NY(o.children,e,A,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:FAe(f,o.index),routesMeta:A})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let u of CY(o.path))s(o,l,!0,u)}),e}function CY(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=CY(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function SAe(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:OAe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var IAe=/^:[\w-]+$/,jAe=3,PAe=2,BAe=1,TAe=10,kAe=-2,RU=t=>t==="*";function FAe(t,e){let r=t.split("/"),n=r.length;return r.some(RU)&&(n+=kAe),e&&(n+=PAe),r.filter(a=>!RU(a)).reduce((a,s)=>a+(IAe.test(s)?jAe:s===""?BAe:TAe),n)}function OAe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function DAe(t,e,r=!1){let{routesMeta:n}=t,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=JE({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),A=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=JE({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:tA([s,f.pathname]),pathnameBase:VAe(tA([s,f.pathnameBase])),route:A}),f.pathnameBase!=="/"&&(s=tA([s,f.pathnameBase]))}return o}function JE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=RAe(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},A)=>{if(d==="*"){let m=l[A]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[A];return f&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function RAe(t,e=!1,r=!0){bf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function MAe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return bf(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function mA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function LAe(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?r1(t):t;return{pathname:r?r.startsWith("/")?r:UAe(r,e):e,search:HAe(n),hash:$Ae(a)}}function UAe(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function g4(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function QAe(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function xD(t){let e=QAe(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function vD(t,e,r,n=!1){let a;typeof t=="string"?a=r1(t):(a={...t},qs(!a.pathname||!a.pathname.includes("?"),g4("?","pathname","search",a)),qs(!a.pathname||!a.pathname.includes("#"),g4("#","pathname","hash",a)),qs(!a.search||!a.search.includes("#"),g4("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let A=o.split("/");for(;A[0]==="..";)A.shift(),f-=1;a.pathname=A.join("/")}l=f>=0?e[f]:"/"}let c=LAe(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var tA=t=>t.join("/").replace(/\/\/+/g,"/"),VAe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),HAe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$Ae=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function KAe(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var _Y=["POST","PUT","PATCH","DELETE"];new Set(_Y);var GAe=["GET",..._Y];new Set(GAe);var n1=g.createContext(null);n1.displayName="DataRouter";var mj=g.createContext(null);mj.displayName="DataRouterState";g.createContext(!1);var EY=g.createContext({isTransitioning:!1});EY.displayName="ViewTransition";var qAe=g.createContext(new Map);qAe.displayName="Fetchers";var zAe=g.createContext(null);zAe.displayName="Await";var _f=g.createContext(null);_f.displayName="Navigation";var mw=g.createContext(null);mw.displayName="Location";var Ef=g.createContext({outlet:null,matches:[],isDataRoute:!1});Ef.displayName="Route";var yD=g.createContext(null);yD.displayName="RouteError";function WAe(t,{relative:e}={}){qs(a1(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=g.useContext(_f),{hash:a,pathname:s,search:o}=gw(t,{relative:e}),l=s;return r!=="/"&&(l=s==="/"?r:tA([r,s])),n.createHref({pathname:l,search:o,hash:a})}function a1(){return g.useContext(mw)!=null}function BA(){return qs(a1(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(mw).location}var SY="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function IY(t){g.useContext(_f).static||g.useLayoutEffect(t)}function pw(){let{isDataRoute:t}=g.useContext(Ef);return t?u0e():XAe()}function XAe(){qs(a1(),"useNavigate() may be used only in the context of a <Router> component.");let t=g.useContext(n1),{basename:e,navigator:r}=g.useContext(_f),{matches:n}=g.useContext(Ef),{pathname:a}=BA(),s=JSON.stringify(xD(n)),o=g.useRef(!1);return IY(()=>{o.current=!0}),g.useCallback((c,u={})=>{if(bf(o.current,SY),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=vD(c,JSON.parse(s),a,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:tA([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,s,a,t])}var YAe=g.createContext(null);function JAe(t){let e=g.useContext(Ef).outlet;return e&&g.createElement(YAe.Provider,{value:t},e)}function gw(t,{relative:e}={}){let{matches:r}=g.useContext(Ef),{pathname:n}=BA(),a=JSON.stringify(xD(r));return g.useMemo(()=>vD(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function ZAe(t,e){return jY(t,e)}function jY(t,e,r,n){var v;qs(a1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(_f),{matches:s}=g.useContext(Ef),o=s[s.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let y=d&&d.path||"";PY(c,!d||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let f=BA(),A;if(e){let y=typeof e=="string"?r1(e):e;qs(u==="/"||((v=y.pathname)==null?void 0:v.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${y.pathname}" was given in the \`location\` prop.`),A=y}else A=f;let h=A.pathname||"/",m=h;if(u!=="/"){let y=u.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=wY(t,{pathname:m});bf(d||p!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),bf(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=a0e(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:tA([u,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:tA([u,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&x?g.createElement(mw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},x):x}function e0e(){let t=c0e(),e=KAe(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=g.createElement(g.Fragment,null,g.createElement("p",null," Hey developer "),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:s},"ErrorBoundary")," or"," ",g.createElement("code",{style:s},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),r?g.createElement("pre",{style:a},r):null,o)}var t0e=g.createElement(e0e,null),r0e=class extends g.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?g.createElement(Ef.Provider,{value:this.props.routeContext},g.createElement(yD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function n0e({routeContext:t,match:e,children:r}){let n=g.useContext(n1);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(Ef.Provider,{value:t},r)}function a0e(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,s=r==null?void 0:r.errors;if(s!=null){let c=a.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);qs(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<a.length;c++){let u=a[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:f}=r,A=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||A){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,u,d)=>{let f,A=!1,h=null,m=null;r&&(f=s&&u.route.id?s[u.route.id]:void 0,h=u.route.errorElement||t0e,o&&(l<0&&d===0?(PY("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,m=null):l===d&&(A=!0,m=u.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,d+1)),x=()=>{let v;return f?v=h:A?v=m:u.route.Component?v=g.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=c,g.createElement(n0e,{match:u,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:v})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?g.createElement(r0e,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function bD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function s0e(t){let e=g.useContext(n1);return qs(e,bD(t)),e}function i0e(t){let e=g.useContext(mj);return qs(e,bD(t)),e}function o0e(t){let e=g.useContext(Ef);return qs(e,bD(t)),e}function wD(t){let e=o0e(t),r=e.matches[e.matches.length-1];return qs(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function l0e(){return wD("useRouteId")}function c0e(){var n;let t=g.useContext(yD),e=i0e("useRouteError"),r=wD("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function u0e(){let{router:t}=s0e("useNavigate"),e=wD("useNavigate"),r=g.useRef(!1);return IY(()=>{r.current=!0}),g.useCallback(async(a,s={})=>{bf(r.current,SY),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var MU={};function PY(t,e,r){!e&&!MU[t]&&(MU[t]=!0,bf(!1,r))}g.memo(d0e);function d0e({routes:t,future:e,state:r}){return jY(t,void 0,r,e)}function Dh({to:t,replace:e,state:r,relative:n}){qs(a1(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(_f);bf(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=g.useContext(Ef),{pathname:o}=BA(),l=pw(),c=vD(t,xD(s),o,n==="path"),u=JSON.stringify(c);return g.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function BY(t){return JAe(t.context)}function Un(t){qs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function f0e({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){qs(!a1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=g.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof r=="string"&&(r=r1(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:A="default"}=r,h=g.useMemo(()=>{let m=mA(c,o);return m==null?null:{location:{pathname:m,search:u,hash:d,state:f,key:A},navigationType:n}},[o,c,u,d,f,A,n]);return bf(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:g.createElement(_f.Provider,{value:l},g.createElement(mw.Provider,{children:e,value:h}))}function h0e({children:t,location:e}){return ZAe(TT(t),e)}function TT(t,e=[]){let r=[];return g.Children.forEach(t,(n,a)=>{if(!g.isValidElement(n))return;let s=[...e,a];if(n.type===g.Fragment){r.push.apply(r,TT(n.props.children,s));return}qs(n.type===Un,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),qs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=TT(n.props.children,s)),r.push(o)}),r}var X_="get",Y_="application/x-www-form-urlencoded";function pj(t){return t!=null&&typeof t.tagName=="string"}function A0e(t){return pj(t)&&t.tagName.toLowerCase()==="button"}function m0e(t){return pj(t)&&t.tagName.toLowerCase()==="form"}function p0e(t){return pj(t)&&t.tagName.toLowerCase()==="input"}function g0e(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function x0e(t,e){return t.button===0&&(!e||e==="_self")&&!g0e(t)}var JN=null;function v0e(){if(JN===null)try{new FormData(document.createElement("form"),0),JN=!1}catch{JN=!0}return JN}var y0e=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function x4(t){return t!=null&&!y0e.has(t)?(bf(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Y_}"`),null):t}function b0e(t,e){let r,n,a,s,o;if(m0e(t)){let l=t.getAttribute("action");n=l?mA(l,e):null,r=t.getAttribute("method")||X_,a=x4(t.getAttribute("enctype"))||Y_,s=new FormData(t)}else if(A0e(t)||p0e(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?mA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||X_,a=x4(t.getAttribute("formenctype"))||x4(l.getAttribute("enctype"))||Y_,s=new FormData(l,t),!v0e()){let{name:u,type:d,value:f}=t;if(d==="image"){let A=u?`${u}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else u&&s.append(u,f)}}else{if(pj(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=X_,n=null,a=Y_,o=t}return s&&a==="text/plain"&&(o=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ND(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function w0e(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&mA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function N0e(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function C0e(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function _0e(t,e,r){let n=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await N0e(s,r);return o.links?o.links():[]}return[]}));return j0e(n.flat(1).filter(C0e).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function LU(t,e,r,n,a,s){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):s==="data"?e.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let A=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function E0e(t,e,{includeHydrateFallback:r}={}){return S0e(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function S0e(t){return[...new Set(t)]}function I0e(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function j0e(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let s=JSON.stringify(I0e(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function TY(){let t=g.useContext(n1);return ND(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function P0e(){let t=g.useContext(mj);return ND(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var CD=g.createContext(void 0);CD.displayName="FrameworkContext";function kY(){let t=g.useContext(CD);return ND(t,"You must render this element inside a <HydratedRouter> element"),t}function B0e(t,e){let r=g.useContext(CD),[n,a]=g.useState(!1),[s,o]=g.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=e,A=g.useRef(null);g.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=v=>{v.forEach(y=>{o(y.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return A.current&&x.observe(A.current),()=>{x.disconnect()}}},[t]),g.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{a(!0)},m=()=>{a(!1),o(!1)};return r?t!=="intent"?[s,A,{}]:[s,A,{onFocus:ty(l,h),onBlur:ty(c,m),onMouseEnter:ty(u,h),onMouseLeave:ty(d,m),onTouchStart:ty(f,h)}]:[!1,A,{}]}function ty(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function T0e({page:t,...e}){let{router:r}=TY(),n=g.useMemo(()=>wY(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?g.createElement(F0e,{page:t,matches:n,...e}):null}function k0e(t){let{manifest:e,routeModules:r}=kY(),[n,a]=g.useState([]);return g.useEffect(()=>{let s=!1;return _0e(t,e,r).then(o=>{s||a(o)}),()=>{s=!0}},[t,e,r]),n}function F0e({page:t,matches:e,...r}){let n=BA(),{manifest:a,routeModules:s}=kY(),{basename:o}=TY(),{loaderData:l,matches:c}=P0e(),u=g.useMemo(()=>LU(t,e,c,a,n,"data"),[t,e,c,a,n]),d=g.useMemo(()=>LU(t,e,c,a,n,"assets"),[t,e,c,a,n]),f=g.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(v=>{var b;let y=a.routes[v.route.id];!y||!y.hasLoader||(!u.some(w=>w.route.id===v.route.id)&&v.route.id in l&&((b=s[v.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(v.route.id))}),m.size===0)return[];let x=w0e(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[x.pathname+x.search]},[o,l,n,a,u,e,t,s]),A=g.useMemo(()=>E0e(d,a),[d,a]),h=k0e(d);return g.createElement(g.Fragment,null,f.map(m=>g.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),A.map(m=>g.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>g.createElement("link",{key:m,nonce:r.nonce,...p})))}function O0e(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var FY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{FY&&(window.__reactRouterVersion="7.8.1")}catch{}function D0e({basename:t,children:e,window:r}){let n=g.useRef();n.current==null&&(n.current=wAe({window:r,v5Compat:!0}));let a=n.current,[s,o]=g.useState({action:a.action,location:a.location}),l=g.useCallback(c=>{g.startTransition(()=>o(c))},[o]);return g.useLayoutEffect(()=>a.listen(l),[a,l]),g.createElement(f0e,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var OY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DY=g.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...A},h){let{basename:m}=g.useContext(_f),p=typeof u=="string"&&OY.test(u),x,v=!1;if(typeof u=="string"&&p&&(x=u,FY))try{let E=new URL(window.location.href),B=u.startsWith("//")?new URL(E.protocol+u):new URL(u),k=mA(B.pathname,m);B.origin===E.origin&&k!=null?u=k+B.search+B.hash:v=!0}catch{bf(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=WAe(u,{relative:a}),[b,w,j]=B0e(n,A),I=L0e(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:f});function _(E){e&&e(E),E.defaultPrevented||I(E)}let S=g.createElement("a",{...A,...j,href:x||y,onClick:v||s?e:_,ref:O0e(h,w),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?g.createElement(g.Fragment,null,S,g.createElement(T0e,{page:y})):S});DY.displayName="Link";var Nn=g.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:o,viewTransition:l,children:c,...u},d){let f=gw(o,{relative:u.relative}),A=BA(),h=g.useContext(mj),{navigator:m,basename:p}=g.useContext(_f),x=h!=null&&$0e(f)&&l===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=A.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=mA(b,p)||b);const w=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let j=y===v||!a&&y.startsWith(v)&&y.charAt(w)==="/",I=b!=null&&(b===v||!a&&b.startsWith(v)&&b.charAt(v.length)==="/"),_={isActive:j,isPending:I,isTransitioning:x},S=j?e:void 0,E;typeof n=="function"?E=n(_):E=[n,j?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let B=typeof s=="function"?s(_):s;return g.createElement(DY,{...u,"aria-current":S,className:E,ref:d,style:B,to:o,viewTransition:l},typeof c=="function"?c(_):c)});Nn.displayName="NavLink";var R0e=g.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:s,method:o=X_,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...A},h)=>{let m=V0e(),p=H0e(l,{relative:u}),x=o.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&OY.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let w=b.nativeEvent.submitter,j=(w==null?void 0:w.getAttribute("formmethod"))||o;m(w||b.currentTarget,{fetcherKey:e,method:j,navigate:r,replace:a,state:s,relative:u,preventScrollReset:d,viewTransition:f})};return g.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:y,...A,"data-discover":!v&&t==="render"?"true":void 0})});R0e.displayName="Form";function M0e(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RY(t){let e=g.useContext(n1);return qs(e,M0e(t)),e}function L0e(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:o}={}){let l=pw(),c=BA(),u=gw(t,{relative:s});return g.useCallback(d=>{if(x0e(d,e)){d.preventDefault();let f=r!==void 0?r:s2(c)===s2(u);l(t,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,u,r,n,e,t,a,s,o])}var U0e=0,Q0e=()=>`__${String(++U0e)}__`;function V0e(){let{router:t}=RY("useSubmit"),{basename:e}=g.useContext(_f),r=l0e();return g.useCallback(async(n,a={})=>{let{action:s,method:o,encType:l,formData:c,body:u}=b0e(n,e);if(a.navigate===!1){let d=a.fetcherKey||Q0e();await t.fetch(d,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function H0e(t,{relative:e}={}){let{basename:r}=g.useContext(_f),n=g.useContext(Ef);qs(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...gw(t||".",{relative:e})},o=BA();if(t==null){s.search=o.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();s.search=d?`?${d}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:tA([r,s.pathname])),s2(s)}function $0e(t,{relative:e}={}){let r=g.useContext(EY);qs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=RY("useViewTransitionState"),a=gw(t,{relative:e});if(!r.isTransitioning)return!1;let s=mA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=mA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return JE(a.pathname,o)!=null||JE(a.pathname,s)!=null}function Sn(t,e){if(!t)return!1;const r=String(e);if(Array.isArray(t))return t.map(String).includes(r);const n=String(t);return n===r||n==="vendedor"&&r==="vendedor_pollo"}var UU={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MY=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},K0e=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[r++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[r++],o=t[r++],l=t[r++],c=((a&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|o&63)}}return e.join("")},LY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const s=t[a],o=a+1<t.length,l=o?t[a+1]:0,c=a+2<t.length,u=c?t[a+2]:0,d=s>>2,f=(s&3)<<4|l>>4;let A=(l&15)<<2|u>>6,h=u&63;c||(h=64,o||(A=64)),n.push(r[d],r[f],r[A],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(MY(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):K0e(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const s=r[t.charAt(a++)],l=a<t.length?r[t.charAt(a)]:0;++a;const u=a<t.length?r[t.charAt(a)]:64;++a;const f=a<t.length?r[t.charAt(a)]:64;if(++a,s==null||l==null||u==null||f==null)throw new G0e;const A=s<<2|l>>4;if(n.push(A),u!==64){const h=l<<4&240|u>>2;if(n.push(h),f!==64){const m=u<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class G0e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const q0e=function(t){const e=MY(t);return LY.encodeByteArray(e,!0)},ZE=function(t){return q0e(t).replace(/\./g,"")},UY=function(t){try{return LY.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0e=()=>z0e().__FIREBASE_DEFAULTS__,X0e=()=>{if(typeof process>"u"||typeof UU>"u")return;const t=UU.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Y0e=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&UY(t[1]);return e&&JSON.parse(e)},gj=()=>{try{return W0e()||X0e()||Y0e()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},QY=t=>{var e,r;return(r=(e=gj())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},J0e=t=>{const e=QY(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},VY=()=>{var t;return(t=gj())===null||t===void 0?void 0:t.config},HY=t=>{var e;return(e=gj())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eme(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ZE(JSON.stringify(r)),ZE(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fo())}function rme(){var t;const e=(t=gj())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nme(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ame(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ime(){const t=Fo();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function $Y(){return!rme()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KY(){try{return typeof indexedDB=="object"}catch{return!1}}function ome(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lme="FirebaseError";class TA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=lme,Object.setPrototypeOf(this,TA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xw.prototype.create)}}class xw{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],o=s?cme(s,n):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new TA(a,l,n)}}function cme(t,e){return t.replace(ume,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const ume=/\{\$([^}]+)}/g;function dme(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function i2(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const s=t[a],o=e[a];if(QU(s)&&QU(o)){if(!i2(s,o))return!1}else if(s!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function QU(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Oy(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,s]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(s)}}),e}function Dy(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function fme(t,e){const r=new hme(t,e);return r.subscribe.bind(r)}class hme{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Ame(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=v4),a.error===void 0&&(a.error=v4),a.complete===void 0&&(a.complete=v4);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ame(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function v4(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(t){return t&&t._delegate?t._delegate:t}class eg{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mme=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Z0e;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gme(e))try{this.getOrInitializeService({instanceIdentifier:ip})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=ip){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ip){return this.instances.has(e)}getOptions(e=ip){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const o=this.instances.get(a);return o&&e(o,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:pme(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ip){return this.component?this.component.multipleInstances?e:ip:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function pme(t){return t===ip?void 0:t}function gme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xme{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new mme(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ha;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ha||(ha={}));const vme={debug:ha.DEBUG,verbose:ha.VERBOSE,info:ha.INFO,warn:ha.WARN,error:ha.ERROR,silent:ha.SILENT},yme=ha.INFO,bme={[ha.DEBUG]:"log",[ha.VERBOSE]:"log",[ha.INFO]:"info",[ha.WARN]:"warn",[ha.ERROR]:"error"},wme=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=bme[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let _D=class{constructor(e){this.name=e,this._logLevel=yme,this._logHandler=wme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ha))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ha.DEBUG,...e),this._logHandler(this,ha.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ha.VERBOSE,...e),this._logHandler(this,ha.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ha.INFO,...e),this._logHandler(this,ha.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ha.WARN,...e),this._logHandler(this,ha.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ha.ERROR,...e),this._logHandler(this,ha.ERROR,...e)}};const Nme=(t,e)=>e.some(r=>t instanceof r);let VU,HU;function Cme(){return VU||(VU=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _me(){return HU||(HU=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GY=new WeakMap,kT=new WeakMap,qY=new WeakMap,y4=new WeakMap,ED=new WeakMap;function Eme(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{r(im(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&GY.set(r,t)}).catch(()=>{}),ED.set(e,t),e}function Sme(t){if(kT.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});kT.set(t,e)}let FT={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return kT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||qY.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return im(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ime(t){FT=t(FT)}function jme(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(b4(this),e,...r);return qY.set(n,e.sort?e.sort():[e]),im(n)}:_me().includes(t)?function(...e){return t.apply(b4(this),e),im(GY.get(this))}:function(...e){return im(t.apply(b4(this),e))}}function Pme(t){return typeof t=="function"?jme(t):(t instanceof IDBTransaction&&Sme(t),Nme(t,Cme())?new Proxy(t,FT):t)}function im(t){if(t instanceof IDBRequest)return Eme(t);if(y4.has(t))return y4.get(t);const e=Pme(t);return e!==t&&(y4.set(t,e),ED.set(e,t)),e}const b4=t=>ED.get(t);function Bme(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const o=indexedDB.open(t,e),l=im(o);return n&&o.addEventListener("upgradeneeded",c=>{n(im(o.result),c.oldVersion,c.newVersion,im(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Tme=["get","getKey","getAll","getAllKeys","count"],kme=["put","add","delete","clear"],w4=new Map;function $U(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(w4.get(e))return w4.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=kme.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||Tme.includes(r)))return;const s=async function(o,...l){const c=this.transaction(o,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),a&&c.done]))[0]};return w4.set(e,s),s}Ime(t=>({...t,get:(e,r,n)=>$U(e,r)||t.get(e,r,n),has:(e,r)=>!!$U(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Ome(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Ome(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const OT="@firebase/app",KU="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=new _D("@firebase/app"),Dme="@firebase/app-compat",Rme="@firebase/analytics-compat",Mme="@firebase/analytics",Lme="@firebase/app-check-compat",Ume="@firebase/app-check",Qme="@firebase/auth",Vme="@firebase/auth-compat",Hme="@firebase/database",$me="@firebase/data-connect",Kme="@firebase/database-compat",Gme="@firebase/functions",qme="@firebase/functions-compat",zme="@firebase/installations",Wme="@firebase/installations-compat",Xme="@firebase/messaging",Yme="@firebase/messaging-compat",Jme="@firebase/performance",Zme="@firebase/performance-compat",epe="@firebase/remote-config",tpe="@firebase/remote-config-compat",rpe="@firebase/storage",npe="@firebase/storage-compat",ape="@firebase/firestore",spe="@firebase/vertexai-preview",ipe="@firebase/firestore-compat",ope="firebase",lpe="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="[DEFAULT]",cpe={[OT]:"fire-core",[Dme]:"fire-core-compat",[Mme]:"fire-analytics",[Rme]:"fire-analytics-compat",[Ume]:"fire-app-check",[Lme]:"fire-app-check-compat",[Qme]:"fire-auth",[Vme]:"fire-auth-compat",[Hme]:"fire-rtdb",[$me]:"fire-data-connect",[Kme]:"fire-rtdb-compat",[Gme]:"fire-fn",[qme]:"fire-fn-compat",[zme]:"fire-iid",[Wme]:"fire-iid-compat",[Xme]:"fire-fcm",[Yme]:"fire-fcm-compat",[Jme]:"fire-perf",[Zme]:"fire-perf-compat",[epe]:"fire-rc",[tpe]:"fire-rc-compat",[rpe]:"fire-gcs",[npe]:"fire-gcs-compat",[ape]:"fire-fst",[ipe]:"fire-fst-compat",[spe]:"fire-vertex","fire-js":"fire-js",[ope]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv=new Map,RT=new Map,MT=new Map;function GU(t,e){try{t.container.addComponent(e)}catch(r){pA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function jv(t){const e=t.name;if(MT.has(e))return pA.debug(`There were multiple attempts to register component ${e}.`),!1;MT.set(e,t);for(const r of Iv.values())GU(r,t);for(const r of RT.values())GU(r,t);return!0}function SD(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Wf(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const upe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},om=new xw("app","Firebase",upe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dpe{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new eg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw om.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=lpe;function ID(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:DT,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw om.create("bad-app-name",{appName:String(a)});if(r||(r=VY()),!r)throw om.create("no-options");const s=Iv.get(a);if(s){if(i2(r,s.options)&&i2(n,s.config))return s;throw om.create("duplicate-app",{appName:a})}const o=new xme(a);for(const c of MT.values())o.addComponent(c);const l=new dpe(r,n,o);return Iv.set(a,l),l}function jD(t=DT){const e=Iv.get(t);if(!e&&t===DT&&VY())return ID();if(!e)throw om.create("no-app",{appName:t});return e}async function fpe(t){let e=!1;const r=t.name;Iv.has(r)?(e=!0,Iv.delete(r)):RT.has(r)&&t.decRefCount()<=0&&(RT.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function lm(t,e,r){var n;let a=(n=cpe[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const s=a.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${a}" with version "${e}":`];s&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pA.warn(l.join(" "));return}jv(new eg(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hpe="firebase-heartbeat-database",Ape=1,o2="firebase-heartbeat-store";let N4=null;function zY(){return N4||(N4=Bme(hpe,Ape,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(o2)}catch(r){console.warn(r)}}}}).catch(t=>{throw om.create("idb-open",{originalErrorMessage:t.message})})),N4}async function mpe(t){try{const r=(await zY()).transaction(o2),n=await r.objectStore(o2).get(WY(t));return await r.done,n}catch(e){if(e instanceof TA)pA.warn(e.message);else{const r=om.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pA.warn(r.message)}}}async function qU(t,e){try{const n=(await zY()).transaction(o2,"readwrite");await n.objectStore(o2).put(e,WY(t)),await n.done}catch(r){if(r instanceof TA)pA.warn(r.message);else{const n=om.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});pA.warn(n.message)}}}function WY(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ppe=1024,gpe=30*24*60*60*1e3;class xpe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new ype(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zU();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=gpe}),this._storage.overwrite(this._heartbeatsCache))}catch(n){pA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=zU(),{heartbeatsToSend:n,unsentEntries:a}=vpe(this._heartbeatsCache.heartbeats),s=ZE(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return pA.warn(r),""}}}function zU(){return new Date().toISOString().substring(0,10)}function vpe(t,e=ppe){const r=[];let n=t.slice();for(const a of t){const s=r.find(o=>o.agent===a.agent);if(s){if(s.dates.push(a.date),WU(r)>e){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),WU(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class ype{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KY()?ome().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await mpe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return qU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return qU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function WU(t){return ZE(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bpe(t){jv(new eg("platform-logger",e=>new Fme(e),"PRIVATE")),jv(new eg("heartbeat",e=>new xpe(e),"PRIVATE")),lm(OT,KU,t),lm(OT,KU,"esm2017"),lm("fire-js","")}bpe("");function PD(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function XY(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wpe=XY,YY=new xw("auth","Firebase",XY());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=new _D("@firebase/auth");function Npe(t,...e){eS.logLevel<=ha.WARN&&eS.warn(`Auth (${s1}): ${t}`,...e)}function J_(t,...e){eS.logLevel<=ha.ERROR&&eS.error(`Auth (${s1}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(t,...e){throw BD(t,...e)}function ah(t,...e){return BD(t,...e)}function JY(t,e,r){const n=Object.assign(Object.assign({},wpe()),{[e]:r});return new xw("auth","Firebase",n).create(e,{appName:t.name})}function rA(t){return JY(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function BD(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return YY.create(t,...e)}function Rn(t,e,...r){if(!t)throw BD(e,...r)}function Gh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw J_(e),new Error(e)}function gA(t,e){t||Gh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Cpe(){return XU()==="http:"||XU()==="https:"}function XU(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _pe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Cpe()||ame()||"connection"in navigator)?navigator.onLine:!0}function Epe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,r){this.shortDelay=e,this.longDelay=r,gA(r>e,"Short delay should be less than long delay!"),this.isMobile=tme()||sme()}get(){return _pe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(t,e){gA(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZY{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Spe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ipe=new yw(3e4,6e4);function kA(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function FA(t,e,r,n,a={}){return eJ(t,a,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=vw(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return nme()||(u.referrerPolicy="no-referrer"),ZY.fetch()(tJ(t,t.config.apiHost,r,l),u)})}async function eJ(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Spe),e);try{const a=new Ppe(t),s=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw ZN(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ZN(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ZN(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw ZN(t,"user-disabled",o);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw JY(t,d,u);wf(t,d)}}catch(a){if(a instanceof TA)throw a;wf(t,"network-request-failed",{message:String(a)})}}async function bw(t,e,r,n,a={}){const s=await FA(t,e,r,n,a);return"mfaPendingCredential"in s&&wf(t,"multi-factor-auth-required",{_serverResponse:s}),s}function tJ(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?TD(t.config,a):`${t.config.apiScheme}://${a}`}function jpe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ppe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ah(this.auth,"network-request-failed")),Ipe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ZN(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=ah(t,e,n);return a.customData._tokenResponse=r,a}function YU(t){return t!==void 0&&t.enterprise!==void 0}class Bpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return jpe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Tpe(t,e){return FA(t,"GET","/v2/recaptchaConfig",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kpe(t,e){return FA(t,"POST","/v1/accounts:delete",e)}async function rJ(t,e){return FA(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Fpe(t,e=!1){const r=fi(t),n=await r.getIdToken(e),a=kD(n);Rn(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:fb(C4(a.auth_time)),issuedAtTime:fb(C4(a.iat)),expirationTime:fb(C4(a.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function C4(t){return Number(t)*1e3}function kD(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return J_("JWT malformed, contained fewer than 3 sections"),null;try{const a=UY(r);return a?JSON.parse(a):(J_("Failed to decode base64 JWT payload"),null)}catch(a){return J_("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function JU(t){const e=kD(t);return Rn(e,"internal-error"),Rn(typeof e.exp<"u","internal-error"),Rn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l2(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof TA&&Ope(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Ope({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dpe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=fb(this.lastLoginAt),this.creationTime=fb(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tS(t){var e;const r=t.auth,n=await t.getIdToken(),a=await l2(t,rJ(r,{idToken:n}));Rn(a==null?void 0:a.users.length,r,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?nJ(s.providerUserInfo):[],l=Mpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new UT(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function Rpe(t){const e=fi(t);await tS(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Mpe(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function nJ(t){return t.map(e=>{var{providerId:r}=e,n=PD(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lpe(t,e){const r=await eJ(t,{},async()=>{const n=vw({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,o=tJ(t,a,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",ZY.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Upe(t,e){return FA(t,"POST","/v2/accounts:revokeToken",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rn(e.idToken,"internal-error"),Rn(typeof e.idToken<"u","internal-error"),Rn(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):JU(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Rn(e.length!==0,"internal-error");const r=JU(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Rn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:s}=await Lpe(e,r);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:s}=r,o=new cv;return n&&(Rn(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(Rn(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),s&&(Rn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cv,this.toJSON())}_performRefresh(){return Gh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(t,e){Rn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qh{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,s=PD(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Dpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new UT(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await l2(this,this.stsTokenManager.getToken(this.auth,e));return Rn(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Fpe(this,e)}reload(){return Rpe(this)}_assign(e){this!==e&&(Rn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new qh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Rn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await tS(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Wf(this.auth.app))return Promise.reject(rA(this.auth));const e=await this.getIdToken();return await l2(this,kpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,s,o,l,c,u,d;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,A=(a=r.email)!==null&&a!==void 0?a:void 0,h=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=r.createdAt)!==null&&u!==void 0?u:void 0,y=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:b,emailVerified:w,isAnonymous:j,providerData:I,stsTokenManager:_}=r;Rn(b&&_,e,"internal-error");const S=cv.fromJSON(this.name,_);Rn(typeof b=="string",e,"internal-error"),o0(f,e.name),o0(A,e.name),Rn(typeof w=="boolean",e,"internal-error"),Rn(typeof j=="boolean",e,"internal-error"),o0(h,e.name),o0(m,e.name),o0(p,e.name),o0(x,e.name),o0(v,e.name),o0(y,e.name);const E=new qh({uid:b,auth:e,email:A,emailVerified:w,displayName:f,isAnonymous:j,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:v,lastLoginAt:y});return I&&Array.isArray(I)&&(E.providerData=I.map(B=>Object.assign({},B))),x&&(E._redirectEventId=x),E}static async _fromIdTokenResponse(e,r,n=!1){const a=new cv;a.updateFromServerResponse(r);const s=new qh({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await tS(s),s}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];Rn(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?nJ(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),l=new cv;l.updateFromIdToken(n);const c=new qh({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new UT(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZU=new Map;function zh(t){gA(t instanceof Function,"Expected a class definition");let e=ZU.get(t);return e?(gA(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ZU.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}aJ.type="NONE";const e7=aJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(t,e,r){return`firebase:${t}:${e}:${r}`}class uv{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=Z_(this.userKey,a.apiKey,s),this.fullPersistenceKey=Z_("persistence",a.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new uv(zh(e7),e,n);const a=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=a[0]||zh(e7);const o=Z_(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(o);if(d){const f=qh._fromJSON(e,d);u!==s&&(l=f),s=u;break}}catch{}const c=a.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new uv(s,e,n):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new uv(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t7(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uJ(e))return"Blackberry";if(dJ(e))return"Webos";if(iJ(e))return"Safari";if((e.includes("chrome/")||oJ(e))&&!e.includes("edge/"))return"Chrome";if(cJ(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function sJ(t=Fo()){return/firefox\//i.test(t)}function iJ(t=Fo()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function oJ(t=Fo()){return/crios\//i.test(t)}function lJ(t=Fo()){return/iemobile/i.test(t)}function cJ(t=Fo()){return/android/i.test(t)}function uJ(t=Fo()){return/blackberry/i.test(t)}function dJ(t=Fo()){return/webos/i.test(t)}function FD(t=Fo()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Qpe(t=Fo()){var e;return FD(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Vpe(){return ime()&&document.documentMode===10}function fJ(t=Fo()){return FD(t)||cJ(t)||dJ(t)||uJ(t)||/windows phone/i.test(t)||lJ(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hJ(t,e=[]){let r;switch(t){case"Browser":r=t7(Fo());break;case"Worker":r=`${t7(Fo())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${s1}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hpe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $pe(t,e={}){return FA(t,"GET","/v2/passwordPolicy",kA(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kpe=6;class Gpe{constructor(e){var r,n,a,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:Kpe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(a=c.containsLowercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qpe{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new r7(this),this.idTokenSubscription=new r7(this),this.beforeStateQueue=new Hpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=YY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=zh(r)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await uv.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await rJ(this,{idToken:e}),n=await qh._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Wf(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=a==null?void 0:a._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(a=c.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Rn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await tS(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Epe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Wf(this.app))return Promise.reject(rA(this));const r=e?fi(e):null;return r&&Rn(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Rn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Wf(this.app)?Promise.reject(rA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Wf(this.app)?Promise.reject(rA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $pe(this),r=new Gpe(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xw("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Upe(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&zh(e)||this._popupRedirectResolver;Rn(r,this,"argument-error"),this.redirectPersistenceManager=await uv.create(this,[zh(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rn(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,a);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Npe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Rm(t){return fi(t)}class r7{constructor(e){this.auth=e,this.observer=null,this.addObserver=fme(r=>this.observer=r)}get next(){return Rn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xj={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zpe(t){xj=t}function AJ(t){return xj.loadJS(t)}function Wpe(){return xj.recaptchaEnterpriseScript}function Xpe(){return xj.gapiScript}function Ype(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const Jpe="recaptcha-enterprise",Zpe="NO_RECAPTCHA";class ege{constructor(e){this.type=Jpe,this.auth=Rm(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Tpe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Bpe(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function a(s,o,l){const c=window.grecaptcha;YU(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(Zpe)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{n(this.auth).then(l=>{if(!r&&YU(window.grecaptcha))a(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Wpe();c.length!==0&&(c+=l),AJ(c).then(()=>{a(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function n7(t,e,r,n=!1){const a=new ege(t);let s;try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function rS(t,e,r,n){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await n7(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await n7(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tge(t,e){const r=SD(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),s=r.getOptions();if(i2(s,e??{}))return a;wf(a,"already-initialized")}return r.initialize({options:e})}function rge(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(zh);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function nge(t,e,r){const n=Rm(t);Rn(n._canInitEmulator,n,"emulator-config-failed"),Rn(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=mJ(e),{host:o,port:l}=age(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${s}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),sge()}function mJ(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function age(t){const e=mJ(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:a7(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:a7(o)}}}function a7(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function sge(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Gh("not implemented")}_getIdTokenResponse(e){return Gh("not implemented")}_linkToIdToken(e,r){return Gh("not implemented")}_getReauthenticationResolver(e){return Gh("not implemented")}}async function ige(t,e){return FA(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oge(t,e){return bw(t,"POST","/v1/accounts:signInWithPassword",kA(t,e))}async function lge(t,e){return FA(t,"POST","/v1/accounts:sendOobCode",kA(t,e))}async function cge(t,e){return lge(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uge(t,e){return bw(t,"POST","/v1/accounts:signInWithEmailLink",kA(t,e))}async function dge(t,e){return bw(t,"POST","/v1/accounts:signInWithEmailLink",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2 extends OD{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new c2(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new c2(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rS(e,r,"signInWithPassword",oge);case"emailLink":return uge(e,{email:this._email,oobCode:this._password});default:wf(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rS(e,n,"signUpPassword",ige);case"emailLink":return dge(e,{idToken:r,email:this._email,oobCode:this._password});default:wf(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dv(t,e){return bw(t,"POST","/v1/accounts:signInWithIdp",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fge="http://localhost";class tg extends OD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new tg(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):wf("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,s=PD(r,["providerId","signInMethod"]);if(!n||!a)return null;const o=new tg(n,a);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return dv(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,dv(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,dv(e,r)}buildRequest(){const e={requestUri:fge,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=vw(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Age(t){const e=Oy(Dy(t)).link,r=e?Oy(Dy(e)).deep_link_id:null,n=Oy(Dy(t)).deep_link_id;return(n?Oy(Dy(n)).link:null)||n||r||e||t}class DD{constructor(e){var r,n,a,s,o,l;const c=Oy(Dy(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,f=hge((a=c.mode)!==null&&a!==void 0?a:null);Rn(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=Age(e);try{return new DD(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(){this.providerId=i1.PROVIDER_ID}static credential(e,r){return c2._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=DD.parseLink(r);return Rn(n,"argument-error"),c2._fromEmailAndCode(e,n.code,n.tenantId)}}i1.PROVIDER_ID="password";i1.EMAIL_PASSWORD_SIGN_IN_METHOD="password";i1.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pJ{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww extends pJ{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0 extends ww{constructor(){super("facebook.com")}static credential(e){return tg._fromParams({providerId:k0.PROVIDER_ID,signInMethod:k0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return k0.credentialFromTaggedObject(e)}static credentialFromError(e){return k0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return k0.credential(e.oauthAccessToken)}catch{return null}}}k0.FACEBOOK_SIGN_IN_METHOD="facebook.com";k0.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0 extends ww{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return tg._fromParams({providerId:F0.PROVIDER_ID,signInMethod:F0.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return F0.credentialFromTaggedObject(e)}static credentialFromError(e){return F0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return F0.credential(r,n)}catch{return null}}}F0.GOOGLE_SIGN_IN_METHOD="google.com";F0.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends ww{constructor(){super("github.com")}static credential(e){return tg._fromParams({providerId:O0.PROVIDER_ID,signInMethod:O0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return O0.credentialFromTaggedObject(e)}static credentialFromError(e){return O0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return O0.credential(e.oauthAccessToken)}catch{return null}}}O0.GITHUB_SIGN_IN_METHOD="github.com";O0.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0 extends ww{constructor(){super("twitter.com")}static credential(e,r){return tg._fromParams({providerId:D0.PROVIDER_ID,signInMethod:D0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return D0.credentialFromTaggedObject(e)}static credentialFromError(e){return D0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return D0.credential(r,n)}catch{return null}}}D0.TWITTER_SIGN_IN_METHOD="twitter.com";D0.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mge(t,e){return bw(t,"POST","/v1/accounts:signUp",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const s=await qh._fromIdTokenResponse(e,n,a),o=s7(n);return new rg({user:s,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=s7(n);return new rg({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function s7(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS extends TA{constructor(e,r,n,a){var s;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,nS.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new nS(e,r,n,a)}}function gJ(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?nS._fromErrorAndOperation(t,s,e,n):s})}async function pge(t,e,r=!1){const n=await l2(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return rg._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gge(t,e,r=!1){const{auth:n}=t;if(Wf(n.app))return Promise.reject(rA(n));const a="reauthenticate";try{const s=await l2(t,gJ(n,a,e,t),r);Rn(s.idToken,n,"internal-error");const o=kD(s.idToken);Rn(o,n,"internal-error");const{sub:l}=o;return Rn(t.uid===l,n,"user-mismatch"),rg._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&wf(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xJ(t,e,r=!1){if(Wf(t.app))return Promise.reject(rA(t));const n="signIn",a=await gJ(t,n,e),s=await rg._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(s.user),s}async function xge(t,e){return xJ(Rm(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vJ(t){const e=Rm(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function vge(t,e,r){const n=Rm(t);await rS(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",cge)}async function yge(t,e,r){if(Wf(t.app))return Promise.reject(rA(t));const n=Rm(t),o=await rS(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mge).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&vJ(t),c}),l=await rg._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function bge(t,e,r){return Wf(t.app)?Promise.reject(rA(t)):xge(fi(t),i1.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&vJ(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(t,e){return fi(t).setPersistence(e)}function wge(t,e,r,n){return fi(t).onIdTokenChanged(e,r,n)}function Nge(t,e,r){return fi(t).beforeAuthStateChanged(e,r)}function vj(t,e,r,n){return fi(t).onAuthStateChanged(e,r,n)}function RD(t){return fi(t).signOut()}const aS="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yJ{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(aS,"1"),this.storage.removeItem(aS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cge=1e3,_ge=10;class bJ extends yJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);Vpe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,_ge):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Cge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}bJ.type="LOCAL";const MD=bJ;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ extends yJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}wJ.type="SESSION";const LD=wJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ege(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new yj(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:s}=r.data,o=this.handlersMap[a];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const l=Array.from(o).map(async u=>u(r.origin,s)),c=await Ege(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yj.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UD(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=UD("",20);a.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(f){const A=f;if(A.data.eventId===u)switch(A.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(A.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(){return window}function Ige(t){sh().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NJ(){return typeof sh().WorkerGlobalScope<"u"&&typeof sh().importScripts=="function"}async function jge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Pge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Bge(){return NJ()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CJ="firebaseLocalStorageDb",Tge=1,sS="firebaseLocalStorage",_J="fbase_key";class Nw{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function bj(t,e){return t.transaction([sS],e?"readwrite":"readonly").objectStore(sS)}function kge(){const t=indexedDB.deleteDatabase(CJ);return new Nw(t).toPromise()}function QT(){const t=indexedDB.open(CJ,Tge);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(sS,{keyPath:_J})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(sS)?e(n):(n.close(),await kge(),e(await QT()))})})}async function i7(t,e,r){const n=bj(t,!0).put({[_J]:e,value:r});return new Nw(n).toPromise()}async function Fge(t,e){const r=bj(t,!1).get(e),n=await new Nw(r).toPromise();return n===void 0?null:n.value}function o7(t,e){const r=bj(t,!0).delete(e);return new Nw(r).toPromise()}const Oge=800,Dge=3;class EJ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await QT(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Dge)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return NJ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yj._getInstance(Bge()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await jge(),!this.activeServiceWorker)return;this.sender=new Sge(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Pge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await QT();return await i7(e,aS,"1"),await o7(e,aS),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>i7(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Fge(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>o7(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=bj(a,!1).getAll();return new Nw(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Oge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}EJ.type="LOCAL";const SJ=EJ;new yw(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rge(t,e){return e?zh(e):(Rn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD extends OD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return dv(e,this._buildIdpRequest())}_linkToIdToken(e,r){return dv(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return dv(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Mge(t){return xJ(t.auth,new QD(t),t.bypassAuthState)}function Lge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),gge(r,new QD(t),t.bypassAuthState)}async function Uge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),pge(r,new QD(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(e,r,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mge;case"linkViaPopup":case"linkViaRedirect":return Uge;case"reauthViaPopup":case"reauthViaRedirect":return Lge;default:wf(this.auth,"internal-error")}}resolve(e){gA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qge=new yw(2e3,1e4);class qx extends IJ{constructor(e,r,n,a,s){super(e,r,a,s),this.provider=n,this.authWindow=null,this.pollId=null,qx.currentPopupAction&&qx.currentPopupAction.cancel(),qx.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rn(e,this.auth,"internal-error"),e}async onExecution(){gA(this.filter.length===1,"Popup operations only handle one event");const e=UD();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ah(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ah(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qx.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ah(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Qge.get())};e()}}qx.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vge="pendingRedirect",tE=new Map;class Hge extends IJ{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=tE.get(this.auth._key());if(!e){try{const n=await $ge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}tE.set(this.auth._key(),e)}return this.bypassAuthState||tE.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function $ge(t,e){const r=qge(e),n=Gge(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function Kge(t,e){tE.set(t._key(),e)}function Gge(t){return zh(t._redirectPersistence)}function qge(t){return Z_(Vge,t.config.apiKey,t.name)}async function zge(t,e,r=!1){if(Wf(t.app))return Promise.reject(rA(t));const n=Rm(t),a=Rge(n,e),o=await new Hge(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wge=10*60*1e3;class Xge{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Yge(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!jJ(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ah(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Wge&&this.cachedEventUids.clear(),this.cachedEventUids.has(l7(e))}saveEventToCache(e){this.cachedEventUids.add(l7(e)),this.lastProcessedEventTime=Date.now()}}function l7(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function jJ({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Yge(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jJ(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jge(t,e={}){return FA(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zge=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,exe=/^https?/;async function txe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Jge(t);for(const r of e)try{if(rxe(r))return}catch{}wf(t,"unauthorized-domain")}function rxe(t){const e=LT(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!exe.test(r))return!1;if(Zge.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nxe=new yw(3e4,6e4);function c7(){const t=sh().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function axe(t){return new Promise((e,r)=>{var n,a,s;function o(){c7(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{c7(),r(ah(t,"network-request-failed"))},timeout:nxe.get()})}if(!((a=(n=sh().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=sh().gapi)===null||s===void 0)&&s.load)o();else{const l=Ype("iframefcb");return sh()[l]=()=>{gapi.load?o():r(ah(t,"network-request-failed"))},AJ(`${Xpe()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw rE=null,e})}let rE=null;function sxe(t){return rE=rE||axe(t),rE}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ixe=new yw(5e3,15e3),oxe="__/auth/iframe",lxe="emulator/auth/iframe",cxe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uxe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dxe(t){const e=t.config;Rn(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?TD(e,lxe):`https://${t.config.authDomain}/${oxe}`,n={apiKey:e.apiKey,appName:t.name,v:s1},a=uxe.get(t.config.apiHost);a&&(n.eid=a);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${vw(n).slice(1)}`}async function fxe(t){const e=await sxe(t),r=sh().gapi;return Rn(r,t,"internal-error"),e.open({where:document.body,url:dxe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cxe,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const o=ah(t,"network-request-failed"),l=sh().setTimeout(()=>{s(o)},ixe.get());function c(){sh().clearTimeout(l),a(n)}n.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hxe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Axe=500,mxe=600,pxe="_blank",gxe="http://localhost";class u7{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xxe(t,e,r,n=Axe,a=mxe){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},hxe),{width:n.toString(),height:a.toString(),top:s,left:o}),u=Fo().toLowerCase();r&&(l=oJ(u)?pxe:r),sJ(u)&&(e=e||gxe,c.scrollbars="yes");const d=Object.entries(c).reduce((A,[h,m])=>`${A}${h}=${m},`,"");if(Qpe(u)&&l!=="_self")return vxe(e||"",l),new u7(null);const f=window.open(e||"",l,d);Rn(f,t,"popup-blocked");try{f.focus()}catch{}return new u7(f)}function vxe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yxe="__/auth/handler",bxe="emulator/auth/handler",wxe=encodeURIComponent("fac");async function d7(t,e,r,n,a,s){Rn(t.config.authDomain,t,"auth-domain-config-required"),Rn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:s1,eventId:a};if(e instanceof pJ){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",dme(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof ww){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${wxe}=${encodeURIComponent(c)}`:"";return`${Nxe(t)}?${vw(l).slice(1)}${u}`}function Nxe({config:t}){return t.emulator?TD(t,bxe):`https://${t.authDomain}/${yxe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4="webStorageSupport";class Cxe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=LD,this._completeRedirectFn=zge,this._overrideRedirectResult=Kge}async _openPopup(e,r,n,a){var s;gA((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await d7(e,r,n,LT(),a);return xxe(e,o,UD())}async _openRedirect(e,r,n,a){await this._originValidation(e);const s=await d7(e,r,n,LT(),a);return Ige(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:s}=this.eventManagers[r];return a?Promise.resolve(a):(gA(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await fxe(e),n=new Xge(e);return r.register("authEvent",a=>(Rn(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(_4,{type:_4},a=>{var s;const o=(s=a==null?void 0:a[0])===null||s===void 0?void 0:s[_4];o!==void 0&&r(!!o),wf(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=txe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return fJ()||iJ()||FD()}}const _xe=Cxe;var f7="@firebase/auth",h7="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Exe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Rn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sxe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ixe(t){jv(new eg("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Rn(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hJ(t)},u=new qpe(n,a,s,c);return rge(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),jv(new eg("auth-internal",e=>{const r=Rm(e.getProvider("auth").getImmediate());return(n=>new Exe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),lm(f7,h7,Sxe(t)),lm(f7,h7,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jxe=5*60,Pxe=HY("authIdTokenMaxAge")||jxe;let A7=null;const Bxe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Pxe)return;const a=r==null?void 0:r.token;A7!==a&&(A7=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function VT(t=jD()){const e=SD(t,"auth");if(e.isInitialized())return e.getImmediate();const r=tge(t,{popupRedirectResolver:_xe,persistence:[SJ,MD,LD]}),n=HY("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=Bxe(s.toString());Nge(r,o,()=>o(r.currentUser)),wge(r,l=>o(l))}}const a=QY("auth");return a&&nge(r,`http://${a}`),r}function Txe(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}zpe({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const s=ah("internal-error");s.customData=a,r(s)},n.type="text/javascript",n.charset="UTF-8",Txe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ixe("Browser");var kxe="firebase",Fxe="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lm(kxe,Fxe,"app");var m7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kp,PJ;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,S){function E(){}E.prototype=S.prototype,_.D=S.prototype,_.prototype=new E,_.prototype.constructor=_,_.C=function(B,k,P){for(var O=Array(arguments.length-2),z=2;z<arguments.length;z++)O[z-2]=arguments[z];return S.prototype[k].apply(B,O)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(_,S,E){E||(E=0);var B=Array(16);if(typeof S=="string")for(var k=0;16>k;++k)B[k]=S.charCodeAt(E++)|S.charCodeAt(E++)<<8|S.charCodeAt(E++)<<16|S.charCodeAt(E++)<<24;else for(k=0;16>k;++k)B[k]=S[E++]|S[E++]<<8|S[E++]<<16|S[E++]<<24;S=_.g[0],E=_.g[1],k=_.g[2];var P=_.g[3],O=S+(P^E&(k^P))+B[0]+3614090360&4294967295;S=E+(O<<7&4294967295|O>>>25),O=P+(k^S&(E^k))+B[1]+3905402710&4294967295,P=S+(O<<12&4294967295|O>>>20),O=k+(E^P&(S^E))+B[2]+606105819&4294967295,k=P+(O<<17&4294967295|O>>>15),O=E+(S^k&(P^S))+B[3]+3250441966&4294967295,E=k+(O<<22&4294967295|O>>>10),O=S+(P^E&(k^P))+B[4]+4118548399&4294967295,S=E+(O<<7&4294967295|O>>>25),O=P+(k^S&(E^k))+B[5]+1200080426&4294967295,P=S+(O<<12&4294967295|O>>>20),O=k+(E^P&(S^E))+B[6]+2821735955&4294967295,k=P+(O<<17&4294967295|O>>>15),O=E+(S^k&(P^S))+B[7]+4249261313&4294967295,E=k+(O<<22&4294967295|O>>>10),O=S+(P^E&(k^P))+B[8]+1770035416&4294967295,S=E+(O<<7&4294967295|O>>>25),O=P+(k^S&(E^k))+B[9]+2336552879&4294967295,P=S+(O<<12&4294967295|O>>>20),O=k+(E^P&(S^E))+B[10]+4294925233&4294967295,k=P+(O<<17&4294967295|O>>>15),O=E+(S^k&(P^S))+B[11]+2304563134&4294967295,E=k+(O<<22&4294967295|O>>>10),O=S+(P^E&(k^P))+B[12]+1804603682&4294967295,S=E+(O<<7&4294967295|O>>>25),O=P+(k^S&(E^k))+B[13]+4254626195&4294967295,P=S+(O<<12&4294967295|O>>>20),O=k+(E^P&(S^E))+B[14]+2792965006&4294967295,k=P+(O<<17&4294967295|O>>>15),O=E+(S^k&(P^S))+B[15]+1236535329&4294967295,E=k+(O<<22&4294967295|O>>>10),O=S+(k^P&(E^k))+B[1]+4129170786&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^k&(S^E))+B[6]+3225465664&4294967295,P=S+(O<<9&4294967295|O>>>23),O=k+(S^E&(P^S))+B[11]+643717713&4294967295,k=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(k^P))+B[0]+3921069994&4294967295,E=k+(O<<20&4294967295|O>>>12),O=S+(k^P&(E^k))+B[5]+3593408605&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^k&(S^E))+B[10]+38016083&4294967295,P=S+(O<<9&4294967295|O>>>23),O=k+(S^E&(P^S))+B[15]+3634488961&4294967295,k=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(k^P))+B[4]+3889429448&4294967295,E=k+(O<<20&4294967295|O>>>12),O=S+(k^P&(E^k))+B[9]+568446438&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^k&(S^E))+B[14]+3275163606&4294967295,P=S+(O<<9&4294967295|O>>>23),O=k+(S^E&(P^S))+B[3]+4107603335&4294967295,k=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(k^P))+B[8]+1163531501&4294967295,E=k+(O<<20&4294967295|O>>>12),O=S+(k^P&(E^k))+B[13]+2850285829&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^k&(S^E))+B[2]+4243563512&4294967295,P=S+(O<<9&4294967295|O>>>23),O=k+(S^E&(P^S))+B[7]+1735328473&4294967295,k=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(k^P))+B[12]+2368359562&4294967295,E=k+(O<<20&4294967295|O>>>12),O=S+(E^k^P)+B[5]+4294588738&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^k)+B[8]+2272392833&4294967295,P=S+(O<<11&4294967295|O>>>21),O=k+(P^S^E)+B[11]+1839030562&4294967295,k=P+(O<<16&4294967295|O>>>16),O=E+(k^P^S)+B[14]+4259657740&4294967295,E=k+(O<<23&4294967295|O>>>9),O=S+(E^k^P)+B[1]+2763975236&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^k)+B[4]+1272893353&4294967295,P=S+(O<<11&4294967295|O>>>21),O=k+(P^S^E)+B[7]+4139469664&4294967295,k=P+(O<<16&4294967295|O>>>16),O=E+(k^P^S)+B[10]+3200236656&4294967295,E=k+(O<<23&4294967295|O>>>9),O=S+(E^k^P)+B[13]+681279174&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^k)+B[0]+3936430074&4294967295,P=S+(O<<11&4294967295|O>>>21),O=k+(P^S^E)+B[3]+3572445317&4294967295,k=P+(O<<16&4294967295|O>>>16),O=E+(k^P^S)+B[6]+76029189&4294967295,E=k+(O<<23&4294967295|O>>>9),O=S+(E^k^P)+B[9]+3654602809&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^k)+B[12]+3873151461&4294967295,P=S+(O<<11&4294967295|O>>>21),O=k+(P^S^E)+B[15]+530742520&4294967295,k=P+(O<<16&4294967295|O>>>16),O=E+(k^P^S)+B[2]+3299628645&4294967295,E=k+(O<<23&4294967295|O>>>9),O=S+(k^(E|~P))+B[0]+4096336452&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~k))+B[7]+1126891415&4294967295,P=S+(O<<10&4294967295|O>>>22),O=k+(S^(P|~E))+B[14]+2878612391&4294967295,k=P+(O<<15&4294967295|O>>>17),O=E+(P^(k|~S))+B[5]+4237533241&4294967295,E=k+(O<<21&4294967295|O>>>11),O=S+(k^(E|~P))+B[12]+1700485571&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~k))+B[3]+2399980690&4294967295,P=S+(O<<10&4294967295|O>>>22),O=k+(S^(P|~E))+B[10]+4293915773&4294967295,k=P+(O<<15&4294967295|O>>>17),O=E+(P^(k|~S))+B[1]+2240044497&4294967295,E=k+(O<<21&4294967295|O>>>11),O=S+(k^(E|~P))+B[8]+1873313359&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~k))+B[15]+4264355552&4294967295,P=S+(O<<10&4294967295|O>>>22),O=k+(S^(P|~E))+B[6]+2734768916&4294967295,k=P+(O<<15&4294967295|O>>>17),O=E+(P^(k|~S))+B[13]+1309151649&4294967295,E=k+(O<<21&4294967295|O>>>11),O=S+(k^(E|~P))+B[4]+4149444226&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~k))+B[11]+3174756917&4294967295,P=S+(O<<10&4294967295|O>>>22),O=k+(S^(P|~E))+B[2]+718787259&4294967295,k=P+(O<<15&4294967295|O>>>17),O=E+(P^(k|~S))+B[9]+3951481745&4294967295,_.g[0]=_.g[0]+S&4294967295,_.g[1]=_.g[1]+(k+(O<<21&4294967295|O>>>11))&4294967295,_.g[2]=_.g[2]+k&4294967295,_.g[3]=_.g[3]+P&4294967295}n.prototype.u=function(_,S){S===void 0&&(S=_.length);for(var E=S-this.blockSize,B=this.B,k=this.h,P=0;P<S;){if(k==0)for(;P<=E;)a(this,_,P),P+=this.blockSize;if(typeof _=="string"){for(;P<S;)if(B[k++]=_.charCodeAt(P++),k==this.blockSize){a(this,B),k=0;break}}else for(;P<S;)if(B[k++]=_[P++],k==this.blockSize){a(this,B),k=0;break}}this.h=k,this.o+=S},n.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var S=1;S<_.length-8;++S)_[S]=0;var E=8*this.o;for(S=_.length-8;S<_.length;++S)_[S]=E&255,E/=256;for(this.u(_),_=Array(16),S=E=0;4>S;++S)for(var B=0;32>B;B+=8)_[E++]=this.g[S]>>>B&255;return _};function s(_,S){var E=l;return Object.prototype.hasOwnProperty.call(E,_)?E[_]:E[_]=S(_)}function o(_,S){this.h=S;for(var E=[],B=!0,k=_.length-1;0<=k;k--){var P=_[k]|0;B&&P==S||(E[k]=P,B=!1)}this.g=E}var l={};function c(_){return-128<=_&&128>_?s(_,function(S){return new o([S|0],0>S?-1:0)}):new o([_|0],0>_?-1:0)}function u(_){if(isNaN(_)||!isFinite(_))return f;if(0>_)return x(u(-_));for(var S=[],E=1,B=0;_>=E;B++)S[B]=_/E|0,E*=4294967296;return new o(S,0)}function d(_,S){if(_.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(_.charAt(0)=="-")return x(d(_.substring(1),S));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(S,8)),B=f,k=0;k<_.length;k+=8){var P=Math.min(8,_.length-k),O=parseInt(_.substring(k,k+P),S);8>P?(P=u(Math.pow(S,P)),B=B.j(P).add(u(O))):(B=B.j(E),B=B.add(u(O)))}return B}var f=c(0),A=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var _=0,S=1,E=0;E<this.g.length;E++){var B=this.i(E);_+=(0<=B?B:4294967296+B)*S,S*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(m(this))return"0";if(p(this))return"-"+x(this).toString(_);for(var S=u(Math.pow(_,6)),E=this,B="";;){var k=w(E,S).g;E=v(E,k.j(S));var P=((0<E.g.length?E.g[0]:E.h)>>>0).toString(_);if(E=k,m(E))return P+B;for(;6>P.length;)P="0"+P;B=P+B}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function m(_){if(_.h!=0)return!1;for(var S=0;S<_.g.length;S++)if(_.g[S]!=0)return!1;return!0}function p(_){return _.h==-1}t.l=function(_){return _=v(this,_),p(_)?-1:m(_)?0:1};function x(_){for(var S=_.g.length,E=[],B=0;B<S;B++)E[B]=~_.g[B];return new o(E,~_.h).add(A)}t.abs=function(){return p(this)?x(this):this},t.add=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0,k=0;k<=S;k++){var P=B+(this.i(k)&65535)+(_.i(k)&65535),O=(P>>>16)+(this.i(k)>>>16)+(_.i(k)>>>16);B=O>>>16,P&=65535,O&=65535,E[k]=O<<16|P}return new o(E,E[E.length-1]&-2147483648?-1:0)};function v(_,S){return _.add(x(S))}t.j=function(_){if(m(this)||m(_))return f;if(p(this))return p(_)?x(this).j(x(_)):x(x(this).j(_));if(p(_))return x(this.j(x(_)));if(0>this.l(h)&&0>_.l(h))return u(this.m()*_.m());for(var S=this.g.length+_.g.length,E=[],B=0;B<2*S;B++)E[B]=0;for(B=0;B<this.g.length;B++)for(var k=0;k<_.g.length;k++){var P=this.i(B)>>>16,O=this.i(B)&65535,z=_.i(k)>>>16,oe=_.i(k)&65535;E[2*B+2*k]+=O*oe,y(E,2*B+2*k),E[2*B+2*k+1]+=P*oe,y(E,2*B+2*k+1),E[2*B+2*k+1]+=O*z,y(E,2*B+2*k+1),E[2*B+2*k+2]+=P*z,y(E,2*B+2*k+2)}for(B=0;B<S;B++)E[B]=E[2*B+1]<<16|E[2*B];for(B=S;B<2*S;B++)E[B]=0;return new o(E,0)};function y(_,S){for(;(_[S]&65535)!=_[S];)_[S+1]+=_[S]>>>16,_[S]&=65535,S++}function b(_,S){this.g=_,this.h=S}function w(_,S){if(m(S))throw Error("division by zero");if(m(_))return new b(f,f);if(p(_))return S=w(x(_),S),new b(x(S.g),x(S.h));if(p(S))return S=w(_,x(S)),new b(x(S.g),S.h);if(30<_.g.length){if(p(_)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var E=A,B=S;0>=B.l(_);)E=j(E),B=j(B);var k=I(E,1),P=I(B,1);for(B=I(B,2),E=I(E,2);!m(B);){var O=P.add(B);0>=O.l(_)&&(k=k.add(E),P=O),B=I(B,1),E=I(E,1)}return S=v(_,k.j(S)),new b(k,S)}for(k=f;0<=_.l(S);){for(E=Math.max(1,Math.floor(_.m()/S.m())),B=Math.ceil(Math.log(E)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),P=u(E),O=P.j(S);p(O)||0<O.l(_);)E-=B,P=u(E),O=P.j(S);m(P)&&(P=A),k=k.add(P),_=v(_,O)}return new b(k,_)}t.A=function(_){return w(this,_).h},t.and=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)&_.i(B);return new o(E,this.h&_.h)},t.or=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)|_.i(B);return new o(E,this.h|_.h)},t.xor=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)^_.i(B);return new o(E,this.h^_.h)};function j(_){for(var S=_.g.length+1,E=[],B=0;B<S;B++)E[B]=_.i(B)<<1|_.i(B-1)>>>31;return new o(E,_.h)}function I(_,S){var E=S>>5;S%=32;for(var B=_.g.length-E,k=[],P=0;P<B;P++)k[P]=0<S?_.i(P+E)>>>S|_.i(P+E+1)<<32-S:_.i(P+E);return new o(k,_.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,PJ=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,kp=o}).apply(typeof m7<"u"?m7:typeof self<"u"?self:typeof window<"u"?window:{});var eC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BJ,Ry,TJ,nE,HT,kJ,FJ,OJ;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(C,Y,ve){return C==Array.prototype||C==Object.prototype||(C[Y]=ve.value),C};function r(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof eC=="object"&&eC];for(var Y=0;Y<C.length;++Y){var ve=C[Y];if(ve&&ve.Math==Math)return ve}throw Error("Cannot find global object")}var n=r(this);function a(C,Y){if(Y)e:{var ve=n;C=C.split(".");for(var et=0;et<C.length-1;et++){var Kt=C[et];if(!(Kt in ve))break e;ve=ve[Kt]}C=C[C.length-1],et=ve[C],Y=Y(et),Y!=et&&Y!=null&&e(ve,C,{configurable:!0,writable:!0,value:Y})}}function s(C,Y){C instanceof String&&(C+="");var ve=0,et=!1,Kt={next:function(){if(!et&&ve<C.length){var rr=ve++;return{value:Y(rr,C[rr]),done:!1}}return et=!0,{done:!0,value:void 0}}};return Kt[Symbol.iterator]=function(){return Kt},Kt}a("Array.prototype.values",function(C){return C||function(){return s(this,function(Y,ve){return ve})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(C){var Y=typeof C;return Y=Y!="object"?Y:C?Array.isArray(C)?"array":Y:"null",Y=="array"||Y=="object"&&typeof C.length=="number"}function u(C){var Y=typeof C;return Y=="object"&&C!=null||Y=="function"}function d(C,Y,ve){return C.call.apply(C.bind,arguments)}function f(C,Y,ve){if(!C)throw Error();if(2<arguments.length){var et=Array.prototype.slice.call(arguments,2);return function(){var Kt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Kt,et),C.apply(Y,Kt)}}return function(){return C.apply(Y,arguments)}}function A(C,Y,ve){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,A.apply(null,arguments)}function h(C,Y){var ve=Array.prototype.slice.call(arguments,1);return function(){var et=ve.slice();return et.push.apply(et,arguments),C.apply(this,et)}}function m(C,Y){function ve(){}ve.prototype=Y.prototype,C.aa=Y.prototype,C.prototype=new ve,C.prototype.constructor=C,C.Qb=function(et,Kt,rr){for(var Lr=Array(arguments.length-2),ma=2;ma<arguments.length;ma++)Lr[ma-2]=arguments[ma];return Y.prototype[Kt].apply(et,Lr)}}function p(C){const Y=C.length;if(0<Y){const ve=Array(Y);for(let et=0;et<Y;et++)ve[et]=C[et];return ve}return[]}function x(C,Y){for(let ve=1;ve<arguments.length;ve++){const et=arguments[ve];if(c(et)){const Kt=C.length||0,rr=et.length||0;C.length=Kt+rr;for(let Lr=0;Lr<rr;Lr++)C[Kt+Lr]=et[Lr]}else C.push(et)}}class v{constructor(Y,ve){this.i=Y,this.j=ve,this.h=0,this.g=null}get(){let Y;return 0<this.h?(this.h--,Y=this.g,this.g=Y.next,Y.next=null):Y=this.i(),Y}}function y(C){return/^[\s\xa0]*$/.test(C)}function b(){var C=l.navigator;return C&&(C=C.userAgent)?C:""}function w(C){return w[" "](C),C}w[" "]=function(){};var j=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function I(C,Y,ve){for(const et in C)Y.call(ve,C[et],et,C)}function _(C,Y){for(const ve in C)Y.call(void 0,C[ve],ve,C)}function S(C){const Y={};for(const ve in C)Y[ve]=C[ve];return Y}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(C,Y){let ve,et;for(let Kt=1;Kt<arguments.length;Kt++){et=arguments[Kt];for(ve in et)C[ve]=et[ve];for(let rr=0;rr<E.length;rr++)ve=E[rr],Object.prototype.hasOwnProperty.call(et,ve)&&(C[ve]=et[ve])}}function k(C){var Y=1;C=C.split(":");const ve=[];for(;0<Y&&C.length;)ve.push(C.shift()),Y--;return C.length&&ve.push(C.join(":")),ve}function P(C){l.setTimeout(()=>{throw C},0)}function O(){var C=ne;let Y=null;return C.g&&(Y=C.g,C.g=C.g.next,C.g||(C.h=null),Y.next=null),Y}class z{constructor(){this.h=this.g=null}add(Y,ve){const et=oe.get();et.set(Y,ve),this.h?this.h.next=et:this.g=et,this.h=et}}var oe=new v(()=>new ce,C=>C.reset());class ce{constructor(){this.next=this.g=this.h=null}set(Y,ve){this.h=Y,this.g=ve,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,ge=!1,ne=new z,Oe=()=>{const C=l.Promise.resolve(void 0);ue=()=>{C.then(Ue)}};var Ue=()=>{for(var C;C=O();){try{C.h.call(C.g)}catch(ve){P(ve)}var Y=oe;Y.j(C),100>Y.h&&(Y.h++,C.next=Y.g,Y.g=C)}ge=!1};function F(){this.s=this.s,this.C=this.C}F.prototype.s=!1,F.prototype.ma=function(){this.s||(this.s=!0,this.N())},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(C,Y){this.type=C,this.g=this.target=Y,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var C=!1,Y=Object.defineProperty({},"passive",{get:function(){C=!0}});try{const ve=()=>{};l.addEventListener("test",ve,Y),l.removeEventListener("test",ve,Y)}catch{}return C}();function U(C,Y){if(H.call(this,C?C.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,C){var ve=this.type=C.type,et=C.changedTouches&&C.changedTouches.length?C.changedTouches[0]:null;if(this.target=C.target||C.srcElement,this.g=Y,Y=C.relatedTarget){if(j){e:{try{w(Y.nodeName);var Kt=!0;break e}catch{}Kt=!1}Kt||(Y=null)}}else ve=="mouseover"?Y=C.fromElement:ve=="mouseout"&&(Y=C.toElement);this.relatedTarget=Y,et?(this.clientX=et.clientX!==void 0?et.clientX:et.pageX,this.clientY=et.clientY!==void 0?et.clientY:et.pageY,this.screenX=et.screenX||0,this.screenY=et.screenY||0):(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0),this.button=C.button,this.key=C.key||"",this.ctrlKey=C.ctrlKey,this.altKey=C.altKey,this.shiftKey=C.shiftKey,this.metaKey=C.metaKey,this.pointerId=C.pointerId||0,this.pointerType=typeof C.pointerType=="string"?C.pointerType:W[C.pointerType]||"",this.state=C.state,this.i=C,C.defaultPrevented&&U.aa.h.call(this)}}m(U,H);var W={2:"touch",3:"pen",4:"mouse"};U.prototype.h=function(){U.aa.h.call(this);var C=this.i;C.preventDefault?C.preventDefault():C.returnValue=!1};var X="closure_listenable_"+(1e6*Math.random()|0),D=0;function V(C,Y,ve,et,Kt){this.listener=C,this.proxy=null,this.src=Y,this.type=ve,this.capture=!!et,this.ha=Kt,this.key=++D,this.da=this.fa=!1}function Z(C){C.da=!0,C.listener=null,C.proxy=null,C.src=null,C.ha=null}function be(C){this.src=C,this.g={},this.h=0}be.prototype.add=function(C,Y,ve,et,Kt){var rr=C.toString();C=this.g[rr],C||(C=this.g[rr]=[],this.h++);var Lr=Xe(C,Y,et,Kt);return-1<Lr?(Y=C[Lr],ve||(Y.fa=!1)):(Y=new V(Y,this.src,rr,!!et,Kt),Y.fa=ve,C.push(Y)),Y};function L(C,Y){var ve=Y.type;if(ve in C.g){var et=C.g[ve],Kt=Array.prototype.indexOf.call(et,Y,void 0),rr;(rr=0<=Kt)&&Array.prototype.splice.call(et,Kt,1),rr&&(Z(Y),C.g[ve].length==0&&(delete C.g[ve],C.h--))}}function Xe(C,Y,ve,et){for(var Kt=0;Kt<C.length;++Kt){var rr=C[Kt];if(!rr.da&&rr.listener==Y&&rr.capture==!!ve&&rr.ha==et)return Kt}return-1}var re="closure_lm_"+(1e6*Math.random()|0),J={};function De(C,Y,ve,et,Kt){if(Array.isArray(Y)){for(var rr=0;rr<Y.length;rr++)De(C,Y[rr],ve,et,Kt);return null}return ve=Qt(ve),C&&C[X]?C.K(Y,ve,u(et)?!!et.capture:!1,Kt):ie(C,Y,ve,!1,et,Kt)}function ie(C,Y,ve,et,Kt,rr){if(!Y)throw Error("Invalid event type");var Lr=u(Kt)?!!Kt.capture:!!Kt,ma=Ot(C);if(ma||(C[re]=ma=new be(C)),ve=ma.add(Y,ve,et,Lr,rr),ve.proxy)return ve;if(et=He(),ve.proxy=et,et.src=C,et.listener=ve,C.addEventListener)K||(Kt=Lr),Kt===void 0&&(Kt=!1),C.addEventListener(Y.toString(),et,Kt);else if(C.attachEvent)C.attachEvent(_t(Y.toString()),et);else if(C.addListener&&C.removeListener)C.addListener(et);else throw Error("addEventListener and attachEvent are unavailable.");return ve}function He(){function C(ve){return Y.call(C.src,C.listener,ve)}const Y=Bt;return C}function Ge(C,Y,ve,et,Kt){if(Array.isArray(Y))for(var rr=0;rr<Y.length;rr++)Ge(C,Y[rr],ve,et,Kt);else et=u(et)?!!et.capture:!!et,ve=Qt(ve),C&&C[X]?(C=C.i,Y=String(Y).toString(),Y in C.g&&(rr=C.g[Y],ve=Xe(rr,ve,et,Kt),-1<ve&&(Z(rr[ve]),Array.prototype.splice.call(rr,ve,1),rr.length==0&&(delete C.g[Y],C.h--)))):C&&(C=Ot(C))&&(Y=C.g[Y.toString()],C=-1,Y&&(C=Xe(Y,ve,et,Kt)),(ve=-1<C?Y[C]:null)&&dt(ve))}function dt(C){if(typeof C!="number"&&C&&!C.da){var Y=C.src;if(Y&&Y[X])L(Y.i,C);else{var ve=C.type,et=C.proxy;Y.removeEventListener?Y.removeEventListener(ve,et,C.capture):Y.detachEvent?Y.detachEvent(_t(ve),et):Y.addListener&&Y.removeListener&&Y.removeListener(et),(ve=Ot(Y))?(L(ve,C),ve.h==0&&(ve.src=null,Y[re]=null)):Z(C)}}}function _t(C){return C in J?J[C]:J[C]="on"+C}function Bt(C,Y){if(C.da)C=!0;else{Y=new U(Y,this);var ve=C.listener,et=C.ha||C.src;C.fa&&dt(C),C=ve.call(et,Y)}return C}function Ot(C){return C=C[re],C instanceof be?C:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qt(C){return typeof C=="function"?C:(C[jt]||(C[jt]=function(Y){return C.handleEvent(Y)}),C[jt])}function Ft(){F.call(this),this.i=new be(this),this.M=this,this.F=null}m(Ft,F),Ft.prototype[X]=!0,Ft.prototype.removeEventListener=function(C,Y,ve,et){Ge(this,C,Y,ve,et)};function $e(C,Y){var ve,et=C.F;if(et)for(ve=[];et;et=et.F)ve.push(et);if(C=C.M,et=Y.type||Y,typeof Y=="string")Y=new H(Y,C);else if(Y instanceof H)Y.target=Y.target||C;else{var Kt=Y;Y=new H(et,C),B(Y,Kt)}if(Kt=!0,ve)for(var rr=ve.length-1;0<=rr;rr--){var Lr=Y.g=ve[rr];Kt=Fe(Lr,et,!0,Y)&&Kt}if(Lr=Y.g=C,Kt=Fe(Lr,et,!0,Y)&&Kt,Kt=Fe(Lr,et,!1,Y)&&Kt,ve)for(rr=0;rr<ve.length;rr++)Lr=Y.g=ve[rr],Kt=Fe(Lr,et,!1,Y)&&Kt}Ft.prototype.N=function(){if(Ft.aa.N.call(this),this.i){var C=this.i,Y;for(Y in C.g){for(var ve=C.g[Y],et=0;et<ve.length;et++)Z(ve[et]);delete C.g[Y],C.h--}}this.F=null},Ft.prototype.K=function(C,Y,ve,et){return this.i.add(String(C),Y,!1,ve,et)},Ft.prototype.L=function(C,Y,ve,et){return this.i.add(String(C),Y,!0,ve,et)};function Fe(C,Y,ve,et){if(Y=C.i.g[String(Y)],!Y)return!0;Y=Y.concat();for(var Kt=!0,rr=0;rr<Y.length;++rr){var Lr=Y[rr];if(Lr&&!Lr.da&&Lr.capture==ve){var ma=Lr.listener,ei=Lr.ha||Lr.src;Lr.fa&&L(C.i,Lr),Kt=ma.call(ei,et)!==!1&&Kt}}return Kt&&!et.defaultPrevented}function Ze(C,Y,ve){if(typeof C=="function")ve&&(C=A(C,ve));else if(C&&typeof C.handleEvent=="function")C=A(C.handleEvent,C);else throw Error("Invalid listener argument");return 2147483647<Number(Y)?-1:l.setTimeout(C,Y||0)}function Te(C){C.g=Ze(()=>{C.g=null,C.i&&(C.i=!1,Te(C))},C.l);const Y=C.h;C.h=null,C.m.apply(null,Y)}class ee extends F{constructor(Y,ve){super(),this.m=Y,this.l=ve,this.h=null,this.i=!1,this.g=null}j(Y){this.h=arguments,this.g?this.i=!0:Te(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function me(C){F.call(this),this.h=C,this.g={}}m(me,F);var Re=[];function he(C){I(C.g,function(Y,ve){this.g.hasOwnProperty(ve)&&dt(Y)},C),C.g={}}me.prototype.N=function(){me.aa.N.call(this),he(this)},me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qe=l.JSON.stringify,st=l.JSON.parse,yt=class{stringify(C){return l.JSON.stringify(C,void 0)}parse(C){return l.JSON.parse(C,void 0)}};function pe(){}pe.prototype.h=null;function je(C){return C.h||(C.h=C.i())}function we(){}var Ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xe(){H.call(this,"d")}m(xe,H);function Se(){H.call(this,"c")}m(Se,H);var xt={},Pt=null;function It(){return Pt=Pt||new Ft}xt.La="serverreachability";function Ut(C){H.call(this,xt.La,C)}m(Ut,H);function Ht(C){const Y=It();$e(Y,new Ut(Y))}xt.STAT_EVENT="statevent";function Le(C,Y){H.call(this,xt.STAT_EVENT,C),this.stat=Y}m(Le,H);function Ce(C){const Y=It();$e(Y,new Le(Y,C))}xt.Ma="timingevent";function Ae(C,Y){H.call(this,xt.Ma,C),this.size=Y}m(Ae,H);function Qe(C,Y){if(typeof C!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){C()},Y)}function fe(){this.g=!0}fe.prototype.xa=function(){this.g=!1};function te(C,Y,ve,et,Kt,rr){C.info(function(){if(C.g)if(rr)for(var Lr="",ma=rr.split("&"),ei=0;ei<ma.length;ei++){var na=ma[ei].split("=");if(1<na.length){var Sa=na[0];na=na[1];var gs=Sa.split("_");Lr=2<=gs.length&&gs[1]=="type"?Lr+(Sa+"="+na+"&"):Lr+(Sa+"=redacted&")}}else Lr=null;else Lr=rr;return"XMLHTTP REQ ("+et+") [attempt "+Kt+"]: "+Y+`
`+ve+`
`+Lr})}function _e(C,Y,ve,et,Kt,rr,Lr){C.info(function(){return"XMLHTTP RESP ("+et+") [ attempt "+Kt+"]: "+Y+`
`+ve+`
`+rr+" "+Lr})}function R(C,Y,ve,et){C.info(function(){return"XMLHTTP TEXT ("+Y+"): "+G(C,ve)+(et?" "+et:"")})}function Q(C,Y){C.info(function(){return"TIMEOUT: "+Y})}fe.prototype.info=function(){};function G(C,Y){if(!C.g)return Y;if(!Y)return null;try{var ve=JSON.parse(Y);if(ve){for(C=0;C<ve.length;C++)if(Array.isArray(ve[C])){var et=ve[C];if(!(2>et.length)){var Kt=et[1];if(Array.isArray(Kt)&&!(1>Kt.length)){var rr=Kt[0];if(rr!="noop"&&rr!="stop"&&rr!="close")for(var Lr=1;Lr<Kt.length;Lr++)Kt[Lr]=""}}}}return qe(ve)}catch{return Y}}var se={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ne={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Me;function ze(){}m(ze,pe),ze.prototype.g=function(){return new XMLHttpRequest},ze.prototype.i=function(){return{}},Me=new ze;function Ie(C,Y,ve,et){this.j=C,this.i=Y,this.l=ve,this.R=et||1,this.U=new me(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new nt}function nt(){this.i=null,this.g="",this.h=!1}var lt={},ht={};function kt(C,Y,ve){C.L=1,C.v=at(Ir(Y)),C.m=ve,C.P=!0,le(C,null)}function le(C,Y){C.F=Date.now(),ot(C),C.A=Ir(C.v);var ve=C.A,et=C.R;Array.isArray(et)||(et=[String(et)]),ur(ve.i,"t",et),C.C=0,ve=C.j.J,C.h=new nt,C.g=pi(C.j,ve?Y:null,!C.m),0<C.O&&(C.M=new ee(A(C.Y,C,C.g),C.O)),Y=C.U,ve=C.g,et=C.ca;var Kt="readystatechange";Array.isArray(Kt)||(Kt&&(Re[0]=Kt.toString()),Kt=Re);for(var rr=0;rr<Kt.length;rr++){var Lr=De(ve,Kt[rr],et||Y.handleEvent,!1,Y.h||Y);if(!Lr)break;Y.g[Lr.key]=Lr}Y=C.H?S(C.H):{},C.m?(C.u||(C.u="POST"),Y["Content-Type"]="application/x-www-form-urlencoded",C.g.ea(C.A,C.u,C.m,Y)):(C.u="GET",C.g.ea(C.A,C.u,null,Y)),Ht(),te(C.i,C.u,C.A,C.l,C.R,C.m)}Ie.prototype.ca=function(C){C=C.target;const Y=this.M;Y&&ol(C)==3?Y.j():this.Y(C)},Ie.prototype.Y=function(C){try{if(C==this.g)e:{const gs=ol(this.g);var Y=this.g.Ba();const hu=this.g.Z();if(!(3>gs)&&(gs!=3||this.g&&(this.h.h||this.g.oa()||fu(this.g)))){this.J||gs!=4||Y==7||(Y==8||0>=hu?Ht(3):Ht(2)),Rt(this);var ve=this.g.Z();this.X=ve;t:if(We(this)){var et=fu(this.g);C="";var Kt=et.length,rr=ol(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_r(this),nr(this);var Lr="";break t}this.h.i=new l.TextDecoder}for(Y=0;Y<Kt;Y++)this.h.h=!0,C+=this.h.i.decode(et[Y],{stream:!(rr&&Y==Kt-1)});et.length=0,this.h.g+=C,this.C=0,Lr=this.h.g}else Lr=this.g.oa();if(this.o=ve==200,_e(this.i,this.u,this.A,this.l,this.R,gs,ve),this.o){if(this.T&&!this.K){t:{if(this.g){var ma,ei=this.g;if((ma=ei.g?ei.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(ma)){var na=ma;break t}}na=null}if(ve=na)R(this.i,this.l,ve,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$r(this,ve);else{this.o=!1,this.s=3,Ce(12),_r(this),nr(this);break e}}if(this.P){ve=!0;let Dl;for(;!this.J&&this.C<Lr.length;)if(Dl=it(this,Lr),Dl==ht){gs==4&&(this.s=4,Ce(14),ve=!1),R(this.i,this.l,null,"[Incomplete Response]");break}else if(Dl==lt){this.s=4,Ce(15),R(this.i,this.l,Lr,"[Invalid Chunk]"),ve=!1;break}else R(this.i,this.l,Dl,null),$r(this,Dl);if(We(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gs!=4||Lr.length!=0||this.h.h||(this.s=1,Ce(16),ve=!1),this.o=this.o&&ve,!ve)R(this.i,this.l,Lr,"[Invalid Chunked Response]"),_r(this),nr(this);else if(0<Lr.length&&!this.W){this.W=!0;var Sa=this.j;Sa.g==this&&Sa.ba&&!Sa.M&&(Sa.j.info("Great, no buffering proxy detected. Bytes received: "+Lr.length),sn(Sa),Sa.M=!0,Ce(11))}}else R(this.i,this.l,Lr,null),$r(this,Lr);gs==4&&_r(this),this.o&&!this.J&&(gs==4?Vn(this.j,this):(this.o=!1,ot(this)))}else GA(this.g),ve==400&&0<Lr.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),_r(this),nr(this)}}}catch{}finally{}};function We(C){return C.g?C.u=="GET"&&C.L!=2&&C.j.Ca:!1}function it(C,Y){var ve=C.C,et=Y.indexOf(`
`,ve);return et==-1?ht:(ve=Number(Y.substring(ve,et)),isNaN(ve)?lt:(et+=1,et+ve>Y.length?ht:(Y=Y.slice(et,et+ve),C.C=et+ve,Y)))}Ie.prototype.cancel=function(){this.J=!0,_r(this)};function ot(C){C.S=Date.now()+C.I,Nt(C,C.I)}function Nt(C,Y){if(C.B!=null)throw Error("WatchDog timer not null");C.B=Qe(A(C.ba,C),Y)}function Rt(C){C.B&&(l.clearTimeout(C.B),C.B=null)}Ie.prototype.ba=function(){this.B=null;const C=Date.now();0<=C-this.S?(Q(this.i,this.A),this.L!=2&&(Ht(),Ce(17)),_r(this),this.s=2,nr(this)):Nt(this,this.S-C)};function nr(C){C.j.G==0||C.J||Vn(C.j,C)}function _r(C){Rt(C);var Y=C.M;Y&&typeof Y.ma=="function"&&Y.ma(),C.M=null,he(C.U),C.g&&(Y=C.g,C.g=null,Y.abort(),Y.ma())}function $r(C,Y){try{var ve=C.j;if(ve.G!=0&&(ve.g==C||Er(ve.h,C))){if(!C.K&&Er(ve.h,C)&&ve.G==3){try{var et=ve.Da.g.parse(Y)}catch{et=null}if(Array.isArray(et)&&et.length==3){var Kt=et;if(Kt[0]==0){e:if(!ve.u){if(ve.g)if(ve.g.F+3e3<C.F)Tn(ve),fo(ve);else break e;yr(ve),Ce(18)}}else ve.za=Kt[1],0<ve.za-ve.T&&37500>Kt[2]&&ve.F&&ve.v==0&&!ve.C&&(ve.C=Qe(A(ve.Za,ve),6e3));if(1>=rn(ve.h)&&ve.ca){try{ve.ca()}catch{}ve.ca=void 0}}else ka(ve,11)}else if((C.K||ve.g==C)&&Tn(ve),!y(Y))for(Kt=ve.Da.g.parse(Y),Y=0;Y<Kt.length;Y++){let na=Kt[Y];if(ve.T=na[0],na=na[1],ve.G==2)if(na[0]=="c"){ve.K=na[1],ve.ia=na[2];const Sa=na[3];Sa!=null&&(ve.la=Sa,ve.j.info("VER="+ve.la));const gs=na[4];gs!=null&&(ve.Aa=gs,ve.j.info("SVER="+ve.Aa));const hu=na[5];hu!=null&&typeof hu=="number"&&0<hu&&(et=1.5*hu,ve.L=et,ve.j.info("backChannelRequestTimeoutMs_="+et)),et=ve;const Dl=C.g;if(Dl){const cl=Dl.g?Dl.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cl){var rr=et.h;rr.g||cl.indexOf("spdy")==-1&&cl.indexOf("quic")==-1&&cl.indexOf("h2")==-1||(rr.j=rr.l,rr.g=new Set,rr.h&&(Ee(rr,rr.h),rr.h=null))}if(et.D){const $d=Dl.g?Dl.g.getResponseHeader("X-HTTP-Session-Id"):null;$d&&(et.ya=$d,tt(et.I,et.D,$d))}}ve.G=3,ve.l&&ve.l.ua(),ve.ba&&(ve.R=Date.now()-C.F,ve.j.info("Handshake RTT: "+ve.R+"ms")),et=ve;var Lr=C;if(et.qa=Va(et,et.J?et.ia:null,et.W),Lr.K){gt(et.h,Lr);var ma=Lr,ei=et.L;ei&&(ma.I=ei),ma.B&&(Rt(ma),ot(ma)),et.g=Lr}else hr(et);0<ve.i.length&&M(ve)}else na[0]!="stop"&&na[0]!="close"||ka(ve,7);else ve.G==3&&(na[0]=="stop"||na[0]=="close"?na[0]=="stop"?ka(ve,7):Bf(ve):na[0]!="noop"&&ve.l&&ve.l.ta(na),ve.v=0)}}Ht(4)}catch{}}var or=class{constructor(C,Y){this.g=C,this.map=Y}};function kr(C){this.l=C||10,l.PerformanceNavigationTiming?(C=l.performance.getEntriesByType("navigation"),C=0<C.length&&(C[0].nextHopProtocol=="hq"||C[0].nextHopProtocol=="h2")):C=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=C?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function en(C){return C.h?!0:C.g?C.g.size>=C.j:!1}function rn(C){return C.h?1:C.g?C.g.size:0}function Er(C,Y){return C.h?C.h==Y:C.g?C.g.has(Y):!1}function Ee(C,Y){C.g?C.g.add(Y):C.h=Y}function gt(C,Y){C.h&&C.h==Y?C.h=null:C.g&&C.g.has(Y)&&C.g.delete(Y)}kr.prototype.cancel=function(){if(this.i=Zt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const C of this.g.values())C.cancel();this.g.clear()}};function Zt(C){if(C.h!=null)return C.i.concat(C.h.D);if(C.g!=null&&C.g.size!==0){let Y=C.i;for(const ve of C.g.values())Y=Y.concat(ve.D);return Y}return p(C.i)}function Mr(C){if(C.V&&typeof C.V=="function")return C.V();if(typeof Map<"u"&&C instanceof Map||typeof Set<"u"&&C instanceof Set)return Array.from(C.values());if(typeof C=="string")return C.split("");if(c(C)){for(var Y=[],ve=C.length,et=0;et<ve;et++)Y.push(C[et]);return Y}Y=[],ve=0;for(et in C)Y[ve++]=C[et];return Y}function Or(C){if(C.na&&typeof C.na=="function")return C.na();if(!C.V||typeof C.V!="function"){if(typeof Map<"u"&&C instanceof Map)return Array.from(C.keys());if(!(typeof Set<"u"&&C instanceof Set)){if(c(C)||typeof C=="string"){var Y=[];C=C.length;for(var ve=0;ve<C;ve++)Y.push(ve);return Y}Y=[],ve=0;for(const et in C)Y[ve++]=et;return Y}}}function ir(C,Y){if(C.forEach&&typeof C.forEach=="function")C.forEach(Y,void 0);else if(c(C)||typeof C=="string")Array.prototype.forEach.call(C,Y,void 0);else for(var ve=Or(C),et=Mr(C),Kt=et.length,rr=0;rr<Kt;rr++)Y.call(void 0,et[rr],ve&&ve[rr],C)}var br=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wr(C,Y){if(C){C=C.split("&");for(var ve=0;ve<C.length;ve++){var et=C[ve].indexOf("="),Kt=null;if(0<=et){var rr=C[ve].substring(0,et);Kt=C[ve].substring(et+1)}else rr=C[ve];Y(rr,Kt?decodeURIComponent(Kt.replace(/\+/g," ")):"")}}}function Xr(C){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,C instanceof Xr){this.h=C.h,Pr(this,C.j),this.o=C.o,this.g=C.g,fn(this,C.s),this.l=C.l;var Y=C.i,ve=new Mt;ve.i=Y.i,Y.g&&(ve.g=new Map(Y.g),ve.h=Y.h),de(this,ve),this.m=C.m}else C&&(Y=String(C).match(br))?(this.h=!1,Pr(this,Y[1]||"",!0),this.o=ct(Y[2]||""),this.g=ct(Y[3]||"",!0),fn(this,Y[4]),this.l=ct(Y[5]||"",!0),de(this,Y[6]||"",!0),this.m=ct(Y[7]||"")):(this.h=!1,this.i=new Mt(null,this.h))}Xr.prototype.toString=function(){var C=[],Y=this.j;Y&&C.push(ye(Y,St,!0),":");var ve=this.g;return(ve||Y=="file")&&(C.push("//"),(Y=this.o)&&C.push(ye(Y,St,!0),"@"),C.push(encodeURIComponent(String(ve)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ve=this.s,ve!=null&&C.push(":",String(ve))),(ve=this.l)&&(this.g&&ve.charAt(0)!="/"&&C.push("/"),C.push(ye(ve,ve.charAt(0)=="/"?vt:wt,!0))),(ve=this.i.toString())&&C.push("?",ve),(ve=this.m)&&C.push("#",ye(ve,qt)),C.join("")};function Ir(C){return new Xr(C)}function Pr(C,Y,ve){C.j=ve?ct(Y,!0):Y,C.j&&(C.j=C.j.replace(/:$/,""))}function fn(C,Y){if(Y){if(Y=Number(Y),isNaN(Y)||0>Y)throw Error("Bad port number "+Y);C.s=Y}else C.s=null}function de(C,Y,ve){Y instanceof Mt?(C.i=Y,Yr(C.i,C.h)):(ve||(Y=ye(Y,Et)),C.i=new Mt(Y,C.h))}function tt(C,Y,ve){C.i.set(Y,ve)}function at(C){return tt(C,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),C}function ct(C,Y){return C?Y?decodeURI(C.replace(/%25/g,"%2525")):decodeURIComponent(C):""}function ye(C,Y,ve){return typeof C=="string"?(C=encodeURI(C).replace(Y,ft),ve&&(C=C.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C):null}function ft(C){return C=C.charCodeAt(0),"%"+(C>>4&15).toString(16)+(C&15).toString(16)}var St=/[#\/\?@]/g,wt=/[#\?:]/g,vt=/[#\?]/g,Et=/[#\?@]/g,qt=/#/g;function Mt(C,Y){this.h=this.g=null,this.i=C||null,this.j=!!Y}function Xt(C){C.g||(C.g=new Map,C.h=0,C.i&&wr(C.i,function(Y,ve){C.add(decodeURIComponent(Y.replace(/\+/g," ")),ve)}))}t=Mt.prototype,t.add=function(C,Y){Xt(this),this.i=null,C=Dt(this,C);var ve=this.g.get(C);return ve||this.g.set(C,ve=[]),ve.push(Y),this.h+=1,this};function ar(C,Y){Xt(C),Y=Dt(C,Y),C.g.has(Y)&&(C.i=null,C.h-=C.g.get(Y).length,C.g.delete(Y))}function vr(C,Y){return Xt(C),Y=Dt(C,Y),C.g.has(Y)}t.forEach=function(C,Y){Xt(this),this.g.forEach(function(ve,et){ve.forEach(function(Kt){C.call(Y,Kt,et,this)},this)},this)},t.na=function(){Xt(this);const C=Array.from(this.g.values()),Y=Array.from(this.g.keys()),ve=[];for(let et=0;et<Y.length;et++){const Kt=C[et];for(let rr=0;rr<Kt.length;rr++)ve.push(Y[et])}return ve},t.V=function(C){Xt(this);let Y=[];if(typeof C=="string")vr(this,C)&&(Y=Y.concat(this.g.get(Dt(this,C))));else{C=Array.from(this.g.values());for(let ve=0;ve<C.length;ve++)Y=Y.concat(C[ve])}return Y},t.set=function(C,Y){return Xt(this),this.i=null,C=Dt(this,C),vr(this,C)&&(this.h-=this.g.get(C).length),this.g.set(C,[Y]),this.h+=1,this},t.get=function(C,Y){return C?(C=this.V(C),0<C.length?String(C[0]):Y):Y};function ur(C,Y,ve){ar(C,Y),0<ve.length&&(C.i=null,C.g.set(Dt(C,Y),p(ve)),C.h+=ve.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const C=[],Y=Array.from(this.g.keys());for(var ve=0;ve<Y.length;ve++){var et=Y[ve];const rr=encodeURIComponent(String(et)),Lr=this.V(et);for(et=0;et<Lr.length;et++){var Kt=rr;Lr[et]!==""&&(Kt+="="+encodeURIComponent(String(Lr[et]))),C.push(Kt)}}return this.i=C.join("&")};function Dt(C,Y){return Y=String(Y),C.j&&(Y=Y.toLowerCase()),Y}function Yr(C,Y){Y&&!C.j&&(Xt(C),C.i=null,C.g.forEach(function(ve,et){var Kt=et.toLowerCase();et!=Kt&&(ar(this,et),ur(this,Kt,ve))},C)),C.j=Y}function Vr(C,Y){const ve=new fe;if(l.Image){const et=new Image;et.onload=h(pr,ve,"TestLoadImage: loaded",!0,Y,et),et.onerror=h(pr,ve,"TestLoadImage: error",!1,Y,et),et.onabort=h(pr,ve,"TestLoadImage: abort",!1,Y,et),et.ontimeout=h(pr,ve,"TestLoadImage: timeout",!1,Y,et),l.setTimeout(function(){et.ontimeout&&et.ontimeout()},1e4),et.src=C}else Y(!1)}function Sr(C,Y){const ve=new fe,et=new AbortController,Kt=setTimeout(()=>{et.abort(),pr(ve,"TestPingServer: timeout",!1,Y)},1e4);fetch(C,{signal:et.signal}).then(rr=>{clearTimeout(Kt),rr.ok?pr(ve,"TestPingServer: ok",!0,Y):pr(ve,"TestPingServer: server error",!1,Y)}).catch(()=>{clearTimeout(Kt),pr(ve,"TestPingServer: error",!1,Y)})}function pr(C,Y,ve,et,Kt){try{Kt&&(Kt.onload=null,Kt.onerror=null,Kt.onabort=null,Kt.ontimeout=null),et(ve)}catch{}}function jr(){this.g=new yt}function Bn(C,Y,ve){const et=ve||"";try{ir(C,function(Kt,rr){let Lr=Kt;u(Kt)&&(Lr=qe(Kt)),Y.push(et+rr+"="+encodeURIComponent(Lr))})}catch(Kt){throw Y.push(et+"type="+encodeURIComponent("_badmap")),Kt}}function wn(C){this.l=C.Ub||null,this.j=C.eb||!1}m(wn,pe),wn.prototype.g=function(){return new xn(this.l,this.j)},wn.prototype.i=function(C){return function(){return C}}({});function xn(C,Y){Ft.call(this),this.D=C,this.o=Y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(xn,Ft),t=xn.prototype,t.open=function(C,Y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=C,this.A=Y,this.readyState=1,Yi(this)},t.send=function(C){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const Y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};C&&(Y.body=C),(this.D||l).fetch(new Request(this.A,Y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ga(this)),this.readyState=0},t.Sa=function(C){if(this.g&&(this.l=C,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=C.headers,this.readyState=2,Yi(this)),this.g&&(this.readyState=3,Yi(this),this.g)))if(this.responseType==="arraybuffer")C.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in C){if(this.j=C.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ua(this)}else C.text().then(this.Ra.bind(this),this.ga.bind(this))};function ua(C){C.j.read().then(C.Pa.bind(C)).catch(C.ga.bind(C))}t.Pa=function(C){if(this.g){if(this.o&&C.value)this.response.push(C.value);else if(!this.o){var Y=C.value?C.value:new Uint8Array(0);(Y=this.v.decode(Y,{stream:!C.done}))&&(this.response=this.responseText+=Y)}C.done?ga(this):Yi(this),this.readyState==3&&ua(this)}},t.Ra=function(C){this.g&&(this.response=this.responseText=C,ga(this))},t.Qa=function(C){this.g&&(this.response=C,ga(this))},t.ga=function(){this.g&&ga(this)};function ga(C){C.readyState=4,C.l=null,C.j=null,C.v=null,Yi(C)}t.setRequestHeader=function(C,Y){this.u.append(C,Y)},t.getResponseHeader=function(C){return this.h&&this.h.get(C.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const C=[],Y=this.h.entries();for(var ve=Y.next();!ve.done;)ve=ve.value,C.push(ve[0]+": "+ve[1]),ve=Y.next();return C.join(`\r
`)};function Yi(C){C.onreadystatechange&&C.onreadystatechange.call(C)}Object.defineProperty(xn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(C){this.m=C?"include":"same-origin"}});function Ji(C){let Y="";return I(C,function(ve,et){Y+=et,Y+=":",Y+=ve,Y+=`\r
`}),Y}function Fl(C,Y,ve){e:{for(et in ve){var et=!1;break e}et=!0}et||(ve=Ji(ve),typeof C=="string"?ve!=null&&encodeURIComponent(String(ve)):tt(C,Y,ve))}function xa(C){Ft.call(this),this.headers=new Map,this.o=C||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(xa,Ft);var Qn=/^https?$/i,du=["POST","PUT"];t=xa.prototype,t.Ha=function(C){this.J=C},t.ea=function(C,Y,ve,et){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+C);Y=Y?Y.toUpperCase():"GET",this.D=C,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Me.g(),this.v=this.o?je(this.o):je(Me),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(Y,String(C),!0),this.B=!1}catch(rr){Ol(this,rr);return}if(C=ve||"",ve=new Map(this.headers),et)if(Object.getPrototypeOf(et)===Object.prototype)for(var Kt in et)ve.set(Kt,et[Kt]);else if(typeof et.keys=="function"&&typeof et.get=="function")for(const rr of et.keys())ve.set(rr,et.get(rr));else throw Error("Unknown input type for opt_headers: "+String(et));et=Array.from(ve.keys()).find(rr=>rr.toLowerCase()=="content-type"),Kt=l.FormData&&C instanceof l.FormData,!(0<=Array.prototype.indexOf.call(du,Y,void 0))||et||Kt||ve.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[rr,Lr]of ve)this.g.setRequestHeader(rr,Lr);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{dc(this),this.u=!0,this.g.send(C),this.u=!1}catch(rr){Ol(this,rr)}};function Ol(C,Y){C.h=!1,C.g&&(C.j=!0,C.g.abort(),C.j=!1),C.l=Y,C.m=5,Zi(C),Mc(C)}function Zi(C){C.A||(C.A=!0,$e(C,"complete"),$e(C,"error"))}t.abort=function(C){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=C||7,$e(this,"complete"),$e(this,"abort"),Mc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mc(this,!0)),xa.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rc(this):this.bb())},t.bb=function(){Rc(this)};function Rc(C){if(C.h&&typeof o<"u"&&(!C.v[1]||ol(C)!=4||C.Z()!=2)){if(C.u&&ol(C)==4)Ze(C.Ea,0,C);else if($e(C,"readystatechange"),ol(C)==4){C.h=!1;try{const Lr=C.Z();e:switch(Lr){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var Y=!0;break e;default:Y=!1}var ve;if(!(ve=Y)){var et;if(et=Lr===0){var Kt=String(C.D).match(br)[1]||null;!Kt&&l.self&&l.self.location&&(Kt=l.self.location.protocol.slice(0,-1)),et=!Qn.test(Kt?Kt.toLowerCase():"")}ve=et}if(ve)$e(C,"complete"),$e(C,"success");else{C.m=6;try{var rr=2<ol(C)?C.g.statusText:""}catch{rr=""}C.l=rr+" ["+C.Z()+"]",Zi(C)}}finally{Mc(C)}}}}function Mc(C,Y){if(C.g){dc(C);const ve=C.g,et=C.v[0]?()=>{}:null;C.g=null,C.v=null,Y||$e(C,"ready");try{ve.onreadystatechange=et}catch{}}}function dc(C){C.I&&(l.clearTimeout(C.I),C.I=null)}t.isActive=function(){return!!this.g};function ol(C){return C.g?C.g.readyState:0}t.Z=function(){try{return 2<ol(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(C){if(this.g){var Y=this.g.responseText;return C&&Y.indexOf(C)==0&&(Y=Y.substring(C.length)),st(Y)}};function fu(C){try{if(!C.g)return null;if("response"in C.g)return C.g.response;switch(C.H){case"":case"text":return C.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in C.g)return C.g.mozResponseArrayBuffer}return null}catch{return null}}function GA(C){const Y={};C=(C.g&&2<=ol(C)&&C.g.getAllResponseHeaders()||"").split(`\r
`);for(let et=0;et<C.length;et++){if(y(C[et]))continue;var ve=k(C[et]);const Kt=ve[0];if(ve=ve[1],typeof ve!="string")continue;ve=ve.trim();const rr=Y[Kt]||[];Y[Kt]=rr,rr.push(ve)}_(Y,function(et){return et.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ll(C,Y,ve){return ve&&ve.internalChannelParams&&ve.internalChannelParams[C]||Y}function Lc(C){this.Aa=0,this.i=[],this.j=new fe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ll("failFast",!1,C),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ll("baseRetryDelayMs",5e3,C),this.cb=ll("retryDelaySeedMs",1e4,C),this.Wa=ll("forwardChannelMaxRetries",2,C),this.wa=ll("forwardChannelRequestTimeoutMs",2e4,C),this.pa=C&&C.xmlHttpFactory||void 0,this.Xa=C&&C.Tb||void 0,this.Ca=C&&C.useFetchStreams||!1,this.L=void 0,this.J=C&&C.supportsCrossDomainXhr||!1,this.K="",this.h=new kr(C&&C.concurrentRequestLimit),this.Da=new jr,this.P=C&&C.fastHandshake||!1,this.O=C&&C.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=C&&C.Rb||!1,C&&C.xa&&this.j.xa(),C&&C.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&C&&C.detectBufferingProxy||!1,this.ja=void 0,C&&C.longPollingTimeout&&0<C.longPollingTimeout&&(this.ja=C.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Lc.prototype,t.la=8,t.G=1,t.connect=function(C,Y,ve,et){Ce(0),this.W=C,this.H=Y||{},ve&&et!==void 0&&(this.H.OSID=ve,this.H.OAID=et),this.F=this.X,this.I=Va(this,null,this.W),M(this)};function Bf(C){if(zu(C),C.G==3){var Y=C.U++,ve=Ir(C.I);if(tt(ve,"SID",C.K),tt(ve,"RID",Y),tt(ve,"TYPE","terminate"),Ct(C,ve),Y=new Ie(C,C.j,Y),Y.L=2,Y.v=at(Ir(ve)),ve=!1,l.navigator&&l.navigator.sendBeacon)try{ve=l.navigator.sendBeacon(Y.v.toString(),"")}catch{}!ve&&l.Image&&(new Image().src=Y.v,ve=!0),ve||(Y.g=pi(Y.j,null),Y.g.ea(Y.v)),Y.F=Date.now(),ot(Y)}Ys(C)}function fo(C){C.g&&(sn(C),C.g.cancel(),C.g=null)}function zu(C){fo(C),C.u&&(l.clearTimeout(C.u),C.u=null),Tn(C),C.h.cancel(),C.s&&(typeof C.s=="number"&&l.clearTimeout(C.s),C.s=null)}function M(C){if(!en(C.h)&&!C.s){C.s=!0;var Y=C.Ga;ue||Oe(),ge||(ue(),ge=!0),ne.add(Y,C),C.B=0}}function Be(C,Y){return rn(C.h)>=C.h.j-(C.s?1:0)?!1:C.s?(C.i=Y.D.concat(C.i),!0):C.G==1||C.G==2||C.B>=(C.Va?0:C.Wa)?!1:(C.s=Qe(A(C.Ga,C,Y),da(C,C.B)),C.B++,!0)}t.Ga=function(C){if(this.s)if(this.s=null,this.G==1){if(!C){this.U=Math.floor(1e5*Math.random()),C=this.U++;const Kt=new Ie(this,this.j,C);let rr=this.o;if(this.S&&(rr?(rr=S(rr),B(rr,this.S)):rr=this.S),this.m!==null||this.O||(Kt.H=rr,rr=null),this.P)e:{for(var Y=0,ve=0;ve<this.i.length;ve++){t:{var et=this.i[ve];if("__data__"in et.map&&(et=et.map.__data__,typeof et=="string")){et=et.length;break t}et=void 0}if(et===void 0)break;if(Y+=et,4096<Y){Y=ve;break e}if(Y===4096||ve===this.i.length-1){Y=ve+1;break e}}Y=1e3}else Y=1e3;Y=Vt(this,Kt,Y),ve=Ir(this.I),tt(ve,"RID",C),tt(ve,"CVER",22),this.D&&tt(ve,"X-HTTP-Session-Id",this.D),Ct(this,ve),rr&&(this.O?Y="headers="+encodeURIComponent(String(Ji(rr)))+"&"+Y:this.m&&Fl(ve,this.m,rr)),Ee(this.h,Kt),this.Ua&&tt(ve,"TYPE","init"),this.P?(tt(ve,"$req",Y),tt(ve,"SID","null"),Kt.T=!0,kt(Kt,ve,null)):kt(Kt,ve,Y),this.G=2}}else this.G==3&&(C?At(this,C):this.i.length==0||en(this.h)||At(this))};function At(C,Y){var ve;Y?ve=Y.l:ve=C.U++;const et=Ir(C.I);tt(et,"SID",C.K),tt(et,"RID",ve),tt(et,"AID",C.T),Ct(C,et),C.m&&C.o&&Fl(et,C.m,C.o),ve=new Ie(C,C.j,ve,C.B+1),C.m===null&&(ve.H=C.o),Y&&(C.i=Y.D.concat(C.i)),Y=Vt(C,ve,1e3),ve.I=Math.round(.5*C.wa)+Math.round(.5*C.wa*Math.random()),Ee(C.h,ve),kt(ve,et,Y)}function Ct(C,Y){C.H&&I(C.H,function(ve,et){tt(Y,et,ve)}),C.l&&ir({},function(ve,et){tt(Y,et,ve)})}function Vt(C,Y,ve){ve=Math.min(C.i.length,ve);var et=C.l?A(C.l.Na,C.l,C):null;e:{var Kt=C.i;let rr=-1;for(;;){const Lr=["count="+ve];rr==-1?0<ve?(rr=Kt[0].g,Lr.push("ofs="+rr)):rr=0:Lr.push("ofs="+rr);let ma=!0;for(let ei=0;ei<ve;ei++){let na=Kt[ei].g;const Sa=Kt[ei].map;if(na-=rr,0>na)rr=Math.max(0,Kt[ei].g-100),ma=!1;else try{Bn(Sa,Lr,"req"+na+"_")}catch{et&&et(Sa)}}if(ma){et=Lr.join("&");break e}}}return C=C.i.splice(0,ve),Y.D=C,et}function hr(C){if(!C.g&&!C.u){C.Y=1;var Y=C.Fa;ue||Oe(),ge||(ue(),ge=!0),ne.add(Y,C),C.v=0}}function yr(C){return C.g||C.u||3<=C.v?!1:(C.Y++,C.u=Qe(A(C.Fa,C),da(C,C.v)),C.v++,!0)}t.Fa=function(){if(this.u=null,hn(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var C=2*this.R;this.j.info("BP detection timer enabled: "+C),this.A=Qe(A(this.ab,this),C)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),fo(this),hn(this))};function sn(C){C.A!=null&&(l.clearTimeout(C.A),C.A=null)}function hn(C){C.g=new Ie(C,C.j,"rpc",C.Y),C.m===null&&(C.g.H=C.o),C.g.O=0;var Y=Ir(C.qa);tt(Y,"RID","rpc"),tt(Y,"SID",C.K),tt(Y,"AID",C.T),tt(Y,"CI",C.F?"0":"1"),!C.F&&C.ja&&tt(Y,"TO",C.ja),tt(Y,"TYPE","xmlhttp"),Ct(C,Y),C.m&&C.o&&Fl(Y,C.m,C.o),C.L&&(C.g.I=C.L);var ve=C.g;C=C.ia,ve.L=1,ve.v=at(Ir(Y)),ve.m=null,ve.P=!0,le(ve,C)}t.Za=function(){this.C!=null&&(this.C=null,fo(this),yr(this),Ce(19))};function Tn(C){C.C!=null&&(l.clearTimeout(C.C),C.C=null)}function Vn(C,Y){var ve=null;if(C.g==Y){Tn(C),sn(C),C.g=null;var et=2}else if(Er(C.h,Y))ve=Y.D,gt(C.h,Y),et=1;else return;if(C.G!=0){if(Y.o)if(et==1){ve=Y.m?Y.m.length:0,Y=Date.now()-Y.F;var Kt=C.B;et=It(),$e(et,new Ae(et,ve)),M(C)}else hr(C);else if(Kt=Y.s,Kt==3||Kt==0&&0<Y.X||!(et==1&&Be(C,Y)||et==2&&yr(C)))switch(ve&&0<ve.length&&(Y=C.h,Y.i=Y.i.concat(ve)),Kt){case 1:ka(C,5);break;case 4:ka(C,10);break;case 3:ka(C,6);break;default:ka(C,2)}}}function da(C,Y){let ve=C.Ta+Math.floor(Math.random()*C.cb);return C.isActive()||(ve*=2),ve*Y}function ka(C,Y){if(C.j.info("Error code "+Y),Y==2){var ve=A(C.fb,C),et=C.Xa;const Kt=!et;et=new Xr(et||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Pr(et,"https"),at(et),Kt?Vr(et.toString(),ve):Sr(et.toString(),ve)}else Ce(2);C.G=0,C.l&&C.l.sa(Y),Ys(C),zu(C)}t.fb=function(C){C?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))};function Ys(C){if(C.G=0,C.ka=[],C.l){const Y=Zt(C.h);(Y.length!=0||C.i.length!=0)&&(x(C.ka,Y),x(C.ka,C.i),C.h.i.length=0,p(C.i),C.i.length=0),C.l.ra()}}function Va(C,Y,ve){var et=ve instanceof Xr?Ir(ve):new Xr(ve);if(et.g!="")Y&&(et.g=Y+"."+et.g),fn(et,et.s);else{var Kt=l.location;et=Kt.protocol,Y=Y?Y+"."+Kt.hostname:Kt.hostname,Kt=+Kt.port;var rr=new Xr(null);et&&Pr(rr,et),Y&&(rr.g=Y),Kt&&fn(rr,Kt),ve&&(rr.l=ve),et=rr}return ve=C.D,Y=C.ya,ve&&Y&&tt(et,ve,Y),tt(et,"VER",C.la),Ct(C,et),et}function pi(C,Y,ve){if(Y&&!C.J)throw Error("Can't create secondary domain capable XhrIo object.");return Y=C.Ca&&!C.pa?new xa(new wn({eb:ve})):new xa(C.pa),Y.Ha(C.J),Y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Js(){}t=Js.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function gi(){}gi.prototype.g=function(C,Y){return new Zs(C,Y)};function Zs(C,Y){Ft.call(this),this.g=new Lc(Y),this.l=C,this.h=Y&&Y.messageUrlParams||null,C=Y&&Y.messageHeaders||null,Y&&Y.clientProtocolHeaderRequired&&(C?C["X-Client-Protocol"]="webchannel":C={"X-Client-Protocol":"webchannel"}),this.g.o=C,C=Y&&Y.initMessageHeaders||null,Y&&Y.messageContentType&&(C?C["X-WebChannel-Content-Type"]=Y.messageContentType:C={"X-WebChannel-Content-Type":Y.messageContentType}),Y&&Y.va&&(C?C["X-WebChannel-Client-Profile"]=Y.va:C={"X-WebChannel-Client-Profile":Y.va}),this.g.S=C,(C=Y&&Y.Sb)&&!y(C)&&(this.g.m=C),this.v=Y&&Y.supportsCrossDomainXhr||!1,this.u=Y&&Y.sendRawJson||!1,(Y=Y&&Y.httpSessionIdParam)&&!y(Y)&&(this.g.D=Y,C=this.h,C!==null&&Y in C&&(C=this.h,Y in C&&delete C[Y])),this.j=new Xu(this)}m(Zs,Ft),Zs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zs.prototype.close=function(){Bf(this.g)},Zs.prototype.o=function(C){var Y=this.g;if(typeof C=="string"){var ve={};ve.__data__=C,C=ve}else this.u&&(ve={},ve.__data__=qe(C),C=ve);Y.i.push(new or(Y.Ya++,C)),Y.G==3&&M(Y)},Zs.prototype.N=function(){this.g.l=null,delete this.j,Bf(this.g),delete this.g,Zs.aa.N.call(this)};function Uc(C){xe.call(this),C.__headers__&&(this.headers=C.__headers__,this.statusCode=C.__status__,delete C.__headers__,delete C.__status__);var Y=C.__sm__;if(Y){e:{for(const ve in Y){C=ve;break e}C=void 0}(this.i=C)&&(C=this.i,Y=Y!==null&&C in Y?Y[C]:void 0),this.data=Y}else this.data=C}m(Uc,xe);function Wu(){Se.call(this),this.status=1}m(Wu,Se);function Xu(C){this.g=C}m(Xu,Js),Xu.prototype.ua=function(){$e(this.g,"a")},Xu.prototype.ta=function(C){$e(this.g,new Uc(C))},Xu.prototype.sa=function(C){$e(this.g,new Wu)},Xu.prototype.ra=function(){$e(this.g,"b")},gi.prototype.createWebChannel=gi.prototype.g,Zs.prototype.send=Zs.prototype.o,Zs.prototype.open=Zs.prototype.m,Zs.prototype.close=Zs.prototype.close,OJ=function(){return new gi},FJ=function(){return It()},kJ=xt,HT={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},se.NO_ERROR=0,se.TIMEOUT=8,se.HTTP_ERROR=6,nE=se,Ne.COMPLETE="complete",TJ=Ne,we.EventType=Ye,Ye.OPEN="a",Ye.CLOSE="b",Ye.ERROR="c",Ye.MESSAGE="d",Ft.prototype.listen=Ft.prototype.K,Ry=we,xa.prototype.listenOnce=xa.prototype.L,xa.prototype.getLastError=xa.prototype.Ka,xa.prototype.getLastErrorCode=xa.prototype.Ba,xa.prototype.getStatus=xa.prototype.Z,xa.prototype.getResponseJson=xa.prototype.Oa,xa.prototype.getResponseText=xa.prototype.oa,xa.prototype.send=xa.prototype.ea,xa.prototype.setWithCredentials=xa.prototype.Ha,BJ=xa}).apply(typeof eC<"u"?eC:typeof self<"u"?self:typeof window<"u"?window:{});const p7="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nl.UNAUTHENTICATED=new Nl(null),Nl.GOOGLE_CREDENTIALS=new Nl("google-credentials-uid"),Nl.FIRST_PARTY=new Nl("first-party-uid"),Nl.MOCK_USER=new Nl("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let o1="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=new _D("@firebase/firestore");function Cx(){return ng.logLevel}function Fr(t,...e){if(ng.logLevel<=ha.DEBUG){const r=e.map(VD);ng.debug(`Firestore (${o1}): ${t}`,...r)}}function _c(t,...e){if(ng.logLevel<=ha.ERROR){const r=e.map(VD);ng.error(`Firestore (${o1}): ${t}`,...r)}}function xm(t,...e){if(ng.logLevel<=ha.WARN){const r=e.map(VD);ng.warn(`Firestore (${o1}): ${t}`,...r)}}function VD(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t="Unexpected state"){const e=`FIRESTORE (${o1}) INTERNAL ASSERTION FAILED: `+t;throw _c(e),new Error(e)}function gn(t,e){t||dn()}function Ln(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Hr extends TA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DJ{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Nl.UNAUTHENTICATED))}shutdown(){}}class Oxe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Dxe{constructor(e){this.t=e,this.currentUser=Nl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){gn(this.o===void 0);let n=this.i;const a=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new pf;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pf,e.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await a(this.currentUser)})},l=c=>{Fr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Fr("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pf)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Fr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gn(typeof n.accessToken=="string"),new DJ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gn(e===null||typeof e=="string"),new Nl(e)}}class Rxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Nl.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Mxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Rxe(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Nl.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Lxe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Uxe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){gn(this.o===void 0);const n=s=>{s.error!=null&&Fr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Fr("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{Fr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?a(s):Fr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(gn(typeof r.token=="string"),this.R=r.token,new Lxe(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qxe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=Qxe(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=e.charAt(a[s]%e.length))}return n}}function Gn(t,e){return t<e?-1:t>e?1:0}function Pv(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}function MJ(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return xr.fromMillis(Date.now())}static fromDate(e){return xr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new xr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Gn(this.nanoseconds,e.nanoseconds):Gn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Cn(e)}static min(){return new Cn(new xr(0,0))}static max(){return new Cn(new xr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e,r,n){r===void 0?r=0:r>e.length&&dn(),n===void 0?n=e.length-r:n>e.length-r&&dn(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return u2.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof u2?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const s=e.get(a),o=r.get(a);if(s<o)return-1;if(s>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Pa extends u2{construct(e,r,n){return new Pa(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Hr(fr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new Pa(r)}static emptyPath(){return new Pa([])}}const Vxe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hs extends u2{construct(e,r,n){return new Hs(e,r,n)}static isValidIdentifier(e){return Vxe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Hs(["__name__"])}static fromServerFormat(e){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Hr(fr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new Hr(fr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[a+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Hr(fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(n+=l,a++):(s(),a++)}if(s(),o)throw new Hr(fr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hs(r)}static emptyPath(){return new Hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e){this.path=e}static fromPath(e){return new Jr(Pa.fromString(e))}static fromName(e){return new Jr(Pa.fromString(e).popFirst(5))}static empty(){return new Jr(Pa.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pa.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Pa.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Jr(new Pa(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,r,n,a){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=a}}function $T(t){return t.fields.find(e=>e.kind===2)}function op(t){return t.fields.filter(e=>e.kind!==2)}iS.UNKNOWN_ID=-1;class aE{constructor(e,r){this.fieldPath=e,this.kind=r}}class d2{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new d2(0,Qu.min())}}function Hxe(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=Cn.fromTimestamp(n===1e9?new xr(r+1,0):new xr(r,n));return new Qu(a,Jr.empty(),e)}function LJ(t){return new Qu(t.readTime,t.key,-1)}class Qu{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Qu(Cn.min(),Jr.empty(),-1)}static max(){return new Qu(Cn.max(),Jr.empty(),-1)}}function $D(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Jr.comparator(t.documentKey,e.documentKey),r!==0?r:Gn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class QJ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jg(t){if(t.code!==fr.FAILED_PRECONDITION||t.message!==UJ)throw t;Fr("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&dn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Jt((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Jt?r:Jt.resolve(r)}catch(r){return Jt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Jt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Jt.reject(r)}static resolve(e){return new Jt((r,n)=>{r(e)})}static reject(e){return new Jt((r,n)=>{n(e)})}static waitFor(e){return new Jt((r,n)=>{let a=0,s=0,o=!1;e.forEach(l=>{++a,l.next(()=>{++s,o&&s===a&&r()},c=>n(c))}),o=!0,s===a&&r()})}static or(e){let r=Jt.resolve(!1);for(const n of e)r=r.next(a=>a?Jt.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(e,r){return new Jt((n,a)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;r(e[u]).next(d=>{o[u]=d,++l,l===s&&n(o)},d=>a(d))}})}static doWhile(e,r){return new Jt((n,a)=>{const s=()=>{e()===!0?r().next(()=>{s()},a):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new pf,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new hb(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const a=KD(n.target.error);this.V.reject(new hb(e,a))}}static open(e,r,n,a){try{return new wj(r,e.transaction(a,n))}catch(s){throw new hb(r,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Fr("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new Kxe(r)}}class cm{constructor(e,r,n){this.name=e,this.version=r,this.p=n,cm.S(Fo())===12.2&&_c("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Fr("SimpleDb","Removing database:",e),Ap(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!KY())return!1;if(cm.v())return!0;const e=Fo(),r=cm.S(e),n=0<r&&r<10,a=VJ(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Fr("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const o=s.target.result;r(o)},a.onblocked=()=>{n(new hb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Hr(fr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Hr(fr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new hb(e,o))},a.onupgradeneeded=s=>{Fr("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,a.transaction,s.oldVersion,this.version).next(()=>{Fr("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,a){const s=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=wj.open(this.db,e,s?"readonly":"readwrite",n),c=a(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Jt.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Fr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function VJ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class $xe{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ap(this.B.delete())}}class hb extends Hr{constructor(e,r){super(fr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Mm(t){return t.name==="IndexedDbTransactionError"}class Kxe{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Fr("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Fr("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ap(n)}add(e){return Fr("SimpleDb","ADD",this.store.name,e,e),Ap(this.store.add(e))}get(e){return Ap(this.store.get(e)).next(r=>(r===void 0&&(r=null),Fr("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Fr("SimpleDb","DELETE",this.store.name,e),Ap(this.store.delete(e))}count(){return Fr("SimpleDb","COUNT",this.store.name),Ap(this.store.count())}U(e,r){const n=this.options(e,r),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new Jt((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(n),o=[];return this.W(s,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Jt((a,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{a(o.target.result)}})}j(e,r){Fr("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const a=this.cursor(n);return this.W(a,(s,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const a=this.cursor(n);return this.W(a,r)}Y(e){const r=this.cursor({});return new Jt((n,a)=>{r.onerror=s=>{const o=KD(s.target.error);a(o)},r.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new Jt((a,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void a();const c=new $xe(l),u=r(l.primaryKey,l.value,c);if(u instanceof Jt){const d=u.catch(f=>(c.done(),Jt.reject(f)));n.push(d)}c.isDone?a():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Jt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function Ap(t){return new Jt((e,r)=>{t.onsuccess=n=>{const a=n.target.result;e(a)},t.onerror=n=>{const a=KD(n.target.error);r(a)}})}let g7=!1;function KD(t){const e=cm.S(Fo());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Hr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return g7||(g7=!0,setTimeout(()=>{throw n},0)),n}}return t}class Gxe{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Fr("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Fr("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){Mm(r)?Fr("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await jg(r)}await this.X(6e4)})}}class qxe{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let a=r,s=!0;return Jt.doWhile(()=>s===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Fr("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,a).next(l=>{a-=l,n.add(o)});s=!1})).next(()=>r-a)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(a=>this.localStore.localDocuments.getNextDocuments(e,r,a,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(a,s)).next(l=>(Fr("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((a,s)=>{const o=LJ(s);$D(o,n)>0&&(n=o)}),new Qu(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}wd.oe=-1;function Cw(t){return t==null}function f2(t){return t===0&&1/t==-1/0}function zxe(t){return typeof t=="number"&&Number.isInteger(t)&&!f2(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=x7(e)),e=Wxe(t.get(r),e);return x7(e)}function Wxe(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const s=t.charAt(a);switch(s){case"\0":r+="";break;case"":r+="";break;default:r+=s}}return r}function x7(t){return t+""}function Xf(t){const e=t.length;if(gn(e>=2),e===2)return gn(t.charAt(0)===""&&t.charAt(1)===""),Pa.emptyPath();const r=e-2,n=[];let a="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>r)&&dn(),t.charAt(o+1)){case"":const l=t.substring(s,o);let c;a.length===0?c=l:(a+=l,c=a,a=""),n.push(c);break;case"":a+=t.substring(s,o),a+="\0";break;case"":a+=t.substring(s,o+1);break;default:dn()}s=o+2}return new Pa(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v7=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(t,e){return[t,jc(e)]}function HJ(t,e,r){return[t,jc(e),r]}const Xxe={},Yxe=["prefixPath","collectionGroup","readTime","documentId"],Jxe=["prefixPath","collectionGroup","documentId"],Zxe=["collectionGroup","readTime","prefixPath","documentId"],eve=["canonicalId","targetId"],tve=["targetId","path"],rve=["path","targetId"],nve=["collectionId","parent"],ave=["indexId","uid"],sve=["uid","sequenceNumber"],ive=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ove=["indexId","uid","orderedDocumentKey"],lve=["userId","collectionPath","documentId"],cve=["userId","collectionPath","largestBatchId"],uve=["userId","collectionGroup","largestBatchId"],$J=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],dve=[...$J,"documentOverlays"],KJ=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],GJ=KJ,GD=[...GJ,"indexConfiguration","indexState","indexEntries"],fve=GD,hve=[...GD,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT extends QJ{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function Do(t,e){const r=Ln(t);return cm.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y7(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Pg(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function qJ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,r){this.comparator=e,this.root=r||Cl.EMPTY}insert(e,r){return new Ws(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Cl.BLACK,null,null))}remove(e){return new Ws(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cl.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tC(this.root,e,this.comparator,!1)}getReverseIterator(){return new tC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tC(this.root,e,this.comparator,!0)}}class tC{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cl{constructor(e,r,n,a,s){this.key=e,this.value=r,this.color=n??Cl.RED,this.left=a??Cl.EMPTY,this.right=s??Cl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,s){return new Cl(e??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Cl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return Cl.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dn();const e=this.left.check();if(e!==this.right.check())throw dn();return e+(this.isRed()?0:1)}}Cl.EMPTY=null,Cl.RED=!0,Cl.BLACK=!1;Cl.EMPTY=new class{constructor(){this.size=0}get key(){throw dn()}get value(){throw dn()}get color(){throw dn()}get left(){throw dn()}get right(){throw dn()}copy(e,r,n,a,s){return this}insert(e,r,n){return new Cl(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e){this.comparator=e,this.data=new Ws(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new b7(this.data.getIterator())}getIteratorFrom(e){return new b7(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof us)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new us(this.comparator);return r.data=e,r}}class b7{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Jg(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e){this.fields=e,e.sort(Hs.comparator)}static empty(){return new eu([])}unionWith(e){let r=new us(Hs.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new eu(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Pv(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zJ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new zJ("Invalid base64 string: "+s):s}}(e);return new Wi(r)}static fromUint8Array(e){const r=function(a){let s="";for(let o=0;o<a.length;++o)s+=String.fromCharCode(a[o]);return s}(e);return new Wi(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Gn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wi.EMPTY_BYTE_STRING=new Wi("");const Ave=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xA(t){if(gn(!!t),typeof t=="string"){let e=0;const r=Ave.exec(t);if(gn(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Us(t.seconds),nanos:Us(t.nanos)}}function Us(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vm(t){return typeof t=="string"?Wi.fromBase64String(t):Wi.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function zD(t){const e=t.mapValue.fields.__previous_value__;return qD(e)?zD(e):e}function h2(t){const e=xA(t.mapValue.fields.__local_write_time__.timestampValue);return new xr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mve{constructor(e,r,n,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class ym{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new ym("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ym&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},iE={nullValue:"NULL_VALUE"};function ag(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qD(t)?4:WJ(t)?9007199254740991:Nj(t)?10:11:dn()}function oh(t,e){if(t===e)return!0;const r=ag(t);if(r!==ag(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return h2(t).isEqual(h2(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const o=xA(a.timestampValue),l=xA(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,s){return vm(a.bytesValue).isEqual(vm(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,s){return Us(a.geoPointValue.latitude)===Us(s.geoPointValue.latitude)&&Us(a.geoPointValue.longitude)===Us(s.geoPointValue.longitude)}(t,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return Us(a.integerValue)===Us(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const o=Us(a.doubleValue),l=Us(s.doubleValue);return o===l?f2(o)===f2(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Pv(t.arrayValue.values||[],e.arrayValue.values||[],oh);case 10:case 11:return function(a,s){const o=a.mapValue.fields||{},l=s.mapValue.fields||{};if(y7(o)!==y7(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!oh(o[c],l[c])))return!1;return!0}(t,e);default:return dn()}}function A2(t,e){return(t.values||[]).find(r=>oh(r,e))!==void 0}function bm(t,e){if(t===e)return 0;const r=ag(t),n=ag(e);if(r!==n)return Gn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Gn(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Us(s.integerValue||s.doubleValue),c=Us(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return w7(t.timestampValue,e.timestampValue);case 4:return w7(h2(t),h2(e));case 5:return Gn(t.stringValue,e.stringValue);case 6:return function(s,o){const l=vm(s),c=vm(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Gn(l[u],c[u]);if(d!==0)return d}return Gn(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=Gn(Us(s.latitude),Us(o.latitude));return l!==0?l:Gn(Us(s.longitude),Us(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return N7(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,d;const f=s.fields||{},A=o.fields||{},h=(l=f.value)===null||l===void 0?void 0:l.arrayValue,m=(c=A.value)===null||c===void 0?void 0:c.arrayValue,p=Gn(((u=h==null?void 0:h.values)===null||u===void 0?void 0:u.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:N7(h,m)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===$0.mapValue&&o===$0.mapValue)return 0;if(s===$0.mapValue)return 1;if(o===$0.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const A=Gn(c[f],d[f]);if(A!==0)return A;const h=bm(l[c[f]],u[d[f]]);if(h!==0)return h}return Gn(c.length,d.length)}(t.mapValue,e.mapValue);default:throw dn()}}function w7(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Gn(t,e);const r=xA(t),n=xA(e),a=Gn(r.seconds,n.seconds);return a!==0?a:Gn(r.nanos,n.nanos)}function N7(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=bm(r[a],n[a]);if(s)return s}return Gn(r.length,n.length)}function Bv(t){return GT(t)}function GT(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=xA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return vm(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Jr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const s of r.values||[])a?a=!1:n+=",",n+=GT(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",s=!0;for(const o of n)s?s=!1:a+=",",a+=`${o}:${GT(r.fields[o])}`;return a+"}"}(t.mapValue):dn()}function m2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function qT(t){return!!t&&"integerValue"in t}function p2(t){return!!t&&"arrayValue"in t}function C7(t){return!!t&&"nullValue"in t}function _7(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function oE(t){return!!t&&"mapValue"in t}function Nj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Ab(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Pg(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ab(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ab(t.arrayValue.values[r]);return e}return Object.assign({},t)}function WJ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const XJ={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function pve(t){return"nullValue"in t?iE:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?m2(ym.empty(),Jr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Nj(t)?XJ:{mapValue:{}}:dn()}function gve(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?m2(ym.empty(),Jr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?XJ:"mapValue"in t?Nj(t)?{mapValue:{}}:$0:dn()}function E7(t,e){const r=bm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function S7(t,e){const r=bm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e){this.value=e}static empty(){return new El({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!oE(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ab(r)}setAll(e){let r=Hs.emptyPath(),n={},a=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,a),n={},a=[],r=l.popLast()}o?n[l.lastSegment()]=Ab(o):a.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(e){const r=this.field(e.popLast());oE(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return oh(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];oE(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Pg(r,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new El(Ab(this.value))}}function YJ(t){const e=[];return Pg(t.fields,(r,n)=>{const a=new Hs([r]);if(oE(n)){const s=YJ(n.mapValue).fields;if(s.length===0)e.push(a);else for(const o of s)e.push(a.child(o))}else e.push(a)}),new eu(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,r,n,a,s,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Vs(e,0,Cn.min(),Cn.min(),Cn.min(),El.empty(),0)}static newFoundDocument(e,r,n,a){return new Vs(e,1,r,Cn.min(),n,a,0)}static newNoDocument(e,r){return new Vs(e,2,r,Cn.min(),Cn.min(),El.empty(),0)}static newUnknownDocument(e,r){return new Vs(e,3,r,Cn.min(),Cn.min(),El.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Cn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=El.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=El.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Cn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,r){this.position=e,this.inclusive=r}}function I7(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const s=e[a],o=t.position[a];if(s.field.isKeyField()?n=Jr.comparator(Jr.fromName(o.referenceValue),r.key):n=bm(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function j7(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!oh(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e,r="asc"){this.field=e,this.dir=r}}function xve(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JJ{}class Aa extends JJ{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new vve(e,r,n):r==="array-contains"?new wve(e,n):r==="in"?new aZ(e,n):r==="not-in"?new Nve(e,n):r==="array-contains-any"?new Cve(e,n):new Aa(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new yve(e,n):new bve(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(bm(r,this.value)):r!==null&&ag(this.value)===ag(r)&&this.matchesComparison(bm(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends JJ{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ts(e,r)}matches(e){return kv(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function kv(t){return t.op==="and"}function zT(t){return t.op==="or"}function WD(t){return ZJ(t)&&kv(t)}function ZJ(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function WT(t){if(t instanceof Aa)return t.field.canonicalString()+t.op.toString()+Bv(t.value);if(WD(t))return t.filters.map(e=>WT(e)).join(",");{const e=t.filters.map(r=>WT(r)).join(",");return`${t.op}(${e})`}}function eZ(t,e){return t instanceof Aa?function(n,a){return a instanceof Aa&&n.op===a.op&&n.field.isEqual(a.field)&&oh(n.value,a.value)}(t,e):t instanceof ts?function(n,a){return a instanceof ts&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,o,l)=>s&&eZ(o,a.filters[l]),!0):!1}(t,e):void dn()}function tZ(t,e){const r=t.filters.concat(e);return ts.create(r,t.op)}function rZ(t){return t instanceof Aa?function(r){return`${r.field.canonicalString()} ${r.op} ${Bv(r.value)}`}(t):t instanceof ts?function(r){return r.op.toString()+" {"+r.getFilters().map(rZ).join(" ,")+"}"}(t):"Filter"}class vve extends Aa{constructor(e,r,n){super(e,r,n),this.key=Jr.fromName(n.referenceValue)}matches(e){const r=Jr.comparator(e.key,this.key);return this.matchesComparison(r)}}class yve extends Aa{constructor(e,r){super(e,"in",r),this.keys=nZ("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class bve extends Aa{constructor(e,r){super(e,"not-in",r),this.keys=nZ("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function nZ(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Jr.fromName(n.referenceValue))}class wve extends Aa{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return p2(r)&&A2(r.arrayValue,this.value)}}class aZ extends Aa{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&A2(this.value.arrayValue,r)}}class Nve extends Aa{constructor(e,r){super(e,"not-in",r)}matches(e){if(A2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!A2(this.value.arrayValue,r)}}class Cve extends Aa{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!p2(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>A2(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ve{constructor(e,r=null,n=[],a=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function XT(t,e=null,r=[],n=[],a=null,s=null,o=null){return new _ve(t,e,r,n,a,s,o)}function sg(t){const e=Ln(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>WT(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Cw(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Bv(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Bv(n)).join(",")),e.ue=r}return e.ue}function _w(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!xve(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!eZ(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!j7(t.startAt,e.startAt)&&j7(t.endAt,e.endAt)}function oS(t){return Jr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function lS(t,e){return t.filters.filter(r=>r instanceof Aa&&r.field.isEqual(e))}function P7(t,e,r){let n=iE,a=!0;for(const s of lS(t,e)){let o=iE,l=!0;switch(s.op){case"<":case"<=":o=pve(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=iE}E7({value:n,inclusive:a},{value:o,inclusive:l})<0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];E7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})<0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}function B7(t,e,r){let n=$0,a=!0;for(const s of lS(t,e)){let o=$0,l=!0;switch(s.op){case">=":case">":o=gve(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=$0}S7({value:n,inclusive:a},{value:o,inclusive:l})>0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];S7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})>0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,r=null,n=[],a=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Eve(t,e,r,n,a,s,o,l){return new l1(t,e,r,n,a,s,o,l)}function Ew(t){return new l1(t)}function T7(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function sZ(t){return t.collectionGroup!==null}function mb(t){const e=Ln(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new us(Hs.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new g2(s,n))}),r.has(Hs.keyField().canonicalString())||e.ce.push(new g2(Hs.keyField(),n))}return e.ce}function Id(t){const e=Ln(t);return e.le||(e.le=Sve(e,mb(t))),e.le}function Sve(t,e){if(t.limitType==="F")return XT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new g2(a.field,s)});const r=t.endAt?new Tv(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Tv(t.startAt.position,t.startAt.inclusive):null;return XT(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function YT(t,e){const r=t.filters.concat([e]);return new l1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function cS(t,e,r){return new l1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Cj(t,e){return _w(Id(t),Id(e))&&t.limitType===e.limitType}function iZ(t){return`${sg(Id(t))}|lt:${t.limitType}`}function _x(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>rZ(a)).join(", ")}]`),Cw(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>Bv(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>Bv(a)).join(",")),`Target(${n})`}(Id(t))}; limitType=${t.limitType})`}function Sw(t,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Jr.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,a){for(const s of mb(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(o,l,c){const u=I7(o,l,c);return o.inclusive?u<=0:u<0}(n.startAt,mb(n),a)||n.endAt&&!function(o,l,c){const u=I7(o,l,c);return o.inclusive?u>=0:u>0}(n.endAt,mb(n),a))}(t,e)}function Ive(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function oZ(t){return(e,r)=>{let n=!1;for(const a of mb(t)){const s=jve(a,e,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function jve(t,e,r){const n=t.field.isKeyField()?Jr.comparator(e.key,r.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?bm(c,u):dn()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return dn()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Pg(this.inner,(r,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return qJ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pve=new Ws(Jr.comparator);function Fu(){return Pve}const lZ=new Ws(Jr.comparator);function My(...t){let e=lZ;for(const r of t)e=e.insert(r.key,r);return e}function cZ(t){let e=lZ;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Yf(){return pb()}function uZ(){return pb()}function pb(){return new Lm(t=>t.toString(),(t,e)=>t.isEqual(e))}const Bve=new Ws(Jr.comparator),Tve=new us(Jr.comparator);function ra(...t){let e=Tve;for(const r of t)e=e.add(r);return e}const kve=new us(Gn);function Fve(){return kve}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:f2(e)?"-0":e}}function dZ(t){return{integerValue:""+t}}function Ove(t,e){return zxe(e)?dZ(e):XD(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(){this._=void 0}}function Dve(t,e,r){return t instanceof x2?function(a,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&qD(s)&&(s=zD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,e):t instanceof ig?hZ(t,e):t instanceof Fv?AZ(t,e):function(a,s){const o=fZ(a,s),l=k7(o)+k7(a.Pe);return qT(o)&&qT(a.Pe)?dZ(l):XD(a.serializer,l)}(t,e)}function Rve(t,e,r){return t instanceof ig?hZ(t,e):t instanceof Fv?AZ(t,e):r}function fZ(t,e){return t instanceof v2?function(n){return qT(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class x2 extends _j{}class ig extends _j{constructor(e){super(),this.elements=e}}function hZ(t,e){const r=mZ(e);for(const n of t.elements)r.some(a=>oh(a,n))||r.push(n);return{arrayValue:{values:r}}}class Fv extends _j{constructor(e){super(),this.elements=e}}function AZ(t,e){let r=mZ(e);for(const n of t.elements)r=r.filter(a=>!oh(a,n));return{arrayValue:{values:r}}}class v2 extends _j{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function k7(t){return Us(t.integerValue||t.doubleValue)}function mZ(t){return p2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pZ{constructor(e,r){this.field=e,this.transform=r}}function Mve(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof ig&&a instanceof ig||n instanceof Fv&&a instanceof Fv?Pv(n.elements,a.elements,oh):n instanceof v2&&a instanceof v2?oh(n.Pe,a.Pe):n instanceof x2&&a instanceof x2}(t.transform,e.transform)}class Lve{constructor(e,r){this.version=e,this.transformResults=r}}class $s{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new $s}static exists(e){return new $s(void 0,e)}static updateTime(e){return new $s(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lE(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ej{}function gZ(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new u1(t.key,$s.none()):new c1(t.key,t.data,$s.none());{const r=t.data,n=El.empty();let a=new us(Hs.comparator);for(let s of e.fields)if(!a.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),a=a.add(s)}return new OA(t.key,n,new eu(a.toArray()),$s.none())}}function Uve(t,e,r){t instanceof c1?function(a,s,o){const l=a.value.clone(),c=O7(a.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof OA?function(a,s,o){if(!lE(a.precondition,s))return void s.convertToUnknownDocument(o.version);const l=O7(a.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(xZ(a)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(a,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function gb(t,e,r,n){return t instanceof c1?function(s,o,l,c){if(!lE(s.precondition,o))return l;const u=s.value.clone(),d=D7(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof OA?function(s,o,l,c){if(!lE(s.precondition,o))return l;const u=D7(s.fieldTransforms,c,o),d=o.data;return d.setAll(xZ(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,o,l){return lE(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function Qve(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),s=fZ(n.transform,a||null);s!=null&&(r===null&&(r=El.empty()),r.set(n.field,s))}return r||null}function F7(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Pv(n,a,(s,o)=>Mve(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class c1 extends Ej{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class OA extends Ej{constructor(e,r,n,a,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function xZ(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function O7(t,e,r){const n=new Map;gn(t.length===r.length);for(let a=0;a<r.length;a++){const s=t[a],o=s.transform,l=e.data.field(s.field);n.set(s.field,Rve(o,l,r[a]))}return n}function D7(t,e,r){const n=new Map;for(const a of t){const s=a.transform,o=r.data.field(a.field);n.set(a.field,Dve(s,o,e))}return n}class u1 extends Ej{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class YD extends Ej{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&Uve(s,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=gb(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=gb(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=uZ();return this.mutations.forEach(a=>{const s=e.get(a.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(a.key)?null:l;const c=gZ(o,l);c!==null&&n.set(a.key,c),o.isValidDocument()||o.convertToNoDocument(Cn.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ra())}isEqual(e){return this.batchId===e.batchId&&Pv(this.mutations,e.mutations,(r,n)=>F7(r,n))&&Pv(this.baseMutations,e.baseMutations,(r,n)=>F7(r,n))}}class ZD{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){gn(e.mutations.length===n.length);let a=function(){return Bve}();const s=e.mutations;for(let o=0;o<s.length;o++)a=a.insert(s[o].key,n[o].version);return new ZD(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vve{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var to,ya;function vZ(t){switch(t){default:return dn();case fr.CANCELLED:case fr.UNKNOWN:case fr.DEADLINE_EXCEEDED:case fr.RESOURCE_EXHAUSTED:case fr.INTERNAL:case fr.UNAVAILABLE:case fr.UNAUTHENTICATED:return!1;case fr.INVALID_ARGUMENT:case fr.NOT_FOUND:case fr.ALREADY_EXISTS:case fr.PERMISSION_DENIED:case fr.FAILED_PRECONDITION:case fr.ABORTED:case fr.OUT_OF_RANGE:case fr.UNIMPLEMENTED:case fr.DATA_LOSS:return!0}}function yZ(t){if(t===void 0)return _c("GRPC error has no .code"),fr.UNKNOWN;switch(t){case to.OK:return fr.OK;case to.CANCELLED:return fr.CANCELLED;case to.UNKNOWN:return fr.UNKNOWN;case to.DEADLINE_EXCEEDED:return fr.DEADLINE_EXCEEDED;case to.RESOURCE_EXHAUSTED:return fr.RESOURCE_EXHAUSTED;case to.INTERNAL:return fr.INTERNAL;case to.UNAVAILABLE:return fr.UNAVAILABLE;case to.UNAUTHENTICATED:return fr.UNAUTHENTICATED;case to.INVALID_ARGUMENT:return fr.INVALID_ARGUMENT;case to.NOT_FOUND:return fr.NOT_FOUND;case to.ALREADY_EXISTS:return fr.ALREADY_EXISTS;case to.PERMISSION_DENIED:return fr.PERMISSION_DENIED;case to.FAILED_PRECONDITION:return fr.FAILED_PRECONDITION;case to.ABORTED:return fr.ABORTED;case to.OUT_OF_RANGE:return fr.OUT_OF_RANGE;case to.UNIMPLEMENTED:return fr.UNIMPLEMENTED;case to.DATA_LOSS:return fr.DATA_LOSS;default:return dn()}}(ya=to||(to={}))[ya.OK=0]="OK",ya[ya.CANCELLED=1]="CANCELLED",ya[ya.UNKNOWN=2]="UNKNOWN",ya[ya.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ya[ya.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ya[ya.NOT_FOUND=5]="NOT_FOUND",ya[ya.ALREADY_EXISTS=6]="ALREADY_EXISTS",ya[ya.PERMISSION_DENIED=7]="PERMISSION_DENIED",ya[ya.UNAUTHENTICATED=16]="UNAUTHENTICATED",ya[ya.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ya[ya.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ya[ya.ABORTED=10]="ABORTED",ya[ya.OUT_OF_RANGE=11]="OUT_OF_RANGE",ya[ya.UNIMPLEMENTED=12]="UNIMPLEMENTED",ya[ya.INTERNAL=13]="INTERNAL",ya[ya.UNAVAILABLE=14]="UNAVAILABLE",ya[ya.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hve(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ve=new kp([4294967295,4294967295],0);function R7(t){const e=Hve().encode(t),r=new PJ;return r.update(e),new Uint8Array(r.digest())}function M7(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new kp([r,n],0),new kp([a,s],0)]}class t6{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ly(`Invalid padding: ${r}`);if(n<0)throw new Ly(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ly(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ly(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=kp.fromNumber(this.Ie)}Ee(e,r,n){let a=e.add(r.multiply(kp.fromNumber(n)));return a.compare($ve)===1&&(a=new kp([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=R7(e),[n,a]=M7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);if(!this.de(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t6(s,a,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=R7(e),[n,a]=M7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ly extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,r,n,a,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,Iw.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Sj(Cn.min(),a,new Ws(Gn),Fu(),ra())}}class Iw{constructor(e,r,n,a,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Iw(n,r,ra(),ra(),ra())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,r,n,a){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=a}}class bZ{constructor(e,r){this.targetId=e,this.me=r}}class wZ{constructor(e,r,n=Wi.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class L7{constructor(){this.fe=0,this.ge=Q7(),this.pe=Wi.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ra(),r=ra(),n=ra();return this.ge.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:dn()}}),new Iw(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=Q7()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,gn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Kve{constructor(e){this.Le=e,this.Be=new Map,this.ke=Fu(),this.qe=U7(),this.Qe=new Ws(Gn)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:dn()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,a)=>{this.ze(a)&&r(a)})}He(e){const r=e.targetId,n=e.me.count,a=this.Je(r);if(a){const s=a.target;if(oS(s))if(n===0){const o=new Jr(s.path);this.Ue(r,o,Vs.newNoDocument(o,Cn.min()))}else gn(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let o,l;try{o=vm(n).toUint8Array()}catch(c){if(c instanceof zJ)return xm("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new t6(o,a,s)}catch(c){return xm(c instanceof Ly?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,s,null),a++)}),a}rt(e){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&oS(l.target)){const c=new Jr(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Vs.newNoDocument(c,e))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=ra();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const a=new Sj(e,r,this.Qe,this.ke,n);return this.ke=Fu(),this.qe=U7(),this.Qe=new Ws(Gn),a}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,r)?a.Fe(r,1):a.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new L7,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new us(Gn),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Fr("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new L7),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function U7(){return new Ws(Jr.comparator)}function Q7(){return new Ws(Jr.comparator)}const Gve={asc:"ASCENDING",desc:"DESCENDING"},qve={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zve={and:"AND",or:"OR"};class Wve{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function JT(t,e){return t.useProto3Json||Cw(e)?e:{value:e}}function Ov(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NZ(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Xve(t,e){return Ov(t,e.toTimestamp())}function rl(t){return gn(!!t),Cn.fromTimestamp(function(r){const n=xA(r);return new xr(n.seconds,n.nanos)}(t))}function r6(t,e){return ZT(t,e).canonicalString()}function ZT(t,e){const r=function(a){return new Pa(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function CZ(t){const e=Pa.fromString(t);return gn(kZ(e)),e}function y2(t,e){return r6(t.databaseId,e.path)}function nA(t,e){const r=CZ(e);if(r.get(1)!==t.databaseId.projectId)throw new Hr(fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Hr(fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Jr(SZ(r))}function _Z(t,e){return r6(t.databaseId,e)}function EZ(t){const e=CZ(t);return e.length===4?Pa.emptyPath():SZ(e)}function ek(t){return new Pa(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function SZ(t){return gn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function V7(t,e,r){return{name:y2(t,e),fields:r.value.mapValue.fields}}function Yve(t,e,r){const n=nA(t,e.name),a=rl(e.updateTime),s=e.createTime?rl(e.createTime):Cn.min(),o=new El({mapValue:{fields:e.fields}}),l=Vs.newFoundDocument(n,a,s,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function Jve(t,e){return"found"in e?function(n,a){gn(!!a.found),a.found.name,a.found.updateTime;const s=nA(n,a.found.name),o=rl(a.found.updateTime),l=a.found.createTime?rl(a.found.createTime):Cn.min(),c=new El({mapValue:{fields:a.found.fields}});return Vs.newFoundDocument(s,o,l,c)}(t,e):"missing"in e?function(n,a){gn(!!a.missing),gn(!!a.readTime);const s=nA(n,a.missing),o=rl(a.readTime);return Vs.newNoDocument(s,o)}(t,e):dn()}function Zve(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:dn()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(gn(d===void 0||typeof d=="string"),Wi.fromBase64String(d||"")):(gn(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Wi.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?fr.UNKNOWN:yZ(u.code);return new Hr(d,u.message||"")}(o);r=new wZ(n,a,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=nA(t,n.document.name),s=rl(n.document.updateTime),o=n.document.createTime?rl(n.document.createTime):Cn.min(),l=new El({mapValue:{fields:n.document.fields}}),c=Vs.newFoundDocument(a,s,o,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new cE(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=nA(t,n.document),s=n.readTime?rl(n.readTime):Cn.min(),o=Vs.newNoDocument(a,s),l=n.removedTargetIds||[];r=new cE([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=nA(t,n.document),s=n.removedTargetIds||[];r=new cE([],s,a,null)}else{if(!("filter"in e))return dn();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,o=new Vve(a,s),l=n.targetId;r=new bZ(l,o)}}return r}function b2(t,e){let r;if(e instanceof c1)r={update:V7(t,e.key,e.value)};else if(e instanceof u1)r={delete:y2(t,e.key)};else if(e instanceof OA)r={update:V7(t,e.key,e.data),updateMask:s1e(e.fieldMask)};else{if(!(e instanceof YD))return dn();r={verify:y2(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof x2)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ig)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof v2)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw dn()}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:Xve(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:dn()}(t,e.precondition)),r}function tk(t,e){const r=e.currentDocument?function(s){return s.updateTime!==void 0?$s.updateTime(rl(s.updateTime)):s.exists!==void 0?$s.exists(s.exists):$s.none()}(e.currentDocument):$s.none(),n=e.updateTransforms?e.updateTransforms.map(a=>function(o,l){let c=null;if("setToServerValue"in l)gn(l.setToServerValue==="REQUEST_TIME"),c=new x2;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new ig(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new Fv(d)}else"increment"in l?c=new v2(o,l.increment):dn();const u=Hs.fromServerFormat(l.fieldPath);return new pZ(u,c)}(t,a)):[];if(e.update){e.update.name;const a=nA(t,e.update.name),s=new El({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new eu(u.map(d=>Hs.fromServerFormat(d)))}(e.updateMask);return new OA(a,s,o,r,n)}return new c1(a,s,r,n)}if(e.delete){const a=nA(t,e.delete);return new u1(a,r)}if(e.verify){const a=nA(t,e.verify);return new YD(a,r)}return dn()}function e1e(t,e){return t&&t.length>0?(gn(e!==void 0),t.map(r=>function(a,s){let o=a.updateTime?rl(a.updateTime):rl(s);return o.isEqual(Cn.min())&&(o=rl(s)),new Lve(o,a.transformResults||[])}(r,e))):[]}function IZ(t,e){return{documents:[_Z(t,e.path)]}}function jZ(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=_Z(t,a);const s=function(u){if(u.length!==0)return TZ(ts.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(A){return{field:Ex(A.field),direction:r1e(A.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=JT(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:a}}function PZ(t){let e=EZ(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){gn(n===1);const d=r.from[0];d.allDescendants?a=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(f){const A=BZ(f);return A instanceof ts&&WD(A)?A.getFilters():[A]}(r.where));let o=[];r.orderBy&&(o=function(f){return f.map(A=>function(m){return new g2(Sx(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(A))}(r.orderBy));let l=null;r.limit&&(l=function(f){let A;return A=typeof f=="object"?f.value:f,Cw(A)?null:A}(r.limit));let c=null;r.startAt&&(c=function(f){const A=!!f.before,h=f.values||[];return new Tv(h,A)}(r.startAt));let u=null;return r.endAt&&(u=function(f){const A=!f.before,h=f.values||[];return new Tv(h,A)}(r.endAt)),Eve(e,a,o,s,l,"F",c,u)}function t1e(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dn()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function BZ(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Sx(r.unaryFilter.field);return Aa.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Sx(r.unaryFilter.field);return Aa.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Sx(r.unaryFilter.field);return Aa.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Sx(r.unaryFilter.field);return Aa.create(o,"!=",{nullValue:"NULL_VALUE"});default:return dn()}}(t):t.fieldFilter!==void 0?function(r){return Aa.create(Sx(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dn()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ts.create(r.compositeFilter.filters.map(n=>BZ(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return dn()}}(r.compositeFilter.op))}(t):dn()}function r1e(t){return Gve[t]}function n1e(t){return qve[t]}function a1e(t){return zve[t]}function Ex(t){return{fieldPath:t.canonicalString()}}function Sx(t){return Hs.fromServerFormat(t.fieldPath)}function TZ(t){return t instanceof Aa?function(r){if(r.op==="=="){if(_7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NAN"}};if(C7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(_7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NOT_NAN"}};if(C7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ex(r.field),op:n1e(r.op),value:r.value}}}(t):t instanceof ts?function(r){const n=r.getFilters().map(a=>TZ(a));return n.length===1?n[0]:{compositeFilter:{op:a1e(r.op),filters:n}}}(t):dn()}function s1e(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function kZ(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,r,n,a,s=Cn.min(),o=Cn.min(),l=Wi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Wh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FZ{constructor(e){this.ct=e}}function i1e(t,e){let r;if(e.document)r=Yve(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Jr.fromSegments(e.noDocument.path),a=lg(e.noDocument.readTime);r=Vs.newNoDocument(n,a),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return dn();{const n=Jr.fromSegments(e.unknownDocument.path),a=lg(e.unknownDocument.version);r=Vs.newUnknownDocument(n,a)}}return e.readTime&&r.setReadTime(function(a){const s=new xr(a[0],a[1]);return Cn.fromTimestamp(s)}(e.readTime)),r}function H7(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:uS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:y2(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ov(s,o.version.toTimestamp()),createTime:Ov(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:og(e.version)};else{if(!e.isUnknownDocument())return dn();n.unknownDocument={path:r.path.toArray(),version:og(e.version)}}return n}function uS(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function og(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function lg(t){const e=new xr(t.seconds,t.nanoseconds);return Cn.fromTimestamp(e)}function mp(t,e){const r=(e.baseMutations||[]).map(s=>tk(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>tk(t.ct,s)),a=xr.fromMillis(e.localWriteTimeMs);return new JD(e.batchId,a,r,n)}function Uy(t){const e=lg(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?lg(t.lastLimboFreeSnapshotVersion):Cn.min();let n;return n=function(s){return s.documents!==void 0}(t.query)?function(s){return gn(s.documents.length===1),Id(Ew(EZ(s.documents[0])))}(t.query):function(s){return Id(PZ(s))}(t.query),new Wh(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Wi.fromBase64String(t.resumeToken))}function OZ(t,e){const r=og(e.snapshotVersion),n=og(e.lastLimboFreeSnapshotVersion);let a;a=oS(e.target)?IZ(t.ct,e.target):jZ(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:sg(e.target),readTime:r,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function DZ(t){const e=PZ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cS(e,e.limit,"L"):e}function E4(t,e){return new e6(e.largestBatchId,tk(t.ct,e.overlayMutation))}function $7(t,e){const r=e.path.lastSegment();return[t,jc(e.path.popLast()),r]}function K7(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:og(n.readTime),documentKey:jc(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1e{getBundleMetadata(e,r){return G7(e).get(r).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:lg(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,r){return G7(e).put(function(a){return{bundleId:a.id,createTime:og(rl(a.createTime)),version:a.version}}(r))}getNamedQuery(e,r){return q7(e).get(r).next(n=>{if(n)return function(s){return{name:s.name,query:DZ(s.bundledQuery),readTime:lg(s.readTime)}}(n)})}saveNamedQuery(e,r){return q7(e).put(function(a){return{name:a.name,readTime:og(rl(a.readTime)),bundledQuery:a.bundledQuery}}(r))}}function G7(t){return Do(t,"bundles")}function q7(t){return Do(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new Ij(e,n)}getOverlay(e,r){return ry(e).get($7(this.userId,r)).next(n=>n?E4(this.serializer,n):null)}getOverlays(e,r){const n=Yf();return Jt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){const a=[];return n.forEach((s,o)=>{const l=new e6(r,o);a.push(this.ht(e,l))}),Jt.waitFor(a)}removeOverlaysForBatchId(e,r,n){const a=new Set;r.forEach(o=>a.add(jc(o.getCollectionPath())));const s=[];return a.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(ry(e).j("collectionPathOverlayIndex",l))}),Jt.waitFor(s)}getOverlaysForCollection(e,r,n){const a=Yf(),s=jc(r),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ry(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=E4(this.serializer,c);a.set(u.getKey(),u)}return a})}getOverlaysForCollectionGroup(e,r,n,a){const s=Yf();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return ry(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const f=E4(this.serializer,u);s.size()<a||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,r){return ry(e).put(function(a,s,o){const[l,c,u]=$7(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:b2(a.ct,o.mutation)}}(this.serializer,this.userId,r))}}function ry(t){return Do(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1e{Pt(e){return Do(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Wi.fromUint8Array(n):Wi.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(Us(e.integerValue));else if("doubleValue"in e){const n=Us(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),f2(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=xA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(vm(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?WJ(e)?this.dt(r,Number.MAX_SAFE_INTEGER):Nj(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):dn()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const a of Object.keys(n))this.Vt(a,r),this.Tt(n[a],r)}wt(e,r){var n,a;const s=e.fields||{};this.dt(r,53);const o="value",l=((a=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.length)||0;this.dt(r,15),r.At(Us(l)),this.Vt(o,r),this.Tt(s[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const a of n)this.Tt(a,r)}yt(e,r){this.dt(r,37),Jr.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}pp.vt=new pp;function c1e(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function z7(t){const e=64-function(n){let a=0;for(let s=0;s<8;++s){const o=c1e(255&n[s]);if(a+=o,o!==8)break}return a}(t);return Math.ceil(e/8)}class u1e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const a=r.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const a=r.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const r=this.qt(e),n=z7(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=255&r[a]}Kt(e){const r=this.qt(e),n=z7(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=~(255&r[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let a=1;a<r.length;++a)r[a]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class d1e{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class f1e{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ny{constructor(){this.jt=new u1e,this.Ht=new d1e(this.jt),this.Jt=new f1e(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,r,n,a){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=a}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new gp(this.indexId,this.documentKey,this.arrayValue,n)}}function l0(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=W7(t.arrayValue,e.arrayValue),r!==0?r:(r=W7(t.directionalValue,e.directionalValue),r!==0?r:Jr.comparator(t.documentKey,e.documentKey)))}function W7(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e){this.Xt=new us((r,n)=>Hs.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(gn(e.collectionGroup===this.collectionId),this.nn)return!1;const r=$T(e);if(r!==void 0&&!this.sn(r))return!1;const n=op(e);let a=new Set,s=0,o=0;for(;s<n.length&&this.sn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!a.has(l.field.canonicalString())){const c=n[s];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new us(Hs.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new aE(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new aE(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new aE(n.field,n.dir==="asc"?0:1)));return new iS(iS.UNKNOWN_ID,this.collectionId,r,d2.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RZ(t){var e,r;if(gn(t instanceof Aa||t instanceof ts),t instanceof Aa){if(t instanceof aZ){const a=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(s=>Aa.create(t.field,"==",s)))||[];return ts.create(a,"or")}return t}const n=t.filters.map(a=>RZ(a));return ts.create(n,t.op)}function h1e(t){if(t.getFilters().length===0)return[];const e=ak(RZ(t));return gn(MZ(e)),rk(e)||nk(e)?[e]:e.getFilters()}function rk(t){return t instanceof Aa}function nk(t){return t instanceof ts&&WD(t)}function MZ(t){return rk(t)||nk(t)||function(r){if(r instanceof ts&&zT(r)){for(const n of r.getFilters())if(!rk(n)&&!nk(n))return!1;return!0}return!1}(t)}function ak(t){if(gn(t instanceof Aa||t instanceof ts),t instanceof Aa)return t;if(t.filters.length===1)return ak(t.filters[0]);const e=t.filters.map(n=>ak(n));let r=ts.create(e,t.op);return r=dS(r),MZ(r)?r:(gn(r instanceof ts),gn(kv(r)),gn(r.filters.length>1),r.filters.reduce((n,a)=>n6(n,a)))}function n6(t,e){let r;return gn(t instanceof Aa||t instanceof ts),gn(e instanceof Aa||e instanceof ts),r=t instanceof Aa?e instanceof Aa?function(a,s){return ts.create([a,s],"and")}(t,e):Y7(t,e):e instanceof Aa?Y7(e,t):function(a,s){if(gn(a.filters.length>0&&s.filters.length>0),kv(a)&&kv(s))return tZ(a,s.getFilters());const o=zT(a)?a:s,l=zT(a)?s:a,c=o.filters.map(u=>n6(u,l));return ts.create(c,"or")}(t,e),dS(r)}function Y7(t,e){if(kv(e))return tZ(e,t.getFilters());{const r=e.filters.map(n=>n6(t,n));return ts.create(r,"or")}}function dS(t){if(gn(t instanceof Aa||t instanceof ts),t instanceof Aa)return t;const e=t.getFilters();if(e.length===1)return dS(e[0]);if(ZJ(t))return t;const r=e.map(a=>dS(a)),n=[];return r.forEach(a=>{a instanceof Aa?n.push(a):a instanceof ts&&(a.op===t.op?n.push(...a.filters):n.push(a))}),n.length===1?n[0]:ts.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1e{constructor(){this.un=new a6}addToCollectionParentIndex(e,r){return this.un.add(r),Jt.resolve()}getCollectionParents(e,r){return Jt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Jt.resolve()}deleteFieldIndex(e,r){return Jt.resolve()}deleteAllFieldIndexes(e){return Jt.resolve()}createTargetIndexes(e,r){return Jt.resolve()}getDocumentsMatchingTarget(e,r){return Jt.resolve(null)}getIndexType(e,r){return Jt.resolve(0)}getFieldIndexes(e,r){return Jt.resolve([])}getNextCollectionGroupToUpdate(e){return Jt.resolve(null)}getMinOffset(e,r){return Jt.resolve(Qu.min())}getMinOffsetFromCollectionGroup(e,r){return Jt.resolve(Qu.min())}updateCollectionGroup(e,r,n){return Jt.resolve()}updateIndexEntries(e,r){return Jt.resolve()}}class a6{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new us(Pa.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new us(Pa.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=new Uint8Array(0);class m1e{constructor(e,r){this.databaseId=r,this.cn=new a6,this.ln=new Lm(n=>sg(n),(n,a)=>_w(n,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),a=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const s={collectionId:n,parent:jc(a)};return J7(e).put(s)}return Jt.resolve()}getCollectionParents(e,r){const n=[],a=IDBKeyRange.bound([r,""],[MJ(r),""],!1,!0);return J7(e).U(a).next(s=>{for(const o of s){if(o.collectionId!==r)break;n.push(Xf(o.parent))}return n})}addFieldIndex(e,r){const n=ay(e),a=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete a.indexId;const s=n.add(a);if(r.indexState){const o=ex(e);return s.next(l=>{o.put(K7(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return s.next()}deleteFieldIndex(e,r){const n=ay(e),a=ex(e),s=Zg(e);return n.delete(r.indexId).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=ay(e),n=Zg(e),a=ex(e);return r.j().next(()=>n.j()).next(()=>a.j())}createTargetIndexes(e,r){return Jt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(a=>{if(a===0||a===1){const s=new X7(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,r){const n=Zg(e);let a=!0;const s=new Map;return Jt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{a&&(a=!!l),s.set(o,l)})).next(()=>{if(a){let o=ra();const l=[];return Jt.forEach(s,(c,u)=>{Fr("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(w=>`${w.fieldPath}:${w.kind}`).join(",")}`}(c)} to execute ${sg(r)}`);const d=function(b,w){const j=$T(w);if(j===void 0)return null;for(const I of lS(b,j.fieldPath))switch(I.op){case"array-contains-any":return I.value.arrayValue.values||[];case"array-contains":return[I.value]}return null}(u,c),f=function(b,w){const j=new Map;for(const I of op(w))for(const _ of lS(b,I.fieldPath))switch(_.op){case"==":case"in":j.set(I.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return j.set(I.fieldPath.canonicalString(),_.value),Array.from(j.values())}return null}(u,c),A=function(b,w){const j=[];let I=!0;for(const _ of op(w)){const S=_.kind===0?P7(b,_.fieldPath,b.startAt):B7(b,_.fieldPath,b.startAt);j.push(S.value),I&&(I=S.inclusive)}return new Tv(j,I)}(u,c),h=function(b,w){const j=[];let I=!0;for(const _ of op(w)){const S=_.kind===0?B7(b,_.fieldPath,b.endAt):P7(b,_.fieldPath,b.endAt);j.push(S.value),I&&(I=S.inclusive)}return new Tv(j,I)}(u,c),m=this.In(c,u,A),p=this.In(c,u,h),x=this.Tn(c,u,f),v=this.En(c.indexId,d,m,A.inclusive,p,h.inclusive,x);return Jt.forEach(v,y=>n.G(y,r.limit).next(b=>{b.forEach(w=>{const j=Jr.fromSegments(w.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return Jt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=h1e(ts.create(e.filters,"and")).map(n=>XT(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,a,s,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,s.length),u=c/(r!=null?r.length:1),d=[];for(let f=0;f<c;++f){const A=r?this.dn(r[f/u]):rC,h=this.An(e,A,n[f%u],a),m=this.Rn(e,A,s[f%u],o),p=l.map(x=>this.An(e,A,x,!0));d.push(...this.createRange(h,m,p))}return d}An(e,r,n,a){const s=new gp(e,Jr.empty(),r,n);return a?s:s.Zt()}Rn(e,r,n,a){const s=new gp(e,Jr.empty(),r,n);return a?s.Zt():s}Pn(e,r){const n=new X7(r),a=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,a).next(s=>{let o=null;for(const l of s)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const a=this.hn(r);return Jt.forEach(a,s=>this.Pn(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let u=new us(Hs.comparator),d=!1;for(const f of c.filters)for(const A of f.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?d=!0:u=u.add(A.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&a.length>1&&n===2?1:n)}Vn(e,r){const n=new ny;for(const a of op(e)){const s=r.data.field(a.fieldPath);if(s==null)return null;const o=n.Yt(a.kind);pp.vt.It(s,o)}return n.zt()}dn(e){const r=new ny;return pp.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new ny;return pp.vt.It(m2(this.databaseId,r),n.Yt(function(s){const o=op(s);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let a=[];a.push(new ny);let s=0;for(const o of op(e)){const l=n[s++];for(const c of a)if(this.fn(r,o.fieldPath)&&p2(l))a=this.gn(a,o,l);else{const u=c.Yt(o.kind);pp.vt.It(l,u)}}return this.pn(a)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const a=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of a){const c=new ny;c.seed(l.zt()),pp.vt.It(o,c.Yt(r.kind)),s.push(c)}return s}fn(e,r){return!!e.filters.find(n=>n instanceof Aa&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=ay(e),a=ex(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(s=>{const o=[];return Jt.forEach(s,l=>a.get([l.indexId,this.uid]).next(c=>{o.push(function(d,f){const A=f?new d2(f.sequenceNumber,new Qu(lg(f.readTime),new Jr(Xf(f.documentKey)),f.largestBatchId)):d2.empty(),h=d.fields.map(([m,p])=>new aE(Hs.fromServerFormat(m),p));return new iS(d.indexId,d.collectionGroup,h,A)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:Gn(n.collectionGroup,a.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const a=ay(e),s=ex(e);return this.yn(e).next(o=>a.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>Jt.forEach(l,c=>s.put(K7(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return Jt.forEach(r,(a,s)=>{const o=n.get(a.collectionGroup);return(o?Jt.resolve(o):this.getFieldIndexes(e,a.collectionGroup)).next(l=>(n.set(a.collectionGroup,l),Jt.forEach(l,c=>this.wn(e,a,c).next(u=>{const d=this.Sn(s,c);return u.isEqual(d)?Jt.resolve():this.bn(e,s,c,u,d)}))))})}Dn(e,r,n,a){return Zg(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,a){return Zg(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const a=Zg(e);let s=new us(l0);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{s=s.add(new gp(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,r){let n=new us(l0);const a=this.Vn(r,e);if(a==null)return n;const s=$T(r);if(s!=null){const o=e.data.field(s.fieldPath);if(p2(o))for(const l of o.arrayValue.values||[])n=n.add(new gp(r.indexId,e.key,this.dn(l),a))}else n=n.add(new gp(r.indexId,e.key,rC,a));return n}bn(e,r,n,a,s){Fr("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,u,d,f,A){const h=c.getIterator(),m=u.getIterator();let p=Jg(h),x=Jg(m);for(;p||x;){let v=!1,y=!1;if(p&&x){const b=d(p,x);b<0?y=!0:b>0&&(v=!0)}else p!=null?y=!0:v=!0;v?(f(x),x=Jg(m)):y?(A(p),p=Jg(h)):(p=Jg(h),x=Jg(m))}}(a,s,l0,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),Jt.waitFor(o)}yn(e){let r=1;return ex(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,a,s)=>{s.done(),r=a.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>l0(o,l)).filter((o,l,c)=>!l||l0(o,c[l-1])!==0);const a=[];a.push(e);for(const o of n){const l=l0(o,e),c=l0(o,r);if(l===0)a[0]=e.Zt();else if(l>0&&c<0)a.push(o),a.push(o.Zt());else if(c>0)break}a.push(r);const s=[];for(let o=0;o<a.length;o+=2){if(this.Cn(a[o],a[o+1]))return[];const l=[a[o].indexId,this.uid,a[o].arrayValue,a[o].directionalValue,rC,[]],c=[a[o+1].indexId,this.uid,a[o+1].arrayValue,a[o+1].directionalValue,rC,[]];s.push(IDBKeyRange.bound(l,c))}return s}Cn(e,r){return l0(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(Z7)}getMinOffset(e,r){return Jt.mapArray(this.hn(r),n=>this.Pn(e,n).next(a=>a||dn())).next(Z7)}}function J7(t){return Do(t,"collectionParents")}function Zg(t){return Do(t,"indexEntries")}function ay(t){return Do(t,"indexConfiguration")}function ex(t){return Do(t,"indexState")}function Z7(t){gn(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const a=t[n].indexState.offset;$D(a,e)<0&&(e=a),r<a.largestBatchId&&(r=a.largestBatchId)}return new Qu(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e9={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Wc{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Wc(e,Wc.DEFAULT_COLLECTION_PERCENTILE,Wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LZ(t,e,r){const n=t.store("mutations"),a=t.store("documentMutations"),s=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(d,f,A)=>(l++,A.delete()));s.push(c.next(()=>{gn(l===1)}));const u=[];for(const d of r.mutations){const f=HJ(e,d.key.path,r.batchId);s.push(a.delete(f)),u.push(d.key)}return Jt.waitFor(s).next(()=>u)}function fS(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw dn();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wc.DEFAULT_COLLECTION_PERCENTILE=10,Wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wc.DEFAULT=new Wc(41943040,Wc.DEFAULT_COLLECTION_PERCENTILE,Wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wc.DISABLED=new Wc(-1,0,0);class jj{constructor(e,r,n,a){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=a,this.Fn={}}static lt(e,r,n,a){gn(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new jj(s,r,n,a)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return c0(e).J({index:"userMutationsIndex",range:n},(a,s,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,a){const s=Ix(e),o=c0(e);return o.add({}).next(l=>{gn(typeof l=="number");const c=new JD(l,r,n,a),u=function(h,m,p){const x=p.baseMutations.map(y=>b2(h.ct,y)),v=p.mutations.map(y=>b2(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:v}}(this.serializer,this.userId,c),d=[];let f=new us((A,h)=>Gn(A.canonicalString(),h.canonicalString()));for(const A of a){const h=HJ(this.userId,A.key.path,l);f=f.add(A.key.path.popLast()),d.push(o.put(u)),d.push(s.put(h,Xxe))}return f.forEach(A=>{d.push(this.indexManager.addToCollectionParentIndex(e,A))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Jt.waitFor(d).next(()=>c)})}lookupMutationBatch(e,r){return c0(e).get(r).next(n=>n?(gn(n.userId===this.userId),mp(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?Jt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const a=n.keys();return this.Fn[r]=a,a}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return c0(e).J({index:"userMutationsIndex",range:a},(o,l,c)=>{l.userId===this.userId&&(gn(l.batchId>=n),s=mp(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return c0(e).J({index:"userMutationsIndex",range:r,reverse:!0},(a,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return c0(e).U("userMutationsIndex",r).next(n=>n.map(a=>mp(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=sE(this.userId,r.path),a=IDBKeyRange.lowerBound(n),s=[];return Ix(e).J({range:a},(o,l,c)=>{const[u,d,f]=o,A=Xf(d);if(u===this.userId&&r.path.isEqual(A))return c0(e).get(f).next(h=>{if(!h)throw dn();gn(h.userId===this.userId),s.push(mp(this.serializer,h))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new us(Gn);const a=[];return r.forEach(s=>{const o=sE(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=Ix(e).J({range:l},(u,d,f)=>{const[A,h,m]=u,p=Xf(h);A===this.userId&&s.path.isEqual(p)?n=n.add(m):f.done()});a.push(c)}),Jt.waitFor(a).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1,s=sE(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new us(Gn);return Ix(e).J({range:o},(c,u,d)=>{const[f,A,h]=c,m=Xf(A);f===this.userId&&n.isPrefixOf(m)?m.length===a&&(l=l.add(h)):d.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],a=[];return r.forEach(s=>{a.push(c0(e).get(s).next(o=>{if(o===null)throw dn();gn(o.userId===this.userId),n.push(mp(this.serializer,o))}))}),Jt.waitFor(a).next(()=>n)}removeMutationBatch(e,r){return LZ(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),Jt.forEach(n,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Jt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),a=[];return Ix(e).J({range:n},(s,o,l)=>{if(s[0]===this.userId){const c=Xf(s[1]);a.push(c)}else l.done()}).next(()=>{gn(a.length===0)})})}containsKey(e,r){return UZ(e,this.userId,r)}Nn(e){return QZ(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function UZ(t,e,r){const n=sE(e,r.path),a=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return Ix(t).J({range:s,H:!0},(l,c,u)=>{const[d,f,A]=l;d===e&&f===a&&(o=!0),u.done()}).next(()=>o)}function c0(t){return Do(t,"mutations")}function Ix(t){return Do(t,"documentMutations")}function QZ(t){return Do(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new cg(0)}static kn(){return new cg(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1e{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new cg(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>Cn.fromTimestamp(new xr(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(a=>(a.highestListenSequenceNumber=r,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),r>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=r),this.Qn(e,a)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>tx(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(gn(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let a=0;const s=[];return tx(e).J((o,l)=>{const c=Uy(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(a++,s.push(this.removeTargetData(e,c)))}).next(()=>Jt.waitFor(s)).next(()=>a)}forEachTarget(e,r){return tx(e).J((n,a)=>{const s=Uy(a);r(s)})}qn(e){return t9(e).get("targetGlobalKey").next(r=>(gn(r!==null),r))}Qn(e,r){return t9(e).put("targetGlobalKey",r)}Kn(e,r){return tx(e).put(OZ(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=sg(r),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return tx(e).J({range:a,index:"queryTargetsIndex"},(o,l,c)=>{const u=Uy(l);_w(r,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,r,n){const a=[],s=R0(e);return r.forEach(o=>{const l=jc(o.path);a.push(s.put({targetId:n,path:l})),a.push(this.referenceDelegate.addReference(e,n,o))}),Jt.waitFor(a)}removeMatchingKeys(e,r,n){const a=R0(e);return Jt.forEach(r,s=>{const o=jc(s.path);return Jt.waitFor([a.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,r){const n=R0(e),a=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),a=R0(e);let s=ra();return a.J({range:n,H:!0},(o,l,c)=>{const u=Xf(o[1]),d=new Jr(u);s=s.add(d)}).next(()=>s)}containsKey(e,r){const n=jc(r.path),a=IDBKeyRange.bound([n],[MJ(n)],!1,!0);let s=0;return R0(e).J({index:"documentTargetsIndex",H:!0,range:a},([o,l],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,r){return tx(e).get(r).next(n=>n?Uy(n):null)}}function tx(t){return Do(t,"targets")}function t9(t){return Do(t,"targetGlobal")}function R0(t){return Do(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r9([t,e],[r,n]){const a=Gn(t,r);return a===0?Gn(e,n):a}class g1e{constructor(e){this.Un=e,this.buffer=new us(r9),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();r9(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class x1e{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Fr("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Mm(r)?Fr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await jg(r)}await this.Hn(3e5)})}}class v1e{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Jt.resolve(wd.oe);const n=new g1e(r);return this.Jn.forEachTarget(e,a=>n.zn(a.sequenceNumber)).next(()=>this.Jn.Zn(e,a=>n.zn(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Fr("LruGarbageCollector","Garbage collection skipped; disabled"),Jt.resolve(e9)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Fr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),e9):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,a,s,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Fr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),a=this.params.maximumSequenceNumbersToCollect):a=f,o=Date.now(),this.nthSequenceNumber(e,a))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,r))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(u=Date.now(),Cx()<=ha.DEBUG&&Fr("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${a} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Jt.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:f})))}}function y1e(t,e){return new v1e(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1e{constructor(e,r){this.db=e,this.garbageCollector=y1e(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,a)=>r(a))}addReference(e,r,n){return nC(e,n)}removeReference(e,r,n){return nC(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return nC(e,r)}nr(e,r){return function(a,s){let o=!1;return QZ(a).Y(l=>UZ(a,l,s).next(c=>(c&&(o=!0),Jt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(u=>{if(!u)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,Cn.min()),R0(e).delete(function(f){return[0,jc(f.path)]}(o))))});a.push(c)}}).next(()=>Jt.waitFor(a)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return nC(e,r)}tr(e,r){const n=R0(e);let a,s=wd.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{o===0?(s!==wd.oe&&r(new Jr(Xf(a)),s),s=u,a=c):s=wd.oe}).next(()=>{s!==wd.oe&&r(new Jr(Xf(a)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nC(t,e){return R0(t).put(function(n,a){return{targetId:0,path:jc(n.path),sequenceNumber:a}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VZ{constructor(){this.changes=new Lm(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Vs.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Jt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Wm(e).put(n)}removeEntry(e,r,n){return Wm(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],uS(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=Vs.newInvalidDocument(r);return Wm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(sy(r))},(a,s)=>{n=this.ir(r,s)}).next(()=>n)}sr(e,r){let n={size:0,document:Vs.newInvalidDocument(r)};return Wm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(sy(r))},(a,s)=>{n={document:this.ir(r,s),size:fS(s)}}).next(()=>n)}getEntries(e,r){let n=Fu();return this._r(e,r,(a,s)=>{const o=this.ir(a,s);n=n.insert(a,o)}).next(()=>n)}ar(e,r){let n=Fu(),a=new Ws(Jr.comparator);return this._r(e,r,(s,o)=>{const l=this.ir(s,o);n=n.insert(s,l),a=a.insert(s,fS(o))}).next(()=>({documents:n,ur:a}))}_r(e,r,n){if(r.isEmpty())return Jt.resolve();let a=new us(s9);r.forEach(c=>a=a.add(c));const s=IDBKeyRange.bound(sy(a.first()),sy(a.last())),o=a.getIterator();let l=o.getNext();return Wm(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{const f=Jr.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&s9(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,u),l=o.hasNext()?o.getNext():null),l?d.$(sy(l)):d.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,a,s){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),uS(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Wm(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=Fu();for(const f of u){const A=this.ir(Jr.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);A.isFoundDocument()&&(Sw(r,A)||a.has(A.key))&&(d=d.insert(A.key,A))}return d})}getAllFromCollectionGroup(e,r,n,a){let s=Fu();const o=a9(r,n),l=a9(r,Qu.max());return Wm(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const f=this.ir(Jr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===a&&d.done()}).next(()=>s)}newChangeBuffer(e){return new N1e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return n9(e).get("remoteDocumentGlobalKey").next(r=>(gn(!!r),r))}rr(e,r){return n9(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=i1e(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(Cn.min())))return n}return Vs.newInvalidDocument(e)}}function HZ(t){return new w1e(t)}class N1e extends VZ{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new Lm(n=>n.toString(),(n,a)=>n.isEqual(a))}applyChanges(e){const r=[];let n=0,a=new us((s,o)=>Gn(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(r.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=H7(this.cr.serializer,o);a=a.add(s.path.popLast());const u=fS(c);n+=u-l.size,r.push(this.cr.addEntry(e,s,c))}else if(n-=l.size,this.trackRemovals){const c=H7(this.cr.serializer,o.convertToNoDocument(Cn.min()));r.push(this.cr.addEntry(e,s,c))}}),a.forEach(s=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),r.push(this.cr.updateMetadata(e,n)),Jt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:a})=>(a.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function n9(t){return Do(t,"remoteDocumentGlobal")}function Wm(t){return Do(t,"remoteDocumentsV14")}function sy(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function a9(t,e){const r=e.documentKey.path.toArray();return[t,uS(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function s9(t,e){const r=t.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<r.length-2&&s<n.length-2;++s)if(a=Gn(r[s],n[s]),a)return a;return a=Gn(r.length,n.length),a||(a=Gn(r[r.length-2],n[n.length-2]),a||Gn(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Z{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&gb(n.mutation,a,eu.empty(),xr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ra()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ra()){const a=Yf();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(s=>{let o=My();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Yf();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ra()))}populateOverlays(e,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,a){let s=Fu();const o=pb(),l=function(){return pb()}();return r.forEach((c,u)=>{const d=n.get(u.key);a.has(u.key)&&(d===void 0||d.mutation instanceof OA)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),gb(d.mutation,u,d.mutation.getFieldMask(),xr.now())):o.set(u.key,eu.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),r.forEach((u,d)=>{var f;return l.set(u,new C1e(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=pb();let a=new Ws((o,l)=>o-l),s=ra();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||eu.empty();d=l.applyToLocalView(u,d),n.set(c,d);const f=(a.get(l.batchId)||ra()).add(c);a=a.insert(l.batchId,f)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=uZ();d.forEach(A=>{if(!s.has(A)){const h=gZ(r.get(A),n.get(A));h!==null&&f.set(A,h),s=s.add(A)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Jt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(o){return Jr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):sZ(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(s=>{const o=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-s.size):Jt.resolve(Yf());let l=-1,c=s;return o.next(u=>Jt.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(d)?Jt.resolve():this.remoteDocumentCache.getEntry(e,d).next(A=>{c=c.insert(d,A)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,ra())).next(d=>({batchId:l,changes:cZ(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Jr(r)).next(n=>{let a=My();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const s=r.collectionGroup;let o=My();return this.indexManager.getCollectionParents(e,s).next(l=>Jt.forEach(l,c=>{const u=function(f,A){return new l1(A,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,a).next(d=>{d.forEach((f,A)=>{o=o.insert(f,A)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,a))).next(o=>{s.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Vs.newInvalidDocument(d)))});let l=My();return o.forEach((c,u)=>{const d=s.get(c);d!==void 0&&gb(d.mutation,u,eu.empty(),xr.now()),Sw(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1e{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Jt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:rl(a.createTime)}}(r)),Jt.resolve()}getNamedQuery(e,r){return Jt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(a){return{name:a.name,query:DZ(a.bundledQuery),readTime:rl(a.readTime)}}(r)),Jt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1e{constructor(){this.overlays=new Ws(Jr.comparator),this.Ir=new Map}getOverlay(e,r){return Jt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Yf();return Jt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,s)=>{this.ht(e,r,s)}),Jt.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Jt.resolve()}getOverlaysForCollection(e,r,n){const a=Yf(),s=r.length+1,o=new Jr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>n&&a.set(c.getKey(),c)}return Jt.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let s=new Ws((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=s.get(u.largestBatchId);d===null&&(d=Yf(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Yf(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=a)););return Jt.resolve(l)}ht(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new e6(r,n));let s=this.Ir.get(r);s===void 0&&(s=ra(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1e{constructor(){this.sessionToken=Wi.EMPTY_BYTE_STRING}getSessionToken(e){return Jt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Jt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(){this.Tr=new us(zo.Er),this.dr=new us(zo.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new zo(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new zo(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Jr(new Pa([])),n=new zo(r,e),a=new zo(r,e+1),s=[];return this.dr.forEachInRange([n,a],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Jr(new Pa([])),n=new zo(r,e),a=new zo(r,e+1);let s=ra();return this.dr.forEachInRange([n,a],o=>{s=s.add(o.key)}),s}containsKey(e){const r=new zo(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class zo{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Jr.comparator(e.key,r.key)||Gn(e.wr,r.wr)}static Ar(e,r){return Gn(e.wr,r.wr)||Jr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new us(zo.Er)}checkEmpty(e){return Jt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new JD(s,r,n,a);this.mutationQueue.push(o);for(const l of a)this.br=this.br.add(new zo(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Jt.resolve(o)}lookupMutationBatch(e,r){return Jt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.vr(n),s=a<0?0:a;return Jt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Jt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Jt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new zo(r,0),a=new zo(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,a],o=>{const l=this.Dr(o.wr);s.push(l)}),Jt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new us(Gn);return r.forEach(a=>{const s=new zo(a,0),o=new zo(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),Jt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let s=n;Jr.isDocumentKey(s)||(s=s.child(""));const o=new zo(new Jr(s),0);let l=new us(Gn);return this.br.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===a&&(l=l.add(c.wr)),!0)},o),Jt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const a=this.Dr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){gn(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Jt.forEach(r.mutations,a=>{const s=new zo(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new zo(r,0),a=this.br.firstAfterOrEqual(n);return Jt.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Jt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1e{constructor(e){this.Mr=e,this.docs=function(){return new Ws(Jr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Jt.resolve(n?n.document.mutableCopy():Vs.newInvalidDocument(r))}getEntries(e,r){let n=Fu();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():Vs.newInvalidDocument(a))}),Jt.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let s=Fu();const o=r.path,l=new Jr(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||$D(LJ(d),n)<=0||(a.has(d.key)||Sw(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Jt.resolve(s)}getAllFromCollectionGroup(e,r,n,a){dn()}Or(e,r){return Jt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new P1e(this)}getSize(e){return Jt.resolve(this.size)}}class P1e extends VZ{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)}),Jt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1e{constructor(e){this.persistence=e,this.Nr=new Lm(r=>sg(r),_w),this.lastRemoteSnapshotVersion=Cn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new s6,this.targetCount=0,this.kr=cg.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,a)=>r(a)),Jt.resolve()}getLastRemoteSnapshotVersion(e){return Jt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Jt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Jt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Jt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new cg(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Jt.resolve()}updateTargetData(e,r){return this.Kn(r),Jt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Jt.resolve()}removeTargets(e,r,n){let a=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)}),Jt.waitFor(s).next(()=>a)}getTargetCount(e){return Jt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Jt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Jt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(o=>{s.push(a.markPotentiallyOrphaned(e,o))}),Jt.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Jt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Jt.resolve(n)}containsKey(e,r){return Jt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KZ{constructor(e,r){this.qr={},this.overlays={},this.Qr=new wd(0),this.Kr=!1,this.Kr=!0,this.$r=new S1e,this.referenceDelegate=e(this),this.Ur=new B1e(this),this.indexManager=new A1e,this.remoteDocumentCache=function(a){return new j1e(a)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new FZ(r),this.Gr=new _1e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new E1e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new I1e(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Fr("MemoryPersistence","Starting transaction:",e);const a=new T1e(this.Qr.next());return this.referenceDelegate.zr(),n(a).next(s=>this.referenceDelegate.jr(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Hr(e,r){return Jt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class T1e extends QJ{constructor(e){super(),this.currentSequenceNumber=e}}class Pj{constructor(e){this.persistence=e,this.Jr=new s6,this.Yr=null}static Zr(e){return new Pj(e)}get Xr(){if(this.Yr)return this.Yr;throw dn()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Jt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Jt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Jt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(a=>this.Xr.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Jt.forEach(this.Xr,n=>{const a=Jr.fromPath(n);return this.ei(e,a).next(s=>{s||r.removeEntry(a,Cn.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Jt.or([()=>Jt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1e{constructor(e){this.serializer=e}O(e,r,n,a){const s=new wj("createOrUpgrade",r);n<1&&a>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",v7,{unique:!0}),c.createObjectStore("documentMutations")}(e),i9(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=Jt.resolve();return n<3&&a>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),i9(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Cn.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),n<4&&a>=4&&(n!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",v7,{unique:!0});const f=u.store("mutations"),A=d.map(h=>f.put(h));return Jt.waitFor(A)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&a>=5&&(o=o.next(()=>this.ni(s))),n<6&&a>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&a>=7&&(o=o.next(()=>this.ii(s))),n<8&&a>=8&&(o=o.next(()=>this.si(e,s))),n<9&&a>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&a>=10&&(o=o.next(()=>this.oi(s))),n<11&&a>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&a>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:lve});u.createIndex("collectionPathOverlayIndex",cve,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",uve,{unique:!1})})(e)})),n<13&&a>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:Yxe});u.createIndex("documentKeyIndex",Jxe),u.createIndex("collectionGroupIndex",Zxe)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&a>=14&&(o=o.next(()=>this.ai(e,s))),n<15&&a>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:ave}).createIndex("sequenceNumberIndex",sve,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:ive}).createIndex("documentKeyIndex",ove,{unique:!1})}(e))),n<16&&a>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&a>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,a)=>{r+=fS(a)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(a=>Jt.forEach(a,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>Jt.forEach(l,c=>{gn(c.userId===s.userId);const u=mp(this.serializer,c);return LZ(e,s.userId,u).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const s=[];return n.J((o,l)=>{const c=new Pa(o),u=function(f){return[0,jc(f)]}(c);s.push(r.get(u).next(d=>d?Jt.resolve():(f=>r.put({targetId:0,path:jc(f),sequenceNumber:a.highestListenSequenceNumber}))(c)))}).next(()=>Jt.waitFor(s))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:nve});const n=r.store("collectionParents"),a=new a6,s=o=>{if(a.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:jc(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new Pa(o);return s(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],u)=>{const d=Xf(l);return s(d.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,a)=>{const s=Uy(a),o=OZ(this.serializer,s);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),a=[];return n.J((s,o)=>{const l=r.store("remoteDocumentsV14"),c=function(f){return f.document?new Jr(Pa.fromString(f.document.name).popFirst(5)):f.noDocument?Jr.fromSegments(f.noDocument.path):f.unknownDocument?Jr.fromSegments(f.unknownDocument.path):dn()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};a.push(l.put(u))}).next(()=>Jt.waitFor(a))}ai(e,r){const n=r.store("mutations"),a=HZ(this.serializer),s=new KZ(Pj.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:ra();mp(this.serializer,c).keys().forEach(f=>d=d.add(f)),l.set(c.userId,d)}),Jt.forEach(l,(c,u)=>{const d=new Nl(u),f=Ij.lt(this.serializer,d),A=s.getIndexManager(d),h=jj.lt(d,this.serializer,A,s.referenceDelegate);return new $Z(a,h,f,A).recalculateAndSaveOverlaysForDocumentKeys(new KT(r,wd.oe),c).next()})})}}function i9(t){t.createObjectStore("targetDocuments",{keyPath:tve}).createIndex("documentTargetsIndex",rve,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",eve,{unique:!0}),t.createObjectStore("targetGlobal")}const S4="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class i6{constructor(e,r,n,a,s,o,l,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=s,this.window=o,this.document=l,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=A=>Promise.resolve(),!i6.D())throw new Hr(fr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new b1e(this,a),this.Ai=r+"main",this.serializer=new FZ(c),this.Ri=new cm(this.Ai,this.hi,new k1e(this.serializer)),this.$r=new l1e,this.Ur=new p1e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=HZ(this.serializer),this.Gr=new o1e,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&_c("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Hr(fr.FAILED_PRECONDITION,S4);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new wd(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>aC(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(Mm(e))return Fr("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Fr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return iy(e).get("owner").next(r=>Jt.resolve(this.vi(r)))}Ci(e){return aC(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=Do(r,"clientMetadata");return n.U().next(a=>{const s=this.xi(a,18e5),o=a.filter(l=>s.indexOf(l)===-1);return Jt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Jt.resolve(!0):iy(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Hr(fr.FAILED_PRECONDITION,S4);return!1}}return!(!this.networkEnabled||!this.inForeground)||aC(e).U().next(n=>this.xi(n,5e3).find(a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,o=!this.inForeground&&a.inForeground,l=this.networkEnabled===a.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Fr("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new KT(e,wd.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>aC(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return jj.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new m1e(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ij.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Fr("IndexedDbPersistence","Starting transaction:",e);const a=r==="readonly"?"readonly":"readwrite",s=function(c){return c===17?hve:c===16?fve:c===15?GD:c===14?GJ:c===13?KJ:c===12?dve:c===11?$J:void dn()}(this.hi);let o;return this.Ri.runTransaction(e,a,s,l=>(o=new KT(l,this.Qr?this.Qr.next():wd.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw _c(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Hr(fr.FAILED_PRECONDITION,UJ);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return iy(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Hr(fr.FAILED_PRECONDITION,S4)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return iy(e).put("owner",r)}static D(){return cm.D()}bi(e){const r=iy(e);return r.get("owner").next(n=>this.vi(n)?(Fr("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):Jt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(_c(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;$Y()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Fr("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return _c("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){_c("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function iy(t){return Do(t,"owner")}function aC(t){return Do(t,"clientMetadata")}function F1e(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=a}static Wi(e,r){let n=ra(),a=ra();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new o6(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GZ{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return $Y()?8:VJ(Fo())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,a){const s={result:null};return this.Yi(e,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,r,a,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new O1e;return this.Xi(e,r,o).next(l=>{if(s.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>s.result)}es(e,r,n,a){return n.documentReadCount<this.ji?(Cx()<=ha.DEBUG&&Fr("QueryEngine","SDK will not create cache indexes for query:",_x(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Jt.resolve()):(Cx()<=ha.DEBUG&&Fr("QueryEngine","Query:",_x(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(Cx()<=ha.DEBUG&&Fr("QueryEngine","The SDK decides to create cache indexes for query:",_x(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Id(r))):Jt.resolve())}Yi(e,r){if(T7(r))return Jt.resolve(null);let n=Id(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=cS(r,null,"F"),n=Id(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=ra(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.ts(r,l);return this.ns(r,u,o,c.readTime)?this.Yi(e,cS(r,null,"F")):this.rs(e,u,r,c)}))})))}Zi(e,r,n,a){return T7(r)||a.isEqual(Cn.min())?Jt.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,a)?Jt.resolve(null):(Cx()<=ha.DEBUG&&Fr("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),_x(r)),this.rs(e,o,r,Hxe(a,-1)).next(l=>l))})}ts(e,r){let n=new us(oZ(e));return r.forEach((a,s)=>{Sw(e,s)&&(n=n.add(s))}),n}ns(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Xi(e,r,n){return Cx()<=ha.DEBUG&&Fr("QueryEngine","Using full collection scan to execute query:",_x(r)),this.Ji.getDocumentsMatchingQuery(e,r,Qu.min(),n)}rs(e,r,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1e{constructor(e,r,n,a){this.persistence=e,this.ss=r,this.serializer=a,this.os=new Ws(Gn),this._s=new Lm(s=>sg(s),_w),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $Z(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function qZ(t,e,r,n){return new D1e(t,e,r,n)}async function zZ(t,e){const r=Ln(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let c=ra();for(const u of a){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of s){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function R1e(t,e){const r=Ln(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,A=f.keys();let h=Jt.resolve();return A.forEach(m=>{h=h.next(()=>d.getEntry(c,m)).next(p=>{const x=u.docVersions.get(m);gn(x!==null),p.version.compareTo(x)<0&&(f.applyToRemoteDocument(p,u),p.isValidDocument()&&(p.setReadTime(u.commitVersion),d.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=ra();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function WZ(t){const e=Ln(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function M1e(t,e){const r=Ln(t),n=e.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const l=[];e.targetChanges.forEach((d,f)=>{const A=a.get(f);if(!A)return;l.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,f)));let h=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?h=h.withResumeToken(Wi.EMPTY_BYTE_STRING,Cn.min()).withLastLimboFreeSnapshotVersion(Cn.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,n)),a=a.insert(f,h),function(p,x,v){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(A,h,d)&&l.push(r.Ur.updateTargetData(s,h))});let c=Fu(),u=ra();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),l.push(L1e(s,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!n.isEqual(Cn.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(f=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(d)}return Jt.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(r.os=a,s))}function L1e(t,e,r){let n=ra(),a=ra();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let o=Fu();return r.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(a=a.add(l)),c.isNoDocument()&&c.version.isEqual(Cn.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Fr("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:a}})}function U1e(t,e){const r=Ln(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Q1e(t,e){const r=Ln(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Ur.getTargetData(n,e).next(s=>s?(a=s,Jt.resolve(a)):r.Ur.allocateTargetId(n).next(o=>(a=new Wh(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function sk(t,e,r){const n=Ln(t),a=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!Mm(o))throw o;Fr("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function o9(t,e,r){const n=Ln(t);let a=Cn.min(),s=ra();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=Ln(c),A=f._s.get(d);return A!==void 0?Jt.resolve(f.os.get(A)):f.Ur.getTargetData(u,d)}(n,o,Id(e)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?a:Cn.min(),r?s:ra())).next(l=>(V1e(n,Ive(e),l),{documents:l,Ts:s})))}function V1e(t,e,r){let n=t.us.get(e)||Cn.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class l9{constructor(){this.activeTargetIds=Fve()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XZ{constructor(){this.so=new l9,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new l9,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1e{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c9{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Fr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Fr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sC=null;function I4(){return sC===null?sC=function(){return 268435456+Math.round(2147483648*Math.random())}():sC++,"0x"+sC.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1e{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul="WebChannelConnection";class G1e extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${a}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${s}`}get Fo(){return!1}Mo(r,n,a,s,o){const l=I4(),c=this.xo(r,n.toUriEncodedString());Fr("RestConnection",`Sending RPC '${r}' ${l}:`,c,a);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(r,c,u,a).then(d=>(Fr("RestConnection",`Received RPC '${r}' ${l}: `,d),d),d=>{throw xm("RestConnection",`RPC '${r}' ${l} failed with error: `,d,"url: ",c,"request:",a),d})}Lo(r,n,a,s,o,l){return this.Mo(r,n,a,s,o)}Oo(r,n,a){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+o1}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),a&&a.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const a=$1e[r];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,a){const s=I4();return new Promise((o,l)=>{const c=new BJ;c.setWithCredentials(!0),c.listenOnce(TJ.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case nE.NO_ERROR:const d=c.getResponseJson();Fr(Ul,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case nE.TIMEOUT:Fr(Ul,`RPC '${e}' ${s} timed out`),l(new Hr(fr.DEADLINE_EXCEEDED,"Request time out"));break;case nE.HTTP_ERROR:const f=c.getStatus();if(Fr(Ul,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let A=c.getResponseJson();Array.isArray(A)&&(A=A[0]);const h=A==null?void 0:A.error;if(h&&h.status&&h.message){const m=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(fr).indexOf(v)>=0?v:fr.UNKNOWN}(h.status);l(new Hr(m,h.message))}else l(new Hr(fr.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Hr(fr.UNAVAILABLE,"Connection failed."));break;default:dn()}}finally{Fr(Ul,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(a);Fr(Ul,`RPC '${e}' ${s} sending request:`,a),c.send(r,"POST",u,n,15)})}Bo(e,r,n){const a=I4(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=OJ(),l=FJ(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=s.join("");Fr(Ul,`Creating RPC '${e}' stream ${a}: ${d}`,c);const f=o.createWebChannel(d,c);let A=!1,h=!1;const m=new K1e({Io:x=>{h?Fr(Ul,`Not sending because RPC '${e}' stream ${a} is closed:`,x):(A||(Fr(Ul,`Opening RPC '${e}' stream ${a} transport.`),f.open(),A=!0),Fr(Ul,`RPC '${e}' stream ${a} sending:`,x),f.send(x))},To:()=>f.close()}),p=(x,v,y)=>{x.listen(v,b=>{try{y(b)}catch(w){setTimeout(()=>{throw w},0)}})};return p(f,Ry.EventType.OPEN,()=>{h||(Fr(Ul,`RPC '${e}' stream ${a} transport opened.`),m.yo())}),p(f,Ry.EventType.CLOSE,()=>{h||(h=!0,Fr(Ul,`RPC '${e}' stream ${a} transport closed`),m.So())}),p(f,Ry.EventType.ERROR,x=>{h||(h=!0,xm(Ul,`RPC '${e}' stream ${a} transport errored:`,x),m.So(new Hr(fr.UNAVAILABLE,"The operation could not be completed")))}),p(f,Ry.EventType.MESSAGE,x=>{var v;if(!h){const y=x.data[0];gn(!!y);const b=y,w=b.error||((v=b[0])===null||v===void 0?void 0:v.error);if(w){Fr(Ul,`RPC '${e}' stream ${a} received error:`,w);const j=w.status;let I=function(E){const B=to[E];if(B!==void 0)return yZ(B)}(j),_=w.message;I===void 0&&(I=fr.INTERNAL,_="Unknown error status: "+j+" with message "+w.message),h=!0,m.So(new Hr(I,_)),f.close()}else Fr(Ul,`RPC '${e}' stream ${a} received:`,y),m.bo(y)}}),p(l,kJ.STAT_EVENT,x=>{x.stat===HT.PROXY?Fr(Ul,`RPC '${e}' stream ${a} detected buffering proxy`):x.stat===HT.NOPROXY&&Fr(Ul,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q1e(){return typeof window<"u"?window:null}function uE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(t){return new Wve(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e,r,n=1e3,a=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=a,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,r-n);a>0&&Fr("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YZ{constructor(e,r,n,a,s,o,l,c){this.ui=e,this.Ho=n,this.Jo=a,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new l6(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===fr.RESOURCE_EXHAUSTED?(_c(r.toString()),_c("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===fr.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.Yo===r&&this.P_(n,a)},n=>{e(()=>{const a=new Hr(fr.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{n(()=>this.I_(a))}),this.stream.onMessage(a=>{n(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Fr("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Fr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class z1e extends YZ{constructor(e,r,n,a,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=Zve(this.serializer,e),n=function(s){if(!("targetChange"in s))return Cn.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Cn.min():o.readTime?rl(o.readTime):Cn.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=ek(this.serializer),r.addTarget=function(s,o){let l;const c=o.target;if(l=oS(c)?{documents:IZ(s,c)}:{query:jZ(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=NZ(s,o.resumeToken);const u=JT(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Cn.min())>0){l.readTime=Ov(s,o.snapshotVersion.toTimestamp());const u=JT(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=t1e(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=ek(this.serializer),r.removeTarget=e,this.a_(r)}}class W1e extends YZ{constructor(e,r,n,a,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return gn(!!e.streamToken),this.lastStreamToken=e.streamToken,gn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){gn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=e1e(e.writeResults,e.commitTime),n=rl(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=ek(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>b2(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1e extends class{}{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new Hr(fr.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,ZT(r,n),a,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===fr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Hr(fr.UNKNOWN,s.toString())})}Lo(e,r,n,a,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,ZT(r,n),a,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===fr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Hr(fr.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Y1e{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(_c(r),this.D_=!1):Fr("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1e{constructor(e,r,n,a,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{Bg(this)&&(Fr("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Ln(c);u.L_.add(4),await jw(u),u.q_.set("Unknown"),u.L_.delete(4),await Tj(u)}(this))})}),this.q_=new Y1e(n,a)}}async function Tj(t){if(Bg(t))for(const e of t.B_)await e(!0)}async function jw(t){for(const e of t.B_)await e(!1)}function JZ(t,e){const r=Ln(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),f6(r)?d6(r):d1(r).r_()&&u6(r,e))}function c6(t,e){const r=Ln(t),n=d1(r);r.N_.delete(e),n.r_()&&ZZ(r,e),r.N_.size===0&&(n.r_()?n.o_():Bg(r)&&r.q_.set("Unknown"))}function u6(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Cn.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}d1(t).A_(e)}function ZZ(t,e){t.Q_.xe(e),d1(t).R_(e)}function d6(t){t.Q_=new Kve({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),d1(t).start(),t.q_.v_()}function f6(t){return Bg(t)&&!d1(t).n_()&&t.N_.size>0}function Bg(t){return Ln(t).L_.size===0}function eee(t){t.Q_=void 0}async function Z1e(t){t.q_.set("Online")}async function eye(t){t.N_.forEach((e,r)=>{u6(t,e)})}async function tye(t,e){eee(t),f6(t)?(t.q_.M_(e),d6(t)):t.q_.set("Unknown")}async function rye(t,e,r){if(t.q_.set("Online"),e instanceof wZ&&e.state===2&&e.cause)try{await async function(a,s){const o=s.cause;for(const l of s.targetIds)a.N_.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.N_.delete(l),a.Q_.removeTarget(l))}(t,e)}catch(n){Fr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await hS(t,n)}else if(e instanceof cE?t.Q_.Ke(e):e instanceof bZ?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Cn.min()))try{const n=await WZ(t.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Wi.EMPTY_BYTE_STRING,d.snapshotVersion)),ZZ(s,c);const f=new Wh(d.target,c,u,d.sequenceNumber);u6(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Fr("RemoteStore","Failed to raise snapshot:",n),await hS(t,n)}}async function hS(t,e,r){if(!Mm(e))throw e;t.L_.add(1),await jw(t),t.q_.set("Offline"),r||(r=()=>WZ(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Fr("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Tj(t)})}function tee(t,e){return e().catch(r=>hS(t,r,e))}async function Pw(t){const e=Ln(t),r=wm(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;nye(e);)try{const a=await U1e(e.localStore,n);if(a===null){e.O_.length===0&&r.o_();break}n=a.batchId,aye(e,a)}catch(a){await hS(e,a)}ree(e)&&nee(e)}function nye(t){return Bg(t)&&t.O_.length<10}function aye(t,e){t.O_.push(e);const r=wm(t);r.r_()&&r.V_&&r.m_(e.mutations)}function ree(t){return Bg(t)&&!wm(t).n_()&&t.O_.length>0}function nee(t){wm(t).start()}async function sye(t){wm(t).p_()}async function iye(t){const e=wm(t);for(const r of t.O_)e.m_(r.mutations)}async function oye(t,e,r){const n=t.O_.shift(),a=ZD.from(n,e,r);await tee(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await Pw(t)}async function lye(t,e){e&&wm(t).V_&&await async function(n,a){if(function(o){return vZ(o)&&o!==fr.ABORTED}(a.code)){const s=n.O_.shift();wm(n).s_(),await tee(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await Pw(n)}}(t,e),ree(t)&&nee(t)}async function u9(t,e){const r=Ln(t);r.asyncQueue.verifyOperationInProgress(),Fr("RemoteStore","RemoteStore received new credentials");const n=Bg(r);r.L_.add(3),await jw(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Tj(r)}async function cye(t,e){const r=Ln(t);e?(r.L_.delete(2),await Tj(r)):e||(r.L_.add(2),await jw(r),r.q_.set("Unknown"))}function d1(t){return t.K_||(t.K_=function(r,n,a){const s=Ln(r);return s.w_(),new z1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:Z1e.bind(null,t),Ro:eye.bind(null,t),mo:tye.bind(null,t),d_:rye.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),f6(t)?d6(t):t.q_.set("Unknown")):(await t.K_.stop(),eee(t))})),t.K_}function wm(t){return t.U_||(t.U_=function(r,n,a){const s=Ln(r);return s.w_(),new W1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:sye.bind(null,t),mo:lye.bind(null,t),f_:iye.bind(null,t),g_:oye.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Pw(t)):(await t.U_.stop(),t.O_.length>0&&(Fr("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,r,n,a,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new pf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,s){const o=Date.now()+n,l=new h6(e,r,o,a,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Hr(fr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function A6(t,e){if(_c("AsyncQueue",`${e}: ${t}`),Mm(t))return new Hr(fr.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Jr.comparator(r.key,n.key):(r,n)=>Jr.comparator(r.key,n.key),this.keyedMap=My(),this.sortedSet=new Ws(this.comparator)}static emptySet(e){return new fv(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof fv)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new fv;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(){this.W_=new Ws(Jr.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):dn():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Dv{constructor(e,r,n,a,s,o,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,a,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new Dv(e,r,fv.emptySet(r),o,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cj(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uye{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class dye{constructor(){this.queries=f9(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const a=Ln(r),s=a.queries;a.queries=f9(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Hr(fr.ABORTED,"Firestore shutting down"))}}function f9(){return new Lm(t=>iZ(t),Cj)}async function m6(t,e){const r=Ln(t);let n=3;const a=e.query;let s=r.queries.get(a);s?!s.H_()&&e.J_()&&(n=2):(s=new uye,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(a,!0);break;case 1:s.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const l=A6(o,`Initialization of query '${_x(e.query)}' failed`);return void e.onError(l)}r.queries.set(a,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&g6(r)}async function p6(t,e){const r=Ln(t),n=e.query;let a=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?a=e.J_()?0:1:!s.H_()&&e.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function fye(t,e){const r=Ln(t);let n=!1;for(const a of e){const s=a.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(a)&&(n=!0);o.z_=a}}n&&g6(r)}function hye(t,e,r){const n=Ln(t),a=n.queries.get(e);if(a)for(const s of a.j_)s.onError(r);n.queries.delete(e)}function g6(t){t.Y_.forEach(e=>{e.next()})}var ik,h9;(h9=ik||(ik={})).ea="default",h9.Cache="cache";class x6{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Dv(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Dv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ik.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aee{constructor(e){this.key=e}}class see{constructor(e){this.key=e}}class Aye{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ra(),this.mutatedKeys=ra(),this.Aa=oZ(e),this.Ra=new fv(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new d9,a=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=a,l=!1;const c=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,u=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((d,f)=>{const A=a.get(d),h=Sw(this.query,f)?f:null,m=!!A&&this.mutatedKeys.has(A.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;A&&h?A.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(A,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||u&&this.Aa(h,u)<0)&&(l=!0)):!A&&h?(n.track({type:0,doc:h}),x=!0):A&&!h&&(n.track({type:1,doc:A}),x=!0,(c||u)&&(l=!0)),x&&(h?(o=o.add(h),s=p?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dn()}};return p(h)-p(m)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(n),a=a!=null&&a;const l=r&&!a?this.ya():[],c=this.da.size===0&&this.current&&!a?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Dv(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new d9,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ra(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new see(n))}),this.da.forEach(n=>{e.has(n)||r.push(new aee(n))}),r}ba(e){this.Ta=e.Ts,this.da=ra();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Dv.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class mye{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class pye{constructor(e){this.key=e,this.va=!1}}class gye{constructor(e,r,n,a,s,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Lm(l=>iZ(l),Cj),this.Ma=new Map,this.xa=new Set,this.Oa=new Ws(Jr.comparator),this.Na=new Map,this.La=new s6,this.Ba={},this.ka=new Map,this.qa=cg.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function xye(t,e,r=!0){const n=dee(t);let a;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await iee(n,e,r,!0),a}async function vye(t,e){const r=dee(t);await iee(r,e,!0,!1)}async function iee(t,e,r,n){const a=await Q1e(t.localStore,Id(e)),s=a.targetId,o=t.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await yye(t,e,s,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&JZ(t.remoteStore,a),l}async function yye(t,e,r,n,a){t.Ka=(f,A,h)=>async function(p,x,v,y){let b=x.view.ma(v);b.ns&&(b=await o9(p.localStore,x.query,!1).then(({documents:_})=>x.view.ma(_,b)));const w=y&&y.targetChanges.get(x.targetId),j=y&&y.targetMismatches.get(x.targetId)!=null,I=x.view.applyChanges(b,p.isPrimaryClient,w,j);return m9(p,x.targetId,I.wa),I.snapshot}(t,f,A,h);const s=await o9(t.localStore,e,!0),o=new Aye(e,s.Ts),l=o.ma(s.documents),c=Iw.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),u=o.applyChanges(l,t.isPrimaryClient,c);m9(t,r,u.wa);const d=new mye(e,r,o);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function bye(t,e,r){const n=Ln(t),a=n.Fa.get(e),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(o=>!Cj(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await sk(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&c6(n.remoteStore,a.targetId),ok(n,a.targetId)}).catch(jg)):(ok(n,a.targetId),await sk(n.localStore,a.targetId,!0))}async function wye(t,e){const r=Ln(t),n=r.Fa.get(e),a=r.Ma.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),c6(r.remoteStore,n.targetId))}async function Nye(t,e,r){const n=fee(t);try{const a=await function(o,l){const c=Ln(o),u=xr.now(),d=l.reduce((h,m)=>h.add(m.key),ra());let f,A;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Fu(),p=ra();return c.cs.getEntries(h,d).next(x=>{m=x,m.forEach((v,y)=>{y.isValidDocument()||(p=p.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{f=x;const v=[];for(const y of l){const b=Qve(y,f.get(y.key).overlayedDocument);b!=null&&v.push(new OA(y.key,b,YJ(b.value.mapValue),$s.exists(!0)))}return c.mutationQueue.addMutationBatch(h,u,v,l)}).next(x=>{A=x;const v=x.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,v)})}).then(()=>({batchId:A.batchId,changes:cZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Ws(Gn)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(n,a.batchId,r),await Bw(n,a.changes),await Pw(n.remoteStore)}catch(a){const s=A6(a,"Failed to persist write");r.reject(s)}}async function oee(t,e){const r=Ln(t);try{const n=await M1e(r.localStore,e);e.targetChanges.forEach((a,s)=>{const o=r.Na.get(s);o&&(gn(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?gn(o.va):a.removedDocuments.size>0&&(gn(o.va),o.va=!1))}),await Bw(r,n,e)}catch(n){await jg(n)}}function A9(t,e,r){const n=Ln(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&a.push(l.snapshot)}),function(o,l){const c=Ln(o);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const A of f.j_)A.Z_(l)&&(u=!0)}),u&&g6(c)}(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Cye(t,e,r){const n=Ln(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Na.get(e),s=a&&a.key;if(s){let o=new Ws(Jr.comparator);o=o.insert(s,Vs.newNoDocument(s,Cn.min()));const l=ra().add(s),c=new Sj(Cn.min(),new Map,new Ws(Gn),o,l);await oee(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),v6(n)}else await sk(n.localStore,e,!1).then(()=>ok(n,e,r)).catch(jg)}async function _ye(t,e){const r=Ln(t),n=e.batch.batchId;try{const a=await R1e(r.localStore,e);cee(r,n,null),lee(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Bw(r,a)}catch(a){await jg(a)}}async function Eye(t,e,r){const n=Ln(t);try{const a=await function(o,l){const c=Ln(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(gn(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);cee(n,e,r),lee(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Bw(n,a)}catch(a){await jg(a)}}function lee(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function cee(t,e,r){const n=Ln(t);let a=n.Ba[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(r?s.reject(r):s.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function ok(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||uee(t,n)})}function uee(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(c6(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),v6(t))}function m9(t,e,r){for(const n of r)n instanceof aee?(t.La.addReference(n.key,e),Sye(t,n)):n instanceof see?(Fr("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||uee(t,n.key)):dn()}function Sye(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Fr("SyncEngine","New document in limbo: "+r),t.xa.add(n),v6(t))}function v6(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Jr(Pa.fromString(e)),n=t.qa.next();t.Na.set(n,new pye(r)),t.Oa=t.Oa.insert(r,n),JZ(t.remoteStore,new Wh(Id(Ew(r.path)),n,"TargetPurposeLimboResolution",wd.oe))}}async function Bw(t,e,r){const n=Ln(t),a=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const f=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){a.push(u);const f=o6.Wi(c.targetId,u);s.push(f)}}))}),await Promise.all(o),n.Ca.d_(a),await async function(c,u){const d=Ln(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Jt.forEach(u,A=>Jt.forEach(A.$i,h=>d.persistence.referenceDelegate.addReference(f,A.targetId,h)).next(()=>Jt.forEach(A.Ui,h=>d.persistence.referenceDelegate.removeReference(f,A.targetId,h)))))}catch(f){if(!Mm(f))throw f;Fr("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const A=f.targetId;if(!f.fromCache){const h=d.os.get(A),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.os=d.os.insert(A,p)}}}(n.localStore,s))}async function Iye(t,e){const r=Ln(t);if(!r.currentUser.isEqual(e)){Fr("SyncEngine","User change. New user:",e.toKey());const n=await zZ(r.localStore,e);r.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new Hr(fr.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Bw(r,n.hs)}}function jye(t,e){const r=Ln(t),n=r.Na.get(e);if(n&&n.va)return ra().add(n.key);{let a=ra();const s=r.Ma.get(e);if(!s)return a;for(const o of s){const l=r.Fa.get(o);a=a.unionWith(l.view.Va)}return a}}function dee(t){const e=Ln(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=oee.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Cye.bind(null,e),e.Ca.d_=fye.bind(null,e.eventManager),e.Ca.$a=hye.bind(null,e.eventManager),e}function fee(t){const e=Ln(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_ye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Eye.bind(null,e),e}class w2{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bj(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return qZ(this.persistence,new GZ,e.initialUser,this.serializer)}Ga(e){return new KZ(Pj.Zr,this.serializer)}Wa(e){return new XZ}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}w2.provider={build:()=>new w2};class Pye extends w2{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await fee(this.Ja.syncEngine),await Pw(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return qZ(this.persistence,new GZ,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new x1e(n,e.asyncQueue,r)}Ha(e,r){const n=new qxe(r,this.persistence);return new Gxe(e.asyncQueue,n)}Ga(e){const r=F1e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Wc.withCacheSize(this.cacheSizeBytes):Wc.DEFAULT;return new i6(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,q1e(),uE(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new XZ}}class AS{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>A9(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Iye.bind(null,this.syncEngine),await cye(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dye}()}createDatastore(e){const r=Bj(e.databaseInfo.databaseId),n=function(s){return new G1e(s)}(e.databaseInfo);return function(s,o,l,c){return new X1e(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,s,o,l){return new J1e(n,a,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>A9(this.syncEngine,r,0),function(){return c9.D()?new c9:new H1e}())}createSyncEngine(e,r){return function(a,s,o,l,c,u,d){const f=new gye(a,s,o,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const s=Ln(a);Fr("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await jw(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}AS.provider={build:()=>new AS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):_c("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bye{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Hr(fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(a,s){const o=Ln(a),l={documents:s.map(f=>y2(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,Pa.emptyPath(),l,s.length),u=new Map;c.forEach(f=>{const A=Jve(o.serializer,f);u.set(A.key.toString(),A)});const d=[];return s.forEach(f=>{const A=u.get(f.toString());gn(!!A),d.push(A)}),d}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new u1(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const a=Jr.fromPath(n);this.mutations.push(new YD(a,this.precondition(a)))}),await async function(n,a){const s=Ln(n),o={writes:a.map(l=>b2(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,Pa.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw dn();r=Cn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Hr(fr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(Cn.min())?$s.exists(!1):$s.updateTime(r):$s.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(Cn.min()))throw new Hr(fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $s.updateTime(r)}return $s.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tye{constructor(e,r,n,a,s){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=a,this.deferred=s,this._u=n.maxAttempts,this.t_=new l6(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new Bye(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(a=>{this.lu(a)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Cw(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!vZ(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kye{constructor(e,r,n,a,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Nl.UNAUTHENTICATED,this.clientId=HD.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Fr("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Fr("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=A6(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function j4(t,e){t.asyncQueue.verifyOperationInProgress(),Fr("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await zZ(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function p9(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Fye(t);Fr("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>u9(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>u9(e.remoteStore,a)),t._onlineComponents=e}async function Fye(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Fr("FirestoreClient","Using user provided OfflineComponentProvider");try{await j4(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===fr.FAILED_PRECONDITION||a.code===fr.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;xm("Error using user provided cache. Falling back to memory cache: "+r),await j4(t,new w2)}}else Fr("FirestoreClient","Using default OfflineComponentProvider"),await j4(t,new w2);return t._offlineComponents}async function b6(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Fr("FirestoreClient","Using user provided OnlineComponentProvider"),await p9(t,t._uninitializedComponentsProvider._online)):(Fr("FirestoreClient","Using default OnlineComponentProvider"),await p9(t,new AS))),t._onlineComponents}function Oye(t){return b6(t).then(e=>e.syncEngine)}function Dye(t){return b6(t).then(e=>e.datastore)}async function mS(t){const e=await b6(t),r=e.eventManager;return r.onListen=xye.bind(null,e.syncEngine),r.onUnlisten=bye.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=vye.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=wye.bind(null,e.syncEngine),r}function Rye(t,e,r={}){const n=new pf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new y6({next:A=>{d.Za(),o.enqueueAndForget(()=>p6(s,f));const h=A.docs.has(l);!h&&A.fromCache?u.reject(new Hr(fr.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&A.fromCache&&c&&c.source==="server"?u.reject(new Hr(fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new x6(Ew(l.path),d,{includeMetadataChanges:!0,_a:!0});return m6(s,f)}(await mS(t),t.asyncQueue,e,r,n)),n.promise}function Mye(t,e,r={}){const n=new pf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new y6({next:A=>{d.Za(),o.enqueueAndForget(()=>p6(s,f)),A.fromCache&&c.source==="server"?u.reject(new Hr(fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new x6(l,d,{includeMetadataChanges:!0,_a:!0});return m6(s,f)}(await mS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hee(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g9=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aee(t,e,r){if(!r)throw new Hr(fr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function mee(t,e,r,n){if(e===!0&&n===!0)throw new Hr(fr.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function x9(t){if(!Jr.isDocumentKey(t))throw new Hr(fr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function v9(t){if(Jr.isDocumentKey(t))throw new Hr(fr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function kj(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dn()}function nl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Hr(fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=kj(t);throw new Hr(fr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Hr(fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Hr(fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mee("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hee((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Hr(fr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Hr(fr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Hr(fr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fj{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new y9({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Hr(fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Hr(fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new y9(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new RJ;switch(n.type){case"firstParty":return new Mxe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Hr(fr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=g9.get(r);n&&(Fr("ComponentProvider","Removing Datastore"),g9.delete(r),n.terminate())}(this),Promise.resolve()}}function pee(t,e,r,n={}){var a;const s=(t=nl(t,Fj))._getSettings(),o=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&xm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Nl.MOCK_USER;else{l=eme(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Hr(fr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Nl(u)}t._authCredentials=new Oxe(new DJ(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new hh(this.firestore,e,this._query)}}class al{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new aA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new al(this.firestore,e,this._key)}}class aA extends hh{constructor(e,r,n){super(e,r,Ew(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new al(this.firestore,null,new Jr(e))}withConverter(e){return new aA(this.firestore,e,this._path)}}function bt(t,e,...r){if(t=fi(t),Aee("collection","path",e),t instanceof Fj){const n=Pa.fromString(e,...r);return v9(n),new aA(t,null,n)}{if(!(t instanceof al||t instanceof aA))throw new Hr(fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pa.fromString(e,...r));return v9(n),new aA(t.firestore,null,n)}}function er(t,e,...r){if(t=fi(t),arguments.length===1&&(e=HD.newId()),Aee("doc","path",e),t instanceof Fj){const n=Pa.fromString(e,...r);return x9(n),new al(t,null,new Jr(n))}{if(!(t instanceof al||t instanceof aA))throw new Hr(fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pa.fromString(e,...r));return x9(n),new al(t.firestore,t instanceof aA?t.converter:null,new Jr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new l6(this,"async_queue_retry"),this.Vu=()=>{const n=uE();n&&Fr("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=uE();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=uE();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new pf;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Mm(e))throw e;Fr("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const a=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw _c("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const a=h6.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(a),a}fu(){this.Eu&&dn()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function w9(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const s of n)if(s in a&&typeof a[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Vu extends Fj{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new b9,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new b9(e),this._firestoreClient=void 0,await e}}}function gee(t,e){const r=typeof t=="object"?t:jD(),n=typeof t=="string"?t:"(default)",a=SD(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=J0e("firestore");s&&pee(a,...s)}return a}function Tg(t){if(t._terminated)throw new Hr(fr.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xee(t),t._firestoreClient}function xee(t){var e,r,n;const a=t._freezeSettings(),s=function(l,c,u,d){return new mve(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,hee(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new kye(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function vee(t,e){xm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return Lye(t,AS.provider,{build:n=>new Pye(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function Lye(t,e,r){if((t=nl(t,Vu))._firestoreClient||t._terminated)throw new Hr(fr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Hr(fr.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},xee(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nm(Wi.fromBase64String(e))}catch(r){throw new Hr(fr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Nm(Wi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Hr(fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Hr(fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Hr(fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Gn(this._lat,e._lat)||Gn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uye=/^__.*__$/;class Qye{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new OA(e,this.data,this.fieldMask,r,this.fieldTransforms):new c1(e,this.data,r,this.fieldTransforms)}}class yee{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new OA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function bee(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dn()}}class Rj{constructor(e,r,n,a,s,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Rj(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return pS(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(bee(this.Cu)&&Uye.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Vye{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Bj(e)}Qu(e,r,n,a=!1){return new Rj({Cu:e,methodName:r,qu:n,path:Hs.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function f1(t){const e=t._freezeSettings(),r=Bj(t._databaseId);return new Vye(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Mj(t,e,r,n,a,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,r,a);_6("Data must be an object, but it was:",o,n);const l=wee(n,o);let c,u;if(s.merge)c=new eu(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const A=lk(e,f,r);if(!o.contains(A))throw new Hr(fr.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);Cee(d,A)||d.push(A)}c=new eu(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new Qye(new El(l),c,u)}class Lj extends Tw{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lj}}function Hye(t,e,r){return new Rj({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class w6 extends Tw{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=Hye(this,e,!0),n=this.Ku.map(s=>h1(s,r)),a=new ig(n);return new pZ(e.path,a)}isEqual(e){return e instanceof w6&&i2(this.Ku,e.Ku)}}function N6(t,e,r,n){const a=t.Qu(1,e,r);_6("Data must be an object, but it was:",a,n);const s=[],o=El.empty();Pg(n,(c,u)=>{const d=E6(e,c,r);u=fi(u);const f=a.Nu(d);if(u instanceof Lj)s.push(d);else{const A=h1(u,f);A!=null&&(s.push(d),o.set(d,A))}});const l=new eu(s);return new yee(o,l,a.fieldTransforms)}function C6(t,e,r,n,a,s){const o=t.Qu(1,e,r),l=[lk(e,n,r)],c=[a];if(s.length%2!=0)throw new Hr(fr.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)l.push(lk(e,s[A])),c.push(s[A+1]);const u=[],d=El.empty();for(let A=l.length-1;A>=0;--A)if(!Cee(u,l[A])){const h=l[A];let m=c[A];m=fi(m);const p=o.Nu(h);if(m instanceof Lj)u.push(h);else{const x=h1(m,p);x!=null&&(u.push(h),d.set(h,x))}}const f=new eu(u);return new yee(d,f,o.fieldTransforms)}function $ye(t,e,r,n=!1){return h1(r,t.Qu(n?4:3,e))}function h1(t,e){if(Nee(t=fi(t)))return _6("Unsupported field value:",e,t),wee(t,e);if(t instanceof Tw)return function(n,a){if(!bee(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,a){const s=[];let o=0;for(const l of n){let c=h1(l,a.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(n,a){if((n=fi(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Ove(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=xr.fromDate(n);return{timestampValue:Ov(a.serializer,s)}}if(n instanceof xr){const s=new xr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ov(a.serializer,s)}}if(n instanceof Oj)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Nm)return{bytesValue:NZ(a.serializer,n._byteString)};if(n instanceof al){const s=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:r6(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Dj)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return XD(l.serializer,c)})}}}}}}(n,a);throw a.Bu(`Unsupported field value: ${kj(n)}`)}(t,e)}function wee(t,e){const r={};return qJ(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pg(t,(n,a)=>{const s=h1(a,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Nee(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof Oj||t instanceof Nm||t instanceof al||t instanceof Tw||t instanceof Dj)}function _6(t,e,r){if(!Nee(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=kj(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function lk(t,e,r){if((e=fi(e))instanceof kg)return e._internalPath;if(typeof e=="string")return E6(t,e);throw pS("Field path arguments must be of type string or ",t,!1,void 0,r)}const Kye=new RegExp("[~\\*/\\[\\]]");function E6(t,e,r){if(e.search(Kye)>=0)throw pS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new kg(...e.split("."))._internalPath}catch{throw pS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function pS(t,e,r,n,a){const s=n&&!n.isEmpty(),o=a!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${a}`),c+=")"),new Hr(fr.INVALID_ARGUMENT,l+t+c)}function Cee(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,r,n,a,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new al(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Gye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Uj("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Gye extends gS{data(){return super.data()}}function Uj(t,e){return typeof e=="string"?E6(t,e):e instanceof kg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _ee(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Hr(fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class S6{}class Qj extends S6{}function sr(t,e,...r){let n=[];e instanceof S6&&n.push(e),n=n.concat(r),function(s){const o=s.filter(c=>c instanceof Vj).length,l=s.filter(c=>c instanceof kw).length;if(o>1||o>0&&l>0)throw new Hr(fr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class kw extends Qj{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new kw(e,r,n)}_apply(e){const r=this._parse(e);return Eee(e._query,r),new hh(e.firestore,e.converter,YT(e._query,r))}_parse(e){const r=f1(e.firestore);return function(s,o,l,c,u,d,f){let A;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Hr(fr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){C9(f,d);const h=[];for(const m of f)h.push(N9(c,s,m));A={arrayValue:{values:h}}}else A=N9(c,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||C9(f,d),A=$ye(l,o,f,d==="in"||d==="not-in");return Aa.create(u,d,A)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ar(t,e,r){const n=e,a=Uj("where",t);return kw._create(a,n,r)}class Vj extends S6{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Vj(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ts.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,s){let o=a;const l=s.getFlattenedFilters();for(const c of l)Eee(o,c),o=YT(o,c)}(e._query,r),new hh(e.firestore,e.converter,YT(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hj extends Qj{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Hj(e,r)}_apply(e){const r=function(a,s,o){if(a.startAt!==null)throw new Hr(fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Hr(fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new g2(s,o)}(e._query,this._field,this._direction);return new hh(e.firestore,e.converter,function(a,s){const o=a.explicitOrderBy.concat([s]);return new l1(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,r))}}function In(t,e="asc"){const r=e,n=Uj("orderBy",t);return Hj._create(n,r)}class $j extends Qj{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new $j(e,r,n)}_apply(e){return new hh(e.firestore,e.converter,cS(e._query,this._limit,this._limitType))}}function xS(t){return $j._create("limit",t,"F")}function N9(t,e,r){if(typeof(r=fi(r))=="string"){if(r==="")throw new Hr(fr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sZ(e)&&r.indexOf("/")!==-1)throw new Hr(fr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Pa.fromString(r));if(!Jr.isDocumentKey(n))throw new Hr(fr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return m2(t,new Jr(n))}if(r instanceof al)return m2(t,r._key);throw new Hr(fr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kj(r)}.`)}function C9(t,e){if(!Array.isArray(t)||t.length===0)throw new Hr(fr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Eee(t,e){const r=function(a,s){for(const o of a)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Hr(fr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Hr(fr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class I6{convertValue(e,r="none"){switch(ag(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Us(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(vm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw dn()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Pg(e,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,a;const s=(a=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(o=>Us(o.doubleValue));return new Dj(s)}convertGeoPoint(e){return new Oj(Us(e.latitude),Us(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=zD(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(h2(e));default:return null}}convertTimestamp(e){const r=xA(e);return new xr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Pa.fromString(e);gn(kZ(n));const a=new ym(n.get(1),n.get(3)),s=new Jr(n.popFirst(5));return a.isEqual(r)||_c(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kj(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class qye extends I6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new al(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gj extends gS{constructor(e,r,n,a,s,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new xb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Uj("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class xb extends Gj{data(e={}){return super.data(e)}}class j6{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Np(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new xb(this._firestore,this._userDataWriter,n.key,n,new Np(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Hr(fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const c=new xb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Np(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new xb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Np(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:zye(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function zye(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dn()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zs(t){t=nl(t,al);const e=nl(t.firestore,Vu);return Rye(Tg(e),t._key).then(r=>Iee(e,t,r))}class qj extends I6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new al(this.firestore,null,r)}}function $t(t){t=nl(t,hh);const e=nl(t.firestore,Vu),r=Tg(e),n=new qj(e);return _ee(t._query),Mye(r,t._query).then(a=>new j6(e,n,t,a))}function See(t,e,r){t=nl(t,al);const n=nl(t.firestore,Vu),a=Kj(t.converter,e,r);return A1(n,[Mj(f1(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,$s.none())])}function Fn(t,e,r,...n){t=nl(t,al);const a=nl(t.firestore,Vu),s=f1(a);let o;return o=typeof(e=fi(e))=="string"||e instanceof kg?C6(s,"updateDoc",t._key,e,r,n):N6(s,"updateDoc",t._key,e),A1(a,[o.toMutation(t._key,$s.exists(!0))])}function qn(t){return A1(nl(t.firestore,Vu),[new u1(t._key,$s.none())])}function Zn(t,e){const r=nl(t.firestore,Vu),n=er(t),a=Kj(t.converter,e);return A1(r,[Mj(f1(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,$s.exists(!1))]).then(()=>n)}function jd(t,...e){var r,n,a;t=fi(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||w9(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(w9(e[o])){const f=e[o];e[o]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(a=f.complete)===null||a===void 0?void 0:a.bind(f)}let c,u,d;if(t instanceof al)u=nl(t.firestore,Vu),d=Ew(t._key.path),c={next:f=>{e[o]&&e[o](Iee(u,t,f))},error:e[o+1],complete:e[o+2]};else{const f=nl(t,hh);u=nl(f.firestore,Vu),d=f._query;const A=new qj(u);c={next:h=>{e[o]&&e[o](new j6(u,A,f,h))},error:e[o+1],complete:e[o+2]},_ee(t._query)}return function(A,h,m,p){const x=new y6(p),v=new x6(h,x,m);return A.asyncQueue.enqueueAndForget(async()=>m6(await mS(A),v)),()=>{x.Za(),A.asyncQueue.enqueueAndForget(async()=>p6(await mS(A),v))}}(Tg(u),d,l,c)}function A1(t,e){return function(n,a){const s=new pf;return n.asyncQueue.enqueueAndForget(async()=>Nye(await Oye(n),a,s)),s.promise}(Tg(t),e)}function Iee(t,e,r){const n=r.docs.get(e._key),a=new qj(t);return new Gj(t,a,e._key,n,new Np(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wye={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jee{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=f1(e)}set(e,r,n){this._verifyNotCommitted();const a=M0(e,this._firestore),s=Kj(a.converter,r,n),o=Mj(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,$s.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const s=M0(e,this._firestore);let o;return o=typeof(r=fi(r))=="string"||r instanceof kg?C6(this._dataReader,"WriteBatch.update",s._key,r,n,a):N6(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,$s.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=M0(e,this._firestore);return this._mutations=this._mutations.concat(new u1(r._key,$s.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Hr(fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function M0(t,e){if((t=fi(t)).firestore!==e)throw new Hr(fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pee extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=f1(r)}get(r){const n=M0(r,this._firestore),a=new qye(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return dn();const o=s[0];if(o.isFoundDocument())return new gS(this._firestore,a,o.key,o,n.converter);if(o.isNoDocument())return new gS(this._firestore,a,n._key,null,n.converter);throw dn()})}set(r,n,a){const s=M0(r,this._firestore),o=Kj(s.converter,n,a),l=Mj(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,a);return this._transaction.set(s._key,l),this}update(r,n,a,...s){const o=M0(r,this._firestore);let l;return l=typeof(n=fi(n))=="string"||n instanceof kg?C6(this._dataReader,"Transaction.update",o._key,n,a,s):N6(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=M0(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=M0(e,this._firestore),n=new qj(this._firestore);return super.get(e).then(a=>new Gj(this._firestore,n,r._key,a._document,new Np(!1,!1),r.converter))}}function Ks(t,e,r){t=nl(t,Vu);const n=Object.assign(Object.assign({},Wye),r);return function(s){if(s.maxAttempts<1)throw new Hr(fr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){const c=new pf;return s.asyncQueue.enqueueAndForget(async()=>{const u=await Dye(s);new Tye(s.asyncQueue,u,l,o,c).au()}),c.promise}(Tg(t),a=>e(new Pee(t,a)),n)}function Bee(...t){return new w6("arrayUnion",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t){return Tg(t=nl(t,Vu)),new jee(t,e=>A1(t,e))}(function(e,r=!0){(function(a){o1=a})(s1),jv(new eg("firestore",(n,{instanceIdentifier:a,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new Vu(new Dxe(n.getProvider("auth-internal")),new Uxe(n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Hr(fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ym(u.options.projectId,d)}(o,a),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),lm(p7,"4.7.3",e),lm(p7,"4.7.3","esm2017")})();const Xye=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:I6,Bytes:Nm,CollectionReference:aA,DocumentReference:al,DocumentSnapshot:Gj,FieldPath:kg,FieldValue:Tw,Firestore:Vu,FirestoreError:Hr,GeoPoint:Oj,Query:hh,QueryCompositeFilterConstraint:Vj,QueryConstraint:Qj,QueryDocumentSnapshot:xb,QueryFieldFilterConstraint:kw,QueryLimitConstraint:$j,QueryOrderByConstraint:Hj,QuerySnapshot:j6,SnapshotMetadata:Np,Timestamp:xr,Transaction:Pee,VectorValue:Dj,WriteBatch:jee,_AutoId:HD,_ByteString:Wi,_DatabaseId:ym,_DocumentKey:Jr,_EmptyAuthCredentialsProvider:RJ,_FieldPath:Hs,_cast:nl,_logWarn:xm,_validateIsNotUsedTogether:mee,addDoc:Zn,arrayUnion:Bee,collection:bt,connectFirestoreEmulator:pee,deleteDoc:qn,doc:er,enableIndexedDbPersistence:vee,ensureFirestoreConfigured:Tg,executeWrite:A1,getDoc:zs,getDocs:$t,getFirestore:gee,limit:xS,onSnapshot:jd,orderBy:In,query:sr,runTransaction:Ks,setDoc:See,updateDoc:Fn,where:Ar,writeBatch:tu},Symbol.toStringTag,{value:"Module"})),Yye={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},Tee=ID(Yye),Pe=gee(Tee),Ec=VT(Tee),Jye=(async()=>{try{return await eE(Ec,MD),console.info(" Auth persistence: browserLocalPersistence enabled"),"local"}catch(t){console.warn(" browserLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await eE(Ec,SJ),console.info(" Auth persistence: indexedDBLocalPersistence enabled"),"indexeddb"}catch(t){console.warn(" indexedDBLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await eE(Ec,LD),console.info(" Auth persistence: browserSessionPersistence enabled (session only)"),"session"}catch(t){console.warn(" browserSessionPersistence failed:",(t==null?void 0:t.code)||t)}return console.warn(" No se pudo establecer ninguna persistencia para Auth."),"none"})();vee(Pe).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function Zye(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState(!1),d=pw();g.useEffect(()=>{let h=!0;const m=vj(Ec,async p=>{if(!(!p||!h))try{const x=await zs(er(Pe,"users",p.uid));if(!x.exists())return;const v=x.data(),y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"";localStorage.setItem("user_email",p.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin",{replace:!0})}catch{}});return()=>{h=!1,m()}},[d]);const f=h=>{if(Array.isArray(h)){if(h.length!==1)return localStorage.setItem("role",h[0]||""),d("/admin");h=h[0]||""}const m=String(h||"");if(localStorage.setItem("role",m),Sn(m,"admin"))return d("/admin");if(Sn(m,"vendedor_pollo"))return d("/admin/salesV2");if(Sn(m,"vendedor_ropa"))return d("/admin/salesClothes");if(Sn(m,"vendedor_dulces"))return d("/admin/salesCandies");if(Sn(m,"supervisor_pollo")||Sn(m,"contador"))return d("/admin/batches")},A=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{u(!0),console.info&&console.info("[Login] attempting signIn",{email:t}),await eE(Ec,MD);const m=await bge(Ec,t,r);console.info&&console.info("[Login] signInWithEmailAndPassword success",{uid:m.user.uid,email:m.user.email});const p=m.user.uid;localStorage.setItem("POSYS_LOGIN_AT",String(Date.now()));const x=await zs(er(Pe,"users",p));if(console.info&&console.info("[Login] firestore users doc snap: exists=",x.exists()),!x.exists()){console.warn&&console.warn("[Login] user doc missing for uid",p),l("Tu usuario no tiene perfil en la base de datos.");return}const v=x.data();console.info&&console.info("[Login] user profile:",v);const y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"",j=["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"];if(!y.some(I=>j.includes(I))){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin")}catch(m){console.error&&console.error("[Login] sign-in error:",m);const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas. ("+p+")":p==="auth/user-not-found"?"Usuario no encontrado. ("+p+")":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde. ("+p+")":((m==null?void 0:m.message)||"Error al iniciar sesin.")+(p?` (${p})`:""))}finally{u(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:A,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:a?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>s(h=>!h),children:a?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function zn({children:t,allowedRoles:e}){const[r,n]=g.useState(!0),[a,s]=g.useState(!1);return g.useEffect(()=>{const o=vj(Ec,async l=>{if(l){const c=er(Pe,"users",l.uid),u=await zs(c);if(u.exists()){const d=u.data(),f=Array.isArray(d.roles)?d.roles:d.role?[d.role]:[];try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e):console.debug&&console.debug("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e)}catch{}let A=!1;for(const h of e)if(Sn(f,h)){A=!0;break}s(A)}else try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] no user doc for uid:",l.uid):console.debug&&console.debug("[PrivateRoute] no user doc for uid:",l.uid)}catch{}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):a?t:i.jsx(Dh,{to:"/"})}const ebe={admin:{},supervisor_pollo:{bills:{view:!0,edit:!1},expenses:{view:!0,edit:!1},customersPollo:{view:!0,edit:!1},transactionsPollo:{view:!0,edit:!1},batches:{view:!0,edit:!1}},contador:{salesV2:{view:!0,edit:!0},customersPollo:{view:!0,edit:!0},batches:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},expenses:{view:!0,edit:!0},financialDashboard:{view:!0,edit:!1},polloCashAudits:{view:!0,edit:!0}},vendedor_pollo:{salesV2:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},customersPollo:{view:!0,edit:!0}},vendedor_dulces:{salesCandies:{view:!0,edit:!0},productsVendorsCandies:{view:!0,edit:!1},productsPricesCandies:{view:!0,edit:!1},transactionCandies:{view:!0,edit:!1},cierreVentasCandies:{view:!0,edit:!1},customersCandies:{view:!0,edit:!0}},vendedor_ropa:{}};function kee(t){return t?Array.isArray(t)?t.filter(Boolean):[t].filter(Boolean):[]}function aa(t,e,r="view"){const n=kee(t);return n.some(a=>a==="admin")?!0:n.some(a=>{var s,o;return!!((o=(s=ebe[a])==null?void 0:s[e])!=null&&o[r])})}const tbe={admin:{},supervisor_pollo:{bills:{cerrarVentas:!1},batches:{create:!1,update:!1,delete:!1,export:!1}},contador:{batches:{create:!0,update:!1,delete:!1,export:!0},bills:{cerrarVentas:!1}},vendedor_pollo:{salesV2:{create:!0,update:!0},customersPollo:{update:!0},bills:{cerrarVentas:!0}},vendedor_dulces:{salesCandies:{create:!0,update:!0},productsVendorsCandies:{create:!0,update:!1,delete:!1},customersCandies:{update:!0},productsPricesCandies:{price_edit:!1}},vendedor_ropa:{}};function rbe(t,e,r){const n=kee(t);return n.some(a=>a==="admin")?!0:aa(t,e,"view")?n.some(a=>{var o;const s=(o=tbe[a])==null?void 0:o[e];return!!(s!=null&&s[r])}):!1}function nbe({role:t,roles:e}){const r="/admin",n=({isActive:re})=>`block rounded px-3 py-2 text-sm ${re?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,a=pw(),[s,o]=g.useState(!1),[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(!1),[h,m]=g.useState(!1),[p,x]=g.useState(!1),[v,y]=g.useState(!1),[b,w]=g.useState(!1),[j,I]=g.useState(!1),[_,S]=g.useState(!1),[E,B]=g.useState(!1),[k,P]=g.useState(!1),[O,z]=g.useState(!1),[oe,ce]=g.useState(!1),[ue,ge]=g.useState(!1),[ne,Oe]=g.useState(!1),[Ue,F]=g.useState(!1),[H,K]=g.useState(!1),U=async()=>{K(!0)},W=async()=>{try{await RD(Ec)}catch(re){console.error("signOut error:",re)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}K(!1),a("/")}},X=({open:re,onClick:J,children:De})=>i.jsxs("button",{type:"button",onClick:J,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:De}),i.jsx("span",{className:"text-xs",children:re?"":""})]}),D=({open:re,onClick:J,title:De})=>i.jsxs("button",{type:"button",onClick:J,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:De}),i.jsx("span",{className:"text-xs",children:re?"":""})]}),V=e&&e.length?e:t,Z=Sn(V,"admin");Sn(V,"vendedor_pollo");const be=Sn(V,"vendedor_ropa");Sn(V,"vendedor_dulces"),Sn(V,"supervisor_pollo")||Sn(V,"contador"),Sn(V,"contador");const L=aa(V,"salesV2","view")||aa(V,"customersPollo","view")||aa(V,"transactionsPollo","view")||aa(V,"bills","view")||aa(V,"expenses","view")||aa(V,"batches","view"),Xe=aa(V,"salesCandies","view")||aa(V,"productsVendorsCandies","view")||aa(V,"customersCandies","view")||aa(V,"productsPricesCandies","view")||aa(V,"transactionCandies","view")||aa(V,"cierreVentasCandies","view");return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>o(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[Z&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:l,onClick:()=>c(re=>!re),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:p,onClick:()=>x(re=>!re),title:"Operaciones"}),p&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Nn,{to:`${r}/salesV2`,className:n,children:"Vender"}),i.jsx(Nn,{to:`${r}/customersPollo`,className:n,children:"Saldo Pendientes"}),i.jsx(Nn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),i.jsx(Nn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"})]}),i.jsx(D,{open:u,onClick:()=>d(re=>!re),title:"Inventarios"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Nn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),i.jsx(Nn,{to:`${r}/paidBatches`,className:n,children:"Inventarios Pagados"})]}),i.jsx(D,{open:f,onClick:()=>A(re=>!re),title:"Finanzas"}),f&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Nn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),i.jsx(Nn,{to:`${r}/billing`,className:n,children:"Facturacion"}),i.jsx(Nn,{to:`${r}/expenses`,className:n,children:"Gastos"}),i.jsx(Nn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),i.jsx(Nn,{to:`${r}/salesV2`,className:n,children:"Venta"}),i.jsx(Nn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),i.jsx(Nn,{to:`${r}/billhistoric`,className:n,children:"Historial de Cierres"})]}),i.jsx(D,{open:h,onClick:()=>m(re=>!re),title:"Productos"}),h&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/products`,className:n,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:v,onClick:()=>y(re=>!re),children:"Gonper"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:b,onClick:()=>w(re=>!re),title:"Inventarios"}),b&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/notebooksInventory`,className:n,children:"Productos y Precios"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:O,onClick:()=>z(re=>!re),children:"CandyShop"}),O&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:ue,onClick:()=>ge(re=>!re),title:"Vendedores"}),ue&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),ue&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/productsVendorsCandies`,className:n,children:"Sub ordenes"})}),ue&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})}),i.jsx(D,{open:oe,onClick:()=>ce(re=>!re),title:"Inventario"}),oe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/mainordersCandies`,className:n,children:"Ordenes Maestras"})}),oe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/inventoryMainOrderCandies`,className:n,children:"Lista de Ordenes"})}),oe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/inventoryCandies`,className:n,children:"Lista Productos"})}),oe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/productsCandies`,className:n,children:"Productos"})}),i.jsx(D,{open:ne,onClick:()=>Oe(re=>!re),title:"Finanzas"}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/datacenter`,className:n,children:"Data Center"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/cashDeliveries`,className:n,children:"Entregas Cash"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/transactionCandies`,className:n,children:"Transacciones"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierres"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/reporteCierresCandies`,className:n,children:"Reporte Cierres"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/billingsCandies`,className:n,children:"Facturas"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/consolidatedVendors`,className:n,children:"Consolidado Vendedores"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/dashboardCandies`,className:n,children:"Dashboard"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/vendorsCandies`,className:n,children:"Vendedores"})}),ne&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/expensesCandies`,className:n,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:Ue,onClick:()=>F(re=>!re),children:"Operaciones Otras"}),Ue&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(Nn,{to:`${r}/users`,className:n,children:"Usuarios"}),i.jsx(Nn,{to:`${r}/fix`,className:n,children:"Fix de lotes"}),i.jsx(Nn,{to:`${r}/transactionclose`,className:n,children:"Liquidaciones"})]})]})]}),!Z&&L&&i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:l,onClick:()=>c(re=>!re),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[aa(V,"salesV2")&&i.jsx(Nn,{to:`${r}/salesV2`,className:n,children:"Vender"}),aa(V,"financialDashboard")&&i.jsx(Nn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),aa(V,"batches")&&i.jsx(Nn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),aa(V,"bills")&&i.jsx(Nn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),aa(V,"transactionsPollo")&&i.jsx(Nn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),aa(V,"expenses")&&i.jsx(Nn,{to:`${r}/expenses`,className:n,children:"Gastos"}),Sn(V,"contador")&&i.jsx(Nn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),aa(V,"customersPollo")&&i.jsx(Nn,{to:`${r}/customersPollo`,className:n,children:"Saldos Pendientes"})]})]}),!Z&&Xe&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:aa(V,"salesCandies")&&i.jsx(Nn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:aa(V,"transactionCandies")&&i.jsx(Nn,{to:`${r}/transactionCandies`,className:n,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:aa(V,"cierreVentasCandies")&&i.jsx(Nn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:aa(V,"productsVendorsCandies")&&i.jsx(Nn,{to:`${r}/productsVendorsCandies`,className:n,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:aa(V,"customersCandies")&&i.jsx(Nn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:aa(V,"productsPricesCandies")&&i.jsx(Nn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})})]}),be&&i.jsxs("div",{className:"border rounded",children:[i.jsx(X,{open:v,onClick:()=>y(re=>!re),children:"Operaciones Ropa"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:E,onClick:()=>B(re=>!re),title:"Ventas"}),E&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Nn,{to:`${r}/salesClothes`,className:n,children:"Venta Ropa"}),i.jsx(Nn,{to:`${r}/TransactionsReportClothes`,className:n,children:"Transacciones"})]}),i.jsx(D,{open:j,onClick:()=>I(re=>!re),title:"Productos"}),j&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/productsClothes`,className:n,children:"Agregar Productos"})}),i.jsx(D,{open:_,onClick:()=>S(re=>!re),title:"Clientes"}),_&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Nn,{to:`${r}/CustomersClothes`,className:n,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:U,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-700",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))}),H&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>K(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>K(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:W,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(BY,{})})]})}function oy(...t){return t.filter(Boolean).join(" ")}function abe({role:t,roles:e}){const r=pw(),n=BA(),a="/admin",s=e&&e.length?e:t,o=Sn(s,"admin"),l=Sn(s,"vendedor_pollo"),c=Sn(s,"vendedor_dulces"),u=Sn(s,"supervisor_pollo")||Sn(s,"contador"),d=Sn(s,"contador"),f=aa(s,"salesV2","view")||aa(s,"batches","view")||aa(s,"bills","view")||aa(s,"transactionsPollo","view")||aa(s,"customersPollo","view"),A=aa(s,"salesCandies","view")||aa(s,"productsVendorsCandies","view")||aa(s,"customersCandies","view")||aa(s,"productsPricesCandies","view")||aa(s,"transactionCandies","view")||aa(s,"cierreVentasCandies","view"),h=f&&A,[m,p]=g.useState(()=>{try{const B=typeof window<"u"?localStorage.getItem("rubro"):null;if(B==="POLLO"||B==="DULCES")return B}catch{}return f?"POLLO":A?"DULCES":"POLLO"}),[x,v]=g.useState(!1),[y,b]=g.useState(!1),w=g.useMemo(()=>{let B=[];if(o||h){if(m==="POLLO")if(o)B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"invPag",label:"Factura",to:`${a}/paidBatches`},{key:"gastos",label:"Gastos",to:`${a}/expenses`},{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}];else if(u){const O=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`}];Sn(s,"contador")&&(B=O)}else l?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:d?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];m==="DULCES"&&(o?B=[{key:"dc",label:"Data Center Reporte",to:`${a}/datacenter`},{key:"maes",label:"Inventario Maestro",to:`${a}/mainordersCandies`},{key:"ord",label:"Inventario Vendedor",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas del dia",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre de ventas",to:`${a}/cierreVentasCandies`},{key:"cash",label:"Entregas Efectivo ",to:`${a}/cashDeliveries`},{key:"items",label:"Productos",to:`${a}/productsCandies`},{key:"precios",label:"Precio Ventas",to:`${a}/productsPricesCandies`},{key:"gonper",label:"Productos Gonper",to:`${a}/notebooksInventory`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}])}else if(u){const O=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre",to:`${a}/bills`}];Sn(s,"contador")?B=[...O,{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}]:B=O}else l?B=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];const k=new Set(["bills","customersPollo","transactionsPollo","batches","salesV2","financialDashboard","polloCashAudits","salesCandies","productsVendorsCandies","productsPricesCandies","transactionCandies","cierreVentasCandies","customersCandies"]);return B.filter(O=>{const oe=O.to.replace(`${a}/`,"");return k.has(oe)?aa(s,oe,"view"):!0})},[a,m,o,h,u,l,c,d,s]);g.useEffect(()=>{if((o||h)&&w.length){try{localStorage.setItem("rubro",m)}catch{}r(w[0].to,{replace:!0})}},[m]),g.useEffect(()=>{x&&v(!1)},[n.pathname]),g.useEffect(()=>{const B=k=>{k.key==="Escape"&&v(!1)};return x&&window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[x]);const j=async()=>{b(!0)},I=async()=>{try{await RD(Ec)}catch(B){console.error("signOut error:",B)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}b(!1),v(!1),r("/")}},_=({isActive:B})=>oy("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",B?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),S=w.length<=2,E=({isActive:B})=>oy("w-full flex items-center justify-between px-4 py-3 rounded-xl border",B?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[o||h?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>p("POLLO"),className:oy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Carniceria"}),i.jsx("button",{type:"button",onClick:()=>p("DULCES"),className:oy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Mr. Candy"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:l?"Pollos Bea":c?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto flex items-center gap-2",children:i.jsx("button",{type:"button",onClick:()=>v(!0),className:"px-3 py-2 rounded-2xl bg-gray-100 text-gray-800 text-sm font-bold shadow hover:bg-gray-200","aria-label":"Abrir men",title:"Men",children:""})})]})}),x&&i.jsxs("div",{className:"fixed inset-0 z-[80]",children:[i.jsx("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:()=>v(!1),"aria-label":"Cerrar men"}),i.jsxs("aside",{className:"absolute right-0 top-0 h-full w-[86%] max-w-sm bg-white shadow-2xl border-l flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-bold text-gray-900",children:"Men"}),i.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200",children:""})]}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-600",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))})]}),i.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-2",children:w.map(B=>i.jsxs(Nn,{to:B.to,className:E,children:[i.jsx("span",{className:"font-semibold",children:B.label}),i.jsx("span",{className:"text-sm opacity-80",children:""})]},B.key))}),i.jsxs("div",{className:"p-3 border-t space-y-2 pb-[calc(12px+env(safe-area-inset-bottom))]",children:[i.jsx("button",{onClick:j,className:"w-full px-4 py-3 rounded-xl bg-red-500 text-white font-semibold shadow hover:bg-red-600",children:"Cerrar sesin"}),y&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>b(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>b(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:I,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]})]}),i.jsx("main",{className:oy("flex-1 overflow-y-auto px-3 pt-3",S?"pb-[calc(92px+env(safe-area-inset-bottom))]":"pb-[calc(16px+env(safe-area-inset-bottom))]"),children:i.jsx(BY,{})}),S&&i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md pb-[env(safe-area-inset-bottom)]",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:w.map(B=>i.jsx(Nn,{to:B.to,className:_,children:B.label},B.key))})})]})}const Fee=6048e5,sbe=864e5,ibe=6e4,obe=36e5,lbe=1e3,_9=Symbol.for("constructDateFrom");function uo(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&_9 in t?t[_9](e):t instanceof Date?new t.constructor(e):new Date(e)}function hi(t,e){return uo(e||t,t)}function P6(t,e,r){const n=hi(t,r==null?void 0:r.in);return isNaN(e)?uo((r==null?void 0:r.in)||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function cbe(t,e,r){const n=hi(t,r==null?void 0:r.in);if(isNaN(e))return uo(t,NaN);const a=n.getDate(),s=uo(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}let ube={};function m1(){return ube}function Cm(t,e){var l,c,u,d;const r=m1(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=hi(t,e==null?void 0:e.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Rv(t,e){return Cm(t,{...e,weekStartsOn:1})}function Oee(t,e){const r=hi(t,e==null?void 0:e.in),n=r.getFullYear(),a=uo(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Rv(a),o=uo(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Rv(o);return r.getTime()>=s.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function vS(t){const e=hi(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function dbe(t,...e){const r=uo.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function E9(t,e){const r=hi(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function fbe(t,e,r){const[n,a]=dbe(r==null?void 0:r.in,t,e),s=E9(n),o=E9(a),l=+s-vS(s),c=+o-vS(o);return Math.round((l-c)/sbe)}function hbe(t,e){const r=Oee(t,e),n=uo(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Rv(n)}function Abe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function B6(t){return!(!Abe(t)&&typeof t!="number"||isNaN(+hi(t)))}function Ld(t,e){const r=hi(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Ud(t,e){const r=hi(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function mbe(t,e){const r=hi(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const pbe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gbe=(t,e,r)=>{let n;const a=pbe[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function P4(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const xbe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},vbe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ybe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bbe={date:P4({formats:xbe,defaultWidth:"full"}),time:P4({formats:vbe,defaultWidth:"full"}),dateTime:P4({formats:ybe,defaultWidth:"full"})},wbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Nbe=(t,e,r,n)=>wbe[t];function ly(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return a[s]}}const Cbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},_be={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ebe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Sbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ibe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},jbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Pbe=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Bbe={ordinalNumber:Pbe,era:ly({values:Cbe,defaultWidth:"wide"}),quarter:ly({values:_be,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ly({values:Ebe,defaultWidth:"wide"}),day:ly({values:Sbe,defaultWidth:"wide"}),dayPeriod:ly({values:Ibe,defaultWidth:"wide",formattingValues:jbe,defaultFormattingWidth:"wide"})};function cy(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(a);if(!s)return null;const o=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?kbe(l,f=>f.test(o)):Tbe(l,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function Tbe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function kbe(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Fbe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const Obe=/^(\d+)(th|st|nd|rd)?/i,Dbe=/\d+/i,Rbe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Mbe={any:[/^b/i,/^(a|c)/i]},Lbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ube={any:[/1/i,/2/i,/3/i,/4/i]},Qbe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Vbe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Hbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$be={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Kbe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Gbe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},qbe={ordinalNumber:Fbe({matchPattern:Obe,parsePattern:Dbe,valueCallback:t=>parseInt(t,10)}),era:cy({matchPatterns:Rbe,defaultMatchWidth:"wide",parsePatterns:Mbe,defaultParseWidth:"any"}),quarter:cy({matchPatterns:Lbe,defaultMatchWidth:"wide",parsePatterns:Ube,defaultParseWidth:"any",valueCallback:t=>t+1}),month:cy({matchPatterns:Qbe,defaultMatchWidth:"wide",parsePatterns:Vbe,defaultParseWidth:"any"}),day:cy({matchPatterns:Hbe,defaultMatchWidth:"wide",parsePatterns:$be,defaultParseWidth:"any"}),dayPeriod:cy({matchPatterns:Kbe,defaultMatchWidth:"any",parsePatterns:Gbe,defaultParseWidth:"any"})},Dee={code:"en-US",formatDistance:gbe,formatLong:bbe,formatRelative:Nbe,localize:Bbe,match:qbe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zbe(t,e){const r=hi(t,e==null?void 0:e.in);return fbe(r,mbe(r))+1}function Ree(t,e){const r=hi(t,e==null?void 0:e.in),n=+Rv(r)-+hbe(r);return Math.round(n/Fee)+1}function T6(t,e){var d,f,A,h;const r=hi(t,e==null?void 0:e.in),n=r.getFullYear(),a=m1(),s=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(A=a.locale)==null?void 0:A.options)==null?void 0:h.firstWeekContainsDate)??1,o=uo((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const l=Cm(o,e),c=uo((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const u=Cm(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function Wbe(t,e){var l,c,u,d;const r=m1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=T6(t,e),s=uo((e==null?void 0:e.in)||t,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),Cm(s,e)}function Mee(t,e){const r=hi(t,e==null?void 0:e.in),n=+Cm(r,e)-+Wbe(r,e);return Math.round(n/Fee)+1}function Ya(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const u0={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Ya(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Ya(r+1,2)},d(t,e){return Ya(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Ya(t.getHours()%12||12,e.length)},H(t,e){return Ya(t.getHours(),e.length)},m(t,e){return Ya(t.getMinutes(),e.length)},s(t,e){return Ya(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ya(a,e.length)}},rx={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},S9={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return u0.y(t,e)},Y:function(t,e,r,n){const a=T6(t,n),s=a>0?a:1-a;if(e==="YY"){const o=s%100;return Ya(o,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ya(s,e.length)},R:function(t,e){const r=Oee(t);return Ya(r,e.length)},u:function(t,e){const r=t.getFullYear();return Ya(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Ya(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Ya(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return u0.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Ya(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=Mee(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):Ya(a,e.length)},I:function(t,e,r){const n=Ree(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Ya(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):u0.d(t,e)},D:function(t,e,r){const n=zbe(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ya(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Ya(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Ya(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return Ya(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=rx.noon:n===0?a=rx.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=rx.evening:n>=12?a=rx.afternoon:n>=4?a=rx.morning:a=rx.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return u0.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):u0.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ya(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ya(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):u0.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):u0.s(t,e)},S:function(t,e){return u0.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return j9(n);case"XXXX":case"XX":return lp(n);case"XXXXX":case"XXX":default:return lp(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return j9(n);case"xxxx":case"xx":return lp(n);case"xxxxx":case"xxx":default:return lp(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+I9(n,":");case"OOOO":default:return"GMT"+lp(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+I9(n,":");case"zzzz":default:return"GMT"+lp(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return Ya(n,e.length)},T:function(t,e,r){return Ya(+t,e.length)}};function I9(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+e+Ya(s,2)}function j9(t,e){return t%60===0?(t>0?"-":"+")+Ya(Math.abs(t)/60,2):lp(t,e)}function lp(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Ya(Math.trunc(n/60),2),s=Ya(n%60,2);return r+a+e+s}const P9=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Lee=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Xbe=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return P9(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",P9(n,e)).replace("{{time}}",Lee(a,e))},ck={p:Lee,P:Xbe},Ybe=/^D+$/,Jbe=/^Y+$/,Zbe=["D","DD","YY","YYYY"];function Uee(t){return Ybe.test(t)}function Qee(t){return Jbe.test(t)}function uk(t,e,r){const n=e2e(t,e,r);if(console.warn(n),Zbe.includes(t))throw new RangeError(n)}function e2e(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const t2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,r2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,n2e=/^'([^]*?)'?$/,a2e=/''/g,s2e=/[a-zA-Z]/;function Ur(t,e,r){var d,f,A,h;const n=m1(),a=n.locale??Dee,s=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(A=n.locale)==null?void 0:A.options)==null?void 0:h.weekStartsOn)??0,l=hi(t,r==null?void 0:r.in);if(!B6(l))throw new RangeError("Invalid time value");let c=e.match(r2e).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=ck[p];return x(m,a.formatLong)}return m}).join("").match(t2e).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:i2e(m)};if(S9[p])return{isToken:!0,value:m};if(p.match(s2e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const u={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(Qee(p)||Uee(p))&&uk(p,e,String(t));const x=S9[p[0]];return x(l,p,a.localize,u)}).join("")}function i2e(t){const e=t.match(n2e);return e?e[1].replace(a2e,"'"):t}function o2e(){return Object.assign({},m1())}function l2e(t,e){const r=hi(t,e==null?void 0:e.in).getDay();return r===0?7:r}function c2e(t,e){const r=u2e(e)?new e(0):uo(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function u2e(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const d2e=10;class Vee{constructor(){Br(this,"subPriority",0)}validate(e,r){return!0}}class f2e extends Vee{constructor(e,r,n,a,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class h2e extends Vee{constructor(r,n){super();Br(this,"priority",d2e);Br(this,"subPriority",-1);this.context=r||(a=>uo(n,a))}set(r,n){return n.timestampIsSet?r:uo(r,c2e(r,this.context))}}let Ra=class{run(e,r,n,a){const s=this.parse(e,r,n,a);return s?{setter:new f2e(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}};class A2e extends Ra{constructor(){super(...arguments);Br(this,"priority",140);Br(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,n,a){return n.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}const Gi={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},qf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function qi(t,e){return t&&{value:e(t.value),rest:t.rest}}function oi(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function zf(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,a=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(a*obe+s*ibe+o*lbe),rest:e.slice(r[0].length)}}function Hee(t){return oi(Gi.anyDigitsSigned,t)}function ji(t,e){switch(t){case 1:return oi(Gi.singleDigit,e);case 2:return oi(Gi.twoDigits,e);case 3:return oi(Gi.threeDigits,e);case 4:return oi(Gi.fourDigits,e);default:return oi(new RegExp("^\\d{1,"+t+"}"),e)}}function yS(t,e){switch(t){case 1:return oi(Gi.singleDigitSigned,e);case 2:return oi(Gi.twoDigitsSigned,e);case 3:return oi(Gi.threeDigitsSigned,e);case 4:return oi(Gi.fourDigitsSigned,e);default:return oi(new RegExp("^-?\\d{1,"+t+"}"),e)}}function k6(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function $ee(t,e){const r=e>0,n=r?e:1-e;let a;if(n<=50)a=t||100;else{const s=n+50,o=Math.trunc(s/100)*100,l=t>=s%100;a=t+o-(l?100:0)}return r?a:1-a}function Kee(t){return t%400===0||t%4===0&&t%100!==0}class m2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return qi(ji(4,r),s);case"yo":return qi(a.ordinalNumber(r,{unit:"year"}),s);default:return qi(ji(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a){const s=r.getFullYear();if(a.isTwoDigitYear){const l=$ee(a.year,s);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class p2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return qi(ji(4,r),s);case"Yo":return qi(a.ordinalNumber(r,{unit:"year"}),s);default:return qi(ji(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a,s){const o=T6(r,s);if(a.isTwoDigitYear){const c=$ee(a.year,o);return r.setFullYear(c,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Cm(r,s)}const l=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Cm(r,s)}}class g2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return yS(n==="R"?4:n.length,r)}set(r,n,a){const s=uo(r,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Rv(s)}}class x2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return yS(n==="u"?4:n.length,r)}set(r,n,a){return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class v2e extends Ra{constructor(){super(...arguments);Br(this,"priority",120);Br(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"Q":case"QQ":return ji(n.length,r);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})||a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class y2e extends Ra{constructor(){super(...arguments);Br(this,"priority",120);Br(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"q":case"qq":return ji(n.length,r);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})||a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class b2e extends Ra{constructor(){super(...arguments);Br(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Br(this,"priority",110)}parse(r,n,a){const s=o=>o-1;switch(n){case"M":return qi(oi(Gi.month,r),s);case"MM":return qi(ji(2,r),s);case"Mo":return qi(a.ordinalNumber(r,{unit:"month"}),s);case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})||a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}class w2e extends Ra{constructor(){super(...arguments);Br(this,"priority",110);Br(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,a){const s=o=>o-1;switch(n){case"L":return qi(oi(Gi.month,r),s);case"LL":return qi(ji(2,r),s);case"Lo":return qi(a.ordinalNumber(r,{unit:"month"}),s);case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})||a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}function N2e(t,e,r){const n=hi(t,r==null?void 0:r.in),a=Mee(n,r)-e;return n.setDate(n.getDate()-a*7),hi(n,r==null?void 0:r.in)}class C2e extends Ra{constructor(){super(...arguments);Br(this,"priority",100);Br(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,a){switch(n){case"w":return oi(Gi.week,r);case"wo":return a.ordinalNumber(r,{unit:"week"});default:return ji(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a,s){return Cm(N2e(r,a,s),s)}}function _2e(t,e,r){const n=hi(t,r==null?void 0:r.in),a=Ree(n,r)-e;return n.setDate(n.getDate()-a*7),n}class E2e extends Ra{constructor(){super(...arguments);Br(this,"priority",100);Br(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,a){switch(n){case"I":return oi(Gi.week,r);case"Io":return a.ordinalNumber(r,{unit:"week"});default:return ji(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a){return Rv(_2e(r,a))}}const S2e=[31,28,31,30,31,30,31,31,30,31,30,31],I2e=[31,29,31,30,31,30,31,31,30,31,30,31];class j2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"subPriority",1);Br(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"d":return oi(Gi.date,r);case"do":return a.ordinalNumber(r,{unit:"date"});default:return ji(n.length,r)}}validate(r,n){const a=r.getFullYear(),s=Kee(a),o=r.getMonth();return s?n>=1&&n<=I2e[o]:n>=1&&n<=S2e[o]}set(r,n,a){return r.setDate(a),r.setHours(0,0,0,0),r}}class P2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"subpriority",1);Br(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,a){switch(n){case"D":case"DD":return oi(Gi.dayOfYear,r);case"Do":return a.ordinalNumber(r,{unit:"date"});default:return ji(n.length,r)}}validate(r,n){const a=r.getFullYear();return Kee(a)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,a){return r.setMonth(0,a),r.setHours(0,0,0,0),r}}function F6(t,e,r){var f,A,h,m;const n=m1(),a=(r==null?void 0:r.weekStartsOn)??((A=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:A.weekStartsOn)??n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,s=hi(t,r==null?void 0:r.in),o=s.getDay(),c=(e%7+7)%7,u=7-a,d=e<0||e>6?e-(o+u)%7:(c+u)%7-(o+u)%7;return P6(s,d,r)}class B2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=F6(r,a,s),r.setHours(0,0,0,0),r}}class T2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return qi(ji(n.length,r),o);case"eo":return qi(a.ordinalNumber(r,{unit:"day"}),o);case"eee":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=F6(r,a,s),r.setHours(0,0,0,0),r}}class k2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return qi(ji(n.length,r),o);case"co":return qi(a.ordinalNumber(r,{unit:"day"}),o);case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})||a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=F6(r,a,s),r.setHours(0,0,0,0),r}}function F2e(t,e,r){const n=hi(t,r==null?void 0:r.in),a=l2e(n,r),s=e-a;return P6(n,s,r)}class O2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return ji(n.length,r);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return qi(a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return qi(a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return qi(a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return qi(a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,a){return r=F2e(r,a),r.setHours(0,0,0,0),r}}class D2e extends Ra{constructor(){super(...arguments);Br(this,"priority",80);Br(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(k6(a),0,0,0),r}}class R2e extends Ra{constructor(){super(...arguments);Br(this,"priority",80);Br(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(k6(a),0,0,0),r}}class M2e extends Ra{constructor(){super(...arguments);Br(this,"priority",80);Br(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(k6(a),0,0,0),r}}class L2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,a){switch(n){case"h":return oi(Gi.hour12h,r);case"ho":return a.ordinalNumber(r,{unit:"hour"});default:return ji(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,a){const s=r.getHours()>=12;return s&&a<12?r.setHours(a+12,0,0,0):!s&&a===12?r.setHours(0,0,0,0):r.setHours(a,0,0,0),r}}class U2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,a){switch(n){case"H":return oi(Gi.hour23h,r);case"Ho":return a.ordinalNumber(r,{unit:"hour"});default:return ji(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,a){return r.setHours(a,0,0,0),r}}class Q2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,a){switch(n){case"K":return oi(Gi.hour11h,r);case"Ko":return a.ordinalNumber(r,{unit:"hour"});default:return ji(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.getHours()>=12&&a<12?r.setHours(a+12,0,0,0):r.setHours(a,0,0,0),r}}class V2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,a){switch(n){case"k":return oi(Gi.hour24h,r);case"ko":return a.ordinalNumber(r,{unit:"hour"});default:return ji(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,a){const s=a<=24?a%24:a;return r.setHours(s,0,0,0),r}}class H2e extends Ra{constructor(){super(...arguments);Br(this,"priority",60);Br(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"m":return oi(Gi.minute,r);case"mo":return a.ordinalNumber(r,{unit:"minute"});default:return ji(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setMinutes(a,0,0),r}}class $2e extends Ra{constructor(){super(...arguments);Br(this,"priority",50);Br(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"s":return oi(Gi.second,r);case"so":return a.ordinalNumber(r,{unit:"second"});default:return ji(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setSeconds(a,0),r}}class K2e extends Ra{constructor(){super(...arguments);Br(this,"priority",30);Br(this,"incompatibleTokens",["t","T"])}parse(r,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return qi(ji(n.length,r),a)}set(r,n,a){return r.setMilliseconds(a),r}}class G2e extends Ra{constructor(){super(...arguments);Br(this,"priority",10);Br(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return zf(qf.basicOptionalMinutes,r);case"XX":return zf(qf.basic,r);case"XXXX":return zf(qf.basicOptionalSeconds,r);case"XXXXX":return zf(qf.extendedOptionalSeconds,r);case"XXX":default:return zf(qf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:uo(r,r.getTime()-vS(r)-a)}}class q2e extends Ra{constructor(){super(...arguments);Br(this,"priority",10);Br(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return zf(qf.basicOptionalMinutes,r);case"xx":return zf(qf.basic,r);case"xxxx":return zf(qf.basicOptionalSeconds,r);case"xxxxx":return zf(qf.extendedOptionalSeconds,r);case"xxx":default:return zf(qf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:uo(r,r.getTime()-vS(r)-a)}}class z2e extends Ra{constructor(){super(...arguments);Br(this,"priority",40);Br(this,"incompatibleTokens","*")}parse(r){return Hee(r)}set(r,n,a){return[uo(r,a*1e3),{timestampIsSet:!0}]}}class W2e extends Ra{constructor(){super(...arguments);Br(this,"priority",20);Br(this,"incompatibleTokens","*")}parse(r){return Hee(r)}set(r,n,a){return[uo(r,a),{timestampIsSet:!0}]}}const X2e={G:new A2e,y:new m2e,Y:new p2e,R:new g2e,u:new x2e,Q:new v2e,q:new y2e,M:new b2e,L:new w2e,w:new C2e,I:new E2e,d:new j2e,D:new P2e,E:new B2e,e:new T2e,c:new k2e,i:new O2e,a:new D2e,b:new R2e,B:new M2e,h:new L2e,H:new U2e,K:new Q2e,k:new V2e,m:new H2e,s:new $2e,S:new K2e,X:new G2e,x:new q2e,t:new z2e,T:new W2e},Y2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,J2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Z2e=/^'([^]*?)'?$/,ewe=/''/g,twe=/\S/,rwe=/[a-zA-Z]/;function bS(t,e,r,n){var x,v,y,b;const a=()=>uo(r,NaN),s=o2e(),o=s.locale??Dee,l=s.firstWeekContainsDate??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.firstWeekContainsDate)??1,c=s.weekStartsOn??((b=(y=s.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??0;if(!e)return t?a():hi(r,n==null?void 0:n.in);const u={firstWeekContainsDate:l,weekStartsOn:c,locale:o},d=[new h2e(n==null?void 0:n.in,r)],f=e.match(J2e).map(w=>{const j=w[0];if(j in ck){const I=ck[j];return I(w,o.formatLong)}return w}).join("").match(Y2e),A=[];for(let w of f){Qee(w)&&uk(w,e,t),Uee(w)&&uk(w,e,t);const j=w[0],I=X2e[j];if(I){const{incompatibleTokens:_}=I;if(Array.isArray(_)){const E=A.find(B=>_.includes(B.token)||B.token===j);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${w}\` at the same time`)}else if(I.incompatibleTokens==="*"&&A.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);A.push({token:j,fullToken:w});const S=I.run(t,w,o.match,u);if(!S)return a();d.push(S.setter),t=S.rest}else{if(j.match(rwe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(w==="''"?w="'":j==="'"&&(w=nwe(w)),t.indexOf(w)===0)t=t.slice(w.length);else return a()}}if(t.length>0&&twe.test(t))return a();const h=d.map(w=>w.priority).sort((w,j)=>j-w).filter((w,j,I)=>I.indexOf(w)===j).map(w=>d.filter(j=>j.priority===w).sort((j,I)=>I.subPriority-j.subPriority)).map(w=>w[0]);let m=hi(r,n==null?void 0:n.in);if(isNaN(+m))return a();const p={};for(const w of h){if(!w.validate(m,u))return a();const j=w.set(m,p,u);Array.isArray(j)?(m=j[0],Object.assign(p,j[1])):m=j}return m}function nwe(t){return t.match(Z2e)[1].replace(ewe,"'")}function Gee(t,e,r){return P6(t,-14,r)}function awe(t,e,r){return cbe(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var dk=function(t,e){return dk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},dk(t,e)};function Sf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");dk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var fk=function(){return fk=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},fk.apply(this,arguments)};function vc(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,[])).next())})}function Xl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function iC(t,e,r){if(arguments.length===2)for(var n=0,a=e.length,s;n<a;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||e)}var vA=function(){function t(e,r,n,a){this.left=e,this.top=r,this.width=n,this.height=a}return t.prototype.add=function(e,r,n,a){return new t(this.left+e,this.top+r,this.width+n,this.height+a)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),zj=function(t,e){return vA.fromClientRect(t,e.getBoundingClientRect())},swe=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),a=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new vA(0,0,n,a)},Wj=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},Ui=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},B9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",iwe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var oC=0;oC<B9.length;oC++)iwe[B9.charCodeAt(oC)]=oC;var T9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lC=0;lC<T9.length;lC++)Qy[T9.charCodeAt(lC)]=lC;var owe=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Qy[t.charCodeAt(n)],o=Qy[t.charCodeAt(n+1)],l=Qy[t.charCodeAt(n+2)],c=Qy[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},lwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},cwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Fp=5,O6=11,B4=2,uwe=O6-Fp,qee=65536>>Fp,dwe=1<<Fp,T4=dwe-1,fwe=1024>>Fp,hwe=qee+fwe,Awe=hwe,mwe=32,pwe=Awe+mwe,gwe=65536>>O6,xwe=1<<uwe,vwe=xwe-1,k9=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},ywe=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},bwe=function(t,e){var r=owe(t),n=Array.isArray(r)?cwe(r):new Uint32Array(r),a=Array.isArray(r)?lwe(r):new Uint16Array(r),s=24,o=k9(a,s/2,n[4]/2),l=n[5]===2?k9(a,(s+n[4])/2):ywe(n,Math.ceil((s+n[4])/4));return new wwe(n[0],n[1],n[2],n[3],o,l)},wwe=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Fp],r=(r<<B4)+(e&T4),this.data[r];if(e<=65535)return r=this.index[qee+(e-55296>>Fp)],r=(r<<B4)+(e&T4),this.data[r];if(e<this.highStart)return r=pwe-gwe+(e>>O6),r=this.index[r],r+=e>>Fp&vwe,r=this.index[r],r=(r<<B4)+(e&T4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),F9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Nwe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cC=0;cC<F9.length;cC++)Nwe[F9.charCodeAt(cC)]=cC;var Cwe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",O9=50,_we=1,zee=2,Wee=3,Ewe=4,Swe=5,D9=7,Xee=8,R9=9,K0=10,hk=11,M9=12,Ak=13,Iwe=14,Vy=15,mk=16,uC=17,uy=18,jwe=19,L9=20,pk=21,dy=22,k4=23,nx=24,_u=25,Hy=26,$y=27,ax=28,Pwe=29,xp=30,Bwe=31,dC=32,fC=33,gk=34,xk=35,vk=36,N2=37,yk=38,dE=39,fE=40,F4=41,Yee=42,Twe=43,kwe=[9001,65288],Jee="!",fa="",hC="",bk=bwe(Cwe),_h=[xp,vk],wk=[_we,zee,Wee,Swe],Zee=[K0,Xee],U9=[$y,Hy],Fwe=wk.concat(Zee),Q9=[yk,dE,fE,gk,xk],Owe=[Vy,Ak],Dwe=function(t,e){e===void 0&&(e="strict");var r=[],n=[],a=[];return t.forEach(function(s,o){var l=bk.get(s);if(l>O9?(a.push(!0),l-=O9):a.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(o),r.push(mk);if(l===Ewe||l===hk){if(o===0)return n.push(o),r.push(xp);var c=r[o-1];return Fwe.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(xp))}if(n.push(o),l===Bwe)return r.push(e==="strict"?pk:N2);if(l===Yee||l===Pwe)return r.push(xp);if(l===Twe)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(N2):r.push(xp);r.push(l)}),[n,r,a]},O4=function(t,e,r,n){var a=n[r];if(Array.isArray(t)?t.indexOf(a)!==-1:t===a)for(var s=r;s<=n.length;){s++;var o=n[s];if(o===e)return!0;if(o!==K0)break}if(a===K0)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==K0)break}if(l!==K0)break}return!1},V9=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===K0)r--;else return n}return 0},Rwe=function(t,e,r,n,a){if(r[n]===0)return fa;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return fa;var o=s-1,l=s+1,c=e[s],u=o>=0?e[o]:0,d=e[l];if(c===zee&&d===Wee)return fa;if(wk.indexOf(c)!==-1)return Jee;if(wk.indexOf(d)!==-1||Zee.indexOf(d)!==-1)return fa;if(V9(s,e)===Xee)return hC;if(bk.get(t[s])===hk||(c===dC||c===fC)&&bk.get(t[l])===hk||c===D9||d===D9||c===R9||[K0,Ak,Vy].indexOf(c)===-1&&d===R9||[uC,uy,jwe,nx,ax].indexOf(d)!==-1||V9(s,e)===dy||O4(k4,dy,s,e)||O4([uC,uy],pk,s,e)||O4(M9,M9,s,e))return fa;if(c===K0)return hC;if(c===k4||d===k4)return fa;if(d===mk||c===mk)return hC;if([Ak,Vy,pk].indexOf(d)!==-1||c===Iwe||u===vk&&Owe.indexOf(c)!==-1||c===ax&&d===vk||d===L9||_h.indexOf(d)!==-1&&c===_u||_h.indexOf(c)!==-1&&d===_u||c===$y&&[N2,dC,fC].indexOf(d)!==-1||[N2,dC,fC].indexOf(c)!==-1&&d===Hy||_h.indexOf(c)!==-1&&U9.indexOf(d)!==-1||U9.indexOf(c)!==-1&&_h.indexOf(d)!==-1||[$y,Hy].indexOf(c)!==-1&&(d===_u||[dy,Vy].indexOf(d)!==-1&&e[l+1]===_u)||[dy,Vy].indexOf(c)!==-1&&d===_u||c===_u&&[_u,ax,nx].indexOf(d)!==-1)return fa;if([_u,ax,nx,uC,uy].indexOf(d)!==-1)for(var f=s;f>=0;){var A=e[f];if(A===_u)return fa;if([ax,nx].indexOf(A)!==-1)f--;else break}if([$y,Hy].indexOf(d)!==-1)for(var f=[uC,uy].indexOf(c)!==-1?o:s;f>=0;){var A=e[f];if(A===_u)return fa;if([ax,nx].indexOf(A)!==-1)f--;else break}if(yk===c&&[yk,dE,gk,xk].indexOf(d)!==-1||[dE,gk].indexOf(c)!==-1&&[dE,fE].indexOf(d)!==-1||[fE,xk].indexOf(c)!==-1&&d===fE||Q9.indexOf(c)!==-1&&[L9,Hy].indexOf(d)!==-1||Q9.indexOf(d)!==-1&&c===$y||_h.indexOf(c)!==-1&&_h.indexOf(d)!==-1||c===nx&&_h.indexOf(d)!==-1||_h.concat(_u).indexOf(c)!==-1&&d===dy&&kwe.indexOf(t[l])===-1||_h.concat(_u).indexOf(d)!==-1&&c===uy)return fa;if(c===F4&&d===F4){for(var h=r[s],m=1;h>0&&(h--,e[h]===F4);)m++;if(m%2!==0)return fa}return c===dC&&d===fC?fa:hC},Mwe=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=Dwe(t,e.lineBreak),n=r[0],a=r[1],s=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(a=a.map(function(l){return[_u,xp,Yee].indexOf(l)!==-1?N2:l}));var o=e.wordBreak==="keep-all"?s.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,a,o]},Lwe=function(){function t(e,r,n,a){this.codePoints=e,this.required=r===Jee,this.start=n,this.end=a}return t.prototype.slice=function(){return Ui.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),Uwe=function(t,e){var r=Wj(t),n=Mwe(r,e),a=n[0],s=n[1],o=n[2],l=r.length,c=0,u=0;return{next:function(){if(u>=l)return{done:!0,value:null};for(var d=fa;u<l&&(d=Rwe(r,s,a,++u,o))===fa;);if(d!==fa||u===l){var f=new Lwe(r,d,c,u);return c=u,{value:f,done:!1}}return{done:!0,value:null}}}},Qwe=1,Vwe=2,Fw=4,H9=8,wS=10,$9=47,vb=92,Hwe=9,$we=32,AC=34,fy=61,Kwe=35,Gwe=36,qwe=37,mC=39,pC=40,hy=41,zwe=95,Xc=45,Wwe=33,Xwe=60,Ywe=62,Jwe=64,Zwe=91,eNe=93,tNe=61,rNe=123,gC=63,nNe=125,K9=124,aNe=126,sNe=128,G9=65533,D4=42,Cp=43,iNe=44,oNe=58,lNe=59,C2=46,cNe=0,uNe=8,dNe=11,fNe=14,hNe=31,ANe=127,Df=-1,ete=48,tte=97,rte=101,mNe=102,pNe=117,gNe=122,nte=65,ate=69,ste=70,xNe=85,vNe=90,Zl=function(t){return t>=ete&&t<=57},yNe=function(t){return t>=55296&&t<=57343},sx=function(t){return Zl(t)||t>=nte&&t<=ste||t>=tte&&t<=mNe},bNe=function(t){return t>=tte&&t<=gNe},wNe=function(t){return t>=nte&&t<=vNe},NNe=function(t){return bNe(t)||wNe(t)},CNe=function(t){return t>=sNe},xC=function(t){return t===wS||t===Hwe||t===$we},NS=function(t){return NNe(t)||CNe(t)||t===zwe},q9=function(t){return NS(t)||Zl(t)||t===Xc},_Ne=function(t){return t>=cNe&&t<=uNe||t===dNe||t>=fNe&&t<=hNe||t===ANe},S0=function(t,e){return t!==vb?!1:e!==wS},vC=function(t,e,r){return t===Xc?NS(e)||S0(e,r):NS(t)?!0:!!(t===vb&&S0(t,e))},R4=function(t,e,r){return t===Cp||t===Xc?Zl(e)?!0:e===C2&&Zl(r):Zl(t===C2?e:t)},ENe=function(t){var e=0,r=1;(t[e]===Cp||t[e]===Xc)&&(t[e]===Xc&&(r=-1),e++);for(var n=[];Zl(t[e]);)n.push(t[e++]);var a=n.length?parseInt(Ui.apply(void 0,n),10):0;t[e]===C2&&e++;for(var s=[];Zl(t[e]);)s.push(t[e++]);var o=s.length,l=o?parseInt(Ui.apply(void 0,s),10):0;(t[e]===ate||t[e]===rte)&&e++;var c=1;(t[e]===Cp||t[e]===Xc)&&(t[e]===Xc&&(c=-1),e++);for(var u=[];Zl(t[e]);)u.push(t[e++]);var d=u.length?parseInt(Ui.apply(void 0,u),10):0;return r*(a+l*Math.pow(10,-o))*Math.pow(10,c*d)},SNe={type:2},INe={type:3},jNe={type:4},PNe={type:13},BNe={type:8},TNe={type:21},kNe={type:9},FNe={type:10},ONe={type:11},DNe={type:12},RNe={type:14},yC={type:23},MNe={type:1},LNe={type:25},UNe={type:24},QNe={type:26},VNe={type:27},HNe={type:28},$Ne={type:29},KNe={type:31},Nk={type:32},ite=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(Wj(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==Nk;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case AC:return this.consumeStringToken(AC);case Kwe:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(q9(r)||S0(n,a)){var s=vC(r,n,a)?Vwe:Qwe,o=this.consumeName();return{type:5,value:o,flags:s}}break;case Gwe:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),PNe;break;case mC:return this.consumeStringToken(mC);case pC:return SNe;case hy:return INe;case D4:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),RNe;break;case Cp:if(R4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case iNe:return jNe;case Xc:var l=e,c=this.peekCodePoint(0),u=this.peekCodePoint(1);if(R4(l,c,u))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(vC(l,c,u))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===Xc&&u===Ywe)return this.consumeCodePoint(),this.consumeCodePoint(),UNe;break;case C2:if(R4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case $9:if(this.peekCodePoint(0)===D4)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===D4&&(d=this.consumeCodePoint(),d===$9))return this.consumeToken();if(d===Df)return this.consumeToken()}break;case oNe:return QNe;case lNe:return VNe;case Xwe:if(this.peekCodePoint(0)===Wwe&&this.peekCodePoint(1)===Xc&&this.peekCodePoint(2)===Xc)return this.consumeCodePoint(),this.consumeCodePoint(),LNe;break;case Jwe:var f=this.peekCodePoint(0),A=this.peekCodePoint(1),h=this.peekCodePoint(2);if(vC(f,A,h)){var o=this.consumeName();return{type:7,value:o}}break;case Zwe:return HNe;case vb:if(S0(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case eNe:return $Ne;case tNe:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),BNe;break;case rNe:return ONe;case nNe:return DNe;case pNe:case xNe:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===Cp&&(sx(p)||p===gC)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case K9:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),kNe;if(this.peekCodePoint(0)===K9)return this.consumeCodePoint(),TNe;break;case aNe:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),FNe;break;case Df:return Nk}return xC(e)?(this.consumeWhiteSpace(),KNe):Zl(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):NS(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Ui(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();sx(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===gC&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(Ui.apply(void 0,e.map(function(c){return c===gC?ete:c})),16),s=parseInt(Ui.apply(void 0,e.map(function(c){return c===gC?ste:c})),16);return{type:30,start:a,end:s}}var o=parseInt(Ui.apply(void 0,e),16);if(this.peekCodePoint(0)===Xc&&sx(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];sx(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt(Ui.apply(void 0,l),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===pC?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===pC?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Df)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===mC||r===AC){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Df||this.peekCodePoint(0)===hy)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),yC)}for(;;){var a=this.consumeCodePoint();if(a===Df||a===hy)return{type:22,value:Ui.apply(void 0,e)};if(xC(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Df||this.peekCodePoint(0)===hy?(this.consumeCodePoint(),{type:22,value:Ui.apply(void 0,e)}):(this.consumeBadUrlRemnants(),yC);if(a===AC||a===mC||a===pC||_Ne(a))return this.consumeBadUrlRemnants(),yC;if(a===vb)if(S0(a,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),yC;else e.push(a)}},t.prototype.consumeWhiteSpace=function(){for(;xC(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===hy||e===Df)return;S0(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var a=Math.min(r,e);n+=Ui.apply(void 0,this._value.splice(0,a)),e-=a}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var a=this._value[n];if(a===Df||a===void 0||a===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===wS)return this._value.splice(0,n),MNe;if(a===vb){var s=this._value[n+1];s!==Df&&s!==void 0&&(s===wS?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):S0(a,s)&&(r+=this.consumeStringSlice(n),r+=Ui(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Fw,n=this.peekCodePoint(0);for((n===Cp||n===Xc)&&e.push(this.consumeCodePoint());Zl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===C2&&Zl(a))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=H9;Zl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===ate||n===rte)&&((a===Cp||a===Xc)&&Zl(s)||Zl(a)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=H9;Zl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[ENe(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(vC(a,s,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===qwe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(sx(e)){for(var r=Ui(e);sx(this.peekCodePoint(0))&&r.length<6;)r+=Ui(this.consumeCodePoint());xC(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||yNe(n)||n>1114111?G9:n}return e===Df?G9:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(q9(r))e+=Ui(r);else if(S0(r,this.peekCodePoint(0)))e+=Ui(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),ote=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new ite;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||qNe(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?Nk:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Ow=function(t){return t.type===15},p1=function(t){return t.type===17},ls=function(t){return t.type===20},GNe=function(t){return t.type===0},Ck=function(t,e){return ls(t)&&t.value===e},lte=function(t){return t.type!==31},Mv=function(t){return t.type!==31&&t.type!==4},Ah=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},qNe=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},_m=function(t){return t.type===17||t.type===15},so=function(t){return t.type===16||_m(t)},cte=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Il={type:17,number:0,flags:Fw},D6={type:16,number:50,flags:Fw},G0={type:16,number:100,flags:Fw},Ky=function(t,e,r){var n=t[0],a=t[1];return[ys(n,e),ys(typeof a<"u"?a:n,r)]},ys=function(t,e){if(t.type===16)return t.number/100*e;if(Ow(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},ute="deg",dte="grad",fte="rad",hte="turn",Xj={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case ute:return Math.PI*e.number/180;case dte:return Math.PI/200*e.number;case fte:return e.number;case hte:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},Ate=function(t){return t.type===15&&(t.unit===ute||t.unit===dte||t.unit===fte||t.unit===hte)},mte=function(t){var e=t.filter(ls).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Il,Il];case"to top":case"bottom":return Nd(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Il,G0];case"to right":case"left":return Nd(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[G0,G0];case"to bottom":case"top":return Nd(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[G0,Il];case"to left":case"right":return Nd(270)}return 0},Nd=function(t){return Math.PI*t/180},um={name:"color",parse:function(t,e){if(e.type===18){var r=zNe[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3);return q0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return q0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6);return q0(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return q0(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var l=sA[e.value.toUpperCase()];if(typeof l<"u")return l}return sA.TRANSPARENT}},dm=function(t){return(255&t)===0},Ho=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,a=255&t>>24;return e<255?"rgba("+a+","+n+","+r+","+e/255+")":"rgb("+a+","+n+","+r+")"},q0=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},z9=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},W9=function(t,e){var r=e.filter(Mv);if(r.length===3){var n=r.map(z9),a=n[0],s=n[1],o=n[2];return q0(a,s,o,1)}if(r.length===4){var l=r.map(z9),a=l[0],s=l[1],o=l[2],c=l[3];return q0(a,s,o,c)}return 0};function M4(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var X9=function(t,e){var r=e.filter(Mv),n=r[0],a=r[1],s=r[2],o=r[3],l=(n.type===17?Nd(n.number):Xj.parse(t,n))/(Math.PI*2),c=so(a)?a.number/100:0,u=so(s)?s.number/100:0,d=typeof o<"u"&&so(o)?ys(o,1):1;if(c===0)return q0(u*255,u*255,u*255,1);var f=u<=.5?u*(c+1):u+c-u*c,A=u*2-f,h=M4(A,f,l+1/3),m=M4(A,f,l),p=M4(A,f,l-1/3);return q0(h*255,m*255,p*255,d)},zNe={hsl:X9,hsla:X9,rgb:W9,rgba:W9},yb=function(t,e){return um.parse(t,ote.create(e).parseComponentValue())},sA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},WNe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(ls(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},XNe={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Yj=function(t,e){var r=um.parse(t,e[0]),n=e[1];return n&&so(n)?{color:r,stop:n}:{color:r,stop:null}},Y9=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=Il),n.stop===null&&(n.stop=G0);for(var a=[],s=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=ys(l,e);c>s?a.push(c):a.push(s),s=c}else a.push(null)}for(var u=null,o=0;o<a.length;o++){var d=a[o];if(d===null)u===null&&(u=o);else if(u!==null){for(var f=o-u,A=a[u-1],h=(d-A)/(f+1),m=1;m<=f;m++)a[u+m-1]=h*m;u=null}}return t.map(function(p,x){var v=p.color;return{color:v,stop:Math.max(Math.min(1,a[x]/e),0)}})},YNe=function(t,e,r){var n=e/2,a=r/2,s=ys(t[0],e)-n,o=a-ys(t[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},JNe=function(t,e,r){var n=typeof t=="number"?t:YNe(t,e,r),a=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),s=e/2,o=r/2,l=a/2,c=Math.sin(n-Math.PI/2)*l,u=Math.cos(n-Math.PI/2)*l;return[a,s-u,s+u,o-c,o+c]},tf=function(t,e){return Math.sqrt(t*t+e*e)},J9=function(t,e,r,n,a){var s=[[0,0],[0,e],[t,0],[t,e]];return s.reduce(function(o,l){var c=l[0],u=l[1],d=tf(r-c,n-u);return(a?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},ZNe=function(t,e,r,n,a){var s=0,o=0;switch(t.size){case 0:t.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(t.shape===0)s=o=Math.min(tf(e,r),tf(e,r-a),tf(e-n,r),tf(e-n,r-a));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(e),Math.abs(e-n)),c=J9(n,a,e,r,!0),u=c[0],d=c[1];s=tf(u-e,(d-r)/l),o=l*s}break;case 1:t.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(t.shape===0)s=o=Math.max(tf(e,r),tf(e,r-a),tf(e-n,r),tf(e-n,r-a));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(e),Math.abs(e-n)),f=J9(n,a,e,r,!1),u=f[0],d=f[1];s=tf(u-e,(d-r)/l),o=l*s}break}return Array.isArray(t.size)&&(s=ys(t.size[0],n),o=t.size.length===2?ys(t.size[1],a):s),[s,o]},eCe=function(t,e){var r=Nd(180),n=[];return Ah(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&o.value==="to"){r=mte(a);return}else if(Ate(o)){r=Xj.parse(t,o);return}}var l=Yj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},bC=function(t,e){var r=Nd(180),n=[];return Ah(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=mte(a);return}else if(Ate(o)){r=(Xj.parse(t,o)+Nd(270))%Nd(360);return}}var l=Yj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},tCe=function(t,e){var r=Nd(180),n=[],a=1,s=0,o=3,l=[];return Ah(e).forEach(function(c,u){var d=c[0];if(u===0){if(ls(d)&&d.value==="linear"){a=1;return}else if(ls(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var f=um.parse(t,d.values[0]);n.push({stop:Il,color:f})}else if(d.name==="to"){var f=um.parse(t,d.values[0]);n.push({stop:G0,color:f})}else if(d.name==="color-stop"){var A=d.values.filter(Mv);if(A.length===2){var f=um.parse(t,A[1]),h=A[0];p1(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:f})}}}}),a===1?{angle:(r+Nd(180))%Nd(360),stops:n,type:a}:{size:o,shape:s,stops:n,position:l,type:a}},pte="closest-side",gte="farthest-side",xte="closest-corner",vte="farthest-corner",yte="circle",bte="ellipse",wte="cover",Nte="contain",rCe=function(t,e){var r=0,n=3,a=[],s=[];return Ah(e).forEach(function(o,l){var c=!0;if(l===0){var u=!1;c=o.reduce(function(f,A){if(u)if(ls(A))switch(A.value){case"center":return s.push(D6),f;case"top":case"left":return s.push(Il),f;case"right":case"bottom":return s.push(G0),f}else(so(A)||_m(A))&&s.push(A);else if(ls(A))switch(A.value){case yte:return r=0,!1;case bte:return r=1,!1;case"at":return u=!0,!1;case pte:return n=0,!1;case wte:case gte:return n=1,!1;case Nte:case xte:return n=2,!1;case vte:return n=3,!1}else if(_m(A)||so(A))return Array.isArray(n)||(n=[]),n.push(A),!1;return f},c)}if(c){var d=Yj(t,o);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},wC=function(t,e){var r=0,n=3,a=[],s=[];return Ah(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,f){if(ls(f))switch(f.value){case"center":return s.push(D6),!1;case"top":case"left":return s.push(Il),!1;case"right":case"bottom":return s.push(G0),!1}else if(so(f)||_m(f))return s.push(f),!1;return d},c):l===1&&(c=o.reduce(function(d,f){if(ls(f))switch(f.value){case yte:return r=0,!1;case bte:return r=1,!1;case Nte:case pte:return n=0,!1;case gte:return n=1,!1;case xte:return n=2,!1;case wte:case vte:return n=3,!1}else if(_m(f)||so(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)),c){var u=Yj(t,o);a.push(u)}}),{size:n,shape:r,stops:a,position:s,type:2}},nCe=function(t){return t.type===1},aCe=function(t){return t.type===2},R6={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=Cte[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function sCe(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!Cte[t.name])}var Cte={"linear-gradient":eCe,"-moz-linear-gradient":bC,"-ms-linear-gradient":bC,"-o-linear-gradient":bC,"-webkit-linear-gradient":bC,"radial-gradient":rCe,"-moz-radial-gradient":wC,"-ms-radial-gradient":wC,"-o-radial-gradient":wC,"-webkit-radial-gradient":wC,"-webkit-gradient":tCe},iCe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Mv(n)&&sCe(n)}).map(function(n){return R6.parse(t,n)})}},oCe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(ls(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},lCe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Ah(e).map(function(r){return r.filter(so)}).map(cte)}},cCe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Ah(e).map(function(r){return r.filter(ls).map(function(n){return n.value}).join(" ")}).map(uCe)}},uCe=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},hv;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(hv||(hv={}));var dCe={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Ah(e).map(function(r){return r.filter(fCe)})}},fCe=function(t){return ls(t)||so(t)},Jj=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},hCe=Jj("top"),ACe=Jj("right"),mCe=Jj("bottom"),pCe=Jj("left"),Zj=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return cte(r.filter(so))}}},gCe=Zj("top-left"),xCe=Zj("top-right"),vCe=Zj("bottom-right"),yCe=Zj("bottom-left"),eP=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},bCe=eP("top"),wCe=eP("right"),NCe=eP("bottom"),CCe=eP("left"),tP=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Ow(r)?r.number:0}}},_Ce=tP("top"),ECe=tP("right"),SCe=tP("bottom"),ICe=tP("left"),jCe={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},PCe={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},BCe={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).reduce(function(r,n){return r|TCe(n.value)},0)}},TCe=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},kCe={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},FCe={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},CS;(function(t){t.NORMAL="normal",t.STRICT="strict"})(CS||(CS={}));var OCe={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return CS.STRICT;case"normal":default:return CS.NORMAL}}},DCe={name:"line-height",initialValue:"normal",prefix:!1,type:4},Z9=function(t,e){return ls(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:so(t)?ys(t,e):e},RCe={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:R6.parse(t,e)}},MCe={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},_k={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},rP=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},LCe=rP("top"),UCe=rP("right"),QCe=rP("bottom"),VCe=rP("left"),HCe={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},$Ce={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},nP=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},KCe=nP("top"),GCe=nP("right"),qCe=nP("bottom"),zCe=nP("left"),WCe={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},XCe={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},YCe={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Ck(e[0],"none")?[]:Ah(e).map(function(r){for(var n={color:sA.TRANSPARENT,offsetX:Il,offsetY:Il,blur:Il},a=0,s=0;s<r.length;s++){var o=r[s];_m(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:n.blur=o,a++):n.color=um.parse(t,o)}return n})}},JCe={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},ZCe={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=r_e[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},e_e=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},t_e=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var a=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,a,s,o,l]:null},r_e={matrix:e_e,matrix3d:t_e},eQ={type:16,number:50,flags:Fw},n_e=[eQ,eQ],a_e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(so);return r.length!==2?n_e:[r[0],r[1]]}},s_e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},bb;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(bb||(bb={}));var i_e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return bb.BREAK_ALL;case"keep-all":return bb.KEEP_ALL;case"normal":default:return bb.NORMAL}}},o_e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(p1(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},_te={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},l_e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return p1(e)?e.number:1}},c_e={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},u_e={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},d_e={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},f_e={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},h_e={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(p1(e))return e.number;if(ls(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},A_e={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(ls).map(function(r){return r.value})}},m_e={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Io=function(t,e){return(t&e)!==0},p_e={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},g_e={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=e.filter(lte),s=0;s<a.length;s++){var o=a[s],l=a[s+1];if(o.type===20){var c=l&&p1(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},x_e={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(lte),a=0;a<n.length;a++){var s=n[a],o=n[a+1];if(ls(s)&&s.value!=="none"){var l=o&&p1(o)?o.number:0;r.push({counter:s.value,reset:l})}}return r}},v_e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Ow).map(function(r){return _te.parse(t,r)})}},y_e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],a=e.filter(GNe);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var o=a[s].value,l=a[s+1].value;n.push({open:o,close:l})}return n}},tQ=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},b_e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Ck(e[0],"none")?[]:Ah(e).map(function(r){for(var n={color:255,offsetX:Il,offsetY:Il,blur:Il,spread:Il,inset:!1},a=0,s=0;s<r.length;s++){var o=r[s];Ck(o,"inset")?n.inset=!0:_m(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:a===2?n.blur=o:n.spread=o,a++):n.color=um.parse(t,o)}return n})}},w_e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(ls).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},N_e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},C_e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Ow(e)?e.number:0}},__e=function(){function t(e,r){var n,a;this.animationDuration=nn(e,v_e,r.animationDuration),this.backgroundClip=nn(e,WNe,r.backgroundClip),this.backgroundColor=nn(e,XNe,r.backgroundColor),this.backgroundImage=nn(e,iCe,r.backgroundImage),this.backgroundOrigin=nn(e,oCe,r.backgroundOrigin),this.backgroundPosition=nn(e,lCe,r.backgroundPosition),this.backgroundRepeat=nn(e,cCe,r.backgroundRepeat),this.backgroundSize=nn(e,dCe,r.backgroundSize),this.borderTopColor=nn(e,hCe,r.borderTopColor),this.borderRightColor=nn(e,ACe,r.borderRightColor),this.borderBottomColor=nn(e,mCe,r.borderBottomColor),this.borderLeftColor=nn(e,pCe,r.borderLeftColor),this.borderTopLeftRadius=nn(e,gCe,r.borderTopLeftRadius),this.borderTopRightRadius=nn(e,xCe,r.borderTopRightRadius),this.borderBottomRightRadius=nn(e,vCe,r.borderBottomRightRadius),this.borderBottomLeftRadius=nn(e,yCe,r.borderBottomLeftRadius),this.borderTopStyle=nn(e,bCe,r.borderTopStyle),this.borderRightStyle=nn(e,wCe,r.borderRightStyle),this.borderBottomStyle=nn(e,NCe,r.borderBottomStyle),this.borderLeftStyle=nn(e,CCe,r.borderLeftStyle),this.borderTopWidth=nn(e,_Ce,r.borderTopWidth),this.borderRightWidth=nn(e,ECe,r.borderRightWidth),this.borderBottomWidth=nn(e,SCe,r.borderBottomWidth),this.borderLeftWidth=nn(e,ICe,r.borderLeftWidth),this.boxShadow=nn(e,b_e,r.boxShadow),this.color=nn(e,jCe,r.color),this.direction=nn(e,PCe,r.direction),this.display=nn(e,BCe,r.display),this.float=nn(e,kCe,r.cssFloat),this.fontFamily=nn(e,d_e,r.fontFamily),this.fontSize=nn(e,f_e,r.fontSize),this.fontStyle=nn(e,m_e,r.fontStyle),this.fontVariant=nn(e,A_e,r.fontVariant),this.fontWeight=nn(e,h_e,r.fontWeight),this.letterSpacing=nn(e,FCe,r.letterSpacing),this.lineBreak=nn(e,OCe,r.lineBreak),this.lineHeight=nn(e,DCe,r.lineHeight),this.listStyleImage=nn(e,RCe,r.listStyleImage),this.listStylePosition=nn(e,MCe,r.listStylePosition),this.listStyleType=nn(e,_k,r.listStyleType),this.marginTop=nn(e,LCe,r.marginTop),this.marginRight=nn(e,UCe,r.marginRight),this.marginBottom=nn(e,QCe,r.marginBottom),this.marginLeft=nn(e,VCe,r.marginLeft),this.opacity=nn(e,l_e,r.opacity);var s=nn(e,HCe,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=nn(e,$Ce,r.overflowWrap),this.paddingTop=nn(e,KCe,r.paddingTop),this.paddingRight=nn(e,GCe,r.paddingRight),this.paddingBottom=nn(e,qCe,r.paddingBottom),this.paddingLeft=nn(e,zCe,r.paddingLeft),this.paintOrder=nn(e,w_e,r.paintOrder),this.position=nn(e,XCe,r.position),this.textAlign=nn(e,WCe,r.textAlign),this.textDecorationColor=nn(e,c_e,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=nn(e,u_e,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=nn(e,YCe,r.textShadow),this.textTransform=nn(e,JCe,r.textTransform),this.transform=nn(e,ZCe,r.transform),this.transformOrigin=nn(e,a_e,r.transformOrigin),this.visibility=nn(e,s_e,r.visibility),this.webkitTextStrokeColor=nn(e,N_e,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=nn(e,C_e,r.webkitTextStrokeWidth),this.wordBreak=nn(e,i_e,r.wordBreak),this.zIndex=nn(e,o_e,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return dm(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return Io(this.display,4)||Io(this.display,33554432)||Io(this.display,268435456)||Io(this.display,536870912)||Io(this.display,67108864)||Io(this.display,134217728)},t}(),E_e=function(){function t(e,r){this.content=nn(e,p_e,r.content),this.quotes=nn(e,y_e,r.quotes)}return t}(),rQ=function(){function t(e,r){this.counterIncrement=nn(e,g_e,r.counterIncrement),this.counterReset=nn(e,x_e,r.counterReset)}return t}(),nn=function(t,e,r){var n=new ite,a=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(a);var s=new ote(n.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(t,ls(o)?o.value:e.initialValue);case 0:return e.parse(t,s.parseComponentValue());case 1:return e.parse(t,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return Xj.parse(t,s.parseComponentValue());case"color":return um.parse(t,s.parseComponentValue());case"image":return R6.parse(t,s.parseComponentValue());case"length":var l=s.parseComponentValue();return _m(l)?l:Il;case"length-percentage":var c=s.parseComponentValue();return so(c)?c:Il;case"time":return _te.parse(t,s.parseComponentValue())}break}},S_e="data-html2canvas-debug",I_e=function(t){var e=t.getAttribute(S_e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Ek=function(t,e){var r=I_e(t);return r===1||e===r},mh=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,Ek(r,3))debugger;this.styles=new __e(e,window.getComputedStyle(r,null)),jk(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=zj(this.context,r),Ek(r,4)&&(this.flags|=16)}return t}(),j_e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",nQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Gy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var NC=0;NC<nQ.length;NC++)Gy[nQ.charCodeAt(NC)]=NC;var P_e=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Gy[t.charCodeAt(n)],o=Gy[t.charCodeAt(n+1)],l=Gy[t.charCodeAt(n+2)],c=Gy[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},B_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},T_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Op=5,M6=11,L4=2,k_e=M6-Op,Ete=65536>>Op,F_e=1<<Op,U4=F_e-1,O_e=1024>>Op,D_e=Ete+O_e,R_e=D_e,M_e=32,L_e=R_e+M_e,U_e=65536>>M6,Q_e=1<<k_e,V_e=Q_e-1,aQ=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},H_e=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},$_e=function(t,e){var r=P_e(t),n=Array.isArray(r)?T_e(r):new Uint32Array(r),a=Array.isArray(r)?B_e(r):new Uint16Array(r),s=24,o=aQ(a,s/2,n[4]/2),l=n[5]===2?aQ(a,(s+n[4])/2):H_e(n,Math.ceil((s+n[4])/4));return new K_e(n[0],n[1],n[2],n[3],o,l)},K_e=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Op],r=(r<<L4)+(e&U4),this.data[r];if(e<=65535)return r=this.index[Ete+(e-55296>>Op)],r=(r<<L4)+(e&U4),this.data[r];if(e<this.highStart)return r=L_e-U_e+(e>>M6),r=this.index[r],r+=e>>Op&V_e,r=this.index[r],r=(r<<L4)+(e&U4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),sQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G_e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var CC=0;CC<sQ.length;CC++)G_e[sQ.charCodeAt(CC)]=CC;var q_e=1,Q4=2,V4=3,iQ=4,oQ=5,z_e=7,lQ=8,H4=9,$4=10,cQ=11,uQ=12,dQ=13,fQ=14,K4=15,W_e=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},X_e=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},Y_e=$_e(j_e),md="",G4="",J_e=function(t){return Y_e.get(t)},Z_e=function(t,e,r){var n=r-2,a=e[n],s=e[r-1],o=e[r];if(s===Q4&&o===V4)return md;if(s===Q4||s===V4||s===iQ||o===Q4||o===V4||o===iQ)return G4;if(s===lQ&&[lQ,H4,cQ,uQ].indexOf(o)!==-1||(s===cQ||s===H4)&&(o===H4||o===$4)||(s===uQ||s===$4)&&o===$4||o===dQ||o===oQ||o===z_e||s===q_e)return md;if(s===dQ&&o===fQ){for(;a===oQ;)a=e[--n];if(a===fQ)return md}if(s===K4&&o===K4){for(var l=0;a===K4;)l++,a=e[--n];if(l%2===0)return md}return G4},eEe=function(t){var e=W_e(t),r=e.length,n=0,a=0,s=e.map(J_e);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=md;n<r&&(o=Z_e(e,s,++n))===md;);if(o!==md||n===r){var l=X_e.apply(null,e.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},tEe=function(t){for(var e=eEe(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},rEe=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(t.body.removeChild(n),s===e)return!0}}return!1},nEe=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,a=Wj(n.data).map(function(c){return Ui(c)}),s=0,o={},l=a.every(function(c,u){r.setStart(n,s),r.setEnd(n,s+c.length);var d=r.getBoundingClientRect();s+=c.length;var f=d.x>o.x||d.y>o.y;return o=d,u===0?!0:f});return t.body.removeChild(e),l},aEe=function(){return typeof new Image().crossOrigin<"u"},sEe=function(){return typeof new XMLHttpRequest().responseType=="string"},iEe=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},hQ=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},oEe=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=e.toDataURL();a.src=s;var o=Sk(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),AQ(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var u=t.createElement("div");return u.style.backgroundImage="url("+s+")",u.style.height=r+"px",hQ(c)?AQ(Sk(r,r,0,0,u)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),hQ(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Sk=function(t,e,r,n,a){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(a),o},AQ=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},wl={get SUPPORT_RANGE_BOUNDS(){var t=rEe(document);return Object.defineProperty(wl,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=wl.SUPPORT_RANGE_BOUNDS&&nEe(document);return Object.defineProperty(wl,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=iEe(document);return Object.defineProperty(wl,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?oEe(document):Promise.resolve(!1);return Object.defineProperty(wl,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=aEe();return Object.defineProperty(wl,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=sEe();return Object.defineProperty(wl,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(wl,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(wl,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},wb=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),lEe=function(t,e,r,n){var a=dEe(e,r),s=[],o=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(wl.SUPPORT_RANGE_BOUNDS){var c=mQ(n,o,l.length).getClientRects();if(c.length>1){var u=L6(l),d=0;u.forEach(function(A){s.push(new wb(A,vA.fromDOMRectList(t,mQ(n,d+o,A.length).getClientRects()))),d+=A.length})}else s.push(new wb(l,vA.fromDOMRectList(t,c)))}else{var f=n.splitText(l.length);s.push(new wb(l,cEe(t,n))),n=f}else wl.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),s},cEe=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(n,e);var s=zj(t,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return vA.EMPTY},mQ=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(t,e),a.setEnd(t,e+r),a},L6=function(t){if(wl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return tEe(t)},uEe=function(t,e){if(wl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return hEe(t,e)},dEe=function(t,e){return e.letterSpacing!==0?L6(t):uEe(t,e)},fEe=[32,160,4961,65792,65793,4153,4241],hEe=function(t,e){for(var r=Uwe(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],a,s=function(){if(a.value){var o=a.value.slice(),l=Wj(o),c="";l.forEach(function(u){fEe.indexOf(u)===-1?c+=Ui(u):(c.length&&n.push(c),n.push(Ui(u)),c="")}),c.length&&n.push(c)}};!(a=r.next()).done;)s();return n},AEe=function(){function t(e,r,n){this.text=mEe(r.data,n.textTransform),this.textBounds=lEe(e,this.text,n,r)}return t}(),mEe=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(pEe,gEe);case 2:return t.toUpperCase();default:return t}},pEe=/(^|\s|:|-|\(|\))([a-z])/g,gEe=function(t,e,r){return t.length>0?e+r.toUpperCase():t},Ste=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return e}(mh),Ite=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return e}(mh),jte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=new XMLSerializer,o=zj(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return e}(mh),Pte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(mh),Ik=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return e}(mh),xEe=[{type:15,flags:0,unit:"px",number:3}],vEe=[{type:16,flags:0,number:50}],yEe=function(t){return t.width>t.height?new vA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new vA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},bEe=function(t){var e=t.type===wEe?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},_S="checkbox",ES="radio",wEe="password",pQ=707406591,U6=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=bEe(n),(a.type===_S||a.type===ES)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=yEe(a.bounds)),a.type){case _S:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=xEe;break;case ES:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=vEe;break}return a}return e}(mh),Bte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return e}(mh),Tte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(mh),kte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=Ote(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?yb(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):sA.TRANSPARENT,o=n.contentWindow.document.body?yb(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):sA.TRANSPARENT;a.backgroundColor=dm(s)?dm(o)?a.styles.backgroundColor:o:s}}catch{}return a}return e}(mh),NEe=["OL","UL","MENU"],hE=function(t,e,r,n){for(var a=e.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,Dte(a)&&a.data.trim().length>0)r.textNodes.push(new AEe(t,a,r.styles));else if(zx(a))if(Ute(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return hE(t,l,r,n)});else{var o=Fte(t,a);o.styles.isVisible()&&(CEe(a,o,n)?o.flags|=4:_Ee(o.styles)&&(o.flags|=2),NEe.indexOf(a.tagName)!==-1&&(o.flags|=8),r.elements.push(o),a.slot,a.shadowRoot?hE(t,a.shadowRoot,o,n):!SS(a)&&!Rte(a)&&!IS(a)&&hE(t,a,o,n))}},Fte=function(t,e){return Pk(e)?new Ste(t,e):Mte(e)?new Ite(t,e):Rte(e)?new jte(t,e):EEe(e)?new Pte(t,e):SEe(e)?new Ik(t,e):IEe(e)?new U6(t,e):IS(e)?new Bte(t,e):SS(e)?new Tte(t,e):Lte(e)?new kte(t,e):new mh(t,e)},Ote=function(t,e){var r=Fte(t,e);return r.flags|=4,hE(t,e,r,r),r},CEe=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||Q6(t)&&r.styles.isTransparent()},_Ee=function(t){return t.isPositioned()||t.isFloating()},Dte=function(t){return t.nodeType===Node.TEXT_NODE},zx=function(t){return t.nodeType===Node.ELEMENT_NODE},jk=function(t){return zx(t)&&typeof t.style<"u"&&!AE(t)},AE=function(t){return typeof t.className=="object"},EEe=function(t){return t.tagName==="LI"},SEe=function(t){return t.tagName==="OL"},IEe=function(t){return t.tagName==="INPUT"},jEe=function(t){return t.tagName==="HTML"},Rte=function(t){return t.tagName==="svg"},Q6=function(t){return t.tagName==="BODY"},Mte=function(t){return t.tagName==="CANVAS"},gQ=function(t){return t.tagName==="VIDEO"},Pk=function(t){return t.tagName==="IMG"},Lte=function(t){return t.tagName==="IFRAME"},xQ=function(t){return t.tagName==="STYLE"},PEe=function(t){return t.tagName==="SCRIPT"},SS=function(t){return t.tagName==="TEXTAREA"},IS=function(t){return t.tagName==="SELECT"},Ute=function(t){return t.tagName==="SLOT"},vQ=function(t){return t.tagName.indexOf("-")>0},BEe=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,a=e.counterReset,s=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return s&&a.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),yQ={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},bQ={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},TEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},kEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},ix=function(t,e,r,n,a,s){return t<e||t>r?_2(t,a,s.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+s},Qte=function(t,e,r,n){var a="";do r||t--,a=n(t)+a,t/=e;while(t*e>=e);return a},Oi=function(t,e,r,n,a){var s=r-e+1;return(t<0?"-":"")+(Qte(Math.abs(t),s,n,function(o){return Ui(Math.floor(o%s)+e)})+a)},Xm=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return Qte(Math.abs(t),n,!1,function(a){return e[Math.floor(a%n)]})+r},jx=1,N0=2,C0=4,qy=8,Eh=function(t,e,r,n,a,s){if(t<-9999||t>9999)return _2(t,4,a.length>0);var o=Math.abs(t),l=a;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var u=o%10;u===0&&Io(s,jx)&&l!==""?l=e[u]+l:u>1||u===1&&c===0||u===1&&c===1&&Io(s,N0)||u===1&&c===1&&Io(s,C0)&&t>100||u===1&&c>1&&Io(s,qy)?l=e[u]+(c>0?r[c-1]:"")+l:u===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},wQ="",NQ="",CQ="",q4="",_2=function(t,e,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Oi(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Xm(t,"",a);case 6:return ix(t,1,3999,yQ,3,n).toLowerCase();case 7:return ix(t,1,3999,yQ,3,n);case 8:return Oi(t,945,969,!1,n);case 9:return Oi(t,97,122,!1,n);case 10:return Oi(t,65,90,!1,n);case 11:return Oi(t,1632,1641,!0,n);case 12:case 49:return ix(t,1,9999,bQ,3,n);case 35:return ix(t,1,9999,bQ,3,n).toLowerCase();case 13:return Oi(t,2534,2543,!0,n);case 14:case 30:return Oi(t,6112,6121,!0,n);case 15:return Xm(t,"",a);case 16:return Xm(t,"",a);case 17:case 48:return Eh(t,"",wQ,"",a,N0|C0|qy);case 47:return Eh(t,"",NQ,"",a,jx|N0|C0|qy);case 42:return Eh(t,"",wQ,"",a,N0|C0|qy);case 41:return Eh(t,"",NQ,"",a,jx|N0|C0|qy);case 26:return Eh(t,"","",CQ,a,0);case 25:return Eh(t,"","",CQ,a,jx|N0|C0);case 31:return Eh(t,"","",q4,s,jx|N0|C0);case 33:return Eh(t,"","",q4,s,0);case 32:return Eh(t,"","",q4,s,jx|N0|C0);case 18:return Oi(t,2406,2415,!0,n);case 20:return ix(t,1,19999,kEe,3,n);case 21:return Oi(t,2790,2799,!0,n);case 22:return Oi(t,2662,2671,!0,n);case 22:return ix(t,1,10999,TEe,3,n);case 23:return Xm(t,"");case 24:return Xm(t,"");case 27:return Oi(t,3302,3311,!0,n);case 28:return Xm(t,"",a);case 29:return Xm(t,"",a);case 34:return Oi(t,3792,3801,!0,n);case 37:return Oi(t,6160,6169,!0,n);case 38:return Oi(t,4160,4169,!0,n);case 39:return Oi(t,2918,2927,!0,n);case 40:return Oi(t,1776,1785,!0,n);case 43:return Oi(t,3046,3055,!0,n);case 44:return Oi(t,3174,3183,!0,n);case 45:return Oi(t,3664,3673,!0,n);case 46:return Oi(t,3872,3881,!0,n);case 3:default:return Oi(t,48,57,!0,n)}},Vte="data-html2canvas-ignore",_Q=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new BEe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,a=FEe(e,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=a.contentWindow,c=l.document,u=REe(a).then(function(){return vc(n,void 0,void 0,function(){var d,f;return Xl(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(QEe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,DEe(c)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,f)}).then(function(){return a})]:[2,a]}})})});return c.open(),c.write(LEe(document.doctype)+"<html></html>"),UEe(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),u},t.prototype.createElementClone=function(e){if(Ek(e,2))debugger;if(Mte(e))return this.createCanvasClone(e);if(gQ(e))return this.createVideoClone(e);if(xQ(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return Pk(r)&&(Pk(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),vQ(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return z4(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),a=e.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var a=e.cloneNode(!1);try{a.width=e.width,a.height=e.height;var s=e.getContext("2d"),o=a.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return a},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var a=e.ownerDocument.createElement("canvas");return a.width=e.offsetWidth,a.height=e.offsetHeight,a},t.prototype.appendChildNode=function(e,r,n){(!zx(r)||!PEe(r)&&!r.hasAttribute(Vte)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!zx(r)||!xQ(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var a=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(zx(s)&&Ute(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},t.prototype.cloneNode=function(e,r){if(Dte(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&zx(e)&&(jk(e)||AE(e))){var a=this.createElementClone(e);a.style.transitionProperty="none";var s=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&jk(a)&&(this.clonedReferenceElement=a),Q6(a)&&$Ee(a);var c=this.counters.parse(new rQ(this.context,s)),u=this.resolvePseudoContent(e,a,o,Nb.BEFORE);vQ(e)&&(r=!0),gQ(e)||this.cloneChildNodes(e,a,r),u&&a.insertBefore(u,a.firstChild);var d=this.resolvePseudoContent(e,a,l,Nb.AFTER);return d&&a.appendChild(d),this.counters.pop(c),(s&&(this.options.copyStyles||AE(e))&&!Lte(e)||r)&&z4(s,a),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([a,e.scrollLeft,e.scrollTop]),(SS(e)||IS(e))&&(SS(a)||IS(a))&&(a.value=e.value),a}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,a){var s=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new rQ(this.context,n));var c=new E_e(this.context,n),u=l.createElement("html2canvaspseudoelement");z4(n,u),c.content.forEach(function(f){if(f.type===0)u.appendChild(l.createTextNode(f.value));else if(f.type===22){var A=l.createElement("img");A.src=f.value,A.style.opacity="1",u.appendChild(A)}else if(f.type===18){if(f.name==="attr"){var h=f.values.filter(ls);h.length&&u.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(f.name==="counter"){var m=f.values.filter(Mv),p=m[0],x=m[1];if(p&&ls(p)){var v=s.counters.getCounterValue(p.value),y=x&&ls(x)?_k.parse(s.context,x.value):3;u.appendChild(l.createTextNode(_2(v,y,!1)))}}else if(f.name==="counters"){var b=f.values.filter(Mv),p=b[0],w=b[1],x=b[2];if(p&&ls(p)){var j=s.counters.getCounterValues(p.value),I=x&&ls(x)?_k.parse(s.context,x.value):3,_=w&&w.type===0?w.value:"",S=j.map(function(k){return _2(k,I,!1)}).join(_);u.appendChild(l.createTextNode(S))}}}else if(f.type===20)switch(f.value){case"open-quote":u.appendChild(l.createTextNode(tQ(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":u.appendChild(l.createTextNode(tQ(c.quotes,--s.quoteDepth,!1)));break;default:u.appendChild(l.createTextNode(f.value))}}),u.className=Bk+" "+Tk;var d=a===Nb.BEFORE?" "+Bk:" "+Tk;return AE(r)?r.className.baseValue+=d:r.className+=d,u}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),Nb;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Nb||(Nb={}));var FEe=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(Vte,"true"),t.body.appendChild(r),r},OEe=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},DEe=function(t){return Promise.all([].slice.call(t.images,0).map(OEe))},REe=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),e(t))},50)}})},MEe=["all","d","content"],z4=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);MEe.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},LEe=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},UEe=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},QEe=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},VEe=":before",HEe=":after",Bk="___html2canvas___pseudoelement_before",Tk="___html2canvas___pseudoelement_after",EQ=`{
    content: "" !important;
    display: none !important;
}`,$Ee=function(t){KEe(t,"."+Bk+VEe+EQ+`
         .`+Tk+HEe+EQ)},KEe=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},Hte=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),GEe=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(X4(e)||XEe(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return vc(this,void 0,void 0,function(){var r,n,a,s,o=this;return Xl(this,function(l){switch(l.label){case 0:return r=Hte.isSameOrigin(e),n=!W4(e)&&this._options.useCORS===!0&&wl.SUPPORT_CORS_IMAGES&&!r,a=!W4(e)&&!r&&!X4(e)&&typeof this._options.proxy=="string"&&wl.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!W4(e)&&!X4(e)&&!a&&!n?[2]:(s=e,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,u){var d=new Image;d.onload=function(){return c(d)},d.onerror=u,(YEe(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return u("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=e.substring(0,256);return new Promise(function(s,o){var l=wl.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")s(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return s(f.result)},!1),f.addEventListener("error",function(A){return o(A)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+a+" with status code "+c.status)},c.onerror=o;var u=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+u+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+a)}}c.send()})},t}(),qEe=/^data:image\/svg\+xml/i,zEe=/^data:image\/.*;base64,/i,WEe=/^data:image\/.*/i,XEe=function(t){return wl.SUPPORT_SVG_DRAWING||!JEe(t)},W4=function(t){return WEe.test(t)},YEe=function(t){return zEe.test(t)},X4=function(t){return t.substr(0,4)==="blob"},JEe=function(t){return t.substr(-3).toLowerCase()==="svg"||qEe.test(t)},tn=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),ox=function(t,e,r){return new tn(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},_C=function(){function t(e,r,n,a){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=a}return t.prototype.subdivide=function(e,r){var n=ox(this.start,this.startControl,e),a=ox(this.startControl,this.endControl,e),s=ox(this.endControl,this.end,e),o=ox(n,a,e),l=ox(a,s,e),c=ox(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,s,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),yd=function(t){return t.type===1},ZEe=function(){function t(e){var r=e.styles,n=e.bounds,a=Ky(r.borderTopLeftRadius,n.width,n.height),s=a[0],o=a[1],l=Ky(r.borderTopRightRadius,n.width,n.height),c=l[0],u=l[1],d=Ky(r.borderBottomRightRadius,n.width,n.height),f=d[0],A=d[1],h=Ky(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((s+c)/n.width),x.push((m+f)/n.width),x.push((o+p)/n.height),x.push((u+A)/n.height);var v=Math.max.apply(Math,x);v>1&&(s/=v,o/=v,c/=v,u/=v,f/=v,A/=v,m/=v,p/=v);var y=n.width-c,b=n.height-A,w=n.width-f,j=n.height-p,I=r.borderTopWidth,_=r.borderRightWidth,S=r.borderBottomWidth,E=r.borderLeftWidth,B=ys(r.paddingTop,e.bounds.width),k=ys(r.paddingRight,e.bounds.width),P=ys(r.paddingBottom,e.bounds.width),O=ys(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?Ds(n.left+E/3,n.top+I/3,s-E/3,o-I/3,Ua.TOP_LEFT):new tn(n.left+E/3,n.top+I/3),this.topRightBorderDoubleOuterBox=s>0||o>0?Ds(n.left+y,n.top+I/3,c-_/3,u-I/3,Ua.TOP_RIGHT):new tn(n.left+n.width-_/3,n.top+I/3),this.bottomRightBorderDoubleOuterBox=f>0||A>0?Ds(n.left+w,n.top+b,f-_/3,A-S/3,Ua.BOTTOM_RIGHT):new tn(n.left+n.width-_/3,n.top+n.height-S/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?Ds(n.left+E/3,n.top+j,m-E/3,p-S/3,Ua.BOTTOM_LEFT):new tn(n.left+E/3,n.top+n.height-S/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?Ds(n.left+E*2/3,n.top+I*2/3,s-E*2/3,o-I*2/3,Ua.TOP_LEFT):new tn(n.left+E*2/3,n.top+I*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?Ds(n.left+y,n.top+I*2/3,c-_*2/3,u-I*2/3,Ua.TOP_RIGHT):new tn(n.left+n.width-_*2/3,n.top+I*2/3),this.bottomRightBorderDoubleInnerBox=f>0||A>0?Ds(n.left+w,n.top+b,f-_*2/3,A-S*2/3,Ua.BOTTOM_RIGHT):new tn(n.left+n.width-_*2/3,n.top+n.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?Ds(n.left+E*2/3,n.top+j,m-E*2/3,p-S*2/3,Ua.BOTTOM_LEFT):new tn(n.left+E*2/3,n.top+n.height-S*2/3),this.topLeftBorderStroke=s>0||o>0?Ds(n.left+E/2,n.top+I/2,s-E/2,o-I/2,Ua.TOP_LEFT):new tn(n.left+E/2,n.top+I/2),this.topRightBorderStroke=s>0||o>0?Ds(n.left+y,n.top+I/2,c-_/2,u-I/2,Ua.TOP_RIGHT):new tn(n.left+n.width-_/2,n.top+I/2),this.bottomRightBorderStroke=f>0||A>0?Ds(n.left+w,n.top+b,f-_/2,A-S/2,Ua.BOTTOM_RIGHT):new tn(n.left+n.width-_/2,n.top+n.height-S/2),this.bottomLeftBorderStroke=m>0||p>0?Ds(n.left+E/2,n.top+j,m-E/2,p-S/2,Ua.BOTTOM_LEFT):new tn(n.left+E/2,n.top+n.height-S/2),this.topLeftBorderBox=s>0||o>0?Ds(n.left,n.top,s,o,Ua.TOP_LEFT):new tn(n.left,n.top),this.topRightBorderBox=c>0||u>0?Ds(n.left+y,n.top,c,u,Ua.TOP_RIGHT):new tn(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||A>0?Ds(n.left+w,n.top+b,f,A,Ua.BOTTOM_RIGHT):new tn(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?Ds(n.left,n.top+j,m,p,Ua.BOTTOM_LEFT):new tn(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||o>0?Ds(n.left+E,n.top+I,Math.max(0,s-E),Math.max(0,o-I),Ua.TOP_LEFT):new tn(n.left+E,n.top+I),this.topRightPaddingBox=c>0||u>0?Ds(n.left+Math.min(y,n.width-_),n.top+I,y>n.width+_?0:Math.max(0,c-_),Math.max(0,u-I),Ua.TOP_RIGHT):new tn(n.left+n.width-_,n.top+I),this.bottomRightPaddingBox=f>0||A>0?Ds(n.left+Math.min(w,n.width-E),n.top+Math.min(b,n.height-S),Math.max(0,f-_),Math.max(0,A-S),Ua.BOTTOM_RIGHT):new tn(n.left+n.width-_,n.top+n.height-S),this.bottomLeftPaddingBox=m>0||p>0?Ds(n.left+E,n.top+Math.min(j,n.height-S),Math.max(0,m-E),Math.max(0,p-S),Ua.BOTTOM_LEFT):new tn(n.left+E,n.top+n.height-S),this.topLeftContentBox=s>0||o>0?Ds(n.left+E+O,n.top+I+B,Math.max(0,s-(E+O)),Math.max(0,o-(I+B)),Ua.TOP_LEFT):new tn(n.left+E+O,n.top+I+B),this.topRightContentBox=c>0||u>0?Ds(n.left+Math.min(y,n.width+E+O),n.top+I+B,y>n.width+E+O?0:c-E+O,u-(I+B),Ua.TOP_RIGHT):new tn(n.left+n.width-(_+k),n.top+I+B),this.bottomRightContentBox=f>0||A>0?Ds(n.left+Math.min(w,n.width-(E+O)),n.top+Math.min(b,n.height+I+B),Math.max(0,f-(_+k)),A-(S+P),Ua.BOTTOM_RIGHT):new tn(n.left+n.width-(_+k),n.top+n.height-(S+P)),this.bottomLeftContentBox=m>0||p>0?Ds(n.left+E+O,n.top+j,Math.max(0,m-(E+O)),p-(S+P),Ua.BOTTOM_LEFT):new tn(n.left+E+O,n.top+n.height-(S+P))}return t}(),Ua;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ua||(Ua={}));var Ds=function(t,e,r,n,a){var s=4*((Math.sqrt(2)-1)/3),o=r*s,l=n*s,c=t+r,u=e+n;switch(a){case Ua.TOP_LEFT:return new _C(new tn(t,u),new tn(t,u-l),new tn(c-o,e),new tn(c,e));case Ua.TOP_RIGHT:return new _C(new tn(t,e),new tn(t+o,e),new tn(c,u-l),new tn(c,u));case Ua.BOTTOM_RIGHT:return new _C(new tn(c,e),new tn(c,e+l),new tn(t+o,u),new tn(t,u));case Ua.BOTTOM_LEFT:default:return new _C(new tn(c,u),new tn(c-o,u),new tn(t,e+l),new tn(t,e))}},jS=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},eSe=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},PS=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},tSe=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),EC=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),rSe=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),nSe=function(t){return t.type===0},$te=function(t){return t.type===1},aSe=function(t){return t.type===2},SQ=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},sSe=function(t,e,r,n,a){return t.map(function(s,o){switch(o){case 0:return s.add(e,r);case 1:return s.add(e+n,r);case 2:return s.add(e+n,r+a);case 3:return s.add(e,r+a)}return s})},Kte=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),Gte=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new ZEe(this.container),this.container.styles.opacity<1&&this.effects.push(new rSe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new tSe(n,a,s))}if(this.container.styles.overflowX!==0){var o=jS(this.curves),l=PS(this.curves);SQ(o,l)?this.effects.push(new EC(o,6)):(this.effects.push(new EC(o,2)),this.effects.push(new EC(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(c){return!$te(c)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=jS(n.curves),l=PS(n.curves);SQ(o,l)||a.unshift(new EC(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(c){return Io(c.target,e)})},t}(),kk=function(t,e,r,n){t.container.elements.forEach(function(a){var s=Io(a.flags,4),o=Io(a.flags,2),l=new Gte(a,t);Io(a.styles.display,2048)&&n.push(l);var c=Io(a.flags,8)?[]:n;if(s||o){var u=s||a.styles.isPositioned()?r:e,d=new Kte(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var f=a.styles.zIndex.order;if(f<0){var A=0;u.negativeZIndex.some(function(m,p){return f>m.element.container.styles.zIndex.order?(A=p,!1):A>0}),u.negativeZIndex.splice(A,0,d)}else if(f>0){var h=0;u.positiveZIndex.some(function(m,p){return f>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),u.positiveZIndex.splice(h,0,d)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?u.nonPositionedFloats.push(d):u.nonPositionedInlineLevel.push(d);kk(l,d,s?d:r,c)}else a.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),kk(l,e,r,c);Io(a.flags,8)&&qte(a,c)})},qte=function(t,e){for(var r=t instanceof Ik?t.start:1,n=t instanceof Ik?t.reversed:!1,a=0;a<e.length;a++){var s=e[a];s.container instanceof Pte&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=_2(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},iSe=function(t){var e=new Gte(t,null),r=new Kte(e),n=[];return kk(e,r,r,n),qte(e.container,n),r},IQ=function(t,e){switch(e){case 0:return Cd(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Cd(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Cd(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Cd(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},oSe=function(t,e){switch(e){case 0:return Cd(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Cd(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Cd(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Cd(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},lSe=function(t,e){switch(e){case 0:return Cd(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Cd(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Cd(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Cd(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},cSe=function(t,e){switch(e){case 0:return SC(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return SC(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return SC(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return SC(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},SC=function(t,e){var r=[];return yd(t)?r.push(t.subdivide(.5,!1)):r.push(t),yd(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},Cd=function(t,e,r,n){var a=[];return yd(t)?a.push(t.subdivide(.5,!1)):a.push(t),yd(r)?a.push(r.subdivide(.5,!0)):a.push(r),yd(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),yd(e)?a.push(e.subdivide(.5,!1).reverse()):a.push(e),a},zte=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},BS=function(t){var e=t.styles,r=t.bounds,n=ys(e.paddingLeft,r.width),a=ys(e.paddingRight,r.width),s=ys(e.paddingTop,r.width),o=ys(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+a),-(e.borderTopWidth+e.borderBottomWidth+s+o))},uSe=function(t,e){return t===0?e.bounds:t===2?BS(e):zte(e)},dSe=function(t,e){return t===0?e.bounds:t===2?BS(e):zte(e)},Y4=function(t,e,r){var n=uSe(Px(t.styles.backgroundOrigin,e),t),a=dSe(Px(t.styles.backgroundClip,e),t),s=fSe(Px(t.styles.backgroundSize,e),r,n),o=s[0],l=s[1],c=Ky(Px(t.styles.backgroundPosition,e),n.width-o,n.height-l),u=hSe(Px(t.styles.backgroundRepeat,e),c,s,n,a),d=Math.round(n.left+c[0]),f=Math.round(n.top+c[1]);return[u,d,f,o,l]},lx=function(t){return ls(t)&&t.value===hv.AUTO},IC=function(t){return typeof t=="number"},fSe=function(t,e,r){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(so(o)&&l&&so(l))return[ys(o,r.width),ys(l,r.height)];var c=IC(s);if(ls(o)&&(o.value===hv.CONTAIN||o.value===hv.COVER)){if(IC(s)){var u=r.width/r.height;return u<s!=(o.value===hv.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=IC(n),f=IC(a),A=d||f;if(lx(o)&&(!l||lx(l))){if(d&&f)return[n,a];if(!c&&!A)return[r.width,r.height];if(A&&c){var h=d?n:a*s,m=f?a:n/s;return[h,m]}var p=d?n:r.width,x=f?a:r.height;return[p,x]}if(c){var v=0,y=0;return so(o)?v=ys(o,r.width):so(l)&&(y=ys(l,r.height)),lx(o)?v=y*s:(!l||lx(l))&&(y=v/s),[v,y]}var b=null,w=null;if(so(o)?b=ys(o,r.width):l&&so(l)&&(w=ys(l,r.height)),b!==null&&(!l||lx(l))&&(w=d&&f?b/n*a:r.height),w!==null&&lx(o)&&(b=d&&f?w/a*n:r.width),b!==null&&w!==null)return[b,w];throw new Error("Unable to calculate background-size for element")},Px=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},hSe=function(t,e,r,n,a){var s=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new tn(Math.round(n.left),Math.round(n.top+o)),new tn(Math.round(n.left+n.width),Math.round(n.top+o)),new tn(Math.round(n.left+n.width),Math.round(c+n.top+o)),new tn(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new tn(Math.round(n.left+s),Math.round(n.top)),new tn(Math.round(n.left+s+l),Math.round(n.top)),new tn(Math.round(n.left+s+l),Math.round(n.height+n.top)),new tn(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new tn(Math.round(n.left+s),Math.round(n.top+o)),new tn(Math.round(n.left+s+l),Math.round(n.top+o)),new tn(Math.round(n.left+s+l),Math.round(n.top+o+c)),new tn(Math.round(n.left+s),Math.round(n.top+o+c))];default:return[new tn(Math.round(a.left),Math.round(a.top)),new tn(Math.round(a.left+a.width),Math.round(a.top)),new tn(Math.round(a.left+a.width),Math.round(a.height+a.top)),new tn(Math.round(a.left),Math.round(a.height+a.top))]}},ASe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",jQ="Hidden Text",mSe=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),a.src=ASe,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(jQ)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(jQ)),n.style.lineHeight="normal",a.style.verticalAlign="super";var c=a.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),Wte=function(){function t(e,r){this.context=e,this.options=r}return t}(),pSe=1e4,gSe=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new mSe(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},e.prototype.applyEffect=function(r){this.ctx.save(),aSe(r)&&(this.ctx.globalAlpha=r.opacity),nSe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),$te(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return vc(this,void 0,void 0,function(){var n;return Xl(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return vc(this,void 0,void 0,function(){return Xl(this,function(n){switch(n.label){case 0:if(Io(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var o=L6(r.text);o.reduce(function(l,c){return s.ctx.fillText(c,l,r.bounds.top+a),l+s.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),a=wSe(r.fontFamily).join(", "),s=Ow(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},e.prototype.renderTextNode=function(r,n){return vc(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A=this;return Xl(this,function(h){return a=this.createFontStyle(n),s=a[0],o=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),u=c.baseline,d=c.middle,f=n.paintOrder,r.textBounds.forEach(function(m){f.forEach(function(p){switch(p){case 0:A.ctx.fillStyle=Ho(n.color),A.renderTextWithLetterSpacing(m,n.letterSpacing,u);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(v){A.ctx.shadowColor=Ho(v.color),A.ctx.shadowOffsetX=v.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=v.offsetY.number*A.options.scale,A.ctx.shadowBlur=v.blur.number,A.renderTextWithLetterSpacing(m,n.letterSpacing,u)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),n.textDecorationLine.length&&(A.ctx.fillStyle=Ho(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(v){switch(v){case 1:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+u),m.bounds.width,1);break;case 2:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:A.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+d),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(A.ctx.strokeStyle=Ho(n.webkitTextStrokeColor),A.ctx.lineWidth=n.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+u)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=BS(r),o=PS(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return vc(this,void 0,void 0,function(){var n,a,s,o,l,c,y,y,u,d,f,A,w,h,m,j,p,x,v,y,b,w,j;return Xl(this,function(I){switch(I.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,o=0,l=n.textNodes,I.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:I.sent(),I.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof Ste))return[3,8];I.label=5;case 5:return I.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,8];case 7:return I.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof Ite&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof jte))return[3,12];I.label=9;case 9:return I.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,12];case 11:return I.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof kte&&n.tree?(u=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,u.render(n.tree)]):[3,14];case 13:d=I.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),I.label=14;case 14:if(n instanceof U6&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===_S?n.checked&&(this.ctx.save(),this.path([new tn(n.bounds.left+f*.39363,n.bounds.top+f*.79),new tn(n.bounds.left+f*.16,n.bounds.top+f*.5549),new tn(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new tn(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new tn(n.bounds.left+f*.72983,n.bounds.top+f*.23),new tn(n.bounds.left+f*.84,n.bounds.top+f*.34085),new tn(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=Ho(pQ),this.ctx.fill(),this.ctx.restore()):n.type===ES&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ho(pQ),this.ctx.fill(),this.ctx.restore())),xSe(n)&&n.value.length){switch(A=this.createFontStyle(s),w=A[0],h=A[1],m=this.fontMetrics.getMetrics(w,h).baseline,this.ctx.font=w,this.ctx.fillStyle=Ho(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=ySe(n.styles.textAlign),j=BS(n),p=0,n.styles.textAlign){case 1:p+=j.width/2;break;case 2:p+=j.width;break}x=j.add(p,0,0,-j.height/2+1),this.ctx.save(),this.path([new tn(j.left,j.top),new tn(j.left+j.width,j.top),new tn(j.left+j.width,j.top+j.height),new tn(j.left,j.top+j.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new wb(n.value,x),s.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Io(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(v=n.styles.listStyleImage,v.type!==0)return[3,18];y=void 0,b=v.url,I.label=15;case 15:return I.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=I.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return I.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(w=this.createFontStyle(s)[0],this.ctx.font=w,this.ctx.fillStyle=Ho(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",j=new vA(n.bounds.left,n.bounds.top+ys(n.styles.paddingTop,n.bounds.width),n.bounds.width,Z9(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new wb(r.listValue,j),s.letterSpacing,Z9(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),I.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return vc(this,void 0,void 0,function(){var n,a,v,s,o,v,l,c,v,u,d,v,f,A,v,h,m,v,p,x,v;return Xl(this,function(y){switch(y.label){case 0:if(Io(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,a=r.negativeZIndex,y.label=2;case 2:return n<a.length?(v=a[n],[4,this.renderStack(v)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),s=0,o=r.nonInlineLevel,y.label=7;case 7:return s<o.length?(v=o[s],[4,this.renderNode(v)]):[3,10];case 8:y.sent(),y.label=9;case 9:return s++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(v=c[l],[4,this.renderStack(v)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:u=0,d=r.nonPositionedInlineLevel,y.label=15;case 15:return u<d.length?(v=d[u],[4,this.renderStack(v)]):[3,18];case 16:y.sent(),y.label=17;case 17:return u++,[3,15];case 18:f=0,A=r.inlineLevel,y.label=19;case 19:return f<A.length?(v=A[f],[4,this.renderNode(v)]):[3,22];case 20:y.sent(),y.label=21;case 21:return f++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(v=m[h],[4,this.renderStack(v)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,y.label=27;case 27:return p<x.length?(v=x[p],[4,this.renderStack(v)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var o=yd(a)?a.start:a;s===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),yd(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},e.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},e.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},e.prototype.renderBackgroundImage=function(r){return vc(this,void 0,void 0,function(){var n,a,s,o,l,c;return Xl(this,function(u){switch(u.label){case 0:n=r.styles.backgroundImage.length-1,a=function(d){var f,A,h,B,ce,ue,O,z,S,m,B,ce,ue,O,z,p,x,v,y,b,w,j,I,_,S,E,B,k,P,O,z,oe,ce,ue,ge,ne,Oe,Ue,F,H,K,U;return Xl(this,function(W){switch(W.label){case 0:if(d.type!==0)return[3,5];f=void 0,A=d.url,W.label=1;case 1:return W.trys.push([1,3,,4]),[4,s.context.cache.match(A)];case 2:return f=W.sent(),[3,4];case 3:return W.sent(),s.context.logger.error("Error loading background-image "+A),[3,4];case 4:return f&&(h=Y4(r,n,[f.width,f.height,f.width/f.height]),B=h[0],ce=h[1],ue=h[2],O=h[3],z=h[4],S=s.ctx.createPattern(s.resizeImage(f,O,z),"repeat"),s.renderRepeat(B,S,ce,ue)),[3,6];case 5:nCe(d)?(m=Y4(r,n,[null,null,null]),B=m[0],ce=m[1],ue=m[2],O=m[3],z=m[4],p=JNe(d.angle,O,z),x=p[0],v=p[1],y=p[2],b=p[3],w=p[4],j=document.createElement("canvas"),j.width=O,j.height=z,I=j.getContext("2d"),_=I.createLinearGradient(v,b,y,w),Y9(d.stops,x).forEach(function(X){return _.addColorStop(X.stop,Ho(X.color))}),I.fillStyle=_,I.fillRect(0,0,O,z),O>0&&z>0&&(S=s.ctx.createPattern(j,"repeat"),s.renderRepeat(B,S,ce,ue))):aCe(d)&&(E=Y4(r,n,[null,null,null]),B=E[0],k=E[1],P=E[2],O=E[3],z=E[4],oe=d.position.length===0?[D6]:d.position,ce=ys(oe[0],O),ue=ys(oe[oe.length-1],z),ge=ZNe(d,ce,ue,O,z),ne=ge[0],Oe=ge[1],ne>0&&Oe>0&&(Ue=s.ctx.createRadialGradient(k+ce,P+ue,0,k+ce,P+ue,ne),Y9(d.stops,ne*2).forEach(function(X){return Ue.addColorStop(X.stop,Ho(X.color))}),s.path(B),s.ctx.fillStyle=Ue,ne!==Oe?(F=r.bounds.left+.5*r.bounds.width,H=r.bounds.top+.5*r.bounds.height,K=Oe/ne,U=1/K,s.ctx.save(),s.ctx.translate(F,H),s.ctx.transform(1,0,0,K,0,0),s.ctx.translate(-F,-H),s.ctx.fillRect(k,U*(P-H)+H,O,z*U),s.ctx.restore()):s.ctx.fill())),W.label=6;case 6:return n--,[2]}})},s=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),u.label=1;case 1:return o<l.length?(c=l[o],[5,a(c)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,a){return vc(this,void 0,void 0,function(){return Xl(this,function(s){return this.path(IQ(a,n)),this.ctx.fillStyle=Ho(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,a,s){return vc(this,void 0,void 0,function(){var o,l;return Xl(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=oSe(s,a),this.path(o),this.ctx.fillStyle=Ho(r),this.ctx.fill(),l=lSe(s,a),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return vc(this,void 0,void 0,function(){var n,a,s,o,l,c,u,d,f=this;return Xl(this,function(A){switch(A.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!dm(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=vSe(Px(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),dm(n.backgroundColor)||(this.ctx.fillStyle=Ho(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){f.ctx.save();var m=jS(r.curves),p=h.inset?0:pSe,x=sSe(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(f.path(m),f.ctx.clip(),f.mask(x)):(f.mask(m),f.ctx.clip(),f.path(x)),f.ctx.shadowOffsetX=h.offsetX.number+p,f.ctx.shadowOffsetY=h.offsetY.number,f.ctx.shadowColor=Ho(h.color),f.ctx.shadowBlur=h.blur.number,f.ctx.fillStyle=h.inset?Ho(h.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),A.label=2;case 2:l=0,c=0,u=s,A.label=3;case 3:return c<u.length?(d=u[c],d.style!==0&&!dm(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return A.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:A.sent(),A.label=11;case 11:l++,A.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,a,s,o){return vc(this,void 0,void 0,function(){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,j,I;return Xl(this,function(_){return this.ctx.save(),l=cSe(s,a),c=IQ(s,a),o===2&&(this.path(c),this.ctx.clip()),yd(c[0])?(u=c[0].start.x,d=c[0].start.y):(u=c[0].x,d=c[0].y),yd(c[1])?(f=c[1].end.x,A=c[1].end.y):(f=c[1].x,A=c[1].y),a===0||a===2?h=Math.abs(u-f):h=Math.abs(d-A),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(v=h/(2*m+p),m*=v,p*=v):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),w=(h-(y+1)*m)/y,p=w<=0||Math.abs(p-b)<Math.abs(p-w)?b:w),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Ho(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(yd(c[0])&&(j=c[3],I=c[0],this.ctx.beginPath(),this.formatPath([new tn(j.end.x,j.end.y),new tn(I.start.x,I.start.y)]),this.ctx.stroke()),yd(c[1])&&(j=c[1],I=c[2],this.ctx.beginPath(),this.formatPath([new tn(j.end.x,j.end.y),new tn(I.start.x,I.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return vc(this,void 0,void 0,function(){var n;return Xl(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ho(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=iSe(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(Wte),xSe=function(t){return t instanceof Tte||t instanceof Bte?!0:t instanceof U6&&t.type!==ES&&t.type!==_S},vSe=function(t,e){switch(t){case 0:return jS(e);case 2:return eSe(e);case 1:default:return PS(e)}},ySe=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},bSe=["-apple-system","system-ui"],wSe=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return bSe.indexOf(e)===-1}):t},NSe=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return e.prototype.render=function(r){return vc(this,void 0,void 0,function(){var n,a;return Xl(this,function(s){switch(s.label){case 0:return n=Sk(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,CSe(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ho(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(Wte),CSe=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},_Se=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,iC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,iC([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,iC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,iC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),ESe=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new _Se({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new GEe(this,e)}return t.instanceCount=1,t}(),Fg=function(t,e){return e===void 0&&(e={}),SSe(t,e)};typeof window<"u"&&Hte.setContext(window);var SSe=function(t,e){return vc(void 0,void 0,void 0,function(){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,_,I,_,S,E,B,k,P,O,z,oe,ce,ue,ge,ne,Oe,Ue,F,H,K;return Xl(this,function(U){switch(U.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(S=e.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(E=e.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:e.proxy,useCORS:(B=e.useCORS)!==null&&B!==void 0?B:!1},s=fk({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},a),o={windowWidth:(P=e.windowWidth)!==null&&P!==void 0?P:n.innerWidth,windowHeight:(O=e.windowHeight)!==null&&O!==void 0?O:n.innerHeight,scrollX:(z=e.scrollX)!==null&&z!==void 0?z:n.pageXOffset,scrollY:(oe=e.scrollY)!==null&&oe!==void 0?oe:n.pageYOffset},l=new vA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new ESe(s,l),u=(ce=e.foreignObjectRendering)!==null&&ce!==void 0?ce:!1,d={allowTaint:(ue=e.allowTaint)!==null&&ue!==void 0?ue:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:u,copyStyles:u},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new _Q(c,t,d),A=f.clonedReferenceElement,A?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=U.sent(),m=Q6(A)||jEe(A)?swe(A.ownerDocument):zj(c,A),p=m.width,x=m.height,v=m.left,y=m.top,b=ISe(c,A,e.backgroundColor),w={canvas:e.canvas,backgroundColor:b,scale:(ne=(ge=e.scale)!==null&&ge!==void 0?ge:n.devicePixelRatio)!==null&&ne!==void 0?ne:1,x:((Oe=e.x)!==null&&Oe!==void 0?Oe:0)+v,y:((Ue=e.y)!==null&&Ue!==void 0?Ue:0)+y,width:(F=e.width)!==null&&F!==void 0?F:Math.ceil(p),height:(H=e.height)!==null&&H!==void 0?H:Math.ceil(x)},u?(c.logger.debug("Document cloned, using foreign object rendering"),_=new NSe(c,w),[4,_.render(A)]):[3,3];case 2:return j=U.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+v+","+y+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),I=Ote(c,A),b===I.styles.backgroundColor&&(I.styles.backgroundColor=sA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+w.x+","+w.y+" with size "+w.width+"x"+w.height),_=new gSe(c,w),[4,_.render(I)];case 4:j=U.sent(),U.label=5;case 5:return(!((K=e.removeContainer)!==null&&K!==void 0)||K)&&(_Q.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,j]}})})},ISe=function(t,e,r){var n=e.ownerDocument,a=n.documentElement?yb(t,getComputedStyle(n.documentElement).backgroundColor):sA.TRANSPARENT,s=n.body?yb(t,getComputedStyle(n.body).backgroundColor):sA.TRANSPARENT,o=typeof r=="string"?yb(t,r):r===null?sA.TRANSPARENT:4294967295;return e===n.documentElement?dm(a)?dm(s)?o:s:a:o};const V6=Object.freeze(Object.defineProperty({__proto__:null,default:Fg},Symbol.toStringTag,{value:"Module"})),jSe="modulepreload",PSe=function(t){return"/"+t},PQ={},iA=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=PSe(c),c in PQ)return;PQ[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":jSe,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((A,h)=>{f.addEventListener("load",A),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function es(t){"@babel/helpers - typeof";return es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},es(t)}var Nf=Uint8Array,Ou=Uint16Array,H6=Int32Array,$6=new Nf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),K6=new Nf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),BQ=new Nf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Xte=function(t,e){for(var r=new Ou(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new H6(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},Yte=Xte($6,2),BSe=Yte.b,Fk=Yte.r;BSe[28]=258,Fk[258]=28;var TSe=Xte(K6,0),TQ=TSe.r,Ok=new Ou(32768);for(var Bs=0;Bs<32768;++Bs){var d0=(Bs&43690)>>1|(Bs&21845)<<1;d0=(d0&52428)>>2|(d0&13107)<<2,d0=(d0&61680)>>4|(d0&3855)<<4,Ok[Bs]=((d0&65280)>>8|(d0&255)<<8)>>1}var Cb=function(t,e,r){for(var n=t.length,a=0,s=new Ou(e);a<n;++a)t[a]&&++s[t[a]-1];var o=new Ou(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new Ou(1<<e);var c=15-e;for(a=0;a<n;++a)if(t[a])for(var u=a<<4|t[a],d=e-t[a],f=o[t[a]-1]++<<d,A=f|(1<<d)-1;f<=A;++f)l[Ok[f]>>c]=u}else for(l=new Ou(n),a=0;a<n;++a)t[a]&&(l[a]=Ok[o[t[a]-1]++]>>15-t[a]);return l},ug=new Nf(288);for(var Bs=0;Bs<144;++Bs)ug[Bs]=8;for(var Bs=144;Bs<256;++Bs)ug[Bs]=9;for(var Bs=256;Bs<280;++Bs)ug[Bs]=7;for(var Bs=280;Bs<288;++Bs)ug[Bs]=8;var TS=new Nf(32);for(var Bs=0;Bs<32;++Bs)TS[Bs]=5;var kSe=Cb(ug,9,0),FSe=Cb(TS,5,0),Jte=function(t){return(t+7)/8|0},OSe=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Nf(t.subarray(e,r))},Sh=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Ay=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},J4=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,s=r.slice();if(!a)return{t:ere,l:0};if(a==1){var o=new Nf(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(j,I){return j.f-I.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=a-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var A=s[0].s,n=1;n<a;++n)s[n].s>A&&(A=s[n].s);var h=new Ou(A+1),m=Dk(r[d-1],h,0);if(m>e){var n=0,p=0,x=m-e,v=1<<x;for(s.sort(function(I,_){return h[_.s]-h[I.s]||I.f-_.f});n<a;++n){var y=s[n].s;if(h[y]>e)p+=v-(1<<m-h[y]),h[y]=e;else break}for(p>>=x;p>0;){var b=s[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var w=s[n].s;h[w]==e&&(--h[w],++p)}m=e}return{t:new Nf(h),l:m}},Dk=function(t,e,r){return t.s==-1?Math.max(Dk(t.l,e,r+1),Dk(t.r,e,r+1)):e[t.s]=r},kQ=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ou(++e),n=0,a=t[0],s=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==a&&l!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[l]}return{c:r.subarray(0,n),n:e}},my=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},Zte=function(t,e,r){var n=r.length,a=Jte(e+2);t[a]=n&255,t[a+1]=n>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var s=0;s<n;++s)t[a+s+4]=r[s];return(a+4+n)*8},FQ=function(t,e,r,n,a,s,o,l,c,u,d){Sh(e,d++,r),++a[256];for(var f=J4(a,15),A=f.t,h=f.l,m=J4(s,15),p=m.t,x=m.l,v=kQ(A),y=v.c,b=v.n,w=kQ(p),j=w.c,I=w.n,_=new Ou(19),S=0;S<y.length;++S)++_[y[S]&31];for(var S=0;S<j.length;++S)++_[j[S]&31];for(var E=J4(_,7),B=E.t,k=E.l,P=19;P>4&&!B[BQ[P-1]];--P);var O=u+5<<3,z=my(a,ug)+my(s,TS)+o,oe=my(a,A)+my(s,p)+o+14+3*P+my(_,B)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&O<=z&&O<=oe)return Zte(e,d,t.subarray(c,c+u));var ce,ue,ge,ne;if(Sh(e,d,1+(oe<z)),d+=2,oe<z){ce=Cb(A,h,0),ue=A,ge=Cb(p,x,0),ne=p;var Oe=Cb(B,k,0);Sh(e,d,b-257),Sh(e,d+5,I-1),Sh(e,d+10,P-4),d+=14;for(var S=0;S<P;++S)Sh(e,d+3*S,B[BQ[S]]);d+=3*P;for(var Ue=[y,j],F=0;F<2;++F)for(var H=Ue[F],S=0;S<H.length;++S){var K=H[S]&31;Sh(e,d,Oe[K]),d+=B[K],K>15&&(Sh(e,d,H[S]>>5&127),d+=H[S]>>12)}}else ce=kSe,ue=ug,ge=FSe,ne=TS;for(var S=0;S<l;++S){var U=n[S];if(U>255){var K=U>>18&31;Ay(e,d,ce[K+257]),d+=ue[K+257],K>7&&(Sh(e,d,U>>23&31),d+=$6[K]);var W=U&31;Ay(e,d,ge[W]),d+=ne[W],W>3&&(Ay(e,d,U>>5&8191),d+=K6[W])}else Ay(e,d,ce[U]),d+=ue[U]}return Ay(e,d,ce[256]),d+ue[256]},DSe=new H6([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ere=new Nf(0),RSe=function(t,e,r,n,a,s){var o=s.z||t.length,l=new Nf(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,d=(s.r||0)&7;if(e){d&&(c[0]=s.r>>3);for(var f=DSe[e-1],A=f>>13,h=f&8191,m=(1<<r)-1,p=s.p||new Ou(32768),x=s.h||new Ou(m+1),v=Math.ceil(r/3),y=2*v,b=function(re){return(t[re]^t[re+1]<<v^t[re+2]<<y)&m},w=new H6(25e3),j=new Ou(288),I=new Ou(32),_=0,S=0,E=s.i||0,B=0,k=s.w||0,P=0;E+2<o;++E){var O=b(E),z=E&32767,oe=x[O];if(p[z]=oe,x[O]=z,k<=E){var ce=o-E;if((_>7e3||B>24576)&&(ce>423||!u)){d=FQ(t,c,0,w,j,I,S,B,P,E-P,d),B=_=S=0,P=E;for(var ue=0;ue<286;++ue)j[ue]=0;for(var ue=0;ue<30;++ue)I[ue]=0}var ge=2,ne=0,Oe=h,Ue=z-oe&32767;if(ce>2&&O==b(E-Ue))for(var F=Math.min(A,ce)-1,H=Math.min(32767,E),K=Math.min(258,ce);Ue<=H&&--Oe&&z!=oe;){if(t[E+ge]==t[E+ge-Ue]){for(var U=0;U<K&&t[E+U]==t[E+U-Ue];++U);if(U>ge){if(ge=U,ne=Ue,U>F)break;for(var W=Math.min(Ue,U-2),X=0,ue=0;ue<W;++ue){var D=E-Ue+ue&32767,V=p[D],Z=D-V&32767;Z>X&&(X=Z,oe=D)}}}z=oe,oe=p[z],Ue+=z-oe&32767}if(ne){w[B++]=268435456|Fk[ge]<<18|TQ[ne];var be=Fk[ge]&31,L=TQ[ne]&31;S+=$6[be]+K6[L],++j[257+be],++I[L],k=E+ge,++_}else w[B++]=t[E],++j[t[E]]}}for(E=Math.max(E,k);E<o;++E)w[B++]=t[E],++j[t[E]];d=FQ(t,c,u,w,j,I,S,B,P,E-P,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=x,s.p=p,s.i=E,s.w=k)}else{for(var E=s.w||0;E<o+u;E+=65535){var Xe=E+65535;Xe>=o&&(c[d/8|0]=u,Xe=o),d=Zte(c,d+1,t.subarray(E,Xe))}s.i=o}return OSe(l,0,n+Jte(d)+a)},tre=function(){var t=1,e=0;return{p:function(r){for(var n=t,a=e,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}t=n,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},MSe=function(t,e,r,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Nf(s.length+t.length);o.set(s),o.set(t,s.length),t=o,a.w=s.length}return RSe(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,a)},rre=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},LSe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=tre();a.p(e.dictionary),rre(t,2,a.d())}};function Rk(t,e){e||(e={});var r=tre();r.p(t);var n=MSe(t,e,e.dictionary?6:2,4);return LSe(n,e),rre(n,n.length-4,r.d()),n}var USe=typeof TextDecoder<"u"&&new TextDecoder,QSe=0;try{USe.decode(ere,{stream:!0}),QSe=1}catch{}function VSe(t){if(Array.isArray(t))return t}function HSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function OQ(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $Se(t,e){if(t){if(typeof t=="string")return OQ(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?OQ(t,e):void 0}}function KSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DQ(t,e){return VSe(t)||HSe(t,e)||$Se(t,e)||KSe()}function RQ(t,e="utf8"){return new TextDecoder(e).decode(t)}const GSe=new TextEncoder;function qSe(t){return GSe.encode(t)}const zSe=1024*8,WSe=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),Z4={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class G6{constructor(e=zSe,r={}){Br(this,"buffer");Br(this,"byteLength");Br(this,"byteOffset");Br(this,"length");Br(this,"offset");Br(this,"lastWrittenByte");Br(this,"littleEndian");Br(this,"_data");Br(this,"_mark");Br(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const a=r.offset?r.offset>>>0:0,s=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof G6)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=Z4[r].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===WSe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new Z4[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new Z4[r](s);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return RQ(this.readBytes(e))}decodeText(e=1,r="utf8"){return RQ(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(qSe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function g1(t){let e=t.length;for(;--e>=0;)t[e]=0}const XSe=3,YSe=258,nre=29,JSe=256,ZSe=JSe+1+nre,are=30,eIe=512,tIe=new Array((ZSe+2)*2);g1(tIe);const rIe=new Array(are*2);g1(rIe);const nIe=new Array(eIe);g1(nIe);const aIe=new Array(YSe-XSe+1);g1(aIe);const sIe=new Array(nre);g1(sIe);const iIe=new Array(are);g1(iIe);const oIe=(t,e,r,n)=>{let a=t&65535|0,s=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+e[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var Mk=oIe;const lIe=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},cIe=new Uint32Array(lIe()),uIe=(t,e,r,n)=>{const a=cIe,s=n+r;t^=-1;for(let o=n;o<s;o++)t=t>>>8^a[(t^e[o])&255];return t^-1};var Rf=uIe,Lk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},sre={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const dIe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var fIe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)dIe(r,n)&&(t[n]=r[n])}}return t},hIe=t=>{let e=0;for(let n=0,a=t.length;n<a;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,a=0,s=t.length;n<s;n++){let o=t[n];r.set(o,a),a+=o.length}return r},ire={assign:fIe,flattenChunks:hIe};let ore=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ore=!1}const E2=new Uint8Array(256);for(let t=0;t<256;t++)E2[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;E2[254]=E2[254]=1;var AIe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,a,s,o=t.length,l=0;for(a=0;a<o;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),s=0,a=0;s<l;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const mIe=(t,e)=>{if(e<65534&&t.subarray&&ore)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var pIe=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=t[n++];if(o<128){s[a++]=o;continue}let l=E2[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return mIe(s,a)},gIe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+E2[t[r]]>e?r:e},Uk={string2buf:AIe,buf2string:pIe,utf8border:gIe};function xIe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var vIe=xIe;const jC=16209,yIe=16191;var bIe=function(e,r){let n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,_,S,E,B;const k=e.state;n=e.next_in,E=e.input,a=n+(e.avail_in-5),s=e.next_out,B=e.output,o=s-(r-e.avail_out),l=s+(e.avail_out-257),c=k.dmax,u=k.wsize,d=k.whave,f=k.wnext,A=k.window,h=k.hold,m=k.bits,p=k.lencode,x=k.distcode,v=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=p[h&v];t:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w===0)B[s++]=b&65535;else if(w&16){j=b&65535,w&=15,w&&(m<w&&(h+=E[n++]<<m,m+=8),j+=h&(1<<w)-1,h>>>=w,m-=w),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=x[h&y];r:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w&16){if(I=b&65535,w&=15,m<w&&(h+=E[n++]<<m,m+=8,m<w&&(h+=E[n++]<<m,m+=8)),I+=h&(1<<w)-1,I>c){e.msg="invalid distance too far back",k.mode=jC;break e}if(h>>>=w,m-=w,w=s-o,I>w){if(w=I-w,w>d&&k.sane){e.msg="invalid distance too far back",k.mode=jC;break e}if(_=0,S=A,f===0){if(_+=u-w,w<j){j-=w;do B[s++]=A[_++];while(--w);_=s-I,S=B}}else if(f<w){if(_+=u+f-w,w-=f,w<j){j-=w;do B[s++]=A[_++];while(--w);if(_=0,f<j){w=f,j-=w;do B[s++]=A[_++];while(--w);_=s-I,S=B}}}else if(_+=f-w,w<j){j-=w;do B[s++]=A[_++];while(--w);_=s-I,S=B}for(;j>2;)B[s++]=S[_++],B[s++]=S[_++],B[s++]=S[_++],j-=3;j&&(B[s++]=S[_++],j>1&&(B[s++]=S[_++]))}else{_=s-I;do B[s++]=B[_++],B[s++]=B[_++],B[s++]=B[_++],j-=3;while(j>2);j&&(B[s++]=B[_++],j>1&&(B[s++]=B[_++]))}}else if(w&64){e.msg="invalid distance code",k.mode=jC;break e}else{b=x[(b&65535)+(h&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){k.mode=yIe;break e}else{e.msg="invalid literal/length code",k.mode=jC;break e}else{b=p[(b&65535)+(h&(1<<w)-1)];continue t}break}}while(n<a&&s<l);j=m>>3,n-=j,m-=j<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?5+(a-n):5-(n-a),e.avail_out=s<l?257+(l-s):257-(s-l),k.hold=h,k.bits=m};const cx=15,MQ=852,LQ=592,UQ=0,e5=1,QQ=2,wIe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),NIe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),CIe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),_Ie=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),EIe=(t,e,r,n,a,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=0,b,w,j,I,_,S=null,E;const B=new Uint16Array(cx+1),k=new Uint16Array(cx+1);let P=null,O,z,oe;for(u=0;u<=cx;u++)B[u]=0;for(d=0;d<n;d++)B[e[r+d]]++;for(h=c,A=cx;A>=1&&B[A]===0;A--);if(h>A&&(h=A),A===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<A&&B[f]===0;f++);for(h<f&&(h=f),x=1,u=1;u<=cx;u++)if(x<<=1,x-=B[u],x<0)return-1;if(x>0&&(t===UQ||A!==1))return-1;for(k[1]=0,u=1;u<cx;u++)k[u+1]=k[u]+B[u];for(d=0;d<n;d++)e[r+d]!==0&&(o[k[e[r+d]]++]=d);if(t===UQ?(S=P=o,E=20):t===e5?(S=wIe,P=NIe,E=257):(S=CIe,P=_Ie,E=0),y=0,d=0,u=f,_=s,m=h,p=0,j=-1,v=1<<h,I=v-1,t===e5&&v>MQ||t===QQ&&v>LQ)return 1;for(;;){O=u-p,o[d]+1<E?(z=0,oe=o[d]):o[d]>=E?(z=P[o[d]-E],oe=S[o[d]-E]):(z=96,oe=0),b=1<<u-p,w=1<<m,f=w;do w-=b,a[_+(y>>p)+w]=O<<24|z<<16|oe|0;while(w!==0);for(b=1<<u-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,d++,--B[u]===0){if(u===A)break;u=e[r+o[d]]}if(u>h&&(y&I)!==j){for(p===0&&(p=h),_+=f,m=u-p,x=1<<m;m+p<A&&(x-=B[m+p],!(x<=0));)m++,x<<=1;if(v+=1<<m,t===e5&&v>MQ||t===QQ&&v>LQ)return 1;j=y&I,a[j]=h<<24|m<<16|_-s|0}}return y!==0&&(a[_+y]=u-p<<24|64<<16|0),l.bits=h,0};var _b=EIe;const SIe=0,lre=1,cre=2,{Z_FINISH:VQ,Z_BLOCK:IIe,Z_TREES:PC,Z_OK:dg,Z_STREAM_END:jIe,Z_NEED_DICT:PIe,Z_STREAM_ERROR:Fd,Z_DATA_ERROR:ure,Z_MEM_ERROR:dre,Z_BUF_ERROR:BIe,Z_DEFLATED:HQ}=sre,aP=16180,$Q=16181,KQ=16182,GQ=16183,qQ=16184,zQ=16185,WQ=16186,XQ=16187,YQ=16188,JQ=16189,kS=16190,Ih=16191,t5=16192,ZQ=16193,r5=16194,eV=16195,tV=16196,rV=16197,nV=16198,BC=16199,TC=16200,aV=16201,sV=16202,iV=16203,oV=16204,lV=16205,n5=16206,cV=16207,uV=16208,Rs=16209,fre=16210,hre=16211,TIe=852,kIe=592,FIe=15,OIe=FIe,dV=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function DIe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Og=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<aP||e.mode>hre?1:0},Are=t=>{if(Og(t))return Fd;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=aP,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(TIe),e.distcode=e.distdyn=new Int32Array(kIe),e.sane=1,e.back=-1,dg},mre=t=>{if(Og(t))return Fd;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Are(t)},pre=(t,e)=>{let r;if(Og(t))return Fd;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Fd:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,mre(t))},gre=(t,e)=>{if(!t)return Fd;const r=new DIe;t.state=r,r.strm=t,r.window=null,r.mode=aP;const n=pre(t,e);return n!==dg&&(t.state=null),n},RIe=t=>gre(t,OIe);let fV=!0,a5,s5;const MIe=t=>{if(fV){a5=new Int32Array(512),s5=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(_b(lre,t.lens,0,288,a5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;_b(cre,t.lens,0,32,s5,0,t.work,{bits:5}),fV=!1}t.lencode=a5,t.lenbits=9,t.distcode=s5,t.distbits=5},xre=(t,e,r,n)=>{let a;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(e.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},LIe=(t,e)=>{let r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=0,v,y,b,w,j,I,_,S;const E=new Uint8Array(4);let B,k;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Og(t)||!t.output||!t.input&&t.avail_in!==0)return Fd;r=t.state,r.mode===Ih&&(r.mode=t5),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,f=l,A=c,S=dg;e:for(;;)switch(r.mode){case aP:if(r.wrap===0){r.mode=t5;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0),u=0,d=0,r.mode=$Q;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=Rs;break}if((u&15)!==HQ){t.msg="unknown compression method",r.mode=Rs;break}if(u>>>=4,d-=4,_=(u&15)+8,r.wbits===0&&(r.wbits=_),_>15||_>r.wbits){t.msg="invalid window size",r.mode=Rs;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?JQ:Ih,u=0,d=0;break;case $Q:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==HQ){t.msg="unknown compression method",r.mode=Rs;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Rs;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0)),u=0,d=0,r.mode=KQ;case KQ:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=Rf(r.check,E,4,0)),u=0,d=0,r.mode=GQ;case GQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0)),u=0,d=0,r.mode=qQ;case qQ:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=zQ;case zQ:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),_)),r.flags&512&&r.wrap&4&&(r.check=Rf(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=WQ;case WQ:if(r.flags&2048){if(l===0)break e;h=0;do _=n[s+h++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Rf(r.check,n,h,s)),l-=h,s+=h,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=XQ;case XQ:if(r.flags&4096){if(l===0)break e;h=0;do _=n[s+h++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Rf(r.check,n,h,s)),l-=h,s+=h,_)break e}else r.head&&(r.head.comment=null);r.mode=YQ;case YQ:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Rs;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ih;break;case JQ:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.adler=r.check=dV(u),u=0,d=0,r.mode=kS;case kS:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,PIe;t.adler=r.check=1,r.mode=Ih;case Ih:if(e===IIe||e===PC)break e;case t5:if(r.last){u>>>=d&7,d-=d&7,r.mode=n5;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=ZQ;break;case 1:if(MIe(r),r.mode=BC,e===PC){u>>>=2,d-=2;break e}break;case 2:r.mode=tV;break;case 3:t.msg="invalid block type",r.mode=Rs}u>>>=2,d-=2;break;case ZQ:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Rs;break}if(r.length=u&65535,u=0,d=0,r.mode=r5,e===PC)break e;case r5:r.mode=eV;case eV:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=Ih;break;case tV:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Rs;break}r.have=0,r.mode=rV;case rV:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[P[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},S=_b(SIe,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid code lengths set",r.mode=Rs;break}r.have=0,r.mode=nV;case nV:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(b<16)u>>>=v,d-=v,r.lens[r.have++]=b;else{if(b===16){for(k=v+2;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=v,d-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=Rs;break}_=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(b===17){for(k=v+3;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,_=0,h=3+(u&7),u>>>=3,d-=3}else{for(k=v+7;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,_=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Rs;break}for(;h--;)r.lens[r.have++]=_}}if(r.mode===Rs)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Rs;break}if(r.lenbits=9,B={bits:r.lenbits},S=_b(lre,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid literal/lengths set",r.mode=Rs;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},S=_b(cre,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,S){t.msg="invalid distances set",r.mode=Rs;break}if(r.mode=BC,e===PC)break e;case BC:r.mode=TC;case TC:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,bIe(t,A),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,r.mode===Ih&&(r.back=-1);break}for(r.back=0;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(y&&!(y&240)){for(w=v,j=y,I=b;x=r.lencode[I+((u&(1<<w+j)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,r.length=b,y===0){r.mode=lV;break}if(y&32){r.back=-1,r.mode=Ih;break}if(y&64){t.msg="invalid literal/length code",r.mode=Rs;break}r.extra=y&15,r.mode=aV;case aV:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=sV;case sV:for(;x=r.distcode[u&(1<<r.distbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(y&240)){for(w=v,j=y,I=b;x=r.distcode[I+((u&(1<<w+j)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,y&64){t.msg="invalid distance code",r.mode=Rs;break}r.offset=b,r.extra=y&15,r.mode=iV;case iV:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Rs;break}r.mode=oV;case oV:if(c===0)break e;if(h=A-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Rs;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=a,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[o++]=p[m++];while(--h);r.length===0&&(r.mode=TC);break;case lV:if(c===0)break e;a[o++]=r.length,c--,r.mode=TC;break;case n5:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(A-=c,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Rf(r.check,a,A,o-A):Mk(r.check,a,A,o-A)),A=c,r.wrap&4&&(r.flags?u:dV(u))!==r.check){t.msg="incorrect data check",r.mode=Rs;break}u=0,d=0}r.mode=cV;case cV:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Rs;break}u=0,d=0}r.mode=uV;case uV:S=jIe;break e;case Rs:S=ure;break e;case fre:return dre;case hre:default:return Fd}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,(r.wsize||A!==t.avail_out&&r.mode<Rs&&(r.mode<n5||e!==VQ))&&xre(t,t.output,t.next_out,A-t.avail_out),f-=t.avail_in,A-=t.avail_out,t.total_in+=f,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Rf(r.check,a,A,t.next_out-A):Mk(r.check,a,A,t.next_out-A)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ih?128:0)+(r.mode===BC||r.mode===r5?256:0),(f===0&&A===0||e===VQ)&&S===dg&&(S=BIe),S},UIe=t=>{if(Og(t))return Fd;let e=t.state;return e.window&&(e.window=null),t.state=null,dg},QIe=(t,e)=>{if(Og(t))return Fd;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,dg):Fd},VIe=(t,e)=>{const r=e.length;let n,a,s;return Og(t)||(n=t.state,n.wrap!==0&&n.mode!==kS)?Fd:n.mode===kS&&(a=1,a=Mk(a,e,r,0),a!==n.check)?ure:(s=xre(t,e,r,r),s?(n.mode=fre,dre):(n.havedict=1,dg))};var HIe=mre,$Ie=pre,KIe=Are,GIe=RIe,qIe=gre,zIe=LIe,WIe=UIe,XIe=QIe,YIe=VIe,JIe="pako inflate (from Nodeca project)",Uh={inflateReset:HIe,inflateReset2:$Ie,inflateResetKeep:KIe,inflateInit:GIe,inflateInit2:qIe,inflate:zIe,inflateEnd:WIe,inflateGetHeader:XIe,inflateSetDictionary:YIe,inflateInfo:JIe};function ZIe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var eje=ZIe;const vre=Object.prototype.toString,{Z_NO_FLUSH:tje,Z_FINISH:rje,Z_OK:S2,Z_STREAM_END:i5,Z_NEED_DICT:o5,Z_STREAM_ERROR:nje,Z_DATA_ERROR:hV,Z_MEM_ERROR:aje}=sre;function Dw(t){this.options=ire.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vIe,this.strm.avail_out=0;let r=Uh.inflateInit2(this.strm,e.windowBits);if(r!==S2)throw new Error(Lk[r]);if(this.header=new eje,Uh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Uk.string2buf(e.dictionary):vre.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Uh.inflateSetDictionary(this.strm,e.dictionary),r!==S2)))throw new Error(Lk[r])}Dw.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?rje:tje,vre.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Uh.inflate(r,o),s===o5&&a&&(s=Uh.inflateSetDictionary(r,a),s===S2?s=Uh.inflate(r,o):s===hV&&(s=o5));r.avail_in>0&&s===i5&&r.state.wrap>0&&t[r.next_in]!==0;)Uh.inflateReset(r),s=Uh.inflate(r,o);switch(s){case nje:case hV:case o5:case aje:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===i5))if(this.options.to==="string"){let c=Uk.utf8border(r.output,r.next_out),u=r.next_out-c,d=Uk.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===S2&&l===0)){if(s===i5)return s=Uh.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Dw.prototype.onData=function(t){this.chunks.push(t)};Dw.prototype.onEnd=function(t){t===S2&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ire.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function sje(t,e){const r=new Dw(e);if(r.push(t),r.err)throw r.msg||Lk[r.err];return r.result}var ije=Dw,oje=sje,lje={Inflate:ije,inflate:oje};const{Inflate:cje,inflate:uje}=lje;var AV=cje,dje=uje;const yre=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;yre[t]=e}const mV=4294967295;function fje(t,e,r){let n=t;for(let a=0;a<r;a++)n=yre[(n^e[a])&255]^n>>>8;return n}function hje(t,e){return(fje(mV,t,e)^mV)>>>0}function pV(t,e,r){const n=t.readUint32(),a=hje(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function bre(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function wre(t,e,r,n){let a=0;for(;a<n;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-n]&255}function Nre(t,e,r,n){let a=0;if(r.length===0)for(;a<n;a++)e[a]=t[a];else for(;a<n;a++)e[a]=t[a]+r[a]&255}function Cre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-a]>>1)&255}else{for(;s<a;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-a]+r[s]>>1)&255}}function _re(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-a]&255}else{for(;s<a;s++)e[s]=t[s]+r[s]&255;for(;s<n;s++)e[s]=t[s]+Aje(e[s-a],r[s],r[s-a])&255}}function Aje(t,e,r){const n=t+e-r,a=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-r);return a<=s&&a<=o?t:s<=o?e:r}function mje(t,e,r,n,a,s){switch(t){case 0:bre(e,r,a);break;case 1:wre(e,r,a,s);break;case 2:Nre(e,r,n,a);break;case 3:Cre(e,r,n,a,s);break;case 4:_re(e,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const pje=new Uint16Array([255]),gje=new Uint8Array(pje.buffer),xje=gje[0]===255;function vje(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],A=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(A<=0||h<=0)continue;const m=A*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const v=e[u++],y=e.subarray(u,u+m);u+=m;const b=new Uint8Array(m);mje(v,y,b,p,m,l),p.set(b);for(let w=0;w<A;w++){const j=f.x+w*f.xStep,I=f.y+x*f.yStep;if(!(j>=r||I>=n))for(let _=0;_<l;_++)c[(I*r+j)*l+_]=b[w*l+_]}}}if(s===16){const d=new Uint16Array(c.buffer);if(xje)for(let f=0;f<d.length;f++)d[f]=yje(d[f]);return d}else return c}function yje(t){return(t&255)<<8|t>>8&255}const bje=new Uint16Array([255]),wje=new Uint8Array(bje.buffer),Nje=wje[0]===255,Cje=new Uint8Array(0);function gV(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let u=Cje,d=0,f,A;for(let h=0;h<n;h++){switch(f=e.subarray(d+1,d+1+l),A=c.subarray(h*l,(h+1)*l),e[d]){case 0:bre(f,A,l);break;case 1:wre(f,A,l,o);break;case 2:Nre(f,A,u,l);break;case 3:Cre(f,A,u,l,o);break;case 4:_re(f,A,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}u=A,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(Nje)for(let m=0;m<h.length;m++)h[m]=_je(h[m]);return h}else return c}function _je(t){return(t&255)<<8|t>>8&255}const mE=Uint8Array.of(137,80,78,71,13,10,26,10);function xV(t){if(!Eje(t.readBytes(mE.length)))throw new Error("wrong PNG signature")}function Eje(t){if(t.length<mE.length)return!1;for(let e=0;e<mE.length;e++)if(t[e]!==mE[e])return!1;return!0}const Sje="tEXt",Ije=0,Ere=new TextDecoder("latin1");function jje(t){if(Bje(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Pje=/^[\u0000-\u00FF]*$/;function Bje(t){if(!Pje.test(t))throw new Error("invalid latin1 text")}function Tje(t,e,r){const n=Sre(e);t[n]=kje(e,r-n.length-1)}function Sre(t){for(t.mark();t.readByte()!==Ije;);const e=t.offset;t.reset();const r=Ere.decode(t.readBytes(e-t.offset-1));return t.skip(1),jje(r),r}function kje(t,e){return Ere.decode(t.readBytes(e))}const wu={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},l5={UNKNOWN:-1,DEFLATE:0},vV={UNKNOWN:-1,ADAPTIVE:0},c5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},kC={NONE:0,BACKGROUND:1,PREVIOUS:2},u5={SOURCE:0,OVER:1};class Fje extends G6{constructor(r,n={}){super(r);Br(this,"_checkCrc");Br(this,"_inflator");Br(this,"_png");Br(this,"_apng");Br(this,"_end");Br(this,"_hasPalette");Br(this,"_palette");Br(this,"_hasTransparency");Br(this,"_transparency");Br(this,"_compressionMethod");Br(this,"_filterMethod");Br(this,"_interlaceMethod");Br(this,"_colorType");Br(this,"_isAnimated");Br(this,"_numberOfFrames");Br(this,"_numberOfPlays");Br(this,"_frames");Br(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new AV,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=l5.UNKNOWN,this._filterMethod=vV.UNKNOWN,this._interlaceMethod=c5.UNKNOWN,this._colorType=wu.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(xV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(xV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Sje:Tje(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?pV(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?pV(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Oje(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case wu.GREYSCALE:a=1;break;case wu.TRUECOLOUR:a=3;break;case wu.INDEXED_COLOUR:a=1;break;case wu.GREYSCALE_ALPHA:a=2;break;case wu.TRUECOLOUR_ALPHA:a=4;break;case wu.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==l5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case wu.GREYSCALE:case wu.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case wu.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case wu.UNKNOWN:case wu.GREYSCALE_ALPHA:case wu.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Sre(this),a=this.readUint8();if(a!==l5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:dje(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=gV({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case kC.NONE:break;case kC.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case kC.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case u5.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case u5.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/a,A=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*A+(1-f)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==vV.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===c5.NO_INTERLACE)this._png.data=gV({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===c5.ADAM7)this._png.data=vje({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:kC.NONE,blendOp:u5.SOURCE,data:r}),this._inflator=new AV,this._writingDataChunks=!1}}function Oje(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var yV;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(yV||(yV={}));function Dje(t,e){return new Fje(t,e).decode()}var Mn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function d5(){Mn.console&&typeof Mn.console.log=="function"&&Mn.console.log.apply(Mn.console,arguments)}var hs={log:d5,warn:function(t){Mn.console&&(typeof Mn.console.warn=="function"?Mn.console.warn.apply(Mn.console,arguments):d5.call(null,arguments))},error:function(t){Mn.console&&(typeof Mn.console.error=="function"?Mn.console.error.apply(Mn.console,arguments):d5(t))}};function f5(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){cp(n.response,e,r)},n.onerror=function(){hs.error("could not download file")},n.send()}function bV(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function FC(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var cp=Mn.saveAs||((typeof window>"u"?"undefined":es(window))!=="object"||window!==Mn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Mn.URL||Mn.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?bV(a.href)?f5(t,e,r):FC(a,a.target="_blank"):FC(a)):(a.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){FC(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(bV(t))f5(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){FC(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:es(s)!=="object"&&(hs.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return f5(t,e,r);var a=t.type==="application/octet-stream",s=/constructor/i.test(Mn.HTMLElement)||Mn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":es(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=Mn.URL||Mn.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Ire(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var pE=Mn.atob.bind(Mn),wV=Mn.btoa.bind(Mn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function h5(t,e){var r=t[0],n=t[1],a=t[2],s=t[3];r=Ql(r,n,a,s,e[0],7,-680876936),s=Ql(s,r,n,a,e[1],12,-389564586),a=Ql(a,s,r,n,e[2],17,606105819),n=Ql(n,a,s,r,e[3],22,-1044525330),r=Ql(r,n,a,s,e[4],7,-176418897),s=Ql(s,r,n,a,e[5],12,1200080426),a=Ql(a,s,r,n,e[6],17,-1473231341),n=Ql(n,a,s,r,e[7],22,-45705983),r=Ql(r,n,a,s,e[8],7,1770035416),s=Ql(s,r,n,a,e[9],12,-1958414417),a=Ql(a,s,r,n,e[10],17,-42063),n=Ql(n,a,s,r,e[11],22,-1990404162),r=Ql(r,n,a,s,e[12],7,1804603682),s=Ql(s,r,n,a,e[13],12,-40341101),a=Ql(a,s,r,n,e[14],17,-1502002290),r=Vl(r,n=Ql(n,a,s,r,e[15],22,1236535329),a,s,e[1],5,-165796510),s=Vl(s,r,n,a,e[6],9,-1069501632),a=Vl(a,s,r,n,e[11],14,643717713),n=Vl(n,a,s,r,e[0],20,-373897302),r=Vl(r,n,a,s,e[5],5,-701558691),s=Vl(s,r,n,a,e[10],9,38016083),a=Vl(a,s,r,n,e[15],14,-660478335),n=Vl(n,a,s,r,e[4],20,-405537848),r=Vl(r,n,a,s,e[9],5,568446438),s=Vl(s,r,n,a,e[14],9,-1019803690),a=Vl(a,s,r,n,e[3],14,-187363961),n=Vl(n,a,s,r,e[8],20,1163531501),r=Vl(r,n,a,s,e[13],5,-1444681467),s=Vl(s,r,n,a,e[2],9,-51403784),a=Vl(a,s,r,n,e[7],14,1735328473),r=Hl(r,n=Vl(n,a,s,r,e[12],20,-1926607734),a,s,e[5],4,-378558),s=Hl(s,r,n,a,e[8],11,-2022574463),a=Hl(a,s,r,n,e[11],16,1839030562),n=Hl(n,a,s,r,e[14],23,-35309556),r=Hl(r,n,a,s,e[1],4,-1530992060),s=Hl(s,r,n,a,e[4],11,1272893353),a=Hl(a,s,r,n,e[7],16,-155497632),n=Hl(n,a,s,r,e[10],23,-1094730640),r=Hl(r,n,a,s,e[13],4,681279174),s=Hl(s,r,n,a,e[0],11,-358537222),a=Hl(a,s,r,n,e[3],16,-722521979),n=Hl(n,a,s,r,e[6],23,76029189),r=Hl(r,n,a,s,e[9],4,-640364487),s=Hl(s,r,n,a,e[12],11,-421815835),a=Hl(a,s,r,n,e[15],16,530742520),r=$l(r,n=Hl(n,a,s,r,e[2],23,-995338651),a,s,e[0],6,-198630844),s=$l(s,r,n,a,e[7],10,1126891415),a=$l(a,s,r,n,e[14],15,-1416354905),n=$l(n,a,s,r,e[5],21,-57434055),r=$l(r,n,a,s,e[12],6,1700485571),s=$l(s,r,n,a,e[3],10,-1894986606),a=$l(a,s,r,n,e[10],15,-1051523),n=$l(n,a,s,r,e[1],21,-2054922799),r=$l(r,n,a,s,e[8],6,1873313359),s=$l(s,r,n,a,e[15],10,-30611744),a=$l(a,s,r,n,e[6],15,-1560198380),n=$l(n,a,s,r,e[13],21,1309151649),r=$l(r,n,a,s,e[4],6,-145523070),s=$l(s,r,n,a,e[11],10,-1120210379),a=$l(a,s,r,n,e[2],15,718787259),n=$l(n,a,s,r,e[9],21,-343485551),t[0]=z0(r,t[0]),t[1]=z0(n,t[1]),t[2]=z0(a,t[2]),t[3]=z0(s,t[3])}function sP(t,e,r,n,a,s){return e=z0(z0(e,t),z0(n,s)),z0(e<<a|e>>>32-a,r)}function Ql(t,e,r,n,a,s,o){return sP(e&r|~e&n,t,e,a,s,o)}function Vl(t,e,r,n,a,s,o){return sP(e&n|r&~n,t,e,a,s,o)}function Hl(t,e,r,n,a,s,o){return sP(e^r^n,t,e,a,s,o)}function $l(t,e,r,n,a,s,o){return sP(r^(e|~n),t,e,a,s,o)}function jre(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)h5(n,Rje(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(h5(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*r,h5(n,a),n}function Rje(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var NV="0123456789abcdef".split("");function Mje(t){for(var e="",r=0;r<4;r++)e+=NV[t>>8*r+4&15]+NV[t>>8*r&15];return e}function Lje(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Qk(t){return jre(t).map(Lje).join("")}var Uje=function(t){for(var e=0;e<t.length;e++)t[e]=Mje(t[e]);return t.join("")}(jre("hello"))!="5d41402abc4b2a76b9719d911017c592";function z0(t,e){if(Uje){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Vk(t,e){var r,n,a,s;if(t!==r){for(var o=(a=t,s=1+(256/t.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var f=e.length,A=0,h=0,m="";for(c=0;c<f;c++)h=(h+(d=l[A=(A+1)%256]))%256,l[A]=l[h],l[h]=d,o=l[(l[A]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var CV={print:4,modify:8,copy:16,"annot-forms":32};function Bx(t,e,r,n){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(CV.perm!==void 0)throw new Error("Invalid permission: "+l);a+=CV[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=Qk(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Vk(this.encryptionKey,this.padding)}function Tx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var a=t.charCodeAt(n);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[n]}return e}function _V(t){if(es(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[r]){var o=e[r][s];try{o[0].apply(t,n)}catch(l){Mn.console&&hs.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function I2(t){if(!(this instanceof I2))return new I2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Pre(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function L0(t,e,r,n,a){if(!(this instanceof L0))return new L0(t,e,r,n,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Pre.call(this,n,a)}function _p(t,e,r,n,a){if(!(this instanceof _p))return new _p(t,e,r,n,a);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Pre.call(this,n,a)}function an(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;es(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,a=t.format||a,s=t.compress||t.compressPdf||s,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,A={},h={internal:{},__private__:{}};h.__private__.PubSub=_V;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(M){m=M};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var v=h.__private__.getPageFormat=function(M){return x[M]};a=a||"a4";var y="compat",b="advanced",w=y;function j(){this.saveGraphicsState(),J(new Le(Te,0,0,-Te,0,fo()*Te).toString()+" cm"),this.setFontSize(this.getFontSize()/Te),u="n",w=b}function I(){this.restoreGraphicsState(),u="S",w=y}var _=h.__private__.combineFontStyleAndFontWeight=function(M,Be){if(M=="bold"&&Be=="normal"||M=="bold"&&Be==400||M=="normal"&&Be=="italic"||M=="bold"&&Be=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Be&&(M=Be==400||Be==="normal"?M==="italic"?"italic":"normal":Be!=700&&Be!=="bold"||M!=="normal"?(Be==700?"bold":Be)+""+M:"bold"),M};h.advancedAPI=function(M){var Be=w===y;return Be&&j.call(this),typeof M!="function"||(M(this),Be&&I.call(this)),this},h.compatAPI=function(M){var Be=w===b;return Be&&I.call(this),typeof M!="function"||(M(this),Be&&j.call(this)),this},h.isAdvancedAPI=function(){return w===b};var S,E=function(M){if(w!==b)throw new Error(M+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=h.roundToPrecision=h.__private__.roundToPrecision=function(M,Be){var At=e||Be;if(isNaN(M)||isNaN(At))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return M.toFixed(At).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf=typeof c=="number"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,c)}:c==="smart"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,M>-1&&M<1?16:5)}:function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,16)};var k=h.f2=h.__private__.f2=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f2");return B(M,2)},P=h.__private__.f3=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f3");return B(M,3)},O=h.scale=h.__private__.scale=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.scale");return w===y?M*Te:w===b?M:void 0},z=function(M){return O(function(Be){return w===y?fo()-Be:w===b?Be:void 0}(M))};h.__private__.setPrecision=h.setPrecision=function(M){typeof parseInt(M,10)=="number"&&(e=parseInt(M,10))};var oe,ce="00000000000000000000000000000000",ue=h.__private__.getFileId=function(){return ce},ge=h.__private__.setFileId=function(M){return ce=M!==void 0&&/^[a-fA-F0-9]{32}$/.test(M)?M.toUpperCase():ce.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Xr=new Bx(d.userPermissions,d.userPassword,d.ownerPassword,ce)),ce};h.setFileId=function(M){return ge(M),this},h.getFileId=function(){return ue()};var ne=h.__private__.convertDateToPDFDate=function(M){var Be=M.getTimezoneOffset(),At=Be<0?"+":"-",Ct=Math.floor(Math.abs(Be/60)),Vt=Math.abs(Be%60),hr=[At,K(Ct),"'",K(Vt),"'"].join("");return["D:",M.getFullYear(),K(M.getMonth()+1),K(M.getDate()),K(M.getHours()),K(M.getMinutes()),K(M.getSeconds()),hr].join("")},Oe=h.__private__.convertPDFDateToDate=function(M){var Be=parseInt(M.substr(2,4),10),At=parseInt(M.substr(6,2),10)-1,Ct=parseInt(M.substr(8,2),10),Vt=parseInt(M.substr(10,2),10),hr=parseInt(M.substr(12,2),10),yr=parseInt(M.substr(14,2),10);return new Date(Be,At,Ct,Vt,hr,yr,0)},Ue=h.__private__.setCreationDate=function(M){var Be;if(M===void 0&&(M=new Date),M instanceof Date)Be=ne(M);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(M))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Be=M}return oe=Be},F=h.__private__.getCreationDate=function(M){var Be=oe;return M==="jsDate"&&(Be=Oe(oe)),Be};h.setCreationDate=function(M){return Ue(M),this},h.getCreationDate=function(M){return F(M)};var H,K=h.__private__.padd2=function(M){return("0"+parseInt(M)).slice(-2)},U=h.__private__.padd2Hex=function(M){return("00"+(M=M.toString())).substr(M.length)},W=0,X=[],D=[],V=0,Z=[],be=[],L=!1,Xe=D;h.__private__.setCustomOutputDestination=function(M){L=!0,Xe=M};var re=function(M){L||(Xe=M)};h.__private__.resetCustomOutputDestination=function(){L=!1,Xe=D};var J=h.__private__.out=function(M){return M=M.toString(),V+=M.length+1,Xe.push(M),Xe},De=h.__private__.write=function(M){return J(arguments.length===1?M.toString():Array.prototype.join.call(arguments," "))},ie=h.__private__.getArrayBuffer=function(M){for(var Be=M.length,At=new ArrayBuffer(Be),Ct=new Uint8Array(At);Be--;)Ct[Be]=M.charCodeAt(Be);return At},He=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return He};var Ge=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(M){return Ge=w===b?M/Te:M,this};var dt,_t=h.__private__.getFontSize=h.getFontSize=function(){return w===y?Ge:Ge*Te},Bt=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(M){return Bt=M,this},h.__private__.getR2L=h.getR2L=function(){return Bt};var Ot,jt=h.__private__.setZoomMode=function(M){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(M))dt=M;else if(isNaN(M)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(M)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+M+'" is not recognized.');dt=M}else dt=parseInt(M,10)};h.__private__.getZoomMode=function(){return dt};var Qt,Ft=h.__private__.setPageMode=function(M){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(M)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+M+'" is not recognized.');Ot=M};h.__private__.getPageMode=function(){return Ot};var $e=h.__private__.setLayoutMode=function(M){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(M)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+M+'" is not recognized.');Qt=M};h.__private__.getLayoutMode=function(){return Qt},h.__private__.setDisplayMode=h.setDisplayMode=function(M,Be,At){return jt(M),$e(Be),Ft(At),this};var Fe={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(M){if(Object.keys(Fe).indexOf(M)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Fe[M]},h.__private__.getDocumentProperties=function(){return Fe},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(M){for(var Be in Fe)Fe.hasOwnProperty(Be)&&M[Be]&&(Fe[Be]=M[Be]);return this},h.__private__.setDocumentProperty=function(M,Be){if(Object.keys(Fe).indexOf(M)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Fe[M]=Be};var Ze,Te,ee,me,Re,he={},qe={},st=[],yt={},pe={},je={},we={},Ye=null,xe=0,Se=[],xt=new _V(h),Pt=t.hotfixes||[],It={},Ut={},Ht=[],Le=function M(Be,At,Ct,Vt,hr,yr){if(!(this instanceof M))return new M(Be,At,Ct,Vt,hr,yr);isNaN(Be)&&(Be=1),isNaN(At)&&(At=0),isNaN(Ct)&&(Ct=0),isNaN(Vt)&&(Vt=1),isNaN(hr)&&(hr=0),isNaN(yr)&&(yr=0),this._matrix=[Be,At,Ct,Vt,hr,yr]};Object.defineProperty(Le.prototype,"sx",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(Le.prototype,"shy",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(Le.prototype,"shx",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(Le.prototype,"sy",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(Le.prototype,"tx",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(Le.prototype,"ty",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(Le.prototype,"a",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(Le.prototype,"b",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(Le.prototype,"c",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(Le.prototype,"d",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(Le.prototype,"e",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(Le.prototype,"f",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(Le.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Le.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Le.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Le.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Le.prototype.join=function(M){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(M)},Le.prototype.multiply=function(M){var Be=M.sx*this.sx+M.shy*this.shx,At=M.sx*this.shy+M.shy*this.sy,Ct=M.shx*this.sx+M.sy*this.shx,Vt=M.shx*this.shy+M.sy*this.sy,hr=M.tx*this.sx+M.ty*this.shx+this.tx,yr=M.tx*this.shy+M.ty*this.sy+this.ty;return new Le(Be,At,Ct,Vt,hr,yr)},Le.prototype.decompose=function(){var M=this.sx,Be=this.shy,At=this.shx,Ct=this.sy,Vt=this.tx,hr=this.ty,yr=Math.sqrt(M*M+Be*Be),sn=(M/=yr)*At+(Be/=yr)*Ct;At-=M*sn,Ct-=Be*sn;var hn=Math.sqrt(At*At+Ct*Ct);return sn/=hn,M*(Ct/=hn)<Be*(At/=hn)&&(M=-M,Be=-Be,sn=-sn,yr=-yr),{scale:new Le(yr,0,0,hn,0,0),translate:new Le(1,0,0,1,Vt,hr),rotate:new Le(M,Be,-Be,M,0,0),skew:new Le(1,0,sn,1,0,0)}},Le.prototype.toString=function(M){return this.join(" ")},Le.prototype.inversed=function(){var M=this.sx,Be=this.shy,At=this.shx,Ct=this.sy,Vt=this.tx,hr=this.ty,yr=1/(M*Ct-Be*At),sn=Ct*yr,hn=-Be*yr,Tn=-At*yr,Vn=M*yr;return new Le(sn,hn,Tn,Vn,-sn*Vt-Tn*hr,-hn*Vt-Vn*hr)},Le.prototype.applyToPoint=function(M){var Be=M.x*this.sx+M.y*this.shx+this.tx,At=M.x*this.shy+M.y*this.sy+this.ty;return new Ol(Be,At)},Le.prototype.applyToRectangle=function(M){var Be=this.applyToPoint(M),At=this.applyToPoint(new Ol(M.x+M.w,M.y+M.h));return new Zi(Be.x,Be.y,At.x-Be.x,At.y-Be.y)},Le.prototype.clone=function(){var M=this.sx,Be=this.shy,At=this.shx,Ct=this.sy,Vt=this.tx,hr=this.ty;return new Le(M,Be,At,Ct,Vt,hr)},h.Matrix=Le;var Ce=h.matrixMult=function(M,Be){return Be.multiply(M)},Ae=new Le(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Ae;var Qe=function(M,Be){if(!pe[M]){var At=(Be instanceof L0?"Sh":"P")+(Object.keys(yt).length+1).toString(10);Be.id=At,pe[M]=At,yt[At]=Be,xt.publish("addPattern",Be)}};h.ShadingPattern=L0,h.TilingPattern=_p,h.addShadingPattern=function(M,Be){return E("addShadingPattern()"),Qe(M,Be),this},h.beginTilingPattern=function(M){E("beginTilingPattern()"),Mc(M.boundingBox[0],M.boundingBox[1],M.boundingBox[2]-M.boundingBox[0],M.boundingBox[3]-M.boundingBox[1],M.matrix)},h.endTilingPattern=function(M,Be){E("endTilingPattern()"),Be.stream=be[H].join(`
`),Qe(M,Be),xt.publish("endTilingPattern",Be),Ht.pop().restore()};var fe,te=h.__private__.newObject=function(){var M=_e();return R(M,!0),M},_e=h.__private__.newObjectDeferred=function(){return W++,X[W]=function(){return V},W},R=function(M,Be){return Be=typeof Be=="boolean"&&Be,X[M]=V,Be&&J(M+" 0 obj"),M},Q=h.__private__.newAdditionalObject=function(){var M={objId:_e(),content:""};return Z.push(M),M},G=_e(),se=_e(),Ne=h.__private__.decodeColorString=function(M){var Be=M.split(" ");if(Be.length!==2||Be[1]!=="g"&&Be[1]!=="G")Be.length!==5||Be[4]!=="k"&&Be[4]!=="K"||(Be=[(1-Be[0])*(1-Be[3]),(1-Be[1])*(1-Be[3]),(1-Be[2])*(1-Be[3]),"r"]);else{var At=parseFloat(Be[0]);Be=[At,At,At,"r"]}for(var Ct="#",Vt=0;Vt<3;Vt++)Ct+=("0"+Math.floor(255*parseFloat(Be[Vt])).toString(16)).slice(-2);return Ct},Me=h.__private__.encodeColorString=function(M){var Be;typeof M=="string"&&(M={ch1:M});var At=M.ch1,Ct=M.ch2,Vt=M.ch3,hr=M.ch4,yr=M.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof At=="string"&&At.charAt(0)!=="#"){var sn=new Ire(At);if(sn.ok)At=sn.toHex();else if(!/^\d*\.?\d*$/.test(At))throw new Error('Invalid color "'+At+'" passed to jsPDF.encodeColorString.')}if(typeof At=="string"&&/^#[0-9A-Fa-f]{3}$/.test(At)&&(At="#"+At[1]+At[1]+At[2]+At[2]+At[3]+At[3]),typeof At=="string"&&/^#[0-9A-Fa-f]{6}$/.test(At)){var hn=parseInt(At.substr(1),16);At=hn>>16&255,Ct=hn>>8&255,Vt=255&hn}if(Ct===void 0||hr===void 0&&At===Ct&&Ct===Vt)Be=typeof At=="string"?At+" "+yr[0]:M.precision===2?k(At/255)+" "+yr[0]:P(At/255)+" "+yr[0];else if(hr===void 0||es(hr)==="object"){if(hr&&!isNaN(hr.a)&&hr.a===0)return["1.","1.","1.",yr[1]].join(" ");Be=typeof At=="string"?[At,Ct,Vt,yr[1]].join(" "):M.precision===2?[k(At/255),k(Ct/255),k(Vt/255),yr[1]].join(" "):[P(At/255),P(Ct/255),P(Vt/255),yr[1]].join(" ")}else Be=typeof At=="string"?[At,Ct,Vt,hr,yr[2]].join(" "):M.precision===2?[k(At),k(Ct),k(Vt),k(hr),yr[2]].join(" "):[P(At),P(Ct),P(Vt),P(hr),yr[2]].join(" ");return Be},ze=h.__private__.getFilters=function(){return o},Ie=h.__private__.putStream=function(M){var Be=(M=M||{}).data||"",At=M.filters||ze(),Ct=M.alreadyAppliedFilters||[],Vt=M.addLength1||!1,hr=Be.length,yr=M.objectId,sn=function(pi){return pi};if(d!==null&&yr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(sn=Xr.encryptor(yr,0));var hn={};At===!0&&(At=["FlateEncode"]);var Tn=M.additionalKeyValues||[],Vn=(hn=an.API.processDataByFilters!==void 0?an.API.processDataByFilters(Be,At):{data:Be,reverseChain:[]}).reverseChain+(Array.isArray(Ct)?Ct.join(" "):Ct.toString());if(hn.data.length!==0&&(Tn.push({key:"Length",value:hn.data.length}),Vt===!0&&Tn.push({key:"Length1",value:hr})),Vn.length!=0)if(Vn.split("/").length-1==1)Tn.push({key:"Filter",value:Vn});else{Tn.push({key:"Filter",value:"["+Vn+"]"});for(var da=0;da<Tn.length;da+=1)if(Tn[da].key==="DecodeParms"){for(var ka=[],Ys=0;Ys<hn.reverseChain.split("/").length-1;Ys+=1)ka.push("null");ka.push(Tn[da].value),Tn[da].value="["+ka.join(" ")+"]"}}J("<<");for(var Va=0;Va<Tn.length;Va++)J("/"+Tn[Va].key+" "+Tn[Va].value);J(">>"),hn.data.length!==0&&(J("stream"),J(sn(hn.data)),J("endstream"))},nt=h.__private__.putPage=function(M){var Be=M.number,At=M.data,Ct=M.objId,Vt=M.contentsObjId;R(Ct,!0),J("<</Type /Page"),J("/Parent "+M.rootDictionaryObjId+" 0 R"),J("/Resources "+M.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(S(M.mediaBox.bottomLeftX))+" "+parseFloat(S(M.mediaBox.bottomLeftY))+" "+S(M.mediaBox.topRightX)+" "+S(M.mediaBox.topRightY)+"]"),M.cropBox!==null&&J("/CropBox ["+S(M.cropBox.bottomLeftX)+" "+S(M.cropBox.bottomLeftY)+" "+S(M.cropBox.topRightX)+" "+S(M.cropBox.topRightY)+"]"),M.bleedBox!==null&&J("/BleedBox ["+S(M.bleedBox.bottomLeftX)+" "+S(M.bleedBox.bottomLeftY)+" "+S(M.bleedBox.topRightX)+" "+S(M.bleedBox.topRightY)+"]"),M.trimBox!==null&&J("/TrimBox ["+S(M.trimBox.bottomLeftX)+" "+S(M.trimBox.bottomLeftY)+" "+S(M.trimBox.topRightX)+" "+S(M.trimBox.topRightY)+"]"),M.artBox!==null&&J("/ArtBox ["+S(M.artBox.bottomLeftX)+" "+S(M.artBox.bottomLeftY)+" "+S(M.artBox.topRightX)+" "+S(M.artBox.topRightY)+"]"),typeof M.userUnit=="number"&&M.userUnit!==1&&J("/UserUnit "+M.userUnit),xt.publish("putPage",{objId:Ct,pageContext:Se[Be],pageNumber:Be,page:At}),J("/Contents "+Vt+" 0 R"),J(">>"),J("endobj");var hr=At.join(`
`);return w===b&&(hr+=`
Q`),R(Vt,!0),Ie({data:hr,filters:ze(),objectId:Vt}),J("endobj"),Ct},lt=h.__private__.putPages=function(){var M,Be,At=[];for(M=1;M<=xe;M++)Se[M].objId=_e(),Se[M].contentsObjId=_e();for(M=1;M<=xe;M++)At.push(nt({number:M,data:be[M],objId:Se[M].objId,contentsObjId:Se[M].contentsObjId,mediaBox:Se[M].mediaBox,cropBox:Se[M].cropBox,bleedBox:Se[M].bleedBox,trimBox:Se[M].trimBox,artBox:Se[M].artBox,userUnit:Se[M].userUnit,rootDictionaryObjId:G,resourceDictionaryObjId:se}));R(G,!0),J("<</Type /Pages");var Ct="/Kids [";for(Be=0;Be<xe;Be++)Ct+=At[Be]+" 0 R ";J(Ct+"]"),J("/Count "+xe),J(">>"),J("endobj"),xt.publish("postPutPages")},ht=function(M){xt.publish("putFont",{font:M,out:J,newObject:te,putStream:Ie}),M.isAlreadyPutted!==!0&&(M.objectNumber=te(),J("<<"),J("/Type /Font"),J("/BaseFont /"+Tx(M.postScriptName)),J("/Subtype /Type1"),typeof M.encoding=="string"&&J("/Encoding /"+M.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},kt=function(M){M.objectNumber=te();var Be=[];Be.push({key:"Type",value:"/XObject"}),Be.push({key:"Subtype",value:"/Form"}),Be.push({key:"BBox",value:"["+[S(M.x),S(M.y),S(M.x+M.width),S(M.y+M.height)].join(" ")+"]"}),Be.push({key:"Matrix",value:"["+M.matrix.toString()+"]"});var At=M.pages[1].join(`
`);Ie({data:At,additionalKeyValues:Be,objectId:M.objectNumber}),J("endobj")},le=function(M,Be){Be||(Be=21);var At=te(),Ct=function(yr,sn){var hn,Tn=[],Vn=1/(sn-1);for(hn=0;hn<1;hn+=Vn)Tn.push(hn);if(Tn.push(1),yr[0].offset!=0){var da={offset:0,color:yr[0].color};yr.unshift(da)}if(yr[yr.length-1].offset!=1){var ka={offset:1,color:yr[yr.length-1].color};yr.push(ka)}for(var Ys="",Va=0,pi=0;pi<Tn.length;pi++){for(hn=Tn[pi];hn>yr[Va+1].offset;)Va++;var Js=yr[Va].offset,gi=(hn-Js)/(yr[Va+1].offset-Js),Zs=yr[Va].color,Uc=yr[Va+1].color;Ys+=U(Math.round((1-gi)*Zs[0]+gi*Uc[0]).toString(16))+U(Math.round((1-gi)*Zs[1]+gi*Uc[1]).toString(16))+U(Math.round((1-gi)*Zs[2]+gi*Uc[2]).toString(16))}return Ys.trim()}(M.colors,Be),Vt=[];Vt.push({key:"FunctionType",value:"0"}),Vt.push({key:"Domain",value:"[0.0 1.0]"}),Vt.push({key:"Size",value:"["+Be+"]"}),Vt.push({key:"BitsPerSample",value:"8"}),Vt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Vt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ie({data:Ct,additionalKeyValues:Vt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:At}),J("endobj"),M.objectNumber=te(),J("<< /ShadingType "+M.type),J("/ColorSpace /DeviceRGB");var hr="/Coords ["+S(parseFloat(M.coords[0]))+" "+S(parseFloat(M.coords[1]))+" ";M.type===2?hr+=S(parseFloat(M.coords[2]))+" "+S(parseFloat(M.coords[3])):hr+=S(parseFloat(M.coords[2]))+" "+S(parseFloat(M.coords[3]))+" "+S(parseFloat(M.coords[4]))+" "+S(parseFloat(M.coords[5])),J(hr+="]"),M.matrix&&J("/Matrix ["+M.matrix.toString()+"]"),J("/Function "+At+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},We=function(M,Be){var At=_e(),Ct=te();Be.push({resourcesOid:At,objectOid:Ct}),M.objectNumber=Ct;var Vt=[];Vt.push({key:"Type",value:"/Pattern"}),Vt.push({key:"PatternType",value:"1"}),Vt.push({key:"PaintType",value:"1"}),Vt.push({key:"TilingType",value:"1"}),Vt.push({key:"BBox",value:"["+M.boundingBox.map(S).join(" ")+"]"}),Vt.push({key:"XStep",value:S(M.xStep)}),Vt.push({key:"YStep",value:S(M.yStep)}),Vt.push({key:"Resources",value:At+" 0 R"}),M.matrix&&Vt.push({key:"Matrix",value:"["+M.matrix.toString()+"]"}),Ie({data:M.stream,additionalKeyValues:Vt,objectId:M.objectNumber}),J("endobj")},it=function(M){for(var Be in M.objectNumber=te(),J("<<"),M)switch(Be){case"opacity":J("/ca "+k(M[Be]));break;case"stroke-opacity":J("/CA "+k(M[Be]))}J(">>"),J("endobj")},ot=function(M){R(M.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var Be in J("/Font <<"),he)he.hasOwnProperty(Be)&&(f===!1||f===!0&&A.hasOwnProperty(Be))&&J("/"+Be+" "+he[Be].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(yt).length>0){for(var Be in J("/Shading <<"),yt)yt.hasOwnProperty(Be)&&yt[Be]instanceof L0&&yt[Be].objectNumber>=0&&J("/"+Be+" "+yt[Be].objectNumber+" 0 R");xt.publish("putShadingPatternDict"),J(">>")}}(),function(Be){if(Object.keys(yt).length>0){for(var At in J("/Pattern <<"),yt)yt.hasOwnProperty(At)&&yt[At]instanceof h.TilingPattern&&yt[At].objectNumber>=0&&yt[At].objectNumber<Be&&J("/"+At+" "+yt[At].objectNumber+" 0 R");xt.publish("putTilingPatternDict"),J(">>")}}(M.objectOid),function(){if(Object.keys(je).length>0){var Be;for(Be in J("/ExtGState <<"),je)je.hasOwnProperty(Be)&&je[Be].objectNumber>=0&&J("/"+Be+" "+je[Be].objectNumber+" 0 R");xt.publish("putGStateDict"),J(">>")}}(),function(){for(var Be in J("/XObject <<"),It)It.hasOwnProperty(Be)&&It[Be].objectNumber>=0&&J("/"+Be+" "+It[Be].objectNumber+" 0 R");xt.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},Nt=function(M){qe[M.fontName]=qe[M.fontName]||{},qe[M.fontName][M.fontStyle]=M.id},Rt=function(M,Be,At,Ct,Vt){var hr={id:"F"+(Object.keys(he).length+1).toString(10),postScriptName:M,fontName:Be,fontStyle:At,encoding:Ct,isStandardFont:Vt||!1,metadata:{}};return xt.publish("addFont",{font:hr,instance:this}),he[hr.id]=hr,Nt(hr),hr.id},nr=h.__private__.pdfEscape=h.pdfEscape=function(M,Be){return function(At,Ct){var Vt,hr,yr,sn,hn,Tn,Vn,da,ka;if(yr=(Ct=Ct||{}).sourceEncoding||"Unicode",hn=Ct.outputEncoding,(Ct.autoencode||hn)&&he[Ze].metadata&&he[Ze].metadata[yr]&&he[Ze].metadata[yr].encoding&&(sn=he[Ze].metadata[yr].encoding,!hn&&he[Ze].encoding&&(hn=he[Ze].encoding),!hn&&sn.codePages&&(hn=sn.codePages[0]),typeof hn=="string"&&(hn=sn[hn]),hn)){for(Vn=!1,Tn=[],Vt=0,hr=At.length;Vt<hr;Vt++)(da=hn[At.charCodeAt(Vt)])?Tn.push(String.fromCharCode(da)):Tn.push(At[Vt]),Tn[Vt].charCodeAt(0)>>8&&(Vn=!0);At=Tn.join("")}for(Vt=At.length;Vn===void 0&&Vt!==0;)At.charCodeAt(Vt-1)>>8&&(Vn=!0),Vt--;if(!Vn)return At;for(Tn=Ct.noBOM?[]:[254,255],Vt=0,hr=At.length;Vt<hr;Vt++){if((ka=(da=At.charCodeAt(Vt))>>8)>>8)throw new Error("Character at position "+Vt+" of string '"+At+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Tn.push(ka),Tn.push(da-(ka<<8))}return String.fromCharCode.apply(void 0,Tn)}(M,Be).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_r=h.__private__.beginPage=function(M){be[++xe]=[],Se[xe]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(M[0]),topRightY:Number(M[1])}},kr(xe),re(be[H])},$r=function(M,Be){var At,Ct,Vt;switch(r=Be||r,typeof M=="string"&&(At=v(M.toLowerCase()),Array.isArray(At)&&(Ct=At[0],Vt=At[1])),Array.isArray(M)&&(Ct=M[0]*Te,Vt=M[1]*Te),isNaN(Ct)&&(Ct=a[0],Vt=a[1]),(Ct>14400||Vt>14400)&&(hs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ct=Math.min(14400,Ct),Vt=Math.min(14400,Vt)),a=[Ct,Vt],r.substr(0,1)){case"l":Vt>Ct&&(a=[Vt,Ct]);break;case"p":Ct>Vt&&(a=[Vt,Ct])}_r(a),Dt(vr),J(xn),xa!==0&&J(xa+" J"),Qn!==0&&J(Qn+" j"),xt.publish("addPage",{pageNumber:xe})},or=function(M){M>0&&M<=xe&&(be.splice(M,1),Se.splice(M,1),xe--,H>xe&&(H=xe),this.setPage(H))},kr=function(M){M>0&&M<=xe&&(H=M)},en=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return be.length-1},rn=function(M,Be,At){var Ct,Vt=void 0;return At=At||{},M=M!==void 0?M:he[Ze].fontName,Be=Be!==void 0?Be:he[Ze].fontStyle,Ct=M.toLowerCase(),qe[Ct]!==void 0&&qe[Ct][Be]!==void 0?Vt=qe[Ct][Be]:qe[M]!==void 0&&qe[M][Be]!==void 0?Vt=qe[M][Be]:At.disableWarning===!1&&hs.warn("Unable to look up font label for font '"+M+"', '"+Be+"'. Refer to getFontList() for available fonts."),Vt||At.noFallback||(Vt=qe.times[Be])==null&&(Vt=qe.times.normal),Vt},Er=h.__private__.putInfo=function(){var M=te(),Be=function(Ct){return Ct};for(var At in d!==null&&(Be=Xr.encryptor(M,0)),J("<<"),J("/Producer ("+nr(Be("jsPDF "+an.version))+")"),Fe)Fe.hasOwnProperty(At)&&Fe[At]&&J("/"+At.substr(0,1).toUpperCase()+At.substr(1)+" ("+nr(Be(Fe[At]))+")");J("/CreationDate ("+nr(Be(oe))+")"),J(">>"),J("endobj")},Ee=h.__private__.putCatalog=function(M){var Be=(M=M||{}).rootDictionaryObjId||G;switch(te(),J("<<"),J("/Type /Catalog"),J("/Pages "+Be+" 0 R"),dt||(dt="fullwidth"),dt){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var At=""+dt;At.substr(At.length-1)==="%"&&(dt=parseInt(dt)/100),typeof dt=="number"&&J("/OpenAction [3 0 R /XYZ null null "+k(dt)+"]")}switch(Qt||(Qt="continuous"),Qt){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}Ot&&J("/PageMode /"+Ot),xt.publish("putCatalog"),J(">>"),J("endobj")},gt=h.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(W+1)),J("/Root "+W+" 0 R"),J("/Info "+(W-1)+" 0 R"),d!==null&&J("/Encrypt "+Xr.oid+" 0 R"),J("/ID [ <"+ce+"> <"+ce+"> ]"),J(">>")},Zt=h.__private__.putHeader=function(){J("%PDF-"+m),J("%")},Mr=h.__private__.putXRef=function(){var M="0000000000";J("xref"),J("0 "+(W+1)),J("0000000000 65535 f ");for(var Be=1;Be<=W;Be++)typeof X[Be]=="function"?J((M+X[Be]()).slice(-10)+" 00000 n "):X[Be]!==void 0?J((M+X[Be]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},Or=h.__private__.buildDocument=function(){var M;W=0,V=0,D=[],X=[],Z=[],G=_e(),se=_e(),re(D),xt.publish("buildDocument"),Zt(),lt(),function(){xt.publish("putAdditionalObjects");for(var At=0;At<Z.length;At++){var Ct=Z[At];R(Ct.objId,!0),J(Ct.content),J("endobj")}xt.publish("postPutAdditionalObjects")}(),M=[],function(){for(var At in he)he.hasOwnProperty(At)&&(f===!1||f===!0&&A.hasOwnProperty(At))&&ht(he[At])}(),function(){var At;for(At in je)je.hasOwnProperty(At)&&it(je[At])}(),function(){for(var At in It)It.hasOwnProperty(At)&&kt(It[At])}(),function(At){var Ct;for(Ct in yt)yt.hasOwnProperty(Ct)&&(yt[Ct]instanceof L0?le(yt[Ct]):yt[Ct]instanceof _p&&We(yt[Ct],At))}(M),xt.publish("putResources"),M.forEach(ot),ot({resourcesOid:se,objectOid:Number.MAX_SAFE_INTEGER}),xt.publish("postPutResources"),d!==null&&(Xr.oid=te(),J("<<"),J("/Filter /Standard"),J("/V "+Xr.v),J("/R "+Xr.r),J("/U <"+Xr.toHexString(Xr.U)+">"),J("/O <"+Xr.toHexString(Xr.O)+">"),J("/P "+Xr.P),J(">>"),J("endobj")),Er(),Ee();var Be=V;return Mr(),gt(),J("startxref"),J(""+Be),J("%%EOF"),re(be[H]),D.join(`
`)},ir=h.__private__.getBlob=function(M){return new Blob([ie(M)],{type:"application/pdf"})},br=h.output=h.__private__.output=(fe=function(M,Be){switch(typeof(Be=Be||{})=="string"?Be={filename:Be}:Be.filename=Be.filename||"generated.pdf",M){case void 0:return Or();case"save":h.save(Be.filename);break;case"arraybuffer":return ie(Or());case"blob":return ir(Or());case"bloburi":case"bloburl":if(Mn.URL!==void 0&&typeof Mn.URL.createObjectURL=="function")return Mn.URL&&Mn.URL.createObjectURL(ir(Or()))||void 0;hs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var At="",Ct=Or();try{At=wV(Ct)}catch{At=wV(unescape(encodeURIComponent(Ct)))}return"data:application/pdf;filename="+Be.filename+";base64,"+At;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Mn)==="[object Window]"){var Vt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",hr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Be.pdfObjectUrl&&(Vt=Be.pdfObjectUrl,hr="");var yr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Vt+'"'+hr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Be)+");<\/script></body></html>",sn=Mn.open();return sn!==null&&sn.document.write(yr),sn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Mn)==="[object Window]"){var hn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Be.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Be.filename+'" width="500px" height="400px" /></body></html>',Tn=Mn.open();if(Tn!==null){Tn.document.write(hn);var Vn=this;Tn.document.documentElement.querySelector("#pdfViewer").onload=function(){Tn.document.title=Be.filename,Tn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Vn.output("bloburl"))}}return Tn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Mn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var da='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Be)+'"></iframe></body></html>',ka=Mn.open();if(ka!==null&&(ka.document.write(da),ka.document.title=Be.filename),ka||typeof safari>"u")return ka;break;case"datauri":case"dataurl":return Mn.document.location.href=this.output("datauristring",Be);default:return null}},fe.foo=function(){try{return fe.apply(this,arguments)}catch(At){var M=At.stack||"";~M.indexOf(" at ")&&(M=M.split(" at ")[1]);var Be="Error in function "+M.split(`
`)[0].split("<")[0]+": "+At.message;if(!Mn.console)throw new Error(Be);Mn.console.error(Be,At),Mn.alert&&alert(Be)}},fe.foo.bar=fe,fe.foo),wr=function(M){return Array.isArray(Pt)===!0&&Pt.indexOf(M)>-1};switch(n){case"pt":Te=1;break;case"mm":Te=72/25.4;break;case"cm":Te=72/2.54;break;case"in":Te=72;break;case"px":Te=wr("px_scaling")==1?.75:96/72;break;case"pc":case"em":Te=12;break;case"ex":Te=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Te=n}var Xr=null;Ue(),ge();var Ir=h.__private__.getPageInfo=h.getPageInfo=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Se[M].objId,pageNumber:M,pageContext:Se[M]}},Pr=h.__private__.getPageInfoByObjId=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Be in Se)if(Se[Be].objId===M)break;return Ir(Be)},fn=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Se[H].objId,pageNumber:H,pageContext:Se[H]}};h.addPage=function(){return $r.apply(this,arguments),this},h.setPage=function(){return kr.apply(this,arguments),re.call(this,be[H]),this},h.insertPage=function(M){return this.addPage(),this.movePage(H,M),this},h.movePage=function(M,Be){var At,Ct;if(M>Be){At=be[M],Ct=Se[M];for(var Vt=M;Vt>Be;Vt--)be[Vt]=be[Vt-1],Se[Vt]=Se[Vt-1];be[Be]=At,Se[Be]=Ct,this.setPage(Be)}else if(M<Be){At=be[M],Ct=Se[M];for(var hr=M;hr<Be;hr++)be[hr]=be[hr+1],Se[hr]=Se[hr+1];be[Be]=At,Se[Be]=Ct,this.setPage(Be)}return this},h.deletePage=function(){return or.apply(this,arguments),this},h.__private__.text=h.text=function(M,Be,At,Ct,Vt){var hr,yr,sn,hn,Tn,Vn,da,ka,Ys,Va=(Ct=Ct||{}).scope||this;if(typeof M=="number"&&typeof Be=="number"&&(typeof At=="string"||Array.isArray(At))){var pi=At;At=Be,Be=M,M=pi}if(arguments[3]instanceof Le==0?(sn=arguments[4],hn=arguments[5],es(da=arguments[3])==="object"&&da!==null||(typeof sn=="string"&&(hn=sn,sn=null),typeof da=="string"&&(hn=da,da=null),typeof da=="number"&&(sn=da,da=null),Ct={flags:da,angle:sn,align:hn})):(E("The transform parameter of text() with a Matrix value"),Ys=Vt),isNaN(Be)||isNaN(At)||M==null)throw new Error("Invalid arguments passed to jsPDF.text");if(M.length===0)return Va;var Js,gi="",Zs=typeof Ct.lineHeightFactor=="number"?Ct.lineHeightFactor:ar,Uc=Va.internal.scaleFactor;function Wu(Ma){return Ma=Ma.split("	").join(Array(Ct.TabLen||9).join(" ")),nr(Ma,da)}function Xu(Ma){for(var ds,Ti=Ma.concat(),ho=[],bh=Ti.length;bh--;)typeof(ds=Ti.shift())=="string"?ho.push(ds):Array.isArray(Ma)&&(ds.length===1||ds[1]===void 0&&ds[2]===void 0)?ho.push(ds[0]):ho.push([ds[0],ds[1],ds[2]]);return ho}function C(Ma,ds){var Ti;if(typeof Ma=="string")Ti=ds(Ma)[0];else if(Array.isArray(Ma)){for(var ho,bh,U1=Ma.concat(),Wg=[],xN=U1.length;xN--;)typeof(ho=U1.shift())=="string"?Wg.push(ds(ho)[0]):Array.isArray(ho)&&typeof ho[0]=="string"&&(bh=ds(ho[0],ho[1],ho[2]),Wg.push([bh[0],bh[1],bh[2]]));Ti=Wg}return Ti}var Y=!1,ve=!0;if(typeof M=="string")Y=!0;else if(Array.isArray(M)){var et=M.concat();yr=[];for(var Kt,rr=et.length;rr--;)(typeof(Kt=et.shift())!="string"||Array.isArray(Kt)&&typeof Kt[0]!="string")&&(ve=!1);Y=ve}if(Y===!1)throw new Error('Type of text must be string or Array. "'+M+'" is not recognized.');typeof M=="string"&&(M=M.match(/[\r?\n]/)?M.split(/\r\n|\r|\n/g):[M]);var Lr=Ge/Va.internal.scaleFactor,ma=Lr*(Zs-1);switch(Ct.baseline){case"bottom":At-=ma;break;case"top":At+=Lr-ma;break;case"hanging":At+=Lr-2*ma;break;case"middle":At+=Lr/2-ma}if((Vn=Ct.maxWidth||0)>0&&(typeof M=="string"?M=Va.splitTextToSize(M,Vn):Object.prototype.toString.call(M)==="[object Array]"&&(M=M.reduce(function(Ma,ds){return Ma.concat(Va.splitTextToSize(ds,Vn))},[]))),hr={text:M,x:Be,y:At,options:Ct,mutex:{pdfEscape:nr,activeFontKey:Ze,fonts:he,activeFontSize:Ge}},xt.publish("preProcessText",hr),M=hr.text,sn=(Ct=hr.options).angle,Ys instanceof Le==0&&sn&&typeof sn=="number"){sn*=Math.PI/180,Ct.rotationDirection===0&&(sn=-sn),w===b&&(sn=-sn);var ei=Math.cos(sn),na=Math.sin(sn);Ys=new Le(ei,na,-na,ei,0,0)}else sn&&sn instanceof Le&&(Ys=sn);w!==b||Ys||(Ys=Ae),(Tn=Ct.charSpace||Ji)!==void 0&&(gi+=S(O(Tn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ka=Ct.horizontalScale)!==void 0&&(gi+=S(100*ka)+` Tz
`),Ct.lang;var Sa=-1,gs=Ct.renderingMode!==void 0?Ct.renderingMode:Ct.stroke,hu=Va.internal.getCurrentPageInfo().pageContext;switch(gs){case 0:case!1:case"fill":Sa=0;break;case 1:case!0:case"stroke":Sa=1;break;case 2:case"fillThenStroke":Sa=2;break;case 3:case"invisible":Sa=3;break;case 4:case"fillAndAddForClipping":Sa=4;break;case 5:case"strokeAndAddPathForClipping":Sa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Sa=6;break;case 7:case"addToPathForClipping":Sa=7}var Dl=hu.usedRenderingMode!==void 0?hu.usedRenderingMode:-1;Sa!==-1?gi+=Sa+` Tr
`:Dl!==-1&&(gi+=`0 Tr
`),Sa!==-1&&(hu.usedRenderingMode=Sa),hn=Ct.align||"left";var cl,$d=Ge*Zs,k1=Va.internal.pageSize.getWidth(),F1=he[Ze];Tn=Ct.charSpace||Ji,Vn=Ct.maxWidth||0,da=Object.assign({autoencode:!0,noBOM:!0},Ct.flags);var qA=[],Km=function(Ma){return Va.getStringUnitWidth(Ma,{font:F1,charSpace:Tn,fontSize:Ge,doKerning:!1})*Ge/Uc};if(Object.prototype.toString.call(M)==="[object Array]"){var Au;yr=Xu(M),hn!=="left"&&(cl=yr.map(Km));var mu,zA=0;if(hn==="right"){Be-=cl[0],M=[],rr=yr.length;for(var yh=0;yh<rr;yh++)yh===0?(mu=pr(Be),Au=jr(At)):(mu=O(zA-cl[yh]),Au=-$d),M.push([yr[yh],mu,Au]),zA=cl[yh]}else if(hn==="center"){Be-=cl[0]/2,M=[],rr=yr.length;for(var WA=0;WA<rr;WA++)WA===0?(mu=pr(Be),Au=jr(At)):(mu=O((zA-cl[WA])/2),Au=-$d),M.push([yr[WA],mu,Au]),zA=cl[WA]}else if(hn==="left"){M=[],rr=yr.length;for(var O1=0;O1<rr;O1++)M.push(yr[O1])}else if(hn==="justify"&&F1.encoding==="Identity-H"){M=[],rr=yr.length,Vn=Vn!==0?Vn:k1;for(var zg=0,Bi=0;Bi<rr;Bi++)if(Au=Bi===0?jr(At):-$d,mu=Bi===0?pr(Be):zg,Bi<rr-1){var gN=O((Vn-cl[Bi])/(yr[Bi].split(" ").length-1)),Tf=yr[Bi].split(" ");M.push([Tf[0]+" ",mu,Au]),zg=0;for(var kf=1;kf<Tf.length;kf++){var D1=(Km(Tf[kf-1]+" "+Tf[kf])-Km(Tf[kf]))*Uc+gN;kf==Tf.length-1?M.push([Tf[kf],D1,0]):M.push([Tf[kf]+" ",D1,0]),zg-=D1}}else M.push([yr[Bi],mu,Au]);M.push(["",zg,0])}else{if(hn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(M=[],rr=yr.length,Vn=Vn!==0?Vn:k1,Bi=0;Bi<rr;Bi++){Au=Bi===0?jr(At):-$d,mu=Bi===0?pr(Be):0;var R1=yr[Bi].split(" ").length-1,M1=R1>0?(Vn-cl[Bi])/R1:0;Bi<rr-1?qA.push(S(O(M1))):qA.push(0),M.push([yr[Bi],mu,Au])}}}(typeof Ct.R2L=="boolean"?Ct.R2L:Bt)===!0&&(M=C(M,function(Ma,ds,Ti){return[Ma.split("").reverse().join(""),ds,Ti]})),hr={text:M,x:Be,y:At,options:Ct,mutex:{pdfEscape:nr,activeFontKey:Ze,fonts:he,activeFontSize:Ge}},xt.publish("postProcessText",hr),M=hr.text,Js=hr.mutex.isHex||!1;var L1=he[Ze].encoding;L1!=="WinAnsiEncoding"&&L1!=="StandardEncoding"||(M=C(M,function(Ma,ds,Ti){return[Wu(Ma),ds,Ti]})),yr=Xu(M),M=[];for(var XA,YA,JA,Gm=Array.isArray(yr[0])?1:0,ZA="",qm=function(Ma,ds,Ti){var ho="";return Ti instanceof Le?(Ti=typeof Ct.angle=="number"?Ce(Ti,new Le(1,0,0,1,Ma,ds)):Ce(new Le(1,0,0,1,Ma,ds),Ti),w===b&&(Ti=Ce(new Le(1,0,0,-1,0,0),Ti)),ho=Ti.join(" ")+` Tm
`):ho=S(Ma)+" "+S(ds)+` Td
`,ho},Yu=0;Yu<yr.length;Yu++){switch(ZA="",Gm){case 1:JA=(Js?"<":"(")+yr[Yu][0]+(Js?">":")"),XA=parseFloat(yr[Yu][1]),YA=parseFloat(yr[Yu][2]);break;case 0:JA=(Js?"<":"(")+yr[Yu]+(Js?">":")"),XA=pr(Be),YA=jr(At)}qA!==void 0&&qA[Yu]!==void 0&&(ZA=qA[Yu]+` Tw
`),Yu===0?M.push(ZA+qm(XA,YA,Ys)+JA):Gm===0?M.push(ZA+JA):Gm===1&&M.push(ZA+qm(XA,YA,Ys)+JA)}M=Gm===0?M.join(` Tj
T* `):M.join(` Tj
`),M+=` Tj
`;var Ff=`BT
/`;return Ff+=Ze+" "+Ge+` Tf
`,Ff+=S(Ge*Zs)+` TL
`,Ff+=ga+`
`,Ff+=gi,Ff+=M,J(Ff+="ET"),A[Ze]=!0,Va};var de=h.__private__.clip=h.clip=function(M){return J(M==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return de("evenodd")},h.__private__.discardPath=h.discardPath=function(){return J("n"),this};var tt=h.__private__.isValidStyle=function(M){var Be=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(M)!==-1&&(Be=!0),Be};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(M){return tt(M)&&(u=M),this};var at=h.__private__.getStyle=h.getStyle=function(M){var Be=u;switch(M){case"D":case"S":Be="S";break;case"F":Be="f";break;case"FD":case"DF":Be="B";break;case"f":case"f*":case"B":case"B*":Be=M}return Be},ct=h.close=function(){return J("h"),this};h.stroke=function(){return J("S"),this},h.fill=function(M){return ye("f",M),this},h.fillEvenOdd=function(M){return ye("f*",M),this},h.fillStroke=function(M){return ye("B",M),this},h.fillStrokeEvenOdd=function(M){return ye("B*",M),this};var ye=function(M,Be){es(Be)==="object"?wt(Be,M):J(M)},ft=function(M){M===null||w===b&&M===void 0||(M=at(M),J(M))};function St(M,Be,At,Ct,Vt){var hr=new _p(Be||this.boundingBox,At||this.xStep,Ct||this.yStep,this.gState,Vt||this.matrix);hr.stream=this.stream;var yr=M+"$$"+this.cloneIndex+++"$$";return Qe(yr,hr),hr}var wt=function(M,Be){var At=pe[M.key],Ct=yt[At];if(Ct instanceof L0)J("q"),J(vt(Be)),Ct.gState&&h.setGState(Ct.gState),J(M.matrix.toString()+" cm"),J("/"+At+" sh"),J("Q");else if(Ct instanceof _p){var Vt=new Le(1,0,0,-1,0,fo());M.matrix&&(Vt=Vt.multiply(M.matrix||Ae),At=St.call(Ct,M.key,M.boundingBox,M.xStep,M.yStep,Vt).id),J("q"),J("/Pattern cs"),J("/"+At+" scn"),Ct.gState&&h.setGState(Ct.gState),J(Be),J("Q")}},vt=function(M){switch(M){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Et=h.moveTo=function(M,Be){return J(S(O(M))+" "+S(z(Be))+" m"),this},qt=h.lineTo=function(M,Be){return J(S(O(M))+" "+S(z(Be))+" l"),this},Mt=h.curveTo=function(M,Be,At,Ct,Vt,hr){return J([S(O(M)),S(z(Be)),S(O(At)),S(z(Ct)),S(O(Vt)),S(z(hr)),"c"].join(" ")),this};h.__private__.line=h.line=function(M,Be,At,Ct,Vt){if(isNaN(M)||isNaN(Be)||isNaN(At)||isNaN(Ct)||!tt(Vt))throw new Error("Invalid arguments passed to jsPDF.line");return w===y?this.lines([[At-M,Ct-Be]],M,Be,[1,1],Vt||"S"):this.lines([[At-M,Ct-Be]],M,Be,[1,1]).stroke()},h.__private__.lines=h.lines=function(M,Be,At,Ct,Vt,hr){var yr,sn,hn,Tn,Vn,da,ka,Ys,Va,pi,Js,gi;if(typeof M=="number"&&(gi=At,At=Be,Be=M,M=gi),Ct=Ct||[1,1],hr=hr||!1,isNaN(Be)||isNaN(At)||!Array.isArray(M)||!Array.isArray(Ct)||!tt(Vt)||typeof hr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Et(Be,At),yr=Ct[0],sn=Ct[1],Tn=M.length,pi=Be,Js=At,hn=0;hn<Tn;hn++)(Vn=M[hn]).length===2?(pi=Vn[0]*yr+pi,Js=Vn[1]*sn+Js,qt(pi,Js)):(da=Vn[0]*yr+pi,ka=Vn[1]*sn+Js,Ys=Vn[2]*yr+pi,Va=Vn[3]*sn+Js,pi=Vn[4]*yr+pi,Js=Vn[5]*sn+Js,Mt(da,ka,Ys,Va,pi,Js));return hr&&ct(),ft(Vt),this},h.path=function(M){for(var Be=0;Be<M.length;Be++){var At=M[Be],Ct=At.c;switch(At.op){case"m":Et(Ct[0],Ct[1]);break;case"l":qt(Ct[0],Ct[1]);break;case"c":Mt.apply(this,Ct);break;case"h":ct()}}return this},h.__private__.rect=h.rect=function(M,Be,At,Ct,Vt){if(isNaN(M)||isNaN(Be)||isNaN(At)||isNaN(Ct)||!tt(Vt))throw new Error("Invalid arguments passed to jsPDF.rect");return w===y&&(Ct=-Ct),J([S(O(M)),S(z(Be)),S(O(At)),S(O(Ct)),"re"].join(" ")),ft(Vt),this},h.__private__.triangle=h.triangle=function(M,Be,At,Ct,Vt,hr,yr){if(isNaN(M)||isNaN(Be)||isNaN(At)||isNaN(Ct)||isNaN(Vt)||isNaN(hr)||!tt(yr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[At-M,Ct-Be],[Vt-At,hr-Ct],[M-Vt,Be-hr]],M,Be,[1,1],yr,!0),this},h.__private__.roundedRect=h.roundedRect=function(M,Be,At,Ct,Vt,hr,yr){if(isNaN(M)||isNaN(Be)||isNaN(At)||isNaN(Ct)||isNaN(Vt)||isNaN(hr)||!tt(yr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var sn=4/3*(Math.SQRT2-1);return Vt=Math.min(Vt,.5*At),hr=Math.min(hr,.5*Ct),this.lines([[At-2*Vt,0],[Vt*sn,0,Vt,hr-hr*sn,Vt,hr],[0,Ct-2*hr],[0,hr*sn,-Vt*sn,hr,-Vt,hr],[2*Vt-At,0],[-Vt*sn,0,-Vt,-hr*sn,-Vt,-hr],[0,2*hr-Ct],[0,-hr*sn,Vt*sn,-hr,Vt,-hr]],M+Vt,Be,[1,1],yr,!0),this},h.__private__.ellipse=h.ellipse=function(M,Be,At,Ct,Vt){if(isNaN(M)||isNaN(Be)||isNaN(At)||isNaN(Ct)||!tt(Vt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var hr=4/3*(Math.SQRT2-1)*At,yr=4/3*(Math.SQRT2-1)*Ct;return Et(M+At,Be),Mt(M+At,Be-yr,M+hr,Be-Ct,M,Be-Ct),Mt(M-hr,Be-Ct,M-At,Be-yr,M-At,Be),Mt(M-At,Be+yr,M-hr,Be+Ct,M,Be+Ct),Mt(M+hr,Be+Ct,M+At,Be+yr,M+At,Be),ft(Vt),this},h.__private__.circle=h.circle=function(M,Be,At,Ct){if(isNaN(M)||isNaN(Be)||isNaN(At)||!tt(Ct))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(M,Be,At,At,Ct)},h.setFont=function(M,Be,At){return At&&(Be=_(Be,At)),Ze=rn(M,Be,{disableWarning:!1}),this};var Xt=h.__private__.getFont=h.getFont=function(){return he[rn.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var M,Be,At={};for(M in qe)if(qe.hasOwnProperty(M))for(Be in At[M]=[],qe[M])qe[M].hasOwnProperty(Be)&&At[M].push(Be);return At},h.addFont=function(M,Be,At,Ct,Vt){var hr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&hr.indexOf(arguments[3])!==-1?Vt=arguments[3]:arguments[3]&&hr.indexOf(arguments[3])==-1&&(At=_(At,Ct)),Rt.call(this,M,Be,At,Vt=Vt||"Identity-H")};var ar,vr=t.lineWidth||.200025,ur=h.__private__.getLineWidth=h.getLineWidth=function(){return vr},Dt=h.__private__.setLineWidth=h.setLineWidth=function(M){return vr=M,J(S(O(M))+" w"),this};h.__private__.setLineDash=an.API.setLineDash=an.API.setLineDashPattern=function(M,Be){if(M=M||[],Be=Be||0,isNaN(Be)||!Array.isArray(M))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return M=M.map(function(At){return S(O(At))}).join(" "),Be=S(O(Be)),J("["+M+"] "+Be+" d"),this};var Yr=h.__private__.getLineHeight=h.getLineHeight=function(){return Ge*ar};h.__private__.getLineHeight=h.getLineHeight=function(){return Ge*ar};var Vr=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(M){return typeof(M=M||1.15)=="number"&&(ar=M),this},Sr=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return ar};Vr(t.lineHeight);var pr=h.__private__.getHorizontalCoordinate=function(M){return O(M)},jr=h.__private__.getVerticalCoordinate=function(M){return w===b?M:Se[H].mediaBox.topRightY-Se[H].mediaBox.bottomLeftY-O(M)},Bn=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(M){return S(pr(M))},wn=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(M){return S(jr(M))},xn=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Ne(xn)},h.__private__.setStrokeColor=h.setDrawColor=function(M,Be,At,Ct){return xn=Me({ch1:M,ch2:Be,ch3:At,ch4:Ct,pdfColorType:"draw",precision:2}),J(xn),this};var ua=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Ne(ua)},h.__private__.setFillColor=h.setFillColor=function(M,Be,At,Ct){return ua=Me({ch1:M,ch2:Be,ch3:At,ch4:Ct,pdfColorType:"fill",precision:2}),J(ua),this};var ga=t.textColor||"0 g",Yi=h.__private__.getTextColor=h.getTextColor=function(){return Ne(ga)};h.__private__.setTextColor=h.setTextColor=function(M,Be,At,Ct){return ga=Me({ch1:M,ch2:Be,ch3:At,ch4:Ct,pdfColorType:"text",precision:3}),this};var Ji=t.charSpace,Fl=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Ji||0)};h.__private__.setCharSpace=h.setCharSpace=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ji=M,this};var xa=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(M){var Be=h.CapJoinStyles[M];if(Be===void 0)throw new Error("Line cap style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xa=Be,J(Be+" J"),this};var Qn=0;h.__private__.setLineJoin=h.setLineJoin=function(M){var Be=h.CapJoinStyles[M];if(Be===void 0)throw new Error("Line join style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qn=Be,J(Be+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(M){if(M=M||0,isNaN(M))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(S(O(M))+" M"),this},h.GState=I2,h.setGState=function(M){(M=typeof M=="string"?je[we[M]]:du(null,M)).equals(Ye)||(J("/"+M.id+" gs"),Ye=M)};var du=function(M,Be){if(!M||!we[M]){var At=!1;for(var Ct in je)if(je.hasOwnProperty(Ct)&&je[Ct].equals(Be)){At=!0;break}if(At)Be=je[Ct];else{var Vt="GS"+(Object.keys(je).length+1).toString(10);je[Vt]=Be,Be.id=Vt}return M&&(we[M]=Be.id),xt.publish("addGState",Be),Be}};h.addGState=function(M,Be){return du(M,Be),this},h.saveGraphicsState=function(){return J("q"),st.push({key:Ze,size:Ge,color:ga}),this},h.restoreGraphicsState=function(){J("Q");var M=st.pop();return Ze=M.key,Ge=M.size,ga=M.color,Ye=null,this},h.setCurrentTransformationMatrix=function(M){return J(M.toString()+" cm"),this},h.comment=function(M){return J("#"+M),this};var Ol=function(M,Be){var At=M||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return At},set:function(hr){isNaN(hr)||(At=parseFloat(hr))}});var Ct=Be||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ct},set:function(hr){isNaN(hr)||(Ct=parseFloat(hr))}});var Vt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Vt},set:function(hr){Vt=hr.toString()}}),this},Zi=function(M,Be,At,Ct){Ol.call(this,M,Be),this.type="rect";var Vt=At||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Vt},set:function(yr){isNaN(yr)||(Vt=parseFloat(yr))}});var hr=Ct||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return hr},set:function(yr){isNaN(yr)||(hr=parseFloat(yr))}}),this},Rc=function(){this.page=xe,this.currentPage=H,this.pages=be.slice(0),this.pagesContext=Se.slice(0),this.x=ee,this.y=me,this.matrix=Re,this.width=ol(H),this.height=GA(H),this.outputDestination=Xe,this.id="",this.objectNumber=-1};Rc.prototype.restore=function(){xe=this.page,H=this.currentPage,Se=this.pagesContext,be=this.pages,ee=this.x,me=this.y,Re=this.matrix,fu(H,this.width),ll(H,this.height),Xe=this.outputDestination};var Mc=function(M,Be,At,Ct,Vt){Ht.push(new Rc),xe=H=0,be=[],ee=M,me=Be,Re=Vt,_r([At,Ct])};for(var dc in h.beginFormObject=function(M,Be,At,Ct,Vt){return Mc(M,Be,At,Ct,Vt),this},h.endFormObject=function(M){return function(Be){if(Ut[Be])Ht.pop().restore();else{var At=new Rc,Ct="Xo"+(Object.keys(It).length+1).toString(10);At.id=Ct,Ut[Be]=Ct,It[Ct]=At,xt.publish("addFormObject",At),Ht.pop().restore()}}(M),this},h.doFormObject=function(M,Be){var At=It[Ut[M]];return J("q"),J(Be.toString()+" cm"),J("/"+At.id+" Do"),J("Q"),this},h.getFormObject=function(M){var Be=It[Ut[M]];return{x:Be.x,y:Be.y,width:Be.width,height:Be.height,matrix:Be.matrix}},h.save=function(M,Be){return M=M||"generated.pdf",(Be=Be||{}).returnPromise=Be.returnPromise||!1,Be.returnPromise===!1?(cp(ir(Or()),M),typeof cp.unload=="function"&&Mn.setTimeout&&setTimeout(cp.unload,911),this):new Promise(function(At,Ct){try{var Vt=cp(ir(Or()),M);typeof cp.unload=="function"&&Mn.setTimeout&&setTimeout(cp.unload,911),At(Vt)}catch(hr){Ct(hr.message)}})},an.API)an.API.hasOwnProperty(dc)&&(dc==="events"&&an.API.events.length?function(M,Be){var At,Ct,Vt;for(Vt=Be.length-1;Vt!==-1;Vt--)At=Be[Vt][0],Ct=Be[Vt][1],M.subscribe.apply(M,[At].concat(typeof Ct=="function"?[Ct]:Ct))}(xt,an.API.events):h[dc]=an.API[dc]);function ol(M){return Se[M].mediaBox.topRightX-Se[M].mediaBox.bottomLeftX}function fu(M,Be){Se[M].mediaBox.topRightX=Be+Se[M].mediaBox.bottomLeftX}function GA(M){return Se[M].mediaBox.topRightY-Se[M].mediaBox.bottomLeftY}function ll(M,Be){Se[M].mediaBox.topRightY=Be+Se[M].mediaBox.bottomLeftY}var Lc=h.getPageWidth=function(M){return ol(M=M||H)/Te},Bf=h.setPageWidth=function(M,Be){fu(M,Be*Te)},fo=h.getPageHeight=function(M){return GA(M=M||H)/Te},zu=h.setPageHeight=function(M,Be){ll(M,Be*Te)};return h.internal={pdfEscape:nr,getStyle:at,getFont:Xt,getFontSize:_t,getCharSpace:Fl,getTextColor:Yi,getLineHeight:Yr,getLineHeightFactor:Sr,getLineWidth:ur,write:De,getHorizontalCoordinate:pr,getVerticalCoordinate:jr,getCoordinateString:Bn,getVerticalCoordinateString:wn,collections:{},newObject:te,newAdditionalObject:Q,newObjectDeferred:_e,newObjectDeferredBegin:R,getFilters:ze,putStream:Ie,events:xt,scaleFactor:Te,pageSize:{getWidth:function(){return Lc(H)},setWidth:function(M){Bf(H,M)},getHeight:function(){return fo(H)},setHeight:function(M){zu(H,M)}},encryptionOptions:d,encryption:Xr,getEncryptor:function(M){return d!==null?Xr.encryptor(M,0):function(Be){return Be}},output:br,getNumberOfPages:en,get pages(){return be},out:J,f2:k,f3:P,getPageInfo:Ir,getPageInfoByObjId:Pr,getCurrentPageInfo:fn,getPDFVersion:p,Point:Ol,Rectangle:Zi,Matrix:Le,hasHotfix:wr},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Lc(H)},set:function(M){Bf(H,M)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return fo(H)},set:function(M){zu(H,M)},enumerable:!0,configurable:!0}),(function(M){for(var Be=0,At=He.length;Be<At;Be++){var Ct=Rt.call(this,M[Be][0],M[Be][1],M[Be][2],He[Be][3],!0);f===!1&&(A[Ct]=!0);var Vt=M[Be][0].split("-");Nt({id:Ct,fontName:Vt[0],fontStyle:Vt[1]||""})}xt.publish("addFonts",{fonts:he,dictionary:qe})}).call(h,He),Ze="F1",$r(a,r),xt.publish("initialized"),h}Bx.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Bx.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Bx.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Bx.prototype.processOwnerPassword=function(t,e){return Vk(Qk(e).substr(0,5),t)},Bx.prototype.encryptor=function(t,e){var r=Qk(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Vk(r,n)}},I2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||es(t)!==es(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},an.API={events:[]},an.version="3.0.4";var wi=an.API,q6=1,Dg=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ux=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},$n=function(t){return t.toFixed(2)},f0=function(t){return t.toFixed(5)};wi.__acroform__={};var lu=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},EV=function(t){return t*q6},Vf=function(t){var e=new Tre,r=un.internal.getHeight(t)||0,n=un.internal.getWidth(t)||0;return e.BBox=[0,0,Number($n(n)),Number($n(r))],e},Qje=wi.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Vje=wi.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Hje=wi.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Hi=wi.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Hje(t,e-1)},$i=wi.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Qje(t,e-1)},Ki=wi.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Vje(t,e-1)},$je=wi.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number($n(c.lowerLeft_X)),Number($n(c.lowerLeft_Y)),Number($n(c.upperRight_X)),Number($n(c.upperRight_Y))]},Kje=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Hk(t,r),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+$n(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Vf(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Hk=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(k){return k.split(`
`)}):a.map(function(k){return[k]});var s=r,o=un.internal.getHeight(t)||0;o=o<0?-o:o;var l=un.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,P,O){if(k+1<a.length){var z=P+" "+a[k+1][0];return OC(z,t,O).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,d,f=OC("3",t,s).height,A=t.multiline?o-s:(o-f)/2,h=A+=2,m=0,p=0,x=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+OC(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var v="",y=0,b=0;b<a.length;b++)if(a.hasOwnProperty(b)){var w=!1;if(a[b].length!==1&&x!==a[b].length-1){if((f+2)*(y+2)+2>o)continue e;v+=a[b][x],w=!0,p=b,b--}else{v=(v+=a[b][x]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var j=parseInt(b),I=c(j,v,s),_=b>=a.length-1;if(I&&!_){v+=" ",x=0;continue}if(I||_){if(_)p=j;else if(t.multiline&&(f+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(y+2)+2>o)continue e;p=j}}for(var S="",E=m;E<=p;E++){var B=a[E];if(t.multiline){if(E===p){S+=B[x]+" ",x=(x+1)%B.length;continue}if(E===m){S+=B[B.length-1]+" ";continue}}S+=B[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,d=OC(S,t,s).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}e+=$n(u)+" "+$n(h)+` Td
`,e+="("+Dg(S)+`) Tj
`,e+=-$n(u)+` 0 Td
`,h=-(s+2),d=0,m=w?p:p+1,y++,v=""}break}return n.text=e,n.fontSize=s,n},OC=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},Gje={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},qje=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},zje=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(If.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Gje)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");q6=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new kre,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&qje(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=$je(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=un.createDefaultAppearanceStream(l),es(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Kje(l);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var A in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(A)){var h=l.appearanceStreamContent[A];if(f+="/"+A+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(p,x){for(var v in p)if(p.hasOwnProperty(v)){var y=v,b=p[v];x.internal.newObjectDeferredBegin(b.objId,!0),es(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(a.internal.acroformPlugin.xForms,a)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Bre=wi.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var a="[",s=0;s<t.length;s++)switch(s!==0&&(a+=" "),es(t[s])){case"boolean":case"number":case"object":a+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),a+="("+Dg(n(t[s].toString()))+")"):a+=t[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},A5=function(t,e,r){var n=function(a){return a};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Dg(n(t))+")"},Jf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Jf.prototype.toString=function(){return this.objId+" 0 R"},Jf.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Jf.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],a=this[n];a&&(Array.isArray(a)?t.push({key:n,value:Bre(a,this.objId,this.scope)}):a instanceof Jf?(a.scope=this.scope,t.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:n,value:a}))}return t};var Tre=function(){Jf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};lu(Tre,Jf);var kre=function(){Jf.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Dg(r(t))+")"}},set:function(r){t=r}})};lu(kre,Jf);var If=function t(){Jf.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Hi(e,3)},set:function(v){v?this.F=$i(e,3):this.F=Ki(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof FS)return;s="FieldObject"+t.FieldNum++}var v=function(y){return y};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Dg(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/q6:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof FS||this instanceof fm))return A5(f,this.objId,this.scope)},set:function(v){v=v.toString(),f=v}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Co==0?A5(A,this.objId,this.scope):A},set:function(v){v=v.toString(),A=this instanceof Co==0?v.substr(0,1)==="("?ux(v.substr(1,v.length-2)):ux(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Co==1?ux(A.substr(1,A.length-1)):A},set:function(v){v=v.toString(),A=this instanceof Co==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Co==0?A5(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof Co==0?v.substr(0,1)==="("?ux(v.substr(1,v.length-2)):ux(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Co==1?ux(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof Co==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(v){v=!!v,p=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(v){m=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,1)},set:function(v){v?this.Ff=$i(this.Ff,1):this.Ff=Ki(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,2)},set:function(v){v?this.Ff=$i(this.Ff,2):this.Ff=Ki(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,3)},set:function(v){v?this.Ff=$i(this.Ff,3):this.Ff=Ki(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');x=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(x){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};lu(If,Jf);var Dp=function(){If.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Bre(e,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,18)},set:function(r){r?this.Ff=$i(this.Ff,18):this.Ff=Ki(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=$i(this.Ff,19):this.Ff=Ki(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,20)},set:function(r){r?(this.Ff=$i(this.Ff,20),e.sort()):this.Ff=Ki(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,22)},set:function(r){r?this.Ff=$i(this.Ff,22):this.Ff=Ki(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,23)},set:function(r){r?this.Ff=$i(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,27)},set:function(r){r?this.Ff=$i(this.Ff,27):this.Ff=Ki(this.Ff,27)}}),this.hasAppearanceStream=!1};lu(Dp,If);var Rp=function(){Dp.call(this),this.fontName="helvetica",this.combo=!1};lu(Rp,Dp);var Mp=function(){Rp.call(this),this.combo=!0};lu(Mp,Rp);var Eb=function(){Mp.call(this),this.edit=!0};lu(Eb,Mp);var Co=function(){If.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,15)},set:function(r){r?this.Ff=$i(this.Ff,15):this.Ff=Ki(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,16)},set:function(r){r?this.Ff=$i(this.Ff,16):this.Ff=Ki(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,17)},set:function(r){r?this.Ff=$i(this.Ff,17):this.Ff=Ki(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,26)},set:function(r){r?this.Ff=$i(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+Dg(r(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){es(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};lu(Co,If);var Sb=function(){Co.call(this),this.pushButton=!0};lu(Sb,Co);var Lp=function(){Co.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};lu(Lp,Co);var FS=function(){var t,e;If.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+Dg(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){es(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=un.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};lu(FS,If),Lp.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Lp.prototype.createOption=function(t){var e=new FS;return e.Parent=this,e.optionName=t,this.Kids.push(e),Wje.call(this.scope,e),e};var Ib=function(){Co.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=un.CheckBox.createAppearanceStream()};lu(Ib,Co);var fm=function(){If.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,13)},set:function(e){e?this.Ff=$i(this.Ff,13):this.Ff=Ki(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,21)},set:function(e){e?this.Ff=$i(this.Ff,21):this.Ff=Ki(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,23)},set:function(e){e?this.Ff=$i(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,24)},set:function(e){e?this.Ff=$i(this.Ff,24):this.Ff=Ki(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,25)},set:function(e){e?this.Ff=$i(this.Ff,25):this.Ff=Ki(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,26)},set:function(e){e?this.Ff=$i(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};lu(fm,If);var jb=function(){fm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,14)},set:function(t){t?this.Ff=$i(this.Ff,14):this.Ff=Ki(this.Ff,14)}}),this.password=!0};lu(jb,fm);var un={CheckBox:{createAppearanceStream:function(){return{N:{On:un.CheckBox.YesNormal},D:{On:un.CheckBox.YesPushDown,Off:un.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=Hk(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+$n(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Vf(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),a=[],s=un.internal.getHeight(t),o=un.internal.getWidth(t),l=Hk(t,t.caption);return a.push("1 g"),a.push("0 0 "+$n(o)+" "+$n(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+$n(o-1)+" "+$n(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+$n(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:un.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=un.RadioButton.Circle.YesNormal,e.D[t]=un.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=un.internal.getWidth(t)<=un.internal.getHeight(t)?un.internal.getWidth(t)/4:un.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=un.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+f0(un.internal.getWidth(t)/2)+" "+f0(un.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=un.internal.getWidth(t)<=un.internal.getHeight(t)?un.internal.getWidth(t)/4:un.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*un.internal.Bezier_C).toFixed(5)),o=Number((n*un.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+f0(un.internal.getWidth(t)/2)+" "+f0(un.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+f0(un.internal.getWidth(t)/2)+" "+f0(un.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=un.internal.getWidth(t)<=un.internal.getHeight(t)?un.internal.getWidth(t)/4:un.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*un.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+f0(un.internal.getWidth(t)/2)+" "+f0(un.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:un.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=un.RadioButton.Cross.YesNormal,e.D[t]=un.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=un.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+$n(un.internal.getWidth(t)-2)+" "+$n(un.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push($n(n.x1.x)+" "+$n(n.x1.y)+" m"),r.push($n(n.x2.x)+" "+$n(n.x2.y)+" l"),r.push($n(n.x4.x)+" "+$n(n.x4.y)+" m"),r.push($n(n.x3.x)+" "+$n(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=un.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+$n(un.internal.getWidth(t)-2)+" "+$n(un.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push($n(r.x1.x)+" "+$n(r.x1.y)+" m"),n.push($n(r.x2.x)+" "+$n(r.x2.y)+" l"),n.push($n(r.x4.x)+" "+$n(r.x4.y)+" m"),n.push($n(r.x3.x)+" "+$n(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};un.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=un.internal.getWidth(t),r=un.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},un.internal.getWidth=function(t){var e=0;return es(t)==="object"&&(e=EV(t.Rect[2])),e},un.internal.getHeight=function(t){var e=0;return es(t)==="object"&&(e=EV(t.Rect[3])),e};var Wje=wi.addField=function(t){if(zje(this,t),!(t instanceof If))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};wi.AcroFormChoiceField=Dp,wi.AcroFormListBox=Rp,wi.AcroFormComboBox=Mp,wi.AcroFormEditBox=Eb,wi.AcroFormButton=Co,wi.AcroFormPushButton=Sb,wi.AcroFormRadioButton=Lp,wi.AcroFormCheckBox=Ib,wi.AcroFormTextField=fm,wi.AcroFormPasswordField=jb,wi.AcroFormAppearance=un,wi.AcroForm={ChoiceField:Dp,ListBox:Rp,ComboBox:Mp,EditBox:Eb,Button:Co,PushButton:Sb,RadioButton:Lp,CheckBox:Ib,TextField:fm,PasswordField:jb,Appearance:un},an.AcroForm={ChoiceField:Dp,ListBox:Rp,ComboBox:Mp,EditBox:Eb,Button:Co,PushButton:Sb,RadioButton:Lp,CheckBox:Ib,TextField:fm,PasswordField:jb,Appearance:un};var Xje=an.AcroForm;function Fre(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(k,P){var O,z,oe,ce,ue,ge=r;if((P=P||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(I(k))for(ue in n)for(oe=n[ue],O=0;O<oe.length;O+=1){for(ce=!0,z=0;z<oe[O].length;z+=1)if(oe[O][z]!==void 0&&oe[O][z]!==k[z]){ce=!1;break}if(ce===!0){ge=ue;break}}else for(ue in n)for(oe=n[ue],O=0;O<oe.length;O+=1){for(ce=!0,z=0;z<oe[O].length;z+=1)if(oe[O][z]!==void 0&&oe[O][z]!==k.charCodeAt(z)){ce=!1;break}if(ce===!0){ge=ue;break}}return ge===r&&P!==r&&(ge=P),ge},s=function k(P){for(var O=this.internal.write,z=this.internal.putStream,oe=(0,this.internal.getFilters)();oe.indexOf("FlateEncode")!==-1;)oe.splice(oe.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var ce=[];if(ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Image"}),ce.push({key:"Width",value:P.width}),ce.push({key:"Height",value:P.height}),P.colorSpace===v.INDEXED?ce.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(ce.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===v.DEVICE_CMYK&&ce.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ce.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&ce.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var ue="",ge=0,ne=P.transparency.length;ge<ne;ge++)ue+=P.transparency[ge]+" "+P.transparency[ge]+" ";ce.push({key:"Mask",value:"["+ue+"]"})}P.sMask!==void 0&&ce.push({key:"SMask",value:P.objectId+1+" 0 R"});var Oe=P.filter!==void 0?["/"+P.filter]:void 0;if(z({data:P.data,additionalKeyValues:ce,alreadyAppliedFilters:Oe,objectId:P.objectId}),O("endobj"),"sMask"in P&&P.sMask!==void 0){var Ue,F=(Ue=P.sMaskBitsPerComponent)!==null&&Ue!==void 0?Ue:P.bitsPerComponent,H={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:F,data:P.sMask};"filter"in P&&(H.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(F," /Columns ").concat(P.width),H.filter=P.filter),k.call(this,H)}if(P.colorSpace===v.INDEXED){var K=this.internal.newObject();z({data:S(new Uint8Array(P.palette)),objectId:K}),O("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var P in k)s.call(this,k[P])},l=function(){var k,P=this.internal.collections[e+"images"],O=this.internal.write;for(var z in P)O("/I"+(k=P[z]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(k){return typeof t["process"+k.toUpperCase()]=="function"},A=function(k){return es(k)==="object"&&k.nodeType===1},h=function(k,P){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var O=""+k.getAttribute("src");if(O.indexOf("data:image/")===0)return pE(unescape(O).split("base64,").pop());var z=t.loadFile(O,!0);if(z!==void 0)return z}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var oe;switch(P){case"PNG":oe="image/png";break;case"WEBP":oe="image/webp";break;default:oe="image/jpeg"}return pE(k.toDataURL(oe,1).split("base64,").pop())}},m=function(k){var P=this.internal.collections[e+"images"];if(P){for(var O in P)if(k===P[O].alias)return P[O]}},p=function(k,P,O){return k||P||(k=-96,P=-96),k<0&&(k=-1*O.width*72/k/this.internal.scaleFactor),P<0&&(P=-1*O.height*72/P/this.internal.scaleFactor),k===0&&(k=P*O.width/O.height),P===0&&(P=k*O.height/O.width),[k,P]},x=function(k,P,O,z,oe,ce){var ue=p.call(this,O,z,oe),ge=this.internal.getCoordinateString,ne=this.internal.getVerticalCoordinateString,Oe=u.call(this);if(O=ue[0],z=ue[1],Oe[oe.index]=oe,ce){ce*=Math.PI/180;var Ue=Math.cos(ce),F=Math.sin(ce),H=function(U){return U.toFixed(4)},K=[H(Ue),H(F),H(-1*F),H(Ue),0,0,"cm"]}this.internal.write("q"),ce?(this.internal.write([1,"0","0",1,ge(k),ne(P+z),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([ge(O),"0","0",ge(z),"0","0","cm"].join(" "))):this.internal.write([ge(O),"0","0",ge(z),ge(k),ne(P+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+oe.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(k){var P,O,z=0;if(typeof k=="string")for(O=k.length,P=0;P<O;P++)z=(z<<5)-z+k.charCodeAt(P),z|=0;else if(I(k))for(O=k.byteLength/2,P=0;P<O;P++)z=(z<<5)-z+k[P],z|=0;return z},w=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var P=!0;return k.length===0&&(P=!1),k.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(P=!1),P},j=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var P=k.indexOf(",");return P<0?null:k.substring(0,P).trim().endsWith("base64")?k.substring(P+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var I=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},_=t.__addimage__.binaryStringToUint8Array=function(k){for(var P=k.length,O=new Uint8Array(P),z=0;z<P;z++)O[z]=k.charCodeAt(z);return O},S=t.__addimage__.arrayBufferToBinaryString=function(k){for(var P="",O=I(k)?k:new Uint8Array(k),z=0;z<O.length;z+=8192)P+=String.fromCharCode.apply(null,O.subarray(z,z+8192));return P};t.addImage=function(){var k,P,O,z,oe,ce,ue,ge,ne;if(typeof arguments[1]=="number"?(P=r,O=arguments[1],z=arguments[2],oe=arguments[3],ce=arguments[4],ue=arguments[5],ge=arguments[6],ne=arguments[7]):(P=arguments[1],O=arguments[2],z=arguments[3],oe=arguments[4],ce=arguments[5],ue=arguments[6],ge=arguments[7],ne=arguments[8]),es(k=arguments[0])==="object"&&!A(k)&&"imageData"in k){var Oe=k;k=Oe.imageData,P=Oe.format||P||r,O=Oe.x||O||0,z=Oe.y||z||0,oe=Oe.w||Oe.width||oe,ce=Oe.h||Oe.height||ce,ue=Oe.alias||ue,ge=Oe.compression||ge,ne=Oe.rotation||Oe.angle||ne}var Ue=this.internal.getFilters();if(ge===void 0&&Ue.indexOf("FlateEncode")!==-1&&(ge="SLOW"),isNaN(O)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var F=E.call(this,k,P,ue,ge);return x.call(this,O,z,oe,ce,F,ne),this};var E=function(k,P,O,z){var oe,ce,ue;if(typeof k=="string"&&a(k)===r){k=unescape(k);var ge=B(k,!1);(ge!==""||(ge=t.loadFile(k,!0))!==void 0)&&(k=ge)}if(A(k)&&(k=h(k,P)),P=a(k,P),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((ue=O)==null||ue.length===0)&&(O=function(ne){return typeof ne=="string"||I(ne)?b(ne):I(ne.data)?b(ne.data):null}(k)),(oe=m.call(this,O))||(k instanceof Uint8Array||P==="RGBA"||(ce=k,k=_(k)),oe=this["process"+P.toUpperCase()](k,d.call(this),O,function(ne){return ne&&typeof ne=="string"&&(ne=ne.toUpperCase()),ne in t.image_compression?ne:y.NONE}(z),ce)),!oe)throw new Error("An unknown error occurred whilst processing the image.");return oe},B=t.__addimage__.convertBase64ToBinaryString=function(k,P){P=typeof P!="boolean"||P;var O,z="";if(typeof k=="string"){var oe;O=(oe=j(k))!==null&&oe!==void 0?oe:k;try{z=pE(O)}catch(ce){if(P)throw w(O)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ce.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return z};t.getImageProperties=function(k){var P,O,z="";if(A(k)&&(k=h(k)),typeof k=="string"&&a(k)===r&&((z=B(k,!1))===""&&(z=t.loadFile(k)||""),k=z),O=a(k),!f(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(k instanceof Uint8Array||(k=_(k)),!(P=this["process"+O.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=O,P}})(an.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};an.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var A=0;A<u.length;A++){n=u[A];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(p.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",s+=" /Popup "+x.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(v(y))+") >>",p.content=s;var b=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(s+=" /Open true"),s+=" >>",x.content=s,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var j=this.annotations._nameMap[n.options.name];n.options.pageNumber=j.page,n.options.top=j.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var I=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:o,type:"link"})},t.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(an.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&a.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(p){var x=0,v=r,y="",b=0;for(x=0;x<p.length;x+=1)v[p.charCodeAt(x)]!==void 0?(b++,typeof(v=v[p.charCodeAt(x)])=="number"&&(y+=String.fromCharCode(v),v=r,b=0),x===p.length-1&&(v=r,y+=p.charAt(x-(b-1)),x-=b-1,b=0)):(v=r,y+=p.charAt(x-b),x-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(p,x,v){return o(p)?s(p)===!1?-1:!u(p)||!o(x)&&!o(v)||!o(v)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:d(p)&&o(x)&&!l(x)&&o(v)&&u(v)?3:l(p)||!o(v)?1:2:-1},h=function(p){var x=0,v=0,y=0,b="",w="",j="",I=(p=p||"").split("\\s+"),_=[];for(x=0;x<I.length;x+=1){for(_.push(""),v=0;v<I[x].length;v+=1)b=I[x][v],w=I[x][v-1],j=I[x][v+1],o(b)?(y=A(b,w,j),_[x]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):_[x]+=b;_[x]=f(_[x])}return _.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(x)){var y=0;for(v=[],y=0;y<x.length;y+=1)Array.isArray(x[y])?v.push([h(x[y][0]),x[y][1],x[y][2]]):v.push([h(x[y])]);p=v}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(an.API),an.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(an.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),A=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,w){return b.concat(x.splitTextToSize(w,v))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:f})*d)&&(h=p);return h!==0&&(m=c.length),{w:h/=A,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&A&&(this.printHeaderRow(c.lineNumber,!0),c.y+=A[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,f,A){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,p,x,v=[],y=[],b=[],w={},j={},I=[],_=[],S=(A=A||{}).autoSize||!1,E=A.printHeaders!==!1,B=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,k=A.margins||Object.assign({width:this.getPageWidth()},e),P=typeof A.padding=="number"?A.padding:3,O=A.headerBackgroundColor||"#c8c8c8",z=A.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=O,this.internal.__cell__.headerTextColor=z,this.setFontSize(B),f==null)y=v=Object.keys(d[0]),b=v.map(function(){return"left"});else if(Array.isArray(f)&&es(f[0])==="object")for(v=f.map(function(Oe){return Oe.name}),y=f.map(function(Oe){return Oe.prompt||Oe.name||""}),b=f.map(function(Oe){return Oe.align||"left"}),h=0;h<f.length;h+=1)j[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(y=v=f,b=v.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<v.length;h+=1){for(w[x=v[h]]=d.map(function(Oe){return Oe[x]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=w[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)I.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);j[x]=Math.max.apply(null,I)+P+P,I=[]}if(E){var oe={};for(h=0;h<v.length;h+=1)oe[v[h]]={},oe[v[h]].text=y[h],oe[v[h]].align=b[h];var ce=l.call(this,oe,j);_=v.map(function(Oe){return new s(c,u,j[Oe],ce,oe[Oe].text,void 0,oe[Oe].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var ue=f.reduce(function(Oe,Ue){return Oe[Ue.name]=Ue.align,Oe},{});for(h=0;h<d.length;h+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:h,data:d[h]},this);var ge=l.call(this,d[h],j);for(p=0;p<v.length;p+=1){var ne=d[h][v[p]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:h,col:p,data:ne},this),o.call(this,new s(c,u,j[v[p]],ge,ne,h+2,ue[v[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/A+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,A.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}}(an.API);var Ore={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Dre=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],$k=Fre(Dre),Rre=[100,200,300,400,500,600,700,800,900],Yje=Fre(Rre);function m5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Ore[s=s||"normal"]?s:"normal"}(t.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),a=function(s){return typeof $k[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,r,n].join(" ")}}}function SV(t,e,r,n){var a;for(a=r;a>=0&&a<e.length;a+=n)if(t[e[a]])return t[e[a]];for(a=r;a>=0&&a<e.length;a-=n)if(t[e[a]])return t[e[a]]}var Jje={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},IV={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function jV(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function PV(t){return t.trimLeft()}function Zje(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function ePe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var DC,BV,TV,dx,RC,kV,FV,OV,p5=["times"];function DV(t,e,r,n,a){var s=4,o=MV;switch(a){case an.API.image_compression.FAST:s=1,o=RV;break;case an.API.image_compression.MEDIUM:s=6,o=LV;break;case an.API.image_compression.SLOW:s=9,o=UV}t=function(c,u,d,f){for(var A,h=c.length/u,m=new Uint8Array(c.length+h),p=[tPe,RV,MV,LV,UV],x=0;x<h;x+=1){var v=x*u,y=c.subarray(v,v+u);if(f)m.set(f(y,d,A),v+x);else{for(var b=p.length,w=[],j=0;j<b;j+=1)w[j]=p[j](y,d,A);var I=nPe(w.concat());m.set(w[I],v+x)}A=y}return m}(t,e,Math.ceil(r*n/8),o);var l=Rk(t,{level:s});return an.API.__addimage__.arrayBufferToBinaryString(l)}function tPe(t){var e=Array.apply([],t);return e.unshift(0),e}function RV(t,e){var r=t.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=t[a-e]||0;n[a+1]=t[a]-s+256&255}return n}function MV(t,e,r){var n=t.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=t[s]-o+256&255}return a}function LV(t,e,r){var n=t.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=t[s-e]||0,l=r&&r[s]||0;a[s+1]=t[s]+256-(o+l>>>1)&255}return a}function UV(t,e,r){var n=t.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=rPe(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);a[s+1]=t[s]-o+256&255}return a}function rPe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),a=Math.abs(t-r),s=Math.abs(t+e-r-r);return n<=a&&n<=s?t:a<=s?e:r}function nPe(t){var e=t.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function g5(t,e,r){var n=e*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return Mre(t,a)>>s&o}function QV(t,e,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var A=f>>8&255;u.setUint8(d,A)}})(t,s,Mre(t,s)&~(l<<o)&65535|c)}function Mre(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function aPe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,a=t[e++],s=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,d=[],f=0,A=null,h=0,m=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];f=t[e++]|t[e++]<<8,A=t[e++],1&p||(A=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++],j=w>>6&1,I=1<<1+(7&w),_=l,S=c,E=!1;w>>7&&(E=!0,_=e,S=I,e+=3*I);var B=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}d.push({x,y:v,width:y,height:b,has_local_palette:E,palette_offset:_,palette_size:S,data_offset:B,data_length:e-B,transparent_index:A,interlaced:!!j,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,O){var z=this.frameInfo(P),oe=z.width*z.height,ce=new Uint8Array(oe);VV(t,z.data_offset,ce,oe);var ue=z.palette_offset,ge=z.transparent_index;ge===null&&(ge=256);var ne=z.width,Oe=r-ne,Ue=ne,F=4*(z.y*r+z.x),H=4*((z.y+z.height)*r+z.x),K=F,U=4*Oe;z.interlaced===!0&&(U+=4*r*7);for(var W=8,X=0,D=ce.length;X<D;++X){var V=ce[X];if(Ue===0&&(Ue=ne,(K+=U)>=H&&(U=4*Oe+4*r*(W-1),K=F+(ne+Oe)*(W<<1),W>>=1)),V===ge)K+=4;else{var Z=t[ue+3*V],be=t[ue+3*V+1],L=t[ue+3*V+2];O[K++]=L,O[K++]=be,O[K++]=Z,O[K++]=255}--Ue}},this.decodeAndBlitFrameRGBA=function(P,O){var z=this.frameInfo(P),oe=z.width*z.height,ce=new Uint8Array(oe);VV(t,z.data_offset,ce,oe);var ue=z.palette_offset,ge=z.transparent_index;ge===null&&(ge=256);var ne=z.width,Oe=r-ne,Ue=ne,F=4*(z.y*r+z.x),H=4*((z.y+z.height)*r+z.x),K=F,U=4*Oe;z.interlaced===!0&&(U+=4*r*7);for(var W=8,X=0,D=ce.length;X<D;++X){var V=ce[X];if(Ue===0&&(Ue=ne,(K+=U)>=H&&(U=4*Oe+4*r*(W-1),K=F+(ne+Oe)*(W<<1),W>>=1)),V===ge)K+=4;else{var Z=t[ue+3*V],be=t[ue+3*V+1],L=t[ue+3*V+2];O[K++]=Z,O[K++]=be,O[K++]=L,O[K++]=255}--Ue}}}function VV(t,e,r,n){for(var a=t[e++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,d=0,f=0,A=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;d<16&&h!==0;)f|=t[e++]<<d,d+=8,h===1?h=t[e++]:--h;if(d<c)break;var x=f&u;if(f>>=c,d-=c,x!==s){if(x===o)break;for(var v=x<l?x:p,y=0,b=v;b>s;)b=m[b]>>8,++y;var w=b;if(A+y+(v!==x?1:0)>n)return void hs.log("Warning, gif stream longer than expected.");r[A++]=w;var j=A+=y;for(v!==x&&(r[A++]=w),b=v;y--;)b=m[b],r[--j]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|w,l>=u+1&&c<12&&(++c,u=u<<1|1)),p=x}else l=o+1,u=(1<<(c=a+1))-1,p=null}return A!==n&&hs.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function x5(t){var e,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),A=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,v=7,y=new Array(64),b=new Array(64),w=new Array(64),j=new Array(256),I=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],oe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ce(F,H){for(var K=0,U=0,W=new Array,X=1;X<=16;X++){for(var D=1;D<=F[X];D++)W[H[U]]=[],W[H[U]][0]=K,W[H[U]][1]=X,U++,K++;K*=2}return W}function ue(F){for(var H=F[0],K=F[1]-1;K>=0;)H&1<<K&&(x|=1<<v),K--,--v<0&&(x==255?(ge(255),ge(0)):ge(x),v=7,x=0)}function ge(F){p.push(F)}function ne(F){ge(F>>8&255),ge(255&F)}function Oe(F,H,K,U,W){for(var X,D=W[0],V=W[240],Z=function(Ge,dt){var _t,Bt,Ot,jt,Qt,Ft,$e,Fe,Ze,Te,ee=0;for(Ze=0;Ze<8;++Ze){_t=Ge[ee],Bt=Ge[ee+1],Ot=Ge[ee+2],jt=Ge[ee+3],Qt=Ge[ee+4],Ft=Ge[ee+5],$e=Ge[ee+6];var me=_t+(Fe=Ge[ee+7]),Re=_t-Fe,he=Bt+$e,qe=Bt-$e,st=Ot+Ft,yt=Ot-Ft,pe=jt+Qt,je=jt-Qt,we=me+pe,Ye=me-pe,xe=he+st,Se=he-st;Ge[ee]=we+xe,Ge[ee+4]=we-xe;var xt=.707106781*(Se+Ye);Ge[ee+2]=Ye+xt,Ge[ee+6]=Ye-xt;var Pt=.382683433*((we=je+yt)-(Se=qe+Re)),It=.5411961*we+Pt,Ut=1.306562965*Se+Pt,Ht=.707106781*(xe=yt+qe),Le=Re+Ht,Ce=Re-Ht;Ge[ee+5]=Ce+It,Ge[ee+3]=Ce-It,Ge[ee+1]=Le+Ut,Ge[ee+7]=Le-Ut,ee+=8}for(ee=0,Ze=0;Ze<8;++Ze){_t=Ge[ee],Bt=Ge[ee+8],Ot=Ge[ee+16],jt=Ge[ee+24],Qt=Ge[ee+32],Ft=Ge[ee+40],$e=Ge[ee+48];var Ae=_t+(Fe=Ge[ee+56]),Qe=_t-Fe,fe=Bt+$e,te=Bt-$e,_e=Ot+Ft,R=Ot-Ft,Q=jt+Qt,G=jt-Qt,se=Ae+Q,Ne=Ae-Q,Me=fe+_e,ze=fe-_e;Ge[ee]=se+Me,Ge[ee+32]=se-Me;var Ie=.707106781*(ze+Ne);Ge[ee+16]=Ne+Ie,Ge[ee+48]=Ne-Ie;var nt=.382683433*((se=G+R)-(ze=te+Qe)),lt=.5411961*se+nt,ht=1.306562965*ze+nt,kt=.707106781*(Me=R+te),le=Qe+kt,We=Qe-kt;Ge[ee+40]=We+lt,Ge[ee+24]=We-lt,Ge[ee+8]=le+ht,Ge[ee+56]=le-ht,ee++}for(Ze=0;Ze<64;++Ze)Te=Ge[Ze]*dt[Ze],h[Ze]=Te>0?Te+.5|0:Te-.5|0;return h}(F,H),be=0;be<64;++be)m[_[be]]=Z[be];var L=m[0]-K;K=m[0],L==0?ue(U[0]):(ue(U[A[X=32767+L]]),ue(f[X]));for(var Xe=63;Xe>0&&m[Xe]==0;)Xe--;if(Xe==0)return ue(D),K;for(var re,J=1;J<=Xe;){for(var De=J;m[J]==0&&J<=Xe;)++J;var ie=J-De;if(ie>=16){re=ie>>4;for(var He=1;He<=re;++He)ue(V);ie&=15}X=32767+m[J],ue(W[(ie<<4)+A[X]]),ue(f[X]),J++}return Xe!=63&&ue(D),K}function Ue(F){F=Math.min(Math.max(F,1),100),s!=F&&(function(H){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],U=0;U<64;U++){var W=o((K[U]*H+50)/100);W=Math.min(Math.max(W,1),255),l[_[U]]=W}for(var X=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],D=0;D<64;D++){var V=o((X[D]*H+50)/100);V=Math.min(Math.max(V,1),255),c[_[D]]=V}for(var Z=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],be=0,L=0;L<8;L++)for(var Xe=0;Xe<8;Xe++)u[be]=1/(l[_[be]]*Z[L]*Z[Xe]*8),d[be]=1/(c[_[be]]*Z[L]*Z[Xe]*8),be++}(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),s=F)}this.encode=function(F,H){H&&Ue(H),p=new Array,x=0,v=7,ne(65496),ne(65504),ne(16),ge(74),ge(70),ge(73),ge(70),ge(0),ge(1),ge(1),ge(0),ne(1),ne(1),ge(0),ge(0),function(){ne(65499),ne(132),ge(0);for(var Bt=0;Bt<64;Bt++)ge(l[Bt]);ge(1);for(var Ot=0;Ot<64;Ot++)ge(c[Ot])}(),function(Bt,Ot){ne(65472),ne(17),ge(8),ne(Ot),ne(Bt),ge(3),ge(1),ge(17),ge(0),ge(2),ge(17),ge(1),ge(3),ge(17),ge(1)}(F.width,F.height),function(){ne(65476),ne(418),ge(0);for(var Bt=0;Bt<16;Bt++)ge(S[Bt+1]);for(var Ot=0;Ot<=11;Ot++)ge(E[Ot]);ge(16);for(var jt=0;jt<16;jt++)ge(B[jt+1]);for(var Qt=0;Qt<=161;Qt++)ge(k[Qt]);ge(1);for(var Ft=0;Ft<16;Ft++)ge(P[Ft+1]);for(var $e=0;$e<=11;$e++)ge(O[$e]);ge(17);for(var Fe=0;Fe<16;Fe++)ge(z[Fe+1]);for(var Ze=0;Ze<=161;Ze++)ge(oe[Ze])}(),ne(65498),ne(12),ge(3),ge(1),ge(0),ge(2),ge(17),ge(3),ge(17),ge(0),ge(63),ge(0);var K=0,U=0,W=0;x=0,v=7,this.encode.displayName="_encode_";for(var X,D,V,Z,be,L,Xe,re,J,De=F.data,ie=F.width,He=F.height,Ge=4*ie,dt=0;dt<He;){for(X=0;X<Ge;){for(be=Ge*dt+X,Xe=-1,re=0,J=0;J<64;J++)L=be+(re=J>>3)*Ge+(Xe=4*(7&J)),dt+re>=He&&(L-=Ge*(dt+1+re-He)),X+Xe>=Ge&&(L-=X+Xe-Ge+4),D=De[L++],V=De[L++],Z=De[L++],y[J]=(I[D]+I[V+256|0]+I[Z+512|0]>>16)-128,b[J]=(I[D+768|0]+I[V+1024|0]+I[Z+1280|0]>>16)-128,w[J]=(I[D+1280|0]+I[V+1536|0]+I[Z+1792|0]>>16)-128;K=Oe(y,u,K,e,n),U=Oe(b,d,U,r,a),W=Oe(w,d,W,r,a),X+=32}dt+=8}if(v>=0){var _t=[];_t[1]=v+1,_t[0]=(1<<v+1)-1,ue(_t)}return ne(65497),new Uint8Array(p)},t=t||50,function(){for(var F=String.fromCharCode,H=0;H<256;H++)j[H]=F(H)}(),e=ce(S,E),r=ce(P,O),n=ce(B,k),a=ce(z,oe),function(){for(var F=1,H=2,K=1;K<=15;K++){for(var U=F;U<H;U++)A[32767+U]=K,f[32767+U]=[],f[32767+U][1]=K,f[32767+U][0]=U;for(var W=-(H-1);W<=-F;W++)A[32767+W]=K,f[32767+W]=[],f[32767+W][1]=K,f[32767+W][0]=H-1+W;F<<=1,H<<=1}}(),function(){for(var F=0;F<256;F++)I[F]=19595*F,I[F+256|0]=38470*F,I[F+512|0]=7471*F+32768,I[F+768|0]=-11059*F,I[F+1024|0]=-21709*F,I[F+1280|0]=32768*F+8421375,I[F+1536|0]=-27439*F,I[F+1792|0]=-5329*F}(),Ue(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Wd(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function HV(t){function e(E){if(!E)throw Error("assert :P")}function r(E,B,k){for(var P=0;4>P;P++)if(E[B+P]!=k.charCodeAt(P))return!0;return!1}function n(E,B,k,P,O){for(var z=0;z<O;z++)E[B+z]=k[P+z]}function a(E,B,k,P){for(var O=0;O<P;O++)E[B+O]=k}function s(E){return new Int32Array(E)}function o(E,B){for(var k=[],P=0;P<E;P++)k.push(new B);return k}function l(E,B){var k=[];return function P(O,z,oe){for(var ce=oe[z],ue=0;ue<ce&&(O.push(oe.length>z+1?[]:new B),!(oe.length<z+1));ue++)P(O[ue],z+1,oe)}(k,0,E),k}var c=function(){var E=this;function B(N,T){for(var q=1<<T-1>>>0;N&q;)q>>>=1;return q?(N&q-1)+q:N}function k(N,T,q,ae,ke){e(!(ae%q));do N[T+(ae-=q)]=ke;while(0<ae)}function P(N,T,q,ae,ke){if(e(2328>=ke),512>=ke)var Ve=s(512);else if((Ve=s(ke))==null)return 0;return function(Ke,Je,rt,mt,Tt,Yt){var pt,Lt,Gt=Je,dr=1<<rt,Wt=s(16),mr=s(16);for(e(Tt!=0),e(mt!=null),e(Ke!=null),e(0<rt),Lt=0;Lt<Tt;++Lt){if(15<mt[Lt])return 0;++Wt[mt[Lt]]}if(Wt[0]==Tt)return 0;for(mr[1]=0,pt=1;15>pt;++pt){if(Wt[pt]>1<<pt)return 0;mr[pt+1]=mr[pt]+Wt[pt]}for(Lt=0;Lt<Tt;++Lt)pt=mt[Lt],0<mt[Lt]&&(Yt[mr[pt]++]=Lt);if(mr[15]==1)return(mt=new O).g=0,mt.value=Yt[0],k(Ke,Gt,1,dr,mt),dr;var gr,Tr=-1,Cr=dr-1,yn=0,cn=1,Xn=1,mn=1<<rt;for(Lt=0,pt=1,Tt=2;pt<=rt;++pt,Tt<<=1){if(cn+=Xn<<=1,0>(Xn-=Wt[pt]))return 0;for(;0<Wt[pt];--Wt[pt])(mt=new O).g=pt,mt.value=Yt[Lt++],k(Ke,Gt+yn,Tt,mn,mt),yn=B(yn,pt)}for(pt=rt+1,Tt=2;15>=pt;++pt,Tt<<=1){if(cn+=Xn<<=1,0>(Xn-=Wt[pt]))return 0;for(;0<Wt[pt];--Wt[pt]){if(mt=new O,(yn&Cr)!=Tr){for(Gt+=mn,gr=1<<(Tr=pt)-rt;15>Tr&&!(0>=(gr-=Wt[Tr]));)++Tr,gr<<=1;dr+=mn=1<<(gr=Tr-rt),Ke[Je+(Tr=yn&Cr)].g=gr+rt,Ke[Je+Tr].value=Gt-Je-Tr}mt.g=pt-rt,mt.value=Yt[Lt++],k(Ke,Gt+(yn>>rt),Tt,mn,mt),yn=B(yn,pt)}}return cn!=2*mr[15]-1?0:dr}(N,T,q,ae,ke,Ve)}function O(){this.value=this.g=0}function z(){this.value=this.g=0}function oe(){this.G=o(5,O),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Km,z)}function ce(N,T,q,ae){e(N!=null),e(T!=null),e(2147483648>ae),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=T,N.pa=q,N.Jd=T,N.Yc=q+ae,N.Zc=4<=ae?q+ae-4+1:q,D(N)}function ue(N,T){for(var q=0;0<T--;)q|=Z(N,128)<<T;return q}function ge(N,T){var q=ue(N,T);return V(N)?-q:q}function ne(N,T,q,ae){var ke,Ve=0;for(e(N!=null),e(T!=null),e(4294967288>ae),N.Sb=ae,N.Ra=0,N.u=0,N.h=0,4<ae&&(ae=4),ke=0;ke<ae;++ke)Ve+=T[q+ke]<<8*ke;N.Ra=Ve,N.bb=ae,N.oa=T,N.pa=q}function Oe(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<zA-8>>>0,++N.bb,N.u-=8;U(N)&&(N.h=1,N.u=0)}function Ue(N,T){if(e(0<=T),!N.h&&T<=mu){var q=K(N)&Au[T];return N.u+=T,Oe(N),q}return N.h=1,N.u=0}function F(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function K(N){return N.Ra>>>(N.u&zA-1)>>>0}function U(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>zA}function W(N,T){N.u=T,N.h=U(N)}function X(N){N.u>=yh&&(e(N.u>=yh),Oe(N))}function D(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function V(N){return ue(N,1)}function Z(N,T){var q=N.Ca;0>N.b&&D(N);var ae=N.b,ke=q*T>>>8,Ve=(N.I>>>ae>ke)+0;for(Ve?(q-=ke,N.I-=ke+1<<ae>>>0):q=ke+1,ae=q,ke=0;256<=ae;)ke+=8,ae>>=8;return ae=7^ke+WA[ae],N.b-=ae,N.Ca=(q<<ae)-1,Ve}function be(N,T,q){N[T+0]=q>>24&255,N[T+1]=q>>16&255,N[T+2]=q>>8&255,N[T+3]=255&q}function L(N,T){return N[T+0]|N[T+1]<<8}function Xe(N,T){return L(N,T)|N[T+2]<<16}function re(N,T){return L(N,T)|L(N,T+2)<<16}function J(N,T){var q=1<<T;return e(N!=null),e(0<T),N.X=s(q),N.X==null?0:(N.Mb=32-T,N.Xa=T,1)}function De(N,T){e(N!=null),e(T!=null),e(N.Xa==T.Xa),n(T.X,0,N.X,0,1<<T.Xa)}function ie(){this.X=[],this.Xa=this.Mb=0}function He(N,T,q,ae){e(q!=null),e(ae!=null);var ke=q[0],Ve=ae[0];return ke==0&&(ke=(N*Ve+T/2)/T),Ve==0&&(Ve=(T*ke+N/2)/N),0>=ke||0>=Ve?0:(q[0]=ke,ae[0]=Ve,1)}function Ge(N,T){return N+(1<<T)-1>>>T}function dt(N,T){return((4278255360&N)+(4278255360&T)>>>0&4278255360)+((16711935&N)+(16711935&T)>>>0&16711935)>>>0}function _t(N,T){E[T]=function(q,ae,ke,Ve,Ke,Je,rt){var mt;for(mt=0;mt<Ke;++mt){var Tt=E[N](Je[rt+mt-1],ke,Ve+mt);Je[rt+mt]=dt(q[ae+mt],Tt)}}}function Bt(){this.ud=this.hd=this.jd=0}function Ot(N,T){return((4278124286&(N^T))>>>1)+(N&T)>>>0}function jt(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function Qt(N,T){return jt(N+(N-T+.5>>1))}function Ft(N,T,q){return Math.abs(T-q)-Math.abs(N-q)}function $e(N,T,q,ae,ke,Ve,Ke){for(ae=Ve[Ke-1],q=0;q<ke;++q)Ve[Ke+q]=ae=dt(N[T+q],ae)}function Fe(N,T,q,ae,ke){var Ve;for(Ve=0;Ve<q;++Ve){var Ke=N[T+Ve],Je=Ke>>8&255,rt=16711935&(rt=(rt=16711935&Ke)+((Je<<16)+Je));ae[ke+Ve]=(4278255360&Ke)+rt>>>0}}function Ze(N,T){T.jd=255&N,T.hd=N>>8&255,T.ud=N>>16&255}function Te(N,T,q,ae,ke,Ve){var Ke;for(Ke=0;Ke<ae;++Ke){var Je=T[q+Ke],rt=Je>>>8,mt=Je,Tt=255&(Tt=(Tt=Je>>>16)+((N.jd<<24>>24)*(rt<<24>>24)>>>5));mt=255&(mt=(mt+=(N.hd<<24>>24)*(rt<<24>>24)>>>5)+((N.ud<<24>>24)*(Tt<<24>>24)>>>5)),ke[Ve+Ke]=(4278255360&Je)+(Tt<<16)+mt}}function ee(N,T,q,ae,ke){E[T]=function(Ve,Ke,Je,rt,mt,Tt,Yt,pt,Lt){for(rt=Yt;rt<pt;++rt)for(Yt=0;Yt<Lt;++Yt)mt[Tt++]=ke(Je[ae(Ve[Ke++])])},E[N]=function(Ve,Ke,Je,rt,mt,Tt,Yt){var pt=8>>Ve.b,Lt=Ve.Ea,Gt=Ve.K[0],dr=Ve.w;if(8>pt)for(Ve=(1<<Ve.b)-1,dr=(1<<pt)-1;Ke<Je;++Ke){var Wt,mr=0;for(Wt=0;Wt<Lt;++Wt)Wt&Ve||(mr=ae(rt[mt++])),Tt[Yt++]=ke(Gt[mr&dr]),mr>>=pt}else E["VP8LMapColor"+q](rt,mt,Gt,dr,Tt,Yt,Ke,Je,Lt)}}function me(N,T,q,ae,ke){for(q=T+q;T<q;){var Ve=N[T++];ae[ke++]=Ve>>16&255,ae[ke++]=Ve>>8&255,ae[ke++]=255&Ve}}function Re(N,T,q,ae,ke){for(q=T+q;T<q;){var Ve=N[T++];ae[ke++]=Ve>>16&255,ae[ke++]=Ve>>8&255,ae[ke++]=255&Ve,ae[ke++]=Ve>>24&255}}function he(N,T,q,ae,ke){for(q=T+q;T<q;){var Ve=(Ke=N[T++])>>16&240|Ke>>12&15,Ke=240&Ke|Ke>>28&15;ae[ke++]=Ve,ae[ke++]=Ke}}function qe(N,T,q,ae,ke){for(q=T+q;T<q;){var Ve=(Ke=N[T++])>>16&248|Ke>>13&7,Ke=Ke>>5&224|Ke>>3&31;ae[ke++]=Ve,ae[ke++]=Ke}}function st(N,T,q,ae,ke){for(q=T+q;T<q;){var Ve=N[T++];ae[ke++]=255&Ve,ae[ke++]=Ve>>8&255,ae[ke++]=Ve>>16&255}}function yt(N,T,q,ae,ke,Ve){if(Ve==0)for(q=T+q;T<q;)be(ae,((Ve=N[T++])[0]>>24|Ve[1]>>8&65280|Ve[2]<<8&16711680|Ve[3]<<24)>>>0),ke+=32;else n(ae,ke,N,T,q)}function pe(N,T){E[T][0]=E[N+"0"],E[T][1]=E[N+"1"],E[T][2]=E[N+"2"],E[T][3]=E[N+"3"],E[T][4]=E[N+"4"],E[T][5]=E[N+"5"],E[T][6]=E[N+"6"],E[T][7]=E[N+"7"],E[T][8]=E[N+"8"],E[T][9]=E[N+"9"],E[T][10]=E[N+"10"],E[T][11]=E[N+"11"],E[T][12]=E[N+"12"],E[T][13]=E[N+"13"],E[T][14]=E[N+"0"],E[T][15]=E[N+"0"]}function je(N){return N==B3||N==T3||N==CN||N==k3}function we(){this.eb=[],this.size=this.A=this.fb=0}function Ye(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function xe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new we,this.f.kb=new Ye,this.sd=null}function Se(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function xt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Pt(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function It(N,T){var q=N.T,ae=T.ba.f.RGBA,ke=ae.eb,Ve=ae.fb+N.ka*ae.A,Ke=Zu[T.ba.S],Je=N.y,rt=N.O,mt=N.f,Tt=N.N,Yt=N.ea,pt=N.W,Lt=T.cc,Gt=T.dc,dr=T.Mc,Wt=T.Nc,mr=N.ka,gr=N.ka+N.T,Tr=N.U,Cr=Tr+1>>1;for(mr==0?Ke(Je,rt,null,null,mt,Tt,Yt,pt,mt,Tt,Yt,pt,ke,Ve,null,null,Tr):(Ke(T.ec,T.fc,Je,rt,Lt,Gt,dr,Wt,mt,Tt,Yt,pt,ke,Ve-ae.A,ke,Ve,Tr),++q);mr+2<gr;mr+=2)Lt=mt,Gt=Tt,dr=Yt,Wt=pt,Tt+=N.Rc,pt+=N.Rc,Ve+=2*ae.A,Ke(Je,(rt+=2*N.fa)-N.fa,Je,rt,Lt,Gt,dr,Wt,mt,Tt,Yt,pt,ke,Ve-ae.A,ke,Ve,Tr);return rt+=N.fa,N.j+gr<N.o?(n(T.ec,T.fc,Je,rt,Tr),n(T.cc,T.dc,mt,Tt,Cr),n(T.Mc,T.Nc,Yt,pt,Cr),q--):1&gr||Ke(Je,rt,null,null,mt,Tt,Yt,pt,mt,Tt,Yt,pt,ke,Ve+ae.A,null,null,Tr),q}function Ut(N,T,q){var ae=N.F,ke=[N.J];if(ae!=null){var Ve=N.U,Ke=T.ba.S,Je=Ke==NN||Ke==CN;T=T.ba.f.RGBA;var rt=[0],mt=N.ka;rt[0]=N.T,N.Kb&&(mt==0?--rt[0]:(--mt,ke[0]-=N.width),N.j+N.ka+N.T==N.o&&(rt[0]=N.o-N.j-mt));var Tt=T.eb;mt=T.fb+mt*T.A,N=X8(ae,ke[0],N.width,Ve,rt,Tt,mt+(Je?0:3),T.A),e(q==rt),N&&je(Ke)&&Q1(Tt,mt,Je,Ve,rt,T.A)}return 0}function Ht(N){var T=N.ma,q=T.ba.S,ae=11>q,ke=q==bN||q==wN||q==NN||q==P3||q==12||je(q);if(T.memory=null,T.Ib=null,T.Jb=null,T.Nd=null,!k1(T.Oa,N,ke?11:12))return 0;if(ke&&je(q)&&Xu(),N.da)alert("todo:use_scaling");else{if(ae){if(T.Ib=Pt,N.Kb){if(q=N.U+1>>1,T.memory=s(N.U+2*q),T.memory==null)return 0;T.ec=T.memory,T.fc=0,T.cc=T.ec,T.dc=T.fc+N.U,T.Mc=T.cc,T.Nc=T.dc+q,T.Ib=It,Xu()}}else alert("todo:EmitYUV");ke&&(T.Jb=Ut,ae&&Uc())}if(ae&&!fL){for(N=0;256>N;++N)Ide[N]=89858*(N-128)+EN>>_N,Bde[N]=-22014*(N-128)+EN,Pde[N]=-45773*(N-128),jde[N]=113618*(N-128)+EN>>_N;for(N=H1;N<D3;++N)T=76283*(N-16)+EN>>_N,Tde[N-H1]=Er(T,255),kde[N-H1]=Er(T+8>>4,15);fL=1}return 1}function Le(N){var T=N.ma,q=N.U,ae=N.T;return e(!(1&N.ka)),0>=q||0>=ae?0:(q=T.Ib(N,T),T.Jb!=null&&T.Jb(N,T,q),T.Dc+=q,1)}function Ce(N){N.ma.memory=null}function Ae(N,T,q,ae){return Ue(N,8)!=47?0:(T[0]=Ue(N,14)+1,q[0]=Ue(N,14)+1,ae[0]=Ue(N,1),Ue(N,3)!=0?0:!N.h)}function Qe(N,T){if(4>N)return N+1;var q=N-2>>1;return(2+(1&N)<<q)+Ue(T,q)+1}function fe(N,T){return 120<T?T-120:1<=(q=((q=Ade[T-1])>>4)*N+(8-(15&q)))?q:1;var q}function te(N,T,q){var ae=K(q),ke=N[T+=255&ae].g-8;return 0<ke&&(W(q,q.u+8),ae=K(q),T+=N[T].value,T+=ae&(1<<ke)-1),W(q,q.u+N[T].g),N[T].value}function _e(N,T,q){return q.g+=N.g,q.value+=N.value<<T>>>0,e(8>=q.g),N.g}function R(N,T,q){var ae=N.xc;return e((T=ae==0?0:N.vc[N.md*(q>>ae)+(T>>ae)])<N.Wb),N.Ya[T]}function Q(N,T,q,ae){var ke=N.ab,Ve=N.c*T,Ke=N.C;T=Ke+T;var Je=q,rt=ae;for(ae=N.Ta,q=N.Ua;0<ke--;){var mt=N.gc[ke],Tt=Ke,Yt=T,pt=Je,Lt=rt,Gt=(rt=ae,Je=q,mt.Ea);switch(e(Tt<Yt),e(Yt<=mt.nc),mt.hc){case 2:Bi(pt,Lt,(Yt-Tt)*Gt,rt,Je);break;case 0:var dr=Tt,Wt=Yt,mr=rt,gr=Je,Tr=(mn=mt).Ea;dr==0&&(O1(pt,Lt,null,null,1,mr,gr),$e(pt,Lt+1,0,0,Tr-1,mr,gr+1),Lt+=Tr,gr+=Tr,++dr);for(var Cr=1<<mn.b,yn=Cr-1,cn=Ge(Tr,mn.b),Xn=mn.K,mn=mn.w+(dr>>mn.b)*cn;dr<Wt;){var pa=Xn,Ao=mn,Yn=1;for(zg(pt,Lt,mr,gr-Tr,1,mr,gr);Yn<Tr;){var pn=(Yn&~yn)+Cr;pn>Tr&&(pn=Tr),(0,R1[pa[Ao++]>>8&15])(pt,Lt+ +Yn,mr,gr+Yn-Tr,pn-Yn,mr,gr+Yn),Yn=pn}Lt+=Tr,gr+=Tr,++dr&yn||(mn+=cn)}Yt!=mt.nc&&n(rt,Je-Gt,rt,Je+(Yt-Tt-1)*Gt,Gt);break;case 1:for(Gt=pt,Wt=Lt,Tr=(pt=mt.Ea)-(gr=pt&~(mr=(Lt=1<<mt.b)-1)),dr=Ge(pt,mt.b),Cr=mt.K,mt=mt.w+(Tt>>mt.b)*dr;Tt<Yt;){for(yn=Cr,cn=mt,Xn=new Bt,mn=Wt+gr,pa=Wt+pt;Wt<mn;)Ze(yn[cn++],Xn),M1(Xn,Gt,Wt,Lt,rt,Je),Wt+=Lt,Je+=Lt;Wt<pa&&(Ze(yn[cn++],Xn),M1(Xn,Gt,Wt,Tr,rt,Je),Wt+=Tr,Je+=Tr),++Tt&mr||(mt+=dr)}break;case 3:if(pt==rt&&Lt==Je&&0<mt.b){for(Wt=rt,pt=Gt=Je+(Yt-Tt)*Gt-(gr=(Yt-Tt)*Ge(mt.Ea,mt.b)),Lt=rt,mr=Je,dr=[],gr=(Tr=gr)-1;0<=gr;--gr)dr[gr]=Lt[mr+gr];for(gr=Tr-1;0<=gr;--gr)Wt[pt+gr]=dr[gr];gN(mt,Tt,Yt,rt,Gt,rt,Je)}else gN(mt,Tt,Yt,pt,Lt,rt,Je)}Je=ae,rt=q}rt!=q&&n(ae,q,Je,rt,Ve)}function G(N,T){var q=N.V,ae=N.Ba+N.c*N.C,ke=T-N.C;if(e(T<=N.l.o),e(16>=ke),0<ke){var Ve=N.l,Ke=N.Ta,Je=N.Ua,rt=Ve.width;if(Q(N,ke,q,ae),ke=Je=[Je],e((q=N.C)<(ae=T)),e(Ve.v<Ve.va),ae>Ve.o&&(ae=Ve.o),q<Ve.j){var mt=Ve.j-q;q=Ve.j,ke[0]+=mt*rt}if(q>=ae?q=0:(ke[0]+=4*Ve.v,Ve.ka=q-Ve.j,Ve.U=Ve.va-Ve.v,Ve.T=ae-q,q=1),q){if(Je=Je[0],11>(q=N.ca).S){var Tt=q.f.RGBA,Yt=(ae=q.S,ke=Ve.U,Ve=Ve.T,mt=Tt.eb,Tt.A),pt=Ve;for(Tt=Tt.fb+N.Ma*Tt.A;0<pt--;){var Lt=Ke,Gt=Je,dr=ke,Wt=mt,mr=Tt;switch(ae){case yN:L1(Lt,Gt,dr,Wt,mr);break;case bN:XA(Lt,Gt,dr,Wt,mr);break;case B3:XA(Lt,Gt,dr,Wt,mr),Q1(Wt,mr,0,dr,1,0);break;case nL:Gm(Lt,Gt,dr,Wt,mr);break;case wN:yt(Lt,Gt,dr,Wt,mr,1);break;case T3:yt(Lt,Gt,dr,Wt,mr,1),Q1(Wt,mr,0,dr,1,0);break;case NN:yt(Lt,Gt,dr,Wt,mr,0);break;case CN:yt(Lt,Gt,dr,Wt,mr,0),Q1(Wt,mr,1,dr,1,0);break;case P3:YA(Lt,Gt,dr,Wt,mr);break;case k3:YA(Lt,Gt,dr,Wt,mr),W8(Wt,mr,dr,1,0);break;case aL:JA(Lt,Gt,dr,Wt,mr);break;default:e(0)}Je+=rt,Tt+=Yt}N.Ma+=Ve}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=q.height)}}N.C=T,e(N.C<=N.i)}function se(N){var T;if(0<N.ua)return 0;for(T=0;T<N.Wb;++T){var q=N.Ya[T].G,ae=N.Ya[T].H;if(0<q[1][ae[1]+0].g||0<q[2][ae[2]+0].g||0<q[3][ae[3]+0].g)return 0}return 1}function Ne(N,T,q,ae,ke,Ve){if(N.Z!=0){var Ke=N.qd,Je=N.rd;for(e(t0[N.Z]!=null);T<q;++T)t0[N.Z](Ke,Je,ae,ke,ae,ke,Ve),Ke=ae,Je=ke,ke+=Ve;N.qd=Ke,N.rd=Je}}function Me(N,T){var q=N.l.ma,ae=q.Z==0||q.Z==1?N.l.j:N.C;if(ae=N.C<ae?ae:N.C,e(T<=N.l.o),T>ae){var ke=N.l.width,Ve=q.ca,Ke=q.tb+ke*ae,Je=N.V,rt=N.Ba+N.c*ae,mt=N.gc;e(N.ab==1),e(mt[0].hc==3),kf(mt[0],ae,T,Je,rt,Ve,Ke),Ne(q,ae,T,Ve,Ke,ke)}N.C=N.Ma=T}function ze(N,T,q,ae,ke,Ve,Ke){var Je=N.$/ae,rt=N.$%ae,mt=N.m,Tt=N.s,Yt=q+N.$,pt=Yt;ke=q+ae*ke;var Lt=q+ae*Ve,Gt=280+Tt.ua,dr=N.Pb?Je:16777216,Wt=0<Tt.ua?Tt.Wa:null,mr=Tt.wc,gr=Yt<Lt?R(Tt,rt,Je):null;e(N.C<Ve),e(Lt<=ke);var Tr=!1;e:for(;;){for(;Tr||Yt<Lt;){var Cr=0;if(Je>=dr){var yn=Yt-q;e((dr=N).Pb),dr.wd=dr.m,dr.xd=yn,0<dr.s.ua&&De(dr.s.Wa,dr.s.vb),dr=Je+pde}if(rt&mr||(gr=R(Tt,rt,Je)),e(gr!=null),gr.Qb&&(T[Yt]=gr.qb,Tr=!0),!Tr)if(X(mt),gr.jc){Cr=mt,yn=T;var cn=Yt,Xn=gr.pd[K(Cr)&Km-1];e(gr.jc),256>Xn.g?(W(Cr,Cr.u+Xn.g),yn[cn]=Xn.value,Cr=0):(W(Cr,Cr.u+Xn.g-256),e(256<=Xn.value),Cr=Xn.value),Cr==0&&(Tr=!0)}else Cr=te(gr.G[0],gr.H[0],mt);if(mt.h)break;if(Tr||256>Cr){if(!Tr)if(gr.nd)T[Yt]=(gr.qb|Cr<<8)>>>0;else{if(X(mt),Tr=te(gr.G[1],gr.H[1],mt),X(mt),yn=te(gr.G[2],gr.H[2],mt),cn=te(gr.G[3],gr.H[3],mt),mt.h)break;T[Yt]=(cn<<24|Tr<<16|Cr<<8|yn)>>>0}if(Tr=!1,++Yt,++rt>=ae&&(rt=0,++Je,Ke!=null&&Je<=Ve&&!(Je%16)&&Ke(N,Je),Wt!=null))for(;pt<Yt;)Cr=T[pt++],Wt.X[(506832829*Cr&4294967295)>>>Wt.Mb]=Cr}else if(280>Cr){if(Cr=Qe(Cr-256,mt),yn=te(gr.G[4],gr.H[4],mt),X(mt),yn=fe(ae,yn=Qe(yn,mt)),mt.h)break;if(Yt-q<yn||ke-Yt<Cr)break e;for(cn=0;cn<Cr;++cn)T[Yt+cn]=T[Yt+cn-yn];for(Yt+=Cr,rt+=Cr;rt>=ae;)rt-=ae,++Je,Ke!=null&&Je<=Ve&&!(Je%16)&&Ke(N,Je);if(e(Yt<=ke),rt&mr&&(gr=R(Tt,rt,Je)),Wt!=null)for(;pt<Yt;)Cr=T[pt++],Wt.X[(506832829*Cr&4294967295)>>>Wt.Mb]=Cr}else{if(!(Cr<Gt))break e;for(Tr=Cr-280,e(Wt!=null);pt<Yt;)Cr=T[pt++],Wt.X[(506832829*Cr&4294967295)>>>Wt.Mb]=Cr;Cr=Yt,e(!(Tr>>>(yn=Wt).Xa)),T[Cr]=yn.X[Tr],Tr=!0}Tr||e(mt.h==U(mt))}if(N.Pb&&mt.h&&Yt<ke)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&De(N.s.vb,N.s.Wa);else{if(mt.h)break e;Ke!=null&&Ke(N,Je>Ve?Ve:Je),N.a=0,N.$=Yt-q}return 1}return N.a=3,0}function Ie(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var T=N.Wa;T!=null&&(T.X=null),N.vb=null,e(N!=null)}function nt(){var N=new Tn;return N==null?null:(N.a=0,N.xb=oL,pe("Predictor","VP8LPredictors"),pe("Predictor","VP8LPredictors_C"),pe("PredictorAdd","VP8LPredictorsAdd"),pe("PredictorAdd","VP8LPredictorsAdd_C"),Bi=Fe,M1=Te,L1=me,XA=Re,YA=he,JA=qe,Gm=st,E.VP8LMapColor32b=Tf,E.VP8LMapColor8b=D1,N)}function lt(N,T,q,ae,ke){var Ve=1,Ke=[N],Je=[T],rt=ae.m,mt=ae.s,Tt=null,Yt=0;e:for(;;){if(q)for(;Ve&&Ue(rt,1);){var pt=Ke,Lt=Je,Gt=ae,dr=1,Wt=Gt.m,mr=Gt.gc[Gt.ab],gr=Ue(Wt,2);if(Gt.Oc&1<<gr)Ve=0;else{switch(Gt.Oc|=1<<gr,mr.hc=gr,mr.Ea=pt[0],mr.nc=Lt[0],mr.K=[null],++Gt.ab,e(4>=Gt.ab),gr){case 0:case 1:mr.b=Ue(Wt,3)+2,dr=lt(Ge(mr.Ea,mr.b),Ge(mr.nc,mr.b),0,Gt,mr.K),mr.K=mr.K[0];break;case 3:var Tr,Cr=Ue(Wt,8)+1,yn=16<Cr?0:4<Cr?1:2<Cr?2:3;if(pt[0]=Ge(mr.Ea,yn),mr.b=yn,Tr=dr=lt(Cr,1,0,Gt,mr.K)){var cn,Xn=Cr,mn=mr,pa=1<<(8>>mn.b),Ao=s(pa);if(Ao==null)Tr=0;else{var Yn=mn.K[0],pn=mn.w;for(Ao[0]=mn.K[0][0],cn=1;cn<1*Xn;++cn)Ao[cn]=dt(Yn[pn+cn],Ao[cn-1]);for(;cn<4*pa;++cn)Ao[cn]=0;mn.K[0]=null,mn.K[0]=Ao,Tr=1}}dr=Tr;break;case 2:break;default:e(0)}Ve=dr}}if(Ke=Ke[0],Je=Je[0],Ve&&Ue(rt,1)&&!(Ve=1<=(Yt=Ue(rt,4))&&11>=Yt)){ae.a=3;break e}var Wr;if(Wr=Ve)t:{var ki,Kn,va,_s=ae,ul=Ke,fc=Je,xi=Yt,Rl=q,hc=_s.m,mo=_s.s,wa=[null],Ha=1,vi=0,$a=mde[xi];r:for(;;){if(Rl&&Ue(hc,1)){var dl=Ue(hc,3)+2,Gd=Ge(ul,dl),Fi=Ge(fc,dl),Qc=Gd*Fi;if(!lt(Gd,Fi,0,_s,wa))break r;for(wa=wa[0],mo.xc=dl,ki=0;ki<Qc;++ki){var fs=wa[ki]>>8&65535;wa[ki]=fs,fs>=Ha&&(Ha=fs+1)}}if(hc.h)break r;for(Kn=0;5>Kn;++Kn){var po=sL[Kn];!Kn&&0<xi&&(po+=1<<xi),vi<po&&(vi=po)}var gu=o(Ha*$a,O),Ac=Ha,xu=o(Ac,oe);if(xu==null)var vu=null;else e(65536>=Ac),vu=xu;var Vc=s(vi);if(vu==null||Vc==null||gu==null){_s.a=1;break r}var yu=gu;for(ki=va=0;ki<Ha;++ki){var xs=vu[ki],bu=xs.G,qd=xs.H,zm=0,Nh=1,fl=0;for(Kn=0;5>Kn;++Kn){po=sL[Kn],bu[Kn]=yu,qd[Kn]=va,!Kn&&0<xi&&(po+=1<<xi);a:{var IN,R3=po,jN=_s,$1=Vc,Dde=yu,Rde=va,M3=0,r0=jN.m,Mde=Ue(r0,1);if(a($1,0,0,R3),Mde){var Lde=Ue(r0,1)+1,Ude=Ue(r0,1),mL=Ue(r0,Ude==0?1:8);$1[mL]=1,Lde==2&&($1[mL=Ue(r0,8)]=1);var PN=1}else{var pL=s(19),gL=Ue(r0,4)+4;if(19<gL){jN.a=3;var BN=0;break a}for(IN=0;IN<gL;++IN)pL[hde[IN]]=Ue(r0,3);var L3=void 0,K1=void 0,xL=jN,Qde=pL,TN=R3,vL=$1,U3=0,n0=xL.m,yL=8,bL=o(128,O);n:for(;P(bL,0,7,Qde,19);){if(Ue(n0,1)){var Vde=2+2*Ue(n0,3);if((L3=2+Ue(n0,Vde))>TN)break n}else L3=TN;for(K1=0;K1<TN&&L3--;){X(n0);var wL=bL[0+(127&K(n0))];W(n0,n0.u+wL.g);var Xg=wL.value;if(16>Xg)vL[K1++]=Xg,Xg!=0&&(yL=Xg);else{var Hde=Xg==16,NL=Xg-16,$de=dde[NL],CL=Ue(n0,ude[NL])+$de;if(K1+CL>TN)break n;for(var Kde=Hde?yL:0;0<CL--;)vL[K1++]=Kde}}U3=1;break n}U3||(xL.a=3),PN=U3}(PN=PN&&!r0.h)&&(M3=P(Dde,Rde,8,$1,R3)),PN&&M3!=0?BN=M3:(jN.a=3,BN=0)}if(BN==0)break r;if(Nh&&fde[Kn]==1&&(Nh=yu[va].g==0),zm+=yu[va].g,va+=BN,3>=Kn){var G1,Q3=Vc[0];for(G1=1;G1<po;++G1)Vc[G1]>Q3&&(Q3=Vc[G1]);fl+=Q3}}if(xs.nd=Nh,xs.Qb=0,Nh&&(xs.qb=(bu[3][qd[3]+0].value<<24|bu[1][qd[1]+0].value<<16|bu[2][qd[2]+0].value)>>>0,zm==0&&256>bu[0][qd[0]+0].value&&(xs.Qb=1,xs.qb+=bu[0][qd[0]+0].value<<8)),xs.jc=!xs.Qb&&6>fl,xs.jc){var kN,Ch=xs;for(kN=0;kN<Km;++kN){var a0=kN,s0=Ch.pd[a0],FN=Ch.G[0][Ch.H[0]+a0];256<=FN.value?(s0.g=FN.g+256,s0.value=FN.value):(s0.g=0,s0.value=0,a0>>=_e(FN,8,s0),a0>>=_e(Ch.G[1][Ch.H[1]+a0],16,s0),a0>>=_e(Ch.G[2][Ch.H[2]+a0],0,s0),_e(Ch.G[3][Ch.H[3]+a0],24,s0))}}}mo.vc=wa,mo.Wb=Ha,mo.Ya=vu,mo.yc=gu,Wr=1;break t}Wr=0}if(!(Ve=Wr)){ae.a=3;break e}if(0<Yt){if(mt.ua=1<<Yt,!J(mt.Wa,Yt)){ae.a=1,Ve=0;break e}}else mt.ua=0;var V3=ae,_L=Ke,Gde=Je,H3=V3.s,$3=H3.xc;if(V3.c=_L,V3.i=Gde,H3.md=Ge(_L,$3),H3.wc=$3==0?-1:(1<<$3)-1,q){ae.xb=Nde;break e}if((Tt=s(Ke*Je))==null){ae.a=1,Ve=0;break e}Ve=(Ve=ze(ae,Tt,0,Ke,Je,Je,null))&&!rt.h;break e}return Ve?(ke!=null?ke[0]=Tt:(e(Tt==null),e(q)),ae.$=0,q||Ie(mt)):Ie(mt),Ve}function ht(N,T){var q=N.c*N.i,ae=q+T+16*T;return e(N.c<=T),N.V=s(ae),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+q+T,1)}function kt(N,T){var q=N.C,ae=T-q,ke=N.V,Ve=N.Ba+N.c*q;for(e(T<=N.l.o);0<ae;){var Ke=16<ae?16:ae,Je=N.l.ma,rt=N.l.width,mt=rt*Ke,Tt=Je.ca,Yt=Je.tb+rt*q,pt=N.Ta,Lt=N.Ua;Q(N,Ke,ke,Ve),Y8(pt,Lt,Tt,Yt,mt),Ne(Je,q,q+Ke,Tt,Yt,rt),ae-=Ke,ke+=Ke*N.c,q+=Ke}e(q==T),N.C=N.Ma=T}function le(){this.ub=this.yd=this.td=this.Rb=0}function We(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function it(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function ot(){this.Yb=function(){var N=[];return function T(q,ae,ke){for(var Ve=ke[ae],Ke=0;Ke<Ve&&(q.push(ke.length>ae+1?[]:0),!(ke.length<ae+1));Ke++)T(q[Ke],ae+1,ke)}(N,0,[3,11]),N}()}function Nt(){this.jb=s(3),this.Wc=l([4,8],ot),this.Xc=l([4,17],ot)}function Rt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function nr(){this.ld=this.La=this.dd=this.tc=0}function _r(){this.Na=this.la=0}function $r(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function or(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function kr(){this.uc=this.M=this.Nb=0,this.wa=Array(new nr),this.Y=0,this.ya=Array(new or),this.aa=0,this.l=new Ee}function en(){this.y=s(16),this.f=s(8),this.ea=s(8)}function rn(){this.cb=this.a=0,this.sc="",this.m=new F,this.Od=new le,this.Kc=new We,this.ed=new Rt,this.Qa=new it,this.Ic=this.$c=this.Aa=0,this.D=new kr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,F),this.ia=0,this.pb=o(4,$r),this.Pa=new Nt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new en),this.Hd=0,this.rb=Array(new _r),this.sb=0,this.wa=Array(new nr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new or),this.L=this.aa=0,this.gd=l([4,2],nr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Er(N,T){return 0>N?0:N>T?T:N}function Ee(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function gt(){var N=new rn;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,V1||(V1=ir)),N}function Zt(N,T,q){return N.a==0&&(N.a=T,N.sc=q,N.cb=0),0}function Mr(N,T,q){return 3<=q&&N[T+0]==157&&N[T+1]==1&&N[T+2]==42}function Or(N,T){if(N==null)return 0;if(N.a=0,N.sc="OK",T==null)return Zt(N,2,"null VP8Io passed to VP8GetHeaders()");var q=T.data,ae=T.w,ke=T.ha;if(4>ke)return Zt(N,7,"Truncated header.");var Ve=q[ae+0]|q[ae+1]<<8|q[ae+2]<<16,Ke=N.Od;if(Ke.Rb=!(1&Ve),Ke.td=Ve>>1&7,Ke.yd=Ve>>4&1,Ke.ub=Ve>>5,3<Ke.td)return Zt(N,3,"Incorrect keyframe parameters.");if(!Ke.yd)return Zt(N,4,"Frame not displayable.");ae+=3,ke-=3;var Je=N.Kc;if(Ke.Rb){if(7>ke)return Zt(N,7,"cannot parse picture header");if(!Mr(q,ae,ke))return Zt(N,3,"Bad code word");Je.c=16383&(q[ae+4]<<8|q[ae+3]),Je.Td=q[ae+4]>>6,Je.i=16383&(q[ae+6]<<8|q[ae+5]),Je.Ud=q[ae+6]>>6,ae+=7,ke-=7,N.za=Je.c+15>>4,N.Ub=Je.i+15>>4,T.width=Je.c,T.height=Je.i,T.Da=0,T.j=0,T.v=0,T.va=T.width,T.o=T.height,T.da=0,T.ib=T.width,T.hb=T.height,T.U=T.width,T.T=T.height,a((Ve=N.Pa).jb,0,255,Ve.jb.length),e((Ve=N.Qa)!=null),Ve.Cb=0,Ve.Bb=0,Ve.Fb=1,a(Ve.Zb,0,0,Ve.Zb.length),a(Ve.Lb,0,0,Ve.Lb)}if(Ke.ub>ke)return Zt(N,7,"bad partition length");ce(Ve=N.m,q,ae,Ke.ub),ae+=Ke.ub,ke-=Ke.ub,Ke.Rb&&(Je.Ld=V(Ve),Je.Kd=V(Ve)),Je=N.Qa;var rt,mt=N.Pa;if(e(Ve!=null),e(Je!=null),Je.Cb=V(Ve),Je.Cb){if(Je.Bb=V(Ve),V(Ve)){for(Je.Fb=V(Ve),rt=0;4>rt;++rt)Je.Zb[rt]=V(Ve)?ge(Ve,7):0;for(rt=0;4>rt;++rt)Je.Lb[rt]=V(Ve)?ge(Ve,6):0}if(Je.Bb)for(rt=0;3>rt;++rt)mt.jb[rt]=V(Ve)?ue(Ve,8):255}else Je.Bb=0;if(Ve.Ka)return Zt(N,3,"cannot parse segment header");if((Je=N.ed).zd=V(Ve),Je.Tb=ue(Ve,6),Je.wb=ue(Ve,3),Je.Pc=V(Ve),Je.Pc&&V(Ve)){for(mt=0;4>mt;++mt)V(Ve)&&(Je.vd[mt]=ge(Ve,6));for(mt=0;4>mt;++mt)V(Ve)&&(Je.od[mt]=ge(Ve,6))}if(N.L=Je.Tb==0?0:Je.zd?1:2,Ve.Ka)return Zt(N,3,"cannot parse filter header");var Tt=ke;if(ke=rt=ae,ae=rt+Tt,Je=Tt,N.Xb=(1<<ue(N.m,2))-1,Tt<3*(mt=N.Xb))q=7;else{for(rt+=3*mt,Je-=3*mt,Tt=0;Tt<mt;++Tt){var Yt=q[ke+0]|q[ke+1]<<8|q[ke+2]<<16;Yt>Je&&(Yt=Je),ce(N.Jc[+Tt],q,rt,Yt),rt+=Yt,Je-=Yt,ke+=3}ce(N.Jc[+mt],q,rt,Je),q=rt<ae?0:5}if(q!=0)return Zt(N,q,"cannot parse partitions");for(q=ue(rt=N.m,7),ke=V(rt)?ge(rt,4):0,ae=V(rt)?ge(rt,4):0,Je=V(rt)?ge(rt,4):0,mt=V(rt)?ge(rt,4):0,rt=V(rt)?ge(rt,4):0,Tt=N.Qa,Yt=0;4>Yt;++Yt){if(Tt.Cb){var pt=Tt.Zb[Yt];Tt.Fb||(pt+=q)}else{if(0<Yt){N.pb[Yt]=N.pb[0];continue}pt=q}var Lt=N.pb[Yt];Lt.Sc[0]=F3[Er(pt+ke,127)],Lt.Sc[1]=O3[Er(pt+0,127)],Lt.Eb[0]=2*F3[Er(pt+ae,127)],Lt.Eb[1]=101581*O3[Er(pt+Je,127)]>>16,8>Lt.Eb[1]&&(Lt.Eb[1]=8),Lt.Qc[0]=F3[Er(pt+mt,117)],Lt.Qc[1]=O3[Er(pt+rt,127)],Lt.lc=pt+rt}if(!Ke.Rb)return Zt(N,4,"Not a key frame.");for(V(Ve),Ke=N.Pa,q=0;4>q;++q){for(ke=0;8>ke;++ke)for(ae=0;3>ae;++ae)for(Je=0;11>Je;++Je)mt=Z(Ve,bde[q][ke][ae][Je])?ue(Ve,8):vde[q][ke][ae][Je],Ke.Wc[q][ke].Yb[ae][Je]=mt;for(ke=0;17>ke;++ke)Ke.Xc[q][ke]=Ke.Wc[q][wde[ke]]}return N.kc=V(Ve),N.kc&&(N.Bd=ue(Ve,8)),N.cb=1}function ir(N,T,q,ae,ke,Ve,Ke){var Je=T[ke].Yb[q];for(q=0;16>ke;++ke){if(!Z(N,Je[q+0]))return ke;for(;!Z(N,Je[q+1]);)if(Je=T[++ke].Yb[0],q=0,ke==16)return 16;var rt=T[ke+1].Yb;if(Z(N,Je[q+2])){var mt=N,Tt=0;if(Z(mt,(pt=Je)[(Yt=q)+3]))if(Z(mt,pt[Yt+6])){for(Je=0,Yt=2*(Tt=Z(mt,pt[Yt+8]))+(pt=Z(mt,pt[Yt+9+Tt])),Tt=0,pt=gde[Yt];pt[Je];++Je)Tt+=Tt+Z(mt,pt[Je]);Tt+=3+(8<<Yt)}else Z(mt,pt[Yt+7])?(Tt=7+2*Z(mt,165),Tt+=Z(mt,145)):Tt=5+Z(mt,159);else Tt=Z(mt,pt[Yt+4])?3+Z(mt,pt[Yt+5]):2;Je=rt[2]}else Tt=1,Je=rt[1];rt=Ke+xde[ke],0>(mt=N).b&&D(mt);var Yt,pt=mt.b,Lt=(Yt=mt.Ca>>1)-(mt.I>>pt)>>31;--mt.b,mt.Ca+=Lt,mt.Ca|=1,mt.I-=(Yt+1&Lt)<<pt,Ve[rt]=((Tt^Lt)-Lt)*ae[(0<ke)+0]}return 16}function br(N){var T=N.rb[N.sb-1];T.la=0,T.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function wr(N,T,q,ae,ke){ke=N[T+q+32*ae]+(ke>>3),N[T+q+32*ae]=-256&ke?0>ke?0:255:ke}function Xr(N,T,q,ae,ke,Ve){wr(N,T,0,q,ae+ke),wr(N,T,1,q,ae+Ve),wr(N,T,2,q,ae-Ve),wr(N,T,3,q,ae-ke)}function Ir(N){return(20091*N>>16)+N}function Pr(N,T,q,ae){var ke,Ve=0,Ke=s(16);for(ke=0;4>ke;++ke){var Je=N[T+0]+N[T+8],rt=N[T+0]-N[T+8],mt=(35468*N[T+4]>>16)-Ir(N[T+12]),Tt=Ir(N[T+4])+(35468*N[T+12]>>16);Ke[Ve+0]=Je+Tt,Ke[Ve+1]=rt+mt,Ke[Ve+2]=rt-mt,Ke[Ve+3]=Je-Tt,Ve+=4,T++}for(ke=Ve=0;4>ke;++ke)Je=(N=Ke[Ve+0]+4)+Ke[Ve+8],rt=N-Ke[Ve+8],mt=(35468*Ke[Ve+4]>>16)-Ir(Ke[Ve+12]),wr(q,ae,0,0,Je+(Tt=Ir(Ke[Ve+4])+(35468*Ke[Ve+12]>>16))),wr(q,ae,1,0,rt+mt),wr(q,ae,2,0,rt-mt),wr(q,ae,3,0,Je-Tt),Ve++,ae+=32}function fn(N,T,q,ae){var ke=N[T+0]+4,Ve=35468*N[T+4]>>16,Ke=Ir(N[T+4]),Je=35468*N[T+1]>>16;Xr(q,ae,0,ke+Ke,N=Ir(N[T+1]),Je),Xr(q,ae,1,ke+Ve,N,Je),Xr(q,ae,2,ke-Ve,N,Je),Xr(q,ae,3,ke-Ke,N,Je)}function de(N,T,q,ae,ke){Pr(N,T,q,ae),ke&&Pr(N,T+16,q,ae+4)}function tt(N,T,q,ae){qm(N,T+0,q,ae,1),qm(N,T+32,q,ae+128,1)}function at(N,T,q,ae){var ke;for(N=N[T+0]+4,ke=0;4>ke;++ke)for(T=0;4>T;++T)wr(q,ae,T,ke,N)}function ct(N,T,q,ae){N[T+0]&&Ma(N,T+0,q,ae),N[T+16]&&Ma(N,T+16,q,ae+4),N[T+32]&&Ma(N,T+32,q,ae+128),N[T+48]&&Ma(N,T+48,q,ae+128+4)}function ye(N,T,q,ae){var ke,Ve=s(16);for(ke=0;4>ke;++ke){var Ke=N[T+0+ke]+N[T+12+ke],Je=N[T+4+ke]+N[T+8+ke],rt=N[T+4+ke]-N[T+8+ke],mt=N[T+0+ke]-N[T+12+ke];Ve[0+ke]=Ke+Je,Ve[8+ke]=Ke-Je,Ve[4+ke]=mt+rt,Ve[12+ke]=mt-rt}for(ke=0;4>ke;++ke)Ke=(N=Ve[0+4*ke]+3)+Ve[3+4*ke],Je=Ve[1+4*ke]+Ve[2+4*ke],rt=Ve[1+4*ke]-Ve[2+4*ke],mt=N-Ve[3+4*ke],q[ae+0]=Ke+Je>>3,q[ae+16]=mt+rt>>3,q[ae+32]=Ke-Je>>3,q[ae+48]=mt-rt>>3,ae+=64}function ft(N,T,q){var ae,ke=T-32,Ve=pu,Ke=255-N[ke-1];for(ae=0;ae<q;++ae){var Je,rt=Ve,mt=Ke+N[T-1];for(Je=0;Je<q;++Je)N[T+Je]=rt[mt+N[ke+Je]];T+=32}}function St(N,T){ft(N,T,4)}function wt(N,T){ft(N,T,8)}function vt(N,T){ft(N,T,16)}function Et(N,T){var q;for(q=0;16>q;++q)n(N,T+32*q,N,T-32,16)}function qt(N,T){var q;for(q=16;0<q;--q)a(N,T,N[T-1],16),T+=32}function Mt(N,T,q){var ae;for(ae=0;16>ae;++ae)a(T,q+32*ae,N,16)}function Xt(N,T){var q,ae=16;for(q=0;16>q;++q)ae+=N[T-1+32*q]+N[T+q-32];Mt(ae>>5,N,T)}function ar(N,T){var q,ae=8;for(q=0;16>q;++q)ae+=N[T-1+32*q];Mt(ae>>4,N,T)}function vr(N,T){var q,ae=8;for(q=0;16>q;++q)ae+=N[T+q-32];Mt(ae>>4,N,T)}function ur(N,T){Mt(128,N,T)}function Dt(N,T,q){return N+2*T+q+2>>2}function Yr(N,T){var q,ae=T-32;for(ae=new Uint8Array([Dt(N[ae-1],N[ae+0],N[ae+1]),Dt(N[ae+0],N[ae+1],N[ae+2]),Dt(N[ae+1],N[ae+2],N[ae+3]),Dt(N[ae+2],N[ae+3],N[ae+4])]),q=0;4>q;++q)n(N,T+32*q,ae,0,ae.length)}function Vr(N,T){var q=N[T-1],ae=N[T-1+32],ke=N[T-1+64],Ve=N[T-1+96];be(N,T+0,16843009*Dt(N[T-1-32],q,ae)),be(N,T+32,16843009*Dt(q,ae,ke)),be(N,T+64,16843009*Dt(ae,ke,Ve)),be(N,T+96,16843009*Dt(ke,Ve,Ve))}function Sr(N,T){var q,ae=4;for(q=0;4>q;++q)ae+=N[T+q-32]+N[T-1+32*q];for(ae>>=3,q=0;4>q;++q)a(N,T+32*q,ae,4)}function pr(N,T){var q=N[T-1+0],ae=N[T-1+32],ke=N[T-1+64],Ve=N[T-1-32],Ke=N[T+0-32],Je=N[T+1-32],rt=N[T+2-32],mt=N[T+3-32];N[T+0+96]=Dt(ae,ke,N[T-1+96]),N[T+1+96]=N[T+0+64]=Dt(q,ae,ke),N[T+2+96]=N[T+1+64]=N[T+0+32]=Dt(Ve,q,ae),N[T+3+96]=N[T+2+64]=N[T+1+32]=N[T+0+0]=Dt(Ke,Ve,q),N[T+3+64]=N[T+2+32]=N[T+1+0]=Dt(Je,Ke,Ve),N[T+3+32]=N[T+2+0]=Dt(rt,Je,Ke),N[T+3+0]=Dt(mt,rt,Je)}function jr(N,T){var q=N[T+1-32],ae=N[T+2-32],ke=N[T+3-32],Ve=N[T+4-32],Ke=N[T+5-32],Je=N[T+6-32],rt=N[T+7-32];N[T+0+0]=Dt(N[T+0-32],q,ae),N[T+1+0]=N[T+0+32]=Dt(q,ae,ke),N[T+2+0]=N[T+1+32]=N[T+0+64]=Dt(ae,ke,Ve),N[T+3+0]=N[T+2+32]=N[T+1+64]=N[T+0+96]=Dt(ke,Ve,Ke),N[T+3+32]=N[T+2+64]=N[T+1+96]=Dt(Ve,Ke,Je),N[T+3+64]=N[T+2+96]=Dt(Ke,Je,rt),N[T+3+96]=Dt(Je,rt,rt)}function Bn(N,T){var q=N[T-1+0],ae=N[T-1+32],ke=N[T-1+64],Ve=N[T-1-32],Ke=N[T+0-32],Je=N[T+1-32],rt=N[T+2-32],mt=N[T+3-32];N[T+0+0]=N[T+1+64]=Ve+Ke+1>>1,N[T+1+0]=N[T+2+64]=Ke+Je+1>>1,N[T+2+0]=N[T+3+64]=Je+rt+1>>1,N[T+3+0]=rt+mt+1>>1,N[T+0+96]=Dt(ke,ae,q),N[T+0+64]=Dt(ae,q,Ve),N[T+0+32]=N[T+1+96]=Dt(q,Ve,Ke),N[T+1+32]=N[T+2+96]=Dt(Ve,Ke,Je),N[T+2+32]=N[T+3+96]=Dt(Ke,Je,rt),N[T+3+32]=Dt(Je,rt,mt)}function wn(N,T){var q=N[T+0-32],ae=N[T+1-32],ke=N[T+2-32],Ve=N[T+3-32],Ke=N[T+4-32],Je=N[T+5-32],rt=N[T+6-32],mt=N[T+7-32];N[T+0+0]=q+ae+1>>1,N[T+1+0]=N[T+0+64]=ae+ke+1>>1,N[T+2+0]=N[T+1+64]=ke+Ve+1>>1,N[T+3+0]=N[T+2+64]=Ve+Ke+1>>1,N[T+0+32]=Dt(q,ae,ke),N[T+1+32]=N[T+0+96]=Dt(ae,ke,Ve),N[T+2+32]=N[T+1+96]=Dt(ke,Ve,Ke),N[T+3+32]=N[T+2+96]=Dt(Ve,Ke,Je),N[T+3+64]=Dt(Ke,Je,rt),N[T+3+96]=Dt(Je,rt,mt)}function xn(N,T){var q=N[T-1+0],ae=N[T-1+32],ke=N[T-1+64],Ve=N[T-1+96];N[T+0+0]=q+ae+1>>1,N[T+2+0]=N[T+0+32]=ae+ke+1>>1,N[T+2+32]=N[T+0+64]=ke+Ve+1>>1,N[T+1+0]=Dt(q,ae,ke),N[T+3+0]=N[T+1+32]=Dt(ae,ke,Ve),N[T+3+32]=N[T+1+64]=Dt(ke,Ve,Ve),N[T+3+64]=N[T+2+64]=N[T+0+96]=N[T+1+96]=N[T+2+96]=N[T+3+96]=Ve}function ua(N,T){var q=N[T-1+0],ae=N[T-1+32],ke=N[T-1+64],Ve=N[T-1+96],Ke=N[T-1-32],Je=N[T+0-32],rt=N[T+1-32],mt=N[T+2-32];N[T+0+0]=N[T+2+32]=q+Ke+1>>1,N[T+0+32]=N[T+2+64]=ae+q+1>>1,N[T+0+64]=N[T+2+96]=ke+ae+1>>1,N[T+0+96]=Ve+ke+1>>1,N[T+3+0]=Dt(Je,rt,mt),N[T+2+0]=Dt(Ke,Je,rt),N[T+1+0]=N[T+3+32]=Dt(q,Ke,Je),N[T+1+32]=N[T+3+64]=Dt(ae,q,Ke),N[T+1+64]=N[T+3+96]=Dt(ke,ae,q),N[T+1+96]=Dt(Ve,ke,ae)}function ga(N,T){var q;for(q=0;8>q;++q)n(N,T+32*q,N,T-32,8)}function Yi(N,T){var q;for(q=0;8>q;++q)a(N,T,N[T-1],8),T+=32}function Ji(N,T,q){var ae;for(ae=0;8>ae;++ae)a(T,q+32*ae,N,8)}function Fl(N,T){var q,ae=8;for(q=0;8>q;++q)ae+=N[T+q-32]+N[T-1+32*q];Ji(ae>>4,N,T)}function xa(N,T){var q,ae=4;for(q=0;8>q;++q)ae+=N[T+q-32];Ji(ae>>3,N,T)}function Qn(N,T){var q,ae=4;for(q=0;8>q;++q)ae+=N[T-1+32*q];Ji(ae>>3,N,T)}function du(N,T){Ji(128,N,T)}function Ol(N,T,q){var ae=N[T-q],ke=N[T+0],Ve=3*(ke-ae)+j3[1020+N[T-2*q]-N[T+q]],Ke=vN[112+(Ve+4>>3)];N[T-q]=pu[255+ae+vN[112+(Ve+3>>3)]],N[T+0]=pu[255+ke-Ke]}function Zi(N,T,q,ae){var ke=N[T+0],Ve=N[T+q];return Ju[255+N[T-2*q]-N[T-q]]>ae||Ju[255+Ve-ke]>ae}function Rc(N,T,q,ae){return 4*Ju[255+N[T-q]-N[T+0]]+Ju[255+N[T-2*q]-N[T+q]]<=ae}function Mc(N,T,q,ae,ke){var Ve=N[T-3*q],Ke=N[T-2*q],Je=N[T-q],rt=N[T+0],mt=N[T+q],Tt=N[T+2*q],Yt=N[T+3*q];return 4*Ju[255+Je-rt]+Ju[255+Ke-mt]>ae?0:Ju[255+N[T-4*q]-Ve]<=ke&&Ju[255+Ve-Ke]<=ke&&Ju[255+Ke-Je]<=ke&&Ju[255+Yt-Tt]<=ke&&Ju[255+Tt-mt]<=ke&&Ju[255+mt-rt]<=ke}function dc(N,T,q,ae){var ke=2*ae+1;for(ae=0;16>ae;++ae)Rc(N,T+ae,q,ke)&&Ol(N,T+ae,q)}function ol(N,T,q,ae){var ke=2*ae+1;for(ae=0;16>ae;++ae)Rc(N,T+ae*q,1,ke)&&Ol(N,T+ae*q,1)}function fu(N,T,q,ae){var ke;for(ke=3;0<ke;--ke)dc(N,T+=4*q,q,ae)}function GA(N,T,q,ae){var ke;for(ke=3;0<ke;--ke)ol(N,T+=4,q,ae)}function ll(N,T,q,ae,ke,Ve,Ke,Je){for(Ve=2*Ve+1;0<ke--;){if(Mc(N,T,q,Ve,Ke))if(Zi(N,T,q,Je))Ol(N,T,q);else{var rt=N,mt=T,Tt=q,Yt=rt[mt-2*Tt],pt=rt[mt-Tt],Lt=rt[mt+0],Gt=rt[mt+Tt],dr=rt[mt+2*Tt],Wt=27*(gr=j3[1020+3*(Lt-pt)+j3[1020+Yt-Gt]])+63>>7,mr=18*gr+63>>7,gr=9*gr+63>>7;rt[mt-3*Tt]=pu[255+rt[mt-3*Tt]+gr],rt[mt-2*Tt]=pu[255+Yt+mr],rt[mt-Tt]=pu[255+pt+Wt],rt[mt+0]=pu[255+Lt-Wt],rt[mt+Tt]=pu[255+Gt-mr],rt[mt+2*Tt]=pu[255+dr-gr]}T+=ae}}function Lc(N,T,q,ae,ke,Ve,Ke,Je){for(Ve=2*Ve+1;0<ke--;){if(Mc(N,T,q,Ve,Ke))if(Zi(N,T,q,Je))Ol(N,T,q);else{var rt=N,mt=T,Tt=q,Yt=rt[mt-Tt],pt=rt[mt+0],Lt=rt[mt+Tt],Gt=vN[112+(4+(dr=3*(pt-Yt))>>3)],dr=vN[112+(dr+3>>3)],Wt=Gt+1>>1;rt[mt-2*Tt]=pu[255+rt[mt-2*Tt]+Wt],rt[mt-Tt]=pu[255+Yt+dr],rt[mt+0]=pu[255+pt-Gt],rt[mt+Tt]=pu[255+Lt-Wt]}T+=ae}}function Bf(N,T,q,ae,ke,Ve){ll(N,T,q,1,16,ae,ke,Ve)}function fo(N,T,q,ae,ke,Ve){ll(N,T,1,q,16,ae,ke,Ve)}function zu(N,T,q,ae,ke,Ve){var Ke;for(Ke=3;0<Ke;--Ke)Lc(N,T+=4*q,q,1,16,ae,ke,Ve)}function M(N,T,q,ae,ke,Ve){var Ke;for(Ke=3;0<Ke;--Ke)Lc(N,T+=4,1,q,16,ae,ke,Ve)}function Be(N,T,q,ae,ke,Ve,Ke,Je){ll(N,T,ke,1,8,Ve,Ke,Je),ll(q,ae,ke,1,8,Ve,Ke,Je)}function At(N,T,q,ae,ke,Ve,Ke,Je){ll(N,T,1,ke,8,Ve,Ke,Je),ll(q,ae,1,ke,8,Ve,Ke,Je)}function Ct(N,T,q,ae,ke,Ve,Ke,Je){Lc(N,T+4*ke,ke,1,8,Ve,Ke,Je),Lc(q,ae+4*ke,ke,1,8,Ve,Ke,Je)}function Vt(N,T,q,ae,ke,Ve,Ke,Je){Lc(N,T+4,1,ke,8,Ve,Ke,Je),Lc(q,ae+4,1,ke,8,Ve,Ke,Je)}function hr(){this.ba=new xe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new xt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function yr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function sn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function hn(){this.ua=0,this.Wa=new ie,this.vb=new ie,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new oe,this.yc=new O}function Tn(){this.xb=this.a=0,this.l=new Ee,this.ca=new xe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new hn,this.ab=0,this.gc=o(4,sn),this.Oc=0}function Vn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ee,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function da(N,T,q,ae,ke,Ve,Ke){for(N=N==null?0:N[T+0],T=0;T<Ke;++T)ke[Ve+T]=N+q[ae+T]&255,N=ke[Ve+T]}function ka(N,T,q,ae,ke,Ve,Ke){var Je;if(N==null)da(null,null,q,ae,ke,Ve,Ke);else for(Je=0;Je<Ke;++Je)ke[Ve+Je]=N[T+Je]+q[ae+Je]&255}function Ys(N,T,q,ae,ke,Ve,Ke){if(N==null)da(null,null,q,ae,ke,Ve,Ke);else{var Je,rt=N[T+0],mt=rt,Tt=rt;for(Je=0;Je<Ke;++Je)mt=Tt+(rt=N[T+Je])-mt,Tt=q[ae+Je]+(-256&mt?0>mt?0:255:mt)&255,mt=rt,ke[Ve+Je]=Tt}}function Va(N,T,q,ae){var ke=T.width,Ve=T.o;if(e(N!=null&&T!=null),0>q||0>=ae||q+ae>Ve)return null;if(!N.Cc){if(N.ga==null){var Ke;if(N.ga=new Vn,(Ke=N.ga==null)||(Ke=T.width*T.o,e(N.Gb.length==0),N.Gb=s(Ke),N.Uc=0,N.Gb==null?Ke=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Ke=1),Ke=!Ke),!Ke){Ke=N.ga;var Je=N.Fa,rt=N.P,mt=N.qc,Tt=N.mb,Yt=N.nb,pt=rt+1,Lt=mt-1,Gt=Ke.l;if(e(Je!=null&&Tt!=null&&T!=null),t0[0]=null,t0[1]=da,t0[2]=ka,t0[3]=Ys,Ke.ca=Tt,Ke.tb=Yt,Ke.c=T.width,Ke.i=T.height,e(0<Ke.c&&0<Ke.i),1>=mt)T=0;else if(Ke.$a=3&Je[rt+0],Ke.Z=Je[rt+0]>>2&3,Ke.Lc=Je[rt+0]>>4&3,rt=Je[rt+0]>>6&3,0>Ke.$a||1<Ke.$a||4<=Ke.Z||1<Ke.Lc||rt)T=0;else if(Gt.put=Le,Gt.ac=Ht,Gt.bc=Ce,Gt.ma=Ke,Gt.width=T.width,Gt.height=T.height,Gt.Da=T.Da,Gt.v=T.v,Gt.va=T.va,Gt.j=T.j,Gt.o=T.o,Ke.$a)e:{e(Ke.$a==1),T=nt();t:for(;;){if(T==null){T=0;break e}if(e(Ke!=null),Ke.mc=T,T.c=Ke.c,T.i=Ke.i,T.l=Ke.l,T.l.ma=Ke,T.l.width=Ke.c,T.l.height=Ke.i,T.a=0,ne(T.m,Je,pt,Lt),!lt(Ke.c,Ke.i,1,T,null)||(T.ab==1&&T.gc[0].hc==3&&se(T.s)?(Ke.ic=1,Je=T.c*T.i,T.Ta=null,T.Ua=0,T.V=s(Je),T.Ba=0,T.V==null?(T.a=1,T=0):T=1):(Ke.ic=0,T=ht(T,Ke.c)),!T))break t;T=1;break e}Ke.mc=null,T=0}else T=Lt>=Ke.c*Ke.i;Ke=!T}if(Ke)return null;N.ga.Lc!=1?N.Ga=0:ae=Ve-q}e(N.ga!=null),e(q+ae<=Ve);e:{if(T=(Je=N.ga).c,Ve=Je.l.o,Je.$a==0){if(pt=N.rc,Lt=N.Vc,Gt=N.Fa,rt=N.P+1+q*T,mt=N.mb,Tt=N.nb+q*T,e(rt<=N.P+N.qc),Je.Z!=0)for(e(t0[Je.Z]!=null),Ke=0;Ke<ae;++Ke)t0[Je.Z](pt,Lt,Gt,rt,mt,Tt,T),pt=mt,Lt=Tt,Tt+=T,rt+=T;else for(Ke=0;Ke<ae;++Ke)n(mt,Tt,Gt,rt,T),pt=mt,Lt=Tt,Tt+=T,rt+=T;N.rc=pt,N.Vc=Lt}else{if(e(Je.mc!=null),T=q+ae,e((Ke=Je.mc)!=null),e(T<=Ke.i),Ke.C>=T)T=1;else if(Je.ic||Uc(),Je.ic){Je=Ke.V,pt=Ke.Ba,Lt=Ke.c;var dr=Ke.i,Wt=(Gt=1,rt=Ke.$/Lt,mt=Ke.$%Lt,Tt=Ke.m,Yt=Ke.s,Ke.$),mr=Lt*dr,gr=Lt*T,Tr=Yt.wc,Cr=Wt<gr?R(Yt,mt,rt):null;e(Wt<=mr),e(T<=dr),e(se(Yt));t:for(;;){for(;!Tt.h&&Wt<gr;){if(mt&Tr||(Cr=R(Yt,mt,rt)),e(Cr!=null),X(Tt),256>(dr=te(Cr.G[0],Cr.H[0],Tt)))Je[pt+Wt]=dr,++Wt,++mt>=Lt&&(mt=0,++rt<=T&&!(rt%16)&&Me(Ke,rt));else{if(!(280>dr)){Gt=0;break t}dr=Qe(dr-256,Tt);var yn,cn=te(Cr.G[4],Cr.H[4],Tt);if(X(Tt),!(Wt>=(cn=fe(Lt,cn=Qe(cn,Tt)))&&mr-Wt>=dr)){Gt=0;break t}for(yn=0;yn<dr;++yn)Je[pt+Wt+yn]=Je[pt+Wt+yn-cn];for(Wt+=dr,mt+=dr;mt>=Lt;)mt-=Lt,++rt<=T&&!(rt%16)&&Me(Ke,rt);Wt<gr&&mt&Tr&&(Cr=R(Yt,mt,rt))}e(Tt.h==U(Tt))}Me(Ke,rt>T?T:rt);break t}!Gt||Tt.h&&Wt<mr?(Gt=0,Ke.a=Tt.h?5:3):Ke.$=Wt,T=Gt}else T=ze(Ke,Ke.V,Ke.Ba,Ke.c,Ke.i,T,kt);if(!T){ae=0;break e}}q+ae>=Ve&&(N.Cc=1),ae=1}if(!ae)return null;if(N.Cc&&((ae=N.ga)!=null&&(ae.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+q*ke}function pi(N,T,q,ae,ke,Ve){for(;0<ke--;){var Ke,Je=N,rt=T+(q?1:0),mt=N,Tt=T+(q?0:3);for(Ke=0;Ke<ae;++Ke){var Yt=mt[Tt+4*Ke];Yt!=255&&(Yt*=32897,Je[rt+4*Ke+0]=Je[rt+4*Ke+0]*Yt>>23,Je[rt+4*Ke+1]=Je[rt+4*Ke+1]*Yt>>23,Je[rt+4*Ke+2]=Je[rt+4*Ke+2]*Yt>>23)}T+=Ve}}function Js(N,T,q,ae,ke){for(;0<ae--;){var Ve;for(Ve=0;Ve<q;++Ve){var Ke=N[T+2*Ve+0],Je=15&(mt=N[T+2*Ve+1]),rt=4369*Je,mt=(240&mt|mt>>4)*rt>>16;N[T+2*Ve+0]=(240&Ke|Ke>>4)*rt>>16&240|(15&Ke|Ke<<4)*rt>>16>>4&15,N[T+2*Ve+1]=240&mt|Je}T+=ke}}function gi(N,T,q,ae,ke,Ve,Ke,Je){var rt,mt,Tt=255;for(mt=0;mt<ke;++mt){for(rt=0;rt<ae;++rt){var Yt=N[T+rt];Ve[Ke+4*rt]=Yt,Tt&=Yt}T+=q,Ke+=Je}return Tt!=255}function Zs(N,T,q,ae,ke){var Ve;for(Ve=0;Ve<ke;++Ve)q[ae+Ve]=N[T+Ve]>>8}function Uc(){Q1=pi,W8=Js,X8=gi,Y8=Zs}function Wu(N,T,q){E[N]=function(ae,ke,Ve,Ke,Je,rt,mt,Tt,Yt,pt,Lt,Gt,dr,Wt,mr,gr,Tr){var Cr,yn=Tr-1>>1,cn=Je[rt+0]|mt[Tt+0]<<16,Xn=Yt[pt+0]|Lt[Gt+0]<<16;e(ae!=null);var mn=3*cn+Xn+131074>>2;for(T(ae[ke+0],255&mn,mn>>16,dr,Wt),Ve!=null&&(mn=3*Xn+cn+131074>>2,T(Ve[Ke+0],255&mn,mn>>16,mr,gr)),Cr=1;Cr<=yn;++Cr){var pa=Je[rt+Cr]|mt[Tt+Cr]<<16,Ao=Yt[pt+Cr]|Lt[Gt+Cr]<<16,Yn=cn+pa+Xn+Ao+524296,pn=Yn+2*(pa+Xn)>>3;mn=pn+cn>>1,cn=(Yn=Yn+2*(cn+Ao)>>3)+pa>>1,T(ae[ke+2*Cr-1],255&mn,mn>>16,dr,Wt+(2*Cr-1)*q),T(ae[ke+2*Cr-0],255&cn,cn>>16,dr,Wt+(2*Cr-0)*q),Ve!=null&&(mn=Yn+Xn>>1,cn=pn+Ao>>1,T(Ve[Ke+2*Cr-1],255&mn,mn>>16,mr,gr+(2*Cr-1)*q),T(Ve[Ke+2*Cr+0],255&cn,cn>>16,mr,gr+(2*Cr+0)*q)),cn=pa,Xn=Ao}1&Tr||(mn=3*cn+Xn+131074>>2,T(ae[ke+Tr-1],255&mn,mn>>16,dr,Wt+(Tr-1)*q),Ve!=null&&(mn=3*Xn+cn+131074>>2,T(Ve[Ke+Tr-1],255&mn,mn>>16,mr,gr+(Tr-1)*q)))}}function Xu(){Zu[yN]=Cde,Zu[bN]=lL,Zu[nL]=_de,Zu[wN]=cL,Zu[NN]=uL,Zu[P3]=dL,Zu[aL]=Ede,Zu[B3]=lL,Zu[T3]=cL,Zu[CN]=uL,Zu[k3]=dL}function C(N){return N&-16384?0>N?0:255:N>>Sde}function Y(N,T){return C((19077*N>>8)+(26149*T>>8)-14234)}function ve(N,T,q){return C((19077*N>>8)-(6419*T>>8)-(13320*q>>8)+8708)}function et(N,T){return C((19077*N>>8)+(33050*T>>8)-17685)}function Kt(N,T,q,ae,ke){ae[ke+0]=Y(N,q),ae[ke+1]=ve(N,T,q),ae[ke+2]=et(N,T)}function rr(N,T,q,ae,ke){ae[ke+0]=et(N,T),ae[ke+1]=ve(N,T,q),ae[ke+2]=Y(N,q)}function Lr(N,T,q,ae,ke){var Ve=ve(N,T,q);T=Ve<<3&224|et(N,T)>>3,ae[ke+0]=248&Y(N,q)|Ve>>5,ae[ke+1]=T}function ma(N,T,q,ae,ke){var Ve=240&et(N,T)|15;ae[ke+0]=240&Y(N,q)|ve(N,T,q)>>4,ae[ke+1]=Ve}function ei(N,T,q,ae,ke){ae[ke+0]=255,Kt(N,T,q,ae,ke+1)}function na(N,T,q,ae,ke){rr(N,T,q,ae,ke),ae[ke+3]=255}function Sa(N,T,q,ae,ke){Kt(N,T,q,ae,ke),ae[ke+3]=255}function gs(N,T,q){E[N]=function(ae,ke,Ve,Ke,Je,rt,mt,Tt,Yt){for(var pt=Tt+(-2&Yt)*q;Tt!=pt;)T(ae[ke+0],Ve[Ke+0],Je[rt+0],mt,Tt),T(ae[ke+1],Ve[Ke+0],Je[rt+0],mt,Tt+q),ke+=2,++Ke,++rt,Tt+=2*q;1&Yt&&T(ae[ke+0],Ve[Ke+0],Je[rt+0],mt,Tt)}}function hu(N,T,q){return q==0?N==0?T==0?6:5:T==0?4:0:q}function Dl(N,T,q,ae,ke){switch(N>>>30){case 3:qm(T,q,ae,ke,0);break;case 2:Yu(T,q,ae,ke);break;case 1:Ma(T,q,ae,ke)}}function cl(N,T){var q,ae,ke=T.M,Ve=T.Nb,Ke=N.oc,Je=N.pc+40,rt=N.oc,mt=N.pc+584,Tt=N.oc,Yt=N.pc+600;for(q=0;16>q;++q)Ke[Je+32*q-1]=129;for(q=0;8>q;++q)rt[mt+32*q-1]=129,Tt[Yt+32*q-1]=129;for(0<ke?Ke[Je-1-32]=rt[mt-1-32]=Tt[Yt-1-32]=129:(a(Ke,Je-32-1,127,21),a(rt,mt-32-1,127,9),a(Tt,Yt-32-1,127,9)),ae=0;ae<N.za;++ae){var pt=T.ya[T.aa+ae];if(0<ae){for(q=-1;16>q;++q)n(Ke,Je+32*q-4,Ke,Je+32*q+12,4);for(q=-1;8>q;++q)n(rt,mt+32*q-4,rt,mt+32*q+4,4),n(Tt,Yt+32*q-4,Tt,Yt+32*q+4,4)}var Lt=N.Gd,Gt=N.Hd+ae,dr=pt.ad,Wt=pt.Hc;if(0<ke&&(n(Ke,Je-32,Lt[Gt].y,0,16),n(rt,mt-32,Lt[Gt].f,0,8),n(Tt,Yt-32,Lt[Gt].ea,0,8)),pt.Za){var mr=Ke,gr=Je-32+16;for(0<ke&&(ae>=N.za-1?a(mr,gr,Lt[Gt].y[15],4):n(mr,gr,Lt[Gt+1].y,0,4)),q=0;4>q;q++)mr[gr+128+q]=mr[gr+256+q]=mr[gr+384+q]=mr[gr+0+q];for(q=0;16>q;++q,Wt<<=2)mr=Ke,gr=Je+hL[q],Kd[pt.Ob[q]](mr,gr),Dl(Wt,dr,16*+q,mr,gr)}else if(mr=hu(ae,ke,pt.Ob[0]),e0[mr](Ke,Je),Wt!=0)for(q=0;16>q;++q,Wt<<=2)Dl(Wt,dr,16*+q,Ke,Je+hL[q]);for(q=pt.Gc,mr=hu(ae,ke,pt.Dd),wh[mr](rt,mt),wh[mr](Tt,Yt),Wt=dr,mr=rt,gr=mt,255&(pt=0|q)&&(170&pt?Ff(Wt,256,mr,gr):ds(Wt,256,mr,gr)),pt=Tt,Wt=Yt,255&(q>>=8)&&(170&q?Ff(dr,320,pt,Wt):ds(dr,320,pt,Wt)),ke<N.Ub-1&&(n(Lt[Gt].y,0,Ke,Je+480,16),n(Lt[Gt].f,0,rt,mt+224,8),n(Lt[Gt].ea,0,Tt,Yt+224,8)),q=8*Ve*N.B,Lt=N.sa,Gt=N.ta+16*ae+16*Ve*N.R,dr=N.qa,pt=N.ra+8*ae+q,Wt=N.Ha,mr=N.Ia+8*ae+q,q=0;16>q;++q)n(Lt,Gt+q*N.R,Ke,Je+32*q,16);for(q=0;8>q;++q)n(dr,pt+q*N.B,rt,mt+32*q,8),n(Wt,mr+q*N.B,Tt,Yt+32*q,8)}}function $d(N,T,q,ae,ke,Ve,Ke,Je,rt){var mt=[0],Tt=[0],Yt=0,pt=rt!=null?rt.kd:0,Lt=rt??new yr;if(N==null||12>q)return 7;Lt.data=N,Lt.w=T,Lt.ha=q,T=[T],q=[q],Lt.gb=[Lt.gb];e:{var Gt=T,dr=q,Wt=Lt.gb;if(e(N!=null),e(dr!=null),e(Wt!=null),Wt[0]=0,12<=dr[0]&&!r(N,Gt[0],"RIFF")){if(r(N,Gt[0]+8,"WEBP")){Wt=3;break e}var mr=re(N,Gt[0]+4);if(12>mr||4294967286<mr){Wt=3;break e}if(pt&&mr>dr[0]-8){Wt=7;break e}Wt[0]=mr,Gt[0]+=12,dr[0]-=12}Wt=0}if(Wt!=0)return Wt;for(mr=0<Lt.gb[0],q=q[0];;){e:{var gr=N;dr=T,Wt=q;var Tr=mt,Cr=Tt,yn=Gt=[0];if((mn=Yt=[Yt])[0]=0,8>Wt[0])Wt=7;else{if(!r(gr,dr[0],"VP8X")){if(re(gr,dr[0]+4)!=10){Wt=3;break e}if(18>Wt[0]){Wt=7;break e}var cn=re(gr,dr[0]+8),Xn=1+Xe(gr,dr[0]+12);if(2147483648<=Xn*(gr=1+Xe(gr,dr[0]+15))){Wt=3;break e}yn!=null&&(yn[0]=cn),Tr!=null&&(Tr[0]=Xn),Cr!=null&&(Cr[0]=gr),dr[0]+=18,Wt[0]-=18,mn[0]=1}Wt=0}}if(Yt=Yt[0],Gt=Gt[0],Wt!=0)return Wt;if(dr=!!(2&Gt),!mr&&Yt)return 3;if(Ve!=null&&(Ve[0]=!!(16&Gt)),Ke!=null&&(Ke[0]=dr),Je!=null&&(Je[0]=0),Ke=mt[0],Gt=Tt[0],Yt&&dr&&rt==null){Wt=0;break}if(4>q){Wt=7;break}if(mr&&Yt||!mr&&!Yt&&!r(N,T[0],"ALPH")){q=[q],Lt.na=[Lt.na],Lt.P=[Lt.P],Lt.Sa=[Lt.Sa];e:{cn=N,Wt=T,mr=q;var mn=Lt.gb;Tr=Lt.na,Cr=Lt.P,yn=Lt.Sa,Xn=22,e(cn!=null),e(mr!=null),gr=Wt[0];var pa=mr[0];for(e(Tr!=null),e(yn!=null),Tr[0]=null,Cr[0]=null,yn[0]=0;;){if(Wt[0]=gr,mr[0]=pa,8>pa){Wt=7;break e}var Ao=re(cn,gr+4);if(4294967286<Ao){Wt=3;break e}var Yn=8+Ao+1&-2;if(Xn+=Yn,0<mn&&Xn>mn){Wt=3;break e}if(!r(cn,gr,"VP8 ")||!r(cn,gr,"VP8L")){Wt=0;break e}if(pa[0]<Yn){Wt=7;break e}r(cn,gr,"ALPH")||(Tr[0]=cn,Cr[0]=gr+8,yn[0]=Ao),gr+=Yn,pa-=Yn}}if(q=q[0],Lt.na=Lt.na[0],Lt.P=Lt.P[0],Lt.Sa=Lt.Sa[0],Wt!=0)break}q=[q],Lt.Ja=[Lt.Ja],Lt.xa=[Lt.xa];e:if(mn=N,Wt=T,mr=q,Tr=Lt.gb[0],Cr=Lt.Ja,yn=Lt.xa,cn=Wt[0],gr=!r(mn,cn,"VP8 "),Xn=!r(mn,cn,"VP8L"),e(mn!=null),e(mr!=null),e(Cr!=null),e(yn!=null),8>mr[0])Wt=7;else{if(gr||Xn){if(mn=re(mn,cn+4),12<=Tr&&mn>Tr-12){Wt=3;break e}if(pt&&mn>mr[0]-8){Wt=7;break e}Cr[0]=mn,Wt[0]+=8,mr[0]-=8,yn[0]=Xn}else yn[0]=5<=mr[0]&&mn[cn+0]==47&&!(mn[cn+4]>>5),Cr[0]=mr[0];Wt=0}if(q=q[0],Lt.Ja=Lt.Ja[0],Lt.xa=Lt.xa[0],T=T[0],Wt!=0)break;if(4294967286<Lt.Ja)return 3;if(Je==null||dr||(Je[0]=Lt.xa?2:1),Ke=[Ke],Gt=[Gt],Lt.xa){if(5>q){Wt=7;break}Je=Ke,pt=Gt,dr=Ve,N==null||5>q?N=0:5<=q&&N[T+0]==47&&!(N[T+4]>>5)?(mr=[0],mn=[0],Tr=[0],ne(Cr=new H,N,T,q),Ae(Cr,mr,mn,Tr)?(Je!=null&&(Je[0]=mr[0]),pt!=null&&(pt[0]=mn[0]),dr!=null&&(dr[0]=Tr[0]),N=1):N=0):N=0}else{if(10>q){Wt=7;break}Je=Gt,N==null||10>q||!Mr(N,T+3,q-3)?N=0:(pt=N[T+0]|N[T+1]<<8|N[T+2]<<16,dr=16383&(N[T+7]<<8|N[T+6]),N=16383&(N[T+9]<<8|N[T+8]),1&pt||3<(pt>>1&7)||!(pt>>4&1)||pt>>5>=Lt.Ja||!dr||!N?N=0:(Ke&&(Ke[0]=dr),Je&&(Je[0]=N),N=1))}if(!N||(Ke=Ke[0],Gt=Gt[0],Yt&&(mt[0]!=Ke||Tt[0]!=Gt)))return 3;rt!=null&&(rt[0]=Lt,rt.offset=T-rt.w,e(4294967286>T-rt.w),e(rt.offset==rt.ha-q));break}return Wt==0||Wt==7&&Yt&&rt==null?(Ve!=null&&(Ve[0]|=Lt.na!=null&&0<Lt.na.length),ae!=null&&(ae[0]=Ke),ke!=null&&(ke[0]=Gt),0):Wt}function k1(N,T,q){var ae=T.width,ke=T.height,Ve=0,Ke=0,Je=ae,rt=ke;if(T.Da=N!=null&&0<N.Da,T.Da&&(Je=N.cd,rt=N.bd,Ve=N.v,Ke=N.j,11>q||(Ve&=-2,Ke&=-2),0>Ve||0>Ke||0>=Je||0>=rt||Ve+Je>ae||Ke+rt>ke))return 0;if(T.v=Ve,T.j=Ke,T.va=Ve+Je,T.o=Ke+rt,T.U=Je,T.T=rt,T.da=N!=null&&0<N.da,T.da){if(!He(Je,rt,q=[N.ib],Ve=[N.hb]))return 0;T.ib=q[0],T.hb=Ve[0]}return T.ob=N!=null&&N.ob,T.Kb=N==null||!N.Sd,T.da&&(T.ob=T.ib<3*ae/4&&T.hb<3*ke/4,T.Kb=0),1}function F1(N){if(N==null)return 2;if(11>N.S){var T=N.f.RGBA;T.fb+=(N.height-1)*T.A,T.A=-T.A}else T=N.f.kb,N=N.height,T.O+=(N-1)*T.fa,T.fa=-T.fa,T.N+=(N-1>>1)*T.Ab,T.Ab=-T.Ab,T.W+=(N-1>>1)*T.Db,T.Db=-T.Db,T.F!=null&&(T.J+=(N-1)*T.lb,T.lb=-T.lb);return 0}function qA(N,T,q,ae){if(ae==null||0>=N||0>=T)return 2;if(q!=null){if(q.Da){var ke=q.cd,Ve=q.bd,Ke=-2&q.v,Je=-2&q.j;if(0>Ke||0>Je||0>=ke||0>=Ve||Ke+ke>N||Je+Ve>T)return 2;N=ke,T=Ve}if(q.da){if(!He(N,T,ke=[q.ib],Ve=[q.hb]))return 2;N=ke[0],T=Ve[0]}}ae.width=N,ae.height=T;e:{var rt=ae.width,mt=ae.height;if(N=ae.S,0>=rt||0>=mt||!(N>=yN&&13>N))N=2;else{if(0>=ae.Rd&&ae.sd==null){Ke=Ve=ke=T=0;var Tt=(Je=rt*AL[N])*mt;if(11>N||(Ve=(mt+1)/2*(T=(rt+1)/2),N==12&&(Ke=(ke=rt)*mt)),(mt=s(Tt+2*Ve+Ke))==null){N=1;break e}ae.sd=mt,11>N?((rt=ae.f.RGBA).eb=mt,rt.fb=0,rt.A=Je,rt.size=Tt):((rt=ae.f.kb).y=mt,rt.O=0,rt.fa=Je,rt.Fd=Tt,rt.f=mt,rt.N=0+Tt,rt.Ab=T,rt.Cd=Ve,rt.ea=mt,rt.W=0+Tt+Ve,rt.Db=T,rt.Ed=Ve,N==12&&(rt.F=mt,rt.J=0+Tt+2*Ve),rt.Tc=Ke,rt.lb=ke)}if(T=1,ke=ae.S,Ve=ae.width,Ke=ae.height,ke>=yN&&13>ke)if(11>ke)N=ae.f.RGBA,T&=(Je=Math.abs(N.A))*(Ke-1)+Ve<=N.size,T&=Je>=Ve*AL[ke],T&=N.eb!=null;else{N=ae.f.kb,Je=(Ve+1)/2,Tt=(Ke+1)/2,rt=Math.abs(N.fa),mt=Math.abs(N.Ab);var Yt=Math.abs(N.Db),pt=Math.abs(N.lb),Lt=pt*(Ke-1)+Ve;T&=rt*(Ke-1)+Ve<=N.Fd,T&=mt*(Tt-1)+Je<=N.Cd,T=(T&=Yt*(Tt-1)+Je<=N.Ed)&rt>=Ve&mt>=Je&Yt>=Je,T&=N.y!=null,T&=N.f!=null,T&=N.ea!=null,ke==12&&(T&=pt>=Ve,T&=Lt<=N.Tc,T&=N.F!=null)}else T=0;N=T?0:2}}return N!=0||q!=null&&q.fd&&(N=F1(ae)),N}var Km=64,Au=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],mu=24,zA=32,yh=8,WA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_t("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(N){return N},E.Predictor2=function(N,T,q){return T[q+0]},E.Predictor3=function(N,T,q){return T[q+1]},E.Predictor4=function(N,T,q){return T[q-1]},E.Predictor5=function(N,T,q){return Ot(Ot(N,T[q+1]),T[q+0])},E.Predictor6=function(N,T,q){return Ot(N,T[q-1])},E.Predictor7=function(N,T,q){return Ot(N,T[q+0])},E.Predictor8=function(N,T,q){return Ot(T[q-1],T[q+0])},E.Predictor9=function(N,T,q){return Ot(T[q+0],T[q+1])},E.Predictor10=function(N,T,q){return Ot(Ot(N,T[q-1]),Ot(T[q+0],T[q+1]))},E.Predictor11=function(N,T,q){var ae=T[q+0];return 0>=Ft(ae>>24&255,N>>24&255,(T=T[q-1])>>24&255)+Ft(ae>>16&255,N>>16&255,T>>16&255)+Ft(ae>>8&255,N>>8&255,T>>8&255)+Ft(255&ae,255&N,255&T)?ae:N},E.Predictor12=function(N,T,q){var ae=T[q+0];return(jt((N>>24&255)+(ae>>24&255)-((T=T[q-1])>>24&255))<<24|jt((N>>16&255)+(ae>>16&255)-(T>>16&255))<<16|jt((N>>8&255)+(ae>>8&255)-(T>>8&255))<<8|jt((255&N)+(255&ae)-(255&T)))>>>0},E.Predictor13=function(N,T,q){var ae=T[q-1];return(Qt((N=Ot(N,T[q+0]))>>24&255,ae>>24&255)<<24|Qt(N>>16&255,ae>>16&255)<<16|Qt(N>>8&255,ae>>8&255)<<8|Qt(255&N,255&ae))>>>0};var O1=E.PredictorAdd0;E.PredictorAdd1=$e,_t("Predictor2","PredictorAdd2"),_t("Predictor3","PredictorAdd3"),_t("Predictor4","PredictorAdd4"),_t("Predictor5","PredictorAdd5"),_t("Predictor6","PredictorAdd6"),_t("Predictor7","PredictorAdd7"),_t("Predictor8","PredictorAdd8"),_t("Predictor9","PredictorAdd9"),_t("Predictor10","PredictorAdd10"),_t("Predictor11","PredictorAdd11"),_t("Predictor12","PredictorAdd12"),_t("Predictor13","PredictorAdd13");var zg=E.PredictorAdd2;ee("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),ee("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Bi,gN=E.ColorIndexInverseTransform,Tf=E.MapARGB,kf=E.VP8LColorIndexInverseTransformAlpha,D1=E.MapAlpha,R1=E.VP8LPredictorsAdd=[];R1.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var M1,L1,XA,YA,JA,Gm,ZA,qm,Yu,Ff,Ma,ds,Ti,ho,bh,U1,Wg,xN,H8,$8,K8,G8,q8,z8,Q1,W8,X8,Y8,J8=s(511),Z8=s(2041),eL=s(225),tL=s(767),rL=0,j3=Z8,vN=eL,pu=tL,Ju=J8,yN=0,bN=1,nL=2,wN=3,NN=4,P3=5,aL=6,B3=7,T3=8,CN=9,k3=10,ude=[2,3,7],dde=[3,3,11],sL=[280,256,256,256,40],fde=[0,1,1,1,0],hde=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ade=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],mde=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],pde=8,F3=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],O3=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],V1=null,gde=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],xde=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],iL=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],vde=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],yde=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],bde=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],wde=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],e0=[],Kd=[],wh=[],Nde=1,oL=2,t0=[],Zu=[];Wu("UpsampleRgbLinePair",Kt,3),Wu("UpsampleBgrLinePair",rr,3),Wu("UpsampleRgbaLinePair",Sa,4),Wu("UpsampleBgraLinePair",na,4),Wu("UpsampleArgbLinePair",ei,4),Wu("UpsampleRgba4444LinePair",ma,2),Wu("UpsampleRgb565LinePair",Lr,2);var Cde=E.UpsampleRgbLinePair,_de=E.UpsampleBgrLinePair,lL=E.UpsampleRgbaLinePair,cL=E.UpsampleBgraLinePair,uL=E.UpsampleArgbLinePair,dL=E.UpsampleRgba4444LinePair,Ede=E.UpsampleRgb565LinePair,_N=16,EN=1<<_N-1,H1=-227,D3=482,Sde=6,fL=0,Ide=s(256),jde=s(256),Pde=s(256),Bde=s(256),Tde=s(D3-H1),kde=s(D3-H1);gs("YuvToRgbRow",Kt,3),gs("YuvToBgrRow",rr,3),gs("YuvToRgbaRow",Sa,4),gs("YuvToBgraRow",na,4),gs("YuvToArgbRow",ei,4),gs("YuvToRgba4444Row",ma,2),gs("YuvToRgb565Row",Lr,2);var hL=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],SN=[0,2,8],Fde=[8,7,6,4,4,2,2,2,1,1,1,1],Ode=1;this.WebPDecodeRGBA=function(N,T,q,ae,ke){var Ve=bN,Ke=new hr,Je=new xe;Ke.ba=Je,Je.S=Ve,Je.width=[Je.width],Je.height=[Je.height];var rt=Je.width,mt=Je.height,Tt=new Se;if(Tt==null||N==null)var Yt=2;else e(Tt!=null),Yt=$d(N,T,q,Tt.width,Tt.height,Tt.Pd,Tt.Qd,Tt.format,null);if(Yt!=0?rt=0:(rt!=null&&(rt[0]=Tt.width[0]),mt!=null&&(mt[0]=Tt.height[0]),rt=1),rt){Je.width=Je.width[0],Je.height=Je.height[0],ae!=null&&(ae[0]=Je.width),ke!=null&&(ke[0]=Je.height);e:{if(ae=new Ee,(ke=new yr).data=N,ke.w=T,ke.ha=q,ke.kd=1,T=[0],e(ke!=null),((N=$d(ke.data,ke.w,ke.ha,null,null,null,T,null,ke))==0||N==7)&&T[0]&&(N=4),(T=N)==0){if(e(Ke!=null),ae.data=ke.data,ae.w=ke.w+ke.offset,ae.ha=ke.ha-ke.offset,ae.put=Le,ae.ac=Ht,ae.bc=Ce,ae.ma=Ke,ke.xa){if((N=nt())==null){Ke=1;break e}if(function(pt,Lt){var Gt=[0],dr=[0],Wt=[0];t:for(;;){if(pt==null)return 0;if(Lt==null)return pt.a=2,0;if(pt.l=Lt,pt.a=0,ne(pt.m,Lt.data,Lt.w,Lt.ha),!Ae(pt.m,Gt,dr,Wt)){pt.a=3;break t}if(pt.xb=oL,Lt.width=Gt[0],Lt.height=dr[0],!lt(Gt[0],dr[0],1,pt,null))break t;return 1}return e(pt.a!=0),0}(N,ae)){if(ae=(T=qA(ae.width,ae.height,Ke.Oa,Ke.ba))==0){t:{ae=N;r:for(;;){if(ae==null){ae=0;break t}if(e(ae.s.yc!=null),e(ae.s.Ya!=null),e(0<ae.s.Wb),e((q=ae.l)!=null),e((ke=q.ma)!=null),ae.xb!=0){if(ae.ca=ke.ba,ae.tb=ke.tb,e(ae.ca!=null),!k1(ke.Oa,q,wN)){ae.a=2;break r}if(!ht(ae,q.width)||q.da)break r;if((q.da||je(ae.ca.S))&&Uc(),11>ae.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ae.ca.f.kb.F!=null&&Uc()),ae.Pb&&0<ae.s.ua&&ae.s.vb.X==null&&!J(ae.s.vb,ae.s.Wa.Xa)){ae.a=1;break r}ae.xb=0}if(!ze(ae,ae.V,ae.Ba,ae.c,ae.i,q.o,G))break r;ke.Dc=ae.Ma,ae=1;break t}e(ae.a!=0),ae=0}ae=!ae}ae&&(T=N.a)}else T=N.a}else{if((N=new gt)==null){Ke=1;break e}if(N.Fa=ke.na,N.P=ke.P,N.qc=ke.Sa,Or(N,ae)){if((T=qA(ae.width,ae.height,Ke.Oa,Ke.ba))==0){if(N.Aa=0,q=Ke.Oa,e((ke=N)!=null),q!=null){if(0<(rt=0>(rt=q.Md)?0:100<rt?255:255*rt/100)){for(mt=Tt=0;4>mt;++mt)12>(Yt=ke.pb[mt]).lc&&(Yt.ia=rt*Fde[0>Yt.lc?0:Yt.lc]>>3),Tt|=Yt.ia;Tt&&(alert("todo:VP8InitRandom"),ke.ia=1)}ke.Ga=q.Id,100<ke.Ga?ke.Ga=100:0>ke.Ga&&(ke.Ga=0)}(function(pt,Lt){if(pt==null)return 0;if(Lt==null)return Zt(pt,2,"NULL VP8Io parameter in VP8Decode().");if(!pt.cb&&!Or(pt,Lt))return 0;if(e(pt.cb),Lt.ac==null||Lt.ac(Lt)){Lt.ob&&(pt.L=0);var Gt=SN[pt.L];if(pt.L==2?(pt.yb=0,pt.zb=0):(pt.yb=Lt.v-Gt>>4,pt.zb=Lt.j-Gt>>4,0>pt.yb&&(pt.yb=0),0>pt.zb&&(pt.zb=0)),pt.Va=Lt.o+15+Gt>>4,pt.Hb=Lt.va+15+Gt>>4,pt.Hb>pt.za&&(pt.Hb=pt.za),pt.Va>pt.Ub&&(pt.Va=pt.Ub),0<pt.L){var dr=pt.ed;for(Gt=0;4>Gt;++Gt){var Wt;if(pt.Qa.Cb){var mr=pt.Qa.Lb[Gt];pt.Qa.Fb||(mr+=dr.Tb)}else mr=dr.Tb;for(Wt=0;1>=Wt;++Wt){var gr=pt.gd[Gt][Wt],Tr=mr;if(dr.Pc&&(Tr+=dr.vd[0],Wt&&(Tr+=dr.od[0])),0<(Tr=0>Tr?0:63<Tr?63:Tr)){var Cr=Tr;0<dr.wb&&(Cr=4<dr.wb?Cr>>2:Cr>>1)>9-dr.wb&&(Cr=9-dr.wb),1>Cr&&(Cr=1),gr.dd=Cr,gr.tc=2*Tr+Cr,gr.ld=40<=Tr?2:15<=Tr?1:0}else gr.tc=0;gr.La=Wt}}}Gt=0}else Zt(pt,6,"Frame setup failed"),Gt=pt.a;if(Gt=Gt==0){if(Gt){pt.$c=0,0<pt.Aa||(pt.Ic=Ode);t:{Gt=pt.Ic,dr=4*(Cr=pt.za);var yn=32*Cr,cn=Cr+1,Xn=0<pt.L?Cr*(0<pt.Aa?2:1):0,mn=(pt.Aa==2?2:1)*Cr;if((gr=dr+832+(Wt=3*(16*Gt+SN[pt.L])/2*yn)+(mr=pt.Fa!=null&&0<pt.Fa.length?pt.Kc.c*pt.Kc.i:0))!=gr)Gt=0;else{if(gr>pt.Vb){if(pt.Vb=0,pt.Ec=s(gr),pt.Fc=0,pt.Ec==null){Gt=Zt(pt,1,"no memory during frame initialization.");break t}pt.Vb=gr}gr=pt.Ec,Tr=pt.Fc,pt.Ac=gr,pt.Bc=Tr,Tr+=dr,pt.Gd=o(yn,en),pt.Hd=0,pt.rb=o(cn+1,_r),pt.sb=1,pt.wa=Xn?o(Xn,nr):null,pt.Y=0,pt.D.Nb=0,pt.D.wa=pt.wa,pt.D.Y=pt.Y,0<pt.Aa&&(pt.D.Y+=Cr),e(!0),pt.oc=gr,pt.pc=Tr,Tr+=832,pt.ya=o(mn,or),pt.aa=0,pt.D.ya=pt.ya,pt.D.aa=pt.aa,pt.Aa==2&&(pt.D.aa+=Cr),pt.R=16*Cr,pt.B=8*Cr,Cr=(yn=SN[pt.L])*pt.R,yn=yn/2*pt.B,pt.sa=gr,pt.ta=Tr+Cr,pt.qa=pt.sa,pt.ra=pt.ta+16*Gt*pt.R+yn,pt.Ha=pt.qa,pt.Ia=pt.ra+8*Gt*pt.B+yn,pt.$c=0,Tr+=Wt,pt.mb=mr?gr:null,pt.nb=mr?Tr:null,e(Tr+mr<=pt.Fc+pt.Vb),br(pt),a(pt.Ac,pt.Bc,0,dr),Gt=1}}if(Gt){if(Lt.ka=0,Lt.y=pt.sa,Lt.O=pt.ta,Lt.f=pt.qa,Lt.N=pt.ra,Lt.ea=pt.Ha,Lt.Vd=pt.Ia,Lt.fa=pt.R,Lt.Rc=pt.B,Lt.F=null,Lt.J=0,!rL){for(Gt=-255;255>=Gt;++Gt)J8[255+Gt]=0>Gt?-Gt:Gt;for(Gt=-1020;1020>=Gt;++Gt)Z8[1020+Gt]=-128>Gt?-128:127<Gt?127:Gt;for(Gt=-112;112>=Gt;++Gt)eL[112+Gt]=-16>Gt?-16:15<Gt?15:Gt;for(Gt=-255;510>=Gt;++Gt)tL[255+Gt]=0>Gt?0:255<Gt?255:Gt;rL=1}ZA=ye,qm=de,Ff=tt,Ma=at,ds=ct,Yu=fn,Ti=Bf,ho=fo,bh=Be,U1=At,Wg=zu,xN=M,H8=Ct,$8=Vt,K8=dc,G8=ol,q8=fu,z8=GA,Kd[0]=Sr,Kd[1]=St,Kd[2]=Yr,Kd[3]=Vr,Kd[4]=pr,Kd[5]=Bn,Kd[6]=jr,Kd[7]=wn,Kd[8]=ua,Kd[9]=xn,e0[0]=Xt,e0[1]=vt,e0[2]=Et,e0[3]=qt,e0[4]=ar,e0[5]=vr,e0[6]=ur,wh[0]=Fl,wh[1]=wt,wh[2]=ga,wh[3]=Yi,wh[4]=Qn,wh[5]=xa,wh[6]=du,Gt=1}else Gt=0}Gt&&(Gt=function(pa,Ao){for(pa.M=0;pa.M<pa.Va;++pa.M){var Yn,pn=pa.Jc[pa.M&pa.Xb],Wr=pa.m,ki=pa;for(Yn=0;Yn<ki.za;++Yn){var Kn=Wr,va=ki,_s=va.Ac,ul=va.Bc+4*Yn,fc=va.zc,xi=va.ya[va.aa+Yn];if(va.Qa.Bb?xi.$b=Z(Kn,va.Pa.jb[0])?2+Z(Kn,va.Pa.jb[2]):Z(Kn,va.Pa.jb[1]):xi.$b=0,va.kc&&(xi.Ad=Z(Kn,va.Bd)),xi.Za=!Z(Kn,145)+0,xi.Za){var Rl=xi.Ob,hc=0;for(va=0;4>va;++va){var mo,wa=fc[0+va];for(mo=0;4>mo;++mo){wa=yde[_s[ul+mo]][wa];for(var Ha=iL[Z(Kn,wa[0])];0<Ha;)Ha=iL[2*Ha+Z(Kn,wa[Ha])];wa=-Ha,_s[ul+mo]=wa}n(Rl,hc,_s,ul,4),hc+=4,fc[0+va]=wa}}else wa=Z(Kn,156)?Z(Kn,128)?1:3:Z(Kn,163)?2:0,xi.Ob[0]=wa,a(_s,ul,wa,4),a(fc,0,wa,4);xi.Dd=Z(Kn,142)?Z(Kn,114)?Z(Kn,183)?1:3:2:0}if(ki.m.Ka)return Zt(pa,7,"Premature end-of-partition0 encountered.");for(;pa.ja<pa.za;++pa.ja){if(ki=pn,Kn=(Wr=pa).rb[Wr.sb-1],_s=Wr.rb[Wr.sb+Wr.ja],Yn=Wr.ya[Wr.aa+Wr.ja],ul=Wr.kc?Yn.Ad:0)Kn.la=_s.la=0,Yn.Za||(Kn.Na=_s.Na=0),Yn.Hc=0,Yn.Gc=0,Yn.ia=0;else{var vi,$a;if(Kn=_s,_s=ki,ul=Wr.Pa.Xc,fc=Wr.ya[Wr.aa+Wr.ja],xi=Wr.pb[fc.$b],va=fc.ad,Rl=0,hc=Wr.rb[Wr.sb-1],wa=mo=0,a(va,Rl,0,384),fc.Za)var dl=0,Gd=ul[3];else{Ha=s(16);var Fi=Kn.Na+hc.Na;if(Fi=V1(_s,ul[1],Fi,xi.Eb,0,Ha,0),Kn.Na=hc.Na=(0<Fi)+0,1<Fi)ZA(Ha,0,va,Rl);else{var Qc=Ha[0]+3>>3;for(Ha=0;256>Ha;Ha+=16)va[Rl+Ha]=Qc}dl=1,Gd=ul[0]}var fs=15&Kn.la,po=15&hc.la;for(Ha=0;4>Ha;++Ha){var gu=1&po;for(Qc=$a=0;4>Qc;++Qc)fs=fs>>1|(gu=(Fi=V1(_s,Gd,Fi=gu+(1&fs),xi.Sc,dl,va,Rl))>dl)<<7,$a=$a<<2|(3<Fi?3:1<Fi?2:va[Rl+0]!=0),Rl+=16;fs>>=4,po=po>>1|gu<<7,mo=(mo<<8|$a)>>>0}for(Gd=fs,dl=po>>4,vi=0;4>vi;vi+=2){for($a=0,fs=Kn.la>>4+vi,po=hc.la>>4+vi,Ha=0;2>Ha;++Ha){for(gu=1&po,Qc=0;2>Qc;++Qc)Fi=gu+(1&fs),fs=fs>>1|(gu=0<(Fi=V1(_s,ul[2],Fi,xi.Qc,0,va,Rl)))<<3,$a=$a<<2|(3<Fi?3:1<Fi?2:va[Rl+0]!=0),Rl+=16;fs>>=2,po=po>>1|gu<<5}wa|=$a<<4*vi,Gd|=fs<<4<<vi,dl|=(240&po)<<vi}Kn.la=Gd,hc.la=dl,fc.Hc=mo,fc.Gc=wa,fc.ia=43690&wa?0:xi.ia,ul=!(mo|wa)}if(0<Wr.L&&(Wr.wa[Wr.Y+Wr.ja]=Wr.gd[Yn.$b][Yn.Za],Wr.wa[Wr.Y+Wr.ja].La|=!ul),ki.Ka)return Zt(pa,7,"Premature end-of-file encountered.")}if(br(pa),Wr=Ao,ki=1,Yn=(pn=pa).D,Kn=0<pn.L&&pn.M>=pn.zb&&pn.M<=pn.Va,pn.Aa==0)t:{if(Yn.M=pn.M,Yn.uc=Kn,cl(pn,Yn),ki=1,Yn=($a=pn.D).Nb,Kn=(wa=SN[pn.L])*pn.R,_s=wa/2*pn.B,Ha=16*Yn*pn.R,Qc=8*Yn*pn.B,ul=pn.sa,fc=pn.ta-Kn+Ha,xi=pn.qa,va=pn.ra-_s+Qc,Rl=pn.Ha,hc=pn.Ia-_s+Qc,po=(fs=$a.M)==0,mo=fs>=pn.Va-1,pn.Aa==2&&cl(pn,$a),$a.uc)for(gu=(Fi=pn).D.M,e(Fi.D.uc),$a=Fi.yb;$a<Fi.Hb;++$a){dl=$a,Gd=gu;var Ac=(xu=(fl=Fi).D).Nb;vi=fl.R;var xu=xu.wa[xu.Y+dl],vu=fl.sa,Vc=fl.ta+16*Ac*vi+16*dl,yu=xu.dd,xs=xu.tc;if(xs!=0)if(e(3<=xs),fl.L==1)0<dl&&G8(vu,Vc,vi,xs+4),xu.La&&z8(vu,Vc,vi,xs),0<Gd&&K8(vu,Vc,vi,xs+4),xu.La&&q8(vu,Vc,vi,xs);else{var bu=fl.B,qd=fl.qa,zm=fl.ra+8*Ac*bu+8*dl,Nh=fl.Ha,fl=fl.Ia+8*Ac*bu+8*dl;Ac=xu.ld,0<dl&&(ho(vu,Vc,vi,xs+4,yu,Ac),U1(qd,zm,Nh,fl,bu,xs+4,yu,Ac)),xu.La&&(xN(vu,Vc,vi,xs,yu,Ac),$8(qd,zm,Nh,fl,bu,xs,yu,Ac)),0<Gd&&(Ti(vu,Vc,vi,xs+4,yu,Ac),bh(qd,zm,Nh,fl,bu,xs+4,yu,Ac)),xu.La&&(Wg(vu,Vc,vi,xs,yu,Ac),H8(qd,zm,Nh,fl,bu,xs,yu,Ac))}}if(pn.ia&&alert("todo:DitherRow"),Wr.put!=null){if($a=16*fs,fs=16*(fs+1),po?(Wr.y=pn.sa,Wr.O=pn.ta+Ha,Wr.f=pn.qa,Wr.N=pn.ra+Qc,Wr.ea=pn.Ha,Wr.W=pn.Ia+Qc):($a-=wa,Wr.y=ul,Wr.O=fc,Wr.f=xi,Wr.N=va,Wr.ea=Rl,Wr.W=hc),mo||(fs-=wa),fs>Wr.o&&(fs=Wr.o),Wr.F=null,Wr.J=null,pn.Fa!=null&&0<pn.Fa.length&&$a<fs&&(Wr.J=Va(pn,Wr,$a,fs-$a),Wr.F=pn.mb,Wr.F==null&&Wr.F.length==0)){ki=Zt(pn,3,"Could not decode alpha data.");break t}$a<Wr.j&&(wa=Wr.j-$a,$a=Wr.j,e(!(1&wa)),Wr.O+=pn.R*wa,Wr.N+=pn.B*(wa>>1),Wr.W+=pn.B*(wa>>1),Wr.F!=null&&(Wr.J+=Wr.width*wa)),$a<fs&&(Wr.O+=Wr.v,Wr.N+=Wr.v>>1,Wr.W+=Wr.v>>1,Wr.F!=null&&(Wr.J+=Wr.v),Wr.ka=$a-Wr.j,Wr.U=Wr.va-Wr.v,Wr.T=fs-$a,ki=Wr.put(Wr))}Yn+1!=pn.Ic||mo||(n(pn.sa,pn.ta-Kn,ul,fc+16*pn.R,Kn),n(pn.qa,pn.ra-_s,xi,va+8*pn.B,_s),n(pn.Ha,pn.Ia-_s,Rl,hc+8*pn.B,_s))}if(!ki)return Zt(pa,6,"Output aborted.")}return 1}(pt,Lt)),Lt.bc!=null&&Lt.bc(Lt),Gt&=1}return Gt?(pt.cb=0,Gt):0})(N,ae)||(T=N.a)}}else T=N.a}T==0&&Ke.Oa!=null&&Ke.Oa.fd&&(T=F1(Ke.ba))}Ke=T}Ve=Ke!=0?null:11>Ve?Je.f.RGBA.eb:Je.f.kb.y}else Ve=null;return Ve};var AL=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(E,B){for(var k="",P=0;P<4;P++)k+=String.fromCharCode(E[B++]);return k}function d(E,B){return E[B+0]|E[B+1]<<8}function f(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16)>>>0}function A(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16|E[B+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,v=t,y=function(E,B){var k={},P=0,O=!1,z=0,oe=0;if(k.frames=[],!function(F,H){for(var K=0;K<4;K++)if(F[H+K]!="RIFF".charCodeAt(K))return!0;return!1}(E,B)){for(A(E,B+=4),B+=8;B<E.length;){var ce=u(E,B),ue=A(E,B+=4);B+=4;var ge=ue+(1&ue);switch(ce){case"VP8 ":case"VP8L":k.frames[P]===void 0&&(k.frames[P]={}),(Ue=k.frames[P]).src_off=O?oe:B-8,Ue.src_size=z+ue+8,P++,O&&(O=!1,z=0,oe=0);break;case"VP8X":(Ue=k.header={}).feature_flags=E[B];var ne=B+4;Ue.canvas_width=1+f(E,ne),ne+=3,Ue.canvas_height=1+f(E,ne),ne+=3;break;case"ALPH":O=!0,z=ge+8,oe=B-8;break;case"ANIM":(Ue=k.header).bgcolor=A(E,B),ne=B+4,Ue.loop_count=d(E,ne),ne+=2;break;case"ANMF":var Oe,Ue;(Ue=k.frames[P]={}).offset_x=2*f(E,B),B+=3,Ue.offset_y=2*f(E,B),B+=3,Ue.width=1+f(E,B),B+=3,Ue.height=1+f(E,B),B+=3,Ue.duration=f(E,B),B+=3,Oe=E[B++],Ue.dispose=1&Oe,Ue.blend=Oe>>1&1}ce!="ANMF"&&(B+=ge)}return k}}(v,0);y.response=v,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,w=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var j=0;j<w.length&&w[j].blend!=0;j++);}var I=w[0],_=x.WebPDecodeRGBA(v,I.src_off,I.src_size,m,h);I.rgba=_,I.imgwidth=m[0],I.imgheight=h[0];for(var S=0;S<m[0]*h[0]*4;S++)p[S]=_[S];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,a,s,o,l,c,u,d=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new c,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new o,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new o,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=F;Object.defineProperty(this,"pdf",{get:function(){return H}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(J){K=!!J}});var U=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return U},set:function(J){U=!!J}});var W=0;Object.defineProperty(this,"posX",{get:function(){return W},set:function(J){isNaN(J)||(W=J)}});var X=0;Object.defineProperty(this,"posY",{get:function(){return X},set:function(J){isNaN(J)||(X=J)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(J){var De;typeof J=="number"?De=[J,J,J,J]:((De=new Array(4))[0]=J[0],De[1]=J.length>=2?J[1]:De[0],De[2]=J.length>=3?J[2]:De[0],De[3]=J.length>=4?J[3]:De[1]),u.margin=De}});var D=!1;Object.defineProperty(this,"autoPaging",{get:function(){return D},set:function(J){D=J}});var V=0;Object.defineProperty(this,"lastBreak",{get:function(){return V},set:function(J){V=J}});var Z=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Z},set:function(J){Z=J}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(J){J instanceof d&&(u=J)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(J){u.path=J}});var be=[];Object.defineProperty(this,"ctxStack",{get:function(){return be},set:function(J){be=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var De;De=A(J),this.ctx.fillStyle=De.style,this.ctx.isFillTransparent=De.a===0,this.ctx.fillOpacity=De.a,this.pdf.setFillColor(De.r,De.g,De.b,{a:De.a}),this.pdf.setTextColor(De.r,De.g,De.b,{a:De.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var De=A(J);this.ctx.strokeStyle=De.style,this.ctx.isStrokeTransparent=De.a===0,this.ctx.strokeOpacity=De.a,De.a===0?this.pdf.setDrawColor(255,255,255):(De.a,this.pdf.setDrawColor(De.r,De.g,De.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var L=null,Xe=null,re=null;Object.defineProperty(this,"fontFaces",{get:function(){return re},set:function(J){L=null,Xe=null,re=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var De;if(this.ctx.font=J,(De=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var ie=De[1];De[2];var He=De[3],Ge=De[4];De[5];var dt=De[6],_t=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ge)[2];Ge=Math.floor(_t==="px"?parseFloat(Ge)*this.pdf.internal.scaleFactor:_t==="em"?parseFloat(Ge)*this.pdf.getFontSize():parseFloat(Ge)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ge);var Bt=function(ee){var me,Re,he=[],qe=ee.trim();if(qe==="")return p5;if(qe in IV)return[IV[qe]];for(;qe!=="";){switch(Re=null,me=(qe=PV(qe)).charAt(0)){case'"':case"'":Re=Zje(qe.substring(1),me);break;default:Re=ePe(qe)}if(Re===null||(he.push(Re[0]),(qe=PV(Re[1]))!==""&&qe.charAt(0)!==","))return p5;qe=qe.replace(/^,/,"")}return he}(dt);if(this.fontFaces){var Ot=function(ee,me){var Re=ee.getFontList(),he=JSON.stringify(Re);if(L===null||Xe!==he){var qe=function(st){var yt=[];return Object.keys(st).forEach(function(pe){st[pe].forEach(function(je){var we=null;switch(je){case"bold":we={family:pe,weight:"bold"};break;case"italic":we={family:pe,style:"italic"};break;case"bolditalic":we={family:pe,weight:"bold",style:"italic"};break;case"":case"normal":we={family:pe}}we!==null&&(we.ref={name:pe,style:je},yt.push(we))})}),yt}(Re);L=function(st){for(var yt={},pe=0;pe<st.length;++pe){var je=m5(st[pe]),we=je.family,Ye=je.stretch,xe=je.style,Se=je.weight;yt[we]=yt[we]||{},yt[we][Ye]=yt[we][Ye]||{},yt[we][Ye][xe]=yt[we][Ye][xe]||{},yt[we][Ye][xe][Se]=je}return yt}(qe.concat(me)),Xe=he}return L}(this.pdf,this.fontFaces),jt=Bt.map(function(ee){return{family:ee,stretch:"normal",weight:He,style:ie}}),Qt=function(ee,me,Re){for(var he=(Re=Re||{}).defaultFontFamily||"times",qe=Object.assign({},Jje,Re.genericFontFamilies||{}),st=null,yt=null,pe=0;pe<me.length;++pe)if(qe[(st=m5(me[pe])).family]&&(st.family=qe[st.family]),ee.hasOwnProperty(st.family)){yt=ee[st.family];break}if(!(yt=yt||ee[he]))throw new Error("Could not find a font-family for the rule '"+jV(st)+"' and default family '"+he+"'.");if(yt=function(je,we){if(we[je])return we[je];var Ye=$k[je],xe=Ye<=$k.normal?-1:1,Se=SV(we,Dre,Ye,xe);if(!Se)throw new Error("Could not find a matching font-stretch value for "+je);return Se}(st.stretch,yt),yt=function(je,we){if(we[je])return we[je];for(var Ye=Ore[je],xe=0;xe<Ye.length;++xe)if(we[Ye[xe]])return we[Ye[xe]];throw new Error("Could not find a matching font-style for "+je)}(st.style,yt),!(yt=function(je,we){if(we[je])return we[je];if(je===400&&we[500])return we[500];if(je===500&&we[400])return we[400];var Ye=Yje[je],xe=SV(we,Rre,Ye,je<400?-1:1);if(!xe)throw new Error("Could not find a matching font-weight for value "+je);return xe}(st.weight,yt)))throw new Error("Failed to resolve a font for the rule '"+jV(st)+"'.");return yt}(Ot,jt);this.pdf.setFont(Qt.ref.name,Qt.ref.style)}else{var Ft="";(He==="bold"||parseInt(He,10)>=700||ie==="bold")&&(Ft="bold"),ie==="italic"&&(Ft+="italic"),Ft.length===0&&(Ft="normal");for(var $e="",Fe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ze=0;Ze<Bt.length;Ze++){if(this.pdf.internal.getFont(Bt[Ze],Ft,{noFallback:!0,disableWarning:!0})!==void 0){$e=Bt[Ze];break}if(Ft==="bolditalic"&&this.pdf.internal.getFont(Bt[Ze],"bold",{noFallback:!0,disableWarning:!0})!==void 0)$e=Bt[Ze],Ft="bold";else if(this.pdf.internal.getFont(Bt[Ze],"normal",{noFallback:!0,disableWarning:!0})!==void 0){$e=Bt[Ze],Ft="normal";break}}if($e===""){for(var Te=0;Te<Bt.length;Te++)if(Fe[Bt[Te]]){$e=Fe[Bt[Te]];break}}$e=$e===""?"Times":$e,this.pdf.setFont($e,Ft)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,Ue.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,Ue.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};f.prototype.setLineDash=function(F){this.lineDash=F},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){w.call(this,"fill",!1)},f.prototype.stroke=function(){w.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new o(F,H));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(F,H)},f.prototype.closePath=function(){var F=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&es(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){F=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(F.x,F.y)},f.prototype.lineTo=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new o(F,H));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},f.prototype.quadraticCurveTo=function(F,H,K,U){if(isNaN(K)||isNaN(U)||isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var W=this.ctx.transform.applyToPoint(new o(K,U)),X=this.ctx.transform.applyToPoint(new o(F,H));this.path.push({type:"qct",x1:X.x,y1:X.y,x:W.x,y:W.y}),this.ctx.lastPoint=new o(W.x,W.y)},f.prototype.bezierCurveTo=function(F,H,K,U,W,X){if(isNaN(W)||isNaN(X)||isNaN(F)||isNaN(H)||isNaN(K)||isNaN(U))throw hs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var D=this.ctx.transform.applyToPoint(new o(W,X)),V=this.ctx.transform.applyToPoint(new o(F,H)),Z=this.ctx.transform.applyToPoint(new o(K,U));this.path.push({type:"bct",x1:V.x,y1:V.y,x2:Z.x,y2:Z.y,x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},f.prototype.arc=function(F,H,K,U,W,X){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(U)||isNaN(W))throw hs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(X=!!X,!this.ctx.transform.isIdentity){var D=this.ctx.transform.applyToPoint(new o(F,H));F=D.x,H=D.y;var V=this.ctx.transform.applyToPoint(new o(0,K)),Z=this.ctx.transform.applyToPoint(new o(0,0));K=Math.sqrt(Math.pow(V.x-Z.x,2)+Math.pow(V.y-Z.y,2))}Math.abs(W-U)>=2*Math.PI&&(U=0,W=2*Math.PI),this.path.push({type:"arc",x:F,y:H,radius:K,startAngle:U,endAngle:W,counterclockwise:X})},f.prototype.arcTo=function(F,H,K,U,W){throw new Error("arcTo not implemented.")},f.prototype.rect=function(F,H,K,U){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(U))throw hs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,H),this.lineTo(F+K,H),this.lineTo(F+K,H+U),this.lineTo(F,H+U),this.lineTo(F,H),this.lineTo(F+K,H),this.lineTo(F,H)},f.prototype.fillRect=function(F,H,K,U){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(U))throw hs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var W={};this.lineCap!=="butt"&&(W.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(W.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,H,K,U),this.fill(),W.hasOwnProperty("lineCap")&&(this.lineCap=W.lineCap),W.hasOwnProperty("lineJoin")&&(this.lineJoin=W.lineJoin)}},f.prototype.strokeRect=function(F,H,K,U){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(U))throw hs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(F,H,K,U),this.stroke())},f.prototype.clearRect=function(F,H,K,U){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(U))throw hs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,H,K,U))},f.prototype.save=function(F){F=typeof F!="boolean"||F;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var U=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=U}},f.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage(H),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(F){var H,K,U,W;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))H=0,K=0,U=0,W=0;else{var X=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(X!==null)H=parseInt(X[1]),K=parseInt(X[2]),U=parseInt(X[3]),W=1;else if((X=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)H=parseInt(X[1]),K=parseInt(X[2]),U=parseInt(X[3]),W=parseFloat(X[4]);else{if(W=1,typeof F=="string"&&F.charAt(0)!=="#"){var D=new Ire(F);F=D.ok?D.toHex():"#000000"}F.length===4?(H=F.substring(1,2),H+=H,K=F.substring(2,3),K+=K,U=F.substring(3,4),U+=U):(H=F.substring(1,3),K=F.substring(3,5),U=F.substring(5,7)),H=parseInt(H,16),K=parseInt(K,16),U=parseInt(U,16)}}return{r:H,g:K,b:U,a:W,style:F}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(F,H,K,U){if(isNaN(H)||isNaN(K)||typeof F!="string")throw hs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(U=isNaN(U)?void 0:U,!h.call(this)){var W=ge(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;P.call(this,{text:F,x:H,y:K,scale:X,angle:W,align:this.textAlign,maxWidth:U})}},f.prototype.strokeText=function(F,H,K,U){if(isNaN(H)||isNaN(K)||typeof F!="string")throw hs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){U=isNaN(U)?void 0:U;var W=ge(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;P.call(this,{text:F,x:H,y:K,scale:X,renderingMode:"stroke",angle:W,align:this.textAlign,maxWidth:U})}},f.prototype.measureText=function(F){if(typeof F!="string")throw hs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,K=this.pdf.internal.scaleFactor,U=H.internal.getFontSize(),W=H.getStringUnitWidth(F)*U/H.internal.scaleFactor;return new function(X){var D=(X=X||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this}({width:W*=Math.round(96*K/72*1e4)/1e4})},f.prototype.scale=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new c(F,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.rotate=function(F){if(isNaN(F))throw hs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new c(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.translate=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new c(1,0,0,1,F,H);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.transform=function(F,H,K,U,W,X){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(U)||isNaN(W)||isNaN(X))throw hs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var D=new c(F,H,K,U,W,X);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.setTransform=function(F,H,K,U,W,X){F=isNaN(F)?1:F,H=isNaN(H)?0:H,K=isNaN(K)?0:K,U=isNaN(U)?1:U,W=isNaN(W)?0:W,X=isNaN(X)?0:X,this.ctx.transform=new c(F,H,K,U,W,X)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(F,H,K,U,W,X,D,V,Z){var be=this.pdf.getImageProperties(F),L=1,Xe=1,re=1,J=1;U!==void 0&&V!==void 0&&(re=V/U,J=Z/W,L=be.width/U*V/U,Xe=be.height/W*Z/W),X===void 0&&(X=H,D=K,H=0,K=0),U!==void 0&&V===void 0&&(V=U,Z=W),U===void 0&&V===void 0&&(V=be.width,Z=be.height);var De=this.ctx.transform.decompose(),ie=ge(De.rotate.shx),He=new c,Ge=(He=(He=(He=He.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new l(X-H*re,D-K*J,U*L,W*Xe));if(this.autoPaging){for(var dt,_t=x.call(this,Ge),Bt=[],Ot=0;Ot<_t.length;Ot+=1)Bt.indexOf(_t[Ot])===-1&&Bt.push(_t[Ot]);b(Bt);for(var jt=Bt[0],Qt=Bt[Bt.length-1],Ft=jt;Ft<Qt+1;Ft++){this.pdf.setPage(Ft);var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fe=Ft===1?this.posY+this.margin[0]:this.margin[0],Ze=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Te=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ee=Ft===1?0:Ze+(Ft-2)*Te;if(this.ctx.clip_path.length!==0){var me=this.path;dt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(dt,this.posX+this.margin[3],-ee+Fe+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=me}var Re=JSON.parse(JSON.stringify(Ge));Re=y([Re],this.posX+this.margin[3],-ee+Fe+this.ctx.prevPageLastElemOffset)[0];var he=(Ft>jt||Ft<Qt)&&p.call(this);he&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,Te,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",Re.x,Re.y,Re.w,Re.h,null,null,ie),he&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(F,"JPEG",Ge.x,Ge.y,Ge.w,Ge.h,null,null,ie)};var x=function(F,H,K){var U=[];H=H||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var W=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":U.push(Math.floor((F.y+W)/K)+1);break;case"arc":U.push(Math.floor((F.y+W-F.radius)/K)+1),U.push(Math.floor((F.y+W+F.radius)/K)+1);break;case"qct":var X=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);U.push(Math.floor((X.y+W)/K)+1),U.push(Math.floor((X.y+X.h+W)/K)+1);break;case"bct":var D=Oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);U.push(Math.floor((D.y+W)/K)+1),U.push(Math.floor((D.y+D.h+W)/K)+1);break;case"rect":U.push(Math.floor((F.y+W)/K)+1),U.push(Math.floor((F.y+F.h+W)/K)+1)}for(var V=0;V<U.length;V+=1)for(;this.pdf.internal.getNumberOfPages()<U[V];)v.call(this);return U},v=function(){var F=this.fillStyle,H=this.strokeStyle,K=this.font,U=this.lineCap,W=this.lineWidth,X=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=H,this.font=K,this.lineCap=U,this.lineWidth=W,this.lineJoin=X},y=function(F,H,K){for(var U=0;U<F.length;U++)switch(F[U].type){case"bct":F[U].x2+=H,F[U].y2+=K;case"qct":F[U].x1+=H,F[U].y1+=K;default:F[U].x+=H,F[U].y+=K}return F},b=function(F){return F.sort(function(H,K){return H-K})},w=function(F,H){var K=this.fillStyle,U=this.strokeStyle,W=this.lineCap,X=this.lineWidth,D=Math.abs(X*this.ctx.transform.scaleX),V=this.lineJoin;if(this.autoPaging){for(var Z,be,L=JSON.parse(JSON.stringify(this.path)),Xe=JSON.parse(JSON.stringify(this.path)),re=[],J=0;J<Xe.length;J++)if(Xe[J].x!==void 0)for(var De=x.call(this,Xe[J]),ie=0;ie<De.length;ie+=1)re.indexOf(De[ie])===-1&&re.push(De[ie]);for(var He=0;He<re.length;He++)for(;this.pdf.internal.getNumberOfPages()<re[He];)v.call(this);b(re);for(var Ge=re[0],dt=re[re.length-1],_t=Ge;_t<dt+1;_t++){this.pdf.setPage(_t),this.fillStyle=K,this.strokeStyle=U,this.lineCap=W,this.lineWidth=D,this.lineJoin=V;var Bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=_t===1?this.posY+this.margin[0]:this.margin[0],jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ft=_t===1?0:jt+(_t-2)*Qt;if(this.ctx.clip_path.length!==0){var $e=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Z,this.posX+this.margin[3],-Ft+Ot+this.ctx.prevPageLastElemOffset),j.call(this,F,!0),this.path=$e}if(be=JSON.parse(JSON.stringify(L)),this.path=y(be,this.posX+this.margin[3],-Ft+Ot+this.ctx.prevPageLastElemOffset),H===!1||_t===0){var Fe=(_t>Ge||_t<dt)&&p.call(this);Fe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Bt,Qt,null).clip().discardPath()),j.call(this,F,H),Fe&&this.pdf.restoreGraphicsState()}this.lineWidth=X}this.path=L}else this.lineWidth=D,j.call(this,F,H),this.lineWidth=X},j=function(F,H){if((F!=="stroke"||H||!m.call(this))&&(F==="stroke"||H||!h.call(this))){for(var K,U,W=[],X=this.path,D=0;D<X.length;D++){var V=X[D];switch(V.type){case"begin":W.push({begin:!0});break;case"close":W.push({close:!0});break;case"mt":W.push({start:V,deltas:[],abs:[]});break;case"lt":var Z=W.length;if(X[D-1]&&!isNaN(X[D-1].x)&&(K=[V.x-X[D-1].x,V.y-X[D-1].y],Z>0)){for(;Z>=0;Z--)if(W[Z-1].close!==!0&&W[Z-1].begin!==!0){W[Z-1].deltas.push(K),W[Z-1].abs.push(V);break}}break;case"bct":K=[V.x1-X[D-1].x,V.y1-X[D-1].y,V.x2-X[D-1].x,V.y2-X[D-1].y,V.x-X[D-1].x,V.y-X[D-1].y],W[W.length-1].deltas.push(K);break;case"qct":var be=X[D-1].x+2/3*(V.x1-X[D-1].x),L=X[D-1].y+2/3*(V.y1-X[D-1].y),Xe=V.x+2/3*(V.x1-V.x),re=V.y+2/3*(V.y1-V.y),J=V.x,De=V.y;K=[be-X[D-1].x,L-X[D-1].y,Xe-X[D-1].x,re-X[D-1].y,J-X[D-1].x,De-X[D-1].y],W[W.length-1].deltas.push(K);break;case"arc":W.push({deltas:[],abs:[],arc:!0}),Array.isArray(W[W.length-1].abs)&&W[W.length-1].abs.push(V)}}U=H?null:F==="stroke"?"stroke":"fill";for(var ie=!1,He=0;He<W.length;He++)if(W[He].arc)for(var Ge=W[He].abs,dt=0;dt<Ge.length;dt++){var _t=Ge[dt];_t.type==="arc"?S.call(this,_t.x,_t.y,_t.radius,_t.startAngle,_t.endAngle,_t.counterclockwise,void 0,H,!ie):O.call(this,_t.x,_t.y),ie=!0}else if(W[He].close===!0)this.pdf.internal.out("h"),ie=!1;else if(W[He].begin!==!0){var Bt=W[He].start.x,Ot=W[He].start.y;z.call(this,W[He].deltas,Bt,Ot),ie=!0}U&&E.call(this,U),H&&B.call(this)}},I=function(F){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-K;case"top":return F+H-K;case"hanging":return F+H-2*K;case"middle":return F+H/2-K;default:return F}},_=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function(H,K){this.colorStops.push([H,K])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(F,H,K,U,W,X,D,V,Z){for(var be=ce.call(this,K,U,W,X),L=0;L<be.length;L++){var Xe=be[L];L===0&&(Z?k.call(this,Xe.x1+F,Xe.y1+H):O.call(this,Xe.x1+F,Xe.y1+H)),oe.call(this,F,H,Xe.x2,Xe.y2,Xe.x3,Xe.y3,Xe.x4,Xe.y4)}V?B.call(this):E.call(this,D)},E=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(F,H){this.pdf.internal.out(r(F)+" "+n(H)+" m")},P=function(F){var H;switch(F.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var K,U,W,X=this.pdf.getTextDimensions(F.text),D=I.call(this,F.y),V=_.call(this,D)-X.h,Z=this.ctx.transform.applyToPoint(new o(F.x,D));if(this.autoPaging){var be=this.ctx.transform.decompose(),L=new c;L=(L=(L=L.multiply(be.translate)).multiply(be.skew)).multiply(be.scale);for(var Xe=this.ctx.transform.applyToRectangle(new l(F.x,D,X.w,X.h)),re=L.applyToRectangle(new l(F.x,V,X.w,X.h)),J=x.call(this,re),De=[],ie=0;ie<J.length;ie+=1)De.indexOf(J[ie])===-1&&De.push(J[ie]);b(De);for(var He=De[0],Ge=De[De.length-1],dt=He;dt<Ge+1;dt++){this.pdf.setPage(dt);var _t=dt===1?this.posY+this.margin[0]:this.margin[0],Bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ot=this.pdf.internal.pageSize.height-this.margin[2],jt=Ot-this.margin[0],Qt=this.pdf.internal.pageSize.width-this.margin[1],Ft=Qt-this.margin[3],$e=dt===1?0:Bt+(dt-2)*jt;if(this.ctx.clip_path.length!==0){var Fe=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(K,this.posX+this.margin[3],-1*$e+_t),j.call(this,"fill",!0),this.path=Fe}var Ze=y([JSON.parse(JSON.stringify(re))],this.posX+this.margin[3],-$e+_t+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(U=this.pdf.internal.getFontSize(),this.pdf.setFontSize(U*F.scale),W=this.lineWidth,this.lineWidth=W*F.scale);var Te=this.autoPaging!=="text";if(Te||Ze.y+Ze.h<=Ot){if(Te||Ze.y>=_t&&Ze.x<=Qt){var ee=Te?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||Qt-Ze.x)[0],me=y([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-$e+_t+this.ctx.prevPageLastElemOffset)[0],Re=Te&&(dt>He||dt<Ge)&&p.call(this);Re&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ft,jt,null).clip().discardPath()),this.pdf.text(ee,me.x,me.y,{angle:F.angle,align:H,renderingMode:F.renderingMode}),Re&&this.pdf.restoreGraphicsState()}}else Ze.y<Ot&&(this.ctx.prevPageLastElemOffset+=Ot-Ze.y);F.scale>=.01&&(this.pdf.setFontSize(U),this.lineWidth=W)}}else F.scale>=.01&&(U=this.pdf.internal.getFontSize(),this.pdf.setFontSize(U*F.scale),W=this.lineWidth,this.lineWidth=W*F.scale),this.pdf.text(F.text,Z.x+this.posX,Z.y+this.posY,{angle:F.angle,align:H,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(U),this.lineWidth=W)},O=function(F,H,K,U){K=K||0,U=U||0,this.pdf.internal.out(r(F+K)+" "+n(H+U)+" l")},z=function(F,H,K){return this.pdf.lines(F,H,K,null,null)},oe=function(F,H,K,U,W,X,D,V){this.pdf.internal.out([e(a(K+F)),e(s(U+H)),e(a(W+F)),e(s(X+H)),e(a(D+F)),e(s(V+H)),"c"].join(" "))},ce=function(F,H,K,U){for(var W=2*Math.PI,X=Math.PI/2;H>K;)H-=W;var D=Math.abs(K-H);D<W&&U&&(D=W-D);for(var V=[],Z=U?-1:1,be=H;D>1e-5;){var L=be+Z*Math.min(D,X);V.push(ue.call(this,F,be,L)),D-=Math.abs(L-be),be=L}return V},ue=function(F,H,K){var U=(K-H)/2,W=F*Math.cos(U),X=F*Math.sin(U),D=W,V=-X,Z=D*D+V*V,be=Z+D*W+V*X,L=4/3*(Math.sqrt(2*Z*be)-be)/(D*X-V*W),Xe=D-L*V,re=V+L*D,J=Xe,De=-re,ie=U+H,He=Math.cos(ie),Ge=Math.sin(ie);return{x1:F*Math.cos(H),y1:F*Math.sin(H),x2:Xe*He-re*Ge,y2:Xe*Ge+re*He,x3:J*He-De*Ge,y3:J*Ge+De*He,x4:F*Math.cos(K),y4:F*Math.sin(K)}},ge=function(F){return 180*F/Math.PI},ne=function(F,H,K,U,W,X){var D=F+.5*(K-F),V=H+.5*(U-H),Z=W+.5*(K-W),be=X+.5*(U-X),L=Math.min(F,W,D,Z),Xe=Math.max(F,W,D,Z),re=Math.min(H,X,V,be),J=Math.max(H,X,V,be);return new l(L,re,Xe-L,J-re)},Oe=function(F,H,K,U,W,X,D,V){var Z,be,L,Xe,re,J,De,ie,He,Ge,dt,_t,Bt,Ot,jt=K-F,Qt=U-H,Ft=W-K,$e=X-U,Fe=D-W,Ze=V-X;for(be=0;be<41;be++)He=(De=(L=F+(Z=be/40)*jt)+Z*((re=K+Z*Ft)-L))+Z*(re+Z*(W+Z*Fe-re)-De),Ge=(ie=(Xe=H+Z*Qt)+Z*((J=U+Z*$e)-Xe))+Z*(J+Z*(X+Z*Ze-J)-ie),be==0?(dt=He,_t=Ge,Bt=He,Ot=Ge):(dt=Math.min(dt,He),_t=Math.min(_t,Ge),Bt=Math.max(Bt,He),Ot=Math.max(Ot,Ge));return new l(Math.round(dt),Math.round(_t),Math.round(Bt-dt),Math.round(Ot-_t))},Ue=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,H,K=(F=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:H}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(an.API),function(t){var e=function(o){var l,c,u,d,f,A,h,m,p,x;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(A=(f=((f=((f=((f=(f-(x=f%85))/85)-(p=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(A+33,h+33,m+33,p+33,x+33)):c.push(122);return function(v,y){for(var b=y;b>0;b--)v.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,A=String,h="length",m=255,p="charCodeAt",x="slice",v="replace";for(o[x](-2),o=o[x](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[x](o[h]%5||5))[h];f>d;d+=5)c=52200625*(o[p](d)-33)+614125*(o[p](d+1)-33)+7225*(o[p](d+2)-33)+85*(o[p](d+3)-33)+(o[p](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var w=b;w>0;w--)y.pop()}(u,l[h]),A.fromCharCode.apply(A,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Rk(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(an.API),function(t){t.loadFile=function(e,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,A=0,h=function(m){var p=m.length,x=[],v=String.fromCharCode;for(A=0;A<p;A+=1)x.push(v(255&m.charCodeAt(A)));return x.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(a,s,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(an.API),function(t){function e(){return(Mn.html2canvas?Promise.resolve(Mn.html2canvas):iA(()=>Promise.resolve().then(()=>V6),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Mn.DOMPurify?Promise.resolve(Mn.DOMPurify):iA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=es(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],p=m.src.find(function(x){return x.format==="truetype"});p&&u.addFont(p.url,m.ref.name,m.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,u.context2d.save(!0),c(this.prop.container,A)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||an.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(A){return u.updateProgress(null,d),A}).then(d,f).then(function(A){return u.updateProgress(1),A})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),A=u.call(f,l,c);return o.convert(A,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,an.getPageSize=function(l,c,u){if(es(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,A=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(A))p=h[A][1]/f,x=h[A][0]/f;else try{p=u[1],x=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:f,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(m5):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(an.API),an.API.addJS=function(t){return TV=t,this.internal.events.subscribe("postPutResources",function(){DC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(DC+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),BV=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+TV+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){DC!==void 0&&BV!==void 0&&this.internal.out("/Names <</JavaScript "+DC+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var A=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(an.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var A,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(f.charCodeAt(x+1))!==-1){A=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),p={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:A,numcomponents:f.charCodeAt(x+9)};break}h=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(an.API),an.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,s=Dje(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;a=u&&c===1?function(S){for(var E=S.width,B=S.height,k=S.data,P=S.palette,O=S.depth,z=!1,oe=[],ce=[],ue=void 0,ge=!1,ne=0,Oe=0;Oe<P.length;Oe++){var Ue=DQ(P[Oe],4),F=Ue[0],H=Ue[1],K=Ue[2],U=Ue[3];oe.push(F,H,K),U!=null&&(U===0?(ne++,ce.length<1&&ce.push(Oe)):U<255&&(ge=!0))}if(ge||ne>1){z=!0,ce=void 0;var W=E*B;ue=new Uint8Array(W);for(var X=new DataView(k.buffer),D=0;D<W;D++){var V=g5(X,D,O),Z=DQ(P[V],4)[3];ue[D]=Z}}else ne===0&&(ce=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:z?8:void 0,colorBytes:k,alphaBytes:ue,needSMask:z,palette:oe,mask:ce}}(s):c===2||c===4?function(S){for(var E=S.data,B=S.width,k=S.height,P=S.channels,O=S.depth,z=P===2?"DeviceGray":"DeviceRGB",oe=P-1,ce=B*k,ue=oe,ge=ce*ue,ne=1*ce,Oe=Math.ceil(ge*O/8),Ue=Math.ceil(ne*O/8),F=new Uint8Array(Oe),H=new Uint8Array(Ue),K=new DataView(E.buffer),U=new DataView(F.buffer),W=new DataView(H.buffer),X=!1,D=0;D<ce;D++){for(var V=D*P,Z=0;Z<ue;Z++)QV(U,g5(K,V+Z,O),D*ue+Z,O);var be=g5(K,V+ue,O);be<(1<<O)-1&&(X=!0),QV(W,be,1*D,O)}return{colorSpace:z,colorsPerPixel:oe,sMaskBitsPerComponent:X?O:void 0,colorBytes:F,alphaBytes:H,needSMask:X}}(s):function(S){var E=S.data,B=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(k){for(var P=k.length,O=new Uint8Array(2*P),z=new DataView(O.buffer,O.byteOffset,O.byteLength),oe=0;oe<P;oe++)z.setUint16(2*oe,k[oe],!1);return O}(E):E,needSMask:!1}}(s);var f,A,h,m=a,p=m.colorSpace,x=m.colorsPerPixel,v=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,w=m.needSMask,j=m.palette,I=m.mask,_=null;return n!==an.API.image_compression.NONE&&typeof Rk=="function"?(_=function(S){var E;switch(S){case an.API.image_compression.FAST:E=11;break;case an.API.image_compression.MEDIUM:E=13;break;case an.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),f=this.decode.FLATE_DECODE,A="/Predictor ".concat(_," /Colors ").concat(x," /BitsPerComponent ").concat(d," /Columns ").concat(o),t=DV(y,Math.ceil(o*x*d/8),x,d,n),w&&(h=DV(b,Math.ceil(o*v/8),1,v,n))):(f=void 0,A=void 0,t=y,w&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:f,decodeParameters:A,transparency:I,palette:j,sMask:h,predictor:_,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:v,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,a){var s=new aPe(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new x5(100).encode(u,100);return t.processJPEG.call(this,d,r,n,a)},t.processGIF87A=t.processGIF89A}(an.API),Wd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wd.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){hs.log("bit decode error:"+r)}},Wd.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Wd.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Wd.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Wd.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=t}},Wd.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},Wd.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Wd.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Wd.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,a){var s=new Wd(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new x5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(an.API),HV.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,a){var s=new HV(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new x5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(an.API),an.API.processRGBA=function(t,e,r){for(var n=t.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],A=n[u+2],h=n[u+3];s[l++]=d,s[l++]=f,s[l++]=A,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},an.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},dx=an.API,RC=dx.getCharWidthsArray=function(t,e){var r,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=e.doKerning!==!1,A=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof a.metadata.widthOfString=="function"?x.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(A=f&&es(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,x.push((l[n]||p)/c+A)),m=n;return x},kV=dx.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return dx.processArabic&&(t=dx.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,a)/r:RC.apply(this,arguments).reduce(function(s,o){return s+o},0)},FV=function(t,e,r,n){for(var a=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<r;)l+=e[s],s++;a.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>n&&(a.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&a.push(t.slice(c,s)),a},OV=function(t,e,r){r||(r={});var n,a,s,o,l,c,u,d=[],f=[d],A=r.textIndent||0,h=0,m=0,p=t.split(" "),x=RC.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),y=[];p.map(function(w){(w=w.split(/\s*\n/)).length>1?y=y.concat(w.map(function(j,I){return(I&&j.length?`
`:"")+j})):y.push(w[0])}),p=y,c=kV.apply(this,[v,r])}for(s=0,o=p.length;s<o;s++){var b=0;if(n=p[s],c&&n[0]==`
`&&(n=n.substr(1),b=1),A+h+(m=(a=RC.apply(this,[n,r])).reduce(function(w,j){return w+j},0))>e||b){if(m>e){for(l=FV.apply(this,[n,a,e-(A+h),e]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(w,j){return w+j},0)}else d=[n];f.push(d),A=m+c,h=x}else d.push(n),A+=h+m,h=x}return u=c?function(w,j){return(j?v:"")+w.join(" ")}:function(w){return w.join(" ")},f.map(u)},dx.splitTextToSize=function(t,e,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),A="Unicode";return f.metadata[A]?{widths:f.metadata[A].widths||{0:1},kerning:f.metadata[A].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(OV.apply(this,[n[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=e[s],a[e[s]]=r[s];var o=function(A){return"0x"+parseInt(A,10).toString(16)},l=t.__fontmetrics__.compress=function(A){var h,m,p,x,v=["{"];for(var y in A){if(h=A[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+a[p.slice(-1)];else{if(es(h)!=="object")throw new Error("Don't know what to do with value type "+es(h)+".");p=l(h)}v.push(m+p)}return v.push("}"),v.join("")},c=t.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,v={},y=1,b=v,w=[],j="",I="",_=A.length-1,S=1;S<_;S+=1)(x=A[S])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(w.push([b,p]),b={},p=void 0):x=="}"?((m=w.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?y=-1:p===void 0?n.hasOwnProperty(x)?(j+=n[x],p=parseInt(j,16)*y,y=1,j=""):j+=x:n.hasOwnProperty(x)?(I+=n[x],b[p]=parseInt(I,16)*y,y=1,p=void 0,I=""):I+=x;return v},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(A){var h=A.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(an.API),function(t){var e=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};t.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(pE(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(an),an.API.addSvgAsImage=function(t,e,r,n,a,s,o,l){if(isNaN(e)||isNaN(r))throw hs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw hs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Mn.canvg?Promise.resolve(Mn.canvg):iA(()=>import("./index.es-6PS6g2_m.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(u,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),e,r,n,a,o,l)})},an.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,r);return this},an.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function A(m,p){var x,v=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(es(t)==="object"){for(a in t)if(s=t[a],A(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&A(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(an.API),function(t){var e=t.API,r=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,A=s.length;f<A;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,A;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,A=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<A;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,A=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<A.length;m++)h+=String.fromCharCode(A[m]);var p=u();d({data:h,addLength1:!0,objectId:p}),c("endobj");var x=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Tx(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Tx(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+Tx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,A="",h=0;h<f.length;h++)A+=String.fromCharCode(f[h]);var m=u();d({data:A,addLength1:!0,objectId:m}),c("endobj");var p=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Tx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Tx(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},A=f.pdfEscape,h=f.activeFontKey,m=f.fonts,p=h,x="",v=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),v=0;v<y.length;v+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[v].charCodeAt(0)]),o||y[v].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=y[v]:x+="";var w="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?w=A(x,p).split("").map(function(j){return j.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(w=r(x,m[p])),f.isHex=!0,{text:w,x:c,y:u,options:d,mutex:f}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(an),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(an.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,d,f=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var w=function(k){var P=k.charCodeAt(),O=P>>8,z=p[O];return z!==void 0?f[256*z+(255&P)]:O===252||O===253?"AL":v.test(O)?"L":O===8?"R":"N"},j=function(k){for(var P,O=0;O<k.length;O++){if((P=w(k.charAt(O)))==="L")return!1;if(P==="R")return!0}return!1},I=function(k,P,O,z){var oe,ce,ue,ge,ne=P[z];switch(ne){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(ne="AN");break;case"AL":y=!0,ne="R";break;case"WS":case"BN":ne="N";break;case"CS":z<1||z+1>=P.length||(oe=O[z-1])!=="EN"&&oe!=="AN"||(ce=P[z+1])!=="EN"&&ce!=="AN"?ne="N":y&&(ce="AN"),ne=ce===oe?ce:"N";break;case"ES":ne=(oe=z>0?O[z-1]:"B")==="EN"&&z+1<P.length&&P[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&O[z-1]==="EN"){ne="EN";break}if(y){ne="N";break}for(ue=z+1,ge=P.length;ue<ge&&P[ue]==="ET";)ue++;ne=ue<ge&&P[ue]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(ge=P.length,ue=z+1;ue<ge&&P[ue]==="NSM";)ue++;if(ue<ge){var Oe=k[z],Ue=Oe>=1425&&Oe<=2303||Oe===64286;if(oe=P[ue],Ue&&(oe==="R"||oe==="AL")){ne="R";break}}}ne=z<1||(oe=P[z-1])==="B"?"N":O[z-1];break;case"B":y=!1,a=!0,ne=b;break;case"S":s=!0,ne="N"}return ne},_=function(k,P,O){var z=k.split("");return O&&S(z,O,{hiLevel:b}),z.reverse(),P&&P.reverse(),z.join("")},S=function(k,P,O){var z,oe,ce,ue,ge,ne=-1,Oe=k.length,Ue=0,F=[],H=b?h:A,K=[];for(y=!1,a=!1,s=!1,oe=0;oe<Oe;oe++)K[oe]=w(k[oe]);for(ce=0;ce<Oe;ce++){if(ge=Ue,F[ce]=I(k,K,F,ce),z=240&(Ue=H[ge][m[F[ce]]]),Ue&=15,P[ce]=ue=H[Ue][5],z>0)if(z===16){for(oe=ne;oe<ce;oe++)P[oe]=1;ne=-1}else ne=-1;if(H[Ue][6])ne===-1&&(ne=ce);else if(ne>-1){for(oe=ne;oe<ce;oe++)P[oe]=ue;ne=-1}K[ce]==="B"&&(P[ce]=0),O.hiLevel|=ue}s&&function(U,W,X){for(var D=0;D<X;D++)if(U[D]==="S"){W[D]=b;for(var V=D-1;V>=0&&U[V]==="WS";V--)W[V]=b}}(K,P,Oe)},E=function(k,P,O,z,oe){if(!(oe.hiLevel<k)){if(k===1&&b===1&&!a)return P.reverse(),void(O&&O.reverse());for(var ce,ue,ge,ne,Oe=P.length,Ue=0;Ue<Oe;){if(z[Ue]>=k){for(ge=Ue+1;ge<Oe&&z[ge]>=k;)ge++;for(ne=Ue,ue=ge-1;ne<ue;ne++,ue--)ce=P[ne],P[ne]=P[ue],P[ue]=ce,O&&(ce=O[ne],O[ne]=O[ue],O[ue]=ce);Ue=ge}Ue++}}},B=function(k,P,O){var z=k.split(""),oe={hiLevel:b};return O||(O=[]),S(z,O,oe),function(ce,ue,ge){if(ge.hiLevel!==0&&d)for(var ne,Oe=0;Oe<ce.length;Oe++)ue[Oe]===1&&(ne=x.indexOf(ce[Oe]))>=0&&(ce[Oe]=x[ne+1])}(z,O,oe),E(2,z,P,O,oe),E(1,z,P,O,oe),z.join("")};return this.__bidiEngine__.doBidiReorder=function(k,P,O){if(function(oe,ce){if(ce)for(var ue=0;ue<oe.length;ue++)ce[ue]=ue;l===void 0&&(l=j(oe)),u===void 0&&(u=j(oe))}(k,P),o||!c||u)if(o&&c&&l^u)b=l?1:0,k=_(k,P,O);else if(!o&&c&&u)b=l?1:0,k=B(k,P,O),k=_(k,P);else if(!o||l||c||u){if(o&&!c&&l^u)k=_(k,P),l?(b=0,k=B(k,P,O)):(b=1,k=B(k,P,O),k=_(k,P));else if(o&&l&&!c&&u)b=1,k=B(k,P,O),k=_(k,P);else if(!o&&!c&&l^u){var z=d;l?(b=1,k=B(k,P,O),b=0,d=!1,k=B(k,P,O),d=z):(b=0,k=B(k,P,O),k=_(k,P),b=1,d=!1,k=B(k,P,O),d=z,k=_(k,P))}}else b=0,k=B(k,P,O);else b=l?1:0,k=B(k,P,O);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,u=k.isOutputRtl,d=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(an),an.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Em(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new vPe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new sPe(this.contents),this.head=new oPe(this),this.name=new fPe(this),this.cmap=new Lre(this),this.toUnicode={},this.hhea=new lPe(this),this.maxp=new hPe(this),this.hmtx=new APe(this),this.post=new uPe(this),this.os2=new cPe(this),this.loca=new xPe(this),this.glyf=new mPe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var a,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var jf,Em=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,a;for(a=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(e.charCodeAt(r)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,a,s,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)r=e[n],s.push(this.writeByte(r));return s},t}(),sPe=function(){var t;function e(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,a,s,o,l,c,u,d,f,A,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),d=16*h-f,(a=new Em).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(d),s=16*h,u=a.pos+s,l=null,m=[],r)for(A=r[p],a.writeString(p),a.writeInt(t(A)),a.writeInt(u),a.writeInt(A.length),m=m.concat(A),p==="head"&&(l=u),u+=A.length;u%4;)m.push(0),u++;return a.write(m),n=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(n),a.data},t=function(r){var n,a,s,o;for(r=Ure.call(r);r.length%4;)r.push(0);for(s=new Em(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),iPe={}.hasOwnProperty,ph=function(t,e){for(var r in e)iPe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};jf=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var oPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Em).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),$V=function(){function t(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),A=h/2,e.pos+=6,s=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),e.pos+=2,p=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),u=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),d=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),a=(this.length-e.pos+this.offset)/2,l=function(){var w,j;for(j=[],c=w=0;0<=a?w<a:w>a;c=0<=a?++w:--w)j.push(e.readUInt16());return j}(),c=v=0,b=s.length;v<b;c=++v)for(x=s[c],n=y=m=p[c];m<=x?y<=x:y>=x;n=m<=x?++y:--y)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(A-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=f}return t.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,_,S,E,B,k,P,O,z,oe,ce,ue,ge,ne,Oe,Ue,F,H,K,U,W,X,D,V,Z,be,L;switch(z=new Em,o=Object.keys(e).sort(function(Xe,re){return Xe-re}),r){case"macroman":for(p=0,x=function(){var Xe=[];for(m=0;m<256;++m)Xe.push(0);return Xe}(),y={0:0},s={},oe=0,ne=o.length;oe<ne;oe++)y[V=e[a=o[oe]]]==null&&(y[V]=++p),s[a]={old:e[a],new:y[e[a]]},x[a]=y[e[a]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(x),{charMap:s,subtable:z.data,maxGlyphID:p+1};case"unicode":for(P=[],f=[],b=0,y={},n={},v=u=null,ce=0,Oe=o.length;ce<Oe;ce++)y[j=e[a=o[ce]]]==null&&(y[j]=++b),n[a]={old:j,new:y[j]},l=y[j]-a,v!=null&&l===u||(v&&f.push(v),P.push(a),u=l),v=a;for(v&&f.push(v),f.push(65535),P.push(65535),B=2*(E=P.length),S=2*Math.pow(Math.log(E)/Math.LN2,2),A=Math.log(S/2)/Math.LN2,_=2*E-S,c=[],I=[],h=[],m=ue=0,Ue=P.length;ue<Ue;m=++ue){if(k=P[m],d=f[m],k===65535){c.push(0),I.push(0);break}if(k-(O=n[k].new)>=32768)for(c.push(0),I.push(2*(h.length+E-m)),a=ge=k;k<=d?ge<=d:ge>=d;a=k<=d?++ge:--ge)h.push(n[a].new);else c.push(O-k),I.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*E+2*h.length),z.writeUInt16(0),z.writeUInt16(B),z.writeUInt16(S),z.writeUInt16(A),z.writeUInt16(_),X=0,F=f.length;X<F;X++)a=f[X],z.writeUInt16(a);for(z.writeUInt16(0),D=0,H=P.length;D<H;D++)a=P[D],z.writeUInt16(a);for(Z=0,K=c.length;Z<K;Z++)l=c[Z],z.writeUInt16(l);for(be=0,U=I.length;be<U;be++)w=I[be],z.writeUInt16(w);for(L=0,W=h.length;L<W;L++)p=h[L],z.writeUInt16(p);return{charMap:n,subtable:z.data,maxGlyphID:b+1}}},t}(),Lre=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new $V(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,a;return r==null&&(r="macroman"),n=$V.encode(e,r),(a=new Em).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},t}(),lPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),cPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),uPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)r=e.readByte(),a.push(this.names.push(e.readString(r)));return a;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),dPe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},fPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,a,s,o,l,c,u,d,f,A;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)a=n[s],e.pos=a.offset,u=e.readString(a.length),o=new dPe(u,a),c[A=a.nameID]==null&&(c[A]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),hPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),APe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,a,s,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)d.push(e.readInt16());return d}(),this.widths=(function(){var u,d,f,A;for(A=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],A.push(s.advance);return A}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),Ure=[].slice,mPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,a,s,o,l,c,u,d,f;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(e),(a=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new Em(r.read(a))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[e]=o===-1?new gPe(l,u,f,c,d):new pPe(l,o,u,f,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=e[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},t}(),pPe=function(){function t(e,r,n,a,s,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),gPe=function(){function t(e,r,n,a,s){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Em(Ure.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),xPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},t}(),vPe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[r],e[r]=a[n];return e},t.prototype.glyphsFor=function(e){var r,n,a,s,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[s=e[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},t.prototype.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v;for(a in n=Lre.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},v=n.charMap)h[(c=v[a]).old]=c.new;for(m in A=n.maxGlyphID,o)m in h||(h[m]=A++);return d=function(y){var b,w;for(b in w={},y)w[y[b]]=b;return w}(h),f=Object.keys(d).sort(function(y,b){return y-b}),p=function(){var y,b,w;for(w=[],y=0,b=f.length;y<b;y++)l=f[y],w.push(d[l]);return w}(),s=this.font.glyf.encode(o,p,h),u=this.font.loca.encode(s.offsets,p),x={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();an.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+r},e}();const Kk=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:Xje,AcroFormAppearance:un,AcroFormButton:Co,AcroFormCheckBox:Ib,AcroFormChoiceField:Dp,AcroFormComboBox:Mp,AcroFormEditBox:Eb,AcroFormListBox:Rp,AcroFormPasswordField:jb,AcroFormPushButton:Sb,AcroFormRadioButton:Lp,AcroFormTextField:fm,GState:I2,ShadingPattern:L0,TilingPattern:_p,default:an,jsPDF:an},Symbol.toStringTag,{value:"Module"}));async function KV(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:xr.now()};return Zn(bt(Pe,"inventory_batches"),e)}async function Qre(t,e){await Fn(er(Pe,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:xr.now()})}async function yPe(t,e){const r=sr(bt(Pe,"batch_allocations"),Ar("saleDate",">=",t),Ar("saleDate","<=",e)),n=await $t(r),a={};return n.forEach(s=>{const o=s.data(),l=o.batchId;a[l]||(a[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),a[l].quantity+=Number(o.quantity||0),a[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(a)}async function Vre(t){const e=er(Pe,"salesV2",t),r=await zs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const u=String((c==null?void 0:c.batchId)||"").trim(),d=Number((c==null?void 0:c.qty)||0);u&&d&&a.push({batchId:u,qty:d})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),u=Number((l==null?void 0:l.qty)||0);c&&u&&a.push({batchId:c,qty:u})}if(a.length===0)return await Ks(Pe,async l=>{l.delete(e)}),{restored:0};const s=new Map;for(const l of a)s.set(l.batchId,Number((s.get(l.batchId)||0)+l.qty));let o=0;return await Ks(Pe,async l=>{const c=Array.from(s.entries()),u=c.map(([f])=>er(Pe,"inventory_batches",f)),d=await Promise.all(u.map(f=>l.get(f)));c.forEach(([f,A],h)=>{const m=d[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),v=Number((x+Number(A||0)).toFixed(3));l.update(u[h],{remaining:v}),o+=Number(A||0)}),l.delete(e)}),{restored:o}}var Hre={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},GV=Ni.createContext&&Ni.createContext(Hre),bPe=["attr","size","title"];function wPe(t,e){if(t==null)return{};var r=NPe(t,e),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)n=s[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function NPe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function OS(){return OS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},OS.apply(this,arguments)}function qV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function DS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qV(Object(r),!0).forEach(function(n){CPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CPe(t,e,r){return e=_Pe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Pe(t){var e=EPe(t,"string");return typeof e=="symbol"?e:e+""}function EPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $re(t){return t&&t.map((e,r)=>Ni.createElement(e.tag,DS({key:r},e.attr),$re(e.child)))}function SPe(t){return e=>Ni.createElement(IPe,OS({attr:DS({},t.attr)},e),$re(t.child))}function IPe(t){var e=r=>{var{attr:n,size:a,title:s}=t,o=wPe(t,bPe),l=a||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),Ni.createElement("svg",OS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:DS(DS({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&Ni.createElement("title",null,s),t.children)};return GV!==void 0?Ni.createElement(GV.Consumer,null,r=>e(r)):e(Hre)}function jPe(t){return SPe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Oc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(jPe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}function Dc(){const[t,e]=g.useState(0),r=g.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const Al=t=>Math.round((Number(t)||0)*100)/100,jh=t=>Math.round((Number(t)||0)*1e3)/1e3,ed=t=>Number(t??0).toFixed(2),Ph=t=>Number(t??0).toFixed(3),zV=(t,e)=>{var o;const r=t.date?String(t.date):"",n=(o=t.timestamp)!=null&&o.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"";let a=r||n;if(r&&n){const l=new Date(r+"T00:00:00").getTime(),c=new Date(n+"T00:00:00").getTime(),u=Math.abs(l-c)/(1e3*60*60*24);isFinite(u)&&u>30&&(a=n)}if(!a)return[];const s=t.type??"CONTADO";return Array.isArray(t.items)&&t.items.length>0?t.items.map((l,c)=>{const u=Number((l==null?void 0:l.qty)??0),d=Number((l==null?void 0:l.lineFinal)??0)||Math.max(0,Number((l==null?void 0:l.unitPrice)||0)*u-Number((l==null?void 0:l.discount)||0));return{id:`${e}#${c}`,productName:String((l==null?void 0:l.productName)??"(sin nombre)"),quantity:u,amount:Al(d),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String((l==null?void 0:l.measurement)??t.measurement??""),allocations:Array.isArray(l==null?void 0:l.allocations)?l.allocations:t.allocations,avgUnitCost:Number((l==null?void 0:l.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((l==null?void 0:l.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String(t.measurement??""),allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]};function PPe({role:t,roles:e}){const[r,n]=g.useState([]),[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),[m,p]=g.useState("ALL"),[x,v]=g.useState({}),[y,b]=g.useState(null),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState(""),[B,k]=g.useState(0),[P,O]=g.useState("0"),z=Ur(new Date,"yyyy-MM-dd"),[oe,ce]=g.useState(z),[ue,ge]=g.useState(z),[ne,Oe]=g.useState(!1),[Ue,F]=g.useState(!1),[H,K]=g.useState(!1),[U,W]=g.useState(""),X=g.useRef(null),{refreshKey:D,refresh:V}=Dc(),Z=e&&e.length?e:t,be=rbe(Z,"bills","cerrarVentas"),L=Sn(Z,"admin"),Xe=({title:xe,open:Se,onToggle:xt,right:Pt})=>i.jsxs("button",{type:"button",onClick:xt,className:"w-full flex items-center justify-between gap-3 px-4 py-3 rounded-xl border bg-gray-50 hover:bg-gray-100 active:bg-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.jsx("span",{className:"font-semibold truncate",children:xe}),Pt?i.jsx("span",{className:"text-xs text-gray-600",children:Pt}):null]}),i.jsx("div",{className:"shrink-0 text-lg font-bold leading-none",children:Se?"":"+"})]});g.useEffect(()=>{if(!oe||!ue)return;u(!0);const xe=sr(bt(Pe,"salesV2"),Ar("date",">=",oe),Ar("date","<=",ue)),Se=jd(xe,xt=>{const Pt=[];xt.forEach(It=>{const Ut=zV(It.data(),It.id);Pt.push(...Ut)}),n(Pt),u(!1)},xt=>{console.error("Error cargando ventas por periodo:",xt),n([]),u(!1)});return()=>Se()},[oe,ue,D]),g.useEffect(()=>{if(!oe||!ue)return;const xe=sr(bt(Pe,"salesV2"),Ar("status","==","FLOTANTE"),Ar("date",">=",oe),Ar("date","<=",ue)),Se=jd(xe,xt=>{const Pt=[];xt.forEach(It=>{const Ut=zV(It.data(),It.id);Pt.push(...Ut)}),s(Pt)});return()=>Se()},[oe,ue,D]),g.useEffect(()=>{(async()=>{try{const xe=await $t(bt(Pe,"users")),Se={};xe.forEach(xt=>{const Pt=xt.data(),It=String(Pt.email||"").trim().toLowerCase(),Ut=String(Pt.name||"").trim();It&&(Se[It]=Ut||Pt.email||"")}),v(Se)}catch(xe){console.error("Error cargando usuarios:",xe),v({})}})()},[]);const re=xe=>{const Se=String(xe||"").trim().toLowerCase();return x[Se]||xe||""};g.useEffect(()=>{(async()=>{const Se=sr(bt(Pe,"daily_closures"),Ar("date","==",z)),xt=await $t(Se);if(xt.empty)l(null);else{const Pt=xt.docs[0];l({id:Pt.id,...Pt.data()})}})()},[z,D]);const J=Ni.useMemo(()=>{let xe=[];if(A==="FLOTANTE"){const xt=[...r,...a],Pt=new Map;for(const It of xt)It.status==="FLOTANTE"&&Pt.set(It.id,It);xe=Array.from(Pt.values())}else if(A==="ALL"){const xt=[...r,...a],Pt=new Map;for(const It of xt)Pt.set(It.id,It);xe=Array.from(Pt.values())}else xe=r.filter(xt=>xt.status==="PROCESADA");m!=="ALL"&&(xe=xe.filter(xt=>xt.type===m));const Se=U.trim().toLowerCase();if(Se){const xt=It=>String(It||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Pt=xt(Se);xe=xe.filter(It=>xt(It.productName).includes(Pt))}return xe},[A,r,a,U,m]),De=Al(J.reduce((xe,Se)=>xe+(Se.amount||0),0)),ie=Al(J.reduce((xe,Se)=>xe+Number(Se.cogsAmount??0),0)),He=xe=>String(xe||"").trim().toLowerCase()!=="lb",Ge=J.filter(xe=>xe.type==="CONTADO"),dt=J.filter(xe=>xe.type==="CREDITO"),_t=jh(Ge.filter(xe=>He(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),Bt=jh(Ge.filter(xe=>!He(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),Ot=jh(dt.filter(xe=>He(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),jt=jh(dt.filter(xe=>!He(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),Qt=Al(Ge.reduce((xe,Se)=>xe+(Se.amount||0),0)),Ft=Al(dt.reduce((xe,Se)=>xe+(Se.amount||0),0)),$e=Al(Ge.reduce((xe,Se)=>xe+Number(Se.cogsAmount??0),0)),Fe=Al(dt.reduce((xe,Se)=>xe+Number(Se.cogsAmount??0),0)),Ze=Al(Qt-$e),Te=Al(Ft-Fe),ee=jh(_t+Ot),me=jh(Bt+jt),Re=Al(Qt+Ft),he={};J.forEach(xe=>{const Se=xe.productName||"(sin nombre)";he[Se]||(he[Se]={totalQuantity:0,totalAmount:0}),he[Se].totalQuantity=jh(he[Se].totalQuantity+(xe.quantity||0)),he[Se].totalAmount=Al(he[Se].totalAmount+(xe.amount||0))});const qe=Object.entries(he).map(([xe,Se])=>({productName:xe,totalQuantity:Se.totalQuantity,totalAmount:Se.totalAmount})),st=async()=>{try{const xe=J.filter(Le=>Le.status==="FLOTANTE"),Se=xe.length>0?xe:r.filter(Le=>Le.status!=="PROCESADA");if(Se.length===0){f("No hay ventas para procesar.");return}const xt={totalCharged:Al(Se.reduce((Le,Ce)=>Le+(Ce.amount||0),0)),totalSuggested:Al(Se.reduce((Le,Ce)=>Le+(Ce.amountSuggested||0),0)),totalUnits:jh(Se.reduce((Le,Ce)=>Le+(Ce.quantity||0),0)),totalCOGS:Al(Se.reduce((Le,Ce)=>Le+Number(Ce.cogsAmount??0),0))},Pt=Al(xt.totalCharged-xt.totalSuggested),It=Al(xt.totalCharged-xt.totalCOGS),Ut=await Zn(bt(Pe,"daily_closures"),{date:z,createdAt:xr.now(),periodStart:oe,periodEnd:ue,totalCharged:xt.totalCharged,totalSuggested:xt.totalSuggested,totalDifference:Pt,totalUnits:xt.totalUnits,totalCOGS:xt.totalCOGS,grossProfit:It,products:Se.map(Le=>({productName:Le.productName,quantity:Le.quantity,amount:Le.amount})),salesV2:Se.map(Le=>({id:Le.id,productName:Le.productName,quantity:Le.quantity,amount:Le.amount,amountSuggested:Le.amountSuggested,userEmail:Le.userEmail,clientName:Le.clientName,amountReceived:Le.amountReceived,change:Le.change,status:Le.status,cogsAmount:Le.cogsAmount??0,avgUnitCost:Le.avgUnitCost??null,allocations:Le.allocations??[],date:Le.date})),productSummary:Object.entries(Se.reduce((Le,Ce)=>{const Ae=Ce.productName||"(sin nombre)";return Le[Ae]||(Le[Ae]={totalQuantity:0,totalAmount:0}),Le[Ae].totalQuantity=jh(Le[Ae].totalQuantity+(Ce.quantity||0)),Le[Ae].totalAmount=Al(Le[Ae].totalAmount+(Ce.amount||0)),Le},{})).map(([Le,Ce])=>({productName:Le,totalQuantity:Ce.totalQuantity,totalAmount:Ce.totalAmount}))}),Ht=tu(Pe);Se.forEach(Le=>{Ht.update(er(Pe,"salesV2",Le.id.split("#")[0]),{status:"PROCESADA",closureId:Ut.id,closureDate:z,date:Le.date})}),await Ht.commit(),f(` Cierre guardado. Ventas procesadas: ${Se.length}.`)}catch(xe){console.error(xe),f(" Error al guardar el cierre.")}},yt=async xe=>{if(!L){f(" No tienes permisos para revertir esta venta.");return}if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Fn(er(Pe,"salesV2",xe.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),f(" Venta revertida a FLOTANTE.")}catch(Se){console.error(Se),f(" No se pudo revertir la venta.")}},pe=xe=>{if(!L){f(" No tienes permisos para editar esta venta.");return}b(xe),j(xe.quantity),_(xe.amount),E(xe.clientName),k(xe.amountReceived),O(xe.change)},je=async()=>{if(!L){f(" No tienes permisos para guardar cambios.");return}if(y)try{await Fn(er(Pe,"salesV2",y.id.split("#")[0]),{quantity:w,amount:I,amountCharged:I,clientName:S,amountReceived:B,change:P}),b(null),f(" Venta actualizada.")}catch(xe){console.error(xe),f(" No se pudo actualizar la venta.")}},we=async xe=>{if(!L){f(" No tienes permisos para eliminar esta venta.");return}if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:Se}=await Vre(xe.split("#")[0]);f(` Venta eliminada. Stock restaurado: ${Number(Se).toFixed(2)}.`)}catch(Se){console.error(Se),f(" No se pudo eliminar la venta.")}},Ye=async()=>{if(X.current){X.current.classList.add("force-pdf-colors"),X.current.classList.add("pdf-print-mode");try{const Se=(await Fg(X.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),xt=new an;xt.addImage(Se,"PNG",10,10,190,0),xt.save(`cierre_${z}.pdf`)}finally{X.current.classList.remove("pdf-print-mode"),X.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[i.jsxs("h2",{className:"text-2xl font-bold",children:["Cierre de Ventas - ",oe,"  ",ue]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(Oc,{onClick:V})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx(Xe,{title:"Filtros",open:ne,onToggle:()=>Oe(xe=>!xe),right:i.jsxs("span",{className:"ml-1",children:[oe,"  ",ue,A!=="ALL"?`  ${A}`:"",m!=="ALL"?`  ${m==="CREDITO"?"Crdito":"Cash"}`:"",U.trim()?`  "${U.trim()}"`:""]})}),ne&&i.jsx("div",{className:"mt-3 border rounded-xl p-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Periodo desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:oe,onChange:xe=>ce(xe.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:ue,onChange:xe=>ge(xe.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:A,onChange:xe=>h(xe.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Tipo Operacin"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:m,onChange:xe=>p(xe.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),i.jsx("option",{value:"CREDITO",children:"Crdito"}),i.jsx("option",{value:"CONTADO",children:"Cash"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-2 w-full",placeholder:"Buscar por producto...",value:U,onChange:xe=>W(xe.target.value)})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:X,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[J.map(xe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${xe.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})}),i.jsx("td",{className:"border p-1",children:xe.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:xe.productName}),i.jsx("td",{className:"border p-1",children:Ph(xe.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ed(xe.amount)]}),i.jsx("td",{className:"border p-1",children:xe.date}),i.jsx("td",{className:"border p-1",children:re(xe.userEmail)}),i.jsx("td",{className:"border p-1",children:xe.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:L?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>pe(xe),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>we(xe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):xe.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:L?i.jsx("button",{onClick:()=>yt(xe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},xe.id)),J.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden mb-4",children:[i.jsx(Xe,{title:"Ventas",open:Ue,onToggle:()=>F(xe=>!xe),right:i.jsxs("span",{className:"ml-1",children:[J.length,"  C$",ed(De)]})}),Ue&&i.jsxs("div",{className:"mt-3 space-y-3",children:[J.map(xe=>i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:xe.productName}),i.jsx("div",{className:"text-xs text-gray-500",children:xe.date})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",ed(xe.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${xe.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cantidad"}),i.jsx("strong",{children:Ph(xe.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("strong",{children:xe.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:re(xe.userEmail)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("strong",{className:"text-right break-all",children:xe.clientName||""})]}),i.jsx("div",{className:"pt-2",children:xe.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:L?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>pe(xe),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>we(xe.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):xe.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:L?i.jsx("button",{onClick:()=>yt(xe.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},xe.id)),J.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Total libras Cash: ",i.jsx("strong",{children:Ph(Bt)})]}),i.jsxs("div",{children:["Total Unidades cash: ",i.jsx("strong",{children:Ph(_t)})]}),i.jsxs("div",{children:["Total libras credito: ",i.jsx("strong",{children:Ph(jt)})]}),i.jsxs("div",{children:["Total Unidades credito: ",i.jsx("strong",{children:Ph(Ot)})]}),i.jsxs("div",{children:["Total facturado Cash: ",i.jsxs("strong",{children:["C$",ed($e)]})]}),i.jsxs("div",{children:["Total facturado credito:"," ",i.jsxs("strong",{children:["C$",ed(Fe)]})]}),i.jsxs("div",{children:["Total venta Cash: ",i.jsxs("strong",{children:["C$",ed(Qt)]})]}),i.jsxs("div",{children:["Total venta Credito: ",i.jsxs("strong",{children:["C$",ed(Ft)]})]}),i.jsxs("div",{children:["Utilidad bruta Cash: ",i.jsxs("strong",{children:["C$",ed(Ze)]})]}),i.jsxs("div",{children:["Utilidad bruta credito:"," ",i.jsxs("strong",{children:["C$",ed(Te)]})]}),i.jsxs("div",{children:["Total libras cash y credito: ",i.jsx("strong",{children:Ph(me)})]}),i.jsxs("div",{children:["Total unidades cash y credito:"," ",i.jsx("strong",{children:Ph(ee)})]}),i.jsxs("div",{children:["Total ventas Cash y credito:"," ",i.jsxs("strong",{children:["C$",ed(Re)]})]}),i.jsxs("div",{children:["Total facturado a precio compra:"," ",i.jsxs("strong",{children:["C$",ed(ie)]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx(Xe,{title:"Consolidado por producto",open:H,onToggle:()=>K(xe=>!xe),right:i.jsx("span",{className:"ml-1",children:qe.length})}),H&&i.jsx("div",{className:"mt-3",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[qe.map(xe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:xe.productName}),i.jsx("td",{className:"border p-1",children:Ph(xe.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ed(xe.totalAmount)]})]},xe.productName)),qe.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[i.jsx("button",{disabled:!be,onClick:st,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:Ye,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),y&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[y.productName,"  ",re(y.userEmail)]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:w,onChange:xe=>j(parseFloat(xe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:I,onChange:xe=>_(parseFloat(xe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:S,onChange:xe=>E(xe.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:xe=>k(parseFloat(xe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:P,onChange:xe=>O(xe.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>b(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:je,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const td=t=>Number(t??0).toFixed(2),fx=t=>Number(t??0).toFixed(3);function BPe(){var y,b,w,j;const t=async I=>{if(!window.confirm(`Eliminar el cierre del ${I.date}?`))return;const _=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(_){const S=await $t(sr(bt(Pe,"salesV2"),Ar("closureId","==",I.id)));if(!S.empty){const E=tu(Pe);S.forEach(B=>{E.update(er(Pe,"salesV2",B.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await E.commit()}}await qn(er(Pe,"daily_closures",I.id)),(u==null?void 0:u.id)===I.id&&d(null),await m(),A(` Cierre eliminado${_?" y ventas reabiertas.":"."}`)}catch(S){console.error(S),A(" No se pudo eliminar el cierre.")}},[e,r]=g.useState(Ur(Gee(new Date),"yyyy-MM-dd")),[n,a]=g.useState(Ur(new Date,"yyyy-MM-dd")),[s,o]=g.useState(!0),[l,c]=g.useState([]),[u,d]=g.useState(null),[f,A]=g.useState(""),h=g.useRef(null),m=async()=>{try{o(!0);const I=sr(bt(Pe,"daily_closures"),Ar("date",">=",e),Ar("date","<=",n)),_=await $t(I),S=[];_.forEach(E=>S.push({id:E.id,...E.data()})),S.sort((E,B)=>E.date<B.date?1:E.date>B.date?-1:0),c(S)}catch(I){console.error(I),A(" Error cargando el historial.")}finally{o(!1)}};g.useEffect(()=>{m()},[]);const p=async I=>{I.preventDefault(),m()},x=g.useMemo(()=>{if(!u)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const I=Number(u.totalUnits??0),_=Number(u.totalSuggested??0),S=Number(u.totalCharged??0),E=Number(u.totalDifference??(isFinite(S-_)?S-_:0)),B=Number(u.totalCOGS??0),k=Number(u.grossProfit??(isFinite(S-B)?S-B:0));return{units:I,sug:_,chg:S,diff:E,cogs:B,profit:k}},[u]),v=async()=>{if(!h.current||!u)return;const I=h.current;I.classList.add("force-pdf-colors");try{const[{default:_},{jsPDF:S}]=await Promise.all([iA(()=>Promise.resolve().then(()=>V6),void 0),iA(()=>Promise.resolve().then(()=>Kk),void 0)]),B=(await _(I,{backgroundColor:"#ffffff",onclone:O=>{const z=O.defaultView;O.body.querySelectorAll("*").forEach(ce=>{const ue=z.getComputedStyle(ce);ue.color&&(ce.style.color=ue.color),ue.backgroundColor&&ue.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ce.style.backgroundColor=ue.backgroundColor),ue.borderColor&&(ce.style.borderColor=ue.borderColor)})}})).toDataURL("image/png"),{jsPDF:k}=await iA(async()=>{const{jsPDF:O}=await Promise.resolve().then(()=>Kk);return{jsPDF:O}},void 0),P=new k;P.addImage(B,"PNG",10,10,190,0),P.save(`cierre_${u.date}.pdf`)}finally{I.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:I=>r(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:I=>a(I.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),s?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.date}),i.jsx("td",{className:"border p-1",children:fx(I.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.grossProfit??Number(I.totalCharged??0)-Number(I.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>d(I),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(I),children:"Eliminar"})]})})]},I.id))})]}),u&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",u.date]}),i.jsx("button",{onClick:()=>d(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:v,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:fx(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",td(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",td(x.profit)]})]})]}),(y=u.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:u.salesV2.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:fx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:I.date??""}),i.jsx("td",{className:"border p-1",children:I.userEmail??""})]},_))})]})]}):(b=u.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:u.sales.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:fx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amount)]}),i.jsx("td",{className:"border p-1",children:I.userEmail??""}),i.jsx("td",{className:"border p-1",children:I.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof I.change=="number"?td(I.change):I.change??"0"})]},_))})]})]}):(w=u.products)!=null&&w.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:u.products.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:fx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amount)]})]},_))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(j=u.productSummary)!=null&&j.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:u.productSummary.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:fx(I.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.totalAmount)]})]},_))})]})]}):null]})]}),f&&i.jsx("p",{className:"mt-3 text-sm",children:f})]})}function TPe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(""),[o,l]=g.useState(!1),[c,u]=g.useState(["vendedor_pollo"]),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState([]),[x,v]=g.useState(!0),[y,b]=g.useState(null),[w,j]=g.useState(["vendedor_pollo"]),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(!1),[P,O]=g.useState([]),z=U=>!U||U==="vendedor"?"vendedor_pollo":U==="admin"||U==="supervisor_pollo"||U==="contador"||U==="vendedor_pollo"||U==="vendedor_ropa"||U==="vendedor_dulces"?U:"vendedor_pollo",oe=U=>U?Array.isArray(U)?U.map(W=>z(String(W))):[z(String(U))]:["vendedor_pollo"],ce=async()=>{v(!0);const U=await $t(bt(Pe,"users")),W=[];U.forEach(X=>{const D=X.data();W.push({id:X.id,email:D.email??"",name:D.name??"",roles:oe(D.roles??D.role),sellerCandyId:D.sellerCandyId??""})}),p(W),v(!1)},ue=async()=>{try{const U=await $t(bt(Pe,"sellers_candies")),W=[];U.forEach(X=>{const D=X.data();W.push({id:X.id,name:D.name??"(sin nombre)",branchLabel:D.branch??"",commissionPercent:Number(D.commissionPercent??0)})}),O(W)}catch(U){console.error("Error cargando sellers_candies:",U)}};g.useEffect(()=>{ce(),ue()},[]);const ge=()=>{e(""),n(""),s(""),u(["vendedor_pollo"]),h("")},ne=async U=>{if(U.preventDefault(),f(""),y){if(a&&a.length>0&&a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}}else if(a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}if(!t.trim()){f(" El nombre es obligatorio.");return}try{if(y){const L=er(Pe,"users",y),Xe=w.length?w:["vendedor_pollo"],re=Xe.includes("vendedor_dulces")&&(I||A)||"";if(await Fn(L,{email:r,name:t.trim(),roles:Xe,role:Xe[0]||"vendedor_pollo",sellerCandyId:re}),p(J=>J.map(De=>De.id===y?{...De,email:r,name:t.trim(),roles:Xe,sellerCandyId:re}:De)),a&&a.length>=6)try{const J=VT(),De=S||r;await vge(J,De),f(` Usuario actualizado. Se envi correo de restablecimiento a ${De}`)}catch(J){console.error("Error sending password reset:",J),f(" Usuario actualizado. No se pudo enviar correo de restablecimiento.")}else f(" Usuario actualizado correctamente.");Ue();return}const W=jD(),X=ID(W.options,"Secondary"),D=VT(X),V=await yge(D,r,a),Z=c.length?c:["vendedor_pollo"],be=Z.includes("vendedor_dulces")&&A||"";await See(er(bt(Pe,"users"),V.user.uid),{email:r,name:t.trim(),roles:Z,role:Z[0]||"vendedor_pollo",sellerCandyId:be}),await RD(D),await fpe(X),p(L=>[{id:V.user.uid,email:r,name:t.trim(),roles:Z,sellerCandyId:be},...L]),f(" Usuario creado correctamente."),ge(),k(!1)}catch(W){console.error(W),f(" Error al crear el usuario: "+W.message)}},Oe=U=>{b(U.id),e(U.name||""),n(U.email||""),E(U.email||""),j(U.roles&&U.roles.length?U.roles:["vendedor_pollo"]),h(U.sellerCandyId||""),_(U.sellerCandyId||""),s(""),k(!0)},Ue=()=>{b(null),j(["vendedor_pollo"]),_(""),E(""),ge(),k(!1)},F=async U=>{confirm("Eliminar este usuario del listado?")&&(await qn(er(Pe,"users",U)),p(X=>X.filter(D=>D.id!==U)))},H=U=>{const W=U==="admin"?"admin":U==="supervisor_pollo"?"supervisor_pollo":U==="vendedor_ropa"?"vendedor_ropa":U==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",X=W==="admin"?"bg-blue-100 text-blue-700":W==="supervisor_pollo"?"bg-amber-100 text-amber-700":W==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":W==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${X}`,children:W})},K=U=>`${U.name}  ${U.branchLabel||"Sin sucursal"}  ${U.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>k(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(U=>{const W=y===U.id,X=(W?w:U.roles).includes("vendedor_dulces");return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:U.name||""}),i.jsx("td",{className:"p-2 border",children:U.email}),i.jsx("td",{className:"p-2 border",children:W?i.jsxs("div",{className:"space-y-2 text-left",children:[["supervisor_pollo","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(D=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:w.includes(D),onChange:()=>j(V=>V.includes(D)?V.filter(Z=>Z!==D):[...V,D])}),i.jsx("span",{className:"text-sm",children:D})]},D)),w.includes("vendedor_dulces")&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs mt-1",value:I,onChange:D=>_(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),P.map(D=>i.jsx("option",{value:D.id,children:K(D)},D.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex gap-2 justify-center",children:U.roles.map(D=>i.jsx("span",{children:H(D)},D))}),X&&U.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Oe(U),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>F(U.id),children:"Eliminar"})]})})]},U.id)})})]})}),d&&i.jsx("p",{className:"text-sm mt-2",children:d}),B&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>k(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:y?"Editar usuario":"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ue,type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:U=>e(U.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:U=>n(U.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:a,onChange:U=>s(U.target.value),required:!y}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(U=>!U),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Roles"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["supervisor_pollo","contador","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(U=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:y?w.includes(U):c.includes(U),onChange:()=>{y?j(W=>W.includes(U)?W.filter(X=>X!==U):[...W,U]):u(W=>W.includes(U)?W.filter(X=>X!==U):[...W,U])}}),i.jsx("span",{className:"text-sm",children:U})]},U))})]}),(y?w.includes("vendedor_dulces"):c.includes("vendedor_dulces"))&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:A,onChange:U=>h(U.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),P.map(U=>i.jsx("option",{value:U.id,children:K(U)},U.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Ue,children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:y?"Guardar cambios":"Crear usuario"})]})]}),d&&i.jsx("p",{className:"text-sm mt-2",children:d})]})]})]})}const WV=t=>`C$${(Number(t)||0).toFixed(2)}`;function kPe(){const[t,e]=g.useState(""),[r,n]=g.useState(0),[a,s]=g.useState(0),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState([]),[m,p]=g.useState(!0),[x,v]=g.useState(!1),[y,b]=g.useState(null),[w,j]=g.useState(""),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[P,O]=g.useState(0),[z,oe]=g.useState(!1),ce=async()=>{p(!0);const K=await $t(bt(Pe,"products")),U=[];K.forEach(W=>{const X=W.data();U.push({id:W.id,name:X.name??"",price:Number(X.price??0),providerPrice:Number(X.providerPrice??0),category:X.category??"",measurement:X.measurement??"",active:X.active!==!1})}),h(U),p(!1)};g.useEffect(()=>{ce()},[]);const ue=async K=>{if(K.preventDefault(),l(""),!t||r<=0||!d){l(" Completa nombre, precio vlido y unidad de medida");return}try{const U={name:t,price:parseFloat(r.toFixed(2)),providerPrice:parseFloat((a||0).toFixed(2)),category:c,measurement:d,active:!0},W=await Zn(bt(Pe,"products"),U);h(X=>[{id:W.id,...U},...X]),l(" Producto registrado con exito."),e(""),n(0),s(0),f(""),u(""),oe(!1)}catch(U){l(" Error: "+U.message)}},ge=K=>{b(K.id),j(K.name),_(K.category),E(K.measurement),k(K.price),O(K.providerPrice||0)},ne=()=>{b(null),j(""),_(""),E(""),k(0)},Oe=async()=>{if(!y)return;const K=er(Pe,"products",y);await Fn(K,{name:w,category:I,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((P||0).toFixed(2))}),h(U=>U.map(W=>W.id===y?{...W,name:w,category:I,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((P||0).toFixed(2))}:W)),ne()},Ue=async K=>{const U=er(Pe,"products",K.id),W=K.active===!1;await Fn(U,{active:W}),h(X=>X.map(D=>D.id===K.id?{...D,active:W}:D))},F=async K=>{const U=sr(bt(Pe,"inventory_batches"),Ar("productId","==",K),xS(1));if(!(await $t(U)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await qn(er(Pe,"products",K)),h(D=>D.filter(V=>V.id!==K)))},H=x?A:A.filter(K=>K.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{l(""),oe(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),z&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>oe(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>oe(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:c,onChange:K=>u(K.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:K=>e(K.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:d,onChange:K=>f(K.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio proveedor (ej: 40.00)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(a)?"":a,onChange:K=>s(parseFloat(K.target.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:K=>n(parseFloat(K.target.value)),onFocus:K=>K.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),o&&i.jsx("p",{className:"text-sm mt-2",children:o})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:K=>v(K.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):H.map(K=>{const U=y===K.id,W=K.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:U?i.jsx("input",{className:"w-full border p-1 rounded",value:w,onChange:X=>j(X.target.value)}):K.name}),i.jsx("td",{className:"p-2 border",children:U?i.jsxs("select",{className:"w-full border p-1 rounded",value:I,onChange:X=>_(X.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):K.category}),i.jsx("td",{className:"p-2 border",children:U?i.jsxs("select",{className:"w-full border p-1 rounded",value:S,onChange:X=>E(X.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):K.measurement}),i.jsx("td",{className:"p-2 border",children:U?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(P)?"":P,onChange:X=>O(parseFloat(X.target.value))}):WV(K.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:U?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(B)?"":B,onChange:X=>k(parseFloat(X.target.value))}):WV(K.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${W?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:W?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:U?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Oe,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ne,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>ge(K),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${W?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>Ue(K),children:W?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>F(K.id),children:"Eliminar"})]})})]},K.id)})})]})})]})}const ml=[];for(let t=0;t<256;++t)ml.push((t+256).toString(16).slice(1));function FPe(t,e=0){return(ml[t[e+0]]+ml[t[e+1]]+ml[t[e+2]]+ml[t[e+3]]+"-"+ml[t[e+4]]+ml[t[e+5]]+"-"+ml[t[e+6]]+ml[t[e+7]]+"-"+ml[t[e+8]]+ml[t[e+9]]+"-"+ml[t[e+10]]+ml[t[e+11]]+ml[t[e+12]]+ml[t[e+13]]+ml[t[e+14]]+ml[t[e+15]]).toLowerCase()}let v5;const OPe=new Uint8Array(16);function DPe(){if(!v5){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");v5=crypto.getRandomValues.bind(crypto)}return v5(OPe)}const RPe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),XV={randomUUID:RPe};function MPe(t,e,r){var a;if(XV.randomUUID&&!t)return XV.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??DPe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,FPe(n)}async function LPe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const a=bt(t,"inventory_batches"),s=sr(a,Ar("productName","==",e)),c=(await $t(s)).docs.map(u=>({id:u.id,data:u.data()})).sort((u,d)=>{var p,x;const f=u.data.date??"",A=d.data.date??"";if(f!==A)return f<A?-1:1;const h=((p=u.data.createdAt)==null?void 0:p.seconds)??0,m=((x=d.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(u=>er(t,"inventory_batches",u.id));return Ks(t,async u=>{let d=Number(r);const f=[],A=await Promise.all(c.map(x=>u.get(x)));for(let x=0;x<c.length&&d>0;x++){const v=c[x],y=A[x];if(!y.exists())continue;const b=y.data(),w=Number(b.quantity??0),j=Number(b.remaining??w??0),I=Number(b.purchasePrice??0);if(j<=0)continue;const _=Math.min(j,d),S=Number((j-_).toFixed(3));u.update(v,{remaining:S}),f.push({batchId:v.id,qty:_,unitCost:I,lineCost:Number((_*I).toFixed(2))}),d=Number((d-_).toFixed(3))}if(d>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${d} unidades.`);const h=Number(f.reduce((x,v)=>x+v.lineCost,0).toFixed(2)),m=f.reduce((x,v)=>x+v.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:f,avgUnitCost:p,cogsAmount:h}})}const Kre=3,UPe=.5*10**-Kre;function As(t){const e=Number(t??0);return Number(e.toFixed(Kre))}function y5(t,e){return As((t??0)+(e??0))}function MC(t,e){return As(t)+UPe>=As(e)}async function QPe(t,e){const r=await $t(bt(Pe,"inventory_batches")),n=t.trim().toLowerCase();let a=0;for(const s of r.docs){const o=s.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await Fn(er(Pe,"inventory_batches",s.id),{productId:e}),a++)}return a}const h0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function YV({user:t,role:e,roles:r}){r&&r.length;const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState(""),[u,d]=g.useState(Ur(new Date,"yyyy-MM-dd")),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState(0),[b,w]=g.useState(0),[j,I]=g.useState("0"),[_,S]=g.useState(""),[E,B]=g.useState(!1),[k,P]=g.useState({}),O=$e=>Math.round($e*100)/100,z=$e=>As($e).toFixed(3),[oe,ce]=g.useState("CONTADO"),[ue,ge]=g.useState([]),[ne,Oe]=g.useState(""),[Ue,F]=g.useState(0),H=$e=>{ce($e),$e==="CREDITO"?(A(""),w(0),I("0.00")):(Oe(""),F(0))},K=$e=>{const Fe=Number($e.specialPrice||0);return Fe>0?Fe:Number($e.price||0)},U=async $e=>{if(!$e)return 0;const Fe=sr(bt(Pe,"inventory_batches"),Ar("productId","==",$e)),Ze=await $t(Fe);let Te=0;return Ze.forEach(ee=>{const me=ee.data();Te=y5(Te,Number(me.remaining||0))}),As(Te)},W=async $e=>{if(!$e)return 0;const Fe=await $t(bt(Pe,"inventory_batches"));let Ze=0;return Fe.forEach(Te=>{const ee=Te.data();(ee.productName||"").trim().toLowerCase()===$e.trim().toLowerCase()&&(Ze=y5(Ze,Number(ee.remaining||0)))}),As(Ze)};g.useEffect(()=>{(async()=>{const $e=await $t(bt(Pe,"products")),Fe=[];$e.forEach(Ze=>{const Te=Ze.data();(Te==null?void 0:Te.active)!==!1&&Fe.push({id:Ze.id,productName:Te.name??Te.productName??"(sin nombre)",price:Number(Te.price??0),measurement:Te.measurement??"(sin unidad)",category:Te.category??"(sin categora)"})}),a(Fe)})()},[]),g.useEffect(()=>{(async()=>{const $e=await $t(bt(Pe,"inventory_batches")),Fe={};$e.forEach(Ze=>{const Te=Ze.data(),ee=Te.productId,me=Number(Te.remaining||0);ee&&(Fe[ee]=y5(Fe[ee]||0,me))}),Object.keys(Fe).forEach(Ze=>Fe[Ze]=As(Fe[Ze])),P(Fe)})()},[]),g.useEffect(()=>{(async()=>{const $e=await $t(bt(Pe,"users")),Fe=[];$e.forEach(Ze=>{const Te=Ze.data();Fe.push({id:Ze.id,email:Te.email??"(sin email)",role:Te.role??"USER"})}),o(Fe)})()},[]);const X=async()=>{if(!l)return;const $e=n.find(Ze=>Ze.id===l);if(!$e)return;if(p.some(Ze=>Ze.productId===$e.id)){c("");return}const Fe=await U($e.id);x(Ze=>[...Ze,{productId:$e.id,productName:$e.productName,measurement:$e.measurement,price:Number($e.price||0),specialPrice:0,stock:Fe,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},D=async $e=>{if(!$e)return;const Fe=n.find(Te=>Te.id===$e);if(!Fe||p.some(Te=>Te.productId===Fe.id))return;const Ze=await U(Fe.id);x(Te=>[...Te,{productId:Fe.id,productName:Fe.productName,measurement:Fe.measurement,price:Number(Fe.price||0),specialPrice:0,stock:Ze,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},V=$e=>{x(Fe=>Fe.filter(Ze=>Ze.productId!==$e))},Z=$e=>{const Fe=String($e||"").replace(",",".");if(Fe==="")return"";const Ze=Fe.split(".");return Ze.length===1?Fe:`${Ze[0]}.${Ze.slice(1).join("")}`},be=async($e,Fe)=>{x(Ze=>Ze.map(Te=>{if(Te.productId!==$e)return Te;const ee=(Te.measurement||"").toLowerCase()!=="lb",me=Z(Fe);if(me.trim()==="")return{...Te,qty:0,qtyInput:""};if(!ee&&me===".")return{...Te,qty:0,qtyInput:"0."};const Re=Number(me),he=Number.isFinite(Re)?Re:0;let qe=ee?Math.max(0,Math.round(he)):As(he);const st=ee?Math.max(0,Math.floor(Number(Te.stock||0))):As(Number(Te.stock||0));if(qe>st){qe=st,S(` Cantidad limitada a existencias (${st})`);const pe=ee?String(qe):qe===0?"":String(qe);return{...Te,qty:qe,qtyInput:pe}}const yt=ee?String(qe):me.endsWith(".")?me:String(qe);return{...Te,qty:qe,qtyInput:yt}}))},L=($e,Fe)=>{x(Ze=>Ze.map(Te=>{if(Te.productId!==$e)return Te;const ee=Z(Fe);if(ee.trim()==="")return{...Te,specialPrice:0,specialPriceInput:""};if(ee===".")return{...Te,specialPrice:0,specialPriceInput:"0."};const me=Number(ee),Re=Number.isFinite(me)?Math.max(0,O(me)):0,he=ee.endsWith(".")?ee:String(Re);return{...Te,specialPrice:Re,specialPriceInput:he}}))},Xe=($e,Fe)=>{x(Ze=>Ze.map(Te=>{if(Te.productId!==$e)return Te;const ee=Z(Fe);if(ee.trim()==="")return{...Te,discount:0,discountInput:""};if(ee===".")return{...Te,discount:0,discountInput:"0."};const me=Number(ee),Re=Number.isFinite(me)?Math.max(0,Math.floor(me)):0,he=ee.endsWith(".")?ee:String(Re);return{...Te,discount:Re,discountInput:he}}))},re=g.useMemo(()=>{let $e=0;for(const Fe of p){const Ze=K(Fe),Te=Number(Ze||0)*Number(Fe.qty||0),ee=Math.max(0,Te-Math.max(0,Number(Fe.discount||0)));$e+=ee}return O($e)},[p]);g.useEffect(()=>{y(re)},[re]),g.useEffect(()=>{const $e=Number(b)||0,Fe=Number(v)||0;I(($e-Fe).toFixed(2))},[b,v]);const J=$e=>{$e.key===","&&($e.preventDefault(),$e.target.value+=".")},[De,ie]=g.useState(!1);g.useEffect(()=>{var Ze;const $e=window.matchMedia("(max-width: 900px)"),Fe=()=>ie($e.matches);return Fe(),(Ze=$e.addEventListener)==null||Ze.call($e,"change",Fe),()=>{var Te;return(Te=$e.removeEventListener)==null?void 0:Te.call($e,"change",Fe)}},[]),g.useEffect(()=>{(async()=>{try{const $e=await $t(bt(Pe,"customers_pollo")),Fe=[];$e.forEach(Ze=>{const Te=Ze.data();Fe.push({id:Ze.id,name:Te.name??"",phone:Te.phone??"",status:Te.status??"ACTIVO",creditLimit:Number(Te.creditLimit??0),vendorId:Te.vendorId??"",vendorName:Te.vendorName??"",balance:0})});for(const Ze of Fe)try{const Te=sr(bt(Pe,"ar_movements_pollo"),Ar("customerId","==",Ze.id)),ee=await $t(Te);let me=0;ee.forEach(he=>{me+=Number(he.data().amount||0)});const Re=Number(Ze.initialDebt||0);Ze.balance=me+Re}catch{Ze.balance=0}Fe.sort((Ze,Te)=>(Ze.name||"").localeCompare(Te.name||"")),ge(Fe)}catch($e){console.error("Error cargando customers_pollo:",$e),ge([])}})()},[]);const He=g.useMemo(()=>ue.find($e=>$e.id===ne)||null,[ue,ne]),Ge=Number((He==null?void 0:He.balance)||0),dt=oe==="CREDITO"?Math.max(0,Number(Ge||0)+Math.max(0,Number(v||0))):0;g.useEffect(()=>{oe==="CREDITO"&&F($e=>Math.min(Math.max(0,Number($e||0)),dt))},[oe,dt]),g.useEffect(()=>{oe==="CREDITO"&&(w(Number(Ue||0)),I("0.00"))},[oe,Ue]);const _t=oe==="CREDITO"?Ge+Math.max(0,Number(v||0))-Math.max(0,Number(Ue||0)):0,Bt=async()=>{if(p.length===0)return"Agrega al menos un producto.";for(const $e of p){if(!$e.qty||$e.qty<=0)return`Cantidad invlida para "${$e.productName}".`;const Fe=await U($e.productId);if(!MC(Fe,$e.qty)){const Ze=await W($e.productName);if(MC(Ze,0)&&!MC(Fe,0)){const Te=await QPe($e.productName,$e.productId),ee=await U($e.productId);if(!MC(ee,$e.qty))return`Stock insuficiente tras corregir ${Te} lote(s) para "${$e.productName}".`}else return`Stock insuficiente para "${$e.productName}". Disponible: ${Fe}`}}return null},Ot=async $e=>{var Ze,Te;$e.preventDefault(),S("");const Fe=await Bt();if(Fe){S(" "+Fe);return}try{B(!0);const ee=[];if(oe==="CONTADO"){if(!f.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!ne)return"Selecciona un cliente (crdito).";if(Ue<0)return"El pago inicial no puede ser negativo.";if(Ue>v)return"El pago inicial no puede superar el total.";if((He==null?void 0:He.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede fiar."}for(const pe of p){const je=pe.qty,{allocations:we,avgUnitCost:Ye,cogsAmount:xe}=await LPe(Pe,pe.productName,je,!1),Se=K(pe),xt=Number(Se||0)*Number(je||0),Pt=Math.max(0,Number(pe.discount||0)),It=Math.max(0,xt-Pt);ee.push({productId:pe.productId,productName:pe.productName,measurement:pe.measurement,unitPrice:Number(Se||0),regularPrice:Number(pe.price||0),specialPrice:Number(pe.specialPrice||0)>0?Number(pe.specialPrice):null,qty:je,discount:Pt,lineTotal:O(xt),lineFinal:O(It),allocations:we,avgUnitCost:Ye,cogsAmount:xe})}const me=ee.reduce((pe,je)=>pe+je.lineFinal,0),Re=ee.reduce((pe,je)=>pe+Number(je.qty||0),0),he=Number(oe==="CREDITO"?Ue||0:b||0),qe=oe==="CREDITO"?"0.00":j,st={id:MPe(),quantity:Re,amount:me,amountCharged:me,timestamp:xr.now(),date:u,userEmail:(t==null?void 0:t.email)??((Ze=s[0])==null?void 0:Ze.email)??"sin usuario",vendor:e??((Te=s[0])==null?void 0:Te.role)??"sin usuario",status:"FLOTANTE",items:ee,itemsTotal:me,type:oe,amountReceived:he,change:qe,customerId:oe==="CREDITO"?ne:"",customerName:oe==="CREDITO"?(He==null?void 0:He.name)||"":f.trim(),clientName:oe==="CONTADO"?f.trim():""};if(oe==="CONTADO"){if(!f.trim()){S(" Ingresa el nombre del cliente (contado).");return}}else{if(!ne){S(" Selecciona un cliente (crdito).");return}if(Ue<0){S(" El pago inicial no puede ser negativo.");return}if(Ue>v){S(" El pago inicial no puede superar el total.");return}if((He==null?void 0:He.status)==="BLOQUEADO"){S(" El cliente est BLOQUEADO. No se puede fiar.");return}const pe=Number((He==null?void 0:He.creditLimit)||0);if(pe>0&&_t>pe){S(` Supera el lmite de crdito (C$ ${pe.toFixed(2)}).`);return}}const yt=await Zn(bt(Pe,"salesV2"),st);if(oe==="CREDITO"&&ne){const pe={customerId:ne,date:u,createdAt:xr.now(),ref:{saleId:yt.id}};await Zn(bt(Pe,"ar_movements_pollo"),{...pe,type:"CARGO",amount:Number(me)||0}),Number(Ue)>0&&await Zn(bt(Pe,"ar_movements_pollo"),{...pe,type:"ABONO",amount:-Number(Ue)}),ge(je=>je.map(we=>we.id===ne?{...we,balance:Number(we.balance||0)+Number(me||0)-Number(Ue||0)}:we))}S(" Venta registrada y asignada a inventario (FIFO)."),x([]),c(""),y(0),w(0),I("0"),A(""),d(Ur(new Date,"yyyy-MM-dd")),Oe(""),F(0),ce("CONTADO")}catch(ee){console.error(ee),S(` ${(ee==null?void 0:ee.message)||"Error al registrar la venta."}`)}finally{B(!1)}},jt=g.useMemo(()=>new Set(p.map($e=>$e.productId)),[p]),Qt=g.useMemo(()=>n.filter($e=>(k[$e.id]||0)>0),[n,k]),Ft=g.useMemo(()=>{const $e=String(h||"").trim().toLowerCase();return $e?Qt.filter(Fe=>`${Fe.productName||""}`.toLowerCase().includes($e)):Qt},[Qt,h]);return De?i.jsx("div",{className:"w-full max-w-lg mx-auto p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"font-bold text-lg text-blue-700",children:"Registrar venta (Pollo)"}),i.jsx("input",{type:"date",className:"text-sm text-gray-700 border rounded px-2 py-1",value:u,onChange:$e=>d($e.target.value),"aria-label":"Fecha de la venta"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:oe,onChange:$e=>H($e.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),oe==="CONTADO"?i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:f,onChange:$e=>A($e.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ne,onChange:$e=>Oe($e.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ue.map($e=>i.jsxs("option",{value:$e.status==="ACTIVO"?$e.id:"",disabled:$e.status==="BLOQUEADO",children:[$e.name,"  Saldo: ",h0($e.balance||0)]},$e.id))]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:h0(Ge)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:h0(_t)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold",children:"Pago inicial"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",type:"number",step:"0.01",inputMode:"decimal",max:dt,value:Ue===0?"":Ue,onChange:$e=>{const Fe=Math.max(0,Number($e.target.value||0)),Ze=Math.min(Fe,dt);F(Ze)},placeholder:"0.00"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",h0(dt)]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 mb-2",placeholder:"Buscar producto por nombre...",value:h,onChange:$e=>m($e.target.value)}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{className:"flex-1 border rounded px-1 py-2 text-sm",value:l,onChange:async $e=>{const Fe=$e.target.value;c(Fe),await D(Fe)},children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Ft.map($e=>i.jsxs("option",{value:$e.id,disabled:jt.has($e.id),children:[$e.productName," | C$ ",$e.price," | Disp:"," ",z(k[$e.id]||0)]},$e.id))]})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Items"}),p.length===0?i.jsx("div",{className:"text-gray-500",children:"Agrega productos al carrito."}):i.jsx("div",{className:"space-y-2",children:p.map($e=>{const Fe=K($e),Ze=Number(Fe||0)*Number($e.qty||0),Te=Math.max(0,Ze-Math.max(0,Number($e.discount||0))),ee=($e.measurement||"").toLowerCase()!=="lb";return i.jsxs("div",{className:"border rounded p-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"font-semibold",children:$e.productName}),i.jsxs("div",{className:"text-sm",children:["C$ ",O(Fe).toFixed(2)]})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 items-center",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:ee?"numeric":"decimal",step:ee?1:.01,value:$e.qtyInput??($e.qty===0?"":$e.qty),onKeyDown:J,onChange:me=>be($e.productId,me.target.value),placeholder:ee?"Unid":"Libras",title:ee?"Unidades":"Libras"}),i.jsx("input",{className:"border rounded px-1 py-1 text-right",inputMode:"numeric",value:$e.discountInput??($e.discount===0?"":$e.discount),onChange:me=>Xe($e.productId,me.target.value),placeholder:"Descuento",title:"Descuento (C$)"}),i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:"decimal",value:$e.specialPriceInput??($e.specialPrice===0?"":$e.specialPrice),onChange:me=>L($e.productId,me.target.value),placeholder:"Sugerido",title:"Precio sugerido (opcional)"})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Exist:"," ",As(Number($e.stock)-Number($e.qty||0)).toFixed(3)]}),i.jsxs("div",{className:"font-semibold",children:["C$ ",O(Te).toFixed(2)]})]}),i.jsx("div",{className:"mt-2 text-right",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600",onClick:()=>V($e.productId),children:"Quitar"})})]},$e.productId)})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Monto total"}),i.jsxs("div",{className:"text-xl font-bold",children:["C$ ",v.toFixed(2)]})]}),oe==="CONTADO"&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-2",inputMode:"decimal",value:b===0?"":b,onChange:$e=>w(Number($e.target.value||0)),placeholder:"Monto recibido"}),i.jsxs("div",{className:"border rounded px-2 py-2 bg-gray-100",children:["Cambio: C$ ",j]})]}),i.jsx("button",{onClick:Ot,disabled:p.length===0||E,className:"w-full bg-blue-600 text-white px-4 py-2 rounded",children:E?"Guardando...":"Guardar venta"}),_&&i.jsx("div",{className:`text-sm ${_.startsWith("")?"text-green-600":_.startsWith("")?"text-yellow-600":"text-red-600"}`,children:_})]})}):i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:Ot,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl\r
                 p-4 sm:p-6 md:p-8\r
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:$e=>c($e.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Qt.map($e=>i.jsxs("option",{value:$e.id,disabled:jt.has($e.id),title:jt.has($e.id)?"Ya est en la lista":`Disponible: ${z(k[$e.id]||0)}`,children:[$e.productName,"  ",$e.measurement,"  C$ ",$e.price," (disp:"," ",z(k[$e.id]||0),")"]},$e.id))]}),i.jsx("button",{type:"button",onClick:X,disabled:!l||jt.has(l),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:u,onChange:$e=>d($e.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:oe,onChange:$e=>H($e.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),oe==="CONTADO"?i.jsxs("div",{className:"md:col-span-2 space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:f,onChange:$e=>A($e.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"md:col-span-2 space-y-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:ne,onChange:$e=>Oe($e.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ue.map($e=>i.jsxs("option",{value:$e.status==="ACTIVO"?$e.id:"",disabled:$e.status==="BLOQUEADO",children:[$e.name,"  Saldo: ",h0($e.balance||0)]},$e.id))]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:h0(Ge)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Pago inicial"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",h0(dt)]}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:dt,className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:Ue===0?"":Ue,onChange:$e=>{const Fe=Math.max(0,Number($e.target.value||0)),Ze=Math.min(Fe,dt);F(Ze)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:h0(_t)})]})]})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):p.map($e=>{const Fe=K($e),Ze=Number(Fe||0)*Number($e.qty||0),Te=Math.max(0,Ze-Math.max(0,Number($e.discount||0))),ee=($e.measurement||"").toLowerCase()!=="lb",me=As(Number($e.stock)-Number($e.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[$e.productName,"  ",$e.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",O($e.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:$e.specialPrice===0?"":$e.specialPrice,onKeyDown:J,onChange:Re=>L($e.productId,Re.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",O(Fe).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:me.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:ee?1:.01,inputMode:ee?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:$e.qtyInput??($e.qty===0?"":$e.qty),onKeyDown:J,onChange:Re=>be($e.productId,Re.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:$e.discount===0?"":$e.discount,onChange:Re=>Xe($e.productId,Re.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",O(Te).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>V($e.productId),title:"Quitar",children:""})})]},$e.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${v.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),oe==="CONTADO"&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:b===0?"":b,onChange:$e=>w(Number($e.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${j}`,readOnly:!0})]})]})}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:p.length===0||E,children:E?"Guardando...":"Guardar venta"}),_&&i.jsx("p",{className:`text-sm mt-2 ${_.startsWith("")?"text-green-600":_.startsWith("")?"text-yellow-600":"text-red-600"}`,children:_})]}),E&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}function Gre(t,e,r,n,a){n=n||{};var s=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():s,u=l*c,d=/\r\n|\r|\n/g,f="",A=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof t=="string"?t.split(d):t,A=f.length||1),r+=l*(2-s),n.valign==="middle"?r-=A/2*u:n.valign==="bottom"&&(r-=A*u),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&A>=1){for(var m=0;m<f.length;m++)a.text(f[m],e-a.getStringUnitWidth(f[m])*h,r),r+=u;return a}e-=a.getStringUnitWidth(t)*h}return n.halign==="justify"?a.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(t,e,r),a}var JV={},Av=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:JV=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,a,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=t.unifyColor(e.textColor),d&&(a=this.jsPDFDocument).setTextColor.apply(a,d),d=t.unifyColor(e.lineColor),d&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,a,s){return this.jsPDFDocument.rect(e,r,n,a,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return JV||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Gk=function(t,e){return Gk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Gk(t,e)};function qre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Gk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var zre=function(t){qre(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function VPe(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function HPe(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function RS(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return a}function Wre(t,e,r,n){var a=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:a,lineColor:s});var o=Xre(a,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,o)}function Xre(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function iP(t,e){var r,n,a,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(a=t.right)!==null&&a!==void 0?a:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function Yre(t,e){var r=iP(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function $Pe(t,e,r,n,a){var s={},o=1.3333333333333333,l=b5(e,function(b){return a.getComputedStyle(b).backgroundColor});l!=null&&(s.fillColor=l);var c=b5(e,function(b){return a.getComputedStyle(b).color});c!=null&&(s.textColor=c);var u=GPe(n,r);u&&(s.cellPadding=u);var d="borderTopColor",f=o*r,A=n.borderTopWidth;if(n.borderBottomWidth===A&&n.borderRightWidth===A&&n.borderLeftWidth===A){var h=(parseFloat(A)||0)/f;h&&(s.lineWidth=h)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=b5(e,function(b){return a.getComputedStyle(b)[d]});m!=null&&(s.lineColor=m);var p=["left","right","center","justify"];p.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),p=["middle","bottom","top"],p.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(s.fontSize=x/o);var v=KPe(n);v&&(s.fontStyle=v);var y=(n.fontFamily||"").toLowerCase();return t.indexOf(y)!==-1&&(s.font=y),s}function KPe(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function b5(t,e){var r=Jre(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function Jre(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:Jre(t.parentElement,e):r}function GPe(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),a=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(l){return parseInt(l||"0")/n}),o=iP(s,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function Zre(t,e,r,n,a){var s,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),d=[],f=[],A=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:d,body:f,foot:A};for(var h=0;h<l.rows.length;h++){var m=l.rows[h],p=(o=(s=m==null?void 0:m.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),x=qPe(c,u,r,m,n,a);x&&(p==="thead"?d.push(x):p==="tfoot"?A.push(x):f.push(x))}return{head:d,body:f,foot:A}}function qPe(t,e,r,n,a,s){for(var o=new zre(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(a||u.display!=="none"){var d=void 0;s&&(d=$Pe(t,c,e,u,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:zPe(c)})}}var f=r.getComputedStyle(n);if(o.length>0&&(a||f.display!=="none"))return o}function zPe(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function WPe(t,e,r){for(var n=0,a=[t,e,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Xh(t,e,r,n,a){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function ene(t,e){var r=new Av(t),n=r.getDocumentOptions(),a=r.getGlobalOptions();WPe(a,n,e);var s=Xh({},a,n,e),o;typeof window<"u"&&(o=window);var l=XPe(a,n,e),c=YPe(a,n,e),u=JPe(r,s),d=e3e(r,s,o);return{id:e.tableId,content:d,hooks:c,styles:l,settings:u}}function XPe(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=t[c],d=e[c],f=r[c];n.columnStyles=Xh({},u,d,f)}else{var A=[t,e,r],h=A.map(function(m){return m[c]||{}});n[c]=Xh({},h[0],h[1],h[2])}},s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];a(l)}return n}function YPe(t,e,r){for(var n=[t,e,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=n;s<o.length;s++){var l=o[s];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function JPe(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m=iP(e.margin,40/t.scaleFactor()),p=(r=ZPe(t,e.startY))!==null&&r!==void 0?r:m.top,x;e.showFoot===!0?x="everyPage":e.showFoot===!1?x="never":x=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(a=e.showHead)!==null&&a!==void 0?a:"everyPage";var y=(s=e.useCss)!==null&&s!==void 0?s:!1,b=e.theme||(y?"plain":"striped"),w=!!e.horizontalPageBreak,j=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:y,theme:b,startY:p,margin:m,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:v,showFoot:x,tableLineWidth:(f=e.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(A=e.tableLineColor)!==null&&A!==void 0?A:200,horizontalPageBreak:w,horizontalPageBreakRepeat:j,horizontalPageBreakBehaviour:(h=e.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function ZPe(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),a=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===a}return typeof e=="number"?e:(e==null||e===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function e3e(t,e,r){var n=e.head||[],a=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=Zre(t,e.html,r,o,e.useCss)||{};n=l.head||n,a=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||t3e(n,a,s);return{columns:c,head:n,body:a,foot:s}}function t3e(t,e,r){var n=t[0]||e[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var u=void 0;Array.isArray(n)?u=a.length:u=s+(c>0?"_".concat(c):"");var d={dataKey:u};a.push(d)}}),a}var qk=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),r3e=function(t){qre(e,t);function e(r,n,a,s,o,l){var c=t.call(this,r,n,l)||this;return c.cell=a,c.row=s,c.column=o,c.section=s.section,c}return e}(qk),n3e=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,a,s,o){for(var l=0,c=r;l<c.length;l++){var u=c[l],d=new r3e(e,this,n,a,s,o),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new qk(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new qk(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),tne=function(){function t(e,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof zre&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(a,s){var o=n.cells[s.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),u=c+l;return u>a?u:a},0)},t}(),rne=function(){function t(e,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(a=e.content)!==null&&a!==void 0?a:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/e*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=iP(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),a3e=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,a=e.allRows();n<a.length;n++){var s=a[n],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function s3e(t,e){i3e(t,e);var r=[],n=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=e.getWidth(t.pageSize().width)-n;a&&(a=zk(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=zk(r,a,function(s){return s.minWidth})),a=Math.abs(a),!e.settings.horizontalPageBreak&&a>.1/t.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),l3e(e),c3e(e,t),o3e(e)}function i3e(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,a=Yre(t,e);e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(t,d,u,s,c,null);var f=u.padding("horizontal");u.contentWidth=RS(u.text,u.styles,t)+f;var A=RS(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=A+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function zk(t,e,r){for(var n=e,a=t.reduce(function(h,m){return h+m.wrappedWidth},0),s=0;s<t.length;s++){var o=t[s],l=o.wrappedWidth/a,c=n*l,u=o.width+c,d=r(o),f=u<d?d:u;e-=f-o.width,o.width=f}if(e=Math.round(e*1e10)/1e10,e){var A=t.filter(function(h){return e<0?h.width>r(h):!0});A.length&&(e=zk(A,e,r))}return e}function o3e(t){for(var e={},r=1,n=t.allRows(),a=0;a<n.length;a++)for(var s=n[a],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=e[c.index];if(r>1)r--,delete s.cells[c.index];else if(u)u.cell.height+=s.height,r=u.cell.colSpan,delete s.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=s.cells[c.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var f=n.length-a,A=d.rowSpan>f?f:d.rowSpan;e[c.index]={cell:d,left:A,row:s}}}}}function l3e(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],a=null,s=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])s+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+s}else{var u=n.cells[c.index];if(!u)continue;if(o=u.colSpan,s=0,u.colSpan>1){a=u,s+=c.width;continue}u.width=c.width+s}}}function c3e(t,e){for(var r={count:0,height:0},n=0,a=t.allRows();n<a.length;n++){for(var s=a[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=ZV(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=ZV(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var A=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<A*u.rowSpan?r={height:A,count:u.rowSpan}:r&&r.count>0&&r.height>A&&(A=r.height),A>s.height&&(s.height=A)}}r.count--}}function ZV(t,e,r,n,a){return t.map(function(s){return u3e(s,e,r,n,a)})}function u3e(t,e,r,n,a){var s=1e4*n.scaleFactor();if(e=Math.ceil(e*s)/s,e>=RS(t,r,n))return t;for(;e<RS(t+a,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+a}function nne(t,e){var r=new Av(t),n=d3e(e,r.scaleFactor()),a=new n3e(e,n);return s3e(r,a),r.applyStyles(r.userStyles),a}function d3e(t,e){var r=t.content,n=h3e(r.columns);if(r.head.length===0){var a=eH(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=eH(n,"foot");a&&r.foot.push(a)}var s=t.settings.theme,o=t.styles;return{columns:n,head:w5("head",r.head,n,o,s,e),body:w5("body",r.body,n,o,s,e),foot:w5("foot",r.foot,n,o,s,e)}}function w5(t,e,r,n,a,s){var o={},l=e.map(function(c,u){for(var d=0,f={},A=0,h=0,m=0,p=r;m<p.length;m++){var x=p[m];if(o[x.index]==null||o[x.index].left===0)if(h===0){var v=void 0;Array.isArray(c)?v=c[x.index-A-d]:v=c[x.dataKey];var y={};typeof v=="object"&&!Array.isArray(v)&&(y=(v==null?void 0:v.styles)||{});var b=A3e(t,x,u,a,n,s,y),w=new rne(v,b,t);f[x.dataKey]=w,f[x.index]=w,h=w.colSpan-1,o[x.index]={left:w.rowSpan-1,times:h}}else h--,A++;else o[x.index].left--,h=o[x.index].times,d++}return new tne(c,u,t,f)});return l}function eH(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var a=f3e(e,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function f3e(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function h3e(t){return t.map(function(e,r){var n,a;return typeof e=="object"?a=(n=e.dataKey)!==null&&n!==void 0?n:r:a=r,new a3e(a,e,r)})}function A3e(t,e,r,n,a,s,o){var l=HPe(n),c;t==="head"?c=a.headStyles:t==="body"?c=a.bodyStyles:t==="foot"&&(c=a.footStyles);var u=Xh({},l.table,l[t],a.styles,c),d=a.columnStyles[e.dataKey]||a.columnStyles[e.index]||{},f=t==="body"?d:{},A=t==="body"&&r%2===0?Xh({},l.alternateRow,a.alternateRowStyles):{},h=VPe(s),m=Xh({},h,u,A,f);return Xh(m,o)}function m3e(t,e,r){var n;r===void 0&&(r={});var a=Yre(t,e),s=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(A){var h=e.columns.find(function(m){return m.dataKey===A||m.index===A});h&&!s.has(h.index)&&(s.set(h.index,!0),o.push(h.index),l.push(e.columns[h.index]),a-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<e.columns.length;){if(s.has(d)){d++;continue}var f=e.columns[d].wrappedWidth;if(u||a>=f)u=!1,o.push(d),l.push(e.columns[d]),a-=f;else break;d++}return{colIndexes:o,columns:l,lastIndex:d-1}}function p3e(t,e){for(var r=[],n=0;n<e.columns.length;n++){var a=m3e(t,e,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function ane(t,e){var r=e.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(A,h){return A+h.height},0);l+=u}var d=new Av(t);(r.pageBreak==="always"||r.startY!=null&&l>d.pageSize().height)&&(ine(d),s.y=a.top),e.callWillDrawPageHooks(d,s);var f=Xh({},s);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?g3e(d,e,f,s):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(A){return yA(d,e,A,s,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(A,h){var m=h===e.body.length-1;MS(d,e,A,m,f,s,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(A){return yA(d,e,A,s,e.columns)})),Wre(d,e,f,s),e.callEndPageHooks(d,s),e.finalY=s.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function g3e(t,e,r,n){var a=p3e(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,d){t.applyStyles(t.userStyles),d>0?Pb(t,e,r,n,u.columns,!0):tH(t,e,n,u.columns),x3e(t,e,r,n,u.columns),N5(t,e,n,u.columns)});else for(var o=-1,l=a[0],c=function(){var u=o;if(l){t.applyStyles(t.userStyles);var d=l.columns;o>=0?Pb(t,e,r,n,d,!0):tH(t,e,n,d),u=rH(t,e,o+1,n,d),N5(t,e,n,d)}var f=u-o;a.slice(1).forEach(function(A){t.applyStyles(t.userStyles),Pb(t,e,r,n,A.columns,!0),rH(t,e,o+1,n,A.columns,f),N5(t,e,n,A.columns)}),o=u};o<e.body.length-1;)c()}function tH(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(s){return yA(t,e,s,r,n)})}function x3e(t,e,r,n,a){t.applyStyles(t.userStyles),e.body.forEach(function(s,o){var l=o===e.body.length-1;MS(t,e,s,l,r,n,a)})}function rH(t,e,r,n,a,s){t.applyStyles(t.userStyles),s=s??e.body.length;var o=Math.min(r+s,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,u){var d=r+u===e.body.length-1,f=sne(t,e,d,n);c.canEntireRowFit(f,a)&&(yA(t,e,c,n,a),l=r+u)}),l}function N5(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(s){return yA(t,e,s,r,n)})}function v3e(t,e,r){var n=r.getLineHeight(t.styles.fontSize),a=t.padding("vertical"),s=Math.floor((e-a)/n);return Math.max(0,s)}function y3e(t,e,r,n){var a={};t.spansMultiplePages=!0,t.height=0;for(var s=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new rne(u.raw,u.styles,u.section);d=Xh(d,u),d.text=[];var f=v3e(u,e,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var A=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(A,h),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),d.contentHeight=d.getContentHeight(A,h),d.contentHeight>s&&(s=d.contentHeight),a[c.index]=d}}var m=new tne(t.raw,-1,t.section,a,!0);m.height=s;for(var p=0,x=r.columns;p<x.length;p++){var c=x[p],d=m.cells[c.index];d&&(d.height=m.height);var u=t.cells[c.index];u&&(u.height=t.height)}return m}function b3e(t,e,r,n){var a=t.pageSize().height,s=n.settings.margin,o=s.top+s.bottom,l=a-o;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(n.columns),f=e.getMaxCellHeight(n.columns)>l;return f?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function MS(t,e,r,n,a,s,o){var l=sne(t,e,n,s);if(r.canEntireRowFit(l,o))yA(t,e,r,s,o);else if(b3e(t,r,l,e)){var c=y3e(r,l,e,t);yA(t,e,r,s,o),Pb(t,e,a,s,o),MS(t,e,c,n,a,s,o)}else Pb(t,e,a,s,o),MS(t,e,r,n,a,s,o)}function yA(t,e,r,n,a){n.x=e.settings.margin.left;for(var s=0,o=a;s<o.length;s++){var l=o[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}w3e(t,c,n);var d=c.getTextPos();Gre(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function w3e(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=Xre(n.lineWidth,n.fillColor);a&&t.rect(e.x,r.y,e.width,e.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),N3e(t,e,r,n.lineWidth))}function N3e(t,e,r,n){var a,s,o,l;n.top&&(a=r.x,s=r.y,o=r.x+e.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,o,l)),n.bottom&&(a=r.x,s=r.y+e.height,o=r.x+e.width,l=r.y+e.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,o,l)),n.left&&(a=r.x,s=r.y,o=r.x,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,s,o,l)),n.right&&(a=r.x+e.width,s=r.y,o=r.x+e.width,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,s,o,l));function c(u,d,f,A,h){t.getDocument().setLineWidth(u),t.getDocument().line(d,f,A,h,"S")}}function sne(t,e,r,n){var a=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-a}function Pb(t,e,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(l){return yA(t,e,l,n,a)}),e.callEndPageHooks(t,n);var o=e.settings.margin;Wre(t,e,r,n),ine(t),e.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return yA(t,e,l,n,a)}),t.applyStyles(t.userStyles))}function ine(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function C3e(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],a=ene(this,n),s=nne(this,a);return ane(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,a){Gre(e,r,n,a,this)},t.API.autoTableSetDefaults=function(e){return Av.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){Av.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Av(this),s=Zre(a,e,window,r,!1),o=s.head,l=s.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var C5;function U0(t,e){var r=ene(t,e),n=nne(t,r);ane(t,n)}try{if(typeof window<"u"&&window){var nH=window,aH=nH.jsPDF||((C5=nH.jspdf)===null||C5===void 0?void 0:C5.jsPDF);aH&&C3e(aH)}}catch(t){console.error("Could not apply autoTable plugin",t)}const Ka=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function _5(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function _3e({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const[a,s]=g.useState([]),[o,l]=g.useState([]),[c,u]=g.useState(!0),[d,f]=g.useState(""),{refreshKey:A,refresh:h}=Dc(),m=e&&e.length?e:t,p=Sn(m,"admin"),x=p||Sn(m,"contador"),[v,y]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[b,w]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[j,I]=g.useState(""),[_,S]=g.useState(!1),[E,B]=g.useState(""),[k,P]=g.useState(Ur(new Date,"yyyy-MM-dd")),[O,z]=g.useState("lb"),[oe,ce]=g.useState(""),[ue,ge]=g.useState(0),[ne,Oe]=g.useState(NaN),[Ue,F]=g.useState(0),[H,K]=g.useState([]),[U,W]=g.useState(null),[X,D]=g.useState([]),[V,Z]=g.useState(!1),[be,L]=g.useState(null),[Xe,re]=g.useState(!1),[J,De]=g.useState(null),[ie,He]=g.useState(null),Ge=Ce=>He(Ae=>Ae===Ce?null:Ce),[dt,_t]=g.useState(!1),Bt=()=>_t(Ce=>!Ce),[Ot,jt]=g.useState("all"),[Qt,Ft]=g.useState({}),$e=Ce=>Ft(Ae=>({...Ae,[Ce]:!(Ae[Ce]??!1)})),Fe=(Ce,Ae)=>{const Qe=[];return Ce>0&&Qe.push(`${Ce.toFixed(3)} lb`),Ae>0&&Qe.push(`${Ae.toFixed(3)} un`),Qe.length===0?"0":Qe.join("  ")},Ze=Ce=>{const Ae=(Ce||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(Ae)||Ae==="lb"};g.useEffect(()=>{(async()=>{u(!0),f("");const Ce=await $t(bt(Pe,"products")),Ae=[];Ce.forEach(_e=>{const R=_e.data();R.active===!0&&Ae.push({id:_e.id,name:R.name??R.productName??"(sin nombre)",category:R.category??"(sin categora)",measurement:R.measurement??"lb",price:Number(R.price??0),providerPrice:Object.prototype.hasOwnProperty.call(R,"providerPrice")?Number(R.providerPrice):void 0})}),s(Ae);const Qe=sr(bt(Pe,"inventory_batches"),In("date","desc")),fe=await $t(Qe),te=[];fe.forEach(_e=>{const R=_e.data(),Q=As(Number(R.quantity||0)),G=Number(R.purchasePrice||0),se=Number(R.salePrice||0),Ne=Number((Q*G).toFixed(2)),Me=Number((Q*se).toFixed(2));te.push({id:_e.id,productId:R.productId,productName:R.productName,category:R.category,unit:R.unit,quantity:Q,remaining:As(Number(R.remaining||0)),purchasePrice:G,salePrice:se,invoiceTotal:R.invoiceTotal!=null?Number(R.invoiceTotal):Ne,expectedTotal:R.expectedTotal!=null?Number(R.expectedTotal):Me,date:R.date,createdAt:R.createdAt,status:R.status,notes:R.notes,paidAmount:Number(R.paidAmount||0),paidAt:R.paidAt,batchGroupId:R.batchGroupId,orderName:R.orderName})}),l(te),u(!1)})()},[A]);const Te=g.useMemo(()=>o.filter(Ce=>!(v&&Ce.date<v||b&&Ce.date>b||j&&Ce.productId!==j)),[o,v,b,j]),ee=g.useMemo(()=>{if(!j)return"Todos";const Ce=a.find(Ae=>Ae.id===j);return Ce?`${Ce.name}  ${Ce.category}`:"Filtro activo"},[j,a]),me=g.useMemo(()=>{const Ce=Te.reduce((G,se)=>G+Number(se.invoiceTotal||0),0),Ae=Te.reduce((G,se)=>G+Number(se.expectedTotal||0),0);let Qe=0,fe=0,te=0,_e=0;for(const G of Te)Ze(G.unit)?(Qe+=G.quantity,fe+=G.remaining):(te+=G.quantity,_e+=G.remaining);const R=Te.reduce((G,se)=>G+se.quantity,0),Q=Te.reduce((G,se)=>G+se.remaining,0);return{lbsIng:Qe,lbsRem:fe,udsIng:te,udsRem:_e,qty:R,rem:Q,totalFacturado:Ce,totalEsperado:Ae}},[Te]),Re=g.useMemo(()=>{var Qe,fe;const Ce=new Map;for(const te of Te){const _e=te.batchGroupId&&String(te.batchGroupId).trim()||te.id;Ce.has(_e)||Ce.set(_e,[]),Ce.get(_e).push(te)}const Ae=[];for(const[te,_e]of Ce.entries()){const R=[..._e].sort((We,it)=>{var Rt,nr;const ot=((Rt=We.createdAt)==null?void 0:Rt.seconds)??0;return(((nr=it.createdAt)==null?void 0:nr.seconds)??0)-ot}),Q=((Qe=R[0])==null?void 0:Qe.date)||"",G=String(((fe=R[0])==null?void 0:fe.orderName)||"").trim()||`Pedido ${Q||""}`.trim()||"Pedido",se=new Set(R.map(We=>String(We.category||"").trim()).filter(Boolean)),Ne=se.size===1?Array.from(se)[0].toUpperCase():"MIXTO",Me=R.some(We=>We.status==="PENDIENTE")?"PENDIENTE":"PAGADO",ze=As(R.reduce((We,it)=>We+(Ze(it.unit)?Number(it.quantity||0):0),0)),Ie=As(R.reduce((We,it)=>We+(Ze(it.unit)?Number(it.remaining||0):0),0)),nt=As(R.reduce((We,it)=>We+(Ze(it.unit)?0:Number(it.quantity||0)),0)),lt=As(R.reduce((We,it)=>We+(Ze(it.unit)?0:Number(it.remaining||0)),0)),ht=Number(R.reduce((We,it)=>We+Number(it.invoiceTotal||0),0).toFixed(2)),kt=Number(R.reduce((We,it)=>We+Number(it.expectedTotal||0),0).toFixed(2)),le=Number((kt-ht).toFixed(2));Ae.push({groupId:te,orderName:G,date:Q,typeLabel:Ne,status:Me,lbsIn:ze,lbsRem:Ie,udsIn:nt,udsRem:lt,totalFacturado:ht,totalEsperado:kt,utilidadBruta:le,items:R})}return Ae.sort((te,_e)=>te.date===_e.date?te.groupId<_e.groupId?1:-1:te.date<_e.date?1:-1),Ae},[Te]),he=g.useMemo(()=>Ot==="all"?Re:Re.filter(Ce=>{const Ae=Ce.lbsRem>0||Ce.udsRem>0;return Ot==="with"?Ae:!Ae}),[Re,Ot]),qe=g.useMemo(()=>{const Ce=new Map;return he.forEach(Ae=>{const Qe=Ae.typeLabel||"MIXTO";Ce.has(Qe)||Ce.set(Qe,[]),Ce.get(Qe).push(Ae)}),Array.from(Ce.entries()).map(([Ae,Qe])=>({type:Ae,items:Qe}))},[he]),st=g.useMemo(()=>{const Ce=String(O||"").toLowerCase().trim();return a.filter(Qe=>String(Qe.measurement||"").toLowerCase().trim()===Ce).sort((Qe,fe)=>Qe.name.localeCompare(fe.name,"es"))},[a,O]);g.useEffect(()=>{const Ce=H.find(Qe=>Qe.productId===oe);if(Ce){ge(Number(Ce.quantity||0)),Oe(Number(Ce.purchasePrice||0)),F(Number(Ce.salePrice||0));return}const Ae=a.find(Qe=>Qe.id===oe);Ae?(ge(0),F(Number(Ae.price||0)),Ae.providerPrice!=null&&Number.isFinite(Number(Ae.providerPrice))?Oe(Number(Ae.providerPrice)):Oe(NaN)):(ge(0),F(0),Oe(NaN))},[oe,a,A,H]);const yt=()=>{f("");const Ce=a.find(Q=>Q.id===oe);if(!Ce)return f("Selecciona un producto.");if(ue<=0||!Number.isFinite(ne)||ne<=0)return f("Completa libras a ingresar y precio proveedor.");const Ae=As(ue),Qe=Ce.measurement,fe=Number((Ae*Number(ne||0)).toFixed(2)),te=Number((Ae*Number(Ue||0)).toFixed(2)),_e=Number((te-fe).toFixed(2)),R=H.findIndex(Q=>Q.productId===Ce.id);R>=0?K(Q=>Q.map((G,se)=>se!==R?G:{...G,quantity:Ae,remaining:Ae,purchasePrice:Number(ne||0),salePrice:Number(Ue||0),invoiceTotal:fe,expectedTotal:te,utilidadBruta:_e})):K(Q=>[...Q,{tempId:_5("IT"),productId:Ce.id,productName:Ce.name,category:Ce.category,unit:Qe,quantity:Ae,remaining:Ae,purchasePrice:Number(ne||0),salePrice:Number(Ue||0),invoiceTotal:fe,expectedTotal:te,utilidadBruta:_e}]),ce(""),ge(0),Oe(NaN),F(0)},pe=Ce=>{K(Ae=>Ae.filter(Qe=>Qe.tempId!==Ce))},je=(Ce,Ae,Qe)=>{K(fe=>fe.map(te=>{if(te.tempId!==Ce)return te;const _e={...te};return Ae==="quantity"&&(_e.quantity=As(Math.max(0,Qe)),U||(_e.remaining=_e.quantity)),Ae==="purchasePrice"&&(_e.purchasePrice=Math.max(0,Number(Qe||0))),Ae==="salePrice"&&(_e.salePrice=Math.max(0,Number(Qe||0))),_e.invoiceTotal=Number((_e.quantity*_e.purchasePrice).toFixed(2)),_e.expectedTotal=Number((_e.quantity*_e.salePrice).toFixed(2)),_e.utilidadBruta=Number((_e.expectedTotal-_e.invoiceTotal).toFixed(2)),_e}))},we=g.useMemo(()=>{const Ce=As(H.reduce((_e,R)=>_e+(Ze(R.unit)?Number(R.quantity||0):0),0)),Ae=As(H.reduce((_e,R)=>_e+(Ze(R.unit)?Number(R.remaining||0):0),0)),Qe=Number(H.reduce((_e,R)=>_e+Number(R.invoiceTotal||0),0).toFixed(2)),fe=Number(H.reduce((_e,R)=>_e+Number(R.expectedTotal||0),0).toFixed(2)),te=Number((fe-Qe).toFixed(2));return{lbsIn:Ce,lbsRem:Ae,totalFacturado:Qe,totalEsperado:fe,utilidadBruta:te}},[H]),Ye=()=>{W(null),D([]),B(""),P(Ur(new Date,"yyyy-MM-dd")),z("lb"),ce(""),ge(0),Oe(NaN),F(0),K([])},xe=async()=>{if(f(""),!H.length)return f("Agrega al menos un producto al pedido.");const Ce=k||Ur(new Date,"yyyy-MM-dd"),Ae=String(E||"").trim()||`Pedido ${Ce}`,Qe=U||_5("BATCH");try{if(!U){for(const R of H)await KV({productId:R.productId,productName:R.productName,category:R.category,unit:R.unit,quantity:As(R.quantity),purchasePrice:Number(R.purchasePrice||0),salePrice:Number(R.salePrice||0),invoiceTotal:Number(R.invoiceTotal||0),expectedTotal:Number(R.expectedTotal||0),date:Ce,notes:"",batchGroupId:Qe,orderName:Ae});f(" Pedido creado"),S(!1),Ye(),h();return}const fe=X,te=new Map;for(const R of fe)te.set(R.productId,R);const _e=new Set(H.map(R=>R.productId));for(const R of H){const Q=te.get(R.productId),G=As(R.quantity);if(Q){const se=As(Q.quantity-Q.remaining),Ne=Math.max(0,As(G-se));await Fn(er(Pe,"inventory_batches",Q.id),{date:Ce,orderName:Ae,batchGroupId:Qe,quantity:G,purchasePrice:Number(R.purchasePrice||0),salePrice:Number(R.salePrice||0),invoiceTotal:Number(R.invoiceTotal||0),expectedTotal:Number(R.expectedTotal||0),remaining:Ne})}else await KV({productId:R.productId,productName:R.productName,category:R.category,unit:R.unit,quantity:G,purchasePrice:Number(R.purchasePrice||0),salePrice:Number(R.salePrice||0),invoiceTotal:Number(R.invoiceTotal||0),expectedTotal:Number(R.expectedTotal||0),date:Ce,notes:"",batchGroupId:Qe,orderName:Ae})}for(const R of fe)_e.has(R.productId)||await qn(er(Pe,"inventory_batches",R.id));f(" Pedido actualizado"),S(!1),Ye(),h()}catch(fe){console.error(fe),f(" Error al guardar pedido")}},Se=Ce=>{L(Ce),Z(!0)},xt=Ce=>{W(Ce.groupId),D(Ce.items),B(Ce.orderName),P(Ce.date||Ur(new Date,"yyyy-MM-dd"));const Ae=Ce.items.map(Qe=>{const fe=Number(Qe.invoiceTotal||0),te=Number(Qe.expectedTotal||0);return{tempId:_5("IT"),productId:Qe.productId,productName:Qe.productName,category:Qe.category,unit:Qe.unit,quantity:As(Qe.quantity),remaining:As(Qe.remaining),purchasePrice:Number(Qe.purchasePrice||0),salePrice:Number(Qe.salePrice||0),invoiceTotal:fe,expectedTotal:te,utilidadBruta:Number((te-fe).toFixed(2))}});K(Ae),S(!0)},Pt=async Ce=>{if(confirm(`Eliminar el pedido "${Ce.orderName}" del ${Ce.date}?`))try{for(const Qe of Ce.items)await qn(er(Pe,"inventory_batches",Qe.id));f(" Pedido eliminado"),h()}catch(Qe){console.error(Qe),f(" Error al eliminar pedido")}},It=Ce=>{De(Ce),re(!0)},Ut=async()=>{if(J)try{for(const Ce of J.items){if(Ce.status!=="PENDIENTE")continue;await Qre(Ce.id),await Fn(er(Pe,"inventory_batches",Ce.id),{remaining:0});const Ae={date:Ce.date,productName:Ce.productName,quantity:Ce.quantity,amount:Number((Ce.expectedTotal??Ce.salePrice*Ce.quantity).toFixed(2)),allocations:[{batchId:Ce.id,qty:Ce.quantity,unitCost:Ce.purchasePrice,lineCost:Number((Ce.purchasePrice*Ce.quantity).toFixed(2))}],avgUnitCost:Ce.purchasePrice,measurement:Ce.unit,createdAt:xr.now(),autoGeneratedFromInventory:!0};await Zn(bt(Pe,"salesV2"),Ae)}f(" Pedido pagado y reflejado como venta"),h()}catch(Ce){console.error(Ce),f(" Error al pagar pedido")}finally{re(!1),De(null)}},Ht=()=>{re(!1),De(null)},Le=()=>{const Ce=new an({unit:"pt",format:"a4",orientation:"landscape"}),Ae="Inventario de Pollo",Qe=`Rango: ${v||"(sin inicio)"} a ${b||"(sin fin)"}`,fe=`Producto: ${ee}`,te=Q=>Number(Q||0).toFixed(3);let _e=40;Ce.setFontSize(16),Ce.text(Ae,40,_e),_e+=16,Ce.setFontSize(10),Ce.text(Qe,40,_e),_e+=12,Ce.text(fe,40,_e),_e+=14;const R=()=>{var Q;_e=(Q=Ce.lastAutoTable)!=null&&Q.finalY?Ce.lastAutoTable.finalY+18:_e+18};U0(Ce,{startY:_e,head:[["KPI","Valor"]],body:[["Libras ingresadas",te(me.lbsIng)],["Libras restantes",te(me.lbsRem)],["Unidades ingresadas",te(me.udsIng)],["Unidades restantes",te(me.udsRem)],["Total esperado",Ka(me.totalEsperado)],["Total facturado",Ka(me.totalFacturado)],["Ganancia sin gastos",Ka(me.totalEsperado-me.totalFacturado)],["Cantidad de lotes",Te.length.toString()]],styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),R(),U0(Ce,{startY:_e,head:[["Fecha","Pedido","Tipo","Lb In","Lb Rem","Ud In","Ud Rem","Facturado","Esperado","Utilidad","Estado"]],body:Re.map(Q=>[Q.date,Q.orderName,Q.typeLabel,te(Q.lbsIn),te(Q.lbsRem),te(Q.udsIn),te(Q.udsRem),Ka(Q.totalFacturado),Ka(Q.totalEsperado),Ka(Q.utilidadBruta),Q.status]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),R(),Re.forEach(Q=>{Ce.setFontSize(11),Ce.text(`Pedido: ${Q.orderName} (${Q.date})  ${Q.typeLabel}`,40,_e),_e+=12,U0(Ce,{startY:_e,head:[["Producto","Unidad","Ingresado","Restante","Precio compra","Precio venta","Total facturado","Total esperado","Utilidad","Estado"]],body:Q.items.map(G=>[G.productName,(G.unit||"").toUpperCase(),te(G.quantity),te(G.remaining),Ka(G.purchasePrice),Ka(G.salePrice),Ka(G.invoiceTotal||G.purchasePrice*G.quantity),Ka(G.expectedTotal||G.salePrice*G.quantity),Ka((G.expectedTotal||G.salePrice*G.quantity)-(G.invoiceTotal||G.purchasePrice*G.quantity)),G.status]),styles:{fontSize:8},headStyles:{fillColor:[230,230,230],textColor:[0,0,0]}}),R()}),Ce.save(`inventario_pollo_${v||"sin_desde"}_a_${b||"sin_hasta"}.pdf`)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-gray-900 text-white hover:bg-black",type:"button",onClick:Le,disabled:c,children:"Exportar PDF"}),x&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{Ye(),S(!0)},children:"Crear Lote"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:Ce=>y(Ce.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:b,onChange:Ce=>w(Ce.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:j,onChange:Ce=>I(Ce.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),a.map(Ce=>i.jsxs("option",{value:Ce.id,children:[Ce.name,"  ",Ce.category]},Ce.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{y(""),w(""),I("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(Oc,{onClick:()=>h(),loading:c})})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:[i.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:Bt,role:"button","aria-expanded":dt,children:[i.jsxs("div",{className:"flex gap-6 items-center",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",me.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",me.lbsRem.toFixed(3)]})]}),i.jsx("div",{className:"text-sm text-gray-500",children:dt?"Cerrar":"Ver ms"})]}),dt&&i.jsx("div",{className:"mt-3",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",me.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",me.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",me.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",me.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",me.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",me.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(me.totalEsperado-me.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",Te.length.toLocaleString()]})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx("div",{className:"flex gap-2",children:[{key:"all",label:"Todos"},{key:"with",label:"Con disponibilidad"},{key:"without",label:"Sin disponibilidad"}].map(Ce=>{const Ae=Ot===Ce.key;return i.jsx("button",{type:"button",onClick:()=>jt(Ce.key),className:`flex-1 px-3 py-2 rounded-xl text-sm font-semibold shadow ${Ae?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:Ce.label},Ce.key)})}),c?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow",children:"Cargando"}):he.length===0?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow text-center",children:Ot==="with"?"Sin lotes con disponibilidad.":Ot==="without"?"Sin lotes sin disponibilidad.":"Sin lotes"}):qe.map(({type:Ce,items:Ae})=>{const Qe=Qt[Ce]??!1;return i.jsxs("div",{className:"bg-white border rounded-2xl",children:[i.jsxs("button",{type:"button",onClick:()=>$e(Ce),className:"w-full px-4 py-3 flex items-center justify-between text-left",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:Ce}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ae.length," ",Ae.length===1?"lote":"lotes"]})]}),i.jsx("span",{className:"text-xs text-gray-500",children:Qe?"Cerrar":"Ver"})]}),Qe&&i.jsx("div",{className:"space-y-3 px-2 pb-4",children:Ae.map(fe=>{const te=ie===fe.groupId,_e=fe.lbsRem>0||fe.udsRem>0;return i.jsxs("div",{className:"bg-gray-50 border rounded-2xl",children:[i.jsxs("div",{className:"p-4 flex items-start justify-between gap-3 cursor-pointer",onClick:()=>Ge(fe.groupId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"font-semibold text-lg",children:[fe.date,i.jsxs("div",{className:"text-sm text-gray-500",children:["Producto: ",fe.typeLabel]})]}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Nombre: ",fe.orderName]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${fe.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:fe.status})})]}),i.jsxs("div",{className:"pb-4 p-4 flex items-start justify-between gap-1 cursor-pointer",children:[i.jsxs("div",{className:"px-2 py-1 rounded text-xs shrink-0 bg-green-100 font-semibold text-gray-700",children:["Ingresado: ",Fe(fe.lbsIn,fe.udsIn)]}),i.jsxs("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${_e?"bg-green-100 font-semibold text-gray-700":"bg-red-100 font-semibold text-red-700"}`,children:["Disponible: ",Fe(fe.lbsRem,fe.udsRem)]})]}),te&&i.jsxs("div",{className:"p-4 pt-0",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Tipo"}),i.jsx("div",{className:"font-semibold",children:fe.typeLabel})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Utilidad bruta"}),i.jsx("div",{className:"font-semibold",children:Ka(fe.utilidadBruta)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs ingresadas"}),i.jsx("div",{className:"font-semibold",children:fe.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs restantes"}),i.jsx("div",{className:"font-semibold",children:fe.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2 col-span-2",children:[i.jsxs("div",{className:"flex justify-between text-[11px] text-gray-500",children:[i.jsx("span",{children:"Total facturado"}),i.jsx("span",{children:"Total esperado"})]}),i.jsxs("div",{className:"flex justify-between font-semibold",children:[i.jsx("span",{children:Ka(fe.totalFacturado)}),i.jsx("span",{children:Ka(fe.totalEsperado)})]})]}),fe.items.length>0&&i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 col-span-2 border border-gray-100",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-2",children:"Productos asociados"}),i.jsx("div",{className:"space-y-1",children:fe.items.map(R=>i.jsxs("div",{className:"flex items-center text-xs justify-between gap-2",children:[i.jsx("div",{className:"font-semibold text-gray-800 truncate",children:R.productName}),i.jsxs("div",{className:"text-gray-600 text-right",children:[i.jsxs("div",{children:["Ingresado:"," ",R.quantity.toFixed(3)]}),i.jsxs("div",{children:["Restante:"," ",R.remaining.toFixed(3)]})]})]},R.id))})]})]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>Se(fe),children:"Ver detalle"}),p?i.jsxs(i.Fragment,{children:[fe.status==="PENDIENTE"&&i.jsx("button",{className:"px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm",onClick:()=>It(fe),children:"Pagar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-yellow-600 hover:bg-yellow-700 text-white text-sm",onClick:()=>xt(fe),children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm",onClick:()=>Pt(fe),children:"Borrar"})]}):null]})]})]},fe.groupId)})})]},Ce)})]}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Unidades ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Unidades restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:c?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):Re.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin lotes"})}):Re.map(Ce=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>Se(Ce),title:Ce.orderName,children:Ce.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:Ce.orderName})]}),i.jsx("td",{className:"p-2 border",children:Ce.typeLabel}),i.jsx("td",{className:"p-2 border",children:Ce.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.udsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.udsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ce.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Ce.status})}),i.jsx("td",{className:"p-2 border",children:p?i.jsxs("div",{className:"flex gap-2 justify-center",children:[Ce.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>It(Ce),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xt(Ce),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Pt(Ce),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},Ce.groupId))})]})}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),_&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:U?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:E,onChange:Ce=>B(Ce.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:k,onChange:Ce=>P(Ce.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:O,onChange:Ce=>{z(Ce.target.value),ce(""),ge(0),Oe(NaN),F(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:oe,onChange:Ce=>ce(Ce.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),st.map(Ce=>i.jsxs("option",{value:Ce.id,children:[Ce.name,"  ",Ce.category,"  ",Ce.measurement]},Ce.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ue===0?"":ue,onChange:Ce=>{const Ae=Ce.target.value.replace(",","."),Qe=parseFloat(Ae),fe=Number.isFinite(Qe)?parseFloat(Qe.toFixed(3)):0;ge(Math.max(0,fe));const te=H.find(_e=>_e.productId===oe);te&&je(te.tempId,"quantity",fe)},disabled:!oe})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Number.isNaN(ne)?"":ne,onChange:Ce=>{const Ae=Ce.target.value.replace(",",".");if(Ae==="")return Oe(NaN);const Qe=parseFloat(Ae),fe=Number.isFinite(Qe)?parseFloat(Qe.toFixed(2)):NaN;Oe(Number.isFinite(fe)?Math.max(0,fe):NaN);const te=H.find(_e=>_e.productId===oe);te&&Number.isFinite(fe)&&je(te.tempId,"purchasePrice",fe)},disabled:!oe})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Ue===0?"":Ue,onChange:Ce=>{const Ae=Ce.target.value.replace(",","."),Qe=parseFloat(Ae),fe=Number.isFinite(Qe)?parseFloat(Qe.toFixed(2)):0;F(Math.max(0,fe));const te=H.find(_e=>_e.productId===oe);te&&je(te.tempId,"salePrice",fe)},disabled:!oe})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:yt,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):H.map(Ce=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[Ce.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[Ce.category,"  ",Ce.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ce.quantity,onChange:Ae=>{const Qe=Ae.target.value.replace(",","."),fe=parseFloat(Qe),te=Number.isFinite(fe)?parseFloat(fe.toFixed(3)):0;je(Ce.tempId,"quantity",te)}})}),i.jsx("td",{className:"p-2 border",children:Number(Ce.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ce.purchasePrice,onChange:Ae=>{const Qe=Ae.target.value.replace(",","."),fe=parseFloat(Qe),te=Number.isFinite(fe)?parseFloat(fe.toFixed(2)):0;je(Ce.tempId,"purchasePrice",te)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ce.salePrice,onChange:Ae=>{const Qe=Ae.target.value.replace(",","."),fe=parseFloat(Qe),te=Number.isFinite(fe)?parseFloat(fe.toFixed(2)):0;je(Ce.tempId,"salePrice",te)}})}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>pe(Ce.tempId),children:"Quitar"})})]},Ce.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:we.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:we.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:Ka(we.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:Ka(we.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Ka(we.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:xe,disabled:H.length===0,children:U?"Editar pedido":"Crear pedido"})]})]})]}),document.body),V&&be&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{Z(!1),L(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:be.orderName})," "," ",be.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Z(!1),L(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:be.items.map(Ce=>{const Ae=Number(Ce.invoiceTotal||0),Qe=Number(Ce.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:Ce.productName}),i.jsx("td",{className:"p-2 border",children:(Ce.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Ce.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:Ka(Ce.salePrice)}),i.jsx("td",{className:"p-2 border",children:Ka(Ae)}),i.jsx("td",{className:"p-2 border",children:Ka(Qe)}),i.jsx("td",{className:"p-2 border",children:Ka(Qe-Ae)}),i.jsx("td",{className:"p-2 border",children:Ce.status})]},Ce.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:be.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:be.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Ka(be.utilidadBruta)})]})]})]})]}),document.body),Xe&&J&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Ht}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:J.orderName})," "," ",J.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:Ut,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:Ht,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const Bh=t=>`C$${(Number(t)||0).toFixed(2)}`;function E3e(){const t=awe(new Date),[e,r]=g.useState(Ur(t,"yyyy-MM")),[n,a]=g.useState([]),[s,o]=g.useState(!1),[l,c]=g.useState(""),u=g.useRef(null),d=g.useMemo(()=>{const[x,v]=e.split("-").map(w=>parseInt(w,10)),y=Ur(Ud(new Date(x,v-1,1)),"yyyy-MM-dd"),b=Ur(Ld(new Date(x,v-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),f=async()=>{o(!0);try{const x=await yPe(d.from,d.to),v=[];for(const y of x){const b=er(Pe,"inventory_batches",y.batchId),w=await zs(b);if(!w.exists())continue;const j=w.data();v.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:j.status??"PENDIENTE",purchasePrice:Number(j.purchasePrice||0),salePrice:Number(j.salePrice||0),supplier:j.supplier})}a(v)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};g.useEffect(()=>{f()},[e]);const A=async x=>{confirm("Marcar este lote como PAGADO?")&&(await Qre(x),a(y=>y.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=g.useMemo(()=>{const x=n.reduce((w,j)=>w+j.soldQty,0),v=n.reduce((w,j)=>w+j.soldAmount,0),y=n.reduce((w,j)=>w+j.soldQty*j.purchasePrice,0),b=v-y;return{q:x,amt:v,cogs:y,profit:b}},[n]),m=g.useMemo(()=>{const x=new Map;for(const v of n){const y=v.productName||"(sin nombre)";x.has(y)||x.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(y);b.qty+=v.soldQty,b.revenue+=v.soldAmount;const w=v.soldQty*v.purchasePrice;b.cogs+=w,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((v,y)=>v.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!u.current)return;const x=u.current;x.classList.add("force-pdf-colors");try{const[{default:v},{jsPDF:y}]=await Promise.all([iA(()=>Promise.resolve().then(()=>V6),void 0),iA(()=>Promise.resolve().then(()=>Kk),void 0)]),w=(await v(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),j=new y("p","mm","a4"),I=190,_=j.getImageProperties(w),S=I,E=_.height*S/_.width;j.addImage(w,"PNG",10,10,S,E),j.save(`liquidaciones_${e}.pdf`)}catch(v){console.error(v),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:f,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:u,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",Bh(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",Bh(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",Bh(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const v=x.soldQty*x.purchasePrice,y=x.soldAmount-v;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:Bh(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:Bh(v)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:Bh(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>A(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:Bh(x.revenue)}),i.jsx("td",{className:"p-2 border",children:Bh(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:Bh(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Zr=t=>`C$${Number(t??0).toFixed(2)}`,S3e=()=>Ur(new Date,"yyyy-MM-dd"),oa=t=>Number(t||0).toFixed(3);function I3e(){const[t,e]=g.useState(()=>{const fe=new Date,te=new Date(fe.getFullYear(),fe.getMonth(),1);return Ur(te,"yyyy-MM-dd")}),[r,n]=g.useState(S3e()),[a,s]=g.useState(!0),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState(!1),[m,p]=g.useState(null),[x,v]=g.useState(0),[y,b]=g.useState(0),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState({}),[B,k]=g.useState({}),{refreshKey:P,refresh:O}=Dc(),[z,oe]=g.useState({}),[ce,ue]=g.useState({}),[ge,ne]=g.useState(!1),Oe=()=>ne(fe=>!fe),[Ue,F]=g.useState(!1),H=()=>F(fe=>!fe),[K,U]=g.useState(!1),[W,X]=g.useState(!1),[D,V]=g.useState(!1),[Z,be]=g.useState(!1),[L,Xe]=g.useState(!1),[re,J]=g.useState(!1),De=()=>U(fe=>!fe),ie=()=>X(fe=>!fe),He=()=>V(fe=>!fe),Ge=()=>be(fe=>!fe),dt=()=>Xe(fe=>!fe),_t=()=>J(fe=>!fe),[Bt,Ot]=g.useState("");g.useEffect(()=>{(async()=>{s(!0);const te=sr(bt(Pe,"salesV2"),Ar("date",">=",t),Ar("date","<=",r)),_e=await $t(te),R=[];_e.forEach(Ne=>{const Me=Ne.data(),ze=Me.date??"";if(Array.isArray(Me.items)&&Me.items.length>0){Me.items.forEach((Ie,nt)=>{const lt=String(Ie.productName??"(sin nombre)"),ht=Number(Ie.qty??0),kt=Number(Ie.lineFinal??0)||Math.max(0,Number(Ie.unitPrice||0)*ht-Number(Ie.discount||0));R.push({id:`${Ne.id}#${nt}`,date:ze,productName:lt,quantity:ht,amount:kt,allocations:Array.isArray(Ie.allocations)?Ie.allocations:Me.allocations,avgUnitCost:Number(Ie.avgUnitCost??Me.avgUnitCost??0),measurement:Ie.measurement??Me.measurement??"",type:Me.type??"CONTADO"})});return}R.push({id:Ne.id,date:ze,productName:Me.productName??"(sin nombre)",quantity:Number(Me.quantity??0),amount:Number(Me.amount??Me.amountCharged??0),allocations:Array.isArray(Me.allocations)?Me.allocations:[],avgUnitCost:Number(Me.avgUnitCost??0),measurement:Me.measurement??"",type:Me.type??"CONTADO"})}),l(R);const Q=sr(bt(Pe,"expenses"),Ar("date",">=",t),Ar("date","<=",r)),G=await $t(Q),se=[];G.forEach(Ne=>{const Me=Ne.data();se.push({id:Ne.id,date:Me.date??"",category:Me.category??"(sin categora)",description:Me.description??"",amount:Number(Me.amount??0),status:Me.status??"PAGADO",createdAt:Me.createdAt})}),u(se),s(!1)})()},[t,r,P]),g.useMemo(()=>{const fe=o.reduce((G,se)=>G+(se.amount||0),0);let te=0;o.forEach(G=>{var se;(se=G.allocations)!=null&&se.length?te+=G.allocations.reduce((Ne,Me)=>Ne+Number(Me.lineCost||0),0):G.avgUnitCost&&G.quantity&&(te+=Number(G.avgUnitCost)*Number(G.quantity))});const _e=fe-te,R=c.reduce((G,se)=>G+(se.amount||0),0),Q=_e-R;return{revenue:fe,cogsReal:te,grossProfit:_e,expensesSum:R,netProfit:Q}},[o,c]);const jt=g.useMemo(()=>Bt?o.filter(fe=>(fe.productName||"")===Bt):o,[o,Bt]),Qt=g.useMemo(()=>{const fe=jt.reduce((G,se)=>G+(se.amount||0),0);let te=0;jt.forEach(G=>{var se;(se=G.allocations)!=null&&se.length?te+=G.allocations.reduce((Ne,Me)=>Ne+Number(Me.lineCost||0),0):G.avgUnitCost&&G.quantity&&(te+=Number(G.avgUnitCost)*Number(G.quantity))});const _e=fe-te,R=c.reduce((G,se)=>G+(se.amount||0),0),Q=_e-R;return{revenue:fe,cogsReal:te,grossProfit:_e,expensesSum:R,netProfit:Q}},[jt,c]),Ft=g.useMemo(()=>{const fe=jt.filter(se=>se.type==="CONTADO"),te=fe.reduce((se,Ne)=>se+(Ne.amount||0),0);let _e=0;fe.forEach(se=>{var Ne;(Ne=se.allocations)!=null&&Ne.length?_e+=se.allocations.reduce((Me,ze)=>Me+Number(ze.lineCost||0),0):se.avgUnitCost&&se.quantity&&(_e+=Number(se.avgUnitCost)*Number(se.quantity))});const R=te-_e,Q=c.reduce((se,Ne)=>se+(Ne.amount||0),0),G=R-Q;return{revenue:te,cogsReal:_e,grossProfit:R,expensesSum:Q,netProfit:G}},[jt,c]),$e=g.useMemo(()=>{const fe=jt.filter(Q=>Q.type==="CREDITO"),te=fe.reduce((Q,G)=>Q+(G.amount||0),0);let _e=0;fe.forEach(Q=>{var G;(G=Q.allocations)!=null&&G.length?_e+=Q.allocations.reduce((se,Ne)=>se+Number(Ne.lineCost||0),0):Q.avgUnitCost&&Q.quantity&&(_e+=Number(Q.avgUnitCost)*Number(Q.quantity))});const R=te-_e;return{revenue:te,cogsReal:_e,grossProfit:R}},[jt]),Fe=fe=>String(fe??"").toLowerCase().trim(),Ze=fe=>Number(fe.qty??fe.quantity??0),Te=fe=>["lb","lbs","libra","libras"].includes(Fe(fe)),ee=fe=>["unidad","unidades","ud","uds","pieza","piezas"].includes(Fe(fe)),me=fe=>fe?typeof fe=="string"?fe:fe!=null&&fe.toDate?Ur(fe.toDate(),"yyyy-MM-dd"):"":"";g.useEffect(()=>{(async()=>{h(!0);try{const te=await $t(bt(Pe,"customers_pollo")),_e={};te.forEach(Ee=>{const gt=Ee.data();_e[Ee.id]=String(gt.name??"(sin nombre)")});const R=await $t(bt(Pe,"ar_movements_pollo")),Q={},G={},se={},Ne={},Me={},ze=new Set,Ie={},nt={},lt={},ht={};let kt=0,le=0;const We=Ee=>{var gt;return Ee!=null&&Ee.date?String(Ee.date):(gt=Ee==null?void 0:Ee.createdAt)!=null&&gt.toDate?Ur(Ee.createdAt.toDate(),"yyyy-MM-dd"):""};R.forEach(Ee=>{var Xr,Ir,Pr;const gt=Ee.data(),Zt=String(gt.customerId??"").trim();if(!Zt)return;const Mr=Number(gt.amount??0);Q[Zt]=(Q[Zt]||0)+Mr;const Or=String(gt.type??"").toUpperCase(),ir=String(gt.debtStatus??gt.creditStatus??gt.cycleStatus??gt.status??"").toUpperCase().trim(),br=["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"].includes(ir),wr=gt.createdAt??null;if(Or==="ABONO"){kt+=Math.abs(Mr);const fn=We(gt);fn&&fn>=t&&fn<=r&&(le+=Math.abs(Mr));const de=(Xr=gt==null?void 0:gt.ref)!=null&&Xr.saleId?String(gt.ref.saleId):"";de?(Ie[de]=(Ie[de]||0)+Math.abs(Mr),fn&&fn>=t&&fn<=r&&(lt[de]=(lt[de]||0)+Math.abs(Mr)),ze.add(de)):(nt[Zt]=(nt[Zt]||0)+Math.abs(Mr),fn&&fn>=t&&fn<=r&&(ht[Zt]=(ht[Zt]||0)+Math.abs(Mr)));const tt=se[Zt],at=!(tt!=null&&tt.ts)||(wr!=null&&wr.toDate&&((Ir=tt.ts)!=null&&Ir.toDate)?wr.toDate()>tt.ts.toDate():!1);(!tt||at)&&(se[Zt]={amount:Math.abs(Mr),date:gt.date??"",ts:wr})}if(Or==="CARGO"){const fn=(Pr=gt==null?void 0:gt.ref)!=null&&Pr.saleId?String(gt.ref.saleId):"";fn&&(Ne[Zt]||(Ne[Zt]=new Set),Ne[Zt].add(fn),br||(Me[Zt]||(Me[Zt]=new Set),Me[Zt].add(fn)),ze.add(fn)),br||(G[Zt]=(G[Zt]||0)+Math.abs(Mr))}});const it=new Map;await Promise.all(Array.from(ze).map(async Ee=>{const gt=await zs(er(Pe,"salesV2",Ee));gt.exists()&&it.set(Ee,gt.data())}));let ot=0,Nt=0;const Rt=Ee=>{const gt=Number(Ee.qty??Ee.quantity??0);return Number(Ee.lineFinal??0)||Math.max(0,Number(Ee.unitPrice||0)*gt-Number(Ee.discount||0))},nr=Ee=>{if(Array.isArray(Ee.items)&&Ee.items.length>0){let Or=0,ir=0;return Ee.items.forEach(br=>{const wr=Number(br.qty??br.quantity??0);if(Or+=Rt(br),Array.isArray(br.allocations)&&br.allocations.length>0)ir+=br.allocations.reduce((Xr,Ir)=>Xr+Number(Ir.lineCost||0),0);else{const Xr=Number(br.avgUnitCost??Ee.avgUnitCost??0);ir+=Xr*wr}}),{total:Or,cogs:ir}}const gt=Number(Ee.quantity??0),Zt=Number(Ee.amount??Ee.amountCharged??0)||0;let Mr=0;return Array.isArray(Ee.allocations)&&Ee.allocations.length>0?Mr=Ee.allocations.reduce((Or,ir)=>Or+Number(ir.lineCost||0),0):Ee.avgUnitCost&&(Mr=Number(Ee.avgUnitCost)*gt),{total:Zt,cogs:Mr}},_r=new Map;it.forEach((Ee,gt)=>{const{total:Zt,cogs:Mr}=nr(Ee);_r.set(gt,{total:Zt,cogs:Mr,grossProfit:Zt-Mr})});const $r={},or={},kr={},en={};Object.keys(Ie).forEach(Ee=>{const gt=_r.get(Ee);if(!(gt!=null&&gt.total))return;const Zt=Number(Ie[Ee]||0);or[Ee]=Zt;const Mr=Math.min(1,Zt/gt.total),Or=gt.grossProfit*Mr;$r[Ee]=Or,ot+=Or}),Object.keys(lt).forEach(Ee=>{const gt=_r.get(Ee);if(!(gt!=null&&gt.total))return;const Zt=Number(lt[Ee]||0);en[Ee]=Zt;const Mr=Math.min(1,Zt/gt.total),Or=gt.grossProfit*Mr;kr[Ee]=Or,Nt+=Or}),Object.keys(nt).forEach(Ee=>{const gt=Ne[Ee];if(!gt||gt.size===0)return;let Zt=0,Mr=0,Or=0,ir=0;gt.forEach(Pr=>{const fn=_r.get(Pr);fn&&(Zt+=fn.total,Mr+=fn.grossProfit,or[Pr]&&(Or+=Math.min(fn.total,or[Pr])),ir+=$r[Pr]||0)});const br=Math.max(0,Zt-Or),wr=Math.max(0,Mr-ir);if(!br||!wr)return;const Xr=Number(nt[Ee]||0),Ir=Math.min(1,Xr/br);ot+=wr*Ir}),Object.keys(ht).forEach(Ee=>{const gt=Ne[Ee];if(!gt||gt.size===0)return;let Zt=0,Mr=0,Or=0,ir=0;gt.forEach(Pr=>{const fn=_r.get(Pr);fn&&(Zt+=fn.total,Mr+=fn.grossProfit,en[Pr]&&(Or+=Math.min(fn.total,en[Pr])),ir+=kr[Pr]||0)});const br=Math.max(0,Zt-Or),wr=Math.max(0,Mr-ir);if(!br||!wr)return;const Xr=Number(ht[Ee]||0),Ir=Math.min(1,Xr/br);Nt+=wr*Ir});const rn=[];Object.keys(Q).forEach(Ee=>{const gt=Number(Q[Ee]||0);if(gt<=0)return;const Zt=new Map;let Mr=0,Or=0,ir="";(Me[Ee]||new Set).forEach(Ir=>{const Pr=it.get(Ir);if(!Pr)return;const fn=String(Pr.date??"");fn&&(!ir||fn>ir)&&(ir=fn),(Array.isArray(Pr.items)&&Pr.items.length>0?Pr.items:[{productName:Pr.productName,qty:Pr.quantity,unitPrice:Pr.unitPrice,discount:Pr.discount,lineFinal:Pr.amount??Pr.amountCharged,measurement:Pr.measurement}]).forEach(tt=>{const at=String(tt.productName??"(sin nombre)"),ct=Number(tt.qty??tt.quantity??0),ye=String(tt.measurement??""),ft=Number(tt.lineFinal??0)||Math.max(0,Number(tt.unitPrice||0)*ct-Number(tt.discount||0));Te(ye)?Mr+=ct:Or+=ct;const St=`${at}||${ye}`,wt=Zt.get(St)||{productName:at,qty:0,amount:0,measurement:ye};wt.qty+=ct,wt.amount+=ft,Zt.set(St,wt)})});const wr=se[Ee],Xr=Number(G[Ee]||0);rn.push({customerId:Ee,name:_e[Ee]||"(sin nombre)",balance:gt,globalBalance:Xr>0?Xr:gt,lbs:Mr,units:Or,lastPaymentAmount:Number((wr==null?void 0:wr.amount)||0),lastSaleDate:ir||"",lastPaymentDate:me((wr==null?void 0:wr.ts)||(wr==null?void 0:wr.date)),products:Array.from(Zt.values()).sort((Ir,Pr)=>Ir.productName.localeCompare(Pr.productName))})});const Er=rn.filter(Ee=>Ee.products.length);Er.sort((Ee,gt)=>gt.balance-Ee.balance),f(Er),v(kt),b(le),j(ot),_(Nt)}catch(te){console.error("Error cargando saldos pendientes:",te),f([]),v(0),b(0),_(0)}finally{h(!1)}})()},[P,t,r]),g.useEffect(()=>{(async()=>{try{const te=await $t(sr(bt(Pe,"inventory_batches"))),_e=bS(t,"yyyy-MM-dd",new Date),R=bS(r,"yyyy-MM-dd",new Date),Q=Ur(Ud(_e),"yyyy-MM-dd"),G=Ur(Ld(R),"yyyy-MM-dd"),se={};te.forEach(Ne=>{var kt;const Me=Ne.data(),ze=String(Me.productName??"(sin nombre)"),Ie=Number(Me.quantity??0),nt=Number(Me.remaining??0),lt=(kt=Me==null?void 0:Me.date)!=null&&kt.toDate?Ur(Me.date.toDate(),"yyyy-MM-dd"):String((Me==null?void 0:Me.date)??(Me==null?void 0:Me.createdAt)??""),ht=lt&&lt>=Q&&lt<=G;se[ze]||(se[ze]={incomingQty:0,remainingQty:0}),ht&&(se[ze].incomingQty+=Ie),se[ze].remainingQty+=nt}),E(se)}catch(te){console.error("Error cargando inventario:",te),E({})}})()},[P,t,r]),g.useMemo(()=>o.reduce((fe,te)=>Te(te.measurement)?fe+Ze(te):fe,0),[o]),g.useMemo(()=>jt.reduce((fe,te)=>Te(te.measurement)?fe+Ze(te):fe,0),[jt]);const Re=g.useMemo(()=>jt.filter(fe=>fe.type==="CONTADO"),[jt]),he=g.useMemo(()=>jt.filter(fe=>fe.type==="CREDITO"),[jt]),qe=g.useMemo(()=>Re.reduce((fe,te)=>fe+(te.amount||0),0),[Re]),st=g.useMemo(()=>he.reduce((fe,te)=>fe+(te.amount||0),0),[he]),yt=g.useMemo(()=>d.reduce((fe,te)=>fe+Number(te.balance||0),0),[d]),pe=g.useMemo(()=>Ft.revenue,[Ft.revenue]),je=g.useMemo(()=>qe,[qe]),we=g.useMemo(()=>qe+y,[qe,y]),Ye=g.useMemo(()=>Ft.grossProfit+I,[Ft.grossProfit,I]),xe=g.useMemo(()=>Ft.netProfit+I,[Ft.netProfit,I]),Se=g.useMemo(()=>Re.reduce((fe,te)=>Te(te.measurement)?fe+Ze(te):fe,0),[Re]),xt=g.useMemo(()=>he.reduce((fe,te)=>Te(te.measurement)?fe+Ze(te):fe,0),[he]);g.useMemo(()=>o.reduce((fe,te)=>ee(te.measurement)?fe+Ze(te):fe,0),[o]),g.useMemo(()=>jt.reduce((fe,te)=>ee(te.measurement)?fe+Ze(te):fe,0),[jt]);const Pt=g.useMemo(()=>Re.reduce((fe,te)=>ee(te.measurement)?fe+Ze(te):fe,0),[Re]),It=g.useMemo(()=>he.reduce((fe,te)=>ee(te.measurement)?fe+Ze(te):fe,0),[he]),Ut=g.useMemo(()=>Array.from(new Set(o.map(fe=>fe.productName||"(sin nombre)"))).sort(),[o]),Ht=g.useMemo(()=>{var te;const fe=new Map;for(const _e of jt){const R=_e.productName||"(sin nombre)";fe.has(R)||fe.set(R,{productName:R,units:0,revenue:0,cogs:0,profit:0,firstDate:_e.date||"",lastDate:_e.date||""});const Q=fe.get(R);Q.units+=Number(_e.quantity||0),Q.revenue+=Number(_e.amount||0),(!Q.firstDate||_e.date<(Q.firstDate||_e.date))&&(Q.firstDate=_e.date),(!Q.lastDate||_e.date>(Q.lastDate||_e.date))&&(Q.lastDate=_e.date);let G=0;(te=_e.allocations)!=null&&te.length?G=_e.allocations.reduce((se,Ne)=>se+Number(Ne.lineCost||0),0):_e.avgUnitCost&&(G=Number(_e.avgUnitCost)*Number(_e.quantity||0)),Q.cogs+=G,Q.profit=Q.revenue-Q.cogs}return Array.from(fe.values()).sort((_e,R)=>_e.productName.localeCompare(R.productName))},[jt]),Le=g.useMemo(()=>[...Ht].sort((fe,te)=>te.units-fe.units).slice(0,3).map((fe,te)=>({idx:te+1,name:fe.productName,units:fe.units})),[Ht]),Ce=fe=>oe(te=>({...te,[fe]:!te[fe]})),Ae=fe=>ue(te=>({...te,[fe]:!te[fe]})),Qe=()=>{const fe=new an({unit:"pt",format:"a4"}),te="Dashboard Financiero",_e=`Rango: ${t} a ${r}`,R=Bt?`Producto: ${Bt}`:"Producto: Todos";fe.setFontSize(16),fe.text(te,40,40),fe.setFontSize(10),fe.text(_e,40,58),fe.text(R,40,72);let Q=90;const G=()=>{var Ne;Q=(Ne=fe.lastAutoTable)!=null&&Ne.finalY?fe.lastAutoTable.finalY+18:Q+18},se=(Ne,Me)=>{Me.length&&(fe.setFontSize(11),fe.text(Ne,40,Q),Q+=12,U0(fe,{startY:Q,head:[["KPI","Valor"]],body:Me,styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),G())};se("KPIs Generales",[["Ventas (rango)",Zr(Qt.revenue)],["Costo",Zr(Qt.cogsReal)],["Utilidad Bruta",Zr(Qt.grossProfit)],["Gastos",Zr(Qt.expensesSum)],["Utilidad Neta",Zr(Qt.netProfit)]]),se("KPIs Cash",[["Ventas Cash",Zr(pe)],["Costo Cash",Zr(Ft.cogsReal)],["Utilidad Bruta Cash",Zr(Ft.grossProfit)]]),se("KPIs Crdito",[["Ventas Crdito",Zr($e.revenue)],["Costo Crdito",Zr($e.cogsReal)],["Utilidad Bruta Crdito",Zr($e.grossProfit)]]),se("Fondos y Utilidades",[["CxC",Zr(yt)],["Recaudacin (Abonos)",Zr(x)],["Recaudacin a la fecha",Zr(y)],["Recolectado Cash + Abonos",Zr(we)],["Utilidad Neta Crdito (Caja)",Zr(I)],["Utilidad Bruta Cash + Crdito",Zr(Ye)],["Gastos",Zr(Ft.expensesSum)],["Utilidad Neta Cash + Crdito",Zr(xe)]]),se("KPIs de Volumen y Ventas",[["Ventas Cash",Zr(je)],["Ventas Crdito",Zr(st)],["Libras Cash",oa(Se)],["Libras Crdito",oa(xt)],["Libras Cash + Crdito",oa(Se+xt)],["Unidades Cash",oa(Pt)],["Unidades Crdito",oa(It)],["Unidades Cash + Crdito",oa(Pt+It)]]),Le.length>0&&(fe.setFontSize(11),fe.text("Top productos por unidades",40,Q),Q+=12,U0(fe,{startY:Q,head:[["#","Producto","Cantidad"]],body:Le.map(Ne=>[String(Ne.idx),Ne.name,oa(Ne.units)]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),G()),U0(fe,{startY:Q,head:[["Cliente","Libras","Unidades","Saldo Global","ltimo abono","Saldo pendiente","Fecha ult. abono"]],body:d.map(Ne=>[Ne.name,oa(Ne.lbs),oa(Ne.units),Zr(Ne.globalBalance),Zr(Ne.lastPaymentAmount),Zr(Ne.balance),Ne.lastPaymentDate||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]},didDrawPage:Ne=>{Ne.pageNumber>1&&(fe.setFontSize(10),fe.text(te,40,30))}}),G(),U0(fe,{startY:Q,head:[["Producto","Ingresado","Disponibilidad","Fechas","Cantidad","Venta","Costo","Utilidad"]],body:Ht.map(Ne=>{var Me,ze;return[Ne.productName,oa(((Me=S[Ne.productName])==null?void 0:Me.incomingQty)||0),oa(((ze=S[Ne.productName])==null?void 0:ze.remainingQty)||0),Ne.firstDate&&Ne.lastDate?Ne.firstDate===Ne.lastDate?Ne.firstDate:`${Ne.firstDate}  ${Ne.lastDate}`:"",oa(Ne.units),Zr(Ne.revenue),Zr(Ne.cogs),Zr(Ne.profit)]}),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),G(),U0(fe,{startY:Q,head:[["Fecha","Categora","Descripcin","Monto","Estado"]],body:c.map(Ne=>[Ne.date,Ne.category,Ne.description||"",Zr(Ne.amount),Ne.status||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),fe.save(`dashboard_${t}_a_${r}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Dashboard Financiero"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",onClick:Qe,className:"px-3 py-2 rounded-lg text-sm bg-gray-900 text-white hover:bg-black",children:"Exportar PDF"}),i.jsx(Oc,{onClick:O,loading:a})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:fe=>e(fe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:fe=>n(fe.target.value)})]})]}),a?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:De,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Kpi Financiero"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Ventas: ",i.jsx("b",{children:Zr(Qt.revenue)}),"  Utilidad Neta:"," ",i.jsx("b",{children:Zr(Qt.netProfit)})]})]}),i.jsx("div",{className:"text-gray-500",children:K?"Cerrar":"Ver"})]}),K&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"flex gap-2 mb-2 items-center",children:i.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:Bt,onChange:fe=>Ot(fe.target.value),children:[i.jsx("option",{value:"",children:"Todos los productos"}),Ut.map(fe=>i.jsx("option",{value:fe,children:fe},fe))]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:Ge,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Ventas cash - Credito"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Resumen"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:Z?"Cerrar":"Ver"})]}),Z&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"Ventas",subtitle:"Ventas cash",value:Zr(pe),valueClass:"text-[#1E4D2B]"}),i.jsx(ss,{title:"Costo",value:Zr(Ft.cogsReal)}),i.jsx(ss,{title:"Utilidad Bruta Cash",value:Zr(Ft.grossProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"Ventas Crdito",value:Zr($e.revenue)}),i.jsx(ss,{title:"Costo",value:Zr($e.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Crdito",value:Zr($e.grossProfit),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:dt,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Fondos"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Liquidez"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:L?"Cerrar":"Ver"})]}),L&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"CxC",value:Zr(yt)}),i.jsx(ss,{title:"Recaudacin Global(Abonos)",value:Zr(x)}),i.jsx(ss,{title:"Recaudacin a la fecha",value:Zr(y)}),i.jsx(ss,{title:"Recolectado Cash + Abonos",value:Zr(we),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ss,{title:"Utilidad Neta Crdito (Caja)",value:Zr(I),valueClass:"text-[#BF5700]"}),i.jsx(ss,{title:"Utilidad Bruta Cash + Crdito",value:Zr(Ye),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ss,{title:"Gastos",value:Zr(Ft.expensesSum),negative:!0}),i.jsx(ss,{title:"Utilidad Neta Cash + Crdito",value:Zr(xe),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:_t,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Detalles"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Mtricas adicionales"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:re?"Cerrar":"Ver"})]}),re&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Ventas Cash",value:Zr(je)}),i.jsx(Kl,{title:"Ventas Crdito",value:Zr(st)}),i.jsx(Kl,{title:"Libras Cash",value:oa(Se)}),i.jsx(Kl,{title:"Libras Crdito",value:oa(xt)}),i.jsx(Kl,{title:"Unidades Cash",value:oa(Pt)}),i.jsx(Kl,{title:"Unidades Crdito",value:oa(It)})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Libras Cash + Credito",value:oa(Se+xt)}),i.jsx(Kl,{title:"Unidades Cash + Credito",value:oa(Pt+It)}),i.jsx(sH,{title:"Productos ms vendidos",items:Le.map(fe=>({key:`${fe.idx}`,label:`${fe.idx}. ${fe.name}`,value:`(${oa(fe.units)})`}))})]})]})]})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Ventas Cash",value:Zr(pe),positive:!0}),i.jsx(ss,{title:"Costo",value:Zr(Ft.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Cash",value:Zr(Ft.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Ventas Crdito",value:Zr($e.revenue),positive:!0}),i.jsx(ss,{title:"Costo",value:Zr($e.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Crdito",value:Zr($e.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"CxC",value:Zr(yt),negative:!0}),i.jsx(ss,{title:"Recaudacin Global(Abonos)",value:Zr(x),positive:!0}),i.jsx(ss,{title:"Recaudacin a la fecha",value:Zr(y),positive:!0}),i.jsx(ss,{title:"Recolectado Cash + Abonos",value:Zr(we),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-4 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Utilidad Neta Crdito (Caja)",value:Zr(I),valueClass:"text-[#BF5700]"}),i.jsx(ss,{title:"Utilidad Bruta Cash + Crdito",value:Zr(Ye),positive:!0}),i.jsx(ss,{title:"Gastos",value:Zr(Ft.expensesSum),negative:!0}),i.jsx(ss,{title:"Utilidad Neta Cash + Crdito",value:Zr(xe),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Ventas Cash",value:Zr(je)}),i.jsx(Kl,{title:"Ventas Crdito",value:Zr(st)}),i.jsx(Kl,{title:"Libras Cash",value:oa(Se)}),i.jsx(Kl,{title:"Libras Crdito",value:oa(xt)}),i.jsx(Kl,{title:"Unidades Cash",value:oa(Pt)}),i.jsx(Kl,{title:"Unidades Crdito",value:oa(It)})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Libras Cash + Credito",value:oa(Se+xt)}),i.jsx(Kl,{title:"Unidades Cash + Credito",value:oa(Pt+It)}),i.jsx(sH,{title:"Productos ms vendidos",items:Le.map(fe=>({key:`${fe.idx}`,label:`${fe.idx}. ${fe.name}`,value:`(${oa(fe.units)})`}))})]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:ie,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Saldos pendientes"}),i.jsx("div",{className:"text-gray-500",children:W?"Cerrar":"Ver"})]}),W&&i.jsx("div",{className:"border rounded-2xl p-3 sm:p-4 bg-gray-50 mt-3",children:A?i.jsx("div",{className:"text-sm text-gray-600",children:"Cargando saldos"}):d.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"Sin saldos pendientes."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-white",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Libras"}),i.jsx("th",{className:"border p-2",children:"Unidades"}),i.jsx("th",{className:"border p-2",children:"Saldo Global"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:d.map(fe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1 text-left",children:fe.name}),i.jsx("td",{className:"border p-1",children:oa(fe.lbs)}),i.jsx("td",{className:"border p-1",children:oa(fe.units)}),i.jsx("td",{className:"border p-1",children:Zr(fe.globalBalance)}),i.jsx("td",{className:"border p-1",children:Zr(fe.lastPaymentAmount)}),i.jsx("td",{className:"border p-1",children:Zr(fe.balance)}),i.jsx("td",{className:"border p-1",children:fe.lastPaymentDate||""}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",onClick:()=>p(fe),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},fe.customerId))})]})})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:He,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Ventas y Gastos"}),i.jsx("div",{className:"text-gray-500",children:D?"Cerrar":"Ver"})]}),D&&i.jsxs("div",{className:"mt-3",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Ingresado Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Disponibilidad"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"}),i.jsx("th",{className:"border p-2",children:"Cantidad Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[Ht.map(fe=>{var te,_e;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:fe.productName}),i.jsx("td",{className:"border p-1",children:oa(((te=S[fe.productName])==null?void 0:te.incomingQty)||0)}),i.jsx("td",{className:"border p-1",children:oa(((_e=S[fe.productName])==null?void 0:_e.remainingQty)||0)}),i.jsx("td",{className:"border p-1",children:fe.firstDate&&fe.lastDate?fe.firstDate===fe.lastDate?fe.firstDate:`${fe.firstDate}  ${fe.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:oa(fe.units)}),i.jsx("td",{className:"border p-1",children:Zr(fe.revenue)}),i.jsx("td",{className:"border p-1",children:Zr(fe.cogs)}),i.jsx("td",{className:`border p-1 ${fe.profit>=0?"text-green-700":"text-red-700"}`,children:Zr(fe.profit)})]},fe.productName)}),Ht.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:Oe,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Ventas por producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Ht.length," productos"]})]}),i.jsx("div",{className:"text-gray-500",children:ge?"Cerrar":"Ver"})]}),ge&&i.jsx("div",{className:"space-y-2 mt-3",children:Ht.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin datos en el rango seleccionado."}):Ht.map(fe=>{var R,Q,G,se;const te=!!z[fe.productName],_e=fe.firstDate&&fe.lastDate?fe.firstDate===fe.lastDate?fe.firstDate:`${fe.firstDate}  ${fe.lastDate}`:"";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>Ce(fe.productName),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:fe.productName}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Libras/Unidades"}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendidas: ",i.jsx("b",{children:oa(fe.units)}),"  Disponible:"," ",i.jsx("b",{className:((R=S[fe.productName])==null?void 0:R.remainingQty)>0?"text-green-700":"text-red-700",children:oa(((Q=S[fe.productName])==null?void 0:Q.remainingQty)||0)})]})]}),i.jsx("div",{className:"text-gray-500 text-xs pt-0.10",children:te?"Cerrar":"Ver"})]}),te&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx(rd,{label:"Lb/Un Ingresadas",value:oa(((G=S[fe.productName])==null?void 0:G.incomingQty)||0)}),i.jsx(rd,{label:"Lb/Un Disponibles",value:oa(((se=S[fe.productName])==null?void 0:se.remainingQty)||0)}),i.jsx(rd,{label:"Fechas Venta",value:_e}),i.jsx(rd,{label:"Lb/Un Vendidas",value:oa(fe.units)}),i.jsx(rd,{label:"Facturado al costo",value:Zr(fe.cogs)}),i.jsx(rd,{label:"Monto Venta",value:Zr(fe.revenue)}),i.jsx(rd,{label:"Utilidad bruta",value:Zr(fe.profit),valueClass:fe.profit>=0?"text-green-700 font-semibold":"text-red-700 font-semibold"})]})})]},fe.productName)})})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(fe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:fe.date}),i.jsx("td",{className:"border p-1",children:fe.category}),i.jsx("td",{className:"border p-1",children:fe.description}),i.jsx("td",{className:"border p-1",children:Zr(fe.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${fe.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:fe.status})})]},fe.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:H,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Gastos del periodo"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[c.length," registros"]})]}),i.jsx("div",{className:"text-gray-500",children:Ue?"Cerrar":"Abrir"})]}),Ue&&i.jsx("div",{className:"space-y-2 mt-3",children:c.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin gastos en el rango seleccionado."}):c.map(fe=>{const te=!!ce[fe.id],_e=fe.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>Ae(fe.id),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:fe.category}),i.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] ${_e}`,children:fe.status})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[fe.date,"  ",i.jsx("b",{children:Zr(fe.amount)})]})]}),i.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:te?"Cerrar":"Ver"})]}),te&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsx(rd,{label:"Fecha",value:fe.date}),i.jsx(rd,{label:"Categora",value:fe.category}),i.jsx(rd,{label:"Descripcin",value:fe.description||""}),i.jsx(rd,{label:"Monto",value:Zr(fe.amount)}),i.jsx(rd,{label:"Estado",value:fe.status||""})]})})]},fe.id)})})]})]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:m.name}),i.jsx("button",{type:"button",onClick:()=>p(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras/Unidades"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"})]})}),i.jsx("tbody",{children:m.products.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin productos asociados."})}):m.products.map(fe=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1",children:fe.productName}),i.jsx("td",{className:"border p-1 text-center",children:oa(fe.qty)}),i.jsx("td",{className:"border p-1 text-center",children:Zr(fe.amount)}),i.jsx("td",{className:"border p-1 text-center",children:m.lastSaleDate||""})]},`${fe.productName}-${fe.measurement}`))})]})})]})})]})}function ss({title:t,value:e,positive:r,negative:n,valueClass:a,subtitle:s}){const o=a||(r?"text-[#568203]":n?"text-[#AB274F]":"");return i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),s?i.jsx("div",{className:"text-[11px] sm:text-[12px] text-gray-400",children:s}):null,i.jsx("div",{className:`text-[26px] sm:text-[30px] font-bold ${o}`,children:e})]})}function Kl({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[18px] sm:text-[20px] font-semibold",children:e})]})}function sH({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}function rd({label:t,value:e,valueClass:r}){return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:t}),i.jsx("div",{className:`text-sm mt-0.5 ${r||""}`,children:e})]})}const LC=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],hx=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function j3e(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[o,l]=g.useState(Ur(new Date,"yyyy-MM-dd")),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState("PENDIENTE"),[x,v]=g.useState(""),[y,b]=g.useState([]),[w,j]=g.useState(!0),[I,_]=g.useState(""),[S,E]=g.useState(null),[B,k]=g.useState(""),[P,O]=g.useState(""),[z,oe]=g.useState(""),[ce,ue]=g.useState(0),[ge,ne]=g.useState("PENDIENTE"),[Oe,Ue]=g.useState(""),[F,H]=g.useState(!1),K=()=>H(ie=>!ie),[U,W]=g.useState(null),X=ie=>W(He=>He===ie?null:ie);g.useEffect(()=>{(async()=>{j(!0),_("");try{const ie=sr(bt(Pe,"expenses"),In("date","desc")),He=await $t(ie),Ge=[];He.forEach(dt=>{const _t=dt.data();Ge.push({id:dt.id,date:_t.date||Ur(new Date,"yyyy-MM-dd"),category:_t.category||"",description:_t.description||"",amount:Number(_t.amount||0),status:_t.status||"PENDIENTE",notes:_t.notes||"",createdAt:_t.createdAt??xr.now()})}),b(Ge)}catch(ie){console.error(ie),_(" Error al cargar gastos")}finally{j(!1)}})()},[t]);const D=g.useMemo(()=>y.filter(ie=>!(r&&ie.date<r||a&&ie.date>a)),[y,r,a]),V=g.useMemo(()=>{const ie=D.reduce((dt,_t)=>dt+(_t.amount||0),0),He=D.filter(dt=>dt.status==="PAGADO").reduce((dt,_t)=>dt+(_t.amount||0),0),Ge=ie-He;return{total:ie,pagado:He,pendiente:Ge}},[D]),Z=()=>{l(Ur(new Date,"yyyy-MM-dd")),u(""),f(""),h(0),p("PENDIENTE"),v("")},be=async ie=>{if(ie.preventDefault(),_(""),!c)return _("Selecciona una categora.");if(!d.trim())return _("Ingresa una descripcin.");if(!A||A<=0)return _("Ingresa un monto vlido.");try{const He={date:o,category:c,description:d.trim(),amount:Number(Number(A||0).toFixed(2)),status:m,notes:x||"",createdAt:xr.now()},Ge=await Zn(bt(Pe,"expenses"),He);b(dt=>[{id:Ge.id,...He},...dt]),Z(),_(" Gasto registrado")}catch(He){console.error(He),_(" Error al guardar gasto")}},L=ie=>{_(""),E(ie.id),k(ie.date),O(ie.category||""),oe(ie.description||""),ue(Number(ie.amount||0)),ne(ie.status||"PENDIENTE"),Ue(ie.notes||"")},Xe=()=>{E(null),k(""),O(""),oe(""),ue(0),ne("PENDIENTE"),Ue("")},re=async()=>{if(S){if(!P)return _("Selecciona una categora.");if(!z.trim())return _("Ingresa una descripcin.");if(!ce||ce<=0)return _("Ingresa un monto vlido.");try{const ie={date:B,category:P,description:z.trim(),amount:Number(Number(ce||0).toFixed(2)),status:ge,notes:Oe||""};await Fn(er(Pe,"expenses",S),ie),b(He=>He.map(Ge=>Ge.id===S?{...Ge,...ie}:Ge)),Xe(),_(" Gasto actualizado")}catch(ie){console.error(ie),_(" Error al actualizar gasto")}}},J=async ie=>{if(confirm(`Eliminar el gasto "${ie.description}"?`))try{await qn(er(Pe,"expenses",ie.id)),b(Ge=>Ge.filter(dt=>dt.id!==ie.id)),_(" Gasto borrado")}catch(Ge){console.error(Ge),_(" Error al borrar gasto")}},De=ie=>ie==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Gastos (Pollo)"}),i.jsx(Oc,{onClick:e,loading:w})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:ie=>n(ie.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:ie=>s(ie.target.value)})]})]}),i.jsxs("div",{className:"sm:ml-auto text-sm bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",hx(V.total)]}),i.jsxs("div",{children:["Pagado: ",hx(V.pagado)]}),i.jsxs("div",{children:["Pendiente: ",hx(V.pendiente)]})]})]}),i.jsxs("div",{className:"md:hidden mb-4",children:[i.jsxs("button",{type:"button",onClick:K,className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white border rounded-2xl",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Crear gasto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha: ",o,"  Monto: ",A===0?"":hx(A)]})]}),i.jsx("div",{className:"text-gray-500",children:F?"":""})]}),F&&i.jsxs("form",{onSubmit:be,className:"mt-3 bg-white p-4 rounded-2xl shadow-2xl border grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:ie=>l(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:ie=>u(ie.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(ie=>i.jsx("option",{value:ie,children:ie},ie))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:ie=>f(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:ie=>{const He=String(ie.target.value||"").replace(",","."),Ge=parseFloat(He);h(Number.isFinite(Ge)?Math.max(0,Ge):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ie=>p(ie.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:x,onChange:ie=>v(ie.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[x.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:Z,children:"Limpiar"})]})]})]}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("form",{onSubmit:be,className:"bg-white p-4 rounded-2xl shadow-2xl border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:ie=>l(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:ie=>u(ie.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(ie=>i.jsx("option",{value:ie,children:ie},ie))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:ie=>f(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:ie=>{const He=String(ie.target.value||"").replace(",","."),Ge=parseFloat(He);h(Number.isFinite(Ge)?Math.max(0,Ge):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ie=>p(ie.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:x,onChange:ie=>v(ie.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[x.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:Z,children:"Limpiar"})]})]})}),i.jsx("div",{className:"block md:hidden space-y-3",children:w?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):D.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin gastos en el rango seleccionado."}):D.map(ie=>{const He=U===ie.id,Ge=S===ie.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full text-left px-3 py-3 flex items-start justify-between bg-white",onClick:()=>X(ie.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ie.description}),i.jsxs("div",{className:"text-xs text-gray-500",children:[ie.category||"","  ",ie.date]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold",children:hx(ie.amount)}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${De(ie.status)}`,children:ie.status})]})]}),He&&i.jsxs("div",{className:"p-3",children:[i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:ie.notes?ie.notes:""}),Ge?i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm",children:[i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:dt=>k(dt.target.value)}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:dt=>O(dt.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(dt=>i.jsx("option",{value:dt,children:dt},dt))]}),i.jsx("input",{className:"w-full border p-2 rounded",value:z,onChange:dt=>oe(dt.target.value)}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(ce)?"":ce,onChange:dt=>{const _t=String(dt.target.value||"").replace(",","."),Bt=parseFloat(_t);ue(Number.isFinite(Bt)?Math.max(0,Bt):0)}}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ge,onChange:dt=>ne(dt.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Oe,onChange:dt=>Ue(dt.target.value),maxLength:500}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:re,children:"Guardar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Xe,children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>L(ie),children:"Editar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>J(ie),children:"Borrar"})]})]})]},ie.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded-2xl shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):D.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):D.map(ie=>{const He=S===ie.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:He?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:Ge=>k(Ge.target.value)}):ie.date}),i.jsx("td",{className:"p-2 border",children:He?i.jsxs("select",{className:"w-full border p-1 rounded",value:P,onChange:Ge=>O(Ge.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(Ge=>i.jsx("option",{value:Ge,children:Ge},Ge))]}):ie.category||""}),i.jsx("td",{className:"p-2 border",children:He?i.jsx("input",{className:"w-full border p-1 rounded",value:z,onChange:Ge=>oe(Ge.target.value)}):i.jsx("span",{title:ie.description,children:ie.description.length>45?ie.description.slice(0,45)+"":ie.description})}),i.jsx("td",{className:"p-2 border",children:He?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ce)?"":ce,onChange:Ge=>{const dt=String(Ge.target.value||"").replace(",","."),_t=parseFloat(dt);ue(Number.isFinite(_t)?Math.max(0,_t):0)}}):hx(ie.amount)}),i.jsx("td",{className:"p-2 border",children:He?i.jsxs("select",{className:"w-full border p-1 rounded",value:ge,onChange:Ge=>ne(Ge.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${De(ie.status)}`,children:ie.status})}),i.jsx("td",{className:"p-2 border",children:He?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Oe,onChange:Ge=>Ue(Ge.target.value),maxLength:500}):i.jsx("span",{title:ie.notes||"",children:(ie.notes||"").length>45?(ie.notes||"").slice(0,45)+"":ie.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:He?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:re,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Xe,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>L(ie),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>J(ie),children:"Borrar"})]})})})]},ie.id)})})]})}),I&&i.jsx("p",{className:"mt-2 text-sm",children:I})]})}function LS(t){return(t||"").trim().toLowerCase()}async function one(){const t=await $t(bt(Pe,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),a=LS(n.name??n.productName);a&&e.set(a,r.id)}),e}async function P3e(t=!1){const e=await one(),r=await $t(bt(Pe,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const a of r.docs){n.checked++;const s=a.data(),o=LS(s.productName);if(!o){n.missingName++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"withoutMatch"});continue}if(s.productId===l){n.alreadyOk++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"alreadyOk"});continue}t||await Fn(er(Pe,"inventory_batches",a.id),{productId:l}),n.fixed++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function B3e(t,e=!1){const r=LS(t),a=(await one()).get(r);if(!a)throw new Error(`No existe un producto activo con nombre "${t}".`);const s=await $t(bt(Pe,"inventory_batches"));let o=0;for(const l of s.docs){const c=l.data();LS(c.productName)===r&&c.productId!==a&&(e||await Fn(er(Pe,"inventory_batches",l.id),{productId:a}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function T3e(){const[t,e]=g.useState(!1),[r,n]=g.useState(""),a=async()=>{try{e(!0),n("");const c=await P3e(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[s,o]=g.useState(""),l=async()=>{if(!s.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await B3e(s.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${s}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:s,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const Nu=t=>`C$${Number(t||0).toFixed(2)}`,Ax=t=>Number(t||0).toFixed(3),k3e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),E5=()=>{const t=new Date;return Ur(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},UC=()=>Ur(new Date,"yyyy-MM-dd");function F3e({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState(E5()),[o,l]=g.useState(UC()),[c,u]=g.useState(""),d=g.useMemo(()=>{const Te=new Map;return n.forEach(ee=>Te.set(ee.productId,{id:ee.productId,name:ee.productName})),Array.from(Te.values()).sort((ee,me)=>ee.name.localeCompare(me.name))},[n]),f=g.useMemo(()=>n.filter(Te=>!(a&&Te.date<a||o&&Te.date>o||c&&Te.productId!==c)),[n,a,o,c]),[A,h]=g.useState(UC()),[m,p]=g.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,v]=g.useState(""),[y,b]=g.useState([]);g.useEffect(()=>{b(Te=>{const ee=Te.filter(me=>f.some(Re=>Re.id===me));return ee.length===0&&f.length>0?f.map(me=>me.id):ee})},[f]);const[w,j]=g.useState([]),[I,_]=g.useState([]),[S,E]=g.useState(!1),[B,k]=g.useState(E5()),[P,O]=g.useState(UC());g.useEffect(()=>{(async()=>{try{E(!0);const Te=sr(bt(Pe,"expenses"),In("date","desc")),ee=await $t(Te),me=[];ee.forEach(Re=>{const he=Re.data();me.push({id:Re.id,date:he.date,description:he.description,amount:Number(he.amount||0)})}),j(me)}catch(Te){console.error(Te)}finally{E(!1)}})()},[]);const z=g.useMemo(()=>w.filter(Te=>!(!Te.date||B&&Te.date<B||P&&Te.date>P)),[w,B,P]),[oe,ce]=g.useState([]),[ue,ge]=g.useState(!1),[ne,Oe]=g.useState(""),[Ue,F]=g.useState("DEBITO"),[H,K]=g.useState(""),U=()=>{const Te=Number(H);!ne.trim()||!isFinite(Te)||Te<=0||(ce(ee=>[...ee,{id:`${Date.now()}_${ee.length+1}`,description:ne.trim(),type:Ue,amount:Number(Te.toFixed(2))}]),Oe(""),K(""))},[W,X]=g.useState(null),[D,V]=g.useState(""),[Z,be]=g.useState("DEBITO"),[L,Xe]=g.useState(""),re=Te=>{X(Te.id),V(Te.description),be(Te.type),Xe(Te.amount.toFixed(2))},J=()=>{X(null),V(""),be("DEBITO"),Xe("")},De=()=>{if(!W)return;const Te=Number(L);!isFinite(Te)||Te<=0||(ce(ee=>ee.map(me=>me.id===W?{...me,description:D.trim(),type:Z,amount:Number(Te.toFixed(2))}:me)),J())},ie=Te=>{ce(ee=>ee.filter(me=>me.id!==Te)),W===Te&&J()},He=(Te,ee)=>{b(me=>ee?[...new Set([...me,Te])]:me.filter(Re=>Re!==Te))},Ge=Te=>{b(Te?f.map(ee=>ee.id):[])},dt=(Te,ee)=>{_(me=>ee?[...new Set([...me,Te])]:me.filter(Re=>Re!==Te))},_t=g.useMemo(()=>f.filter(Te=>y.includes(Te.id)),[f,y]),Bt=g.useMemo(()=>oe.filter(Te=>Te.type==="DEBITO").reduce((Te,ee)=>Te+ee.amount,0),[oe]),Ot=g.useMemo(()=>oe.filter(Te=>Te.type==="CREDITO").reduce((Te,ee)=>Te+ee.amount,0),[oe]),jt=g.useMemo(()=>{let Te=0,ee=0,me=0,Re=0;for(const st of _t){k3e(st.unit)?Te+=Number(st.quantity||0):ee+=Number(st.quantity||0);const yt=st.expectedTotal??Number((Number(st.quantity||0)*Number(st.salePrice||0)).toFixed(2)),pe=st.invoiceTotal!==void 0&&st.invoiceTotal!==null?Number(st.invoiceTotal):Number((Number(st.quantity||0)*Number(st.purchasePrice||0)).toFixed(2));me+=Number(yt||0),Re+=Number(pe||0)}const he=z.filter(st=>I.includes(st.id)).reduce((st,yt)=>st+Number(yt.amount||0),0),qe=me-he-Bt+Ot;return{totalLbs:Te,totalUnits:ee,totalExpected:Number(me.toFixed(2)),totalInvoiced:Number(Re.toFixed(2)),totalGastos:Number(he.toFixed(2)),debits:Number(Bt.toFixed(2)),credits:Number(Ot.toFixed(2)),finalAmount:Number(qe.toFixed(2)),grossProfit:Number((me-Re).toFixed(2))}},[_t,z,I,Bt,Ot]),[Qt,Ft]=g.useState(!1),[$e,Fe]=g.useState(""),Ze=async()=>{if(Fe(""),_t.length===0){Fe("Selecciona al menos 1 lote pagado.");return}try{Ft(!0);const Te={number:m.trim(),date:A,description:x.trim(),status:"PENDIENTE",createdAt:xr.now(),totalLbs:Number(Ax(jt.totalLbs)),totalUnits:Number(Ax(jt.totalUnits)),totalAmount:jt.totalExpected,invoiceTotal:jt.totalInvoiced,totalExpenses:jt.totalGastos,totalDebits:jt.debits,totalCredits:jt.credits,finalAmount:jt.finalAmount,batches:_t.map(ee=>{var me;return{id:ee.id,productId:ee.productId,productName:ee.productName,unit:ee.unit,quantity:Number(Ax(ee.quantity)),salePrice:Number(Number(ee.salePrice||0).toFixed(2)),purchasePrice:Number(Number(ee.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(ee.quantity||0)*Number(ee.salePrice||0)).toFixed(2)),invoiceTotal:ee.invoiceTotal!==void 0&&ee.invoiceTotal!==null?Number(ee.invoiceTotal):Number((Number(ee.quantity||0)*Number(ee.purchasePrice||0)).toFixed(2)),batchDate:ee.date,paidAt:(me=ee.paidAt)!=null&&me.toDate?Ur(ee.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:z.filter(ee=>I.includes(ee.id)).map(ee=>({id:ee.id,date:ee.date||null,description:ee.description||"",amount:Number(Number(ee.amount||0).toFixed(2))})),adjustments:oe.map(ee=>({id:ee.id,description:ee.description,type:ee.type,amount:Number(ee.amount.toFixed(2))}))};await Zn(bt(Pe,"invoices"),Te),Fe(" Factura creada."),r()}catch(Te){console.error(Te),Fe(` Error al crear factura: ${(Te==null?void 0:Te.message)||"desconocido"}`)}finally{Ft(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:A,onChange:Te=>h(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:Te=>p(Te.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:Te=>v(Te.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Te=>s(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:Te=>l(Te.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:Te=>u(Te.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),d.map(Te=>i.jsx("option",{value:Te.id,children:Te.name},Te.id))]})]}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{s(E5()),l(UC()),u("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:f.length>0&&y.length===f.length,onChange:Te=>Ge(Te.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),f.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha lote"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),i.jsx("tbody",{children:f.map(Te=>{var qe;const ee=y.includes(Te.id),me=Te.expectedTotal??Number((Number(Te.quantity||0)*Number(Te.salePrice||0)).toFixed(2)),Re=Te.invoiceTotal!==void 0&&Te.invoiceTotal!==null?Number(Te.invoiceTotal):Number((Number(Te.quantity||0)*Number(Te.purchasePrice||0)).toFixed(2)),he=me-Re;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:ee,onChange:st=>He(Te.id,st.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Te.date}),i.jsx("td",{className:"p-2 border",children:Te.productName}),i.jsx("td",{className:"p-2 border",children:(Te.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Ax(Te.quantity)}),i.jsx("td",{className:"p-2 border",children:Nu(Te.salePrice)}),i.jsx("td",{className:"p-2 border",children:Nu(Re)}),i.jsx("td",{className:"p-2 border",children:Nu(me)}),i.jsx("td",{className:"p-2 border",children:Nu(he)}),i.jsx("td",{className:"p-2 border",children:(qe=Te.paidAt)!=null&&qe.toDate?Ur(Te.paidAt.toDate(),"yyyy-MM-dd"):""})]},Te.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),S&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:B,onChange:Te=>k(Te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:P,onChange:Te=>O(Te.target.value)})]})]})]}),z.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:z.map(Te=>{const ee=I.includes(Te.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:ee,onChange:me=>dt(Te.id,me.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Te.date||""}),i.jsx("td",{className:"p-2 border",children:Te.description||""}),i.jsx("td",{className:"p-2 border",children:Nu(Number(Te.amount||0))})]},Te.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>ge(!0),children:"Crear Cargo"})]}),oe.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:oe.map(Te=>{const ee=W===Te.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:D,onChange:me=>V(me.target.value)}):i.jsx("span",{title:Te.description,children:Te.description.length>60?`${Te.description.slice(0,60)}`:Te.description})}),i.jsx("td",{className:"p-2 border",children:ee?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Z,onChange:me=>be(me.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Te.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:Te.type})}),i.jsx("td",{className:"p-2 border",children:ee?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:L,onChange:me=>Xe(me.target.value)}):Nu(Te.amount)}),i.jsx("td",{className:"p-2 border",children:ee?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:De,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:J,children:"Cancelar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(Te.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>re(Te),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(Te.id),children:"Eliminar"})]})})]},Te.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:Ax(jt.totalLbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:Ax(jt.totalUnits)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:Nu(jt.totalInvoiced)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:Nu(jt.totalExpected)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:Nu(jt.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Nu(jt.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Nu(jt.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Nu(jt.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:Nu(jt.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:Qt,onClick:Ze,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:Qt?"Creando":"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),$e&&i.jsx("span",{className:"text-sm ml-2",children:$e})]}),Qt&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),ue&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{type:"button",className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>ge(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:ne,onChange:Te=>Oe(Te.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Ue,onChange:Te=>F(Te.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:H,onChange:Te=>K(Te.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:U,children:"Agregar"})})]})]})})]})}const nd=t=>`C$ ${Number(t||0).toFixed(2)}`,Hc=t=>Number(t||0).toFixed(3),O3e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function D3e(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(!1),[o,l]=g.useState(null),[c,u]=g.useState(Ur(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[d,f]=g.useState(Ur(new Date,"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(!1),{refreshKey:x,refresh:v}=Dc(),[y,b]=g.useState(!1),w=()=>b(O=>!O),[j,I]=g.useState(null),_=O=>I(z=>z===O?null:O);g.useEffect(()=>{(async()=>{n(!0);const O=sr(bt(Pe,"inventory_batches"),Ar("status","==","PAGADO"),In("date","desc")),z=await $t(O),oe=[];z.forEach(ce=>{const ue=ce.data(),ge=Number(ue.quantity||0),ne=Number(ue.remaining||0),Oe=Number(ue.purchasePrice||0),Ue=Number(ue.salePrice||0),F=Number((ge*Oe).toFixed(2)),H=Number((ge*Ue).toFixed(2));oe.push({id:ce.id,productId:ue.productId,productName:ue.productName,category:ue.category,unit:ue.unit,quantity:ge,remaining:ne,purchasePrice:Oe,salePrice:Ue,invoiceTotal:ue.invoiceTotal!=null?Number(ue.invoiceTotal):F,expectedTotal:ue.expectedTotal!=null?Number(ue.expectedTotal):H,date:ue.date,status:ue.status,paidAt:ue.paidAt})}),e(oe),n(!1)})()},[x]);const S=g.useMemo(()=>t.filter(O=>!(c&&O.date<c||d&&O.date>d||A&&O.productId!==A)),[t,c,d,A]),E=g.useMemo(()=>{let O=0,z=0,oe=0,ce=0,ue=0,ge=0;for(const ne of S)O3e(ne.unit)?(O+=ne.quantity,z+=ne.remaining):(oe+=ne.quantity,ce+=ne.remaining),ue+=Number(ne.expectedTotal||0),ge+=Number(ne.invoiceTotal||0);return{lbsIng:O,lbsRem:z,udsIng:oe,udsRem:ce,totalEsperado:ue,totalFact:ge,gross:ue-ge}},[S]),B=O=>{l(O),s(!0)},k=async()=>{if(o)try{const O=er(Pe,"inventory_batches",o.id);await Fn(O,{status:"PENDIENTE",remaining:o.quantity});const z=bt(Pe,"salesV2"),oe=await $t(sr(z,Ar("batchId","==",o.id))),ce=await $t(sr(z,Ar("productName","==",o.productName),Ar("date","==",o.date))),ue=[...oe.docs,...ce.docs];for(const ge of ue)await qn(er(Pe,"salesV2",ge.id));s(!1),l(null),v()}catch(O){console.error("Error al marcar pendiente:",O)}},P=g.useMemo(()=>{const O=new Map;return t.forEach(z=>O.set(z.productId,{id:z.productId,name:z.productName})),Array.from(O.values()).sort((z,oe)=>z.name.localeCompare(oe.name))},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(Oc,{onClick:v,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:O=>u(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:O=>f(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:O=>h(O.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),P.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]})]}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"})]}),i.jsx("button",{type:"button",className:"sm:ml-auto px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"md:hidden",children:[i.jsxs("button",{type:"button",onClick:w,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Totales"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Libras: ",i.jsx("b",{children:Hc(E.lbsIng)}),"  Restantes:"," ",i.jsx("b",{children:Hc(E.lbsRem)})]})]}),i.jsx("div",{className:"text-gray-500",children:y?"":""})]}),y&&i.jsx("div",{className:"mt-3 bg-gray-50 p-3 rounded-2xl shadow-2xl border text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Hc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Hc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",nd(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Hc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Hc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",nd(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",nd(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"hidden md:block bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Hc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Hc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",nd(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Hc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Hc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",nd(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",nd(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:r?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):S.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin lotes pagados"}):S.map(O=>{var oe;const z=j===O.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>_(O.id),className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:O.productName}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[(O.category||"").toUpperCase(),"  ",O.date," "," ",(O.unit||"").toUpperCase()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-bold",children:nd(O.expectedTotal||0)}),i.jsx("div",{className:"text-[11px] text-gray-500",children:z?"Detalles":"Esperado"})]})]}),z&&i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ingresado"}),i.jsx("div",{className:"font-semibold",children:Hc(O.quantity)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:Hc(O.remaining)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Costo"}),i.jsx("div",{className:"font-semibold",children:nd(O.invoiceTotal||0)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Fecha pago"}),i.jsx("div",{className:"font-semibold",children:(oe=O.paidAt)!=null&&oe.toDate?Ur(O.paidAt.toDate(),"yyyy-MM-dd"):""})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(O),children:"Marcar PENDIENTE"})})]})]},O.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):S.map(O=>{var z;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:(O.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:O.productName}),i.jsx("td",{className:"p-2 border",children:(O.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Hc(O.quantity)}),i.jsx("td",{className:"p-2 border",children:Hc(O.remaining)}),i.jsx("td",{className:"p-2 border",children:nd(O.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:nd(O.salePrice)}),i.jsx("td",{className:"p-2 border",children:nd(O.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:nd(O.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(z=O.paidAt)!=null&&z.toDate?Ur(O.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(O),children:"Marcar PENDIENTE"})})]},O.id)})})]})}),m&&i.jsx(F3e,{paidBatches:t,onClose:()=>p(!1),onCreated:()=>p(!1)}),a&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-xl",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded-xl",children:"Confirmar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var US={};US.version="0.18.5";var lne=1252,R3e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],z6={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},W6=function(t){R3e.indexOf(t)!=-1&&(lne=z6[0]=t)};function M3e(){W6(1252)}var ff=function(t){W6(t)};function X6(){ff(1200),M3e()}function iH(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function L3e(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function cne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var zy=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?L3e(t.slice(2)):e==254&&r==255?cne(t.slice(2)):e==65279?t.slice(1):t},QC=function(e){return String.fromCharCode(e)},oH=function(e){return String.fromCharCode(e)},j2,W0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function P2(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,a=t.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),e+=W0.charAt(s)+W0.charAt(o)+W0.charAt(l)+W0.charAt(c);return e}function Hu(t){var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=W0.indexOf(t.charAt(u++)),o=W0.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),l=W0.indexOf(t.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=W0.indexOf(t.charAt(u++)),a=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var ta=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),DA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Sm(t){return ta?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function lH(t){return ta?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Pu=function(e){return ta?DA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function oP(t){if(typeof ArrayBuffer>"u")return Pu(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Um(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function U3e(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Y6(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Y6(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Jo=ta?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:DA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Q3e(t){for(var e=[],r=0,n=t.length+250,a=Sm(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Sm(65535),n=65530)}return e.push(a.slice(0,r)),Jo(e)}var Pc=/\u0000/g,Wy=/[\u0001-\u0006]/g;function mv(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function hf(t,e){var r=""+t;return r.length>=e?r:Ei("0",e-r.length)+r}function J6(t,e){var r=""+t;return r.length>=e?r:Ei(" ",e-r.length)+r}function QS(t,e){var r=""+t;return r.length>=e?r:r+Ei(" ",e-r.length)}function V3e(t,e){var r=""+Math.round(t);return r.length>=e?r:Ei("0",e-r.length)+r}function H3e(t,e){var r=""+t;return r.length>=e?r:Ei("0",e-r.length)+r}var cH=Math.pow(2,32);function mx(t,e){if(t>cH||t<-cH)return V3e(t,e);var r=Math.round(t);return H3e(r,e)}function VS(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var uH=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],S5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $3e(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var kn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},dH={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},K3e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function HS(t,e,r){for(var n=t<0?-1:1,a=t*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<e&&(f=Math.floor(a),l=f*o+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=u,u=d;if(d>e&&(u>e?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var A=Math.floor(n*l/d);return[A,n*l-A*d,d]}function Ep(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),s=0,o=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=Y3e(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var une=new Date(1899,11,31,0,0,0),G3e=une.getTime(),q3e=new Date(1900,2,1,0,0,0);function dne(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=q3e&&(r+=24*60*60*1e3),(r-(G3e+(t.getTimezoneOffset()-une.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Z6(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function z3e(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function W3e(t){var e=t<0?12:11,r=Z6(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function X3e(t){var e=Z6(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function B2(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=W3e(t):e===10?r=t.toFixed(10).substr(0,12):r=X3e(t),Z6(z3e(r.toUpperCase()))}function fg(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):B2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Od(14,dne(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Y3e(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function J3e(t,e,r,n){var a="",s=0,o=0,l=r.y,c,u=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return S5[r.m-1][1];case 5:return S5[r.m-1][0];default:return S5[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return uH[r.q][0];default:return uH[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?hf(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=hf(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?hf(c,u):"";return d}function X0(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var fne=/%/g;function Z3e(t,e,r){var n=e.replace(fne,""),a=e.length-n.length;return oA(t,n,r*Math.pow(10,2*a))+Ei("%",a)}function e4e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return oA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+hne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ane=/# (\?+)( ?)\/( ?)(\d+)/;function t4e(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?Ei(" ",t[1].length+1+t[4].length):J6(o,t[1].length)+t[2]+"/"+t[3]+hf(l,t[4].length))}function r4e(t,e,r){return r+(e===0?"":""+e)+Ei(" ",t[1].length+2+t[4].length)}var mne=/^#*0*\.([0#]+)/,pne=/\).*[0#]/,gne=/\(###\) ###\\?-####/;function wc(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function fH(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function hH(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function n4e(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function a4e(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function cd(t,e,r){if(t.charCodeAt(0)===40&&!e.match(pne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cd("n",n,r):"("+cd("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return e4e(t,e,r);if(e.indexOf("%")!==-1)return Z3e(t,e,r);if(e.indexOf("E")!==-1)return hne(e,r);if(e.charCodeAt(0)===36)return"$"+cd(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+mx(c,e.length);if(e.match(/^[#?]+$/))return a=mx(r,0),a==="0"&&(a=""),a.length>e.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(Ane))return t4e(s,c,u);if(e.match(/^#+0+$/))return u+mx(c,e.length-e.indexOf("0"));if(s=e.match(mne))return a=fH(r,s[1].length).replace(/^([^\.]+)$/,"$1."+wc(s[1])).replace(/\.$/,"."+wc(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Ei("0",wc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+fH(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+X0(mx(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cd(t,e,-r):X0(""+(Math.floor(r)+n4e(r,s[1].length)))+"."+hf(hH(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return cd(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=mv(cd(t,e.replace(/[\\-]/g,""),r)),o=0,mv(mv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(gne))return a=cd(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=HS(c,Math.pow(10,o)-1,!1),a=""+u,d=oA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=QS(l[2],o),d.length<s[4].length&&(d=wc(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=HS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?J6(l[1],o)+s[2]+"/"+s[3]+QS(l[2],o):Ei(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=mx(r,0),e.length<=a.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return wc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=hH(r,s[1].length),r<0?"-"+cd(t,e,-r):X0(a4e(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hf(0,3-m.length):"")+m})+"."+hf(o,s[1].length);switch(e){case"###,##0.00":return cd(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=X0(mx(c,0));return h!=="0"?u+h:"";case"###,###.00":return cd(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return cd(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function s4e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return oA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function i4e(t,e,r){var n=e.replace(fne,""),a=e.length-n.length;return oA(t,n,r*Math.pow(10,2*a))+Ei("%",a)}function xne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+xne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Hf(t,e,r){if(t.charCodeAt(0)===40&&!e.match(pne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hf("n",n,r):"("+Hf("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return s4e(t,e,r);if(e.indexOf("%")!==-1)return i4e(t,e,r);if(e.indexOf("E")!==-1)return xne(e,r);if(e.charCodeAt(0)===36)return"$"+Hf(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+hf(c,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(Ane))return r4e(s,c,u);if(e.match(/^#+0+$/))return u+hf(c,e.length-e.indexOf("0"));if(s=e.match(mne))return a=(""+r).replace(/^([^\.]+)$/,"$1."+wc(s[1])).replace(/\.$/,"."+wc(s[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+Ei("0",wc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+X0(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hf(t,e,-r):X0(""+r)+"."+Ei("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Hf(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=mv(Hf(t,e.replace(/[\\-]/g,""),r)),o=0,mv(mv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(gne))return a=Hf(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=HS(c,Math.pow(10,o)-1,!1),a=""+u,d=oA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=QS(l[2],o),d.length<s[4].length&&(d=wc(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=HS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?J6(l[1],o)+s[2]+"/"+s[3]+QS(l[2],o):Ei(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return wc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Hf(t,e,-r):X0(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hf(0,3-m.length):"")+m})+"."+hf(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=X0(""+c);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return Hf(t,e.slice(0,e.lastIndexOf(".")),r)+wc(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function oA(t,e,r){return(r|0)===r?Hf(t,e,r):cd(t,e,r)}function o4e(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var vne=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function x1(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":VS(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(vne))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function l4e(t,e,r,n){for(var a=[],s="",o=0,l="",c="t",u,d,f,A="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!VS(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=Ep(e,r,t.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Ep(e,r),u==null))return"";for(s=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=A),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=Ep(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",A="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,A="h"):t.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,A="h"):(p.t="t",++o),u==null&&p.t==="T")return"";a[a.length]=p,c=l;break;case"[":for(s=l;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(vne)){if(u==null&&(u=Ep(e,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",x1(t)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<t.length&&(l=t.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;t.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var x=0,v=0,y;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=A,c="h",x<1&&(x=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[o].v.match(/[Hh]/)&&(x=1),x<2&&a[o].v.match(/[Mm]/)&&(x=2),x<3&&a[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",w;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=J3e(a[o].t.charCodeAt(0),a[o].v,u,v),a[o].t="t";break;case"n":case"?":for(w=o+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[o].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[o].v,o=w-1;break;case"G":a[o].t="t",a[o].v=fg(e,r);break}var j="",I,_;if(b.length>0){b.charCodeAt(0)==40?(I=e<0&&b.charCodeAt(0)===45?-e:e,_=oA("n",b,I)):(I=e<0&&n>1?-e:e,_=oA("n",b,I),I<0&&a[0]&&a[0].t=="t"&&(_=_.substr(1),a[0].v="-"+a[0].v)),w=_.length-1;var S=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){S=o;break}var E=a.length;if(S===a.length&&_.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(w>=a[o].v.length-1?(w-=a[o].v.length,a[o].v=_.substr(w+1,a[o].v.length)):w<0?a[o].v="":(a[o].v=_.substr(0,w+1),w=-1),a[o].t="t",E=o);w>=0&&E<a.length&&(a[E].v=_.substr(0,w+1)+a[E].v)}else if(S!==a.length&&_.indexOf("E")===-1){for(w=_.indexOf(".")-1,o=S;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")-1:a[o].v.length-1,j=a[o].v.substr(d+1);d>=0;--d)w>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(j=_.charAt(w--)+j);a[o].v=j,a[o].t="t",E=o}for(w>=0&&E<a.length&&(a[E].v=_.substr(0,w+1)+a[E].v),w=_.indexOf(".")+1,o=S;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==S)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")+1:0,j=a[o].v.substr(0,d);d<a[o].v.length;++d)w<_.length&&(j+=_.charAt(w++));a[o].v=j,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(I=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=oA(a[o].t,a[o].v,I),a[o].t="t");var B="";for(o=0;o!==a.length;++o)a[o]!=null&&(B+=a[o].v);return B}var AH=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function mH(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function c4e(t,e){var r=o4e(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(AH),l=r[1].match(AH);return mH(e,o)?[n,r[0]]:mH(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Od(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:kn)[t],n==null&&(n=r.table&&r.table[dH[t]]||kn[dH[t]]),n==null&&(n=K3e[t]||"General");break}if(VS(n,0))return fg(e,r);e instanceof Date&&(e=dne(e,r.date1904));var a=c4e(n,e);if(VS(a[1]))return fg(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return l4e(a[1],e,r,a[0])}function lA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(kn[r]==null){e<0&&(e=r);continue}if(kn[r]==t){e=r;break}}e<0&&(e=391)}return kn[e]=t,e}function lP(t){for(var e=0;e!=392;++e)t[e]!==void 0&&lA(t[e],e)}function v1(){kn=$3e()}var u4e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},yne=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function d4e(t){var e=typeof t=="number"?kn[t]:t;return e=e.replace(yne,"(\\d+)"),new RegExp("^"+e+"$")}function f4e(t,e,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(yne)||[]).forEach(function(f,A){var h=parseInt(r[A+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var h4e=function(){var t={};t.version="1.2.0";function e(){for(var _=0,S=new Array(256),E=0;E!=256;++E)_=E,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,S[E]=_;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(_){var S=0,E=0,B=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)k[B]=_[B];for(B=0;B!=256;++B)for(E=_[B],S=256+B;S<4096;S+=256)E=k[S]=E>>>8^_[E&255];var P=[];for(B=1;B!=16;++B)P[B-1]=typeof Int32Array<"u"?k.subarray(B*256,B*256+256):k.slice(B*256,B*256+256);return P}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],A=a[7],h=a[8],m=a[9],p=a[10],x=a[11],v=a[12],y=a[13],b=a[14];function w(_,S){for(var E=S^-1,B=0,k=_.length;B<k;)E=E>>>8^r[(E^_.charCodeAt(B++))&255];return~E}function j(_,S){for(var E=S^-1,B=_.length-15,k=0;k<B;)E=b[_[k++]^E&255]^y[_[k++]^E>>8&255]^v[_[k++]^E>>16&255]^x[_[k++]^E>>>24]^p[_[k++]]^m[_[k++]]^h[_[k++]]^A[_[k++]]^f[_[k++]]^d[_[k++]]^u[_[k++]]^c[_[k++]]^l[_[k++]]^o[_[k++]]^s[_[k++]]^r[_[k++]];for(B+=15;k<B;)E=E>>>8^r[(E^_[k++])&255];return~E}function I(_,S){for(var E=S^-1,B=0,k=_.length,P=0,O=0;B<k;)P=_.charCodeAt(B++),P<128?E=E>>>8^r[(E^P)&255]:P<2048?(E=E>>>8^r[(E^(192|P>>6&31))&255],E=E>>>8^r[(E^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,O=_.charCodeAt(B++)&1023,E=E>>>8^r[(E^(240|P>>8&7))&255],E=E>>>8^r[(E^(128|P>>2&63))&255],E=E>>>8^r[(E^(128|O>>6&15|(P&3)<<4))&255],E=E>>>8^r[(E^(128|O&63))&255]):(E=E>>>8^r[(E^(224|P>>12&15))&255],E=E>>>8^r[(E^(128|P>>6&63))&255],E=E>>>8^r[(E^(128|P&63))&255]);return~E}return t.table=r,t.bstr=w,t.buf=j,t.str=I,t}(),En=function(){var e={};e.version="1.2.1";function r(R,Q){for(var G=R.split("/"),se=Q.split("/"),Ne=0,Me=0,ze=Math.min(G.length,se.length);Ne<ze;++Ne){if(Me=G[Ne].length-se[Ne].length)return Me;if(G[Ne]!=se[Ne])return G[Ne]<se[Ne]?-1:1}return G.length-se.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var Q=R.lastIndexOf("/");return Q===-1?R:R.slice(0,Q+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var Q=R.lastIndexOf("/");return Q===-1?R:R.slice(Q+1)}function s(R,Q){typeof Q=="string"&&(Q=new Date(Q));var G=Q.getHours();G=G<<6|Q.getMinutes(),G=G<<5|Q.getSeconds()>>>1,R.write_shift(2,G);var se=Q.getFullYear()-1980;se=se<<4|Q.getMonth()+1,se=se<<5|Q.getDate(),R.write_shift(2,se)}function o(R){var Q=R.read_shift(2)&65535,G=R.read_shift(2)&65535,se=new Date,Ne=G&31;G>>>=5;var Me=G&15;G>>>=4,se.setMilliseconds(0),se.setFullYear(G+1980),se.setMonth(Me-1),se.setDate(Ne);var ze=Q&31;Q>>>=5;var Ie=Q&63;return Q>>>=6,se.setHours(Q),se.setMinutes(Ie),se.setSeconds(ze<<1),se}function l(R){_l(R,0);for(var Q={},G=0;R.l<=R.length-4;){var se=R.read_shift(2),Ne=R.read_shift(2),Me=R.l+Ne,ze={};switch(se){case 21589:G=R.read_shift(1),G&1&&(ze.mtime=R.read_shift(4)),Ne>5&&(G&2&&(ze.atime=R.read_shift(4)),G&4&&(ze.ctime=R.read_shift(4))),ze.mtime&&(ze.mt=new Date(ze.mtime*1e3));break}R.l=Me,Q[se]=ze}return Q}var c;function u(){return c||(c={})}function d(R,Q){if(R[0]==80&&R[1]==75)return we(R,Q);if((R[0]|32)==109&&(R[1]|32)==105)return Le(R,Q);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var G=3,se=512,Ne=0,Me=0,ze=0,Ie=0,nt=0,lt=[],ht=R.slice(0,512);_l(ht,0);var kt=f(ht);switch(G=kt[0],G){case 3:se=512;break;case 4:se=4096;break;case 0:if(kt[1]==0)return we(R,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}se!==512&&(ht=R.slice(0,se),_l(ht,28));var le=R.slice(0,se);A(ht,G);var We=ht.read_shift(4,"i");if(G===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);ht.l+=4,ze=ht.read_shift(4,"i"),ht.l+=4,ht.chk("00100000","Mini Stream Cutoff Size: "),Ie=ht.read_shift(4,"i"),Ne=ht.read_shift(4,"i"),nt=ht.read_shift(4,"i"),Me=ht.read_shift(4,"i");for(var it=-1,ot=0;ot<109&&(it=ht.read_shift(4,"i"),!(it<0));++ot)lt[ot]=it;var Nt=h(R,se);x(nt,Me,Nt,se,lt);var Rt=y(Nt,ze,lt,se);Rt[ze].name="!Directory",Ne>0&&Ie!==O&&(Rt[Ie].name="!MiniFAT"),Rt[lt[0]].name="!FAT",Rt.fat_addrs=lt,Rt.ssz=se;var nr={},_r=[],$r=[],or=[];b(ze,Rt,Nt,_r,Ne,nr,$r,Ie),m($r,or,_r),_r.shift();var kr={FileIndex:$r,FullPaths:or};return Q&&Q.raw&&(kr.raw={header:le,sectors:Nt}),kr}function f(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(z,"Header Signature: "),R.l+=16;var Q=R.read_shift(2,"u");return[R.read_shift(2,"u"),Q]}function A(R,Q){var G=9;switch(R.l+=2,G=R.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function h(R,Q){for(var G=Math.ceil(R.length/Q)-1,se=[],Ne=1;Ne<G;++Ne)se[Ne-1]=R.slice(Ne*Q,(Ne+1)*Q);return se[G-1]=R.slice(G*Q),se}function m(R,Q,G){for(var se=0,Ne=0,Me=0,ze=0,Ie=0,nt=G.length,lt=[],ht=[];se<nt;++se)lt[se]=ht[se]=se,Q[se]=G[se];for(;Ie<ht.length;++Ie)se=ht[Ie],Ne=R[se].L,Me=R[se].R,ze=R[se].C,lt[se]===se&&(Ne!==-1&&lt[Ne]!==Ne&&(lt[se]=lt[Ne]),Me!==-1&&lt[Me]!==Me&&(lt[se]=lt[Me])),ze!==-1&&(lt[ze]=se),Ne!==-1&&se!=lt[se]&&(lt[Ne]=lt[se],ht.lastIndexOf(Ne)<Ie&&ht.push(Ne)),Me!==-1&&se!=lt[se]&&(lt[Me]=lt[se],ht.lastIndexOf(Me)<Ie&&ht.push(Me));for(se=1;se<nt;++se)lt[se]===se&&(Me!==-1&&lt[Me]!==Me?lt[se]=lt[Me]:Ne!==-1&&lt[Ne]!==Ne&&(lt[se]=lt[Ne]));for(se=1;se<nt;++se)if(R[se].type!==0){if(Ie=se,Ie!=lt[Ie])do Ie=lt[Ie],Q[se]=Q[Ie]+"/"+Q[se];while(Ie!==0&&lt[Ie]!==-1&&Ie!=lt[Ie]);lt[se]=-1}for(Q[0]+="/",se=1;se<nt;++se)R[se].type!==2&&(Q[se]+="/")}function p(R,Q,G){for(var se=R.start,Ne=R.size,Me=[],ze=se;G&&Ne>0&&ze>=0;)Me.push(Q.slice(ze*P,ze*P+P)),Ne-=P,ze=vp(G,ze*4);return Me.length===0?cr(0):Jo(Me).slice(0,R.size)}function x(R,Q,G,se,Ne){var Me=O;if(R===O){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ze=G[R],Ie=(se>>>2)-1;if(!ze)return;for(var nt=0;nt<Ie&&(Me=vp(ze,nt*4))!==O;++nt)Ne.push(Me);x(vp(ze,se-4),Q-1,G,se,Ne)}}function v(R,Q,G,se,Ne){var Me=[],ze=[];Ne||(Ne=[]);var Ie=se-1,nt=0,lt=0;for(nt=Q;nt>=0;){Ne[nt]=!0,Me[Me.length]=nt,ze.push(R[nt]);var ht=G[Math.floor(nt*4/se)];if(lt=nt*4&Ie,se<4+lt)throw new Error("FAT boundary crossed: "+nt+" 4 "+se);if(!R[ht])break;nt=vp(R[ht],lt)}return{nodes:Me,data:SH([ze])}}function y(R,Q,G,se){var Ne=R.length,Me=[],ze=[],Ie=[],nt=[],lt=se-1,ht=0,kt=0,le=0,We=0;for(ht=0;ht<Ne;++ht)if(Ie=[],le=ht+Q,le>=Ne&&(le-=Ne),!ze[le]){nt=[];var it=[];for(kt=le;kt>=0;){it[kt]=!0,ze[kt]=!0,Ie[Ie.length]=kt,nt.push(R[kt]);var ot=G[Math.floor(kt*4/se)];if(We=kt*4&lt,se<4+We)throw new Error("FAT boundary crossed: "+kt+" 4 "+se);if(!R[ot]||(kt=vp(R[ot],We),it[kt]))break}Me[le]={nodes:Ie,data:SH([nt])}}return Me}function b(R,Q,G,se,Ne,Me,ze,Ie){for(var nt=0,lt=se.length?2:0,ht=Q[R].data,kt=0,le=0,We;kt<ht.length;kt+=128){var it=ht.slice(kt,kt+128);_l(it,64),le=it.read_shift(2),We=iR(it,0,le-lt),se.push(We);var ot={name:We,type:it.read_shift(1),color:it.read_shift(1),L:it.read_shift(4,"i"),R:it.read_shift(4,"i"),C:it.read_shift(4,"i"),clsid:it.read_shift(16),state:it.read_shift(4,"i"),start:0,size:0},Nt=it.read_shift(2)+it.read_shift(2)+it.read_shift(2)+it.read_shift(2);Nt!==0&&(ot.ct=w(it,it.l-8));var Rt=it.read_shift(2)+it.read_shift(2)+it.read_shift(2)+it.read_shift(2);Rt!==0&&(ot.mt=w(it,it.l-8)),ot.start=it.read_shift(4,"i"),ot.size=it.read_shift(4,"i"),ot.size<0&&ot.start<0&&(ot.size=ot.type=0,ot.start=O,ot.name=""),ot.type===5?(nt=ot.start,Ne>0&&nt!==O&&(Q[nt].name="!StreamData")):ot.size>=4096?(ot.storage="fat",Q[ot.start]===void 0&&(Q[ot.start]=v(G,ot.start,Q.fat_addrs,Q.ssz)),Q[ot.start].name=ot.name,ot.content=Q[ot.start].data.slice(0,ot.size)):(ot.storage="minifat",ot.size<0?ot.size=0:nt!==O&&ot.start!==O&&Q[nt]&&(ot.content=p(ot,Q[nt].data,(Q[Ie]||{}).data))),ot.content&&_l(ot.content,0),Me[We]=ot,ze.push(ot)}}function w(R,Q){return new Date((ju(R,Q+4)/1e7*Math.pow(2,32)+ju(R,Q)/1e7-11644473600)*1e3)}function j(R,Q){return u(),d(c.readFileSync(R),Q)}function I(R,Q){var G=Q&&Q.type;switch(G||ta&&Buffer.isBuffer(R)&&(G="buffer"),G||"base64"){case"file":return j(R,Q);case"base64":return d(Pu(Hu(R)),Q);case"binary":return d(Pu(R),Q)}return d(R,Q)}function _(R,Q){var G=Q||{},se=G.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=se+"/",R.FileIndex[0]={name:se,type:5}),G.CLSID&&(R.FileIndex[0].clsid=G.CLSID),S(R)}function S(R){var Q="Sh33tJ5";if(!En.find(R,"/"+Q)){var G=cr(4);G[0]=55,G[1]=G[3]=50,G[2]=54,R.FileIndex.push({name:Q,type:2,content:G,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+Q),E(R)}}function E(R,Q){_(R);for(var G=!1,se=!1,Ne=R.FullPaths.length-1;Ne>=0;--Ne){var Me=R.FileIndex[Ne];switch(Me.type){case 0:se?G=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:se=!0,isNaN(Me.R*Me.L*Me.C)&&(G=!0),Me.R>-1&&Me.L>-1&&Me.R==Me.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!Q)){var ze=new Date(1987,1,19),Ie=0,nt=Object.create?Object.create(null):{},lt=[];for(Ne=0;Ne<R.FullPaths.length;++Ne)nt[R.FullPaths[Ne]]=!0,R.FileIndex[Ne].type!==0&&lt.push([R.FullPaths[Ne],R.FileIndex[Ne]]);for(Ne=0;Ne<lt.length;++Ne){var ht=n(lt[Ne][0]);se=nt[ht],se||(lt.push([ht,{name:a(ht).replace("/",""),type:1,clsid:ce,ct:ze,mt:ze,content:null}]),nt[ht]=!0)}for(lt.sort(function(We,it){return r(We[0],it[0])}),R.FullPaths=[],R.FileIndex=[],Ne=0;Ne<lt.length;++Ne)R.FullPaths[Ne]=lt[Ne][0],R.FileIndex[Ne]=lt[Ne][1];for(Ne=0;Ne<lt.length;++Ne){var kt=R.FileIndex[Ne],le=R.FullPaths[Ne];if(kt.name=a(le).replace("/",""),kt.L=kt.R=kt.C=-(kt.color=1),kt.size=kt.content?kt.content.length:0,kt.start=0,kt.clsid=kt.clsid||ce,Ne===0)kt.C=lt.length>1?1:-1,kt.size=0,kt.type=5;else if(le.slice(-1)=="/"){for(Ie=Ne+1;Ie<lt.length&&n(R.FullPaths[Ie])!=le;++Ie);for(kt.C=Ie>=lt.length?-1:Ie,Ie=Ne+1;Ie<lt.length&&n(R.FullPaths[Ie])!=n(le);++Ie);kt.R=Ie>=lt.length?-1:Ie,kt.type=1}else n(R.FullPaths[Ne+1]||"")==n(le)&&(kt.R=Ne+1),kt.type=2}}}function B(R,Q){var G=Q||{};if(G.fileType=="mad")return Ce(R,G);switch(E(R),G.fileType){case"zip":return xe(R,G)}var se=function(We){for(var it=0,ot=0,Nt=0;Nt<We.FileIndex.length;++Nt){var Rt=We.FileIndex[Nt];if(Rt.content){var nr=Rt.content.length;nr>0&&(nr<4096?it+=nr+63>>6:ot+=nr+511>>9)}}for(var _r=We.FullPaths.length+3>>2,$r=it+7>>3,or=it+127>>7,kr=$r+ot+_r+or,en=kr+127>>7,rn=en<=109?0:Math.ceil((en-109)/127);kr+en+rn+127>>7>en;)rn=++en<=109?0:Math.ceil((en-109)/127);var Er=[1,rn,en,or,_r,ot,it,0];return We.FileIndex[0].size=it<<6,Er[7]=(We.FileIndex[0].start=Er[0]+Er[1]+Er[2]+Er[3]+Er[4]+Er[5])+(Er[6]+7>>3),Er}(R),Ne=cr(se[7]<<9),Me=0,ze=0;{for(Me=0;Me<8;++Me)Ne.write_shift(1,oe[Me]);for(Me=0;Me<8;++Me)Ne.write_shift(2,0);for(Ne.write_shift(2,62),Ne.write_shift(2,3),Ne.write_shift(2,65534),Ne.write_shift(2,9),Ne.write_shift(2,6),Me=0;Me<3;++Me)Ne.write_shift(2,0);for(Ne.write_shift(4,0),Ne.write_shift(4,se[2]),Ne.write_shift(4,se[0]+se[1]+se[2]+se[3]-1),Ne.write_shift(4,0),Ne.write_shift(4,4096),Ne.write_shift(4,se[3]?se[0]+se[1]+se[2]-1:O),Ne.write_shift(4,se[3]),Ne.write_shift(-4,se[1]?se[0]-1:O),Ne.write_shift(4,se[1]),Me=0;Me<109;++Me)Ne.write_shift(-4,Me<se[2]?se[1]+Me:-1)}if(se[1])for(ze=0;ze<se[1];++ze){for(;Me<236+ze*127;++Me)Ne.write_shift(-4,Me<se[2]?se[1]+Me:-1);Ne.write_shift(-4,ze===se[1]-1?O:ze+1)}var Ie=function(We){for(ze+=We;Me<ze-1;++Me)Ne.write_shift(-4,Me+1);We&&(++Me,Ne.write_shift(-4,O))};for(ze=Me=0,ze+=se[1];Me<ze;++Me)Ne.write_shift(-4,ue.DIFSECT);for(ze+=se[2];Me<ze;++Me)Ne.write_shift(-4,ue.FATSECT);Ie(se[3]),Ie(se[4]);for(var nt=0,lt=0,ht=R.FileIndex[0];nt<R.FileIndex.length;++nt)ht=R.FileIndex[nt],ht.content&&(lt=ht.content.length,!(lt<4096)&&(ht.start=ze,Ie(lt+511>>9)));for(Ie(se[6]+7>>3);Ne.l&511;)Ne.write_shift(-4,ue.ENDOFCHAIN);for(ze=Me=0,nt=0;nt<R.FileIndex.length;++nt)ht=R.FileIndex[nt],ht.content&&(lt=ht.content.length,!(!lt||lt>=4096)&&(ht.start=ze,Ie(lt+63>>6)));for(;Ne.l&511;)Ne.write_shift(-4,ue.ENDOFCHAIN);for(Me=0;Me<se[4]<<2;++Me){var kt=R.FullPaths[Me];if(!kt||kt.length===0){for(nt=0;nt<17;++nt)Ne.write_shift(4,0);for(nt=0;nt<3;++nt)Ne.write_shift(4,-1);for(nt=0;nt<12;++nt)Ne.write_shift(4,0);continue}ht=R.FileIndex[Me],Me===0&&(ht.start=ht.size?ht.start-1:O);var le=Me===0&&G.root||ht.name;if(lt=2*(le.length+1),Ne.write_shift(64,le,"utf16le"),Ne.write_shift(2,lt),Ne.write_shift(1,ht.type),Ne.write_shift(1,ht.color),Ne.write_shift(-4,ht.L),Ne.write_shift(-4,ht.R),Ne.write_shift(-4,ht.C),ht.clsid)Ne.write_shift(16,ht.clsid,"hex");else for(nt=0;nt<4;++nt)Ne.write_shift(4,0);Ne.write_shift(4,ht.state||0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,ht.start),Ne.write_shift(4,ht.size),Ne.write_shift(4,0)}for(Me=1;Me<R.FileIndex.length;++Me)if(ht=R.FileIndex[Me],ht.size>=4096)if(Ne.l=ht.start+1<<9,ta&&Buffer.isBuffer(ht.content))ht.content.copy(Ne,Ne.l,0,ht.size),Ne.l+=ht.size+511&-512;else{for(nt=0;nt<ht.size;++nt)Ne.write_shift(1,ht.content[nt]);for(;nt&511;++nt)Ne.write_shift(1,0)}for(Me=1;Me<R.FileIndex.length;++Me)if(ht=R.FileIndex[Me],ht.size>0&&ht.size<4096)if(ta&&Buffer.isBuffer(ht.content))ht.content.copy(Ne,Ne.l,0,ht.size),Ne.l+=ht.size+63&-64;else{for(nt=0;nt<ht.size;++nt)Ne.write_shift(1,ht.content[nt]);for(;nt&63;++nt)Ne.write_shift(1,0)}if(ta)Ne.l=Ne.length;else for(;Ne.l<Ne.length;)Ne.write_shift(1,0);return Ne}function k(R,Q){var G=R.FullPaths.map(function(nt){return nt.toUpperCase()}),se=G.map(function(nt){var lt=nt.split("/");return lt[lt.length-(nt.slice(-1)=="/"?2:1)]}),Ne=!1;Q.charCodeAt(0)===47?(Ne=!0,Q=G[0].slice(0,-1)+Q):Ne=Q.indexOf("/")!==-1;var Me=Q.toUpperCase(),ze=Ne===!0?G.indexOf(Me):se.indexOf(Me);if(ze!==-1)return R.FileIndex[ze];var Ie=!Me.match(Wy);for(Me=Me.replace(Pc,""),Ie&&(Me=Me.replace(Wy,"!")),ze=0;ze<G.length;++ze)if((Ie?G[ze].replace(Wy,"!"):G[ze]).replace(Pc,"")==Me||(Ie?se[ze].replace(Wy,"!"):se[ze]).replace(Pc,"")==Me)return R.FileIndex[ze];return null}var P=64,O=-2,z="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],ce="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(R,Q,G){u();var se=B(R,G);c.writeFileSync(Q,se)}function ne(R){for(var Q=new Array(R.length),G=0;G<R.length;++G)Q[G]=String.fromCharCode(R[G]);return Q.join("")}function Oe(R,Q){var G=B(R,Q);switch(Q&&Q.type||"buffer"){case"file":return u(),c.writeFileSync(Q.filename,G),G;case"binary":return typeof G=="string"?G:ne(G);case"base64":return P2(typeof G=="string"?G:ne(G));case"buffer":if(ta)return Buffer.isBuffer(G)?G:DA(G);case"array":return typeof G=="string"?Pu(G):G}return G}var Ue;function F(R){try{var Q=R.InflateRaw,G=new Q;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)Ue=R;else throw new Error("zlib does not expose bytesRead")}catch(se){console.error("cannot use native zlib: "+(se.message||se))}}function H(R,Q){if(!Ue)return pe(R,Q);var G=Ue.InflateRaw,se=new G,Ne=se._processChunk(R.slice(R.l),se._finishFlushFlag);return R.l+=se.bytesRead,Ne}function K(R){return Ue?Ue.deflateRawSync(R):Te(R)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(R){var Q=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var V=typeof Uint8Array<"u",Z=V?new Uint8Array(256):[],be=0;be<256;++be)Z[be]=D(be);function L(R,Q){var G=Z[R&255];return Q<=8?G>>>8-Q:(G=G<<8|Z[R>>8&255],Q<=16?G>>>16-Q:(G=G<<8|Z[R>>16&255],G>>>24-Q))}function Xe(R,Q){var G=Q&7,se=Q>>>3;return(R[se]|(G<=6?0:R[se+1]<<8))>>>G&3}function re(R,Q){var G=Q&7,se=Q>>>3;return(R[se]|(G<=5?0:R[se+1]<<8))>>>G&7}function J(R,Q){var G=Q&7,se=Q>>>3;return(R[se]|(G<=4?0:R[se+1]<<8))>>>G&15}function De(R,Q){var G=Q&7,se=Q>>>3;return(R[se]|(G<=3?0:R[se+1]<<8))>>>G&31}function ie(R,Q){var G=Q&7,se=Q>>>3;return(R[se]|(G<=1?0:R[se+1]<<8))>>>G&127}function He(R,Q,G){var se=Q&7,Ne=Q>>>3,Me=(1<<G)-1,ze=R[Ne]>>>se;return G<8-se||(ze|=R[Ne+1]<<8-se,G<16-se)||(ze|=R[Ne+2]<<16-se,G<24-se)||(ze|=R[Ne+3]<<24-se),ze&Me}function Ge(R,Q,G){var se=Q&7,Ne=Q>>>3;return se<=5?R[Ne]|=(G&7)<<se:(R[Ne]|=G<<se&255,R[Ne+1]=(G&7)>>8-se),Q+3}function dt(R,Q,G){var se=Q&7,Ne=Q>>>3;return G=(G&1)<<se,R[Ne]|=G,Q+1}function _t(R,Q,G){var se=Q&7,Ne=Q>>>3;return G<<=se,R[Ne]|=G&255,G>>>=8,R[Ne+1]=G,Q+8}function Bt(R,Q,G){var se=Q&7,Ne=Q>>>3;return G<<=se,R[Ne]|=G&255,G>>>=8,R[Ne+1]=G&255,R[Ne+2]=G>>>8,Q+16}function Ot(R,Q){var G=R.length,se=2*G>Q?2*G:Q+5,Ne=0;if(G>=Q)return R;if(ta){var Me=lH(se);if(R.copy)R.copy(Me);else for(;Ne<R.length;++Ne)Me[Ne]=R[Ne];return Me}else if(V){var ze=new Uint8Array(se);if(ze.set)ze.set(R);else for(;Ne<G;++Ne)ze[Ne]=R[Ne];return ze}return R.length=se,R}function jt(R){for(var Q=new Array(R),G=0;G<R;++G)Q[G]=0;return Q}function Qt(R,Q,G){var se=1,Ne=0,Me=0,ze=0,Ie=0,nt=R.length,lt=V?new Uint16Array(32):jt(32);for(Me=0;Me<32;++Me)lt[Me]=0;for(Me=nt;Me<G;++Me)R[Me]=0;nt=R.length;var ht=V?new Uint16Array(nt):jt(nt);for(Me=0;Me<nt;++Me)lt[Ne=R[Me]]++,se<Ne&&(se=Ne),ht[Me]=0;for(lt[0]=0,Me=1;Me<=se;++Me)lt[Me+16]=Ie=Ie+lt[Me-1]<<1;for(Me=0;Me<nt;++Me)Ie=R[Me],Ie!=0&&(ht[Me]=lt[Ie+16]++);var kt=0;for(Me=0;Me<nt;++Me)if(kt=R[Me],kt!=0)for(Ie=L(ht[Me],se)>>se-kt,ze=(1<<se+4-kt)-1;ze>=0;--ze)Q[Ie|ze<<kt]=kt&15|Me<<4;return se}var Ft=V?new Uint16Array(512):jt(512),$e=V?new Uint16Array(32):jt(32);if(!V){for(var Fe=0;Fe<512;++Fe)Ft[Fe]=0;for(Fe=0;Fe<32;++Fe)$e[Fe]=0}(function(){for(var R=[],Q=0;Q<32;Q++)R.push(5);Qt(R,$e,32);var G=[];for(Q=0;Q<=143;Q++)G.push(8);for(;Q<=255;Q++)G.push(9);for(;Q<=279;Q++)G.push(7);for(;Q<=287;Q++)G.push(8);Qt(G,Ft,288)})();var Ze=function(){for(var Q=V?new Uint8Array(32768):[],G=0,se=0;G<X.length-1;++G)for(;se<X[G+1];++se)Q[se]=G;for(;se<32768;++se)Q[se]=29;var Ne=V?new Uint8Array(259):[];for(G=0,se=0;G<W.length-1;++G)for(;se<W[G+1];++se)Ne[se]=G;function Me(Ie,nt){for(var lt=0;lt<Ie.length;){var ht=Math.min(65535,Ie.length-lt),kt=lt+ht==Ie.length;for(nt.write_shift(1,+kt),nt.write_shift(2,ht),nt.write_shift(2,~ht&65535);ht-- >0;)nt[nt.l++]=Ie[lt++]}return nt.l}function ze(Ie,nt){for(var lt=0,ht=0,kt=V?new Uint16Array(32768):[];ht<Ie.length;){var le=Math.min(65535,Ie.length-ht);if(le<10){for(lt=Ge(nt,lt,+(ht+le==Ie.length)),lt&7&&(lt+=8-(lt&7)),nt.l=lt/8|0,nt.write_shift(2,le),nt.write_shift(2,~le&65535);le-- >0;)nt[nt.l++]=Ie[ht++];lt=nt.l*8;continue}lt=Ge(nt,lt,+(ht+le==Ie.length)+2);for(var We=0;le-- >0;){var it=Ie[ht];We=(We<<5^it)&32767;var ot=-1,Nt=0;if((ot=kt[We])&&(ot|=ht&-32768,ot>ht&&(ot-=32768),ot<ht))for(;Ie[ot+Nt]==Ie[ht+Nt]&&Nt<250;)++Nt;if(Nt>2){it=Ne[Nt],it<=22?lt=_t(nt,lt,Z[it+1]>>1)-1:(_t(nt,lt,3),lt+=5,_t(nt,lt,Z[it-23]>>5),lt+=3);var Rt=it<8?0:it-4>>2;Rt>0&&(Bt(nt,lt,Nt-W[it]),lt+=Rt),it=Q[ht-ot],lt=_t(nt,lt,Z[it]>>3),lt-=3;var nr=it<4?0:it-2>>1;nr>0&&(Bt(nt,lt,ht-ot-X[it]),lt+=nr);for(var _r=0;_r<Nt;++_r)kt[We]=ht&32767,We=(We<<5^Ie[ht])&32767,++ht;le-=Nt-1}else it<=143?it=it+48:lt=dt(nt,lt,1),lt=_t(nt,lt,Z[it]),kt[We]=ht&32767,++ht}lt=_t(nt,lt,0)-1}return nt.l=(lt+7)/8|0,nt.l}return function(nt,lt){return nt.length<8?Me(nt,lt):ze(nt,lt)}}();function Te(R){var Q=cr(50+Math.floor(R.length*1.1)),G=Ze(R,Q);return Q.slice(0,G)}var ee=V?new Uint16Array(32768):jt(32768),me=V?new Uint16Array(32768):jt(32768),Re=V?new Uint16Array(128):jt(128),he=1,qe=1;function st(R,Q){var G=De(R,Q)+257;Q+=5;var se=De(R,Q)+1;Q+=5;var Ne=J(R,Q)+4;Q+=4;for(var Me=0,ze=V?new Uint8Array(19):jt(19),Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],nt=1,lt=V?new Uint8Array(8):jt(8),ht=V?new Uint8Array(8):jt(8),kt=ze.length,le=0;le<Ne;++le)ze[U[le]]=Me=re(R,Q),nt<Me&&(nt=Me),lt[Me]++,Q+=3;var We=0;for(lt[0]=0,le=1;le<=nt;++le)ht[le]=We=We+lt[le-1]<<1;for(le=0;le<kt;++le)(We=ze[le])!=0&&(Ie[le]=ht[We]++);var it=0;for(le=0;le<kt;++le)if(it=ze[le],it!=0){We=Z[Ie[le]]>>8-it;for(var ot=(1<<7-it)-1;ot>=0;--ot)Re[We|ot<<it]=it&7|le<<3}var Nt=[];for(nt=1;Nt.length<G+se;)switch(We=Re[ie(R,Q)],Q+=We&7,We>>>=3){case 16:for(Me=3+Xe(R,Q),Q+=2,We=Nt[Nt.length-1];Me-- >0;)Nt.push(We);break;case 17:for(Me=3+re(R,Q),Q+=3;Me-- >0;)Nt.push(0);break;case 18:for(Me=11+ie(R,Q),Q+=7;Me-- >0;)Nt.push(0);break;default:Nt.push(We),nt<We&&(nt=We);break}var Rt=Nt.slice(0,G),nr=Nt.slice(G);for(le=G;le<286;++le)Rt[le]=0;for(le=se;le<30;++le)nr[le]=0;return he=Qt(Rt,ee,286),qe=Qt(nr,me,30),Q}function yt(R,Q){if(R[0]==3&&!(R[1]&3))return[Sm(Q),2];for(var G=0,se=0,Ne=lH(Q||1<<18),Me=0,ze=Ne.length>>>0,Ie=0,nt=0;!(se&1);){if(se=re(R,G),G+=3,se>>>1)se>>1==1?(Ie=9,nt=5):(G=st(R,G),Ie=he,nt=qe);else{G&7&&(G+=8-(G&7));var lt=R[G>>>3]|R[(G>>>3)+1]<<8;if(G+=32,lt>0)for(!Q&&ze<Me+lt&&(Ne=Ot(Ne,Me+lt),ze=Ne.length);lt-- >0;)Ne[Me++]=R[G>>>3],G+=8;continue}for(;;){!Q&&ze<Me+32767&&(Ne=Ot(Ne,Me+32767),ze=Ne.length);var ht=He(R,G,Ie),kt=se>>>1==1?Ft[ht]:ee[ht];if(G+=kt&15,kt>>>=4,!(kt>>>8&255))Ne[Me++]=kt;else{if(kt==256)break;kt-=257;var le=kt<8?0:kt-4>>2;le>5&&(le=0);var We=Me+W[kt];le>0&&(We+=He(R,G,le),G+=le),ht=He(R,G,nt),kt=se>>>1==1?$e[ht]:me[ht],G+=kt&15,kt>>>=4;var it=kt<4?0:kt-2>>1,ot=X[kt];for(it>0&&(ot+=He(R,G,it),G+=it),!Q&&ze<We&&(Ne=Ot(Ne,We+100),ze=Ne.length);Me<We;)Ne[Me]=Ne[Me-ot],++Me}}}return Q?[Ne,G+7>>>3]:[Ne.slice(0,Me),G+7>>>3]}function pe(R,Q){var G=R.slice(R.l||0),se=yt(G,Q);return R.l+=se[1],se[0]}function je(R,Q){if(R)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function we(R,Q){var G=R;_l(G,0);var se=[],Ne=[],Me={FileIndex:se,FullPaths:Ne};_(Me,{root:Q.root});for(var ze=G.length-4;(G[ze]!=80||G[ze+1]!=75||G[ze+2]!=5||G[ze+3]!=6)&&ze>=0;)--ze;G.l=ze+4,G.l+=4;var Ie=G.read_shift(2);G.l+=6;var nt=G.read_shift(4);for(G.l=nt,ze=0;ze<Ie;++ze){G.l+=20;var lt=G.read_shift(4),ht=G.read_shift(4),kt=G.read_shift(2),le=G.read_shift(2),We=G.read_shift(2);G.l+=8;var it=G.read_shift(4),ot=l(G.slice(G.l+kt,G.l+kt+le));G.l+=kt+le+We;var Nt=G.l;G.l=it+4,Ye(G,lt,ht,Me,ot),G.l=Nt}return Me}function Ye(R,Q,G,se,Ne){R.l+=2;var Me=R.read_shift(2),ze=R.read_shift(2),Ie=o(R);if(Me&8257)throw new Error("Unsupported ZIP encryption");for(var nt=R.read_shift(4),lt=R.read_shift(4),ht=R.read_shift(4),kt=R.read_shift(2),le=R.read_shift(2),We="",it=0;it<kt;++it)We+=String.fromCharCode(R[R.l++]);if(le){var ot=l(R.slice(R.l,R.l+le));(ot[21589]||{}).mt&&(Ie=ot[21589].mt),((Ne||{})[21589]||{}).mt&&(Ie=Ne[21589].mt)}R.l+=le;var Nt=R.slice(R.l,R.l+lt);switch(ze){case 8:Nt=H(R,ht);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ze)}var Rt=!1;Me&8&&(nt=R.read_shift(4),nt==134695760&&(nt=R.read_shift(4),Rt=!0),lt=R.read_shift(4),ht=R.read_shift(4)),lt!=Q&&je(Rt,"Bad compressed size: "+Q+" != "+lt),ht!=G&&je(Rt,"Bad uncompressed size: "+G+" != "+ht),Qe(se,We,Nt,{unsafe:!0,mt:Ie})}function xe(R,Q){var G=Q||{},se=[],Ne=[],Me=cr(1),ze=G.compression?8:0,Ie=0,nt=0,lt=0,ht=0,kt=0,le=R.FullPaths[0],We=le,it=R.FileIndex[0],ot=[],Nt=0;for(nt=1;nt<R.FullPaths.length;++nt)if(We=R.FullPaths[nt].slice(le.length),it=R.FileIndex[nt],!(!it.size||!it.content||We=="Sh33tJ5")){var Rt=ht,nr=cr(We.length);for(lt=0;lt<We.length;++lt)nr.write_shift(1,We.charCodeAt(lt)&127);nr=nr.slice(0,nr.l),ot[kt]=h4e.buf(it.content,0);var _r=it.content;ze==8&&(_r=K(_r)),Me=cr(30),Me.write_shift(4,67324752),Me.write_shift(2,20),Me.write_shift(2,Ie),Me.write_shift(2,ze),it.mt?s(Me,it.mt):Me.write_shift(4,0),Me.write_shift(-4,ot[kt]),Me.write_shift(4,_r.length),Me.write_shift(4,it.content.length),Me.write_shift(2,nr.length),Me.write_shift(2,0),ht+=Me.length,se.push(Me),ht+=nr.length,se.push(nr),ht+=_r.length,se.push(_r),Me=cr(46),Me.write_shift(4,33639248),Me.write_shift(2,0),Me.write_shift(2,20),Me.write_shift(2,Ie),Me.write_shift(2,ze),Me.write_shift(4,0),Me.write_shift(-4,ot[kt]),Me.write_shift(4,_r.length),Me.write_shift(4,it.content.length),Me.write_shift(2,nr.length),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(4,0),Me.write_shift(4,Rt),Nt+=Me.l,Ne.push(Me),Nt+=nr.length,Ne.push(nr),++kt}return Me=cr(22),Me.write_shift(4,101010256),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(2,kt),Me.write_shift(2,kt),Me.write_shift(4,Nt),Me.write_shift(4,ht),Me.write_shift(2,0),Jo([Jo(se),Jo(Ne),Me])}var Se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xt(R,Q){if(R.ctype)return R.ctype;var G=R.name||"",se=G.match(/\.([^\.]+)$/);return se&&Se[se[1]]||Q&&(se=(G=Q).match(/[\.\\]([^\.\\])+$/),se&&Se[se[1]])?Se[se[1]]:"application/octet-stream"}function Pt(R){for(var Q=P2(R),G=[],se=0;se<Q.length;se+=76)G.push(Q.slice(se,se+76));return G.join(`\r
`)+`\r
`}function It(R){var Q=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(lt){var ht=lt.charCodeAt(0).toString(16).toUpperCase();return"="+(ht.length==1?"0"+ht:ht)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],se=Q.split(`\r
`),Ne=0;Ne<se.length;++Ne){var Me=se[Ne];if(Me.length==0){G.push("");continue}for(var ze=0;ze<Me.length;){var Ie=76,nt=Me.slice(ze,ze+Ie);nt.charAt(Ie-1)=="="?Ie--:nt.charAt(Ie-2)=="="?Ie-=2:nt.charAt(Ie-3)=="="&&(Ie-=3),nt=Me.slice(ze,ze+Ie),ze+=Ie,ze<Me.length&&(nt+="="),G.push(nt)}}return G.join(`\r
`)}function Ut(R){for(var Q=[],G=0;G<R.length;++G){for(var se=R[G];G<=R.length&&se.charAt(se.length-1)=="=";)se=se.slice(0,se.length-1)+R[++G];Q.push(se)}for(var Ne=0;Ne<Q.length;++Ne)Q[Ne]=Q[Ne].replace(/[=][0-9A-Fa-f]{2}/g,function(Me){return String.fromCharCode(parseInt(Me.slice(1),16))});return Pu(Q.join(`\r
`))}function Ht(R,Q,G){for(var se="",Ne="",Me="",ze,Ie=0;Ie<10;++Ie){var nt=Q[Ie];if(!nt||nt.match(/^\s*$/))break;var lt=nt.match(/^(.*?):\s*([^\s].*)$/);if(lt)switch(lt[1].toLowerCase()){case"content-location":se=lt[2].trim();break;case"content-type":Me=lt[2].trim();break;case"content-transfer-encoding":Ne=lt[2].trim();break}}switch(++Ie,Ne.toLowerCase()){case"base64":ze=Pu(Hu(Q.slice(Ie).join("")));break;case"quoted-printable":ze=Ut(Q.slice(Ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ne)}var ht=Qe(R,se.slice(G.length),ze,{unsafe:!0});Me&&(ht.ctype=Me)}function Le(R,Q){if(ne(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=Q&&Q.root||"",se=(ta&&Buffer.isBuffer(R)?R.toString("binary"):ne(R)).split(`\r
`),Ne=0,Me="";for(Ne=0;Ne<se.length;++Ne)if(Me=se[Ne],!!/^Content-Location:/i.test(Me)&&(Me=Me.slice(Me.indexOf("file")),G||(G=Me.slice(0,Me.lastIndexOf("/")+1)),Me.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),Me.slice(0,G.length)!=G););var ze=(se[1]||"").match(/boundary="(.*?)"/);if(!ze)throw new Error("MAD cannot find boundary");var Ie="--"+(ze[1]||""),nt=[],lt=[],ht={FileIndex:nt,FullPaths:lt};_(ht);var kt,le=0;for(Ne=0;Ne<se.length;++Ne){var We=se[Ne];We!==Ie&&We!==Ie+"--"||(le++&&Ht(ht,se.slice(kt,Ne),G),kt=Ne)}return ht}function Ce(R,Q){var G=Q||{},se=G.boundary||"SheetJS";se="------="+se;for(var Ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+se.slice(2)+'"',"","",""],Me=R.FullPaths[0],ze=Me,Ie=R.FileIndex[0],nt=1;nt<R.FullPaths.length;++nt)if(ze=R.FullPaths[nt].slice(Me.length),Ie=R.FileIndex[nt],!(!Ie.size||!Ie.content||ze=="Sh33tJ5")){ze=ze.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Nt){return"_x"+Nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Nt){return"_u"+Nt.charCodeAt(0).toString(16)+"_"});for(var lt=Ie.content,ht=ta&&Buffer.isBuffer(lt)?lt.toString("binary"):ne(lt),kt=0,le=Math.min(1024,ht.length),We=0,it=0;it<=le;++it)(We=ht.charCodeAt(it))>=32&&We<128&&++kt;var ot=kt>=le*4/5;Ne.push(se),Ne.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+ze),Ne.push("Content-Transfer-Encoding: "+(ot?"quoted-printable":"base64")),Ne.push("Content-Type: "+xt(Ie,ze)),Ne.push(""),Ne.push(ot?It(ht):Pt(ht))}return Ne.push(se+`--\r
`),Ne.join(`\r
`)}function Ae(R){var Q={};return _(Q,R),Q}function Qe(R,Q,G,se){var Ne=se&&se.unsafe;Ne||_(R);var Me=!Ne&&En.find(R,Q);if(!Me){var ze=R.FullPaths[0];Q.slice(0,ze.length)==ze?ze=Q:(ze.slice(-1)!="/"&&(ze+="/"),ze=(ze+Q).replace("//","/")),Me={name:a(Q),type:2},R.FileIndex.push(Me),R.FullPaths.push(ze),Ne||En.utils.cfb_gc(R)}return Me.content=G,Me.size=G?G.length:0,se&&(se.CLSID&&(Me.clsid=se.CLSID),se.mt&&(Me.mt=se.mt),se.ct&&(Me.ct=se.ct)),Me}function fe(R,Q){_(R);var G=En.find(R,Q);if(G){for(var se=0;se<R.FileIndex.length;++se)if(R.FileIndex[se]==G)return R.FileIndex.splice(se,1),R.FullPaths.splice(se,1),!0}return!1}function te(R,Q,G){_(R);var se=En.find(R,Q);if(se){for(var Ne=0;Ne<R.FileIndex.length;++Ne)if(R.FileIndex[Ne]==se)return R.FileIndex[Ne].name=a(G),R.FullPaths[Ne]=G,!0}return!1}function _e(R){E(R,!0)}return e.find=k,e.read=I,e.parse=d,e.write=Oe,e.writeFile=ge,e.utils={cfb_new:Ae,cfb_add:Qe,cfb_del:fe,cfb_mov:te,cfb_gc:_e,ReadShift:Bb,CheckField:Vne,prep_blob:_l,bconcat:Jo,use_zlib:F,_deflateRaw:Te,_inflateRaw:pe,consts:ue},e}();function A4e(t){return typeof t=="string"?oP(t):Array.isArray(t)?U3e(t):t}function Rw(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=oP(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Zf(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([A4e(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Um(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function m4e(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Pi(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function pH(t,e){for(var r=[],n=Pi(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function cP(t){for(var e=[],r=Pi(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function uP(t){for(var e=[],r=Pi(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function p4e(t){for(var e=[],r=Pi(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var $S=new Date(1899,11,30,0,0,0);function Oo(t,e){var r=t.getTime(),n=$S.getTime()+(t.getTimezoneOffset()-$S.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var bne=new Date,g4e=$S.getTime()+(bne.getTimezoneOffset()-$S.getTimezoneOffset())*6e4,gH=bne.getTimezoneOffset();function dP(t){var e=new Date;return e.setTime(t*24*60*60*1e3+g4e),e.getTimezoneOffset()!==gH&&e.setTime(e.getTime()+(e.getTimezoneOffset()-gH)*6e4),e}function x4e(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[s],10)}return e}var xH=new Date("2017-02-19T19:06:09.000Z"),wne=isNaN(xH.getFullYear())?new Date("2/19/17"):xH,v4e=wne.getFullYear()==2017;function Fs(t,e){var r=new Date(t);if(v4e)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(wne.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function hg(t,e){if(ta&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Zf(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Zf(cne(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Zf(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Zf(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function Os(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Os(t[r]));return e}function Ei(t,e){for(var r="";r.length<e;)r+=t;return r}function gf(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var y4e=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lv(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&y4e.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var b4e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function Nne(t){return t?t.content&&t.type?hg(t.content,!0):t.data?zy(t.data):t.asNodeBuffer&&ta?zy(t.asNodeBuffer().toString("binary")):t.asBinary?zy(t.asBinary()):t._data&&t._data.getContent?zy(hg(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Cne(t){if(!t)return null;if(t.data)return iH(t.data);if(t.asNodeBuffer&&ta)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?iH(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function w4e(t){return t&&t.name.slice(-4)===".bin"?Cne(t):Nne(t)}function pd(t,e){for(var r=t.FullPaths||Pi(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function eR(t,e){var r=pd(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ro(t,e,r){if(!r)return w4e(eR(t,e));if(!e)return null;try{return ro(t,e)}catch{return null}}function Bu(t,e,r){if(!r)return Nne(eR(t,e));if(!e)return null;try{return Bu(t,e)}catch{return null}}function N4e(t,e,r){return Cne(eR(t,e))}function vH(t){for(var e=t.FullPaths||Pi(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Jn(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ta?n=DA(r):n=Q3e(r),En.utils.cfb_add(t,e,n)}En.utils.cfb_add(t,e,r)}else t.file(e,r)}function tR(){return En.utils.cfb_new()}function _ne(t,e){switch(e.type){case"base64":return En.read(t,{type:"base64"});case"binary":return En.read(t,{type:"binary"});case"buffer":case"array":return En.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Xy(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Xi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,C4e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,yH=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_4e=/<[^>]*>/g,cc=Xi.match(yH)?yH:_4e,E4e=/<\w*:/,S4e=/<(\/?)\w+:/;function Dn(t,e,r){for(var n={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(C4e),l=0,c="",u=0,d="",f="",A=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(A=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+A,f.length-A),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function gh(t){return t.replace(S4e,"<$1")}var Ene={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rR=cP(Ene),_a=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(l,c){return Ene[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),nR=/[&<>'"]/g,I4e=/[\u0000-\u0008\u000b-\u001f]/g;function rs(t){var e=t+"";return e.replace(nR,function(r){return rR[r]}).replace(I4e,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bH(t){return rs(t).replace(/ /g,"_x0020_")}var Sne=/[\u0000-\u001f]/g;function aR(t){var e=t+"";return e.replace(nR,function(r){return rR[r]}).replace(/\n/g,"<br/>").replace(Sne,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function j4e(t){var e=t+"";return e.replace(nR,function(r){return rR[r]}).replace(Sne,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var wH=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function P4e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ps(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function I5(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function NH(t){var e=Sm(2*t.length),r,n,a=1,s=0,o=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function CH(t){return DA(t,"binary").toString("utf8")}var VC="foo bar baz",cs=ta&&(CH(VC)==I5(VC)&&CH||NH(VC)==I5(VC)&&NH)||I5,Zf=ta?function(t){return DA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},T2=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Ine=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),B4e=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),T4e=/<\/?(?:vt:)?variant>/g,k4e=/<(?:vt:)([^>]*)>([\s\S]*)</;function _H(t,e){var r=Dn(t),n=t.match(B4e(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(T4e,"").match(k4e);o&&a.push({v:cs(o[2]),t:o[1]})}),a}var jne=/(^\s|\s$|\n)/;function Sl(t,e){return"<"+t+(e.match(jne)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function k2(t){return Pi(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Kr(t,e,r){return"<"+t+(r!=null?k2(r):"")+(e!=null?(e.match(jne)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Wk(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function F4e(t,e){switch(typeof t){case"string":var r=Kr("vt:lpwstr",rs(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Kr((t|0)==t?"vt:i4":"vt:r8",rs(String(t)));case"boolean":return Kr("vt:bool",t?"true":"false")}if(t instanceof Date)return Kr("vt:filetime",Wk(t));throw new Error("Unable to serialize "+t)}function sR(t){if(ta&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return cs(Um(Y6(t)));throw new Error("Bad input format: expected Buffer or string")}var F2=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Po={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Rg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Iu={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function O4e(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function D4e(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=n?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)t[r+l]=s&255;t[r+6]=(a&15)<<4|s&15,t[r+7]=a>>4|n}var EH=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,s=t[0][n].length;a<s;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},SH=ta?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:DA(e)})):EH(t)}:EH,IH=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Yh(t,a)));return n.join("").replace(Pc,"")},iR=ta?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Pc,""):IH(t,e,r)}:IH,jH=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},Pne=ta?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):jH(t,e,r)}:jH,PH=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(kx(t,a)));return n.join("")},Mw=ta?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):PH(e,r,n)}:PH,Bne=function(t,e){var r=ju(t,e);return r>0?Mw(t,e+4,e+4+r-1):""},Tne=Bne,kne=function(t,e){var r=ju(t,e);return r>0?Mw(t,e+4,e+4+r-1):""},Fne=kne,One=function(t,e){var r=2*ju(t,e);return r>0?Mw(t,e+4,e+4+r-1):""},Dne=One,Rne=function(e,r){var n=ju(e,r);return n>0?iR(e,r+4,r+4+n):""},Mne=Rne,Lne=function(t,e){var r=ju(t,e);return r>0?Mw(t,e+4,e+4+r):""},Une=Lne,Qne=function(t,e){return O4e(t,e)},KS=Qne,oR=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ta&&(Tne=function(e,r){if(!Buffer.isBuffer(e))return Bne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Fne=function(e,r){if(!Buffer.isBuffer(e))return kne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Dne=function(e,r){if(!Buffer.isBuffer(e))return One(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Mne=function(e,r){if(!Buffer.isBuffer(e))return Rne(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Une=function(e,r){if(!Buffer.isBuffer(e))return Lne(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},KS=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Qne(e,r)},oR=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var kx=function(t,e){return t[e]},Yh=function(t,e){return t[e+1]*256+t[e]},R4e=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ju=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},vp=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},M4e=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Bb(t,e){var r="",n,a,s=[],o,l,c,u;switch(e){case"dbcs":if(u=this.l,ta&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Yh(this,u)),u+=2;t*=2;break;case"utf8":r=Mw(this,this.l,this.l+t);break;case"utf16le":t*=2,r=iR(this,this.l,this.l+t);break;case"wstr":return Bb.call(this,t,"dbcs");case"lpstr-ansi":r=Tne(this,this.l),t=4+ju(this,this.l);break;case"lpstr-cp":r=Fne(this,this.l),t=4+ju(this,this.l);break;case"lpwstr":r=Dne(this,this.l),t=4+2*ju(this,this.l);break;case"lpp4":t=4+ju(this,this.l),r=Mne(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ju(this,this.l),r=Une(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=kx(this,this.l+t++))!==0;)s.push(QC(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Yh(this,this.l+t))!==0;)s.push(QC(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=kx(this,u),this.l=u+1,l=Bb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(QC(Yh(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=kx(this,u),this.l=u+1,l=Bb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(QC(kx(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=kx(this,this.l),this.l++,n;case 2:return n=(e==="i"?R4e:Yh)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?vp:M4e)(this,this.l),this.l+=4,n):(a=ju(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=KS(this,this.l):a=KS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=Pne(this,this.l,t);break}}return this.l+=t,r}var L4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},U4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Q4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function V4e(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)Q4e(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,L4e(this,e,this.l);break;case 8:if(n=8,r==="f"){D4e(this,e,this.l);break}case 16:break;case-4:n=4,U4e(this,e,this.l);break}return this.l+=n,this}function Vne(t,e){var r=Pne(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function _l(t,e){t.l=e,t.read_shift=Bb,t.chk=Vne,t.write_shift=V4e}function lc(t,e){t.l+=e}function cr(t){var e=Sm(t);return _l(e,0),e}function RA(t,e,r){if(t){var n,a,s;_l(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var u=U2[l]||U2[65535];for(n=t.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=t.read_shift(1))&127)<<7*a;c=t.l+s;var d=u.f&&u.f(t,s,r);if(t.l=c,e(d,u,l))return}}}function iu(){var t=[],e=ta?256:2048,r=function(u){var d=cr(u);return _l(d,0),d},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,e)))},o=function(){return a(),Jo(t)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:l,end:o,_bufs:t}}function Nr(t,e,r,n){var a=+e,s;if(!isNaN(a)){n||(n=U2[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&oR(r)&&t.push(r)}}function Tb(t,e,r){var n=Os(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function BH(t,e,r){var n=Os(t);return n.s=Tb(n.s,e.s,r),n.e=Tb(n.e,e.s,r),n}function kb(t,e){if(t.cRel&&t.c<0)for(t=Os(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Os(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=On(t);return!t.cRel&&t.cRel!=null&&(r=K4e(r)),!t.rRel&&t.rRel!=null&&(r=H4e(r)),r}function j5(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+li(t.s.c)+":"+(t.e.cRel?"":"$")+li(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+zi(t.s.r)+":"+(t.e.rRel?"":"$")+zi(t.e.r):kb(t.s,e.biff)+":"+kb(t.e,e.biff)}function lR(t){return parseInt($4e(t),10)-1}function zi(t){return""+(t+1)}function H4e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $4e(t){return t.replace(/\$(\d+)$/,"$1")}function cR(t){for(var e=G4e(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function li(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function K4e(t){return t.replace(/^([A-Z])/,"$$$1")}function G4e(t){return t.replace(/^\$([A-Z])/,"$1")}function q4e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ci(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function On(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ou(t){var e=t.indexOf(":");return e==-1?{s:ci(t),e:ci(t)}:{s:ci(t.slice(0,e)),e:ci(t.slice(e+1))}}function Wn(t,e){return typeof e>"u"||typeof e=="number"?Wn(t.s,t.e):(typeof t!="string"&&(t=On(t)),typeof e!="string"&&(e=On(e)),t==e?t:t+":"+e)}function Ea(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=t.length;for(r=0;n<s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function TH(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Od(t.z,r?Oo(e):e)}catch{}try{return t.w=Od((t.XF||{}).numFmtId||(r?14:0),r?Oo(e):e)}catch{return""+e}}function bA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?MA[t.v]||t.v:e==null?TH(t,t.v):TH(t,e))}function Qm(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Hne(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,s=t||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ci(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ea(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var A=0;A!=e[f].length;++A)if(!(typeof e[f][A]>"u")){var h={v:e[f][A]},m=o+f,p=l+A;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),e[f][A]&&typeof e[f][A]=="object"&&!Array.isArray(e[f][A])&&!(e[f][A]instanceof Date))h=e[f][A];else if(Array.isArray(h.v)&&(h.f=e[f][A][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||kn[14],n.cellDates?(h.t="d",h.w=Od(h.z,Oo(h.v))):(h.t="n",h.v=Oo(h.v),h.w=Od(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var x=On({c:p,r:m});s[x]&&s[x].z&&(h.z=s[x].z),s[x]=h}}}return u.s.c<1e7&&(s["!ref"]=Wn(u)),s}function y1(t,e){return Hne(null,t,e)}function z4e(t){return t.read_shift(4,"i")}function xf(t,e){return e||(e=cr(4)),e.write_shift(4,t),e}function sc(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Zo(t,e){var r=!1;return e==null&&(r=!0,e=cr(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function W4e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function X4e(t,e){return e||(e=cr(4)),e.write_shift(2,0),e.write_shift(2,0),e}function uR(t,e){var r=t.l,n=t.read_shift(1),a=sc(t),s=[],o={t:a,h:a};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)s.push(W4e(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function Y4e(t,e){var r=!1;return e==null&&(r=!0,e=cr(15+4*t.t.length)),e.write_shift(1,0),Zo(t.t,e),r?e.slice(0,e.l):e}var J4e=uR;function Z4e(t,e){var r=!1;return e==null&&(r=!0,e=cr(23+4*t.t.length)),e.write_shift(1,1),Zo(t.t,e),e.write_shift(4,1),X4e({},e),r?e.slice(0,e.l):e}function Qd(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Mg(t,e){return e==null&&(e=cr(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Lg(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ug(t,e){return e==null&&(e=cr(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var e5e=sc,$ne=Zo;function dR(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function GS(t,e){var r=!1;return e==null&&(r=!0,e=cr(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var t5e=sc,Xk=dR,fR=GS;function hR(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?KS([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):vp(e,0)>>2;return r?a/100:a}function Kne(t,e){e==null&&(e=cr(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Gne(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function r5e(t,e){return e||(e=cr(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Qg=Gne,b1=r5e;function nc(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ag(t,e){return(e||cr(8)).write_shift(8,t,"f")}function n5e(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var u=Up[a];u&&(e.rgb=D2(u));break;case 2:e.rgb=D2([o,l,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function qS(t,e){if(e||(e=cr(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function a5e(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function s5e(t,e){e||(e=cr(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function qne(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function i5e(t){return qne(t,1)}function o5e(t){return qne(t,2)}var AR=2,zc=3,HC=11,kH=12,zS=19,$C=64,l5e=65,c5e=71,u5e=4108,d5e=4126,Wo=80,zne=81,f5e=[Wo,zne],Yk={1:{n:"CodePage",t:AR},2:{n:"Category",t:Wo},3:{n:"PresentationFormat",t:Wo},4:{n:"ByteCount",t:zc},5:{n:"LineCount",t:zc},6:{n:"ParagraphCount",t:zc},7:{n:"SlideCount",t:zc},8:{n:"NoteCount",t:zc},9:{n:"HiddenCount",t:zc},10:{n:"MultimediaClipCount",t:zc},11:{n:"ScaleCrop",t:HC},12:{n:"HeadingPairs",t:u5e},13:{n:"TitlesOfParts",t:d5e},14:{n:"Manager",t:Wo},15:{n:"Company",t:Wo},16:{n:"LinksUpToDate",t:HC},17:{n:"CharacterCount",t:zc},19:{n:"SharedDoc",t:HC},22:{n:"HyperlinksChanged",t:HC},23:{n:"AppVersion",t:zc,p:"version"},24:{n:"DigSig",t:l5e},26:{n:"ContentType",t:Wo},27:{n:"ContentStatus",t:Wo},28:{n:"Language",t:Wo},29:{n:"Version",t:Wo},255:{},2147483648:{n:"Locale",t:zS},2147483651:{n:"Behavior",t:zS},1919054434:{}},Jk={1:{n:"CodePage",t:AR},2:{n:"Title",t:Wo},3:{n:"Subject",t:Wo},4:{n:"Author",t:Wo},5:{n:"Keywords",t:Wo},6:{n:"Comments",t:Wo},7:{n:"Template",t:Wo},8:{n:"LastAuthor",t:Wo},9:{n:"RevNumber",t:Wo},10:{n:"EditTime",t:$C},11:{n:"LastPrinted",t:$C},12:{n:"CreatedDate",t:$C},13:{n:"ModifiedDate",t:$C},14:{n:"PageCount",t:zc},15:{n:"WordCount",t:zc},16:{n:"CharCount",t:zc},17:{n:"Thumbnail",t:c5e},18:{n:"Application",t:Wo},19:{n:"DocSecurity",t:zc},255:{},2147483648:{n:"Locale",t:zS},2147483651:{n:"Behavior",t:zS},1919054434:{}},FH={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},h5e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function A5e(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var m5e=A5e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Up=Os(m5e),MA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Wne={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zk={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},KC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function mR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function p5e(t){var e=mR();if(!t||!t.match)return e;var r={};if((t.match(cc)||[]).forEach(function(n){var a=Dn(n);switch(a[0].replace(E4e,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Zk[a.ContentType]]!==void 0&&e[Zk[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Po.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Xne(t,e){var r=p4e(Zk),n=[],a;n[n.length]=Xi,n[n.length]=Kr("Types",null,{xmlns:Po.CT,"xmlns:xsd":Po.xsd,"xmlns:xsi":Po.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Kr("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(a=t[c][0],n[n.length]=Kr("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:KC[c][e.bookType]||KC[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Kr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:KC[c][e.bookType]||KC[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Kr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ia={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function O2(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Fb(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(cc)||[]).forEach(function(a){var s=Dn(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Xy(s.Target,e);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function pv(t){var e=[Xi,Kr("Relationships",null,{xmlns:Po.RELS})];return Pi(t["!id"]).forEach(function(r){e[e.length]=Kr("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ja(t,e,r,n,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[ia.HLINK,ia.XPATH,ia.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var g5e="application/vnd.oasis.opendocument.spreadsheet";function x5e(t,e){for(var r=sR(t),n,a;n=F2.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Dn(n[0],!1),a.path=="/"&&a.type!==g5e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function v5e(t){var e=[Xi];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function OH(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function y5e(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function b5e(t){var e=[Xi];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(OH(t[r][0],t[r][1])),e.push(y5e("",t[r][0]));return e.push(OH("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Yne(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+US.version+"</meta:generator></office:meta></office:document-meta>"}var Pd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],w5e=function(){for(var t=new Array(Pd.length),e=0;e<Pd.length;++e){var r=Pd[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Jne(t){var e={};t=cs(t);for(var r=0;r<Pd.length;++r){var n=Pd[r],a=t.match(w5e[r]);a!=null&&a.length>0&&(e[n[1]]=_a(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Fs(e[n[1]]))}return e}function P5(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=rs(e),n[n.length]=r?Kr(t,e,r):Sl(t,e))}function Zne(t,e){var r=e||{},n=[Xi,Kr("cp:coreProperties",null,{"xmlns:cp":Po.CORE_PROPS,"xmlns:dc":Po.dc,"xmlns:dcterms":Po.dcterms,"xmlns:dcmitype":Po.dcmitype,"xmlns:xsi":Po.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&P5("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Wk(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&P5("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Wk(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Pd.length;++s){var o=Pd[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&P5(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Qp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],eae=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function tae(t,e,r,n){var a=[];if(typeof t=="string")a=_H(t,n);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(d){return{v:d}}));var o=typeof e=="string"?_H(e,n).map(function(d){return d.v}):e,l=0,c=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function N5e(t,e,r){var n={};return e||(e={}),t=cs(t),Qp.forEach(function(a){var s=(t.match(T2(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=_a(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&tae(n.HeadingPairs,n.TitlesOfParts,e,r),e}function rae(t){var e=[],r=Kr;return t||(t={}),t.Application="SheetJS",e[e.length]=Xi,e[e.length]=Kr("Properties",null,{xmlns:Po.EXT_PROPS,"xmlns:vt":Po.vt}),Qp.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=rs(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+rs(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var C5e=/<[^>]+>[^<]*/g;function _5e(t,e){var r={},n="",a=t.match(C5e);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=Dn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=_a(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=_a(d);break;case"bool":r[n]=Ps(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Fs(d);break;case"cy":case"error":r[n]=_a(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function nae(t){var e=[Xi,Kr("Properties",null,{xmlns:Po.CUST_PROPS,"xmlns:vt":Po.vt})];if(!t)return e.join("");var r=1;return Pi(t).forEach(function(a){++r,e[e.length]=Kr("property",F4e(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rs(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var eF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},B5;function E5e(t,e,r){B5||(B5=cP(eF)),e=B5[e]||e,t[e]=r}function S5e(t,e){var r=[];return Pi(eF).map(function(n){for(var a=0;a<Pd.length;++a)if(Pd[a][1]==n)return Pd[a];for(a=0;a<Qp.length;++a)if(Qp[a][1]==n)return Qp[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Sl(eF[n[1]]||n[1],a))}}),Kr("DocumentProperties",r.join(""),{xmlns:Iu.o})}function I5e(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Pi(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Pd.length;++o)if(s==Pd[o][1])return;for(o=0;o<Qp.length;++o)if(s==Qp[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=t[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Kr(bH(s),l,{"dt:dt":c}))}}),e&&Pi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Kr(bH(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Iu.o+'">'+a.join("")+"</"+n+">"}function pR(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function j5e(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=cr(8);return o.write_shift(4,n),o.write_shift(4,a),o}function aae(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function sae(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function iae(t,e,r){return e===31?sae(t):aae(t,e,r)}function tF(t,e,r){return iae(t,e,r===!1?0:4)}function P5e(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return iae(t,e,0)}function B5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Pc,""),t.l-a&2&&(t.l+=2)}return r}function T5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Pc,"");return r}function k5e(t){var e=t.l,r=WS(t,zne);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=WS(t,zc);return[r,n]}function F5e(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(k5e(t));return r}function DH(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Pc,"").replace(Wy,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function oae(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function O5e(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function WS(t,e,r){var n=t.read_shift(2),a,s=r||{};if(t.l+=2,e!==kH&&n!==e&&f5e.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===kH?n:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return aae(t,n,4).replace(Pc,"");case 31:return sae(t);case 64:return pR(t);case 65:return oae(t);case 71:return O5e(t);case 80:return tF(t,n,!s.raw).replace(Pc,"");case 81:return P5e(t,n).replace(Pc,"");case 4108:return F5e(t);case 4126:case 4127:return n==4127?B5e(t):T5e(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function RH(t,e){var r=cr(4),n=cr(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=cr(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=j5e(e);break;case 31:case 80:for(n=cr(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Jo([r,n])}function MH(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=a;++o){var d=t.read_shift(4),f=t.read_shift(4);s[o]=[d,f+r]}s.sort(function(y,b){return y[1]-b[1]});var A={};for(o=0;o!=a;++o){if(t.l!==s[o][1]){var h=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(h=!1,t.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[s[o][0]];if(A[m.n]=WS(t,m.t,{raw:!0}),m.p==="version"&&(A[m.n]=String(A[m.n]>>16)+"."+("0000"+String(A[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(A[m.n]){case 0:A[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ff(l=A[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+A[m.n])}}else if(s[o][0]===1){if(l=A.CodePage=WS(t,AR),ff(l),c!==-1){var p=t.l;t.l=s[c][1],u=DH(t,l),t.l=p}}else if(s[o][0]===0){if(l===0){c=o,t.l=s[o+1][1];continue}u=DH(t,l)}else{var x=u[s[o][0]],v;switch(t[t.l]){case 65:t.l+=4,v=oae(t);break;case 30:t.l+=4,v=tF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=tF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=Mi(t,4);break;case 64:t.l+=4,v=Fs(pR(t));break;default:throw new Error("unparsed value: "+t[t.l])}A[x]=v}}return t.l=r+n,A}var lae=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function D5e(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function LH(t,e,r){var n=cr(8),a=[],s=[],o=8,l=0,c=cr(8),u=cr(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!e){u=cr(8),u.write_shift(4,0),a.unshift(u);var d=[cr(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=cr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Jo(d),s.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(lae.indexOf(t[l][0])>-1||eae.indexOf(t[l][0])>-1)&&t[l][1]!=null){var A=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof A=="string"){var p=A.split(".");A=(+p[0]<<16)+(+p[1]||0)}c=RH(m.t,A)}else{var x=D5e(A);x==-1&&(x=31,A=String(A)),c=RH(x,A)}s.push(c),u=cr(8),u.write_shift(4,e?h:2+l),a.push(u),o+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Jo([n].concat(a).concat(s))}function UH(t,e,r){var n=t.content;if(!n)return{};_l(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==En.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=MH(n,e),A={SystemIdentifier:u};for(var h in f)A[h]=f[h];if(A.FMTID=s,a===1)return A;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=MH(n,null)}catch{}for(h in m)A[h]=m[h];return A.FMTID=[s,o],A}function QH(t,e,r,n,a,s){var o=cr(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,En.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var c=LH(t,r,n);if(l.push(c),a){var u=LH(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Jo(l)}function A0(t,e){return t.read_shift(e),null}function R5e(t,e){e||(e=cr(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function M5e(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Mi(t,e){return t.read_shift(e)===1}function Nc(t,e){return e||(e=cr(2)),e.write_shift(2,+!!t),e}function no(t){return t.read_shift(2,"u")}function gd(t,e){return e||(e=cr(2)),e.write_shift(2,t),e}function cae(t,e){return M5e(t,e,no)}function L5e(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function uae(t,e,r){return r||(r=cr(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Lw(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function U5e(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return a&&(t.l+=4*o),n&&(t.l+=l),c.t=d,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Q5e(t){var e=t.t||"",r=cr(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=cr(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return Jo(a)}function mg(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Uw(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):mg(t,n,r)}function Vg(t,e,r){if(r.biff>5)return Uw(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function dae(t,e,r){return r||(r=cr(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function V5e(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function H5e(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Pc,"");return n&&(t.l+=24),a}function $5e(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Pc,"");return r+o}function K5e(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return H5e(t);case"0303000000000000c000000000000046":return $5e(t);default:throw new Error("Unsupported Moniker "+r)}}function GC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Pc,""):"";return r}function VH(t,e){e||(e=cr(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function G5e(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var s,o,l,c,u="",d,f;a&16&&(s=GC(t,r-t.l)),a&128&&(o=GC(t,r-t.l)),(a&257)===257&&(l=GC(t,r-t.l)),(a&257)===1&&(c=K5e(t,r-t.l)),a&8&&(u=GC(t,r-t.l)),a&32&&(d=t.read_shift(16)),a&64&&(f=pR(t)),t.l=r;var A=o||l||c||"";A&&u&&(A+="#"+u),A||(A="#"+u),a&2&&A.charAt(0)=="/"&&A.charAt(1)!="/"&&(A="file://"+A);var h={Target:A};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function q5e(t){var e=cr(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),VH(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),s&8&&VH(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function fae(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function hae(t,e){var r=fae(t);return r[3]=0,r}function xh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function pg(t,e,r,n){return n||(n=cr(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function z5e(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function W5e(t,e,r){return e===0?"":Vg(t,e,r)}function X5e(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,s,o]}function Aae(t){var e=t.read_shift(2),r=hR(t);return[e,r]}function Y5e(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=Lw(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,a}function fP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function mae(t,e){return e||(e=cr(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function pae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var J5e=pae;function gae(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Z5e(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function eBe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Gl(t){t.l+=2,t.l+=t.read_shift(2)}var tBe={0:Gl,4:Gl,5:Gl,6:Gl,7:eBe,8:Gl,9:Gl,10:Gl,11:Gl,12:Gl,13:Z5e,14:Gl,15:Gl,16:Gl,17:Gl,18:Gl,19:Gl,20:Gl,21:gae};function rBe(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(tBe[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function qC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function gR(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=cr(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function nBe(t,e){return e===0||t.read_shift(2),1200}function aBe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Vg(t,0,r);return t.read_shift(e+n-t.l),a}function sBe(t,e){var r=!e||e.biff==8,n=cr(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function iBe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function oBe(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Lw(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function lBe(t,e){var r=!e||e.biff>=8?2:1,n=cr(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function cBe(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0;o!=a&&t.l<r;++o)s.push(U5e(t));return s.Count=n,s.Unique=a,s}function uBe(t,e){var r=cr(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=Q5e(t[a]);var s=Jo([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function dBe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function fBe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function hBe(t){var e=z5e(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function ABe(t){return t.read_shift(2),t.read_shift(4)}function HH(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function mBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function pBe(){var t=cr(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function gBe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function xBe(t){var e=cr(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function vBe(){}function yBe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Lw(t,0,r),n}function bBe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,s=cr(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function wBe(t){var e=xh(t);return e.isst=t.read_shift(4),e}function NBe(t,e,r,n){var a=cr(10);return pg(t,e,n,a),a.write_shift(4,r),a}function CBe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=xh(t);r.biff==2&&t.l++;var s=Uw(t,n-t.l,r);return a.val=s,a}function _Be(t,e,r,n,a){var s=!a||a.biff==8,o=cr(8+ +s+(1+s)*r.length);return pg(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function EBe(t,e,r){var n=t.read_shift(2),a=Vg(t,0,r);return[n,a]}function SBe(t,e,r,n){var a=r&&r.biff==5;n||(n=cr(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var IBe=Vg;function $H(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,s=t.read_shift(a),o=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:l},e:{r:o,c}}}function jBe(t,e){var r=e.biff==8||!e.biff?4:2,n=cr(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function PBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=Aae(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function BBe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(Aae(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function TBe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function kBe(t,e,r,n){var a={},s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=h5e[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function FBe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=kBe(t,e,n.fStyle,r),n}function KH(t,e,r,n){var a=r&&r.biff==5;n||(n=cr(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function OBe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function DBe(t){var e=cr(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function GH(t,e,r){var n=xh(t);(r.biff==2||e==9)&&++t.l;var a=L5e(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function RBe(t,e,r,n,a,s){var o=cr(8);return pg(t,e,n,o),uae(r,s,o),o}function MBe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=xh(t),a=nc(t);return n.val=a,n}function LBe(t,e,r,n){var a=cr(14);return pg(t,e,n,a),Ag(r,a),a}var qH=W5e;function UBe(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=mg(t,s),l=[];n>t.l;)l.push(Uw(t));return[s,a,o,l]}function zH(t,e,r){var n=t.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Y5e(t,e-2,r)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var QBe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function WH(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=mg(t,o,r);a&32&&(u=QBe[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var f=n==t.l||l===0||!(d>0)?[]:rDe(t,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function xae(t,e,r){if(r.biff<8)return VBe(t,e,r);for(var n=[],a=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(X5e(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function VBe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Lw(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function HBe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),s=mg(t,n,r),o=mg(t,a,r);return[s,o]}function $Be(t,e,r){var n=pae(t);t.l++;var a=t.read_shift(1);return e-=8,[nDe(t,e,r),a,n]}function XH(t,e,r){var n=J5e(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,eDe(t,e,r)]}function KBe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function GBe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=Vg(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},l,o,s]}}function qBe(t,e,r){return GBe(t,e,r)}function zBe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(fP(t));return r}function WBe(t){var e=cr(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)mae(t[r],e);return e}function XBe(t,e,r){if(r&&r.biff<8)return JBe(t,e,r);var n=gae(t),a=rBe(t,e-22,n[1]);return{cmo:n,ft:a}}var YBe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function JBe(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((YBe[n]||lc)(t,e,r)),{cmo:[a,n,s],ft:o}}function ZBe(t,e,r){var n=t.l,a="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=V5e(t,6,r);var l=t.read_shift(2);t.read_shift(2),no(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],f=mg(t,t.lens[u+1]-t.lens[u]-1);if(a+=f,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function eTe(t,e){var r=fP(t);t.l+=16;var n=G5e(t,e-24);return[r,n]}function tTe(t){var e=cr(24),r=ci(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return Jo([e,q5e(t[1])])}function rTe(t,e){t.read_shift(2);var r=fP(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Pc,""),[r,n]}function nTe(t){var e=t[1].Tooltip,r=cr(10+2*(e.length+1));r.write_shift(2,2048);var n=ci(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function aTe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=FH[r]||r,r=t.read_shift(2),e[1]=FH[r]||r,e}function sTe(t){return t||(t=cr(4)),t.write_shift(2,1),t.write_shift(2,1),t}function iTe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(hae(t));return r}function oTe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(hae(t));return r}function lTe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function vae(t,e,r){if(!r.cellStyles)return lc(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function cTe(t,e){var r=cr(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function uTe(t,e){var r={};return e<32||(t.l+=16,r.header=nc(t),r.footer=nc(t),t.l+=2),r}function dTe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function fTe(t){for(var e=cr(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var hTe=xh,ATe=cae,mTe=Uw;function pTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function gTe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=xh(t);++t.l;var a=Vg(t,e-7,r);return n.t="str",n.val=a,n}function xTe(t){var e=xh(t);++t.l;var r=nc(t);return e.t="n",e.val=r,e}function vTe(t,e,r){var n=cr(15);return $w(n,t,e),n.write_shift(8,r,"f"),n}function yTe(t){var e=xh(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function bTe(t,e,r){var n=cr(9);return $w(n,t,e),n.write_shift(2,r),n}function wTe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function NTe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function CTe(t,e,r){var n=t.l+e,a=xh(t),s=t.read_shift(2),o=mg(t,s,r);return t.l=n,a.t="str",a.val=o,a}var _Te=[2,3,48,49,131,139,140,245],rF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=cP({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Sm(1);switch(c.type){case"base64":d=Pu(Hu(l));break;case"binary":d=Pu(l);break;case"buffer":case"array":d=l;break}_l(d,0);var f=d.read_shift(1),A=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,A=!0;break;case 49:h=!0,A=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=d.read_shift(2));var v=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=t[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var b=[],w={},j=Math.min(d.length,f==2?521:x-10-(h?264:0)),I=m?32:11;d.l<j&&d[d.l]!=13;)switch(w={},w.name=j2.utils.decode(y,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,w.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),f==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&b.push(w),f!=2&&(d.l+=m?13:14),w.type){case"B":(!h||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var _=0,S=0;for(u[0]=[],S=0;S!=b.length;++S)u[0][S]=b[S].name;for(;p-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++_]=[],S=0,S=0;S!=b.length;++S){var E=d.slice(d.l,d.l+b[S].len);d.l+=b[S].len,_l(E,0);var B=j2.utils.decode(y,E);switch(b[S].type){case"C":B.trim().length&&(u[_][S]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[_][S]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[_][S]=B;break;case"F":u[_][S]=parseFloat(B.trim());break;case"+":case"I":u[_][S]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[_][S]=!0;break;case"N":case"F":u[_][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!A)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[_][S]="##MEMO##"+(m?parseInt(B.trim(),10):E.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[_][S]=+B||0);break;case"@":u[_][S]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[_][S]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[_][S]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][S]=-E.read_shift(-8,"f");break;case"B":if(h&&b[S].len==8){u[_][S]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=y1(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{return Qm(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&ff(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=iu(),f=JS(l,{header:1,raw:!0,cellDates:!0}),A=f[0],h=f.slice(1),m=l["!cols"]||[],p=0,x=0,v=0,y=1;for(p=0;p<A.length;++p){if(((m[p]||{}).DBF||{}).name){A[p]=m[p].DBF.name,++v;continue}if(A[p]!=null){if(++v,typeof A[p]=="number"&&(A[p]=A[p].toString(10)),typeof A[p]!="string")throw new Error("DBF Invalid column name "+A[p]+" |"+typeof A[p]+"|");if(A.indexOf(A[p])!==p){for(x=0;x<1024;++x)if(A.indexOf(A[p]+"_"+x)==-1){A[p]+="_"+x;break}}}}var b=Ea(l["!ref"]),w=[],j=[],I=[];for(p=0;p<=b.e.c-b.s.c;++p){var _="",S="",E=0,B=[];for(x=0;x<h.length;++x)h[x][p]!=null&&B.push(h[x][p]);if(B.length==0||A[p]==null){w[p]="?";continue}for(x=0;x<B.length;++x){switch(typeof B[x]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=B[x]instanceof Date?"D":"C";break;default:S="C"}E=Math.max(E,String(B[x]).length),_=_&&_!=S?"C":S}E>250&&(E=250),S=((m[p]||{}).DBF||{}).type,S=="C"&&m[p].DBF.len>E&&(E=m[p].DBF.len),_=="B"&&S=="N"&&(_="N",I[p]=m[p].DBF.dec,E=m[p].DBF.len),j[p]=_=="C"||S=="N"?E:s[_]||0,y+=j[p],w[p]=_}var k=d.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*v),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[lne]||3)<<8),p=0,x=0;p<A.length;++p)if(A[p]!=null){var P=d.next(32),O=(A[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,O,"sbcs"),P.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),P.write_shift(4,x),P.write_shift(1,j[p]||s[w[p]]||0),P.write_shift(1,I[p]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),x+=j[p]||s[w[p]]||0}var z=d.next(264);for(z.write_shift(4,13),p=0;p<65;++p)z.write_shift(4,0);for(p=0;p<h.length;++p){var oe=d.next(y);for(oe.write_shift(1,0),x=0;x<A.length;++x)if(A[x]!=null)switch(w[x]){case"L":oe.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":oe.write_shift(8,h[p][x]||0,"f");break;case"N":var ce="0";for(typeof h[p][x]=="number"&&(ce=h[p][x].toFixed(I[x]||0)),v=0;v<j[x]-ce.length;++v)oe.write_shift(1,32);oe.write_shift(1,ce,"sbcs");break;case"D":h[p][x]?(oe.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(h[p][x]!=null?h[p][x]:"").slice(0,j[x]);for(oe.write_shift(1,ue,"sbcs"),v=0;v<j[x]-ue.length;++v)oe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),yae=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Pi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(A,h){var m=t[h];return typeof m=="number"?oH(m):m},n=function(A,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?A:oH(p)};t["|"]=254;function a(A,h){switch(h.type){case"base64":return s(Hu(A),h);case"binary":return s(A,h);case"buffer":return s(ta&&Buffer.isBuffer(A)?A.toString("binary"):Um(A),h);case"array":return s(hg(A),h)}throw new Error("Unrecognized type "+h.type)}function s(A,h){var m=A.split(/[\n\r]+/),p=-1,x=-1,v=0,y=0,b=[],w=[],j=null,I={},_=[],S=[],E=[],B=0,k;for(+h.codepage>=0&&ff(+h.codepage);v!==m.length;++v){B=0;var P=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),O=P.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),z=O[0],oe;if(P.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&w.push(P.slice(3).replace(/;;/g,";"));break;case"C":var ce=!1,ue=!1,ge=!1,ne=!1,Oe=-1,Ue=-1;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"A":break;case"X":x=parseInt(O[y].slice(1))-1,ue=!0;break;case"Y":for(p=parseInt(O[y].slice(1))-1,ue||(x=0),k=b.length;k<=p;++k)b[k]=[];break;case"K":oe=O[y].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(gf(oe))?isNaN(Lv(oe).getDate())||(oe=Fs(oe)):(oe=gf(oe),j!==null&&x1(j)&&(oe=dP(oe))),ce=!0;break;case"E":ne=!0;var F=gv(O[y].slice(1),{r:p,c:x});b[p][x]=[b[p][x],F];break;case"S":ge=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":Oe=parseInt(O[y].slice(1))-1;break;case"C":Ue=parseInt(O[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(ce&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=oe:b[p][x]=oe,j=null),ge){if(ne)throw new Error("SYLK shared formula cannot have own formula");var H=Oe>-1&&b[Oe][Ue];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=Mae(H[1],{r:p-Oe,c:x-Ue})}break;case"F":var K=0;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"X":x=parseInt(O[y].slice(1))-1,++K;break;case"Y":for(p=parseInt(O[y].slice(1))-1,k=b.length;k<=p;++k)b[k]=[];break;case"M":B=parseInt(O[y].slice(1))/20;break;case"F":break;case"G":break;case"P":j=w[parseInt(O[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=O[y].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)B=parseInt(E[2],10),S[k-1]=B===0?{hidden:!0}:{wch:B},Im(S[k-1]);break;case"C":x=parseInt(O[y].slice(1))-1,S[x]||(S[x]={});break;case"R":p=parseInt(O[y].slice(1))-1,_[p]||(_[p]={}),B>0?(_[p].hpt=B,_[p].hpx=Qv(B)):B===0&&(_[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}K<1&&(j=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return _.length>0&&(I["!rows"]=_),S.length>0&&(I["!cols"]=S),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,I]}function o(A,h){var m=a(A,h),p=m[0],x=m[1],v=y1(p,h);return Pi(x).forEach(function(y){v[y]=x[y]}),v}function l(A,h){return Qm(o(A,h),h)}function c(A,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(A.t){case"n":x+=A.v||0,A.f&&!A.F&&(x+=";E"+NR(A.f,{r:m,c:p}));break;case"b":x+=A.v?"TRUE":"FALSE";break;case"e":x+=A.w||A.v;break;case"d":x+='"'+(A.w||A.v)+'"';break;case"s":x+='"'+A.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(A,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=R2(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=M2(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&A.push(x)})}function d(A,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*L2(m.hpx)+";"),x.length>2&&A.push(x+"R"+(p+1))})}function f(A,h){var m=["ID;PWXL;N;E"],p=[],x=Ea(A["!ref"]),v,y=Array.isArray(A),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),A["!cols"]&&u(m,A["!cols"]),A["!rows"]&&d(m,A["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var w=x.s.r;w<=x.e.r;++w)for(var j=x.s.c;j<=x.e.c;++j){var I=On({r:w,c:j});v=y?(A[w]||[])[j]:A[I],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,A,w,j))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),bae=function(){function t(s,o){switch(o.type){case"base64":return e(Hu(s),o);case"binary":return e(s,o);case"buffer":return e(ta&&Buffer.isBuffer(s)?s.toString("binary"):Um(s),o);case"array":return e(hg(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var A=l[d].trim().split(","),h=A[0],m=A[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(gf(m))?isNaN(Lv(m).getDate())?f[c][u]=m:f[c][u]=Fs(m):f[c][u]=gf(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return y1(t(s,o),o)}function n(s,o){return Qm(r(s,o),o)}var a=function(){var s=function(c,u,d,f,A){c.push(u),c.push(d+","+f),c.push('"'+A.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ea(c["!ref"]),f,A=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var p=On({r:h,c:m});if(f=A?(c[h]||[])[m]:c[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,x,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Od(f.z||kn[14],Oo(Fs(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),wae=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,A){for(var h=f.split(`
`),m=-1,p=-1,x=0,v=[];x!==h.length;++x){var y=h[x].trim().split(":");if(y[0]==="cell"){var b=ci(y[1]);if(v.length<=b.r)for(m=v.length;m<=b.r;++m)v[m]||(v[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":v[m][p]=t(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],w])}}}return A&&A.sheetRows&&(v=v.slice(0,A.sheetRows)),v}function n(f,A){return y1(r(f,A),A)}function a(f,A){return Qm(n(f,A),A)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var A=[],h=[],m,p="",x=ou(f["!ref"]),v=Array.isArray(f),y=x.s.r;y<=x.e.r;++y)for(var b=x.s.c;b<=x.e.c;++b)if(p=On({r:y,c:b}),m=v?(f[y]||[])[b]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var w=Oo(Fs(m.v));h[2]="vtc",h[3]="nd",h[4]=""+w,h[5]=m.w||Od(m.z||kn[14],w);break;case"e":continue}A.push(h.join(":"))}return A.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),A.push("valueformat:1:text-wiki"),A.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Uv=function(){function t(d,f,A,h,m){m.raw?f[A][h]=d:d===""||(d==="TRUE"?f[A][h]=!0:d==="FALSE"?f[A][h]=!1:isNaN(gf(d))?isNaN(Lv(d).getDate())?f[A][h]=d:f[A][h]=Fs(d):f[A][h]=gf(d))}function e(d,f){var A=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,x=Math.max(x,v);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,x).trim(),h,y,b,A),b=1;b<=(m[y].length-x)/10+1;++b)t(m[y].slice(x+(b-1)*10,x+b*10).trim(),h,y,b,A)}return A.sheetRows&&(h=h.slice(0,A.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},A=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?A=!A:!A&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function s(d,f){var A=f||{},h="",m=A.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):A&&A.FS?h=A.FS:h=a(d.slice(0,1024));var x=0,v=0,y=0,b=0,w=0,j=h.charCodeAt(0),I=!1,_=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=A.dateNF!=null?d4e(A.dateNF):null;function B(){var k=d.slice(b,w),P={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)P.t="z";else if(A.raw)P.t="s",P.v=k;else if(k.trim().length===0)P.t="s",P.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(P.t="s",P.v=k.slice(2,-1).replace(/""/g,'"')):UFe(k)?(P.t="n",P.f=k.slice(1)):(P.t="s",P.v=k);else if(k=="TRUE")P.t="b",P.v=!0;else if(k=="FALSE")P.t="b",P.v=!1;else if(!isNaN(y=gf(k)))P.t="n",A.cellText!==!1&&(P.w=k),P.v=y;else if(!isNaN(Lv(k).getDate())||E&&k.match(E)){P.z=A.dateNF||kn[14];var O=0;E&&k.match(E)&&(k=f4e(k,A.dateNF,k.match(E)||[]),O=1),A.cellDates?(P.t="d",P.v=Fs(k,O)):(P.t="n",P.v=Oo(Fs(k,O))),A.cellText!==!1&&(P.w=Od(P.z,P.v instanceof Date?Oo(P.v):P.v)),A.cellNF||delete P.z}else P.t="s",P.v=k;if(P.t=="z"||(A.dense?(m[x]||(m[x]=[]),m[x][v]=P):m[On({c:v,r:x})]=P),b=w+1,S=d.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<x&&(p.e.r=x),_==j)++v;else if(v=0,++x,A.sheetRows&&A.sheetRows<=x)return!0}e:for(;w<d.length;++w)switch(_=d.charCodeAt(w)){case 34:S===34&&(I=!I);break;case j:case 10:case 13:if(!I&&B())break e;break}return w-b>0&&B(),m["!ref"]=Wn(p),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):y1(e(d,f),f)}function l(d,f){var A="",h=f.type=="string"?[0,0,0,0]:BR(d,f);switch(f.type){case"base64":A=Hu(d);break;case"binary":A=d;break;case"buffer":f.codepage==65001?A=d.toString("utf8"):f.codepage&&typeof j2<"u"||(A=ta&&Buffer.isBuffer(d)?d.toString("binary"):Um(d));break;case"array":A=hg(d);break;case"string":A=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?A=cs(A.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?A=cs(A):f.type=="binary"&&typeof j2<"u",A.slice(0,19)=="socialcalc:version:"?wae.to_sheet(f.type=="string"?A:cs(A),f):o(A,f)}function c(d,f){return Qm(l(d,f),f)}function u(d){for(var f=[],A=Ea(d["!ref"]),h,m=Array.isArray(d),p=A.s.r;p<=A.e.r;++p){for(var x=[],v=A.s.c;v<=A.e.c;++v){var y=On({r:p,c:v});if(h=m?(d[p]||[])[v]:d[y],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(bA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(v===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function ETe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=yae.to_workbook(t,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Uv.to_workbook(t,e)}}var Vp=function(){function t(F,H,K){if(F){_l(F,F.l||0);for(var U=K.Enum||Oe;F.l<F.length;){var W=F.read_shift(2),X=U[W]||U[65535],D=F.read_shift(2),V=F.l+D,Z=X.f&&X.f(F,D,K);if(F.l=V,H(Z,X,W))return}}}function e(F,H){switch(H.type){case"base64":return r(Pu(Hu(F)),H);case"binary":return r(Pu(F),H);case"buffer":case"array":return r(F,H)}throw"Unsupported type "+H.type}function r(F,H){if(!F)return F;var K=H||{},U=K.dense?[]:{},W="Sheet1",X="",D=0,V={},Z=[],be=[],L={s:{r:0,c:0},e:{r:0,c:0}},Xe=K.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)K.Enum=Oe,t(F,function(ie,He,Ge){switch(Ge){case 0:K.vers=ie,ie>=4096&&(K.qpro=!0);break;case 6:L=ie;break;case 204:ie&&(X=ie);break;case 222:X=ie;break;case 15:case 51:K.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=K.dateNF||kn[14],K.cellDates&&(ie[1].t="d",ie[1].v=dP(ie[1].v))),K.qpro&&ie[3]>D&&(U["!ref"]=Wn(L),V[W]=U,Z.push(W),U=K.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},D=ie[3],W=X||"Sheet"+(D+1),X="");var dt=K.dense?(U[ie[0].r]||[])[ie[0].c]:U[On(ie[0])];if(dt){dt.t=ie[1].t,dt.v=ie[1].v,ie[1].z!=null&&(dt.z=ie[1].z),ie[1].f!=null&&(dt.f=ie[1].f);break}K.dense?(U[ie[0].r]||(U[ie[0].r]=[]),U[ie[0].r][ie[0].c]=ie[1]):U[On(ie[0])]=ie[1];break}},K);else if(F[2]==26||F[2]==14)K.Enum=Ue,F[2]==14&&(K.qpro=!0,F.l=0),t(F,function(ie,He,Ge){switch(Ge){case 204:W=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>D&&(U["!ref"]=Wn(L),V[W]=U,Z.push(W),U=K.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},D=ie[3],W="Sheet"+(D+1)),Xe>0&&ie[0].r>=Xe)break;K.dense?(U[ie[0].r]||(U[ie[0].r]=[]),U[ie[0].r][ie[0].c]=ie[1]):U[On(ie[0])]=ie[1],L.e.c<ie[0].c&&(L.e.c=ie[0].c),L.e.r<ie[0].r&&(L.e.r=ie[0].r);break;case 27:ie[14e3]&&(be[ie[14e3][0]]=ie[14e3][1]);break;case 1537:be[ie[0]]=ie[1],ie[0]==D&&(W=ie[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(U["!ref"]=Wn(L),V[X||W]=U,Z.push(X||W),!be.length)return{SheetNames:Z,Sheets:V};for(var re={},J=[],De=0;De<be.length;++De)V[Z[De]]?(J.push(be[De]||Z[De]),re[be[De]]=V[be[De]]||V[Z[De]]):(J.push(be[De]),re[be[De]]={"!ref":"A1"});return{SheetNames:J,Sheets:re}}function n(F,H){var K=H||{};if(+K.codepage>=0&&ff(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var U=iu(),W=Ea(F["!ref"]),X=Array.isArray(F),D=[];Gr(U,0,s(1030)),Gr(U,6,c(W));for(var V=Math.min(W.e.r,8191),Z=W.s.r;Z<=V;++Z)for(var be=zi(Z),L=W.s.c;L<=W.e.c;++L){Z===W.s.r&&(D[L]=li(L));var Xe=D[L]+be,re=X?(F[Z]||[])[L]:F[Xe];if(!(!re||re.t=="z"))if(re.t=="n")(re.v|0)==re.v&&re.v>=-32768&&re.v<=32767?Gr(U,13,h(Z,L,re.v)):Gr(U,14,p(Z,L,re.v));else{var J=bA(re);Gr(U,15,f(Z,L,J.slice(0,239)))}}return Gr(U,1),U.end()}function a(F,H){var K=H||{};if(+K.codepage>=0&&ff(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var U=iu();Gr(U,0,o(F));for(var W=0,X=0;W<F.SheetNames.length;++W)(F.Sheets[F.SheetNames[W]]||{})["!ref"]&&Gr(U,27,ne(F.SheetNames[W],X++));var D=0;for(W=0;W<F.SheetNames.length;++W){var V=F.Sheets[F.SheetNames[W]];if(!(!V||!V["!ref"])){for(var Z=Ea(V["!ref"]),be=Array.isArray(V),L=[],Xe=Math.min(Z.e.r,8191),re=Z.s.r;re<=Xe;++re)for(var J=zi(re),De=Z.s.c;De<=Z.e.c;++De){re===Z.s.r&&(L[De]=li(De));var ie=L[De]+J,He=be?(V[re]||[])[De]:V[ie];if(!(!He||He.t=="z"))if(He.t=="n")Gr(U,23,B(re,De,D,He.v));else{var Ge=bA(He);Gr(U,22,_(re,De,D,Ge.slice(0,239)))}}++D}}return Gr(U,1),U.end()}function s(F){var H=cr(2);return H.write_shift(2,F),H}function o(F){var H=cr(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var K=0,U=0,W=0,X=0;X<F.SheetNames.length;++X){var D=F.SheetNames[X],V=F.Sheets[D];if(!(!V||!V["!ref"])){++W;var Z=ou(V["!ref"]);K<Z.e.r&&(K=Z.e.r),U<Z.e.c&&(U=Z.e.c)}}return K>8191&&(K=8191),H.write_shift(2,K),H.write_shift(1,W),H.write_shift(1,U),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(F,H,K){var U={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&K.qpro?(U.s.c=F.read_shift(1),F.l++,U.s.r=F.read_shift(2),U.e.c=F.read_shift(1),F.l++,U.e.r=F.read_shift(2),U):(U.s.c=F.read_shift(2),U.s.r=F.read_shift(2),H==12&&K.qpro&&(F.l+=2),U.e.c=F.read_shift(2),U.e.r=F.read_shift(2),H==12&&K.qpro&&(F.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function c(F){var H=cr(8);return H.write_shift(2,F.s.c),H.write_shift(2,F.s.r),H.write_shift(2,F.e.c),H.write_shift(2,F.e.r),H}function u(F,H,K){var U=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(U[0].c=F.read_shift(1),U[3]=F.read_shift(1),U[0].r=F.read_shift(2),F.l+=2):(U[2]=F.read_shift(1),U[0].c=F.read_shift(2),U[0].r=F.read_shift(2)),U}function d(F,H,K){var U=F.l+H,W=u(F,H,K);if(W[1].t="s",K.vers==20768){F.l++;var X=F.read_shift(1);return W[1].v=F.read_shift(X,"utf8"),W}return K.qpro&&F.l++,W[1].v=F.read_shift(U-F.l,"cstr"),W}function f(F,H,K){var U=cr(7+K.length);U.write_shift(1,255),U.write_shift(2,H),U.write_shift(2,F),U.write_shift(1,39);for(var W=0;W<U.length;++W){var X=K.charCodeAt(W);U.write_shift(1,X>=128?95:X)}return U.write_shift(1,0),U}function A(F,H,K){var U=u(F,H,K);return U[1].v=F.read_shift(2,"i"),U}function h(F,H,K){var U=cr(7);return U.write_shift(1,255),U.write_shift(2,H),U.write_shift(2,F),U.write_shift(2,K,"i"),U}function m(F,H,K){var U=u(F,H,K);return U[1].v=F.read_shift(8,"f"),U}function p(F,H,K){var U=cr(13);return U.write_shift(1,255),U.write_shift(2,H),U.write_shift(2,F),U.write_shift(8,K,"f"),U}function x(F,H,K){var U=F.l+H,W=u(F,H,K);if(W[1].v=F.read_shift(8,"f"),K.qpro)F.l=U;else{var X=F.read_shift(2);w(F.slice(F.l,F.l+X),W),F.l+=X}return W}function v(F,H,K){var U=H&32768;return H&=-32769,H=(U?F:0)+(H>=8192?H-16384:H),(U?"":"$")+(K?li(H):zi(H))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(F,H){_l(F,0);for(var K=[],U=0,W="",X="",D="",V="";F.l<F.length;){var Z=F[F.l++];switch(Z){case 0:K.push(F.read_shift(8,"f"));break;case 1:X=v(H[0].c,F.read_shift(2),!0),W=v(H[0].r,F.read_shift(2),!1),K.push(X+W);break;case 2:{var be=v(H[0].c,F.read_shift(2),!0),L=v(H[0].r,F.read_shift(2),!1);X=v(H[0].c,F.read_shift(2),!0),W=v(H[0].r,F.read_shift(2),!1),K.push(be+L+":"+X+W)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(F.read_shift(2));break;case 6:{for(var Xe="";Z=F[F.l++];)Xe+=String.fromCharCode(Z);K.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:V=K.pop(),D=K.pop(),K.push(["AND","OR"][Z-20]+"("+D+","+V+")");break;default:if(Z<32&&b[Z])V=K.pop(),D=K.pop(),K.push(D+b[Z]+V);else if(y[Z]){if(U=y[Z][1],U==69&&(U=F[F.l++]),U>K.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+K.join("|")+"|");return}var re=K.slice(-U);K.length-=U,K.push(y[Z][0]+"("+re.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}K.length==1?H[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function j(F){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=F.read_shift(2),H[3]=F[F.l++],H[0].c=F[F.l++],H}function I(F,H){var K=j(F);return K[1].t="s",K[1].v=F.read_shift(H-4,"cstr"),K}function _(F,H,K,U){var W=cr(6+U.length);W.write_shift(2,F),W.write_shift(1,K),W.write_shift(1,H),W.write_shift(1,39);for(var X=0;X<U.length;++X){var D=U.charCodeAt(X);W.write_shift(1,D>=128?95:D)}return W.write_shift(1,0),W}function S(F,H){var K=j(F);K[1].v=F.read_shift(2);var U=K[1].v>>1;if(K[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return K[1].v=U,K}function E(F,H){var K=j(F),U=F.read_shift(4),W=F.read_shift(4),X=F.read_shift(2);if(X==65535)return U===0&&W===3221225472?(K[1].t="e",K[1].v=15):U===0&&W===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var D=X&32768;return X=(X&32767)-16446,K[1].v=(1-D*2)*(W*Math.pow(2,X+32)+U*Math.pow(2,X)),K}function B(F,H,K,U){var W=cr(14);if(W.write_shift(2,F),W.write_shift(1,K),W.write_shift(1,H),U==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var X=0,D=0,V=0,Z=0;return U<0&&(X=1,U=-U),D=Math.log2(U)|0,U/=Math.pow(2,D-31),Z=U>>>0,Z&2147483648||(U/=2,++D,Z=U>>>0),U-=Z,Z|=2147483648,Z>>>=0,U*=Math.pow(2,32),V=U>>>0,W.write_shift(4,V),W.write_shift(4,Z),D+=16383+(X?32768:0),W.write_shift(2,D),W}function k(F,H){var K=E(F);return F.l+=H-14,K}function P(F,H){var K=j(F),U=F.read_shift(4);return K[1].v=U>>6,K}function O(F,H){var K=j(F),U=F.read_shift(8,"f");return K[1].v=U,K}function z(F,H){var K=O(F);return F.l+=H-10,K}function oe(F,H){return F[F.l+H-1]==0?F.read_shift(H,"cstr"):""}function ce(F,H){var K=F[F.l++];K>H-1&&(K=H-1);for(var U="";U.length<K;)U+=String.fromCharCode(F[F.l++]);return U}function ue(F,H,K){if(!(!K.qpro||H<21)){var U=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var W=F.read_shift(H-21,"cstr");return[U,W]}}function ge(F,H){for(var K={},U=F.l+H;F.l<U;){var W=F.read_shift(2);if(W==14e3){for(K[W]=[0,""],K[W][0]=F.read_shift(2);F[F.l];)K[W][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return K}function ne(F,H){var K=cr(5+F.length);K.write_shift(2,14e3),K.write_shift(2,H);for(var U=0;U<F.length;++U){var W=F.charCodeAt(U);K[K.l++]=W>127?95:W}return K[K.l++]=0,K}var Oe={0:{n:"BOF",f:no},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:ce},65535:{n:""}},Ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function STe(t){var e={},r=t.match(cc),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Dn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=z6[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var ITe=function(){var t=T2("t"),e=T2("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:_a(o[1])},c=s.match(e);return c&&(l.s=STe(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),jTe=function(){var e=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),PTe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,BTe=/<(?:\w+:)?r>/,TTe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function xR(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=_a(cs(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=cs(t),r&&(n.h=aR(n.t))):t.match(BTe)&&(n.r=cs(t),n.t=_a(cs((t.replace(TTe,"").match(PTe)||[]).join("").replace(cc,""))),r&&(n.h=jTe(ITe(n.r)))),n):{t:""}}var kTe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,FTe=/<(?:\w+:)?(?:si|sstItem)>/g,OTe=/<\/(?:\w+:)?(?:si|sstItem)>/;function DTe(t,e){var r=[],n="";if(!t)return r;var a=t.match(kTe);if(a){n=a[2].replace(FTe,"").split(OTe);for(var s=0;s!=n.length;++s){var o=xR(n[s].trim(),e);o!=null&&(r[r.length]=o)}a=Dn(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var RTe=/^\s|\s$|[\t\n\r]/;function Nae(t,e){if(!e.bookSST)return"";var r=[Xi];r[r.length]=Kr("sst",null,{xmlns:Rg[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(RTe)&&(s+=' xml:space="preserve"'),s+=">"+rs(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function MTe(t){return[t.read_shift(4),t.read_shift(4)]}function LTe(t,e){var r=[],n=!1;return RA(t,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function UTe(t,e){return e||(e=cr(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var QTe=Y4e;function VTe(t){var e=iu();Nr(e,159,UTe(t));for(var r=0;r<t.length;++r)Nr(e,19,QTe(t[r]));return Nr(e,160),e.end()}function Cae(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function cA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function HTe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=cA(t,4),e.U=cA(t,4),e.W=cA(t,4),e}function $Te(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function KTe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push($Te(t));return e}function GTe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function qTe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=cA(t,4),e.U=cA(t,4),e.W=cA(t,4),e}function zTe(t){var e=qTe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function _ae(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Eae(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function WTe(t){var e=cA(t);switch(e.Minor){case 2:return[e.Minor,XTe(t)];case 3:return[e.Minor,YTe()];case 4:return[e.Minor,JTe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function XTe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=_ae(t,r),a=Eae(t,t.length-t.l);return{t:"Std",h:n,v:a}}function YTe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function JTe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(cc,function(s){var o=Dn(s);switch(gh(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function ZTe(t,e){var r={},n=r.EncryptionVersionInfo=cA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=_ae(t,a),e-=a,r.EncryptionVerifier=Eae(t,e),r}function eke(t){var e={},r=e.EncryptionVersionInfo=cA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function vR(t){var e=0,r,n=Cae(t),a=n.length+1,s,o,l,c,u;for(r=Sm(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=e&16384?1:0,c=e<<1&32767,u=l|c,e=u^o;return e^52811}var Sae=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=e[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=Cae(o),c=s(l),u=l.length,d=Sm(16),f=0;f!=16;++f)d[f]=0;var A,h,m;for((u&1)===1&&(A=c>>8,d[u]=a(t[0],A),--u,A=c&255,h=l[l.length-1],d[u]=a(h,A));u>0;)--u,A=c>>8,d[u]=a(l[u],A),--u,A=c&255,d[u]=a(l[u],A);for(u=15,m=15-l.length;m>0;)A=c>>8,d[u]=a(t[m],A),--u,--m,A=c&255,d[u]=a(l[u],A),--u,--m;return d}}(),tke=function(t,e,r,n,a){a||(a=e),n||(n=Sae(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},rke=function(t){var e=0,r=Sae(t);return function(n){var a=tke("",n,e,r);return e=a[1],a[0]}};function nke(t,e,r,n){var a={key:no(t),verificationBytes:no(t)};return r.password&&(a.verifier=vR(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=rke(r.password)),a}function ake(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=eke(t):n.Data=ZTe(t,e),n}function ske(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?ake(t,e-2,n):nke(t,r.biff>=8?e:e-2,r,n),n}var Iae=function(){function t(a,s){switch(s.type){case"base64":return e(Hu(a),s);case"binary":return e(a,s);case"buffer":return e(ta&&Buffer.isBuffer(a)?a.toString("binary"):Um(a),s);case"array":return e(hg(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var A=/\\\w+\b/g,h=0,m,p=-1;m=A.exec(d);){switch(m[0]){case"\\cell":var x=d.slice(h,A.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var v={v:x,t:"s"};Array.isArray(l)?l[f][p]=v:l[On({r:f,c:p})]=v}break}h=A.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Wn(u),l}function r(a,s){return Qm(t(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=Ea(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=On({r:u,c:d});l=c?(a[u]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(bA(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function ike(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function D2(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function oke(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),s=Math.min(e,r,n),o=a-s;if(o===0)return[0,0,e];var l=0,c=0,u=a+s;switch(c=o/(u>1?2-u:u),a){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,u/2]}function lke(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function XS(t,e){if(e===0)return t;var r=oke(ike(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),D2(lke(r))}var jae=6,cke=15,uke=1,rc=jae;function R2(t){return Math.floor((t+Math.round(128/rc)/256)*rc)}function M2(t){return Math.floor((t-5)/rc*100+.5)/100}function YS(t){return Math.round((t*rc+5)/rc*256)/256}function T5(t){return YS(M2(R2(t)))}function yR(t){var e=Math.abs(t-T5(t)),r=rc;if(e>.005)for(rc=uke;rc<cke;++rc)Math.abs(t-T5(t))<=e&&(e=Math.abs(t-T5(t)),r=rc);rc=r}function Im(t){t.width?(t.wpx=R2(t.width),t.wch=M2(t.wpx),t.MDW=rc):t.wpx?(t.wch=M2(t.wpx),t.width=YS(t.wch),t.MDW=rc):typeof t.wch=="number"&&(t.width=YS(t.wch),t.wpx=R2(t.width),t.MDW=rc),t.customWidth&&delete t.customWidth}var dke=96,Pae=dke;function L2(t){return t*96/Pae}function Qv(t){return t*Pae/96}var fke={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function hke(t,e,r,n){e.Borders=[];var a={},s=!1;(t[0].match(cc)||[]).forEach(function(o){var l=Dn(o);switch(gh(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Ps(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Ps(l.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function Ake(t,e,r,n){e.Fills=[];var a={},s=!1;(t[0].match(cc)||[]).forEach(function(o){var l=Dn(o);switch(gh(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function mke(t,e,r,n){e.Fonts=[];var a={},s=!1;(t[0].match(cc)||[]).forEach(function(o){var l=Dn(o);switch(gh(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=cs(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Ps(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Ps(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Ps(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Ps(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Ps(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Ps(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Ps(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=z6[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Ps(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Up[a.color.index];a.color.index==81&&(c=Up[1]),c||(c=Up[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=XS(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function pke(t,e,r){e.NumberFmt=[];for(var n=Pi(kn),a=0;a<n.length;++a)e.NumberFmt[n[a]]=kn[n[a]];var s=t[0].match(cc);if(s)for(a=0;a<s.length;++a){var o=Dn(s[a]);switch(gh(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=_a(cs(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}lA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function gke(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Kr("numFmt",null,{numFmtId:n,formatCode:rs(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Kr("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var zC=["numFmtId","fillId","fontId","borderId","xfId"],WC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function xke(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(cc)||[]).forEach(function(s){var o=Dn(s),l=0;switch(gh(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<zC.length;++l)n[zC[l]]&&(n[zC[l]]=parseInt(n[zC[l]],10));for(l=0;l<WC.length;++l)n[WC[l]]&&(n[WC[l]]=Ps(n[WC[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Ps(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function vke(t){var e=[];return e[e.length]=Kr("cellXfs",null),t.forEach(function(r){e[e.length]=Kr("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Kr("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var yke=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(e))&&pke(f,d,u),(f=l.match(a))&&mke(f,d,c,u),(f=l.match(n))&&Ake(f,d,c,u),(f=l.match(s))&&hke(f,d,c,u),(f=l.match(r))&&xke(f,d,u),d}}();function Bae(t,e){var r=[Xi,Kr("styleSheet",null,{xmlns:Rg[0],"xmlns:vt":Po.vt})],n;return t.SSF&&(n=gke(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=vke(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function bke(t,e){var r=t.read_shift(2),n=sc(t);return[r,n]}function wke(t,e,r){r||(r=cr(6+4*e.length)),r.write_shift(2,t),Zo(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Nke(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=a5e(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=n5e(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=sc(t),n}function Cke(t,e){e||(e=cr(25+4*32)),e.write_shift(2,t.sz*20),s5e(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),qS(t.color,e);var n=0;return n=2,e.write_shift(1,n),Zo(t.name,e),e.length>e.l?e.slice(0,e.l):e}var _ke=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],k5,Eke=lc;function YH(t,e){e||(e=cr(4*3+8*7+16*1)),k5||(k5=cP(_ke));var r=k5[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(qS({auto:1},e),qS({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Ske(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function Tae(t,e,r){r||(r=cr(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function py(t,e){return e||(e=cr(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Ike=lc;function jke(t,e){return e||(e=cr(51)),e.write_shift(1,0),py(null,e),py(null,e),py(null,e),py(null,e),py(null,e),e.length>e.l?e.slice(0,e.l):e}function Pke(t,e){return e||(e=cr(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),GS(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Bke(t,e,r){var n=cr(2052);return n.write_shift(4,t),GS(e,n),GS(r,n),n.length>n.l?n.slice(0,n.l):n}function Tke(t,e,r){var n={};n.NumberFmt=[];for(var a in kn)n.NumberFmt[a]=kn[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return RA(t,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],lA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=XS(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function kke(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Nr(t,615,xf(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Nr(t,44,wke(a,e[a]))}),Nr(t,616))}}function Fke(t){var e=1;Nr(t,611,xf(e)),Nr(t,43,Cke({sz:12,color:{theme:1},name:"Calibri",family:2})),Nr(t,612)}function Oke(t){var e=2;Nr(t,603,xf(e)),Nr(t,45,YH({patternType:"none"})),Nr(t,45,YH({patternType:"gray125"})),Nr(t,604)}function Dke(t){var e=1;Nr(t,613,xf(e)),Nr(t,46,jke()),Nr(t,614)}function Rke(t){var e=1;Nr(t,626,xf(e)),Nr(t,47,Tae({numFmtId:0},65535)),Nr(t,627)}function Mke(t,e){Nr(t,617,xf(e.length)),e.forEach(function(r){Nr(t,47,Tae(r,0))}),Nr(t,618)}function Lke(t){var e=1;Nr(t,619,xf(e)),Nr(t,48,Pke({xfId:0,name:"Normal"})),Nr(t,620)}function Uke(t){var e=0;Nr(t,505,xf(e)),Nr(t,506)}function Qke(t){var e=0;Nr(t,508,Bke(e,"TableStyleMedium9","PivotStyleMedium4")),Nr(t,509)}function Vke(t,e){var r=iu();return Nr(r,278),kke(r,t.SSF),Fke(r),Oke(r),Dke(r),Rke(r),Mke(r,e.cellXfs),Lke(r),Uke(r),Qke(r),Nr(r,279),r.end()}var Hke=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $ke(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(cc)||[]).forEach(function(a){var s=Dn(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Hke.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Kke(){}function Gke(){}var qke=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,zke=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Wke=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Xke(t,e,r){e.themeElements={};var n;[["clrScheme",qke,$ke],["fontScheme",zke,Kke],["fmtScheme",Wke,Gke]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var Yke=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function kae(t,e){(!t||t.length===0)&&(t=bR());var r,n={};if(!(r=t.match(Yke)))throw new Error("themeElements not found in theme");return Xke(r[0],n,e),n.raw=t,n}function bR(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xi];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Jke(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=_ne(s,{type:"array"})}catch{return}var l=Bu(o,"theme/theme/theme1.xml",!0);if(l)return kae(l,r)}}function Zke(t){return t.read_shift(4)}function eFe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=tFe(t,4);break;case 2:e.xclrValue=fae(t);break;case 3:e.xclrValue=Zke(t);break;case 4:t.l+=4;break}return t.l+=8,e}function tFe(t,e){return lc(t,e)}function rFe(t,e){return lc(t,e)}function nFe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=eFe(t);break;case 6:n[1]=rFe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function aFe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(nFe(t,r-t.l));return{ixfe:n,ext:s}}function sFe(t,e){e.forEach(function(r){switch(r[0]){}})}function iFe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:sc(t)}}function oFe(t){var e=cr(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Zo(t.name,e),e.slice(0,e.l)}function lFe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function cFe(t){var e=cr(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function uFe(t,e){var r=cr(8+2*e.length);return r.write_shift(4,t),Zo(e,r),r.slice(0,r.l)}function dFe(t){return t.l+=4,t.read_shift(4)!=0}function fFe(t,e){var r=cr(8);return r.write_shift(4,t),r.write_shift(4,1),r}function hFe(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return RA(t,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function AFe(){var t=iu();return Nr(t,332),Nr(t,334,xf(1)),Nr(t,335,oFe({name:"XLDAPR",version:12e4,flags:3496657072})),Nr(t,336),Nr(t,339,uFe(1,"XLDAPR")),Nr(t,52),Nr(t,35,xf(514)),Nr(t,4096,xf(0)),Nr(t,4097,gd(1)),Nr(t,36),Nr(t,53),Nr(t,340),Nr(t,337,fFe(1)),Nr(t,51,cFe([[1,0]])),Nr(t,338),Nr(t,333),t.end()}function mFe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,s=2,o;return t.replace(cc,function(l){var c=Dn(l);switch(gh(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function Fae(){var t=[Xi];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function pFe(t){var e=[];if(!t)return e;var r=1;return(t.match(cc)||[]).forEach(function(n){var a=Dn(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function gFe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=On(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function xFe(t,e,r){var n=[];return RA(t,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function vFe(t,e,r,n){if(!t)return t;var a=n||{},s=!1;RA(t,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function yFe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Wx=1024;function Oae(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Kr("xml",null,{"xmlns:v":Iu.v,"xmlns:o":Iu.o,"xmlns:x":Iu.x,"xmlns:mv":Iu.mv}).replace(/\/>/,">"),Kr("o:shapelayout",Kr("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Kr("v:shapetype",[Kr("v:stroke",null,{joinstyle:"miter"}),Kr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Wx<t*1e3;)Wx+=1e3;return e.forEach(function(s){var o=ci(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Kr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Kr("v:fill",c,l),d={on:"t",obscured:"t"};++Wx,a=a.concat(["<v:shape"+k2({id:"_x0000_s"+Wx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Kr("v:shadow",null,d),Kr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Sl("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Sl("x:AutoFill","False"),Sl("x:Row",String(o.r)),Sl("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function JH(t,e,r,n){var a=Array.isArray(t),s;e.forEach(function(o){var l=ci(o.ref);if(a?(t[l.r]||(t[l.r]=[]),s=t[l.r][l.c]):s=t[o.ref],!s){s={t:"z"},a?t[l.r][l.c]=s:t[o.ref]=s;var c=Ea(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Wn(c);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function bFe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Dn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=ci(c.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),A=!!f&&!!f[1]&&xR(f[1])||{r:"",t:"",h:""};u.r=A.r,A.r=="<t></t>"&&(A.t=A.h=""),u.t=(A.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=A.h),n.push(u)}}}}),n}function Dae(t){var e=[Xi,Kr("comments",null,{xmlns:Rg[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var s=rs(a.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(rs(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Sl("t",rs(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(Sl("t",rs(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function wFe(t,e){var r=[],n=!1,a={},s=0;return t.replace(cc,function(l,c){var u=Dn(l);switch(gh(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function NFe(t,e,r){var n=[Xi,Kr("ThreadedComments",null,{xmlns:Po.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Kr("threadedComment",Sl("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function CFe(t,e){var r=[],n=!1;return t.replace(cc,function(s){var o=Dn(s);switch(gh(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function _Fe(t){var e=[Xi,Kr("personList",null,{xmlns:Po.TCMNT,"xmlns:x":Rg[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Kr("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function EFe(t){var e={};e.iauthor=t.read_shift(4);var r=Qg(t);return e.rfx=r.s,e.ref=On(r.s),t.l+=16,e}function SFe(t,e){return e==null&&(e=cr(36)),e.write_shift(4,t[1].iauthor),b1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var IFe=sc;function jFe(t){return Zo(t.slice(0,54))}function PFe(t,e){var r=[],n=[],a={},s=!1;return RA(t,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function BFe(t){var e=iu(),r=[];return Nr(e,628),Nr(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Nr(e,632,jFe(a.a)))})}),Nr(e,631),Nr(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:ci(n[0]),e:ci(n[0])};Nr(e,635,SFe([s,a])),a.t&&a.t.length>0&&Nr(e,637,Z4e(a)),Nr(e,636),delete a.iauthor})}),Nr(e,634),Nr(e,629),e.end()}var TFe="application/vnd.ms-office.vbaProject";function kFe(t){var e=En.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");En.utils.cfb_add(e,a,t.FileIndex[n].content)}}),En.write(e)}function FFe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&En.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var Rae=["xlsb","xlsm","xlam","biff8","xla"];function OFe(){return{"!type":"dialog"}}function DFe(){return{"!type":"dialog"}}function RFe(){return{"!type":"macro"}}function MFe(){return{"!type":"macro"}}var gv=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=e.c:--d,c?u+=e.r:--u,a+(l?"":"$")+li(d)+(c?"":"$")+zi(u)}return function(a,s){return e=s,a.replace(t,r)}}(),wR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,NR=function(){return function(e,r){return e.replace(wR,function(n,a,s,o,l,c){var u=cR(o)-(s?0:r.c),d=lR(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",A=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+A})}}();function Mae(t,e){return t.replace(wR,function(r,n,a,s,o,l){return n+(a=="$"?a+s:li(cR(s)+e.c))+(o=="$"?o+l:zi(lR(l)+e.r))})}function LFe(t,e,r){var n=ou(e),a=n.s,s=ci(r),o={r:s.r-a.r,c:s.c-a.c};return Mae(t,o)}function UFe(t){return t.length!=1}function ZH(t){return t.replace(/_xlfn\./g,"")}function eo(t){t.l+=1}function jm(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Lae(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Uae(t);r.biff==12&&(n=4)}var a=t.read_shift(n),s=t.read_shift(n),o=jm(t),l=jm(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Uae(t){var e=jm(t),r=jm(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function QFe(t,e,r){if(r.biff<8)return Uae(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),s=jm(t),o=jm(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Qae(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return VFe(t);var n=t.read_shift(r&&r.biff==12?4:2),a=jm(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function VFe(t){var e=jm(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function HFe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $Fe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return KFe(t);var a=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function KFe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function GFe(t,e,r){var n=(t[t.l++]&96)>>5,a=Lae(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function qFe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Lae(t,s,r);return[n,a,o]}function zFe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function WFe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,a]}function XFe(t,e,r){var n=(t[t.l++]&96)>>5,a=QFe(t,e-1,r);return[n,a]}function YFe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function e$(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function JFe(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function ZFe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function eOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function tOe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function rOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Vae(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function nOe(t){return t.read_shift(2),Vae(t)}function aOe(t){return t.read_shift(2),Vae(t)}function sOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=Qae(t,0,r);return[n,a]}function iOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=$Fe(t,0,r);return[n,a]}function oOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Qae(t,0,r);return[n,a,s]}function lOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[dDe[a],Kae[a],n]}function cOe(t,e,r){var n=t[t.l++],a=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:uOe(t);return[a,(s[0]===0?Kae:uDe)[s[1]]]}function uOe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function dOe(t,e,r){t.l+=r&&r.biff==2?3:4}function fOe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function hOe(t){return t.l++,MA[t.read_shift(1)]}function AOe(t){return t.l++,t.read_shift(2)}function mOe(t){return t.l++,t.read_shift(1)!==0}function pOe(t){return t.l++,nc(t)}function gOe(t,e,r){return t.l++,Lw(t,e-1,r)}function xOe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mi(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=MA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=nc(t);break;case 2:r[1]=Vg(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function vOe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Qg:fP)(t));return a}function yOe(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=xOe(t,r.biff);return o}function bOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function wOe(t,e,r){if(r.biff==5)return NOe(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[n,a,s]}function NOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function COe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function _Oe(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function EOe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function SOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,a]}var IOe=lc,jOe=lc,POe=lc;function Qw(t,e,r){return t.l+=2,[HFe(t)]}function CR(t){return t.l+=6,[]}var BOe=Qw,TOe=CR,kOe=CR,FOe=Qw;function Hae(t){return t.l+=2,[no(t),t.read_shift(2)&1]}var OOe=Qw,DOe=Hae,ROe=CR,MOe=Qw,LOe=Qw,UOe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QOe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),o=UOe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:s}}function VOe(t){return t.l+=2,[t.read_shift(4)]}function HOe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function $Oe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function KOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function GOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function qOe(t){return t.l+=4,[0,0]}var t$={1:{n:"PtgExp",f:fOe},2:{n:"PtgTbl",f:POe},3:{n:"PtgAdd",f:eo},4:{n:"PtgSub",f:eo},5:{n:"PtgMul",f:eo},6:{n:"PtgDiv",f:eo},7:{n:"PtgPower",f:eo},8:{n:"PtgConcat",f:eo},9:{n:"PtgLt",f:eo},10:{n:"PtgLe",f:eo},11:{n:"PtgEq",f:eo},12:{n:"PtgGe",f:eo},13:{n:"PtgGt",f:eo},14:{n:"PtgNe",f:eo},15:{n:"PtgIsect",f:eo},16:{n:"PtgUnion",f:eo},17:{n:"PtgRange",f:eo},18:{n:"PtgUplus",f:eo},19:{n:"PtgUminus",f:eo},20:{n:"PtgPercent",f:eo},21:{n:"PtgParen",f:eo},22:{n:"PtgMissArg",f:eo},23:{n:"PtgStr",f:gOe},26:{n:"PtgSheet",f:HOe},27:{n:"PtgEndSheet",f:$Oe},28:{n:"PtgErr",f:hOe},29:{n:"PtgBool",f:mOe},30:{n:"PtgInt",f:AOe},31:{n:"PtgNum",f:pOe},32:{n:"PtgArray",f:YFe},33:{n:"PtgFunc",f:lOe},34:{n:"PtgFuncVar",f:cOe},35:{n:"PtgName",f:bOe},36:{n:"PtgRef",f:sOe},37:{n:"PtgArea",f:GFe},38:{n:"PtgMemArea",f:COe},39:{n:"PtgMemErr",f:IOe},40:{n:"PtgMemNoMem",f:jOe},41:{n:"PtgMemFunc",f:_Oe},42:{n:"PtgRefErr",f:EOe},43:{n:"PtgAreaErr",f:zFe},44:{n:"PtgRefN",f:iOe},45:{n:"PtgAreaN",f:XFe},46:{n:"PtgMemAreaN",f:KOe},47:{n:"PtgMemNoMemN",f:GOe},57:{n:"PtgNameX",f:wOe},58:{n:"PtgRef3d",f:oOe},59:{n:"PtgArea3d",f:qFe},60:{n:"PtgRefErr3d",f:SOe},61:{n:"PtgAreaErr3d",f:WFe},255:{}},zOe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WOe={1:{n:"PtgElfLel",f:Hae},2:{n:"PtgElfRw",f:MOe},3:{n:"PtgElfCol",f:BOe},6:{n:"PtgElfRwV",f:LOe},7:{n:"PtgElfColV",f:FOe},10:{n:"PtgElfRadical",f:OOe},11:{n:"PtgElfRadicalS",f:ROe},13:{n:"PtgElfColS",f:TOe},15:{n:"PtgElfColSV",f:kOe},16:{n:"PtgElfRadicalLel",f:DOe},25:{n:"PtgList",f:QOe},29:{n:"PtgSxName",f:VOe},255:{}},XOe={0:{n:"PtgAttrNoop",f:qOe},1:{n:"PtgAttrSemi",f:rOe},2:{n:"PtgAttrIf",f:eOe},4:{n:"PtgAttrChoose",f:JFe},8:{n:"PtgAttrGoto",f:ZFe},16:{n:"PtgAttrSum",f:dOe},32:{n:"PtgAttrBaxcel",f:e$},33:{n:"PtgAttrBaxcel",f:e$},64:{n:"PtgAttrSpace",f:nOe},65:{n:"PtgAttrSpaceSemi",f:aOe},128:{n:"PtgAttrIfError",f:tOe},255:{}};function Vw(t,e,r,n){if(n.biff<8)return lc(t,e);for(var a=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=yOe(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=vOe(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&s.push(lc(t,e)),s}function Hw(t,e,r){for(var n=t.l+e,a,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],a=t$[s]||t$[zOe[s]],(s===24||s===25)&&(a=(s===24?WOe:XOe)[t[t.l+1]]),!a||!a.f?lc(t,e):o.push([a.n,a.f(t,e,r)]);return o}function YOe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var JOe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ZOe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function $ae(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function r$(t,e,r){var n=$ae(t,e,r);return n=="#REF"?n:ZOe(n,r)}function ec(t,e,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,A=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",v=0,y=t[0].length;v<y;++v){var b=t[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=Ei(" ",t[0][p][1][1]);break;case 1:x=Ei("\r",t[0][p][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+x,p=-1}l.push(u+JOe[b[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Tb(b[1][1],o,a),l.push(kb(d,s));break;case"PtgRefN":d=r?Tb(b[1][1],r,a):b[1][1],l.push(kb(d,s));break;case"PtgRef3d":f=b[1][1],d=Tb(b[1][2],o,a),m=r$(n,f,a),l.push(m+"!"+kb(d,s));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],j=b[1][1];w||(w=0),w&=127;var I=w==0?[]:l.slice(-w);l.length-=w,j==="User"&&(j=I.shift()),l.push(j+"("+I.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=BH(b[1][1],r?{s:r}:o,a),l.push(j5(h,a));break;case"PtgArea":h=BH(b[1][1],o,a),l.push(j5(h,a));break;case"PtgArea3d":f=b[1][1],h=b[1][2],m=r$(n,f,a),l.push(m+"!"+j5(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":A=b[1][2];var _=(n.names||[])[A-1]||(n[0]||[])[A],S=_?_.Name:"SH33TJSNAME"+String(A);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var E=b[1][1];A=b[1][2];var B;if(a.biff<=5)E<0&&(E=-E),n[E]&&(B=n[E][A]);else{var k="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][A]&&n[E][A].itab>0&&(k=n.SheetNames[n[E][A].itab-1]+"!"):k=n.SheetNames[A-1]+"!"),n[E]&&n[E][A])k+=n[E][A].Name;else if(n[0]&&n[0][A])k+=n[0][A].Name;else{var P=($ae(n,E,a)||"").split(";;");P[A-1]?k=P[A-1]:k+="SH33TJSERRX"}l.push(k);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var O="(",z=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:O=Ei(" ",t[0][p][1][1])+O;break;case 3:O=Ei("\r",t[0][p][1][1])+O;break;case 4:z=Ei(" ",t[0][p][1][1])+z;break;case 5:z=Ei("\r",t[0][p][1][1])+z;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(O+l.pop()+z);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var oe={c:r.c,r:r.r};if(n.sharedf[On(d)]){var ce=n.sharedf[On(d)];l.push(ec(ce,o,oe,n,a))}else{var ue=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(ec(u[1],o,oe,n,a)),ue=!0;break}ue||l.push(b[1])}break;case"PtgArray":l.push("{"+YOe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&ge.indexOf(t[0][v][0])==-1){b=t[0][p];var ne=!0;switch(b[1][0]){case 4:ne=!1;case 0:x=Ei(" ",b[1][1]);break;case 5:ne=!1;case 1:x=Ei("\r",b[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((ne?x:"")+l.pop()+(ne?"":x)),p=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function eDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],lc(t,e-2)];var l=Hw(t,o,r);return e!==o+a&&(s=Vw(t,e-o-a,l,r)),t.l=n,[l,s]}function tDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],lc(t,e-2)];var l=Hw(t,o,r);return e!==o+a&&(s=Vw(t,e-o-a,l,r)),t.l=n,[l,s]}function rDe(t,e,r,n){var a=t.l+e,s=Hw(t,n,r),o;return a!==t.l&&(o=Vw(t,a-t.l,s,r)),[s,o]}function nDe(t,e,r){var n=t.l+e,a,s=t.read_shift(2),o=Hw(t,s,r);return s==65535?[[],lc(t,e-2)]:(e!==s+2&&(a=Vw(t,n-s-2,o,r)),[o,a])}function aDe(t){var e;if(Yh(t,t.l+6)!==65535)return[nc(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function sDe(t){if(t==null){var e=cr(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ag(t);return Ag(0)}function F5(t,e,r){var n=t.l+e,a=xh(t);r.biff==2&&++t.l;var s=aDe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=tDe(t,n-t.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function iDe(t,e,r,n,a){var s=pg(e,r,a),o=sDe(t.v),l=cr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=cr(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var f=Jo([s,o,l,u]);return f}function hP(t,e,r){var n=t.read_shift(4),a=Hw(t,n,r),s=t.read_shift(4),o=s>0?Vw(t,s,a,r):null;return[a,o]}var oDe=hP,AP=hP,lDe=hP,cDe=hP,uDe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Kae={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dDe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function n$(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function fDe(t){var e="of:="+t.replace(wR,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function O5(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function hDe(t){return t.replace(/\./,"!")}var Ob={},xv={},Db=typeof Map<"u";function _R(t,e,r){var n=0,a=t.length;if(r){if(Db?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Db?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Db?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function mP(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(rc=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=M2(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=YS(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Hp(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Vm(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){lA(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===n)return a;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Gae(t,e,r,n,a,s){try{n.cellNF&&(t.z=kn[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Fs(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(kn[e]==null&&lA(u4e[e]||"General",e),t.t==="e")t.w=t.w||MA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=B2(t.v);else if(t.t==="d"){var o=Oo(t.v);(o|0)===o?t.w=o.toString(10):t.w=B2(o)}else{if(t.v===void 0)return"";t.w=fg(t.v,xv)}else t.t==="d"?t.w=Od(e,Oo(t.v),xv):t.w=Od(e,t.v,xv)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=XS(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=XS(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function ADe(t,e,r){if(t&&t["!ref"]){var n=Ea(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function mDe(t,e){var r=Ea(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Wn(r))}var pDe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,gDe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xDe=/<(?:\w:)?hyperlink [^>]*>/mg,vDe=/"(\w*:\w*)"/,yDe=/<(?:\w:)?col\b[^>]*[\/]?>/g,bDe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wDe=/<(?:\w:)?pageMargins[^>]*\/>/g,qae=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,NDe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,CDe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _De(t,e,r,n,a,s,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=t.match(gDe);f?(u=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):u=d=t;var A=u.match(qae);A?ER(A[0],l,a,r):(A=u.match(NDe))&&SDe(A[0],A[1]||"",l,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(vDe);m&&mDe(l,m[1])}var p=u.match(CDe);p&&p[1]&&UDe(p[1],a);var x=[];if(e.cellStyles){var v=u.match(yDe);v&&ODe(x,v)}f&&HDe(f[1],l,e,c,s,o);var y=d.match(bDe);y&&(l["!autofilter"]=RDe(y[0]));var b=[],w=d.match(pDe);if(w)for(h=0;h!=w.length;++h)b[h]=Ea(w[h].slice(w[h].indexOf('"')+1));var j=d.match(xDe);j&&TDe(l,j,n);var I=d.match(wDe);if(I&&(l["!margins"]=kDe(Dn(I[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Wn(c)),e.sheetRows>0&&l["!ref"]){var _=Ea(l["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Wn(_))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function EDe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Wn(t[r])+'"/>';return e+"</mergeCells>"}function ER(t,e,r,n){var a=Dn(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=_a(cs(a.codeName)))}function SDe(t,e,r,n,a){ER(t.slice(0,t.indexOf(">")),r,n,a)}function IDe(t,e,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Zf(rs(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),l=(l||"")+Kr("outlinePr",null,u)}!s&&!l||(a[a.length]=Kr("sheetPr",l,o))}var jDe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],PDe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function BDe(t){var e={sheet:1};return jDe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),PDe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=vR(t.password).toString(16).toUpperCase()),Kr("sheetProtection",null,e)}function TDe(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var s=Dn(cs(e[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+_a(s.location))):(s.Target="#"+_a(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ea(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=On({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function kDe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function FDe(t){return Hp(t),Kr("pageMargins",null,t)}function ODe(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=Dn(e[n],!0);a.hidden&&(a.hidden=Ps(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,yR(a.width)),Im(a);s<=o;)t[s++]=Os(a)}}function DDe(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Kr("col",null,mP(a,n)));return r[r.length]="</cols>",r.join("")}function RDe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function MDe(t,e,r,n){var a=typeof t.ref=="string"?t.ref:Wn(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=ou(a);o.s.r==o.e.r&&(o.e.r=ou(e["!ref"]).e.r,a=Wn(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Kr("autoFilter",null,{ref:a})}var LDe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function UDe(t,e){e.Views||(e.Views=[{}]),(t.match(LDe)||[]).forEach(function(r,n){var a=Dn(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Ps(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function QDe(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Kr("sheetViews",Kr("sheetView",null,a),{})}function VDe(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=MA[t.v];break;case"d":n&&n.cellDates?a=Fs(t.v,-1).toISOString():(t=Os(t),t.t="n",a=""+(t.v=Oo(Fs(t.v)))),typeof t.z>"u"&&(t.z=kn[14]);break;default:a=t.v;break}var l=Sl("v",rs(a)),c={r:e},u=Vm(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Sl("v",""+_R(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=Kr("f",rs(t.f),d)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Kr("c",l,c)}var HDe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=T2("v"),o=T2("f");return function(c,u,d,f,A,h){for(var m=0,p="",x=[],v=[],y=0,b=0,w=0,j="",I,_,S=0,E=0,B,k,P=0,O=0,z=Array.isArray(h.CellXf),oe,ce=[],ue=[],ge=Array.isArray(u),ne=[],Oe={},Ue=!1,F=!!d.sheetStubs,H=c.split(e),K=0,U=H.length;K!=U;++K){p=H[K].trim();var W=p.length;if(W!==0){var X=0;e:for(m=0;m<W;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(_=Dn(p.slice(X,m),!0),S=_.r!=null?parseInt(_.r,10):S+1,E=-1,d.sheetRows&&d.sheetRows<S)continue;Oe={},Ue=!1,_.ht&&(Ue=!0,Oe.hpt=parseFloat(_.ht),Oe.hpx=Qv(Oe.hpt)),_.hidden=="1"&&(Ue=!0,Oe.hidden=!0),_.outlineLevel!=null&&(Ue=!0,Oe.level=+_.outlineLevel),Ue&&(ne[S-1]=Oe)}break;case"<":X=m;break}if(X>=m)break;if(_=Dn(p.slice(X,m),!0),S=_.r!=null?parseInt(_.r,10):S+1,E=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(Oe={},Ue=!1,_.ht&&(Ue=!0,Oe.hpt=parseFloat(_.ht),Oe.hpx=Qv(Oe.hpt)),_.hidden=="1"&&(Ue=!0,Oe.hidden=!0),_.outlineLevel!=null&&(Ue=!0,Oe.level=+_.outlineLevel),Ue&&(ne[S-1]=Oe)),x=p.slice(m).split(t);for(var D=0;D!=x.length&&x[D].trim().charAt(0)=="<";++D);for(x=x.slice(D),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(v=p.match(r),y=m,b=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,j=v[1],b=0;b!=j.length&&!((w=j.charCodeAt(b)-64)<1||w>26);++b)y=26*y+w;--y,E=y}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,_=Dn(p.slice(0,b),!0),_.r||(_.r=On({r:S-1,c:E})),j=p.slice(b),I={t:""},(v=j.match(s))!=null&&v[1]!==""&&(I.v=_a(v[1])),d.cellFormula){if((v=j.match(o))!=null&&v[1]!==""){if(I.f=_a(cs(v[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=ZH(I.f)),v[0].indexOf('t="array"')>-1)I.F=(j.match(a)||[])[1],I.F.indexOf(":")>-1&&ce.push([Ea(I.F),I.F]);else if(v[0].indexOf('t="shared"')>-1){k=Dn(v[0]);var V=_a(cs(v[1]));d.xlfn||(V=ZH(V)),ue[parseInt(k.si,10)]=[k,V,_.r]}}else(v=j.match(/<f[^>]*\/>/))&&(k=Dn(v[0]),ue[k.si]&&(I.f=LFe(ue[k.si][1],ue[k.si][2],_.r)));var Z=ci(_.r);for(b=0;b<ce.length;++b)Z.r>=ce[b][0].s.r&&Z.r<=ce[b][0].e.r&&Z.c>=ce[b][0].s.c&&Z.c<=ce[b][0].e.c&&(I.F=ce[b][1])}if(_.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(F)I.t="z";else continue;else I.t=_.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),I.t){case"n":if(I.v==""||I.v==null){if(!F)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!F)continue;I.t="z"}else B=Ob[parseInt(I.v,10)],I.v=B.t,I.r=B.r,d.cellHTML&&(I.h=B.h);break;case"str":I.t="s",I.v=I.v!=null?cs(I.v):"",d.cellHTML&&(I.h=aR(I.v));break;case"inlineStr":v=j.match(n),I.t="s",v!=null&&(B=xR(v[1]))?(I.v=B.t,d.cellHTML&&(I.h=B.h)):I.v="";break;case"b":I.v=Ps(I.v);break;case"d":d.cellDates?I.v=Fs(I.v,1):(I.v=Oo(Fs(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=Wne[I.v];break}if(P=O=0,oe=null,z&&_.s!==void 0&&(oe=h.CellXf[_.s],oe!=null&&(oe.numFmtId!=null&&(P=oe.numFmtId),d.cellStyles&&oe.fillId!=null&&(O=oe.fillId))),Gae(I,P,O,d,A,h),d.cellDates&&z&&I.t=="n"&&x1(kn[P])&&(I.t="d",I.v=dP(I.v)),_.cm&&d.xlmeta){var be=(d.xlmeta.Cell||[])[+_.cm-1];be&&be.type=="XLDAPR"&&(I.D=!0)}if(ge){var L=ci(_.r);u[L.r]||(u[L.r]=[]),u[L.r][L.c]=I}else u[_.r]=I}}}}ne.length>0&&(u["!rows"]=ne)}}();function $De(t,e,r,n){var a=[],s=[],o=Ea(t["!ref"]),l="",c,u="",d=[],f=0,A=0,h=t["!rows"],m=Array.isArray(t),p={r:u},x,v=-1;for(A=o.s.c;A<=o.e.c;++A)d[A]=li(A);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=zi(f),A=o.s.c;A<=o.e.c;++A){c=d[A]+u;var y=m?(t[f]||[])[A]:t[c];y!==void 0&&(l=VDe(y,c,t,e))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(p={r:u},h&&h[f]&&(x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=L2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),a[a.length]=Kr("row",s.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=L2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level),a[a.length]=Kr("row","",p));return a.join("")}function zae(t,e,r,n){var a=[Xi,Kr("worksheet",null,{xmlns:Rg[0],"xmlns:r":Po.r})],s=r.SheetNames[t],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Ea(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Wn(d)}n||(n={}),c["!comments"]=[];var f=[];IDe(c,r,t,e,a),a[a.length]=Kr("dimension",null,{ref:u}),a[a.length]=QDe(c,e,t,r),e.sheetFormat&&(a[a.length]=Kr("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=DDe(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=$De(c,e),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=BDe(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=MDe(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=EDe(c["!merges"]));var A=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Ja(n,-1,rs(p[1].Target).replace(/#.*$/,""),ia.HLINK),h["r:id"]="rId"+m),(A=p[1].Target.indexOf("#"))>-1&&(h.location=rs(p[1].Target.slice(A+1))),p[1].Tooltip&&(h.tooltip=rs(p[1].Tooltip)),a[a.length]=Kr("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=FDe(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Sl("ignoredErrors",Kr("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Ja(n,-1,"../drawings/drawing"+(t+1)+".xml",ia.DRAW),a[a.length]=Kr("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Ja(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ia.VML),a[a.length]=Kr("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function KDe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function GDe(t,e,r){var n=cr(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;a.hpx?s=L2(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var f=-1,A=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[On(u)];m&&(f<0&&(f=h),A=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,A))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function qDe(t,e,r,n){var a=GDe(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Nr(t,0,a)}var zDe=Qg,WDe=b1;function XDe(){}function YDe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=e5e(t),r}function JDe(t,e,r){r==null&&(r=cr(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return qS({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$ne(t,r),r.slice(0,r.l)}function ZDe(t){var e=Qd(t);return[e]}function e6e(t,e,r){return r==null&&(r=cr(8)),Mg(e,r)}function t6e(t){var e=Lg(t);return[e]}function r6e(t,e,r){return r==null&&(r=cr(4)),Ug(e,r)}function n6e(t){var e=Qd(t),r=t.read_shift(1);return[e,r,"b"]}function a6e(t,e,r){return r==null&&(r=cr(9)),Mg(e,r),r.write_shift(1,t.v?1:0),r}function s6e(t){var e=Lg(t),r=t.read_shift(1);return[e,r,"b"]}function i6e(t,e,r){return r==null&&(r=cr(5)),Ug(e,r),r.write_shift(1,t.v?1:0),r}function o6e(t){var e=Qd(t),r=t.read_shift(1);return[e,r,"e"]}function l6e(t,e,r){return r==null&&(r=cr(9)),Mg(e,r),r.write_shift(1,t.v),r}function c6e(t){var e=Lg(t),r=t.read_shift(1);return[e,r,"e"]}function u6e(t,e,r){return r==null&&(r=cr(8)),Ug(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function d6e(t){var e=Qd(t),r=t.read_shift(4);return[e,r,"s"]}function f6e(t,e,r){return r==null&&(r=cr(12)),Mg(e,r),r.write_shift(4,e.v),r}function h6e(t){var e=Lg(t),r=t.read_shift(4);return[e,r,"s"]}function A6e(t,e,r){return r==null&&(r=cr(8)),Ug(e,r),r.write_shift(4,e.v),r}function m6e(t){var e=Qd(t),r=nc(t);return[e,r,"n"]}function p6e(t,e,r){return r==null&&(r=cr(16)),Mg(e,r),Ag(t.v,r),r}function Wae(t){var e=Lg(t),r=nc(t);return[e,r,"n"]}function g6e(t,e,r){return r==null&&(r=cr(12)),Ug(e,r),Ag(t.v,r),r}function x6e(t){var e=Qd(t),r=hR(t);return[e,r,"n"]}function v6e(t,e,r){return r==null&&(r=cr(12)),Mg(e,r),Kne(t.v,r),r}function y6e(t){var e=Lg(t),r=hR(t);return[e,r,"n"]}function b6e(t,e,r){return r==null&&(r=cr(8)),Ug(e,r),Kne(t.v,r),r}function w6e(t){var e=Qd(t),r=uR(t);return[e,r,"is"]}function N6e(t){var e=Qd(t),r=sc(t);return[e,r,"str"]}function C6e(t,e,r){return r==null&&(r=cr(12+4*t.v.length)),Mg(e,r),Zo(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _6e(t){var e=Lg(t),r=sc(t);return[e,r,"str"]}function E6e(t,e,r){return r==null&&(r=cr(8+4*t.v.length)),Ug(e,r),Zo(t.v,r),r.length>r.l?r.slice(0,r.l):r}function S6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"b"];if(r.cellFormula){t.l+=2;var l=AP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}function I6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"e"];if(r.cellFormula){t.l+=2;var l=AP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}function j6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=nc(t),o=[a,s,"n"];if(r.cellFormula){t.l+=2;var l=AP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}function P6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=sc(t),o=[a,s,"str"];if(r.cellFormula){t.l+=2;var l=AP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}var B6e=Qg,T6e=b1;function k6e(t,e){return e==null&&(e=cr(4)),e.write_shift(4,t),e}function F6e(t,e){var r=t.l+e,n=Qg(t),a=dR(t),s=sc(t),o=sc(t),l=sc(t);t.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function O6e(t,e){var r=cr(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));b1({s:ci(t[0]),e:ci(t[0])},r),fR("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return Zo(a||"",r),Zo(t[1].Tooltip||"",r),Zo("",r),r.slice(0,r.l)}function D6e(){}function R6e(t,e,r){var n=t.l+e,a=Gne(t),s=t.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=oDe(t,n-t.l,r);o[1]=l}else t.l=n;return o}function M6e(t,e,r){var n=t.l+e,a=Qg(t),s=[a];if(r.cellFormula){var o=cDe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function L6e(t,e,r){r==null&&(r=cr(18));var n=mP(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var Xae=["left","right","top","bottom","header","footer"];function U6e(t){var e={};return Xae.forEach(function(r){e[r]=nc(t)}),e}function Q6e(t,e){return e==null&&(e=cr(6*8)),Hp(t),Xae.forEach(function(r){Ag(t[r],e)}),e}function V6e(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function H6e(t,e,r){r==null&&(r=cr(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $6e(t){var e=cr(24);return e.write_shift(4,4),e.write_shift(4,1),b1(t,e),e}function K6e(t,e){return e==null&&(e=cr(16*4+2)),e.write_shift(2,t.password?vR(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function G6e(){}function q6e(){}function z6e(t,e,r,n,a,s,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,A=!1,h,m,p,x,v,y,b,w,j,I=[];l.biff=12,l["!row"]=0;var _=0,S=!1,E=[],B={},k=l.supbooks||a.supbooks||[[]];if(k.sharedf=B,k.arrayf=E,k.SheetNames=a.SheetNames||a.Sheets.map(function(ge){return ge.name}),!l.supbooks&&(l.supbooks=k,a.Names))for(var P=0;P<a.Names.length;++P)k[0][P+1]=a.Names[P];var O=[],z=[],oe=!1;U2[16]={n:"BrtShortReal",f:Wae};var ce;if(RA(t,function(ne,Oe,Ue){if(!A)switch(Ue){case 148:u=ne;break;case 0:h=ne,l.sheetRows&&l.sheetRows<=h.r&&(A=!0),w=zi(x=h.r),l["!row"]=h.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Qv(ne.hpt)),z[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:ne[2]},ne[2]){case"n":m.v=ne[1];break;case"s":b=Ob[ne[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!ne[1];break;case"e":m.v=ne[1],l.cellText!==!1&&(m.w=MA[m.v]);break;case"str":m.t="s",m.v=ne[1];break;case"is":m.t="s",m.v=ne[1].t;break}if((p=o.CellXf[ne[0].iStyleRef])&&Gae(m,p.numFmtId,null,l,s,o),v=ne[0].c==-1?v+1:ne[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[li(v)+w]=m,l.cellFormula){for(S=!1,_=0;_<E.length;++_){var F=E[_];h.r>=F[0].s.r&&h.r<=F[0].e.r&&v>=F[0].s.c&&v<=F[0].e.c&&(m.F=Wn(F[0]),S=!0)}!S&&ne.length>3&&(m.f=ne[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),l.cellDates&&p&&m.t=="n"&&x1(kn[p.numFmtId])){var H=Ep(m.v);H&&(m.t="d",m.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}ce&&(ce.type=="XLDAPR"&&(m.D=!0),ce=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},v=ne[0].c==-1?v+1:ne[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[li(v)+w]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),ce&&(ce.type=="XLDAPR"&&(m.D=!0),ce=void 0);break;case 176:I.push(ne);break;case 49:ce=((l.xlmeta||{}).Cell||[])[ne-1];break;case 494:var K=n["!id"][ne.relId];for(K?(ne.Target=K.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=K):ne.relId==""&&(ne.Target="#"+ne.loc),x=ne.rfx.s.r;x<=ne.rfx.e.r;++x)for(v=ne.rfx.s.c;v<=ne.rfx.e.c;++v)l.dense?(c[x]||(c[x]=[]),c[x][v]||(c[x][v]={t:"z",v:void 0}),c[x][v].l=ne):(y=On({c:v,r:x}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=ne);break;case 426:if(!l.cellFormula)break;E.push(ne),j=l.dense?c[x][v]:c[li(v)+w],j.f=ec(ne[1],d,{r:h.r,c:v},k,l),j.F=Wn(ne[0]);break;case 427:if(!l.cellFormula)break;B[On(ne[0].s)]=ne[1],j=l.dense?c[x][v]:c[li(v)+w],j.f=ec(ne[1],d,{r:h.r,c:v},k,l);break;case 60:if(!l.cellStyles)break;for(;ne.e>=ne.s;)O[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},oe||(oe=!0,yR(ne.w/256)),Im(O[ne.e+1]);break;case 161:c["!autofilter"]={ref:Wn(ne)};break;case 476:c["!margins"]=ne;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ne.name&&(a.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(c["!outline"]={above:ne.above,left:ne.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ne.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!Oe.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+Ue.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Wn(u||d)),l.sheetRows&&c["!ref"]){var ue=Ea(c["!ref"]);l.sheetRows<=+ue.e.r&&(ue.e.r=l.sheetRows-1,ue.e.r>d.e.r&&(ue.e.r=d.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>d.e.c&&(ue.e.c=d.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Wn(ue))}return I.length>0&&(c["!merges"]=I),O.length>0&&(c["!cols"]=O),z.length>0&&(c["!rows"]=z),c}function W6e(t,e,r,n,a,s,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Os(e),e.z=e.z||kn[14],e.v=Oo(Fs(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=Vm(a.cellXfs,e,a),e.l&&s["!links"].push([On(c),e.l]),e.c&&s["!comments"].push([On(c),e.c]),e.t){case"s":case"str":return a.bookSST?(l=_R(a.Strings,e.v,a.revStrings),c.t="s",c.v=l,o?Nr(t,18,A6e(e,c)):Nr(t,7,f6e(e,c))):(c.t="str",o?Nr(t,17,E6e(e,c)):Nr(t,6,C6e(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Nr(t,13,b6e(e,c)):Nr(t,2,v6e(e,c)):o?Nr(t,16,g6e(e,c)):Nr(t,5,p6e(e,c)),!0;case"b":return c.t="b",o?Nr(t,15,i6e(e,c)):Nr(t,4,a6e(e,c)),!0;case"e":return c.t="e",o?Nr(t,14,u6e(e,c)):Nr(t,3,l6e(e,c)),!0}return o?Nr(t,12,r6e(e,c)):Nr(t,1,e6e(e,c)),!0}function X6e(t,e,r,n){var a=Ea(e["!ref"]||"A1"),s,o="",l=[];Nr(t,145);var c=Array.isArray(e),u=a.e.r;e["!rows"]&&(u=Math.max(a.e.r,e["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=zi(d),qDe(t,e,a,d);var f=!1;if(d<=a.e.r)for(var A=a.s.c;A<=a.e.c;++A){d===a.s.r&&(l[A]=li(A)),s=l[A]+o;var h=c?(e[d]||[])[A]:e[s];if(!h){f=!1;continue}f=W6e(t,h,d,A,n,e,f)}}Nr(t,146)}function Y6e(t,e){!e||!e["!merges"]||(Nr(t,177,k6e(e["!merges"].length)),e["!merges"].forEach(function(r){Nr(t,176,T6e(r))}),Nr(t,178))}function J6e(t,e){!e||!e["!cols"]||(Nr(t,390),e["!cols"].forEach(function(r,n){r&&Nr(t,60,L6e(n,r))}),Nr(t,391))}function Z6e(t,e){!e||!e["!ref"]||(Nr(t,648),Nr(t,649,$6e(Ea(e["!ref"]))),Nr(t,650))}function eRe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=Ja(r,-1,n[1].Target.replace(/#.*$/,""),ia.HLINK);Nr(t,494,O6e(n,a))}}),delete e["!links"]}function tRe(t,e,r,n){if(e["!comments"].length>0){var a=Ja(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ia.VML);Nr(t,551,fR("rId"+a)),e["!legacy"]=a}}function rRe(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:Wn(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ou(s);l.s.r==l.e.r&&(l.e.r=ou(e["!ref"]).e.r,s=Wn(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Nr(t,161,b1(Ea(s))),Nr(t,162)}}function nRe(t,e,r){Nr(t,133),Nr(t,137,H6e(e,r)),Nr(t,138),Nr(t,134)}function aRe(t,e){e["!protect"]&&Nr(t,535,K6e(e["!protect"]))}function sRe(t,e,r,n){var a=iu(),s=r.SheetNames[t],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=Ea(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Nr(a,129),(r.vbaraw||o["!outline"])&&Nr(a,147,JDe(l,o["!outline"])),Nr(a,148,WDe(c)),nRe(a,o,r.Workbook),J6e(a,o),X6e(a,o,t,e),aRe(a,o),rRe(a,o,r,t),Y6e(a,o),eRe(a,o,n),o["!margins"]&&Nr(a,476,Q6e(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Z6e(a,o),tRe(a,o,t,n),Nr(a,130),a.end()}function iRe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=_a((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function oRe(t,e,r,n,a,s){var o=s||{"!type":"chart"};if(!t)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var A=iRe(f);d.s.r=d.s.c=0,d.e.c=l,u=li(l),A[0].forEach(function(h,m){o[u+zi(m)]={t:"n",v:h,z:A[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=Wn(d)),o}function lRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(qae);return l&&ER(l[0],s,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function cRe(t,e){t.l+=10;var r=sc(t);return{name:r}}function uRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return RA(t,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var SR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dRe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],fRe=[],hRe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function a$(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ps(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function s$(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ps(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Yae(t){s$(t.WBProps,SR),s$(t.CalcPr,hRe),a$(t.WBView,dRe),a$(t.Sheets,fRe),xv.date1904=Ps(t.WBProps.date1904)}function ARe(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ps(t.Workbook.WBProps.date1904)?"true":"false"}var mRe="][*?/\\".split("");function Jae(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return mRe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pRe(t,e,r){t.forEach(function(n,a){Jae(n);for(var s=0;s<a;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function gRe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];pRe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)ADe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var xRe=/<\w+:workbook/;function vRe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(t.replace(cc,function(c,u){var d=Dn(c);switch(gh(d[0])){case"<?xml":break;case"<workbook":c.match(xRe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":SR.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ps(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=cs(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=_a(cs(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=cs(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Ps(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=_a(cs(t.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Rg.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Yae(r),r}function Zae(t){var e=[Xi];e[e.length]=Kr("workbook",null,{xmlns:Rg[0],"xmlns:r":Po.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(SR.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Kr("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:rs(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Kr("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=Kr("definedName",rs(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function yRe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Xk(t),r.name=sc(t),r}function bRe(t,e){return e||(e=cr(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),fR(t.strRelID,e),Zo(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function wRe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?sc(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function NRe(t,e){e||(e=cr(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),$ne(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function CRe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function _Re(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=t5e(t),o=lDe(t,0,r),l=dR(t);t.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function ERe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],U2[16]={n:"BrtFRTArchID$",f:CRe},RA(t,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=ec(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),Yae(r),r.Names=s,r.supbooks=o,r}function SRe(t,e){Nr(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Nr(t,156,bRe(a))}Nr(t,144)}function IRe(t,e){e||(e=cr(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Zo("SheetJS",e),Zo(US.version,e),Zo(US.version,e),Zo("7262",e),e.length>e.l?e.slice(0,e.l):e}function jRe(t,e){e||(e=cr(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function PRe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Nr(t,135),Nr(t,158,jRe(a)),Nr(t,136))}}function BRe(t,e){var r=iu();return Nr(r,131),Nr(r,128,IRe()),Nr(r,153,NRe(t.Workbook&&t.Workbook.WBProps||null)),PRe(r,t),SRe(r,t),Nr(r,132),r.end()}function TRe(t,e,r){return e.slice(-4)===".bin"?ERe(t,r):vRe(t,r)}function kRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?z6e(t,n,r,a,s,o,l):_De(t,n,r,a,s,o,l)}function FRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?uRe(t,n,r,a,s):lRe(t,n,r,a,s)}function ORe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?RFe():MFe()}function DRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?OFe():DFe()}function RRe(t,e,r,n){return e.slice(-4)===".bin"?Tke(t,r,n):yke(t,r,n)}function MRe(t,e,r){return kae(t,r)}function LRe(t,e,r){return e.slice(-4)===".bin"?LTe(t,r):DTe(t,r)}function URe(t,e,r){return e.slice(-4)===".bin"?PFe(t,r):bFe(t,r)}function QRe(t,e,r){return e.slice(-4)===".bin"?xFe(t):pFe(t)}function VRe(t,e,r,n){return r.slice(-4)===".bin"?vFe(t,e,r,n):void 0}function HRe(t,e,r){return e.slice(-4)===".bin"?hFe(t,e,r):mFe(t,e,r)}function $Re(t,e,r){return(e.slice(-4)===".bin"?BRe:Zae)(t)}function KRe(t,e,r,n,a){return(e.slice(-4)===".bin"?sRe:zae)(t,r,n,a)}function GRe(t,e,r){return(e.slice(-4)===".bin"?Vke:Bae)(t,r)}function qRe(t,e,r){return(e.slice(-4)===".bin"?VTe:Nae)(t,r)}function zRe(t,e,r){return(e.slice(-4)===".bin"?BFe:Dae)(t)}function WRe(t){return(t.slice(-4)===".bin"?AFe:Fae)()}var ese=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,tse=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Xd(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(ese),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(tse),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function XRe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(ese),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(tse),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Rb;function YRe(t,e){var r=Rb[t]||_a(t);return r==="General"?fg(e):Od(r,e)}function JRe(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ps(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Fs(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[_a(e)]=a}function ZRe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||MA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=B2(t.v):t.w=fg(t.v):t.w=YRe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Rb[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&x1(n)){var a=Ep(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function eMe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=fke[n.Pattern]||n.Pattern)}t[e.ID]=e}function tMe(t,e,r,n,a,s,o,l,c,u){var d="General",f=n.StyleID,A={};u=u||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ps(t);break;case"String":n.t="s",n.r=wH(_a(t)),n.v=t.indexOf("<")>-1?_a(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Fs(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=_a(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Wne[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=wH(e||t));break}if(ZRe(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=_a(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=gv(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=gv("RC:RC",a):n.ArrayRange&&(n.F=gv(n.ArrayRange,a),c.push([Ea(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(x){!A.patternType&&x.patternType&&(A.patternType=x.patternType)}),n.s=A),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function rMe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function D5(t,e){var r=e||{};v1();var n=zy(sR(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=cs(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Os(r);return o.type="string",Uv.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(He){a.indexOf("<"+He)>=0&&(s=!0)}),s)return QMe(n,r);Rb={"General Number":"General","General Date":kn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kn[15],"Short Date":kn[14],"Long Time":kn[19],"Medium Time":kn[18],"Short Time":kn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kn[2],Standard:kn[4],Percent:kn[10],Scientific:kn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],A=r.dense?[]:{},h="",m={},p={},x=Xd('<Data ss:Type="String">'),v=0,y=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},I={},_="",S=0,E=[],B={},k={},P=0,O=[],z=[],oe={},ce=[],ue,ge=!1,ne=[],Oe=[],Ue={},F=0,H=0,K={Sheets:[],WBProps:{date1904:!1}},U={};F2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";l=F2.exec(n);)switch(l[3]=(W=l[3]).toLowerCase()){case"data":if(W=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?tMe(n.slice(v,l.index),_,x,c[c.length-1][0]=="comment"?oe:m,{c:y,r:b},j,ce[y],p,ne,r):(_="",x=Xd(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(z.length>0&&(m.c=z),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(A[b]||(A[b]=[]),A[b][y]=m):A[li(y)+zi(b)]=m),m.HRef&&(m.l={Target:_a(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(F=y+(parseInt(m.MergeAcross,10)|0),H=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:y,r:b},e:{c:F,r:H}})),!r.sheetStubs)m.MergeAcross?y=F+1:++y;else if(m.MergeAcross||m.MergeDown){for(var X=y;X<=F;++X)for(var D=b;D<=H;++D)(X>y||D>b)&&(r.dense?(A[D]||(A[D]=[]),A[D][X]={t:"z"}):A[li(X)+zi(D)]={t:"z"});y=F+1}else++y;else m=XRe(l[0]),m.Index&&(y=+m.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),l[0].slice(-2)==="/>"&&++y,z=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),l[0].slice(-2)==="/>"&&(p=Xd(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=Xd(l[0]),p.Index&&(b=+p.Index-1),Ue={},(p.AutoFitHeight=="0"||p.Height)&&(Ue.hpx=parseInt(p.Height,10),Ue.hpt=L2(Ue.hpx),Oe[b]=Ue),p.Hidden=="1"&&(Ue.hidden=!0,Oe[b]=Ue));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(A["!ref"]=Wn(w),r.sheetRows&&r.sheetRows<=w.e.r&&(A["!fullref"]=A["!ref"],w.e.r=r.sheetRows-1,A["!ref"]=Wn(w))),E.length&&(A["!merges"]=E),ce.length>0&&(A["!cols"]=ce),Oe.length>0&&(A["!rows"]=Oe),d[h]=A}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),u=Xd(l[0]),h=_a(u.Name),A=r.dense?[]:{},E=[],ne=[],Oe=[],U={name:h,Hidden:0},K.Sheets.push(U);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ce=[],ge=!1}break;case"style":l[1]==="/"?eMe(j,I,r):I=Xd(l[0]);break;case"numberformat":I.nf=_a(Xd(l[0]).Format||"General"),Rb[I.nf]&&(I.nf=Rb[I.nf]);for(var V=0;V!=392&&kn[V]!=I.nf;++V);if(V==392){for(V=57;V!=392;++V)if(kn[V]==null){lA(I.nf,V);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ue=Xd(l[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!ge&&ue.wpx>10){ge=!0,rc=jae;for(var Z=0;Z<ce.length;++Z)ce[Z]&&Im(ce[Z])}ge&&Im(ue),ce[ue.Index-1||ce.length]=ue;for(var be=0;be<+ue.Span;++be)ce[ce.length]=Os(ue);break;case"namedrange":if(l[1]==="/")break;K.Names||(K.Names=[]);var L=Dn(l[0]),Xe={Name:L.Name,Ref:gv(L.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Xe.Sheet=K.Sheets.length-1),K.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=Xd(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?E5e(B,W,n.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));rMe(oe),z.push(oe)}else c.push([l[3],!1]),u=Xd(l[0]),oe={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var re=Xd(l[0]);A["!autofilter"]={ref:gv(re.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return u$(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(l[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(P,l.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else P=l.index+l[0].length;break;case"header":A["!margins"]||Hp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].header=+Dn(l[0]).Margin);break;case"footer":A["!margins"]||Hp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].footer=+Dn(l[0]).Margin);break;case"pagemargins":var De=Dn(l[0]);A["!margins"]||Hp(A["!margins"]={},"xlml"),isNaN(+De.Top)||(A["!margins"].top=+De.Top),isNaN(+De.Left)||(A["!margins"].left=+De.Left),isNaN(+De.Right)||(A["!margins"].right=+De.Right),isNaN(+De.Bottom)||(A["!margins"].bottom=+De.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?JRe(k,W,O,n.slice(P,l.index)):(O=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ie={};return!r.bookSheets&&!r.bookProps&&(ie.Sheets=d),ie.SheetNames=f,ie.Workbook=K,ie.SSF=Os(kn),ie.Props=B,ie.Custprops=k,ie}function nF(t,e){switch(jR(e=e||{}),e.type||"base64"){case"base64":return D5(Hu(t),e);case"binary":case"buffer":case"file":return D5(t,e);case"array":return D5(Um(t),e)}}function nMe(t,e){var r=[];return t.Props&&r.push(S5e(t.Props,e)),t.Custprops&&r.push(I5e(t.Props,t.Custprops)),r.join("")}function aMe(){return""}function sMe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(Kr("NumberFormat",null,{"ss:Format":rs(kn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Kr("Style",s.join(""),o))}),Kr("Styles",r.join(""))}function rse(t){return Kr("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+NR(t.Ref,{r:0,c:0})})}function iMe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(rse(a)))}return Kr("Names",r.join(""))}function oMe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(rse(l)))}return s.join("")}function lMe(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Kr("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Kr("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Kr("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Kr("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Sl("ProtectContents","True")),t["!protect"].objects&&a.push(Sl("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Sl("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Sl("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Sl("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Kr("WorksheetOptions",a.join(""),{xmlns:Iu.x})}function cMe(t){return t.map(function(e){var r=P4e(e.t||""),n=Kr("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Kr("Comment",n,{"ss:Author":e.a})}).join("")}function uMe(t,e,r,n,a,s,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+rs(NR(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=ci(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=rs(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=rs(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",A="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",A=String(t.v);break;case"b":f="Boolean",A=t.v?"1":"0";break;case"e":f="Error",A=MA[t.v];break;case"d":f="DateTime",A=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||kn[14]);break;case"s":f="String",A=j4e(t.v||"");break}var h=Vm(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?A:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=cMe(t.c)),Kr("Cell",p,l)}function dMe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Qv(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function fMe(t,e,r,n){if(!t["!ref"])return"";var a=Ea(t["!ref"]),s=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,v){Im(x);var y=!!x.width,b=mP(v,x),w={"ss:Index":v+1};y&&(w["ss:Width"]=R2(b.width)),x.hidden&&(w["ss:Hidden"]="1"),l.push(Kr("Column",null,w))});for(var c=Array.isArray(t),u=a.s.r;u<=a.e.r;++u){for(var d=[dMe(u,(t["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var A=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(A=!0);break}if(!A){var h={r:u,c:f},m=On(h),p=c?(t[u]||[])[f]:t[m];d.push(uMe(p,m,t,e,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function hMe(t,e,r){var n=[],a=r.SheetNames[t],s=r.Sheets[a],o=s?oMe(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?fMe(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(lMe(s,e,t,r)),n.join("")}function AMe(t,e){e||(e={}),t.SSF||(t.SSF=Os(kn)),t.SSF&&(v1(),lP(t.SSF),e.revssf=uP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Vm(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(nMe(t,e)),r.push(aMe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Kr("Worksheet",hMe(n,e,t),{"ss:Name":rs(t.SheetNames[n])}));return r[2]=sMe(t,e),r[3]=iMe(t),Xi+Kr("Workbook",r.join(""),{xmlns:Iu.ss,"xmlns:o":Iu.o,"xmlns:x":Iu.x,"xmlns:ss":Iu.ss,"xmlns:dt":Iu.dt,"xmlns:html":Iu.html})}function mMe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=i5e(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=o5e(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var pMe=[60,1084,2066,2165,2175];function gMe(t,e,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Yh(r,r.l),u=aF[c],d=0;u!=null&&pMe.indexOf(c)>-1;)s=Yh(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=aF[c=Yh(r,r.l)];var f=Jo(o);_l(f,0);var A=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(A),A+=o[h].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,a)}function Mf(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=kn[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||MA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=B2(t.v):t.w=fg(t.v):t.w=Od(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&x1(kn[n]||String(n))){var a=Ep(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function XC(t,e,r){return{v:t,ixfe:e,t:r}}function xMe(t,e){var r={opts:{}},n={},a=e.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,A="",h,m,p,x,v={},y=[],b,w,j=[],I=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},E=function(Te){return Te<8?Up[Te]:Te<64&&I[Te-8]||Up[Te]},B=function(Te,ee,me){var Re=ee.XF.data;if(!(!Re||!Re.patternType||!me||!me.cellStyles)){ee.s={},ee.s.patternType=Re.patternType;var he;(he=D2(E(Re.icvFore)))&&(ee.s.fgColor={rgb:he}),(he=D2(E(Re.icvBack)))&&(ee.s.bgColor={rgb:he})}},k=function(Te,ee,me){if(!(Ue>1)&&!(me.sheetRows&&Te.r>=me.sheetRows)){if(me.cellStyles&&ee.XF&&ee.XF.data&&B(Te,ee,me),delete ee.ixfe,delete ee.XF,f=Te,A=On(Te),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Te.r<o.s.r&&(o.s.r=Te.r),Te.c<o.s.c&&(o.s.c=Te.c),Te.r+1>o.e.r&&(o.e.r=Te.r+1),Te.c+1>o.e.c&&(o.e.c=Te.c+1),me.cellFormula&&ee.f){for(var Re=0;Re<y.length;++Re)if(!(y[Re][0].s.c>Te.c||y[Re][0].s.r>Te.r)&&!(y[Re][0].e.c<Te.c||y[Re][0].e.r<Te.r)){ee.F=Wn(y[Re][0]),(y[Re][0].s.c!=Te.c||y[Re][0].s.r!=Te.r)&&delete ee.f,ee.f&&(ee.f=""+ec(y[Re][1],o,Te,ne,P));break}}me.dense?(a[Te.r]||(a[Te.r]=[]),a[Te.r][Te.c]=ee):a[A]=ee}},P={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var O,z=[],oe=[],ce=[],ue=[],ge=!1,ne=[];ne.SheetNames=P.snames,ne.sharedf=P.sharedf,ne.arrayf=P.arrayf,ne.names=[],ne.XTI=[];var Oe=0,Ue=0,F=0,H=[],K=[],U;P.codepage=1200,ff(1200);for(var W=!1;t.l<t.length-1;){var X=t.l,D=t.read_shift(2);if(D===0&&Oe===10)break;var V=t.l===t.length?0:t.read_shift(2),Z=aF[D];if(Z&&Z.f){if(e.bookSheets&&Oe===133&&D!==133)break;if(Oe=D,Z.r===2||Z.r==12){var be=t.read_shift(2);if(V-=2,!P.enc&&be!==D&&((be&255)<<8|be>>8)!==D)throw new Error("rt mismatch: "+be+"!="+D);Z.r==12&&(t.l+=10,V-=10)}var L={};if(D===10?L=Z.f(t,V,P):L=gMe(D,Z,t,V,P),Ue==0&&[9,521,1033,2057].indexOf(Oe)===-1)continue;switch(D){case 34:r.opts.Date1904=_.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=L,!e.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=L;break;case 66:var Xe=Number(L);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}ff(P.codepage=Xe),W=!0;break;case 317:P.rrtabid=L;break;case 25:P.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:P.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(a["!type"]="dialog"),L.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),L.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:j.push(L);break;case 430:ne.push([L]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(L);break;case 24:case 536:U={Name:L.Name,Ref:ec(L.rgce,o,null,ne,P)},L.itab>0&&(U.Sheet=L.itab-1),ne.names.push(U),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(K[L.itab-1]={ref:Wn(L.rgce[0][0][1][2])});break;case 22:P.ExternCount=L;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(L),ne.XTI=ne.XTI.concat(L);break;case 2196:if(P.biff<8)break;U!=null&&(U.Comment=L[1]);break;case 18:a["!protect"]=L;break;case 19:L!==0&&P.WTF&&console.error("Password verifier: "+L);break;case 133:s[L.pos]=L,P.snames.push(L.name);break;case 10:{if(--Ue)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=Wn(o),e.sheetRows&&e.sheetRows<=o.e.r){var re=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Wn(o),o.e.r=re}o.e.r++,o.e.c++}z.length>0&&(a["!merges"]=z),oe.length>0&&(a["!objects"]=oe),ce.length>0&&(a["!cols"]=ce),ue.length>0&&(a["!rows"]=ue),_.Sheets.push(S)}u===""?d=a:n[u]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[D]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),P.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(P.biff=5,W=!0,ff(P.codepage=28591)),P.biff==8&&L.BIFFVer==0&&L.dt==16&&(P.biff=2),Ue++)break;if(a=e.dense?[]:{},P.biff<8&&!W&&(W=!0,ff(P.codepage=e.codepage||1252)),P.biff<5||L.BIFFVer==0&&L.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:t.l-V,name:u};s[J.pos]=J,P.snames.push(u)}else u=(s[X]||{name:""}).name;L.dt==32&&(a["!type"]="chart"),L.dt==64&&(a["!type"]="macro"),z=[],oe=[],P.arrayf=y=[],ce=[],ue=[],ge=!1,S={Hidden:(s[X]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[L.r]||[])[L.c]:a[On({c:L.c,r:L.r})])&&++L.c,b={ixfe:L.ixfe,XF:j[L.ixfe]||{},v:L.val,t:"n"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:L.c,r:L.r},b,e);break;case 5:case 517:b={ixfe:L.ixfe,XF:j[L.ixfe],v:L.val,t:L.t},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:L.c,r:L.r},b,e);break;case 638:b={ixfe:L.ixfe,XF:j[L.ixfe],v:L.rknum,t:"n"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:L.c,r:L.r},b,e);break;case 189:for(var De=L.c;De<=L.C;++De){var ie=L.rkrec[De-L.c][0];b={ixfe:ie,XF:j[ie],v:L.rkrec[De-L.c][1],t:"n"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:De,r:L.r},b,e)}break;case 6:case 518:case 1030:{if(L.val=="String"){l=L;break}if(b=XC(L.val,L.cell.ixfe,L.tt),b.XF=j[b.ixfe],e.cellFormula){var He=L.formula;if(He&&He[0]&&He[0][0]&&He[0][0][0]=="PtgExp"){var Ge=He[0][0][1][0],dt=He[0][0][1][1],_t=On({r:Ge,c:dt});v[_t]?b.f=""+ec(L.formula,o,L.cell,ne,P):b.F=((e.dense?(a[Ge]||[])[dt]:a[_t])||{}).F}else b.f=""+ec(L.formula,o,L.cell,ne,P)}F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k(L.cell,b,e),l=L}break;case 7:case 519:if(l)l.val=L,b=XC(L,l.cell.ixfe,"s"),b.XF=j[b.ixfe],e.cellFormula&&(b.f=""+ec(l.formula,o,l.cell,ne,P)),F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(L);var Bt=On(L[0].s);if(h=e.dense?(a[L[0].s.r]||[])[L[0].s.c]:a[Bt],e.cellFormula&&h){if(!l||!Bt||!h)break;h.f=""+ec(L[1],o,L[0],ne,P),h.F=Wn(L[0])}}break;case 1212:{if(!e.cellFormula)break;if(A){if(!l)break;v[On(l.cell)]=L[0],h=e.dense?(a[l.cell.r]||[])[l.cell.c]:a[On(l.cell)],(h||{}).f=""+ec(L[0],o,f,ne,P)}}break;case 253:b=XC(c[L.isst].t,L.ixfe,"s"),c[L.isst].h&&(b.h=c[L.isst].h),b.XF=j[b.ixfe],F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:L.c,r:L.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:L.ixfe,XF:j[L.ixfe],t:"z"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:L.c,r:L.r},b,e));break;case 190:if(e.sheetStubs)for(var Ot=L.c;Ot<=L.C;++Ot){var jt=L.ixfe[Ot-L.c];b={ixfe:jt,XF:j[jt],t:"z"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:Ot,r:L.r},b,e)}break;case 214:case 516:case 4:b=XC(L.val,L.ixfe,"s"),b.XF=j[b.ixfe],F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),k({c:L.c,r:L.r},b,e);break;case 0:case 512:Ue===1&&(o=L);break;case 252:c=L;break;case 1054:if(P.biff==4){H[F++]=L[1];for(var Qt=0;Qt<F+163&&kn[Qt]!=L[1];++Qt);Qt>=163&&lA(L[1],F+163)}else lA(L[1],L[0]);break;case 30:{H[F++]=L;for(var Ft=0;Ft<F+163&&kn[Ft]!=L;++Ft);Ft>=163&&lA(L,F+163)}break;case 229:z=z.concat(L);break;case 93:oe[L.cmo[0]]=P.lastobj=L;break;case 438:P.lastobj.TxO=L;break;case 127:P.lastobj.ImData=L;break;case 440:for(x=L[0].s.r;x<=L[0].e.r;++x)for(p=L[0].s.c;p<=L[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&(h.l=L[1]);break;case 2048:for(x=L[0].s.r;x<=L[0].e.r;++x)for(p=L[0].s.c;p<=L[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&h.l&&(h.l.Tooltip=L[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=e.dense?(a[L[0].r]||[])[L[0].c]:a[On(L[0])];var $e=oe[L[2]];h||(e.dense?(a[L[0].r]||(a[L[0].r]=[]),h=a[L[0].r][L[0].c]={t:"z"}):h=a[On(L[0])]={t:"z"},o.e.r=Math.max(o.e.r,L[0].r),o.s.r=Math.min(o.s.r,L[0].r),o.e.c=Math.max(o.e.c,L[0].c),o.s.c=Math.min(o.s.c,L[0].c)),h.c||(h.c=[]),m={a:L[1],t:$e.TxO.t},h.c.push(m)}break;case 2173:sFe(j[L.ixfe],L.ext);break;case 125:{if(!P.cellStyles)break;for(;L.e>=L.s;)ce[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},ge||(ge=!0,yR(L.w/256)),Im(ce[L.e+1])}break;case 520:{var Fe={};L.level!=null&&(ue[L.r]=Fe,Fe.level=L.level),L.hidden&&(ue[L.r]=Fe,Fe.hidden=!0),L.hpt&&(ue[L.r]=Fe,Fe.hpt=L.hpt,Fe.hpx=Qv(L.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Hp(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[D]]=L;break;case 161:a["!margins"]||Hp(a["!margins"]={}),a["!margins"].header=L.header,a["!margins"].footer=L.footer;break;case 574:L.RTL&&(_.Views[0].RTL=!0);break;case 146:I=L;break;case 2198:O=L;break;case 140:w=L;break;case 442:u?S.CodeName=L||S.name:_.WBProps.CodeName=L||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+D.toString(16)),t.l+=V}return r.SheetNames=Pi(s).sort(function(Ze,Te){return Number(Ze)-Number(Te)}).map(function(Ze){return s[Ze].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&K.forEach(function(Ze,Te){r.Sheets[r.SheetNames[Te]]["!autofilter"]=Ze}),r.Strings=c,r.SSF=Os(kn),P.enc&&(r.Encryption=P.enc),O&&(r.Themes=O),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),ne.names.length>0&&(_.Names=ne.names),r.Workbook=_,r}var Mb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function vMe(t,e,r){var n=En.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=UH(n,Yk,Mb.DSI);for(var s in a)e[s]=a[s]}catch(u){if(r.WTF)throw u}var o=En.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=UH(o,Jk,Mb.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(tae(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function yMe(t,e){var r=[],n=[],a=[],s=0,o,l=pH(Yk,"n"),c=pH(Jk,"n");if(t.Props)for(o=Pi(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=Pi(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)lae.indexOf(a[s][0])>-1||eae.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&En.utils.cfb_add(e,"/SummaryInformation",QH(n,Mb.SI,c,Jk)),(r.length||u.length)&&En.utils.cfb_add(e,"/DocumentSummaryInformation",QH(r,Mb.DSI,l,Yk,u.length?u:null,Mb.UDI))}function nse(t,e){e||(e={}),jR(e),X6(),e.codepage&&W6(e.codepage);var r,n;if(t.FullPaths){if(En.find(t,"/encryption"))throw new Error("File is password-protected");r=En.find(t,"!CompObj"),n=En.find(t,"/Workbook")||En.find(t,"/Book")}else{switch(e.type){case"base64":t=Pu(Hu(t));break;case"binary":t=Pu(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}_l(t,0),n={content:t}}var a,s;if(r&&mMe(r),e.bookProps&&!e.bookSheets)a={};else{var o=ta?"buffer":"array";if(n&&n.content)a=xMe(n.content,e);else if((s=En.find(t,"PerfectOffice_MAIN"))&&s.content)a=Vp.to_workbook(s.content,(e.type=o,e));else if((s=En.find(t,"NativeContent_MAIN"))&&s.content)a=Vp.to_workbook(s.content,(e.type=o,e));else throw(s=En.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&En.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=kFe(t))}var l={};return t.FullPaths&&vMe(t,l,e),a.Props=a.Custprops=l,e.bookFiles&&(a.cfb=t),a}function bMe(t,e){var r=e||{},n=En.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return En.utils.cfb_add(n,a,ase(t,r)),r.biff==8&&(t.Props||t.Custprops)&&yMe(t,n),r.biff==8&&t.vbaraw&&FFe(n,En.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var U2={0:{f:KDe},1:{f:ZDe},2:{f:x6e},3:{f:o6e},4:{f:n6e},5:{f:m6e},6:{f:N6e},7:{f:d6e},8:{f:P6e},9:{f:j6e},10:{f:S6e},11:{f:I6e},12:{f:t6e},13:{f:y6e},14:{f:c6e},15:{f:s6e},16:{f:Wae},17:{f:_6e},18:{f:h6e},19:{f:uR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_Re},40:{},42:{},43:{f:Nke},44:{f:bke},45:{f:Eke},46:{f:Ike},47:{f:Ske},48:{},49:{f:z4e},50:{},51:{f:lFe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vae},62:{f:w6e},63:{f:gFe},64:{f:G6e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:lc,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:V6e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:YDe},148:{f:zDe,p:16},151:{f:D6e},152:{},153:{f:wRe},154:{},155:{},156:{f:yRe},157:{},158:{},159:{T:1,f:MTe},160:{T:-1},161:{T:1,f:Qg},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:B6e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:iFe},336:{T:-1},337:{f:dFe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Xk},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xae},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:R6e},427:{f:M6e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:U6e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:XDe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:F6e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Xk},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:IFe},633:{T:1},634:{T:-1},635:{T:1,f:EFe},636:{T:-1},637:{f:J4e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cRe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:q6e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},aF={6:{f:F5},10:{f:A0},12:{f:no},13:{f:no},14:{f:Mi},15:{f:Mi},16:{f:nc},17:{f:Mi},18:{f:Mi},19:{f:no},20:{f:qH},21:{f:qH},23:{f:xae},24:{f:WH},25:{f:Mi},26:{},27:{},28:{f:qBe},29:{},34:{f:Mi},35:{f:zH},38:{f:nc},39:{f:nc},40:{f:nc},41:{f:nc},42:{f:Mi},43:{f:Mi},47:{f:ske},49:{f:yBe},51:{f:no},60:{},61:{f:mBe},64:{f:Mi},65:{f:vBe},66:{f:no},77:{},80:{},81:{},82:{},85:{f:no},89:{},90:{},91:{},92:{f:aBe},93:{f:XBe},94:{},95:{f:Mi},96:{},97:{},99:{f:Mi},125:{f:vae},128:{f:OBe},129:{f:iBe},130:{f:no},131:{f:Mi},132:{f:Mi},133:{f:oBe},134:{},140:{f:aTe},141:{f:no},144:{},146:{f:oTe},151:{},152:{},153:{},154:{},155:{},156:{f:no},157:{},158:{},160:{f:ATe},161:{f:uTe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:BBe},190:{f:TBe},193:{f:A0},197:{},198:{},199:{},200:{},201:{},202:{f:Mi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:no},220:{},221:{f:Mi},222:{},224:{f:FBe},225:{f:nBe},226:{f:A0},227:{},229:{f:zBe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:cBe},253:{f:wBe},255:{f:dBe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cae},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mi},353:{f:A0},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:UBe},431:{f:Mi},432:{},433:{},434:{},437:{},438:{f:ZBe},439:{f:Mi},440:{f:eTe},441:{},442:{f:Uw},443:{},444:{f:no},445:{},446:{},448:{f:A0},449:{f:ABe,r:2},450:{f:A0},512:{f:$H},513:{f:hTe},515:{f:MBe},516:{f:CBe},517:{f:GH},519:{f:mTe},520:{f:fBe},523:{},545:{f:XH},549:{f:HH},566:{},574:{f:gBe},638:{f:PBe},659:{},1048:{},1054:{f:EBe},1084:{},1212:{f:$Be},2048:{f:rTe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:A0},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:lTe,r:12},2173:{f:aFe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HBe,r:12},2197:{},2198:{f:Jke,r:12},2199:{},2200:{},2201:{},2202:{f:KBe,r:12},2203:{f:A0},2204:{},2205:{},2206:{},2207:{},2211:{f:hBe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:no},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:dTe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:iTe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$H},1:{},2:{f:yTe},3:{f:xTe},4:{f:gTe},5:{f:GH},7:{f:wTe},8:{},9:{f:qC},11:{},22:{f:no},30:{f:IBe},31:{},32:{},33:{f:XH},36:{},37:{f:HH},50:{f:NTe},62:{},52:{},67:{},68:{f:no},69:{},86:{},126:{},127:{f:pTe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:CTe},223:{},234:{},354:{},421:{},518:{f:F5},521:{f:qC},536:{f:WH},547:{f:zH},561:{},579:{},1030:{f:F5},1033:{f:qC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Gr(t,e,r,n){var a=e;if(!isNaN(a)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&oR(r)&&t.push(r)}}function wMe(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Gr(t,e,r,a);var s=e;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<a;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function $w(t,e,r){return t||(t=cr(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function NMe(t,e,r,n){var a=cr(9);return $w(a,t,e),uae(r,n||"b",a),a}function CMe(t,e,r){var n=cr(8+2*r.length);return $w(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _Me(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Oo(Fs(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Gr(t,2,bTe(r,n,a)):Gr(t,3,vTe(r,n,a));return;case"b":case"e":Gr(t,5,NMe(r,n,e.v,e.t));return;case"s":case"str":Gr(t,4,CMe(r,n,(e.v||"").slice(0,255)));return}Gr(t,1,$w(null,r,n))}function EMe(t,e,r,n){var a=Array.isArray(e),s=Ea(e["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Wn(s)}for(var u=s.s.r;u<=s.e.r;++u){l=zi(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=li(d)),o=c[d]+l;var f=a?(e[u]||[])[d]:e[o];f&&_Me(t,f,u,d)}}}function SMe(t,e){for(var r=e||{},n=iu(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Gr(n,r.biff==4?1033:r.biff==3?521:9,gR(t,16,r)),EMe(n,t.Sheets[t.SheetNames[a]],a,r),Gr(n,10),n.end()}function IMe(t,e,r){Gr(t,49,bBe({sz:12,name:"Arial"},r))}function jMe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Gr(t,1054,SBe(a,e[a],r))})}function PMe(t,e){var r=cr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Gr(t,2151,r),r=cr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),mae(Ea(e["!ref"]||"A1"),r),r.write_shift(4,4),Gr(t,2152,r)}function BMe(t,e){for(var r=0;r<16;++r)Gr(t,224,KH({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Gr(t,224,KH(n,0,e))})}function TMe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Gr(t,440,tTe(n)),n[1].Tooltip&&Gr(t,2048,nTe(n))}delete e["!links"]}function kMe(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Gr(t,125,cTe(mP(a,n),a))})}}function FMe(t,e,r,n,a){var s=16+Vm(a.cellXfs,e,a);if(e.v==null&&!e.bf){Gr(t,513,pg(r,n,s));return}if(e.bf)Gr(t,6,iDe(e,r,n,a,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Oo(Fs(e.v)):e.v;Gr(t,515,LBe(r,n,o,s));break;case"b":case"e":Gr(t,517,RBe(r,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var l=_R(a.Strings,e.v,a.revStrings);Gr(t,253,NBe(r,n,l,s))}else Gr(t,516,_Be(r,n,(e.v||"").slice(0,255),s,a));break;default:Gr(t,513,pg(r,n,s))}}function OMe(t,e,r){var n=iu(),a=r.SheetNames[t],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,d,f="",A=[],h=Ea(s["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Gr(n,2057,gR(r,16,e)),Gr(n,13,gd(1)),Gr(n,12,gd(100)),Gr(n,15,Nc(!0)),Gr(n,17,Nc(!1)),Gr(n,16,Ag(.001)),Gr(n,95,Nc(!0)),Gr(n,42,Nc(!1)),Gr(n,43,Nc(!1)),Gr(n,130,gd(1)),Gr(n,128,DBe()),Gr(n,131,Nc(!1)),Gr(n,132,Nc(!1)),u&&kMe(n,s["!cols"]),Gr(n,512,jBe(h,e)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=zi(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(A[x]=li(x)),d=A[x]+f;var v=c?(s[p]||[])[x]:s[d];v&&(FMe(n,v,p,x,e),u&&v.l&&s["!links"].push([d,v.l]))}}var y=l.CodeName||l.name||a;return u&&Gr(n,574,xBe((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Gr(n,229,WBe(s["!merges"])),u&&TMe(n,s),Gr(n,442,dae(y)),u&&PMe(n,s),Gr(n,10),n.end()}function DMe(t,e,r){var n=iu(),a=(t||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Gr(n,2057,gR(t,5,r)),r.bookType=="xla"&&Gr(n,135),Gr(n,225,l?gd(1200):null),Gr(n,193,R5e(2)),c&&Gr(n,191),c&&Gr(n,192),Gr(n,226),Gr(n,92,sBe("SheetJS",r)),Gr(n,66,gd(l?1200:1252)),l&&Gr(n,353,gd(0)),l&&Gr(n,448),Gr(n,317,fTe(t.SheetNames.length)),l&&t.vbaraw&&Gr(n,211),l&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";Gr(n,442,dae(u))}Gr(n,156,gd(17)),Gr(n,25,Nc(!1)),Gr(n,18,Nc(!1)),Gr(n,19,gd(0)),l&&Gr(n,431,Nc(!1)),l&&Gr(n,444,gd(0)),Gr(n,61,pBe()),Gr(n,64,Nc(!1)),Gr(n,141,gd(0)),Gr(n,34,Nc(ARe(t)=="true")),Gr(n,14,Nc(!0)),l&&Gr(n,439,Nc(!1)),Gr(n,218,gd(0)),IMe(n,t,r),jMe(n,t.SSF,r),BMe(n,r),l&&Gr(n,352,Nc(!1));var d=n.end(),f=iu();l&&Gr(f,140,sTe()),l&&r.Strings&&wMe(f,252,uBe(r.Strings)),Gr(f,10);var A=f.end(),h=iu(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=d.length+m+A.length;for(p=0;p<t.SheetNames.length;++p){var v=s[p]||{};Gr(h,133,lBe({pos:x,hs:v.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return d.length&&b.push(d),y.length&&b.push(y),A.length&&b.push(A),Jo(b)}function RMe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Os(kn)),t&&t.SSF&&(v1(),lP(t.SSF),r.revssf=uP(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,PR(r),r.cellXfs=[],Vm(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=OMe(a,r,t);return n.unshift(DMe(t,n,r)),Jo(n)}function ase(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ou(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return RMe(t,e);case 4:case 3:case 2:return SMe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function i$(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=a.index,l=s&&s.index||t.length,c=b4e(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,A=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(x!="<td"&&x!="<th")){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var j=0;j<m.length;++j){var I=m[j];I.s.c==d&&I.s.r<u&&u<=I.e.r&&(d=I.e.c+1,j=-1)}var _=Dn(y.slice(0,y.indexOf(">")));A=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||A>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+A-1}});var S=_.t||_["data-t"]||"";if(!b.length){d+=A;continue}if(b=Ine(b),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!b.length){d+=A;continue}var E={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(gf(b))?isNaN(Lv(b).getDate())||(E={t:"d",v:Fs(b)},r.cellDates||(E={t:"n",v:Oo(E.v)}),E.z=r.dateNF||kn[14]):E={t:"n",v:gf(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=E):n[On({r:u,c:d})]=E,d+=A}}}}return n["!ref"]=Wn(h),m.length&&(n["!merges"]=m),n}function MMe(t,e,r,n){for(var a=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=On({r,c:o}),f=n.dense?(t[r]||[])[o]:t[d],A=f&&f.v!=null&&(f.h||aR(f.w||(bA(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?A='<span contenteditable="true">'+A+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(A='<a href="'+f.l.Target+'">'+A+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(Kr("td",A,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var LMe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',UMe="</body></html>";function QMe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Qm(i$(r[0],e),e);var n=kR();return r.forEach(function(a,s){FR(n,i$(a,e),"Sheet"+(s+1))}),n}function VMe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sse(t,e){var r=e||{},n=r.header!=null?r.header:LMe,a=r.footer!=null?r.footer:UMe,s=[n],o=ou(t["!ref"]);r.dense=Array.isArray(t),s.push(VMe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(MMe(t,o,l,r));return s.push("</table>"+a),s.join("")}function ise(t,e,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?ci(n.origin):n.origin;a=o.r,s=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var d=ou(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],A=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,v=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var w=l[m];if(o$(w)){if(n.display)continue;h[p]={hidden:!0}}var j=w.children;for(x=v=0;x<j.length;++x){var I=j[x];if(!(n.display&&o$(I))){var _=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):Ine(I.innerHTML),S=I.getAttribute("data-z")||I.getAttribute("z");for(A=0;A<f.length;++A){var E=f[A];E.s.c==v+s&&E.s.r<p+a&&p+a<=E.e.r&&(v=E.e.c+1-s,A=-1)}b=+I.getAttribute("colspan")||1,((y=+I.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+s},e:{r:p+a+(y||1)-1,c:v+s+(b||1)-1}});var B={t:"s",v:_},k=I.getAttribute("data-t")||I.getAttribute("t")||"";_!=null&&(_.length==0?B.t=k||"z":n.raw||_.trim().length==0||k=="s"||(_==="TRUE"?B={t:"b",v:!0}:_==="FALSE"?B={t:"b",v:!1}:isNaN(gf(_))?isNaN(Lv(_).getDate())||(B={t:"d",v:Fs(_)},n.cellDates||(B={t:"n",v:Oo(B.v)}),B.z=n.dateNF||kn[14]):B={t:"n",v:gf(_)})),B.z===void 0&&S!=null&&(B.z=S);var P="",O=I.getElementsByTagName("A");if(O&&O.length)for(var z=0;z<O.length&&!(O[z].hasAttribute("href")&&(P=O[z].getAttribute("href"),P.charAt(0)!="#"));++z);P&&P.charAt(0)!="#"&&(B.l={Target:P}),n.dense?(t[p+a]||(t[p+a]=[]),t[p+a][v+s]=B):t[On({c:v+s,r:p+a})]=B,u.e.c<v+s&&(u.e.c=v+s),v+=b}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),t["!ref"]=Wn(u),p>=c&&(t["!fullref"]=Wn((u.e.r=l.length-m+p-1+a,u))),t}function ose(t,e){var r=e||{},n=r.dense?[]:{};return ise(n,t,e)}function HMe(t,e){return Qm(ose(t,e),e)}function o$(t){var e="",r=$Me(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function $Me(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function KMe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=_a(e.replace(/<[^>]*>/g,""));return[r]}var l$={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function lse(t,e){var r=e||{},n=sR(t),a=[],s,o,l={name:""},c="",u=0,d,f,A={},h=[],m=r.dense?[]:{},p,x,v={value:""},y="",b=0,w=[],j=-1,I=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,E={},B=[],k={},P=0,O=0,z=[],oe=1,ce=1,ue=[],ge={Names:[]},ne={},Oe=["",""],Ue=[],F={},H="",K=0,U=!1,W=!1,X=0;for(F2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=F2.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?m["!ref"]=Wn(_):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(m["!fullref"]=m["!ref"],_.e.r=r.sheetRows-1,m["!ref"]=Wn(_)),B.length&&(m["!merges"]=B),z.length&&(m["!rows"]=z),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),A[d.name]=m,W=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Dn(p[0],!1),j=I=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,m=r.dense?[]:{},B=[],z=[],W=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){j+=oe,oe=1;break}if(f=Dn(p[0],!1),f.?j=f.-1:j==-1&&(j=0),oe=+f["number-rows-repeated"]||1,oe<10)for(X=0;X<oe;++X)S>0&&(z[j+X]={level:S});I=-1;break;case"covered-table-cell":p[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(m[j]||(m[j]=[]),m[j][I]={t:"z"}):m[On({r:j,c:I})]={t:"z"}),y="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++I,v=Dn(p[0],!1),ce=parseInt(v["number-columns-repeated"]||"1",10),x={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(x.f=n$(_a(v.formula))),(v.||v["value-type"])=="string"&&(x.t="s",x.v=_a(v["string-value"]||""),r.dense?(m[j]||(m[j]=[]),m[j][I]=x):m[On({r:j,c:I})]=x),I+=ce-1;else if(p[1]!=="/"){++I,y="",b=0,w=[],ce=1;var D=oe?j+oe-1:j;if(I>_.e.c&&(_.e.c=I),I<_.s.c&&(_.s.c=I),j<_.s.r&&(_.s.r=j),D>_.e.r&&(_.e.r=D),v=Dn(p[0],!1),Ue=[],F={},x={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=_a(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(P=parseInt(v["number-matrix-rows-spanned"],10)||0,O=parseInt(v["number-matrix-columns-spanned"],10)||0,k={s:{r:j,c:I},e:{r:j+P-1,c:I+O-1}},x.F=Wn(k),ue.push([k,x.F])),v.formula)x.f=n$(v.formula);else for(X=0;X<ue.length;++X)j>=ue[X][0].s.r&&j<=ue[X][0].e.r&&I>=ue[X][0].s.c&&I<=ue[X][0].e.c&&(x.F=ue[X][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(P=parseInt(v["number-rows-spanned"],10)||0,O=parseInt(v["number-columns-spanned"],10)||0,k={s:{r:j,c:I},e:{r:j+P-1,c:I+O-1}},B.push(k)),v["number-columns-repeated"]&&(ce=parseInt(v["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Ps(v["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(v.value);break;case"percentage":x.t="n",x.v=parseFloat(v.value);break;case"currency":x.t="n",x.v=parseFloat(v.value);break;case"date":x.t="d",x.v=Fs(v["date-value"]),r.cellDates||(x.t="n",x.v=Oo(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=x4e(v["time-value"])/86400,r.cellDates&&(x.t="d",x.v=dP(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(v.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",v["string-value"]!=null&&(y=_a(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(U=!1,x.t==="s"&&(x.v=y||"",w.length&&(x.R=w),U=b==0),ne.Target&&(x.l=ne),Ue.length>0&&(x.c=Ue,Ue=[]),y&&r.cellText!==!1&&(x.w=y),U&&(x.t="z",delete x.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var V=0;V<oe;++V){if(ce=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[j+V]||(m[j+V]=[]),m[j+V][I]=V==0?x:Os(x);--ce>0;)m[j+V][I+ce]=Os(x);else for(m[On({r:j+V,c:I})]=x;--ce>0;)m[On({r:j+V,c:I+ce})]=Os(x);_.e.c<=I&&(_.e.c=I)}ce=parseInt(v["number-columns-repeated"]||"1",10),I+=ce-1,ce=0,x={},y="",w=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;F.t=y,w.length&&(F.R=w),F.a=H,Ue.push(F)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);H="",K=0,y="",b=0,w=[];break;case"creator":p[1]==="/"?H=n.slice(K,p.index):K=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Dn(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=l$[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=l$[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=Dn(p[0],!1),Oe=O5(o["cell-range-address"]);var Z={Name:o.name,Ref:Oe[0]+"!"+Oe[1]};W&&(Z.Sheet=h.length),ge.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var be=KMe(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+be[0]}else Dn(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Oe=O5(Dn(p[0])["target-range-address"]),A[Oe[0]]["!autofilter"]={ref:Oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(ne=Dn(p[0],!1),!ne.href)break;ne.Target=_a(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(Oe=O5(ne.Target.slice(1)),ne.Target="#"+Oe[0]+"!"+Oe[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var L={Sheets:A,SheetNames:h,Workbook:ge};return r.bookSheets&&delete L.Sheets,L}function c$(t,e){e=e||{},pd(t,"META-INF/manifest.xml")&&x5e(ro(t,"META-INF/manifest.xml"),e);var r=Bu(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=lse(cs(r),e);return pd(t,"meta.xml")&&(n.Props=Jne(ro(t,"meta.xml"))),n}function u$(t,e){return lse(t,e)}var GMe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+k2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xi+e}}(),d$=function(){var t=function(s){return rs(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+rs(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=ou(s["!ref"]||"A1"),A=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(u=0;u<f.s.r;++u)p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(e);for(;d<=f.e.c;++d){var v=!1,y={},b="";for(h=0;h!=A.length;++h)if(!(A[h].s.c>d)&&!(A[h].s.r>u)&&!(A[h].e.c<d)&&!(A[h].e.r<u)){(A[h].s.c!=d||A[h].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=A[h].e.c-A[h].s.c+1,y["table:number-rows-spanned"]=A[h].e.r-A[h].s.r+1;break}if(v){c.push(r);continue}var w=On({r:u,c:d}),j=m?(s[u]||[])[d]:s[w];if(j&&j.f&&(y["table:formula"]=rs(fDe(j.f)),j.F&&j.F.slice(0,w.length)==w)){var I=ou(j.F);y["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,y["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!j){c.push(e);continue}switch(j.t){case"b":b=j.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=j.v?"true":"false";break;case"n":b=j.w||String(j.v||0),y["office:value-type"]="float",y["office:value"]=j.v||0;break;case"s":case"str":b=j.v==null?"":j.v,y["office:value-type"]="string";break;case"d":b=j.w||Fs(j.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Fs(j.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var _=t(b);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+hDe(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),_=Kr("text:a",_,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+Kr("table:table-cell",Kr("text:p",_,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Im(f),f.ods=l;var A=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+A+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Xi],u=k2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=k2({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Yne().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function cse(t,e){if(e.bookType=="fods")return d$(t,e);var r=tR(),n="",a=[],s=[];return n="mimetype",Jn(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Jn(r,n,d$(t,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Jn(r,n,GMe(t,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Jn(r,n,Xi+Yne()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Jn(r,n,b5e(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Jn(r,n,v5e(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function gg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function sF(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):cs(Um(t))}function qMe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Pu(Zf(t))}function zMe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Pm(t){var e=t.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function f$(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function WMe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function XMe(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=r>=0?0:128}function Q2(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Wa(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ii(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ia(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=Q2(t,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Q2(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};e[a]==null?e[a]=[u]:e[a].push(u)}return e}function pl(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Wa(n*8+a.type)),a.type==2&&e.push(Wa(a.data.length)),e.push(a.data))})}),Pm(e)}function IR(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ud(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=Q2(t,n),s=Ia(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:Ii(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Ia(l.data),u=Ii(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=Ii(s[3][0].data)>>>0>0),r.push(o)}return r}function px(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Wa(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Wa(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Wa(o.data.length)}],n[2].push({data:pl(o.meta),type:2})});var s=pl(n);e.push(Wa(s.length)),e.push(s),a.forEach(function(o){return e.push(o)})}),Pm(e)}function YMe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Q2(e,r),a=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Pm(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=Pm(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function dd(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(YMe(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Pm(e)}function gx(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var s=Wa(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Pm(e)}function JMe(t,e,r,n){var a=gg(t),s=a.getUint32(4,!0),o=(n>1?12:8)+f$(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=f$(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function ZMe(t,e,r){var n=gg(t),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=WMe(t,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return f}function R5(t,e){var r=new Uint8Array(32),n=gg(r),a=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,XMe(r,a,t.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,a)}function M5(t,e){var r=new Uint8Array(32),n=gg(r),a=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,a)}function e8e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return JMe(t,e,r,t[0]);case 5:return ZMe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Jl(t){var e=Ia(t);return Q2(e[1][0].data)}function h$(t,e){var r=Ia(e.data),n=Ii(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=Ia(o.data),c=Ii(l[1][0].data)>>>0;switch(n){case 1:s[c]=sF(l[3][0].data);break;case 8:{var u=t[Jl(l[9][0].data)][0],d=Ia(u.data),f=t[Jl(d[1][0].data)][0],A=Ii(f.meta[1][0].data);if(A!=2001)throw new Error("2000 unexpected reference to ".concat(A));var h=Ia(f.data);s[c]=h[3].map(function(m){return sF(m.data)}).join("")}break}}),s}function t8e(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=Ia(t),v=Ii(x[1][0].data)>>>0,y=Ii(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Ii(x[8][0].data)>0||!1,w,j;if((s=(a=x[7])==null?void 0:a[0])!=null&&s.data&&e!=0)w=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=x[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=x[4])==null?void 0:d[0])!=null&&f.data&&e!=1)w=(h=(A=x[4])==null?void 0:A[0])==null?void 0:h.data,j=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var I=b?4:1,_=gg(w),S=[],E=0;E<w.length/2;++E){var B=_.getUint16(E*2,!0);B<65535&&S.push([E,B])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var k=[];for(E=0;E<S.length-1;++E)k[S[E][0]]=j.subarray(S[E][1]*I,S[E+1][1]*I);return S.length>=1&&(k[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*I)),{R:v,cells:k}}function r8e(t,e){var r,n=Ia(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ii(n[7][0].data)>>>0>0?1:0:-1,s=IR(n[5],function(o){return t8e(o,a)});return{nrows:Ii(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function n8e(t,e,r){var n,a=Ia(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ii(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ii(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Wn(s);var o=Ia(a[4][0].data),l=h$(t,t[Jl(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?h$(t,t[Jl(o[17][0].data)][0]):[],u=Ia(o[3][0].data),d=0;u[1].forEach(function(f){var A=Ia(f.data),h=t[Jl(A[2][0].data)][0],m=Ii(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=r8e(t,h);p.data.forEach(function(x,v){x.forEach(function(y,b){var w=On({r:d+v,c:b}),j=e8e(y,l,c);j&&(r[w]=j)})}),d+=p.nrows})}function a8e(t,e){var r=Ia(e.data),n={"!ref":"A1"},a=t[Jl(r[2][0].data)],s=Ii(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return n8e(t,a[0],n),n}function s8e(t,e){var r,n=Ia(e.data),a={name:(r=n[1])!=null&&r[0]?sF(n[1][0].data):"",sheets:[]},s=IR(n[2],Jl);return s.forEach(function(o){t[o].forEach(function(l){var c=Ii(l.meta[1][0].data);c==6e3&&a.sheets.push(a8e(t,l))})}),a}function i8e(t,e){var r=kR(),n=Ia(e.data),a=IR(n[1],Jl);if(a.forEach(function(s){t[s].forEach(function(o){var l=Ii(o.meta[1][0].data);if(l==2){var c=s8e(t,o);c.sheets.forEach(function(u,d){FR(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function L5(t){var e,r,n,a,s={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=dd(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=ud(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ii(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Ii(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return i8e(s,l)}function o8e(t,e,r){var n,a,s,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&Ii(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=gg(t[7][0].data),d=0,f=[],A=gg(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),A.setUint16(p*2,h,!0);var x,v;switch(typeof e[p]){case"string":x=R5({t:"s",v:e[p]},r),v=M5({t:"s",v:e[p]},r);break;case"number":x=R5({t:"n",v:e[p]},r),v=M5({t:"n",v:e[p]},r);break;case"boolean":x=R5({t:"b",v:e[p]},r),v=M5({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(x),d+=x.length,m.push(v),h+=v.length,++c}for(t[2][0].data=Wa(c);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535,!0);return t[6][0].data=Pm(f),t[3][0].data=Pm(m),c}function l8e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ou(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Wn(n)));var s=JS(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(K){typeof K=="string"&&o.push(K)})});var l={},c=[],u=En.read(e.numbers,{type:"base64"});u.FileIndex.map(function(H,K){return[H,u.FullPaths[K]]}).forEach(function(H){var K=H[0],U=H[1];if(K.type==2&&K.name.match(/\.iwa/)){var W=K.content,X=dd(W),D=ud(X);D.forEach(function(V){c.push(V.id),l[V.id]={deps:[],location:U,type:Ii(V.messages[0].meta[1][0].data)}})}}),c.sort(function(H,K){return H-K});var d=c.filter(function(H){return H>1}).map(function(H){return[H,Wa(H)]});u.FileIndex.map(function(H,K){return[H,u.FullPaths[K]]}).forEach(function(H){var K=H[0];if(H[1],!!K.name.match(/\.iwa/)){var U=ud(dd(K.content));U.forEach(function(W){W.messages.forEach(function(X){d.forEach(function(D){W.messages.some(function(V){return Ii(V.meta[1][0].data)!=11006&&zMe(V.data,D[1])})&&l[D[0]].deps.push(W.id)})})})}});for(var f=En.find(u,l[1].location),A=ud(dd(f.content)),h,m=0;m<A.length;++m){var p=A[m];p.id==1&&(h=p)}var x=Jl(Ia(h.messages[0].data)[1][0].data);for(f=En.find(u,l[x].location),A=ud(dd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=Jl(Ia(h.messages[0].data)[2][0].data),f=En.find(u,l[x].location),A=ud(dd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=Jl(Ia(h.messages[0].data)[2][0].data),f=En.find(u,l[x].location),A=ud(dd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);var v=Ia(h.messages[0].data);{v[6][0].data=Wa(n.e.r+1),v[7][0].data=Wa(n.e.c+1);var y=Jl(v[46][0].data),b=En.find(u,l[y].location),w=ud(dd(b.content));{for(var j=0;j<w.length&&w[j].id!=y;++j);if(w[j].id!=y)throw"Bad ColumnRowUIDMapArchive";var I=Ia(w[j].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var _=0;_<=n.e.c;++_){var S=[];S[1]=S[2]=[{type:0,data:Wa(_+420690)}],I[1].push({type:2,data:pl(S)}),I[2].push({type:0,data:Wa(_)}),I[3].push({type:0,data:Wa(_)})}I[4]=[],I[5]=[],I[6]=[];for(var E=0;E<=n.e.r;++E)S=[],S[1]=S[2]=[{type:0,data:Wa(E+726270)}],I[4].push({type:2,data:pl(S)}),I[5].push({type:0,data:Wa(E)}),I[6].push({type:0,data:Wa(E)});w[j].messages[0].data=pl(I)}b.content=gx(px(w)),b.size=b.content.length,delete v[46];var B=Ia(v[4][0].data);{B[7][0].data=Wa(n.e.r+1);var k=Ia(B[1][0].data),P=Jl(k[2][0].data);b=En.find(u,l[P].location),w=ud(dd(b.content));{if(w[0].id!=P)throw"Bad HeaderStorageBucket";var O=Ia(w[0].messages[0].data);for(E=0;E<s.length;++E){var z=Ia(O[2][0].data);z[1][0].data=Wa(E),z[4][0].data=Wa(s[E].length),O[2][E]={type:O[2][0].type,data:pl(z)}}w[0].messages[0].data=pl(O)}b.content=gx(px(w)),b.size=b.content.length;var oe=Jl(B[2][0].data);b=En.find(u,l[oe].location),w=ud(dd(b.content));{if(w[0].id!=oe)throw"Bad HeaderStorageBucket";for(O=Ia(w[0].messages[0].data),_=0;_<=n.e.c;++_)z=Ia(O[2][0].data),z[1][0].data=Wa(_),z[4][0].data=Wa(n.e.r+1),O[2][_]={type:O[2][0].type,data:pl(z)};w[0].messages[0].data=pl(O)}b.content=gx(px(w)),b.size=b.content.length;var ce=Jl(B[4][0].data);(function(){for(var H=En.find(u,l[ce].location),K=ud(dd(H.content)),U,W=0;W<K.length;++W){var X=K[W];X.id==ce&&(U=X)}var D=Ia(U.messages[0].data);{D[3]=[];var V=[];o.forEach(function(L,Xe){V[1]=[{type:0,data:Wa(Xe)}],V[2]=[{type:0,data:Wa(1)}],V[3]=[{type:2,data:qMe(L)}],D[3].push({type:2,data:pl(V)})})}U.messages[0].data=pl(D);var Z=px(K),be=gx(Z);H.content=be,H.size=H.content.length})();var ue=Ia(B[3][0].data);{var ge=ue[1][0];delete ue[2];var ne=Ia(ge.data);{var Oe=Jl(ne[2][0].data);(function(){for(var H=En.find(u,l[Oe].location),K=ud(dd(H.content)),U,W=0;W<K.length;++W){var X=K[W];X.id==Oe&&(U=X)}var D=Ia(U.messages[0].data);{delete D[6],delete ue[7];var V=new Uint8Array(D[5][0].data);D[5]=[];for(var Z=0,be=0;be<=n.e.r;++be){var L=Ia(V);Z+=o8e(L,s[be],o),L[1][0].data=Wa(be),D[5].push({data:pl(L),type:2})}D[1]=[{type:0,data:Wa(n.e.c+1)}],D[2]=[{type:0,data:Wa(n.e.r+1)}],D[3]=[{type:0,data:Wa(Z)}],D[4]=[{type:0,data:Wa(n.e.r+1)}]}U.messages[0].data=pl(D);var Xe=px(K),re=gx(Xe);H.content=re,H.size=H.content.length})()}ge.data=pl(ne)}B[3][0].data=pl(ue)}v[4][0].data=pl(B)}h.messages[0].data=pl(v);var Ue=px(A),F=gx(Ue);return f.content=F,f.size=f.content.length,u}function use(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function jR(t){use([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function PR(t){use([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function c8e(t){return ia.WS.indexOf(t)>-1?"sheet":t==ia.CS?"chart":t==ia.DS?"dialog":t==ia.MS?"macro":t&&t.length?t:"sheet"}function u8e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,c8e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function d8e(t,e,r,n,a,s,o,l,c,u,d,f){try{s[n]=Fb(Bu(t,r,!0),e);var A=ro(t,e),h;switch(l){case"sheet":h=kRe(A,e,a,c,s[n],u,d,f);break;case"chart":if(h=FRe(A,e,a,c,s[n],u,d,f),!h||!h["!drawel"])break;var m=Xy(h["!drawel"].Target,e),p=O2(m),x=yFe(Bu(t,m,!0),Fb(Bu(t,p,!0),m)),v=Xy(x,m),y=O2(v);h=oRe(Bu(t,v,!0),v,c,Fb(Bu(t,y,!0),v),u,h);break;case"macro":h=ORe(A,e,a,c,s[n],u,d,f);break;case"dialog":h=DRe(A,e,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];s&&s[n]&&Pi(s[n]).forEach(function(w){var j="";if(s[n][w].Type==ia.CMNT){j=Xy(s[n][w].Target,e);var I=URe(ro(t,j,!0),j,c);if(!I||!I.length)return;JH(h,I,!1)}s[n][w].Type==ia.TCMNT&&(j=Xy(s[n][w].Target,e),b=b.concat(wFe(ro(t,j,!0),c)))}),b&&b.length&&JH(h,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function ad(t){return t.charAt(0)=="/"?t.slice(1):t}function f8e(t,e){if(v1(),e=e||{},jR(e),pd(t,"META-INF/manifest.xml")||pd(t,"objectdata.xml"))return c$(t,e);if(pd(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof L5<"u"){if(t.FileIndex)return L5(t);var r=En.utils.cfb_new();return vH(t).forEach(function(z){Jn(r,z,N4e(t,z))}),L5(r)}throw new Error("Unsupported NUMBERS file")}if(!pd(t,"[Content_Types].xml"))throw pd(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):pd(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=vH(t),a=p5e(Bu(t,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",ro(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!ro(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(Ob=[],a.sst)try{Ob=LRe(ro(t,ad(a.sst)),a.sst,e)}catch(z){if(e.WTF)throw z}e.cellStyles&&a.themes.length&&(c=MRe(Bu(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(u=RRe(ro(t,ad(a.style)),a.style,c,e))}a.links.map(function(z){try{var oe=Fb(Bu(t,O2(ad(z))),z);return VRe(ro(t,ad(z)),oe,z,e)}catch{}});var d=TRe(ro(t,ad(a.workbooks[0])),a.workbooks[0],e),f={},A="";a.coreprops.length&&(A=ro(t,ad(a.coreprops[0]),!0),A&&(f=Jne(A)),a.extprops.length!==0&&(A=ro(t,ad(a.extprops[0]),!0),A&&N5e(A,f,e)));var h={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(A=Bu(t,ad(a.custprops[0]),!0),A&&(h=_5e(A,e)));var m={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(oe){return oe.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),e.bookProps&&(m.Props=f,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&a.calcchain&&(p=QRe(ro(t,ad(a.calcchain)),a.calcchain));var x=0,v={},y,b;{var w=d.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var j=0;j!=w.length;++j)f.SheetNames[j]=w[j].name}var I=s?"bin":"xml",_=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,_+1)+"_rels/"+a.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");pd(t,S)||(S="xl/_rels/workbook."+I+".rels");var E=Fb(Bu(t,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=HRe(ro(t,ad(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=CFe(ro(t,ad(a.people[0])),e)),E&&(E=u8e(E,d.Sheets));var B=ro(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var k="sheet";if(E&&E[x]?(y="xl/"+E[x][1].replace(/[\/]?xl\//,""),pd(t,y)||(y=E[x][1]),pd(t,y)||(y=S.replace(/_rels\/.*$/,"")+E[x][1]),k=E[x][2]):(y="xl/worksheets/sheet"+(x+1-B)+"."+I,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,O=0;O!=e.sheets.length;++O)typeof e.sheets[O]=="number"&&e.sheets[O]==x&&(P=1),typeof e.sheets[O]=="string"&&e.sheets[O].toLowerCase()==f.SheetNames[x].toLowerCase()&&(P=1);if(!P)continue e}}d8e(t,y,b,f.SheetNames[x],x,v,o,k,e,d,c,u)}return m={Directory:a,Workbook:d,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Ob,Styles:u,Themes:c,SSF:Os(kn)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(z,oe){z=z.replace(/^Root Entry[\/]/,""),m.keys.push(z),m.files[z]=t.FileIndex[oe]}))),e&&e.bookVBA&&(a.vba.length>0?m.vbaraw=ro(t,ad(a.vba[0]),!0):a.defaults&&a.defaults.bin===TFe&&(m.vbaraw=ro(t,"xl/vbaProject.bin",!0))),m}function h8e(t,e){var r=e||{},n="Workbook",a=En.find(t,n);try{if(n="/!DataSpaces/Version",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(HTe(a.content),n="/!DataSpaces/DataSpaceMap",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=KTe(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=GTe(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);zTe(a.content)}catch{}if(n="/EncryptionInfo",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=WTe(a.content);if(n="/EncryptedPackage",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function A8e(t,e){return e.bookType=="ods"?cse(t,e):e.bookType=="numbers"?l8e(t,e):e.bookType=="xlsb"?m8e(t,e):p8e(t,e)}function m8e(t,e){Wx=1024,t&&!t.SSF&&(t.SSF=Os(kn)),t&&t.SSF&&(v1(),lP(t.SSF),e.revssf=uP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Db?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Rae.indexOf(e.bookType)>-1,a=mR();PR(e=e||{});var s=tR(),o="",l=0;if(e.cellXfs=[],Vm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Jn(s,o,Zne(t.Props,e)),a.coreprops.push(o),Ja(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Jn(s,o,rae(t.Props)),a.extprops.push(o),Ja(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&Pi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Jn(s,o,nae(t.Custprops)),a.custprops.push(o),Ja(e.rels,4,o,ia.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],A=(f||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jn(s,o,KRe(l-1,o,e,t,d)),a.sheets.push(o),Ja(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Jn(s,p,zRe(h,p)),a.comments.push(p),Ja(d,-1,"../comments"+l+"."+r,ia.CMNT),m=!0),f["!legacy"]&&m&&Jn(s,"xl/drawings/vmlDrawing"+l+".vml",Oae(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Jn(s,O2(o),pv(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Jn(s,o,qRe(e.Strings,o,e)),a.strs.push(o),Ja(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Jn(s,o,$Re(t,o)),a.workbooks.push(o),Ja(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Jn(s,o,bR(t.Themes,e)),a.themes.push(o),Ja(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Jn(s,o,GRe(t,o,e)),a.styles.push(o),Ja(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Jn(s,o,t.vbaraw),a.vba.push(o),Ja(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Jn(s,o,WRe(o)),a.metadata.push(o),Ja(e.wbrels,-1,"metadata."+r,ia.XLMETA),Jn(s,"[Content_Types].xml",Xne(a,e)),Jn(s,"_rels/.rels",pv(e.rels)),Jn(s,"xl/_rels/workbook."+r+".rels",pv(e.wbrels)),delete e.revssf,delete e.ssf,s}function p8e(t,e){Wx=1024,t&&!t.SSF&&(t.SSF=Os(kn)),t&&t.SSF&&(v1(),lP(t.SSF),e.revssf=uP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Db?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Rae.indexOf(e.bookType)>-1,a=mR();PR(e=e||{});var s=tR(),o="",l=0;if(e.cellXfs=[],Vm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Jn(s,o,Zne(t.Props,e)),a.coreprops.push(o),Ja(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Jn(s,o,rae(t.Props)),a.extprops.push(o),Ja(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&Pi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Jn(s,o,nae(t.Custprops)),a.custprops.push(o),Ja(e.rels,4,o,ia.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},A=t.Sheets[t.SheetNames[l-1]],h=(A||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jn(s,o,zae(l-1,e,t,f)),a.sheets.push(o),Ja(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(A){var m=A["!comments"],p=!1,x="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+l+"."+r,Jn(s,x,NFe(m,d,e)),a.threadedcomments.push(x),Ja(f,-1,"../threadedComments/threadedComment"+l+"."+r,ia.TCMNT)),x="xl/comments"+l+"."+r,Jn(s,x,Dae(m)),a.comments.push(x),Ja(f,-1,"../comments"+l+"."+r,ia.CMNT),p=!0}A["!legacy"]&&p&&Jn(s,"xl/drawings/vmlDrawing"+l+".vml",Oae(l,A["!comments"])),delete A["!comments"],delete A["!legacy"]}f["!id"].rId1&&Jn(s,O2(o),pv(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Jn(s,o,Nae(e.Strings,e)),a.strs.push(o),Ja(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Jn(s,o,Zae(t)),a.workbooks.push(o),Ja(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Jn(s,o,bR(t.Themes,e)),a.themes.push(o),Ja(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Jn(s,o,Bae(t,e)),a.styles.push(o),Ja(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Jn(s,o,t.vbaraw),a.vba.push(o),Ja(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Jn(s,o,Fae()),a.metadata.push(o),Ja(e.wbrels,-1,"metadata."+r,ia.XLMETA),d.length>1&&(o="xl/persons/person.xml",Jn(s,o,_Fe(d)),a.people.push(o),Ja(e.wbrels,-1,"persons/person.xml",ia.PEOPLE)),Jn(s,"[Content_Types].xml",Xne(a,e)),Jn(s,"_rels/.rels",pv(e.rels)),Jn(s,"xl/_rels/workbook."+r+".rels",pv(e.wbrels)),delete e.revssf,delete e.ssf,s}function BR(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Hu(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function g8e(t,e){return En.find(t,"EncryptedPackage")?h8e(t,e):nse(t,e)}function x8e(t,e){var r,n=t,a=e||{};return a.type||(a.type=ta&&Buffer.isBuffer(t)?"buffer":"base64"),r=_ne(n,a),f8e(r,a)}function dse(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return nF(t.slice(r),e);default:break e}return Uv.to_workbook(t,e)}function v8e(t,e){var r="",n=BR(t,e);switch(e.type){case"base64":r=Hu(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=hg(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=cs(r)),e.type="binary",dse(r,e)}function y8e(t,e){var r=t;return e.type=="base64"&&(r=Hu(r)),r=j2.utils.decode(1200,r.slice(2),"str"),e.type="binary",dse(r,e)}function b8e(t){return t.match(/[^\x00-\x7F]/)?Zf(t):t}function U5(t,e,r,n){return n?(r.type="string",Uv.to_workbook(t,r)):Uv.to_workbook(e,r)}function Vv(t,e){X6();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Vv(new Uint8Array(t),(r=Os(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xv={},r.dateNF&&(xv.dateNF=r.dateNF),r.type||(r.type=ta&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ta?"buffer":"binary",n=m4e(t),typeof Uint8Array<"u"&&!ta&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=b8e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Os(r),r.type="array",Vv(Y6(n),r)}switch((a=BR(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return g8e(En.read(n,r),r);break;case 9:if(a[1]<=8)return nse(n,r);break;case 60:return nF(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return ETe(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return bae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?x8e(n,r):U5(t,n,r,s);case 239:return a[3]===60?nF(n,r):U5(t,n,r,s);case 255:if(a[1]===254)return y8e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Vp.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Vp.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return rF.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Iae.to_workbook(n,r);break;case 10:case 13:case 32:return v8e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _Te.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?rF.to_workbook(n,r):U5(t,n,r,s)}function fse(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Rw(e.file,En.write(t,{type:ta?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return En.write(t,e)}function w8e(t,e){var r=Os(e||{}),n=A8e(t,r);return N8e(n,r)}function N8e(t,e){var r={},n=ta?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?En.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(oP(a))}return e.password&&typeof encrypt_agile<"u"?fse(encrypt_agile(a,e.password),e):e.type==="file"?Rw(e.file,a):e.type=="string"?cs(a):a}function C8e(t,e){var r=e||{},n=bMe(t,r);return fse(n,r)}function $f(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return P2(Zf(n));case"binary":return Zf(n);case"string":return t;case"file":return Rw(e.file,n,"utf8");case"buffer":return ta?DA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$f(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function _8e(t,e){switch(e.type){case"base64":return P2(t);case"binary":return t;case"string":return t;case"file":return Rw(e.file,t,"binary");case"buffer":return ta?DA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function YC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?P2(r):e.type=="string"?cs(r):r;case"file":return Rw(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function pP(t,e){X6(),gRe(t);var r=Os(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pP(t,r);return r.type="array",oP(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $f(AMe(t,r),r);case"slk":case"sylk":return $f(yae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return $f(sse(t.Sheets[t.SheetNames[a]],r),r);case"txt":return _8e(hse(t.Sheets[t.SheetNames[a]],r),r);case"csv":return $f(TR(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return $f(bae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return YC(rF.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return $f(Uv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return $f(Iae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return $f(wae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return $f(cse(t,r),r);case"wk1":return YC(Vp.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return YC(Vp.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),YC(ase(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),C8e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return w8e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function E8e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function V2(t,e,r){var n={};return n.type="file",n.file=e,E8e(n),pP(t,n)}function S8e(t,e,r,n,a,s,o,l){var c=zi(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,A=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(A,"__rowNum__",{value:r,enumerable:!1})}catch{A.__rowNum__=r}else A.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(A[s[h]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)A[s[h]]=null;else if(u!==void 0)A[s[h]]=u;else if(d&&p===null)A[s[h]]=null;else continue;else A[s[h]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:bA(m,p,l);p!=null&&(f=!1)}}return{row:A,isempty:f}}function JS(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ea(d);break;case"number":c=Ea(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=zi(c.s.r),A=[],h=[],m=0,p=0,x=Array.isArray(t),v=c.s.r,y=0,b={};x&&!t[v]&&(t[v]=[]);var w=u.skipHidden&&t["!cols"]||[],j=u.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(A[y]=li(y),r=x?t[v][y]:t[A[y]+f],n){case 1:s[y]=y-c.s.c;break;case 2:s[y]=A[y];break;case 3:s[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=bA(r,null,u),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}s[y]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(j[v]||{}).hidden){var I=S8e(t,c,v,A,n,s,x,u);(I.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=I.row)}return h.length=m,h}var A$=/"/g;function I8e(t,e,r,n,a,s,o,l){for(var c=!0,u=[],d="",f=zi(r),A=e.s.c;A<=e.e.c;++A)if(n[A]){var h=l.dense?(t[r]||[])[A]:t[n[A]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:bA(h,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||p===34||l.forceQuotes){d='"'+d.replace(A$,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(A$,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function TR(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Ea(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(t);for(var A=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(A[m]||{}).hidden||(f[m]=li(m));for(var p=0,x=a.s.r;x<=a.e.r;++x)(h[x]||{}).hidden||(d=I8e(t,a,x,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function hse(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=TR(t,e);return r}function j8e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Ea(t["!ref"]),s="",o=[],l,c=[],u=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=li(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=zi(d),l=a.s.c;l<=a.e.c;++l)if(e=o[l]+s,r=u?(t[d]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function Ase(t,e,r){var n=r||{},a=+!n.skipHeader,s=t||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ci(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+e.length-1+a}};if(s["!ref"]){var f=Ea(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+e.length-1+a)}else o==-1&&(o=0,d.e.r=e.length-1+a);var A=n.header||[],h=0;e.forEach(function(p,x){Pi(p).forEach(function(v){(h=A.indexOf(v))==-1&&(A[h=A.length]=v);var y=p[v],b="z",w="",j=On({c:l+h,r:o+x+a});u=H2(s,j),y&&typeof y=="object"&&!(y instanceof Date)?s[j]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=Oo(y)),w=n.dateNF||kn[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,w&&(u.z=w)):s[j]=u={t:b,v:y},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,l+A.length-1);var m=zi(o);if(a)for(h=0;h<A.length;++h)s[li(h+l)+m]={t:"s",v:A[h]};return s["!ref"]=Wn(d),s}function P8e(t,e){return Ase(null,t,e)}function H2(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ci(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?H2(t,On(e)):H2(t,On({r:e,c:r||0}))}function B8e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function kR(){return{SheetNames:[],Sheets:{}}}function FR(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(Jae(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function T8e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=B8e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function k8e(t,e){return t.z=e,t}function mse(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function F8e(t,e,r){return mse(t,"#"+e,r)}function O8e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function D8e(t,e,r,n){for(var a=typeof e!="string"?e:Ea(e),s=typeof e=="string"?e:Wn(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=H2(t,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return t}var Qa={encode_col:li,encode_row:zi,encode_cell:On,encode_range:Wn,decode_col:cR,decode_row:lR,split_cell:q4e,decode_cell:ci,decode_range:ou,format_cell:bA,sheet_add_aoa:Hne,sheet_add_json:Ase,sheet_add_dom:ise,aoa_to_sheet:y1,json_to_sheet:P8e,table_to_sheet:ose,table_to_book:HMe,sheet_to_csv:TR,sheet_to_txt:hse,sheet_to_json:JS,sheet_to_html:sse,sheet_to_formulae:j8e,sheet_to_row_object_array:JS,sheet_get_cell:H2,book_new:kR,book_append_sheet:FR,book_set_sheet_visibility:T8e,cell_set_number_format:k8e,cell_set_hyperlink:mse,cell_set_internal_link:F8e,cell_add_comment:O8e,sheet_set_array_formula:D8e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const gP="pollo_cash_audits";async function R8e(t){return(await Zn(bt(Pe,gP),{...t,createdAt:t.createdAt??xr.now()})).id}async function M8e(t){const e=bt(Pe,gP),r=(()=>{if(t!=null&&t.createdFrom&&(t!=null&&t.createdTo)){const s=xr.fromDate(t.createdFrom),o=xr.fromDate(t.createdTo);return sr(e,Ar("createdAt",">=",s),Ar("createdAt","<=",o),In("createdAt","desc"))}return sr(e,In("createdAt","desc"))})();return(await $t(r)).docs.map(s=>{const o=s.data();return{id:s.id,createdAt:o.createdAt,createdByUid:o.createdByUid||"",createdByName:o.createdByName||"",contadorUid:o.contadorUid||"",contadorName:o.contadorName||"",entregadoPor:o.entregadoPor||"",recibidoPor:o.recibidoPor||"",rangeFrom:o.rangeFrom||"",rangeTo:o.rangeTo||"",ventasCash:Number(o.ventasCash||0),abonos:Number(o.abonos||0),ingresosExtra:Number(o.ingresosExtra||0),debitos:Number(o.debitos||0),subTotal:Number(o.subTotal||0),totalEntregado:Number(o.totalEntregado||0),comment:o.comment||""}})}async function L8e(t){await qn(er(Pe,gP,t))}async function U8e(t,e){await Fn(er(Pe,gP,t),e)}const yi=t=>`C$ ${(Number(t)||0).toFixed(2)}`,JC=t=>Number(t||0).toFixed(3),Ri=t=>{const e=Number(String(t??"").replace(/,/g,"."));return isNaN(e)?0:Math.round(e*100)/100},ZS=t=>{const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},Ym=()=>{const t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},Q8e=()=>{const t=new Date;return ZS(new Date(t.getFullYear(),t.getMonth(),1))},V8e=()=>{const t=new Date;return ZS(new Date(t.getFullYear(),t.getMonth()+1,0))},H8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),$8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),pse=t=>String(t??"").toLowerCase().trim(),ZC=t=>Number(t.qty??t.quantity??0),m$=t=>["lb","lbs","libra","libras"].includes(pse(t)),p$=t=>["unidad","unidades","ud","uds","pieza","piezas"].includes(pse(t));function K8e(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(!1),[o,l]=g.useState(!1),[c,u]=g.useState(null),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(""),[I,_]=g.useState(Ym()),[S,E]=g.useState(Ym()),[B,k]=g.useState(0),[P,O]=g.useState(0),[z,oe]=g.useState(0),[ce,ue]=g.useState(0),[ge,ne]=g.useState(""),[Oe,Ue]=g.useState([]),[F,H]=g.useState(0),[K,U]=g.useState(!1),W=g.useMemo(()=>Ri(B+P+z),[B,P,z]),X=g.useMemo(()=>Ri(W-ce),[W,ce]),[D,V]=g.useState([]),[Z,be]=g.useState(!1),[L,Xe]=g.useState(Q8e()),[re,J]=g.useState(V8e()),[De,ie]=g.useState([]),[He,Ge]=g.useState(0),[dt,_t]=g.useState(!1);async function Bt(){var pe;const he=(await $t(sr(bt(Pe,"users")))).docs.map(je=>{const we=je.data();return{uid:je.id,name:we.displayName||we.name||we.email||je.id,role:we.role,roles:we.roles}}).filter(je=>je.role==="contador"||Array.isArray(je.roles)&&je.roles.includes("contador"));h(he);const qe=((pe=Ec.currentUser)==null?void 0:pe.uid)||"",yt=he.find(je=>je.uid===qe)||he[0];yt&&(p(yt.uid),v(yt.name))}async function Ot(){be(!0);try{const me=L&&re?{createdFrom:H8e(new Date(L)),createdTo:$8e(new Date(re))}:void 0,Re=await M8e(me);V(Re)}finally{be(!1)}}g.useEffect(()=>{Bt(),Ot()},[]),g.useEffect(()=>{Ot()},[L,re]),g.useEffect(()=>{(async()=>{if(!(!L||!re)){_t(!0);try{const Re=sr(bt(Pe,"salesV2"),Ar("date",">=",L),Ar("date","<=",re)),he=await $t(Re),qe=[];he.forEach(je=>{const we=je.data(),Ye=we.date??"";if(Array.isArray(we.items)&&we.items.length>0){we.items.forEach((xe,Se)=>{const xt=String(xe.productName??"(sin nombre)"),Pt=Number(xe.qty??0),It=Number(xe.lineFinal??0)||Math.max(0,Number(xe.unitPrice||0)*Pt-Number(xe.discount||0));qe.push({id:`${je.id}#${Se}`,date:Ye,productName:xt,quantity:Pt,amount:It,measurement:xe.measurement??we.measurement??"",type:we.type??"CONTADO"})});return}qe.push({id:je.id,date:Ye,productName:we.productName??"(sin nombre)",quantity:Number(we.quantity??0),amount:Number(we.amount??we.amountCharged??0),measurement:we.measurement??"",type:we.type??"CONTADO"})}),ie(qe);const st=await $t(bt(Pe,"ar_movements_pollo"));let yt=0;const pe=je=>{var we;return je!=null&&je.date?String(je.date):(we=je==null?void 0:je.createdAt)!=null&&we.toDate?ZS(je.createdAt.toDate()):""};st.forEach(je=>{const we=je.data();if(String(we.type??"").toUpperCase()!=="ABONO")return;const xe=Math.abs(Number(we.amount??0)),Se=pe(we);Se&&Se>=L&&Se<=re&&(yt+=xe)}),Ge(yt)}catch(Re){console.error("Error cargando KPIs del periodo:",Re),ie([]),Ge(0)}finally{_t(!1)}}})()},[L,re]),g.useEffect(()=>{(async()=>{if(!(!I||!S)){U(!0);try{const Re=sr(bt(Pe,"salesV2"),Ar("date",">=",I),Ar("date","<=",S)),he=await $t(Re),qe=[];he.forEach(je=>{const we=je.data(),Ye=we.date??"";if(Array.isArray(we.items)&&we.items.length>0){we.items.forEach((xe,Se)=>{const xt=String(xe.productName??"(sin nombre)"),Pt=Number(xe.qty??0),It=Number(xe.lineFinal??0)||Math.max(0,Number(xe.unitPrice||0)*Pt-Number(xe.discount||0));qe.push({id:`${je.id}#${Se}`,date:Ye,productName:xt,quantity:Pt,amount:It,measurement:xe.measurement??we.measurement??"",type:we.type??"CONTADO"})});return}qe.push({id:je.id,date:Ye,productName:we.productName??"(sin nombre)",quantity:Number(we.quantity??0),amount:Number(we.amount??we.amountCharged??0),measurement:we.measurement??"",type:we.type??"CONTADO"})}),Ue(qe);const st=await $t(bt(Pe,"ar_movements_pollo"));let yt=0;const pe=je=>{var we;return je!=null&&je.date?String(je.date):(we=je==null?void 0:je.createdAt)!=null&&we.toDate?ZS(je.createdAt.toDate()):""};st.forEach(je=>{const we=je.data();if(String(we.type??"").toUpperCase()!=="ABONO")return;const xe=Math.abs(Number(we.amount??0)),Se=pe(we);Se&&Se>=I&&Se<=S&&(yt+=xe)}),H(yt)}catch(Re){console.error("Error cargando KPI de modal:",Re),Ue([]),H(0)}finally{U(!1)}}})()},[I,S]);const jt=g.useMemo(()=>{const me=D.reduce((qe,st)=>qe+(Number(st.totalEntregado)||0),0),Re=D.reduce((qe,st)=>qe+(Number(st.debitos)||0),0),he=D.reduce((qe,st)=>qe+(Number(st.subTotal)||0),0);return{sumTotal:Ri(me),sumDeb:Ri(Re),sumSub:Ri(he)}},[D]),Qt=g.useMemo(()=>{const me=De.filter(we=>we.type==="CONTADO"),Re=De.filter(we=>we.type==="CREDITO"),he=me.reduce((we,Ye)=>we+(Ye.amount||0),0),qe=he+He,st=me.reduce((we,Ye)=>m$(Ye.measurement)?we+ZC(Ye):we,0),yt=me.reduce((we,Ye)=>p$(Ye.measurement)?we+ZC(Ye):we,0),pe=Re.reduce((we,Ye)=>m$(Ye.measurement)?we+ZC(Ye):we,0),je=Re.reduce((we,Ye)=>p$(Ye.measurement)?we+ZC(Ye):we,0);return{ventasCash:Ri(he),recaudado:Ri(qe),lbsCash:JC(st),unitsCash:JC(yt),lbsCredit:JC(pe),unitsCredit:JC(je)}},[De,He]),Ft=g.useMemo(()=>{const he=Oe.filter(qe=>qe.type==="CONTADO").reduce((qe,st)=>qe+(st.amount||0),0)+F;return{recaudado:Ri(he)}},[Oe,F]);function $e(){b(""),j(""),_(Ym()),E(Ym()),k(0),O(0),oe(0),ue(0),ne(""),s(!1),l(!1),u(null)}function Fe(me){u(me.id),e(!0),s(!0),l(!0),p(me.contadorUid||""),v(me.contadorName||""),b(me.recibidoPor||""),j(me.entregadoPor||""),_(me.rangeFrom||Ym()),E(me.rangeTo||Ym()),k(Number(me.ventasCash||0)),O(Number(me.abonos||0)),oe(Number(me.ingresosExtra||0)),ue(Number(me.debitos||0)),ne(me.comment||"")}async function Ze(){var me,Re,he;if(!m)return alert("Seleccione Contador.");if(!y.trim())return alert("Recibido por es obligatorio.");if(!I||!S)return alert("Seleccione el rango arqueado.");if(new Date(I)>new Date(S))return alert("Rango invlido: Desde no puede ser mayor que Hasta.");n(!0);try{if(c)await U8e(c,{contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:I,rangeTo:S,ventasCash:Ri(B),abonos:Ri(P),ingresosExtra:Ri(z),debitos:Ri(ce),subTotal:Ri(W),totalEntregado:Ri(X),comment:ge.trim()});else{const qe=((me=Ec.currentUser)==null?void 0:me.uid)||"",st=((Re=Ec.currentUser)==null?void 0:Re.displayName)||((he=Ec.currentUser)==null?void 0:he.email)||qe;await R8e({createdAt:xr.now(),createdByUid:qe,createdByName:st,contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:I,rangeTo:S,ventasCash:Ri(B),abonos:Ri(P),ingresosExtra:Ri(z),debitos:Ri(ce),subTotal:Ri(W),totalEntregado:Ri(X),comment:ge.trim()})}e(!1),$e(),await Ot()}finally{n(!1)}}async function Te(me){var he;if(window.confirm(`Eliminar el arqueo creado el ${(he=me.createdAt)!=null&&he.toDate?me.createdAt.toDate().toLocaleString():""}?`)){n(!0);try{await L8e(me.id),await Ot()}finally{n(!1)}}}function ee(){const me=D.map(qe=>{var st;return{"Fecha de creacin":(st=qe.createdAt)!=null&&st.toDate?qe.createdAt.toDate().toLocaleString():"","Rango arqueado":`${qe.rangeFrom} a ${qe.rangeTo}`,"Arqueado por (Contador)":qe.contadorName,"Recibido por":qe.recibidoPor,"Entregado por":qe.entregadoPor,"Ventas cash":qe.ventasCash,Abonos:qe.abonos,"Ingresos extra":qe.ingresosExtra,"Sub total":qe.subTotal,Dbitos:qe.debitos,"Monto entregado":qe.totalEntregado,Comentario:qe.comment||""}}),Re=Qa.json_to_sheet(me),he=Qa.book_new();Qa.book_append_sheet(he,Re,"Arqueos"),V2(he,`arqueos_pollo_${Ym()}.xlsx`)}return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Arqueo fsico y entregas (Pollo)"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Registro de arqueos, dbitos por gasto/reabastecimiento y monto entregado."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{$e(),e(!0)},className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo arqueo"}),i.jsx("button",{onClick:ee,className:"px-3 py-2 rounded bg-emerald-600 text-white text-sm hover:bg-emerald-700",children:"Exportar Excel"})]})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Filtro por fecha (creacin)"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:L,onChange:me=>Xe(me.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:re,onChange:me=>J(me.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]})]}),i.jsx("button",{onClick:()=>{Xe(""),J("")},className:"mt-2 text-xs text-blue-600 hover:underline",children:"Limpiar filtro"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-xl font-semibold",children:yi(jt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(jt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(jt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]})]}),i.jsxs("div",{className:"mt-3 hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Qt.ventasCash)}),dt&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Qt.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCredit})]})]}),i.jsx("div",{className:"mt-3 md:hidden",children:i.jsx(Q5,{title:"KPIs",open:d,onToggle:()=>f(me=>!me),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(jt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(jt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(jt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Qt.ventasCash)}),dt&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Qt.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCredit})]})]})]})})}),i.jsx("div",{className:"mt-4 block md:hidden space-y-3",children:Z?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):D.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"No hay arqueos en este rango."}):D.map(me=>{var Re;return i.jsxs("div",{className:"bg-white border rounded-2xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha de creacin"}),i.jsx("div",{className:"font-semibold text-sm",children:(Re=me.createdAt)!=null&&Re.toDate?me.createdAt.toDate().toLocaleString():""}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Rango arqueado"}),i.jsxs("div",{className:"text-sm",children:[me.rangeFrom," a ",me.rangeTo]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto entregado"}),i.jsx("div",{className:"font-semibold",children:yi(me.totalEntregado)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-gray-600",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Contador:"})," ",me.contadorName]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Recibido:"})," ",me.recibidoPor]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Sub total:"})," ",yi(me.subTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Dbitos:"})," ",yi(me.debitos)]})]}),i.jsxs("div",{className:"mt-3 flex justify-end",children:[i.jsx("button",{type:"button",onClick:()=>Fe(me),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>Te(me),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},me.id)})}),i.jsxs("div",{className:"mt-4 bg-white rounded shadow overflow-hidden hidden md:block",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Arqueos guardados"}),i.jsx("div",{className:"text-xs text-gray-500",children:Z?"Cargando...":`${D.length} registro(s)`})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 text-gray-600",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left px-3 py-2",children:"Fecha de creacin"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Rango arqueado"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Arqueado por"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Recibido por"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Sub total"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Dbitos"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Monto entregado"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[!Z&&D.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-3 py-6 text-center text-gray-500",children:"No hay arqueos en este rango."})}),D.map(me=>{var Re;return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-3 py-2",children:(Re=me.createdAt)!=null&&Re.toDate?me.createdAt.toDate().toLocaleString():""}),i.jsxs("td",{className:"px-3 py-2",children:[me.rangeFrom," a ",me.rangeTo]}),i.jsx("td",{className:"px-3 py-2",children:me.contadorName}),i.jsx("td",{className:"px-3 py-2",children:me.recibidoPor}),i.jsx("td",{className:"px-3 py-2 text-right font-medium",children:yi(me.subTotal)}),i.jsx("td",{className:"px-3 py-2 text-right",children:yi(me.debitos)}),i.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:yi(me.totalEntregado)}),i.jsxs("td",{className:"px-3 py-2 text-right",children:[i.jsx("button",{type:"button",onClick:()=>Fe(me),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>Te(me),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},me.id)})]})]})})]}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-3xl rounded shadow-lg overflow-hidden",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:c?"Editar arqueo":"Nuevo arqueo"}),i.jsx("button",{onClick:()=>{e(!1),$e()},className:"text-sm px-2 py-1 rounded hover:bg-gray-100",children:""})]}),i.jsxs("div",{className:"p-3 md:p-4 space-y-3 text-sm",children:[i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx(Q5,{title:"Datos colaboradores",open:a,onToggle:()=>s(me=>!me),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:me=>{const Re=me.target.value,he=A.find(qe=>qe.uid===Re);p(Re),v((he==null?void 0:he.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(me=>i.jsx("option",{value:me.uid,children:me.name},me.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:me=>b(me.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:me=>j(me.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:I,onChange:me=>_(me.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:me=>E(me.target.value),className:"w-full border rounded px-2 py-2"})]})]})]})}),i.jsxs(Q5,{title:"Inputs y KPIs",open:o,onToggle:()=>l(me=>!me),children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:yi(Ft.recaudado)}),K&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsx(m0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(m0,{label:"Abonos",value:P,onChange:O}),i.jsx(m0,{label:"Ingresos extra oficiales",value:z,onChange:oe}),i.jsx(m0,{label:"Dbitos (gasto o reabastecimiento)",value:ce,onChange:ue})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[i.jsx(e_,{title:"Sub total (ventas + abonos + ingresos)",value:yi(W)}),i.jsx(e_,{title:"Total (sub total - dbitos)",value:yi(X)})]})]})]}),i.jsxs("div",{className:"hidden md:block space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:me=>{const Re=me.target.value,he=A.find(qe=>qe.uid===Re);p(Re),v((he==null?void 0:he.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(me=>i.jsx("option",{value:me.uid,children:me.name},me.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:me=>b(me.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:me=>j(me.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:I,onChange:me=>_(me.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:me=>E(me.target.value),className:"w-full border rounded px-2 py-2"})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:yi(Ft.recaudado)}),K&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(m0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(m0,{label:"Abonos",value:P,onChange:O}),i.jsx(m0,{label:"Ingresos extra oficiales",value:z,onChange:oe}),i.jsx(m0,{label:"Dbitos (gasto o reabastecimiento)",value:ce,onChange:ue})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(e_,{title:"Sub total (ventas + abonos + ingresos)",value:yi(W)}),i.jsx(e_,{title:"Total (sub total - dbitos)",value:yi(X)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Comentario / Nota"}),i.jsx("textarea",{value:ge,onChange:me=>ne(me.target.value),className:"w-full border rounded px-2 py-2 min-h-[90px]",placeholder:"Opcional..."})]})]}),i.jsxs("div",{className:"p-3 border-t flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>{e(!1),$e()},className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",disabled:r,children:"Cancelar"}),i.jsx("button",{onClick:Ze,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-60",disabled:r,children:r?"Guardando...":c?"Guardar cambios":"Guardar arqueo"})]})]})})]})}function e_({title:t,value:e}){return i.jsxs("div",{className:"bg-gray-50 border rounded p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-semibold",children:e})]})}function m0({label:t,value:e,onChange:r}){return i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:t}),i.jsx("input",{inputMode:"decimal",value:String(e),onChange:n=>r(Ri(n.target.value)),className:"w-full border rounded px-2 py-2",placeholder:"0.00"})]})}function Q5({title:t,open:e,onToggle:r,children:n}){return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold text-sm",children:t}),i.jsx("button",{type:"button",onClick:r,className:"text-xs px-3 py-1.5 rounded border hover:bg-gray-50",children:e?"Cerrar":"Ver"})]}),e&&i.jsx("div",{className:"px-3 pb-3 pt-1",children:n})]})}const Qo=t=>`C$ ${(Number(t)||0).toFixed(2)}`,G8e=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function t_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function q8e(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function z8e(t){const e="ROP",r=t_(t.subcat).slice(0,3)||"GEN",n=q8e(t.gender),a=t_(t.color).slice(0,3)||"COL",s=t_(t.size)||"TLL",o=t_(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${a}-${s}-${o}-${l}`}const gy=/^[A-Za-z0-9._-]{0,32}$/;function W8e(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(Ur(new Date,"yyyy-MM-dd")),[y,b]=g.useState(0),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(0),[P,O]=g.useState(""),[z,oe]=g.useState(""),[ce,ue]=g.useState(""),[ge,ne]=g.useState(""),[Oe,Ue]=g.useState(""),[F,H]=g.useState(""),[K,U]=g.useState(""),[W,X]=g.useState(!1),[D,V]=g.useState(""),[Z,be]=g.useState("Camisa"),[L,Xe]=g.useState(null),[re,J]=g.useState(""),[De,ie]=g.useState(0),[He,Ge]=g.useState(0),[dt,_t]=g.useState(0),[Bt,Ot]=g.useState(0),[jt,Qt]=g.useState(0),[Ft,$e]=g.useState(""),[Fe,Ze]=g.useState(""),[Te,ee]=g.useState(""),[me,Re]=g.useState(""),[he,qe]=g.useState(""),[st,yt]=g.useState(""),[pe,je]=g.useState(""),[we,Ye]=g.useState(null),[xe,Se]=g.useState({x:0,y:0}),[xt,Pt]=g.useState(!1);g.useEffect(()=>{const Q=()=>Ye(null),G=se=>se.key==="Escape"&&Ye(null);return document.addEventListener("click",Q),document.addEventListener("keydown",G),()=>{document.removeEventListener("click",Q),document.removeEventListener("keydown",G)}},[]);const It=(Q,G,se=192,Ne=160)=>{let ze=Q;Q+se+8>window.innerWidth&&(ze=Q-se),ze=Math.max(8,Math.min(ze,window.innerWidth-se-8));let Ie=G;return G+Ne+8>window.innerHeight&&(Ie=window.innerHeight-Ne-8),Ie=Math.max(8,Math.min(Ie,window.innerHeight-Ne-8)),{x:ze,y:Ie}},Ut=(Q,G)=>{Q.stopPropagation();const se=Q.currentTarget.getBoundingClientRect(),Ne=se.right,Me=se.bottom,ze=It(Ne,Me);Se(ze),Ye(Ie=>Ie===G?null:G)};g.useEffect(()=>{const Q=()=>Ye(null),G=se=>{se.key==="Escape"&&Ye(null)};return document.addEventListener("click",Q),document.addEventListener("keydown",G),()=>{document.removeEventListener("click",Q),document.removeEventListener("keydown",G)}},[]),g.useEffect(()=>{if(!we)return;const Q=()=>Ye(null);return window.addEventListener("scroll",Q,!0),window.addEventListener("resize",Q),()=>{window.removeEventListener("scroll",Q,!0),window.removeEventListener("resize",Q)}},[we]),g.useEffect(()=>{(async()=>{const Q=await $t(bt(Pe,"products_clothes")),G=[];Q.forEach(ze=>{const Ie=ze.data();G.push({id:ze.id,name:Ie.name??"(sin nombre)",category:Ie.category??"(sin categora)",measurement:Ie.measurement??"unidad",price:Number(Ie.price??0),sku:Ie.sku||"",size:Ie.size||"",color:Ie.color||"",gender:Ie.gender||"",brand:Ie.brand||""})}),e(G);const se=sr(bt(Pe,"inventory_clothes_batches"),In("date","desc")),Ne=await $t(se),Me=[];Ne.forEach(ze=>{const Ie=ze.data();Me.push({id:ze.id,productId:Ie.productId,productName:Ie.productName,category:Ie.category,unit:Ie.unit,quantity:Number(Ie.quantity||0),remaining:Number(Ie.remaining??Ie.quantity??0),purchasePrice:Number(Ie.purchasePrice||0),salePrice:Number(Ie.salePrice||0),invoiceTotal:Number(Ie.invoiceTotal??Number(Ie.quantity||0)*Number(Ie.purchasePrice||0)),expectedTotal:Number(Ie.expectedTotal??Number(Ie.quantity||0)*Number(Ie.salePrice||0)),date:Ie.date,createdAt:Ie.createdAt,status:Ie.status,notes:Ie.notes||"",sku:Ie.sku||"",size:Ie.size||"",color:Ie.color||"",gender:Ie.gender||"",brand:Ie.brand||"",clientCode:Ie.clientCode||""})}),n(Me),s(!1)})()},[]),g.useEffect(()=>{const Q=t.find(G=>G.id===m);Q&&(_(Number(Q.price||0)),Q.sku&&oe(Q.sku),Q.size&&ue(G=>G||Q.size),Q.color&&ne(G=>G||Q.color),Q.gender&&Ue(G=>G||Q.gender),Q.brand&&H(G=>G||Q.brand))},[m,t]),g.useEffect(()=>{E(Math.floor(y*w*100)/100)},[y,w]),g.useEffect(()=>{k(Math.floor(y*I*100)/100)},[y,I]),g.useEffect(()=>{const Q=t.find(Ne=>Ne.id===m);if(Q!=null&&Q.sku){oe(Q.sku);return}const G=W&&Z?Z:(Q==null?void 0:Q.category)||"";if(!G&&!Oe&&!ge&&!ce&&!F){oe("");return}const se=z8e({subcat:G,gender:Oe||"",color:ge||"",size:ce||"",brand:F||""});oe(se)},[W,Z,m,Oe,ge,ce,F,t]);const Ht=g.useMemo(()=>r.filter(Q=>!(c&&Q.date<c||d&&Q.date>d||A&&Q.productId!==A)),[r,c,d,A]),Le=g.useMemo(()=>{const Q=Ht.reduce((Me,ze)=>Me+(ze.invoiceTotal||0),0),G=Ht.reduce((Me,ze)=>Me+(ze.expectedTotal||0),0),se=Ht.reduce((Me,ze)=>Me+ze.quantity,0),Ne=Ht.reduce((Me,ze)=>Me+ze.remaining,0);return{udsIng:se,udsRem:Ne,totalFacturado:Q,totalEsperado:G}},[Ht]),Ce=async Q=>{Q.preventDefault(),l("");const G=!!m&&!W,se=t.find(Ie=>Ie.id===m),Ne=G?(se==null?void 0:se.name)||"":D||"",Me=G?(se==null?void 0:se.category)||"":Z||"General",ze=G&&(se==null?void 0:se.measurement)||"unidad";if(!Ne||y<=0||w<=0){l("Completa nombre/cantidad/costo.");return}if(K&&!gy.test(K)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const Ie=await Zn(bt(Pe,"inventory_clothes_batches"),{productId:G?se.id:"",productName:Ne,category:Me,unit:ze,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:B,date:x,createdAt:xr.now(),status:"PENDIENTE",notes:P||"",sku:z||"",size:ce||"",color:ge||"",gender:Oe||"",brand:F||"",clientCode:K||""});n(nt=>[{id:Ie.id,productId:G?se.id:"",productName:Ne,category:Me,unit:ze,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:B,date:x,createdAt:xr.now(),status:"PENDIENTE",notes:P||"",sku:z||"",size:ce||"",color:ge||"",gender:Oe||"",brand:F||"",clientCode:K||""},...nt]),l(" Lote de ropa creado"),p(""),v(Ur(new Date,"yyyy-MM-dd")),b(0),j(0),_(0),E(0),k(0),O(""),oe(""),ue(""),ne(""),Ue(""),H(""),U(""),X(!1),V(""),be("Camisa")}catch(Ie){console.error(Ie),l(" Error al crear lote")}},Ae=async Q=>{confirm(`Marcar PAGADO el lote del ${Q.date} (${Q.productName})?`)&&(await Fn(er(Pe,"inventory_clothes_batches",Q.id),{status:"PAGADO"}),n(se=>se.map(Ne=>Ne.id===Q.id?{...Ne,status:"PAGADO"}:Ne)))},Qe=Q=>{Xe(Q.id),J(Q.date),ie(Q.quantity),Ge(Q.purchasePrice),_t(Q.salePrice),Ot(Number((Q.quantity*Q.purchasePrice).toFixed(2))),Qt(Number((Q.quantity*Q.salePrice).toFixed(2))),$e(Q.notes||""),Ze(Q.sku||""),ee(Q.size||""),Re(Q.color||""),qe(Q.gender||""),yt(Q.brand||""),je(Q.clientCode||"")},fe=()=>{Xe(null),J(""),ie(0),Ge(0),_t(0),Ot(0),Qt(0),$e(""),Ze(""),ee(""),Re(""),qe(""),yt(""),je("")};g.useEffect(()=>{L&&Ot(Math.floor(De*He*100)/100)},[L,De,He]),g.useEffect(()=>{L&&Qt(Math.floor(De*dt*100)/100)},[L,De,dt]);const te=async()=>{if(!L)return;const Q=r.find(Me=>Me.id===L);if(!Q)return;const G=Math.max(0,Q.quantity-Q.remaining),se=Math.max(0,De-G);if(pe&&!gy.test(pe)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const Ne=er(Pe,"inventory_clothes_batches",L);await Fn(Ne,{date:re,quantity:De,purchasePrice:He,salePrice:dt,invoiceTotal:Bt,expectedTotal:jt,notes:Ft,remaining:se,sku:Fe,size:Te,color:me,gender:he||"",brand:st||"",clientCode:pe||""}),n(Me=>Me.map(ze=>ze.id===L?{...ze,date:re,quantity:De,purchasePrice:He,salePrice:dt,invoiceTotal:Bt,expectedTotal:jt,notes:Ft,remaining:se,sku:Fe,size:Te,color:me,gender:he||"",brand:st||"",clientCode:pe||""}:ze)),fe(),l(" Lote actualizado")},_e=async Q=>{confirm(`Eliminar el lote del ${Q.date} (${Q.productName})?`)&&(await qn(er(Pe,"inventory_clothes_batches",Q.id)),n(se=>se.filter(Ne=>Ne.id!==Q.id)),l(" Lote eliminado"))},R=()=>{const Q=(c?`Desde ${c}`:"Desde inicio")+"  "+(d?`Hasta ${d}`:"Hasta hoy"),G=ze=>(ze||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),se=Ht.map(ze=>`
      <tr>
        <td>${ze.date}</td>
        <td>${(ze.category||"").toUpperCase()}</td>
        <td>${G(ze.productName)}</td>
        <td>${G(ze.sku||"")}</td>
        <td>${G(ze.size||"")}</td>
        <td>${G(ze.color||"")}</td>
        <td>${G(ze.clientCode||"")}</td>
        <td>${G(ze.gender||"")}</td>
        <td>${(ze.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${ze.quantity.toFixed(0)}</td>
        <td style="text-align:right">${ze.remaining.toFixed(0)}</td>
        <td style="text-align:right">${Qo(ze.purchasePrice)}</td>
        <td style="text-align:right">${Qo(ze.salePrice)}</td>
        <td style="text-align:right">${Qo(ze.invoiceTotal||0)}</td>
        <td style="text-align:right">${Qo(ze.expectedTotal||0)}</td>
        <td>${G((ze.notes||"").slice(0,120))}</td>
        <td>${ze.status}</td>
      </tr>`).join(""),Ne=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${Q}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${Le.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${Le.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${Qo(Le.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${Qo(Le.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${Qo(Number((Le.totalEsperado-Le.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${se||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,Me=window.open("","_blank");Me&&(Me.document.open(),Me.document.write(Ne),Me.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Pt(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:Q=>u(Q.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:Q=>f(Q.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:Q=>h(Q.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(Q=>i.jsxs("option",{value:Q.id,children:[Q.name,"  ",Q.category]},Q.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:R,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Le.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Le.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Qo(Le.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Qo(Le.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Qo(Number((Le.totalEsperado-Le.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):Ht.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):Ht.map(Q=>{const G=L===Q.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:G?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:re,onChange:se=>J(se.target.value)}):Q.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(Q.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:Q.productName,children:Q.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:G?i.jsx("input",{className:"w-full border p-1 rounded",value:Fe,onChange:se=>Ze(se.target.value)}):i.jsx("span",{className:"block truncate",title:Q.sku||"",children:Q.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:G?i.jsx("input",{className:"w-full border p-1 rounded",value:Te,onChange:se=>ee(se.target.value)}):Q.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:G?i.jsx("input",{className:"w-full border p-1 rounded",value:me,onChange:se=>Re(se.target.value)}):Q.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:G?i.jsx("input",{className:"w-full border p-1 rounded",value:pe,onChange:se=>{const Ne=se.target.value;gy.test(Ne)&&je(Ne)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:Q.clientCode||"",children:Q.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:G?i.jsx("select",{className:"w-full border p-1 rounded",value:he,onChange:se=>qe(se.target.value),children:G8e.map(se=>i.jsx("option",{value:se,children:se||""},se))}):Q.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(Q.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:G?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(De)?"":De,onChange:se=>ie(Math.max(0,parseInt(se.target.value||"0",10)))}):Q.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:G?Q.remaining:Q.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:G?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(He)?"":He,onChange:se=>Ge(Math.max(0,parseFloat(se.target.value||"0")))}):Qo(Q.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:G?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(dt)?"":dt,onChange:se=>_t(Math.max(0,parseFloat(se.target.value||"0")))}):Qo(Q.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Qo(G?Bt:Q.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Qo(G?jt:Q.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:G?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ft,onChange:se=>$e(se.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:Q.notes||"",children:Q.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${Q.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Q.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:G?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:te,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:fe,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:se=>Ut(se,Q.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},Q.id)})})]})})}),we&&Mu.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>Ye(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:xe.x,top:xe.y},onClick:Q=>Q.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const Q=Ht.find(G=>G.id===we);return(Q==null?void 0:Q.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{Ye(null),Ae(Q)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const Q=Ht.find(G=>G.id===we);Q&&(Ye(null),Qe(Q))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const Q=Ht.find(G=>G.id===we);Q&&(Ye(null),_e(Q))},children:" Borrar"})]})})]}),document.body),xt&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Pt(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pt(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ce,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:Q=>p(Q.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(Q=>i.jsxs("option",{value:Q.id,children:[Q.name,"  ",Q.category,"  ",Q.sku?`SKU: ${Q.sku}`:""]},Q.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:Q=>v(Q.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:Q=>b(Math.max(0,parseInt(Q.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:Q=>j(Math.max(0,parseFloat(Q.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:I===0?"":I,onChange:Q=>_(Math.max(0,parseFloat(Q.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:z,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ce,readOnly:!0,onChange:Q=>ue(Q.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ge,readOnly:!0,onChange:Q=>ne(Q.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Oe,readOnly:!0,onChange:Q=>Ue(Q.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:F,onChange:Q=>H(Q.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:K,onChange:Q=>{const G=Q.target.value;gy.test(G)&&U(G)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!gy.test(K)&&K.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:P,onChange:Q=>O(Q.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[P.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Qo(S),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Qo(B),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pt(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const X8e=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],Y8e=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],J8e=["XS","S","M","L","XL","2XL"],Z8e=["2","4","6","8","10","12","14"],eLe=["26","28","30","32","34","36","38"],tLe=["Shein","Usado","Otro"],rLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function r_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function nLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function aLe(t){const e="ROP",r=r_(t.subcat).slice(0,3)||"GEN",n=nLe(t.gender),a=r_(t.color).slice(0,3)||"COL",s=r_(t.size)||"TLL",o=r_(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${a}-${s}-${o}`}const sLe=/^[A-Za-z0-9._-]{0,32}$/;function iLe(){const[t,e]=g.useState(""),[r,n]=g.useState("Camisa"),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState("Shein"),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState("0"),[I,_]=g.useState(""),[S,E]=g.useState(""),B=g.useMemo(()=>{const U=Number(w||0),W=Number(y||0);return Math.floor(U*W*100)/100},[w,y]),[k,P]=g.useState([]),[O,z]=g.useState(!0),[oe,ce]=g.useState(""),{refreshKey:ue,refresh:ge}=Dc(),[ne,Oe]=g.useState(!1),Ue=g.useMemo(()=>r.toLowerCase()==="jean"?eLe:d==="NINO"||d==="NINA"?Z8e:J8e,[r,d]);g.useEffect(()=>{p(aLe({subcat:r,gender:d,color:o,size:a,brand:c}))},[r,d,o,a,c]),g.useEffect(()=>{(async()=>{z(!0);const U=sr(bt(Pe,"products_clothes"),In("createdAt","desc")),W=await $t(U),X=[];W.forEach(D=>{const V=D.data();X.push({id:D.id,name:V.name??"(sin nombre)",category:V.category??"",measurement:V.measurement??"unidad",sku:V.sku??"",size:V.size||"",color:V.color||"",brand:V.brand||"",gender:V.gender||"",clientCode:V.clientCode||"",notes:V.notes||"",createdAt:V.createdAt??xr.now()})}),P(X),z(!1)})()},[ue]);const F=()=>{e(""),n("Camisa"),s(""),l(""),u("Shein"),f(""),h(""),v(""),b(""),j("0"),_(""),E("")},H=async U=>{if(U.preventDefault(),ce(""),!t.trim()){ce("Ingresa el nombre del producto.");return}if(A&&!sLe.test(A)){ce("Cdigo del cliente invlido");return}const W=Number(w||0),X=Number(y||0);if(W<0){ce("La cantidad de piezas debe ser 0 o mayor.");return}if(X<0){ce("El precio de venta no puede ser negativo.");return}try{const D=await Zn(bt(Pe,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:xr.now(),price:X||0});if(P(V=>[{id:D.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:xr.now()},...V]),W>0){const V=new Date().toISOString().slice(0,10),Z=I||V;await Zn(bt(Pe,"inventory_clothes_batches"),{productId:D.id,productName:t.trim(),category:r,unit:"unidad",quantity:W,remaining:W,purchasePrice:0,salePrice:X||0,invoiceTotal:0,expectedTotal:B||0,date:Z,createdAt:xr.now(),status:"PENDIENTE",notes:S||"",sku:m||"",size:a||"",color:o||"",gender:d||"",brand:c||"",clientCode:A||""})}ce(W>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),F()}catch(D){console.error(D),ce(" Error al crear producto")}},K=async U=>{confirm(`Eliminar el producto "${U.name}"?`)&&(await qn(er(Pe,"products_clothes",U.id)),P(X=>X.filter(D=>D.id!==U.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Oc,{onClick:ge,loading:O}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{Oe(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),ne&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:U=>e(U.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:U=>n(U.target.value),children:X8e.map(U=>i.jsx("option",{value:U,children:U},U))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:d,onChange:U=>f(U.target.value),children:rLe.map(U=>i.jsx("option",{value:U,children:U||""},U))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:U=>s(U.target.value),children:[i.jsx("option",{value:"",children:""}),Ue.map(U=>i.jsx("option",{value:U,children:U},U))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:U=>l(U.target.value),children:[i.jsx("option",{value:"",children:""}),Y8e.map(U=>i.jsx("option",{value:U,children:U},U))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:U=>u(U.target.value),children:tLe.map(U=>i.jsx("option",{value:U,children:U},U))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:U=>h(U.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:U=>b(U.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:w,onChange:U=>j(U.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:I,onChange:U=>_(U.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(B)?"":B.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:F,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>Oe(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:O?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):k.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):k.map(U=>{var W;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(W=U.createdAt)!=null&&W.toDate?U.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:U.category}),i.jsx("td",{className:"p-2 border",children:U.name}),i.jsx("td",{className:"p-2 border",children:U.sku}),i.jsx("td",{className:"p-2 border",children:U.size||""}),i.jsx("td",{className:"p-2 border",children:U.color||""}),i.jsx("td",{className:"p-2 border",children:U.brand||""}),i.jsx("td",{className:"p-2 border",children:U.gender||""}),i.jsx("td",{className:"p-2 border",children:U.clientCode||""}),i.jsx("td",{className:"p-2 border",children:U.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>K(U),children:"Borrar"})})]},U.id)})})]})}),oe&&i.jsx("p",{className:"mt-2 text-sm",children:oe})]})}async function oLe(t){const{productId:e,quantity:r,saleDate:n,saleId:a}=t,s=Math.max(0,Math.floor(Number(r||0)));if(!e||s<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=sr(bt(Pe,"inventory_clothes_batches"),Ar("productId","==",e)),u=(await $t(o)).docs.map(f=>({id:f.id,data:f.data()})).sort((f,A)=>{var v,y;const h=String(f.data.date||""),m=String(A.data.date||"");if(h!==m)return h<m?-1:1;const p=((v=f.data.createdAt)==null?void 0:v.seconds)??0,x=((y=A.data.createdAt)==null?void 0:y.seconds)??0;return p-x}).map(f=>er(Pe,"inventory_clothes_batches",f.id)),d=[];return await Ks(Pe,async f=>{const A=await Promise.all(u.map(m=>f.get(m)));let h=s;for(let m=0;m<u.length&&h>0;m++){const p=u[m],x=A[m];if(!x.exists())continue;const v=x.data(),y=Math.max(0,Math.floor(Number(v.quantity||0))),b=Number.isFinite(Number(v.remaining))?Math.max(0,Math.floor(Number(v.remaining||0))):y;if(b<=0)continue;const w=Math.min(b,h),j=Math.max(0,b-w);f.update(p,{remaining:j}),d.push({batchId:p.id,qty:w,batchDate:String(v.date||""),productName:String(v.productName||"")}),h-=w}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(a)for(const m of d)await Zn(bt(Pe,"batch_clothes_allocations"),{saleId:a,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:xr.now()})}),{allocations:d}}async function iF(t){const e=er(Pe,"sales_clothes",t),r=await zs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const u=n.allocationsByItem[c],d=String((u==null?void 0:u.productId)||c||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];l[d]=f.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}for(const c of n.items){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),f=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))})):l[u]||[];a.push({productId:u,productName:String((c==null?void 0:c.productName)||""),qty:d,allocations:f.length?f:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),u=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),d=Array.isArray(n.allocations)?n.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):[];c&&u>0&&a.push({productId:c,productName:String(l.productName||n.productName||""),qty:u,allocations:d.length?d:void 0})}return a.length===0?(await Ks(Pe,async l=>{l.delete(e)}),{restored:0}):a.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await Ks(Pe,async c=>{const u=[];for(const f of a)for(const A of f.allocations||[])u.push({ref:er(Pe,"inventory_clothes_batches",A.batchId),addBack:Math.max(0,Math.floor(Number(A.qty||0)))});const d=await Promise.all(u.map(f=>c.get(f.ref)));for(let f=0;f<u.length;f++){const A=d[f];if(!A.exists())continue;const h=A.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(u[f].ref,{remaining:m+u[f].addBack})}c.delete(e)}),{restored:a.reduce((c,u)=>c+(u.allocations||[]).reduce((d,f)=>d+f.qty,0),0)}):(await Ks(Pe,async l=>{const c={};for(const h of a){if(!h.productId||h.qty<=0)continue;const m=sr(bt(Pe,"inventory_clothes_batches"),Ar("productId","==",h.productId)),x=(await $t(m)).docs.map(v=>{const y=v.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),w=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:v.id,date:String(y.date||""),quantity:b,remaining:w}}).sort((v,y)=>v.date.localeCompare(y.date));c[h.productId]=x}const u=[];for(const h of a){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)u.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const v=Math.max(0,x.quantity-x.remaining);if(v<=0)continue;const y=Math.min(v,p);u.push({id:x.id,addBack:y}),p-=y}for(const x of m){if(p<=0)break;const v=Math.min(p,h.qty);u.push({id:x.id,addBack:v}),p-=v}}const d={};for(const h of u)d[h.id]=(d[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const f=Object.keys(d).map(h=>er(Pe,"inventory_clothes_batches",h)),A=await Promise.all(f.map(h=>l.get(h)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),v=Math.max(0,Math.floor(Number(d[f[h].id]||0)));l.update(f[h],{remaining:x+v})}l.delete(e)}),{restored:a.reduce((l,c)=>l+c.qty,0)})}const g$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Th=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function n_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function x$(t){const e=sr(bt(Pe,"ar_movements"),Ar("ref.saleId","==",t)),r=await $t(e);await Promise.all(r.docs.map(n=>qn(er(Pe,"ar_movements",n.id))))}function lLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async Le=>{e(!0),n(!0),s(Le),l([]);try{const Ae=(await $t(sr(bt(Pe,"sales_clothes"),Ar("__name__","==",Le)))).docs[0],Qe=Ae==null?void 0:Ae.data(),te=(Array.isArray(Qe==null?void 0:Qe.items)?Qe.items:Qe!=null&&Qe.item?[Qe.item]:[]).map(_e=>({productName:String(_e.productName||""),qty:Number(_e.qty||0),unitPrice:Number(_e.unitPrice||0),discount:Number(_e.discount||0),total:Number(_e.total||0)}));l(te)}catch(Ce){console.error(Ce)}finally{n(!1)}},[u,d]=g.useState(""),[f,A]=g.useState("+505 "),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState("ACTIVO"),[b,w]=g.useState(0),[j,I]=g.useState([]),[_,S]=g.useState(!0),[E,B]=g.useState(""),[k,P]=g.useState(null),[O,z]=g.useState(""),[oe,ce]=g.useState("+505 "),[ue,ge]=g.useState(""),[ne,Oe]=g.useState(""),[Ue,F]=g.useState("ACTIVO"),[H,K]=g.useState(0),[U,W]=g.useState(!1),[X,D]=g.useState(null),[V,Z]=g.useState(!1),[be,L]=g.useState([]),[Xe,re]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[J,De]=g.useState(!1),[ie,He]=g.useState(0),[Ge,dt]=g.useState(new Date().toISOString().slice(0,10)),[_t,Bt]=g.useState(""),[Ot,jt]=g.useState(!1),[Qt,Ft]=g.useState(null),[$e,Fe]=g.useState(""),[Ze,Te]=g.useState(0),[ee,me]=g.useState(""),[Re,he]=g.useState(!1);g.useEffect(()=>{(async()=>{const Le=sr(bt(Pe,"customers_clothes"),In("createdAt","desc")),Ce=await $t(Le),Ae=[];Ce.forEach(Qe=>{const fe=Qe.data();Ae.push({id:Qe.id,name:fe.name??"",phone:fe.phone??"+505 ",place:fe.place??"",notes:fe.notes??"",status:fe.status??"ACTIVO",creditLimit:Number(fe.creditLimit??0),createdAt:fe.createdAt??xr.now(),balance:0})});for(const Qe of Ae)try{const fe=sr(bt(Pe,"ar_movements"),Ar("customerId","==",Qe.id)),te=await $t(fe);let _e=0;te.forEach(R=>_e+=Number(R.data().amount||0)),Qe.balance=_e}catch{Qe.balance=0}I(Ae),S(!1)})()},[]);const qe=()=>{d(""),A("+505 "),m(""),x(""),y("ACTIVO"),w(0)},st=async Le=>{if(Le.preventDefault(),B(""),!u.trim()){B("Ingresa el nombre.");return}const Ce=n_(f);if(Ce.length<6){B("Telfono incompleto.");return}try{const Ae=await Zn(bt(Pe,"customers_clothes"),{name:u.trim(),phone:Ce,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:xr.now()});I(Qe=>[{id:Ae.id,name:u.trim(),phone:Ce,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:xr.now(),balance:0},...Qe]),qe(),he(!1),B(" Cliente creado")}catch(Ae){console.error(Ae),B(" Error al crear cliente")}},yt=Le=>{P(Le.id),z(Le.name),ce(Le.phone||"+505 "),ge(Le.place||""),Oe(Le.notes||""),F(Le.status||"ACTIVO"),K(Number(Le.creditLimit||0))},pe=()=>{P(null),z(""),ce("+505 "),ge(""),Oe(""),F("ACTIVO"),K(0)},je=async()=>{if(!k)return;const Le=n_(oe);if(!O.trim()){B("Ingresa el nombre.");return}try{await Fn(er(Pe,"customers_clothes",k),{name:O.trim(),phone:Le,place:ue||"",notes:ne||"",status:Ue,creditLimit:Number(H||0)}),I(Ce=>Ce.map(Ae=>Ae.id===k?{...Ae,name:O.trim(),phone:Le,place:ue||"",notes:ne||"",status:Ue,creditLimit:Number(H||0)}:Ae)),pe(),B(" Cliente actualizado")}catch(Ce){console.error(Ce),B(" Error al actualizar")}},we=async Le=>{if(confirm(`Eliminar al cliente "${Le.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{S(!0);const Ae=sr(bt(Pe,"sales_clothes"),Ar("customerId","==",Le.id)),Qe=await $t(Ae);for(const _e of Qe.docs){const R=_e.id;try{await iF(R)}catch(Q){console.warn("restoreSaleAndDeleteClothes error",Q);try{await qn(er(Pe,"sales_clothes",R))}catch{}}await x$(R)}const fe=sr(bt(Pe,"ar_movements"),Ar("customerId","==",Le.id)),te=await $t(fe);await Promise.all(te.docs.map(_e=>qn(er(Pe,"ar_movements",_e.id)))),await qn(er(Pe,"customers_clothes",Le.id)),I(_e=>_e.filter(R=>R.id!==Le.id)),B(" Cliente eliminado y prendas devueltas al inventario")}catch(Ae){console.error(Ae),B(" No se pudo eliminar el cliente.")}finally{S(!1)}},Ye=async Le=>{D(Le),L([]),re({saldoActual:0,totalAbonado:0,totalCargos:0}),W(!0),De(!1),He(0),dt(new Date().toISOString().slice(0,10)),Bt(""),Ft(null),Z(!0);try{const Ce=sr(bt(Pe,"ar_movements"),Ar("customerId","==",Le.id)),Ae=await $t(Ce),Qe=[];Ae.forEach(fe=>{var _e,R;const te=fe.data();Qe.push({id:fe.id,date:te.date??((R=(_e=te.createdAt)==null?void 0:_e.toDate)!=null&&R.call(_e)?te.createdAt.toDate().toISOString().slice(0,10):""),type:te.type??"CARGO",amount:Number(te.amount||0),ref:te.ref||{},comment:te.comment||"",createdAt:te.createdAt})}),Qe.sort((fe,te)=>{var Q,G;if(fe.date!==te.date)return fe.date.localeCompare(te.date);const _e=((Q=fe.createdAt)==null?void 0:Q.seconds)||0,R=((G=te.createdAt)==null?void 0:G.seconds)||0;return _e-R}),L(Qe),xe(Qe)}catch(Ce){console.error(Ce),B(" No se pudo cargar el estado de cuenta")}finally{Z(!1)}},xe=Le=>{const Ce=Le.reduce((fe,te)=>fe+(Number(te.amount)||0),0),Ae=Le.filter(fe=>Number(fe.amount)<0).reduce((fe,te)=>fe+Math.abs(Number(te.amount)||0),0),Qe=Le.filter(fe=>Number(fe.amount)>0).reduce((fe,te)=>fe+Number(te.amount)||0,0);re({saldoActual:Ce,totalAbonado:Ae,totalCargos:Qe})},Se=async()=>{if(!X)return;B("");const Le=Number(ie||0);if(!(Le>0)){B("Ingresa un monto de abono mayor a 0.");return}const Ce=parseFloat(Le.toFixed(2));if(!Ge){B("Selecciona la fecha del abono.");return}try{jt(!0);const Ae={customerId:X.id,type:"ABONO",amount:-Ce,date:Ge,comment:_t||"",createdAt:xr.now()},fe={id:(await Zn(bt(Pe,"ar_movements"),Ae)).id,date:Ge,type:"ABONO",amount:-Ce,comment:_t||"",createdAt:xr.now()},te=[...be,fe].sort((_e,R)=>{var se,Ne;if(_e.date!==R.date)return _e.date.localeCompare(R.date);const Q=((se=_e.createdAt)==null?void 0:se.seconds)||0,G=((Ne=R.createdAt)==null?void 0:Ne.seconds)||0;return Q-G});L(te),xe(te),I(_e=>_e.map(R=>R.id===X.id?{...R,balance:(R.balance||0)-Ce}:R)),D(_e=>_e&&{..._e,balance:(_e.balance||0)-Ce}),He(0),Bt(""),dt(new Date().toISOString().slice(0,10)),De(!1),B(" Abono registrado")}catch(Ae){console.error(Ae),B(" Error al registrar el abono")}finally{jt(!1)}},xt=Le=>{Ft(Le.id),Fe(Le.date||new Date().toISOString().slice(0,10)),Te(Math.abs(Number(Le.amount||0))),me(Le.comment||"")},Pt=()=>{Ft(null),Fe(""),Te(0),me("")},It=async()=>{if(!Qt)return;const Le=be.findIndex(fe=>fe.id===Qt);if(Le===-1)return;const Ce=be[Le],Ae=Number(Ze||0);if(!(Ae>0)){B("El monto debe ser mayor a 0.");return}const Qe=Ce.type==="ABONO"?-parseFloat(Ae.toFixed(2)):+parseFloat(Ae.toFixed(2));try{await Fn(er(Pe,"ar_movements",Qt),{date:$e,amount:Qe,comment:ee||""});const fe=[...be];fe[Le]={...Ce,date:$e,amount:Qe,comment:ee||""},fe.sort((_e,R)=>{var se,Ne;if(_e.date!==R.date)return _e.date.localeCompare(R.date);const Q=((se=_e.createdAt)==null?void 0:se.seconds)||0,G=((Ne=R.createdAt)==null?void 0:Ne.seconds)||0;return Q-G}),L(fe),xe(fe);const te=fe.reduce((_e,R)=>_e+(Number(R.amount)||0),0);I(_e=>_e.map(R=>R.id===(X==null?void 0:X.id)?{...R,balance:te}:R)),D(_e=>_e&&{..._e,balance:te}),Pt(),B(" Movimiento actualizado")}catch(fe){console.error(fe),B(" Error al actualizar movimiento")}},Ut=async Le=>{var Ae,Qe;if(confirm(`Eliminar este movimiento (${Le.type==="ABONO"?"Abono":"Compra"}) del ${Le.date}?${Le.type==="CARGO"&&((Ae=Le.ref)!=null&&Ae.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(S(!0),Le.type==="CARGO"&&((Qe=Le.ref)!=null&&Qe.saleId)){try{await iF(Le.ref.saleId)}catch(_e){console.warn("restoreSaleAndDeleteClothes error",_e),S(!1),B(" No se pudo devolver inventario de la venta.");return}await x$(Le.ref.saleId)}else await qn(er(Pe,"ar_movements",Le.id));const fe=be.filter(_e=>{var R,Q;return Le.type==="CARGO"&&((R=Le.ref)!=null&&R.saleId)?((Q=_e.ref)==null?void 0:Q.saleId)!==Le.ref.saleId:_e.id!==Le.id});L(fe),xe(fe);const te=fe.reduce((_e,R)=>_e+(Number(R.amount)||0),0);I(_e=>_e.map(R=>R.id===(X==null?void 0:X.id)?{...R,balance:te}:R)),D(_e=>_e&&{..._e,balance:te}),B(" Movimiento eliminado")}catch(fe){console.error(fe),B(" Error al eliminar movimiento")}finally{S(!1)}},Ht=g.useMemo(()=>[...j].sort((Le,Ce)=>{var Ae,Qe;return Le.status!==Ce.status?Le.status==="BLOQUEADO"?1:-1:(((Ae=Ce.createdAt)==null?void 0:Ae.seconds)||0)-(((Qe=Le.createdAt)==null?void 0:Qe.seconds)||0)}),[j]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>he(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:_?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Ht.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):Ht.map(Le=>{var Ae;const Ce=k===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Ae=Le.createdAt)!=null&&Ae.toDate?Le.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{className:"w-full border p-1 rounded",value:O,onChange:Qe=>z(Qe.target.value)}):Le.name}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{className:"w-full border p-1 rounded",value:oe,onChange:Qe=>ce(n_(Qe.target.value))}):Le.phone}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("select",{className:"w-full border p-1 rounded",value:ue,onChange:Qe=>ge(Qe.target.value),children:[i.jsx("option",{value:"",children:""}),g$.map(Qe=>i.jsx("option",{value:Qe,children:Qe},Qe))]}):Le.place||""}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("select",{className:"w-full border p-1 rounded",value:Ue,onChange:Qe=>F(Qe.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Le.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Le.status})}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(H)?"":H,onChange:Qe=>K(Math.max(0,Number(Qe.target.value||0)))}):Th(Le.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Th(Le.balance||0)}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:ne,onChange:Qe=>Oe(Qe.target.value),maxLength:500}):i.jsx("span",{title:Le.notes||"",children:(Le.notes||"").length>40?(Le.notes||"").slice(0,40)+"":Le.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Ce?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:je,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:pe,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>yt(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>we(Le),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Ye(Le),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},Le.id)})})]})}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),Re&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>he(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>he(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:st,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:u,onChange:Le=>d(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:Le=>A(n_(Le.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Le=>m(Le.target.value),children:[i.jsx("option",{value:"",children:""}),g$.map(Le=>i.jsx("option",{value:Le,children:Le},Le))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:Le=>y(Le.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:Le=>w(Math.max(0,Number(Le.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:Le=>x(Le.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>he(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),U&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(X==null?void 0:X.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{He(0),dt(new Date().toISOString().slice(0,10)),Bt(""),De(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>W(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Th(Xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Th(Xe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Th(Xe.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:V?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):be.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):be.map(Le=>{var Ae,Qe;const Ce=Qt===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:$e,onChange:fe=>Fe(fe.target.value)}):Le.date||""}),i.jsx("td",{className:"p-2 border",children:Le.amount>=0?(Ae=Le.ref)!=null&&Ae.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(Le.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Qe=Le.ref)!=null&&Qe.saleId?`Venta #${Le.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{className:"w-full border p-1 rounded",value:ee,onChange:fe=>me(fe.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Le.comment||"",children:(Le.comment||"").length>40?(Le.comment||"").slice(0,40)+"":Le.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:Ce?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ze)?"":Ze,onChange:fe=>{const te=Number(fe.target.value||0),_e=Number.isFinite(te)?Math.max(0,parseFloat(te.toFixed(2))):0;Te(_e)},placeholder:"0.00",title:Le.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Th(Le.amount)}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:It,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Pt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xt(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Ut(Le),children:"Borrar"})]})})]},Le.id)})})]})})]})}),J&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(X==null?void 0:X.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ge,onChange:Le=>dt(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ie===0?"":ie,onChange:Le=>{const Ce=Number(Le.target.value||0),Ae=Number.isFinite(Ce)?Math.max(0,parseFloat(Ce.toFixed(2))):0;He(Ae)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:_t,onChange:Le=>Bt(Le.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[_t.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>De(!1),disabled:Ot,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Se,disabled:Ot,children:Ot?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((Le,Ce)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Le.productName}),i.jsx("td",{className:"p-2 border text-right",children:Le.qty}),i.jsx("td",{className:"p-2 border text-right",children:Th(Le.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Th(Le.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Th(Le.total)})]},Ce))})]})})]})})]})}const xx=t=>`C$ ${(Number(t)||0).toFixed(2)}`,cLe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function uLe(t){if(!t)return 0;const e=sr(bt(Pe,"inventory_clothes_batches"),Ar("productId","==",t)),r=await $t(e);let n="0000-00-00",a=-1,s=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),u=Number(l.salePrice||0),d=l.createdAt,f=((d==null?void 0:d.seconds)??0)*1e3+((d==null?void 0:d.nanoseconds)??0)/1e6;c>n?(n=c,a=f,s=u):c===n&&f>a&&(a=f,s=u)}),Number(s||0)}async function v$(t){if(!t)return 0;const e=sr(bt(Pe,"inventory_clothes_batches"),Ar("productId","==",t)),r=await $t(e);let n=0;return r.forEach(a=>n+=Number(a.data().remaining||0)),n}function y$(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function dLe({role:t="",roles:e}={role:""}){const r=e&&e.length?e:t;Sn(r,"admin"),Sn(r,"vendedor_ropa");const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState({}),[u,d]=g.useState("CONTADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(new Date().toISOString().slice(0,10)),[v,y]=g.useState(""),[b,w]=g.useState([]),j=g.useMemo(()=>b.reduce((ie,He)=>ie+(He.qty||0),0),[b]),I=g.useMemo(()=>{const ie=b.reduce((He,Ge)=>{const dt=Math.max(0,(Number(Ge.unitPrice)||0)*(Ge.qty||0)-(Number(Ge.discount)||0));return He+dt},0);return Math.floor(ie*100)/100},[b]),[_,S]=g.useState(0),[E,B]=g.useState(""),[k,P]=g.useState(!1),[O,z]=g.useState(!1),[oe,ce]=g.useState(""),[ue,ge]=g.useState("+505 "),[ne,Oe]=g.useState(""),[Ue,F]=g.useState(""),[H,K]=g.useState("ACTIVO"),[U,W]=g.useState(0),X=()=>{ce(""),ge("+505 "),Oe(""),F(""),K("ACTIVO"),W(0)};g.useEffect(()=>{(async()=>{const ie=sr(bt(Pe,"customers_clothes"),In("createdAt","desc")),He=await $t(ie),Ge=[];He.forEach(Ft=>{const $e=Ft.data();Ge.push({id:Ft.id,name:$e.name??"",phone:$e.phone??"+505 ",place:$e.place??"",status:$e.status??"ACTIVO",creditLimit:Number($e.creditLimit??0),balance:0})});for(const Ft of Ge)try{const $e=sr(bt(Pe,"ar_movements"),Ar("customerId","==",Ft.id)),Fe=await $t($e);let Ze=0;Fe.forEach(Te=>Ze+=Number(Te.data().amount||0)),Ft.balance=Ze}catch{Ft.balance=0}a(Ge);const dt=sr(bt(Pe,"products_clothes"),In("createdAt","desc")),_t=await $t(dt),Bt=[];_t.forEach(Ft=>{const $e=Ft.data();Bt.push({id:Ft.id,name:$e.name??"(sin nombre)",sku:$e.sku??""})}),o(Bt);const Ot=sr(bt(Pe,"inventory_clothes_batches"),Ar("remaining",">",0)),jt=await $t(Ot),Qt={};jt.forEach(Ft=>{const $e=Ft.data(),Fe=$e.productId||"",Ze=Number($e.remaining||0);Fe&&(Qt[Fe]=(Qt[Fe]||0)+Ze)}),c(Qt)})()},[]);const D=g.useMemo(()=>n.find(ie=>ie.id===f),[n,f]),V=(D==null?void 0:D.balance)||0,Z=u==="CREDITO"?V+Math.max(0,Number(I||0))-Math.max(0,Number(_||0)):0,be=async ie=>{if(!ie)return;if(b.some(Bt=>Bt.productId===ie)){y("");return}const He=s.find(Bt=>Bt.id===ie);if(!He){y("");return}let Ge=await uLe(ie);Ge||(Ge=Number((He==null?void 0:He.price)||0));const dt=await v$(ie),_t={productId:ie,productName:He.name||"",sku:He.sku||"",unitPrice:Number(Ge)||0,available:Number(dt)||0,qty:0,discount:0};w(Bt=>[...Bt,_t]),y("")},L=(ie,He)=>{w(Ge=>Ge.map(dt=>{if(dt.productId!==ie)return dt;if(He==="")return{...dt,qty:0};const _t=Math.max(0,Math.floor(Number(He)));return{...dt,qty:_t}}))},Xe=(ie,He)=>{w(Ge=>Ge.map(dt=>{if(dt.productId!==ie)return dt;if(He==="")return{...dt,discount:0};const _t=Math.max(0,Math.floor(Number(He)));return{...dt,discount:_t}}))},re=ie=>w(He=>He.filter(Ge=>Ge.productId!==ie)),J=async()=>{if(!p)return"Selecciona la fecha.";if(b.length===0)return"Agrega al menos un producto.";const ie=b.filter(He=>(He.qty||0)>0);if(ie.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(I>0))return"El total debe ser mayor a cero.";if(u==="CONTADO"){if(!h.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!f)return"Selecciona un cliente (crdito).";if(_<0)return"El pago inicial no puede ser negativo.";if(_>I)return"El pago inicial no puede superar el total.";if((D==null?void 0:D.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const He of ie){const Ge=await v$(He.productId);if(He.qty>Ge)return`Inventario insuficiente para "${He.productName}". Disponible: ${Ge} unidades.`;const dt=(Number(He.unitPrice)||0)*(He.qty||0),_t=Number(He.discount)||0;if(!Number.isInteger(_t)||_t<0)return`El descuento en "${He.productName}" debe ser entero y  0.`;if(_t>dt)return`El descuento en "${He.productName}" no puede exceder C$ ${dt.toFixed(2)}.`}return null},De=async ie=>{ie.preventDefault(),B("");const He=await J();if(He){B(" "+He);return}try{P(!0);const Ge=b.filter(Ot=>(Ot.qty||0)>0).map(Ot=>{const jt=(Number(Ot.unitPrice)||0)*(Ot.qty||0),Qt=Math.max(0,Math.floor(Number(Ot.discount)||0)),Ft=Math.max(0,jt-Qt);return{productId:Ot.productId,productName:Ot.productName,sku:Ot.sku||"",qty:Ot.qty,unitPrice:Number(Ot.unitPrice)||0,discount:Qt,total:Math.floor(Ft*100)/100}}),dt={type:u,date:p,createdAt:xr.now(),itemsTotal:Number(I)||0,total:Number(I)||0,quantity:Number(j)||0,items:Ge};u==="CONTADO"?dt.customerName=h.trim():(dt.customerId=f,dt.downPayment=Number(_)||0);const _t=await Zn(bt(Pe,"sales_clothes"),dt);if(u==="CREDITO"&&f){const Ot={customerId:f,date:p,createdAt:xr.now(),ref:{saleId:_t.id}};await Zn(bt(Pe,"ar_movements"),{...Ot,type:"CARGO",amount:Number(I)||0}),Number(_)>0&&await Zn(bt(Pe,"ar_movements"),{...Ot,type:"ABONO",amount:-Number(_)})}const Bt={};for(const Ot of Ge)if(Ot.qty>0){const{allocations:jt}=await oLe({productId:Ot.productId,quantity:Ot.qty,saleDate:p,saleId:_t.id});Bt[Ot.productId]={productId:Ot.productId,allocations:jt}}await Fn(er(Pe,"sales_clothes",_t.id),{allocationsByItem:Bt}),d("CONTADO"),A(""),m(""),x(new Date().toISOString().slice(0,10)),w([]),S(0),u==="CREDITO"&&f&&a(Ot=>Ot.map(jt=>jt.id===f?{...jt,balance:(jt.balance||0)+(Number(I)||0)-(Number(_)||0)}:jt)),B(" Venta registrada"),(async()=>{const Ot=sr(bt(Pe,"inventory_clothes_batches"),Ar("remaining",">",0)),jt=await $t(Ot),Qt={};jt.forEach(Ft=>{const $e=Ft.data(),Fe=$e.productId||"",Ze=Number($e.remaining||0);Fe&&(Qt[Fe]=(Qt[Fe]||0)+Ze)}),c(Qt)})()}catch(Ge){console.error(Ge),B(" Error al guardar la venta")}finally{P(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:De,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:u,onChange:ie=>d(ie.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),u==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:h,onChange:ie=>m(ie.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:f,onChange:ie=>A(ie.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),n.map(ie=>i.jsxs("option",{value:ie.status==="ACTIVO"?ie.id:"",disabled:ie.status==="BLOQUEADO",children:[ie.name," | ",ie.phone," | Saldo: ",xx(ie.balance||0)]},ie.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>z(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:xx(V)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:_===0?"":_,onChange:ie=>S(Math.max(0,Number(ie.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:xx(Z)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:p,onChange:ie=>x(ie.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:async ie=>{const He=ie.target.value;y(He),await be(He)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),s.map(ie=>{const He=b.some(_t=>_t.productId===ie.id),Ge=l[ie.id]||0,dt=He||Ge<=0;return i.jsxs("option",{value:dt?"":ie.id,disabled:dt,children:[ie.name," ",ie.sku?` ${ie.sku}`:""," ",Ge>0?`(disp: ${Ge})`:"(sin stock)",He?" (seleccionado)":""]},ie.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),b.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):b.map(ie=>{const He=Math.max(0,(ie.available||0)-(ie.qty||0)),Ge=(Number(ie.unitPrice)||0)*(ie.qty||0),dt=Math.max(0,Ge-(Number(ie.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[ie.productName,ie.sku?`  ${ie.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:xx(ie.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:He}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ie.qty)||ie.qty===0?"":ie.qty,onChange:_t=>L(ie.productId,_t.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ie.discount)||ie.discount===0?"":ie.discount,onChange:_t=>Xe(ie.productId,_t.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:xx(dt)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>re(ie.productId),title:"Quitar producto",children:""})})]},ie.productId)})]}),b.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:j})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:xx(I)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:k,children:k?"Guardando...":"Registrar venta"})})]}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:oe,onChange:ie=>ce(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ue,onChange:ie=>ge(y$(ie.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ne,onChange:ie=>Oe(ie.target.value),children:[i.jsx("option",{value:"",children:""}),cLe.map(ie=>i.jsx("option",{value:ie,children:ie},ie))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:H,onChange:ie=>K(ie.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:U===0?"":U,onChange:ie=>W(Math.max(0,Number(ie.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ue,onChange:ie=>F(ie.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{X(),z(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(B(""),!oe.trim()){B("Ingresa el nombre del nuevo cliente.");return}const ie=y$(ue);try{const He=await Zn(bt(Pe,"customers_clothes"),{name:oe.trim(),phone:ie,place:ne||"",notes:Ue||"",status:H,creditLimit:Number(U||0),createdAt:xr.now()}),Ge={id:He.id,name:oe.trim(),phone:ie,place:ne||"",status:H,creditLimit:Number(U||0),balance:0};a(dt=>[Ge,...dt]),A(He.id),X(),z(!1),B(" Cliente creado")}catch(He){console.error(He),B(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),k&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const go=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function gE(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function fLe(t,e){const r=gE(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},a=Number(t.quantity??n.qty??0),s=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??s??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:a,unitPrice:Number(n.unitPrice??(s&&a?s/a:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function hLe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}function ALe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),[P,O]=g.useState(!1),[z,oe]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});g.useEffect(()=>{(async()=>{b(!0),j("");try{const F=await $t(bt(Pe,"sales_clothes")),H=[],K=[];F.forEach(re=>{const J=re.data(),De=fLe(J,re.id);De&&(De.date<=a&&H.push(De),De.date>=r&&De.date<=a&&K.push(De))}),u(H),l(K);const U=await $t(bt(Pe,"inventory_clothes_batches")),W=[];U.forEach(re=>{const J=re.data(),De=gE(J);!De||De>a||W.push({id:re.id,productId:J.productId,productName:J.productName||"",date:De,quantity:Number(J.quantity||0),remaining:Number(J.remaining||0),purchasePrice:Number(J.purchasePrice||0)})}),f(W);const X=await $t(bt(Pe,"expenses_clothes")),D=[];X.forEach(re=>{const J=re.data(),De=gE(J);De&&De>=r&&De<=a&&D.push({id:re.id,date:De,category:J.category||"",description:J.description||"",amount:Number(J.amount||0),status:J.status||""})}),h(D);const V=await $t(bt(Pe,"ar_movements")),Z=[],be={};V.forEach(re=>{const J=re.data(),De=gE(J);if(!De)return;const ie=J.customerId,He=Number(J.amount||0);ie&&(be[ie]=(be[ie]||0)+He),J.type==="ABONO"&&De>=r&&De<=a&&Z.push({id:re.id,customerId:ie,type:"ABONO",amount:He,date:De})}),p(Z);const L=await $t(bt(Pe,"customers_clothes")),Xe=[];L.forEach(re=>{const J=re.data();Xe.push({id:re.id,name:J.name||"",balance:be[re.id]||0})}),v(Xe)}catch(F){console.error(F),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ce=g.useMemo(()=>{try{return hLe(d,c,r,a)}catch(F){return console.error(F),0}},[d,c,r,a]),ue=g.useMemo(()=>{const F=o.reduce((be,L)=>be+(L.total||0),0),H=A.reduce((be,L)=>be+(L.amount||0),0),K=F-ce,U=K-H,W=m.reduce((be,L)=>be+Math.abs(L.amount||0),0),X=x.filter(be=>(be.balance||0)>0),D=X.reduce((be,L)=>be+(L.balance||0),0);let V=0,Z=0;for(const be of o){const L=(be.items||[]).reduce((Xe,re)=>Xe+(Number(re.qty)||0),0);be.type==="CONTADO"?V+=L:Z+=L}return{ventasTotales:F,costoMercaderia:ce,gastosPeriodo:H,gananciaAntes:K,gananciaDespues:U,abonosRecibidos:W,saldosPendientes:D,clientesConSaldo:X.length,prendasCash:V,prendasCredito:Z}},[o,A,m,x,ce]),ge=g.useMemo(()=>{const F={};for(const H of o){if(H.type!=="CREDITO"||!H.customerId)continue;const K=(H.items||[]).reduce((U,W)=>U+(Number(W.qty)||0),0);F[H.customerId]=(F[H.customerId]||0)+K}return x.filter(H=>(H.balance||0)>0).map(H=>({customerId:H.id,name:H.name,prendasCredito:F[H.id]||0,saldo:H.balance||0})).sort((H,K)=>K.saldo-H.saldo)},[x,o]),ne=g.useMemo(()=>{const F={};return x.forEach(H=>F[H.id]=H.name),F},[x]),Oe=g.useMemo(()=>[...o].sort((F,H)=>H.date.localeCompare(F.date)).map(F=>{var U;const H=(F.items||[]).reduce((W,X)=>W+(Number(X.qty)||0),0);let K="Cash";return F.type==="CREDITO"&&F.customerId?K=ne[F.customerId]||"":F.type==="CONTADO"&&(K=((U=F.customerName)==null?void 0:U.trim())||"Cash"),{id:F.id,date:F.date,type:F.type==="CREDITO"?"Crdito":"Cash",customer:K,piezas:H,total:Number(F.total||0)}}),[o,ne]),Ue=async F=>{_(!0),E({id:F.customerId,name:F.name}),k([]),O(!0),oe({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const H=[];let K=0,U=0,W=0;for(const Z of o)if(!(Z.type!=="CREDITO"||Z.customerId!==F.customerId))for(const be of Z.items||[]){const L=Number(be.qty||0),Xe=Number(be.unitPrice||0),re=L*Xe,J=Math.max(0,Number(be.discount||0)),De=Math.max(0,re-J);H.push({saleId:Z.id,date:Z.date,productName:be.productName,sku:be.sku||"",qty:L,unitPrice:Xe,lineTotal:re,discount:J,lineFinal:De}),K+=re,U+=J,W+=De}let X=0;for(const Z of m)Z.customerId===F.customerId&&(X+=Math.abs(Z.amount||0));const D=x.find(Z=>Z.id===F.customerId),V=(D==null?void 0:D.balance)||0;k(H),oe({totalBruto:K,totalDescuento:U,totalFiado:W,saldoActual:V,abonadoPeriodo:X})}catch(H){console.error(H),j(" No se pudo cargar el detalle del cliente.")}finally{O(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(Oc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:F=>n(F.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:F=>s(F.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:go(ue.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:go(ue.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:ue.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ue.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:ue.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):ge.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):ge.map(F=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ue({customerId:F.customerId,name:F.name}),title:"Ver piezas fiadas del periodo",children:F.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:go(F.saldo)})]},F.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):Oe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):Oe.map(F=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.date}),i.jsx("td",{className:"p-2 border",children:F.customer}),i.jsx("td",{className:"p-2 border",children:F.type}),i.jsx("td",{className:"p-2 border",children:F.piezas}),i.jsx("td",{className:"p-2 border",children:go(F.total)})]},F.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((F,H)=>F.date.localeCompare(H.date)).map(F=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.date}),i.jsx("td",{className:"p-2 border",children:F.category||""}),i.jsx("td",{className:"p-2 border",children:F.description?i.jsx("span",{title:F.description,children:F.description.length>40?F.description.slice(0,40)+"":F.description}):""}),i.jsx("td",{className:"p-2 border",children:go(F.amount)}),i.jsx("td",{className:"p-2 border",children:F.status||""})]},F.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(S==null?void 0:S.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>_(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):B.sort((F,H)=>F.date.localeCompare(H.date)).map((F,H)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.date}),i.jsx("td",{className:"p-2 border",children:F.productName}),i.jsx("td",{className:"p-2 border",children:F.sku||""}),i.jsx("td",{className:"p-2 border",children:F.qty}),i.jsx("td",{className:"p-2 border",children:go(F.unitPrice)}),i.jsx("td",{className:"p-2 border",children:go(F.lineTotal)}),i.jsx("td",{className:"p-2 border",children:go(F.discount)}),i.jsx("td",{className:"p-2 border",children:go(F.lineFinal)})]},`${F.saleId}-${H}`))})]})})]})})]})}const b$=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],a_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function mLe(){const[t,e]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[P,O]=g.useState(""),[z,oe]=g.useState(0),[ce,ue]=g.useState("PENDIENTE"),[ge,ne]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(bt(Pe,"expenses_clothes"),In("date","desc")),V=await $t(D),Z=[];V.forEach(be=>{const L=be.data();Z.push({id:be.id,date:L.date||Ur(new Date,"yyyy-MM-dd"),category:L.category||"",description:L.description||"",amount:Number(L.amount||0),status:L.status||"PENDIENTE",notes:L.notes||"",createdAt:L.createdAt??xr.now()})}),v(Z)}catch(D){console.error(D),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Oe=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Ue=g.useMemo(()=>{const D=Oe.reduce((be,L)=>be+(L.amount||0),0),V=Oe.filter(be=>be.status==="PAGADO").reduce((be,L)=>be+(L.amount||0),0),Z=D-V;return{total:D,pagado:V,pendiente:Z}},[Oe]),F=()=>{s(Ur(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const V=await Zn(bt(Pe,"expenses_clothes"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()});v(Z=>[{id:V.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()},...Z]),F(),j(" Gasto registrado")}catch(V){console.error(V),j(" Error al guardar gasto")}},K=D=>{_(D.id),E(D.date),k(D.category||""),O(D.description||""),oe(Number(D.amount||0)),ue(D.status||"PENDIENTE"),ne(D.notes||"")},U=()=>{_(null),E(""),k(""),O(""),oe(0),ue("PENDIENTE"),ne("")},W=async()=>{if(I){if(!B){j("Selecciona una categora.");return}if(!P.trim()){j("Ingresa una descripcin.");return}if(!z||z<=0){j("Ingresa un monto vlido.");return}try{await Fn(er(Pe,"expenses_clothes",I),{date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:ce,notes:ge||""}),v(D=>D.map(V=>V.id===I?{...V,date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:ce,notes:ge||""}:V)),U(),j(" Gasto actualizado")}catch(D){console.error(D),j(" Error al actualizar gasto")}}},X=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await qn(er(Pe,"expenses_clothes",D.id)),v(Z=>Z.filter(be=>be.id!==D.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",a_(Ue.total)]}),i.jsxs("div",{children:["Pagado: ",a_(Ue.pagado)]}),i.jsxs("div",{children:["Pendiente: ",a_(Ue.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),b$.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Oe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Oe.slice().sort((D,V)=>D.date.localeCompare(V.date)).map(D=>{const V=I===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:Z=>E(Z.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:Z=>k(Z.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),b$.map(Z=>i.jsx("option",{value:Z,children:Z},Z))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:Z=>O(Z.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(z)?"":z,onChange:Z=>oe(Math.max(0,Number(Z.target.value||0)))}):a_(D.amount)}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:ce,onChange:Z=>ue(Z.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:ge,onChange:Z=>ne(Z.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:V?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:W,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:U,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>K(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>X(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const Yd=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function pLe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):""}function gLe(t,e){const r=pLe(t);if(!r)return null;const n=t.item||{},a=Number((n==null?void 0:n.qty)??t.quantity??0)||0,s=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(a>0?s/a:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||a||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:a,unitPrice:o,total:a*o}}}async function xLe(t,e){if(e<=0)return;const r=sr(bt(Pe,"inventory_clothes_batches"),Ar("productId","==",t)),n=await $t(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,s);s-=l,await Fn(er(Pe,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}s>0&&console.warn("consumeFIFO: falt inventario",s)}async function vLe(t,e){if(e<=0)return;const r=sr(bt(Pe,"inventory_clothes_batches"),Ar("productId","==",t)),n=await $t(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,s);s-=c,await Fn(er(Pe,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}s>0&&console.warn("restoreFIFO: no se devolvi todo",s)}async function gse(t){const e=sr(bt(Pe,"ar_movements"),Ar("ref.saleId","==",t)),r=await $t(e);await Promise.all(r.docs.map(n=>qn(er(Pe,"ar_movements",n.id))))}async function yLe(t,e,r){if(await gse(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:xr.now(),ref:{saleId:t.id}},{addDoc:a}=await iA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>Xye);return{addDoc:o}},void 0);await a(bt(Pe,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const s=Math.max(0,Number(r??t.downPayment??0));s>0&&await a(bt(Pe,"ar_movements"),{...n,type:"ABONO",amount:-s})}function bLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async re=>{e(!0),n(!0),s(re),l([]);try{const De=(await $t(sr(bt(Pe,"sales_clothes"),Ar("__name__","==",re)))).docs[0],ie=De==null?void 0:De.data(),Ge=(Array.isArray(ie==null?void 0:ie.items)?ie.items:ie!=null&&ie.item?[ie.item]:[]).map(dt=>({productName:String(dt.productName||""),qty:Number(dt.qty||0),unitPrice:Number(dt.unitPrice||0),discount:Number(dt.discount||0),total:Number(dt.total||0)}));l(Ge)}catch(J){console.error(J)}finally{n(!1)}},[u,d]=g.useState(Ur(new Date,"yyyy-MM-01")),[f,A]=g.useState(Ur(new Date,"yyyy-MM-dd")),[h,m]=g.useState([]),[p,x]=g.useState([]),[v,y]=g.useState(!0),[b,w]=g.useState(""),[j,I]=g.useState(""),[_,S]=g.useState(""),[E,B]=g.useState(null),[k,P]=g.useState(!1),[O,z]=g.useState(null),[oe,ce]=g.useState(0),ue=15,[ge,ne]=g.useState(1),Oe=g.useMemo(()=>{const re={};return h.forEach(J=>re[J.id]=J.name),re},[h]);g.useEffect(()=>{(async()=>{y(!0),w("");try{const re=await $t(bt(Pe,"customers_clothes")),J=[];re.forEach(He=>J.push({id:He.id,name:He.data().name||""})),m(J);const De=await $t(sr(bt(Pe,"sales_clothes"),In("createdAt","desc"))),ie=[];De.forEach(He=>{const Ge=gLe(He.data(),He.id);Ge&&Ge.date>=u&&Ge.date<=f&&ie.push(Ge)}),x(ie.sort((He,Ge)=>Ge.date.localeCompare(He.date))),ne(1)}catch(re){console.error(re),w(" Error cargando transacciones.")}finally{y(!1)}})()},[u,f]);const Ue=g.useMemo(()=>p.filter(re=>!(j&&re.customerId!==j||_&&re.type!==_)),[p,j,_]),F=g.useMemo(()=>{let re=0,J=0,De=0,ie=0;for(const He of Ue)He.type==="CONTADO"?(re+=He.item.qty,De+=He.total):(J+=He.item.qty,ie+=He.total);return{piezasCash:re,piezasCredito:J,montoCash:De,montoCredito:ie}},[Ue]),H=Math.max(1,Math.ceil(Ue.length/ue)),K=g.useMemo(()=>{const re=(ge-1)*ue;return Ue.slice(re,re+ue)},[Ue,ge]),U=re=>{B(null),z(re),ce(re.item.qty||0),P(!0)},W=async re=>{if(B(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await iF(re.id),await gse(re.id),x(J=>J.filter(De=>De.id!==re.id)),w(" Venta eliminada")}catch(J){console.error(J),w(" No se pudo eliminar la venta.")}finally{y(!1)}},X=async()=>{if(!O)return;const re=Number(O.item.qty||0),J=Math.max(1,Math.floor(Number(oe)||0));if(J===re){P(!1);return}const De=Number(O.item.unitPrice||0),ie=Number((De*J).toFixed(2));try{y(!0);const He=J-re;He>0?await xLe(O.item.productId,He):He<0&&await vLe(O.item.productId,-He);const Ge=er(Pe,"sales_clothes",O.id);await Fn(Ge,{quantity:J,total:ie,itemsTotal:ie,"item.qty":J,"item.total":ie,updatedAt:xr.now()});const dt=Math.min(Number(O.downPayment||0),ie);await yLe(O,ie,dt),x(_t=>_t.map(Bt=>Bt.id===O.id?{...Bt,quantity:J,total:ie,item:{...Bt.item,qty:J,total:ie},downPayment:dt}:Bt)),w(" Venta actualizada"),P(!1)}catch(He){console.error(He),w(" No se pudo actualizar la venta.")}finally{y(!1)}},D=()=>{const re=`Reporte de transacciones (Ropa)  ${u} a ${f}`,J=Ge=>(Ge||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),De=Ue.map(Ge=>{const dt=Ge.customerName||(Ge.customerId?Oe[Ge.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Ge.date}</td>
          <td>${J(dt)}</td>
          <td>${Ge.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ge.item.qty}</td>
          <td style="text-align:right">${Yd(Ge.total)}</td>
        </tr>`}).join(""),ie=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${J(re)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${J(re)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${F.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${F.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${Yd(F.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Yd(F.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${De||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,He=window.open("","_blank");He&&(He.document.open(),He.document.write(ie),He.document.close())},V=()=>ne(1),Z=()=>ne(re=>Math.max(1,re-1)),be=()=>ne(re=>Math.min(H,re+1)),L=()=>ne(H),Xe=()=>{const re=[];if(H<=7)for(let De=1;De<=H;De++)re.push(De);else{const De=Math.max(1,ge-2),ie=Math.min(H,ge+2);re.push(1),De>2&&re.push(-1);for(let He=De;He<=ie;He++)He!==1&&He!==H&&re.push(He);ie<H-1&&re.push(-2),re.push(H)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:V,disabled:ge===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Z,disabled:ge===1,children:" Anterior"}),re.map((De,ie)=>typeof De=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${De===ge?"bg-blue-600 text-white":""}`,onClick:()=>ne(De),children:De},ie):i.jsx("span",{className:"px-2",children:""},ie)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:be,disabled:ge===H,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:L,disabled:ge===H,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",ge," de ",H,"  ",Ue.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:re=>{d(re.target.value),ne(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:re=>{A(re.target.value),ne(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:j,onChange:re=>{I(re.target.value),ne(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(re=>i.jsx("option",{value:re.id,children:re.name},re.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:_,onChange:re=>{S(re.target.value),ne(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:F.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:F.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Yd(F.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Yd(F.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:v?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):K.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):K.map(re=>{const J=re.customerName||(re.customerId?Oe[re.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:re.date}),i.jsx("td",{className:"p-2 border",children:J}),i.jsx("td",{className:"p-2 border",children:re.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(re.id),children:re.item.qty})}),i.jsx("td",{className:"p-2 border",children:Yd(re.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>B(De=>De===re.id?null:re.id),title:"Acciones",children:""}),E===re.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>U(re),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>W(re),children:"Eliminar"})]})]})]},re.id)})})]}),Xe()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),k&&O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[O.item.productName," ",O.item.sku?` ${O.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:oe,onChange:re=>ce(Math.max(1,Math.floor(Number(re.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:Yd(O.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:Yd(Number(O.item.unitPrice)*Number(oe||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{P(!1),z(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:X,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((re,J)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:re.productName}),i.jsx("td",{className:"p-2 border text-right",children:re.qty}),i.jsx("td",{className:"p-2 border text-right",children:Yd(re.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Yd(re.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Yd(re.total)})]},J))})]})})]})})]})}const w$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],$c=t=>`C$ ${(Number(t)||0).toFixed(2)}`,p0=t=>Math.round((Number(t)||0)*100)/100,wLe=new Set(["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"]),xy=t=>{const e=String(t||"").trim().toUpperCase();return wLe.has(e)?"PAGADA":"PENDIENTE"};function s_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function N$(t){const e=sr(bt(Pe,"ar_movements_pollo"),Ar("ref.saleId","==",t)),r=await $t(e);await Promise.all(r.docs.map(n=>qn(er(Pe,"ar_movements_pollo",n.id))))}function NLe({role:t="",roles:e,sellerPolloId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=Sn(a,"vendedor_pollo"),l=Sn(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(!1),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),P=async de=>{var tt;j(!0),_(!0),E(de),k([]);try{const at=await zs(er(Pe,"salesV2",de));let ct=null;if(at.exists()?ct=at.data():ct=(tt=(await $t(sr(bt(Pe,"salesV2"),Ar("name","==",de)))).docs[0])==null?void 0:tt.data(),!ct){k([]);return}let ye=[];if(Array.isArray(ct.items)&&ct.items.length>0)ye=ct.items;else if(ct.items&&typeof ct.items=="object")try{ye=Object.values(ct.items)}catch{ye=[]}else ct.item?ye=[ct.item]:Array.isArray(ct.products)&&ct.products.length>0?ye=ct.products:Array.isArray(ct.lines)&&ct.lines.length>0?ye=ct.lines:Array.isArray(ct.detalles)&&ct.detalles.length>0?ye=ct.detalles:(ct.productName||ct.product)&&(ye=[{productName:ct.productName||ct.product||"",qty:ct.qty??ct.quantity??ct.lbs??0,unitPrice:ct.unitPrice??ct.price??0,discount:ct.discount??0,total:ct.total??ct.amount??0}]);const ft=Mt=>{if(Mt==null)return NaN;if(typeof Mt=="number")return Mt;let Xt=String(Mt).trim();if(!Xt)return NaN;if(Xt=Xt.replace(/[^0-9.,-]/g,""),!Xt)return NaN;Xt.indexOf(".")>-1&&Xt.indexOf(",")>-1?Xt=Xt.replace(/,/g,""):Xt.indexOf(",")>-1&&Xt.indexOf(".")===-1&&(Xt=Xt.replace(/,/g,"."));const ar=Number(Xt);return Number.isNaN(ar)?NaN:ar},St=new Set;for(const Mt of ye)if(Array.isArray(Mt==null?void 0:Mt.allocations))for(const Xt of Mt.allocations){const ar=String((Xt==null?void 0:Xt.batchId)||"").trim();ar&&St.add(ar)}else if(Mt!=null&&Mt.allocations&&typeof Mt.allocations=="object")try{for(const Xt of Object.values(Mt.allocations)){const ar=String((Xt==null?void 0:Xt.batchId)||"").trim();ar&&St.add(ar)}}catch{}if(Array.isArray(ct==null?void 0:ct.allocations))for(const Mt of ct.allocations){const Xt=String((Mt==null?void 0:Mt.batchId)||"").trim();Xt&&St.add(Xt)}const wt={};St.size>0&&await Promise.all(Array.from(St).map(async Mt=>{try{const Xt=await zs(er(Pe,"inventory_batches",Mt));if(Xt.exists()){const ar=Xt.data();wt[Mt]=Number(ar.salePrice??ar.sale_price??ar.price??0)}}catch{}}));const vt=new Set;for(const Mt of ye){const Xt=String(Mt.productId||"").trim();Xt&&vt.add(Xt)}const Et={};vt.size>0&&await Promise.all(Array.from(vt).map(async Mt=>{try{const Xt=await zs(er(Pe,"products",Mt));if(Xt.exists()){const ar=Xt.data();Et[Mt]=Number(ar.salePrice??ar.price??0)}}catch{}}));const qt=ye.map(Mt=>{const Xt=String(Mt.productName||Mt.product||Mt.name||"(sin nombre)"),ar=Number(Mt.qty??Mt.quantity??Mt.lbs??Mt.weight??0)||0,vr=ft(Mt.total??Mt.lineFinal??Mt.amount??Mt.monto??Mt.line_total)||0;let ur=0;const Dt=[Mt.unitPrice,Mt.unitPricePackage,Mt.salePrice,Mt.sale_price,Mt.price,Mt.unit_price,Mt.pricePerUnit,Mt.price_per_unit];for(const Sr of Dt){const pr=ft(Sr);if(!Number.isNaN(pr)&&pr!==0){ur=pr;break}}if(!ur){const Sr=(ct==null?void 0:ct.salePrice)??(ct==null?void 0:ct.sale_price)??(ct==null?void 0:ct.unitPrice)??(ct==null?void 0:ct.unit_price)??(ct==null?void 0:ct.price)??(ct==null?void 0:ct.pricePerUnit),pr=ft(Sr);!Number.isNaN(pr)&&pr!==0&&(ur=pr)}if(!ur){const Sr=Array.isArray(Mt.allocations)?Mt.allocations[0]:Mt.allocations&&typeof Mt.allocations=="object"?Object.values(Mt.allocations)[0]:null,pr=Sr?String(Sr.batchId||"").trim():"";pr&&wt[pr]&&(ur=wt[pr]||0)}!ur&&Mt.productId&&(ur=Et[String(Mt.productId)]||0),(!ur||ur===0)&&vr>0&&ar>0&&(ur=vr/ar);const Yr=ft(Mt.discount??Mt.desc??0)||0;let Vr=vr;return(!Vr||Vr===0)&&(Vr=Number(ur*ar||0)),Vr=Number(Vr)||0,{productName:Xt,qty:ar,unitPrice:ur,discount:Yr,total:Vr}});k(qt)}catch(at){console.error(at)}finally{_(!1)}},[O,z]=g.useState(""),[oe,ce]=g.useState("+505 "),[ue,ge]=g.useState(""),[ne,Oe]=g.useState(""),[Ue,F]=g.useState("ACTIVO"),[H,K]=g.useState(0),[U,W]=g.useState(""),[X,D]=g.useState(0),[V,Z]=g.useState([]),[be,L]=g.useState(!0),[Xe,re]=g.useState(""),[J,De]=g.useState(null),[ie,He]=g.useState(""),[Ge,dt]=g.useState("+505 "),[_t,Bt]=g.useState(""),[Ot,jt]=g.useState(""),[Qt,Ft]=g.useState("ACTIVO"),[$e,Fe]=g.useState(0),[Ze,Te]=g.useState(""),[ee,me]=g.useState(!1),[Re,he]=g.useState(null),[qe,st]=g.useState(!1),[yt,pe]=g.useState([]),[je,we]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[Ye,xe]=g.useState(!1),[Se,xt]=g.useState(0),[Pt,It]=g.useState(new Date().toISOString().slice(0,10)),[Ut,Ht]=g.useState(""),[Le,Ce]=g.useState(!1),[Ae,Qe]=g.useState(null),[fe,te]=g.useState(""),[_e,R]=g.useState(0),[Q,G]=g.useState(""),[se,Ne]=g.useState(null),[Me,ze]=g.useState(!1),[Ie,nt]=g.useState(null),[lt,ht]=g.useState(!1),[kt,le]=g.useState(!1),[We,it]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(L(!0),o&&!s){Z([]),re(" Este usuario no tiene vendedor asociado (sellerPolloId vaco).");return}const de=await $t(bt(Pe,"sellers_candies")),tt=[];de.forEach(ft=>{const St=ft.data();tt.push({id:ft.id,name:String(St.name||"")})}),u(tt);const at=o?sr(bt(Pe,"customers_pollo"),Ar("vendorId","==",s),In("createdAt","desc")):sr(bt(Pe,"customers_pollo"),In("createdAt","desc")),ct=await $t(at),ye=[];ct.forEach(ft=>{const St=ft.data();ye.push({id:ft.id,name:St.name??"",phone:St.phone??"+505 ",place:St.place??"",notes:St.notes??"",status:St.status??"ACTIVO",creditLimit:Number(St.creditLimit??0),createdAt:St.createdAt??xr.now(),balance:0,vendorId:St.vendorId||"",vendorName:St.vendorName||"",initialDebt:Number(St.initialDebt||0),lastAbonoDate:"",lastAbonoAmount:0})});for(const ft of ye)try{const St=sr(bt(Pe,"ar_movements_pollo"),Ar("customerId","==",ft.id)),wt=await $t(St);let vt=0,Et=null,qt=!1;wt.forEach(vr=>{var Yr,Vr,Sr;const ur=vr.data(),Dt=Number(ur.amount||0);if(vt+=Dt,Dt>0&&xy(ur.debtStatus??ur.creditStatus??ur.cycleStatus??ur.status)==="PENDIENTE"&&(qt=!0),Dt<0){const pr=ur.date??((Vr=(Yr=ur.createdAt)==null?void 0:Yr.toDate)!=null&&Vr.call(Yr)?ur.createdAt.toDate().toISOString().slice(0,10):""),jr=(Sr=ur.createdAt)!=null&&Sr.seconds?Number(ur.createdAt.seconds):0;(!Et||jr>=Et.ts)&&(Et={date:pr,amount:Math.abs(Dt),ts:jr})}});const Mt=Number(ft.initialDebt||0),Xt=p0(Mt+vt);ft.balance=Xt,(qt||Xt>0)&&Et?(ft.lastAbonoDate=Et.date,ft.lastAbonoAmount=Et.amount):(ft.lastAbonoDate="",ft.lastAbonoAmount=0)}catch{ft.balance=Number(ft.initialDebt||0),ft.lastAbonoDate="",ft.lastAbonoAmount=0}Z(ye)}catch(de){console.error(de),re(" Error cargando clientes.")}finally{L(!1)}})()},[o,s]);const ot=()=>{z(""),ce("+505 "),ge(""),Oe(""),F("ACTIVO"),K(0),W(""),D(0)},Nt=async de=>{var ye;if(de.preventDefault(),re(""),!O.trim()){re("Ingresa el nombre.");return}const tt=s_(oe);if(tt.length<6){re("Telfono incompleto.");return}const at=o?s:String(U||""),ct=at&&((ye=c.find(ft=>ft.id===at))==null?void 0:ye.name)||"";try{const ft=Number(X||0),St=await Zn(bt(Pe,"customers_pollo"),{name:O.trim(),phone:tt,place:ue||"",notes:ne||"",status:Ue,creditLimit:Number(H||0),vendorId:at,vendorName:ct,initialDebt:ft,createdAt:xr.now()});Z(wt=>[{id:St.id,name:O.trim(),phone:tt,place:ue||"",notes:ne||"",status:Ue,creditLimit:Number(H||0),vendorId:at,vendorName:ct,initialDebt:ft,createdAt:xr.now(),balance:ft,lastAbonoDate:"",lastAbonoAmount:0},...wt]),ot(),ze(!1),re(" Cliente creado")}catch(ft){console.error(ft),re(" Error al crear cliente")}},Rt=de=>{if(o){re(" No permitido: vendedores no editan clientes desde el listado.");return}De(de.id),He(de.name),dt(de.phone||"+505 "),Bt(de.place||""),jt(de.notes||""),Ft(de.status||"ACTIVO"),Fe(Number(de.creditLimit||0)),Te(String(de.vendorId||""))},nr=()=>{De(null),He(""),dt("+505 "),Bt(""),jt(""),Ft("ACTIVO"),Fe(0),Te("")},_r=async()=>{var St;if(o){re(" No permitido.");return}if(!J)return;const de=s_(Ge);if(!ie.trim()){re("Ingresa el nombre.");return}const tt=V.find(wt=>wt.id===J),at=String((tt==null?void 0:tt.vendorId)||""),ct=o?s:String(Ze||"");if(o&&at&&at!==s){re(" Este cliente pertenece a otro vendedor.");return}if(l&&at&&ct&&at!==ct){re(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const ye=o?s:String(Ze||""),ft=ye&&((St=c.find(wt=>wt.id===ye))==null?void 0:St.name)||"";try{await Fn(er(Pe,"customers_pollo",J),{name:ie.trim(),phone:de,place:_t||"",notes:Ot||"",status:Qt,creditLimit:Number($e||0),vendorId:ye,vendorName:ft}),Z(wt=>wt.map(vt=>vt.id===J?{...vt,name:ie.trim(),phone:de,place:_t||"",notes:Ot||"",status:Qt,creditLimit:Number($e||0),vendorId:ye,vendorName:ft}:vt)),nr(),re(" Cliente actualizado")}catch(wt){console.error(wt),re(" Error al actualizar")}},$r=async de=>{if(confirm(`Eliminar al cliente "${de.name}"?
Se borrarn todas sus ventas y movimientos.`))try{L(!0);const at=sr(bt(Pe,"salesV2"),Ar("customerId","==",de.id)),ct=await $t(at);for(const St of ct.docs){const wt=St.id;try{await qn(er(Pe,"salesV2",wt))}catch(vt){console.warn("delete sale error",vt)}await N$(wt)}const ye=sr(bt(Pe,"ar_movements_pollo"),Ar("customerId","==",de.id)),ft=await $t(ye);await Promise.all(ft.docs.map(St=>qn(er(Pe,"ar_movements_pollo",St.id)))),await qn(er(Pe,"customers_pollo",de.id)),Z(St=>St.filter(wt=>wt.id!==de.id)),re(" Cliente eliminado y registros borrados")}catch(at){console.error(at),re(" No se pudo eliminar el cliente.")}finally{L(!1)}},or=(de,tt)=>{const at=de.reduce((St,wt)=>St+(Number(wt.amount)||0),0),ct=de.filter(St=>Number(St.amount)<0).reduce((St,wt)=>St+Math.abs(Number(wt.amount)||0),0),ye=de.filter(St=>Number(St.amount)>0).reduce((St,wt)=>St+(Number(wt.amount)||0),0),ft=Number(tt||0)+at;we({saldoActual:ft,totalAbonado:ct,totalCargos:Number(tt||0)+ye,saldoRestante:ft})},kr=async de=>{he(de),pe([]),we({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),me(!0),ht(!1),le(!1),it(null),xe(!1),xt(0),It(new Date().toISOString().slice(0,10)),Ht(""),Qe(null),st(!0);try{const tt=sr(bt(Pe,"ar_movements_pollo"),Ar("customerId","==",de.id)),at=await $t(tt),ct=[];at.forEach(ye=>{var vt,Et;const ft=ye.data(),St=ft.date??((Et=(vt=ft.createdAt)==null?void 0:vt.toDate)!=null&&Et.call(vt)?ft.createdAt.toDate().toISOString().slice(0,10):""),wt=Number(ft.amount||0);ct.push({id:ye.id,date:St,type:ft.type??(wt<0?"ABONO":"CARGO"),amount:wt,ref:ft.ref||{},comment:ft.comment||"",createdAt:ft.createdAt,debtStatus:xy(ft.debtStatus??ft.creditStatus??ft.cycleStatus??ft.status)})}),ct.sort((ye,ft)=>{var vt,Et;if(ye.date!==ft.date)return ye.date.localeCompare(ft.date);const St=((vt=ye.createdAt)==null?void 0:vt.seconds)||0,wt=((Et=ft.createdAt)==null?void 0:Et.seconds)||0;return St-wt}),pe(ct),or(ct,Number(de.initialDebt||0))}catch(tt){console.error(tt),re(" No se pudo cargar el estado de cuenta")}finally{st(!1)}},en=(de,tt)=>p0(tt||0)>0?!0:de.some(at=>at.type==="CARGO"&&xy(at.debtStatus)==="PENDIENTE"),rn=de=>{const tt=de.filter(at=>Number(at.amount)<0).map(at=>{var ct;return{date:at.date,amount:Math.abs(Number(at.amount||0)),ts:((ct=at.createdAt)==null?void 0:ct.seconds)||0}}).sort((at,ct)=>(at.ts||0)-(ct.ts||0));return tt.length?tt[tt.length-1]:null},Er=async()=>{if(!Re)return;re("");const de=Number(Se||0);if(!(de>0)){re("Ingresa un monto de abono mayor a 0.");return}const tt=parseFloat(de.toFixed(2));if(!Pt){re("Selecciona la fecha del abono.");return}try{Ce(!0);const at={customerId:Re.id,type:"ABONO",amount:-tt,date:Pt,comment:Ut||"",createdAt:xr.now()},ye={id:(await Zn(bt(Pe,"ar_movements_pollo"),at)).id,date:Pt,type:"ABONO",amount:-tt,comment:Ut||"",createdAt:xr.now()},ft=[...yt,ye].sort((Et,qt)=>{var ar,vr;if(Et.date!==qt.date)return Et.date.localeCompare(qt.date);const Mt=((ar=Et.createdAt)==null?void 0:ar.seconds)||0,Xt=((vr=qt.createdAt)==null?void 0:vr.seconds)||0;return Mt-Xt});pe(ft),or(ft,Number(Re.initialDebt||0));const St=ft.reduce((Et,qt)=>Et+(Number(qt.amount)||0),0),wt=p0(Number(Re.initialDebt||0)+St),vt=en(ft,wt);Z(Et=>Et.map(qt=>{if(qt.id!==Re.id)return qt;const Mt=p0((qt.balance||0)-tt);return{...qt,balance:Mt,lastAbonoDate:vt?Pt:"",lastAbonoAmount:vt?tt:0}})),he(Et=>Et&&{...Et,balance:p0((Et.balance||0)-tt),lastAbonoDate:vt?Pt:"",lastAbonoAmount:vt?tt:0}),xt(0),Ht(""),It(new Date().toISOString().slice(0,10)),xe(!1),re(" Abono registrado")}catch(at){console.error(at),re(" Error al registrar el abono")}finally{Ce(!1)}},Ee=de=>{Qe(de.id),te(de.date||new Date().toISOString().slice(0,10)),R(Math.abs(Number(de.amount||0))),G(de.comment||"")},gt=()=>{Qe(null),te(""),R(0),G("")},Zt=async()=>{if(!Ae||!Re)return;const de=yt.findIndex(ye=>ye.id===Ae);if(de===-1)return;const tt=yt[de],at=Number(_e||0);if(!(at>0)){re("El monto debe ser mayor a 0.");return}const ct=tt.type==="ABONO"?-parseFloat(at.toFixed(2)):+parseFloat(at.toFixed(2));try{await Fn(er(Pe,"ar_movements_pollo",Ae),{date:fe,amount:ct,comment:Q||""});const ye=[...yt];ye[de]={...tt,date:fe,amount:ct,comment:Q||""},ye.sort((Et,qt)=>{var ar,vr;if(Et.date!==qt.date)return Et.date.localeCompare(qt.date);const Mt=((ar=Et.createdAt)==null?void 0:ar.seconds)||0,Xt=((vr=qt.createdAt)==null?void 0:vr.seconds)||0;return Mt-Xt}),pe(ye),or(ye,Number(Re.initialDebt||0));const ft=ye.reduce((Et,qt)=>Et+(Number(qt.amount)||0),0),St=p0(Number(Re.initialDebt||0)+ft),wt=en(ye,St),vt=wt?rn(ye):null;Z(Et=>Et.map(qt=>qt.id===Re.id?{...qt,balance:St,lastAbonoDate:wt&&vt?vt.date:"",lastAbonoAmount:wt&&vt?vt.amount:0}:qt)),he(Et=>Et&&{...Et,balance:St,lastAbonoDate:wt&&vt?vt.date:"",lastAbonoAmount:wt&&vt?vt.amount:0}),gt(),re(" Movimiento actualizado")}catch(ye){console.error(ye),re(" Error al actualizar movimiento")}},Mr=async de=>{var at,ct;if(confirm(`Eliminar este movimiento (${de.type==="ABONO"?"Abono":"Compra"}) del ${de.date}?${de.type==="CARGO"&&((at=de.ref)!=null&&at.saleId)?`
Se borrarn los registros de esa venta.`:""}`)&&Re)try{if(L(!0),de.type==="CARGO"&&((ct=de.ref)!=null&&ct.saleId)){try{await qn(er(Pe,"salesV2",de.ref.saleId))}catch(Et){console.warn("delete sale error",Et),L(!1),re(" No se pudo borrar la venta asociada.");return}await N$(de.ref.saleId)}else await qn(er(Pe,"ar_movements_pollo",de.id));const ye=yt.filter(Et=>{var qt,Mt;return de.type==="CARGO"&&((qt=de.ref)!=null&&qt.saleId)?((Mt=Et.ref)==null?void 0:Mt.saleId)!==de.ref.saleId:Et.id!==de.id});pe(ye),or(ye,Number(Re.initialDebt||0));const ft=ye.reduce((Et,qt)=>Et+(Number(qt.amount)||0),0),St=p0(Number(Re.initialDebt||0)+ft),wt=en(ye,St),vt=wt?rn(ye):null;Z(Et=>Et.map(qt=>qt.id===Re.id?{...qt,balance:St,lastAbonoDate:wt&&vt?vt.date:"",lastAbonoAmount:wt&&vt?vt.amount:0}:qt)),he(Et=>Et&&{...Et,balance:St,lastAbonoDate:wt&&vt?vt.date:"",lastAbonoAmount:wt&&vt?vt.amount:0}),it(null),re(" Movimiento eliminado")}catch(ye){console.error(ye),re(" Error al eliminar movimiento")}finally{L(!1)}},Or=async de=>{if(de.type!=="CARGO")return;const tt=xy(de.debtStatus)==="PAGADA"?"PENDIENTE":"PAGADA";try{Ne(de.id),await Fn(er(Pe,"ar_movements_pollo",de.id),{debtStatus:tt});const at=yt.map(ct=>ct.id===de.id?{...ct,debtStatus:tt}:ct);if(pe(at),Re){or(at,Number(Re.initialDebt||0));const ct=at.reduce((wt,vt)=>wt+(Number(vt.amount)||0),0),ye=p0(Number(Re.initialDebt||0)+ct),ft=en(at,ye),St=ft?rn(at):null;Z(wt=>wt.map(vt=>vt.id===Re.id?{...vt,balance:ye,lastAbonoDate:ft&&St?St.date:"",lastAbonoAmount:ft&&St?St.amount:0}:vt)),he(wt=>wt&&{...wt,balance:ye,lastAbonoDate:ft&&St?St.date:"",lastAbonoAmount:ft&&St?St.amount:0})}re(tt==="PAGADA"?" Compra marcada como pagada":" Compra marcada como pendiente")}catch(at){console.error(at),re(" No se pudo actualizar el estado de la compra")}finally{Ne(null)}},ir=g.useMemo(()=>[...V].sort((de,tt)=>{var at,ct;return de.status!==tt.status?de.status==="BLOQUEADO"?1:-1:(((at=tt.createdAt)==null?void 0:at.seconds)||0)-(((ct=de.createdAt)==null?void 0:ct.seconds)||0)}),[V]),br=de=>de==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",wr=g.useMemo(()=>{const de=A.trim().toLowerCase(),tt=x.trim()===""?null:Number(x),at=y.trim()===""?null:Number(y);return ir.filter(ct=>{const ye=!de||String(ct.name||"").toLowerCase().includes(de),ft=!m||ct.status===m,St=Number(ct.balance||0),wt=tt===null||!Number.isNaN(tt)&&St>=tt,vt=at===null||!Number.isNaN(at)&&St<=at;return ye&&ft&&wt&&vt})},[ir,A,m,x,y]),Xr=g.useMemo(()=>wr.reduce((de,tt)=>de+Number(tt.balance||0),0),[wr]),Ir=g.useMemo(()=>wr.filter(de=>de.status==="ACTIVO").length,[wr]),Pr=wr.length,fn=()=>{h(""),p(""),v(""),b("")};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Pollo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{ze(!0),o&&W(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Saldo pendiente"}),i.jsx("div",{className:"text-2xl font-semibold",children:$c(Xr)}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Calculado sobre los clientes filtrados"})]}),i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Clientes activos"}),i.jsx("div",{className:"text-2xl font-semibold",children:Ir}),i.jsxs("p",{className:"text-[11px] text-gray-500 mt-1",children:["De un total de ",Pr]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm p-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Filtrar cliente"}),i.jsx("input",{className:"w-full border rounded px-3 py-2",placeholder:"Nombre, telfono o nota",value:A,onChange:de=>h(de.target.value)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-gray-50 hover:bg-gray-100",onClick:()=>f(de=>!de),children:d?"Ocultar filtros":"Ms filtros"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-white hover:bg-gray-50",onClick:fn,children:"Limpiar"})]})]}),d&&i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border rounded px-3 py-2",value:m,onChange:de=>p(de.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"Activo"}),i.jsx("option",{value:"BLOQUEADO",children:"Bloqueado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mnimo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:x,onChange:de=>v(de.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mximo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:y,onChange:de=>b(de.target.value),placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:be?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):wr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):wr.map(de=>{var at;const tt=J===de.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(at=de.createdAt)!=null&&at.toDate?de.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:ie,onChange:ct=>He(ct.target.value)}):i.jsx("div",{className:"font-medium",children:de.name})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:Ge,onChange:ct=>dt(s_(ct.target.value))}):de.phone}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ze,onChange:ct=>Te(ct.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(ct=>i.jsx("option",{value:ct.id,children:ct.name},ct.id))]}):de.vendorName||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:_t,onChange:ct=>Bt(ct.target.value),children:[i.jsx("option",{value:"",children:""}),w$.map(ct=>i.jsx("option",{value:ct,children:ct},ct))]}):de.place||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:Qt,onChange:ct=>Ft(ct.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${br(de.status)}`,children:de.status})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN($e)?"":$e,onChange:ct=>Fe(Math.max(0,Number(ct.target.value||0)))}):$c(de.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:$c(de.balance||0)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ot,onChange:ct=>jt(ct.target.value),maxLength:500}):i.jsx("span",{title:de.notes||"",children:(de.notes||"").length>40?(de.notes||"").slice(0,40)+"":de.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:tt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:_r,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:nr,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Rt(de),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>$r(de),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>kr(de),children:"Estado de cuenta"})]})})})]},de.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-2",children:be?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Cargando"}):wr.length===0?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Sin clientes"}):wr.map(de=>i.jsxs("div",{className:"border rounded-lg bg-white p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-base",children:de.name}),i.jsx("div",{className:"text-xs text-gray-600",children:de.phone||""}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:de.vendorName||""})]})]}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${br(de.status)}`,children:de.status})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:$c(de.balance||0)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Lmite"}),i.jsx("div",{className:"font-semibold",children:$c(de.creditLimit||0)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["ltimo abono:"," ",i.jsx("span",{className:"font-medium",children:de.lastAbonoDate?`${de.lastAbonoDate} (${$c(de.lastAbonoAmount||0)})`:""})]}),de.notes?i.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Nota:"})," ",(de.notes||"").length>80?(de.notes||"").slice(0,80)+"":de.notes]}):null,i.jsxs("div",{className:"mt-3 flex gap-2 flex-wrap",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white text-sm",onClick:()=>kr(de),children:"Estado de cuenta"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-yellow-600 text-white text-sm",onClick:()=>Rt(de),disabled:o,title:o?"Vendedor no edita":"Editar",children:"Editar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-red-600 text-white text-sm disabled:opacity-50",onClick:()=>$r(de),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"})]})]},de.id))})]}),Xe&&i.jsx("p",{className:"mt-2 text-sm",children:Xe}),Me&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>ze(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ze(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Nt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:O,onChange:de=>z(de.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:oe,onChange:de=>ce(s_(de.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ue,onChange:de=>ge(de.target.value),children:[i.jsx("option",{value:"",children:""}),w$.map(de=>i.jsx("option",{value:de,children:de},de))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ue,onChange:de=>F(de.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:U,onChange:de=>W(de.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(de=>i.jsx("option",{value:de.id,children:de.name},de.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:X===0?"":X,onChange:de=>D(Math.max(0,Number(de.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:de=>K(Math.max(0,Number(de.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ne,onChange:de=>Oe(de.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ne.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ze(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),ee&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[50]",style:{zIndex:50},children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>me(!1)}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-full max-w-5xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-3",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(Re==null?void 0:Re.name)||""]}),i.jsxs("div",{className:"flex gap-2 shrink-0",children:[i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{xt(0),It(new Date().toISOString().slice(0,10)),Ht(""),xe(!0)},children:"Abonar"}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>me(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(Number((Re==null?void 0:Re.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(je.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(je.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(je.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Estado compra"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:qe?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):yt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):yt.map(de=>{var ct;const tt=Ae===de.id,at=xy(de.debtStatus);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:fe,onChange:ye=>te(ye.target.value)}):de.date||""}),i.jsx("td",{className:"p-2 border",children:de.amount>=0?(ct=de.ref)!=null&&ct.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",onClick:()=>P(de.ref.saleId),children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:de.type==="CARGO"?i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${at==="PAGADA"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:at==="PAGADA"?"Pagada":"Pendiente"}):""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:Q,onChange:ye=>G(ye.target.value)}):i.jsx("span",{title:de.comment||"",children:(de.comment||"").length>40?(de.comment||"").slice(0,40)+"":de.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(_e)?"":_e,onChange:ye=>R(Number(ye.target.value||0))}):$c(de.amount)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Zt,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:gt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ee(de),children:"Editar"}),de.type==="CARGO"&&i.jsx("button",{type:"button",className:`px-2 py-1 rounded text-white ${at==="PAGADA"?"bg-gray-600 hover:bg-gray-700":"bg-emerald-600 hover:bg-emerald-700"} disabled:opacity-50`,onClick:()=>Or(de),disabled:se===de.id,children:at==="PAGADA"?"Marcar pendiente":"Marcar pagada"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Mr(de),children:"Borrar"})]})})]},de.id)})})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",style:{zIndex:60},children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," "]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((de,tt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:de.productName}),i.jsx("td",{className:"p-2 border text-right",children:de.qty}),i.jsx("td",{className:"p-2 border text-right",children:$c(de.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:$c(de.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:$c(de.total)})]},tt))})]})})]})})]}),document.body),Ye&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[90]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(Re==null?void 0:Re.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Pt,onChange:de=>It(de.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Se===0?"":Se,onChange:de=>{const tt=Number(de.target.value||0),at=Number.isFinite(tt)?Math.max(0,parseFloat(tt.toFixed(2))):0;xt(at)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ut,onChange:de=>Ht(de.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Ut.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>xe(!1),disabled:Le,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Er,disabled:Le,children:Le?"Guardando...":"Guardar abono"})]})]})})]})}function CLe(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function _Le(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var ELe=function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o])},t(r,n)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),SLe=function(t){ELe(e,t);function e(r,n){var a=this.constructor,s=t.call(this,r,n)||this;return Object.defineProperty(s,"name",{value:a.name,enumerable:!1,configurable:!0}),CLe(s,a.prototype),_Le(s),s}return e}(Error),ILe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cu=function(t){ILe(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind="Exception",e}(SLe),jLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qi=function(t){jLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArgumentException",e}(cu),PLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pn=function(t){PLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(cu),xse=function(){function t(e){if(this.binarizer=e,e===null)throw new Pn("Binarizer must be non-null.")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,a){var s=this.binarizer.getLuminanceSource().crop(e,r,n,a);return new t(this.binarizer.createBinarizer(s))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},t}(),BLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oo=function(t){BLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(cu),TLe=function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t}(),ws=function(){function t(){}return t.arraycopy=function(e,r,n,a,s){for(;s--;)n[a++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t}(),kLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),OR=function(t){kLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(cu),FLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),C$=function(t){FLe(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var a=t.call(this,n)||this;return a.index=r,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(OR),OLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bo=function(){function t(){}return t.fill=function(e,r){for(var n=0,a=e.length;n<a;n++)e[n]=r},t.fillWithin=function(e,r,n,a){t.rangeCheck(e.length,r,n);for(var s=r;s<n;s++)e[s]=a},t.rangeCheck=function(e,r,n){if(r>n)throw new Pn("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new C$(r);if(n>e)throw new C$(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var a=1;try{for(var s=OLe(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=31*a+l}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var a=n-r,s=new Int32Array(a);return ws.arraycopy(e,r,s,0,a),s},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var a=0,s=e.length-1;a<=s;){var o=s+a>>1,l=n(r,e[o]);if(l>0)a=o+1;else if(l<0)s=o-1;else return o}return-a-1},t.numberComparator=function(e,r){return e-r},t}(),sa=function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),el=function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);ws.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=~n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=~n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new Pn;if(r!==e){r--;for(var n=Math.floor(e/32),a=Math.floor(r/32),s=this.bits,o=n;o<=a;o++){var l=o>n?0:e&31,c=o<a?31:r&31,u=(2<<c)-(1<<l);s[o]|=u}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new Pn;if(r===e)return!0;r--;for(var a=Math.floor(e/32),s=Math.floor(r/32),o=this.bits,l=a;l<=s;l++){var c=l>a?0:e&31,u=l<s?31:r&31,d=(2<<u)-(1<<c)&4294967295;if((o[l]&d)!==(n?d:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new Pn("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new Pn("Sizes don't match");for(var r=this.bits,n=0,a=r.length;n<a;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,a){for(var s=0;s<a;s++){for(var o=0,l=0;l<8;l++)this.get(e)&&(o|=1<<7-l),e++;r[n+s]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits,s=0;s<n;s++){var o=a[s];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-s]=o}if(this.size!==n*32){for(var l=n*32-this.size,c=e[0]>>>l,s=1;s<n;s++){var u=e[s];c|=u<<32-l,e[s-1]=c,c=u>>>l}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+Bo.hashCode(this.bits)},t.prototype.toString=function(){for(var e="",r=0,n=this.size;r<n;r++)r&7||(e+=" "),e+=this.get(r)?"X":".";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t}(),oF;(function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",t[t.ASSUME_GS1=8]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(oF||(oF={}));const Ns=oF;var DLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),qr=function(t){DLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(cu),RLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},qa;(function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"})(qa||(qa={}));var jo=function(){function t(e,r,n){for(var a,s,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];this.valueIdentifier=e,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,u=0,d=c.length;u!==d;u++){var f=c[u];t.VALUES_TO_ECI.set(f,this)}try{for(var A=RLe(o),h=A.next();!h.done;h=A.next()){var m=h.value;t.NAME_TO_ECI.set(m,this)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new qr("incorect value");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new qr("incorect value");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new qr("incorect value");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(qa.Cp437,Int32Array.from([0,2]),"Cp437"),t.ISO8859_1=new t(qa.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),t.ISO8859_2=new t(qa.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),t.ISO8859_3=new t(qa.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),t.ISO8859_4=new t(qa.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),t.ISO8859_5=new t(qa.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),t.ISO8859_6=new t(qa.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),t.ISO8859_7=new t(qa.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),t.ISO8859_8=new t(qa.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),t.ISO8859_9=new t(qa.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),t.ISO8859_10=new t(qa.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),t.ISO8859_11=new t(qa.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),t.ISO8859_13=new t(qa.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),t.ISO8859_14=new t(qa.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),t.ISO8859_15=new t(qa.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),t.ISO8859_16=new t(qa.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),t.SJIS=new t(qa.SJIS,20,"SJIS","Shift_JIS"),t.Cp1250=new t(qa.Cp1250,21,"Cp1250","windows-1250"),t.Cp1251=new t(qa.Cp1251,22,"Cp1251","windows-1251"),t.Cp1252=new t(qa.Cp1252,23,"Cp1252","windows-1252"),t.Cp1256=new t(qa.Cp1256,24,"Cp1256","windows-1256"),t.UnicodeBigUnmarked=new t(qa.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),t.UTF8=new t(qa.UTF8,26,"UTF8","UTF-8"),t.ASCII=new t(qa.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),t.Big5=new t(qa.Big5,28,"Big5"),t.GB18030=new t(qa.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),t.EUC_KR=new t(qa.EUC_KR,30,"EUC_KR","EUC-KR"),t}(),MLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xE=function(t){MLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(cu),Bd=function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e==="ISO-8859-1"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},t.encodingName=function(e){return typeof e=="string"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof jo?e:jo.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var a="",s=0,o=e.length;s<o;s++){var l=e[s].toString(16);l.length<2&&(l="0"+l),a+="%"+l}return decodeURIComponent(a)}if(n.equals(jo.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new xE("Encoding "+this.encodingName(r)+" not supported by fallback.")},t.isDecodeFallbackSupported=function(e){return e.equals(jo.UTF8)||e.equals(jo.ISO8859_1)||e.equals(jo.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(""),a=[],s=0;s<n.length;s++)a.push(n[s].charCodeAt(0));return new Uint8Array(a)},t}(),ba=function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return Bd.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(Ns.CHARACTER_SET)!==void 0)return r.get(Ns.CHARACTER_SET).toString();for(var n=e.length,a=!0,s=!0,o=!0,l=0,c=0,u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,b=0;b<n&&(a||s||o);b++){var w=e[b]&255;o&&(l>0?w&128?l--:o=!1:w&128&&(w&64?(l++,w&32?(l++,w&16?(l++,w&8?o=!1:d++):u++):c++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&v++),s&&(f>0?w<64||w===127||w>252?s=!1:f--:w===128||w===160||w>239?s=!1:w>160&&w<224?(A++,m=0,h++,h>p&&(p=h)):w>127?(f++,h=0,m++,m>x&&(x=m)):(h=0,m=0))}return o&&l>0&&(o=!1),s&&f>0&&(s=!1),o&&(y||c+u+d>0)?t.UTF8:s&&(t.ASSUME_SHIFT_JIS||p>=3||x>=3)?t.SHIFT_JIS:a&&s?p===2&&A===2||v*10>=n?t.SHIFT_JIS:t.ISO88591:a?t.ISO88591:s?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=-1;function s(l,c,u,d,f,A){if(l==="%%")return"%";if(r[++a]!==void 0){l=d?parseInt(d.substr(1)):void 0;var h=f?parseInt(f.substr(1)):void 0,m;switch(A){case"s":m=r[a];break;case"c":m=r[a][0];break;case"f":m=parseFloat(r[a]).toFixed(l);break;case"p":m=parseFloat(r[a]).toPrecision(l);break;case"e":m=parseFloat(r[a]).toExponential(l);break;case"x":m=parseInt(r[a]).toString(h||16);break;case"d":m=parseFloat(parseInt(r[a],h||10).toPrecision(l)).toFixed(0);break}m=typeof m=="object"?JSON.stringify(m):(+m).toString(h);for(var p=parseInt(u),x=u&&u[0]+""=="0"?"0":" ";m.length<p;)m=c!==void 0?m+x:x+m;return m}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,s)},t.getBytes=function(e,r){return Bd.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=jo.SJIS.getName(),t.GB2312="GB2312",t.ISO88591=jo.ISO8859_1.getName(),t.EUC_JP="EUC_JP",t.UTF8=jo.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t}(),ea=function(){function t(e){e===void 0&&(e=""),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=ba.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var a=r;r<r+n;a++)this.append(e[a]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=""},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t}(),lh=function(){function t(e,r,n,a){if(this.width=e,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=e),this.height=r,e<1||r<1)throw new Pn("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,a=new t(n,r),s=0;s<r;s++)for(var o=e[s],l=0;l<n;l++)o[l]&&a.set(l,s);return a},t.parseFromString=function(e,r,n){if(e===null)throw new Pn("stringRepresentation cannot be null");for(var a=new Array(e.length),s=0,o=0,l=-1,c=0,u=0;u<e.length;)if(e.charAt(u)===`
`||e.charAt(u)==="\r"){if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");o=s,c++}u++}else if(e.substring(u,u+r.length)===r)u+=r.length,a[s]=!0,s++;else if(e.substring(u,u+n.length)===n)u+=n.length,a[s]=!1,s++;else throw new Pn("illegal character encountered: "+e.substring(u));if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");c++}for(var d=new t(l,c),f=0;f<s;f++)a[f]&&d.set(Math.floor(f%l),Math.floor(f/l));return d},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new Pn("input matrix dimensions do not match");for(var r=new el(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,s=0,o=this.height;s<o;s++)for(var l=s*n,c=e.getRow(s,r).getBitArray(),u=0;u<n;u++)a[l+u]^=c[u]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,a){if(r<0||e<0)throw new Pn("Left and top must be nonnegative");if(a<1||n<1)throw new Pn("Height and width must be at least 1");var s=e+n,o=r+a;if(o>this.height||s>this.width)throw new Pn("The region must fit inside the matrix");for(var l=this.rowSize,c=this.bits,u=r;u<o;u++)for(var d=u*l,f=e;f<s;f++)c[d+Math.floor(f/32)]|=1<<(f&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new el(this.width):r.clear();for(var n=this.rowSize,a=this.bits,s=e*n,o=0;o<n;o++)r.setBulk(o*32,a[s+o]);return r},t.prototype.setRow=function(e,r){ws.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new el(e),a=new el(e),s=0,o=Math.floor((r+1)/2);s<o;s++)n=this.getRow(s,n),a=this.getRow(r-1-s,a),n.reverse(),a.reverse(),this.setRow(s,a),this.setRow(r-1-s,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,a=this.bits,s=e,o=r,l=-1,c=-1,u=0;u<r;u++)for(var d=0;d<n;d++){var f=a[u*n+d];if(f!==0){if(u<o&&(o=u),u>c&&(c=u),d*32<s){for(var A=0;!(f<<31-A&4294967295);)A++;d*32+A<s&&(s=d*32+A)}if(d*32+31>l){for(var A=31;!(f>>>A);)A--;d*32+A>l&&(l=d*32+A)}}}return l<s||c<o?null:Int32Array.from([s,o,l-s+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var a=n/e,s=n%e*32,o=r[n],l=0;!(o<<31-l&4294967295);)l++;return s+=l,Int32Array.from([s,a])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),s=Math.floor(n%e)*32,o=r[n],l=31;!(o>>>l);)l--;return s+=l,Int32Array.from([s,a])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Bo.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e="X "),r===void 0&&(r="  "),n===void 0&&(n=`
`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var a=new ea,s=0,o=this.height;s<o;s++){for(var l=0,c=this.width;l<c;l++)a.append(this.get(l,s)?e:r);a.append(n)}return a.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t}(),LLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lr=function(t){LLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(cu),ULe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),QLe=function(t){ULe(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var a=this.getLuminanceSource(),s=a.getWidth();n==null||n.getSize()<s?n=new el(s):n.clear(),this.initArrays(s);for(var o=a.getRow(r,this.luminances),l=this.buckets,c=0;c<s;c++)l[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(l);if(s<3)for(var c=0;c<s;c++)(o[c]&255)<u&&n.set(c);else for(var d=o[0]&255,f=o[1]&255,c=1;c<s-1;c++){var A=o[c+1]&255;(f*4-d-A)/2<u&&n.set(c),d=f,f=A}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight(),s=new lh(n,a);this.initArrays(n);for(var o=this.buckets,l=1;l<5;l++)for(var c=Math.floor(a*l/5),u=r.getRow(c,this.luminances),d=Math.floor(n*4/5),f=Math.floor(n/5);f<d;f++){var A=u[f]&255;o[A>>e.LUMINANCE_SHIFT]++}for(var h=e.estimateBlackPoint(o),m=r.getMatrix(),l=0;l<a;l++)for(var p=l*n,f=0;f<n;f++){var A=m[p+f]&255;A<h&&s.set(f,l)}return s},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(r){for(var n=r.length,a=0,s=0,o=0,l=0;l<n;l++)r[l]>o&&(s=l,o=r[l]),r[l]>a&&(a=r[l]);for(var c=0,u=0,l=0;l<n;l++){var d=l-s,f=r[l]*d*d;f>u&&(c=l,u=f)}if(s>c){var A=s;s=c,c=A}if(c-s<=n/16)throw new lr;for(var h=c-1,m=-1,l=c-1;l>s;l--){var p=l-s,f=p*p*(c-l)*(a-r[l]);f>m&&(h=l,m=f)}return h<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(TLe),VLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vse=function(t){VLe(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var s=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var l=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&l++;var c=e.calculateBlackPoints(s,o,l,n,a),u=new lh(n,a);e.calculateThresholdForBlock(s,o,l,n,a,c,u),this.matrix=u}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,a,s,o,l,c){for(var u=o-e.BLOCK_SIZE,d=s-e.BLOCK_SIZE,f=0;f<a;f++){var A=f<<e.BLOCK_SIZE_POWER;A>u&&(A=u);for(var h=e.cap(f,2,a-3),m=0;m<n;m++){var p=m<<e.BLOCK_SIZE_POWER;p>d&&(p=d);for(var x=e.cap(m,2,n-3),v=0,y=-2;y<=2;y++){var b=l[h+y];v+=b[x-2]+b[x-1]+b[x]+b[x+1]+b[x+2]}var w=v/25;e.thresholdBlock(r,p,A,w,s,c)}}},e.cap=function(r,n,a){return r<n?n:r>a?a:r},e.thresholdBlock=function(r,n,a,s,o,l){for(var c=0,u=a*o+n;c<e.BLOCK_SIZE;c++,u+=o)for(var d=0;d<e.BLOCK_SIZE;d++)(r[u+d]&255)<=s&&l.set(n+d,a+c)},e.calculateBlackPoints=function(r,n,a,s,o){for(var l=o-e.BLOCK_SIZE,c=s-e.BLOCK_SIZE,u=new Array(a),d=0;d<a;d++){u[d]=new Int32Array(n);var f=d<<e.BLOCK_SIZE_POWER;f>l&&(f=l);for(var A=0;A<n;A++){var h=A<<e.BLOCK_SIZE_POWER;h>c&&(h=c);for(var m=0,p=255,x=0,v=0,y=f*s+h;v<e.BLOCK_SIZE;v++,y+=s){for(var b=0;b<e.BLOCK_SIZE;b++){var w=r[y+b]&255;m+=w,w<p&&(p=w),w>x&&(x=w)}if(x-p>e.MIN_DYNAMIC_RANGE)for(v++,y+=s;v<e.BLOCK_SIZE;v++,y+=s)for(var b=0;b<e.BLOCK_SIZE;b++)m+=r[y+b]&255}var j=m>>e.BLOCK_SIZE_POWER*2;if(x-p<=e.MIN_DYNAMIC_RANGE&&(j=p/2,d>0&&A>0)){var I=(u[d-1][A]+2*u[d][A-1]+u[d-1][A-1])/4;p<I&&(j=I)}u[d][A]=j}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(QLe),Kw=function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,a){throw new xE("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new xE("This luminance source does not support rotation by 90 degrees.")},t.prototype.rotateCounterClockwise45=function(){throw new xE("This luminance source does not support rotation by 45 degrees.")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new ea,n=0;n<this.height;n++){for(var a=this.getRow(n,e),s=0;s<this.width;s++){var o=a[s]&255,l=void 0;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",r.append(l)}r.append(`
`)}return r.toString()},t}(),HLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xP=function(t){HLe(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var a=this.delegate.getRow(r,n),s=this.getWidth(),o=0;o<s;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),s=0;s<n;s++)a[s]=255-(r[s]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,a,s){return new e(this.delegate.crop(r,n,a,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Kw),$Le=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),KLe=function(t){$Le(e,t);function e(r,n){n===void 0&&(n=!1);var a=t.call(this,r.width,r.height)||this;return a.canvas=r,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(r,n),a}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var a=r.getContext("2d").getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height,n)},e.toGrayscaleBuffer=function(r,n,a,s){s===void 0&&(s=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!s)for(var l=0,c=0,u=r.length;l<u;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=d}else for(var l=0,c=0,p=r.length;l<p;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=255-d}return o},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement(),a=n.getContext("2d"),s=r*e.DEGREE_TO_RADIANS,o=this.canvas.width,l=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(s))*o+Math.abs(Math.sin(s))*l),u=Math.ceil(Math.abs(Math.sin(s))*o+Math.abs(Math.cos(s))*l);return n.width=c,n.height=u,a.translate(c/2,u/2),a.rotate(s),a.drawImage(this.canvas,o/-2,l/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new xP(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(Kw),GLe=function(){function t(e,r,n){this.deviceId=e,this.label=r,this.kind="videoinput",this.groupId=n||void 0}return t.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},t}(),mc=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},pc=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},qLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},w1=function(){function t(e,r,n){r===void 0&&(r=500),this.reader=e,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(t.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),t.prototype.listVideoInputDevices=function(){return mc(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return pc(this,function(h){switch(h.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=qLe(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device "+(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.prototype.getVideoInputDevices=function(){return mc(this,void 0,void 0,function(){var e;return pc(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=r.sent(),[2,e.map(function(n){return new GLe(n.deviceId,n.label)})]}})})},t.prototype.findDeviceById=function(e){return mc(this,void 0,void 0,function(){var r;return pc(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2,null]}})})},t.prototype.decodeFromInputVideoDevice=function(e,r){return mc(this,void 0,void 0,function(){return pc(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return mc(this,void 0,void 0,function(){var n,a;return pc(this,function(s){switch(s.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return mc(this,void 0,void 0,function(){var n;return pc(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return mc(this,void 0,void 0,function(){var n,a;return pc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return n=s.sent(),[4,this.decodeOnce(n)];case 2:return a=s.sent(),[2,a]}})})},t.prototype.decodeFromInputVideoDeviceContinuously=function(e,r,n){return mc(this,void 0,void 0,function(){return pc(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,r,n)];case 1:return[2,a.sent()]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return mc(this,void 0,void 0,function(){var a,s;return pc(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return mc(this,void 0,void 0,function(){var a;return pc(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=s.sent(),[4,this.decodeFromStream(a,r,n)];case 2:return[2,s.sent()]}})})},t.prototype.decodeFromStream=function(e,r,n){return mc(this,void 0,void 0,function(){var a;return pc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return a=s.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,s.sent()]}})})},t.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},t.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},t.prototype.attachStreamToVideo=function(e,r){return mc(this,void 0,void 0,function(){var n;return pc(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(r),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},t.prototype.playVideoOnLoadAsync=function(e){var r=this;return new Promise(function(n,a){return r.playVideoOnLoad(e,function(){return n()})})},t.prototype.playVideoOnLoad=function(e,r){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",r),this.tryPlayVideo(e)},t.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},t.prototype.tryPlayVideo=function(e){return mc(this,void 0,void 0,function(){return pc(this,function(r){switch(r.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.play()];case 2:return r.sent(),[3,4];case 3:return r.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},t.prototype.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Qi("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Qi("element with id '"+e+"' must be an "+r+" element");return n},t.prototype.decodeFromImage=function(e,r){if(!e&&!r)throw new Qi("either imageElement with a src set or an url must be provided");return r&&!e?this.decodeFromImageUrl(r):this.decodeFromImageElement(e)},t.prototype.decodeFromVideo=function(e,r){if(!e&&!r)throw new Qi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(e)},t.prototype.decodeFromVideoContinuously=function(e,r,n){if(e===void 0&&r===void 0)throw new Qi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(e,n)},t.prototype.decodeFromImageElement=function(e){if(!e)throw new Qi("An image element must be provided.");this.reset();var r=this.prepareImageElement(e);this.imageElement=r;var n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n},t.prototype.decodeFromVideoElement=function(e){var r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(r)},t.prototype.decodeFromVideoElementContinuously=function(e,r){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,r)},t.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new Qi("A video element must be provided.");this.reset();var r=this.prepareVideoElement(e);return this.videoElement=r,r},t.prototype.decodeFromImageUrl=function(e){if(!e)throw new Qi("An URL must be provided.");this.reset();var r=this.prepareImageElement();this.imageElement=r;var n=this._decodeOnLoadImage(r);return r.src=e,n},t.prototype.decodeFromVideoUrl=function(e){if(!e)throw new Qi("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=e,n},t.prototype.decodeFromVideoUrlContinuously=function(e,r){if(!e)throw new Qi("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=e,a},t.prototype._decodeOnLoadImage=function(e){var r=this;return new Promise(function(n,a){r.imageLoadedListener=function(){return r.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",r.imageLoadedListener)})},t.prototype._decodeOnLoadVideo=function(e){return mc(this,void 0,void 0,function(){return pc(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return r.sent(),[4,this.decodeOnce(e)];case 2:return[2,r.sent()]}})})},t.prototype._decodeOnLoadVideoContinuously=function(e,r){return mc(this,void 0,void 0,function(){return pc(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,r),[2]}})})},t.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.prototype.prepareImageElement=function(e){var r;return typeof e>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(r=e),r},t.prototype.prepareVideoElement=function(e){var r;return!e&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(r=e),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.prototype.decodeOnce=function(e,r,n){var a=this;r===void 0&&(r=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var s=function(o,l){if(a._stopAsyncDecode){l(new lr("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var c=a.decode(e);o(c)}catch(A){var u=r&&A instanceof lr,d=A instanceof oo||A instanceof qr,f=d&&n;if(u||f)return setTimeout(s,a._timeBetweenDecodingAttempts,o,l);l(A)}};return new Promise(function(o,l){return s(o,l)})},t.prototype.decodeContinuously=function(e,r){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var s=n.decode(e);r(s,null),setTimeout(a,n.timeBetweenScansMillis)}catch(c){r(null,c);var o=c instanceof oo||c instanceof qr,l=c instanceof lr;(o||l)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},t.prototype.decode=function(e){var r=this.createBinaryBitmap(e);return this.decodeBitmap(r)},t.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var r=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),r=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new KLe(n,r),s=new vse(a);return new xse(s)},t.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var r=this.getCaptureCanvas(e),n=void 0;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},t.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var r=this.createCaptureCanvas(e);this.captureCanvas=r}return this.captureCanvas},t.prototype.drawFrameOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.drawImageOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},t.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var r=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r},t.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},t.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},t.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},t.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},t.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},t.prototype.addVideoSource=function(e,r){try{e.srcObject=r}catch{e.src=URL.createObjectURL(r)}},t.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},t}(),uc=function(){function t(e,r,n,a,s,o){n===void 0&&(n=r==null?0:8*r.length),o===void 0&&(o=ws.currentTimeMillis()),this.text=e,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=s,this.timestamp=o,this.text=e,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=s,this.resultMetadata=null,o==null?this.timestamp=ws.currentTimeMillis():this.timestamp=o}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(e,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,r)},t.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},t.prototype.addResultPoints=function(e){var r=this.resultPoints;if(r===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(r.length+e.length);ws.arraycopy(r,0,n,0,r.length),ws.arraycopy(e,0,n,r.length,e.length),this.resultPoints=n}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}(),lF;(function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(lF||(lF={}));const jn=lF;var cF;(function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(cF||(cF={}));const jl=cF;var vP=function(){function t(e,r,n,a,s,o){s===void 0&&(s=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(e){this.numBits=e},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(e){this.erasures=e},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(e){this.other=e},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t}(),Yy=function(){function t(){}return t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.addOrSubtract=function(e,r){return e^r},t}(),hm=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),ws.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var r=this.coefficients,n;if(e===1){n=0;for(var a=0,s=r.length;a!==s;a++){var o=r[a];n=Yy.addOrSubtract(n,o)}return n}n=r[0];for(var l=r.length,c=this.field,a=1;a<l;a++)n=Yy.addOrSubtract(c.multiply(e,n),r[a]);return n},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ws.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=Yy.addOrSubtract(r[l-o],n[l]);return new t(this.field,s)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=this.field,c=0;c<n;c++)for(var u=r[c],d=0;d<s;d++)o[c+d]=Yy.addOrSubtract(o[c+d],l.multiply(u,a[d]));return new t(l,o)},t.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var r=this.coefficients.length,n=this.field,a=new Int32Array(r),s=this.coefficients,o=0;o<r;o++)a[o]=n.multiply(s[o],e);return new t(n,a)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,s=new Int32Array(a+e),o=this.field,l=0;l<a;l++)s[l]=o.multiply(n[l],r);return new t(o,s)},t.prototype.divide=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new Pn("Divide by 0");for(var r=this.field,n=r.getZero(),a=this,s=e.getCoefficient(e.getDegree()),o=r.inverse(s);a.getDegree()>=e.getDegree()&&!a.isZero();){var l=a.getDegree()-e.getDegree(),c=r.multiply(a.getCoefficient(a.getDegree()),o),u=e.multiplyByMonomial(l,c),d=r.buildMonomial(l,c);n=n.addOrSubtract(d),a=a.addOrSubtract(u)}return[n,a]},t.prototype.toString=function(){for(var e="",r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),r===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}r!==0&&(r===1?e+="x":(e+="x^",e+=r))}}return e},t}(),zLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yse=function(t){zLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(cu),WLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jc=function(t){WLe(e,t);function e(r,n,a){var s=t.call(this)||this;s.primitive=r,s.size=n,s.generatorBase=a;for(var o=new Int32Array(n),l=1,c=0;c<n;c++)o[c]=l,l*=2,l>=n&&(l^=r,l&=n-1);s.expTable=o;for(var u=new Int32Array(n),c=0;c<n-1;c++)u[o[c]]=c;return s.logTable=u,s.zero=new hm(s,Int32Array.from([0])),s.one=new hm(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new hm(this,a)},e.prototype.inverse=function(r){if(r===0)throw new yse;return this.expTable[this.size-this.logTable[r]-1]},e.prototype.multiply=function(r,n){return r===0||n===0?0:this.expTable[(this.logTable[r]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+sa.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(r){return r===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(Yy),XLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),i_=function(t){XLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(cu),YLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gw=function(t){YLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(cu),yP=function(){function t(e){this.field=e}return t.prototype.decode=function(e,r){for(var n=this.field,a=new hm(n,e),s=new Int32Array(r),o=!0,l=0;l<r;l++){var c=a.evaluateAt(n.exp(l+n.getGeneratorBase()));s[s.length-1-l]=c,c!==0&&(o=!1)}if(!o)for(var u=new hm(n,s),d=this.runEuclideanAlgorithm(n.buildMonomial(r,1),u,r),f=d[0],A=d[1],h=this.findErrorLocations(f),m=this.findErrorMagnitudes(A,h),l=0;l<h.length;l++){var p=e.length-1-n.log(h[l]);if(p<0)throw new i_("Bad error location");e[p]=Jc.addOrSubtract(e[p],m[l])}},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=this.field,o=e,l=r,c=s.getZero(),u=s.getOne();l.getDegree()>=(n/2|0);){var d=o,f=c;if(o=l,c=u,o.isZero())throw new i_("r_{i-1} was zero");l=d;for(var A=s.getZero(),h=o.getCoefficient(o.getDegree()),m=s.inverse(h);l.getDegree()>=o.getDegree()&&!l.isZero();){var p=l.getDegree()-o.getDegree(),x=s.multiply(l.getCoefficient(l.getDegree()),m);A=A.addOrSubtract(s.buildMonomial(p,x)),l=l.addOrSubtract(o.multiplyByMonomial(p,x))}if(u=A.multiply(c).addOrSubtract(f),l.getDegree()>=o.getDegree())throw new Gw("Division algorithm failed to reduce polynomial?")}var v=u.getCoefficient(0);if(v===0)throw new i_("sigmaTilde(0) was zero");var y=s.inverse(v),b=u.multiplyScalar(y),w=l.multiplyScalar(y);return[b,w]},t.prototype.findErrorLocations=function(e){var r=e.getDegree();if(r===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(r),a=0,s=this.field,o=1;o<s.getSize()&&a<r;o++)e.evaluateAt(o)===0&&(n[a]=s.inverse(o),a++);if(a!==r)throw new i_("Error locator degree does not match number of roots");return n},t.prototype.findErrorMagnitudes=function(e,r){for(var n=r.length,a=new Int32Array(n),s=this.field,o=0;o<n;o++){for(var l=s.inverse(r[o]),c=1,u=0;u<n;u++)if(o!==u){var d=s.multiply(r[u],l),f=d&1?d&-2:d|1;c=s.multiply(c,f)}a[o]=s.multiply(e.evaluateAt(l),s.inverse(c)),s.getGeneratorBase()!==0&&(a[o]=s.multiply(a[o],l))}return a},t}(),gl;(function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"})(gl||(gl={}));var _$=function(){function t(){}return t.prototype.decode=function(e){this.ddata=e;var r=e.getBits(),n=this.extractBits(r),a=this.correctBits(n),s=t.convertBoolArrayToByteArray(a),o=t.getEncodedData(a),l=new vP(s,o,null,null);return l.setNumBits(a.length),l},t.highLevelDecode=function(e){return this.getEncodedData(e)},t.getEncodedData=function(e){for(var r=e.length,n=gl.UPPER,a=gl.UPPER,s="",o=0;o<r;)if(a===gl.BINARY){if(r-o<5)break;var l=t.readCode(e,o,5);if(o+=5,l===0){if(r-o<11)break;l=t.readCode(e,o,11)+31,o+=11}for(var c=0;c<l;c++){if(r-o<8){o=r;break}var u=t.readCode(e,o,8);s+=ba.castAsNonUtf8Char(u),o+=8}a=n}else{var d=a===gl.DIGIT?4:5;if(r-o<d)break;var u=t.readCode(e,o,d);o+=d;var f=t.getCharacter(a,u);f.startsWith("CTRL_")?(n=a,a=t.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(s+=f,a=n)}return s},t.getTable=function(e){switch(e){case"L":return gl.LOWER;case"P":return gl.PUNCT;case"M":return gl.MIXED;case"D":return gl.DIGIT;case"B":return gl.BINARY;case"U":default:return gl.UPPER}},t.getCharacter=function(e,r){switch(e){case gl.UPPER:return t.UPPER_TABLE[r];case gl.LOWER:return t.LOWER_TABLE[r];case gl.MIXED:return t.MIXED_TABLE[r];case gl.PUNCT:return t.PUNCT_TABLE[r];case gl.DIGIT:return t.DIGIT_TABLE[r];default:throw new Gw("Bad table")}},t.prototype.correctBits=function(e){var r,n;this.ddata.getNbLayers()<=2?(n=6,r=Jc.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=Jc.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=Jc.AZTEC_DATA_10):(n=12,r=Jc.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),s=e.length/n;if(s<a)throw new qr;for(var o=e.length%n,l=new Int32Array(s),c=0;c<s;c++,o+=n)l[c]=t.readCode(e,o,n);try{var u=new yP(r);u.decode(l,s-a)}catch(x){throw new qr(x)}for(var d=(1<<n)-1,f=0,c=0;c<a;c++){var A=l[c];if(A===0||A===d)throw new qr;(A===1||A===d-1)&&f++}for(var h=new Array(a*n-f),m=0,c=0;c<a;c++){var A=l[c];if(A===1||A===d-1)h.fill(A>1,m,m+n-1),m+=n-1;else for(var p=n-1;p>=0;--p)h[m++]=(A&1<<p)!==0}return h},t.prototype.extractBits=function(e){var r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,s=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,r));if(r)for(var l=0;l<s.length;l++)s[l]=l;else for(var c=a+1+2*sa.truncDivision(sa.truncDivision(a,2)-1,15),u=a/2,d=sa.truncDivision(c,2),l=0;l<u;l++){var f=l+sa.truncDivision(l,15);s[u-l-1]=d-f-1,s[u+l]=d+f+1}for(var l=0,A=0;l<n;l++){for(var h=(n-l)*4+(r?9:12),m=l*2,p=a-1-m,x=0;x<h;x++)for(var v=x*2,y=0;y<2;y++)o[A+v+y]=e.get(s[m+y],s[m+x]),o[A+2*h+v+y]=e.get(s[m+x],s[p-y]),o[A+4*h+v+y]=e.get(s[p-y],s[p-x]),o[A+6*h+v+y]=e.get(s[p-x],s[m+y]);A+=h*8}return o},t.readCode=function(e,r,n){for(var a=0,s=r;s<r+n;s++)a<<=1,e[s]&&(a|=1);return a},t.readByte=function(e,r){var n=e.length-r;return n>=8?t.readCode(e,r,8):t.readCode(e,r,n)<<8-n},t.convertBoolArrayToByteArray=function(e){for(var r=new Uint8Array((e.length+7)/8),n=0;n<r.length;n++)r[n]=t.readByte(e,8*n);return r},t.prototype.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],t.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],t}(),ja=function(){function t(){}return t.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},t.distance=function(e,r,n,a){var s=e-n,o=r-a;return Math.sqrt(s*s+o*o)},t.sum=function(e){for(var r=0,n=0,a=e.length;n!==a;n++){var s=e[n];r+=s}return r},t}(),uF=function(){function t(){}return t.floatToIntBits=function(e){return e},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),An=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*uF.floatToIntBits(this.x)+uF.floatToIntBits(this.y)},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.orderBestPatterns=function(e){var r=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),s,o,l;if(n>=r&&n>=a?(o=e[0],s=e[1],l=e[2]):a>=n&&a>=r?(o=e[1],s=e[0],l=e[2]):(o=e[2],s=e[0],l=e[1]),this.crossProductZ(s,o,l)<0){var c=s;s=l,l=c}e[0]=s,e[1]=o,e[2]=l},t.distance=function(e,r){return ja.distance(e.x,e.y,r.x,r.y)},t.crossProductZ=function(e,r,n){var a=r.x,s=r.y;return(n.x-a)*(e.y-s)-(n.y-s)*(e.x-a)},t}(),DR=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),JLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ZLe=function(t){JLe(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n)||this;return l.compact=a,l.nbDatablocks=s,l.nbLayers=o,l}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(DR),dF=function(){function t(e,r,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),r==null&&(r=t.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var s=r/2|0;if(this.leftInit=n-s,this.rightInit=n+s,this.upInit=a-s,this.downInit=a+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new lr}return t.prototype.detect=function(){for(var e=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,s=!1,o=!0,l=!1,c=!1,u=!1,d=!1,f=!1,A=this.width,h=this.height;o;){o=!1;for(var m=!0;(m||!c)&&r<A;)m=this.containsBlackPoint(n,a,r,!1),m?(r++,o=!0,c=!0):c||r++;if(r>=A){s=!0;break}for(var p=!0;(p||!u)&&a<h;)p=this.containsBlackPoint(e,r,a,!0),p?(a++,o=!0,u=!0):u||a++;if(a>=h){s=!0;break}for(var x=!0;(x||!d)&&e>=0;)x=this.containsBlackPoint(n,a,e,!1),x?(e--,o=!0,d=!0):d||e--;if(e<0){s=!0;break}for(var v=!0;(v||!f)&&n>=0;)v=this.containsBlackPoint(e,r,n,!0),v?(n--,o=!0,f=!0):f||n--;if(n<0){s=!0;break}o&&(l=!0)}if(!s&&l){for(var y=r-e,b=null,w=1;b===null&&w<y;w++)b=this.getBlackPointOnSegment(e,a-w,e+w,a);if(b==null)throw new lr;for(var j=null,w=1;j===null&&w<y;w++)j=this.getBlackPointOnSegment(e,n+w,e+w,n);if(j==null)throw new lr;for(var I=null,w=1;I===null&&w<y;w++)I=this.getBlackPointOnSegment(r,n+w,r-w,n);if(I==null)throw new lr;for(var _=null,w=1;_===null&&w<y;w++)_=this.getBlackPointOnSegment(r,a-w,r-w,a);if(_==null)throw new lr;return this.centerEdges(_,b,I,j)}else throw new lr},t.prototype.getBlackPointOnSegment=function(e,r,n,a){for(var s=ja.round(ja.distance(e,r,n,a)),o=(n-e)/s,l=(a-r)/s,c=this.image,u=0;u<s;u++){var d=ja.round(e+u*o),f=ja.round(r+u*l);if(c.get(d,f))return new An(d,f)}return null},t.prototype.centerEdges=function(e,r,n,a){var s=e.getX(),o=e.getY(),l=r.getX(),c=r.getY(),u=n.getX(),d=n.getY(),f=a.getX(),A=a.getY(),h=t.CORR;return s<this.width/2?[new An(f-h,A+h),new An(l+h,c+h),new An(u-h,d-h),new An(s+h,o-h)]:[new An(f+h,A+h),new An(l+h,c-h),new An(u-h,d+h),new An(s-h,o-h)]},t.prototype.containsBlackPoint=function(e,r,n,a){var s=this.image;if(a){for(var o=e;o<=r;o++)if(s.get(o,n))return!0}else for(var l=e;l<=r;l++)if(s.get(n,l))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t}(),E$=function(){function t(){}return t.checkAndNudgePoints=function(e,r){for(var n=e.getWidth(),a=e.getHeight(),s=!0,o=0;o<r.length&&s;o+=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new lr;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}s=!0;for(var o=r.length-2;o>=0&&s;o-=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new lr;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}},t}(),bse=function(){function t(e,r,n,a,s,o,l,c,u){this.a11=e,this.a21=r,this.a31=n,this.a12=a,this.a22=s,this.a32=o,this.a13=l,this.a23=c,this.a33=u}return t.quadrilateralToQuadrilateral=function(e,r,n,a,s,o,l,c,u,d,f,A,h,m,p,x){var v=t.quadrilateralToSquare(e,r,n,a,s,o,l,c),y=t.squareToQuadrilateral(u,d,f,A,h,m,p,x);return y.times(v)},t.prototype.transformPoints=function(e){for(var r=e.length,n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=0;A<r;A+=2){var h=e[A],m=e[A+1],p=s*h+c*m+f;e[A]=(n*h+o*m+u)/p,e[A+1]=(a*h+l*m+d)/p}},t.prototype.transformPointsWithValues=function(e,r){for(var n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=e.length,h=0;h<A;h++){var m=e[h],p=r[h],x=s*m+c*p+f;e[h]=(n*m+o*p+u)/x,r[h]=(a*m+l*p+d)/x}},t.squareToQuadrilateral=function(e,r,n,a,s,o,l,c){var u=e-n+s-l,d=r-a+o-c;if(u===0&&d===0)return new t(n-e,s-n,e,a-r,o-a,r,0,0,1);var f=n-s,A=l-s,h=a-o,m=c-o,p=f*m-A*h,x=(u*m-A*d)/p,v=(f*d-u*h)/p;return new t(n-e+x*n,l-e+v*l,e,a-r+x*a,c-r+v*c,r,x,v,1)},t.quadrilateralToSquare=function(e,r,n,a,s,o,l,c){return t.squareToQuadrilateral(e,r,n,a,s,o,l,c).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t}(),eUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tUe=function(t){eUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sampleGrid=function(r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w){var j=bse.quadrilateralToQuadrilateral(s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w);return this.sampleGridWithTransform(r,n,a,j)},e.prototype.sampleGridWithTransform=function(r,n,a,s){if(n<=0||a<=0)throw new lr;for(var o=new lh(n,a),l=new Float32Array(2*n),c=0;c<a;c++){for(var u=l.length,d=c+.5,f=0;f<u;f+=2)l[f]=f/2+.5,l[f+1]=d;s.transformPoints(l),E$.checkAndNudgePoints(r,l);try{for(var f=0;f<u;f+=2)r.get(Math.floor(l[f]),Math.floor(l[f+1]))&&o.set(f/2,c)}catch{throw new lr}}return o},e}(E$),RR=function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new tUe,t}(),Kc=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.toResultPoint=function(){return new An(this.getX(),this.getY())},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t}(),rUe=function(){function t(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return t.prototype.detect=function(){return this.detectMirror(!1)},t.prototype.detectMirror=function(e){var r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var s=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new ZLe(s,o,this.compact,this.nbDataBlocks,this.nbLayers)},t.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new lr;var r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],r),this.sampleLine(e[1],e[2],r),this.sampleLine(e[2],e[3],r),this.sampleLine(e[3],e[0],r)]);this.shift=this.getRotation(n,r);for(var a=0,s=0;s<4;s++){var o=n[(this.shift+s)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var l=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)},t.prototype.getRotation=function(e,r){var n=0;e.forEach(function(s,o,l){var c=(s>>r-2<<1)+(s&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(sa.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new lr},t.prototype.getCorrectedParameterData=function(e,r){var n,a;r?(n=7,a=2):(n=10,a=4);for(var s=n-a,o=new Int32Array(n),l=n-1;l>=0;--l)o[l]=e&15,e>>=4;try{var c=new yP(Jc.AZTEC_PARAM);c.decode(o,s)}catch{throw new lr}for(var u=0,l=0;l<a;l++)u=(u<<4)+o[l];return u},t.prototype.getBullsEyeCorners=function(e){var r=e,n=e,a=e,s=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var l=this.getFirstDifferent(r,o,1,-1),c=this.getFirstDifferent(n,o,1,1),u=this.getFirstDifferent(a,o,-1,1),d=this.getFirstDifferent(s,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(d,l)*this.nbCenterLayers/(this.distancePoint(s,r)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(l,c,u,d))break}r=l,n=c,a=u,s=d,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new lr;this.compact=this.nbCenterLayers===5;var A=new An(r.getX()+.5,r.getY()-.5),h=new An(n.getX()+.5,n.getY()+.5),m=new An(a.getX()-.5,a.getY()+.5),p=new An(s.getX()-.5,s.getY()-.5);return this.expandSquare([A,h,m,p],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},t.prototype.getMatrixCenter=function(){var e,r,n,a;try{var s=new dF(this.image).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{var o=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new Kc(o+7,l-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Kc(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Kc(o-7,l+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Kc(o-7,l-7),!1,-1,-1).toResultPoint()}var c=ja.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=ja.round((e.getY()+a.getY()+r.getY()+n.getY())/4);try{var s=new dF(this.image,15,c,u).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{e=this.getFirstDifferent(new Kc(c+7,u-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Kc(c+7,u+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Kc(c-7,u+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Kc(c-7,u-7),!1,-1,-1).toResultPoint()}return c=ja.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=ja.round((e.getY()+a.getY()+r.getY()+n.getY())/4),new Kc(c,u)},t.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},t.prototype.sampleGrid=function(e,r,n,a,s){var o=RR.getInstance(),l=this.getDimension(),c=l/2-this.nbCenterLayers,u=l/2+this.nbCenterLayers;return o.sampleGrid(e,l,l,c,c,u,c,u,u,c,u,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),s.getX(),s.getY())},t.prototype.sampleLine=function(e,r,n){for(var a=0,s=this.distanceResultPoint(e,r),o=s/n,l=e.getX(),c=e.getY(),u=o*(r.getX()-e.getX())/s,d=o*(r.getY()-e.getY())/s,f=0;f<n;f++)this.image.get(ja.round(l+f*u),ja.round(c+f*d))&&(a|=1<<n-f-1);return a},t.prototype.isWhiteOrBlackRectangle=function(e,r,n,a){var s=3;e=new Kc(e.getX()-s,e.getY()+s),r=new Kc(r.getX()-s,r.getY()-s),n=new Kc(n.getX()+s,n.getY()-s),a=new Kc(a.getX()+s,a.getY()+s);var o=this.getColor(a,e);if(o===0)return!1;var l=this.getColor(e,r);return l!==o||(l=this.getColor(r,n),l!==o)?!1:(l=this.getColor(n,a),l===o)},t.prototype.getColor=function(e,r){for(var n=this.distancePoint(e,r),a=(r.getX()-e.getX())/n,s=(r.getY()-e.getY())/n,o=0,l=e.getX(),c=e.getY(),u=this.image.get(e.getX(),e.getY()),d=Math.ceil(n),f=0;f<d;f++)l+=a,c+=s,this.image.get(ja.round(l),ja.round(c))!==u&&o++;var A=o/n;return A>.1&&A<.9?0:A<=.1===u?1:-1},t.prototype.getFirstDifferent=function(e,r,n,a){for(var s=e.getX()+n,o=e.getY()+a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n,o+=a;for(s-=n,o-=a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n;for(s-=n;this.isValid(s,o)&&this.image.get(s,o)===r;)o+=a;return o-=a,new Kc(s,o)},t.prototype.expandSquare=function(e,r,n){var a=n/(2*r),s=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),l=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,u=new An(l+a*s,c+a*o),d=new An(l-a*s,c-a*o);s=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),l=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var f=new An(l+a*s,c+a*o),A=new An(l-a*s,c-a*o),h=[u,f,d,A];return h},t.prototype.isValid=function(e,r){return e>=0&&e<this.image.getWidth()&&r>0&&r<this.image.getHeight()},t.prototype.isValidPoint=function(e){var r=ja.round(e.getX()),n=ja.round(e.getY());return this.isValid(r,n)},t.prototype.distancePoint=function(e,r){return ja.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.distanceResultPoint=function(e,r){return ja.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(sa.truncDivision(this.nbLayers-4,8)+1)+15},t}(),eI=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=null,a=new rUe(e.getBlackMatrix()),s=null,o=null;try{var l=a.detectMirror(!1);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new _$().decode(l)}catch(f){n=f}if(o==null)try{var l=a.detectMirror(!0);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new _$().decode(l)}catch(f){throw n??f}var c=new uc(o.getText(),o.getRawBytes(),o.getNumBits(),s,jn.AZTEC,ws.currentTimeMillis()),u=o.getByteSegments();u!=null&&c.putMetadata(jl.BYTE_SEGMENTS,u);var d=o.getECLevel();return d!=null&&c.putMetadata(jl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reportFoundResultPoints=function(e,r){if(e!=null){var n=e.get(Ns.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach(function(a,s,o){n.foundPossibleResultPoint(a)})}},t.prototype.reset=function(){},t}(),nUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){nUe(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new eI,r)||this}return e})(w1);var ko=function(){function t(){}return t.prototype.decode=function(e,r){try{return this.doDecode(e,r)}catch{var n=r&&r.get(Ns.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),s=this.doDecode(a,r),o=s.getResultMetadata(),l=270;o!==null&&o.get(jl.ORIENTATION)===!0&&(l=l+o.get(jl.ORIENTATION)%360),s.putMetadata(jl.ORIENTATION,l);var c=s.getResultPoints();if(c!==null)for(var u=a.getHeight(),d=0;d<c.length;d++)c[d]=new An(u-c[d].getY()-1,c[d].getX());return s}else throw new lr}},t.prototype.reset=function(){},t.prototype.doDecode=function(e,r){var n=e.getWidth(),a=e.getHeight(),s=new el(n),o=r&&r.get(Ns.TRY_HARDER)===!0,l=Math.max(1,a>>(o?8:5)),c;o?c=a:c=15;for(var u=Math.trunc(a/2),d=0;d<c;d++){var f=Math.trunc((d+1)/2),A=(d&1)===0,h=u+l*(A?f:-f);if(h<0||h>=a)break;try{s=e.getBlackRow(h,s)}catch{continue}for(var m=function(y){if(y===1&&(s.reverse(),r&&r.get(Ns.NEED_RESULT_POINT_CALLBACK)===!0)){var b=new Map;r.forEach(function(I,_){return b.set(_,I)}),b.delete(Ns.NEED_RESULT_POINT_CALLBACK),r=b}try{var w=p.decodeRow(h,s,r);if(y===1){w.putMetadata(jl.ORIENTATION,180);var j=w.getResultPoints();j!==null&&(j[0]=new An(n-j[0].getX()-1,j[0].getY()),j[1]=new An(n-j[1].getX()-1,j[1].getY()))}return{value:w}}catch{}},p=this,x=0;x<2;x++){var v=m(x);if(typeof v=="object")return v.value}}throw new lr},t.recordPattern=function(e,r,n){for(var a=n.length,s=0;s<a;s++)n[s]=0;var o=e.getSize();if(r>=o)throw new lr;for(var l=!e.get(r),c=0,u=r;u<o;){if(e.get(u)!==l)n[c]++;else{if(++c===a)break;n[c]=1,l=!l}u++}if(!(c===a||c===a-1&&u===o))throw new lr},t.recordPatternInReverse=function(e,r,n){for(var a=n.length,s=e.get(r);r>0&&a>=0;)e.get(--r)!==s&&(a--,s=!s);if(a>=0)throw new lr;t.recordPattern(e,r+1,n)},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return Number.POSITIVE_INFINITY;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return Number.POSITIVE_INFINITY;u+=h}return u/s},t}(),aUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),S$=function(t){aUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.findStartPattern=function(r){for(var n=r.getSize(),a=r.getNextSet(0),s=0,o=Int32Array.from([0,0,0,0,0,0]),l=a,c=!1,u=6,d=a;d<n;d++)if(r.get(d)!==c)o[s]++;else{if(s===u-1){for(var f=e.MAX_AVG_VARIANCE,A=-1,h=e.CODE_START_A;h<=e.CODE_START_C;h++){var m=ko.patternMatchVariance(o,e.CODE_PATTERNS[h],e.MAX_INDIVIDUAL_VARIANCE);m<f&&(f=m,A=h)}if(A>=0&&r.isRange(Math.max(0,l-(d-l)/2),l,!1))return Int32Array.from([l,d,A]);l+=o[0]+o[1],o=o.slice(2,o.length),o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,c=!c}throw new lr},e.decodeCode=function(r,n,a){ko.recordPattern(r,a,n);for(var s=e.MAX_AVG_VARIANCE,o=-1,l=0;l<e.CODE_PATTERNS.length;l++){var c=e.CODE_PATTERNS[l],u=this.patternMatchVariance(n,c,e.MAX_INDIVIDUAL_VARIANCE);u<s&&(s=u,o=l)}if(o>=0)return o;throw new lr},e.prototype.decodeRow=function(r,n,a){var s=a&&a.get(Ns.ASSUME_GS1)===!0,o=e.findStartPattern(n),l=o[2],c=0,u=new Uint8Array(20);u[c++]=l;var d;switch(l){case e.CODE_START_A:d=e.CODE_CODE_A;break;case e.CODE_START_B:d=e.CODE_CODE_B;break;case e.CODE_START_C:d=e.CODE_CODE_C;break;default:throw new qr}for(var f=!1,A=!1,h="",m=o[0],p=o[1],x=Int32Array.from([0,0,0,0,0,0]),v=0,y=0,b=l,w=0,j=!0,I=!1,_=!1;!f;){var S=A;switch(A=!1,v=y,y=e.decodeCode(n,x,p),u[c++]=y,y!==e.CODE_STOP&&(j=!0),y!==e.CODE_STOP&&(w++,b+=w*y),m=p,p+=x.reduce(function(ue,ge){return ue+ge},0),y){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new qr}switch(d){case e.CODE_CODE_A:if(y<64)_===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),_=!1;else if(y<96)_===I?h+=String.fromCharCode(y-64):h+=String.fromCharCode(y+64),_=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!I&&_?(I=!0,_=!1):I&&_?(I=!1,_=!1):_=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_B;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(y<96)_===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),_=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!I&&_?(I=!0,_=!1):I&&_?(I=!1,_=!1):_=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_A;break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(y<100)y<10&&(h+="0"),h+=y;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}S&&(d=d===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var E=p-m;if(p=n.getNextUnset(p),!n.isRange(p,Math.min(n.getSize(),p+(p-m)/2),!1))throw new lr;if(b-=w*v,b%103!==v)throw new oo;var B=h.length;if(B===0)throw new lr;B>0&&j&&(d===e.CODE_CODE_C?h=h.substring(0,B-2):h=h.substring(0,B-1));for(var k=(o[1]+o[0])/2,P=m+E/2,O=u.length,z=new Uint8Array(O),oe=0;oe<O;oe++)z[oe]=u[oe];var ce=[new An(k,r),new An(P,r)];return new uc(h,z,0,ce,jn.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(ko),sUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),V5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},I$=function(t){sUe(e,t);function e(r,n){r===void 0&&(r=!1),n===void 0&&(n=!1);var a=t.call(this)||this;return a.usingCheckDigit=r,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.counters;u.fill(0),this.decodeRowResult="";var d=e.findAsteriskPattern(n,u),f=n.getNextSet(d[1]),A=n.getSize(),h,m;do{e.recordPattern(n,f,u);var p=e.toNarrowWidePattern(u);if(p<0)throw new lr;h=e.patternToChar(p),this.decodeRowResult+=h,m=f;try{for(var x=(s=void 0,V5(u)),v=x.next();!v.done;v=x.next()){var y=v.value;f+=y}}catch(O){s={error:O}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}f=n.getNextSet(f)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=V5(u),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(O){l={error:O}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}var I=f-m-b;if(f!==A&&I*2<b)throw new lr;if(this.usingCheckDigit){for(var _=this.decodeRowResult.length-1,S=0,E=0;E<_;E++)S+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(E));if(this.decodeRowResult.charAt(_)!==e.ALPHABET_STRING.charAt(S%43))throw new oo;this.decodeRowResult=this.decodeRowResult.substring(0,_)}if(this.decodeRowResult.length===0)throw new lr;var B;this.extendedMode?B=e.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;var k=(d[1]+d[0])/2,P=m+b/2;return new uc(B,null,0,[new An(k,r),new An(P,r)],jn.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(r,n){for(var a=r.getSize(),s=r.getNextSet(0),o=0,l=s,c=!1,u=n.length,d=s;d<a;d++)if(r.get(d)!==c)n[o]++;else{if(o===u-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&r.isRange(Math.max(0,l-Math.floor((d-l)/2)),l,!1))return[l,d];l+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,c=!c}throw new lr},e.toNarrowWidePattern=function(r){var n,a,s=r.length,o=0,l;do{var c=2147483647;try{for(var u=(n=void 0,V5(r)),d=u.next();!d.done;d=u.next()){var f=d.value;f<c&&f>o&&(c=f)}}catch(p){n={error:p}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o=c,l=0;for(var A=0,h=0,m=0;m<s;m++){var f=r[m];f>o&&(h|=1<<s-1-m,l++,A+=f)}if(l===3){for(var m=0;m<s&&l>0;m++){var f=r[m];if(f>o&&(l--,f*2>=A))return-1}return h}}while(l>3);return-1},e.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);if(r===e.ASTERISK_ENCODING)return"*";throw new lr},e.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o==="+"||o==="$"||o==="%"||o==="/"){var l=r.charAt(s+1),c="\0";switch(o){case"+":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new qr;break;case"$":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new qr;break;case"%":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l==="X"||l==="Y"||l==="Z")c="";else throw new qr;break;case"/":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new qr;break}a+=c,s++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(ko),iUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),H5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},j$=function(t){iUe(e,t);function e(){var r=t.call(this)||this;return r.decodeRowResult="",r.counters=new Int32Array(6),r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.findAsteriskPattern(n),d=n.getNextSet(u[1]),f=n.getSize(),A=this.counters;A.fill(0),this.decodeRowResult="";var h,m;do{e.recordPattern(n,d,A);var p=this.toPattern(A);if(p<0)throw new lr;h=this.patternToChar(p),this.decodeRowResult+=h,m=d;try{for(var x=(s=void 0,H5(A)),v=x.next();!v.done;v=x.next()){var y=v.value;d+=y}}catch(E){s={error:E}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}d=n.getNextSet(d)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=H5(A),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(E){l={error:E}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}if(d===f||!n.get(d))throw new lr;if(this.decodeRowResult.length<2)throw new lr;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var I=this.decodeExtended(this.decodeRowResult),_=(u[1]+u[0])/2,S=m+b/2;return new uc(I,null,0,[new An(_,r),new An(S,r)],jn.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(r){var n=r.getSize(),a=r.getNextSet(0);this.counters.fill(0);for(var s=this.counters,o=a,l=!1,c=s.length,u=0,d=a;d<n;d++)if(r.get(d)!==l)s[u]++;else{if(u===c-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([o,d]);o+=s[0]+s[1],s.copyWithin(0,2,2+u-1),s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,l=!l}throw new lr},e.prototype.toPattern=function(r){var n,a,s=0;try{for(var o=H5(r),l=o.next();!l.done;l=o.next()){var c=l.value;s+=c}}catch(m){n={error:m}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var u=0,d=r.length,f=0;f<d;f++){var A=Math.round(r[f]*9/s);if(A<1||A>4)return-1;if(f&1)u<<=A;else for(var h=0;h<A;h++)u=u<<1|1}return u},e.prototype.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);throw new lr},e.prototype.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o>="a"&&o<="d"){if(s>=n-1)throw new qr;var l=r.charAt(s+1),c="\0";switch(o){case"d":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new qr;break;case"a":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new qr;break;case"b":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l>="X"&&l<="Z")c="";else throw new qr;break;case"c":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new qr;break}a+=c,s++}else a+=o}return a},e.prototype.checkChecksums=function(r){var n=r.length;this.checkOneChecksum(r,n-2,20),this.checkOneChecksum(r,n-1,15)},e.prototype.checkOneChecksum=function(r,n,a){for(var s=1,o=0,l=n-1;l>=0;l--)o+=s*e.ALPHABET_STRING.indexOf(r.charAt(l)),++s>a&&(s=1);if(r.charAt(n)!==e.ALPHABET_STRING[o%47])throw new oo},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(ko),oUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P$=function(t){oUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return e.prototype.decodeRow=function(r,n,a){var s,o,l=this.decodeStart(n),c=this.decodeEnd(n),u=new ea;e.decodeMiddle(n,l[1],c[0],u);var d=u.toString(),f=null;a!=null&&(f=a.get(Ns.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var A=d.length,h=!1,m=0;try{for(var p=lUe(f),x=p.next();!x.done;x=p.next()){var v=x.value;if(A===v){h=!0;break}v>m&&(m=v)}}catch(w){s={error:w}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}if(!h&&A>m&&(h=!0),!h)throw new qr;var y=[new An(l[1],r),new An(c[0],r)],b=new uc(d,null,0,y,jn.ITF,new Date().getTime());return b},e.decodeMiddle=function(r,n,a,s){var o=new Int32Array(10),l=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),l.fill(0),c.fill(0);n<a;){ko.recordPattern(r,n,o);for(var u=0;u<5;u++){var d=2*u;l[u]=o[d],c[u]=o[d+1]}var f=e.decodeDigit(l);s.append(f.toString()),f=this.decodeDigit(c),s.append(f.toString()),o.forEach(function(A){n+=A})}},e.prototype.decodeStart=function(r){var n=e.skipWhiteSpace(r),a=e.findGuardPattern(r,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a},e.prototype.validateQuietZone=function(r,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var s=n-1;a>0&&s>=0&&!r.get(s);s--)a--;if(a!==0)throw new lr},e.skipWhiteSpace=function(r){var n=r.getSize(),a=r.getNextSet(0);if(a===n)throw new lr;return a},e.prototype.decodeEnd=function(r){r.reverse();try{var n=e.skipWhiteSpace(r),a=void 0;try{a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof lr&&(a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);var s=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-s,a}finally{r.reverse()}},e.findGuardPattern=function(r,n,a){var s=a.length,o=new Int32Array(s),l=r.getSize(),c=!1,u=0,d=n;o.fill(0);for(var f=n;f<l;f++)if(r.get(f)!==c)o[u]++;else{if(u===s-1){if(ko.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[d,f];d+=o[0]+o[1],ws.arraycopy(o,2,o,0,u-1),o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,c=!c}throw new lr},e.decodeDigit=function(r){for(var n=e.MAX_AVG_VARIANCE,a=-1,s=e.PATTERNS.length,o=0;o<s;o++){var l=e.PATTERNS[o],c=ko.patternMatchVariance(r,l,e.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,a=o):c===n&&(a=-1)}if(a>=0)return a%10;throw new lr},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(ko),cUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hv=function(t){cUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.decodeRowStringBuffer="",r}return e.findStartGuardPattern=function(r){for(var n=!1,a,s=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(r,s,!1,this.START_END_PATTERN,o);var l=a[0];s=a[1];var c=l-(s-l);c>=0&&(n=r.isRange(c,l,!1))}return a},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(r,n,a,s){return this.findGuardPattern(r,n,a,s,new Int32Array(s.length))},e.findGuardPattern=function(r,n,a,s,o){var l=r.getSize();n=a?r.getNextUnset(n):r.getNextSet(n);for(var c=0,u=n,d=s.length,f=a,A=n;A<l;A++)if(r.get(A)!==f)o[c]++;else{if(c===d-1){if(ko.patternMatchVariance(o,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([u,A]);u+=o[0]+o[1];for(var h=o.slice(2,o.length),m=0;m<c-1;m++)o[m]=h[m];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,f=!f}throw new lr},e.decodeDigit=function(r,n,a,s){this.recordPattern(r,a,n);for(var o=this.MAX_AVG_VARIANCE,l=-1,c=s.length,u=0;u<c;u++){var d=s[u],f=ko.patternMatchVariance(n,d,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,l=u)}if(l>=0)return l;throw new lr},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(ko),uUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dUe=function(){function t(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new An((n[0]+n[1])/2,e),new An(s,e)],u=new uc(o,null,0,c,jn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<5&&c<l;d++){var f=Hv.decodeDigit(e,o,c,Hv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,uUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<4-d),d!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==5)throw new lr;var p=this.determineCheckDigit(u);if(t.extensionChecksum(n.toString())!==p)throw new lr;return c},t.extensionChecksum=function(e){for(var r=e.length,n=0,a=r-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=r-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},t.prototype.determineCheckDigit=function(e){for(var r=0;r<10;r++)if(e===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new lr},t.parseExtensionString=function(e){if(e.length!==5)return null;var r=t.parseExtension5String(e);return r==null?null:new Map([[jl.SUGGESTED_PRICE,r]])},t.parseExtension5String=function(e){var r;switch(e.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),s=n%100,o=s<10?"0"+s:s.toString();return r+a+"."+o},t}(),fUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},hUe=function(){function t(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new An((n[0]+n[1])/2,e),new An(s,e)],u=new uc(o,null,0,c,jn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<2&&c<l;d++){var f=Hv.decodeDigit(e,o,c,Hv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,fUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<1-d),d!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==2)throw new lr;if(parseInt(n.toString())%4!==u)throw new lr;return c},t.parseExtensionString=function(e){return e.length!==2?null:new Map([[jl.ISSUE_NUMBER,parseInt(e)]])},t}(),AUe=function(){function t(){}return t.decodeRow=function(e,r,n){var a=Hv.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new dUe;return s.decodeRow(e,r,a)}catch{var o=new hUe;return o.decodeRow(e,r,a)}},t.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),t}(),mUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_o=function(t){mUe(e,t);function e(){var r=t.call(this)||this;r.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(l){return Int32Array.from(l)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],s=new Int32Array(a.length),o=0;o<a.length;o++)s[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=s}return r}return e.prototype.decodeRow=function(r,n,a){var s=e.findStartGuardPattern(n),o=a==null?null:a.get(Ns.NEED_RESULT_POINT_CALLBACK);if(o!=null){var l=new An((s[0]+s[1])/2,r);o.foundPossibleResultPoint(l)}var c=this.decodeMiddle(n,s,this.decodeRowStringBuffer),u=c.rowOffset,d=c.resultString;if(o!=null){var f=new An(u,r);o.foundPossibleResultPoint(f)}var A=e.decodeEnd(n,u);if(o!=null){var h=new An((A[0]+A[1])/2,r);o.foundPossibleResultPoint(h)}var m=A[1],p=m+(m-A[0]);if(p>=n.getSize()||!n.isRange(m,p,!1))throw new lr;var x=d.toString();if(x.length<8)throw new qr;if(!e.checkChecksum(x))throw new oo;var v=(s[1]+s[0])/2,y=(A[1]+A[0])/2,b=this.getBarcodeFormat(),w=[new An(v,r),new An(y,r)],j=new uc(x,null,0,w,b,new Date().getTime()),I=0;try{var _=AUe.decodeRow(r,n,A[1]);j.putMetadata(jl.UPC_EAN_EXTENSION,_.getText()),j.putAllMetadata(_.getResultMetadata()),j.addResultPoints(_.getResultPoints()),I=_.getText().length}catch{}var S=a==null?null:a.get(Ns.ALLOWED_EAN_EXTENSIONS);if(S!=null){var E=!1;for(var B in S)if(I.toString()===B){E=!0;break}if(!E)throw new lr}return b===jn.EAN_13||jn.UPC_A,j},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(Hv),pUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),B$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fF=function(t){pUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0,h=0;h<6&&f<d;h++){var m=_o.decodeDigit(r,u,f,_o.L_AND_G_PATTERNS);a+=String.fromCharCode(48+m%10);try{for(var p=(s=void 0,B$(u)),x=p.next();!x.done;x=p.next()){var v=x.value;f+=v}}catch(j){s={error:j}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}m>=10&&(A|=1<<5-h)}a=e.determineFirstDigit(a,A);var y=_o.findGuardPattern(r,f,!0,_o.MIDDLE_PATTERN,new Int32Array(_o.MIDDLE_PATTERN.length).fill(0));f=y[1];for(var h=0;h<6&&f<d;h++){var m=_o.decodeDigit(r,u,f,_o.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var b=(l=void 0,B$(u)),w=b.next();!w.done;w=b.next()){var v=w.value;f+=v}}catch(_){l={error:_}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return jn.EAN_13},e.determineFirstDigit=function(r,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new lr},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(_o),gUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),T$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},k$=function(t){gUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0;A<4&&f<d;A++){var h=_o.decodeDigit(r,u,f,_o.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var m=(s=void 0,T$(u)),p=m.next();!p.done;p=m.next()){var x=p.value;f+=x}}catch(w){s={error:w}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(s)throw s.error}}}var v=_o.findGuardPattern(r,f,!0,_o.MIDDLE_PATTERN,new Int32Array(_o.MIDDLE_PATTERN.length).fill(0));f=v[1];for(var A=0;A<4&&f<d;A++){var h=_o.decodeDigit(r,u,f,_o.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var y=(l=void 0,T$(u)),b=y.next();!b.done;b=y.next()){var x=b.value;f+=x}}catch(I){l={error:I}}finally{try{b&&!b.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return jn.EAN_8},e}(_o),xUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),F$=function(t){xUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.ean13Reader=new fF,r}return e.prototype.getBarcodeFormat=function(){return jn.UPC_A},e.prototype.decode=function(r,n){return this.maybeReturnResult(this.ean13Reader.decode(r))},e.prototype.decodeRow=function(r,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,n,a))},e.prototype.decodeMiddle=function(r,n,a){return this.ean13Reader.decodeMiddle(r,n,a)},e.prototype.maybeReturnResult=function(r){var n=r.getText();if(n.charAt(0)==="0"){var a=new uc(n.substring(1),null,null,r.getResultPoints(),jn.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new lr},e.prototype.reset=function(){this.ean13Reader.reset()},e}(_o),vUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},O$=function(t){vUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=new Int32Array(4),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l=this.decodeMiddleCounters.map(function(x){return x});l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=r.getSize(),u=n[1],d=0,f=0;f<6&&u<c;f++){var A=e.decodeDigit(r,l,u,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);try{for(var h=(s=void 0,yUe(l)),m=h.next();!m.done;m=h.next()){var p=m.value;u+=p}}catch(x){s={error:x}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(s)throw s.error}}A>=10&&(d|=1<<5-f)}return e.determineNumSysAndCheckDigit(new ea(a),d),u},e.prototype.decodeEnd=function(r,n){return e.findGuardPatternWithoutCounters(r,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(r){return _o.checkChecksum(e.convertUPCEtoUPCA(r))},e.determineNumSysAndCheckDigit=function(r,n){for(var a=0;a<=1;a++)for(var s=0;s<10;s++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][s]){r.insert(0,"0"+a),r.append("0"+s);return}throw lr.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return jn.UPC_E},e.convertUPCEtoUPCA=function(r){var n=r.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new ea;a.append(r.charAt(0));var s=n[5];switch(s){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(s),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(s);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(_o),bUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),D$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$5=function(t){bUe(e,t);function e(r){var n=t.call(this)||this,a=r==null?null:r.get(Ns.POSSIBLE_FORMATS),s=[];return a!=null&&(a.indexOf(jn.EAN_13)>-1&&s.push(new fF),a.indexOf(jn.UPC_A)>-1&&s.push(new F$),a.indexOf(jn.EAN_8)>-1&&s.push(new k$),a.indexOf(jn.UPC_E)>-1&&s.push(new O$)),s.length===0&&(s.push(new fF),s.push(new F$),s.push(new k$),s.push(new O$)),n.readers=s,n}return e.prototype.decodeRow=function(r,n,a){var s,o;try{for(var l=D$(this.readers),c=l.next();!c.done;c=l.next()){var u=c.value;try{var d=u.decodeRow(r,n,a),f=d.getBarcodeFormat()===jn.EAN_13&&d.getText().charAt(0)==="0",A=a==null?null:a.get(Ns.POSSIBLE_FORMATS),h=A==null||A.includes(jn.UPC_A);if(f&&h){var m=d.getRawBytes(),p=new uc(d.getText().substring(1),m,m?m.length:null,d.getResultPoints(),jn.UPC_A);return p.putAllMetadata(d.getResultMetadata()),p}return d}catch{}}}catch(x){s={error:x}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}throw new lr},e.prototype.reset=function(){var r,n;try{for(var a=D$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;o.reset()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}(ko),wUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),NUe=function(t){wUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},r}return e.prototype.decodeRow=function(r,n,a){var s=this.getValidRowData(n);if(!s)throw new lr;var o=this.codaBarDecodeRow(s.row);if(!o)throw new lr;return new uc(o,null,0,[new An(s.left,r),new An(s.right,r)],jn.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(r){var n=r.toArray(),a=n.indexOf(!0);if(a===-1)return null;var s=n.lastIndexOf(!0);if(s<=a)return null;n=n.slice(a,s+1);for(var o=[],l=n[0],c=1,u=1;u<n.length;u++)n[u]===l?c++:(l=n[u],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:s}},e.prototype.codaBarDecodeRow=function(r){for(var n=[],a=Math.ceil(r.reduce(function(c,u){return(c+u)/2},0));r.length>0;){var s=r.splice(0,8).splice(0,7),o=s.map(function(c){return c<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var l=n.join("");return this.validCodaBarString(l)?l:null},e.prototype.validCodaBarString=function(r){var n=/^[A-D].{1,}[A-D]$/;return n.test(r)},e}(ko),CUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_Ue=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},up=function(t){CUe(e,t);function e(){var r=t.call(this)||this;return r.decodeFinderCounters=new Int32Array(4),r.dataCharacterCounters=new Int32Array(8),r.oddRoundingErrors=new Array(4),r.evenRoundingErrors=new Array(4),r.oddCounts=new Array(r.dataCharacterCounters.length/2),r.evenCounts=new Array(r.dataCharacterCounters.length/2),r}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(r,n){for(var a=0;a<n.length;a++)if(ko.patternMatchVariance(r,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new lr},e.count=function(r){return ja.sum(new Int32Array(r))},e.increment=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]>s&&(s=n[o],a=o);r[a]++},e.decrement=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]<s&&(s=n[o],a=o);r[a]--},e.isFinderPattern=function(r){var n,a,s=r[0]+r[1],o=s+r[2]+r[3],l=s/o;if(l>=e.MIN_FINDER_PATTERN_RATIO&&l<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;try{for(var d=_Ue(r),f=d.next();!f.done;f=d.next()){var A=f.value;A>u&&(u=A),A<c&&(c=A)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return u<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(ko),tI=function(){function t(e,r){this.value=e,this.checksumPortion=r}return t.prototype.getValue=function(){return this.value},t.prototype.getChecksumPortion=function(){return this.checksumPortion},t.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value&&this.checksumPortion===r.checksumPortion},t.prototype.hashCode=function(){return this.value^this.checksumPortion},t}(),wse=function(){function t(e,r,n,a,s){this.value=e,this.startEnd=r,this.value=e,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new An(n,s)),this.resultPoints.push(new An(a,s))}return t.prototype.getValue=function(){return this.value},t.prototype.getStartEnd=function(){return this.startEnd},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.hashCode=function(){return this.value},t}(),EUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xx=function(){function t(){}return t.getRSSvalue=function(e,r,n){var a,s,o=0;try{for(var l=EUe(e),c=l.next();!c.done;c=l.next()){var u=c.value;o+=u}}catch(y){a={error:y}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}for(var d=0,f=0,A=e.length,h=0;h<A-1;h++){var m=void 0;for(m=1,f|=1<<h;m<e[h];m++,f&=~(1<<h)){var p=t.combins(o-m-1,A-h-2);if(n&&f===0&&o-m-(A-h-1)>=A-h-1&&(p-=t.combins(o-m-(A-h),A-h-2)),A-h-1>1){for(var x=0,v=o-m-(A-h-2);v>r;v--)x+=t.combins(o-m-v-1,A-h-3);p-=x*(A-1-h)}else o-m>r&&p--;d+=p}o-=m}return d},t.combins=function(e,r){var n,a;e-r>r?(a=r,n=e-r):(a=e-r,n=r);for(var s=1,o=1,l=e;l>n;l--)s*=l,o<=a&&(s/=o,o++);for(;o<=a;)s/=o,o++;return s},t}(),SUe=function(){function t(){}return t.buildBitArray=function(e){var r=e.length*2-1;e[e.length-1].getRightChar()==null&&(r-=1);for(var n=12*r,a=new el(n),s=0,o=e[0],l=o.getRightChar().getValue(),c=11;c>=0;--c)l&1<<c&&a.set(s),s++;for(var c=1;c<e.length;++c){for(var u=e[c],d=u.getLeftChar().getValue(),f=11;f>=0;--f)d&1<<f&&a.set(s),s++;if(u.getRightChar()!==null)for(var A=u.getRightChar().getValue(),f=11;f>=0;--f)A&1<<f&&a.set(s),s++}return a},t}(),Jm=function(){function t(e,r){r?this.decodedInformation=null:(this.finished=e,this.decodedInformation=r)}return t.prototype.getDecodedInformation=function(){return this.decodedInformation},t.prototype.isFinished=function(){return this.finished},t}(),MR=function(){function t(e){this.newPosition=e}return t.prototype.getNewPosition=function(){return this.newPosition},t}(),IUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jd=function(t){IUe(e,t);function e(r,n){var a=t.call(this,r)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(MR),jUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zm=function(t){jUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return a?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=n,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(MR),PUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vx=function(t){PUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;if(n<0||n>10||a<0||a>10)throw new qr;return s.firstDigit=n,s.secondDigit=a,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(MR),o_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},BUe=function(){function t(){}return t.parseFieldsInGeneralPurpose=function(e){var r,n,a,s,o,l,c,u;if(!e)return null;if(e.length<2)throw new lr;var d=e.substring(0,2);try{for(var f=o_(t.TWO_DIGIT_DATA_LENGTH),A=f.next();!A.done;A=f.next()){var h=A.value;if(h[0]===d)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(2,h[2],e):t.processFixedAI(2,h[1],e)}}catch(I){r={error:I}}finally{try{A&&!A.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}if(e.length<3)throw new lr;var m=e.substring(0,3);try{for(var p=o_(t.THREE_DIGIT_DATA_LENGTH),x=p.next();!x.done;x=p.next()){var h=x.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(3,h[2],e):t.processFixedAI(3,h[1],e)}}catch(I){a={error:I}}finally{try{x&&!x.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}try{for(var v=o_(t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),y=v.next();!y.done;y=v.next()){var h=y.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){o={error:I}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(o)throw o.error}}if(e.length<4)throw new lr;var b=e.substring(0,4);try{for(var w=o_(t.FOUR_DIGIT_DATA_LENGTH),j=w.next();!j.done;j=w.next()){var h=j.value;if(h[0]===b)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){c={error:I}}finally{try{j&&!j.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}throw new lr},t.processFixedAI=function(e,r,n){if(n.length<e)throw new lr;var a=n.substring(0,e);if(n.length<e+r)throw new lr;var s=n.substring(e,e+r),o=n.substring(e+r),l="("+a+")"+s,c=t.parseFieldsInGeneralPurpose(o);return c==null?l:l+c},t.processVariableAI=function(e,r,n){var a=n.substring(0,e),s;n.length<e+r?s=n.length:s=e+r;var o=n.substring(e,s),l=n.substring(s),c="("+a+")"+o,u=t.parseFieldsInGeneralPurpose(l);return u==null?c:c+u},t.VARIABLE_LENGTH=[],t.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",t.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",t.VARIABLE_LENGTH,20],["22",t.VARIABLE_LENGTH,29],["30",t.VARIABLE_LENGTH,8],["37",t.VARIABLE_LENGTH,8],["90",t.VARIABLE_LENGTH,30],["91",t.VARIABLE_LENGTH,30],["92",t.VARIABLE_LENGTH,30],["93",t.VARIABLE_LENGTH,30],["94",t.VARIABLE_LENGTH,30],["95",t.VARIABLE_LENGTH,30],["96",t.VARIABLE_LENGTH,30],["97",t.VARIABLE_LENGTH,3],["98",t.VARIABLE_LENGTH,30],["99",t.VARIABLE_LENGTH,30]],t.THREE_DIGIT_DATA_LENGTH=[["240",t.VARIABLE_LENGTH,30],["241",t.VARIABLE_LENGTH,30],["242",t.VARIABLE_LENGTH,6],["250",t.VARIABLE_LENGTH,30],["251",t.VARIABLE_LENGTH,30],["253",t.VARIABLE_LENGTH,17],["254",t.VARIABLE_LENGTH,20],["400",t.VARIABLE_LENGTH,30],["401",t.VARIABLE_LENGTH,30],["402",17],["403",t.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",t.VARIABLE_LENGTH,20],["421",t.VARIABLE_LENGTH,15],["422",3],["423",t.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",t.VARIABLE_LENGTH,15],["391",t.VARIABLE_LENGTH,18],["392",t.VARIABLE_LENGTH,15],["393",t.VARIABLE_LENGTH,18],["703",t.VARIABLE_LENGTH,30]],t.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",t.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",t.VARIABLE_LENGTH,20],["8003",t.VARIABLE_LENGTH,30],["8004",t.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",t.VARIABLE_LENGTH,30],["8008",t.VARIABLE_LENGTH,12],["8018",18],["8020",t.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",t.VARIABLE_LENGTH,70],["8200",t.VARIABLE_LENGTH,70]],t}(),vE=function(){function t(e){this.buffer=new ea,this.information=e}return t.prototype.decodeAllCodes=function(e,r){var n=r,a=null;do{var s=this.decodeGeneralPurposeField(n,a),o=BUe.parseFieldsInGeneralPurpose(s.getNewString());if(o!=null&&e.append(o),s.isRemaining()?a=""+s.getRemainingValue():a=null,n===s.getNewPosition())break;n=s.getNewPosition()}while(!0);return e.toString()},t.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var r=e;r<e+3;++r)if(this.information.get(r))return!0;return this.information.get(e+3)},t.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var r=this.extractNumericValueFromBitArray(e,4);return r===0?new vx(this.information.getSize(),vx.FNC1,vx.FNC1):new vx(this.information.getSize(),r-1,vx.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,s=(n-8)%11;return new vx(e+7,a,s)},t.prototype.extractNumericValueFromBitArray=function(e,r){return t.extractNumericValueFromBitArray(this.information,e,r)},t.extractNumericValueFromBitArray=function(e,r,n){for(var a=0,s=0;s<n;++s)e.get(r+s)&&(a|=1<<n-s-1);return a},t.prototype.decodeGeneralPurposeField=function(e,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new Zm(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Zm(this.current.getPosition(),this.buffer.toString())},t.prototype.parseBlocks=function(){var e,r;do{var n=this.current.getPosition();this.current.isAlpha()?(r=this.parseAlphaBlock(),e=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),e=r.isFinished()):(r=this.parseNumericBlock(),e=r.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return r.getDecodedInformation()},t.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var r=void 0;return e.isSecondDigitFNC1()?r=new Zm(this.current.getPosition(),this.buffer.toString()):r=new Zm(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Jm(!0,r)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var r=new Zm(this.current.getPosition(),this.buffer.toString());return new Jm(!0,r)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Jm(!1)},t.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new Zm(this.current.getPosition(),this.buffer.toString());return new Jm(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Jm(!1)},t.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new Zm(this.current.getPosition(),this.buffer.toString());return new Jm(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Jm(!1)},t.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},t.prototype.decodeIsoIec646=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new Jd(e+5,Jd.FNC1);if(r>=5&&r<15)return new Jd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new Jd(e+7,""+(n+1));if(n>=90&&n<116)return new Jd(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),s;switch(a){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new qr}return new Jd(e+8,s)},t.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},t.prototype.decodeAlphanumeric=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new Jd(e+5,Jd.FNC1);if(r>=5&&r<15)return new Jd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new Jd(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new Gw("Decoding invalid alphanumeric value: "+n)}return new Jd(e+6,a)},t.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<5&&r+e<this.information.getSize();++r)if(r===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+r))return!1;return!0},t.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var r=e;r<e+3;++r)if(this.information.get(r))return!1;return!0},t.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<4&&r+e<this.information.getSize();++r)if(this.information.get(e+r))return!1;return!0},t}(),Nse=function(){function t(e){this.information=e,this.generalDecoder=new vE(e)}return t.prototype.getInformation=function(){return this.information},t.prototype.getGeneralDecoder=function(){return this.generalDecoder},t}(),TUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),of=function(t){TUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedGtin=function(r,n){r.append("(01)");var a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(r,n,a){for(var s=0;s<4;++s){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*s,10);o/100===0&&r.append("0"),o/10===0&&r.append("0"),r.append(o)}e.appendCheckDigit(r,a)},e.appendCheckDigit=function(r,n){for(var a=0,s=0;s<13;s++){var o=r.charAt(s+n).charCodeAt(0)-48;a+=s&1?o:3*o}a=10-a%10,a===10&&(a=0),r.append(a)},e.GTIN_SIZE=40,e}(Nse),kUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),FUe=function(t){kUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ea;r.append("(01)");var n=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(of),OUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),DUe=function(t){OUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ea;return this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(Nse),RUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yE=function(t){RUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedWeight=function(r,n,a){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(r,s);for(var o=this.checkWeight(s),l=1e5,c=0;c<5;++c)o/l===0&&r.append("0"),l/=10;r.append(o)},e}(of),MUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Cse=function(t){MUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+yE.GTIN_SIZE+e.WEIGHT_SIZE)throw new lr;var r=new ea;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+yE.GTIN_SIZE,e.WEIGHT_SIZE),r.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(yE),LUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),UUe=function(t){LUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){r.append("(3103)")},e.prototype.checkWeight=function(r){return r},e}(Cse),QUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),VUe=function(t){QUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){n<1e4?r.append("(3202)"):r.append("(3203)")},e.prototype.checkWeight=function(r){return r<1e4?r:r-1e4},e}(Cse),HUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$Ue=function(t){HUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+of.GTIN_SIZE)throw new lr;var r=new ea;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+of.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(392"),r.append(n),r.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+of.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(of),KUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),GUe=function(t){KUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+of.GTIN_SIZE)throw new lr;var r=new ea;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+of.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(393"),r.append(n),r.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+of.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&r.append("0"),a/10===0&&r.append("0"),r.append(a);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+of.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return r.append(s.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(of),qUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),g0=function(t){qUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.dateCode=a,s.firstAIdigits=n,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new lr;var r=new ea;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(r,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),r.toString()},e.prototype.encodeCompressedDate=function(r,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){r.append("("),r.append(this.dateCode),r.append(")");var s=a%32;a/=32;var o=a%12+1;a/=12;var l=a;l/10===0&&r.append("0"),r.append(l),o/10===0&&r.append("0"),r.append(o),s/10===0&&r.append("0"),r.append(s)}},e.prototype.addWeightCode=function(r,n){r.append("("),r.append(this.firstAIdigits),r.append(n/1e5),r.append(")")},e.prototype.checkWeight=function(r){return r%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(yE);function zUe(t){try{if(t.get(1))return new FUe(t);if(!t.get(2))return new DUe(t);var e=vE.extractNumericValueFromBitArray(t,1,4);switch(e){case 4:return new UUe(t);case 5:return new VUe(t)}var r=vE.extractNumericValueFromBitArray(t,1,5);switch(r){case 12:return new $Ue(t);case 13:return new GUe(t)}var n=vE.extractNumericValueFromBitArray(t,1,7);switch(n){case 56:return new g0(t,"310","11");case 57:return new g0(t,"320","11");case 58:return new g0(t,"310","13");case 59:return new g0(t,"320","13");case 60:return new g0(t,"310","15");case 61:return new g0(t,"320","15");case 62:return new g0(t,"310","17");case 63:return new g0(t,"320","17")}}catch(a){throw console.log(a),new Gw("unknown decoder: "+t)}}var R$=function(){function t(e,r,n,a){this.leftchar=e,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}return t.prototype.mayBeLast=function(){return this.maybeLast},t.prototype.getLeftChar=function(){return this.leftchar},t.prototype.getRightChar=function(){return this.rightchar},t.prototype.getFinderPattern=function(){return this.finderpattern},t.prototype.mustBeLast=function(){return this.rightchar==null},t.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},t.equals=function(e,r){return e instanceof t?t.equalsOrNull(e.leftchar,r.leftchar)&&t.equalsOrNull(e.rightchar,r.rightchar)&&t.equalsOrNull(e.finderpattern,r.finderpattern):!1},t.equalsOrNull=function(e,r){return e===null?r===null:t.equals(e,r)},t.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},t}(),WUe=function(){function t(e,r,n){this.pairs=e,this.rowNumber=r,this.wasReversed=n}return t.prototype.getPairs=function(){return this.pairs},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.isReversed=function(){return this.wasReversed},t.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},t.prototype.toString=function(){return"{ "+this.pairs+" }"},t.prototype.equals=function(e,r){return e instanceof t?this.checkEqualitity(e,r)&&e.wasReversed===r.wasReversed:!1},t.prototype.checkEqualitity=function(e,r){if(!(!e||!r)){var n;return e.forEach(function(a,s){r.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},t}(),XUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),x0=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},YUe=function(t){XUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.pairs=new Array(e.MAX_PAIRS),r.rows=new Array,r.startEnd=[2],r}return e.prototype.decodeRow=function(r,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(r,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(r,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(r,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,r))}catch(l){if(l instanceof lr){if(!this.pairs.length)throw new lr;a=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(r,!1),s){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new lr},e.prototype.checkRowsBoolean=function(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return r&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(r,n){for(var a,s,o=n;o<this.rows.length;o++){var l=this.rows[o];this.pairs.length=0;try{for(var c=(a=void 0,x0(r)),u=c.next();!u.done;u=c.next()){var d=u.value;this.pairs.push(d.getPairs())}}catch(A){a={error:A}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}if(this.pairs.push(l.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(r);f.push(l);try{return this.checkRows(f,o+1)}catch(A){console.log(A)}}}throw new lr},e.isValidSequence=function(r){var n,a;try{for(var s=x0(e.FINDER_PATTERN_SEQUENCES),o=s.next();!o.done;o=s.next()){var l=o.value;if(!(r.length>l.length)){for(var c=!0,u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!==l[u]){c=!1;break}if(c)return!0}}}catch(d){n={error:d}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(r,n){for(var a=0,s=!1,o=!1;a<this.rows.length;){var l=this.rows[a];if(l.getRowNumber()>r){o=l.isEquivalent(this.pairs);break}s=l.isEquivalent(this.pairs),a++}o||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new WUe(this.pairs,r,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(r,n){var a,s,o,l,c,u;try{for(var d=x0(n),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.getPairs().length!==r.length){var h=!0;try{for(var m=(o=void 0,x0(A.getPairs())),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,x0(r)),b=y.next();!b.done;b=y.next()){var w=b.value;if(R$.equals(x,w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}v||(h=!1)}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}}}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}},e.isPartialRow=function(r,n){var a,s,o,l,c,u;try{for(var d=x0(n),f=d.next();!f.done;f=d.next()){var A=f.value,h=!0;try{for(var m=(o=void 0,x0(r)),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,x0(A.getPairs())),b=y.next();!b.done;b=y.next()){var w=b.value;if(x.equals(w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}if(!v){h=!1;break}}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}if(h)return!0}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(r){var n=SUe.buildBitArray(r),a=zUe(n),s=a.parseInformation(),o=r[0].getFinderPattern().getResultPoints(),l=r[r.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],l[0],l[1]];return new uc(s,null,null,c,jn.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var r=this.pairs.get(0),n=r.getLeftChar(),a=r.getRightChar();if(a===null)return!1;for(var s=a.getChecksumPortion(),o=2,l=1;l<this.pairs.size();++l){var c=this.pairs.get(l);s+=c.getLeftChar().getChecksumPortion(),o++;var u=c.getRightChar();u!=null&&(s+=u.getChecksumPortion(),o++)}s%=211;var d=211*(o-4)+s;return d===n.getValue()},e.getNextSecondBar=function(r,n){var a;return r.get(n)?(a=r.getNextUnset(n),a=r.getNextSet(a)):(a=r.getNextSet(n),a=r.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(r,n,a){var s=n.length%2===0;this.startFromEven&&(s=!s);var o,l=!0,c=-1;do this.findNextPair(r,n,c),o=this.parseFoundFinderPattern(r,a,s),o===null?c=e.getNextSecondBar(r,this.startEnd[0]):l=!1;while(l);var u=this.decodeDataCharacter(r,o,s,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new lr;var d;try{d=this.decodeDataCharacter(r,o,s,!1)}catch(f){d=null,console.log(f)}return new R$(u,d,o,!0)},e.prototype.isEmptyPair=function(r){return r.length===0},e.prototype.findNextPair=function(r,n,a){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var o=r.getSize(),l;if(a>=0)l=a;else if(this.isEmptyPair(n))l=0;else{var c=n[n.length-1];l=c.getFinderPattern().getStartEnd()[1]}var u=n.length%2!==0;this.startFromEven&&(u=!u);for(var d=!1;l<o&&(d=!r.get(l),!!d);)l++;for(var f=0,A=l,h=l;h<o;h++)if(r.get(h)!==d)s[f]++;else{if(f===3){if(u&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=A,this.startEnd[1]=h;return}u&&e.reverseCounters(s),A+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,f--}else f++;s[f]=1,d=!d}throw new lr},e.reverseCounters=function(r){for(var n=r.length,a=0;a<n/2;++a){var s=r[a];r[a]=r[n-a-1],r[n-a-1]=s}},e.prototype.parseFoundFinderPattern=function(r,n,a){var s,o,l;if(a){for(var c=this.startEnd[0]-1;c>=0&&!r.get(c);)c--;c++,s=this.startEnd[0]-c,o=c,l=this.startEnd[1]}else o=this.startEnd[0],l=r.getNextUnset(this.startEnd[1]+1),s=l-this.startEnd[1];var u=this.getDecodeFinderCounters();ws.arraycopy(u,0,u,1,u.length-1),u[0]=s;var d;try{d=this.parseFinderValue(u,e.FINDER_PATTERNS)}catch{return null}return new wse(d,[o,l],o,l,n)},e.prototype.decodeDataCharacter=function(r,n,a,s){for(var o=this.getDataCharacterCounters(),l=0;l<o.length;l++)o[l]=0;if(s)e.recordPatternInReverse(r,n.getStartEnd()[0],o);else{e.recordPattern(r,n.getStartEnd()[1],o);for(var c=0,u=o.length-1;c<u;c++,u--){var d=o[c];o[c]=o[u],o[u]=d}}var f=17,A=ja.sum(new Int32Array(o))/f,h=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(A-h)/h>.3)throw new lr;for(var m=this.getOddCounts(),p=this.getEvenCounts(),x=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var y=1*o[c]/A,b=y+.5;if(b<1){if(y<.3)throw new lr;b=1}else if(b>8){if(y>8.7)throw new lr;b=8}var w=c/2;c&1?(p[w]=b,v[w]=y-b):(m[w]=b,x[w]=y-b)}this.adjustOddEvenCounts(f);for(var j=4*n.getValue()+(a?0:2)+(s?0:1)-1,I=0,_=0,c=m.length-1;c>=0;c--){if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c];_+=m[c]*S}I+=m[c]}for(var E=0,c=p.length-1;c>=0;c--)if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c+1];E+=p[c]*S}var B=_+E;if(I&1||I>13||I<4)throw new lr;var k=(13-I)/2,P=e.SYMBOL_WIDEST[k],O=9-P,z=Xx.getRSSvalue(m,P,!0),oe=Xx.getRSSvalue(p,O,!1),ce=e.EVEN_TOTAL_SUBSET[k],ue=e.GSUM[k],ge=z*ce+oe+ue;return new tI(ge,B)},e.isNotA1left=function(r,n,a){return!(r.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(r){var n=ja.sum(new Int32Array(this.getOddCounts())),a=ja.sum(new Int32Array(this.getEvenCounts())),s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);var l=!1,c=!1;a>13?c=!0:a<4&&(l=!0);var u=n+a-r,d=(n&1)===1,f=(a&1)===0;if(u===1)if(d){if(f)throw new lr;o=!0}else{if(!f)throw new lr;c=!0}else if(u===-1)if(d){if(f)throw new lr;s=!0}else{if(!f)throw new lr;l=!0}else if(u===0){if(d){if(!f)throw new lr;n<a?(s=!0,c=!0):(o=!0,l=!0)}else if(f)throw new lr}else throw new lr;if(s){if(o)throw new lr;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new lr;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(up),JUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ZUe=function(t){JUe(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.count=0,s.finderPattern=a,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(tI),e7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),K5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},M$=function(t){e7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.possibleLeftPairs=[],r.possibleRightPairs=[],r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.decodePair(n,!1,r,a);e.addOrTally(this.possibleLeftPairs,u),n.reverse();var d=this.decodePair(n,!0,r,a);e.addOrTally(this.possibleRightPairs,d),n.reverse();try{for(var f=K5(this.possibleLeftPairs),A=f.next();!A.done;A=f.next()){var h=A.value;if(h.getCount()>1)try{for(var m=(l=void 0,K5(this.possibleRightPairs)),p=m.next();!p.done;p=m.next()){var x=p.value;if(x.getCount()>1&&e.checkChecksum(h,x))return e.constructResult(h,x)}}catch(v){l={error:v}}finally{try{p&&!p.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}}}catch(v){s={error:v}}finally{try{A&&!A.done&&(o=f.return)&&o.call(f)}finally{if(s)throw s.error}}throw new lr},e.addOrTally=function(r,n){var a,s;if(n!=null){var o=!1;try{for(var l=K5(r),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.getValue()===n.getValue()){u.incrementCount(),o=!0;break}}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}o||r.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(r,n){for(var a=4537077*r.getValue()+n.getValue(),s=new String(a).toString(),o=new ea,l=13-s.length;l>0;l--)o.append("0");o.append(s);for(var c=0,l=0;l<13;l++){var u=o.charAt(l).charCodeAt(0)-48;c+=l&1?u:3*u}c=10-c%10,c===10&&(c=0),o.append(c.toString());var d=r.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new uc(o.toString(),null,0,[d[0],d[1],f[0],f[1]],jn.RSS_14,new Date().getTime())},e.checkChecksum=function(r,n){var a=(r.getChecksumPortion()+16*n.getChecksumPortion())%79,s=9*r.getFinderPattern().getValue()+n.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,a===s},e.prototype.decodePair=function(r,n,a,s){try{var o=this.findFinderPattern(r,n),l=this.parseFoundFinderPattern(r,a,n,o),c=s==null?null:s.get(Ns.NEED_RESULT_POINT_CALLBACK);if(c!=null){var u=(o[0]+o[1])/2;n&&(u=r.getSize()-1-u),c.foundPossibleResultPoint(new An(u,a))}var d=this.decodeDataCharacter(r,l,!0),f=this.decodeDataCharacter(r,l,!1);return new ZUe(1597*d.getValue()+f.getValue(),d.getChecksumPortion()+4*f.getChecksumPortion(),l)}catch{return null}},e.prototype.decodeDataCharacter=function(r,n,a){for(var s=this.getDataCharacterCounters(),o=0;o<s.length;o++)s[o]=0;if(a)ko.recordPatternInReverse(r,n.getStartEnd()[0],s);else{ko.recordPattern(r,n.getStartEnd()[1]+1,s);for(var l=0,c=s.length-1;l<c;l++,c--){var u=s[l];s[l]=s[c],s[c]=u}}for(var d=a?16:15,f=ja.sum(new Int32Array(s))/d,A=this.getOddCounts(),h=this.getEvenCounts(),m=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors(),l=0;l<s.length;l++){var x=s[l]/f,v=Math.floor(x+.5);v<1?v=1:v>8&&(v=8);var y=Math.floor(l/2);l&1?(h[y]=v,p[y]=x-v):(A[y]=v,m[y]=x-v)}this.adjustOddEvenCounts(a,d);for(var b=0,w=0,l=A.length-1;l>=0;l--)w*=9,w+=A[l],b+=A[l];for(var j=0,I=0,l=h.length-1;l>=0;l--)j*=9,j+=h[l],I+=h[l];var _=w+3*j;if(a){if(b&1||b>12||b<4)throw new lr;var S=(12-b)/2,E=e.OUTSIDE_ODD_WIDEST[S],B=9-E,k=Xx.getRSSvalue(A,E,!1),P=Xx.getRSSvalue(h,B,!0),O=e.OUTSIDE_EVEN_TOTAL_SUBSET[S],z=e.OUTSIDE_GSUM[S];return new tI(k*O+P+z,_)}else{if(I&1||I>10||I<4)throw new lr;var S=(10-I)/2,E=e.INSIDE_ODD_WIDEST[S],B=9-E,k=Xx.getRSSvalue(A,E,!0),P=Xx.getRSSvalue(h,B,!1),oe=e.INSIDE_ODD_TOTAL_SUBSET[S],z=e.INSIDE_GSUM[S];return new tI(P*oe+k+z,_)}},e.prototype.findFinderPattern=function(r,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var s=r.getSize(),o=!1,l=0;l<s&&(o=!r.get(l),n!==o);)l++;for(var c=0,u=l,d=l;d<s;d++)if(r.get(d)!==o)a[c]++;else{if(c===3){if(up.isFinderPattern(a))return[u,d];u+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,o=!o}throw new lr},e.prototype.parseFoundFinderPattern=function(r,n,a,s){for(var o=r.get(s[0]),l=s[0]-1;l>=0&&o!==r.get(l);)l--;l++;var c=s[0]-l,u=this.getDecodeFinderCounters(),d=new Int32Array(u.length);ws.arraycopy(u,0,d,1,u.length-1),d[0]=c;var f=this.parseFinderValue(d,e.FINDER_PATTERNS),A=l,h=s[1];return a&&(A=r.getSize()-1-A,h=r.getSize()-1-h),new wse(f,[l,s[1]],A,h,n)},e.prototype.adjustOddEvenCounts=function(r,n){var a=ja.sum(new Int32Array(this.getOddCounts())),s=ja.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1,c=!1,u=!1;r?(a>12?l=!0:a<4&&(o=!0),s>12?u=!0:s<4&&(c=!0)):(a>11?l=!0:a<5&&(o=!0),s>10?u=!0:s<4&&(c=!0));var d=a+s-n,f=(a&1)===(r?1:0),A=(s&1)===1;if(d===1)if(f){if(A)throw new lr;l=!0}else{if(!A)throw new lr;u=!0}else if(d===-1)if(f){if(A)throw new lr;o=!0}else{if(!A)throw new lr;c=!0}else if(d===0){if(f){if(!A)throw new lr;a<s?(o=!0,u=!0):(l=!0,c=!0)}else if(A)throw new lr}else throw new lr;if(o){if(l)throw new lr;up.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&up.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(u)throw new lr;up.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&up.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(up),t7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yx=function(t){t7e(e,t);function e(r){var n=t.call(this)||this;n.readers=[];var a=r?r.get(Ns.POSSIBLE_FORMATS):null,s=r&&r.get(Ns.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=r&&r.get(Ns.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(jn.EAN_13)||a.includes(jn.UPC_A)||a.includes(jn.EAN_8)||a.includes(jn.UPC_E))&&n.readers.push(new $5(r)),a.includes(jn.CODE_39)&&n.readers.push(new I$(s,o)),a.includes(jn.CODE_93)&&n.readers.push(new j$),a.includes(jn.CODE_128)&&n.readers.push(new S$),a.includes(jn.ITF)&&n.readers.push(new P$),a.includes(jn.CODABAR)&&n.readers.push(new NUe),a.includes(jn.RSS_14)&&n.readers.push(new M$),a.includes(jn.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new YUe))),n.readers.length===0&&(n.readers.push(new $5(r)),n.readers.push(new I$),n.readers.push(new j$),n.readers.push(new $5(r)),n.readers.push(new S$),n.readers.push(new P$),n.readers.push(new M$)),n}return e.prototype.decodeRow=function(r,n,a){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(r,n,a)}catch{}throw new lr},e.prototype.reset=function(){this.readers.forEach(function(r){return r.reset()})},e}(ko),r7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){r7e(e,t);function e(r,n){return r===void 0&&(r=500),t.call(this,new Yx(n),r,n)||this}return e})(w1);var L$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},La=function(){function t(e,r,n){this.ecCodewords=e,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}return t.prototype.getECCodewords=function(){return this.ecCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),Fa=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),n7e=function(){function t(e,r,n,a,s,o){var l,c;this.versionNumber=e,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=s,this.ecBlocks=o;var u=0,d=o.getECCodewords(),f=o.getECBlocks();try{for(var A=L$(f),h=A.next();!h.done;h=A.next()){var m=h.value;u+=m.getCount()*(m.getDataCodewords()+d)}}catch(p){l={error:p}}finally{try{h&&!h.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}this.totalCodewords=u}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},t.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},t.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},t.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t.getVersionForDimensions=function(e,r){var n,a;if(e&1||r&1)throw new qr;try{for(var s=L$(t.VERSIONS),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.symbolSizeRows===e&&l.symbolSizeColumns===r)return l}}catch(c){n={error:c}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}throw new qr},t.prototype.toString=function(){return""+this.versionNumber},t.buildVersions=function(){return[new t(1,10,10,8,8,new La(5,new Fa(1,3))),new t(2,12,12,10,10,new La(7,new Fa(1,5))),new t(3,14,14,12,12,new La(10,new Fa(1,8))),new t(4,16,16,14,14,new La(12,new Fa(1,12))),new t(5,18,18,16,16,new La(14,new Fa(1,18))),new t(6,20,20,18,18,new La(18,new Fa(1,22))),new t(7,22,22,20,20,new La(20,new Fa(1,30))),new t(8,24,24,22,22,new La(24,new Fa(1,36))),new t(9,26,26,24,24,new La(28,new Fa(1,44))),new t(10,32,32,14,14,new La(36,new Fa(1,62))),new t(11,36,36,16,16,new La(42,new Fa(1,86))),new t(12,40,40,18,18,new La(48,new Fa(1,114))),new t(13,44,44,20,20,new La(56,new Fa(1,144))),new t(14,48,48,22,22,new La(68,new Fa(1,174))),new t(15,52,52,24,24,new La(42,new Fa(2,102))),new t(16,64,64,14,14,new La(56,new Fa(2,140))),new t(17,72,72,16,16,new La(36,new Fa(4,92))),new t(18,80,80,18,18,new La(48,new Fa(4,114))),new t(19,88,88,20,20,new La(56,new Fa(4,144))),new t(20,96,96,22,22,new La(68,new Fa(4,174))),new t(21,104,104,24,24,new La(56,new Fa(6,136))),new t(22,120,120,18,18,new La(68,new Fa(6,175))),new t(23,132,132,20,20,new La(62,new Fa(8,163))),new t(24,144,144,22,22,new La(62,new Fa(8,156),new Fa(2,155))),new t(25,8,18,6,16,new La(7,new Fa(1,5))),new t(26,8,32,6,14,new La(11,new Fa(1,10))),new t(27,12,26,10,24,new La(14,new Fa(1,16))),new t(28,12,36,10,16,new La(18,new Fa(1,22))),new t(29,16,36,14,16,new La(24,new Fa(1,32))),new t(30,16,48,14,22,new La(28,new Fa(1,49)))]},t.VERSIONS=t.buildVersions(),t}(),a7e=function(){function t(e){var r=e.getHeight();if(r<8||r>144||r&1)throw new qr;this.version=t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new lh(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return t.prototype.getVersion=function(){return this.version},t.readVersion=function(e){var r=e.getHeight(),n=e.getWidth();return n7e.getVersionForDimensions(r,n)},t.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),r=0,n=4,a=0,s=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),l=!1,c=!1,u=!1,d=!1;do if(n===s&&a===0&&!l)e[r++]=this.readCorner1(s,o)&255,n-=2,a+=2,l=!0;else if(n===s-2&&a===0&&o&3&&!c)e[r++]=this.readCorner2(s,o)&255,n-=2,a+=2,c=!0;else if(n===s+4&&a===2&&!(o&7)&&!u)e[r++]=this.readCorner3(s,o)&255,n-=2,a+=2,u=!0;else if(n===s-2&&a===0&&(o&7)===4&&!d)e[r++]=this.readCorner4(s,o)&255,n-=2,a+=2,d=!0;else{do n<s&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n+=2,a-=2;while(n<s&&a>=0);n+=3,a+=1}while(n<s||a<o);if(r!==this.version.getTotalCodewords())throw new qr;return e},t.prototype.readModule=function(e,r,n,a){return e<0&&(e+=n,r+=4-(n+4&7)),r<0&&(r+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(r,e),this.mappingBitMatrix.get(r,e)},t.prototype.readUtah=function(e,r,n,a){var s=0;return this.readModule(e-2,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-2,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r,n,a)&&(s|=1),s<<=1,this.readModule(e,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e,r,n,a)&&(s|=1),s},t.prototype.readCorner1=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,1,e,r)&&(n|=1),n<<=1,this.readModule(e-1,2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.readCorner2=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-4,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner3=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-3,e,r)&&(n|=1),n<<=1,this.readModule(1,r-2,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner4=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.extractDataRegion=function(e){var r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==r)throw new Pn("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),o=r/a|0,l=n/s|0,c=o*a,u=l*s,d=new lh(u,c),f=0;f<o;++f)for(var A=f*a,h=0;h<l;++h)for(var m=h*s,p=0;p<a;++p)for(var x=f*(a+2)+1+p,v=A+p,y=0;y<s;++y){var b=h*(s+2)+1+y;if(e.get(b,x)){var w=m+y;d.set(w,v)}}return d},t}(),U$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r){var n,a,s,o,l=r.getECBlocks(),c=0,u=l.getECBlocks();try{for(var d=U$(u),f=d.next();!f.done;f=d.next()){var A=f.value;c+=A.getCount()}}catch(z){n={error:z}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}var h=new Array(c),m=0;try{for(var p=U$(u),x=p.next();!x.done;x=p.next())for(var A=x.value,v=0;v<A.getCount();v++){var y=A.getDataCodewords(),b=l.getECCodewords()+y;h[m++]=new t(y,new Uint8Array(b))}}catch(z){s={error:z}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}for(var w=h[0].codewords.length,j=w-l.getECCodewords(),I=j-1,_=0,v=0;v<I;v++)for(var S=0;S<m;S++)h[S].codewords[v]=e[_++];for(var E=r.getVersionNumber()===24,B=E?8:m,S=0;S<B;S++)h[S].codewords[j-1]=e[_++];for(var k=h[0].codewords.length,v=j;v<k;v++)for(var S=0;S<m;S++){var P=E?(S+8)%m:S,O=E&&P>7?v-1:v;h[P].codewords[O]=e[_++]}if(_!==e.length)throw new Pn;return h},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),_se=function(){function t(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new Pn(""+e);var r=0,n=this.bitOffset,a=this.byteOffset,s=this.bytes;if(n>0){var o=8-n,l=e<o?e:o,c=o-l,u=255>>8-l<<c;r=(s[a]&u)>>c,e-=l,n+=l,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)r=r<<8|s[a]&255,a++,e-=8;if(e>0){var c=8-e,u=255>>c<<c;r=r<<e|(s[a]&u)>>c,n+=e}}return this.bitOffset=n,this.byteOffset=a,r},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t}(),yo;(function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"})(yo||(yo={}));var i7e=function(){function t(){}return t.decode=function(e){var r=new _se(e),n=new ea,a=new ea,s=new Array,o=yo.ASCII_ENCODE;do if(o===yo.ASCII_ENCODE)o=this.decodeAsciiSegment(r,n,a);else{switch(o){case yo.C40_ENCODE:this.decodeC40Segment(r,n);break;case yo.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case yo.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case yo.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case yo.BASE256_ENCODE:this.decodeBase256Segment(r,n,s);break;default:throw new qr}o=yo.ASCII_ENCODE}while(o!==yo.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new vP(e,n.toString(),s.length===0?null:s,null)},t.decodeAsciiSegment=function(e,r,n){var a=!1;do{var s=e.readBits(8);if(s===0)throw new qr;if(s<=128)return a&&(s+=128),r.append(String.fromCharCode(s-1)),yo.ASCII_ENCODE;if(s===129)return yo.PAD_ENCODE;if(s<=229){var o=s-130;o<10&&r.append("0"),r.append(""+o)}else switch(s){case 230:return yo.C40_ENCODE;case 231:return yo.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return yo.ANSIX12_ENCODE;case 239:return yo.TEXT_ENCODE;case 240:return yo.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new qr;break}}while(e.available()>0);return yo.ASCII_ENCODE},t.decodeC40Segment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var u=this.C40_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new qr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var u=this.C40_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new qr}s=0;break;case 3:n?(r.append(String.fromCharCode(c+224)),n=!1):r.append(String.fromCharCode(c+96)),s=0;break;default:throw new qr}}}while(e.available()>0)},t.decodeTextSegment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var u=this.TEXT_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new qr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var u=this.TEXT_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new qr}s=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var u=this.TEXT_SHIFT3_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u),s=0}else throw new qr;break;default:throw new qr}}}while(e.available()>0)},t.decodeAnsiX12Segment=function(e,r){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var s=0;s<3;s++){var o=n[s];switch(o){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(o<14)r.append(String.fromCharCode(o+44));else if(o<40)r.append(String.fromCharCode(o+51));else throw new qr;break}}}while(e.available()>0)},t.parseTwoBytes=function(e,r,n){var a=(e<<8)+r-1,s=Math.floor(a/1600);n[0]=s,a-=s*1600,s=Math.floor(a/40),n[1]=s,n[2]=a-s*40},t.decodeEdifactSegment=function(e,r){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}a&32||(a|=64),r.append(String.fromCharCode(a))}}while(e.available()>0)},t.decodeBase256Segment=function(e,r,n){var a=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),a++),o;if(s===0?o=e.available()/8|0:s<250?o=s:o=250*(s-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new qr;for(var l=new Uint8Array(o),c=0;c<o;c++){if(e.available()<8)throw new qr;l[c]=this.unrandomize255State(e.readBits(8),a++)}n.push(l);try{r.append(Bd.decode(l,ba.ISO88591))}catch(u){throw new Gw("Platform does not support required encoding: "+u.message)}},t.unrandomize255State=function(e,r){var n=149*r%255+1,a=e-n;return a>=0?a:a+256},t.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],t.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.TEXT_SHIFT2_SET_CHARS=t.C40_SHIFT2_SET_CHARS,t.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],t}(),o7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l7e=function(){function t(){this.rsDecoder=new yP(Jc.DATA_MATRIX_FIELD_256)}return t.prototype.decode=function(e){var r,n,a=new a7e(e),s=a.getVersion(),o=a.readCodewords(),l=s7e.getDataBlocks(o,s),c=0;try{for(var u=o7e(l),d=u.next();!d.done;d=u.next()){var f=d.value;c+=f.getNumDataCodewords()}}catch(b){r={error:b}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}for(var A=new Uint8Array(c),h=l.length,m=0;m<h;m++){var p=l[m],x=p.getCodewords(),v=p.getNumDataCodewords();this.correctErrors(x,v);for(var y=0;y<v;y++)A[y*h+m]=x[y]}return i7e.decode(A)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new oo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),c7e=function(){function t(e){this.image=e,this.rectangleDetector=new dF(this.image)}return t.prototype.detect=function(){var e=this.rectangleDetector.detect(),r=this.detectSolid1(e);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new lr;r=this.shiftToModuleCenter(r);var n=r[0],a=r[1],s=r[2],o=r[3],l=this.transitionsBetween(n,o)+1,c=this.transitionsBetween(s,o)+1;(l&1)===1&&(l+=1),(c&1)===1&&(c+=1),4*l<7*c&&4*c<7*l&&(l=c=Math.max(l,c));var u=t.sampleGrid(this.image,n,a,s,o,l,c);return new DR(u,[n,a,s,o])},t.shiftPoint=function(e,r,n){var a=(r.getX()-e.getX())/(n+1),s=(r.getY()-e.getY())/(n+1);return new An(e.getX()+a,e.getY()+s)},t.moveAway=function(e,r,n){var a=e.getX(),s=e.getY();return a<r?a-=1:a+=1,s<n?s-=1:s+=1,new An(a,s)},t.prototype.detectSolid1=function(e){var r=e[0],n=e[1],a=e[3],s=e[2],o=this.transitionsBetween(r,n),l=this.transitionsBetween(n,a),c=this.transitionsBetween(a,s),u=this.transitionsBetween(s,r),d=o,f=[s,r,n,a];return d>l&&(d=l,f[0]=r,f[1]=n,f[2]=a,f[3]=s),d>c&&(d=c,f[0]=n,f[1]=a,f[2]=s,f[3]=r),d>u&&(f[0]=a,f[1]=s,f[2]=r,f[3]=n),f},t.prototype.detectSolid2=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=t.shiftPoint(n,a,(o+1)*4),c=t.shiftPoint(a,n,(o+1)*4),u=this.transitionsBetween(l,r),d=this.transitionsBetween(c,s);return u<d?(e[0]=r,e[1]=n,e[2]=a,e[3]=s):(e[0]=n,e[1]=a,e[2]=s,e[3]=r),e},t.prototype.correctTopRight=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=this.transitionsBetween(n,s),c=t.shiftPoint(r,n,(l+1)*4),u=t.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(c,s),l=this.transitionsBetween(u,s);var d=new An(s.getX()+(a.getX()-n.getX())/(o+1),s.getY()+(a.getY()-n.getY())/(o+1)),f=new An(s.getX()+(r.getX()-n.getX())/(l+1),s.getY()+(r.getY()-n.getY())/(l+1));if(!this.isValid(d))return this.isValid(f)?f:null;if(!this.isValid(f))return d;var A=this.transitionsBetween(c,d)+this.transitionsBetween(u,d),h=this.transitionsBetween(c,f)+this.transitionsBetween(u,f);return A>h?d:f},t.prototype.shiftToModuleCenter=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s)+1,l=this.transitionsBetween(a,s)+1,c=t.shiftPoint(r,n,l*4),u=t.shiftPoint(a,n,o*4);o=this.transitionsBetween(c,s)+1,l=this.transitionsBetween(u,s)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);var d=(r.getX()+n.getX()+a.getX()+s.getX())/4,f=(r.getY()+n.getY()+a.getY()+s.getY())/4;r=t.moveAway(r,d,f),n=t.moveAway(n,d,f),a=t.moveAway(a,d,f),s=t.moveAway(s,d,f);var A,h;return c=t.shiftPoint(r,n,l*4),c=t.shiftPoint(c,s,o*4),A=t.shiftPoint(n,r,l*4),A=t.shiftPoint(A,a,o*4),u=t.shiftPoint(a,s,l*4),u=t.shiftPoint(u,n,o*4),h=t.shiftPoint(s,a,l*4),h=t.shiftPoint(h,r,o*4),[c,A,u,h]},t.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},t.sampleGrid=function(e,r,n,a,s,o,l){var c=RR.getInstance();return c.sampleGrid(e,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,r.getX(),r.getY(),s.getX(),s.getY(),a.getX(),a.getY(),n.getX(),n.getY())},t.prototype.transitionsBetween=function(e,r){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),s=Math.trunc(r.getX()),o=Math.trunc(r.getY()),l=Math.abs(o-a)>Math.abs(s-n);if(l){var c=n;n=a,a=c,c=s,s=o,o=c}for(var u=Math.abs(s-n),d=Math.abs(o-a),f=-u/2,A=a<o?1:-1,h=n<s?1:-1,m=0,p=this.image.get(l?a:n,l?n:a),x=n,v=a;x!==s;x+=h){var y=this.image.get(l?v:x,l?x:v);if(y!==p&&(m++,p=y),f+=d,f>0){if(v===o)break;v+=A,f-=u}}return m},t}(),rI=function(){function t(){this.decoder=new l7e}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n,a;if(r!=null&&r.has(Ns.PURE_BARCODE)){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(s),a=t.NO_POINTS}else{var o=new c7e(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var l=n.getRawBytes(),c=new uc(n.getText(),l,8*l.length,a,jn.DATA_MATRIX,ws.currentTimeMillis()),u=n.getByteSegments();u!=null&&c.putMetadata(jl.BYTE_SEGMENTS,u);var d=n.getECLevel();return d!=null&&c.putMetadata(jl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r==null||n==null)throw new lr;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0],u=(c-l+1)/a,d=(o-s+1)/a;if(u<=0||d<=0)throw new lr;var f=a/2;s+=f,l+=f;for(var A=new lh(u,d),h=0;h<d;h++)for(var m=s+h*a,p=0;p<u;p++)e.get(l+p*a,m)&&A.set(p,h);return A},t.moduleSize=function(e,r){for(var n=r.getWidth(),a=e[0],s=e[1];a<n&&r.get(a,s);)a++;if(a===n)throw new lr;var o=a-e[0];if(o===0)throw new lr;return o},t.NO_POINTS=[],t}(),u7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){u7e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new rI,r)||this}return e})(w1);var Jx;(function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"})(Jx||(Jx={}));var d7e=function(){function t(e,r,n){this.value=e,this.stringValue=r,this.bits=n,t.FOR_BITS.set(n,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new Qi(e+"not available")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new Pn;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t(Jx.L,"L",1),t.M=new t(Jx.M,"M",0),t.Q=new t(Jx.Q,"Q",3),t.H=new t(Jx.H,"H",2),t}(),f7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ese=function(){function t(e){this.errorCorrectionLevel=d7e.forBits(e>>3&3),this.dataMask=e&7}return t.numBitsDiffering=function(e,r){return sa.bitCount(e^r)},t.decodeFormatInformation=function(e,r){var n=t.doDecodeFormatInformation(e,r);return n!==null?n:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,r^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,r){var n,a,s=Number.MAX_SAFE_INTEGER,o=0;try{for(var l=f7e(t.FORMAT_INFO_DECODE_LOOKUP),c=l.next();!c.done;c=l.next()){var u=c.value,d=u[0];if(d===e||d===r)return new t(u[1]);var f=t.numBitsDiffering(e,d);f<s&&(o=u[1],s=f),e!==r&&(f=t.numBitsDiffering(r,d),f<s&&(o=u[1],s=f))}}catch(A){n={error:A}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s<=3?new t(o):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t}(),h7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zt=function(){function t(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=r}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var e,r,n=0,a=this.ecBlocks;try{for(var s=h7e(a),o=s.next();!o.done;o=s.next()){var l=o.value;n+=l.getCount()}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),ut=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),A7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$p=function(){function t(e,r){for(var n,a,s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=r,this.ecBlocks=s;var l=0,c=s[0].getECCodewordsPerBlock(),u=s[0].getECBlocks();try{for(var d=A7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;l+=A.getCount()*(A.getDataCodewords()+c)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this.totalCodewords=l}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},t.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new qr;try{return this.getVersionForNumber((e-17)/4)}catch{throw new qr}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new Pn;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var r=Number.MAX_SAFE_INTEGER,n=0,a=0;a<t.VERSION_DECODE_INFO.length;a++){var s=t.VERSION_DECODE_INFO[a];if(s===e)return t.getVersionForNumber(a+7);var o=Ese.numBitsDiffering(e,s);o<r&&(n=a+7,r=o)}return r<=3?t.getVersionForNumber(n):null},t.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),r=new lh(e);r.setRegion(0,0,9,9),r.setRegion(e-8,0,8,9),r.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var s=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||r.setRegion(this.alignmentPatternCenters[o]-2,s,5,5);return r.setRegion(6,9,1,e-17),r.setRegion(9,6,e-17,1),this.versionNumber>6&&(r.setRegion(e-11,0,3,6),r.setRegion(0,e-11,6,3)),r},t.prototype.toString=function(){return""+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new zt(7,new ut(1,19)),new zt(10,new ut(1,16)),new zt(13,new ut(1,13)),new zt(17,new ut(1,9))),new t(2,Int32Array.from([6,18]),new zt(10,new ut(1,34)),new zt(16,new ut(1,28)),new zt(22,new ut(1,22)),new zt(28,new ut(1,16))),new t(3,Int32Array.from([6,22]),new zt(15,new ut(1,55)),new zt(26,new ut(1,44)),new zt(18,new ut(2,17)),new zt(22,new ut(2,13))),new t(4,Int32Array.from([6,26]),new zt(20,new ut(1,80)),new zt(18,new ut(2,32)),new zt(26,new ut(2,24)),new zt(16,new ut(4,9))),new t(5,Int32Array.from([6,30]),new zt(26,new ut(1,108)),new zt(24,new ut(2,43)),new zt(18,new ut(2,15),new ut(2,16)),new zt(22,new ut(2,11),new ut(2,12))),new t(6,Int32Array.from([6,34]),new zt(18,new ut(2,68)),new zt(16,new ut(4,27)),new zt(24,new ut(4,19)),new zt(28,new ut(4,15))),new t(7,Int32Array.from([6,22,38]),new zt(20,new ut(2,78)),new zt(18,new ut(4,31)),new zt(18,new ut(2,14),new ut(4,15)),new zt(26,new ut(4,13),new ut(1,14))),new t(8,Int32Array.from([6,24,42]),new zt(24,new ut(2,97)),new zt(22,new ut(2,38),new ut(2,39)),new zt(22,new ut(4,18),new ut(2,19)),new zt(26,new ut(4,14),new ut(2,15))),new t(9,Int32Array.from([6,26,46]),new zt(30,new ut(2,116)),new zt(22,new ut(3,36),new ut(2,37)),new zt(20,new ut(4,16),new ut(4,17)),new zt(24,new ut(4,12),new ut(4,13))),new t(10,Int32Array.from([6,28,50]),new zt(18,new ut(2,68),new ut(2,69)),new zt(26,new ut(4,43),new ut(1,44)),new zt(24,new ut(6,19),new ut(2,20)),new zt(28,new ut(6,15),new ut(2,16))),new t(11,Int32Array.from([6,30,54]),new zt(20,new ut(4,81)),new zt(30,new ut(1,50),new ut(4,51)),new zt(28,new ut(4,22),new ut(4,23)),new zt(24,new ut(3,12),new ut(8,13))),new t(12,Int32Array.from([6,32,58]),new zt(24,new ut(2,92),new ut(2,93)),new zt(22,new ut(6,36),new ut(2,37)),new zt(26,new ut(4,20),new ut(6,21)),new zt(28,new ut(7,14),new ut(4,15))),new t(13,Int32Array.from([6,34,62]),new zt(26,new ut(4,107)),new zt(22,new ut(8,37),new ut(1,38)),new zt(24,new ut(8,20),new ut(4,21)),new zt(22,new ut(12,11),new ut(4,12))),new t(14,Int32Array.from([6,26,46,66]),new zt(30,new ut(3,115),new ut(1,116)),new zt(24,new ut(4,40),new ut(5,41)),new zt(20,new ut(11,16),new ut(5,17)),new zt(24,new ut(11,12),new ut(5,13))),new t(15,Int32Array.from([6,26,48,70]),new zt(22,new ut(5,87),new ut(1,88)),new zt(24,new ut(5,41),new ut(5,42)),new zt(30,new ut(5,24),new ut(7,25)),new zt(24,new ut(11,12),new ut(7,13))),new t(16,Int32Array.from([6,26,50,74]),new zt(24,new ut(5,98),new ut(1,99)),new zt(28,new ut(7,45),new ut(3,46)),new zt(24,new ut(15,19),new ut(2,20)),new zt(30,new ut(3,15),new ut(13,16))),new t(17,Int32Array.from([6,30,54,78]),new zt(28,new ut(1,107),new ut(5,108)),new zt(28,new ut(10,46),new ut(1,47)),new zt(28,new ut(1,22),new ut(15,23)),new zt(28,new ut(2,14),new ut(17,15))),new t(18,Int32Array.from([6,30,56,82]),new zt(30,new ut(5,120),new ut(1,121)),new zt(26,new ut(9,43),new ut(4,44)),new zt(28,new ut(17,22),new ut(1,23)),new zt(28,new ut(2,14),new ut(19,15))),new t(19,Int32Array.from([6,30,58,86]),new zt(28,new ut(3,113),new ut(4,114)),new zt(26,new ut(3,44),new ut(11,45)),new zt(26,new ut(17,21),new ut(4,22)),new zt(26,new ut(9,13),new ut(16,14))),new t(20,Int32Array.from([6,34,62,90]),new zt(28,new ut(3,107),new ut(5,108)),new zt(26,new ut(3,41),new ut(13,42)),new zt(30,new ut(15,24),new ut(5,25)),new zt(28,new ut(15,15),new ut(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new zt(28,new ut(4,116),new ut(4,117)),new zt(26,new ut(17,42)),new zt(28,new ut(17,22),new ut(6,23)),new zt(30,new ut(19,16),new ut(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new zt(28,new ut(2,111),new ut(7,112)),new zt(28,new ut(17,46)),new zt(30,new ut(7,24),new ut(16,25)),new zt(24,new ut(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new zt(30,new ut(4,121),new ut(5,122)),new zt(28,new ut(4,47),new ut(14,48)),new zt(30,new ut(11,24),new ut(14,25)),new zt(30,new ut(16,15),new ut(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new zt(30,new ut(6,117),new ut(4,118)),new zt(28,new ut(6,45),new ut(14,46)),new zt(30,new ut(11,24),new ut(16,25)),new zt(30,new ut(30,16),new ut(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new zt(26,new ut(8,106),new ut(4,107)),new zt(28,new ut(8,47),new ut(13,48)),new zt(30,new ut(7,24),new ut(22,25)),new zt(30,new ut(22,15),new ut(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new zt(28,new ut(10,114),new ut(2,115)),new zt(28,new ut(19,46),new ut(4,47)),new zt(28,new ut(28,22),new ut(6,23)),new zt(30,new ut(33,16),new ut(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new zt(30,new ut(8,122),new ut(4,123)),new zt(28,new ut(22,45),new ut(3,46)),new zt(30,new ut(8,23),new ut(26,24)),new zt(30,new ut(12,15),new ut(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new zt(30,new ut(3,117),new ut(10,118)),new zt(28,new ut(3,45),new ut(23,46)),new zt(30,new ut(4,24),new ut(31,25)),new zt(30,new ut(11,15),new ut(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new zt(30,new ut(7,116),new ut(7,117)),new zt(28,new ut(21,45),new ut(7,46)),new zt(30,new ut(1,23),new ut(37,24)),new zt(30,new ut(19,15),new ut(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new zt(30,new ut(5,115),new ut(10,116)),new zt(28,new ut(19,47),new ut(10,48)),new zt(30,new ut(15,24),new ut(25,25)),new zt(30,new ut(23,15),new ut(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new zt(30,new ut(13,115),new ut(3,116)),new zt(28,new ut(2,46),new ut(29,47)),new zt(30,new ut(42,24),new ut(1,25)),new zt(30,new ut(23,15),new ut(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new zt(30,new ut(17,115)),new zt(28,new ut(10,46),new ut(23,47)),new zt(30,new ut(10,24),new ut(35,25)),new zt(30,new ut(19,15),new ut(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new zt(30,new ut(17,115),new ut(1,116)),new zt(28,new ut(14,46),new ut(21,47)),new zt(30,new ut(29,24),new ut(19,25)),new zt(30,new ut(11,15),new ut(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new zt(30,new ut(13,115),new ut(6,116)),new zt(28,new ut(14,46),new ut(23,47)),new zt(30,new ut(44,24),new ut(7,25)),new zt(30,new ut(59,16),new ut(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new zt(30,new ut(12,121),new ut(7,122)),new zt(28,new ut(12,47),new ut(26,48)),new zt(30,new ut(39,24),new ut(14,25)),new zt(30,new ut(22,15),new ut(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new zt(30,new ut(6,121),new ut(14,122)),new zt(28,new ut(6,47),new ut(34,48)),new zt(30,new ut(46,24),new ut(10,25)),new zt(30,new ut(2,15),new ut(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new zt(30,new ut(17,122),new ut(4,123)),new zt(28,new ut(29,46),new ut(14,47)),new zt(30,new ut(49,24),new ut(10,25)),new zt(30,new ut(24,15),new ut(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new zt(30,new ut(4,122),new ut(18,123)),new zt(28,new ut(13,46),new ut(32,47)),new zt(30,new ut(48,24),new ut(14,25)),new zt(30,new ut(42,15),new ut(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new zt(30,new ut(20,117),new ut(4,118)),new zt(28,new ut(40,47),new ut(7,48)),new zt(30,new ut(43,24),new ut(22,25)),new zt(30,new ut(10,15),new ut(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new zt(30,new ut(19,118),new ut(6,119)),new zt(28,new ut(18,47),new ut(31,48)),new zt(30,new ut(34,24),new ut(34,25)),new zt(30,new ut(20,15),new ut(61,16)))],t}(),$o;(function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"})($o||($o={}));var Q$=function(){function t(e,r){this.value=e,this.isMasked=r}return t.prototype.unmaskBitMatrix=function(e,r){for(var n=0;n<r;n++)for(var a=0;a<r;a++)this.isMasked(n,a)&&e.flip(a,n)},t.values=new Map([[$o.DATA_MASK_000,new t($o.DATA_MASK_000,function(e,r){return(e+r&1)===0})],[$o.DATA_MASK_001,new t($o.DATA_MASK_001,function(e,r){return(e&1)===0})],[$o.DATA_MASK_010,new t($o.DATA_MASK_010,function(e,r){return r%3===0})],[$o.DATA_MASK_011,new t($o.DATA_MASK_011,function(e,r){return(e+r)%3===0})],[$o.DATA_MASK_100,new t($o.DATA_MASK_100,function(e,r){return(Math.floor(e/2)+Math.floor(r/3)&1)===0})],[$o.DATA_MASK_101,new t($o.DATA_MASK_101,function(e,r){return e*r%6===0})],[$o.DATA_MASK_110,new t($o.DATA_MASK_110,function(e,r){return e*r%6<3})],[$o.DATA_MASK_111,new t($o.DATA_MASK_111,function(e,r){return(e+r+e*r%3&1)===0})]]),t}(),m7e=function(){function t(e){var r=e.getHeight();if(r<21||(r&3)!==1)throw new qr;this.bitMatrix=e}return t.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,r=0;r<6;r++)e=this.copyBit(r,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),s=0,o=a-7,n=a-1;n>=o;n--)s=this.copyBit(8,n,s);for(var r=a-8;r<a;r++)s=this.copyBit(r,8,s);if(this.parsedFormatInfo=Ese.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new qr},t.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),r=Math.floor((e-17)/4);if(r<=6)return $p.getVersionForNumber(r);for(var n=0,a=e-11,s=5;s>=0;s--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,s,n);var l=$p.decodeVersionInformation(n);if(l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;n=0;for(var o=5;o>=0;o--)for(var s=e-9;s>=a;s--)n=this.copyBit(o,s,n);if(l=$p.decodeVersionInformation(n),l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;throw new qr},t.prototype.copyBit=function(e,r,n){var a=this.isMirror?this.bitMatrix.get(r,e):this.bitMatrix.get(e,r);return a?n<<1|1:n<<1},t.prototype.readCodewords=function(){var e=this.readFormatInformation(),r=this.readVersion(),n=Q$.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var s=r.buildFunctionPattern(),o=!0,l=new Uint8Array(r.getTotalCodewords()),c=0,u=0,d=0,f=a-1;f>0;f-=2){f===6&&f--;for(var A=0;A<a;A++)for(var h=o?a-1-A:A,m=0;m<2;m++)s.get(f-m,h)||(d++,u<<=1,this.bitMatrix.get(f-m,h)&&(u|=1),d===8&&(l[c++]=u,d=0,u=0));o=!o}if(c!==r.getTotalCodewords())throw new qr;return l},t.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=Q$.values.get(this.parsedFormatInfo.getDataMask()),r=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},t.prototype.mirror=function(){for(var e=this.bitMatrix,r=0,n=e.getWidth();r<n;r++)for(var a=r+1,s=e.getHeight();a<s;a++)e.get(r,a)!==e.get(a,r)&&(e.flip(a,r),e.flip(r,a))},t}(),V$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},p7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r,n){var a,s,o,l;if(e.length!==r.getTotalCodewords())throw new Pn;var c=r.getECBlocksForLevel(n),u=0,d=c.getECBlocks();try{for(var f=V$(d),A=f.next();!A.done;A=f.next()){var h=A.value;u+=h.getCount()}}catch(O){a={error:O}}finally{try{A&&!A.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}var m=new Array(u),p=0;try{for(var x=V$(d),v=x.next();!v.done;v=x.next())for(var h=v.value,y=0;y<h.getCount();y++){var b=h.getDataCodewords(),w=c.getECCodewordsPerBlock()+b;m[p++]=new t(b,new Uint8Array(w))}}catch(O){o={error:O}}finally{try{v&&!v.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}for(var j=m[0].codewords.length,I=m.length-1;I>=0;){var _=m[I].codewords.length;if(_===j)break;I--}I++;for(var S=j-c.getECCodewordsPerBlock(),E=0,y=0;y<S;y++)for(var B=0;B<p;B++)m[B].codewords[y]=e[E++];for(var B=I;B<p;B++)m[B].codewords[S]=e[E++];for(var k=m[0].codewords.length,y=S;y<k;y++)for(var B=0;B<p;B++){var P=B<I?y:y+1;m[B].codewords[P]=e[E++]}return m},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),hd;(function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"})(hd||(hd={}));var Is=function(){function t(e,r,n,a){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,t.FOR_BITS.set(a,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var r=t.FOR_BITS.get(e);if(r===void 0)throw new Pn;return r},t.prototype.getCharacterCountBits=function(e){var r=e.getVersionNumber(),n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(hd.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(hd.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(hd.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(hd.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),t.BYTE=new t(hd.BYTE,"BYTE",Int32Array.from([8,16,16]),4),t.ECI=new t(hd.ECI,"ECI",Int32Array.from([0,0,0]),7),t.KANJI=new t(hd.KANJI,"KANJI",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(hd.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(hd.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),t.HANZI=new t(hd.HANZI,"HANZI",Int32Array.from([8,10,12]),13),t}(),g7e=function(){function t(){}return t.decode=function(e,r,n,a){var s=new _se(e),o=new ea,l=new Array,c=-1,u=-1;try{var d=null,f=!1,A=void 0;do{if(s.available()<4)A=Is.TERMINATOR;else{var h=s.readBits(4);A=Is.forBits(h)}switch(A){case Is.TERMINATOR:break;case Is.FNC1_FIRST_POSITION:case Is.FNC1_SECOND_POSITION:f=!0;break;case Is.STRUCTURED_APPEND:if(s.available()<16)throw new qr;c=s.readBits(8),u=s.readBits(8);break;case Is.ECI:var m=t.parseECIValue(s);if(d=jo.getCharacterSetECIByValue(m),d===null)throw new qr;break;case Is.HANZI:var p=s.readBits(4),x=s.readBits(A.getCharacterCountBits(r));p===t.GB2312_SUBSET&&t.decodeHanziSegment(s,o,x);break;default:var v=s.readBits(A.getCharacterCountBits(r));switch(A){case Is.NUMERIC:t.decodeNumericSegment(s,o,v);break;case Is.ALPHANUMERIC:t.decodeAlphanumericSegment(s,o,v,f);break;case Is.BYTE:t.decodeByteSegment(s,o,v,d,l,a);break;case Is.KANJI:t.decodeKanjiSegment(s,o,v);break;default:throw new qr}break}}while(A!==Is.TERMINATOR)}catch{throw new qr}return new vP(e,o.toString(),l.length===0?null:l,n===null?null:n.toString(),c,u)},t.decodeHanziSegment=function(e,r,n){if(n*13>e.available())throw new qr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,a[s]=l>>8&255,a[s+1]=l&255,s+=2,n--}try{r.append(Bd.decode(a,ba.GB2312))}catch(c){throw new qr(c)}},t.decodeKanjiSegment=function(e,r,n){if(n*13>e.available())throw new qr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,a[s]=l>>8,a[s+1]=l,s+=2,n--}try{r.append(Bd.decode(a,ba.SHIFT_JIS))}catch(c){throw new qr(c)}},t.decodeByteSegment=function(e,r,n,a,s,o){if(8*n>e.available())throw new qr;for(var l=new Uint8Array(n),c=0;c<n;c++)l[c]=e.readBits(8);var u;a===null?u=ba.guessEncoding(l,o):u=a.getName();try{r.append(Bd.decode(l,u))}catch(d){throw new qr(d)}s.push(l)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new qr;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,r,n,a){for(var s=r.length();n>1;){if(e.available()<11)throw new qr;var o=e.readBits(11);r.append(t.toAlphaNumericChar(Math.floor(o/45))),r.append(t.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new qr;r.append(t.toAlphaNumericChar(e.readBits(6)))}if(a)for(var l=s;l<r.length();l++)r.charAt(l)==="%"&&(l<r.length()-1&&r.charAt(l+1)==="%"?r.deleteCharAt(l+1):r.setCharAt(l,""))},t.decodeNumericSegment=function(e,r,n){for(;n>=3;){if(e.available()<10)throw new qr;var a=e.readBits(10);if(a>=1e3)throw new qr;r.append(t.toAlphaNumericChar(Math.floor(a/100))),r.append(t.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(t.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new qr;var s=e.readBits(7);if(s>=100)throw new qr;r.append(t.toAlphaNumericChar(Math.floor(s/10))),r.append(t.toAlphaNumericChar(s%10))}else if(n===1){if(e.available()<4)throw new qr;var o=e.readBits(4);if(o>=10)throw new qr;r.append(t.toAlphaNumericChar(o))}},t.parseECIValue=function(e){var r=e.readBits(8);if(!(r&128))return r&127;if((r&192)===128){var n=e.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){var a=e.readBits(16);return(r&31)<<16&4294967295|a}throw new qr},t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.GB2312_SUBSET=1,t}(),Sse=function(){function t(e){this.mirrored=e}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var r=e[0];e[0]=e[2],e[2]=r}},t}(),H$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},x7e=function(){function t(){this.rsDecoder=new yP(Jc.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(e,r){return this.decodeBitMatrix(lh.parseFromBooleanArray(e),r)},t.prototype.decodeBitMatrix=function(e,r){var n=new m7e(e),a=null;try{return this.decodeBitMatrixParser(n,r)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var s=this.decodeBitMatrixParser(n,r);return s.setOther(new Sse(!0)),s}catch(o){throw a!==null?a:o}},t.prototype.decodeBitMatrixParser=function(e,r){var n,a,s,o,l=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),u=e.readCodewords(),d=p7e.getDataBlocks(u,l,c),f=0;try{for(var A=H$(d),h=A.next();!h.done;h=A.next()){var m=h.value;f+=m.getNumDataCodewords()}}catch(I){n={error:I}}finally{try{h&&!h.done&&(a=A.return)&&a.call(A)}finally{if(n)throw n.error}}var p=new Uint8Array(f),x=0;try{for(var v=H$(d),y=v.next();!y.done;y=v.next()){var m=y.value,b=m.getCodewords(),w=m.getNumDataCodewords();this.correctErrors(b,w);for(var j=0;j<w;j++)p[x++]=b[j]}}catch(I){s={error:I}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(s)throw s.error}}return g7e.decode(p,l,c,r)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new oo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),v7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),y7e=function(t){v7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.estimatedModuleSize=a,s}return e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=(this.getX()+n)/2,o=(this.getY()+r)/2,l=(this.estimatedModuleSize+a)/2;return new e(s,o,l)},e}(An),b7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},w7e=function(){function t(e,r,n,a,s,o,l){this.image=e,this.startX=r,this.startY=n,this.width=a,this.height=s,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var e=this.startX,r=this.height,n=this.width,a=e+n,s=this.startY+r/2,o=new Int32Array(3),l=this.image,c=0;c<r;c++){var u=s+(c&1?-Math.floor((c+1)/2):Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var d=e;d<a&&!l.get(d,u);)d++;for(var f=0;d<a;){if(l.get(d,u))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,d);if(A!==null)return A}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;d++}if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,a);if(A!==null)return A}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new lr},t.centerFromEnd=function(e,r){return r-e[2]-e[1]/2},t.prototype.foundPatternCross=function(e){for(var r=this.moduleSize,n=r/2,a=0;a<3;a++)if(Math.abs(r-e[a])>=n)return!1;return!0},t.prototype.crossCheckVertical=function(e,r,n,a){var s=this.image,o=s.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;for(var c=e;c>=0&&s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&!s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c)&&l[1]<=n;)l[1]++,c++;if(c===o||l[1]>n)return NaN;for(;c<o&&!s.get(r,c)&&l[2]<=n;)l[2]++,c++;if(l[2]>n)return NaN;var u=l[0]+l[1]+l[2];return 5*Math.abs(u-a)>=2*a?NaN:this.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n){var a,s,o=e[0]+e[1]+e[2],l=t.centerFromEnd(e,n),c=this.crossCheckVertical(r,l,2*e[1],o);if(!isNaN(c)){var u=(e[0]+e[1]+e[2])/3;try{for(var d=b7e(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.aboutEquals(u,c,l))return A.combineEstimate(c,l,u)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}var h=new y7e(l,c,u);this.possibleCenters.push(h),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(h)}return null},t}(),N7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),C7e=function(t){N7e(e,t);function e(r,n,a,s){var o=t.call(this,r,n)||this;return o.estimatedModuleSize=a,o.count=s,s===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=this.count+1,o=(this.count*this.getX()+n)/s,l=(this.count*this.getY()+r)/s,c=(this.count*this.estimatedModuleSize+a)/s;return new e(o,l,c,s)},e}(An),_7e=function(){function t(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t}(),vy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},E7e=function(){function t(e,r){this.image=e,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var r=e!=null&&e.get(Ns.TRY_HARDER)!==void 0,n=e!=null&&e.get(Ns.PURE_BARCODE)!==void 0,a=this.image,s=a.getHeight(),o=a.getWidth(),l=Math.floor(3*s/(4*t.MAX_MODULES));(l<t.MIN_SKIP||r)&&(l=t.MIN_SKIP);for(var c=!1,u=new Int32Array(5),d=l-1;d<s&&!c;d+=l){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;for(var f=0,A=0;A<o;A++)if(a.get(A,d))(f&1)===1&&f++,u[f]++;else if(f&1)u[f]++;else if(f===4)if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,A,n);if(h===!0)if(l=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var m=this.findRowSkip();m>u[2]&&(d+=m-u[2]-l,A=o-1)}else{u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;continue}f=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;else u[++f]++;if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,o,n);h===!0&&(l=u[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var p=this.selectBestPatterns();return An.orderBestPatterns(p),new _7e(p)},t.centerFromEnd=function(e,r){return r-e[4]-e[3]-e[2]/2},t.foundPatternCross=function(e){for(var r=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;r+=a}if(r<7)return!1;var s=r/7,o=s/2;return Math.abs(s-e[0])<o&&Math.abs(s-e[1])<o&&Math.abs(3*s-e[2])<3*o&&Math.abs(s-e[3])<o&&Math.abs(s-e[4])<o},t.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},t.prototype.crossCheckDiagonal=function(e,r,n,a){for(var s=this.getCrossCheckStateCount(),o=0,l=this.image;e>=o&&r>=o&&l.get(r-o,e-o);)s[2]++,o++;if(e<o||r<o)return!1;for(;e>=o&&r>=o&&!l.get(r-o,e-o)&&s[1]<=n;)s[1]++,o++;if(e<o||r<o||s[1]>n)return!1;for(;e>=o&&r>=o&&l.get(r-o,e-o)&&s[0]<=n;)s[0]++,o++;if(s[0]>n)return!1;var c=l.getHeight(),u=l.getWidth();for(o=1;e+o<c&&r+o<u&&l.get(r+o,e+o);)s[2]++,o++;if(e+o>=c||r+o>=u)return!1;for(;e+o<c&&r+o<u&&!l.get(r+o,e+o)&&s[3]<n;)s[3]++,o++;if(e+o>=c||r+o>=u||s[3]>=n)return!1;for(;e+o<c&&r+o<u&&l.get(r+o,e+o)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return!1;var d=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(d-a)<2*a&&t.foundPatternCross(s)},t.prototype.crossCheckVertical=function(e,r,n,a){for(var s=this.image,o=s.getHeight(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(r,c);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(r,c)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(r,c)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=2*a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.crossCheckHorizontal=function(e,r,n,a){for(var s=this.image,o=s.getWidth(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(c,r);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(c,r)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(c,r)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(c,r);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(c,r)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(c,r)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n,a){var s=e[0]+e[1]+e[2]+e[3]+e[4],o=t.centerFromEnd(e,n),l=this.crossCheckVertical(r,Math.floor(o),e[2],s);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),e[2],s),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),e[2],s)))){for(var c=s/7,u=!1,d=this.possibleCenters,f=0,A=d.length;f<A;f++){var h=d[f];if(h.aboutEquals(c,l,o)){d[f]=h.combineEstimate(l,o,c),u=!0;break}}if(!u){var m=new C7e(o,l,c);d.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return!0}return!1},t.prototype.findRowSkip=function(){var e,r,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var s=vy(this.possibleCenters),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.getCount()>=t.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,r,n,a,s=0,o=0,l=this.possibleCenters.length;try{for(var c=vy(this.possibleCenters),u=c.next();!u.done;u=c.next()){var d=u.value;d.getCount()>=t.CENTER_QUORUM&&(s++,o+=d.getEstimatedModuleSize())}}catch(p){e={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(s<3)return!1;var f=o/l,A=0;try{for(var h=vy(this.possibleCenters),m=h.next();!m.done;m=h.next()){var d=m.value;A+=Math.abs(d.getEstimatedModuleSize()-f)}}catch(p){n={error:p}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return A<=.05*o},t.prototype.selectBestPatterns=function(){var e,r,n,a,s=this.possibleCenters.length;if(s<3)throw new lr;var o=this.possibleCenters,l;if(s>3){var c=0,u=0;try{for(var d=vy(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value,h=A.getEstimatedModuleSize();c+=h,u+=h*h}}catch(j){e={error:j}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}l=c/s;var m=Math.sqrt(u/s-l*l);o.sort(function(j,I){var _=Math.abs(I.getEstimatedModuleSize()-l),S=Math.abs(j.getEstimatedModuleSize()-l);return _<S?-1:_>S?1:0});for(var p=Math.max(.2*l,m),x=0;x<o.length&&o.length>3;x++){var v=o[x];Math.abs(v.getEstimatedModuleSize()-l)>p&&(o.splice(x,1),x--)}}if(o.length>3){var c=0;try{for(var y=vy(o),b=y.next();!b.done;b=y.next()){var w=b.value;c+=w.getEstimatedModuleSize()}}catch(I){n={error:I}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}l=c/o.length,o.sort(function(I,_){if(_.getCount()===I.getCount()){var S=Math.abs(_.getEstimatedModuleSize()-l),E=Math.abs(I.getEstimatedModuleSize()-l);return S<E?1:S>E?-1:0}else return _.getCount()-I.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t}(),S7e=function(){function t(e){this.image=e}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(Ns.NEED_RESULT_POINT_CALLBACK);var r=new E7e(this.image,this.resultPointCallback),n=r.find(e);return this.processFinderPatternInfo(n)},t.prototype.processFinderPatternInfo=function(e){var r=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),s=this.calculateModuleSize(r,n,a);if(s<1)throw new lr("No pattern found in proccess finder.");var o=t.computeDimension(r,n,a,s),l=$p.getProvisionalVersionForDimension(o),c=l.getDimensionForVersion()-7,u=null;if(l.getAlignmentPatternCenters().length>0)for(var d=n.getX()-r.getX()+a.getX(),f=n.getY()-r.getY()+a.getY(),A=1-3/c,h=Math.floor(r.getX()+A*(d-r.getX())),m=Math.floor(r.getY()+A*(f-r.getY())),p=4;p<=16;p<<=1)try{u=this.findAlignmentInRegion(s,h,m,p);break}catch(b){if(!(b instanceof lr))throw b}var x=t.createTransform(r,n,a,u,o),v=t.sampleGrid(this.image,x,o),y;return u===null?y=[a,r,n]:y=[a,r,n,u],new DR(v,y)},t.createTransform=function(e,r,n,a,s){var o=s-3.5,l,c,u,d;return a!==null?(l=a.getX(),c=a.getY(),u=o-3,d=u):(l=r.getX()-e.getX()+n.getX(),c=r.getY()-e.getY()+n.getY(),u=o,d=o),bse.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,d,3.5,o,e.getX(),e.getY(),r.getX(),r.getY(),l,c,n.getX(),n.getY())},t.sampleGrid=function(e,r,n){var a=RR.getInstance();return a.sampleGridWithTransform(e,n,n,r)},t.computeDimension=function(e,r,n,a){var s=ja.round(An.distance(e,r)/a),o=ja.round(An.distance(e,n)/a),l=Math.floor((s+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new lr("Dimensions could be not found.")}return l},t.prototype.calculateModuleSize=function(e,r,n){return(this.calculateModuleSizeOneWay(e,r)+this.calculateModuleSizeOneWay(e,n))/2},t.prototype.calculateModuleSizeOneWay=function(e,r){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,r,n,a){var s=this.sizeOfBlackWhiteBlackRun(e,r,n,a),o=1,l=e-(n-e);l<0?(o=e/(e-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(l-e),l=this.image.getWidth()-1);var c=Math.floor(r-(a-r)*o);return o=1,c<0?(o=r/(r-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-r)/(c-r),c=this.image.getHeight()-1),l=Math.floor(e+(l-e)*o),s+=this.sizeOfBlackWhiteBlackRun(e,r,l,c),s-1},t.prototype.sizeOfBlackWhiteBlackRun=function(e,r,n,a){var s=Math.abs(a-r)>Math.abs(n-e);if(s){var o=e;e=r,r=o,o=n,n=a,a=o}for(var l=Math.abs(n-e),c=Math.abs(a-r),u=-l/2,d=e<n?1:-1,f=r<a?1:-1,A=0,h=n+d,m=e,p=r;m!==h;m+=d){var x=s?p:m,v=s?m:p;if(A===1===this.image.get(x,v)){if(A===2)return ja.distance(m,p,e,r);A++}if(u+=c,u>0){if(p===a)break;p+=f,u-=l}}return A===2?ja.distance(n+d,a,e,r):NaN},t.prototype.findAlignmentInRegion=function(e,r,n,a){var s=Math.floor(a*e),o=Math.max(0,r-s),l=Math.min(this.image.getWidth()-1,r+s);if(l-o<e*3)throw new lr("Alignment top exceeds estimated module size.");var c=Math.max(0,n-s),u=Math.min(this.image.getHeight()-1,n+s);if(u-c<e*3)throw new lr("Alignment bottom exceeds estimated module size.");var d=new w7e(this.image,o,c,l-o,u-c,e,this.resultPointCallback);return d.find()},t}(),nI=function(){function t(){this.decoder=new x7e}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,r){var n,a;if(r!=null&&r.get(Ns.PURE_BARCODE)!==void 0){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(s,r),a=t.NO_POINTS}else{var o=new S7e(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(o.getBits(),r),a=o.getPoints()}n.getOther()instanceof Sse&&n.getOther().applyMirroredCorrection(a);var l=new uc(n.getText(),n.getRawBytes(),void 0,a,jn.QR_CODE,void 0),c=n.getByteSegments();c!==null&&l.putMetadata(jl.BYTE_SEGMENTS,c);var u=n.getECLevel();return u!==null&&l.putMetadata(jl.ERROR_CORRECTION_LEVEL,u),n.hasStructuredAppend()&&(l.putMetadata(jl.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),l.putMetadata(jl.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),l},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r===null||n===null)throw new lr;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0];if(l>=c||s>=o)throw new lr;if(o-s!==c-l&&(c=l+(o-s),c>=e.getWidth()))throw new lr;var u=Math.round((c-l+1)/a),d=Math.round((o-s+1)/a);if(u<=0||d<=0)throw new lr;if(d!==u)throw new lr;var f=Math.floor(a/2);s+=f,l+=f;var A=l+Math.floor((u-1)*a)-c;if(A>0){if(A>f)throw new lr;l-=A}var h=s+Math.floor((d-1)*a)-o;if(h>0){if(h>f)throw new lr;s-=h}for(var m=new lh(u,d),p=0;p<d;p++)for(var x=s+Math.floor(p*a),v=0;v<u;v++)e.get(l+Math.floor(v*a),x)&&m.set(v,p);return m},t.moduleSize=function(e,r){for(var n=r.getHeight(),a=r.getWidth(),s=e[0],o=e[1],l=!0,c=0;s<a&&o<n;){if(l!==r.get(s,o)){if(++c===5)break;l=!l}s++,o++}if(s===a||o===n)throw new lr;return(s-e[0])/7},t.NO_POINTS=new Array,t}(),I7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Na=function(){function t(){}return t.prototype.PDF417Common=function(){},t.getBitCountSum=function(e){return ja.sum(e)},t.toIntArray=function(e){var r,n;if(e==null||!e.length)return t.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),s=0;try{for(var o=I7e(e),l=o.next();!l.done;l=o.next()){var c=l.value;a[s++]=c}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},t.getCodeword=function(e){var r=Bo.binarySearch(t.SYMBOL_TABLE,e&262143);return r<0?-1:(t.CODEWORD_TABLE[r]-1)%t.NUMBER_OF_CODEWORDS},t.NUMBER_OF_CODEWORDS=929,t.MAX_CODEWORDS_IN_BARCODE=t.NUMBER_OF_CODEWORDS-1,t.MIN_ROWS_IN_BARCODE=3,t.MAX_ROWS_IN_BARCODE=90,t.MODULES_IN_CODEWORD=17,t.MODULES_IN_STOP_PATTERN=18,t.BARS_IN_MODULE=8,t.EMPTY_INT_ARRAY=new Int32Array([]),t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),t}(),j7e=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),P7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},B7e=function(){function t(){}return t.detectMultiple=function(e,r,n){var a=e.getBlackMatrix(),s=t.detect(n,a);return s.length||(a=a.clone(),a.rotate180(),s=t.detect(n,a)),new j7e(a,s)},t.detect=function(e,r){for(var n,a,s=new Array,o=0,l=0,c=!1;o<r.getHeight();){var u=t.findVertices(r,o,l);if(u[0]==null&&u[3]==null){if(!c)break;c=!1,l=0;try{for(var d=(n=void 0,P7e(s)),f=d.next();!f.done;f=d.next()){var A=f.value;A[1]!=null&&(o=Math.trunc(Math.max(o,A[1].getY()))),A[3]!=null&&(o=Math.max(o,Math.trunc(A[3].getY())))}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o+=t.ROW_STEP;continue}if(c=!0,s.push(u),!e)break;u[2]!=null?(l=Math.trunc(u[2].getX()),o=Math.trunc(u[2].getY())):(l=Math.trunc(u[4].getX()),o=Math.trunc(u[4].getY()))}return s},t.findVertices=function(e,r,n){var a=e.getHeight(),s=e.getWidth(),o=new Array(8);return t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.START_PATTERN),t.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY())),t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.STOP_PATTERN),t.INDEXES_STOP_PATTERN),o},t.copyToResult=function(e,r,n){for(var a=0;a<n.length;a++)e[n[a]]=r[a]},t.findRowsWithPattern=function(e,r,n,a,s,o){for(var l=new Array(4),c=!1,u=new Int32Array(o.length);a<r;a+=t.ROW_STEP){var d=t.findGuardPattern(e,s,a,n,!1,o,u);if(d!=null){for(;a>0;){var f=t.findGuardPattern(e,s,--a,n,!1,o,u);if(f!=null)d=f;else{a++;break}}l[0]=new An(d[0],a),l[1]=new An(d[1],a),c=!0;break}}var A=a+1;if(c){for(var h=0,f=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);A<r;A++){var d=t.findGuardPattern(e,f[0],A,n,!1,o,u);if(d!=null&&Math.abs(f[0]-d[0])<t.MAX_PATTERN_DRIFT&&Math.abs(f[1]-d[1])<t.MAX_PATTERN_DRIFT)f=d,h=0;else{if(h>t.SKIPPED_ROW_COUNT_MAX)break;h++}}A-=h+1,l[2]=new An(f[0],A),l[3]=new An(f[1],A)}return A-a<t.BARCODE_MIN_HEIGHT&&Bo.fill(l,null),l},t.findGuardPattern=function(e,r,n,a,s,o,l){Bo.fillWithin(l,0,l.length,0);for(var c=r,u=0;e.get(c,n)&&c>0&&u++<t.MAX_PIXEL_DRIFT;)c--;for(var d=c,f=0,A=o.length,h=s;d<a;d++){var m=e.get(d,n);if(m!==h)l[f]++;else{if(f===A-1){if(t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return new Int32Array([c,d]);c+=l[0]+l[1],ws.arraycopy(l,2,l,0,f-1),l[f-1]=0,l[f]=0,f--}else f++;l[f]=1,h=!h}}return f===A-1&&t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE?new Int32Array([c,d-1]):null},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return 1/0;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return 1/0;u+=h}return u/s},t.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),t.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),t.MAX_AVG_VARIANCE=.42,t.MAX_INDIVIDUAL_VARIANCE=.8,t.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),t.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),t.MAX_PIXEL_DRIFT=3,t.MAX_PATTERN_DRIFT=5,t.SKIPPED_ROW_COUNT_MAX=25,t.ROW_STEP=5,t.BARCODE_MIN_HEIGHT=10,t}(),T7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Sp=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),ws.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){var r,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var s=T7e(this.coefficients),o=s.next();!o.done;o=s.next()){var l=o.value;a=this.field.add(a,l)}}catch(f){r={error:f}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}for(var c=this.coefficients[0],u=this.coefficients.length,d=1;d<u;d++)c=this.field.add(this.field.multiply(e,c),this.coefficients[d]);return c},t.prototype.add=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ws.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=this.field.add(r[l-o],n[l]);return new t(this.field,s)},t.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},t.prototype.multiply=function(e){return e instanceof t?this.multiplyOther(e):this.multiplyScalar(e)},t.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new t(this.field,new Int32Array([0]));for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=0;l<n;l++)for(var c=r[l],u=0;u<s;u++)o[l+u]=this.field.add(o[l+u],this.field.multiply(c,a[u]));return new t(this.field,o)},t.prototype.negative=function(){for(var e=this.coefficients.length,r=new Int32Array(e),n=0;n<e;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new t(this.field,r)},t.prototype.multiplyScalar=function(e){if(e===0)return new t(this.field,new Int32Array([0]));if(e===1)return this;for(var r=this.coefficients.length,n=new Int32Array(r),a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new t(this.field,n)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return new t(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),s=0;s<n;s++)a[s]=this.field.multiply(this.coefficients[s],r);return new t(this.field,a)},t.prototype.toString=function(){for(var e=new ea,r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(r===0||n!==1)&&e.append(n),r!==0&&(r===1?e.append("x"):(e.append("x^"),e.append(r))))}return e.toString()},t}(),k7e=function(){function t(){}return t.prototype.add=function(e,r){return(e+r)%this.modulus},t.prototype.subtract=function(e,r){return(this.modulus+e-r)%this.modulus},t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.prototype.inverse=function(e){if(e===0)throw new yse;return this.expTable[this.modulus-this.logTable[e]-1]},t.prototype.multiply=function(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.modulus-1)]},t.prototype.getSize=function(){return this.modulus},t.prototype.equals=function(e){return e===this},t}(),F7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),O7e=function(t){F7e(e,t);function e(r,n){var a=t.call(this)||this;a.modulus=r,a.expTable=new Int32Array(r),a.logTable=new Int32Array(r);for(var s=1,o=0;o<r;o++)a.expTable[o]=s,s=s*n%r;for(var o=0;o<r-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new Sp(a,new Int32Array([0])),a.one=new Sp(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new Sp(this,a)},e.PDF417_GF=new e(Na.NUMBER_OF_CODEWORDS,3),e}(k7e),D7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},R7e=function(){function t(){this.field=O7e.PDF417_GF}return t.prototype.decode=function(e,r,n){for(var a,s,o=new Sp(this.field,e),l=new Int32Array(r),c=!1,u=r;u>0;u--){var d=o.evaluateAt(this.field.exp(u));l[r-u]=d,d!==0&&(c=!0)}if(!c)return 0;var f=this.field.getOne();if(n!=null)try{for(var A=D7e(n),h=A.next();!h.done;h=A.next()){var m=h.value,p=this.field.exp(e.length-1-m),x=new Sp(this.field,new Int32Array([this.field.subtract(0,p),1]));f=f.multiply(x)}}catch(S){a={error:S}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}for(var v=new Sp(this.field,l),y=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),v,r),b=y[0],w=y[1],j=this.findErrorLocations(b),I=this.findErrorMagnitudes(w,b,j),u=0;u<j.length;u++){var _=e.length-1-this.field.log(j[u]);if(_<0)throw oo.getChecksumInstance();e[_]=this.field.subtract(e[_],I[u])}return j.length},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=e,o=r,l=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(n/2);){var u=s,d=l;if(s=o,l=c,s.isZero())throw oo.getChecksumInstance();o=u;for(var f=this.field.getZero(),A=s.getCoefficient(s.getDegree()),h=this.field.inverse(A);o.getDegree()>=s.getDegree()&&!o.isZero();){var m=o.getDegree()-s.getDegree(),p=this.field.multiply(o.getCoefficient(o.getDegree()),h);f=f.add(this.field.buildMonomial(m,p)),o=o.subtract(s.multiplyByMonomial(m,p))}c=f.multiply(l).subtract(d).negative()}var x=c.getCoefficient(0);if(x===0)throw oo.getChecksumInstance();var v=this.field.inverse(x),y=c.multiply(v),b=o.multiply(v);return[y,b]},t.prototype.findErrorLocations=function(e){for(var r=e.getDegree(),n=new Int32Array(r),a=0,s=1;s<this.field.getSize()&&a<r;s++)e.evaluateAt(s)===0&&(n[a]=this.field.inverse(s),a++);if(a!==r)throw oo.getChecksumInstance();return n},t.prototype.findErrorMagnitudes=function(e,r,n){for(var a=r.getDegree(),s=new Int32Array(a),o=1;o<=a;o++)s[a-o]=this.field.multiply(o,r.getCoefficient(o));for(var l=new Sp(this.field,s),c=n.length,u=new Int32Array(c),o=0;o<c;o++){var d=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(d)),A=this.field.inverse(l.evaluateAt(d));u[o]=this.field.multiply(f,A)}return u},t}(),hF=function(){function t(e,r,n,a,s){e instanceof t?this.constructor_2(e):this.constructor_1(e,r,n,a,s)}return t.prototype.constructor_1=function(e,r,n,a,s){var o=r==null||n==null,l=a==null||s==null;if(o&&l)throw new lr;o?(r=new An(0,a.getY()),n=new An(0,s.getY())):l&&(a=new An(e.getWidth()-1,r.getY()),s=new An(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=s,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),s.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))},t.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},t.merge=function(e,r){return e==null?r:r==null?e:new t(e.image,e.topLeft,e.bottomLeft,r.topRight,r.bottomRight)},t.prototype.addMissingRows=function(e,r,n){var a=this.topLeft,s=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(e>0){var c=n?this.topLeft:this.topRight,u=Math.trunc(c.getY()-e);u<0&&(u=0);var d=new An(c.getX(),u);n?a=d:o=d}if(r>0){var f=n?this.bottomLeft:this.bottomRight,A=Math.trunc(f.getY()+r);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);var h=new An(f.getX(),A);n?s=h:l=h}return new t(this.image,a,s,o,l)},t.prototype.getMinX=function(){return this.minX},t.prototype.getMaxX=function(){return this.maxX},t.prototype.getMinY=function(){return this.minY},t.prototype.getMaxY=function(){return this.maxY},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getBottomRight=function(){return this.bottomRight},t}(),M7e=function(){function t(e,r,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}return t.prototype.getColumnCount=function(){return this.columnCount},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},t.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},t}(),LR=function(){function t(){this.buffer=""}return t.form=function(e,r){var n=-1;function a(o,l,c,u,d,f){if(o==="%%")return"%";if(r[++n]!==void 0){o=u?parseInt(u.substr(1)):void 0;var A=d?parseInt(d.substr(1)):void 0,h;switch(f){case"s":h=r[n];break;case"c":h=r[n][0];break;case"f":h=parseFloat(r[n]).toFixed(o);break;case"p":h=parseFloat(r[n]).toPrecision(o);break;case"e":h=parseFloat(r[n]).toExponential(o);break;case"x":h=parseInt(r[n]).toString(A||16);break;case"d":h=parseFloat(parseInt(r[n],A||10).toPrecision(o)).toFixed(0);break}h=typeof h=="object"?JSON.stringify(h):(+h).toString(A);for(var m=parseInt(c),p=c&&c[0]+""=="0"?"0":" ";h.length<m;)h=l!==void 0?h+p:p+h;return h}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,a)},t.prototype.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.buffer+=t.form(e,r)},t.prototype.toString=function(){return this.buffer},t}(),L7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ise=function(){function t(e){this.boundingBox=new hF(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return t.prototype.getCodewordNearby=function(e){var r=this.getCodeword(e);if(r!=null)return r;for(var n=1;n<t.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null},t.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},t.prototype.setCodeword=function(e,r){this.codewords[this.imageRowToCodewordIndex(e)]=r},t.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.getCodewords=function(){return this.codewords},t.prototype.toString=function(){var e,r,n=new LR,a=0;try{for(var s=L7e(this.codewords),o=s.next();!o.done;o=s.next()){var l=o.value;if(l==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n.toString()},t.MAX_NEARBY_DISTANCE=5,t}(),U7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q7e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,s=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s},Jy=function(){function t(){this.values=new Map}return t.prototype.setValue=function(e){e=Math.trunc(e);var r=this.values.get(e);r==null&&(r=0),r++,this.values.set(e,r)},t.prototype.getValue=function(){var e,r,n=-1,a=new Array,s=function(f,A){var h={getKey:function(){return f},getValue:function(){return A}};h.getValue()>n?(n=h.getValue(),a=[],a.push(h.getKey())):h.getValue()===n&&a.push(h.getKey())};try{for(var o=U7e(this.values.entries()),l=o.next();!l.done;l=o.next()){var c=Q7e(l.value,2),u=c[0],d=c[1];s(u,d)}}catch(f){e={error:f}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return Na.toIntArray(a)},t.prototype.getConfidence=function(e){return this.values.get(e)},t}(),V7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$$=function(t){V7e(e,t);function e(r,n){var a=t.call(this,r)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var r,n;try{for(var a=G5(this.getCodewords()),s=a.next();!s.done;s=a.next()){var o=s.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(r){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,r);for(var a=this.getBoundingBox(),s=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=-1,d=1,f=0,A=l;A<c;A++)if(n[A]!=null){var h=n[A],m=h.getRowNumber()-u;if(m===0)f++;else if(m===1)d=Math.max(d,f),f=1,u=h.getRowNumber();else if(m<0||h.getRowNumber()>=r.getRowCount()||m>A)n[A]=null;else{var p=void 0;d>2?p=(d-2)*m:p=m;for(var x=p>=A,v=1;v<=p&&!x;v++)x=n[A-v]!=null;x?n[A]=null:(u=h.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var r,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var s=new Int32Array(a.getRowCount());try{for(var o=G5(this.getCodewords()),l=o.next();!l.done;l=o.next()){var c=l.value;if(c!=null){var u=c.getRowNumber();if(u>=s.length)continue;s[u]++}}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(r){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),s=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.getCodewords(),u=-1,d=o;d<l;d++)if(c[d]!=null){var f=c[d];f.setRowNumberAsRowIndicatorColumn();var A=f.getRowNumber()-u;A===0||(A===1?u=f.getRowNumber():f.getRowNumber()>=r.getRowCount()?c[d]=null:u=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var r,n,a=this.getCodewords(),s=new Jy,o=new Jy,l=new Jy,c=new Jy;try{for(var u=G5(a),d=u.next();!d.done;d=u.next()){var f=d.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var A=f.getValue()%30,h=f.getRowNumber();switch(this._isLeft||(h+=2),h%3){case 0:o.setValue(A*3+1);break;case 1:c.setValue(A/3),l.setValue(A%3);break;case 2:s.setValue(A+1);break}}}}catch(p){r={error:p}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}if(s.getValue().length===0||o.getValue().length===0||l.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<Na.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>Na.MAX_ROWS_IN_BARCODE)return null;var m=new M7e(s.getValue()[0],o.getValue()[0],l.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(a,m),m},e.prototype.removeIncorrectCodewords=function(r,n){for(var a=0;a<r.length;a++){var s=r[a];if(r[a]!=null){var o=s.getValue()%30,l=s.getRowNumber();if(l>n.getRowCount()){r[a]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(r[a]=null);break;case 2:o+1!==n.getColumnCount()&&(r[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+t.prototype.toString.call(this)},e}(Ise),H7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$7e=function(){function t(e,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return t.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=Na.MAX_CODEWORDS_IN_BARCODE,r;do r=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<r);return this.detectionResultColumns},t.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},t.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var r=1;r<this.barcodeColumnCount+1;r++)for(var n=this.detectionResultColumns[r].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n));return e},t.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},t.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&r[n]!=null&&e[n].getRowNumber()===r[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var s=this.detectionResultColumns[a].getCodewords()[n];s!=null&&(s.setRowNumber(e[n].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},t.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=this.barcodeColumnCount+1;o>0&&s<this.ADJUST_ROW_NUMBER_SKIP;o--){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,r=this.detectionResultColumns[0].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=1;o<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;o++){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.adjustRowNumberIfValid=function(e,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),r=0):++r),r},t.prototype.adjustRowNumbers=function(e,r,n){var a,s;if(this.detectionResultColumns[e-1]!=null){var o=n[r],l=this.detectionResultColumns[e-1].getCodewords(),c=l;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var u=new Array(14);u[2]=l[r],u[3]=c[r],r>0&&(u[0]=n[r-1],u[4]=l[r-1],u[5]=c[r-1]),r>1&&(u[8]=n[r-2],u[10]=l[r-2],u[11]=c[r-2]),r<n.length-1&&(u[1]=n[r+1],u[6]=l[r+1],u[7]=c[r+1]),r<n.length-2&&(u[9]=n[r+2],u[12]=l[r+2],u[13]=c[r+2]);try{for(var d=H7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;if(t.adjustRowNumber(o,A))return}}catch(h){a={error:h}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}}},t.adjustRowNumber=function(e,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===e.getBucket()?(e.setRowNumber(r.getRowNumber()),!0):!1},t.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},t.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},t.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},t.prototype.setBoundingBox=function(e){this.boundingBox=e},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.setDetectionResultColumn=function(e,r){this.detectionResultColumns[e]=r},t.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},t.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var r=new LR,n=0;n<e.getCodewords().length;n++){r.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}var s=this.detectionResultColumns[a].getCodewords()[n];if(s==null){r.format("    |   ");continue}r.format(" %3d|%3d",s.getRowNumber(),s.getValue())}r.format("%n")}return r.toString()},t}(),K7e=function(){function t(e,r,n,a){this.rowNumber=t.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return t.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},t.prototype.isValidRowNumber=function(e){return e!==t.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},t.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},t.prototype.getWidth=function(){return this.endX-this.startX},t.prototype.getStartX=function(){return this.startX},t.prototype.getEndX=function(){return this.endX},t.prototype.getBucket=function(){return this.bucket},t.prototype.getValue=function(){return this.value},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.setRowNumber=function(e){this.rowNumber=e},t.prototype.toString=function(){return this.rowNumber+"|"+this.value},t.BARCODE_ROW_UNKNOWN=-1,t}(),G7e=function(){function t(){}return t.initialize=function(){for(var e=0;e<Na.SYMBOL_TABLE.length;e++)for(var r=Na.SYMBOL_TABLE[e],n=r&1,a=0;a<Na.BARS_IN_MODULE;a++){for(var s=0;(r&1)===n;)s+=1,r>>=1;n=r&1,t.RATIOS_TABLE[e]||(t.RATIOS_TABLE[e]=new Array(Na.BARS_IN_MODULE)),t.RATIOS_TABLE[e][Na.BARS_IN_MODULE-a-1]=Math.fround(s/Na.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},t.getDecodedValue=function(e){var r=t.getDecodedCodewordValue(t.sampleBitCounts(e));return r!==-1?r:t.getClosestDecodedValue(e)},t.sampleBitCounts=function(e){for(var r=ja.sum(e),n=new Int32Array(Na.BARS_IN_MODULE),a=0,s=0,o=0;o<Na.MODULES_IN_CODEWORD;o++){var l=r/(2*Na.MODULES_IN_CODEWORD)+o*r/Na.MODULES_IN_CODEWORD;s+e[a]<=l&&(s+=e[a],a++),n[a]++}return n},t.getDecodedCodewordValue=function(e){var r=t.getBitValue(e);return Na.getCodeword(r)===-1?-1:r},t.getBitValue=function(e){for(var r=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)},t.getClosestDecodedValue=function(e){var r=ja.sum(e),n=new Array(Na.BARS_IN_MODULE);if(r>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/r);var s=uF.MAX_VALUE,o=-1;this.bSymbolTableReady||t.initialize();for(var l=0;l<t.RATIOS_TABLE.length;l++){for(var c=0,u=t.RATIOS_TABLE[l],d=0;d<Na.BARS_IN_MODULE;d++){var f=Math.fround(u[d]-n[d]);if(c+=Math.fround(f*f),c>=s)break}c<s&&(s=c,o=Na.SYMBOL_TABLE[l])}return o},t.bSymbolTableReady=!1,t.RATIOS_TABLE=new Array(Na.SYMBOL_TABLE.length).map(function(e){return new Array(Na.BARS_IN_MODULE)}),t}(),q7e=function(){function t(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return t.prototype.getSegmentIndex=function(){return this.segmentIndex},t.prototype.setSegmentIndex=function(e){this.segmentIndex=e},t.prototype.getFileId=function(){return this.fileId},t.prototype.setFileId=function(e){this.fileId=e},t.prototype.getOptionalData=function(){return this.optionalData},t.prototype.setOptionalData=function(e){this.optionalData=e},t.prototype.isLastSegment=function(){return this.lastSegment},t.prototype.setLastSegment=function(e){this.lastSegment=e},t.prototype.getSegmentCount=function(){return this.segmentCount},t.prototype.setSegmentCount=function(e){this.segmentCount=e},t.prototype.getSender=function(){return this.sender||null},t.prototype.setSender=function(e){this.sender=e},t.prototype.getAddressee=function(){return this.addressee||null},t.prototype.setAddressee=function(e){this.addressee=e},t.prototype.getFileName=function(){return this.fileName},t.prototype.setFileName=function(e){this.fileName=e},t.prototype.getFileSize=function(){return this.fileSize},t.prototype.setFileSize=function(e){this.fileSize=e},t.prototype.getChecksum=function(){return this.checksum},t.prototype.setChecksum=function(e){this.checksum=e},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(e){this.timestamp=e},t}(),K$=function(){function t(){}return t.parseLong=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t}(),z7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W7e=function(t){z7e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="NullPointerException",e}(cu),X7e=function(){function t(){}return t.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},t.prototype.writeBytesOffset=function(e,r,n){if(e==null)throw new W7e;if(r<0||r>e.length||n<0||r+n>e.length||r+n<0)throw new OR;if(n===0)return;for(var a=0;a<n;a++)this.write(e[r+a])},t.prototype.flush=function(){},t.prototype.close=function(){},t}(),Y7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),J7e=function(t){Y7e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(cu),Z7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),e9e=function(t){Z7e(e,t);function e(r){r===void 0&&(r=32);var n=t.call(this)||this;if(n.count=0,r<0)throw new Pn("Negative initial size: "+r);return n.buf=new Uint8Array(r),n}return e.prototype.ensureCapacity=function(r){r-this.buf.length>0&&this.grow(r)},e.prototype.grow=function(r){var n=this.buf.length,a=n<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new J7e;a=sa.MAX_VALUE}this.buf=Bo.copyOfUint8Array(this.buf,a)},e.prototype.write=function(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1},e.prototype.writeBytesOffset=function(r,n,a){if(n<0||n>r.length||a<0||n+a-r.length>0)throw new OR;this.ensureCapacity(this.count+a),ws.arraycopy(r,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(r){r.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return Bo.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(r){return new String(this.buf).toString()},e.prototype.toString_number=function(r){return new String(this.buf).toString()},e.prototype.close=function(){},e}(X7e),is;(function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(is||(is={}));function jse(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var l_;function I0(t){if(typeof l_>"u"&&(l_=jse()),l_===null)throw new Error("BigInt is not supported!");return l_(t)}function t9e(){var t=[];t[0]=I0(1);var e=I0(900);t[1]=e;for(var r=2;r<16;r++)t[r]=t[r-1]*e;return t}var r9e=function(){function t(){}return t.decode=function(e,r){var n=new ea(""),a=jo.ISO8859_1;n.enableDecoding(a);for(var s=1,o=e[s++],l=new q7e;s<e[0];){switch(o){case t.TEXT_COMPACTION_MODE_LATCH:s=t.textCompaction(e,s,n);break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:s=t.byteCompaction(o,e,a,s,n);break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s++]);break;case t.NUMERIC_COMPACTION_MODE_LATCH:s=t.numericCompaction(e,s,n);break;case t.ECI_CHARSET:jo.getCharacterSetECIByValue(e[s++]);break;case t.ECI_GENERAL_PURPOSE:s+=2;break;case t.ECI_USER_DEFINED:s++;break;case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=t.decodeMacroBlock(e,s,l);break;case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:throw new qr;default:s--,s=t.textCompaction(e,s,n);break}if(s<e.length)o=e[s++];else throw qr.getFormatInstance()}if(n.length()===0)throw qr.getFormatInstance();var c=new vP(null,n.toString(),null,r);return c.setOther(l),c},t.decodeMacroBlock=function(e,r,n){if(r+t.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw qr.getFormatInstance();for(var a=new Int32Array(t.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<t.NUMBER_OF_SEQUENCE_CODEWORDS;s++,r++)a[s]=e[r];n.setSegmentIndex(sa.parseInt(t.decodeBase900toBase10(a,t.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new ea;r=t.textCompaction(e,r,o),n.setFileId(o.toString());var l=-1;for(e[r]===t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=r+1);r<e[0];)switch(e[r]){case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,e[r]){case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new ea;r=t.textCompaction(e,r+1,c),n.setFileName(c.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var u=new ea;r=t.textCompaction(e,r+1,u),n.setSender(u.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var d=new ea;r=t.textCompaction(e,r+1,d),n.setAddressee(d.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new ea;r=t.numericCompaction(e,r+1,f),n.setSegmentCount(sa.parseInt(f.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var A=new ea;r=t.numericCompaction(e,r+1,A),n.setTimestamp(K$.parseLong(A.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var h=new ea;r=t.numericCompaction(e,r+1,h),n.setChecksum(sa.parseInt(h.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var m=new ea;r=t.numericCompaction(e,r+1,m),n.setFileSize(K$.parseLong(m.toString()));break;default:throw qr.getFormatInstance()}break;case t.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw qr.getFormatInstance()}if(l!==-1){var p=r-l;n.isLastSegment()&&p--,n.setOptionalData(Bo.copyOfRange(e,l,l+p))}return r},t.textCompaction=function(e,r,n){for(var a=new Int32Array((e[0]-r)*2),s=new Int32Array((e[0]-r)*2),o=0,l=!1;r<e[0]&&!l;){var c=e[r++];if(c<t.TEXT_COMPACTION_MODE_LATCH)a[o]=c/30,a[o+1]=c%30,o+=2;else switch(c){case t.TEXT_COMPACTION_MODE_LATCH:a[o++]=t.TEXT_COMPACTION_MODE_LATCH;break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,l=!0;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[r++],s[o]=c,o++;break}}return t.decodeTextCompaction(a,s,o,n),r},t.decodeTextCompaction=function(e,r,n,a){for(var s=is.ALPHA,o=is.ALPHA,l=0;l<n;){var c=e[l],u="";switch(s){case is.ALPHA:if(c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.LL:s=is.LOWER;break;case t.ML:s=is.MIXED;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.LOWER:if(c<26)u=String.fromCharCode(97+c);else switch(c){case 26:u=" ";break;case t.AS:o=s,s=is.ALPHA_SHIFT;break;case t.ML:s=is.MIXED;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.MIXED:if(c<t.PL)u=t.MIXED_CHARS[c];else switch(c){case t.PL:s=is.PUNCT;break;case 26:u=" ";break;case t.LL:s=is.LOWER;break;case t.AL:s=is.ALPHA;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.PUNCT:if(c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=is.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.ALPHA_SHIFT:if(s=o,c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.PUNCT_SHIFT:if(s=o,c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=is.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break}u!==""&&a.append(u),l++}},t.byteCompaction=function(e,r,n,a,s){var o=new e9e,l=0,c=0,u=!1;switch(e){case t.BYTE_COMPACTION_MODE_LATCH:for(var d=new Int32Array(6),f=r[a++];a<r[0]&&!u;)switch(d[l++]=f,c=900*c+f,f=r[a++],f){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break;default:if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(I0(c)>>I0(8*(5-A))));c=0,l=0}break}a===r[0]&&f<t.TEXT_COMPACTION_MODE_LATCH&&(d[l++]=f);for(var h=0;h<l;h++)o.write(d[h]);break;case t.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!u;){var m=r[a++];if(m<t.TEXT_COMPACTION_MODE_LATCH)l++,c=900*c+m;else switch(m){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break}if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(I0(c)>>I0(8*(5-A))));c=0,l=0}}break}return s.append(Bd.decode(o.toByteArray(),n)),a},t.numericCompaction=function(e,r,n){for(var a=0,s=!1,o=new Int32Array(t.MAX_NUMERIC_CODEWORDS);r<e[0]&&!s;){var l=e[r++];if(r===e[0]&&(s=!0),l<t.TEXT_COMPACTION_MODE_LATCH)o[a]=l,a++;else switch(l){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,s=!0;break}(a%t.MAX_NUMERIC_CODEWORDS===0||l===t.NUMERIC_COMPACTION_MODE_LATCH||s)&&a>0&&(n.append(t.decodeBase900toBase10(o,a)),a=0)}return r},t.decodeBase900toBase10=function(e,r){for(var n=I0(0),a=0;a<r;a++)n+=t.EXP900[r-a-1]*I0(e[a]);var s=n.toString();if(s.charAt(0)!=="1")throw new qr;return s.substring(1)},t.TEXT_COMPACTION_MODE_LATCH=900,t.BYTE_COMPACTION_MODE_LATCH=901,t.NUMERIC_COMPACTION_MODE_LATCH=902,t.BYTE_COMPACTION_MODE_LATCH_6=924,t.ECI_USER_DEFINED=925,t.ECI_GENERAL_PURPOSE=926,t.ECI_CHARSET=927,t.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,t.MACRO_PDF417_TERMINATOR=922,t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,t.MAX_NUMERIC_CODEWORDS=15,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,t.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,t.PL=25,t.LL=27,t.AS=27,t.ML=28,t.AL=28,t.PS=29,t.PAL=29,t.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,t.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",t.EXP900=jse()?t9e():[],t.NUMBER_OF_SEQUENCE_CODEWORDS=2,t}(),yy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},n9e=function(){function t(){}return t.decode=function(e,r,n,a,s,o,l){for(var c=new hF(e,r,n,a,s),u=null,d=null,f,A=!0;;A=!1){if(r!=null&&(u=t.getRowIndicatorColumn(e,c,r,!0,o,l)),a!=null&&(d=t.getRowIndicatorColumn(e,c,a,!1,o,l)),f=t.merge(u,d),f==null)throw lr.getNotFoundInstance();var h=f.getBoundingBox();if(A&&h!=null&&(h.getMinY()<c.getMinY()||h.getMaxY()>c.getMaxY()))c=h;else break}f.setBoundingBox(c);var m=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,u),f.setDetectionResultColumn(m,d);for(var p=u!=null,x=1;x<=m;x++){var v=p?x:m-x;if(f.getDetectionResultColumn(v)===void 0){var y=void 0;v===0||v===m?y=new $$(c,v===0):y=new Ise(c),f.setDetectionResultColumn(v,y);for(var b=-1,w=b,j=c.getMinY();j<=c.getMaxY();j++){if(b=t.getStartColumn(f,v,j,p),b<0||b>c.getMaxX()){if(w===-1)continue;b=w}var I=t.detectCodeword(e,c.getMinX(),c.getMaxX(),p,b,j,o,l);I!=null&&(y.setCodeword(j,I),w=b,o=Math.min(o,I.getWidth()),l=Math.max(l,I.getWidth()))}}}return t.createDecoderResult(f)},t.merge=function(e,r){if(e==null&&r==null)return null;var n=t.getBarcodeMetadata(e,r);if(n==null)return null;var a=hF.merge(t.adjustBoundingBox(e),t.adjustBoundingBox(r));return new $7e(n,a)},t.adjustBoundingBox=function(e){var r,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var s=t.getMax(a),o=0;try{for(var l=yy(a),c=l.next();!c.done;c=l.next()){var u=c.value;if(o+=s-u,u>0)break}}catch(h){r={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}for(var d=e.getCodewords(),f=0;o>0&&d[f]==null;f++)o--;for(var A=0,f=a.length-1;f>=0&&(A+=s-a[f],!(a[f]>0));f--);for(var f=d.length-1;A>0&&d[f]==null;f--)A--;return e.getBoundingBox().addMissingRows(o,A,e.isLeft())},t.getMax=function(e){var r,n,a=-1;try{for(var s=yy(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=Math.max(a,l)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.getBarcodeMetadata=function(e,r){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();var a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},t.getRowIndicatorColumn=function(e,r,n,a,s,o){for(var l=new $$(r,a),c=0;c<2;c++)for(var u=c===0?1:-1,d=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=r.getMaxY()&&f>=r.getMinY();f+=u){var A=t.detectCodeword(e,0,e.getWidth(),a,d,f,s,o);A!=null&&(l.setCodeword(f,A),a?d=A.getStartX():d=A.getEndX())}return l},t.adjustCodewordCount=function(e,r){var n=r[0][1],a=n.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-t.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(s<1||s>Na.MAX_CODEWORDS_IN_BARCODE)throw lr.getNotFoundInstance();n.setValue(s)}else a[0]!==s&&n.setValue(s)},t.createDecoderResult=function(e){var r=t.createBarcodeMatrix(e);t.adjustCodewordCount(e,r);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],o=new Array,l=0;l<e.getBarcodeRowCount();l++)for(var c=0;c<e.getBarcodeColumnCount();c++){var u=r[l][c+1].getValue(),d=l*e.getBarcodeColumnCount()+c;u.length===0?n.push(d):u.length===1?a[d]=u[0]:(o.push(d),s.push(u))}for(var f=new Array(s.length),A=0;A<f.length;A++)f[A]=s[A];return t.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,Na.toIntArray(n),Na.toIntArray(o),f)},t.createDecoderResultFromAmbiguousValues=function(e,r,n,a,s){for(var o=new Int32Array(a.length),l=100;l-- >0;){for(var c=0;c<o.length;c++)r[a[c]]=s[c][o[c]];try{return t.decodeCodewords(r,e,n)}catch(d){var u=d instanceof oo;if(!u)throw d}if(o.length===0)throw oo.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<s[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw oo.getChecksumInstance()}throw oo.getChecksumInstance()},t.createBarcodeMatrix=function(e){for(var r,n,a,s,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]=new Jy;var u=0;try{for(var d=yy(e.getDetectionResultColumns()),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)try{for(var h=(a=void 0,yy(A.getCodewords())),m=h.next();!m.done;m=h.next()){var p=m.value;if(p!=null){var x=p.getRowNumber();if(x>=0){if(x>=o.length)continue;o[x][u].setValue(p.getValue())}}}}catch(v){a={error:v}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}u++}}catch(v){r={error:v}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return o},t.isValidBarcodeColumn=function(e,r){return r>=0&&r<=e.getBarcodeColumnCount()+1},t.getStartColumn=function(e,r,n,a){var s,o,l=a?1:-1,c=null;if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodeword(n)),c!=null)return a?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(r).getCodewordNearby(n),c!=null)return a?c.getStartX():c.getEndX();if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodewordNearby(n)),c!=null)return a?c.getEndX():c.getStartX();for(var u=0;t.isValidBarcodeColumn(e,r-l);){r-=l;try{for(var d=(s=void 0,yy(e.getDetectionResultColumn(r).getCodewords())),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)return(a?A.getEndX():A.getStartX())+l*u*(A.getEndX()-A.getStartX())}}catch(h){s={error:h}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(s)throw s.error}}u++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},t.detectCodeword=function(e,r,n,a,s,o,l,c){s=t.adjustCodewordStartColumn(e,r,n,a,s,o);var u=t.getModuleBitCount(e,r,n,a,s,o);if(u==null)return null;var d,f=ja.sum(u);if(a)d=s+f;else{for(var A=0;A<u.length/2;A++){var h=u[A];u[A]=u[u.length-1-A],u[u.length-1-A]=h}d=s,s=d-f}if(!t.checkCodewordSkew(f,l,c))return null;var m=G7e.getDecodedValue(u),p=Na.getCodeword(m);return p===-1?null:new K7e(s,d,t.getCodewordBucketNumber(m),p)},t.getModuleBitCount=function(e,r,n,a,s,o){for(var l=s,c=new Int32Array(8),u=0,d=a?1:-1,f=a;(a?l<n:l>=r)&&u<c.length;)e.get(l,o)===f?(c[u]++,l+=d):(u++,f=!f);return u===c.length||l===(a?n:r)&&u===c.length-1?c:null},t.getNumberOfECCodeWords=function(e){return 2<<e},t.adjustCodewordStartColumn=function(e,r,n,a,s,o){for(var l=s,c=a?-1:1,u=0;u<2;u++){for(;(a?l>=r:l<n)&&a===e.get(l,o);){if(Math.abs(s-l)>t.CODEWORD_SKEW_SIZE)return s;l+=c}c=-c,a=!a}return l},t.checkCodewordSkew=function(e,r,n){return r-t.CODEWORD_SKEW_SIZE<=e&&e<=n+t.CODEWORD_SKEW_SIZE},t.decodeCodewords=function(e,r,n){if(e.length===0)throw qr.getFormatInstance();var a=1<<r+1,s=t.correctErrors(e,n,a);t.verifyCodewordCount(e,a);var o=r9e.decode(e,""+r);return o.setErrorsCorrected(s),o.setErasures(n.length),o},t.correctErrors=function(e,r,n){if(r!=null&&r.length>n/2+t.MAX_ERRORS||n<0||n>t.MAX_EC_CODEWORDS)throw oo.getChecksumInstance();return t.errorCorrection.decode(e,n,r)},t.verifyCodewordCount=function(e,r){if(e.length<4)throw qr.getFormatInstance();var n=e[0];if(n>e.length)throw qr.getFormatInstance();if(n===0)if(r<e.length)e[0]=e.length-r;else throw qr.getFormatInstance()},t.getBitCountForCodeword=function(e){for(var r=new Int32Array(8),n=0,a=r.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)r[a]++,e>>=1;return r},t.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},t.getCodewordBucketNumber_number=function(e){return t.getCodewordBucketNumber(t.getBitCountForCodeword(e))},t.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},t.toString=function(e){for(var r=new LR,n=0;n<e.length;n++){r.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var s=e[n][a];s.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}r.format("%n")}return r.toString()},t.CODEWORD_SKEW_SIZE=2,t.MAX_ERRORS=3,t.MAX_EC_CODEWORDS=512,t.errorCorrection=new R7e,t}(),a9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},aI=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=t.decode(e,r,!1);if(n==null||n.length===0||n[0]==null)throw lr.getNotFoundInstance();return n[0]},t.prototype.decodeMultiple=function(e,r){r===void 0&&(r=null);try{return t.decode(e,r,!0)}catch(n){throw n instanceof qr||n instanceof oo?lr.getNotFoundInstance():n}},t.decode=function(e,r,n){var a,s,o=new Array,l=B7e.detectMultiple(e,r,n);try{for(var c=a9e(l.getPoints()),u=c.next();!u.done;u=c.next()){var d=u.value,f=n9e.decode(l.getBits(),d[4],d[5],d[6],d[7],t.getMinCodewordWidth(d),t.getMaxCodewordWidth(d)),A=new uc(f.getText(),f.getRawBytes(),void 0,d,jn.PDF_417);A.putMetadata(jl.ERROR_CORRECTION_LEVEL,f.getECLevel());var h=f.getOther();h!=null&&A.putMetadata(jl.PDF417_EXTRA_METADATA,h),o.push(A)}}catch(m){a={error:m}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return o.map(function(m){return m})},t.getMaxWidth=function(e,r){return e==null||r==null?0:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMinWidth=function(e,r){return e==null||r==null?sa.MAX_VALUE:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(t.getMaxWidth(e[0],e[4]),t.getMaxWidth(e[6],e[2])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN),Math.max(t.getMaxWidth(e[1],e[5]),t.getMaxWidth(e[7],e[3])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN)))},t.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(t.getMinWidth(e[0],e[4]),t.getMinWidth(e[6],e[2])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN),Math.min(t.getMinWidth(e[1],e[5]),t.getMinWidth(e[7],e[3])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN)))},t.prototype.reset=function(){},t}(),s9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G$=function(t){s9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReaderException",e}(cu),q$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Pse=function(){function t(){}return t.prototype.decode=function(e,r){return this.setHints(r),this.decodeInternal(e)},t.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},t.prototype.setHints=function(e){this.hints=e;var r=e!=null&&e.get(Ns.TRY_HARDER)!==void 0,n=e==null?null:e.get(Ns.POSSIBLE_FORMATS),a=new Array;if(n!=null){var s=n.some(function(o){return o===jn.UPC_A||o===jn.UPC_E||o===jn.EAN_13||o===jn.EAN_8||o===jn.CODABAR||o===jn.CODE_39||o===jn.CODE_93||o===jn.CODE_128||o===jn.ITF||o===jn.RSS_14||o===jn.RSS_EXPANDED});s&&!r&&a.push(new Yx(e)),n.includes(jn.QR_CODE)&&a.push(new nI),n.includes(jn.DATA_MATRIX)&&a.push(new rI),n.includes(jn.AZTEC)&&a.push(new eI),n.includes(jn.PDF_417)&&a.push(new aI),s&&r&&a.push(new Yx(e))}a.length===0&&(r||a.push(new Yx(e)),a.push(new nI),a.push(new rI),a.push(new eI),a.push(new aI),r&&a.push(new Yx(e))),this.readers=a},t.prototype.reset=function(){var e,r;if(this.readers!==null)try{for(var n=q$(this.readers),a=n.next();!a.done;a=n.next()){var s=a.value;s.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.decodeInternal=function(e){var r,n;if(this.readers===null)throw new G$("No readers where selected, nothing can be read.");try{for(var a=q$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;try{return o.decode(e,this.hints)}catch(l){if(l instanceof G$)continue}}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new lr("No MultiFormat Readers were able to detect the code.")},t}(),i9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){i9e(e,t);function e(r,n){r===void 0&&(r=null),n===void 0&&(n=500);var a=this,s=new Pse;return s.setHints(r),a=t.call(this,s,n)||this,a}return e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e})(w1);var o9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){o9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new aI,r)||this}return e})(w1);var l9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){l9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new nI,r)||this}return e})(w1);var AF;(function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",t[t.MIN_SIZE=4]="MIN_SIZE",t[t.MAX_SIZE=5]="MAX_SIZE",t[t.MARGIN=6]="MARGIN",t[t.PDF417_COMPACT=7]="PDF417_COMPACT",t[t.PDF417_COMPACTION=8]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=10]="AZTEC_LAYERS",t[t.QR_VERSION=11]="QR_VERSION",t[t.GS1_FORMAT=12]="GS1_FORMAT",t[t.FORCE_C40=13]="FORCE_C40"})(AF||(AF={}));const c_=AF;var Bse=function(){function t(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new hm(e,Int32Array.from([1])))}return t.prototype.buildGenerator=function(e){var r=this.cachedGenerators;if(e>=r.length)for(var n=r[r.length-1],a=this.field,s=r.length;s<=e;s++){var o=n.multiply(new hm(a,Int32Array.from([1,a.exp(s-1+a.getGeneratorBase())])));r.push(o),n=o}return r[e]},t.prototype.encode=function(e,r){if(r===0)throw new Pn("No error correction bytes");var n=e.length-r;if(n<=0)throw new Pn("No data bytes provided");var a=this.buildGenerator(r),s=new Int32Array(n);ws.arraycopy(e,0,s,0,n);var o=new hm(this.field,s);o=o.multiplyByMonomial(r,1);for(var l=o.divide(a)[1],c=l.getCoefficients(),u=r-c.length,d=0;d<u;d++)e[n+d]=0;ws.arraycopy(c,0,e,n+u,c.length)},t}(),Zy=function(){function t(){}return t.applyMaskPenaltyRule1=function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)},t.applyMaskPenaltyRule2=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s-1;o++)for(var l=n[o],c=0;c<a-1;c++){var u=l[c];u===l[c+1]&&u===n[o+1][c]&&u===n[o+1][c+1]&&r++}return t.N2*r},t.applyMaskPenaltyRule3=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=0;l<a;l++){var c=n[o];l+6<a&&c[l]===1&&c[l+1]===0&&c[l+2]===1&&c[l+3]===1&&c[l+4]===1&&c[l+5]===0&&c[l+6]===1&&(t.isWhiteHorizontal(c,l-4,l)||t.isWhiteHorizontal(c,l+7,l+11))&&r++,o+6<s&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(t.isWhiteVertical(n,l,o-4,o)||t.isWhiteVertical(n,l,o+7,o+11))&&r++}return r*t.N3},t.isWhiteHorizontal=function(e,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(var a=r;a<n;a++)if(e[a]===1)return!1;return!0},t.isWhiteVertical=function(e,r,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var s=n;s<a;s++)if(e[s][r]===1)return!1;return!0},t.applyMaskPenaltyRule4=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=n[o],c=0;c<a;c++)l[c]===1&&r++;var u=e.getHeight()*e.getWidth(),d=Math.floor(Math.abs(r*2-u)*10/u);return d*t.N4},t.getDataMaskBit=function(e,r,n){var a,s;switch(e){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:s=n*r,a=(s&1)+s%3;break;case 6:s=n*r,a=(s&1)+s%3&1;break;case 7:s=n*r,a=s%3+(n+r&1)&1;break;default:throw new Pn("Invalid mask pattern: "+e)}return a===0},t.applyMaskPenaltyRule1Internal=function(e,r){for(var n=0,a=r?e.getHeight():e.getWidth(),s=r?e.getWidth():e.getHeight(),o=e.getArray(),l=0;l<a;l++){for(var c=0,u=-1,d=0;d<s;d++){var f=r?o[l][d]:o[d][l];f===u?c++:(c>=5&&(n+=t.N1+(c-5)),c=1,u=f)}c>=5&&(n+=t.N1+(c-5))}return n},t.N1=3,t.N2=3,t.N3=40,t.N4=10,t}(),c9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u9e=function(){function t(e,r){this.width=e,this.height=r;for(var n=new Array(r),a=0;a!==r;a++)n[a]=new Uint8Array(e);this.bytes=n}return t.prototype.getHeight=function(){return this.height},t.prototype.getWidth=function(){return this.width},t.prototype.get=function(e,r){return this.bytes[r][e]},t.prototype.getArray=function(){return this.bytes},t.prototype.setNumber=function(e,r,n){this.bytes[r][e]=n},t.prototype.setBoolean=function(e,r,n){this.bytes[r][e]=n?1:0},t.prototype.clear=function(e){var r,n;try{for(var a=c9e(this.bytes),s=a.next();!s.done;s=a.next()){var o=s.value;Bo.fill(o,e)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;if(this.width!==r.width||this.height!==r.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var s=this.bytes[n],o=r.bytes[n],l=0,c=this.width;l<c;++l)if(s[l]!==o[l])return!1;return!0},t.prototype.toString=function(){for(var e=new ea,r=0,n=this.height;r<n;++r){for(var a=this.bytes[r],s=0,o=this.width;s<o;++s)switch(a[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},t}(),mF=function(){function t(){this.maskPattern=-1}return t.prototype.getMode=function(){return this.mode},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getVersion=function(){return this.version},t.prototype.getMaskPattern=function(){return this.maskPattern},t.prototype.getMatrix=function(){return this.matrix},t.prototype.toString=function(){var e=new ea;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},t.prototype.setMode=function(e){this.mode=e},t.prototype.setECLevel=function(e){this.ecLevel=e},t.prototype.setVersion=function(e){this.version=e},t.prototype.setMaskPattern=function(e){this.maskPattern=e},t.prototype.setMatrix=function(e){this.matrix=e},t.isValidMaskPattern=function(e){return e>=0&&e<t.NUM_MASK_PATTERNS},t.NUM_MASK_PATTERNS=8,t}(),d9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ss=function(t){d9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="WriterException",e}(cu),z$=function(){function t(){}return t.clearMatrix=function(e){e.clear(255)},t.buildMatrix=function(e,r,n,a,s){t.clearMatrix(s),t.embedBasicPatterns(n,s),t.embedTypeInfo(r,a,s),t.maybeEmbedVersionInfo(n,s),t.embedDataBits(e,a,s)},t.embedBasicPatterns=function(e,r){t.embedPositionDetectionPatternsAndSeparators(r),t.embedDarkDotAtLeftBottomCorner(r),t.maybeEmbedPositionAdjustmentPatterns(e,r),t.embedTimingPatterns(r)},t.embedTypeInfo=function(e,r,n){var a=new el;t.makeTypeInfoBits(e,r,a);for(var s=0,o=a.getSize();s<o;++s){var l=a.get(a.getSize()-1-s),c=t.TYPE_INFO_COORDINATES[s],u=c[0],d=c[1];if(n.setBoolean(u,d,l),s<8){var f=n.getWidth()-s-1,A=8;n.setBoolean(f,A,l)}else{var f=8,A=n.getHeight()-7+(s-8);n.setBoolean(f,A,l)}}},t.maybeEmbedVersionInfo=function(e,r){if(!(e.getVersionNumber()<7)){var n=new el;t.makeVersionInfoBits(e,n);for(var a=6*3-1,s=0;s<6;++s)for(var o=0;o<3;++o){var l=n.get(a);a--,r.setBoolean(s,r.getHeight()-11+o,l),r.setBoolean(r.getHeight()-11+o,s,l)}}},t.embedDataBits=function(e,r,n){for(var a=0,s=-1,o=n.getWidth()-1,l=n.getHeight()-1;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(var c=0;c<2;++c){var u=o-c;if(t.isEmpty(n.get(u,l))){var d=void 0;a<e.getSize()?(d=e.get(a),++a):d=!1,r!==255&&Zy.getDataMaskBit(r,u,l)&&(d=!d),n.setBoolean(u,l,d)}}l+=s}s=-s,l+=s,o-=2}if(a!==e.getSize())throw new Ss("Not all bits consumed: "+a+"/"+e.getSize())},t.findMSBSet=function(e){return 32-sa.numberOfLeadingZeros(e)},t.calculateBCHCode=function(e,r){if(r===0)throw new Pn("0 polynomial");var n=t.findMSBSet(r);for(e<<=n-1;t.findMSBSet(e)>=n;)e^=r<<t.findMSBSet(e)-n;return e},t.makeTypeInfoBits=function(e,r,n){if(!mF.isValidMaskPattern(r))throw new Ss("Invalid mask pattern");var a=e.getBits()<<3|r;n.appendBits(a,5);var s=t.calculateBCHCode(a,t.TYPE_INFO_POLY);n.appendBits(s,10);var o=new el;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new Ss("should not happen but we got: "+n.getSize())},t.makeVersionInfoBits=function(e,r){r.appendBits(e.getVersionNumber(),6);var n=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new Ss("should not happen but we got: "+r.getSize())},t.isEmpty=function(e){return e===255},t.embedTimingPatterns=function(e){for(var r=8;r<e.getWidth()-8;++r){var n=(r+1)%2;t.isEmpty(e.get(r,6))&&e.setNumber(r,6,n),t.isEmpty(e.get(6,r))&&e.setNumber(6,r,n)}},t.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new Ss;e.setNumber(8,e.getHeight()-8,1)},t.embedHorizontalSeparationPattern=function(e,r,n){for(var a=0;a<8;++a){if(!t.isEmpty(n.get(e+a,r)))throw new Ss;n.setNumber(e+a,r,0)}},t.embedVerticalSeparationPattern=function(e,r,n){for(var a=0;a<7;++a){if(!t.isEmpty(n.get(e,r+a)))throw new Ss;n.setNumber(e,r+a,0)}},t.embedPositionAdjustmentPattern=function(e,r,n){for(var a=0;a<5;++a)for(var s=t.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPattern=function(e,r,n){for(var a=0;a<7;++a)for(var s=t.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPatternsAndSeparators=function(e){var r=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-r,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-r,e);var n=8;t.embedHorizontalSeparationPattern(0,n-1,e),t.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;t.embedVerticalSeparationPattern(a,0,e),t.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),t.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},t.maybeEmbedPositionAdjustmentPatterns=function(e,r){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],s=0,o=a.length;s!==o;s++){var l=a[s];if(l>=0)for(var c=0;c!==o;c++){var u=a[c];u>=0&&t.isEmpty(r.get(u,l))&&t.embedPositionAdjustmentPattern(u-2,l-2,r)}}},t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),t.VERSION_INFO_POLY=7973,t.TYPE_INFO_POLY=1335,t.TYPE_INFO_MASK_PATTERN=21522,t}(),f9e=function(){function t(e,r){this.dataBytes=e,this.errorCorrectionBytes=r}return t.prototype.getDataBytes=function(){return this.dataBytes},t.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},t}(),W$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.calculateMaskPenalty=function(e){return Zy.applyMaskPenaltyRule1(e)+Zy.applyMaskPenaltyRule2(e)+Zy.applyMaskPenaltyRule3(e)+Zy.applyMaskPenaltyRule4(e)},t.encode=function(e,r,n){n===void 0&&(n=null);var a=t.DEFAULT_BYTE_MODE_ENCODING,s=n!==null&&n.get(c_.CHARACTER_SET)!==void 0;s&&(a=n.get(c_.CHARACTER_SET).toString());var o=this.chooseMode(e,a),l=new el;if(o===Is.BYTE&&(s||t.DEFAULT_BYTE_MODE_ENCODING!==a)){var c=jo.getCharacterSetECIByName(a);c!==void 0&&this.appendECI(c,l)}this.appendModeInfo(o,l);var u=new el;this.appendBytes(e,o,u,a);var d;if(n!==null&&n.get(c_.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(c_.QR_VERSION).toString(),10);d=$p.getVersionForNumber(f);var A=this.calculateBitsNeeded(o,l,u,d);if(!this.willFit(A,d,r))throw new Ss("Data too big for requested version")}else d=this.recommendVersion(r,o,l,u);var h=new el;h.appendBitArray(l);var m=o===Is.BYTE?u.getSizeInBytes():e.length;this.appendLengthInfo(m,d,o,h),h.appendBitArray(u);var p=d.getECBlocksForLevel(r),x=d.getTotalCodewords()-p.getTotalECCodewords();this.terminateBits(x,h);var v=this.interleaveWithECBytes(h,d.getTotalCodewords(),x,p.getNumBlocks()),y=new mF;y.setECLevel(r),y.setMode(o),y.setVersion(d);var b=d.getDimensionForVersion(),w=new u9e(b,b),j=this.chooseMaskPattern(v,r,d,w);return y.setMaskPattern(j),z$.buildMatrix(v,r,d,j,w),y.setMatrix(w),y},t.recommendVersion=function(e,r,n,a){var s=this.calculateBitsNeeded(r,n,a,$p.getVersionForNumber(1)),o=this.chooseVersion(s,e),l=this.calculateBitsNeeded(r,n,a,o);return this.chooseVersion(l,e)},t.calculateBitsNeeded=function(e,r,n,a){return r.getSize()+e.getCharacterCountBits(a)+n.getSize()},t.getAlphanumericCode=function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1},t.chooseMode=function(e,r){if(r===void 0&&(r=null),jo.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(e))return Is.KANJI;for(var n=!1,a=!1,s=0,o=e.length;s<o;++s){var l=e.charAt(s);if(t.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)a=!0;else return Is.BYTE}return a?Is.ALPHANUMERIC:n?Is.NUMERIC:Is.BYTE},t.isOnlyDoubleByteKanji=function(e){var r;try{r=Bd.encode(e,jo.SJIS)}catch{return!1}var n=r.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var s=r[a]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},t.chooseMaskPattern=function(e,r,n,a){for(var s=Number.MAX_SAFE_INTEGER,o=-1,l=0;l<mF.NUM_MASK_PATTERNS;l++){z$.buildMatrix(e,r,n,l,a);var c=this.calculateMaskPenalty(a);c<s&&(s=c,o=l)}return o},t.chooseVersion=function(e,r){for(var n=1;n<=40;n++){var a=$p.getVersionForNumber(n);if(t.willFit(e,a,r))return a}throw new Ss("Data too big")},t.willFit=function(e,r,n){var a=r.getTotalCodewords(),s=r.getECBlocksForLevel(n),o=s.getTotalECCodewords(),l=a-o,c=(e+7)/8;return l>=c},t.terminateBits=function(e,r){var n=e*8;if(r.getSize()>n)throw new Ss("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(var a=0;a<4&&r.getSize()<n;++a)r.appendBit(!1);var s=r.getSize()&7;if(s>0)for(var a=s;a<8;a++)r.appendBit(!1);for(var o=e-r.getSizeInBytes(),a=0;a<o;++a)r.appendBits(a&1?17:236,8);if(r.getSize()!==n)throw new Ss("Bits size does not equal capacity")},t.getNumDataBytesAndNumECBytesForBlockID=function(e,r,n,a,s,o){if(a>=n)throw new Ss("Block ID too large");var l=e%n,c=n-l,u=Math.floor(e/n),d=u+1,f=Math.floor(r/n),A=f+1,h=u-f,m=d-A;if(h!==m)throw new Ss("EC bytes mismatch");if(n!==c+l)throw new Ss("RS blocks mismatch");if(e!==(f+h)*c+(A+m)*l)throw new Ss("Total bytes mismatch");a<c?(s[0]=f,o[0]=h):(s[0]=A,o[0]=m)},t.interleaveWithECBytes=function(e,r,n,a){var s,o,l,c;if(e.getSizeInBytes()!==n)throw new Ss("Number of bits and data bytes does not match");for(var u=0,d=0,f=0,A=new Array,h=0;h<a;++h){var m=new Int32Array(1),p=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(r,n,a,h,m,p);var x=m[0],v=new Uint8Array(x);e.toBytes(8*u,v,0,x);var y=t.generateECBytes(v,p[0]);A.push(new f9e(v,y)),d=Math.max(d,x),f=Math.max(f,y.length),u+=m[0]}if(n!==u)throw new Ss("Data bytes does not match offset");for(var b=new el,h=0;h<d;++h)try{for(var w=(s=void 0,W$(A)),j=w.next();!j.done;j=w.next()){var I=j.value,v=I.getDataBytes();h<v.length&&b.appendBits(v[h],8)}}catch(B){s={error:B}}finally{try{j&&!j.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}for(var h=0;h<f;++h)try{for(var _=(l=void 0,W$(A)),S=_.next();!S.done;S=_.next()){var I=S.value,y=I.getErrorCorrectionBytes();h<y.length&&b.appendBits(y[h],8)}}catch(B){l={error:B}}finally{try{S&&!S.done&&(c=_.return)&&c.call(_)}finally{if(l)throw l.error}}if(r!==b.getSizeInBytes())throw new Ss("Interleaving error: "+r+" and "+b.getSizeInBytes()+" differ.");return b},t.generateECBytes=function(e,r){for(var n=e.length,a=new Int32Array(n+r),s=0;s<n;s++)a[s]=e[s]&255;new Bse(Jc.QR_CODE_FIELD_256).encode(a,r);for(var o=new Uint8Array(r),s=0;s<r;s++)o[s]=a[n+s];return o},t.appendModeInfo=function(e,r){r.appendBits(e.getBits(),4)},t.appendLengthInfo=function(e,r,n,a){var s=n.getCharacterCountBits(r);if(e>=1<<s)throw new Ss(e+" is bigger than "+((1<<s)-1));a.appendBits(e,s)},t.appendBytes=function(e,r,n,a){switch(r){case Is.NUMERIC:t.appendNumericBytes(e,n);break;case Is.ALPHANUMERIC:t.appendAlphanumericBytes(e,n);break;case Is.BYTE:t.append8BitBytes(e,n,a);break;case Is.KANJI:t.appendKanjiBytes(e,n);break;default:throw new Ss("Invalid mode: "+r)}},t.getDigit=function(e){return e.charCodeAt(0)-48},t.isDigit=function(e){var r=t.getDigit(e);return r>=0&&r<=9},t.appendNumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getDigit(e.charAt(a));if(a+2<n){var o=t.getDigit(e.charAt(a+1)),l=t.getDigit(e.charAt(a+2));r.appendBits(s*100+o*10+l,10),a+=3}else if(a+1<n){var o=t.getDigit(e.charAt(a+1));r.appendBits(s*10+o,7),a+=2}else r.appendBits(s,4),a++}},t.appendAlphanumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getAlphanumericCode(e.charCodeAt(a));if(s===-1)throw new Ss;if(a+1<n){var o=t.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new Ss;r.appendBits(s*45+o,11),a+=2}else r.appendBits(s,6),a++}},t.append8BitBytes=function(e,r,n){var a;try{a=Bd.encode(e,n)}catch(c){throw new Ss(c)}for(var s=0,o=a.length;s!==o;s++){var l=a[s];r.appendBits(l,8)}},t.appendKanjiBytes=function(e,r){var n;try{n=Bd.encode(e,jo.SJIS)}catch(f){throw new Ss(f)}for(var a=n.length,s=0;s<a;s+=2){var o=n[s]&255,l=n[s+1]&255,c=o<<8&4294967295|l,u=-1;if(c>=33088&&c<=40956?u=c-33088:c>=57408&&c<=60351&&(u=c-49472),u===-1)throw new Ss("Invalid byte sequence");var d=(u>>8)*192+(u&255);r.appendBits(d,13)}},t.appendECI=function(e,r){r.appendBits(Is.ECI.getBits(),4),r.appendBits(e.getValue(),8)},t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),t.DEFAULT_BYTE_MODE_ENCODING=jo.UTF8.getName(),t})();var h9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){h9e(e,t);function e(r,n,a,s,o,l,c,u){var d=t.call(this,l,c)||this;if(d.yuvData=r,d.dataWidth=n,d.dataHeight=a,d.left=s,d.top=o,s+l>n||o+c>a)throw new Pn("Crop rectangle does not fit within image data.");return u&&d.reverseHorizontal(l,c),d}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ws.arraycopy(this.yuvData,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ws.arraycopy(this.yuvData,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ws.arraycopy(this.yuvData,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+n,a,s,!1)},e.prototype.renderThumbnail=function(){for(var r=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*n),s=this.yuvData,o=this.top*this.dataWidth+this.left,l=0;l<n;l++){for(var c=l*r,u=0;u<r;u++){var d=s[o+u*e.THUMBNAIL_SCALE_FACTOR]&255;a[c+u]=4278190080|d*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(r,n){for(var a=this.yuvData,s=0,o=this.top*this.dataWidth+this.left;s<n;s++,o+=this.dataWidth)for(var l=o+r/2,c=o,u=o+r-1;c<l;c++,u--){var d=a[c];a[c]=a[u],a[u]=d}},e.prototype.invert=function(){return new xP(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Kw);var A9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){A9e(e,t);function e(r,n,a,s,o,l,c){var u=t.call(this,n,a)||this;if(u.dataWidth=s,u.dataHeight=o,u.left=l,u.top=c,r.BYTES_PER_ELEMENT===4){for(var d=n*a,f=new Uint8ClampedArray(d),A=0;A<d;A++){var h=r[A],m=h>>16&255,p=h>>7&510,x=h&255;f[A]=(m+p+x)/4&255}u.luminances=f}else u.luminances=r;if(s===void 0&&(u.dataWidth=n),o===void 0&&(u.dataHeight=a),l===void 0&&(u.left=0),c===void 0&&(u.top=0),u.left+n>u.dataWidth||u.top+a>u.dataHeight)throw new Pn("Crop rectangle does not fit within image data.");return u}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ws.arraycopy(this.luminances,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ws.arraycopy(this.luminances,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ws.arraycopy(this.luminances,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.luminances,a,s,this.dataWidth,this.dataHeight,this.left+r,this.top+n)},e.prototype.invert=function(){return new xP(this)},e})(Kw);var m9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),p9e=function(t){m9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.forName=function(r){return this.getCharacterSetECIByName(r)},e}(jo),g9e=function(){function t(){}return t.ISO_8859_1=jo.ISO8859_1,t}(),pF,x9e=301,v9e=function(t,e){for(var r=1,n=0;n<255;n++)e[n]=r,t[r]=n,r*=2,r>=256&&(r^=x9e);return{LOG:t,ALOG:e}};pF=v9e([],[]),pF.LOG;pF.ALOG;var X$;(function(t){t[t.FORCE_NONE=0]="FORCE_NONE",t[t.FORCE_SQUARE=1]="FORCE_SQUARE",t[t.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(X$||(X$={}));var Y$=129,Tse=230,y9e=231,b9e=235,w9e=236,N9e=237,C9e=238,_9e=239,E9e=240,q5=254,S9e=254,J$="[)>05",Z$="[)>06",eK="",Xa=0,xl=1,xc=2,bo=3,qo=4,Wl=5,I9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Xa},t.prototype.encode=function(e){var r=lf.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(r>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case Wl:e.writeCodeword(y9e),e.signalEncoderChange(Wl);return;case xl:e.writeCodeword(Tse),e.signalEncoderChange(xl);return;case bo:e.writeCodeword(C9e),e.signalEncoderChange(bo);break;case xc:e.writeCodeword(_9e),e.signalEncoderChange(xc);break;case qo:e.writeCodeword(E9e),e.signalEncoderChange(qo);break;default:throw new Error("Illegal mode: "+a)}else lf.isExtendedASCII(n)?(e.writeCodeword(b9e),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},t.prototype.encodeASCIIDigits=function(e,r){if(lf.isDigit(e)&&lf.isDigit(r)){var n=(e-48)*10+(r-48);return n+130}throw new Error("not digits: "+e+r)},t}(),j9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Wl},t.prototype.encode=function(e){var r=new ea;for(r.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();r.append(n),e.pos++;var a=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}var s=r.length()-1,o=1,l=e.getCodewordCount()+s+o;e.updateSymbolInfo(l);var c=e.getSymbolInfo().getDataCapacity()-l>0;if(e.hasMoreCharacters()||c)if(s<=249)r.setCharAt(0,ba.getCharAt(s));else if(s<=1555)r.setCharAt(0,ba.getCharAt(Math.floor(s/250)+249)),r.insert(1,ba.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var u=0,n=r.length();u<n;u++)e.writeCodeword(this.randomize255State(r.charAt(u).charCodeAt(0),e.getCodewordCount()+1))},t.prototype.randomize255State=function(e,r){var n=149*r%255+1,a=e+n;return a<=255?a:a-256},t}(),UR=function(){function t(){}return t.prototype.getEncodingMode=function(){return xl},t.prototype.encodeMaximal=function(e){for(var r=new ea,n=0,a=e.pos,s=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,r),r.length()%3===0&&(a=e.pos,s=r.length())}if(s!==r.length()){var l=Math.floor(r.length()/3*2),c=Math.floor(e.getCodewordCount()+l+1);e.updateSymbolInfo(c);var u=e.getSymbolInfo().getDataCapacity()-c,d=Math.floor(r.length()%3);(d===2&&u!==2||d===1&&(n>3||u!==1))&&(e.pos=a)}r.length()>0&&e.writeCodeword(Tse),this.handleEOD(e,r)},t.prototype.encode=function(e){for(var r=new ea;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,r),s=Math.floor(r.length()/3)*2,o=e.getCodewordCount()+s;e.updateSymbolInfo(o);var l=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var c=new ea;for(r.length()%3===2&&l!==2&&(a=this.backtrackOneCharacter(e,r,c,a));r.length()%3===1&&(a>3||l!==1);)a=this.backtrackOneCharacter(e,r,c,a);break}var u=r.length();if(u%3===0){var d=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(d!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}}this.handleEOD(e,r)},t.prototype.backtrackOneCharacter=function(e,r,n,a){var s=r.length(),o=r.toString().substring(0,s-a);r.setLengthToZero(),r.append(o),e.pos--;var l=e.getCurrentChar();return a=this.encodeChar(l,n),e.resetSymbolInfo(),a},t.prototype.writeNextTriplet=function(e,r){e.writeCodewords(this.encodeToCodewords(r.toString()));var n=r.toString().substring(3);r.setLengthToZero(),r.append(n)},t.prototype.handleEOD=function(e,r){var n=Math.floor(r.length()/3*2),a=r.length()%3,s=e.getCodewordCount()+n;e.updateSymbolInfo(s);var o=e.getSymbolInfo().getDataCapacity()-s;if(a===2){for(r.append("\0");r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(q5)}else if(o===1&&a===1){for(;r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(q5),e.pos--}else if(a===0){for(;r.length()>=3;)this.writeNextTriplet(e,r);(o>0||e.hasMoreCharacters())&&e.writeCodeword(q5)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(Xa)},t.prototype.encodeChar=function(e,r){if(e===32)return r.append(3),1;if(e>=48&&e<=57)return r.append(e-48+4),1;if(e>=65&&e<=90)return r.append(e-65+14),1;if(e<32)return r.append(0),r.append(e),2;if(e<=47)return r.append(1),r.append(e-33),2;if(e<=64)return r.append(1),r.append(e-58+15),2;if(e<=95)return r.append(1),r.append(e-91+22),2;if(e<=127)return r.append(2),r.append(e-96),2;r.append("1");var n=2;return n+=this.encodeChar(e-128,r),n},t.prototype.encodeToCodewords=function(e){var r=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=r/256,a=r%256,s=new ea;return s.append(n),s.append(a),s.toString()},t}(),P9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return qo},t.prototype.encode=function(e){for(var r=new ea;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,r),e.pos++;var a=r.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(r.toString()));var s=r.toString().substring(4);r.setLengthToZero(),r.append(s);var o=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}}r.append(ba.getCharAt(31)),this.handleEOD(e,r)},t.prototype.handleEOD=function(e,r){try{var n=r.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,l=this.encodeToCodewords(r.toString()),c=!e.hasMoreCharacters(),u=c&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(u=!1,e.updateSymbolInfo(e.getCodewordCount()+l.length))}u?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(l)}finally{e.signalEncoderChange(Xa)}},t.prototype.encodeChar=function(e,r){e>=32&&e<=63?r.append(e):e>=64&&e<=94?r.append(ba.getCharAt(e-64)):lf.illegalCharacter(ba.getCharAt(e))},t.prototype.encodeToCodewords=function(e){var r=e.length;if(r===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=r>=2?e.charAt(1).charCodeAt(0):0,s=r>=3?e.charAt(2).charCodeAt(0):0,o=r>=4?e.charAt(3).charCodeAt(0):0,l=(n<<18)+(a<<12)+(s<<6)+o,c=l>>16&255,u=l>>8&255,d=l&255,f=new ea;return f.append(c),r>=2&&f.append(u),r>=3&&f.append(d),f.toString()},t}(),B9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),T9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Da=function(){function t(e,r,n,a,s,o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=r,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=s,this.dataRegions=o,this.rsBlockData=l,this.rsBlockError=c}return t.lookup=function(e,r,n,a,s){var o,l;r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!0);try{for(var c=T9e(F9e),u=c.next();!u.done;u=c.next()){var d=u.value;if(!(r===1&&d.rectangular)&&!(r===2&&!d.rectangular)&&!(n!=null&&(d.getSymbolWidth()<n.getWidth()||d.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(d.getSymbolWidth()>a.getWidth()||d.getSymbolHeight()>a.getHeight()))&&e<=d.dataCapacity)return d}}catch(f){o={error:f}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},t.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},t.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},t.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},t.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},t.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},t.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},t.prototype.getDataCapacity=function(){return this.dataCapacity},t.prototype.getErrorCodewords=function(){return this.errorCodewords},t.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},t.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},t}(),k9e=function(t){B9e(e,t);function e(){return t.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(r){return r<=8?156:155},e}(Da),F9e=[new Da(!1,3,5,8,8,1),new Da(!1,5,7,10,10,1),new Da(!0,5,7,16,6,1),new Da(!1,8,10,12,12,1),new Da(!0,10,11,14,6,2),new Da(!1,12,12,14,14,1),new Da(!0,16,14,24,10,1),new Da(!1,18,14,16,16,1),new Da(!1,22,18,18,18,1),new Da(!0,22,18,16,10,2),new Da(!1,30,20,20,20,1),new Da(!0,32,24,16,14,2),new Da(!1,36,24,22,22,1),new Da(!1,44,28,24,24,1),new Da(!0,49,28,22,14,2),new Da(!1,62,36,14,14,4),new Da(!1,86,42,16,16,4),new Da(!1,114,48,18,18,4),new Da(!1,144,56,20,20,4),new Da(!1,174,68,22,22,4),new Da(!1,204,84,24,24,4,102,42),new Da(!1,280,112,14,14,16,140,56),new Da(!1,368,144,16,16,16,92,36),new Da(!1,456,192,18,18,16,114,48),new Da(!1,576,224,20,20,16,144,56),new Da(!1,696,272,22,22,16,174,68),new Da(!1,816,336,24,24,16,136,56),new Da(!1,1050,408,18,18,36,175,68),new Da(!1,1304,496,20,20,36,163,62),new k9e],O9e=function(){function t(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var r=e.split("").map(function(l){return l.charCodeAt(0)}),n=new ea,a=0,s=r.length;a<s;a++){var o=String.fromCharCode(r[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new ea,this.newEncoding=-1}return t.prototype.setSymbolShape=function(e){this.shape=e},t.prototype.setSizeConstraints=function(e,r){this.minSize=e,this.maxSize=r},t.prototype.getMessage=function(){return this.msg},t.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},t.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCodewords=function(){return this.codewords},t.prototype.writeCodewords=function(e){this.codewords.append(e)},t.prototype.writeCodeword=function(e){this.codewords.append(e)},t.prototype.getCodewordCount=function(){return this.codewords.length()},t.prototype.getNewEncoding=function(){return this.newEncoding},t.prototype.signalEncoderChange=function(e){this.newEncoding=e},t.prototype.resetEncoderSignal=function(){this.newEncoding=-1},t.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},t.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},t.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},t.prototype.getSymbolInfo=function(){return this.symbolInfo},t.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=Da.lookup(e,this.shape,this.minSize,this.maxSize,!0))},t.prototype.resetSymbolInfo=function(){this.symbolInfo=null},t}(),D9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),R9e=function(t){D9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return bo},e.prototype.encode=function(r){for(var n=new ea;r.hasMoreCharacters();){var a=r.getCurrentChar();r.pos++,this.encodeChar(a,n);var s=n.length();if(s%3===0){this.writeNextTriplet(r,n);var o=lf.lookAheadTest(r.getMessage(),r.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){r.signalEncoderChange(Xa);break}}}this.handleEOD(r,n)},e.prototype.encodeChar=function(r,n){switch(r){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:r>=48&&r<=57?n.append(r-48+4):r>=65&&r<=90?n.append(r-65+14):lf.illegalCharacter(ba.getCharAt(r));break}return 1},e.prototype.handleEOD=function(r,n){r.updateSymbolInfo();var a=r.getSymbolInfo().getDataCapacity()-r.getCodewordCount(),s=n.length();r.pos-=s,(r.getRemainingCharacters()>1||a>1||r.getRemainingCharacters()!==a)&&r.writeCodeword(S9e),r.getNewEncoding()<0&&r.signalEncoderChange(Xa)},e}(UR),M9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),L9e=function(t){M9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return xc},e.prototype.encodeChar=function(r,n){if(r===32)return n.append(3),1;if(r>=48&&r<=57)return n.append(r-48+4),1;if(r>=97&&r<=122)return n.append(r-97+14),1;if(r<32)return n.append(0),n.append(r),2;if(r<=47)return n.append(1),n.append(r-33),2;if(r<=64)return n.append(1),n.append(r-58+15),2;if(r>=91&&r<=95)return n.append(1),n.append(r-91+22),2;if(r===96)return n.append(2),n.append(0),2;if(r<=90)return n.append(2),n.append(r-65+1),2;if(r<=127)return n.append(2),n.append(r-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(r-128,n),a},e}(UR),lf=function(){function t(){}return t.randomize253State=function(e){var r=149*e%253+1,n=Y$+r;return n<=254?n:n-254},t.encodeHighLevel=function(e,r,n,a,s){r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!1);var o=new UR,l=[new I9e,o,new L9e,new R9e,new P9e,new j9e],c=new O9e(e);c.setSymbolShape(r),c.setSizeConstraints(n,a),e.startsWith(J$)&&e.endsWith(eK)?(c.writeCodeword(w9e),c.setSkipAtEnd(2),c.pos+=J$.length):e.startsWith(Z$)&&e.endsWith(eK)&&(c.writeCodeword(N9e),c.setSkipAtEnd(2),c.pos+=Z$.length);var u=Xa;for(s&&(o.encodeMaximal(c),u=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)l[u].encode(c),c.getNewEncoding()>=0&&(u=c.getNewEncoding(),c.resetEncoderSignal());var d=c.getCodewordCount();c.updateSymbolInfo();var f=c.getSymbolInfo().getDataCapacity();d<f&&u!==Xa&&u!==Wl&&u!==qo&&c.writeCodeword("");var A=c.getCodewords();for(A.length()<f&&A.append(Y$);A.length()<f;)A.append(this.randomize253State(A.length()+1));return c.getCodewords().toString()},t.lookAheadTest=function(e,r,n){var a=this.lookAheadTestIntern(e,r,n);if(n===bo&&a===bo){for(var s=Math.min(r+3,e.length),o=r;o<s;o++)if(!this.isNativeX12(e.charCodeAt(o)))return Xa}else if(n===qo&&a===qo){for(var s=Math.min(r+4,e.length),o=r;o<s;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return Xa}return a},t.lookAheadTestIntern=function(e,r,n){if(r>=e.length)return n;var a;n===Xa?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var s=0,o=new Uint8Array(6),l=[];;){if(r+s===e.length){Bo.fill(o,0),Bo.fill(l,0);var c=this.findMinimums(a,l,sa.MAX_VALUE,o),u=this.getMinimumCount(o);if(l[Xa]===c)return Xa;if(u===1){if(o[Wl]>0)return Wl;if(o[qo]>0)return qo;if(o[xc]>0)return xc;if(o[bo]>0)return bo}return xl}var d=e.charCodeAt(r+s);if(s++,this.isDigit(d)?a[Xa]+=.5:this.isExtendedASCII(d)?(a[Xa]=Math.ceil(a[Xa]),a[Xa]+=2):(a[Xa]=Math.ceil(a[Xa]),a[Xa]++),this.isNativeC40(d)?a[xl]+=2/3:this.isExtendedASCII(d)?a[xl]+=8/3:a[xl]+=4/3,this.isNativeText(d)?a[xc]+=2/3:this.isExtendedASCII(d)?a[xc]+=8/3:a[xc]+=4/3,this.isNativeX12(d)?a[bo]+=2/3:this.isExtendedASCII(d)?a[bo]+=13/3:a[bo]+=10/3,this.isNativeEDIFACT(d)?a[qo]+=3/4:this.isExtendedASCII(d)?a[qo]+=17/4:a[qo]+=13/4,this.isSpecialB256(d)?a[Wl]+=4:a[Wl]++,s>=4){if(Bo.fill(o,0),Bo.fill(l,0),this.findMinimums(a,l,sa.MAX_VALUE,o),l[Xa]<this.min(l[Wl],l[xl],l[xc],l[bo],l[qo]))return Xa;if(l[Wl]<l[Xa]||l[Wl]+1<this.min(l[xl],l[xc],l[bo],l[qo]))return Wl;if(l[qo]+1<this.min(l[Wl],l[xl],l[xc],l[bo],l[Xa]))return qo;if(l[xc]+1<this.min(l[Wl],l[xl],l[qo],l[bo],l[Xa]))return xc;if(l[bo]+1<this.min(l[Wl],l[xl],l[qo],l[xc],l[Xa]))return bo;if(l[xl]+1<this.min(l[Xa],l[Wl],l[qo],l[xc])){if(l[xl]<l[bo])return xl;if(l[xl]===l[bo]){for(var f=r+s+1;f<e.length;){var A=e.charCodeAt(f);if(this.isX12TermSep(A))return bo;if(!this.isNativeX12(A))break;f++}return xl}}}}},t.min=function(e,r,n,a,s){var o=Math.min(e,Math.min(r,Math.min(n,a)));return s===void 0?o:Math.min(o,s)},t.findMinimums=function(e,r,n,a){for(var s=0;s<6;s++){var o=r[s]=Math.ceil(e[s]);n>o&&(n=o,Bo.fill(a,0)),n===o&&(a[s]=a[s]+1)}return n},t.getMinimumCount=function(e){for(var r=0,n=0;n<6;n++)r+=e[n];return r||0},t.isDigit=function(e){return e>=48&&e<=57},t.isExtendedASCII=function(e){return e>=128&&e<=255},t.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},t.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},t.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},t.isX12TermSep=function(e){return e===13||e===42||e===62},t.isNativeEDIFACT=function(e){return e>=32&&e<=94},t.isSpecialB256=function(e){return!1},t.determineConsecutiveDigitCount=function(e,r){r===void 0&&(r=0);for(var n=e.length,a=r;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-r},t.illegalCharacter=function(e){var r=sa.toHexString(e.charCodeAt(0));throw r="0000".substring(0,4-r.length)+r,new Error("Illegal character: "+e+" (0x"+r+")")},t}(),z5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tK=function(){function t(e){this.charset=e,this.name=e.name}return t.prototype.canEncode=function(e){try{return Bd.encode(e,this.charset)!=null}catch{return!1}},t}(),U9e=function(){function t(e,r,n){var a,s,o,l,c,u;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(E){return new tK(p9e.forName(E))}),this.encoders=[];var d=[];d.push(new tK(g9e.ISO_8859_1));for(var f=r!=null&&r.name.startsWith("UTF"),A=0;A<e.length;A++){var h=!1;try{for(var m=(a=void 0,z5(d)),p=m.next();!p.done;p=m.next()){var x=p.value,v=e.charAt(A),y=v.charCodeAt(0);if(y===n||x.canEncode(v)){h=!0;break}}}catch(E){a={error:E}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!h)try{for(var b=(o=void 0,z5(this.ENCODERS)),w=b.next();!w.done;w=b.next()){var x=w.value;if(x.canEncode(e.charAt(A))){d.push(x),h=!0;break}}}catch(E){o={error:E}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(o)throw o.error}}h||(f=!0)}if(d.length===1&&!f)this.encoders=[d[0]];else{this.encoders=[];var j=0;try{for(var I=z5(d),_=I.next();!_.done;_=I.next()){var x=_.value;this.encoders[j++]=x}}catch(E){c={error:E}}finally{try{_&&!_.done&&(u=I.return)&&u.call(I)}finally{if(c)throw c.error}}}var S=-1;if(r!=null){for(var A=0;A<this.encoders.length;A++)if(this.encoders[A]!=null&&r.name===this.encoders[A].name){S=A;break}}this.priorityEncoderIndex=S}return t.prototype.length=function(){return this.encoders.length},t.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},t.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},t.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},t.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},t.prototype.canEncode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return!0},t.prototype.encode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return Bd.encode(ba.getCharAt(e),this.encoders[r].name)},t}(),Q9e=3,V9e=function(){function t(e,r,n){this.fnc1=n;var a=new U9e(e,r,n);if(a.length()===1)for(var s=0;s<this.bytes.length;s++){var o=e.charAt(s).charCodeAt(0);this.bytes[s]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(e,r){if(e+r-1>=this.bytes.length)return!1;for(var n=0;n<r;n++)if(this.isECI(e+n))return!1;return!0},t.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},t.prototype.subSequence=function(e,r){if(e<0||e>r||r>this.length())throw new Error(""+e);for(var n=new ea,a=e;a<r;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},t.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},t.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},t.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},t.prototype.addEdge=function(e,r,n){(e[r][n.encoderIndex]==null||e[r][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[r][n.encoderIndex]=n)},t.prototype.addEdges=function(e,r,n,a,s,o){var l=e.charAt(a).charCodeAt(0),c=0,u=r.length();r.getPriorityEncoderIndex()>=0&&(l===o||r.canEncode(l,r.getPriorityEncoderIndex()))&&(c=r.getPriorityEncoderIndex(),u=c+1);for(var d=c;d<u;d++)(l===o||r.canEncode(l,d))&&this.addEdge(n,a+1,new rK(l,r,d,s,o))},t.prototype.encodeMinimally=function(e,r,n){var a=e.length,s=new rK[a+1][r.length()];this.addEdges(e,r,s,0,null,n);for(var o=1;o<=a;o++){for(var l=0;l<r.length();l++)s[o][l]!=null&&o<a&&this.addEdges(e,r,s,o,s[o][l],n);for(var l=0;l<r.length();l++)s[o-1][l]=null}for(var c=-1,u=sa.MAX_VALUE,l=0;l<r.length();l++)if(s[a][l]!=null){var d=s[a][l];d.cachedTotalSize<u&&(u=d.cachedTotalSize,c=l)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],A=s[a][c];A!=null;){if(A.isFNC1())f.unshift(1e3);else for(var h=r.encode(A.c,A.encoderIndex),o=h.length-1;o>=0;o--)f.unshift(h[o]&255);var m=A.previous===null?0:A.previous.encoderIndex;m!==A.encoderIndex&&f.unshift(256+r.getECIValue(A.encoderIndex)),A=A.previous}for(var p=[],o=0;o<p.length;o++)p[o]=f[o];return p},t}(),rK=function(){function t(e,r,n,a,s){this.c=e,this.encoderSet=r,this.encoderIndex=n,this.previous=a,this.fnc1=s,this.c=e===s?1e3:e;var o=this.isFNC1()?1:r.encode(e,n).length,l=a===null?0:a.encoderIndex;l!==n&&(o+=Q9e),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return this.c===1e3},t}(),H9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var nK;(function(t){t[t.ASCII=0]="ASCII",t[t.C40=1]="C40",t[t.TEXT=2]="TEXT",t[t.X12=3]="X12",t[t.EDF=4]="EDF",t[t.B256=5]="B256"})(nK||(nK={}));(function(t){H9e(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n,a)||this;return l.shape=s,l.macroId=o,l}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(V9e);var $9e=function(){function t(){}return t.prototype.isCompact=function(){return this.compact},t.prototype.setCompact=function(e){this.compact=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getLayers=function(){return this.layers},t.prototype.setLayers=function(e){this.layers=e},t.prototype.getCodeWords=function(){return this.codeWords},t.prototype.setCodeWords=function(e){this.codeWords=e},t.prototype.getMatrix=function(){return this.matrix},t.prototype.setMatrix=function(e){this.matrix=e},t}(),aK=function(){function t(){}return t.singletonList=function(e){return[e]},t.min=function(e,r){return e.sort(r)[0]},t}(),K9e=function(){function t(e){this.previous=e}return t.prototype.getPrevious=function(){return this.previous},t}(),G9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),QR=function(t){G9e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.value=n,s.bitCount=a,s}return e.prototype.appendTo=function(r,n){r.appendBits(this.value,this.bitCount)},e.prototype.add=function(r,n){return new e(this,r,n)},e.prototype.addBinaryShift=function(r,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,r,n)},e.prototype.toString=function(){var r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+sa.toBinaryString(r|1<<this.bitCount).substring(1)+">"},e}(K9e),q9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z9e=function(t){q9e(e,t);function e(r,n,a){var s=t.call(this,r,0,0)||this;return s.binaryShiftStart=n,s.binaryShiftByteCount=a,s}return e.prototype.appendTo=function(r,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(r,n){return new e(this,r,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(QR);function W9e(t,e,r){return new z9e(t,e,r)}function by(t,e,r){return new QR(t,e,r)}var X9e=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Am=0,sI=1,_d=2,kse=3,eh=4,Y9e=new QR(null,0,0),W5=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],J9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function Z9e(t){var e,r;try{for(var n=J9e(t),a=n.next();!a.done;a=n.next()){var s=a.value;Bo.fill(s,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return t[Am][eh]=0,t[sI][eh]=0,t[sI][Am]=28,t[kse][eh]=0,t[_d][eh]=0,t[_d][Am]=15,t}var Fse=Z9e(Bo.createInt32Array(6,6)),eQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tQe=function(){function t(e,r,n,a){this.token=e,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}return t.prototype.getMode=function(){return this.mode},t.prototype.getToken=function(){return this.token},t.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},t.prototype.getBitCount=function(){return this.bitCount},t.prototype.latchAndAppend=function(e,r){var n=this.bitCount,a=this.token;if(e!==this.mode){var s=W5[this.mode][e];a=by(a,s&65535,s>>16),n+=s>>16}var o=e===_d?4:5;return a=by(a,r,o),new t(a,e,0,n+o)},t.prototype.shiftAndAppend=function(e,r){var n=this.token,a=this.mode===_d?4:5;return n=by(n,Fse[this.mode][e],a),n=by(n,r,5),new t(n,this.mode,0,this.bitCount+a+5)},t.prototype.addBinaryShiftChar=function(e){var r=this.token,n=this.mode,a=this.bitCount;if(this.mode===eh||this.mode===_d){var s=W5[n][Am];r=by(r,s&65535,s>>16),a+=s>>16,n=Am}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new t(r,n,this.binaryShiftByteCount+1,a+o);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(e+1)),l},t.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var r=this.token;return r=W9e(r,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new t(r,this.mode,0,this.bitCount)},t.prototype.isBetterThanOrEqualTo=function(e){var r=this.bitCount+(W5[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?r+=t.calculateBinaryShiftCost(e)-t.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(r+=10),r<=e.bitCount},t.prototype.toBitArray=function(e){for(var r,n,a=[],s=this.endBinaryShift(e.length).token;s!==null;s=s.getPrevious())a.unshift(s);var o=new el;try{for(var l=eQe(a),c=l.next();!c.done;c=l.next()){var u=c.value;u.appendTo(o,e)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t.prototype.toString=function(){return ba.format("%s bits=%d bytes=%d",X9e[this.mode],this.bitCount,this.binaryShiftByteCount)},t.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},t.INITIAL_STATE=new t(Y9e,Am,0,0),t}();function rQe(t){var e=ba.getCharCode(" "),r=ba.getCharCode("."),n=ba.getCharCode(",");t[Am][e]=1;for(var a=ba.getCharCode("Z"),s=ba.getCharCode("A"),o=s;o<=a;o++)t[Am][o]=o-s+2;t[sI][e]=1;for(var l=ba.getCharCode("z"),c=ba.getCharCode("a"),o=c;o<=l;o++)t[sI][o]=o-c+2;t[_d][e]=1;for(var u=ba.getCharCode("9"),d=ba.getCharCode("0"),o=d;o<=u;o++)t[_d][o]=o-d+2;t[_d][n]=12,t[_d][r]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],A=0;A<f.length;A++)t[kse][ba.getCharCode(f[A])]=A;for(var h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],A=0;A<h.length;A++)ba.getCharCode(h[A])>0&&(t[eh][ba.getCharCode(h[A])]=A);return t}var X5=rQe(Bo.createInt32Array(5,256)),u_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},nQe=function(){function t(e){this.text=e}return t.prototype.encode=function(){for(var e=ba.getCharCode(" "),r=ba.getCharCode(`
`),n=aK.singletonList(tQe.INITIAL_STATE),a=0;a<this.text.length;a++){var s=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case ba.getCharCode("\r"):s=o===r?2:0;break;case ba.getCharCode("."):s=o===e?3:0;break;case ba.getCharCode(","):s=o===e?4:0;break;case ba.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=t.updateStateListForPair(n,a,s),a++):n=this.updateStateListForChar(n,a)}var l=aK.min(n,function(c,u){return c.getBitCount()-u.getBitCount()});return l.toBitArray(this.text)},t.prototype.updateStateListForChar=function(e,r){var n,a,s=[];try{for(var o=u_(e),l=o.next();!l.done;l=o.next()){var c=l.value;this.updateStateForChar(c,r,s)}}catch(u){n={error:u}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return t.simplifyStates(s)},t.prototype.updateStateForChar=function(e,r,n){for(var a=this.text[r]&255,s=X5[e.getMode()][a]>0,o=null,l=0;l<=eh;l++){var c=X5[l][a];if(c>0){if(o==null&&(o=e.endBinaryShift(r)),!s||l===e.getMode()||l===_d){var u=o.latchAndAppend(l,c);n.push(u)}if(!s&&Fse[e.getMode()][l]>=0){var d=o.shiftAndAppend(l,c);n.push(d)}}}if(e.getBinaryShiftByteCount()>0||X5[e.getMode()][a]===0){var f=e.addBinaryShiftChar(r);n.push(f)}},t.updateStateListForPair=function(e,r,n){var a,s,o=[];try{for(var l=u_(e),c=l.next();!c.done;c=l.next()){var u=c.value;this.updateStateForPair(u,r,n,o)}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}return this.simplifyStates(o)},t.updateStateForPair=function(e,r,n,a){var s=e.endBinaryShift(r);if(a.push(s.latchAndAppend(eh,n)),e.getMode()!==eh&&a.push(s.shiftAndAppend(eh,n)),n===3||n===4){var o=s.latchAndAppend(_d,16-n).latchAndAppend(_d,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var l=e.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(l)}},t.simplifyStates=function(e){var r,n,a,s,o=[];try{for(var l=u_(e),c=l.next();!c.done;c=l.next()){var u=c.value,d=!0,f=function(x){if(x.isBetterThanOrEqualTo(u))return d=!1,"break";u.isBetterThanOrEqualTo(x)&&(o=o.filter(function(v){return v!==x}))};try{for(var A=(a=void 0,u_(o)),h=A.next();!h.done;h=A.next()){var m=h.value,p=f(m);if(p==="break")break}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}d&&o.push(u)}}catch(x){r={error:x}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t}(),aQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.encodeBytes=function(e){return t.encode(e,t.DEFAULT_EC_PERCENT,t.DEFAULT_AZTEC_LAYERS)},t.encode=function(e,r,n){var a=new nQe(e).encode(),s=sa.truncDivision(a.getSize()*r,100)+11,o=a.getSize()+s,l,c,u,d,f;if(n!==t.DEFAULT_AZTEC_LAYERS){if(l=n<0,c=Math.abs(n),c>(l?t.MAX_NB_BITS_COMPACT:t.MAX_NB_BITS))throw new Pn(ba.format("Illegal value %s for layers",n));u=t.totalBitsInLayer(c,l),d=t.WORD_SIZE[c];var A=u-u%d;if(f=t.stuffBits(a,d),f.getSize()+s>A)throw new Pn("Data to large for user specified layer");if(l&&f.getSize()>d*64)throw new Pn("Data to large for user specified layer")}else{d=0,f=null;for(var h=0;;h++){if(h>t.MAX_NB_BITS)throw new Pn("Data too large for an Aztec code");if(l=h<=3,c=l?h+1:h,u=t.totalBitsInLayer(c,l),!(o>u)){(f==null||d!==t.WORD_SIZE[c])&&(d=t.WORD_SIZE[c],f=t.stuffBits(a,d));var A=u-u%d;if(!(l&&f.getSize()>d*64)&&f.getSize()+s<=A)break}}}var m=t.generateCheckWords(f,u,d),p=f.getSize()/d,x=t.generateModeMessage(l,c,p),v=(l?11:14)+c*4,y=new Int32Array(v),b;if(l){b=v;for(var h=0;h<y.length;h++)y[h]=h}else{b=v+1+2*sa.truncDivision(sa.truncDivision(v,2)-1,15);for(var w=sa.truncDivision(v,2),j=sa.truncDivision(b,2),h=0;h<w;h++){var I=h+sa.truncDivision(h,15);y[w-h-1]=j-I-1,y[w+h]=j+I+1}}for(var _=new lh(b),h=0,S=0;h<c;h++){for(var E=(c-h)*4+(l?9:12),B=0;B<E;B++)for(var k=B*2,P=0;P<2;P++)m.get(S+k+P)&&_.set(y[h*2+P],y[h*2+B]),m.get(S+E*2+k+P)&&_.set(y[h*2+B],y[v-1-h*2-P]),m.get(S+E*4+k+P)&&_.set(y[v-1-h*2-P],y[v-1-h*2-B]),m.get(S+E*6+k+P)&&_.set(y[v-1-h*2-B],y[h*2+P]);S+=E*8}if(t.drawModeMessage(_,l,b,x),l)t.drawBullsEye(_,sa.truncDivision(b,2),5);else{t.drawBullsEye(_,sa.truncDivision(b,2),7);for(var h=0,B=0;h<sa.truncDivision(v,2)-1;h+=15,B+=16)for(var P=sa.truncDivision(b,2)&1;P<b;P+=2)_.set(sa.truncDivision(b,2)-B,P),_.set(sa.truncDivision(b,2)+B,P),_.set(P,sa.truncDivision(b,2)-B),_.set(P,sa.truncDivision(b,2)+B)}var O=new $9e;return O.setCompact(l),O.setSize(b),O.setLayers(c),O.setCodeWords(p),O.setMatrix(_),O},t.drawBullsEye=function(e,r,n){for(var a=0;a<n;a+=2)for(var s=r-a;s<=r+a;s++)e.set(s,r-a),e.set(s,r+a),e.set(r-a,s),e.set(r+a,s);e.set(r-n,r-n),e.set(r-n+1,r-n),e.set(r-n,r-n+1),e.set(r+n,r-n),e.set(r+n,r-n+1),e.set(r+n,r+n-1)},t.generateModeMessage=function(e,r,n){var a=new el;return e?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=t.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=t.generateCheckWords(a,40,4)),a},t.drawModeMessage=function(e,r,n,a){var s=sa.truncDivision(n,2);if(r)for(var o=0;o<7;o++){var l=s-3+o;a.get(o)&&e.set(l,s-5),a.get(o+7)&&e.set(s+5,l),a.get(20-o)&&e.set(l,s+5),a.get(27-o)&&e.set(s-5,l)}else for(var o=0;o<10;o++){var l=s-5+o+sa.truncDivision(o,5);a.get(o)&&e.set(l,s-7),a.get(o+10)&&e.set(s+7,l),a.get(29-o)&&e.set(l,s+7),a.get(39-o)&&e.set(s-7,l)}},t.generateCheckWords=function(e,r,n){var a,s,o=e.getSize()/n,l=new Bse(t.getGF(n)),c=sa.truncDivision(r,n),u=t.bitsToWords(e,n,c);l.encode(u,c-o);var d=r%n,f=new el;f.appendBits(0,d);try{for(var A=aQe(Array.from(u)),h=A.next();!h.done;h=A.next()){var m=h.value;f.appendBits(m,n)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}return f},t.bitsToWords=function(e,r,n){var a=new Int32Array(n),s,o;for(s=0,o=e.getSize()/r;s<o;s++){for(var l=0,c=0;c<r;c++)l|=e.get(s*r+c)?1<<r-c-1:0;a[s]=l}return a},t.getGF=function(e){switch(e){case 4:return Jc.AZTEC_PARAM;case 6:return Jc.AZTEC_DATA_6;case 8:return Jc.AZTEC_DATA_8;case 10:return Jc.AZTEC_DATA_10;case 12:return Jc.AZTEC_DATA_12;default:throw new Pn("Unsupported word size "+e)}},t.stuffBits=function(e,r){for(var n=new el,a=e.getSize(),s=(1<<r)-2,o=0;o<a;o+=r){for(var l=0,c=0;c<r;c++)(o+c>=a||e.get(o+c))&&(l|=1<<r-1-c);(l&s)===s?(n.appendBits(l&s,r),o--):l&s?n.appendBits(l,r):(n.appendBits(l|1,r),o--)}return n},t.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.DEFAULT_EC_PERCENT=33,t.DEFAULT_AZTEC_LAYERS=0,t.MAX_NB_BITS=32,t.MAX_NB_BITS_COMPACT=4,t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),t})();var sQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),iQe=function(t){sQe(e,t);function e(r){var n=t.call(this,r.width,r.height)||this;return n.canvas=r,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(r),n}return e.makeBufferFromCanvasImageData=function(r){var n;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height)},e.toGrayscaleBuffer=function(r,n,a){for(var s=new Uint8ClampedArray(n*a),o=0,l=0,c=r.length;o<c;o+=4,l++){var u=void 0,d=r[o+3];if(d===0)u=255;else{var f=r[o],A=r[o+1],h=r[o+2];u=306*f+601*A+117*h+512>>10}s[l]=u}return s},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new xP(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=r*e.DEGREE_TO_RADIANS,s=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(a))*s+Math.abs(Math.sin(a))*o),c=Math.ceil(Math.abs(Math.sin(a))*s+Math.abs(Math.cos(a))*o);n.width=l,n.height=c;var u=n.getContext("2d");if(!u)throw new Error("Could not create a Canvas Context element.");return u.translate(l/2,c/2),u.rotate(a),u.drawImage(this.canvas,s/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(Kw);function Ose(){return typeof navigator<"u"}function oQe(){return Ose()&&!!navigator.mediaDevices}function lQe(){return!!(oQe()&&navigator.mediaDevices.enumerateDevices)}var Zx=function(){return Zx=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Zx.apply(this,arguments)},ti=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},ri=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Y5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},cQe={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},N1=function(){function t(e,r,n){r===void 0&&(r=new Map),n===void 0&&(n={}),this.reader=e,this.hints=r,this.options=Zx(Zx({},cQe),n)}return Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(Ns.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),t.addVideoSource=function(e,r){try{e.srcObject=r}catch{console.error("got interrupted by new loading request")}},t.mediaStreamSetTorch=function(e,r){return ti(this,void 0,void 0,function(){return ri(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:r?"flash":"off",torch:!!r}]})];case 1:return n.sent(),[2]}})})},t.mediaStreamIsTorchCompatible=function(e){var r,n,a=e.getVideoTracks();try{for(var s=Y5(a),o=s.next();!o.done;o=s.next()){var l=o.value;if(t.mediaStreamIsTorchCompatibleTrack(l))return!0}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},t.mediaStreamIsTorchCompatibleTrack=function(e){try{var r=e.getCapabilities();return"torch"in r}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},t.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},t.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Qi("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Qi("element with id '".concat(e,"' must be an ").concat(r," element"));return n},t.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return t.getMediaElement(e,"video");if(!e&&typeof document<"u"){var r=document.createElement("video");return r.width=200,r.height=200,r}throw new Error("Couldn't get videoElement from videoSource!")},t.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return t.getMediaElement(e,"img");if(typeof e>"u"){var r=document.createElement("img");return r.width=200,r.height=200,r}throw new Error("Couldn't get imageElement from imageSource!")},t.prepareVideoElement=function(e){var r=t.createVideoElement(e);return r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.createBinaryBitmapFromCanvas=function(e){var r=new iQe(e),n=new vse(r);return new xse(n)},t.drawImageOnCanvas=function(e,r){e.drawImage(r,0,0)},t.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},t.createCaptureCanvas=function(e){if(!e)throw new Qi("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var r=document.createElement("canvas"),n=t.getMediaElementDimensions(e),a=n.width,s=n.height;return r.style.width=a+"px",r.style.height=s+"px",r.width=a,r.height=s,r},t.tryPlayVideo=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:if(e!=null&&e.ended)return console.error("Trying to play video that has ended."),[2,!1];if(t.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return r=n.sent(),console.warn("It was not possible to play the video.",r),[2,!1];case 4:return[2]}})})},t.createCanvasFromMediaElement=function(e){var r=t.createCaptureCanvas(e),n=r.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return t.drawImageOnCanvas(n,e),r},t.createBinaryBitmapFromMediaElem=function(e){var r=t.createCanvasFromMediaElement(e);return t.createBinaryBitmapFromCanvas(r)},t.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},t.listVideoInputDevices=function(){return ti(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return ri(this,function(h){switch(h.label){case 0:if(!Ose())throw new Error("Can't enumerate devices, navigator is not present.");if(!lQe())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=Y5(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device ".concat(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.findDeviceById=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:return[4,t.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2]}})})},t.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},t.releaseAllStreams=function(){t.streamTracker.length!==0&&t.streamTracker.forEach(function(e){e.getTracks().forEach(function(r){return r.stop()})}),t.streamTracker=[]},t.playVideoOnLoadAsync=function(e,r){return ti(this,void 0,void 0,function(){var n;return ri(this,function(a){switch(a.label){case 0:return[4,t.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(s,o){var l=setTimeout(function(){t.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",c))},r),c=function(){t.tryPlayVideo(e).then(function(u){clearTimeout(l),e.removeEventListener("canplay",c),s(u)})};e.addEventListener("canplay",c)})]}})})},t.attachStreamToVideo=function(e,r,n){return n===void 0&&(n=5e3),ti(this,void 0,void 0,function(){var a;return ri(this,function(s){switch(s.label){case 0:return a=t.prepareVideoElement(r),t.addVideoSource(a,e),[4,t.playVideoOnLoadAsync(a,n)];case 1:return s.sent(),[2,a]}})})},t._waitImageLoad=function(e){return new Promise(function(r,n){var a=1e4,s=setTimeout(function(){t.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(s),e.removeEventListener("load",o),r()};e.addEventListener("load",o)})},t.checkCallbackFnOrThrow=function(e){if(!e)throw new Qi("`callbackFn` is a required parameter, you cannot capture results without it.")},t.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(r){return r.stop()}),e=void 0},t.prototype.decode=function(e){var r=t.createCanvasFromMediaElement(e);return this.decodeFromCanvas(r)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},t.prototype.decodeFromCanvas=function(e){var r=t.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(r)},t.prototype.decodeFromImageElement=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:if(!e)throw new Qi("An image element must be provided.");return r=t.prepareImageElement(e),[4,this._decodeOnLoadImage(r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeFromImageUrl=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:if(!e)throw new Qi("An URL must be provided.");r=t.prepareImageElement(),r.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(r)];case 2:return[2,n.sent()];case 3:return t.destroyImageElement(r),[7];case 4:return[2]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return ti(this,void 0,void 0,function(){var a,s;return ri(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,r,n)];case 3:return[2,o.sent()];case 4:throw s=o.sent(),t.disposeMediaStream(a),s;case 5:return[2]}})})},t.prototype.decodeFromStream=function(e,r,n){return ti(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A,h=this;return ri(this,function(m){switch(m.label){case 0:return t.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,t.attachStreamToVideo(e,r,a)];case 1:return s=m.sent(),o=function(){t.disposeMediaStream(e),t.cleanVideoSource(s)},l=this.scan(s,n,o),c=e.getVideoTracks(),u=Zx(Zx({},l),{stop:function(){l.stop()},streamVideoConstraintsApply:function(p,x){return ti(this,void 0,void 0,function(){var v,y,b,w,j,I,_;return ri(this,function(S){switch(S.label){case 0:v=x?c.filter(x):c,S.label=1;case 1:S.trys.push([1,6,7,8]),y=Y5(v),b=y.next(),S.label=2;case 2:return b.done?[3,5]:(w=b.value,[4,w.applyConstraints(p)]);case 3:S.sent(),S.label=4;case 4:return b=y.next(),[3,2];case 5:return[3,8];case 6:return j=S.sent(),I={error:j},[3,8];case 7:try{b&&!b.done&&(_=y.return)&&_.call(y)}finally{if(I)throw I.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(p){return c.find(p).getConstraints()},streamVideoSettingsGet:function(p){return c.find(p).getSettings()},streamVideoCapabilitiesGet:function(p){return c.find(p).getCapabilities()}}),d=t.mediaStreamIsTorchCompatible(e),d&&(f=c==null?void 0:c.find(function(p){return t.mediaStreamIsTorchCompatibleTrack(p)}),A=function(p){return ti(h,void 0,void 0,function(){return ri(this,function(x){switch(x.label){case 0:return[4,t.mediaStreamSetTorch(f,p)];case 1:return x.sent(),[2]}})})},u.switchTorch=A,u.stop=function(){return ti(h,void 0,void 0,function(){return ri(this,function(p){switch(p.label){case 0:return l.stop(),[4,A(!1)];case 1:return p.sent(),[2]}})})}),[2,u]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return ti(this,void 0,void 0,function(){var a,s;return ri(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromVideoElement=function(e,r){return ti(this,void 0,void 0,function(){var n,a;return ri(this,function(s){switch(s.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Qi("A video element must be provided.");return n=t.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,a)];case 1:return s.sent(),[2,this.scan(n,r)]}})})},t.prototype.decodeFromVideoUrl=function(e,r){return ti(this,void 0,void 0,function(){var n,a,s,o;return ri(this,function(l){switch(l.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Qi("An URL must be provided.");return n=t.prepareVideoElement(),n.src=e,a=function(){t.cleanVideoSource(n)},s=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,s)];case 1:return l.sent(),o=this.scan(n,r,a),[2,o]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return ti(this,void 0,void 0,function(){var n;return ri(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return ti(this,void 0,void 0,function(){var n,a,s;return ri(this,function(o){switch(o.label){case 0:return n=!!r,[4,t.attachStreamToVideo(e,r)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return s=o.sent(),[2,s];case 4:return n||t.cleanVideoSource(a),[7];case 5:return[2]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return ti(this,void 0,void 0,function(){var n,a;return ri(this,function(s){switch(s.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromVideoElement=function(e){return ti(this,void 0,void 0,function(){var r,n;return ri(this,function(a){switch(a.label){case 0:if(!e)throw new Qi("A video element must be provided.");return r=t.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(r,n)];case 1:return a.sent(),[4,this.scanOneResult(r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromVideoUrl=function(e){return ti(this,void 0,void 0,function(){var r,n;return ri(this,function(a){switch(a.label){case 0:if(!e)throw new Qi("An URL must be provided.");r=t.prepareVideoElement(),r.src=e,n=this.decodeOnceFromVideoElement(r),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return t.cleanVideoSource(r),[7];case 4:return[2]}})})},t.prototype.scanOneResult=function(e,r,n,a){var s=this;return r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,l){s.scan(e,function(c,u,d){if(c){o(c),d.stop();return}if(u){if(u instanceof lr&&r||u instanceof oo&&n||u instanceof qr&&a)return;d.stop(),l(u)}})})},t.prototype.scan=function(e,r,n){var a=this;t.checkCallbackFnOrThrow(r);var s=t.createCaptureCanvas(e),o;try{o=s.getContext("2d",{willReadFrequently:!0})}catch{o=s.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var l=function(){o=void 0,s=void 0},c=!1,u,d=function(){c=!0,clearTimeout(u),l(),n&&n()},f={stop:d},A=function(){if(!c)try{t.drawImageOnCanvas(o,e);var h=a.decodeFromCanvas(s);r(h,void 0,f),u=setTimeout(A,a.options.delayBetweenScanSuccess)}catch(v){r(void 0,v,f);var m=v instanceof oo,p=v instanceof qr,x=v instanceof lr;if(m||p||x){u=setTimeout(A,a.options.delayBetweenScanAttempts);return}l(),n&&n(v)}};return A(),f},t.prototype._decodeOnLoadImage=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:return r=t.isImageLoaded(e),r?[3,2]:[4,t._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},t.prototype.getUserMedia=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=n.sent(),t.streamTracker.push(r),[2,r]}})})},t.streamTracker=[],t}(),uQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){uQe(e,t);function e(r,n){return t.call(this,new eI,r,n)||this}return e})(N1);var dQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){dQe(e,t);function e(r,n){return t.call(this,new Yx(r),r,n)||this}return e})(N1);var fQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){fQe(e,t);function e(r,n){return t.call(this,new rI,r,n)||this}return e})(N1);var hQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$2=function(t){hQe(e,t);function e(r,n){var a=this,s=new Pse;return s.setHints(r),a=t.call(this,s,r,n)||this,a.reader=s,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(r){this.hints.set(Ns.POSSIBLE_FORMATS,r),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e.prototype.setHints=function(r){this.hints=r,this.reader.setHints(this.hints)},e}(N1),AQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){AQe(e,t);function e(r,n){return t.call(this,new aI,r,n)||this}return e})(N1);var mQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){mQe(e,t);function e(r,n){return t.call(this,new nI,r,n)||this}return e})(N1);const J5=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function os(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Rh(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function v0(t,e=1){const r=Math.floor(Rh(t,e));return r>0?r:e}function pQe(t){return Object.values(t||{}).every(r=>os(r)==="")}function ep(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(os(a),a));for(const a of e){const s=n.get(os(a));if(s!=null)return t[s]}}function gQe({open:t,code:e,onClose:r}){return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-lg border p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"font-bold text-lg",children:"Cdigo de barras"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Valor"}),i.jsx("div",{className:"text-xl font-mono font-semibold break-all",children:e})]}),i.jsx("div",{className:"mt-3 flex gap-2 justify-end",children:i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>{var n;try{(n=navigator.clipboard)==null||n.writeText(e)}catch{}},children:"Copiar"})})]})}):null}function xQe({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new $2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function vQe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState(1),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(null),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[P,O]=g.useState(1),[z,oe]=g.useState(""),[ce,ue]=g.useState(""),[ge,ne]=g.useState(""),[Oe,Ue]=g.useState(""),[F,H]=g.useState(""),[K,U]=g.useState(!1),[W,X]=g.useState(""),[D,V]=g.useState(!1),[Z,be]=g.useState("create"),[L,Xe]=g.useState(!1),[re,J]=g.useState(""),[De,ie]=g.useState([]),[He,Ge]=g.useState([]),[dt,_t]=g.useState(!1),[Bt,Ot]=g.useState(!1);g.useEffect(()=>{var lt;const Ie=window.matchMedia("(max-width: 900px)"),nt=()=>Ot(Ie.matches);return nt(),(lt=Ie.addEventListener)==null||lt.call(Ie,"change",nt),()=>{var ht;return(ht=Ie.removeEventListener)==null?void 0:ht.call(Ie,"change",nt)}},[]);const[jt,Qt]=g.useState(!0),[Ft,$e]=g.useState(!0);g.useEffect(()=>{Bt?(Qt(!1),$e(!1)):(Qt(!0),$e(!0))},[Bt]);const[Fe,Ze]=g.useState(null),[Te,ee]=g.useState({}),me=g.useRef(!1),Re=g.useRef(null);g.useEffect(()=>{n(!0),s("");const Ie=bt(Pe,"products_candies"),nt=sr(Ie,In("name","asc")),lt=jd(nt,ht=>{const kt=[],le={};ht.forEach(ot=>{const Nt=ot.data(),Rt=String(Nt.barcode||"").trim()||void 0;Rt&&(le[ot.id]=Rt),kt.push({id:ot.id,name:Nt.name||"",category:Nt.category||"",providerPrice:Number(Nt.providerPrice||0),unitsPerPackage:Number(Nt.unitsPerPackage||1),barcode:Rt,packaging:String(Nt.packaging||Nt.empaque||"").trim()||void 0,createdAt:Nt.createdAt})});const We=he.current||{};let it=!1;for(const ot of Object.keys(le))if((le[ot]||"")!==(We[ot]||"")){it=!0;break}l(kt),he.current=le,n(!1),!qe.current&&it&&(s(" Catlogo actualizado."),setTimeout(()=>s(""),3e3)),qe.current=!1},ht=>{console.error(ht),s(" Error sincronizando catlogo de dulces."),n(!1)});return()=>lt()},[t]);const he=g.useRef({}),qe=g.useRef(!0),st=g.useMemo(()=>{const Ie=os(ge),nt=String(Oe||"").trim(),lt=String(F||"").trim().toLowerCase();return lt?o.filter(ht=>String(ht.packaging||"").trim().toLowerCase()===lt):!Ie&&!nt?o:o.filter(ht=>{const kt=`${ht.category} ${ht.name}`.toLowerCase(),le=Ie?kt.includes(Ie):!0,We=String(ht.barcode||""),it=nt?We.includes(nt):!0;return le&&it})},[o,ge,Oe,F]),yt=7,[pe,je]=g.useState(1),we=g.useMemo(()=>{const Ie={};return st.forEach(nt=>{const lt=String(nt.category||"(sin categora)").trim()||"(sin categora)";Ie[lt]||(Ie[lt]=[]),Ie[lt].push(nt)}),Object.entries(Ie).map(([nt,lt])=>({category:nt,rows:lt.sort((ht,kt)=>ht.name.localeCompare(kt.name,"es"))})).sort((nt,lt)=>nt.category.localeCompare(lt.category,"es"))},[st]),Ye=Math.max(1,Math.ceil((Bt?we.length:st.length)/yt)),xe=g.useMemo(()=>{const Ie=(pe-1)*yt;return st.slice(Ie,Ie+yt)},[st,pe]),Se=g.useMemo(()=>{const Ie=(pe-1)*yt;return we.slice(Ie,Ie+yt)},[we,pe]);g.useEffect(()=>{je(1)},[ge,Oe,F]),g.useEffect(()=>{je(Ie=>Math.min(Ie,Ye))},[Ye]);const xt=()=>je(1),Pt=()=>je(Ie=>Math.max(1,Ie-1)),It=()=>je(Ie=>Math.min(Ye,Ie+1)),Ut=()=>je(Ye),Ht=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:xt,disabled:pe===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Pt,disabled:pe===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",pe," de ",Ye]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:It,disabled:pe===Ye,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ut,disabled:pe===Ye,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[st.length," producto(s)"]})]}),Le=Ie=>{ee(nt=>({...nt,[Ie]:!nt[Ie]}))},Ce=g.useMemo(()=>{const Ie=new Set;return o.forEach(nt=>{const lt=String(nt.category||"").trim();lt&&Ie.add(lt)}),Array.from(Ie).sort((nt,lt)=>nt.localeCompare(lt,"es"))},[o]),Ae=()=>{u(""),f(""),h(0),p(1),v(""),b("")},Qe=async Ie=>{if(Ie.preventDefault(),me.current||r)return;s("");const nt=String(c||"").trim(),lt=String(d||"").trim(),ht=Math.max(0,Rh(A,0)),kt=v0(m,1),le=String(x||"").trim();if(!nt)return s(" La categora es requerida.");if(!lt)return s(" El nombre del producto es requerido.");if(ht<=0)return s(" El precio proveedor debe ser > 0.");if(kt<=0)return s(" Und x paquete debe ser > 0.");const We=`${os(nt)}::${os(lt)}`,it=Date.now();if(Re.current&&Re.current.key===We&&it-Re.current.ts<4e3){s(" Ya se est creando este producto.");return}if(o.some(Nt=>os(Nt.category)===os(nt)&&os(Nt.name)===os(lt)))return s(" Ya existe un producto con esa categora y nombre.");if(le&&o.some(Rt=>String(Rt.barcode||"")===le))return s(" Ya existe un producto con ese cdigo de barras.");me.current=!0,Re.current={key:We,ts:it};try{if(n(!0),!(await $t(sr(bt(Pe,"products_candies"),Ar("category","==",nt),Ar("name","==",lt),xS(1)))).empty){s(" Ya existe un producto con esa categora y nombre.");return}if(le&&!(await $t(sr(bt(Pe,"products_candies"),Ar("barcode","==",le),xS(1)))).empty){s(" Ya existe un producto con ese cdigo de barras.");return}const Rt={category:nt,name:lt,providerPrice:ht,unitsPerPackage:kt,createdAt:xr.now()};le&&(Rt.barcode=le);const nr=String(y||"").trim();nr&&(Rt.packaging=nr),await Zn(bt(Pe,"products_candies"),Rt),s(" Producto creado."),Ae()}catch(Nt){console.error(Nt),s(" Error creando producto.")}finally{n(!1),me.current=!1}},fe=Ie=>{j(Ie.id),_(Ie.category),E(Ie.name),k(Ie.providerPrice),O(Ie.unitsPerPackage||1),oe(String(Ie.barcode||"")),ue(String(Ie.packaging||"")),s("")},te=()=>{j(null),_(""),E(""),k(0),O(1),oe(""),ue("")},_e=async()=>{if(!w)return;s("");const Ie=String(I||"").trim(),nt=String(S||"").trim(),lt=Math.max(0,Rh(B,0)),ht=v0(P,1),kt=String(z||"").trim(),le=String(ce||"").trim();if(!Ie)return s(" La categora es requerida.");if(!nt)return s(" El nombre del producto es requerido.");if(lt<=0)return s(" El precio proveedor debe ser > 0.");if(ht<=0)return s(" Und x paquete debe ser > 0.");if(o.some(it=>it.id!==w&&os(it.category)===os(Ie)&&os(it.name)===os(nt)))return s(" Ya existe otro producto con esa categora y nombre.");if(kt&&o.some(ot=>ot.id!==w&&String(ot.barcode||"")===kt))return s(" Ya existe otro producto con ese cdigo de barras.");try{n(!0);const it={category:Ie,name:nt,providerPrice:lt,unitsPerPackage:ht,updatedAt:xr.now()};it.barcode=kt||"",it.packaging=le||"",await Fn(er(Pe,"products_candies",w),it),l(ot=>ot.map(Nt=>Nt.id===w?{...Nt,category:Ie,name:nt,providerPrice:lt,unitsPerPackage:ht,barcode:kt||void 0,packaging:le||void 0}:Nt).sort((Nt,Rt)=>Nt.name.localeCompare(Rt.name,"es"))),Bt&&s(" Producto guardado."),te()}catch(it){console.error(it),s(" Error actualizando producto.")}finally{n(!1)}},R=async Ie=>{if(confirm(`Eliminar "${Ie.name}" (${Ie.category}) del catlogo?`))try{n(!0),await qn(er(Pe,"products_candies",Ie.id)),l(lt=>lt.filter(ht=>ht.id!==Ie.id)),s(" Producto eliminado.")}catch(lt){console.error(lt),s(" Error eliminando producto.")}finally{n(!1)}},Q=()=>{const Ie=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24,Empaque:"Tarro",Codigo:"7445074183182"}],nt=Qa.json_to_sheet(Ie),lt=Qa.book_new();Qa.book_append_sheet(lt,nt,"Productos");const ht=pP(lt,{type:"array",bookType:"xlsx"}),kt=new Blob([ht],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),le=URL.createObjectURL(kt),We=document.createElement("a");We.href=le,We.download="template_productos_dulces.xlsx",document.body.appendChild(We),We.click(),We.remove(),URL.revokeObjectURL(le)},G=Ie=>{const nt=[],lt=[];Ie.forEach((kt,le)=>{if(!kt||typeof kt!="object"||pQe(kt))return;const We=String(ep(kt,["Id","ID","productId","docId"])??"").trim(),it=String(ep(kt,["Categoria","Categora","Category","cat","category"])??"").trim(),ot=String(ep(kt,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),Nt=ep(kt,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),Rt=ep(kt,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),nr=ep(kt,["Codigo","Cdigo","Barcode","barcode","EAN","UPC","Code"]),_r=String(nr??"").trim(),$r=ep(kt,["Empaque","Packaging","PackagingType","Pack","Formato"]),or=String($r??"").trim(),kr=Math.max(0,Rh(Nt,0)),en=v0(Rt,1),rn=le+2;it||lt.push(`Fila ${rn}: falta Categoria.`),ot||lt.push(`Fila ${rn}: falta Producto/Nombre.`),kr<=0&&lt.push(`Fila ${rn}: PrecioProveedor debe ser > 0.`),en<=0&&lt.push(`Fila ${rn}: UnidadesPorPaquete debe ser > 0.`),it&&ot&&kr>0&&en>0&&nt.push({id:We||void 0,category:it,name:ot,providerPrice:kr,unitsPerPackage:en,barcode:_r||void 0,packaging:or||void 0,_raw:kt})});const ht=new Map;for(const kt of nt){const le=kt.id?`id::${kt.id}`:`${os(kt.category)}::${os(kt.name)}`;ht.set(le,kt)}return{rows:Array.from(ht.values()),errors:lt}},se=async Ie=>{if(s(""),Ge([]),ie([]),J((Ie==null?void 0:Ie.name)||""),!Ie)return;const nt=Ie.name.toLowerCase(),lt=nt.endsWith(".xlsx")||nt.endsWith(".xls"),ht=nt.endsWith(".csv");if(!lt&&!ht){Ge(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{_t(!0);const kt=new FileReader,le=await new Promise((_r,$r)=>{kt.onerror=()=>$r(new Error("No se pudo leer el archivo.")),kt.onload=()=>_r(kt.result),kt.readAsArrayBuffer(Ie)}),We=Vv(new Uint8Array(le),{type:"array"}),it=We.SheetNames[0],ot=We.Sheets[it],Nt=Qa.sheet_to_json(ot,{defval:""}),{rows:Rt,errors:nr}=G(Nt);ie(Rt),Ge(nr),Rt.length===0&&nr.length===0&&Ge(["No se encontraron filas vlidas para importar."])}catch(kt){console.error(kt),Ge(["Error leyendo el archivo. Revis que no est corrupto."])}finally{_t(!1)}},Ne=(Ie,nt)=>{ie(lt=>{const ht=[...lt],kt=ht[Ie];return kt?(ht[Ie]={...kt,...nt},ht):lt})},Me=async()=>{if(s(""),He.length>0){s(" Correg los errores antes de importar.");return}if(De.length===0){s(" No hay filas para importar.");return}try{_t(!0);const Ie={},nt={},lt={};o.forEach(We=>{Ie[We.id]=We,nt[`${os(We.category)}::${os(We.name)}`]=We;const it=String(We.barcode||"").trim();it&&(lt[it]=We)});const ht=tu(Pe);let kt=0,le=0;for(const We of De){const it=String(We.category||"").trim(),ot=String(We.name||"").trim(),Nt=Math.max(0,Rh(We.providerPrice,0)),Rt=v0(We.unitsPerPackage,1),nr=String(We.barcode||"").trim();if(!it||!ot||Nt<=0||Rt<=0)continue;let _r;if(We.id&&Ie[We.id])_r=Ie[We.id];else{const $r=`${os(it)}::${os(ot)}`;_r=nt[$r]}if(!_r&&nr&&lt[nr]&&(_r=lt[nr]),_r){const $r={category:it,name:ot,providerPrice:Nt,unitsPerPackage:Rt,updatedAt:xr.now()};We.barcode!=null&&($r.barcode=nr||""),We.packaging!=null&&($r.packaging=String(We.packaging||"")||""),ht.update(er(Pe,"products_candies",_r.id),$r),le+=1}else{const $r=er(bt(Pe,"products_candies")),or={category:it,name:ot,providerPrice:Nt,unitsPerPackage:Rt,createdAt:xr.now()};nr&&(or.barcode=nr),We.packaging&&(or.packaging=We.packaging),ht.set($r,or),kt+=1}}await ht.commit(),s(` Importacin lista. Creados: ${kt}, Actualizados: ${le}`),Xe(!1),ie([]),Ge([]),J(""),e()}catch(Ie){console.error(Ie),s(" Error importando productos a Firestore.")}finally{_t(!1)}},ze=g.useMemo(()=>{const Ie=new Set(o.map(le=>le.id)),nt=new Set(o.map(le=>`${os(le.category)}::${os(le.name)}`)),lt=new Set(o.map(le=>String(le.barcode||"").trim()).filter(Boolean));let ht=0,kt=0;for(const le of De){if(le.id&&Ie.has(le.id)){ht+=1;continue}const We=`${os(le.category)}::${os(le.name)}`;if(nt.has(We)){ht+=1;continue}const it=String(le.barcode||"").trim();if(it&&lt.has(it)){ht+=1;continue}kt+=1}return{willCreate:kt,willUpdate:ht,total:De.length}},[De,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catalogo"}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Oc,{onClick:e,loading:r||dt}),!Bt&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Xe(!0),ie([]),Ge([]),J("")},children:"Importar"})]})})]}),Bt&&i.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-900 text-white",onClick:()=>Qt(Ie=>!Ie),children:jt?"Ocultar creacin":"Crear producto"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Xe(!0),ie([]),Ge([]),J("")},children:"Importar"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-200",onClick:()=>$e(Ie=>!Ie),children:Ft?"Ocultar filtros":"Mostrar filtros"}),Ft&&i.jsxs("div",{className:"bg-white p-3 rounded shadow-sm border",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:F,onChange:Ie=>H(Ie.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),jt&&i.jsxs("form",{onSubmit:Qe,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:Ie=>u(Ie.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:d,onChange:Ie=>f(Ie.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:y,onChange:Ie=>b(Ie.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(A)?"":A,onChange:Ie=>h(Math.max(0,Rh(Ie.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:Ie=>p(v0(Ie.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo (opcional)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"w-full border rounded px-2 py-1",value:x,onChange:Ie=>v(Ie.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white hover:bg-black whitespace-nowrap",onClick:()=>{be("create"),V(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"md:col-span-6 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Ae,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),Ft&&i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:ge,onChange:Ie=>ne(Ie.target.value),placeholder:"Buscar por categora o producto"}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:F,onChange:Ie=>H(Ie.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:Oe,onChange:Ie=>Ue(Ie.target.value),placeholder:"Ej: 7445074183182"}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("search"),V(!0),$e(!0)},children:"Escanear producto"})}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ne(""),Ue("")},children:"Limpiar filtros"})})]}),i.jsxs("div",{className:"w-full md:w-auto text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:st.length})]})]}),Bt?i.jsxs("div",{className:"space-y-2",children:[r?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Cargando"}):st.length===0?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Sin productos."}):i.jsx("div",{className:"space-y-3",children:Se.map(Ie=>{const nt=!!Te[Ie.category];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Le(Ie.category),"aria-expanded":nt,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:Ie.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Ie.rows.length," producto(s)"]})]}),i.jsx("span",{className:`transition-transform ${nt?"rotate-180":""}`,children:""})]}),nt&&i.jsx("div",{className:"border-t p-2 space-y-2",children:Ie.rows.map(lt=>{const ht=w===lt.id,kt=Fe===lt.id,le=!!String(lt.barcode||"").trim();return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Ze(We=>We===lt.id?null:lt.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:lt.name}),i.jsx("div",{className:"text-xs text-gray-600 truncate",children:lt.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("div",{className:"font-bold tabular-nums",children:J5(lt.providerPrice)})]})]}),kt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Categora"}),ht?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:We=>_(We.target.value)}):i.jsx("div",{className:"font-semibold",children:lt.category})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Und x paquete"}),ht?i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:P,onChange:We=>O(v0(We.target.value,1))}):i.jsx("div",{className:"font-semibold text-right tabular-nums",children:lt.unitsPerPackage})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Empaque"}),ht?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ce,onChange:We=>ue(We.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"font-semibold",children:lt.packaging||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),ht?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:We=>k(Math.max(0,Rh(We.target.value,0)))}):i.jsx("div",{className:"font-semibold tabular-nums",children:J5(lt.providerPrice)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Cdigo"}),ht?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-1",value:z,onChange:We=>oe(We.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("edit"),V(!0)},children:"Escanear"})]}):le?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{X(String(lt.barcode||"").trim()),U(!0)},children:"Ver cdigo"}):i.jsx("div",{className:"text-gray-600",children:"No"})]})]}),i.jsx("div",{className:"pt-2 flex gap-2",children:ht?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-blue-600 text-white",onClick:_e,type:"button",children:"Guardar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("edit"),V(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-200",onClick:te,type:"button",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400",onClick:()=>fe(lt),type:"button",children:"Editar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:()=>R(lt),type:"button",children:"Borrar"})]})})]})})]},lt.id)})})]},Ie.category)})}),!r&&st.length>0&&Ht()]}):i.jsxs("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1050px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):st.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin productos."})}):xe.map(Ie=>{const nt=w===Ie.id,lt=!!String(Ie.barcode||"").trim();return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:nt?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:ht=>_(ht.target.value)}):Ie.category}),i.jsx("td",{className:"p-2 border",children:nt?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:S,onChange:ht=>E(ht.target.value)}):Ie.name}),i.jsx("td",{className:"p-2 border",children:nt?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ce,onChange:ht=>ue(ht.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):Ie.packaging||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:nt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:ht=>k(Math.max(0,Rh(ht.target.value,0)))}):J5(Ie.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:nt?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:P,onChange:ht=>O(v0(ht.target.value,1))}):Ie.unitsPerPackage}),i.jsx("td",{className:"p-2 border text-center",children:nt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:z,onChange:ht=>oe(ht.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-800 text-white hover:bg-black",onClick:()=>{be("edit"),V(!0)},children:"Escanear"})]}):lt?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{X(String(Ie.barcode||"").trim()),U(!0)},children:"S"}):i.jsx("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-600",children:"No"})}),i.jsx("td",{className:"p-2 border",children:nt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:_e,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:te,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>fe(Ie),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>R(Ie),type:"button",children:"Borrar"})]})})]},Ie.id)})})]}),!r&&st.length>0&&Ht()]}),a?Bt&&a===" Producto guardado."?i.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[i.jsx("div",{className:"flex-1 text-sm",children:a}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white",onClick:()=>{s(""),te(),V(!1)},children:"Aceptar"})]}):i.jsx("p",{className:"mt-2 text-sm",children:a}):null,i.jsx(gQe,{open:K,code:W,onClose:()=>U(!1)}),i.jsx(xQe,{open:D,onClose:()=>V(!1),onDetected:async Ie=>{const nt=String(Ie||"").trim();if(nt){if(Z==="edit"&&w){if(o.some(ht=>ht.id!==w&&String(ht.barcode||"")===nt)){s(" Ya existe otro producto con ese cdigo de barras."),oe(nt),V(!1);return}try{await Fn(er(Pe,"products_candies",w),{barcode:nt}),l(ht=>ht.map(kt=>kt.id===w?{...kt,barcode:nt}:kt)),oe(nt),Bt&&s(" Producto guardado.")}catch(ht){console.error(ht),s(" Error guardando cdigo de barras.")}finally{V(!1)}return}if(Z==="search"){Ue(nt),V(!1);return}Z==="create"?v(Ie):oe(Ie)}}}),L&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Xe(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete, Empaque (opcional), Codigo (opcional)."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Q,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:Ie=>{var nt;return se(((nt=Ie.target.files)==null?void 0:nt[0])||null)}}),re&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:re})]}),dt&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),He.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:He.slice(0,50).map((Ie,nt)=>i.jsx("li",{children:Ie},nt))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",ze.total," filas (Crear:"," ",ze.willCreate," / Actualizar:"," ",ze.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:Me,disabled:dt||De.length===0||He.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1250px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Codigo (opcional)"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:De.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):De.slice(0,300).map((Ie,nt)=>{const lt=Ie.id?o.some(We=>We.id===Ie.id):!1,ht=o.some(We=>`${os(We.category)}::${os(We.name)}`==`${os(Ie.category)}::${os(Ie.name)}`),kt=Ie.barcode?o.some(We=>String(We.barcode||"")===Ie.barcode):!1,le=lt||ht||kt;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Ie.id||"",onChange:We=>Ne(nt,{id:We.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Ie.category,onChange:We=>Ne(nt,{category:We.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:Ie.name,onChange:We=>Ne(nt,{name:We.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(Ie.providerPrice)?"":Ie.providerPrice,onChange:We=>Ne(nt,{providerPrice:Math.max(0,Rh(We.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:Ie.unitsPerPackage,onChange:We=>Ne(nt,{unitsPerPackage:v0(We.target.value,1)})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Ie.packaging||"",onChange:We=>Ne(nt,{packaging:We.target.value.trim()||void 0}),placeholder:"Tarro, Bolsa..."})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Ie.barcode||"",onChange:We=>Ne(nt,{barcode:We.target.value.trim()||void 0}),placeholder:"EAN/UPC (opcional)"})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${le?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:le?"ACTUALIZA":"CREA"})})]},`${Ie.id||""}-${nt}`)})})]}),i.jsx("datalist",{id:"categories-list",children:Ce.map(Ie=>i.jsx("option",{value:Ie},Ie))})]}),De.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",De.length," filas (el import importa todas)."]})]})]})})]})}function Dse(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),a=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):a>0?Math.floor(a*e):0}function Z5(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Dse(t)}const Rse=t=>Math.max(0,Math.floor(Number(t??0)));function yQe(t){return Rse(t.packages??t.totalPackages??t.packs??t.packagesInitial??t.initialPackages??0)}function bQe(t){return Rse(t.remainingPackages??t.remainingPacks??t.packsRemaining??t.packagesRemaining??t.remaining_packages??0)}async function gF(t){const e=String(t||"").trim();if(!e)return{created:0,skipped:0,updated:0,totalItems:0};let r=er(Pe,"candy_main_orders",e),n=await zs(r);if(!n.exists()){const p=sr(bt(Pe,"candy_main_orders"),Ar("orderId","==",e)),x=await $t(p);if(x.empty)throw new Error("Orden maestra no existe");r=x.docs[0].ref,n=x.docs[0]}const a=n.data(),s=r.id,o=Array.isArray(a.items)?a.items:[];if(!o.length)return{created:0,skipped:0,updated:0,totalItems:0};const l=await $t(sr(bt(Pe,"inventory_candies"),Ar("orderId","==",s))),c=new Set,u=new Map;l.forEach(p=>{const x=p.data(),v=String(x.productId||"").trim();if(v&&c.add(v),!v)return;const y=u.get(v)||[];y.push({ref:p.ref,data:x}),u.set(v,y)});const d=tu(Pe);let f=0,A=0,h=0;const m=String(a.date||"");for(const p of o){const x=String(p.id||p.productId||"").trim();if(!x)continue;const v=u.get(x)||[];if(v.length>0){if(v.length===1&&v.every(k=>{const P=Math.max(0,Math.floor(Number(k.data.remainingPackages||0))),O=Math.max(0,Math.floor(Number(k.data.remaining||0))),z=Math.max(0,Math.floor(Number(k.data.totalUnits||0)));return P<=0&&O<=0&&z<=0})){const k=v[0].ref,P=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),O=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),z=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let oe=Math.max(0,Math.floor(O||0)),ce=Math.max(0,Math.floor(z||0));oe<=0&&ce>0&&(oe=ce),ce<=0&&(ce=oe);const ue=oe*P,ge=ce*P;d.update(k,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:ue,remaining:ge,packages:oe,remainingPackages:ce,unitsPerPackage:P,totalUnits:ue,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,status:"PENDIENTE",orderId:s,updatedAt:xr.now()}),h+=1;continue}A+=1;continue}const y=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),b=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),w=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let j=Math.max(0,Math.floor(b||0)),I=Math.max(0,Math.floor(w||0));j<=0&&I>0&&(j=I),I<=0&&(I=j);const _=j*y,S=I*y,E=er(bt(Pe,"inventory_candies"));d.set(E,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:_,remaining:S,packages:j,remainingPackages:I,unitsPerPackage:y,totalUnits:_,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,createdAt:xr.now(),status:"PENDIENTE",orderId:s}),f+=1}return(f>0||h>0)&&await d.commit(),{created:f,skipped:A,updated:h,totalItems:o.length}}async function wQe(t){const e=er(Pe,"candy_main_orders",t);if((await zs(e)).exists())return e;const n=sr(bt(Pe,"candy_main_orders"),Ar("orderId","==",t)),a=await $t(n);return a.empty?null:er(Pe,"candy_main_orders",a.docs[0].id)}async function eB(t){if(!t)return;const e=await wQe(t);if(!e)return;const r=sr(bt(Pe,"inventory_candies"),Ar("orderId","==",t)),n=await $t(r),a=new Map;n.forEach(l=>{const c=l.data(),u=String(c.productId||"");if(!u)return;const d=yQe(c),f=bQe(c),A=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),v=h*d,y=m*d,b=p*d,w=x*d,j=y-v,I=b-v,_=w-v;a.has(u)||a.set(u,{productId:u,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:A,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const S=a.get(u);S.packages+=d,S.remainingPackages+=f,S.subtotal+=v,S.totalRivas+=y,S.totalSanJorge+=b,S.totalIsla+=w,S.gainRivas+=j,S.gainSanJorge+=I,S.gainIsla+=_,S.providerPrice=h,S.unitPriceRivas=m||S.unitPriceRivas,S.unitPriceSanJorge=p||S.unitPriceSanJorge,S.unitPriceIsla=x||S.unitPriceIsla,S.unitsPerPackage=A||S.unitsPerPackage,S.name=String(c.productName||S.name),S.category=String(c.category||S.category)});const s=Array.from(a.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=s.reduce((l,c)=>l+Number(c.packages||0),0);await Fn(e,{totalPackages:o,items:s})}function NQe(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const a=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const s of a){const o=String(s.inventorySellerId||""),l=Math.max(0,Math.floor(Number(s.units??s.qty??s.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const a=e[n],s=Array.isArray(a==null?void 0:a.allocations)?a.allocations:[];for(const o of s){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function K2(t){const e=t.split("#")[0],r=er(Pe,"sales_candies",e),n=await zs(r);if(!n.exists())throw new Error("La venta no existe.");const a=n.data(),s=NQe(a);if(s&&s.allocations.length>0){let u=0;return await Ks(Pe,async d=>{const f={};for(const p of s.allocations){const x=p.inventorySellerId,v=Math.max(0,Math.floor(Number(p.units||0)));!x||v<=0||(f[x]=(f[x]||0)+v,u+=v)}const h=Object.keys(f).map(p=>er(Pe,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>d.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=Number(v.remainingUnits??v.remaining??0),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);d.update(h[p],{remainingUnits:w,remainingPackages:I})}d.delete(r)}),{restored:u}}const o=[];if(Array.isArray(a.items)&&a.items.length>0){const u={};if(a.allocationsByItem&&typeof a.allocationsByItem=="object")for(const d of Object.keys(a.allocationsByItem)){const f=a.allocationsByItem[d],A=String((f==null?void 0:f.productId)||d||"");if(!A)continue;const h=Array.isArray(f==null?void 0:f.allocations)?f.allocations:[];u[A]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(a.allocationsByItem))for(const d of a.allocationsByItem){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];u[f]=A.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const d of a.items){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Math.max(0,Math.floor(Number((d==null?void 0:d.qty)||(d==null?void 0:d.quantity)||0))),h=Array.isArray(d==null?void 0:d.allocations)?d.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):u[f]||[];o.push({productId:f,productName:String((d==null?void 0:d.productName)||""),qty:A,allocations:h.length?h:void 0})}}else{const u=a.item||{},d=String(u.productId||a.productId||""),f=Math.max(0,Math.floor(Number(u.qty??a.quantity??0))),A=Array.isArray(a.allocations)?a.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];d&&f>0&&o.push({productId:d,productName:String(u.productName||a.productName||""),qty:f,allocations:A.length?A:void 0})}if(o.length===0)return await Ks(Pe,async u=>{u.delete(r)}),{restored:0};if(o.every(u=>Array.isArray(u.allocations)&&u.allocations.length>0)){let u=0;return await Ks(Pe,async d=>{const f=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));u+=p,f.push({ref:er(Pe,"inventory_candies",m.batchId),addBack:p})}const A=await Promise.all(f.map(h=>d.get(h.ref)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=Z5(p),v=Math.max(0,Math.floor(Number(f[h].addBack||0))),y=x+v,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),w=Math.floor(y/b);d.update(f[h].ref,{remaining:y,remainingPackages:w,packages:w})}d.delete(r)}),{restored:u}}let c=0;return await Ks(Pe,async u=>{const d={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=sr(bt(Pe,"inventory_candies"),Ar("productId","==",p.productId)),y=(await $t(x)).docs.map(b=>{const w=b.data(),j=Dse(w),I=Z5(w);return{id:b.id,date:String(w.date||""),baseUnits:j,remaining:I}}).sort((b,w)=>b.date.localeCompare(w.date));d[p.productId]=y}const f=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,f.push({id:y.batchId,addBack:b})}continue}const x=d[p.productId]||[];let v=p.qty;for(const y of x){if(v<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const w=Math.min(b,v);f.push({id:y.id,addBack:w}),c+=w,v-=w}for(const y of x){if(v<=0)break;const b=Math.min(v,p.qty);f.push({id:y.id,addBack:b}),c+=b,v-=b}}const A={};for(const p of f)A[p.id]=(A[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(A).map(p=>er(Pe,"inventory_candies",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=Z5(v),b=Math.max(0,Math.floor(Number(A[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);u.update(h[p],{remaining:w,remainingPackages:I,packages:I})}u.delete(r)}),{restored:c}}async function CQe(t){return K2(t)}const gc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function tB(t){return isFinite(t)?Math.round(t):0}function Zd(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function rB(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function _Qe(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const a=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-a}function EQe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,j]=g.useState(0),[I,_]=g.useState(!1),[S,E]=g.useState(""),[B,k]=g.useState(""),[P,O]=g.useState([]);g.useEffect(()=>{(async()=>{try{s(!0);const W=await $t(bt(Pe,"products_candies")),X=[];W.forEach(be=>{const L=be.data();X.push({id:be.id,name:L.name??"(sin nombre)",category:L.category??"(sin categora)"})}),e(X);const D=sr(bt(Pe,"inventory_candies"),In("date","desc")),V=await $t(D),Z=[];V.forEach(be=>{const L=be.data(),Xe=Number(L.unitsPerPackage||0),re=Number(L.totalUnits??L.quantity??(L.packages||0)*(L.unitsPerPackage||0)),J=Number(L.remaining??L.totalUnits??re??0);Z.push({id:be.id,productId:L.productId,productName:L.productName,category:L.category,measurement:L.measurement??"unidad",packages:Number(L.packages||0),unitsPerPackage:Xe,totalUnits:re,remaining:J,remainingPackages:typeof L.remainingPackages=="number"?Number(L.remainingPackages):void 0,providerPrice:Number(L.providerPrice||0),subtotal:Number(L.subtotal||0),totalRivas:Number(L.totalRivas||0),totalSanJorge:Number(L.totalSanJorge||0),totalIsla:Number(L.totalIsla||0),gainRivas:Number(L.gainRivas||0),gainSanJorge:Number(L.gainSanJorge||0),gainIsla:Number(L.gainIsla||0),unitPriceRivas:Number(L.unitPriceRivas||0),unitPriceSanJorge:Number(L.unitPriceSanJorge||0),unitPriceIsla:Number(L.unitPriceIsla||0),date:L.date,createdAt:L.createdAt,status:L.status??"PENDIENTE",orderId:L.orderId??null})}),n(Z)}catch(W){console.error(W),l(" Error cargando inventario.")}finally{s(!1)}})()},[]);const z=g.useMemo(()=>r.filter(W=>!(c&&W.date<c||d&&W.date>d||A&&W.productId!==A||m&&String(W.category||"")!==m)),[r,c,d,A,m]),oe=g.useMemo(()=>{const W=new Set;for(const X of t)X.category&&W.add(X.category);return Array.from(W).sort((X,D)=>X.localeCompare(D))},[t]),ce=g.useMemo(()=>{const W=z.reduce((L,Xe)=>L+Zd(Xe),0),X=z.reduce((L,Xe)=>L+rB(Xe),0),D=z.reduce((L,Xe)=>{const re=Zd(Xe);return L+Number(Xe.providerPrice||0)*re},0),V=z.reduce((L,Xe)=>{const re=Zd(Xe);return L+Number(Xe.unitPriceRivas||0)*re},0),Z=z.reduce((L,Xe)=>{const re=Zd(Xe);return L+Number(Xe.unitPriceSanJorge||0)*re},0),be=z.reduce((L,Xe)=>{const re=Zd(Xe);return L+Number(Xe.unitPriceIsla||0)*re},0);return{totalPaquetes:W,totalPaquetesRestantes:X,totalSubtotal:D,totalRivas:V,totalSJ:Z,totalIsla:be}},[z]),ue=g.useMemo(()=>{let W=0,X=0;for(const D of z)D.status==="PENDIENTE"&&(W+=1),D.status==="PAGADO"&&(X+=1);return{totalLotes:z.length,pendientes:W,pagados:X}},[z]),ge=g.useMemo(()=>{const W=new Map;for(const D of z){const V=String(D.productId||"");V&&(W.has(V)||W.set(V,{batches:[]}),W.get(V).batches.push(D))}const X=[];for(const[D,V]of W.entries()){const Z=[...V.batches].sort(_Qe),be=Z[0],L=Z.reduce((jt,Qt)=>jt+Zd(Qt),0),Xe=Z.reduce((jt,Qt)=>jt+rB(Qt),0),re=Number((be==null?void 0:be.providerPrice)||0),J=Number((be==null?void 0:be.unitPriceRivas)||0),De=Number((be==null?void 0:be.unitPriceIsla)||0),ie=Z.reduce((jt,Qt)=>{const Ft=Zd(Qt);return jt+Number(Qt.providerPrice||0)*Ft},0),He=Z.reduce((jt,Qt)=>{const Ft=Zd(Qt);return jt+Number(Qt.unitPriceRivas||0)*Ft},0),Ge=Z.reduce((jt,Qt)=>{const Ft=Zd(Qt);return jt+Number(Qt.unitPriceIsla||0)*Ft},0),dt=He-ie,_t=Ge-ie;let Bt="",Ot;for(const jt of Z)(!Bt||String(jt.date||"")>Bt)&&(Bt=String(jt.date||""),Ot=jt.createdAt);X.push({productId:D,productName:(be==null?void 0:be.productName)||"",category:(be==null?void 0:be.category)||"",totalPackages:L,remainingPackages:Xe,providerPrice:re,unitPriceRivas:J,unitPriceIsla:De,subtotal:ie,totalRivas:He,totalIsla:Ge,gainRivas:dt,gainIsla:_t,lastDate:Bt,lastCreatedAt:Ot,batchCount:Z.length})}return X.sort((D,V)=>String(V.lastDate).localeCompare(String(D.lastDate))),X},[z]),ne=W=>{v(W.id),b(W.date),j(W.providerPrice),l("")},Oe=()=>{v(null),b(""),j(0)},Ue=async()=>{if(!x)return;const W=r.find(Ge=>Ge.id===x);if(!W)return;if(w<0){l("El precio proveedor no puede ser negativo.");return}const X=Zd(W),D=w*X,V=X>0?D/.8:0,Z=X>0?D/.85:0,be=X>0?D/.7:0,L=V-D,Xe=Z-D,re=be-D,J=X>0?tB(V/X):0,De=X>0?tB(Z/X):0,ie=X>0?tB(be/X):0,He=er(Pe,"inventory_candies",x);await Fn(He,{date:y,providerPrice:w,subtotal:D,totalRivas:V,totalSanJorge:Z,totalIsla:be,gainRivas:L,gainSanJorge:Xe,gainIsla:re,unitPriceRivas:J,unitPriceSanJorge:De,unitPriceIsla:ie}),n(Ge=>Ge.map(dt=>dt.id===x?{...dt,date:y,providerPrice:w,subtotal:D,totalRivas:V,totalSanJorge:Z,totalIsla:be,gainRivas:L,gainSanJorge:Xe,gainIsla:re,unitPriceRivas:J,unitPriceSanJorge:De,unitPriceIsla:ie}:dt)),W.orderId&&await eB(String(W.orderId)),l(" Lote de dulces actualizado"),Oe()},F=async W=>{confirm(`Marcar PAGADO el lote del ${W.date} (${W.productName})?`)&&(await Fn(er(Pe,"inventory_candies",W.id),{status:"PAGADO"}),n(D=>D.map(V=>V.id===W.id?{...V,status:"PAGADO"}:V)),l(" Lote marcado como pagado"))},H=async W=>{confirm(`Eliminar el lote del ${W.date} (${W.productName})?`)&&(await qn(er(Pe,"inventory_candies",W.id)),n(D=>D.filter(V=>V.id!==W.id)),W.orderId&&await eB(String(W.orderId)),l(" Lote eliminado"))},K=async(W,X)=>{try{s(!0),l("");const D=sr(bt(Pe,"inventory_candies"),Ar("productId","==",W),In("date","desc")),V=await $t(D),Z=[];V.forEach(be=>{const L=be.data(),Xe=Number(L.unitsPerPackage||0),re=Number(L.totalUnits??L.quantity??(L.packages||0)*(L.unitsPerPackage||0)),J=Number(L.remaining??L.totalUnits??re??0);Z.push({id:be.id,productId:L.productId,productName:L.productName,category:L.category,measurement:L.measurement??"unidad",packages:Number(L.packages||0),unitsPerPackage:Xe,totalUnits:re,remaining:J,remainingPackages:typeof L.remainingPackages=="number"?Number(L.remainingPackages):void 0,providerPrice:Number(L.providerPrice||0),subtotal:Number(L.subtotal||0),totalRivas:Number(L.totalRivas||0),totalSanJorge:Number(L.totalSanJorge||0),totalIsla:Number(L.totalIsla||0),gainRivas:Number(L.gainRivas||0),gainSanJorge:Number(L.gainSanJorge||0),gainIsla:Number(L.gainIsla||0),unitPriceRivas:Number(L.unitPriceRivas||0),unitPriceSanJorge:Number(L.unitPriceSanJorge||0),unitPriceIsla:Number(L.unitPriceIsla||0),date:L.date,createdAt:L.createdAt,status:L.status??"PENDIENTE",orderId:L.orderId??null})}),E(W),k(X),O(Z),_(!0)}catch(D){console.error(D),l(" Error abriendo detalle del producto.")}finally{s(!1)}},U=async(W,X)=>{const D=r.filter(Z=>Z.productId===W);if(confirm(`Eliminar COMPLETAMENTE "${X}"?
Esto eliminar ${D.length} lote(s) de este producto.`))try{s(!0),l("");const Z=Array.from(new Set(D.map(be=>be.orderId?String(be.orderId):"").filter(Boolean)));for(const be of D)await qn(er(Pe,"inventory_candies",be.id));n(be=>be.filter(L=>L.productId!==W)),l(" Producto eliminado (todos sus lotes).");for(const be of Z)await eB(be);I&&S===W&&(_(!1),O([]),E(""),k(""))}catch(Z){console.error(Z),l(" Error eliminando lotes del producto.")}finally{s(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:W=>u(W.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:W=>f(W.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:W=>p(W.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),oe.map(W=>i.jsx("option",{value:W,children:W},W))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:W=>h(W.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(W=>i.jsxs("option",{value:W.id,children:[W.name,"  ",W.category]},W.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",ue.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",ue.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",ue.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ce.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ce.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",gc(ce.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",gc(ce.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",gc(ce.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",gc(ce.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):ge.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):ge.map(W=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:W.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:W.productName,children:W.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",W.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:W.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:W.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.gainIsla)}),i.jsx("td",{className:"p-2 border",children:W.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>K(W.productId,W.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>U(W.productId,W.productName),children:"Borrar"})]})})]},W.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",B||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",S]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{_(!1),O([]),E(""),k(""),Oe()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:P.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):P.map(W=>{const X=x===W.id,D=Zd(W),V=rB(W);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:X?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:Z=>b(Z.target.value)}):W.date}),i.jsx("td",{className:"p-2 border align-top",children:W.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:W.productName,children:W.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",W.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:D}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:V}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:W.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:X?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(w)?"":w,onChange:Z=>j(Math.max(0,parseFloat(Z.target.value||"0")))}):gc(W.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:gc(W.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:gc(W.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:W.orderId?String(W.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${W.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:W.status})}),i.jsx("td",{className:"p-2 border align-top",children:X?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ue,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Oe,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[W.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>F(W),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>ne(W),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>H(W),children:"Borrar"})]})})]},W.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>U(S,B),children:"Borrar producto (todos los lotes)"})})]})})]})}const nB=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Vo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function wy(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function sK(t){const e=sr(bt(Pe,"ar_movements"),Ar("ref.saleId","==",t)),r=await $t(e);await Promise.all(r.docs.map(n=>qn(er(Pe,"ar_movements",n.id))))}function SQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=Sn(a,"vendedor_dulces"),l=Sn(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(!1),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),P=async ye=>{var ft;j(!0),_(!0),E(ye),k([]);try{const St=await zs(er(Pe,"sales_candies",ye));let wt=null;St.exists()?wt=St.data():wt=(ft=(await $t(sr(bt(Pe,"sales_candies"),Ar("name","==",ye)))).docs[0])==null?void 0:ft.data();let vt=[];if(Array.isArray(wt==null?void 0:wt.items))vt=wt.items;else if(wt!=null&&wt.items&&typeof wt.items=="object")try{vt=Object.values(wt.items)}catch{vt=[]}else wt!=null&&wt.item&&(vt=[wt.item]);const Et=vt.map(qt=>({productName:String(qt.productName||""),qty:Number(qt.packages??qt.qty??qt.quantity??0),unitPrice:Number(qt.unitPricePackage??qt.unitPrice??qt.price??0),discount:Number(qt.discount||0),total:Number(qt.total??qt.lineFinal??qt.amount??0)}));k(Et)}catch(St){console.error(St)}finally{_(!1)}},[O,z]=g.useState(""),[oe,ce]=g.useState("+505 "),[ue,ge]=g.useState(""),[ne,Oe]=g.useState(""),[Ue,F]=g.useState("ACTIVO"),[H,K]=g.useState(0),[U,W]=g.useState(""),[X,D]=g.useState(0),[V,Z]=g.useState([]),[be,L]=g.useState(!0),[Xe,re]=g.useState(""),J=10,[De,ie]=g.useState(1),[He,Ge]=g.useState(null),[dt,_t]=g.useState(""),[Bt,Ot]=g.useState("+505 "),[jt,Qt]=g.useState(""),[Ft,$e]=g.useState(""),[Fe,Ze]=g.useState("ACTIVO"),[Te,ee]=g.useState(0),[me,Re]=g.useState(""),[he,qe]=g.useState(!1),[st,yt]=g.useState(null),[pe,je]=g.useState(!1),[we,Ye]=g.useState([]),[xe,Se]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[xt,Pt]=g.useState(!1),[It,Ut]=g.useState(0),[Ht,Le]=g.useState(new Date().toISOString().slice(0,10)),[Ce,Ae]=g.useState(""),[Qe,fe]=g.useState(!1),[te,_e]=g.useState(null),[R,Q]=g.useState(""),[G,se]=g.useState(0),[Ne,Me]=g.useState(""),[ze,Ie]=g.useState(!1),[nt,lt]=g.useState(null),[ht,kt]=g.useState(!1),[le,We]=g.useState(!1),[it,ot]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(L(!0),o&&!s){Z([]),re(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const ye=await $t(bt(Pe,"sellers_candies")),ft=[];ye.forEach(Et=>{const qt=Et.data(),Mt=String(qt.status||"ACTIVO");Mt==="ACTIVO"&&ft.push({id:Et.id,name:String(qt.name||""),status:Mt})}),u(ft);const St=o?sr(bt(Pe,"customers_candies"),Ar("vendorId","==",s),In("createdAt","desc")):sr(bt(Pe,"customers_candies"),In("createdAt","desc")),wt=await $t(St),vt=[];wt.forEach(Et=>{const qt=Et.data();vt.push({id:Et.id,name:qt.name??"",phone:qt.phone??"+505 ",place:qt.place??"",notes:qt.notes??"",status:qt.status??"ACTIVO",creditLimit:Number(qt.creditLimit??0),createdAt:qt.createdAt??xr.now(),balance:0,sellerId:qt.sellerId||"",vendorId:qt.vendorId||"",vendorName:qt.vendorName||"",initialDebt:Number(qt.initialDebt||0),initialDebtDate:String(qt.initialDebtDate||"").trim(),lastAbonoDate:"",lastAbonoAmount:0})});for(const Et of vt)try{const qt=sr(bt(Pe,"ar_movements"),Ar("customerId","==",Et.id)),Mt=await $t(qt);let Xt=0,ar=null;const vr=[];Mt.forEach(Yr=>{var jr,Bn,wn;const Vr=Yr.data(),Sr=Number(Vr.amount||0);Xt+=Sr;const pr=Vr.date??((Bn=(jr=Vr.createdAt)==null?void 0:jr.toDate)!=null&&Bn.call(jr)?Vr.createdAt.toDate().toISOString().slice(0,10):"");if(vr.push({id:Yr.id,date:pr,type:Vr.type??(Sr<0?"ABONO":"CARGO"),amount:Sr,ref:Vr.ref||{},comment:Vr.comment||"",createdAt:Vr.createdAt}),Sr<0){const xn=(wn=Vr.createdAt)!=null&&wn.seconds?Number(Vr.createdAt.seconds):0;(!ar||xn>=ar.ts)&&(ar={date:pr,amount:Math.abs(Sr),ts:xn})}});const ur=Number(Et.initialDebt||0),Dt=kr(ur,String(Et.initialDebtDate||""),vr);Et.balance=Dt+Xt,ar?(Et.lastAbonoDate=ar==null?void 0:ar.date,Et.lastAbonoAmount=ar==null?void 0:ar.amount):(Et.lastAbonoDate="",Et.lastAbonoAmount=0)}catch{Et.balance=Number(Et.initialDebt||0),Et.lastAbonoDate="",Et.lastAbonoAmount=0}Z(vt)}catch(ye){console.error(ye),re(" Error cargando clientes.")}finally{L(!1)}})()},[o,s]);const Nt=()=>{z(""),ce("+505 "),ge(""),Oe(""),F("ACTIVO"),K(0),W(""),D(0)},Rt=async ye=>{var vt;if(ye.preventDefault(),re(""),!O.trim()){re("Ingresa el nombre.");return}const ft=wy(oe);if(ft.length<6){re("Telfono incompleto.");return}const St=o?s:String(U||"").trim(),wt=St&&((vt=c.find(Et=>Et.id===St))==null?void 0:vt.name)||"";try{const Et=Number(X||0),qt=await Zn(bt(Pe,"customers_candies"),{name:O.trim(),phone:ft,place:ue||"",notes:ne||"",status:Ue,creditLimit:Number(H||0),vendorId:St,vendorName:wt,initialDebt:Et,createdAt:xr.now()});Z(Mt=>[{id:qt.id,name:O.trim(),phone:ft,place:ue||"",notes:ne||"",status:Ue,creditLimit:Number(H||0),vendorId:St,vendorName:wt,initialDebt:Et,createdAt:xr.now(),balance:Et,lastAbonoDate:"",lastAbonoAmount:0},...Mt]),Nt(),Ie(!1),re(" Cliente creado")}catch(Et){console.error(Et),re(" Error al crear cliente")}},nr=ye=>{if(o){re(" No permitido: vendedores no editan clientes desde el listado.");return}Ge(ye.id),_t(ye.name),Ot(ye.phone||"+505 "),Qt(ye.place||""),$e(ye.notes||""),Ze(ye.status||"ACTIVO"),ee(Number(ye.creditLimit||0)),Re(String(ye.vendorId||""))},_r=()=>{Ge(null),_t(""),Ot("+505 "),Qt(""),$e(""),Ze("ACTIVO"),ee(0),Re("")},$r=async()=>{var qt;if(o){re(" No permitido.");return}if(!He)return;const ye=wy(Bt);if(!dt.trim()){re("Ingresa el nombre.");return}const ft=V.find(Mt=>Mt.id===He),St=String((ft==null?void 0:ft.vendorId)||""),wt=o?s:String(me||"");if(o&&St&&St!==s){re(" Este cliente pertenece a otro vendedor.");return}if(l&&St&&wt&&St!==wt){re(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const vt=o?s:String(me||""),Et=vt&&((qt=c.find(Mt=>Mt.id===vt))==null?void 0:qt.name)||"";try{await Fn(er(Pe,"customers_candies",He),{name:dt.trim(),phone:ye,place:jt||"",notes:Ft||"",status:Fe,creditLimit:Number(Te||0),vendorId:vt,vendorName:Et}),Z(Mt=>Mt.map(Xt=>Xt.id===He?{...Xt,name:dt.trim(),phone:ye,place:jt||"",notes:Ft||"",status:Fe,creditLimit:Number(Te||0),vendorId:vt,vendorName:Et}:Xt)),_r(),re(" Cliente actualizado")}catch(Mt){console.error(Mt),re(" Error al actualizar")}},or=async ye=>{if(confirm(`Eliminar al cliente "${ye.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{L(!0);const St=sr(bt(Pe,"sales_candies"),Ar("customerId","==",ye.id)),wt=await $t(St);for(const qt of wt.docs){const Mt=qt.id;try{await K2(Mt)}catch(Xt){console.warn("restoreSaleAndDeleteCandy error",Xt);try{await qn(er(Pe,"sales_candies",Mt))}catch{}}await sK(Mt)}const vt=sr(bt(Pe,"ar_movements"),Ar("customerId","==",ye.id)),Et=await $t(vt);await Promise.all(Et.docs.map(qt=>qn(er(Pe,"ar_movements",qt.id)))),await qn(er(Pe,"customers_candies",ye.id)),Z(qt=>qt.filter(Mt=>Mt.id!==ye.id)),re(" Cliente eliminado y dulces devueltos al inventario")}catch(St){console.error(St),re(" No se pudo eliminar el cliente.")}finally{L(!1)}},kr=(ye,ft,St)=>{const wt=Number(ye||0);if(!wt)return 0;const vt=String(ft||"").trim();return vt&&St.some(qt=>{var ur;const Mt=Number(qt.amount||0);if(!(Mt>0))return!1;const Xt=Math.abs(Mt-wt)<.01,ar=String(qt.date||"").trim()===vt,vr=!!((ur=qt.ref)!=null&&ur.saleId);return Xt&&ar&&vr})?0:wt},en=(ye,ft,St)=>{const wt=ye.reduce((Xt,ar)=>Xt+(Number(ar.amount)||0),0),vt=ye.filter(Xt=>Number(Xt.amount)<0).reduce((Xt,ar)=>Xt+Math.abs(Number(ar.amount)||0),0),Et=ye.filter(Xt=>Number(Xt.amount)>0).reduce((Xt,ar)=>Xt+(Number(ar.amount)||0),0),qt=kr(ft,St,ye),Mt=Number(qt||0)+wt;Se({saldoActual:Mt,totalAbonado:vt,totalCargos:Number(qt||0)+Et,saldoRestante:Mt})},rn=async ye=>{yt(ye),Ye([]),Se({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),qe(!0),kt(!1),We(!1),ot(null),Pt(!1),Ut(0),Le(new Date().toISOString().slice(0,10)),Ae(""),_e(null),je(!0);try{const ft=sr(bt(Pe,"ar_movements"),Ar("customerId","==",ye.id)),St=await $t(ft),wt=[];St.forEach(vt=>{var Xt,ar;const Et=vt.data(),qt=Et.date??((ar=(Xt=Et.createdAt)==null?void 0:Xt.toDate)!=null&&ar.call(Xt)?Et.createdAt.toDate().toISOString().slice(0,10):""),Mt=Number(Et.amount||0);wt.push({id:vt.id,date:qt,type:Et.type??(Mt<0?"ABONO":"CARGO"),amount:Mt,ref:Et.ref||{},comment:Et.comment||"",createdAt:Et.createdAt})}),wt.sort((vt,Et)=>{var Xt,ar;if(vt.date!==Et.date)return vt.date.localeCompare(Et.date);const qt=((Xt=vt.createdAt)==null?void 0:Xt.seconds)||0,Mt=((ar=Et.createdAt)==null?void 0:ar.seconds)||0;return qt-Mt}),Ye(wt),en(wt,Number(ye.initialDebt||0),String(ye.initialDebtDate||""))}catch(ft){console.error(ft),re(" No se pudo cargar el estado de cuenta")}finally{je(!1)}},Er=ye=>{const ft=ye.filter(St=>Number(St.amount)<0).map(St=>{var wt;return{date:St.date,amount:Math.abs(Number(St.amount||0)),ts:((wt=St.createdAt)==null?void 0:wt.seconds)||0}}).sort((St,wt)=>(St.ts||0)-(wt.ts||0));return ft.length?ft[ft.length-1]:null},Ee=g.useMemo(()=>kr(Number((st==null?void 0:st.initialDebt)||0),String((st==null?void 0:st.initialDebtDate)||""),we),[st==null?void 0:st.initialDebt,st==null?void 0:st.initialDebtDate,we]),gt=async()=>{if(!st)return;re("");const ye=Number(It||0);if(!(ye>0)){re("Ingresa un monto de abono mayor a 0.");return}const ft=parseFloat(ye.toFixed(2));if(!Ht){re("Selecciona la fecha del abono.");return}try{fe(!0);const St={customerId:st.id,type:"ABONO",amount:-ft,date:Ht,comment:Ce||"",createdAt:xr.now()},vt={id:(await Zn(bt(Pe,"ar_movements"),St)).id,date:Ht,type:"ABONO",amount:-ft,comment:Ce||"",createdAt:xr.now()},Et=[...we,vt].sort((ar,vr)=>{var Yr,Vr;if(ar.date!==vr.date)return ar.date.localeCompare(vr.date);const ur=((Yr=ar.createdAt)==null?void 0:Yr.seconds)||0,Dt=((Vr=vr.createdAt)==null?void 0:Vr.seconds)||0;return ur-Dt});Ye(Et),en(Et,Number(st.initialDebt||0),String(st.initialDebtDate||""));const qt=Et.reduce((ar,vr)=>ar+(Number(vr.amount)||0),0),Mt=kr(Number(st.initialDebt||0),String(st.initialDebtDate||""),Et),Xt=Number(Mt||0)+qt;Z(ar=>ar.map(vr=>vr.id!==st.id?vr:{...vr,balance:Xt,lastAbonoDate:Ht,lastAbonoAmount:ft})),yt(ar=>ar&&{...ar,balance:Xt,lastAbonoDate:Ht,lastAbonoAmount:ft}),Ut(0),Ae(""),Le(new Date().toISOString().slice(0,10)),Pt(!1),re(" Abono registrado")}catch(St){console.error(St),re(" Error al registrar el abono")}finally{fe(!1)}},Zt=ye=>{_e(ye.id),Q(ye.date||new Date().toISOString().slice(0,10)),se(Math.abs(Number(ye.amount||0))),Me(ye.comment||"")},Mr=()=>{_e(null),Q(""),se(0),Me("")},Or=async()=>{if(!te||!st)return;const ye=we.findIndex(vt=>vt.id===te);if(ye===-1)return;const ft=we[ye],St=Number(G||0);if(!(St>0)){re("El monto debe ser mayor a 0.");return}const wt=ft.type==="ABONO"?-parseFloat(St.toFixed(2)):+parseFloat(St.toFixed(2));try{await Fn(er(Pe,"ar_movements",te),{date:R,amount:wt,comment:Ne||""});const vt=[...we];vt[ye]={...ft,date:R,amount:wt,comment:Ne||""},vt.sort((ar,vr)=>{var Yr,Vr;if(ar.date!==vr.date)return ar.date.localeCompare(vr.date);const ur=((Yr=ar.createdAt)==null?void 0:Yr.seconds)||0,Dt=((Vr=vr.createdAt)==null?void 0:Vr.seconds)||0;return ur-Dt}),Ye(vt),en(vt,Number(st.initialDebt||0),String(st.initialDebtDate||""));const Et=vt.reduce((ar,vr)=>ar+(Number(vr.amount)||0),0),qt=kr(Number(st.initialDebt||0),String(st.initialDebtDate||""),vt),Mt=Number(qt||0)+Et,Xt=Er(vt);Z(ar=>ar.map(vr=>vr.id===st.id?{...vr,balance:Mt,lastAbonoDate:(Xt==null?void 0:Xt.date)||"",lastAbonoAmount:(Xt==null?void 0:Xt.amount)||0}:vr)),yt(ar=>ar&&{...ar,balance:Mt,lastAbonoDate:(Xt==null?void 0:Xt.date)||"",lastAbonoAmount:(Xt==null?void 0:Xt.amount)||0}),Mr(),re(" Movimiento actualizado")}catch(vt){console.error(vt),re(" Error al actualizar movimiento")}},ir=async ye=>{var St,wt;if(confirm(`Eliminar este movimiento (${ye.type==="ABONO"?"Abono":"Compra"}) del ${ye.date}?${ye.type==="CARGO"&&((St=ye.ref)!=null&&St.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`)&&st)try{if(L(!0),ye.type==="CARGO"&&((wt=ye.ref)!=null&&wt.saleId)){try{await K2(ye.ref.saleId)}catch(ar){console.warn("restoreSaleAndDeleteCandy error",ar),L(!1),re(" No se pudo devolver inventario de la venta.");return}await sK(ye.ref.saleId)}else await qn(er(Pe,"ar_movements",ye.id));const vt=we.filter(ar=>{var vr,ur;return ye.type==="CARGO"&&((vr=ye.ref)!=null&&vr.saleId)?((ur=ar.ref)==null?void 0:ur.saleId)!==ye.ref.saleId:ar.id!==ye.id});Ye(vt),en(vt,Number(st.initialDebt||0),String(st.initialDebtDate||""));const Et=vt.reduce((ar,vr)=>ar+(Number(vr.amount)||0),0),qt=kr(Number(st.initialDebt||0),String(st.initialDebtDate||""),vt),Mt=Number(qt||0)+Et,Xt=Er(vt);Z(ar=>ar.map(vr=>vr.id===st.id?{...vr,balance:Mt,lastAbonoDate:(Xt==null?void 0:Xt.date)||"",lastAbonoAmount:(Xt==null?void 0:Xt.amount)||0}:vr)),yt(ar=>ar&&{...ar,balance:Mt,lastAbonoDate:(Xt==null?void 0:Xt.date)||"",lastAbonoAmount:(Xt==null?void 0:Xt.amount)||0}),ot(null),re(" Movimiento eliminado")}catch(vt){console.error(vt),re(" Error al eliminar movimiento")}finally{L(!1)}},br=g.useMemo(()=>[...V].sort((ye,ft)=>{var St,wt;return ye.status!==ft.status?ye.status==="BLOQUEADO"?1:-1:(((St=ft.createdAt)==null?void 0:St.seconds)||0)-(((wt=ye.createdAt)==null?void 0:wt.seconds)||0)}),[V]),wr=ye=>ye==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",Xr=g.useMemo(()=>{const ye=A.trim().toLowerCase(),ft=x.trim()===""?null:Number(x),St=y.trim()===""?null:Number(y);return br.filter(wt=>{const vt=!ye||String(wt.name||"").toLowerCase().includes(ye),Et=!m||wt.status===m,qt=Number(wt.balance||0),Mt=ft===null||!Number.isNaN(ft)&&qt>=ft,Xt=St===null||!Number.isNaN(St)&&qt<=St;return vt&&Et&&Mt&&Xt})},[br,A,m,x,y]),Ir=Math.max(1,Math.ceil(Xr.length/J)),Pr=g.useMemo(()=>{const ye=(De-1)*J;return Xr.slice(ye,ye+J)},[Xr,De]);g.useEffect(()=>{ie(1)},[A,m,x,y]);const fn=()=>ie(1),de=()=>ie(ye=>Math.max(1,ye-1)),tt=()=>ie(ye=>Math.min(Ir,ye+1)),at=()=>ie(Ir),ct=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:fn,disabled:De===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:de,disabled:De===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",De," de ",Ir]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:tt,disabled:De===Ir,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:at,disabled:De===Ir,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[Xr.length," cliente(s)"]})]});return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Ie(!0),o&&W(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border w-full md:w-auto",onClick:()=>f(ye=>!ye),children:d?"Ocultar filtros":"Mostrar filtros"}),d&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl p-3 grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:ye=>h(ye.target.value),placeholder:"Buscar por nombre"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ye=>p(ye.target.value||""),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mn."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:x,onChange:ye=>v(ye.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mx."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:y,onChange:ye=>b(ye.target.value),placeholder:""})]})]}),i.jsx("div",{className:"md:col-span-4 flex flex-wrap gap-2 justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border",onClick:()=>{h(""),p(""),v(""),b("")},children:"Limpiar"})})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:be?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Pr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Pr.map(ye=>{var St;const ft=He===ye.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(St=ye.createdAt)!=null&&St.toDate?ye.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:ft?i.jsx("input",{className:"w-full border p-1 rounded",value:dt,onChange:wt=>_t(wt.target.value)}):i.jsx("div",{className:"font-medium",children:ye.name})}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{className:"w-full border p-1 rounded",value:Bt,onChange:wt=>Ot(wy(wt.target.value))}):ye.phone}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:me,onChange:wt=>Re(wt.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(wt=>i.jsx("option",{value:wt.id,children:wt.name},wt.id))]}):ye.vendorName||""}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("select",{className:"w-full border p-1 rounded",value:jt,onChange:wt=>Qt(wt.target.value),children:[i.jsx("option",{value:"",children:""}),nB.map(wt=>i.jsx("option",{value:wt,children:wt},wt))]}):ye.place||""}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("select",{className:"w-full border p-1 rounded",value:Fe,onChange:wt=>Ze(wt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${wr(ye.status)}`,children:ye.status})}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Te)?"":Te,onChange:wt=>ee(Math.max(0,Number(wt.target.value||0)))}):Vo(ye.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Vo(ye.balance||0)}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ft,onChange:wt=>$e(wt.target.value),maxLength:500}):i.jsx("span",{title:ye.notes||"",children:(ye.notes||"").length>40?(ye.notes||"").slice(0,40)+"":ye.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:ft?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:$r,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:_r,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nr(ye),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>or(ye),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>rn(ye),children:"Estado de cuenta"})]})})})]},ye.id)})})]}),ct()]}),i.jsxs("div",{className:"md:hidden",children:[be?i.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):Pr.length===0?i.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):i.jsx("div",{className:"space-y-2",children:Pr.map(ye=>{const ft=nt===ye.id,St=He===ye.id,wt=i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${wr(ye.status)}`,children:ye.status});return i.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{re(""),!St&&lt(vt=>vt===ye.id?null:ye.id)},children:[i.jsx("div",{className:"min-w-0 flex-1",children:i.jsx("div",{className:"truncate font-semibold",children:ye.name})}),i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Pendiente"}),i.jsx("div",{className:"font-semibold leading-4",children:Vo(ye.balance||0)})]}),wt]})]}),ft&&i.jsxs("div",{className:"px-3 pb-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"ltimo abono"}),i.jsx("div",{className:"font-medium",children:ye.lastAbonoDate?ye.lastAbonoDate:""}),i.jsx("div",{className:"text-[12px] text-gray-700",children:ye.lastAbonoAmount?Vo(ye.lastAbonoAmount):""})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo pendiente"}),i.jsx("div",{className:"text-lg font-bold",children:Vo(ye.balance||0)})]})]}),St?i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:dt,onChange:vt=>_t(vt.target.value)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:Bt,onChange:vt=>Ot(wy(vt.target.value))})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:Fe,onChange:vt=>Ze(vt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:jt,onChange:vt=>Qt(vt.target.value),children:[i.jsx("option",{value:"",children:""}),nB.map(vt=>i.jsx("option",{value:vt,children:vt},vt))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:o?s:me,onChange:vt=>Re(vt.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(vt=>i.jsx("option",{value:vt.id,children:vt.name},vt.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lmite"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(Te)?"":Te,onChange:vt=>ee(Math.max(0,Number(vt.target.value||0)))})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded-xl min-h-24 resize-y",value:Ft,onChange:vt=>$e(vt.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:$r,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:()=>{_r(),lt(null)},type:"button",children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nr(ye),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>or(ye),disabled:!l,title:l?"Borrar":"Solo admin",type:"button",children:"Borrar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>rn(ye),type:"button",children:"Estado"})]})]})]},ye.id)})}),ct()]})]}),Xe&&i.jsx("p",{className:"mt-2 text-sm",children:Xe}),ze&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ie(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ie(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Rt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:O,onChange:ye=>z(ye.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:oe,onChange:ye=>ce(wy(ye.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ue,onChange:ye=>ge(ye.target.value),children:[i.jsx("option",{value:"",children:""}),nB.map(ye=>i.jsx("option",{value:ye,children:ye},ye))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ue,onChange:ye=>F(ye.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:U,onChange:ye=>W(ye.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(ye=>i.jsx("option",{value:ye.id,children:ye.name},ye.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:X===0?"":X,onChange:ye=>D(Math.max(0,Number(ye.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:ye=>K(Math.max(0,Number(ye.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ne,onChange:ye=>Oe(ye.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ne.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ie(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),he&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4 max-h-[92vh] overflow-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(st==null?void 0:st.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Ut(0),Le(new Date().toISOString().slice(0,10)),Ae(""),Pt(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>qe(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(Number(Ee||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(xe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(xe.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:pe?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):we.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):we.map(ye=>{var St,wt;const ft=te===ye.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:R,onChange:vt=>Q(vt.target.value)}):ye.date||""}),i.jsx("td",{className:"p-2 border",children:ye.amount>=0?(St=ye.ref)!=null&&St.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>P(ye.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(wt=ye.ref)!=null&&wt.saleId?`Venta #${ye.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{className:"w-full border p-1 rounded",value:Ne,onChange:vt=>Me(vt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:ye.comment||"",children:(ye.comment||"").length>40?(ye.comment||"").slice(0,40)+"":ye.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:ft?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(G)?"":G,onChange:vt=>{const Et=Number(vt.target.value||0),qt=Number.isFinite(Et)?Math.max(0,parseFloat(Et.toFixed(2))):0;se(qt)},placeholder:"0.00"}):Vo(ye.amount)}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Or,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Mr,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Zt(ye),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ir(ye),children:"Borrar"})]})})]},ye.id)})})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>kt(ye=>!ye),children:[i.jsx("div",{className:"font-semibold",children:"Estado de cuenta"}),i.jsx("div",{className:"text-sm text-gray-500",children:ht?"Ocultar":"Ver"})]}),ht&&i.jsxs("div",{className:"px-3 pb-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Deuda inicial"}),i.jsx("div",{className:"font-bold",children:Vo(Number(Ee||0))})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo actual"}),i.jsx("div",{className:"font-bold",children:Vo(xe.saldoActual)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Total abonado"}),i.jsx("div",{className:"font-bold",children:Vo(xe.totalAbonado)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo restante"}),i.jsx("div",{className:"font-bold",children:Vo(xe.saldoRestante)})]})]})]}),i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>We(ye=>!ye),children:[i.jsx("div",{className:"font-semibold",children:"Movimientos"}),i.jsx("div",{className:"text-sm text-gray-500",children:le?"Ocultar":"Ver"})]}),le&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:pe?i.jsx("div",{className:"text-center text-sm p-3",children:"Cargando"}):we.length===0?i.jsx("div",{className:"text-center text-sm p-3",children:"Sin movimientos"}):we.map(ye=>{var Et,qt;const ft=it===ye.id,St=te===ye.id,wt=ye.amount>=0?"CARGO":"ABONO",vt=ye.amount>=0?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700";return i.jsxs("div",{className:"border rounded-2xl overflow-hidden bg-white",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{St||ot(Mt=>Mt===ye.id?null:ye.id)},children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Fecha"}),i.jsx("div",{className:"font-semibold",children:ye.date||""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${vt}`,children:wt}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Monto"}),i.jsx("div",{className:"font-semibold",children:Vo(ye.amount)})]})]})]}),ft&&i.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Referencia"}),i.jsx("div",{className:"font-medium",children:(Et=ye.ref)!=null&&Et.saleId?`Venta #${ye.ref.saleId}`:""}),((qt=ye.ref)==null?void 0:qt.saleId)&&i.jsx("button",{type:"button",className:"mt-2 text-xs underline text-blue-600",onClick:()=>P(ye.ref.saleId),children:"Ver productos de la venta"})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),St?i.jsx("input",{className:"w-full border p-2 rounded-xl",value:Ne,onChange:Mt=>Me(Mt.target.value),placeholder:"Comentario"}):i.jsx("div",{className:"font-medium",children:(ye.comment||"").trim()||""})]}),St&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded-xl",value:R,onChange:Mt=>Q(Mt.target.value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(G)?"":G,onChange:Mt=>{const Xt=Number(Mt.target.value||0),ar=Number.isFinite(Xt)?Math.max(0,parseFloat(Xt.toFixed(2))):0;se(ar)}})]})]}),St?i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:Or,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:Mr,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Zt(ye),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700",onClick:()=>ir(ye),type:"button",children:"Borrar"})]})]})]},ye.id)})})]})]}),xt&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(st==null?void 0:st.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ht,onChange:ye=>Le(ye.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:It===0?"":It,onChange:ye=>{const ft=Number(ye.target.value||0),St=Number.isFinite(ft)?Math.max(0,parseFloat(ft.toFixed(2))):0;Ut(St)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ce,onChange:ye=>Ae(ye.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Ce.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pt(!1),disabled:Qe,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:gt,disabled:Qe,children:Qe?"Guardando...":"Guardar abono"})]})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",S?` #${S}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((ye,ft)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ye.productName}),i.jsx("td",{className:"p-2 border text-right",children:ye.qty}),i.jsx("td",{className:"p-2 border text-right",children:Vo(ye.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Vo(ye.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Vo(ye.total)})]},ft))})]})})]})})]})}const Gc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,IQe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas","Pull","Tilgue","Balge","Santa Cruz","Moyogalpa","Santo Domingo","San Jos del Sur","San Fernando","Merida","La Paloma","San Lorenzo","San Carlos","San Miguel"];function jQe(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function PQe(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function BQe(t){const{saleId:e,date:r,customerName:n,branch:a,items:s,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:u}=t,d=new an;let f=12;if(d.setFontSize(16),d.text("Multiservicios Ortiz",10,f),f+=6,d.setFontSize(12),d.text("Recibo de venta certificada",10,f),f+=8,d.setFontSize(12),d.text(`Fecha: ${r}`,10,f),f+=5,d.text(`Cliente: ${n||"Cliente Mostrador"}`,10,f),f+=5,d.text(`Sucursal: ${jQe(a)}`,10,f),f+=5,d.text(`Autorizado: ${e}`,10,f),f+=5,l&&(d.text(`Vendedor: ${l}`,10,f),f+=5),typeof c=="number"){const A=Number(u||0).toFixed(2),h=c.toFixed(2);d.text(`Comisin vendedor: ${h}%  C$ ${A}`,10,f),f+=8}else f+=3;d.setFontSize(12),d.text("Producto",10,f),d.text("Paquetes",110,f,{align:"right"}),d.text("Precio.",150,f,{align:"right"}),d.text("Subtotal",190,f,{align:"right"}),f+=4,d.line(10,f,190,f),f+=4,s.forEach(A=>{f>270&&(d.addPage(),f=12);const h=(A.productName||"").length>50?A.productName.slice(0,47)+"...":A.productName;d.text(h,10,f),d.text(String(A.qty),110,f,{align:"right"}),d.text(`C$ ${Number(A.unitPrice||0).toFixed(2)}`,150,f,{align:"right"}),d.text(`C$ ${Number(A.total||0).toFixed(2)}`,190,f,{align:"right"}),f+=5}),f+=4,d.line(10,f,190,f),f+=6,d.setFontSize(13),d.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,f,{align:"right"}),f+=6,d.setFontSize(9),d.text("Gracias por su compra.",10,f),d.save(`venta_dulces_${e}.pdf`)}async function iK(t,e){if(!t||!e)return 0;const r=sr(bt(Pe,"inventory_candies_sellers"),Ar("sellerId","==",e),Ar("productId","==",t)),n=await $t(r);let a=0;return n.forEach(s=>{const o=s.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(a+=l)}),a}const oK=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function TQe(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:a,saleId:s}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=sr(bt(Pe,"inventory_candies_sellers"),Ar("sellerId","==",r),Ar("productId","==",e),Ar("remainingUnits",">",0),In("date","asc"),In("createdAt","asc")),u=await $t(c);for(const d of u.docs){if(o<=0)break;const f=d.data(),A=Number(f.remainingUnits||0);if(A<=0)continue;const h=Math.min(A,o),m=A-h,p=Math.max(1,Math.floor(Number(f.unitsPerPackage||1))),x=Math.floor(m/p);await Fn(d.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:d.id,productId:e,units:h,saleDate:a,saleId:s}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function lK(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function kQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t;Sn(a,"admin"),Sn(a,"vendedor_dulces");const[s,o]=g.useState([]),[l,c]=g.useState([]),[u,d]=g.useState([]),[f,A]=g.useState({}),[h,m]=g.useState("CONTADO"),[p,x]=g.useState("RIVAS"),[v,y]=g.useState(""),[b,w]=g.useState(""),[j,I]=g.useState(oK()),[_,S]=g.useState(""),[E,B]=g.useState(!1),[k,P]=g.useState(""),[O,z]=g.useState([]),[oe,ce]=g.useState(!0),[ue,ge]=g.useState(!1),ne=g.useMemo(()=>O.reduce((Ae,Qe)=>Ae+(Qe.qtyPackages||0),0),[O]),Oe=g.useMemo(()=>O.reduce((Ae,Qe)=>Ae+(Qe.qtyPackages||0)*(Qe.unitsPerPackage||1),0),[O]),Ue=g.useMemo(()=>{const Ae=O.reduce((Qe,fe)=>{const te=(Number(fe.pricePerPackage)||0)*(fe.qtyPackages||0),_e=Number(fe.discount)||0,R=Math.max(0,te-_e);return Qe+R},0);return Math.floor(Ae*100)/100},[O]),[F,H]=g.useState(0),[K,U]=g.useState(""),[W,X]=g.useState(!1),[D,V]=g.useState(!1),[Z,be]=g.useState(""),[L,Xe]=g.useState("+505 "),[re,J]=g.useState(""),[De,ie]=g.useState(""),[He,Ge]=g.useState("ACTIVO"),[dt,_t]=g.useState(0),[Bt,Ot]=g.useState(""),jt=()=>{be(""),Xe("+505 "),J(""),ie(""),Ge("ACTIVO"),_t(0)},[Qt,Ft]=g.useState(!1),$e=async Ae=>{const Qe=String(Ae||"").trim();if(!Qe)return;const fe=Ut.find(Q=>String(Q.barcode||"")===Qe),te=Ut.find(Q=>String(Q.sku||"")===Qe),_e=Ut.find(Q=>String(Q.id||"")===Qe),R=fe||te||_e||null;R?(await Ye(R.id),U(" Producto agregado desde escner."),setTimeout(()=>U(""),2500)):(U(" Cdigo no corresponde a ningn producto disponible."),setTimeout(()=>U(""),2500))};function Fe({open:Ae,onClose:Qe,onDetected:fe}){const te=g.useRef(null),_e=g.useRef(null),[R,Q]=g.useState(""),G=g.useRef("");return g.useEffect(()=>{if(!Ae)return;let se=!1;const Ne=new $2,Me=()=>{var Ie,nt,lt;try{(Ie=_e.current)==null||Ie.stop()}catch{}_e.current=null;try{const ht=(nt=te.current)==null?void 0:nt.srcObject;try{(lt=ht==null?void 0:ht.getTracks)==null||lt.call(ht).forEach(kt=>kt.stop())}catch{}}catch{}try{te.current&&(te.current.srcObject=null)}catch{}};return(async()=>{Q("");try{if(!te.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(lt=>lt.stop())}catch{}const Ie=await Ne.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},te.current,nt=>{if(!se&&nt){const lt=String(nt.getText()||"").trim().replace(/\s+/g,"");if(!lt||lt===G.current)return;G.current=lt,Me(),fe(lt),Qe()}});_e.current=Ie}catch(Ie){const nt=String((Ie==null?void 0:Ie.message)||""),lt=String((Ie==null?void 0:Ie.name)||"");nt.toLowerCase().includes("permission")||lt==="NotAllowedError"?Q("Permiso de cmara denegado."):lt==="NotFoundError"||nt.toLowerCase().includes("notfound")?Q("No se encontr cmara en este dispositivo."):nt.toLowerCase().includes("secure")||nt.toLowerCase().includes("https")?Q("La cmara requiere HTTPS (sitio seguro)."):Q(nt||"No se pudo iniciar el escner.")}})(),()=>{var Ie;se=!0;try{(Ie=_e.current)==null||Ie.stop()}catch{}_e.current=null}},[Ae,Qe,fe]),Ae?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Qe,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:te,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),R&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:R}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}const Ze=g.useMemo(()=>s.find(Ae=>Ae.id===v),[s,v]),Te=g.useMemo(()=>E&&_?s.filter(Ae=>(Ae.vendorId??Ae.sellerId??"")===_):s,[s,E,_]),ee=(Ze==null?void 0:Ze.balance)||0,me=h==="CREDITO"?ee+Math.max(0,Number(Ue||0))-Math.max(0,Number(F||0)):0,Re=g.useMemo(()=>{if(h!=="CREDITO")return 0;const Ae=Math.max(0,Number(ee||0))+Math.max(0,Number(Ue||0));return Math.floor(Ae*100)/100},[h,ee,Ue]),he=Ae=>{const Qe=Math.max(0,Number(Ae||0));return Math.min(Qe,Re)},qe=g.useMemo(()=>u.find(Ae=>Ae.id===_)||null,[u,_]),st=(qe==null?void 0:qe.commissionPercent)||0,yt=g.useMemo(()=>{const Ae=O.reduce((Qe,fe)=>Qe+Number(fe.margenVendedor||0),0);return Number(Ae.toFixed(2))},[O]);g.useEffect(()=>{(async()=>{const Ae=sr(bt(Pe,"customers_candies"),In("createdAt","desc")),Qe=await $t(Ae),fe=[];Qe.forEach(Q=>{const G=Q.data();fe.push({id:Q.id,name:G.name??"",phone:G.phone??"+505 ",place:G.place??"",status:G.status??"ACTIVO",creditLimit:Number(G.creditLimit??0),balance:0,sellerId:G.sellerId??G.vendorId??"",vendorId:G.vendorId??G.sellerId??""})});for(const Q of fe)try{const G=sr(bt(Pe,"ar_movements"),Ar("customerId","==",Q.id)),se=await $t(G);let Ne=0;se.forEach(ze=>Ne+=Number(ze.data().amount||0));const Me=Number(Q.initialDebt||0);Q.balance=Ne+Me}catch{Q.balance=0}o(fe);const te=sr(bt(Pe,"products_candies"),In("createdAt","desc")),_e=await $t(te),R=[];_e.forEach(Q=>{const G=Q.data();R.push({id:Q.id,name:G.name??"(sin nombre)",sku:G.sku??"",unitsPerPackage:Number(G.unitsPerPackage??1),barcode:String(G.barcode||""),priceRivas:Number(G.unitPriceRivas??0),priceSanJorge:Number(G.unitPriceSanJorge??0),priceIsla:Number(G.unitPriceIsla??0),providerPrice:Number(G.providerPrice??0),providerPricePerUnit:Number(G.providerPricePerUnit??0)})}),c(R);try{const Q=await $t(bt(Pe,"sellers_candies")),G=[];Q.forEach(se=>{const Ne=se.data(),Me=Ne.branch||"Rivas",ze=PQe(Me);G.push({id:se.id,name:Ne.name??"(sin nombre)",branch:ze,branchLabel:Me,commissionPercent:Number(Ne.commissionPercent??0)})}),d(G)}catch(Q){console.error("Error cargando vendedores:",Q)}A({})})()},[]),g.useEffect(()=>{var Qe,fe;const Ae=e&&e.length?e:t;if(Ae&&((Qe=Ae.includes)!=null&&Qe.call(Ae,"vendedor_dulces"))&&r){S(r),B(!0);try{localStorage.setItem("pos_vendorId",r),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(Ae&&((fe=Ae.includes)!=null&&fe.call(Ae,"admin"))){B(!1);return}try{const te=localStorage.getItem("pos_vendorId")||"",_e=localStorage.getItem("pos_role")||"";te&&S(te),_e.toUpperCase()==="VENDEDOR"&&B(!0)}catch{}},[t,r]);const pe=async Ae=>{if(!Ae){A({});return}const Qe=sr(bt(Pe,"inventory_candies_sellers"),Ar("sellerId","==",Ae)),fe=await $t(Qe),te={};fe.forEach(_e=>{const R=_e.data(),Q=R.productId||"";if(!Q)return;const G=Number(R.remainingUnits??R.remaining??R.totalUnits??0);G<=0||(te[Q]=(te[Q]||0)+G)}),A(te),z(_e=>{const R=[];for(const Q of _e){const G=te[Q.productId]??0;G>0&&R.push({...Q,availableUnits:G})}return R})};g.useEffect(()=>{if(!_){A({});return}const Ae=u.find(Qe=>Qe.id===_);Ae&&x(Ae.branch),pe(_)},[_,u]),g.useEffect(()=>{z(Ae=>Ae.map(Qe=>{const fe=l.find(_e=>_e.id===Qe.productId);if(!fe)return Qe;const te=p==="RIVAS"?fe.priceRivas:p==="SAN_JORGE"?fe.priceSanJorge:fe.priceIsla;return{...Qe,pricePerPackage:Number(te)||0}}))},[p,l]);async function je(Ae){const{productId:Qe,vendorId:fe,branch:te}=Ae;if(!Qe||!fe)return 0;const _e=sr(bt(Pe,"inventory_candies_sellers"),Ar("sellerId","==",fe),Ar("productId","==",Qe)),R=await $t(_e);if(R.empty)return 0;const Q=R.docs[0].data(),G=Number(Q.unitPriceVendor??0);if(G>0)return G;const se=Number(te==="RIVAS"?Q.unitPriceRivas??0:te==="SAN_JORGE"?Q.unitPriceSanJorge??0:Q.unitPriceIsla??0);return Number(se||0)}const we=Ae=>{const Qe=Number(st||0),fe=Number(Ae||0)*Qe/100;return Math.max(0,Number(fe.toFixed(2)))},Ye=async Ae=>{var Me;if(!Ae)return;if(!_){U("Selecciona primero el vendedor para usar su inventario."),P("");return}if(O.some(ze=>ze.productId===Ae)){P("");return}const Qe=l.find(ze=>ze.id===Ae);if(!Qe){P("");return}const fe=await iK(Ae,_),te=((Me=u.find(ze=>ze.id===_))==null?void 0:Me.branch)??p,_e=await je({productId:Ae,vendorId:_,branch:te}),Q=await(async ze=>{const{productId:Ie,vendorId:nt}=ze;if(!Ie||!nt)return 0;try{const lt=sr(bt(Pe,"inventory_candies_sellers"),Ar("sellerId","==",nt),Ar("productId","==",Ie)),ht=await $t(lt);if(ht.empty)return 0;const kt=ht.docs[0].data();return Number(kt.providerPrice??0)}catch{return 0}})({productId:Ae,vendorId:_}),G=(()=>{const ze=Number(Qe.providerPrice||0);if(ze>0)return ze;const Ie=Number(Qe.providerPricePerUnit||0);return Ie>0?Ie*Number(Qe.unitsPerPackage||1):0})(),se=Number(Q||0)>0?Number(Q||0):Number(G||0),Ne={productId:Ae,productName:Qe.name||"",sku:Qe.sku||"",unitsPerPackage:Qe.unitsPerPackage||1,pricePerPackage:Number(_e)||0,availableUnits:Number(fe)||0,qtyPackages:0,discount:0,providerPricePerPackage:Number(se)||0,margenVendedor:0,uBruta:0};z(ze=>[...ze,Ne]),P("")},xe=(Ae,Qe)=>{z(fe=>fe.map(te=>{if(te.productId!==Ae)return te;if(Qe==="")return{...te,qtyPackages:0};const _e=Math.max(0,Math.floor(Number(Qe))),R=f[Ae]??te.availableUnits??0,Q=Math.max(1,Number(te.unitsPerPackage||1)),G=Math.floor(R/Q);let se=_e;_e>G&&(se=G,U(` Solo hay ${G} paquetes disponibles.`),setTimeout(()=>U(""),2500));const Ne=Number(te.pricePerPackage||0)*se,Me=Number(te.providerPricePerPackage||0)*se,ze=Ne-Me,Ie=we(ze);return{...te,qtyPackages:se,margenVendedor:Ie,uBruta:ze}}))},Se=(Ae,Qe)=>{z(fe=>fe.map(te=>{if(te.productId!==Ae)return te;if(Qe==="")return{...te,discount:0};const _e=Math.max(0,Math.floor(Number(Qe))),R=te.qtyPackages||0,Q=Number(te.pricePerPackage||0)*R,G=Number(te.providerPricePerPackage||0)*R,se=Q-G,Ne=we(se);return{...te,discount:_e,margenVendedor:Ne,uBruta:se}}))},xt=Ae=>z(Qe=>Qe.filter(fe=>fe.productId!==Ae)),Pt=async()=>{if(!j)return"Selecciona la fecha.";if(!_)return"Selecciona el vendedor para esta venta.";if(O.length===0)return"Agrega al menos un producto.";const Ae=O.filter(Qe=>(Qe.qtyPackages||0)>0);if(Ae.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(Ue>0))return"El total debe ser mayor a cero.";if(h==="CONTADO"){if(!b.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!v)return"Selecciona un cliente (crdito).";if(F<0)return"El pago inicial no puede ser negativo.";if(F>Re)return"El pago inicial no puede superar el saldo a deber (saldo actual + venta).";if((Ze==null?void 0:Ze.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Qe of Ae){const fe=Qe.unitsPerPackage||1,te=(Qe.qtyPackages||0)*fe,_e=await iK(Qe.productId,_),R=Math.floor(_e/fe);if(te>_e)return`Inventario insuficiente en el pedido del vendedor para "${Qe.productName}". Disponible: ${R} paquetes.`;const Q=(Number(Qe.pricePerPackage)||0)*(Qe.qtyPackages||0),G=Number(Qe.discount)||0;if(!Number.isInteger(G)||G<0)return`El descuento en "${Qe.productName}" debe ser entero y  0.`;if(G>Q)return`El descuento en "${Qe.productName}" no puede exceder C$ ${Q.toFixed(2)}.`}return null},It=async Ae=>{Ae.preventDefault(),U("");const Qe=await Pt();if(Qe){U(" "+Qe);return}try{X(!0);const fe=O.filter(G=>(G.qtyPackages||0)>0).map(G=>{const se=G.unitsPerPackage||1,Ne=G.qtyPackages||0,Me=Ne*se,ze=(Number(G.pricePerPackage)||0)*(Ne||0),Ie=Math.max(0,Math.floor(Number(G.discount)||0)),nt=Math.max(0,ze-Ie),lt=Number(G.providerPricePerPackage||0),ht=lt*Ne,kt=ze-ht,le=we(kt);return{productId:G.productId,productName:G.productName,sku:G.sku||"",qty:Me,packages:Ne,unitsPerPackage:se,branch:p,unitPricePackage:Number(G.pricePerPackage)||0,discount:Ie,total:Math.floor(nt*100)/100,providerPricePerPackage:lt,margenVendedor:le,uBruta:kt}}),te={type:h,branch:p,date:j,createdAt:xr.now(),itemsTotal:Number(Ue)||0,total:Number(Ue)||0,quantity:Number(Oe)||0,packagesTotal:Number(ne)||0,items:fe,vendorId:_},_e=u.find(G=>G.id===_);_e&&(te.vendorName=_e.name,te.vendorBranch=_e.branch,te.vendorBranchLabel=_e.branchLabel,te.vendorCommissionPercent=_e.commissionPercent||0,te.vendorCommissionAmount=yt||0),h==="CONTADO"?te.customerName=b.trim():(te.customerId=v,te.downPayment=Number(F)||0);const R=await Zn(bt(Pe,"sales_candies"),te);if(h==="CONTADO"){const G=(b||"").trim();if(G)try{await Zn(bt(Pe,"cash_customers"),{name:G,date:j,branch:p,vendorId:_,createdAt:xr.now()})}catch(se){console.warn("No se pudo guardar cash_customer:",se)}}if(h==="CREDITO"&&v){const G={customerId:v,date:j,createdAt:xr.now(),ref:{saleId:R.id}};await Zn(bt(Pe,"ar_movements"),{...G,type:"CARGO",amount:Number(Ue)||0}),Number(F)>0&&await Zn(bt(Pe,"ar_movements"),{...G,type:"ABONO",amount:-Number(F)})}const Q={};for(const G of fe)if(G.qty>0){const{allocations:se}=await TQe({productId:G.productId,vendorId:_,quantityUnits:G.qty,saleDate:j,saleId:R.id});Q[G.productId]={productId:G.productId,vendorId:_,allocations:se}}await Fn(er(Pe,"sales_candies",R.id),{allocationsByItem:Q});try{const G=h==="CONTADO"?b.trim()||"Cliente Mostrador":(Ze==null?void 0:Ze.name)||"Cliente crdito";BQe({saleId:R.id,date:j,customerName:G,branch:p,items:fe.map(se=>({productName:se.productName,qty:se.packages,unitPrice:se.unitPricePackage,total:se.total})),total:Number(Ue)||0,vendorName:_e==null?void 0:_e.name,vendorCommissionPercent:(_e==null?void 0:_e.commissionPercent)||0,vendorCommissionAmount:yt})}catch(G){console.error("Error generando voucher PDF:",G)}m("CONTADO"),y(""),w(""),I(oK()),z([]),H(0),h==="CREDITO"&&v&&o(G=>G.map(se=>se.id===v?{...se,balance:(se.balance||0)+(Number(Ue)||0)-(Number(F)||0)}:se)),U(" Venta de dulces registrada"),_?await pe(_):A({})}catch(fe){console.error(fe),U(" Error al guardar la venta de dulces")}finally{X(!1)}},Ut=g.useMemo(()=>l.filter(Ae=>{const Qe=f[Ae.id]||0,fe=Math.max(1,Number(Ae.unitsPerPackage||1));return Math.floor(Qe/fe)>0}).sort((Ae,Qe)=>(Ae.name||"").localeCompare(Qe.name||"")),[l,f]),[Ht,Le]=g.useState(""),Ce=g.useMemo(()=>{const Ae=String(Ht||"").trim().toLowerCase();return Ae?Ut.filter(Qe=>`${Qe.name||""} ${Qe.sku||""}`.toLowerCase().includes(Ae)||String(Qe.id||"").includes(Ae)):Ut},[Ht,Ut]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),i.jsxs("form",{onSubmit:It,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6",children:[i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Ae=>m(Ae.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:b,onChange:Ae=>w(Ae.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:v,onChange:Ae=>y(Ae.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),Te.map(Ae=>i.jsxs("option",{value:Ae.status==="ACTIVO"?Ae.id:"",disabled:Ae.status==="BLOQUEADO",children:[Ae.name," | ",Ae.phone," | Saldo: ",Gc(Ae.balance||0)]},Ae.id))]}),i.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>V(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Gc(ee)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:Re,className:"w-full border p-2 rounded",value:F===0?"":F,onChange:Ae=>{const Qe=he(Ae.target.value);H(Qe)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Gc(me)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:Ae=>I(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_,onChange:Ae=>{S(Ae.target.value),z([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(Ae=>i.jsxs("option",{value:Ae.id,children:[Ae.name,"  ",Ae.branchLabel,"  ",Ae.commissionPercent.toFixed(2),"%"," comisin"]},Ae.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:p==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:p==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:p==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:_?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Ht,onChange:Ae=>Le(Ae.target.value),disabled:!_}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Ft(!0),disabled:!_,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async Ae=>{const Qe=Ae.target.value;P(Qe),await Ye(Qe)},disabled:!_,children:[i.jsx("option",{value:"",children:_?"Selecciona un producto":"Selecciona un vendedor primero"}),Ce.map(Ae=>{const Qe=O.some(R=>R.productId===Ae.id),fe=f[Ae.id]||0,te=Math.max(1,Number(Ae.unitsPerPackage||1)),_e=Math.floor(fe/te);return _e<=0?null:i.jsxs("option",{value:Qe?"":Ae.id,disabled:Qe,children:[Ae.name," ",Ae.sku?` ${Ae.sku}`:""," (disp: ",_e," ","paq.)",Qe?" ":""]},Ae.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),O.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):O.map(Ae=>{const Qe=f[Ae.productId]??Ae.availableUnits??0,fe=Ae.unitsPerPackage?Math.floor(Qe/Ae.unitsPerPackage):0,te=Math.max(0,fe-(Ae.qtyPackages||0)),_e=(Number(Ae.pricePerPackage)||0)*(Ae.qtyPackages||0),R=Math.max(0,_e-(Number(Ae.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[Ae.productName,Ae.sku?`  ${Ae.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Gc(Ae.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[te," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ae.qtyPackages)||Ae.qtyPackages===0?"":Ae.qtyPackages,onChange:Q=>xe(Ae.productId,Q.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ae.discount)||Ae.discount===0?"":Ae.discount,onChange:Q=>Se(Ae.productId,Q.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1 text-right",children:Gc(R)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>xt(Ae.productId),title:"Quitar producto",children:""})})]},Ae.productId)})]})}),O.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:ne})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Gc(Ue)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Gc(yt)," ",st?`(${st.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:W,children:W?"Guardando...":"Registrar venta"})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>ce(Ae=>!Ae),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Datos de venta",i.jsx("span",{className:"text-lg",children:oe?"":"+"})]}),oe&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:Ae=>I(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Ae=>m(Ae.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (Cash)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mario Bergoglio",value:b,onChange:Ae=>w(Ae.target.value)})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:Ae=>y(Ae.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),Te.map(Ae=>i.jsxs("option",{value:Ae.status==="ACTIVO"?Ae.id:"",disabled:Ae.status==="BLOQUEADO",children:[Ae.name," | Saldo: ",Gc(Ae.balance||0)]},Ae.id))]}),i.jsx("button",{type:"button",className:"w-full px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>V(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:Gc(ee)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:Gc(me)})]})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:Re,className:"w-full border p-2 rounded",value:F===0?"":F,onChange:Ae=>{const Qe=he(Ae.target.value);H(Qe)},placeholder:"0.00"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_,onChange:Ae=>{S(Ae.target.value),z([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(Ae=>i.jsxs("option",{value:Ae.id,children:[Ae.name,"  "," ",Ae.commissionPercent.toFixed(2),"%"]},Ae.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor Logueado en esta app."})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>ge(Ae=>!Ae),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Agrega Productos",i.jsx("span",{className:"text-lg",children:ue?"":"+"})]}),ue&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Productos"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:_?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Ht,onChange:Ae=>Le(Ae.target.value),disabled:!_}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Ft(!0),disabled:!_,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async Ae=>{const Qe=Ae.target.value;P(Qe),await Ye(Qe)},disabled:!_,children:[i.jsx("option",{value:"",children:_?"Selecciona un producto":"Selecciona un vendedor primero"}),Ce.map(Ae=>{const Qe=O.some(R=>R.productId===Ae.id),fe=f[Ae.id]||0,te=Math.max(1,Number(Ae.unitsPerPackage||1)),_e=Math.floor(fe/te);return _e<=0?null:i.jsxs("option",{value:Qe?"":Ae.id,disabled:Qe,children:[Ae.name," ",Ae.sku?` ${Ae.sku}`:""," (disp:"," ",_e," paq.)",Qe?" ":""]},Ae.id)})]})]}),O.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay productos agregados."}):i.jsx("div",{className:"space-y-2",children:O.map(Ae=>{const Qe=f[Ae.productId]??Ae.availableUnits??0,fe=Ae.unitsPerPackage?Math.floor(Qe/Ae.unitsPerPackage):0,te=Math.max(0,fe-(Ae.qtyPackages||0)),_e=(Number(Ae.pricePerPackage)||0)*(Ae.qtyPackages||0),R=Math.max(0,_e-(Number(Ae.discount)||0));return i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50 space-y-2",children:[i.jsxs("div",{className:"font-semibold leading-tight",children:[Ae.productName,Ae.sku?`  ${Ae.sku}`:""]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio x Paquete"}),i.jsx("div",{className:"font-bold",children:Gc(Ae.pricePerPackage)})]}),i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencias"}),i.jsxs("div",{className:"font-bold",children:[te," paq."]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cantidad Paquetes"}),i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(Ae.qtyPackages)||Ae.qtyPackages===0?"":Ae.qtyPackages,onChange:Q=>xe(Ae.productId,Q.target.value),inputMode:"numeric",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Descuento"}),i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(Ae.discount)||Ae.discount===0?"":Ae.discount,onChange:Q=>Se(Ae.productId,Q.target.value),inputMode:"numeric",placeholder:"0"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"font-regular text-gray-600",children:["Total ",Gc(R)]}),i.jsxs("div",{className:"font-regular text-gray-600",children:["Comision ",Gc(Ae.margenVendedor||0)]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg bg-red-100 hover:bg-red-200",onClick:()=>xt(Ae.productId),children:"Quitar"})]})]},Ae.productId)})}),O.length>0&&i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:ne})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-semibold",children:Gc(Ue)})]})]})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl hover:bg-blue-700 disabled:opacity-60",disabled:W,children:W?"Guardando...":"Registrar venta"})]})]}),K&&i.jsx("p",{className:"mt-2 text-sm",children:K}),D&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:Z,onChange:Ae=>be(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:L,onChange:Ae=>Xe(lK(Ae.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:re,onChange:Ae=>J(Ae.target.value),children:[i.jsx("option",{value:"",children:""}),IQe.map(Ae=>i.jsx("option",{value:Ae,children:Ae},Ae))]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Bt,onChange:Ae=>Ot(Ae.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.filter(Ae=>(Ae.status??"ACTIVO")==="ACTIVO").map(Ae=>i.jsxs("option",{value:Ae.id,children:[Ae.name,"  ",Ae.branchLabel]},Ae.id))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:De,onChange:Ae=>ie(Ae.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{jt(),V(!1)},children:"Cancelar"}),i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var fe;const Ae=E?_||r:Bt;if(!Ae){U("Selecciona el vendedor para asociar este cliente.");return}if(U(""),!Z.trim()){U("Ingresa el nombre del nuevo cliente.");return}const Qe=lK(L);try{const te=await Zn(bt(Pe,"customers_candies"),{name:Z.trim(),phone:Qe,place:re||"",notes:De||"",status:He,creditLimit:Number(dt||0),createdAt:xr.now(),sellerId:Ae,vendorId:Ae,vendorName:((fe=u.find(R=>R.id===Ae))==null?void 0:fe.name)||""}),_e={id:te.id,name:Z.trim(),phone:Qe,place:re||"",status:He,creditLimit:Number(dt||0),balance:0,sellerId:Ae};o(R=>[_e,...R]),y(te.id),jt(),V(!1),U(" Cliente creado")}catch(te){console.error(te),U(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),i.jsx(Fe,{open:Qt,onClose:()=>Ft(!1),onDetected:$e}),W&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const cK=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],d_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function FQe(){const[t,e]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[P,O]=g.useState(""),[z,oe]=g.useState(0),[ce,ue]=g.useState("PENDIENTE"),[ge,ne]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(bt(Pe,"expenses_candies"),In("date","desc")),V=await $t(D),Z=[];V.forEach(be=>{const L=be.data();Z.push({id:be.id,date:L.date||Ur(new Date,"yyyy-MM-dd"),category:L.category||"",description:L.description||"",amount:Number(L.amount||0),status:L.status||"PENDIENTE",notes:L.notes||"",createdAt:L.createdAt??xr.now()})}),v(Z)}catch(D){console.error(D),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Oe=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Ue=g.useMemo(()=>{const D=Oe.reduce((be,L)=>be+(L.amount||0),0),V=Oe.filter(be=>be.status==="PAGADO").reduce((be,L)=>be+(L.amount||0),0),Z=D-V;return{total:D,pagado:V,pendiente:Z}},[Oe]),F=()=>{s(Ur(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const V=await Zn(bt(Pe,"expenses_candies"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()});v(Z=>[{id:V.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()},...Z]),F(),j(" Gasto registrado")}catch(V){console.error(V),j(" Error al guardar gasto")}},K=D=>{_(D.id),E(D.date),k(D.category||""),O(D.description||""),oe(Number(D.amount||0)),ue(D.status||"PENDIENTE"),ne(D.notes||"")},U=()=>{_(null),E(""),k(""),O(""),oe(0),ue("PENDIENTE"),ne("")},W=async()=>{if(I){if(!B){j("Selecciona una categora.");return}if(!P.trim()){j("Ingresa una descripcin.");return}if(!z||z<=0){j("Ingresa un monto vlido.");return}try{await Fn(er(Pe,"expenses_candies",I),{date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:ce,notes:ge||""}),v(D=>D.map(V=>V.id===I?{...V,date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:ce,notes:ge||""}:V)),U(),j(" Gasto actualizado")}catch(D){console.error(D),j(" Error al actualizar gasto")}}},X=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await qn(er(Pe,"expenses_candies",D.id)),v(Z=>Z.filter(be=>be.id!==D.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",d_(Ue.total)]}),i.jsxs("div",{children:["Pagado: ",d_(Ue.pagado)]}),i.jsxs("div",{children:["Pendiente: ",d_(Ue.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),cK.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Oe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Oe.slice().sort((D,V)=>D.date.localeCompare(V.date)).map(D=>{const V=I===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:Z=>E(Z.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:Z=>k(Z.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),cK.map(Z=>i.jsx("option",{value:Z,children:Z},Z))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:Z=>O(Z.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(z)?"":z,onChange:Z=>oe(Math.max(0,Number(Z.target.value||0)))}):d_(D.amount)}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:ce,onChange:Z=>ue(Z.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:ge,onChange:Z=>ne(Z.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:V?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:W,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:U,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>K(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>X(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const xo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function OQe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):""}function DQe(t,e){var l,c,u;const r=OQe(t);if(!r)return null;let n=0,a=0;const s=Array.isArray(t.items)&&t.items.length>0?t.items:t.item?[t.item]:[],o=s.length?s.map(d=>String(d.productName||d.name||"").trim()).filter(Boolean):t.productName?[String(t.productName).trim()]:[];return s.length>0?(n=s.reduce((d,f)=>d+(Number(f.packages??f.qty??f.quantity??0)||0),0),a=Number(t.total??t.itemsTotal??0)||0,a||(a=s.reduce((d,f)=>d+(Number(f.total??f.lineFinal??0)||0),0))):(n=Number(t.packagesTotal??t.quantity??((l=t.item)==null?void 0:l.packages)??((c=t.item)==null?void 0:c.qty)??0)||0,a=Number(t.total??((u=t.item)==null?void 0:u.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0,productNames:o}}async function RQe(t){const e=(t||"").trim();if(!e)return;const r=sr(bt(Pe,"ar_movements"),Ar("ref.saleId","==",e)),n=await $t(r);await Promise.all(n.docs.map(a=>qn(er(Pe,"ar_movements",a.id))))}function MQe({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=Sn(n,"vendedor_dulces"),s=Sn(n,"admin"),o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async ee=>{c(!0),d(!0),A(ee),m([]);try{const me=await zs(er(Pe,"sales_candies",ee)),Re=me.exists()?me.data():null;if(!Re){m([]);return}const qe=(Array.isArray(Re==null?void 0:Re.items)?Re.items:Re!=null&&Re.item?[Re.item]:[]).map(st=>({productName:String(st.productName||""),qty:Number(st.packages??st.qty??st.quantity??0),unitPrice:Number(st.unitPricePackage??st.unitPrice??0),discount:Number(st.discount||0),total:Number(st.total??st.lineFinal??0)}));m(qe)}catch(me){console.error(me)}finally{d(!1)}},[x,v]=g.useState(Ur(new Date,"yyyy-MM-01")),[y,b]=g.useState(Ur(new Date,"yyyy-MM-dd")),[w,j]=g.useState([]),[I,_]=g.useState([]),[S,E]=g.useState(""),[B,k]=g.useState([]),[P,O]=g.useState(!0),[z,oe]=g.useState(""),[ce,ue]=g.useState(""),[ge,ne]=g.useState(""),[Oe,Ue]=g.useState(null),F=15,[H,K]=g.useState(1),[U,W]=g.useState(!1),[X,D]=g.useState(!1),[V,Z]=g.useState(!1),[be,L]=g.useState(!1),Xe=g.useMemo(()=>{const ee={};return w.forEach(me=>ee[me.id]=me.name),ee},[w]),re=g.useMemo(()=>{const ee={};return B.forEach(me=>{ee[me.id]=me}),ee},[B]),J=g.useMemo(()=>{const ee=new Set;return I.forEach(me=>{(me.productNames||[]).forEach(Re=>ee.add(Re))}),Array.from(ee).sort((me,Re)=>me.localeCompare(Re))},[I]),De=ee=>{const me=Number(ee.vendorCommissionAmount||0);if(me>0)return me;if(!ee.vendorId)return 0;const Re=re[ee.vendorId];if(!Re||!Re.commissionPercent)return 0;const he=(Number(ee.total)||0)*(Number(Re.commissionPercent)||0)/100;return Number(he.toFixed(2))};g.useEffect(()=>{(async()=>{O(!0),oe("");try{const ee=await $t(bt(Pe,"customers_candies")),me=[];ee.forEach(yt=>me.push({id:yt.id,name:yt.data().name||""})),j(me);const Re=await $t(bt(Pe,"sellers_candies")),he=[];Re.forEach(yt=>{const pe=yt.data();he.push({id:yt.id,name:pe.name||"",commissionPercent:Number(pe.commissionPercent||0)})}),k(he);const qe=await $t(sr(bt(Pe,"sales_candies"),In("createdAt","desc"))),st=[];qe.forEach(yt=>{const pe=DQe(yt.data(),yt.id);pe&&pe.date>=x&&pe.date<=y&&st.push(pe)}),_(st.sort((yt,pe)=>pe.date.localeCompare(yt.date))),K(1)}catch(ee){console.error(ee),oe(" Error cargando transacciones.")}finally{O(!1)}})()},[x,y]);const ie=g.useMemo(()=>I.filter(ee=>!(a&&(!e||!ee.vendorId||ee.vendorId!==e)||ce&&ee.customerId!==ce||ge&&ee.type!==ge||S&&(!ee.productNames||!ee.productNames.includes(S)))),[I,ce,ge,S,a,e]),He=g.useMemo(()=>{let ee=0,me=0,Re=0,he=0,qe=0,st=0;for(const yt of ie)yt.type==="CONTADO"?(ee+=yt.quantity,Re+=yt.total,qe+=De(yt)):(me+=yt.quantity,he+=yt.total,st+=De(yt));return{packsCash:ee,packsCredito:me,montoCash:Re,montoCredito:he,comisionCash:qe,comisionCredito:st}},[ie]),Ge=Math.max(1,Math.ceil(ie.length/F)),dt=g.useMemo(()=>{const ee=(H-1)*F;return ie.slice(ee,ee+F)},[ie,H]),_t=g.useMemo(()=>dt.filter(ee=>ee.type==="CONTADO"),[dt]),Bt=g.useMemo(()=>dt.filter(ee=>ee.type==="CREDITO"),[dt]),Ot=g.useMemo(()=>f&&I.find(ee=>ee.id===f)||null,[f,I]),jt=async ee=>{if(s&&(Ue(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{O(!0);const me=ee.id.split("#")[0];await K2(me),await RQe(me),_(Re=>Re.filter(he=>he.id!==ee.id)),oe(" Venta eliminada y saldo del cliente ajustado")}catch(me){console.error(me),oe(" No se pudo eliminar la venta.")}finally{O(!1)}},Qt=()=>{const ee=`Ventas del dia  ${x} a ${y}`,me=st=>(st||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Re=ie.map(st=>{const yt=st.customerName||(st.customerId?Xe[st.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${st.date}</td>
          <td>${me(yt)}</td>
          <td>${st.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${st.quantity}</td>
          <td style="text-align:right">${xo(st.total)}</td>
        </tr>`}).join(""),he=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${me(ee)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${me(ee)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${He.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${He.packsCredito}</div>
        <div><b>Monto Cash:</b> ${xo(He.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${xo(He.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${Re||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,qe=window.open("","_blank");qe&&(qe.document.open(),qe.document.write(he),qe.document.close())},Ft=()=>K(1),$e=()=>K(ee=>Math.max(1,ee-1)),Fe=()=>K(ee=>Math.min(Ge,ee+1)),Ze=()=>K(Ge),Te=()=>{const ee=[];if(Ge<=7)for(let Re=1;Re<=Ge;Re++)ee.push(Re);else{const Re=Math.max(1,H-2),he=Math.min(Ge,H+2);ee.push(1),Re>2&&ee.push(-1);for(let qe=Re;qe<=he;qe++)qe!==1&&qe!==Ge&&ee.push(qe);he<Ge-1&&ee.push(-2),ee.push(Ge)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ft,disabled:H===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:$e,disabled:H===1,children:" Anterior"}),ee.map((Re,he)=>typeof Re=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${Re===H?"bg-blue-600 text-white":""}`,onClick:()=>K(Re),children:Re},he):i.jsx("span",{className:"px-2",children:""},he)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Fe,disabled:H===Ge,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ze,disabled:H===Ge,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",H," de ",Ge,"  ",ie.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>W(ee=>!ee),"aria-expanded":U,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${U?"rotate-180":""}`,children:""})]}),U&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:ee=>{v(ee.target.value),K(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:ee=>{b(ee.target.value),K(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ce,onChange:ee=>{ue(ee.target.value),K(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(ee=>i.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ge,onChange:ee=>{ne(ee.target.value),K(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:S,onChange:ee=>{E(ee.target.value),K(1)},disabled:J.length===0,children:[i.jsx("option",{value:"",children:"Todos"}),J.map(ee=>i.jsx("option",{value:ee,children:ee},ee))]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Qt,children:"Exportar PDF"})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(ee=>!ee),"aria-expanded":X,children:[i.jsx("span",{children:"Indicadores"}),i.jsx("span",{className:`transition-transform ${X?"rotate-180":""}`,children:""})]}),X&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:He.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:He.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(He.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(He.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(He.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(He.comisionCredito)})]})]})})]}),i.jsxs("div",{className:"block md:hidden space-y-3",children:[P?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):dt.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Z(ee=>!ee),"aria-expanded":V,children:[i.jsx("span",{children:"Cash"}),i.jsx("span",{className:`transition-transform ${V?"rotate-180":""}`,children:""})]}),V&&i.jsx("div",{className:"p-3 border-t space-y-3",children:_t.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):_t.map(ee=>{const me=ee.customerName||(ee.customerId?Xe[ee.customerId]:"")||"Nombre cliente",Re=De(ee);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:me}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ee.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-green-50 border-green-200 text-green-700",children:"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:he=>{he.preventDefault(),p(ee.id)},title:"Ver detalle",children:ee.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",xo(ee.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:me})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ee.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ee.id),title:"Ver detalle",children:ee.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:xo(ee.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:Re>0?xo(Re):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ee.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>Ue(he=>he===ee.id?null:ee.id),children:" Acciones"}),Oe===ee.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>jt(ee),children:"Eliminar"})]})]})})]})},ee.id)})})]}),i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>L(ee=>!ee),"aria-expanded":be,children:[i.jsx("span",{children:"Crdito"}),i.jsx("span",{className:`transition-transform ${be?"rotate-180":""}`,children:""})]}),be&&i.jsx("div",{className:"p-3 border-t space-y-3",children:Bt.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):Bt.map(ee=>{const me=ee.customerName||(ee.customerId?Xe[ee.customerId]:"")||"Nombre cliente",Re=De(ee);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:me}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ee.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-yellow-50 border-yellow-200 text-yellow-700",children:"Crdito"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:he=>{he.preventDefault(),p(ee.id)},title:"Ver detalle",children:ee.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",xo(ee.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:me})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ee.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Crdito"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ee.id),title:"Ver detalle",children:ee.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:xo(ee.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:Re>0?xo(Re):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ee.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>Ue(he=>he===ee.id?null:ee.id),children:" Acciones"}),Oe===ee.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>jt(ee),children:"Eliminar"})]})]})})]})},ee.id)})})]})]}),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:Te()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):dt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):dt.map(ee=>{const me=ee.customerName||(ee.customerId?Xe[ee.customerId]:"")||"Nombre cliente",Re=De(ee);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.date}),i.jsx("td",{className:"p-2 border",children:me}),i.jsx("td",{className:"p-2 border",children:ee.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(ee.id),children:ee.quantity})}),i.jsx("td",{className:"p-2 border",children:xo(ee.total)}),i.jsx("td",{className:"p-2 border",children:Re>0?xo(Re):""}),i.jsx("td",{className:"p-2 border",children:ee.vendorName||""}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>Ue(he=>he===ee.id?null:ee.id),title:"Acciones",children:""}),Oe===ee.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>jt(ee),children:"Eliminar"})})]})]},ee.id)})})]}),Te()]}),z&&i.jsx("p",{className:"mt-2 text-sm",children:z}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",f?` #${f}`:""]}),Ot&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:De(Ot)>0?xo(De(Ot)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((ee,me)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ee.productName}),i.jsx("td",{className:"p-2 border text-right",children:ee.qty}),i.jsx("td",{className:"p-2 border text-right",children:xo(ee.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:xo(ee.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:xo(ee.total)})]},me))})]})})]})})]})}const bn=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function eb(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function LQe(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/a:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}});if(t!=null&&t.item){const n=t.item,a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/a:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0),uBruta:Number((t==null?void 0:t.uBruta)??(t==null?void 0:t.grossProfit)??0)}]:[]}function UQe(t,e){const r=eb(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,a=t.vendorName||t.sellerName||void 0,s=LQe(t);let o=Number(t.total??t.itemsTotal??0)||s.reduce((l,c)=>{const u=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),d=Math.max(0,Number(c.discount||0)),f=Math.max(0,u-d);return l+f},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:s,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:a,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}function QQe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}async function VQe(t){const e=sr(bt(Pe,"ar_movements"),Ar("ref.saleId","==",t)),r=await $t(e);await Promise.all(r.docs.map(n=>qn(er(Pe,"ar_movements",n.id))))}function HQe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState([]),[S,E]=g.useState({}),[B,k]=g.useState({}),[P,O]=g.useState(!1),[z,oe]=g.useState(null),[ce,ue]=g.useState([]),[ge,ne]=g.useState(!1),[Oe,Ue]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[F,H]=g.useState(!1),[K,U]=g.useState(""),[W,X]=g.useState([]),[D,V]=g.useState(!1),[Z,be]=g.useState("CASH"),[L,Xe]=g.useState(1),re=10,[J,De]=g.useState(!1),[ie,He]=g.useState(null);g.useEffect(()=>{(async()=>{try{const he=await $t(bt(Pe,"sellers_candies")),qe=[];he.forEach(st=>{const yt=st.data();qe.push({id:st.id,name:yt.name||"",commissionPercent:Number(yt.commissionPercent||0)})}),_(qe)}catch(he){console.error("Error cargando sellers_candies",he)}})()},[]);const Ge=g.useMemo(()=>{const he={};return I.forEach(qe=>{he[qe.id]=qe}),he},[I]);g.useEffect(()=>{(async()=>{b(!0),j("");try{const he=await $t(bt(Pe,"sales_candies")),qe=[],st=[];he.forEach(Le=>{const Ce=Le.data(),Ae=UQe(Ce,Le.id);Ae&&(Ae.date<=a&&qe.push(Ae),Ae.date>=r&&Ae.date<=a&&st.push(Ae))}),u(qe),l(st);const yt=await $t(bt(Pe,"inventory_candies")),pe=[];yt.forEach(Le=>{const Ce=Le.data(),Ae=eb(Ce);if(!Ae||Ae>a)return;const Qe=Math.max(1,Math.floor(Number(Ce.unitsPerPackage||1))),fe=Number(Ce.totalUnits??Ce.quantity??0),te=Number(Ce.packages??0),_e=Number(Ce.remaining??0),R=Number(Ce.remainingPackages??0),Q=te>0?te:fe>0?Math.floor(fe/Qe):0,G=R>0?R:_e>0?Math.floor(_e/Qe):0;pe.push({id:Le.id,productId:Ce.productId,productName:Ce.productName||"",date:Ae,quantity:Number(Q||0),remaining:Number(G||0),purchasePrice:Number(Ce.providerPrice||Ce.purchasePrice||0),unitsPerPackage:Qe})}),f(pe);const je=await $t(bt(Pe,"expenses_candies")),we=[];je.forEach(Le=>{const Ce=Le.data(),Ae=eb(Ce);Ae&&Ae>=r&&Ae<=a&&we.push({id:Le.id,date:Ae,category:Ce.category||"",description:Ce.description||"",amount:Number(Ce.amount||0),status:Ce.status||""})}),h(we);const Ye=await $t(bt(Pe,"ar_movements")),xe=[],Se={};Ye.forEach(Le=>{const Ce=Le.data(),Ae=eb(Ce);if(!Ae)return;const Qe=Ce.customerId,fe=Number(Ce.amount||0);Qe&&(Se[Qe]=(Se[Qe]||0)+fe),Ce.type==="ABONO"&&Ae>=r&&Ae<=a&&xe.push({id:Le.id,customerId:Qe,type:"ABONO",amount:fe,date:Ae})}),p(xe);const xt=await $t(bt(Pe,"customers_candies")),Pt=[];xt.forEach(Le=>{const Ce=Le.data();Pt.push({id:Le.id,name:Ce.name||"",balance:Se[Le.id]||0})}),v(Pt);const It=await $t(bt(Pe,"inventory_candies_sellers")),Ut={},Ht={};It.forEach(Le=>{const Ce=Le.data(),Ae=eb(Ce);if(!Ae||Ae<r||Ae>a)return;const Qe=Ce.sellerId||Ce.vendorId||"NO_VENDOR",fe=Ce.productName||"",te=Ce.sku||"",_e=Math.max(1,Math.floor(Number(Ce.unitsPerPackage||1))),R=Number(Ce.totalUnits??0),Q=Number(Ce.packages??0),G=Number(Ce.remainingUnits??Ce.remaining??0),se=Number(Ce.remainingPackages??0),Ne=Q>0?Q:R>0?Math.floor(R/_e):0,Me=se>0?se:G>0?Math.floor(G/_e):0,ze=Number(Ce.totalVendor??0),Ie=Number(Ce.uVendor??0),nt=Number(Ce.subtotal??0),lt=Number(Ce.uBruta??0),ht=Ne,kt=ht>0?ze/ht:0,le=ht>0?Ie/ht:0,We=ht>0?nt/ht:0,it=ht>0?lt>0?lt/ht:kt-We:0;if(Ut[Qe]||(Ut[Qe]={associated:[],remaining:[]}),Ne>0){const ot=Ne,Nt=ot*kt,Rt=ot*We,nr=Nt,_r=ot*le,$r=ot*it;Ut[Qe].associated.push({saleId:Le.id,date:Ae,productId:Ce.productId||Ce.id||"",productName:fe,sku:te,qty:ot,unitPrice:kt,costTotal:Rt,lineTotal:Nt,discount:0,lineFinal:nr,grossProfit:$r,vendorCommissionAmount:_r,type:"ASSOCIATED"}),Ht[Qe]=(Ht[Qe]||0)+ot}if(Me>0){const ot=Me,Nt=ot*kt,Rt=ot*We,nr=Nt,_r=ot*le,$r=ot*it;Ut[Qe].remaining.push({saleId:Le.id,date:Ae,productId:Ce.productId||Ce.id||"",productName:fe,sku:te,qty:ot,unitPrice:kt,costTotal:Rt,lineTotal:Nt,discount:0,lineFinal:nr,grossProfit:$r,vendorCommissionAmount:_r,type:"REMAINING"})}}),E(Ut),k(Ht)}catch(he){console.error(he),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const dt=g.useCallback((he,qe)=>{const st=Number(qe.vendorCommissionAmount||0)||0;if(st>0)return st;const yt=Number(he.vendorCommissionAmount||0)||0;if(yt<=0)return 0;const pe=Number(qe.qty||0),je=Number(qe.unitPrice||0),we=pe*je,Ye=Math.max(0,Number(qe.discount||0)),xe=Math.max(0,we-Ye);return!xe||!he.total?0:yt*xe/he.total},[]),_t=g.useMemo(()=>{try{return QQe(d,c,r,a)}catch(he){return console.error(he),0}},[d,c,r,a]),Bt=g.useMemo(()=>{const he=o.reduce((It,Ut)=>It+(Ut.total||0),0),qe=A.reduce((It,Ut)=>It+(Ut.amount||0),0),st=he-_t,yt=st-qe;let pe=0;for(const It of o)for(const Ut of It.items||[]){const Ht=Number(Ut.uBruta||0);Number.isFinite(Ht)&&(pe+=Ht)}const je=m.reduce((It,Ut)=>It+Math.abs(Ut.amount||0),0),we=x.filter(It=>(It.balance||0)>0),Ye=we.reduce((It,Ut)=>It+(Ut.balance||0),0);let xe=0,Se=0,xt=0,Pt=0;for(const It of o){const Ut=(It.items||[]).reduce((Le,Ce)=>Le+(Number(Ce.qty)||0),0),Ht=(It.items||[]).reduce((Le,Ce)=>Le+dt(It,Ce),0);It.type==="CONTADO"?(xe+=Ut,xt+=Ht):(Se+=Ut,Pt+=Ht)}return{ventasTotales:he,costoMercaderia:_t,gastosPeriodo:qe,gananciaAntes:st,utilidadBrutaOrdenes:pe,gananciaDespues:yt,abonosRecibidos:je,saldosPendientes:Ye,clientesConSaldo:we.length,paquetesCash:xe,paquetesCredito:Se,comisionCash:xt,comisionCredito:Pt}},[o,A,m,x,_t,dt,S]),Ot=g.useMemo(()=>{const he={},qe={};for(const st of o)if(!(st.type!=="CREDITO"||!st.customerId))for(const yt of st.items||[]){const pe=Number(yt.qty||0),je=Number(yt.unitPrice||0),we=pe*je,Ye=Math.max(0,Number(yt.discount||0)),xe=Math.max(0,we-Ye);he[st.customerId]=(he[st.customerId]||0)+pe,qe[st.customerId]=(qe[st.customerId]||0)+xe}return x.filter(st=>(st.balance||0)>0).map(st=>({customerId:st.id,name:st.name,paquetesAsociados:he[st.id]||0,saldoTotal:qe[st.id]||0,saldoPendiente:st.balance||0})).sort((st,yt)=>yt.saldoPendiente-st.saldoPendiente)},[x,o]),jt=g.useMemo(()=>{const he={};return x.forEach(qe=>he[qe.id]=qe.name),he},[x]),Qt=g.useMemo(()=>[...o].sort((he,qe)=>qe.date.localeCompare(he.date)).map(he=>{var pe;const qe=(he.items||[]).reduce((je,we)=>je+(Number(we.qty)||0),0);let st="Cash";he.type==="CREDITO"&&he.customerId?st=jt[he.customerId]||"":he.type==="CONTADO"&&(st=((pe=he.customerName)==null?void 0:pe.trim())||"Cash");const yt=qe>0?he.total/qe:0;return{id:he.id,date:he.date,type:he.type==="CREDITO"?"Crdito":"Cash",customer:st,paquetes:qe,total:Number(he.total||0),avgPrice:yt}}),[o,jt]),Ft=g.useMemo(()=>{var qe,st;const he=new Map;for(const yt of o){const pe=yt.vendorId||"NO_VENDOR",je=yt.vendorName||((qe=Ge[pe])==null?void 0:qe.name)||"Sin vendedor";he.has(pe)||he.set(pe,{vendorId:pe,vendorName:je,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const we=he.get(pe);for(const Ye of yt.items||[]){const xe=Number(Ye.qty||0),Se=Number(Ye.unitPrice||0),xt=xe*Se,Pt=Math.max(0,Number(Ye.discount||0)),It=Math.max(0,xt-Pt),Ut=dt(yt,Ye);yt.type==="CONTADO"?(we.paquetesVendidos+=xe,we.totalVendido+=It,we.comisionCash+=Ut):(we.paquetesFiados+=xe,we.totalFiado+=It,we.comisionCredito+=Ut)}}for(const[yt,pe]of Object.entries(B)){const je=he.get(yt),we=(je==null?void 0:je.vendorName)||((st=Ge[yt])==null?void 0:st.name)||"Sin vendedor",Ye=je||{vendorId:yt,vendorName:we,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};Ye.paquetesAsociados=pe,Ye.paquetesRestantes=Math.max(pe-Ye.paquetesVendidos-Ye.paquetesFiados,0),he.set(yt,Ye)}return Array.from(he.values()).sort((yt,pe)=>pe.totalVendido+pe.totalFiado-(yt.totalVendido+yt.totalFiado))},[o,B,Ge,dt]),$e=async he=>{O(!0),oe({id:he.customerId,name:he.name}),ue([]),ne(!0),Ue({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const qe=[];let st=0,yt=0,pe=0;for(const xe of o)if(!(xe.type!=="CREDITO"||xe.customerId!==he.customerId))for(const Se of xe.items||[]){const xt=Number(Se.qty||0),Pt=Number(Se.unitPrice||0),It=xt*Pt,Ut=Math.max(0,Number(Se.discount||0)),Ht=Math.max(0,It-Ut);qe.push({saleId:xe.id,date:xe.date,productName:Se.productName,sku:Se.sku||"",qty:xt,unitPrice:Pt,lineTotal:It,discount:Ut,lineFinal:Ht}),st+=It,yt+=Ut,pe+=Ht}let je=0;for(const xe of m)xe.customerId===he.customerId&&(je+=Math.abs(xe.amount||0));const we=x.find(xe=>xe.id===he.customerId),Ye=(we==null?void 0:we.balance)||0;ue(qe),Ue({totalBruto:st,totalDescuento:yt,totalFiado:pe,saldoActual:Ye,abonadoPeriodo:je})}catch(qe){console.error(qe),j(" No se pudo cargar el detalle del cliente.")}finally{ne(!1)}},Fe=(he,qe,st)=>{H(!0),be(st),Xe(1);let yt="";st==="ASSOCIATED"?yt=`Paquetes asociados  ${qe}`:st==="REMAINING"?yt=`Paquetes restantes  ${qe}`:st==="CASH"?yt=`Paquetes vendidos (Cash)  ${qe}`:yt=`Paquetes fiados (Crdito)  ${qe}`,U(yt),X([]),V(!0);try{if(st==="ASSOCIATED"||st==="REMAINING"){const je=S[he],we=st==="ASSOCIATED"?(je==null?void 0:je.associated)||[]:(je==null?void 0:je.remaining)||[];X([...we].sort((Ye,xe)=>(xe.qty||0)-(Ye.qty||0))),V(!1);return}const pe=[];for(const je of o)if(((je.vendorId||"NO_VENDOR")===he||!je.vendorId&&he==="NO_VENDOR")&&!(st==="CASH"&&je.type!=="CONTADO")&&!(st==="CREDIT"&&je.type!=="CREDITO"))for(const Ye of je.items||[]){const xe=Number(Ye.qty||0),Se=Number(Ye.unitPrice||0),xt=xe*Se,Pt=Math.max(0,Number(Ye.discount||0)),It=Math.max(0,xt-Pt),Ut=dt(je,Ye);pe.push({saleId:je.id,date:je.date,productName:Ye.productName,sku:Ye.sku||"",qty:xe,unitPrice:Se,lineTotal:xt,discount:Pt,lineFinal:It,vendorCommissionAmount:Ut,type:st})}X(pe.sort((je,we)=>je.date.localeCompare(we.date)))}catch(pe){console.error(pe),j(" No se pudo cargar el detalle del vendedor.")}finally{V(!1)}},Ze=g.useMemo(()=>Z!=="ASSOCIATED"&&Z!=="REMAINING"?1:Math.max(1,Math.ceil(W.length/re)),[Z,W.length]),Te=g.useMemo(()=>{if(Z!=="ASSOCIATED"&&Z!=="REMAINING")return W;const he=(L-1)*re;return W.slice(he,he+re)},[Z,L,W]),ee=Z==="ASSOCIATED"||Z==="REMAINING"?10:8;g.useEffect(()=>{Z!=="ASSOCIATED"&&Z!=="REMAINING"||L>Ze&&Xe(Ze)},[Z,L,Ze]);const me=he=>{const qe=o.find(st=>st.id===he)||null;He(qe),De(!0)},Re=async he=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await K2(he),await VQe(he),l(qe=>qe.filter(st=>st.id!==he)),u(qe=>qe.filter(st=>st.id!==he)),De(!1),He(null)}catch(qe){console.error(qe),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(Oc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:he=>n(he.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:he=>s(he.target.value)})]})]}),i.jsx("div",{className:"md:hidden mb-4",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",open:!0,children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"KPIs"}),i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(Bt.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(Bt.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:Bt.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Bt.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:Bt.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.comisionCredito)})]})]})})]})}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(Bt.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:bn(Bt.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:Bt.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Bt.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:Bt.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Bt.comisionCredito)})]})]}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Consolidado clientes y vendedores"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border",children:"Saldo total"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ot.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ot.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:he.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>$e({customerId:he.customerId,name:he.name}),title:"Ver paquetes fiados del periodo",children:he.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:bn(he.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:bn(he.saldoPendiente)})]},he.customerId))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Ft.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"ASSOCIATED"),children:he.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"REMAINING"),children:he.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"CASH"),children:he.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"CREDIT"),children:he.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.comisionCredito)})]},he.vendorId))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ot.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ot.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:he.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>$e({customerId:he.customerId,name:he.name}),title:"Ver paquetes fiados del periodo",children:he.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:bn(he.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:bn(he.saldoPendiente)})]},he.customerId))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Ft.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"ASSOCIATED"),children:he.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"REMAINING"),children:he.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"CASH"),children:he.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Fe(he.vendorId,he.vendorName,"CREDIT"),children:he.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.comisionCredito)})]},he.vendorId))})]})}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Transacciones y gastos"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Qt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Qt.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>me(he.id),children:he.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>Re(he.id),children:"Eliminar"})})]},he.id))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((he,qe)=>he.date.localeCompare(qe.date)).map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:he.date}),i.jsx("td",{className:"p-2 border",children:he.category||""}),i.jsx("td",{className:"p-2 border",children:he.description?i.jsx("span",{title:he.description,children:he.description.length>40?he.description.slice(0,40)+"":he.description}):""}),i.jsx("td",{className:"p-2 border",children:bn(he.amount)}),i.jsx("td",{className:"p-2 border",children:he.status||""})]},he.id))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Qt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Qt.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:he.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>me(he.id),children:he.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:bn(he.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>Re(he.id),children:"Eliminar"})})]},he.id))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((he,qe)=>he.date.localeCompare(qe.date)).map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:he.date}),i.jsx("td",{className:"p-2 border",children:he.category||""}),i.jsx("td",{className:"p-2 border",children:he.description?i.jsx("span",{title:he.description,children:he.description.length>40?he.description.slice(0,40)+"":he.description}):""}),i.jsx("td",{className:"p-2 border",children:bn(he.amount)}),i.jsx("td",{className:"p-2 border",children:he.status||""})]},he.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(z==null?void 0:z.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>O(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Oe.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Oe.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Oe.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Oe.abonadoPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:bn(Oe.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:ge?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ce.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ce.sort((he,qe)=>he.date.localeCompare(qe.date)).map((he,qe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:he.date}),i.jsx("td",{className:"p-2 border",children:he.productName}),i.jsx("td",{className:"p-2 border",children:he.qty}),i.jsx("td",{className:"p-2 border",children:bn(he.unitPrice)}),i.jsx("td",{className:"p-2 border",children:bn(he.lineTotal)}),i.jsx("td",{className:"p-2 border",children:bn(he.discount)}),i.jsx("td",{className:"p-2 border",children:bn(he.lineFinal)})]},`${he.saleId}-${qe}`))})]})})]})}),F&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:K}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>H(!1),children:"Cerrar"})]}),(Z==="ASSOCIATED"||Z==="REMAINING")&&!D&&i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2 text-sm",children:[i.jsxs("div",{className:"text-gray-600",children:["Pgina ",L," de ",Ze]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Xe(he=>Math.max(1,he-1)),disabled:L<=1,children:"Anterior"}),i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Xe(he=>Math.min(Ze,he+1)),disabled:L>=Ze,children:"Siguiente"})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha Orden"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Costo"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]}):i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Utilidad vendedor"})]}):i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:D?i.jsx("tr",{children:i.jsx("td",{colSpan:ee,className:"p-4 text-center",children:"Cargando"})}):W.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:ee,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):Te.map((he,qe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:he.date}),i.jsx("td",{className:"p-2 border",children:he.productName}),i.jsx("td",{className:"p-2 border",children:he.qty}),i.jsx("td",{className:"p-2 border",children:bn(he.unitPrice)}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:bn(he.costTotal??0)}),i.jsx("td",{className:"p-2 border",children:bn(he.lineTotal)})]}):i.jsx("td",{className:"p-2 border",children:bn(he.lineTotal)}),i.jsx("td",{className:"p-2 border",children:bn(he.discount)}),i.jsx("td",{className:"p-2 border",children:bn(he.lineFinal)}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:bn(he.grossProfit||0)}),i.jsx("td",{className:"p-2 border",children:bn(he.vendorCommissionAmount)})]}):i.jsx("td",{className:"p-2 border",children:bn(he.vendorCommissionAmount)})]},`${he.saleId}-${qe}`))})]})})]})}),J&&ie&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",ie.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>De(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(ie.items||[]).map((he,qe)=>{const st=Number(he.qty||0),yt=Number(he.unitPrice||0),pe=st*yt,je=dt(ie,he);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:he.productName}),i.jsx("td",{className:"p-2 border",children:st}),i.jsx("td",{className:"p-2 border",children:bn(yt)}),i.jsx("td",{className:"p-2 border",children:bn(pe)}),i.jsx("td",{className:"p-2 border",children:bn(je)})]},qe)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),bn(ie.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>Re(ie.id),children:"Eliminar venta"})]})]})})]})}const uK=["Rivas","Isla Ometepe","San Jorge"];function $Qe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState("0"),[m,p]=g.useState("Rivas"),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,j]=g.useState("0"),[I,_]=g.useState("Rivas");g.useEffect(()=>{(async()=>{s(!0),l("");try{const z=sr(bt(Pe,"sellers_candies"),In("name","asc")),oe=await $t(z),ce=[];oe.forEach(ue=>{const ge=ue.data();ce.push({id:ue.id,name:ge.name||"",commissionPercent:Number(ge.commissionPercent||0),branch:ge.branch||"Rivas",createdAt:ge.createdAt||xr.now()})}),n(ce)}catch(z){console.error(z),l(" Error cargando vendedores.")}finally{s(!1)}})()},[t]);const S=()=>{f(""),h("0"),p("Rivas")},E=async z=>{z.preventDefault(),l("");const oe=d.trim();if(!oe){l("Ingresa el nombre y apellido del vendedor.");return}const ce=Number(A||0);if(ce<0){l("El margen no puede ser negativo.");return}try{const ue={name:oe,commissionPercent:ce,branch:m,createdAt:xr.now()},ge=await Zn(bt(Pe,"sellers_candies"),ue);n(ne=>[{id:ge.id,...ue},...ne]),l(" Vendedor creado correctamente."),S(),u(!1)}catch(ue){console.error(ue),l(" Error al crear el vendedor.")}},B=z=>{v(z.id),b(z.name),j(z.commissionPercent.toString()),_(z.branch)},k=()=>{v(null),b(""),j("0"),_("Rivas")},P=async()=>{if(!x)return;l("");const z=y.trim();if(!z){l("El nombre y apellido no pueden estar vacos.");return}const oe=Number(w||0);if(oe<0){l("El margen no puede ser negativo.");return}try{await Fn(er(Pe,"sellers_candies",x),{name:z,commissionPercent:oe,branch:I}),n(ce=>ce.map(ue=>ue.id===x?{...ue,name:z,commissionPercent:oe,branch:I}:ue)),l(" Vendedor actualizado."),k()}catch(ce){console.error(ce),l(" Error al actualizar el vendedor.")}},O=async z=>{if(window.confirm(`Eliminar al vendedor "${z.name}"? Esta accin no se puede deshacer.`))try{await qn(er(Pe,"sellers_candies",z.id)),n(ce=>ce.filter(ue=>ue.id!==z.id)),l(" Vendedor eliminado.")}catch(ce){console.error(ce),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Oc,{onClick:e,loading:a}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>u(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:z=>f(z.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Margen del vendedor (% sobre U Aproximada)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:A,onChange:z=>h(z.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje YA NO es comisin sobre venta. Se aplica as: U. Vendedor = U. Aproximada  (margen/100). U. Inversionista = U. Aproximada  U. Vendedor."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:z=>p(z.target.value),children:uK.map(z=>i.jsx("option",{value:z,children:z},z))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{S(),u(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Margen (% U Aproximada)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(z=>{const oe=x===z.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:oe?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:ce=>b(ce.target.value)}):z.name}),i.jsx("td",{className:"p-2 border",children:oe?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:w,onChange:ce=>j(ce.target.value)}):`${z.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:oe?i.jsx("select",{className:"border p-1 rounded text-xs",value:I,onChange:ce=>_(ce.target.value),children:uK.map(ce=>i.jsx("option",{value:ce,children:ce},ce))}):z.branch}),i.jsx("td",{className:"p-2 border",children:oe?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:P,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:k,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>B(z),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>O(z),children:"Borrar"})]})})]},z.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const la=t=>Math.max(0,Math.floor(Number(t||0)));function G2(t){return Math.max(1,la(t.unitsPerPackage||1))}function dK(t){const e=Number(t.remaining);if(Number.isFinite(e)&&e>0)return Math.floor(e);const r=Number(t.remainingPackages??t.remainingPacks??t.packagesRemaining??0);if(Number.isFinite(r)&&r>0){const l=G2(t);return Math.floor(r*l)}const n=G2(t),a=Number(t.totalUnits||0),s=Number(t.quantity||0),o=Number(t.packages||0);return a>0?Math.floor(a):s>0?Math.floor(s):o>0?Math.floor(o*n):0}async function KQe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);const n=!!t.deleteVendorAfter;if(!e||r<=0)return{restoredPackages:0,mode:"noop"};const a=sr(bt(Pe,"inventory_transfers_candies"),Ar("toVendorRowId","==",e)),s=await $t(a);if(s.empty)return{restoredPackages:0,mode:"noop"};const o=s.docs.map(f=>({id:f.id,...f.data()})).filter(f=>String(f.fromVendorRowId||"").trim()!=="").sort((f,A)=>{var p,x;const h=Number(((p=f.createdAt)==null?void 0:p.seconds)??0);return Number(((x=A.createdAt)==null?void 0:x.seconds)??0)-h});if(!o.length)return{restoredPackages:0,mode:"noop"};const l=[];let c=r;for(const f of o){if(c<=0)break;const A=la(f.packagesMoved||0);if(A<=0)continue;const h=Math.min(c,A);h<=0||(l.push({fromVendorRowId:String(f.fromVendorRowId),packs:h}),c-=h)}if(!l.length)return{restoredPackages:0,mode:"noop"};const u=er(Pe,"inventory_candies_sellers",e),d=l.map(f=>er(Pe,"inventory_candies_sellers",f.fromVendorRowId));return await Ks(Pe,async f=>{const A=await Promise.all(d.map(h=>f.get(h)));for(let h=0;h<l.length;h++){const m=d[h],p=A[h];if(!p.exists())continue;const x=p.data(),v=la(l[h].packs||0);if(v<=0)continue;const y=Math.max(1,la(x.unitsPerPackage||1)),b=v*y,w=Number(x.remainingPackages||0),j=Number(x.packages||0);f.update(m,{packages:Math.max(0,j+v),remainingPackages:Math.max(0,w+v),...y>0?{remainingUnits:Number(x.remainingUnits||0)+b}:{},transferDelta:Number(x.transferDelta||0)+v,updatedAt:xr.now()})}n&&f.delete(u)}),{restoredPackages:r-c,mode:"transfer"}}async function xF(t){const{orderId:e,productId:r}=t;let n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=sr(bt(Pe,"inventory_candies"),Ar("orderId","==",e),Ar("productId","==",r),In("createdAt","asc")),s=await $t(a);if(s.empty)return;const o=s.docs.map(l=>l.ref);await Ks(Pe,async l=>{const c=await Promise.all(o.map(u=>l.get(u)));for(let u=0;u<o.length&&n>0;u++){const d=c[u];if(!d.exists())continue;const f=d.data(),A=G2(f),h=n*A,p=la(f.remaining??0)+h,x=Math.floor(p/A);l.update(o[u],{remaining:p,remainingPackages:x,packages:x,updatedAt:xr.now()}),n=0}})}async function vF(t){const{orderId:e,productId:r}=t,n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=er(Pe,"candy_main_orders",e);await Ks(Pe,async s=>{const o=await s.get(a);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let u=!1;const d=c.map(f=>String((f==null?void 0:f.id)||"")!==String(r)?f:(u=!0,{...f,remainingPackages:la(f.remainingPackages)+n}));u&&s.update(a,{items:d,updatedAt:xr.now()})})}function yF(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),a=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),s=la((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,la((r==null?void 0:r.unitsPerPackage)||1));!n||!a||s<=0||e.push({batchId:n,masterOrderId:a,units:s,unitsPerPackage:o})}return e}function q2(t,e){const r=la(t),n=Math.max(1,la(e));return Math.floor(r/n)}async function fK(t){const e=String(t.productId||"");let r=la(t.packagesToAllocate);if(!e||r<=0)return{allocations:[]};const n=sr(bt(Pe,"inventory_candies"),Ar("productId","==",e)),a=await $t(n);if(a.empty)throw new Error("No hay inventario para este producto.");const o=a.docs.map(c=>({id:c.id,data:c.data()})).sort((c,u)=>{var m,p;const d=String(c.data.date||""),f=String(u.data.date||"");if(d!==f)return d<f?-1:1;const A=((m=c.data.createdAt)==null?void 0:m.seconds)??0,h=((p=u.data.createdAt)==null?void 0:p.seconds)??0;return A-h}).map(c=>er(Pe,"inventory_candies",c.id)),l=[];return await Ks(Pe,async c=>{const u=await Promise.all(o.map(y=>c.get(y))),d=[];let f=r;for(let y=0;y<o.length&&f>0;y++){const b=o[y],w=u[y];if(!w.exists())continue;const j=w.data(),I=G2(j),_=dK(j);if(_<=0)continue;const S=Math.floor(_/I);if(S<=0)continue;const E=Math.min(S,f),B=E*I,k=Math.max(0,_-B),P=Math.floor(k/I),O=String(j.orderId||"");if(!O)throw new Error("Lote sin orderId (orden maestra).");l.push({batchId:b.id,masterOrderId:O,units:B,unitsPerPackage:I}),d.push({ref:b,newRemUnits:k,newRemPacks:P}),f-=E}if(f>0)throw new Error(`Inventario insuficiente. Faltan ${f} paquetes.`);const A={};for(const y of l){const b=q2(y.units,y.unitsPerPackage);A[y.masterOrderId]=(A[y.masterOrderId]||0)+b}const h=new Map;for(let y=0;y<d.length;y++){const b=d[y];h.set(b.ref.id,b.newRemUnits)}const m={};for(let y=0;y<o.length;y++){const b=o[y],w=u[y];if(!w.exists())continue;const j=w.data(),I=String(j.orderId||""),_=String(j.productId||"");if(!I||!_)continue;const S=G2(j),E=h.get(b.id),B=typeof E=="number"?E:dK(j),k=Math.floor(B/S);m[I]||(m[I]={}),m[I][_]=(m[I][_]||0)+Math.max(0,k)}const p=Object.keys(A),x=p.map(y=>er(Pe,"candy_main_orders",y)),v=await Promise.all(x.map(y=>c.get(y)));for(let y=0;y<d.length;y++){const b=d[y];c.update(b.ref,{remaining:b.newRemUnits,remainingPackages:b.newRemPacks,packages:b.newRemPacks,updatedAt:xr.now()})}for(let y=0;y<x.length;y++){const b=v[y];if(!b.exists())throw new Error("Orden maestra no existe.");const w=b.data(),j=Array.isArray(w.items)?w.items:[],I=p[y];if(la(A[I]||0)<=0)continue;let S=!1;const E=j.map(B=>{var P;if(String((B==null?void 0:B.id)||"")!==e)return B;S=!0;const k=((P=m[I])==null?void 0:P[e])??la(B.remainingPackages||0);return{...B,remainingPackages:Math.max(0,la(k||0))}});S&&c.update(x[y],{items:E,updatedAt:xr.now()})}}),{allocations:l}}async function GQe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);if(!e)throw new Error("vendorInventoryId requerido");if(r<=0)return{restoredPackages:0,mode:"noop"};const n=er(Pe,"inventory_candies_sellers",e),a=await zs(n);if(!a.exists())throw new Error("No existe la orden del vendedor");const s=a.data(),o=String(s.productId||"");if(!o)throw new Error("La orden del vendedor no tiene productId");if(!yF(s.masterAllocations||s.allocations||s.allocationsByBatch).length){const u=String(s.orderId||"");if(!u)throw new Error("La orden del vendedor no tiene orderId");return await xF({orderId:u,productId:o,packagesToReturn:r}),await vF({orderId:u,productId:o,packagesToReturn:r}),{restoredPackages:r,mode:"legacy"}}let c=0;return await Ks(Pe,async u=>{const d=await u.get(n);if(!d.exists())throw new Error("No existe la orden del vendedor");const f=d.data(),A=String(f.productId||"");if(!A)throw new Error("Doc vendedor sin productId");let h=yF(f.masterAllocations||f.allocations||f.allocationsByBatch);if(!h.length)throw new Error("No hay masterAllocations guardadas en este doc (no se puede restaurar blindado).");const m=[];let p=r;for(let E=h.length-1;E>=0&&p>0;E--){const B=h[E],k=Math.max(1,la(B.unitsPerPackage||1)),P=q2(B.units,k);if(P<=0)continue;const O=Math.min(P,p),z=O*k;m.push({batchId:B.batchId,masterOrderId:B.masterOrderId,units:z,unitsPerPackage:k}),p-=O}const x=r-p;if(x<=0)return;c=x;const v=m.map(E=>er(Pe,"inventory_candies",E.batchId)),y={};for(const E of m){const B=q2(E.units,E.unitsPerPackage);B>0&&(y[E.masterOrderId]=(y[E.masterOrderId]||0)+B)}const w=Object.keys(y).map(E=>er(Pe,"candy_main_orders",E)),[j,I]=await Promise.all([Promise.all(v.map(E=>u.get(E))),Promise.all(w.map(E=>u.get(E)))]);for(let E=0;E<m.length;E++){const B=m[E],k=j[E];if(!k.exists())continue;const P=k.data(),O=Math.max(1,la(B.unitsPerPackage||P.unitsPerPackage||1)),z=la(B.units),ce=la(P.remaining??0)+z,ue=Math.floor(ce/O);u.update(v[E],{remaining:ce,remainingPackages:ue,packages:ue,updatedAt:xr.now()})}for(let E=0;E<w.length;E++){const B=I[E];if(!B.exists())continue;const k=w[E].id,P=la(y[k]||0);if(P<=0)continue;const O=B.data(),z=Array.isArray(O.items)?O.items:[];let oe=!1;const ce=z.map(ue=>String((ue==null?void 0:ue.id)||"")!==String(A)?ue:(oe=!0,{...ue,remainingPackages:la(ue.remainingPackages)+P}));oe&&u.update(w[E],{items:ce,updatedAt:xr.now()})}const _=new Map;for(const E of m){const B=`${E.batchId}__${E.masterOrderId}__${E.unitsPerPackage}`;_.set(B,(_.get(B)||0)+la(E.units))}const S=[];for(const E of h){const B=Math.max(1,la(E.unitsPerPackage||1)),k=`${E.batchId}__${E.masterOrderId}__${B}`,P=la(_.get(k)||0);if(P<=0){S.push(E);continue}const z=la(E.units)-P;z>0&&S.push({...E,units:z,unitsPerPackage:B}),_.delete(k)}u.update(n,{masterAllocations:S,updatedAt:xr.now()})}),{restoredPackages:c,mode:"blind"}}async function hK(t){if(!t)throw new Error("vendorInventoryId requerido");const e=er(Pe,"inventory_candies_sellers",t),r=await zs(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),a=String(n.productId||""),s=la(n.remainingPackages||n.packages||0),o=la(n.packages||n.remainingPackages||0),l=yF(n.masterAllocations||n.allocations||n.allocationsByBatch),c=await KQe({vendorInventoryId:t,packagesToReturn:s,deleteVendorAfter:!1});if(!l.length){const d=String(n.orderId||"");if(!d)throw new Error("La orden del vendedor no tiene orderId");if(!a)throw new Error("La orden del vendedor no tiene productId");if(c.restoredPackages>0){const f=Math.max(0,s-c.restoredPackages);return f<=0?(await Ks(Pe,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages,mode:"transfer"}):(await xF({orderId:d,productId:a,packagesToReturn:f}),await vF({orderId:d,productId:a,packagesToReturn:f}),await Ks(Pe,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages+f,mode:"transfer+legacy"})}return o<=0?(await Ks(Pe,async f=>{f.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await xF({orderId:d,productId:a,packagesToReturn:o}),await vF({orderId:d,productId:a,packagesToReturn:o}),await Ks(Pe,async f=>{f.delete(e)}),{restoredPackages:o,mode:"legacy"})}let u=0;return await Ks(Pe,async d=>{const f={};for(const y of l){const b=Math.max(1,la(y.unitsPerPackage||1)),w=la(y.units),j=q2(w,b);j>0&&(f[y.masterOrderId]=(f[y.masterOrderId]||0)+j)}const A=l.map(y=>er(Pe,"inventory_candies",y.batchId)),m=Object.keys(f).map(y=>er(Pe,"candy_main_orders",y)),[p,x]=await Promise.all([Promise.all(A.map(y=>d.get(y))),Promise.all(m.map(y=>d.get(y)))]);let v=0;for(let y=0;y<l.length;y++){const b=l[y],w=p[y];if(!w.exists())continue;const j=w.data(),I=Math.max(1,la(b.unitsPerPackage||j.unitsPerPackage||1)),_=la(b.units),E=la(j.remaining??0)+_,B=Math.floor(E/I);d.update(A[y],{remaining:E,remainingPackages:B,packages:B,updatedAt:xr.now()});const k=q2(_,I);k>0&&(v+=k)}for(let y=0;y<m.length;y++){const b=x[y];if(!b.exists())continue;const w=m[y].id,j=la(f[w]||0);if(j<=0)continue;const I=b.data(),_=Array.isArray(I.items)?I.items:[];let S=!1;const E=_.map(B=>String((B==null?void 0:B.id)||"")!==String(a)?B:(S=!0,{...B,remainingPackages:la(B.remainingPackages)+j}));S&&d.update(m[y],{items:E,updatedAt:xr.now()})}d.delete(e),u=v}),{restoredPackages:u,mode:"blind"}}const aB=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Mse=(t,e)=>`${t}__${e}`,qQe=t=>t?typeof t=="string"?t:t!=null&&t.seconds?new Date(t.seconds*1e3).toISOString().slice(0,10):t!=null&&t.toDate?t.toDate().toISOString().slice(0,10):"":"",zQe=t=>{const e=t.sellerId||"",r=qQe(t.date);return e&&r?Mse(e,r):t.orderId?t.orderId:t.id},AK=(t,e=!1)=>{if(!t)return null;const r=new Date(t);return Number.isNaN(r.getTime())?null:(e?r.setHours(23,59,59,999):r.setHours(0,0,0,0),r)},WQe=t=>{var e,r;if((e=t.createdAt)!=null&&e.toDate)return t.createdAt.toDate();if((r=t.createdAt)!=null&&r.seconds)return new Date(t.createdAt.seconds*1e3);if(t.date){const n=new Date(t.date);if(!Number.isNaN(n.getTime()))return n}return null},mK=t=>{const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"},bF=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},pK=(t,e)=>{const r=bF(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}},gK=(t,e)=>e?e==="RIVAS"?t.unitPriceRivas||0:e==="SAN_JORGE"?t.unitPriceSanJorge||0:t.unitPriceIsla||0:t.unitPriceIsla||0,xK=(t,e)=>e?e==="RIVAS"?t.grossProfitPerPackRivas||0:e==="SAN_JORGE"?t.grossProfitPerPackSanJorge||0:t.grossProfitPerPackIsla||0:t.grossProfitPerPackIsla||0,vK=(t,e)=>e?e==="RIVAS"?t.uApproxPerPackRivas||0:e==="SAN_JORGE"?t.uApproxPerPackSanJorge||0:t.uApproxPerPackIsla||0:t.uApproxPerPackIsla||0;function XQe({open:t,onClose:e,orders:r,rows:n,setRows:a,isAdmin:s,currentUserEmail:o,currentUserName:l,sellerCandyId:c,sellers:u,products:d,transferAgg:f,setTransferAgg:A,setTransferRowDeltas:h}){const[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState(""),[w,j]=g.useState(""),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState("0"),[P,O]=g.useState(""),[z,oe]=g.useState(!1),[ce,ue]=g.useState(""),[ge,ne]=g.useState(!1),[Oe,Ue]=g.useState(""),[F,H]=g.useState(()=>new Date().toISOString().slice(0,10)),[K,U]=g.useState(""),[W,X]=g.useState(()=>{const Fe=new Date;return new Date(Fe.getFullYear(),Fe.getMonth(),1).toISOString().slice(0,10)}),[D,V]=g.useState(()=>new Date().toISOString().slice(0,10)),Z=g.useMemo(()=>{const Fe={};return u.forEach(Ze=>{Fe[Ze.id]=Ze}),Fe},[u]),be=g.useMemo(()=>{const Fe={};return d.forEach(Ze=>{Fe[Ze.id]=Ze}),Fe},[d]),L=Oe&&Z[Oe]||null,Xe=g.useMemo(()=>r.map(Fe=>Fe.orderKey),[r]),re=g.useMemo(()=>{const Fe={};return r.forEach(Ze=>Fe[Ze.orderKey]=Ze),Fe},[r]),J=n,De=g.useMemo(()=>{const Fe={};return J.forEach(Ze=>{const Te=zQe(Ze),ee=new Set;Te&&ee.add(Te),Ze.orderId&&ee.add(String(Ze.orderId)),ee.add(Ze.id),ee.forEach(me=>{Fe[me]||(Fe[me]=[]),Fe[me].push(Ze)})}),Fe},[J]),ie=g.useMemo(()=>y?De[y]||[]:[],[De,y]),He=g.useMemo(()=>ie.filter(Fe=>{const Ze=Fe.remainingPackages??Fe.remaining??Fe.packages??0;return Number(Ze||0)>0}),[ie]),Ge=g.useMemo(()=>{const Fe=K.trim().toLowerCase();return Fe?He.filter(Ze=>`${Ze.category||""} ${Ze.productName||""}`.toLowerCase().trim().includes(Fe)):He},[He,K]),dt=g.useMemo(()=>w&&J.find(Fe=>Fe.id===w)||null,[J,w]),_t=g.useMemo(()=>{if(dt!=null&&dt.sellerId)return dt.sellerId;const Fe=re[y];return(Fe==null?void 0:Fe.sellerId)||""},[dt,re,y]),Bt=g.useMemo(()=>I?De[I]||[]:[],[De,I]),Ot=g.useMemo(()=>dt?Bt.filter(Fe=>Fe.productId===dt.productId):[],[Bt,dt]),jt=async()=>{try{p(!0);let Fe=[];if(!s&&c){const Ze=sr(bt(Pe,"inventory_transfers_candies"),Ar("fromSellerId","==",c),In("createdAt","desc")),Te=sr(bt(Pe,"inventory_transfers_candies"),Ar("toSellerId","==",c),In("createdAt","desc")),[ee,me]=await Promise.all([$t(Ze),$t(Te)]),Re=new Set,he=qe=>{qe.forEach(st=>{if(Re.has(st.id))return;Re.add(st.id);const yt=st.data();Fe.push({id:st.id,...yt})})};he(ee),he(me),Fe.sort((qe,st)=>{var je,we;const yt=((je=qe.createdAt)==null?void 0:je.seconds)||0;return(((we=st.createdAt)==null?void 0:we.seconds)||0)-yt})}else{const Ze=sr(bt(Pe,"inventory_transfers_candies"),In("createdAt","desc"));(await $t(Ze)).forEach(ee=>{const me=ee.data();Fe.push({id:ee.id,...me})})}v(Fe)}catch{ue(" Error cargando traslados.")}finally{p(!1)}};g.useEffect(()=>{t&&jt()},[t]);const Qt=g.useMemo(()=>{const Fe=AK(W),Ze=AK(D,!0);return x.filter(Te=>{const ee=WQe(Te);return ee?!(Fe&&ee<Fe||Ze&&ee>Ze):!0})},[x,W,D]);g.useEffect(()=>{U("")},[y]),g.useEffect(()=>{if(ge){if(!Oe){const Fe=re[y];Fe!=null&&Fe.sellerId&&Ue(Fe.sellerId)}F||H(new Date().toISOString().slice(0,10))}},[ge,Oe,F,re,y]);const Ft=()=>{b(""),j(""),_(""),E(""),k("0"),O(""),ne(!1),Ue(""),H(new Date().toISOString().slice(0,10))},$e=async()=>{if(!s){ue("No tienes permiso para hacer traslados.");return}ue("");const Fe=Number(B||0);if(!(Fe>0)){ue("La cantidad de paquetes debe ser mayor a 0.");return}if(!P.trim()){ue("Debes escribir el motivo de la movida.");return}if(!y||!w){ue("Selecciona el pedido origen y el producto.");return}const Ze=ge;if(!Ze&&!I){ue("Selecciona el pedido destino.");return}if(Ze){if(!Oe){ue("Selecciona el vendedor de la nueva orden.");return}if(!F){ue("Selecciona la fecha de la nueva orden.");return}}const Te=!Ze&&I&&re[I]||null;if(!Ze&&!Te){ue("Selecciona un pedido destino vlido.");return}const ee=Te?Z[Te.sellerId]||{id:Te.sellerId||"",name:Te.sellerName||"",email:Te.sellerEmail||"",branch:Te.branch,branchLabel:Te.branchLabel,commissionPercent:Te.vendorMarginPercent??Te.commissionPercent??0}:null,me=n.find(xe=>xe.id===w)||null,Re=!Ze&&S&&n.find(xe=>xe.id===S)||null;if(!me){ue("No se encontr la fila origen/destino.");return}if(!Ze&&Re&&w===S){ue("Origen y destino no pueden ser el mismo.");return}if(!Ze&&Re&&me.productId!==Re.productId){ue("El producto destino no coincide con el producto origen.");return}if(Number(me.remainingPackages||0)<Fe){ue("El origen no tiene suficientes paquetes disponibles.");return}const he=Ze?L:null;if(Ze&&!he){ue("Selecciona un vendedor destino vlido.");return}const qe=be[me.productId]||null,st=Ze?mK((he==null?void 0:he.branch)||(he==null?void 0:he.branchLabel)):void 0,yt=!Ze&&!S&&!!Te,pe=Ze||yt;let je=null,we=null,Ye="";if(Ze&&he){const xe=bF(he.commissionPercent??0),Se=st,xt=Number((qe==null?void 0:qe.unitsPerPackage)??me.unitsPerPackage??0),Pt=xt>0?xt*Fe:0;qe?gK(qe,Se):Number(me.unitPriceRivas||me.unitPriceIsla||0);const Ut=(qe?xK(qe,Se):Number(me.grossProfit||0)/Math.max(1,me.packages||1))*Fe,Ht=qe?Number(qe.logisticAllocatedPerPack||0)*Fe:Number(me.logisticAllocated||0),Ce=(qe?vK(qe,Se):Number(me.uAproximada||0)/Math.max(1,me.packages||1))*Fe,Ae=pK(Ut,xe),Qe=Number(Ut||0)-Number(Ht||0)-Number(Ae.uVendor||0),fe=((qe==null?void 0:qe.unitPriceRivas)||me.unitPriceRivas||0)*Fe,te=((qe==null?void 0:qe.unitPriceSanJorge)||me.unitPriceSanJorge||0)*Fe,_e=((qe==null?void 0:qe.unitPriceIsla)||me.unitPriceIsla||0)*Fe;Ye=Mse(he.id,F),je={sellerId:he.id,sellerName:he.name,sellerEmail:he.email||"",branch:Se||"",branchLabel:he.branchLabel||"",productId:me.productId,productName:me.productName,category:me.category,orderId:Ye,date:F,packages:Fe,unitsPerPackage:xt,totalUnits:Pt,remainingPackages:Fe,remainingUnits:Pt,totalRivas:fe,totalSanJorge:te,totalIsla:_e,unitPriceRivas:(qe==null?void 0:qe.unitPriceRivas)||me.unitPriceRivas||0,unitPriceSanJorge:(qe==null?void 0:qe.unitPriceSanJorge)||me.unitPriceSanJorge||0,unitPriceIsla:(qe==null?void 0:qe.unitPriceIsla)||me.unitPriceIsla||0,grossProfit:Ut,logisticAllocated:Ht,vendorMarginPercent:Ae.vendorMarginPercent,uVendor:Ae.uVendor,uInvestor:Ae.uInvestor,uAproximada:Ce,uNeta:Qe,providerPrice:me.providerPrice,transferDelta:0}}if(yt&&Te){const xe=bF((ee==null?void 0:ee.commissionPercent)??Te.vendorMarginPercent??0),Se=mK((ee==null?void 0:ee.branch)||(ee==null?void 0:ee.branchLabel)||Te.branch||Te.branchLabel),xt=Number((qe==null?void 0:qe.unitsPerPackage)??me.unitsPerPackage??0),Pt=xt>0?xt*Fe:0;qe?gK(qe,Se):Number(me.unitPriceRivas||me.unitPriceIsla||0);const Ut=(qe?xK(qe,Se):Number(me.grossProfit||0)/Math.max(1,me.packages||1))*Fe,Ht=qe?Number(qe.logisticAllocatedPerPack||0)*Fe:Number(me.logisticAllocated||0),Ce=(qe?vK(qe,Se):Number(me.uAproximada||0)/Math.max(1,me.packages||1))*Fe,Ae=pK(Ut,xe),Qe=Number(Ut||0)-Number(Ht||0)-Number(Ae.uVendor||0),fe=((qe==null?void 0:qe.unitPriceRivas)||me.unitPriceRivas||0)*Fe,te=((qe==null?void 0:qe.unitPriceSanJorge)||me.unitPriceSanJorge||0)*Fe,_e=((qe==null?void 0:qe.unitPriceIsla)||me.unitPriceIsla||0)*Fe;we={sellerId:Te.sellerId,sellerName:(ee==null?void 0:ee.name)||Te.sellerName||"",sellerEmail:(ee==null?void 0:ee.email)||Te.sellerEmail||"",branch:Se||Te.branch||"",branchLabel:(ee==null?void 0:ee.branchLabel)||Te.branchLabel||"",productId:me.productId,productName:me.productName,category:me.category,orderId:Te.orderKey||I,date:Te.date||new Date().toISOString().slice(0,10),packages:Fe,unitsPerPackage:xt,totalUnits:Pt,remainingPackages:Fe,remainingUnits:Pt,totalRivas:fe,totalSanJorge:te,totalIsla:_e,unitPriceRivas:(qe==null?void 0:qe.unitPriceRivas)||me.unitPriceRivas||0,unitPriceSanJorge:(qe==null?void 0:qe.unitPriceSanJorge)||me.unitPriceSanJorge||0,unitPriceIsla:(qe==null?void 0:qe.unitPriceIsla)||me.unitPriceIsla||0,grossProfit:Ut,logisticAllocated:Ht,vendorMarginPercent:Ae.vendorMarginPercent,uVendor:Ae.uVendor,uInvestor:Ae.uInvestor,uAproximada:Ce,uNeta:Qe,providerPrice:me.providerPrice,transferDelta:0}}try{oe(!0);const xe=er(Pe,"inventory_candies_sellers",me.id),Se=Ze||yt?er(bt(Pe,"inventory_candies_sellers")):er(Pe,"inventory_candies_sellers",Re.id),xt=xr.now(),Pt=new Date().toISOString().slice(0,10);let It=null;await Ks(Pe,async Ut=>{const Ht=await Ut.get(xe);if(!Ht.exists())throw new Error("Orden origen no existe.");const Le=Ht.data(),Ce=Number(Le.remainingPackages||0);if(Ce<Fe)throw new Error("Origen no tiene suficientes paquetes.");let Ae=null;if(!Ze&&!yt){const Q=await Ut.get(Se);if(!Q.exists())throw new Error("Orden destino no existe.");Ae=Q.data()}const Qe=Number(Le.unitsPerPackage||me.unitsPerPackage||0),fe=Qe>0?Fe*Qe:0,te=Number(Le.transferDelta||0);Ut.update(xe,{packages:Math.max(0,Number(Le.packages||0)-Fe),remainingPackages:Ce-Fe,...Qe>0?{remainingUnits:Number(Le.remainingUnits||0)-fe}:{},updatedAt:xt,transferDelta:te-Fe});let _e=null;if(Ze){const Q={...je,createdAt:xt,updatedAt:xt,remainingPackages:Fe,remainingUnits:Number((je==null?void 0:je.unitsPerPackage)||0)>0?Fe*Number((je==null?void 0:je.unitsPerPackage)||0):je==null?void 0:je.remainingUnits,transferDelta:0};Ut.set(Se,Q),_e=Q,It={id:Se.id,...Q}}else if(yt&&we){const Q={...we,createdAt:xt,updatedAt:xt,remainingPackages:Fe,remainingUnits:Number(we.unitsPerPackage||0)>0?Fe*Number(we.unitsPerPackage||0):we.remainingUnits,transferDelta:0};Ut.set(Se,Q),_e=Q,It={id:Se.id,...Q}}else{const Q=Ae,G=Number(Q.unitsPerPackage||me.unitsPerPackage||0),se=G>0?Fe*G:0,Ne=Number(Q.transferDelta||0);Ut.update(Se,{packages:Math.max(0,Number(Q.packages||0)+Fe),remainingPackages:Number(Q.remainingPackages||0)+Fe,...G>0?{remainingUnits:Number(Q.remainingUnits||0)+se}:{},updatedAt:xt,transferDelta:Ne+Fe}),_e={...Q,remainingPackages:Number(Q.remainingPackages||0)+Fe,remainingUnits:G>0?Number(Q.remainingUnits||0)+se:Q.remainingUnits,sellerId:Q.sellerId,sellerName:Q.sellerName,orderId:Q.orderId||(Re==null?void 0:Re.id)||"",transferDelta:Ne+Fe}}const R=er(bt(Pe,"inventory_transfers_candies"));Ut.set(R,{createdAt:xt,date:Pt,createdByEmail:(o||"").trim(),createdByName:String(l||"").trim(),productId:String(Le.productId||""),productName:String(Le.productName||""),packagesMoved:Fe,providerPrice:Number(Le.providerPrice||0),unitPriceRivas:Number(Le.unitPriceRivas||0),unitPriceIsla:Number(Le.unitPriceIsla||0),fromSellerId:String(Le.sellerId||""),fromSellerName:String(Le.sellerName||""),fromOrderKey:String(Le.orderId||me.id||""),fromOrderLabel:String(Le.orderId||me.id||""),toSellerId:Ze?(he==null?void 0:he.id)||"":String((_e==null?void 0:_e.sellerId)||""),toSellerName:Ze?(he==null?void 0:he.name)||"":String((_e==null?void 0:_e.sellerName)||""),toOrderKey:Ze?Ye:String((_e==null?void 0:_e.orderId)||I||""),toOrderLabel:Ze?Ye:String((_e==null?void 0:_e.orderId)||I||""),fromVendorRowId:me.id,toVendorRowId:Ze||yt?Se.id:Re.id,comment:P.trim(),destRowWasNew:pe})}),a(Ut=>{const Ht=Ut.reduce((Le,Ce)=>{if(Ce.id===me.id){const Ae=Number(Ce.unitsPerPackage||0),Qe=Ae>0?Fe*Ae:0;return Le.push({...Ce,packages:Math.max(0,Number(Ce.packages||0)-Fe),remainingPackages:Number(Ce.remainingPackages||0)-Fe,remainingUnits:Ae>0?Number(Ce.remainingUnits||0)-Qe:Ce.remainingUnits,transferDelta:Number(Ce.transferDelta||0)-Fe}),Le}if(!Ze&&Re&&Ce.id===Re.id){const Ae=Number(Ce.unitsPerPackage||0),Qe=Ae>0?Fe*Ae:0;return Le.push({...Ce,packages:Math.max(0,Number(Ce.packages||0)+Fe),remainingPackages:Number(Ce.remainingPackages||0)+Fe,remainingUnits:Ae>0?Number(Ce.remainingUnits||0)+Qe:Ce.remainingUnits,transferDelta:Number(Ce.transferDelta||0)+Fe}),Le}return Le.push(Ce),Le},[]);return It?[...Ht,It]:Ht}),await jt(),A(Ut=>{const Ht={...Ut},Le=y,Ce=Ze?Ye:I;return Le&&(Ht[Le]=Ht[Le]||{out:0,in:0},Ht[Le].out+=Fe),Ce&&(Ht[Ce]=Ht[Ce]||{out:0,in:0},Ht[Ce].in+=Fe),Ht}),h(Ut=>{const Ht={...Ut};if(me.id&&(Ht[me.id]=(Ht[me.id]||0)-Fe),!pe){const Le=yt||Ze?It==null?void 0:It.id:Re==null?void 0:Re.id;Le&&(Ht[Le]=(Ht[Le]||0)+Fe)}return Ht}),Ft(),ue(" Traslado realizado.")}catch(xe){ue((xe==null?void 0:xe.message)||" Error realizando el traslado.")}finally{oe(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[z&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{e(),Ft()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:y,onChange:Fe=>{b(Fe.target.value),j(""),_(""),E(""),k("0")},disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xe.map(Fe=>{const Ze=re[Fe];return i.jsxs("option",{value:Fe,children:["Vendedor: ",(Ze==null?void 0:Ze.sellerName)||"","  Existencias:"," ",(Ze==null?void 0:Ze.totalRemainingPackages)||"0"," Paquetes - Fecha Orden:"," ",(Ze==null?void 0:Ze.date)||""]},Fe)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsx("input",{type:"text",className:"mt-1 mb-2 w-full border p-2 rounded text-sm",placeholder:"Buscar producto...",value:K,onChange:Fe=>U(Fe.target.value),disabled:!s||!y}),i.jsxs("select",{className:"w-full border p-2 rounded",value:w,onChange:Fe=>{j(Fe.target.value),_(""),E(""),k("0")},disabled:!s||!y,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ge.map(Fe=>i.jsxs("option",{value:Fe.id,children:[Fe.productName,"  Existencias:"," ",Number(Fe.remainingPackages??Fe.packages??0)," Paquetes - Precio Costo: $",Fe.providerPrice]},Fe.id))]})]}),!ge&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:I,onChange:Fe=>{_(Fe.target.value),E("")},disabled:!s||!w,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xe.filter(Fe=>Fe!==y).map(Fe=>{const Ze=re[Fe];return i.jsxs("option",{value:Fe,children:["Vendedor: ",(Ze==null?void 0:Ze.sellerName)||"","  Existencias:"," ",(Ze==null?void 0:Ze.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Ze==null?void 0:Ze.date)||""]},Fe)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:S,onChange:Fe=>E(Fe.target.value),disabled:!s||!I||!dt,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ot.map(Fe=>i.jsxs("option",{value:Fe.id,children:["Tipo: ",Fe.category," - ",Fe.productName,"  Existencias:"," ",Number(Fe.remainingPackages??Fe.packages??0),"Paquetes - Precio Costo: $",Fe.providerPrice]},Fe.id))]}),I&&dt&&Ot.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. Si dejas este campo vaco se crear automticamente al moverlo."}),I&&i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este campo es opcional; salo solo si el pedido ya tiene el producto y quieres sumar a esa fila."})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:ge,onChange:Fe=>{const Ze=Fe.target.checked;ne(Ze),Ze&&(_(""),E(""))},disabled:!s}),i.jsx("span",{className:"text-sm font-semibold",children:"Crear nueva orden destino (independiente)"})]}),ge&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor destino (nueva orden)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Oe,onChange:Fe=>Ue(Fe.target.value),disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),u.map(Fe=>i.jsxs("option",{value:Fe.id,disabled:Fe.id===_t,children:[Fe.name,Fe.id===_t?" (origen)":""]},Fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de la nueva orden"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:F,onChange:Fe=>H(Fe.target.value),disabled:!s}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esta orden ser independiente. Asegrate de usar una fecha que no tenga otro pedido activo para el mismo vendedor."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:B,onChange:Fe=>k(Fe.target.value),disabled:!s||!w||!ge&&!I})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:P,onChange:Fe=>O(Fe.target.value),disabled:!s,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:Ft,disabled:!s||z,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:$e,disabled:!s||z||!w||!ge&&!I||Number(B||0)<=0||!P.trim(),children:"Hacer traslado"})]}),ce&&i.jsx("div",{className:"text-sm text-red-600 mt-2",children:ce})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:W,onChange:Fe=>X(Fe.target.value)}),i.jsx("span",{className:"text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:D,onChange:Fe=>V(Fe.target.value)}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:jt,disabled:m,type:"button",children:m?"Cargando...":"Recargar"})]})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Desde vendedor"}),i.jsx("th",{className:"p-2 border",children:"Desde orden"}),i.jsx("th",{className:"p-2 border",children:"Hacia vendedor"}),i.jsx("th",{className:"p-2 border",children:"Hacia orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Qt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin traslados"})}):Qt.map(Fe=>{var me,Re;const Ze=((Re=(me=Fe.createdAt)==null?void 0:me.toDate)==null?void 0:Re.call(me))||(Fe.createdAt?new Date(Fe.createdAt.seconds*1e3):null),Te=Ze?`${Ze.toISOString().slice(0,10)} ${Ze.toISOString().slice(11,19)}`:Fe.date||"",ee=(Fe.createdByName||"").trim()||(Fe.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Te}),i.jsx("td",{className:"p-2 border",children:ee}),i.jsx("td",{className:"p-2 border text-left",children:Fe.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(Fe.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:aB(Fe.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:aB(Fe.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:aB(Fe.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:Fe.fromSellerName||""}),i.jsx("td",{className:"p-2 border",children:Fe.fromOrderLabel||Fe.fromOrderKey||""}),i.jsx("td",{className:"p-2 border",children:Fe.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:Fe.toOrderLabel||Fe.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:Fe.comment||""})]},Fe.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}):null}const ni=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function yK(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const bi=t=>Math.max(0,Math.floor(Number(t||0))),rf=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},sd=(t,e)=>{const r=rf(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}};function YQe({role:t="",sellerCandyId:e="",currentUserEmail:r,roles:n}){const{refreshKey:a,refresh:s}=Dc(),o=n&&n.length?n:t,l=!o||Sn(o,"admin"),c=Sn(o,"vendedor_dulces"),u=(r||"").trim().toLowerCase(),d=!l&&c,[f,A]=g.useState(!0),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState([]),[b,w]=g.useState({}),[j,I]=g.useState([]),_=g.useRef({});g.useEffect(()=>{const de={};j.forEach(tt=>{de[tt.id]=tt}),_.current=de},[j]);const[S,E]=g.useState(!1),[B,k]=g.useState(null),[P,O]=g.useState(""),[z,oe]=g.useState(""),[ce,ue]=g.useState(""),[ge,ne]=g.useState(""),[Oe,Ue]=g.useState("0"),[F,H]=g.useState([]),[K,U]=g.useState(""),[W,X]=g.useState(""),[D,V]=g.useState(!1),[Z,be]=g.useState(!1),[L,Xe]=g.useState(!1),re=20,[J,De]=g.useState(1),ie=20,[He,Ge]=g.useState(1),[dt,_t]=g.useState({}),[Bt,Ot]=g.useState(!1),[jt,Qt]=g.useState({}),[Ft,$e]=g.useState({}),[Fe,Ze]=g.useState(!1),[Te,ee]=g.useState({}),[me,Re]=g.useState({}),he=g.useMemo(()=>p.find(de=>de.id===P)||null,[P,p]);he==null||he.branch,g.useEffect(()=>{!S||!P||!F.length||H(de=>de.map(tt=>{const at=v.find(ur=>ur.id===tt.productId)||null,ct=p.find(ur=>ur.id===P)||null,ye=ct==null?void 0:ct.branch,ft=bi(tt.packages),St=at?Se(at,ye):Number(tt.pricePerPackage||0),vt=(at?xt(at,ye):0)*ft,Et=at?at.logisticAllocatedPerPack*ft:Number(tt.logisticAllocated||0),Mt=(at?Pt(at,ye):0)*ft,Xt=It(P),ar=tt.vendorMarginPercent!=null&&String(tt.vendorMarginPercent).trim()!==""?rf(tt.vendorMarginPercent):Xt,vr=sd(vt,ar);return{...tt,pricePerPackage:St,totalExpected:St*ft,grossProfit:vt,logisticAllocated:Et,vendorMarginPercent:vr.vendorMarginPercent,uAproximada:Mt,uVendor:vr.uVendor,uInvestor:vr.uInvestor,totalRivas:((at==null?void 0:at.unitPriceRivas)||tt.unitPriceRivas||0)*ft,totalSanJorge:((at==null?void 0:at.unitPriceSanJorge)||tt.unitPriceSanJorge||0)*ft,totalIsla:((at==null?void 0:at.unitPriceIsla)||tt.unitPriceIsla||0)*ft,unitPriceRivas:(at==null?void 0:at.unitPriceRivas)||tt.unitPriceRivas||0,unitPriceSanJorge:(at==null?void 0:at.unitPriceSanJorge)||tt.unitPriceSanJorge||0,unitPriceIsla:(at==null?void 0:at.unitPriceIsla)||tt.unitPriceIsla||0}}))},[S,P,F.length,v,p]);const qe=g.useMemo(()=>!c||!u?null:p.find(de=>(de.email||"").trim().toLowerCase()===u)||null,[c,u,p]);g.useMemo(()=>new Set(F.map(de=>de.productId)),[F]);const st=g.useMemo(()=>v.filter(de=>(b[de.id]??0)>1).sort((de,tt)=>`${de.category} ${de.name}`.localeCompare(`${tt.category} ${tt.name}`)),[v,b]),yt=g.useMemo(()=>{const de=K.trim().toLowerCase();return de?st.filter(tt=>`${tt.category??""} ${tt.name??""}`.toLowerCase().includes(de)):st},[st,K]),pe=g.useMemo(()=>v.find(de=>de.id===ge)||null,[ge,v]),je=g.useMemo(()=>c&&qe?j.filter(de=>de.sellerId===qe.id):j,[j,c,qe]),we=async()=>{try{const de=bt(Pe,"inventory_transfers_candies"),tt=(vt,Et,qt,Mt)=>{Et&&(vt[Et]=vt[Et]||{out:0,in:0},vt[Et][qt]+=Mt)},at=(vt,Et,qt)=>{const Mt=String(Et||"");Mt&&(vt[Mt]=(vt[Mt]||0)+qt)},ct={},ye={},ft=_.current,St=vt=>{var ur,Dt;if(vt.destRowWasNew!=null)return!!vt.destRowWasNew;const Et=String(vt.toVendorRowId||"");if(!Et)return!1;const qt=ft[Et];if(!qt)return!1;const Mt=Number(((ur=qt.createdAt)==null?void 0:ur.seconds)??0),Xt=Number(((Dt=vt.createdAt)==null?void 0:Dt.seconds)??0),ar=Mt>0&&Xt>0&&Math.abs(Mt-Xt)<=1,vr=Math.max(0,Number(qt.packages||0))===Math.max(0,Number(vt.packagesMoved||0));return ar&&vr},wt=vt=>{const Et=vt.data(),qt=Number(Et.packagesMoved||0);qt>0&&(tt(ct,String(Et.fromOrderKey||""),"out",qt),tt(ct,String(Et.toOrderKey||""),"in",qt),at(ye,Et.fromVendorRowId,-qt),St(Et)||at(ye,Et.toVendorRowId,qt))};if(!c)(await $t(de)).forEach(wt);else{const vt=sr(de,Ar("fromSellerId","==",e)),Et=sr(de,Ar("toSellerId","==",e)),[qt,Mt]=await Promise.all([$t(vt),$t(Et)]),Xt=new Set,ar=vr=>{vr.forEach(ur=>{Xt.has(ur.id)||(Xt.add(ur.id),wt(ur))})};ar(qt.docs),ar(Mt.docs)}Qt(ct),$e(ye)}catch(de){console.error(de),Qt({}),$e({})}};g.useEffect(()=>{(async()=>{A(!0),m("");try{const de=await $t(sr(bt(Pe,"sellers_candies"),In("name","asc"))),tt=[];de.forEach(ur=>{const Dt=ur.data(),Yr=Dt.branch||Dt.branchLabel||Dt.route||Dt.sucursal||Dt.location||"";tt.push({id:ur.id,name:Dt.name||"",email:Dt.email||"",commissionPercent:Number(Dt.commissionPercent||0),branch:yK(Yr),branchLabel:Yr})}),x(tt);const at=await $t(sr(bt(Pe,"candy_main_orders"),In("createdAt","desc"))),ct={},ye={},ft=(ur,Dt)=>`${ur}#${String(Dt).padStart(10,"0")}`;at.forEach(ur=>{var pr;const Dt=ur.data(),Yr=Number(((pr=Dt.createdAt)==null?void 0:pr.seconds)??0),Vr=String(Dt.date||""),Sr=Array.isArray(Dt.items)?Dt.items:[];for(const jr of Sr){const Bn=String(jr.id||jr.productId||"");if(!Bn)continue;const wn=bi(jr.remainingPackages??jr.remainingPacks??0);wn>0&&(ct[Bn]=(ct[Bn]||0)+wn);const xn=Math.max(1,bi(jr.packages??0)),ua=Number(jr.providerPrice??jr.provider_price??jr.priceProvider??jr.costProvider??0),ga=Number(jr.unitPriceRivas||0),Yi=Number(jr.unitPriceSanJorge||0),Ji=Number(jr.unitPriceIsla||0),Fl=Number(jr.gainRivas??jr.grossProfitRivas??jr.grossProfit??0),xa=Number(jr.gainSanJorge??jr.grossProfitSanJorge??jr.grossProfit??0),Qn=Number(jr.gainIsla??jr.grossProfitIsla??jr.grossProfit??0),du=Number(jr.logisticAllocated??jr.prorrateo??jr.prorrateoLogistico??jr.gastos??0),Zi=Number(jr.uAproximada??jr.uApprox??jr.netProfit??jr.vendorProfit??jr.gainVendor??0)/xn,Rc=du/xn,Mc={id:Bn,name:String(jr.name||jr.productName||""),category:String(jr.category||""),unitsPerPackage:bi(jr.unitsPerPackage??0),providerPrice:ua,unitPriceRivas:ga,unitPriceSanJorge:Yi,unitPriceIsla:Ji,grossProfitPerPackRivas:Fl/xn,grossProfitPerPackSanJorge:xa/xn,grossProfitPerPackIsla:Qn/xn,uApproxPerPackRivas:Zi,uApproxPerPackSanJorge:Zi,uApproxPerPackIsla:Zi,logisticAllocatedPerPack:Rc,masterOrderId:ur.id,key:ft(Vr,Yr)},dc=ye[Bn];(!dc||Mc.key>dc.key)&&(ye[Bn]=Mc)}});const St=await $t(sr(bt(Pe,"inventory_candies"),In("createdAt","desc"))),wt=ur=>{const Dt=Math.max(1,bi(ur.unitsPerPackage||1)),Yr=Number(ur.remaining??0);if(Number.isFinite(Yr)&&Yr>0)return Math.floor(Yr/Dt);const Vr=Number(ur.remainingPackages??0);return Number.isFinite(Vr)&&Vr>0?Math.floor(Vr):0},vt={};St.forEach(ur=>{const Dt=ur.data(),Yr=String(Dt.productId||"");if(!Yr)return;const Vr=wt(Dt);Vr<=0||(vt[Yr]=(vt[Yr]||0)+Vr)});const Et={};(Object.keys(vt).length?Object.keys(vt):Object.keys(ct)).forEach(ur=>{const Dt=Object.keys(vt).length?vt[ur]:ct[ur];Et[ur]=Math.max(0,bi(Dt))}),w(Et);const Mt=await $t(c?sr(bt(Pe,"inventory_candies_sellers"),Ar("sellerId","==",e),In("createdAt","desc")):sr(bt(Pe,"inventory_candies_sellers"),In("createdAt","desc"))),Xt=Object.keys(ye).map(ur=>{const Dt=ye[ur];return{id:Dt.id,name:Dt.name,category:Dt.category,unitsPerPackage:Dt.unitsPerPackage,providerPrice:Dt.providerPrice,unitPriceRivas:Dt.unitPriceRivas,unitPriceSanJorge:Dt.unitPriceSanJorge,unitPriceIsla:Dt.unitPriceIsla,grossProfitPerPackRivas:Dt.grossProfitPerPackRivas,grossProfitPerPackSanJorge:Dt.grossProfitPerPackSanJorge,grossProfitPerPackIsla:Dt.grossProfitPerPackIsla,uApproxPerPackRivas:Dt.uApproxPerPackRivas,uApproxPerPackSanJorge:Dt.uApproxPerPackSanJorge,uApproxPerPackIsla:Dt.uApproxPerPackIsla,logisticAllocatedPerPack:Dt.logisticAllocatedPerPack,existingPacks:Et[Dt.id]??0,masterOrderId:Dt.masterOrderId}}).sort((ur,Dt)=>`${ur.category} ${ur.name}`.localeCompare(`${Dt.category} ${Dt.name}`));y(Xt);const ar=[];Mt.forEach(ur=>{const Dt=ur.data(),Yr=Object.prototype.hasOwnProperty.call(Dt,"transferDelta"),Vr=tt.find(ua=>ua.id===Dt.sellerId)||null,Sr=rf(Dt.vendorMarginPercent??Dt.vendorMargin??Dt.commissionPercent??(Vr==null?void 0:Vr.commissionPercent)??0),pr=Number(Dt.uAproximada??Dt.uApprox??Dt.netProfit??Dt.uAprox??Dt.uApproxTotal??0),jr=Dt.uVendor??Dt.vendorProfit??Dt.gainVendor??0,Bn=Dt.uVendor!=null,wn=sd(Number(Dt.grossProfit??Dt.gainVendor??0),Sr),xn=Bn?{uAproximada:Number(pr||0),vendorMarginPercent:Sr,uVendor:Number(jr||0),uInvestor:Number(pr||0)-Number(jr||0)}:{uAproximada:Number(pr||0),vendorMarginPercent:wn.vendorMarginPercent,uVendor:wn.uVendor,uInvestor:wn.uInvestor};ar.push({id:ur.id,sellerId:Dt.sellerId,sellerName:Dt.sellerName||"",orderName:Dt.orderName||"",productId:Dt.productId,productName:Dt.productName||"",category:Dt.category||"",orderId:Dt.orderId||null,packages:Number(Dt.packages||0),unitsPerPackage:Number(Dt.unitsPerPackage||0),totalUnits:Number(Dt.totalUnits||0),remainingPackages:Number(Dt.remainingPackages||0),remainingUnits:Number(Dt.remainingUnits||0),totalRivas:Number(Dt.totalRivas||0),totalSanJorge:Number(Dt.totalSanJorge||0),totalIsla:Number(Dt.totalIsla||0),unitPriceRivas:Number(Dt.unitPriceRivas||0),unitPriceSanJorge:Number(Dt.unitPriceSanJorge||0),unitPriceIsla:Number(Dt.unitPriceIsla||0),grossProfit:Number(Dt.grossProfit??Dt.gainVendor??0),logisticAllocated:Number(Dt.logisticAllocated??Dt.gastos??Dt.gasto??0),vendorMarginPercent:xn.vendorMarginPercent,uAproximada:xn.uAproximada,uVendor:xn.uVendor,uInvestor:xn.uInvestor,vendorProfit:Number(Dt.vendorProfit??xn.uVendor??0),transferDelta:Yr&&typeof Dt.transferDelta=="number"?Number(Dt.transferDelta||0):void 0,subtotal:Number(Dt.subtotal||0),providerPrice:Number(Dt.providerPrice||0),date:Dt.date||"",createdAt:Dt.createdAt||xr.now()})});const vr={};ar.forEach(ur=>{vr[ur.id]=ur}),_.current=vr,I(ar),await we()}catch(de){console.error(de),m(" Error cargando datos de vendedores / pedidos.")}finally{A(!1)}})()},[a,t,e]);const Ye=(de,tt)=>`${de}__${tt}`,xe=de=>de.orderId||Ye(de.sellerId,de.date),Se=(de,tt)=>tt?tt==="RIVAS"?de.unitPriceRivas||0:tt==="SAN_JORGE"?de.unitPriceSanJorge||0:de.unitPriceIsla||0:de.unitPriceIsla||de.unitPriceRivas||de.unitPriceSanJorge||0,xt=(de,tt)=>tt?tt==="RIVAS"?de.grossProfitPerPackRivas||0:tt==="SAN_JORGE"?de.grossProfitPerPackSanJorge||0:de.grossProfitPerPackIsla||0:de.grossProfitPerPackIsla||de.grossProfitPerPackRivas||de.grossProfitPerPackSanJorge||0,Pt=(de,tt)=>tt?tt==="RIVAS"?de.uApproxPerPackRivas||0:tt==="SAN_JORGE"?de.uApproxPerPackSanJorge||0:de.uApproxPerPackIsla||0:de.uApproxPerPackIsla||de.uApproxPerPackRivas||de.uApproxPerPackSanJorge||0,It=de=>{const tt=p.find(at=>at.id===de)||null;return rf((tt==null?void 0:tt.commissionPercent)??0)},Ut=de=>{const tt=Ft[de.id];return typeof tt=="number"&&Number.isFinite(tt)?tt:typeof de.transferDelta=="number"?Number(de.transferDelta||0):0},Ht=de=>{const tt=Math.max(0,Number(de.packages||0)),at=Ut(de);return Math.max(0,tt+at)},Le=de=>{const tt=Math.max(1,bi(de.unitsPerPackage||1)),at=Number(de.remaining??0);if(Number.isFinite(at)&&at>0)return Math.floor(at/tt);const ct=Number(de.remainingPackages??0);return Number.isFinite(ct)&&ct>0?Math.floor(ct):0},Ce=async(de,tt)=>{const at=String(de||"").trim();if(!at)return{byId:0,byName:0};const ct=await $t(sr(bt(Pe,"inventory_candies"),Ar("productId","==",at)));let ye=0;ct.forEach(vt=>{ye+=Le(vt.data())});const ft=Math.max(0,ye);let St=0;const wt=String(tt||"").trim();return ft===0&&wt&&((await $t(sr(bt(Pe,"inventory_candies"),Ar("productName","==",wt)))).forEach(Et=>{St+=Le(Et.data())}),St=Math.max(0,St)),{byId:ft,byName:St}},Ae=g.useMemo(()=>{const de=new Map;for(const at of je){const ct=xe(at),ye=de.get(ct)||{orderKey:ct,sellerId:at.sellerId,sellerName:at.sellerName,orderName:at.orderName||"",date:at.date,totalPackages:0,totalActivePackages:0,totalRemainingPackages:0,totalExpected:0,totalExpectedActive:0,grossProfit:0,grossProfitActive:0,vendorProfit:0,vendorProfitActive:0,gastos:0,gastosActive:0,transferredOut:0,transferredIn:0},ft=Math.max(0,Number(at.packages||0)),St=Math.max(0,Number(at.remainingPackages||0)),wt=Ht(at),vt=ft>0?wt/ft:1;ye.totalPackages+=ft,ye.totalRemainingPackages+=St,ye.totalActivePackages+=wt;const Et=p.find(wn=>wn.id===at.sellerId)||null,qt=Et==null?void 0:Et.branch,Mt=v.find(wn=>wn.id===String(at.productId))||null,Xt=Mt?Se(Mt,qt):Number(qt==="RIVAS"?at.unitPriceRivas||0:qt==="SAN_JORGE"?at.unitPriceSanJorge||0:at.unitPriceIsla||0),ar=Xt*ft,vr=Xt*wt;ye.totalExpected+=Number(ar||0),ye.totalExpectedActive+=Number(vr||0);const ur=Mt?xt(Mt,qt):ft>0?Number(at.grossProfit||0)/ft:0,Dt=ur*ft,Yr=ur*wt;ye.grossProfit+=Number(Dt||0),ye.grossProfitActive+=Number(Yr||0);const Vr=typeof(Mt==null?void 0:Mt.logisticAllocatedPerPack)=="number"?Number(Mt.logisticAllocatedPerPack||0):(()=>{const wn=Number(at.logisticAllocated??at.gastos??at.gasto??0),xn=ft>0?ft:wt||1;return xn>0?wn/xn:0})(),Sr=Vr*ft,pr=Vr*wt;ye.gastos=(ye.gastos||0)+Number(Sr||0),ye.gastosActive=(ye.gastosActive||0)+Number(pr||0);const jr=It(at.sellerId),Bn=sd(Dt,jr);ye.vendorProfit+=Number(Bn.uVendor||0),ye.vendorProfitActive+=Number(Bn.uVendor||0)*vt,de.set(ct,ye)}const tt=[];for(const at of de.values()){const ct=jt[at.orderKey]||{out:0,in:0};at.transferredOut=ct.out||0,at.transferredIn=ct.in||0,Number.isFinite(at.totalExpectedActive)||(at.totalExpectedActive=at.totalExpected),Number.isFinite(at.grossProfitActive)||(at.grossProfitActive=at.grossProfit),Number.isFinite(at.vendorProfitActive)||(at.vendorProfitActive=at.vendorProfit),Number.isFinite(at.gastosActive||0)||(at.gastosActive=at.gastos),tt.push(at)}return tt.sort((at,ct)=>(ct.date||"").localeCompare(at.date||"")),tt},[je,p,jt,v,Ft]),Qe=g.useMemo(()=>Math.max(1,Math.ceil(Ae.length/re)),[Ae.length]);g.useEffect(()=>{J>Qe&&De(Qe)},[Qe]);const fe=g.useMemo(()=>{const de=(J-1)*re;return Ae.slice(de,de+re)},[Ae,J]),te=()=>De(de=>Math.max(1,de-1)),_e=()=>De(de=>Math.min(Qe,de+1)),R=g.useMemo(()=>{const de=W.trim().toLowerCase();return de?F.filter(tt=>{const at=String(tt.productName||"").toLowerCase(),ct=String(tt.category||"").toLowerCase();return at.includes(de)||ct.includes(de)}):F},[F,W]),Q=g.useMemo(()=>Math.max(1,Math.ceil(R.length/ie)),[R.length]);g.useEffect(()=>{He>Q&&Ge(Q)},[Q]);const G=g.useMemo(()=>{const de=(He-1)*ie;return R.slice(de,de+ie)},[R,He]),se=g.useMemo(()=>{const de=new Map;for(const tt of G){const at=(tt.category||"Sin categora").trim()||"Sin categora",ct=de.get(at)||[];ct.push(tt),de.set(at,ct)}return Array.from(de.entries())},[G]),Ne=de=>{_t(tt=>({...tt,[de]:!tt[de]}))},Me=()=>Ge(de=>Math.max(1,de-1)),ze=()=>Ge(de=>Math.min(Q,de+1)),Ie=de=>{ee(tt=>({...tt,[de]:!0}))},nt=de=>{ee(tt=>({...tt,[de]:!1}))},lt=de=>{Re(tt=>({...tt,[de]:!0}))},ht=de=>{Re(tt=>({...tt,[de]:!1}))},kt=de=>{const tt=Math.max(0,Number(de.packages||0)),at=Number(de.transferDelta||0);return Math.max(0,tt+at)},le=de=>{const tt=Math.max(0,Number(de.packages||0)),at=kt(de);return tt===0?at>0?1:0:at/tt},We=(de,tt)=>Number(tt||0)*le(de),it=de=>Number(de.logisticAllocated??de.logisticAllocated??de.gastos??de.gasto??0),ot=de=>{const tt=We(de,Number(de.totalExpected||0)),at=We(de,Number(de.grossProfit||0)),ct=We(de,it(de)),ye=We(de,Number(de.uVendor||0)),ft=at-ct-ye;return{totalExpected:tt,grossProfit:at,gastos:ct,uVendor:ye,uNeta:ft}},Nt=g.useMemo(()=>F.reduce((de,tt)=>{const at=Math.max(0,Number(tt.packages||0)),ct=kt(tt),ye=ot(tt);return de.totalPackages+=at,de.totalActivePackages+=ct,de.totalExpected+=ye.totalExpected,de.grossProfit+=ye.grossProfit,de.gastosTotal+=ye.gastos,de.uVendor+=ye.uVendor,de},{totalPackages:0,totalActivePackages:0,totalExpected:0,grossProfit:0,gastosTotal:0,uVendor:0}),[F]),Rt=g.useMemo(()=>Nt.grossProfit-Nt.gastosTotal-Nt.uVendor,[Nt.grossProfit,Nt.gastosTotal,Nt.uVendor]),nr=()=>{k(null),O(""),oe(""),ue(""),ne(""),Ue("0"),H([]),U(""),Ge(1),ee({}),Re({})},_r=()=>{m(""),nr(),c&&qe&&O(qe.id);const de=new Date,tt=de.getFullYear(),at=String(de.getMonth()+1).padStart(2,"0"),ct=String(de.getDate()).padStart(2,"0");oe(`${tt}-${at}-${ct}`),ue(""),E(!0)},$r=()=>{E(!1)},or=de=>{m(""),nr(),k(de);const[tt,at]=de.split("__");O(tt||""),oe(at||"");const ct=je.filter(vt=>xe(vt)===de),ye=ct[0]||null;ue((ye==null?void 0:ye.orderName)||"");const ft=p.find(vt=>vt.id===tt)||null,St=ft==null?void 0:ft.branch,wt=ct.map(vt=>{const Et=v.find(Bn=>Bn.id===String(vt.productId))||null,qt=Number(vt.unitPriceRivas||(Et==null?void 0:Et.unitPriceRivas)||0),Mt=Number(vt.unitPriceSanJorge||(Et==null?void 0:Et.unitPriceSanJorge)||0),Xt=Number(vt.unitPriceIsla||(Et==null?void 0:Et.unitPriceIsla)||0),ar=Number(vt.packages||0),vr=St==="RIVAS"?qt:St==="SAN_JORGE"?Mt:Xt,ur=Number(vt.totalRivas||0),Dt=Number(vt.totalSanJorge||0),Yr=Number(vt.totalIsla||0),Vr=St==="RIVAS"?ur:St==="SAN_JORGE"?Dt:Yr,Sr=rf(vt.vendorMarginPercent??It(tt)),pr=sd(Number(vt.grossProfit||0),Sr),jr=Number(vt.logisticAllocated??vt.gastos??0)||(Et?Et.logisticAllocatedPerPack*ar:0);return{id:vt.id,productId:String(vt.productId||""),productName:vt.productName||(Et==null?void 0:Et.name)||"",category:vt.category||(Et==null?void 0:Et.category)||"",unitsPerPackage:Number(vt.unitsPerPackage||(Et==null?void 0:Et.unitsPerPackage)||0),packages:ar,totalExpected:Vr,pricePerPackage:vr,grossProfit:Number(vt.grossProfit||0),logisticAllocated:jr,vendorMarginPercent:pr.vendorMarginPercent,uAproximada:Number(vt.uAproximada||0),uVendor:Number(vt.uVendor??pr.uVendor??0),uInvestor:Number(vt.uInvestor??pr.uInvestor??0),totalRivas:ur,totalSanJorge:Dt,totalIsla:Yr,unitPriceRivas:qt,unitPriceSanJorge:Mt,unitPriceIsla:Xt,providerPrice:Number(vt.providerPrice||0),remainingPackages:Number(vt.remainingPackages||0),transferDelta:Ut(vt)}});H(wt),E(!0)},kr=()=>{if(m(""),!P)return m(" Seleccion un vendedor.");if(!z)return m(" Seleccion una fecha.");if(!ge)return m(" Seleccion un producto.");const de=bi(Oe);if(de<=0)return m(" Paquetes debe ser > 0.");const tt=v.find(vr=>vr.id===ge);if(!tt)return m(" Producto no encontrado.");if(F.some(vr=>vr.productId===tt.id))return m(" Ese producto ya est agregado al pedido.");const at=p.find(vr=>vr.id===P)||null,ct=at==null?void 0:at.branch,ye=Se(tt,ct),ft=xt(tt,ct),wt=Pt(tt,ct)*de,vt=ye*de,Et=ft*de,qt=tt.logisticAllocatedPerPack*de,Mt=It(P),Xt=sd(Et,Mt),ar={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:tt.id,productName:tt.name,category:tt.category,unitsPerPackage:tt.unitsPerPackage,packages:de,totalExpected:vt,pricePerPackage:ye,grossProfit:Et,logisticAllocated:qt,providerPrice:tt.providerPrice,vendorMarginPercent:Xt.vendorMarginPercent,uAproximada:wt,uVendor:Xt.uVendor,uInvestor:Xt.uInvestor,totalRivas:(tt.unitPriceRivas||0)*de,totalSanJorge:(tt.unitPriceSanJorge||0)*de,totalIsla:(tt.unitPriceIsla||0)*de,unitPriceRivas:tt.unitPriceRivas||0,unitPriceSanJorge:tt.unitPriceSanJorge||0,unitPriceIsla:tt.unitPriceIsla||0,remainingPackages:de,transferDelta:0};H(vr=>[ar,...vr]),ne(""),Ue("0"),Ge(1)},en=de=>{H(tt=>tt.filter(at=>at.id!==de))},rn=(de,tt)=>{const at=Math.max(0,bi(tt));H(ct=>ct.map(ye=>{if(ye.id!==de)return ye;const ft=v.find(Yr=>Yr.id===ye.productId),St=p.find(Yr=>Yr.id===P)||null,wt=St==null?void 0:St.branch,vt=ft?Se(ft,wt):ye.pricePerPackage||0,qt=(ft?xt(ft,wt):0)*at,Mt=ft?ft.logisticAllocatedPerPack*at:ye.logisticAllocated||0,ar=(ft?Pt(ft,wt):0)*at,vr=ye.vendorMarginPercent!=null?ye.vendorMarginPercent:It(P),ur=sd(qt,vr),Dt=String(ye.id||"").startsWith("tmp_")||Number(ye.remainingPackages||0)===Number(ye.packages||0);return{...ye,packages:at,pricePerPackage:vt,totalExpected:vt*at,grossProfit:qt,logisticAllocated:Mt,providerPrice:(ft==null?void 0:ft.providerPrice)??ye.providerPrice??Number(ye.providerPrice||0),vendorMarginPercent:ur.vendorMarginPercent,uAproximada:ar,uVendor:ur.uVendor,uInvestor:ur.uInvestor,totalRivas:((ft==null?void 0:ft.unitPriceRivas)||ye.unitPriceRivas||0)*at,totalSanJorge:((ft==null?void 0:ft.unitPriceSanJorge)||ye.unitPriceSanJorge||0)*at,totalIsla:((ft==null?void 0:ft.unitPriceIsla)||ye.unitPriceIsla||0)*at,remainingPackages:Dt?at:ye.remainingPackages}}))},Er=(de,tt)=>{const at=rf(tt);H(ct=>ct.map(ye=>{if(ye.id!==de)return ye;const ft=v.find(ar=>ar.id===ye.productId),St=p.find(ar=>ar.id===P)||null,wt=St==null?void 0:St.branch,vt=bi(ye.packages),qt=(ft?Pt(ft,wt):0)*vt,Mt=Number(ye.grossProfit||0),Xt=sd(Mt,at);return{...ye,vendorMarginPercent:Xt.vendorMarginPercent,uAproximada:qt,uVendor:Xt.uVendor,uInvestor:Xt.uInvestor}}))},Ee=async()=>{if(l&&!Z)try{be(!0),m("");const de=j;if(!de.length){m(" No hay documentos para actualizar.");return}const tt=wt=>v.find(vt=>vt.id===wt)||null,at=wt=>{const vt=p.find(Et=>Et.id===wt)||null;return vt==null?void 0:vt.branch},ct=(wt,vt)=>Math.abs(Number(wt||0)-Number(vt||0))>.01;let ye=tu(Pe),ft=0,St=0;for(const wt of de){const vt=at(wt.sellerId)||"ISLA",Et=Math.max(1,Number(wt.unitsPerPackage||0)||1),qt=Number(wt.totalUnits||0),Mt=Number(wt.remainingUnits||0),ar=Math.max(0,qt-Mt)/Et,vr=Number(wt.remainingPackages||0),ur=Math.max(0,vr+ar),Dt=tt(String(wt.productId||"")),Yr=Dt&&ur>0?xt(Dt,vt)*ur:Number(wt.grossProfit||0),Vr=Dt&&ur>0?Dt.logisticAllocatedPerPack*ur:Number(wt.logisticAllocated||0),Sr=Dt?Pt(Dt,vt):0,pr=ur>0?Sr*ur:0,jr=wt.vendorMarginPercent!=null?rf(wt.vendorMarginPercent):It(wt.sellerId),Bn=sd(Yr,jr),wn=Bn.uVendor,xn=Bn.uInvestor,ua=Yr-Vr-wn;if(!(ct(wt.packages,ur)||wt.uVendor==null||wt.uNeta==null||wt.uAproximada==null||wt.uInvestor==null||wt.logisticAllocated==null||ct(wt.uVendor,wn)||ct(wt.uNeta,ua)||ct(wt.uAproximada,pr)||ct(wt.uInvestor,xn)||ct(wt.logisticAllocated,Vr)))continue;const Yi=er(Pe,"inventory_candies_sellers",wt.id);ye.update(Yi,{packages:ur,vendorMarginPercent:jr,grossProfit:Yr,logisticAllocated:Vr,uAproximada:pr,uVendor:wn,uInvestor:xn,uNeta:ua,vendorProfit:wn,updatedAt:xr.now()}),ft+=1,St+=1,ft>=400&&(await ye.commit(),ye=tu(Pe),ft=0)}ft>0&&await ye.commit(),m(` Actualizados ${St} documentos.`),s()}catch(de){console.error(de),m(" Error actualizando documentos.")}finally{be(!1)}},gt=(de,tt,at="Hoja1")=>{const ct=Qa.book_new(),ye=Qa.aoa_to_sheet(tt);Qa.book_append_sheet(ct,ye,at),V2(ct,de)},Zt=()=>{if(!l){m(" Solo admin puede exportar Excel.");return}const de=["Vendedor","Sucursal","Fecha","Producto ID","Producto","Categora","Paquetes","Paquetes restantes","Precio paquete","Precio proveedor","Total esperado","U. Bruta","U. Vendedor","U. Neta","P. Rivas","P. San Jorge","P. Isla","Total Rivas","Total San Jorge","Total Isla","Unidades x paquete","vendorMarginPercent","uVendor"],tt=p.find(ft=>ft.id===P)||null,at=(tt==null?void 0:tt.branch)||yK(tt==null?void 0:tt.branchLabel)||"",ct=[de,...F.map(ft=>{const{totalExpected:St,grossProfit:wt,uVendor:vt,uNeta:Et}=ot(ft);return[(tt==null?void 0:tt.name)||"",String(at),z||"",ft.productId,ft.productName,ft.category,Number(ft.packages||0),Number(ft.remainingPackages||0),Number(ft.pricePerPackage||0),Number(ft.providerPrice||0),Number(St||0),Number(wt||0),Number(vt||0),Number(Et||0),Number(ft.unitPriceRivas||0),Number(ft.unitPriceSanJorge||0),Number(ft.unitPriceIsla||0),Number(ft.totalRivas||0),Number(ft.totalSanJorge||0),Number(ft.totalIsla||0),Number(ft.unitsPerPackage||0),Number(ft.vendorMarginPercent||0),Number(ft.uVendor||0)]})],ye=`vendor_order_items_${((tt==null?void 0:tt.name)||"vendedor").replace(/\s+/g,"_")}_${z||"sin_fecha"}.xlsx`;gt(ye,ct,"Productos")},Mr=()=>{const de=["productId","productName","category","Existentes","Paquetes","vendorMarginPercent","uNeta"],tt=v.map(ct=>({id:ct.id,name:ct.name,category:ct.category,existentes:Number(ct.existingPacks||0)})).filter(ct=>ct.existentes>0).sort((ct,ye)=>`${ct.category} ${ct.name}`.localeCompare(`${ye.category} ${ye.name}`)),at=[de,...tt.map(ct=>[ct.id,ct.name,ct.category,ct.existentes,"","",""])];gt("plantilla_orden_vendedor.xlsx",at,"Plantilla")},Or=async de=>{try{m("");const tt=await de.arrayBuffer(),at=Vv(tt,{type:"array"}),ct=at.SheetNames||[],ye=at.Sheets.Plantilla||at.Sheets.Productos||at.Sheets[ct[0]];if(!ye)return m(" Archivo sin hojas.");const ft=Qa.sheet_to_json(ye,{header:1,defval:""});if(!ft.length)return m(" Archivo vaco.");const St=(ft[0]||[]).map(vr=>String(vr||"").trim().toLowerCase()),wt=St.findIndex(vr=>vr==="productid"||vr==="producto id"||vr==="id"),vt=St.findIndex(vr=>vr==="paquetes"||vr==="packages"),Et=St.findIndex(vr=>vr==="vendormarginpercent"||vr==="vendor_margin_percent"||vr==="marginvendorpercent"||vr==="margen"||vr==="margen vendedor"||vr==="margen_del_vendedor");if(wt<0||vt<0)return m(" Plantilla invlida: debe tener columnas productId y Paquetes.");if(!P)return m(" Seleccion un vendedor antes de importar.");if(!z)return m(" Seleccion una fecha antes de importar.");const qt=p.find(vr=>vr.id===P)||null,Mt=qt==null?void 0:qt.branch,Xt=It(P),ar=[];for(let vr=1;vr<ft.length;vr++){const ur=ft[vr]||[],Dt=String(ur[wt]||"").trim();if(!Dt)continue;const Yr=bi(ur[vt]);if(Yr<=0)continue;const Vr=v.find(Qn=>Qn.id===Dt);if(!Vr)continue;const Sr=Et>=0?rf(ur[Et]):0,pr=Et>=0&&String(ur[Et]??"").trim()!==""?Sr:Xt,jr=Se(Vr,Mt),Bn=xt(Vr,Mt),wn=jr*Yr,xn=Bn*Yr,ua=Vr.logisticAllocatedPerPack*Yr,Yi=Pt(Vr,Mt)*Yr,Ji=sd(xn,pr),Fl=F.find(Qn=>Qn.productId===Dt);if(Fl){const Qn=Et>=0&&String(ur[Et]??"").trim()!==""?pr:Fl.vendorMarginPercent,du=sd(xn,Qn);H(Ol=>Ol.map(Zi=>Zi.id===Fl.id?{...Zi,packages:Yr,pricePerPackage:jr,totalExpected:wn,grossProfit:xn,logisticAllocated:ua,vendorMarginPercent:du.vendorMarginPercent,uAproximada:Yi,uVendor:du.uVendor,uInvestor:du.uInvestor,totalRivas:(Vr.unitPriceRivas||0)*Yr,totalSanJorge:(Vr.unitPriceSanJorge||0)*Yr,totalIsla:(Vr.unitPriceIsla||0)*Yr}:Zi));continue}const xa={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:Vr.id,productName:Vr.name,category:Vr.category,unitsPerPackage:Vr.unitsPerPackage,packages:Yr,pricePerPackage:jr,totalExpected:wn,grossProfit:xn,logisticAllocated:ua,providerPrice:Vr.providerPrice,vendorMarginPercent:Ji.vendorMarginPercent,uAproximada:Yi,uVendor:Ji.uVendor,uInvestor:Ji.uInvestor,totalRivas:(Vr.unitPriceRivas||0)*Yr,totalSanJorge:(Vr.unitPriceSanJorge||0)*Yr,totalIsla:(Vr.unitPriceIsla||0)*Yr,unitPriceRivas:Vr.unitPriceRivas||0,unitPriceSanJorge:Vr.unitPriceSanJorge||0,unitPriceIsla:Vr.unitPriceIsla||0,remainingPackages:Yr};ar.push(xa)}if(!ar.length)return m(" No se encontraron filas con Paquetes > 0.");H(vr=>[...ar,...vr]),Ge(1),m(` Importados ${ar.length} productos desde plantilla.`)}catch(tt){console.error(tt),m(" Error importando Excel.")}},ir=async()=>{var de;try{if(m(""),d)return m(" Solo lectura.");if(!P)return m(" Seleccion un vendedor.");if(!z)return m(" Seleccion una fecha.");if(!F.length)return m(" Agreg al menos 1 producto.");const tt=p.find(Sr=>Sr.id===P)||null;if(!tt)return m(" Vendedor invlido.");const at=tt.branch,ct=B?je.filter(Sr=>xe(Sr)===B):[],ye=String(((de=ct[0])==null?void 0:de.orderName)||"").trim(),ft=String(ce||"").trim(),St=B?ye!==ft:ft!=="",wt=Sr=>String(Sr??"").trim(),vt=new Map;ct.forEach(Sr=>vt.set(wt(Sr.productId),Sr));const Et=Sr=>vt.get(wt(Sr))||null,qt=Sr=>{const pr=Et(Sr.productId),jr=bi(Sr.packages),Bn=pr?bi(pr.packages):0,wn=!pr||jr!==Bn,xn=rf(pr?pr.vendorMarginPercent:Sr.vendorMarginPercent),ua=rf(Sr.vendorMarginPercent);return{prev:pr,newPacks:jr,oldPacks:Bn,packsChanged:wn,marginChanged:pr?xn!==ua:!0}},Mt=B?F.filter(Sr=>{const pr=qt(Sr);return!pr.prev||pr.packsChanged||pr.marginChanged}):F;for(const Sr of Mt){const pr=bi(Sr.packages),jr=B?Et(Sr.productId):null,Bn=jr?bi(jr.packages):0,wn=pr-Bn;if(wn>0){let xn=b[Sr.productId]??0;const ua=v.find(ga=>ga.id===Sr.productId)||null;if(wn>xn&&(ua!=null&&ua.masterOrderId))try{await gF(ua.masterOrderId);const ga=await Ce(Sr.productId,Sr.productName);xn=ga.byId,w(Yi=>({...Yi,[Sr.productId]:ga.byId}))}catch{}if(wn>xn){const ga=await Ce(Sr.productId,Sr.productName);return ga.byId===0&&ga.byName>0?m(` "${Sr.productName}" no tiene inventario por ID (${Sr.productId}). Pero existe por nombre: ${ga.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`):m(` "${Sr.productName}" excede existencias de orden maestra. Existentes: ${ga.byId} (faltan ${wn})`)}}}V(!0);const Xt=xr.now(),ar=Ye(P,z),vr=It(P),ur=new Set(F.map(Sr=>String(Sr.id||""))),Dt=B?ct.filter(Sr=>!ur.has(String(Sr.id||""))):[];if(B&&Mt.length===0&&!Dt.length&&!St)return V(!1),m(" No hay cambios para guardar.");if(B&&Mt.length===0&&!Dt.length&&St){const Sr=tu(Pe);ct.forEach(pr=>{Sr.update(er(Pe,"inventory_candies_sellers",pr.id),{orderName:ft,updatedAt:xr.now()})}),await Sr.commit(),I(pr=>pr.map(jr=>xe(jr)===B?{...jr,orderName:ft}:jr)),m(" Pedido guardado."),E(!1),nr(),s();return}if(B){const Sr=[];for(const pr of Dt)await hK(pr.id),Sr.push(pr.id);Sr.length&&I(pr=>pr.filter(jr=>!Sr.includes(jr.id)));for(const pr of F){const jr=Et(pr.productId);if(!jr)continue;const Bn=bi(pr.packages),wn=bi(jr.packages),xn=Bn-wn;if(xn<0){const ua=Math.abs(xn),ga=bi(jr.remainingPackages);if(ua>ga)return m(` No pods bajar "${pr.productName}" en ${ua} porque solo quedan ${ga} paquetes restantes.`);await GQe({vendorInventoryId:jr.id,packagesToReturn:ua})}}}const Yr=new Map;let Vr="";for(const Sr of Mt){const pr=qt(Sr),jr=pr.newPacks-pr.oldPacks;if(pr.packsChanged&&jr>0)try{const{allocations:Bn}=await fK({productId:Sr.productId,packagesToAllocate:jr});Yr.set(Sr.productId,Bn||[])}catch{const wn=v.find(xn=>xn.id===Sr.productId)||null;if(wn!=null&&wn.masterOrderId)try{await gF(wn.masterOrderId);const{allocations:xn}=await fK({productId:Sr.productId,packagesToAllocate:jr});Yr.set(Sr.productId,xn||[]);continue}catch{const ua=await Ce(Sr.productId,Sr.productName);ua.byId===0&&ua.byName>0?Vr=` "${Sr.productName}" no tiene inventario por ID (${Sr.productId}). Pero existe por nombre: ${ua.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Vr=` No hay paquetes disponibles en orden maestra para "${Sr.productName}". Disponibles: ${ua.byId}.`;break}{const xn=await Ce(Sr.productId,Sr.productName);xn.byId===0&&xn.byName>0?Vr=` "${Sr.productName}" no tiene inventario por ID (${Sr.productId}). Pero existe por nombre: ${xn.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Vr=` No hay paquetes disponibles en orden maestra para "${Sr.productName}". Disponibles: ${xn.byId}.`}break}}if(Vr)return V(!1),m(Vr);if(await Ks(Pe,async Sr=>{for(const pr of Mt){const jr=qt(pr),Bn=jr.prev;if(B&&Bn&&!jr.packsChanged){const M=pr.vendorMarginPercent!=null?pr.vendorMarginPercent:vr,Be=Number(Bn.grossProfit??pr.grossProfit??0),At=Number(Bn.logisticAllocated??pr.logisticAllocated??0),Ct=sd(Be,M),Vt=Number(Be||0)-Number(At||0)-Number(Ct.uVendor||0),hr=er(Pe,"inventory_candies_sellers",pr.id);Sr.update(hr,{vendorMarginPercent:Ct.vendorMarginPercent,uVendor:Ct.uVendor,uInvestor:Ct.uInvestor,uNeta:Vt,vendorProfit:Ct.uVendor});continue}const wn=bi(pr.packages),xn=bi(pr.unitsPerPackage),ua=wn*xn,ga=Bn?bi(Bn.packages):0,Yi=Bn?bi(Bn.remainingPackages):0,Ji=wn-ga,Fl=Bn?Math.max(0,Yi+Ji):wn,xa=Fl*xn,Qn=v.find(M=>M.id===pr.productId),du=Qn?Se(Qn,at):Number(pr.pricePerPackage||0),Zi=(Qn?xt(Qn,at):0)*wn,Rc=Qn?Qn.logisticAllocatedPerPack*wn:pr.logisticAllocated||0,dc=(Qn?Pt(Qn,at):0)*wn,ol=pr.vendorMarginPercent!=null?pr.vendorMarginPercent:vr,fu=sd(Zi,ol),GA=Number(Zi||0)-Number(Rc||0)-Number(fu.uVendor||0),ll=((Qn==null?void 0:Qn.unitPriceRivas)||pr.unitPriceRivas||0)*wn,Lc=((Qn==null?void 0:Qn.unitPriceSanJorge)||pr.unitPriceSanJorge||0)*wn,Bf=((Qn==null?void 0:Qn.unitPriceIsla)||pr.unitPriceIsla||0)*wn,fo={sellerId:tt.id,sellerName:tt.name,sellerEmail:tt.email||"",branch:tt.branch||"",branchLabel:tt.branchLabel||"",orderName:String(ce||"").trim(),productId:pr.productId,productName:pr.productName,category:pr.category,orderId:ar,date:z,createdAt:Xt,packages:wn,unitsPerPackage:xn,totalUnits:ua,remainingPackages:Fl,remainingUnits:xa,totalRivas:ll,totalSanJorge:Lc,totalIsla:Bf,unitPriceRivas:(Qn==null?void 0:Qn.unitPriceRivas)||pr.unitPriceRivas||0,unitPriceSanJorge:(Qn==null?void 0:Qn.unitPriceSanJorge)||pr.unitPriceSanJorge||0,unitPriceIsla:(Qn==null?void 0:Qn.unitPriceIsla)||pr.unitPriceIsla||0,grossProfit:Zi,logisticAllocated:Rc,vendorMarginPercent:fu.vendorMarginPercent,uVendor:fu.uVendor,uNeta:GA,uAproximada:dc,uInvestor:fu.uInvestor,providerPrice:Number(pr.providerPrice??(Qn==null?void 0:Qn.providerPrice)??0),vendorProfit:fu.uVendor,transferDelta:Bn?Number(Bn.transferDelta||0):0},zu=Yr.get(pr.productId)||[];if(B)if(String(pr.id||"").startsWith("tmp_")){const M=er(bt(Pe,"inventory_candies_sellers"));fo.masterAllocations=zu,Sr.set(M,fo)}else{const M=er(Pe,"inventory_candies_sellers",pr.id);zu.length>0&&(fo.masterAllocations=Bee(...zu)),Sr.set(M,fo,{merge:!0})}else{const M=er(bt(Pe,"inventory_candies_sellers"));fo.masterAllocations=zu,Sr.set(M,fo)}}}),B&&St){const Sr=new Set(Dt.map(jr=>jr.id)),pr=tu(Pe);ct.forEach(jr=>{Sr.has(jr.id)||pr.update(er(Pe,"inventory_candies_sellers",jr.id),{orderName:ft,updatedAt:xr.now()})}),await pr.commit(),I(jr=>jr.map(Bn=>xe(Bn)===B?{...Bn,orderName:ft}:Bn))}m(" Pedido guardado."),E(!1),nr(),s()}catch(tt){console.error(tt),m(" Error guardando el pedido.")}finally{V(!1)}},br=async de=>{try{if(m(""),!l)return m(" Solo admin.");V(!0);const tt=je.filter(at=>xe(at)===de);for(const at of tt)await hK(at.id);m(" Pedido eliminado."),s()}catch(tt){console.error(tt),m(" Error eliminando pedido.")}finally{V(!1)}},wr=Ni.useRef(null),Xr=()=>{var de;if(d)return m(" Solo lectura.");if(!P)return m(" Seleccion un vendedor.");if(!z)return m(" Seleccion una fecha.");(de=wr.current)==null||de.click()},Ir=async de=>{var at;const tt=(at=de.target.files)==null?void 0:at[0];de.target.value="",tt&&await Or(tt)},Pr=!l,fn=l?12:9;return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-3 mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-lg md:text-2xl font-semibold",children:"rdenes de Vendedor (Dulces)"}),i.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Pedidos agrupados por vendedor + fecha. U. Bruta viene de la orden maestra. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(Oc,{onClick:s}),l&&i.jsx("button",{onClick:()=>Ze(!0),className:"px-3 py-2 rounded bg-amber-600 text-white text-sm hover:bg-amber-700",children:"Traslados"}),!d&&i.jsx("button",{onClick:_r,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo pedido"})]})]}),h&&!S&&i.jsx("div",{className:"mb-3 p-2 rounded border text-sm bg-white",children:h}),f?i.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"hidden md:block bg-white border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:Ae.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:()=>{if(!S){m(" Abr un pedido para exportar productos asociados.");return}Zt()},children:"Exportar asociados"}),l&&i.jsx(i.Fragment,{children:i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Ee,disabled:Z,children:Z?"Actualizando campos...":"Actualizar campos calculados"})})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Nombre"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Asociados"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Salida"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Entrada"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[fe.map(de=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:de.orderName||""}),i.jsx("td",{className:"p-2 border-b",children:de.date}),i.jsx("td",{className:"p-2 border-b",children:de.sellerName}),i.jsx("td",{className:"p-2 border-b text-right",children:de.totalPackages}),i.jsx("td",{className:"p-2 border-b text-right",children:de.totalRemainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(de.totalExpectedActive??de.totalExpected)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(de.grossProfitActive??de.grossProfit)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni((de.gastosActive??de.gastos)||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(de.vendorProfitActive??de.vendorProfit)}),i.jsx("td",{className:"p-2 border-b text-right",children:de.transferredOut}),i.jsx("td",{className:"p-2 border-b text-right",children:de.transferredIn}),i.jsx("td",{className:"p-2 border-b",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded bg-gray-900 text-white text-xs hover:bg-black",onClick:()=>or(de.orderKey),children:"Ver / Editar"}),l&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este pedido completo?")&&br(de.orderKey)},children:"Eliminar"})]})})]},de.orderKey)),!fe.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:fn,children:"No hay pedidos."})})]})]})}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina ",J," / ",Qe]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:te,disabled:J<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:_e,disabled:J>=Qe,children:""})]})]})]}),i.jsxs("div",{className:"md:hidden space-y-2",children:[i.jsxs("div",{className:"bg-white border rounded p-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:Ae.length})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:[J,"/",Qe]})]}),fe.map(de=>i.jsxs("div",{className:"bg-white border rounded",role:"button",tabIndex:0,onClick:()=>or(de.orderKey),onKeyDown:tt=>{(tt.key==="Enter"||tt.key===" ")&&(tt.preventDefault(),or(de.orderKey))},children:[i.jsxs("div",{className:"p-2 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:de.sellerName}),i.jsxs("div",{className:"text-xs text-gray-600",children:[de.orderName||"","  ",de.date]})]}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm text-red-600",onClick:tt=>{tt.stopPropagation(),confirm("Eliminar este pedido completo?")&&br(de.orderKey)},children:"Eliminar"})]}),i.jsx("div",{className:"px-2 pb-2",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Asociados"}),i.jsx("div",{className:"font-semibold",children:de.totalPackages})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Restantes"}),i.jsx("div",{className:"font-semibold",children:de.totalRemainingPackages})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:ni(de.totalExpectedActive??de.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:ni(de.vendorProfitActive??de.vendorProfit)})]})]})})]},de.orderKey)),!fe.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 bg-white border rounded",children:"No hay pedidos."}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:te,disabled:J<=1,children:""}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:_e,disabled:J>=Qe,children:""})]})]})]}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3 md:p-6",children:i.jsxs("div",{className:"bg-white w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded shadow relative",children:[D&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"text-sm font-semibold",children:"Guardando"})}),i.jsxs("div",{className:"p-3 md:p-5 border-b flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-semibold",children:B?"Editar pedido":"Nuevo pedido"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Nombre: ",ce||""]}),i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta viene de Orden Maestra. U. Vendedor e Inversionista se calculan aqu. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:$r,children:"Cerrar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:ir,children:"Guardar"})]})]}),i.jsxs("div",{className:"p-3 md:p-5 space-y-3",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Xe(de=>!de),children:[i.jsx("span",{children:"Filtros y KPIs"}),i.jsx("span",{children:L?"":"+"})]}),i.jsxs("div",{className:`${L?"block":"hidden"} md:block space-y-3`,children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[i.jsxs("div",{className:"md:col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Nombre"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:ce,onChange:de=>ue(de.target.value),placeholder:"Nombre de la orden",disabled:d})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:P,onChange:de=>O(de.target.value),disabled:Pr,children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),p.map(de=>i.jsxs("option",{value:de.id,children:[de.name," ",de.branch?`(${de.branch})`:""]},de.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",value:z,onChange:de=>oe(de.target.value)})]}),i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Mr,children:"Plantilla"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Xr,children:"Importar Excel"}),i.jsx("input",{ref:wr,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:Ir})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. asociados"}),i.jsx("div",{className:"text-lg font-semibold",children:Nt.totalPackages})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(Nt.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(Nt.grossProfit)})]})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(Nt.uVendor)})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(Rt)})]})]})]}),i.jsxs("div",{className:"border rounded p-3 space-y-2",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Ot(de=>!de),children:[i.jsx("span",{children:"Agregar producto"}),i.jsx("span",{children:Bt?"":"+"})]}),i.jsxs("div",{className:`${Bt?"block":"hidden"} md:block space-y-2`,children:[i.jsx("div",{className:"text-sm font-semibold hidden md:block",children:"Agregar producto"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-2",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:K,onChange:de=>U(de.target.value),placeholder:"Buscar por categora o nombre"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:ge,onChange:de=>ne(de.target.value),children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),yt.map(de=>i.jsxs("option",{value:de.id,children:[de.category," - ",de.name," (exist:"," ",b[de.id]??0,")"]},de.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:Oe,onChange:de=>Ue(de.target.value),inputMode:"numeric"})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{className:"w-full px-3 py-2 rounded bg-gray-900 text-white text-sm hover:bg-black",onClick:kr,disabled:!pe,children:"Agregar"})})]})]})]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm font-semibold",children:["Productos asociados (",F.length,")"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Buscar producto",value:W,onChange:de=>{X(de.target.value),Ge(1)}}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Zt,disabled:!F.length,children:"Exportar Excel"})]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Categora"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Producto"}),i.jsxs("th",{className:"text-right p-2 border-b",children:["P. Asociados"," "]}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Precio prov."}),i.jsx("th",{className:"text-right p-2 border-b",children:"Precio/paq"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"})]}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Neta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Margen (%)"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[G.map(de=>{const{totalExpected:tt,grossProfit:at,gastos:ct,uVendor:ye,uNeta:ft}=ot(de);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:de.category}),i.jsx("td",{className:"p-2 border-b",children:de.productName}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsx("span",{children:de.packages}):Te[de.id]?i.jsx("input",{className:"w-20 border rounded p-1 text-right",value:String(de.packages),onChange:St=>rn(de.id,St.target.value),onBlur:()=>nt(de.id),onKeyDown:St=>{(St.key==="Enter"||St.key==="Escape")&&nt(de.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:de.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ie(de.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 border-b text-right",children:de.remainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(de.providerPrice||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(de.pricePerPackage)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(tt)}),l&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border-b text-right",children:ni(at)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(ct)})]}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(ye)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(ft)}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsxs("span",{children:[Number(de.vendorMarginPercent??It(P)).toFixed(3),"%"]}):me[de.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-20 border rounded p-1 text-right",value:String(de.vendorMarginPercent??It(P)),onChange:St=>Er(de.id,St.target.value),onBlur:()=>ht(de.id),onKeyDown:St=>{(St.key==="Enter"||St.key==="Escape")&&ht(de.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{children:[Number(de.vendorMarginPercent??It(P)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>lt(de.id),"aria-label":"Editar margen",children:""})]})}),i.jsx("td",{className:"p-2 border-b",children:!d&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este producto?")&&en(de.id)},children:""})})]},de.id)}),!G.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:l?13:9,children:"No hay productos asociados."})})]})]})}),i.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[se.map(([de,tt])=>{const at=!!dt[de];return i.jsxs("div",{className:"border rounded",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-2 flex items-center justify-between text-sm",onClick:()=>Ne(de),children:[i.jsx("span",{className:"font-semibold",children:de}),i.jsxs("span",{className:"text-xs text-gray-600",children:[tt.length," ",tt.length===1?"producto":"productos"]})]}),at&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:tt.map(ct=>{const{totalExpected:ye,grossProfit:ft,gastos:St,uVendor:wt,uNeta:vt}=ot(ct);return i.jsxs("div",{className:"border rounded p-2 text-xs space-y-2",children:[i.jsx("div",{className:"font-semibold text-sm",children:ct.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes"}),d?i.jsx("div",{className:"font-semibold",children:ct.packages}):Te[ct.id]?i.jsx("input",{className:"w-full border rounded p-1 text-right",value:String(ct.packages),onChange:Et=>rn(ct.id,Et.target.value),onBlur:()=>nt(ct.id),onKeyDown:Et=>{(Et.key==="Enter"||Et.key==="Escape")&&nt(ct.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:ct.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ie(ct.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:ct.remainingPackages})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Precio/paq"}),i.jsx("div",{className:"font-semibold",children:ni(ct.pricePerPackage)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:ni(ye)})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"font-semibold",children:ni(ft)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Gastos"}),i.jsx("div",{className:"font-semibold",children:ni(St)})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:ni(wt)})]}),l&&i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"font-semibold",children:ni(vt)})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-gray-600",children:"Margen (%)"}),d?i.jsxs("div",{className:"font-semibold",children:[Number(ct.vendorMarginPercent??It(P)).toFixed(3),"%"]}):me[ct.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-full border rounded p-1 text-right",value:String(ct.vendorMarginPercent??It(P)),onChange:Et=>Er(ct.id,Et.target.value),onBlur:()=>ht(ct.id),onKeyDown:Et=>{(Et.key==="Enter"||Et.key==="Escape")&&ht(ct.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{className:"font-semibold",children:[Number(ct.vendorMarginPercent??It(P)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>lt(ct.id),"aria-label":"Editar margen",children:""})]})]}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>{confirm("Eliminar este producto?")&&en(ct.id)},children:""})]})]},ct.id)})})]},de)}),!G.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 text-center",children:"No hay productos asociados."})]}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina items ",He," / ",Q]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Me,disabled:He<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:ze,disabled:He>=Q,children:""})]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center md:justify-between",children:[i.jsx("div",{className:"text-xs text-gray-600",children:B?i.jsxs(i.Fragment,{children:["Editando: ",i.jsx("b",{children:B})]}):i.jsx(i.Fragment,{children:"Nuevo pedido (an no guardado)"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:$r,children:"Cancelar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:ir,children:"Guardar pedido"})]})]}),h&&i.jsx("div",{className:"text-sm text-gray-700",children:h})]})]})}),i.jsx(XQe,{open:Fe,onClose:()=>Ze(!1),orders:Ae,rows:j,setRows:I,isAdmin:l,currentUserEmail:r||"",currentUserName:"",sellerCandyId:e,sellers:p,products:v,transferAgg:jt,setTransferAgg:Qt,setTransferRowDeltas:$e})]})}const Hn=t=>Math.max(0,Math.floor(Number(t)||0)),Lb=t=>Math.round(t||0),bE=99.999;function Lse(t){const e=Math.max(1,Hn(t.unitsPerPackage||1)),r=Hn(t.totalUnits||0),n=Hn(t.quantity||0),a=Hn(t.packages||0);return r>0?r:n>0?n:a>0?a*e:0}function JQe(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Lse(t)}function bK(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,Hn(t.unitsPerPackage||1)),n=JQe(t);return Math.max(0,Math.floor(n/r))}function ZQe(t){const e=Math.max(1,Hn(t.unitsPerPackage||1)),r=Lse(t);return Math.max(0,Math.floor(r/e))}function Ub(t){return String(t??"").trim().toLowerCase().replace(/\s+/g," ")}function Lf(t){const e=String(t??"").trim();if(!e)return 0;const r=e.replace(/,/g,"."),n=Number(r);return Number.isFinite(n)?n:0}function kh(t,e){const r={};Object.keys(t||{}).forEach(n=>r[Ub(n)]=t[n]);for(const n of e){const a=r[Ub(n)];if(a!=null&&String(a).trim()!=="")return a}}function tp(t,e,r){const n=t*e,a=bE,s=Math.min(Math.max(r.marginR,0),a)/100,o=Math.min(Math.max(r.marginSJ,0),a)/100,l=Math.min(Math.max(r.marginIsla,0),a)/100,c=e>0&&s<1?n/(1-s):n,u=e>0&&o<1?n/(1-o):n,d=e>0&&l<1?n/(1-l):n,f=c-n,A=u-n,h=d-n,m=e>0?Lb(c/e):0,p=e>0?Lb(u/e):0,x=e>0?Lb(d/e):0;return{subtotal:n,totalRivas:c,totalSanJorge:u,totalIsla:d,gainRivas:f,gainSanJorge:A,gainIsla:h,unitPriceRivas:m,unitPriceSanJorge:p,unitPriceIsla:x}}function eVe(t){return Number(t.gainRivas||0)}function tVe(t){return Number(t.gainIsla||0)}function sB(t,e,r){const n=eVe(t),a=tVe(t),s=Number(t.subtotal||0),o=e>0&&r>0?e*s/r:0;return{...t,grossProfit:n,grossProfitIsla:a,logisticAllocated:o}}function rVe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(""),[a,s]=g.useState(!0),[o,l]=g.useState(!1),[c,u]=g.useState(!1),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState({}),[w,j]=g.useState(!1),[I,_]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[P,O]=g.useState("20"),[z,oe]=g.useState("15"),[ce,ue]=g.useState("30"),[ge,ne]=g.useState("0"),[Oe,Ue]=g.useState([]),[F,H]=g.useState({}),[K,U]=g.useState({}),[W,X]=g.useState({}),[D,V]=g.useState({}),[Z,be]=g.useState({}),[L,Xe]=g.useState({}),[re,J]=g.useState({}),De=Ee=>H(gt=>({...gt,[Ee]:!0})),ie=Ee=>H(gt=>({...gt,[Ee]:!1})),He=Ee=>U(gt=>({...gt,[Ee]:!0})),Ge=Ee=>U(gt=>({...gt,[Ee]:!1})),dt=Ee=>X(gt=>({...gt,[Ee]:!0})),_t=Ee=>X(gt=>({...gt,[Ee]:!1})),Bt=Ee=>V(gt=>({...gt,[Ee]:!0})),Ot=Ee=>V(gt=>({...gt,[Ee]:!1})),jt=Ee=>be(gt=>({...gt,[Ee]:!0})),Qt=Ee=>be(gt=>({...gt,[Ee]:!1})),Ft=Ee=>Xe(gt=>({...gt,[Ee]:!0})),$e=Ee=>Xe(gt=>({...gt,[Ee]:!1})),Fe=Ee=>J(gt=>({...gt,[Ee]:!0})),Ze=Ee=>J(gt=>({...gt,[Ee]:!1})),[Te,ee]=g.useState(""),[me,Re]=g.useState(""),[he,qe]=g.useState(""),[st,yt]=g.useState("1"),[pe,je]=g.useState("0"),[we,Ye]=g.useState("DATOS"),[xe,Se]=g.useState(""),[xt,Pt]=g.useState(1),It=15,Ut=g.useMemo(()=>Math.max(1,Math.ceil(x.length/It)),[x.length]);g.useEffect(()=>Pt(1),[x.length]);const Ht=g.useMemo(()=>{const Ee=(xt-1)*It;return x.slice(Ee,Ee+It)},[x,xt]),Le=g.useMemo(()=>{const Ee=new Set;for(const gt of A){const Zt=String(gt.category||"").trim();Zt&&Ee.add(Zt)}return Array.from(Ee).sort((gt,Zt)=>gt.localeCompare(Zt,"es"))},[A]);g.useEffect(()=>{!Te&&Le.length>0&&ee(Le[0])},[Le]);const Ce=async()=>{p(!0);try{const Ee=await $t(sr(bt(Pe,"products_candies"),In("createdAt","desc"))),gt=[];Ee.forEach(Zt=>{const Mr=Zt.data();gt.push({id:Zt.id,name:String(Mr.name??"").trim(),category:String(Mr.category??"").trim()||"Caramelo",providerPrice:Number(Mr.providerPrice??0),unitsPerPackage:Number(Mr.unitsPerPackage??1)})}),h(gt)}catch(Ee){console.error(Ee),n(" Error cargando catlogo de dulces.")}finally{p(!1)}};g.useEffect(()=>{Ce()},[t]);const Ae=g.useMemo(()=>(Te.trim().length>0?A.filter(gt=>gt.category===Te):A).sort((gt,Zt)=>gt.name.localeCompare(Zt.name,"es")),[A,Te]);g.useEffect(()=>{if(!me){qe(""),yt("1");return}const Ee=A.find(gt=>gt.id===me);Ee&&(qe(String(Ee.providerPrice??0)),yt(String(Ee.unitsPerPackage??1)))},[me,A]);const Qe=()=>{_(null),E(""),k(""),Ue([]),H({}),U({}),X({}),V({}),be({}),Xe({}),J({}),ee(Le[0]||""),Re(""),qe(""),je("0"),yt("1"),O("20"),oe("15"),ue("30"),ne("0"),Ye("DATOS"),Se("")},fe=()=>{if(n(""),!me){n("Selecciona un producto del catlogo.");return}const Ee=A.find(Ir=>Ir.id===me);if(!Ee){n("Producto de catlogo no encontrado (refresca).");return}const gt=Number(Ee.providerPrice||0),Zt=Hn(pe||0),Mr=Hn(Ee.unitsPerPackage||0);if(gt<0){n("El precio proveedor no puede ser negativo.");return}if(Zt<=0){n("Los paquetes deben ser mayor que 0.");return}if(Mr<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const Or=Number(P||0),ir=Number(z||0),br=Number(ce||0),wr=tp(gt,Zt,{marginR:Or,marginSJ:ir,marginIsla:br});if(Oe.find(Ir=>Ir.id===Ee.id))Ue(Ir=>Ir.map(Pr=>{if(Pr.id!==Ee.id)return Pr;const fn=Hn(Pr.packages||0)+Zt,de=tp(gt,fn,{marginR:Number(Pr.marginRivas??Or),marginSJ:Number(Pr.marginSanJorge??ir),marginIsla:Number(Pr.marginIsla??br)}),at=Hn(Pr.remainingPackages??Pr.packages)+Zt;return{...Pr,providerPrice:gt,unitsPerPackage:Mr,packages:fn,remainingPackages:at,...de}}));else{const Ir={id:Ee.id,name:Ee.name,category:Ee.category,providerPrice:gt,packages:Zt,unitsPerPackage:Mr,marginRivas:Or,marginSanJorge:ir,marginIsla:br,subtotal:wr.subtotal,totalRivas:wr.totalRivas,totalSanJorge:wr.totalSanJorge,totalIsla:wr.totalIsla,gainRivas:wr.gainRivas,gainSanJorge:wr.gainSanJorge,gainIsla:wr.gainIsla,unitPriceRivas:wr.unitPriceRivas,unitPriceSanJorge:wr.unitPriceSanJorge,unitPriceIsla:wr.unitPriceIsla,remainingPackages:Zt};Ue(Pr=>[...Pr,Ir])}Re(""),je("0"),Ye("ITEMS")},te=Ee=>{Ue(gt=>gt.filter(Zt=>Zt.id!==Ee))},_e=(Ee,gt,Zt)=>{Ue(Mr=>Mr.map(Or=>{if(Or.id!==Ee)return Or;let ir={...Or};if(gt==="packages"&&(ir.packages=Hn(Zt||0)),gt==="unitsPerPackage"&&(ir.unitsPerPackage=Hn(Zt||0)),gt==="remainingPackages"){const br=Math.max(0,Hn(ir.packages||0)),wr=Hn(Zt||0);ir.remainingPackages=Math.min(br,Math.max(0,wr))}if(gt==="unitPriceRivas"||gt==="unitPriceIsla"){const br=Math.max(0,Number(Zt)||0),wr=Math.max(0,Hn(ir.packages||0)),Xr=Number(ir.providerPrice||0)*wr,Ir=wr>0?br*wr:0;if(gt==="unitPriceRivas"){ir.unitPriceRivas=br,ir.totalRivas=Ir,ir.gainRivas=Ir-Xr;const Pr=Ir>0?(1-Xr/Ir)*100:0;ir.marginRivas=Math.min(Math.max(Pr,0),bE)}else{ir.unitPriceIsla=br,ir.totalIsla=Ir,ir.gainIsla=Ir-Xr;const Pr=Ir>0?(1-Xr/Ir)*100:0;ir.marginIsla=Math.min(Math.max(Pr,0),bE)}}if(gt==="marginRivas"&&(ir.marginRivas=Number(Zt||0)),gt==="marginIsla"&&(ir.marginIsla=Number(Zt||0)),gt==="marginSanJorge"&&(ir.marginSanJorge=Number(Zt||0)),gt==="packages"||gt==="marginRivas"||gt==="marginIsla"||gt==="marginSanJorge"){const br=tp(ir.providerPrice,ir.packages,{marginR:Number(ir.marginRivas||0),marginSJ:Number(ir.marginSanJorge||0),marginIsla:Number(ir.marginIsla||0)});ir={...ir,...br}}if(ir.remainingPackages===void 0||ir.remainingPackages===null)ir.remainingPackages=ir.packages;else if(gt==="packages"){const br=Hn(ir.remainingPackages);ir.remainingPackages=Math.min(br,Math.max(0,ir.packages))}return ir}))},R=g.useMemo(()=>{const Ee=Oe.reduce((ir,br)=>ir+Hn(br.packages),0),gt=Oe.reduce((ir,br)=>ir+Number(br.subtotal||0),0),Zt=Oe.reduce((ir,br)=>ir+Number(br.totalRivas||0),0),Mr=Oe.reduce((ir,br)=>ir+Number(br.totalSanJorge||0),0),Or=Oe.reduce((ir,br)=>ir+Number(br.totalIsla||0),0);return{totalPackages:Ee,subtotal:gt,totalRivas:Zt,totalSanJorge:Mr,totalIsla:Or}},[Oe]),Q=g.useMemo(()=>{const Ee=Math.max(0,Lf(ge||0)),gt=Number(R.subtotal||0),Zt=Oe.map(br=>sB(br,Ee,gt)),Mr=Zt.reduce((br,wr)=>br+Number(wr.grossProfit||0),0),Or=Zt.reduce((br,wr)=>br+Number(wr.grossProfitIsla||0),0),ir=Zt.reduce((br,wr)=>br+Number(wr.logisticAllocated||0),0);return{items:Zt,logisticsTotal:Ee,grossTotal:Mr,grossIslaTotal:Or,logisticAllocatedTotal:ir}},[Oe,ge,R.subtotal]),G=g.useMemo(()=>{const Ee=String(xe||"").trim().toLowerCase();return Ee?Q.items.filter(gt=>{const Zt=String(gt.name||"").toLowerCase(),Mr=String(gt.category||"").toLowerCase();return Zt.includes(Ee)||Mr.includes(Ee)}):Q.items},[Q.items,xe]),[se,Ne]=g.useState(1),Me=15,ze=g.useMemo(()=>Math.max(1,Math.ceil(G.length/Me)),[G.length]);g.useEffect(()=>Ne(1),[G.length]);const Ie=g.useMemo(()=>{const Ee=(se-1)*Me;return G.slice(Ee,Ee+Me)},[G,se]),[nt,lt]=g.useState({});g.useEffect(()=>lt({}),[G.length]);const[ht,kt]=g.useState({});g.useEffect(()=>{const Ee={};for(const gt of x)gt&&gt.id&&(Ee[gt.id]=!1);kt(Ee)},[x]);const le=g.useMemo(()=>({totalPackages:R.totalPackages,subtotalCosto:R.subtotal,esperadoRivas:R.totalRivas,esperadoIsla:R.totalIsla,gastosLogisticos:Q.logisticsTotal,utilidadBrutaRivas:Q.grossTotal,utilidadBrutaIsla:Q.grossIslaTotal}),[R,Q]),We=()=>{if(n(""),!A.length){n(" No hay catlogo cargado para generar plantilla.");return}const Ee=Number(P||0),gt=Number(ce||0),Zt=A.slice().sort((Xr,Ir)=>Xr.name.localeCompare(Ir.name,"es")).map(Xr=>({Producto:Xr.name,Paquetes:"","Margen rivas":Ee,"Margen Isla":gt,"P. unidad Rivas":"","P. unidad Isla":""})),Mr=[{Campo:"Gastos logisticos",Valor:Lf(ge||0)}],Or=Qa.book_new(),ir=Qa.json_to_sheet(Zt),br=Qa.json_to_sheet(Mr);Qa.book_append_sheet(Or,ir,"Productos"),Qa.book_append_sheet(Or,br,"Config");const wr=B&&String(B).trim()||new Date().toISOString().slice(0,10);V2(Or,`plantilla_orden_maestra_${wr}.xlsx`)},it=()=>{if(n(""),!Q.items.length){n(" No hay items para exportar.");return}const Ee=Q.items.slice().sort((ir,br)=>ir.name.localeCompare(br.name,"es")).map(ir=>({Categora:ir.category,Producto:ir.name,Paquetes:Hn(ir.packages),"Paquetes restantes":Hn(ir.remainingPackages??ir.packages),"Und x Paquete":Hn(ir.unitsPerPackage),"Precio proveedor":Number(ir.providerPrice||0),Facturado:Number(ir.subtotal||0),"Esperado Rivas":Number(ir.totalRivas||0),"Esperado Isla":Number(ir.totalIsla||0),"MV Rivas":Number(ir.marginRivas||0),"MV Isla":Number(ir.marginIsla||0),"Utilidad Bruta":Number(ir.grossProfit||0),"Utilidad Bruta Isla":Number(ir.grossProfitIsla||0),"Prorrateo logistico":Number(ir.logisticAllocated||0),"Precio Rivas":Number(ir.unitPriceRivas||0),"Precio Isla":Number(ir.unitPriceIsla||0)})),gt=[{KPI:"Paquetes totales",Valor:le.totalPackages},{KPI:"Subtotal costo",Valor:le.subtotalCosto},{KPI:"Esperado Rivas",Valor:le.esperadoRivas},{KPI:"Esperado Isla",Valor:le.esperadoIsla},{KPI:"Gastos logsticos",Valor:le.gastosLogisticos},{KPI:"Utilidad Bruta Rivas",Valor:le.utilidadBrutaRivas},{KPI:"Utilidad Bruta Isla",Valor:le.utilidadBrutaIsla}],Zt=Qa.book_new();Qa.book_append_sheet(Zt,Qa.json_to_sheet(Ee),"Productos"),Qa.book_append_sheet(Zt,Qa.json_to_sheet(gt),"Resumen");const Mr=B&&String(B).trim()||new Date().toISOString().slice(0,10),Or=S&&String(S).trim()||`Orden_${Mr}`;V2(Zt,`orden_maestra_${Or.replace(/[^\w\-]+/g,"_")}_${Mr}.xlsx`)},ot=g.useRef(null),[Nt,Rt]=g.useState(!1),nr=()=>{var Ee;if(!A.length){n(" Catlogo no cargado todava. Esper y prob de nuevo.");return}(Ee=ot.current)==null||Ee.click()},_r=async Ee=>{var Zt;const gt=(Zt=Ee.target.files)==null?void 0:Zt[0];if(gt){Ee.target.value="",Rt(!0),n("");try{const Mr=await gt.arrayBuffer(),Or=Vv(Mr,{type:"array"}),ir=Or.SheetNames||[],br=Or.Sheets.Productos||Or.Sheets.Plantilla||Or.Sheets[ir[0]];if(!br){n(" No se encontr hoja de Productos/Plantilla.");return}const wr=Qa.sheet_to_json(br,{defval:""});if(!wr.length){n(" El Excel viene vaco.");return}let Xr=0;const Ir=Or.Sheets.Config;if(Ir){const at=Qa.sheet_to_json(Ir,{defval:""}),ct=new Map;for(const ye of at){const ft=Ub(kh(ye,["Campo","Key","Nombre"])??""),St=kh(ye,["Valor","Value"]);ft&&ct.set(ft,St)}ct.has("gastos logisticos")&&(Xr=Math.max(0,Lf(ct.get("gastos logisticos"))))}else for(const at of wr){const ct=kh(at,["Gastos","Gasto","Gastos logisticos","Logistica"]),ye=Lf(ct);if(ye>0){Xr=ye;break}}ne(String(Xr||0));const Pr=new Map;for(const at of A)Pr.set(Ub(at.name),at);const fn=[],de=new Map;for(let at=0;at<wr.length;at++){const ct=wr[at],ye=kh(ct,["Producto","Product","Nombre","Name"]),ft=kh(ct,["Paquetes","Packages"]),St=kh(ct,["Margen rivas","Margen Rivas","MV Rivas"]),wt=kh(ct,["Margen Isla","Margen isla","MV Isla"]),vt=kh(ct,["P. unidad Rivas","P unidad Rivas","Precio Rivas"]),Et=kh(ct,["P. unidad Isla","P unidad Isla","Precio Isla"]),qt=Ub(ye);if(!qt)continue;const Mt=Pr.get(qt);if(!Mt){fn.push(`Fila ${at+2}: Producto no existe en catlogo: "${String(ye).trim()}".`);continue}const Xt=Math.floor(Lf(ft));if(Xt<=0){fn.push(`Fila ${at+2}: "Paquetes" invlido para "${Mt.name}".`);continue}const ar=String(St??"").trim()!==""?Lf(St):Number(P||0),vr=String(wt??"").trim()!==""?Lf(wt):Number(ce||0),ur=Math.floor(Lf(vt)),Dt=Math.floor(Lf(Et)),Yr=de.get(Mt.id);Yr?de.set(Mt.id,{packages:Yr.packages+Xt,mR:ar,mI:vr,puR:ur>0?ur:Yr.puR,puI:Dt>0?Dt:Yr.puI}):de.set(Mt.id,{packages:Xt,mR:ar,mI:vr,puR:ur>0?ur:void 0,puI:Dt>0?Dt:void 0})}const tt=[];de.forEach((at,ct)=>{const ye=A.find(Dt=>Dt.id===ct);if(!ye)return;const ft=Number(ye.providerPrice||0),St=Math.max(1,Hn(ye.unitsPerPackage||1)),wt=Math.max(1,Hn(at.packages)),vt=ft*wt,Et=Number(at.puR||0),qt=Number(at.puI||0),Mt=Et>0||qt>0;let Xt=at.mR,ar=at.mI;const vr=Number(z||0);let ur;if(Mt){const Dt=tp(ft,wt,{marginR:Xt,marginSJ:vr,marginIsla:ar}),Yr=Et>0?Et*wt:Dt.totalRivas,Vr=qt>0?qt*wt:Dt.totalIsla,Sr=pr=>{if(!Number.isFinite(pr)||pr<=0)return 0;const jr=(1-vt/pr)*100;return Math.min(Math.max(jr,0),bE)};Et>0&&(Xt=Sr(Yr)),qt>0&&(ar=Sr(Vr)),ur={subtotal:vt,totalRivas:Yr,totalSanJorge:Dt.totalSanJorge,totalIsla:Vr,gainRivas:Yr-vt,gainSanJorge:Dt.gainSanJorge,gainIsla:Vr-vt,unitPriceRivas:wt>0?Lb(Yr/wt):0,unitPriceSanJorge:Dt.unitPriceSanJorge,unitPriceIsla:wt>0?Lb(Vr/wt):0}}else ur=tp(ft,wt,{marginR:Xt,marginSJ:vr,marginIsla:ar});tt.push({id:ye.id,name:ye.name,category:ye.category,providerPrice:ft,packages:wt,unitsPerPackage:St,marginRivas:Xt,marginSanJorge:vr,marginIsla:ar,subtotal:ur.subtotal,totalRivas:ur.totalRivas,totalSanJorge:ur.totalSanJorge,totalIsla:ur.totalIsla,gainRivas:ur.gainRivas,gainSanJorge:ur.gainSanJorge,gainIsla:ur.gainIsla,unitPriceRivas:ur.unitPriceRivas,unitPriceSanJorge:ur.unitPriceSanJorge,unitPriceIsla:ur.unitPriceIsla,remainingPackages:wt})}),Ue(at=>{const ct=new Map;at.forEach(ye=>ct.set(ye.id,ye));for(const ye of tt){const ft=ct.get(ye.id);if(!ft)ct.set(ye.id,ye);else{const St=Hn(ft.packages)+Hn(ye.packages),wt=tp(ft.providerPrice,St,{marginR:ye.marginRivas,marginSJ:Number(ft.marginSanJorge||0),marginIsla:ye.marginIsla});ct.set(ye.id,{...ft,packages:St,marginRivas:ye.marginRivas,marginIsla:ye.marginIsla,remainingPackages:Hn(ft.remainingPackages??ft.packages)+Hn(ye.packages),...wt})}}return Array.from(ct.values()).sort((ye,ft)=>ye.name.localeCompare(ft.name,"es"))}),Ye("ITEMS"),fn.length?(n(` Importado con detalles. Errores: ${fn.length}.`),console.warn("Errores import:",fn)):n(` Importacin lista: ${tt.length} productos agregados.`)}catch(Mr){console.error(Mr),n(" Error importando Excel. Revis hojas: Productos + Config (o Plantilla).")}finally{Rt(!1)}}};g.useEffect(()=>{(async()=>{s(!0);try{const Ee=sr(bt(Pe,"candy_main_orders"),In("createdAt","desc")),gt=await $t(Ee),Zt=[];gt.forEach(ir=>{const br=ir.data();Zt.push({id:ir.id,name:br.name??"",date:br.date??"",totalPackages:Number(br.totalPackages??0),subtotal:Number(br.subtotal??0),totalRivas:Number(br.totalRivas??0),totalSanJorge:Number(br.totalSanJorge??0),totalIsla:Number(br.totalIsla??0),marginRivas:Number(br.marginRivas??20),marginSanJorge:Number(br.marginSanJorge??15),marginIsla:Number(br.marginIsla??30),logisticsCost:Number(br.logisticsCost??0),createdAt:br.createdAt??xr.now()})}),v(Zt);const Mr=await $t(bt(Pe,"inventory_candies")),Or={};Mr.forEach(ir=>{const br=ir.data(),wr=br.orderId;if(!wr)return;const Xr=ZQe(br),Ir=bK(br);Or[wr]||(Or[wr]={orderId:wr,totalPackages:0,remainingPackages:0}),Or[wr].totalPackages+=Xr,Or[wr].remainingPackages+=Ir}),b(Or)}catch(Ee){console.error(Ee),n(" Error cargando pedidos generales.")}finally{s(!1)}})()},[t]);const $r=Ee=>{var gt;return Ee.date?Ee.date:(gt=Ee.createdAt)!=null&&gt.toDate?Ee.createdAt.toDate().toISOString().slice(0,10):""},or=async Ee=>{if(Ee.preventDefault(),n(""),l(!0),!Oe.length){n("Agrega al menos un producto a la orden.");return}try{const gt=new Date().toISOString().slice(0,10),Zt=B||gt,Mr=Number(P||0),Or=Number(z||0),ir=Number(ce||0),br=Math.max(0,Lf(ge||0));for(const at of Oe){if(!String(at.name||"").trim()){n("Hay un producto sin nombre en el pedido.");return}if(Number(at.providerPrice||0)<0){n(`El precio proveedor no puede ser negativo (producto: ${at.name}).`);return}if(Hn(at.packages)<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${at.name}).`);return}if(Hn(at.unitsPerPackage)<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${at.name}).`);return}}const wr=Number(R.subtotal||0),Xr=Oe.map(at=>sB(at,br,wr)),Ir={totalPackages:R.totalPackages,subtotal:R.subtotal,totalRivas:R.totalRivas,totalSanJorge:R.totalSanJorge,totalIsla:R.totalIsla},Pr={name:S||`Pedido ${Zt}`,date:Zt,totalPackages:Ir.totalPackages,subtotal:Ir.subtotal,totalRivas:Ir.totalRivas,totalSanJorge:Ir.totalSanJorge,totalIsla:Ir.totalIsla,marginRivas:Mr,marginSanJorge:Or,marginIsla:ir,logisticsCost:br,uBrutaGlobal:Q.grossTotal,items:Xr};if(I){await Fn(er(Pe,"candy_main_orders",I),{...Pr});for(const ye of Xr){const ft=await $t(sr(bt(Pe,"inventory_candies"),Ar("orderId","==",I),Ar("productId","==",ye.id))),St=Math.max(1,Hn(ye.unitsPerPackage||1)),wt=Hn(ye.packages)*St,vt=Math.min(Hn(ye.remainingPackages??ye.packages),Hn(ye.packages)),Et=Math.max(0,vt*St);if(ft.empty)await Zn(bt(Pe,"inventory_candies"),{productId:ye.id,productName:ye.name,category:ye.category,measurement:"unidad",quantity:wt,remaining:Et,packages:Hn(ye.packages),remainingPackages:vt,unitsPerPackage:St,totalUnits:wt,providerPrice:ye.providerPrice,subtotal:ye.subtotal,totalRivas:ye.totalRivas,totalSanJorge:ye.totalSanJorge,totalIsla:ye.totalIsla,gainRivas:ye.gainRivas,gainSanJorge:ye.gainSanJorge,gainIsla:ye.gainIsla,unitPriceRivas:ye.unitPriceRivas,unitPriceSanJorge:ye.unitPriceSanJorge,unitPriceIsla:ye.unitPriceIsla,date:Zt,createdAt:xr.now(),status:"PENDIENTE",orderId:I});else for(const qt of ft.docs)await Fn(er(Pe,"inventory_candies",qt.id),{productName:ye.name,category:ye.category,unitsPerPackage:St,totalUnits:wt,quantity:wt,remaining:Et,packages:Hn(ye.packages),remainingPackages:vt,providerPrice:ye.providerPrice,subtotal:ye.subtotal,totalRivas:ye.totalRivas,totalSanJorge:ye.totalSanJorge,totalIsla:ye.totalIsla,gainRivas:ye.gainRivas,gainSanJorge:ye.gainSanJorge,gainIsla:ye.gainIsla,unitPriceRivas:ye.unitPriceRivas,unitPriceSanJorge:ye.unitPriceSanJorge,unitPriceIsla:ye.unitPriceIsla,date:Zt})}const at=await $t(sr(bt(Pe,"inventory_candies"),Ar("orderId","==",I))),ct=new Set(Xr.map(ye=>ye.id));for(const ye of at.docs){const ft=ye.data(),St=String(ft.productId||"");St&&!ct.has(St)&&await qn(er(Pe,"inventory_candies",ye.id))}v(ye=>ye.map(ft=>ft.id===I?{...ft,name:Pr.name,date:Pr.date,totalPackages:Pr.totalPackages,subtotal:Pr.subtotal,totalRivas:Pr.totalRivas,totalSanJorge:Pr.totalSanJorge,totalIsla:Pr.totalIsla,marginRivas:Pr.marginRivas,marginSanJorge:Pr.marginSanJorge,marginIsla:Pr.marginIsla,logisticsCost:Pr.logisticsCost}:ft)),n(" Orden maestra actualizada (pedido + inventario)."),Qe(),j(!1),e();return}const de=(await Zn(bt(Pe,"candy_main_orders"),{...Pr,createdAt:xr.now()})).id,tt=tu(Pe);for(const at of Xr){const ct=Math.max(1,Hn(at.unitsPerPackage||1)),ye=Hn(at.packages)*ct,ft=Math.min(Hn(at.remainingPackages??at.packages),Hn(at.packages)),St=Math.max(0,ft*ct),wt=er(bt(Pe,"inventory_candies"));tt.set(wt,{productId:at.id,productName:at.name,category:at.category,measurement:"unidad",quantity:ye,remaining:St,packages:Hn(at.packages),remainingPackages:ft,unitsPerPackage:ct,totalUnits:ye,providerPrice:at.providerPrice,subtotal:at.subtotal,totalRivas:at.totalRivas,totalSanJorge:at.totalSanJorge,totalIsla:at.totalIsla,gainRivas:at.gainRivas,gainSanJorge:at.gainSanJorge,gainIsla:at.gainIsla,unitPriceRivas:at.unitPriceRivas,unitPriceSanJorge:at.unitPriceSanJorge,unitPriceIsla:at.unitPriceIsla,date:Zt,createdAt:xr.now(),status:"PENDIENTE",orderId:de})}await tt.commit(),n(" Orden maestra creada y registrada en inventario."),Qe(),j(!1),e()}catch(gt){console.error(gt),n(" Error al guardar orden maestra.")}finally{l(!1)}},kr=async Ee=>{try{s(!0),n(""),_(Ee.id),E(Ee.name),k(Ee.date),O(String(Ee.marginRivas??20)),oe(String(Ee.marginSanJorge??15)),ue(String(Ee.marginIsla??30));const gt=Number(Ee.logisticsCost??0);ne(String(gt||0)),Ye("DATOS");const Zt=er(Pe,"candy_main_orders",Ee.id),Mr=await zs(Zt);if(!Mr.exists()){n(" No se encontr la orden.");return}const Or=Mr.data(),ir=Array.isArray(Or.items)?Or.items:[],br=await $t(sr(bt(Pe,"inventory_candies"),Ar("orderId","==",Ee.id))),wr={};br.forEach(Ir=>{const Pr=Ir.data(),fn=String(Pr.productId||"");if(!fn)return;const de=bK(Pr);wr[fn]=(wr[fn]||0)+de});const Xr=ir.map(Ir=>{const Pr=A.find(ft=>ft.id===Ir.id),fn=Number((Pr==null?void 0:Pr.providerPrice)??Ir.providerPrice??0),de=Math.max(1,Hn((Pr==null?void 0:Pr.unitsPerPackage)??Ir.unitsPerPackage??1)),tt=Number(Ir.marginRivas??0),at=Number(Ir.marginSanJorge??Number(z||0)),ct=Number(Ir.marginIsla??0),ye=tp(fn,Hn(Ir.packages||0),{marginR:tt,marginSJ:at,marginIsla:ct});return{...Ir,name:String((Pr==null?void 0:Pr.name)??Ir.name??"").trim(),category:String((Pr==null?void 0:Pr.category)??Ir.category??"Caramelo").trim(),providerPrice:fn,unitsPerPackage:de,remainingPackages:wr[Ir.id]??Ir.remainingPackages??Ir.packages??0,...ye}});Ue(Xr),j(!0)}catch(gt){console.error(gt),n(" Error al abrir orden maestra.")}finally{s(!1)}},en=async Ee=>{if(confirm(`Eliminar la orden "${Ee.name}" y todo su inventario asociado?`)){n("");try{const Zt=await $t(sr(bt(Pe,"inventory_candies"),Ar("orderId","==",Ee.id)));for(const Mr of Zt.docs)await qn(er(Pe,"inventory_candies",Mr.id));await qn(er(Pe,"candy_main_orders",Ee.id)),v(Mr=>Mr.filter(Or=>Or.id!==Ee.id)),n(" Orden maestra eliminada."),e()}catch(Zt){console.error(Zt),n(" Error al eliminar orden maestra.")}}},rn=async()=>{if(!c)try{u(!0),n("");const Ee=await $t(bt(Pe,"candy_main_orders"));let gt=tu(Pe),Zt=0,Mr=0;const Or=(ir,br)=>Math.abs(Number(ir||0)-Number(br||0))>.01;Ee.forEach(ir=>{const br=ir.data(),wr=Array.isArray(br.items)?br.items:[];if(!wr.length)return;const Xr=wr.reduce((at,ct)=>at+Number(ct.subtotal||0),0);let Ir=Number(br.logisticsCost??br.gastosLogisticos??br.gastos??0);if(Number.isFinite(Ir)||(Ir=0),!Ir){const at=wr.reduce((ct,ye)=>ct+Number(ye.logisticAllocated??0),0);Ir=Number(at||0)}const Pr=wr.map(at=>sB(at,Ir,Xr)),fn=Pr.reduce((at,ct)=>at+Number(ct.grossProfit||0),0);if(!(Or(br.logisticsCost,Ir)||Or(br.uBrutaGlobal,fn)||Pr.some((at,ct)=>{const ye=wr[ct]||{};return Or(ye.logisticAllocated,at.logisticAllocated)||Or(ye.grossProfit,at.grossProfit)||Or(ye.grossProfitIsla,at.grossProfitIsla)})))return;const tt=er(Pe,"candy_main_orders",ir.id);gt.update(tt,{logisticsCost:Ir,uBrutaGlobal:fn,items:Pr,updatedAt:xr.now()}),Zt+=1,Mr+=1,Zt>=400&&(gt.commit(),gt=tu(Pe),Zt=0)}),Zt>0&&await gt.commit(),n(` Ordenes maestras actualizadas: ${Mr}`),e()}catch(Ee){console.error(Ee),n(" Error actualizando prorrateo de rdenes maestras.")}finally{u(!1)}},Er=async()=>{if(I&&!d)try{f(!0),n("");const Ee=await gF(I);Ee.created>0||Ee.updated>0?n(` Inventario listo: ${Ee.created} creados, ${Ee.updated} reparados (de ${Ee.totalItems}).`):Ee.totalItems>0?n(" No haba inventario faltante para crear o reparar."):n(" La orden no tiene items para crear inventario."),e()}catch(Ee){console.error(Ee),n(" Error creando inventario faltante.")}finally{f(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"})}),i.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[i.jsx("div",{}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Oc,{onClick:e,loading:a||m}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-gray-200 text-gray-800 px-2 md:px-3 py-2 rounded-2xl hover:bg-gray-300 disabled:opacity-60",onClick:rn,disabled:c,children:c?"Actualizando prorrateo...":"Actualizar prorrateo"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-2 md:px-3 py-2 rounded-2xl hover:bg-indigo-700 w-full md:w-auto max-w-[220px] justify-center",onClick:()=>{Qe(),j(!0)},children:[i.jsx("span",{className:"items-center gap-4 inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Orden"]})]})]}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]}),w&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"relative bg-white p-4 md:p-6 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[o&&i.jsx("div",{className:"absolute inset-0 bg-white/70 z-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white border rounded-xl px-4 py-3 shadow flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-semibold",children:"Guardando orden"})]})}),i.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-3 border-b",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h3",{className:"text-lg md:text-xl font-bold",children:I?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[I&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",disabled:o||d,onClick:Er,children:d?"Creando inventario...":"Crear inventario faltante"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:o,onClick:()=>{Qe(),j(!1)},children:"Cerrar"})]})]}),i.jsx("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-1 gap-2",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold",children:"Gastos logsticos (orden)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:ge,onChange:Ee=>ne(Ee.target.value),placeholder:"0",min:0})]})}),i.jsx("div",{className:"md:hidden mt-3",children:i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[i.jsx("button",{type:"button",onClick:()=>Ye("DATOS"),className:`px-2 py-2 rounded text-xs font-semibold border ${we==="DATOS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Datos"}),i.jsx("button",{type:"button",onClick:()=>Ye("AGREGAR"),className:`px-2 py-2 rounded text-xs font-semibold border ${we==="AGREGAR"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Agregar"}),i.jsxs("button",{type:"button",onClick:()=>Ye("ITEMS"),className:`px-2 py-2 rounded text-xs font-semibold border ${we==="ITEMS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:["Items (",Oe.length,")"]}),i.jsx("button",{type:"button",onClick:()=>Ye("TOTALES"),className:`px-2 py-2 rounded text-xs font-semibold border ${we==="TOTALES"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Totales"})]})})]}),i.jsxs("form",{onSubmit:or,className:"space-y-4 pt-4",children:[i.jsx("input",{ref:ot,type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:_r}),i.jsx("div",{className:`${we==="DATOS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:S,onChange:Ee=>E(Ee.target.value),placeholder:"Ej: Pedido enero 19"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:Ee=>k(Ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:P,onChange:Ee=>O(Ee.target.value)})]}),i.jsx("input",{type:"hidden",value:z,readOnly:!0}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:ce,onChange:Ee=>ue(Ee.target.value)})]})]})}),i.jsx("div",{className:`${we==="AGREGAR"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:Te,onChange:Ee=>{ee(Ee.target.value),Re("")},disabled:m,children:Le.length===0?i.jsx("option",{value:"",children:m?"Cargando...":"No hay categoras en catlogo"}):Le.map(Ee=>i.jsx("option",{value:Ee,children:Ee},Ee))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:me,onChange:Ee=>Re(Ee.target.value),children:[i.jsx("option",{value:"",children:m?"Cargando catlogo...":"Selecciona producto"}),Ae.map(Ee=>i.jsx("option",{value:Ee.id,children:Ee.name},Ee.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:he,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:pe,onChange:Ee=>je(Ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:st,readOnly:!0})]})]}),i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-end gap-2 mt-3",children:i.jsx("button",{type:"button",onClick:fe,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto"})})]})}),i.jsxs("div",{className:"hidden md:flex items-center justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:We,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",title:"Descarga plantilla (Productos + Config)",children:"Descargar plantilla"}),i.jsx("button",{type:"button",onClick:nr,disabled:Nt,className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",title:"Importa desde Excel (Productos + Config)",children:Nt?"Importando...":"Importar Excel"}),i.jsx("button",{type:"button",onClick:it,className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",title:"Exporta la orden actual (Productos + Resumen)",children:"Exportar Excel"})]}),i.jsx("div",{className:`${we==="ITEMS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"mb-2 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Items:"," ",i.jsx("span",{className:"font-semibold",children:Oe.length}),xe.trim()?i.jsxs(i.Fragment,{children:[" "," Mostrando"," ",i.jsx("span",{className:"font-semibold",children:G.length})]}):null]}),i.jsx("input",{value:xe,onChange:Ee=>Se(Ee.target.value),placeholder:"Buscar producto o categora",className:"w-full md:w-80 border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsx("div",{className:"overflow-x-auto border rounded pb-5",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2",children:"Categora"}),i.jsx("th",{className:"text-left p-2",children:"Producto"}),i.jsx("th",{className:"text-right p-2",children:"Paquetes"}),i.jsx("th",{className:"text-right p-2",children:"Restantes"}),i.jsx("th",{className:"text-right p-2",children:"Und x Paq"}),i.jsx("th",{className:"text-right p-2",children:"Precio prov"}),i.jsx("th",{className:"text-right p-2",children:"Facturado"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Isla"}),i.jsx("th",{className:"text-right p-2",children:"MV Rivas"}),i.jsx("th",{className:"text-right p-2",children:"MV Isla"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Rivas"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Isla"}),i.jsx("th",{className:"text-right p-2",children:"Prorrateo"}),i.jsx("th",{className:"text-right p-2",children:"Precio Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Precio Isla"}),i.jsx("th",{className:"text-center p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Ie.map(Ee=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Ee.category}),i.jsx("td",{className:"p-2 font-semibold",children:Ee.name}),i.jsx("td",{className:"p-2 text-right",children:F[Ee.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Ee.packages,onChange:gt=>_e(Ee.id,"packages",gt.target.value),onBlur:()=>ie(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&ie(Ee.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Ee.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>De(Ee.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:W[Ee.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Hn(Ee.remainingPackages??Ee.packages),onChange:gt=>_e(Ee.id,"remainingPackages",gt.target.value),onBlur:()=>_t(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&_t(Ee.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Hn(Ee.remainingPackages??Ee.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>dt(Ee.id),"aria-label":"Editar paquetes restantes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:K[Ee.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Ee.unitsPerPackage,onChange:gt=>_e(Ee.id,"unitsPerPackage",gt.target.value),onBlur:()=>Ge(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ge(Ee.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Ee.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>He(Ee.id),"aria-label":"Editar unidades por paquete",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(Ee.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Ee.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Ee.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Ee.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:L[Ee.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(Ee.marginRivas??0),onChange:gt=>_e(Ee.id,"marginRivas",gt.target.value),onBlur:()=>$e(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&$e(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Ee.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ft(Ee.id),"aria-label":"Editar margen Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:re[Ee.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(Ee.marginIsla??0),onChange:gt=>_e(Ee.id,"marginIsla",gt.target.value),onBlur:()=>Ze(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ze(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Ee.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Fe(Ee.id),"aria-label":"Editar margen Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(Ee.grossProfit||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Ee.grossProfitIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Ee.logisticAllocated||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:D[Ee.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(Ee.unitPriceRivas||0),onChange:gt=>_e(Ee.id,"unitPriceRivas",gt.target.value),onBlur:()=>Ot(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ot(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Ee.unitPriceRivas||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Bt(Ee.id),"aria-label":"Editar precio Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Z[Ee.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(Ee.unitPriceIsla||0),onChange:gt=>_e(Ee.id,"unitPriceIsla",gt.target.value),onBlur:()=>Qt(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Qt(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Ee.unitPriceIsla||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>jt(Ee.id),"aria-label":"Editar precio Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>te(Ee.id),children:"Quitar"})})]},Ee.id)),G.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center text-gray-500",children:"No hay productos en la orden."})})]})]})}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando"," ",Math.min((se-1)*Me+1,G.length),"-",Math.min(se*Me,G.length)," ","de ",G.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:se<=1,onClick:()=>Ne(Ee=>Math.max(1,Ee-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[se," / ",ze]}),i.jsx("button",{type:"button",disabled:se>=ze,onClick:()=>Ne(Ee=>Math.min(ze,Ee+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]}),i.jsx("div",{className:"md:hidden space-y-3",children:G.length===0?i.jsx("div",{className:"p-4 border rounded bg-gray-50 text-gray-600",children:"No hay productos en esta orden."}):G.map(Ee=>i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-base leading-tight truncate",children:Ee.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:Ee.category})]}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>te(Ee.id),children:"Quitar"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),F[Ee.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:Ee.packages,onChange:gt=>_e(Ee.id,"packages",gt.target.value),onBlur:()=>ie(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&ie(Ee.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Ee.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>De(Ee.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes restantes"}),W[Ee.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Hn(Ee.remainingPackages??Ee.packages),onChange:gt=>_e(Ee.id,"remainingPackages",gt.target.value),onBlur:()=>_t(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&_t(Ee.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Hn(Ee.remainingPackages??Ee.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>dt(Ee.id),"aria-label":"Editar paquetes restantes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Und x Paquete"}),K[Ee.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:Ee.unitsPerPackage,onChange:gt=>_e(Ee.id,"unitsPerPackage",gt.target.value),onBlur:()=>Ge(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ge(Ee.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Ee.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>He(Ee.id),"aria-label":"Editar unidades por paquete",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Number(Ee.providerPrice||0).toFixed(2),readOnly:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Rivas (%)"}),L[Ee.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Ee.marginRivas??0,onChange:gt=>_e(Ee.id,"marginRivas",gt.target.value),onBlur:()=>$e(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&$e(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(Ee.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ft(Ee.id),"aria-label":"Editar margen Rivas",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Isla (%)"}),re[Ee.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Ee.marginIsla??0,onChange:gt=>_e(Ee.id,"marginIsla",gt.target.value),onBlur:()=>Ze(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ze(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(Ee.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Fe(Ee.id),"aria-label":"Editar margen Isla",children:""})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Facturado"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.subtotal||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.totalIsla||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prorrateo logstico"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.logisticAllocated||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.grossProfit||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.grossProfitIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Rivas (paq)"}),D[Ee.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(Ee.unitPriceRivas||0),onChange:gt=>_e(Ee.id,"unitPriceRivas",gt.target.value),onBlur:()=>Ot(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ot(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Ee.unitPriceRivas}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Bt(Ee.id),"aria-label":"Editar precio Rivas",children:""})]})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Isla (paq)"}),Z[Ee.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(Ee.unitPriceIsla||0),onChange:gt=>_e(Ee.id,"unitPriceIsla",gt.target.value),onBlur:()=>Qt(Ee.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Qt(Ee.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Ee.unitPriceIsla}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>jt(Ee.id),"aria-label":"Editar precio Isla",children:""})]})]})]})]},Ee.id))})]})}),i.jsxs("div",{className:`${we==="TOTALES"?"block":"hidden"} md:block`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"text-lg font-semibold",children:le.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (facturado)"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(le.subtotalCosto||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado (Rivas / Isla)"}),i.jsxs("div",{className:"text-sm font-semibold",children:["Rivas: ",Number(le.esperadoRivas||0).toFixed(2),i.jsx("br",{}),"Isla: ",Number(le.esperadoIsla||0).toFixed(2)]})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos logsticos"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(le.gastosLogisticos||0).toFixed(2)})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Rivas"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(le.utilidadBrutaRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Isla"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(le.utilidadBrutaIsla||0).toFixed(2)})]})]}),i.jsx("div",{className:"mt-3 border rounded p-3 bg-white",children:i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:it,disabled:!Q.items.length,title:"Exporta la orden actual (productos + resumen)",children:"Exportar orden a Excel"})})})]})]}),i.jsxs("div",{className:"sticky bottom-0 bg-white pt-3 mt-4 border-t",children:[i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:Qe,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{Qe(),j(!1)},className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:o||Oe.length===0,children:o?"Guardando...":"Guardar orden"})]}),i.jsx("div",{className:"md:hidden mt-2",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>{Ye(we==="DATOS"&&!I?"AGREGAR":we==="DATOS"||we==="AGREGAR"?"ITEMS":we==="ITEMS"?"TOTALES":"DATOS")},children:"Siguiente"})})]})]})]})}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"md:hidden space-y-3",children:a?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Cargando"}):x.length===0?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Sin ordenes maestras."}):x.map(Ee=>{const gt=y[Ee.id],Zt=$r(Ee),Mr=Ee.totalPackages>0?(Ee.subtotal/Ee.totalPackages).toFixed(2):"0.00",Or=Number(Ee.logisticsCost||0),ir=Number(Ee.totalRivas||0)-Number(Ee.subtotal||0);return i.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-xs text-gray-500",children:Zt}),i.jsx("div",{className:"font-semibold text-base leading-tight",children:Ee.name})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-xs",onClick:()=>kr(Ee),children:"Ver"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>en(Ee),children:"Borrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:Ee.totalPackages})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:gt?gt.remainingPackages:0})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Proveedor"}),i.jsx("div",{className:"font-semibold",children:Mr})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.subtotal||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Ee.totalIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Gastos log."}),i.jsx("div",{className:"font-semibold",children:Or.toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta (est)"}),i.jsx("div",{className:"font-semibold",children:ir.toFixed(2)})]})]})]},Ee.id)})}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Esperado Rivas"}),i.jsx("th",{className:"p-2 border",children:"Esperado Isla"}),i.jsx("th",{className:"p-2 border",children:"Gastos log."}),i.jsx("th",{className:"p-2 border",children:"U. Bruta (est)"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin ordenes maestras."})}):Ht.map(Ee=>{const gt=y[Ee.id],Zt=$r(Ee),Mr=Ee.totalPackages>0?(Ee.subtotal/Ee.totalPackages).toFixed(2):"0.00",Or=Number(Ee.logisticsCost||0),ir=Number(Ee.totalRivas||0)-Number(Ee.subtotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Zt}),i.jsx("td",{className:"p-2 border text-left",children:Ee.name}),i.jsx("td",{className:"p-2 border",children:Ee.totalPackages}),i.jsx("td",{className:"p-2 border",children:gt?gt.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:Mr}),i.jsx("td",{className:"p-2 border",children:Number(Ee.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(Ee.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(Ee.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Or.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:ir.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>kr(Ee),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>en(Ee),children:"Borrar"})]})})]},Ee.id)})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",Math.min((xt-1)*It+1,x.length),"-",Math.min(xt*It,x.length)," de ",x.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:xt<=1,onClick:()=>Pt(Ee=>Math.max(1,Ee-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[xt," / ",Ut]}),i.jsx("button",{type:"button",disabled:xt>=Ut,onClick:()=>Pt(Ee=>Math.min(Ut,Ee+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]})]})]})}const y0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function iB(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),a=r*e,s=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),u=a*(1+o/100),d=a*(1+l/100),f=a*(1+c/100),A=u-a,h=d-a,m=f-a,p=u/s,x=d/s,v=f/s;return{...t,subtotal:Number(a.toFixed(2)),totalRivas:Number(u.toFixed(2)),totalSanJorge:Number(d.toFixed(2)),totalIsla:Number(f.toFixed(2)),gainRivas:Number(A.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(v.toFixed(2))}}function wK(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function qc(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function oB(t){const{margin:e,gain:r,subtotal:n,orderMargin:a}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const s=Number(n||0),o=Number(r);return Number.isFinite(o)&&s>0?o/s*100:Number(a||0)}function nVe(){var U,W,X;const[t,e]=g.useState([]),[r,n]=g.useState({}),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Ur(Ld(new Date),"yyyy-MM-dd")),[A,h]=g.useState(!1),[m,p]=g.useState(!1),[x,v]=g.useState(null),[y,b]=g.useState([]),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(""),[P,O]=g.useState(""),[z,oe]=g.useState(0),[ce,ue]=g.useState(0),[ge,ne]=g.useState(1);g.useEffect(()=>{(async()=>{try{s(!0),l("");const D=sr(bt(Pe,"candy_main_orders"),In("createdAt","desc")),V=await $t(D),Z=[];V.forEach(Xe=>{const re=Xe.data();Z.push({id:Xe.id,name:re.name??"",date:re.date??"",totalPackages:Number(re.totalPackages??0),subtotal:Number(re.subtotal??0),totalRivas:Number(re.totalRivas??0),totalSanJorge:Number(re.totalSanJorge??0),totalIsla:Number(re.totalIsla??0),marginRivas:Number(re.marginRivas??0),marginSanJorge:Number(re.marginSanJorge??0),marginIsla:Number(re.marginIsla??0),createdAt:re.createdAt??xr.now()})}),e(Z);const be=await $t(sr(bt(Pe,"inventory_candies"))),L={};be.forEach(Xe=>{const re=Xe.data(),J=re.orderId;if(!J)return;const De=Number(re.unitsPerPackage||1)||1,ie=Number(re.totalUnits??(re.packages||0)*De),He=Math.round(ie/De),Ge=Number(re.remaining??re.totalUnits??ie),dt=Number(re.remainingPackages??NaN),_t=Number.isFinite(dt)?Math.round(dt):Math.round(Ge/De);L[J]||(L[J]={orderId:J,totalPackages:0,remainingPackages:0}),L[J].totalPackages+=He,L[J].remainingPackages+=_t}),n(L)}catch(D){console.error(D),l(" Error cargando inventario de pedidos.")}finally{s(!1)}})()},[]);const Oe=g.useMemo(()=>t.filter(D=>{var Z;const V=D.date||((Z=D.createdAt)!=null&&Z.toDate?D.createdAt.toDate().toISOString().slice(0,10):"");return!(!V||c&&V<c||d&&V>d)}),[t,c,d]),Ue=g.useMemo(()=>{let D=0,V=0,Z=0,be=0,L=0,Xe=0;for(const re of Oe){D+=re.totalPackages,V+=re.subtotal,Z+=re.totalRivas,be+=re.totalSanJorge,L+=re.totalIsla;const J=r[re.id];J&&(Xe+=J.remainingPackages)}return{totalPaquetes:D,totalSubtotal:V,totalRivas:Z,totalSJ:be,totalIsla:L,totalPaquetesRestantes:Xe,totalPedidos:Oe.length}},[Oe,r]),F=async(D,V,Z)=>{if(!x)return;const be=Number(Z||0),L=y.map(J=>J.id!==D?J:iB({...J,[V]:be}));b(L);const Xe=L.find(J=>J.id===D);if(!Xe)return;const re=wK(L);try{await Fn(er(Pe,"products_candies",D),{marginRivas:Xe.marginRivas,marginSanJorge:Xe.marginSanJorge,marginIsla:Xe.marginIsla,subtotal:Xe.subtotal,totalRivas:Xe.totalRivas,totalSanJorge:Xe.totalSanJorge,totalIsla:Xe.totalIsla,unitPriceRivas:Xe.unitPriceRivas,unitPriceSanJorge:Xe.unitPriceSanJorge,unitPriceIsla:Xe.unitPriceIsla,gainRivas:Xe.gainRivas,gainSanJorge:Xe.gainSanJorge,gainIsla:Xe.gainIsla}),await Fn(er(Pe,"candy_main_orders",x.id),{totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),v(J=>J&&{...J,totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(J){console.error(J),l(" Error actualizando mrgenes del producto.")}},H=async()=>{if(x)try{l("");const D=Number.isFinite(w)&&w!==0?w:x.marginRivas||0,V=Number.isFinite(I)&&I!==0?I:x.marginSanJorge||0,Z=Number.isFinite(S)&&S!==0?S:x.marginIsla||0,be=iB({id:"tmp",name:B.trim(),category:P.trim(),providerPrice:Number(z||0),packages:Number(ce||0),unitsPerPackage:Number(ge||1),marginRivas:Number(D||0),marginSanJorge:Number(V||0),marginIsla:Number(Z||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ce||0)}),L=await Zn(bt(Pe,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:be.name,category:be.category,providerPrice:be.providerPrice,packages:be.packages,unitsPerPackage:be.unitsPerPackage,marginRivas:be.marginRivas,marginSanJorge:be.marginSanJorge,marginIsla:be.marginIsla,gainRivas:be.gainRivas,gainSanJorge:be.gainSanJorge,gainIsla:be.gainIsla,subtotal:be.subtotal,totalRivas:be.totalRivas,totalSanJorge:be.totalSanJorge,totalIsla:be.totalIsla,unitPriceRivas:be.unitPriceRivas,unitPriceSanJorge:be.unitPriceSanJorge,unitPriceIsla:be.unitPriceIsla,createdAt:xr.now()}),re=[{...be,id:L.id},...y];b(re);const J=wK(re);await Fn(er(Pe,"candy_main_orders",x.id),{totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),v(De=>De&&{...De,totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),j(0),_(0),E(0),k(""),O(""),oe(0),ue(0),ne(1),l(" Producto agregado con mrgenes por sucursal.")}catch(D){console.error(D),l(" Error agregando producto al pedido.")}},K=async D=>{try{v(D),b([]),h(!0),p(!0),l("");const V=await $t(sr(bt(Pe,"inventory_candies"),Ar("orderId","==",D.id))),Z={};V.forEach(Xe=>{const re=Xe.data(),J=re.productId;if(!J)return;const De=Number(re.unitsPerPackage||1)||1,ie=Number(re.remaining??re.totalUnits??0),He=Number(re.remainingPackages??NaN),Ge=Number.isFinite(He)?Math.round(He):Math.round(ie/De);Z[J]=(Z[J]||0)+Ge});const be=await $t(sr(bt(Pe,"products_candies"),Ar("orderId","==",D.id))),L=[];be.forEach(Xe=>{const re=Xe.data(),J=qc(re.providerPrice,0),De=qc(re.packages,0),ie=re.subtotal??J*De,He=oB({margin:re.marginRivas,gain:re.gainRivas,subtotal:ie,orderMargin:D.marginRivas||0}),Ge=oB({margin:re.marginSanJorge,gain:re.gainSanJorge,subtotal:ie,orderMargin:D.marginSanJorge||0}),dt=oB({margin:re.marginIsla,gain:re.gainIsla,subtotal:ie,orderMargin:D.marginIsla||0}),_t=iB({id:Xe.id,name:re.name??"",category:re.category??"",providerPrice:J,packages:De,unitsPerPackage:qc(re.unitsPerPackage,1),marginRivas:Number(He||0),marginSanJorge:Number(Ge||0),marginIsla:Number(dt||0),subtotal:qc(re.subtotal,0),totalRivas:qc(re.totalRivas,0),totalSanJorge:qc(re.totalSanJorge,0),totalIsla:qc(re.totalIsla,0),gainRivas:qc(re.gainRivas,0),gainSanJorge:qc(re.gainSanJorge,0),gainIsla:qc(re.gainIsla,0),unitPriceRivas:qc(re.unitPriceRivas,0),unitPriceSanJorge:qc(re.unitPriceSanJorge,0),unitPriceIsla:qc(re.unitPriceIsla,0),remainingPackages:Z[Xe.id]??qc(re.packages,0)});L.push(_t)}),b(L)}catch(V){console.error(V),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:D=>f(D.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:Ue.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Ue.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Ue.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",y0(Ue.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",y0(Ue.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",y0(Ue.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",y0(Ue.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Oe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):Oe.map(D=>{var re;const V=D.totalPackages>0?Math.round(D.totalRivas/D.totalPackages):0,Z=D.totalPackages>0?Math.round(D.totalSanJorge/D.totalPackages):0,be=D.totalPackages>0?Math.round(D.totalIsla/D.totalPackages):0,L=D.date||((re=D.createdAt)!=null&&re.toDate?D.createdAt.toDate().toISOString().slice(0,10):""),Xe=r[D.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:L}),i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.totalPackages}),i.jsx("td",{className:"p-2 border",children:Xe?Xe.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:V}),i.jsx("td",{className:"p-2 border",children:Z}),i.jsx("td",{className:"p-2 border",children:be}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>K(D),children:"Ver pedido"})})]},D.id)})})]})}),A&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),v(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((U=x.createdAt)!=null&&U.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((W=r[x.id])==null?void 0:W.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((X=r[x.id])==null?void 0:X.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:y0(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:y0(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:y0(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:y0(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:w,onChange:D=>j(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:I,onChange:D=>_(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:S,onChange:D=>E(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:B,onChange:D=>k(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:P,onChange:D=>O(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:z,onChange:D=>oe(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ce,onChange:D=>ue(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ge,onChange:D=>ne(Number(D.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:H,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(D=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.category}),i.jsx("td",{className:"p-2 border",children:D.packages}),i.jsx("td",{className:"p-2 border",children:D.remainingPackages??D.packages}),i.jsx("td",{className:"p-2 border",children:D.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:D.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginRivas??0,onChange:V=>F(D.id,"marginRivas",V.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginSanJorge??0,onChange:V=>F(D.id,"marginSanJorge",V.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginIsla??0,onChange:V=>F(D.id,"marginIsla",V.target.value)})}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:D.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:D.unitPriceIsla})]},D.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!A&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const za=t=>Math.round((Number(t)||0)*100)/100,rp=t=>Math.round((Number(t)||0)*1e3)/1e3,ai=t=>Number(t??0).toFixed(2),Uf=t=>Number(t??0).toFixed(3),NK=t=>String(t??"").trim().toLowerCase();async function aVe(t){if(!t)return;const e=sr(bt(Pe,"ar_movements"),Ar("ref.saleId","==",t)),r=await $t(e);await Promise.all(r.docs.map(n=>qn(er(Pe,"ar_movements",n.id))))}const sVe=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,u=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),v=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(v||0)>0&&(y=za(c*Number(v||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:za(v),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:s,vendorId:o,vendorCommissionAmount:y,processedDate:u||""}});const d=Number(t.packagesTotal??t.quantity??0),f=Number(t.amount??t.amountCharged??t.total??0)||0;let A=0;return A=za(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:d,amount:f,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:s,vendorId:o,vendorCommissionAmount:A,processedDate:u||""}]};function iVe({role:t,currentUserEmail:e,sellerCandyId:r,roles:n}){const[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),m=Ur(new Date,"yyyy-MM-dd"),[p,x]=g.useState(m),[v,y]=g.useState(m),[b,w]=g.useState("ALL"),[j,I]=g.useState("ALL"),[_,S]=g.useState(null),[E,B]=g.useState(0),[k,P]=g.useState(0),[O,z]=g.useState(""),[oe,ce]=g.useState(0),[ue,ge]=g.useState("0"),[ne,Oe]=g.useState(!1),[Ue,F]=g.useState(!1),[H,K]=g.useState(!1),[U,W]=g.useState(!1),[X,D]=g.useState(!1),[V,Z]=g.useState(!1),be=g.useRef(null),L=n&&n.length?n:t,Xe=!L||Sn(L,"admin"),re=Sn(L,"vendedor_dulces"),J=(e||"").trim().toLowerCase(),[De,ie]=g.useState([]),[He,Ge]=g.useState({}),[dt,_t]=g.useState({}),Bt=Ni.useMemo(()=>{const te=new Set;return a.forEach(_e=>{const R=(_e.productName||"").trim();R&&te.add(R)}),Array.from(te).sort((_e,R)=>_e.localeCompare(R))},[a]);g.useEffect(()=>{if(!p||!v)return;u(!0);const te=sr(bt(Pe,"sales_candies"),Ar("date",">=",p),Ar("date","<=",v),In("date","asc")),_e=jd(te,R=>{const Q=[];R.forEach(G=>{const se=sVe(G.data(),G.id);Q.push(...se)}),s(Q),u(!1)},R=>{console.error("Error cargando ventas por periodo:",R),s([]),u(!1)});return()=>_e()},[p,v]),g.useEffect(()=>{(async()=>{const _e=sr(bt(Pe,"daily_closures_candies"),Ar("date","==",m)),R=await $t(_e);if(R.empty)l(null);else{const Q=R.docs[0];l({id:Q.id,...Q.data()})}})()},[m]),g.useEffect(()=>{(async()=>{try{const _e=await $t(bt(Pe,"sellers_candies")),R=[];_e.forEach(Q=>{const G=Q.data();R.push({id:Q.id,name:G.name||"",commissionPercent:Number(G.commissionPercent||0)})}),ie(R)}catch(_e){console.error("Error cargando sellers_candies",_e)}})()},[]),g.useEffect(()=>{(async()=>{try{const _e=await $t(bt(Pe,"products_candies")),R={};_e.forEach(Q=>{const G=Q.data(),se=NK(G==null?void 0:G.name);if(!se)return;const Ne=String((G==null?void 0:G.category)||"").trim();R[se]=Ne||"(sin categora)"}),Ge(R)}catch(_e){console.error("Error cargando products_candies",_e)}})()},[]);const Ot=te=>za(Number(te.vendorCommissionAmount??0)||0),jt=Ni.useMemo(()=>{let te=[...a];return A==="FLOTANTE"&&(te=te.filter(_e=>_e.status==="FLOTANTE")),A==="PROCESADA"&&(te=te.filter(_e=>_e.status==="PROCESADA")),j!=="ALL"&&(te=te.filter(_e=>(_e.productName||"").trim()===j)),Xe&&b!=="ALL"&&(te=te.filter(_e=>(_e.vendorId||"")===b)),re&&(r?te=te.filter(_e=>(_e.vendorId||"")===r):J?te=te.filter(_e=>(_e.sellerEmail||"").toLowerCase()===J):te=[]),te},[A,a,j,Xe,b,re,r,J]),Qt=Ni.useMemo(()=>jt.filter(te=>te.type!=="CREDITO"),[jt]),Ft=Ni.useMemo(()=>jt.filter(te=>te.type==="CREDITO"),[jt]),$e=Ni.useMemo(()=>jt.filter(te=>te.status==="FLOTANTE").length,[jt]),Fe=Ni.useMemo(()=>jt.filter(te=>te.status==="PROCESADA").length,[jt]),Ze=Ni.useMemo(()=>jt.filter(te=>te.type==="CREDITO").length,[jt]),Te=Ni.useMemo(()=>jt.filter(te=>te.type!=="CREDITO").length,[jt]),ee=rp(jt.reduce((te,_e)=>te+(_e.quantity||0),0)),me=za(jt.reduce((te,_e)=>te+Number(_e.cogsAmount??0),0)),Re=za(jt.reduce((te,_e)=>te+(_e.amount||0),0)),he=za(Re-me);let qe=0,st=0,yt=0,pe=0,je=0,we=0,Ye=0;jt.forEach(te=>{const _e=Number(te.amount||0),R=Number(te.amountReceived||0),Q=Ot(te);je+=Q,te.type==="CREDITO"?(qe+=te.quantity||0,yt+=_e-R,Ye+=Q):(st+=te.quantity||0,pe+=_e,we+=Q)}),yt=za(yt),pe=za(pe),je=za(je),we=za(we),Ye=za(Ye);const xe=Ni.useMemo(()=>{const te={};for(const _e of jt){const R=(_e.vendorId||"").trim();if(!R||_e.type==="CREDITO")continue;const Q=Ot(_e);if(!te[R]){const G=De.find(se=>se.id===R);te[R]={vendorId:R,name:(G==null?void 0:G.name)||_e.userEmail||"(sin vendedor)",total:0}}te[R].total=za(te[R].total+Q)}return Object.values(te).filter(_e=>_e.total>0).sort((_e,R)=>R.total-_e.total)},[jt,De]),Se=Ni.useMemo(()=>{const te={};for(const _e of jt){const R=(_e.vendorId||"").trim();if(!R||_e.type!=="CREDITO")continue;const Q=Ot(_e);if(!te[R]){const G=De.find(se=>se.id===R);te[R]={vendorId:R,name:(G==null?void 0:G.name)||_e.userEmail||"(sin vendedor)",total:0}}te[R].total=za(te[R].total+Q)}return Object.values(te).filter(_e=>_e.total>0).sort((_e,R)=>R.total-_e.total)},[jt,De]),xt={};jt.forEach(te=>{const _e=te.productName||"(sin nombre)";xt[_e]||(xt[_e]={totalQuantity:0,totalAmount:0,totalCommission:0}),xt[_e].totalQuantity=rp(xt[_e].totalQuantity+(te.quantity||0)),xt[_e].totalAmount=za(xt[_e].totalAmount+(te.amount||0)),xt[_e].totalCommission=za(xt[_e].totalCommission+Ot(te))});const Pt=Object.entries(xt).map(([te,_e])=>({productName:te,category:He[NK(te)]||"(sin categora)",totalQuantity:_e.totalQuantity,totalAmount:_e.totalAmount,totalCommission:_e.totalCommission})),It=Ni.useMemo(()=>{const te={};for(const _e of Pt){const R=_e.category||"(sin categora)";te[R]||(te[R]={category:R,rows:[],totalQuantity:0,totalAmount:0,totalCommission:0}),te[R].rows.push(_e),te[R].totalQuantity=rp(te[R].totalQuantity+(_e.totalQuantity||0)),te[R].totalAmount=za(te[R].totalAmount+(_e.totalAmount||0)),te[R].totalCommission=za(te[R].totalCommission+(_e.totalCommission||0))}return Object.values(te).map(_e=>({..._e,rows:[..._e.rows].sort((R,Q)=>Q.totalAmount-R.totalAmount)})).sort((_e,R)=>R.totalAmount-_e.totalAmount)},[Pt]),Ut=te=>{_t(_e=>({..._e,[te]:!_e[te]}))},Ht=async()=>{if(Xe)try{const te=jt.filter(ze=>ze.status==="FLOTANTE");if(te.length===0){f("No hay ventas flotantes para procesar en este perodo.");return}const _e={totalCharged:za(te.reduce((ze,Ie)=>ze+(Ie.amount||0),0)),totalSuggested:za(te.reduce((ze,Ie)=>ze+(Ie.amountSuggested||0),0)),totalUnits:rp(te.reduce((ze,Ie)=>ze+(Ie.quantity||0),0)),totalCOGS:za(te.reduce((ze,Ie)=>ze+Number(Ie.cogsAmount??0),0))},R=za(_e.totalCharged-_e.totalSuggested),Q=za(_e.totalCharged-_e.totalCOGS),G=te.reduce((ze,Ie)=>{const nt=Number(Ie.quantity||0),lt=Number(Ie.amount||0),ht=Number(Ie.vendorCommissionAmount||0);return Ie.type==="CREDITO"?(ze.packsCredit+=nt,ze.amountCredit+=lt,ze.comCredit+=ht):(ze.packsCash+=nt,ze.amountCash+=lt,ze.comCash+=ht),ze},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),se={totalPacksCash:rp(G.packsCash),totalPacksCredit:rp(G.packsCredit),totalAmountCash:za(G.amountCash),totalAmountCredit:za(G.amountCredit),totalCommissionCash:za(G.comCash),totalCommissionCredit:za(G.comCredit)},Ne=await Zn(bt(Pe,"daily_closures_candies"),{date:m,createdAt:xr.now(),periodStart:p,periodEnd:v,totalCharged:_e.totalCharged,totalSuggested:_e.totalSuggested,totalDifference:R,totalUnits:_e.totalUnits,totalCOGS:_e.totalCOGS,grossProfit:Q,...se,products:te.map(ze=>({productName:ze.productName,quantity:ze.quantity,amount:ze.amount})),sales:te.map(ze=>({id:ze.id,productName:ze.productName,quantity:ze.quantity,amount:ze.amount,amountSuggested:ze.amountSuggested,userEmail:ze.userEmail,clientName:ze.clientName,amountReceived:ze.amountReceived,change:ze.change,status:ze.status,cogsAmount:ze.cogsAmount??0,avgUnitCost:ze.avgUnitCost??null,allocations:ze.allocations??[],date:ze.date,type:ze.type??"CONTADO",vendorId:ze.vendorId??"",vendorCommissionAmount:Number(ze.vendorCommissionAmount??0)||0,processedDate:m})),productSummary:Object.entries(te.reduce((ze,Ie)=>{const nt=Ie.productName||"(sin nombre)";return ze[nt]||(ze[nt]={totalQuantity:0,totalAmount:0}),ze[nt].totalQuantity=rp(ze[nt].totalQuantity+(Ie.quantity||0)),ze[nt].totalAmount=za(ze[nt].totalAmount+(Ie.amount||0)),ze},{})).map(([ze,Ie])=>({productName:ze,totalQuantity:Ie.totalQuantity,totalAmount:Ie.totalAmount}))}),Me=tu(Pe);te.forEach(ze=>{Me.update(er(Pe,"sales_candies",ze.id.split("#")[0]),{status:"PROCESADA",closureId:Ne.id,closureDate:m,processedDate:m,processedAt:xr.now()})}),await Me.commit(),f(` Cierre guardado. Ventas procesadas: ${te.length}. (Proceso: ${m})`)}catch(te){console.error(te),f(" Error al guardar el cierre de dulces.")}},Le=async te=>{if(Xe&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Fn(er(Pe,"sales_candies",te.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),f(" Venta revertida a FLOTANTE.")}catch(_e){console.error(_e),f(" No se pudo revertir la venta.")}},Ce=te=>{Xe&&(S(te),B(te.quantity),P(te.amount),z(te.clientName),ce(te.amountReceived),ge(te.change))},Ae=async()=>{if(!(!_||!Xe))try{await Fn(er(Pe,"sales_candies",_.id.split("#")[0]),{packagesTotal:E,amount:k,amountCharged:k,clientName:O,amountReceived:oe,change:ue}),S(null),f(" Venta de dulces actualizada.")}catch(te){console.error(te),f(" No se pudo actualizar la venta de dulces.")}},Qe=async te=>{if(Xe&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const _e=te.split("#")[0],{restored:R}=await CQe(_e);await aVe(_e),f(` Venta eliminada. Stock restaurado (unidades internas): ${Number(R).toFixed(2)}. Estado de cuenta ajustado.`)}catch(_e){console.error(_e),f(" No se pudo eliminar la venta de dulces.")}},fe=async()=>{if(be.current){be.current.classList.add("force-pdf-colors"),be.current.classList.add("pdf-print-mode");try{const _e=(await Fg(be.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),R=new an;R.addImage(_e,"PNG",10,10,190,0),R.save(`cierre_dulces_${p}_a_${v}_proc_${m}.pdf`)}finally{be.current.classList.remove("pdf-print-mode"),be.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
        .pdf-print-mode .collapsible-content { display: block !important; }
      `}),i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",m]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Oe(te=>!te),"aria-expanded":ne,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${ne?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${ne?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:p,onChange:te=>x(te.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:te=>y(te.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:te=>h(te.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),Xe&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:te=>w(te.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),De.map(te=>i.jsx("option",{value:te.id,children:te.name||te.id},te.id))]})]}),i.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[i.jsx("label",{className:"text-xs md:text-sm whitespace-nowrap",children:"Productos:"}),i.jsxs("select",{className:"border rounded px-2 py-1 text-xs w-full md:w-48 lg:w-56",value:j,onChange:te=>I(te.target.value),disabled:Bt.length===0,children:[i.jsx("option",{value:"ALL",children:"Todos"}),Bt.map(te=>i.jsx("option",{value:te,children:te},te))]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>F(te=>!te),"aria-expanded":Ue,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${Ue?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Ue?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:$e}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:Fe}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Ze}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Te}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ai(we)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ai(Ye)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>K(te=>!te),"aria-expanded":H,children:[i.jsx("span",{children:"KPIs por vendedor"}),i.jsx("span",{className:`transition-transform ${H?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${H?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),xe.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:xe.map(te=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:te.name}),i.jsxs("strong",{className:"ml-2",children:["C$",ai(te.total)]})]},te.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),Se.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Se.map(te=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:te.name}),i.jsxs("strong",{className:"ml-2",children:["C$",ai(te.total)]})]},te.vendorId))})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:be,children:[i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>W(te=>!te),"aria-expanded":U,children:[i.jsx("span",{children:"Transacciones Cash"}),i.jsx("span",{className:`transition-transform ${U?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${U?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Qt.map(te=>{const _e=Ot(te),R=(te.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${te.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:te.status})}),i.jsx("td",{className:"border p-1",children:te.productName}),i.jsx("td",{className:"border p-1",children:"Cash"}),i.jsx("td",{className:"border p-1",children:Uf(te.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ai(te.amount)]}),i.jsx("td",{className:"border p-1",children:_e>0?`C$${ai(_e)}`:""}),i.jsx("td",{className:"border p-1",children:te.date}),i.jsx("td",{className:"border p-1",children:R||""}),i.jsx("td",{className:"border p-1",children:te.userEmail}),i.jsx("td",{className:"border p-1",children:te.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(te),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Qe(te.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):te.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsx("button",{onClick:()=>Le(te.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},te.id)}),Qt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas cash para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Qt.map(te=>{const _e=Ot(te),R=(te.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:te.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Cash  ",te.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",ai(te.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${te.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:te.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Uf(te.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:_e>0?`C$${ai(_e)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:R||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:te.userEmail})]}),i.jsx("div",{className:"pt-2",children:te.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(te),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Qe(te.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):te.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsx("button",{onClick:()=>Le(te.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},te.id)}),Qt.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas cash para mostrar."})]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(te=>!te),"aria-expanded":X,children:[i.jsx("span",{children:"Transacciones Crdito"}),i.jsx("span",{className:`transition-transform ${X?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${X?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Ft.map(te=>{const _e=Ot(te),R=(te.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${te.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:te.status})}),i.jsx("td",{className:"border p-1",children:te.productName}),i.jsx("td",{className:"border p-1",children:"Crdito"}),i.jsx("td",{className:"border p-1",children:Uf(te.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ai(te.amount)]}),i.jsx("td",{className:"border p-1",children:_e>0?`C$${ai(_e)}`:""}),i.jsx("td",{className:"border p-1",children:te.date}),i.jsx("td",{className:"border p-1",children:R||""}),i.jsx("td",{className:"border p-1",children:te.userEmail}),i.jsx("td",{className:"border p-1",children:te.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(te),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Qe(te.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):te.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsx("button",{onClick:()=>Le(te.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},te.id)}),Ft.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas crdito para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Ft.map(te=>{const _e=Ot(te),R=(te.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:te.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Crdito  ",te.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",ai(te.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${te.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:te.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Uf(te.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:_e>0?`C$${ai(_e)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:R||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:te.userEmail})]}),i.jsx("div",{className:"pt-2",children:te.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(te),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Qe(te.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):te.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsx("button",{onClick:()=>Le(te.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},te.id)}),Ft.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas crdito para mostrar."})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:Uf(qe)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:Uf(st)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",ai(yt)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",ai(pe)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",ai(je)]})]})]}),(me>0||he!==Re)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",ai(me)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",ai(he)]})]}),i.jsxs("div",{children:["Total paquetes (visibles):"," ",i.jsx("strong",{children:Uf(ee)})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Z(te=>!te),"aria-expanded":V,children:[i.jsx("span",{children:"Consolidado por producto"}),i.jsx("span",{className:`transition-transform ${V?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${V?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"space-y-3",children:[It.map(te=>{const _e=!!dt[te.category];return i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ut(te.category),"aria-expanded":_e,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"truncate",children:te.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Uf(te.totalQuantity)," paquetes  C$",ai(te.totalAmount),"  Comisin"," ",te.totalCommission>0?`C$${ai(te.totalCommission)}`:""]})]}),i.jsx("span",{className:`transition-transform ${_e?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${_e?"block":"hidden"} border-t p-3`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsx("tbody",{children:te.rows.map(R=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName}),i.jsx("td",{className:"border p-1",children:Uf(R.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ai(R.totalAmount)]}),i.jsx("td",{className:"border p-1",children:R.totalCommission>0?`C$${ai(R.totalCommission)}`:""})]},R.productName))})]})}),i.jsx("div",{className:"pdf-mobile md:hidden space-y-2",children:te.rows.map(R=>i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[i.jsx("div",{className:"font-semibold",children:R.productName}),i.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),i.jsx("strong",{children:Uf(R.totalQuantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total dinero"}),i.jsxs("strong",{children:["C$",ai(R.totalAmount)]})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:R.totalCommission>0?`C$${ai(R.totalCommission)}`:""})]})]})]},R.productName))})]})]},te.category)}),It.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[Xe&&i.jsx("button",{onClick:Ht,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),i.jsx("button",{onClick:fe,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),_&&Xe&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[_.productName,"  ",_.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:E,onChange:te=>B(parseFloat(te.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:k,onChange:te=>P(parseFloat(te.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:O,onChange:te=>z(te.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:oe,onChange:te=>ce(parseFloat(te.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:ue,onChange:te=>ge(te.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>S(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:Ae,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Fh=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Cu=t=>Math.round((Number(t)||0)*100)/100;function oVe(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function lVe(t){return t.toISOString().slice(0,10)}function cVe(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function uVe(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return lVe(r)}function dVe(){const[t,e]=g.useState(cVe()),[r,n]=g.useState(uVe()),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState({}),[d,f]=g.useState({}),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState({}),[y,b]=g.useState(!1),[w,j]=g.useState(null),[I,_]=g.useState(null),S=g.useMemo(()=>w&&A.find(ce=>ce.vendorId===w)||null,[w,A]),E=g.useMemo(()=>{var ce;return!w||!I?[]:((ce=x[w])==null?void 0:ce[I])||[]},[w,I,x]),B=g.useMemo(()=>Cu(A.reduce((ce,ue)=>ce+(ue.totalSoldMoney||0),0)),[A]),k=g.useMemo(()=>Cu(A.reduce((ce,ue)=>ce+(ue.totalCreditMoney||0),0)),[A]);g.useEffect(()=>{(async()=>{try{const ce=await $t(bt(Pe,"sellers_candies")),ue={};ce.forEach(Oe=>{const Ue=Oe.data(),F=Ue.branch||"Rivas";let H="RIVAS";F==="San Jorge"?H="SAN_JORGE":F==="Isla Ometepe"&&(H="ISLA"),ue[Oe.id]={id:Oe.id,name:Ue.name??"(sin nombre)",branch:H,branchLabel:F,commissionPercent:Number(Ue.commissionPercent??0)}});const ge=await $t(bt(Pe,"products_candies")),ne={};ge.forEach(Oe=>{const Ue=Oe.data();ne[Oe.id]={id:Oe.id,name:Ue.name??"(sin nombre)"}}),u(ue),f(ne)}catch(ce){console.error(ce),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const P=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}s(!0),l("");try{const ce={},ue={},ge=sr(bt(Pe,"inventory_candies_sellers"),Ar("date",">=",t),Ar("date","<=",r)),ne=await $t(ge),Oe={},Ue={},F={},H={};ne.forEach(ie=>{var Ye,xe;const He=ie.data(),Ge=He.sellerId||"";if(!Ge)return;const dt=He.productId||"",_t=He.productName||((Ye=d[dt])==null?void 0:Ye.name)||"(sin nombre)",Bt=Math.max(1,Math.floor(Number(He.unitsPerPackage||1))),Ot=Number(He.totalUnits??0),jt=Number(He.packages??0),Qt=Number(He.remainingUnits??He.remaining??0),Ft=Number(He.remainingPackages??0),$e=jt>0?jt:Ot>0?Math.floor(Ot/Bt):0,Fe=Ft>0?Ft:Qt>0?Math.floor(Qt/Bt):0;Oe[Ge]=(Oe[Ge]||0)+$e,Ue[Ge]=(Ue[Ge]||0)+Fe;const Ze=He.orderId||He.vendorOrderId||He.orderNumber||He.order||ie.id;F[Ge]||(F[Ge]=new Set),F[Ge].add(Ze);const Te=((xe=c[Ge])==null?void 0:xe.name)||He.sellerName||"(sin vendedor)",ee=String(He.date||""),me=Number(He.totalVendor??0),Re=Number(He.gainVendor??0),he=jt>0?jt:Ot>0?Math.floor(Ot/Bt):0,qe=he>0?me/he:0,st=he>0?Re/he:0,yt=Cu($e*qe),pe=Cu($e*st),je=Cu(Fe*qe),we=Cu(Fe*st);H[Ge]||(H[Ge]={ordered:[],remaining:[]}),$e>0&&H[Ge].ordered.push({date:ee,vendorName:Te,productName:_t,packages:$e,totalMoney:yt,vendorCommission:pe}),Fe>0&&H[Ge].remaining.push({date:ee,vendorName:Te,productName:_t,packages:Fe,totalMoney:je,vendorCommission:we})});const K={};Object.keys(F).forEach(ie=>{K[ie]=F[ie].size});const U=sr(bt(Pe,"sales_candies"),Ar("date",">=",t),Ar("date","<=",r)),W=await $t(U),X={},D={},V={},Z={},be={},L={};W.forEach(ie=>{const He=ie.data(),Ge=He.date||"",dt=He.vendorId||He.sellerId||"";if(!dt)return;const _t=c[dt],Bt=He.vendorName||(_t==null?void 0:_t.name)||"(sin vendedor)",Ot=Number(He.vendorCommissionPercent??(_t==null?void 0:_t.commissionPercent)??0)||0,jt=Array.isArray(He.items)?He.items:[];if(!jt.length)return;const Qt=String(He.type||"").toUpperCase()==="CREDITO";be[dt]||(be[dt]={sold:[],credit:[]}),jt.forEach(Ft=>{var yt;const $e=Ft.productName||((yt=d[Ft.productId||""])==null?void 0:yt.name)||"(sin nombre)",Fe=Ft.packages??Ft.qty??Ft.quantity??0,Ze=Number(Fe||0);if(Ze<=0)return;const Te=Number(Ft.unitPricePackage??Ft.unitPrice??0)||0,ee=Math.max(0,Number(Ft.discount||0)),me=Ze*Te,Re=Cu(Math.max(0,me-ee));if(Re<=0)return;console.log("DBG",{isCredit:Qt,vendorId:dt,commissionPercent:Ot,lineFinal:Re,storedItemCommission:Number(Ft.vendorCommissionAmount??0)});let he=0;const qe=Number(Ft.vendorCommissionAmount??0);qe?he=Cu(qe):Ot>0&&(he=Cu(Re*Ot/100)),Qt?(D[dt]=(D[dt]||0)+Ze,Z[dt]=(Z[dt]||0)+Re):(X[dt]=(X[dt]||0)+Ze,V[dt]=(V[dt]||0)+Re),Qt?ue[dt]=(ue[dt]||0)+he:ce[dt]=(ce[dt]||0)+he,Qt?be[dt].credit.push({date:Ge,vendorName:Bt,productName:$e,packages:Ze,totalMoney:Re,vendorCommission:0}):be[dt].sold.push({date:Ge,vendorName:Bt,productName:$e,packages:Ze,totalMoney:Re,vendorCommission:he});const st=$e;L[st]||(L[st]={productName:$e,packages:0,totalMoney:0}),L[st].packages+=Ze,L[st].totalMoney+=Re})});const Xe=new Set([...Object.keys(Oe),...Object.keys(Ue),...Object.keys(X),...Object.keys(D)]),re=[],J={};Xe.forEach(ie=>{var Fe,Ze,Te,ee;const He=c[ie],Ge=(He==null?void 0:He.name)||"(sin vendedor)",dt=He?He.branchLabel||oVe(He.branch):"",_t=Oe[ie]||0,Bt=Ue[ie]||0,Ot=X[ie]||0,jt=D[ie]||0,Qt=Cu(V[ie]||0),Ft=Cu(Z[ie]||0),$e=K[ie]||0;re.push({vendorId:ie,vendorName:Ge,branchLabel:dt,orderedPackages:_t,remainingPackages:Bt,soldPackages:Ot,creditPackages:jt,totalSoldMoney:Qt,totalCreditMoney:Ft,ordersCreated:$e,commissionCash:Cu(ce[ie]||0),commissionCredit:0}),J[ie]={ordered:(((Fe=H[ie])==null?void 0:Fe.ordered)||[]).sort((me,Re)=>me.date.localeCompare(Re.date)),remaining:(((Ze=H[ie])==null?void 0:Ze.remaining)||[]).sort((me,Re)=>me.date.localeCompare(Re.date)),sold:(((Te=be[ie])==null?void 0:Te.sold)||[]).sort((me,Re)=>me.date.localeCompare(Re.date)),credit:(((ee=be[ie])==null?void 0:ee.credit)||[]).sort((me,Re)=>me.date.localeCompare(Re.date))}}),re.sort((ie,He)=>ie.vendorName.localeCompare(He.vendorName,"es")),h(re),v(J);const De=Object.values(L).map(ie=>({productName:ie.productName,packages:ie.packages,totalMoney:Cu(ie.totalMoney)})).sort((ie,He)=>He.packages-ie.packages).slice(0,10);p(De),re.length||l("Sin datos para el rango seleccionado.")}catch(ce){console.error(ce),l(" Error cargando consolidado de vendedores.")}finally{s(!1)}};g.useEffect(()=>{Object.keys(c).length&&P()},[c]);const O=(ce,ue)=>{j(ce),_(ue),b(!0)},z=()=>{b(!1),j(null),_(null)},oe=()=>{if(!A.length){l("No hay datos para exportar.");return}const ce=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],ue=A.map(F=>[F.vendorName,F.branchLabel,F.orderedPackages.toString(),F.remainingPackages.toString(),F.soldPackages.toString(),F.creditPackages.toString(),F.totalSoldMoney.toFixed(2),F.commissionCash.toFixed(2),F.totalCreditMoney.toFixed(2),F.commissionCredit.toFixed(2),F.ordersCreated.toString()]),ge=[ce,...ue].map(F=>F.map(H=>`"${String(H).replace(/"/g,'""')}"`).join(",")).join(`
`),ne=new Blob([ge],{type:"text/csv;charset=utf-8;"}),Oe=URL.createObjectURL(ne),Ue=document.createElement("a");Ue.href=Oe,Ue.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Ue.click(),URL.revokeObjectURL(Oe)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ce=>e(ce.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ce=>n(ce.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:P,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:a,children:a?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:oe,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Fh(B)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Fh(k)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:A.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[A.map(ce=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ce.vendorName}),i.jsx("td",{className:"border p-1",children:ce.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ce.vendorId,"ordered"),children:ce.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ce.vendorId,"remaining"),children:ce.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ce.vendorId,"sold"),children:ce.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ce.vendorId,"credit"),children:ce.creditPackages})}),i.jsx("td",{className:"border p-1",children:Fh(ce.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Fh(ce.commissionCash)}),i.jsx("td",{className:"border p-1",children:Fh(ce.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Fh(ce.commissionCredit)}),i.jsx("td",{className:"border p-1",children:ce.ordersCreated})]},ce.vendorId)),A.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((ce,ue)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ue+1}),i.jsx("td",{className:"border p-1",children:ce.productName}),i.jsx("td",{className:"border p-1",children:ce.packages}),i.jsx("td",{className:"border p-1",children:Fh(ce.totalMoney)})]},ce.productName)),m.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&I&&w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",I==="ordered"?"Paquetes ordenados":I==="remaining"?"Paquetes restantes":I==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[S==null?void 0:S.vendorName,"  ",S==null?void 0:S.branchLabel]})]}),i.jsx("button",{onClick:z,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[E.map((ce,ue)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ce.date}),i.jsx("td",{className:"border p-1",children:ce.productName}),i.jsx("td",{className:"border p-1",children:ce.packages}),i.jsx("td",{className:"border p-1",children:Fh(ce.totalMoney)}),i.jsx("td",{className:"border p-1",children:ce.vendorName}),i.jsx("td",{className:"border p-1",children:Fh(ce.vendorCommission)})]},ue)),E.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const ql=t=>`C$${Number(t||0).toFixed(2)}`,f_=t=>Number(t||0).toFixed(3),lB=()=>{const t=new Date;return Ur(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},h_=()=>Ur(new Date,"yyyy-MM-dd");function fVe({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState([]),o=g.useMemo(()=>{const pe={};return a.forEach(je=>{je.email&&(pe[je.email.trim().toLowerCase()]=je)}),pe},[a]);g.useEffect(()=>{(async()=>{try{const pe=sr(bt(Pe,"sellers_candies"),In("name","asc")),je=await $t(pe),we=[];je.forEach(Ye=>{const xe=Ye.data();we.push({id:Ye.id,name:xe.name||"",email:xe.email||"",commissionPercent:Number(xe.commissionPercent||0)})}),s(we)}catch(pe){console.error(pe)}})()},[]);const[l,c]=g.useState(lB()),[u,d]=g.useState(h_()),[f,A]=g.useState(""),[h,m]=g.useState(""),p=g.useMemo(()=>{const pe=new Map;return n.forEach(je=>{const we=je.productId||je.productName;pe.set(we,{key:we,name:je.productName})}),Array.from(pe.values()).sort((je,we)=>je.name.localeCompare(we.name))},[n]),x=g.useMemo(()=>{const pe=new Map;return n.forEach(je=>{const we=(je.sellerEmail||"").trim().toLowerCase();if(!we)return;const Ye=o[we],xe=(Ye==null?void 0:Ye.name)||je.vendorName||we;pe.set(we,{email:we,label:xe})}),Array.from(pe.values()).sort((je,we)=>je.label.localeCompare(we.label))},[n,o]),v=g.useMemo(()=>n.filter(pe=>!(l&&pe.date<l||u&&pe.date>u||f&&(pe.productId||pe.productName)!==f||h&&(pe.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,u,f,h]),[y,b]=g.useState(h_()),[w,j]=g.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[I,_]=g.useState(""),[S,E]=g.useState("0"),[B,k]=g.useState(()=>v.map(pe=>pe.id));g.useEffect(()=>{k(pe=>pe.filter(je=>v.some(we=>we.id===je)))},[v]);const[P,O]=g.useState([]),[z,oe]=g.useState([]),[ce,ue]=g.useState(!1),[ge,ne]=g.useState(lB()),[Oe,Ue]=g.useState(h_());g.useEffect(()=>{(async()=>{try{ue(!0);const pe=sr(bt(Pe,"expensesCandies"),In("date","desc")),je=await $t(pe),we=[];je.forEach(Ye=>{const xe=Ye.data();we.push({id:Ye.id,date:xe.date,description:xe.description,amount:Number(xe.amount||0)})}),O(we)}catch(pe){console.error(pe)}finally{ue(!1)}})()},[]);const F=g.useMemo(()=>P.filter(pe=>!(!pe.date||ge&&pe.date<ge||Oe&&pe.date>Oe)),[P,ge,Oe]),[H,K]=g.useState([]),[U,W]=g.useState(!1),[X,D]=g.useState(""),[V,Z]=g.useState("DEBITO"),[be,L]=g.useState(""),Xe=()=>{const pe=Number(be);!X.trim()||!isFinite(pe)||pe<=0||(K(je=>[...je,{id:`${Date.now()}_${je.length+1}`,description:X.trim(),type:V,amount:Number(pe.toFixed(2))}]),D(""),L(""))},[re,J]=g.useState(null),[De,ie]=g.useState(""),[He,Ge]=g.useState("DEBITO"),[dt,_t]=g.useState(""),Bt=pe=>{J(pe.id),ie(pe.description),Ge(pe.type),_t(pe.amount.toFixed(2))},Ot=()=>{J(null),ie(""),Ge("DEBITO"),_t("")},jt=()=>{if(!re)return;const pe=Number(dt);!isFinite(pe)||pe<=0||(K(je=>je.map(we=>we.id===re?{...we,description:De.trim(),type:He,amount:Number(pe.toFixed(2))}:we)),Ot())},Qt=pe=>{K(je=>je.filter(we=>we.id!==pe)),re===pe&&Ot()},Ft=(pe,je)=>{k(we=>je?[...new Set([...we,pe])]:we.filter(Ye=>Ye!==pe))},$e=pe=>{k(pe?v.map(je=>je.id):[])},Fe=(pe,je)=>{oe(we=>je?[...new Set([...we,pe])]:we.filter(Ye=>Ye!==pe))},Ze=g.useMemo(()=>v.filter(pe=>B.includes(pe.id)),[v,B]),Te=g.useMemo(()=>H.filter(pe=>pe.type==="DEBITO").reduce((pe,je)=>pe+je.amount,0),[H]),ee=g.useMemo(()=>H.filter(pe=>pe.type==="CREDITO").reduce((pe,je)=>pe+je.amount,0),[H]),me=g.useMemo(()=>{let pe=0,je=0,we=0,Ye=0;for(const Ut of Ze){const Ht=Number(Ut.packages||0),Le=Number(Ut.cogsAmount||0),Ce=Number(Ut.amount||0);pe+=Ht,je+=Le,we+=Ce;const Ae=(Ut.sellerEmail||"").trim().toLowerCase(),Qe=o[Ae],fe=Number((Qe==null?void 0:Qe.commissionPercent)||0),te=Ce*fe/100;Ye+=te}const xe=F.filter(Ut=>z.includes(Ut.id)).reduce((Ut,Ht)=>Ut+Number(Ht.amount||0),0),Se=we-je,xt=we-xe-Te+ee-Ye,Pt=Number(S||0),It=we*Pt/100;return{totalPackages:Number(f_(pe)),totalProvider:Number(je.toFixed(2)),totalSale:Number(we.toFixed(2)),totalGastos:Number(xe.toFixed(2)),debits:Number(Te.toFixed(2)),credits:Number(ee.toFixed(2)),grossProfit:Number(Se.toFixed(2)),finalAmount:Number(xt.toFixed(2)),totalCommissionVendors:Number(Ye.toFixed(2)),branchProfit:Number(It.toFixed(2)),branchFactor:Pt}},[Ze,F,z,Te,ee,o,S]),[Re,he]=g.useState(!1),[qe,st]=g.useState(""),yt=async()=>{if(st(""),Ze.length===0){st("Selecciona al menos 1 transaccin procesada.");return}try{he(!0);const pe={number:w.trim(),date:y,description:I.trim(),status:"PENDIENTE",createdAt:xr.now(),totalPackages:me.totalPackages,totalProvider:me.totalProvider,totalSale:me.totalSale,totalExpenses:me.totalGastos,totalDebits:me.debits,totalCredits:me.credits,grossProfit:me.grossProfit,totalCommissionVendors:me.totalCommissionVendors,branchFactorPercent:me.branchFactor,branchProfit:me.branchProfit,finalAmount:me.finalAmount,transactions:Ze.map(je=>{const we=Number(je.packages||0)||1,Ye=Number(je.cogsAmount||0),xe=Number(je.amount||0),Se=Ye/we,xt=xe/we,Pt=(je.sellerEmail||"").trim().toLowerCase(),It=o[Pt],Ut=Number((It==null?void 0:It.commissionPercent)||0),Ht=xe*Ut/100;return{id:je.id,date:je.date,productId:je.productId||null,productName:je.productName,vendorName:je.vendorName,sellerEmail:je.sellerEmail||null,packages:Number(f_(je.packages)),providerPricePack:Number(Se.toFixed(4)),salePricePack:Number(xt.toFixed(4)),totalProvider:Number(Ye.toFixed(2)),totalSale:Number(xe.toFixed(2)),commissionPercent:Ut,commissionAmount:Number(Ht.toFixed(2))}}),expenses:F.filter(je=>z.includes(je.id)).map(je=>({id:je.id,date:je.date||null,description:je.description||"",amount:Number(Number(je.amount||0).toFixed(2))})),adjustments:H.map(je=>({id:je.id,description:je.description,type:je.type,amount:Number(je.amount.toFixed(2))}))};await Zn(bt(Pe,"invoicesCandies"),pe),st(" Factura de dulces creada."),r()}catch(pe){console.error(pe),st(` Error al crear factura: ${(pe==null?void 0:pe.message)||"desconocido"}`)}finally{he(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:pe=>b(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:w,onChange:pe=>j(pe.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:pe=>E(pe.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:I,onChange:pe=>_(pe.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:pe=>c(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:pe=>d(pe.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:f,onChange:pe=>A(pe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(pe=>i.jsx("option",{value:pe.key,children:pe.name},pe.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:pe=>m(pe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(pe=>i.jsx("option",{value:pe.email,children:pe.label},pe.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(lB()),d(h_()),A(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.length>0&&B.length===v.length,onChange:pe=>$e(pe.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),v.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:v.map(pe=>{const je=B.includes(pe.id),we=Number(pe.packages||0)||1,Ye=Number(pe.cogsAmount||0),xe=Number(pe.amount||0),Se=Ye/we,xt=xe/we,Pt=(pe.sellerEmail||"").trim().toLowerCase(),It=o[Pt],Ut=Number((It==null?void 0:It.commissionPercent)||0),Ht=xe*Ut/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:je,onChange:Le=>Ft(pe.id,Le.target.checked)})}),i.jsx("td",{className:"p-2 border",children:pe.date}),i.jsx("td",{className:"p-2 border",children:(It==null?void 0:It.name)||pe.vendorName}),i.jsx("td",{className:"p-2 border",children:pe.productName}),i.jsx("td",{className:"p-2 border",children:f_(pe.packages)}),i.jsx("td",{className:"p-2 border",children:ql(Se)}),i.jsx("td",{className:"p-2 border",children:ql(xt)}),i.jsx("td",{className:"p-2 border",children:ql(Ye)}),i.jsx("td",{className:"p-2 border",children:ql(xe)}),i.jsx("td",{className:"p-2 border",children:Ut>0?`${ql(Ht)} (${Ut.toFixed(2)}%)`:""})]},pe.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ce&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:ge,onChange:pe=>ne(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:Oe,onChange:pe=>Ue(pe.target.value)})]})]})]}),F.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:F.map(pe=>{const je=z.includes(pe.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:je,onChange:we=>Fe(pe.id,we.target.checked)})}),i.jsx("td",{className:"p-2 border",children:pe.date||""}),i.jsx("td",{className:"p-2 border",children:pe.description||""}),i.jsx("td",{className:"p-2 border",children:ql(Number(pe.amount||0))})]},pe.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>W(!0),children:"Crear Cargo"})]}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.map(pe=>{const je=re===pe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:je?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:De,onChange:we=>ie(we.target.value)}):i.jsx("span",{title:pe.description,children:pe.description.length>60?`${pe.description.slice(0,60)}`:pe.description})}),i.jsx("td",{className:"p-2 border",children:je?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:He,onChange:we=>Ge(we.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${pe.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:pe.type})}),i.jsx("td",{className:"p-2 border",children:je?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:dt,onChange:we=>_t(we.target.value)}):ql(pe.amount)}),i.jsx("td",{className:"p-2 border",children:je?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:jt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Ot,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Qt(pe.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>Bt(pe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Qt(pe.id),children:"Eliminar"})]})})]},pe.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:f_(me.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:ql(me.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:ql(me.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:ql(me.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:ql(me.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:ql(me.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:ql(me.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:ql(me.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:ql(me.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:ql(me.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:Re,onClick:yt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:Re?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),qe&&i.jsx("span",{className:"text-sm ml-2",children:qe})]}),Re&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),U&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>W(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:X,onChange:pe=>D(pe.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:V,onChange:pe=>Z(pe.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:be,onChange:pe=>L(pe.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Xe,children:"Agregar"})})]})]})})]})}const Ga=t=>`C$ ${Number(t??0).toFixed(2)}`,A_=t=>Number(t??0).toFixed(3);function cB(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),a=Number(t.totalSale??0),s=Number(t.totalCommissionVendors??0);if(e.length>0&&(a===0||r===0)){r=0,n=0,a=0,s=0;for(const v of e){const y=Number(v.packages??0);r+=y,n+=Number(v.totalProvider??y*(v.providerPricePack??0)),a+=Number(v.totalSale??y*(v.salePricePack??0));const b=v.commissionAmount??Number(v.totalSale??0)*Number(v.commissionPercent??0)/100;s+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((v,y)=>v+Number(y.amount||0),0),u=l.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),d=l.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):u,A=t.totalCredits!==void 0?Number(t.totalCredits):d,h=a-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):a-s-c-f+A;return{totalPackages:r,totalProvider:n,totalSale:a,commissionTotal:s,expenses:c,debits:f,credits:A,grossProfit:h,branchProfit:p,finalAmount:x}}function CK(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function hVe(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),u=async()=>{n(!0);const h=sr(bt(Pe,"invoicesCandies"),In("date","desc")),m=await $t(h),p=[];m.forEach(x=>{const v=x.data();p.push({id:x.id,date:v.date,number:v.number,description:v.description,status:v.status||"PENDIENTE",totalPackages:v.totalPackages||0,totalProvider:v.totalProvider||0,totalSale:v.totalSale||0,totalExpenses:v.totalExpenses||0,totalDebits:v.totalDebits||0,totalCredits:v.totalCredits||0,totalCommissionVendors:v.totalCommissionVendors||0,finalAmount:v.finalAmount||0,branchFactorPercent:v.branchFactorPercent||0,branchProfit:v.branchProfit||0,transactions:(v.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(v.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(v.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};g.useEffect(()=>{u()},[]);const d=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await Fn(er(Pe,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(a==null?void 0:a.id)===h.id&&s({...h,status:m})},f=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await qn(er(Pe,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(a==null?void 0:a.id)===h.id&&s(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},A=async()=>{if(!o.current||!a)return;const h=o.current,m=await Fg(h,{backgroundColor:"#ffffff",onclone:b=>{const w=b.body;w.style.background="#ffffff",w.querySelectorAll("*").forEach(j=>{const I=b.defaultView.getComputedStyle(j);I.boxShadow&&I.boxShadow!=="none"&&(j.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new an("p","mm","a4"),v=x.internal.pageSize.getWidth(),y=m.height*v/m.width;x.addImage(p,"PNG",0,0,v,y),x.save(`factura_candy_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(fVe,{onClose:()=>c(!1),onCreated:()=>{c(!1),u()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=cB(h),p=CK(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:A_(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>d(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>f(h),children:"Eliminar"})]})})]},h.id)})})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=cB(a),m=CK(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",A_(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Ga(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Ga(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Ga(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Ga(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Ga(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Ga(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Ga(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(a.transactions||[]).length>0?(a.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:A_(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Ga(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ga(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=cB(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:A_(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:Ga(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:Ga(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:Ga(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:Ga(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:Ga(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Ga(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Ga(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Ga(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Ga(h.finalAmount)})]})})]})})()]})]})}const Ms=t=>Math.round((Number(t)||0)*100)/100,b0=t=>Math.round((Number(t)||0)*1e3)/1e3,vo=t=>Number(t??0).toFixed(2),Oh=t=>Number(t??0).toFixed(3),AVe=(t,e)=>{var A;const r=t.date??((A=t.timestamp)!=null&&A.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((h,m)=>{const p=Number((h==null?void 0:h.packages)??(h==null?void 0:h.qty)??(h==null?void 0:h.quantity)??0),x=Number((h==null?void 0:h.lineFinal)??0)||Math.max(0,Number((h==null?void 0:h.unitPricePackage)||(h==null?void 0:h.unitPrice)||0)*p-Number((h==null?void 0:h.discount)||0));let v=0;return c>0&&l>0&&Number(x||0)>0&&(v=Ms(c*Number(x||0)/l)),{id:`${e}#${m}`,productName:String((h==null?void 0:h.productName)??"(sin nombre)"),quantity:p,amount:Ms(x),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:v}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0,f=Ms(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:String((t==null?void 0:t.productName)??"(sin nombre)"),quantity:u,amount:Ms(d),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:f}]};function mVe({role:t,roles:e,currentUserEmail:r,sellerCandyId:n}){const a=e&&e.length?e:t,s=!a||Sn(a,"admin"),o="daily_closures_candies",l="sales_candies",c="sellers_candies",[u,d]=g.useState(Ur(Gee(new Date),"yyyy-MM-dd")),[f,A]=g.useState(Ur(new Date,"yyyy-MM-dd")),[h,m]=g.useState(!0),[p,x]=g.useState([]),[v,y]=g.useState(null),[b,w]=g.useState(""),[j,I]=g.useState([]),[_,S]=g.useState("ALL"),[E,B]=g.useState({}),k=g.useRef(null);if(!s)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const P=async()=>{try{const X=await $t(bt(Pe,c)),D=[];X.forEach(V=>{const Z=V.data();D.push({id:V.id,name:Z.name||"",commissionPercent:Number(Z.commissionPercent||0)})}),I(D)}catch(X){console.error("Error cargando sellers_candies",X)}},O=async()=>{const X=performance.now();try{m(!0);const D=sr(bt(Pe,o),Ar("date",">=",u),Ar("date","<=",f)),V=await $t(D),Z=performance.now();console.log(" getDocs ms:",(Z-X).toFixed(1),"docs:",V.size);const be=[];V.forEach(J=>be.push({id:J.id,...J.data()}));const L=performance.now();console.log(" parse+set ms:",(L-Z).toFixed(1),"rows:",be.length),be.sort((J,De)=>J.date<De.date?1:J.date>De.date?-1:0),x(be),y(null);const Xe=new Set;be.forEach(J=>{(J.sales||[]).forEach(De=>{const ie=String((De==null?void 0:De.id)??"").split("#")[0].trim();ie&&Xe.add(ie)})});const re=Array.from(Xe).filter(J=>!E[J]);if(re.length>0){const J={};for(const De of re)try{const ie=await zs(er(Pe,l,De));if(ie.exists()){const He=ie.data();J[De]=AVe(He,De)}else J[De]=[]}catch(ie){console.error("Error leyendo sale",De,ie),J[De]=[]}B(De=>({...De,...J}))}}catch(D){console.error(D),w(" Error cargando liquidaciones.")}finally{m(!1)}};g.useEffect(()=>{P()},[]),g.useEffect(()=>{O()},[]);const z=async X=>{X.preventDefault(),await O()},oe=g.useMemo(()=>{const X={};return j.forEach(D=>X[D.id]=D.name||D.id),X},[j]),ce=X=>{const D=[];return(X.sales||[]).forEach(V=>{const Z=String((V==null?void 0:V.id)??"").trim();if(!Z)return;const be=Z.split("#")[0],Xe=(E[be]||[]).find(re=>re.id===Z);Xe?D.push(Xe):D.push({id:Z,productName:String((V==null?void 0:V.productName)??"(sin nombre)"),quantity:Number((V==null?void 0:V.quantity)??0),amount:Ms(Number((V==null?void 0:V.amount)??0)),date:String((V==null?void 0:V.date)??""),type:"CONTADO",vendorId:"",userEmail:String((V==null?void 0:V.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),D},ue=X=>_==="ALL"?X:X.filter(D=>(D.vendorId||"")===_),ge=g.useMemo(()=>p.map(X=>{const D=ue(ce(X));let V=0,Z=0,be=0,L=0,Xe=0,re=0;for(const J of D){const De=Number(J.quantity||0),ie=Number(J.amount||0),He=Number(J.vendorCommissionAmount||0);J.type==="CREDITO"?(Z+=De,L+=ie,re+=He):(V+=De,be+=ie,Xe+=He)}return{...X,_sales:D,_packsCash:b0(V),_packsCredit:b0(Z),_amountCash:Ms(be),_amountCredit:Ms(L),_comCash:Ms(Xe),_comCredit:Ms(re)}}),[p,E,_]),ne=g.useMemo(()=>{let X=0,D=0,V=0,Z=0,be=0,L=0;for(const Xe of ge)X+=Number(Xe._packsCash||0),D+=Number(Xe._packsCredit||0),V+=Number(Xe._amountCash||0),Z+=Number(Xe._amountCredit||0),be+=Number(Xe._comCash||0),L+=Number(Xe._comCredit||0);return{packsCash:b0(X),packsCredit:b0(D),totalSales:Ms(V+Z),amountCash:Ms(V),amountCredit:Ms(Z),comCash:Ms(be),comCredit:Ms(L)}},[ge]),Oe=g.useMemo(()=>{const X={},D={};for(const V of ge){const Z=V._sales||[];for(const be of Z){const L=(be.vendorId||"").trim();if(!L)continue;const Xe=oe[L]||be.userEmail||L,re=Ms(Number(be.vendorCommissionAmount||0));be.type==="CREDITO"?(D[L]||(D[L]={vendorId:L,name:Xe,total:0}),D[L].total=Ms(D[L].total+re)):(X[L]||(X[L]={vendorId:L,name:Xe,total:0}),X[L].total=Ms(X[L].total+re))}}return{cashRows:Object.values(X).filter(V=>V.total>0).sort((V,Z)=>Z.total-V.total),creditRows:Object.values(D).filter(V=>V.total>0).sort((V,Z)=>Z.total-V.total)}},[ge,oe]),Ue=g.useMemo(()=>j.map(X=>({id:X.id,label:X.name||X.id})).sort((X,D)=>X.label.localeCompare(D.label)),[j]),F=g.useMemo(()=>v&&ge.find(X=>X.id===v.id)||null,[v,ge]),H=g.useMemo(()=>F?F._sales||[]:[],[F]),K=g.useMemo(()=>{let X=0,D=0,V=0,Z=0;for(const be of H)be.type==="CREDITO"?(D+=Number(be.quantity||0),Z+=Number(be.amount||0)):(X+=Number(be.quantity||0),V+=Number(be.amount||0));return{packsCash:b0(X),packsCredit:b0(D),amountCash:Ms(V),amountCredit:Ms(Z)}},[H]),U=g.useMemo(()=>{const X={};for(const D of H){const V=D.productName||"(sin nombre)";X[V]||(X[V]={productName:V,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const Z=Number(D.quantity||0),be=Number(D.amount||0),L=Number(D.vendorCommissionAmount||0);D.type==="CREDITO"?(X[V].packsCredit=b0(X[V].packsCredit+Z),X[V].amountCredit=Ms(X[V].amountCredit+be),X[V].comCredit=Ms(X[V].comCredit+L)):(X[V].packsCash=b0(X[V].packsCash+Z),X[V].amountCash=Ms(X[V].amountCash+be),X[V].comCash=Ms(X[V].comCash+L))}return Object.values(X)},[H]),W=async()=>{if(!k.current||!F)return;const X=k.current;X.classList.add("force-pdf-colors");try{const V=(await Fg(X,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Z=new an;Z.addImage(V,"PNG",10,10,190,0),Z.save(`liquidacion_${F.date}.pdf`)}finally{X.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:z,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:X=>d(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:X=>A(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:_,onChange:X=>S(X.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),Ue.map(X=>i.jsx("option",{value:X.id,children:X.label},X.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Oh(ne.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Oh(ne.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(ne.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(ne.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(ne.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(ne.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(ne.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),Oe.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Oe.cashRows.map(X=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:X.name}),i.jsxs("strong",{className:"ml-2",children:["C$",vo(X.total)]})]},X.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),Oe.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Oe.creditRows.map(X=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:X.name}),i.jsxs("strong",{className:"ml-2",children:["C$",vo(X.total)]})]},X.vendorId))})]})]}),h?i.jsx("p",{children:"Cargando..."}):ge.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:ge.map(X=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:X.date}),i.jsx("td",{className:"border p-1",children:Oh(X._packsCash)}),i.jsx("td",{className:"border p-1",children:Oh(X._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>y(X),children:"Ver detalle"})})})]},X.id))})]}),F&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",F.date]}),i.jsx("button",{onClick:()=>y(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:W,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:k,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",vo(K.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",vo(K.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Oh(K.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Oh(K.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:H.map((X,D)=>{const V=X.vendorId&&oe[X.vendorId]?oe[X.vendorId]:X.userEmail,Z=Ms(Number(X.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:V}),i.jsx("td",{className:"border p-1",children:X.productName}),i.jsx("td",{className:"border p-1",children:X.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Oh(X.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X.amount)]}),i.jsx("td",{className:"border p-1",children:Z>0?`C$${vo(Z)}`:""}),i.jsx("td",{className:"border p-1",children:X.date||""})]},D)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),U.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:U.map((X,D)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:X.productName}),i.jsx("td",{className:"border p-1",children:Oh(X.packsCash)}),i.jsx("td",{className:"border p-1",children:Oh(X.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(X.comCredit)]})]},D))})]})]})]}),b&&i.jsx("p",{className:"mt-3 text-sm",children:b})]})}const zr=t=>Math.round((Number(t)||0)*100)/100,hl=t=>Math.round((Number(t)||0)*1e3)/1e3,Qr=t=>Number(t??0).toFixed(2),si=t=>Number(t??0).toFixed(3),iI=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},Rr=t=>{const e=Number(t);return Number.isFinite(e)?e:0},pVe=t=>Math.max(0,Math.min(1,t));function _K({title:t,series:e,valuePrefix:r="C$"}){const u=e.map(b=>Number(b.value||0)),d=u.length?Math.min(...u):0,f=u.length?Math.max(...u):0,A=f-d||1,h=840,m=204,p=e.map((b,w)=>{const j=44+(e.length<=1?h/2:w/(e.length-1)*h),I=18+(1-(Number(b.value||0)-d)/A)*m;return{x:j,y:I,...b}}),x=p.map((b,w)=>`${w===0?"M":"L"} ${b.x.toFixed(2)} ${b.y.toFixed(2)}`).join(" "),v=p[p.length-1],y=v?v.value:0;return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base",children:t}),i.jsxs("div",{className:"text-xs text-gray-600 whitespace-nowrap",children:["ltimo: ",i.jsx("strong",{children:r+Qr(y)})]})]}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("svg",{viewBox:"0 0 900 260",className:"min-w-[720px] w-full h-auto",role:"img","aria-label":t,children:[[0,1,2,3].map(b=>{const w=18+b/3*m;return i.jsx("line",{x1:44,y1:w,x2:884,y2:w,stroke:"#e5e7eb",strokeWidth:"1"},b)}),i.jsxs("text",{x:8,y:28,fontSize:"12",fill:"#6b7280",children:[r,Qr(f)]}),i.jsxs("text",{x:8,y:18+m,fontSize:"12",fill:"#6b7280",children:[r,Qr(d)]}),i.jsx("path",{d:x,fill:"none",stroke:"#111827",strokeWidth:"2.5"}),p.map((b,w)=>i.jsx("circle",{cx:b.x,cy:b.y,r:"3.5",fill:"#111827"},w)),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("text",{x:44,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"start",children:e[0].label}),i.jsx("text",{x:884,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"end",children:e[e.length-1].label})]})]})})]})}function gVe({title:t,items:e}){const r=e.reduce((f,A)=>f+Number(A.value||0),0),n=240,a=86,s=120,o=120,l=r>0?r:1;let c=0;const u=["#111827","#374151","#6b7280","#9ca3af"],d=e.map((f,A)=>{const h=Math.max(0,Number(f.value||0)),m=c/l,p=h/l;c+=h;const x=m+p,v=m*Math.PI*2-Math.PI/2,y=x*Math.PI*2-Math.PI/2,b=s+a*Math.cos(v),w=o+a*Math.sin(v),j=s+a*Math.cos(y),I=o+a*Math.sin(y),_=p>.5?1:0;return{d:[`M ${s} ${o}`,`L ${b.toFixed(2)} ${w.toFixed(2)}`,`A ${a} ${a} 0 ${_} 1 ${j.toFixed(2)} ${I.toFixed(2)}`,"Z"].join(" "),fill:u[A%u.length],...f,frac:p}});return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base mb-2",children:t}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("div",{className:"w-full md:w-auto overflow-x-auto",children:i.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"min-w-[240px] w-[260px] h-auto",role:"img","aria-label":t,children:[d.map((f,A)=>i.jsx("path",{d:f.d,fill:f.fill},A)),i.jsx("circle",{cx:s,cy:o,r:"48",fill:"#ffffff"}),i.jsx("text",{x:s,y:o-4,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:"Total"}),i.jsxs("text",{x:s,y:o+16,textAnchor:"middle",fontSize:"14",fill:"#111827",fontWeight:"700",children:["C$",Qr(r)]})]})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.map((f,A)=>{const h=Number(f.value||0),m=pVe(h/(r||1))*100;return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"text-sm font-semibold truncate",children:f.label}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Qr(h)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[m.toFixed(1),"%"]}),i.jsx("div",{className:"h-2 bg-white border rounded-full mt-2 overflow-hidden",children:i.jsx("div",{className:"h-full",style:{width:`${m}%`,background:u[A%u.length]}})})]},f.label)})}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Distribucin basada en ventas del perodo con los filtros actuales."})]})]})]})}const xVe=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),a=t.status??"FLOTANTE",s=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),u=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",d=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,f=Number(t.vendorCommissionAmount??0)||0,A=iI(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((v,y)=>{const b=Number((v==null?void 0:v.packages)??0)||0,w=Number((v==null?void 0:v.total)??0)||Math.max(0,Number((v==null?void 0:v.unitPricePackage)||0)*b-Number((v==null?void 0:v.discount)||0)),j=iI(v==null?void 0:v.branch)||A;let I=0;return f>0&&d>0&&w>0&&(I=zr(f*w/d)),{id:`${e}#${y}`,docId:e,productId:String((v==null?void 0:v.productId)??""),productName:String((v==null?void 0:v.productName)??"(sin nombre)"),date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:j||"",packages:b,amount:zr(w),commission:zr(I)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=zr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:A||"",packages:h,amount:zr(m),commission:zr(p)}]};function vVe({role:t,roles:e}){var kt;const r=e&&e.length?e:t,n=!r||Sn(r,"admin"),a=Ur(new Date,"yyyy-MM-dd"),[s,o]=g.useState(a),[l,c]=g.useState(a),[u,d]=g.useState("TODAS"),[f,A]=g.useState("AMBAS"),[h,m]=g.useState("ALL"),[p,x]=g.useState("ALL"),[v,y]=g.useState(""),[b,w]=g.useState(""),[j,I]=g.useState(""),[_,S]=g.useState(""),[E,B]=g.useState("DIA"),[k,P]=g.useState(!0),[O,z]=g.useState(""),[oe,ce]=g.useState([]),[ue,ge]=g.useState([]),[ne,Oe]=g.useState([]),[Ue,F]=g.useState({}),[H,K]=g.useState([]),[U,W]=g.useState([]),[X,D]=g.useState([]),[V,Z]=g.useState([]),[be,L]=g.useState([]),[Xe,re]=g.useState([]),[J,De]=g.useState(""),[ie,He]=g.useState(""),[Ge,dt]=g.useState(null),_t=g.useRef(null),[Bt,Ot]=g.useState([]),[jt,Qt]=g.useState("DETALLE"),[Ft,$e]=g.useState(!1),[Fe,Ze]=g.useState(!1),[Te,ee]=g.useState(!1),[me,Re]=g.useState(!1),[he,qe]=g.useState(!1),[st,yt]=g.useState(!1),pe=g.useMemo(()=>{const le={};return U.forEach(We=>le[We.id]=String(We.name||"").trim()),le},[U]),je=g.useMemo(()=>{const le={};return ue.forEach(We=>le[We.id]=We),le},[ue]),we=le=>{const We=le.customerId?pe[le.customerId]:"";return(le.customerName||We||"").trim()||(le.customerId?pe[le.customerId]||le.customerId:"")||""};g.useEffect(()=>{if(!n)return;(async()=>{try{const We=await $t(bt(Pe,"inventory_candies")),it=[];We.forEach(ot=>it.push({id:ot.id,...ot.data()})),Ot(it)}catch(We){console.error("inventory_candies all error:",We),Ot([])}})()},[n]),g.useEffect(()=>{(async()=>{try{const We=await $t(bt(Pe,"sellers_candies")),it=[];We.forEach(Nt=>{const Rt=Nt.data();it.push({id:Nt.id,name:String(Rt.name||"").trim(),commissionPercent:Number(Rt.commissionPercent||0),branch:Rt.branch||""})});const ot=new Map;it.forEach(Nt=>ot.set(Nt.id,Nt)),ge(Array.from(ot.values()).sort((Nt,Rt)=>Nt.name.localeCompare(Rt.name)))}catch(We){console.error(We)}})()},[]),g.useEffect(()=>{if(!n||!s||!l)return;P(!0),z("");const le=sr(bt(Pe,"sales_candies"),Ar("date",">=",s),Ar("date","<=",l),In("date","asc")),We=jd(le,it=>{const ot=[];it.forEach(Nt=>ot.push(...xVe(Nt.data(),Nt.id))),ce(ot),P(!1)},it=>{console.error("sales_candies periodo error:",it),ce([]),P(!1),z(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>We()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const We=sr(bt(Pe,"candy_main_orders"),Ar("date",">=",s),Ar("date","<=",l)),it=await $t(We),ot=[];it.forEach(Nt=>ot.push({id:Nt.id,...Nt.data()})),Oe(ot)}catch(We){console.error("candy_main_orders error:",We),Oe([])}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const We=await $t(sr(bt(Pe,"candy_main_orders"),In("createdAt","desc"))),it={},ot=(Nt,Rt)=>`${Nt}#${String(Rt).padStart(10,"0")}`;We.forEach(Nt=>{var kr;const Rt=Nt.data(),nr=Number(((kr=Rt.createdAt)==null?void 0:kr.seconds)??0),_r=String(Rt.date||""),$r=ot(_r,nr),or=Array.isArray(Rt.items)?Rt.items:[];for(const en of or){const rn=String(en.id||en.productId||"");if(!rn)continue;const Er={unitPriceRivas:Number(en.unitPriceRivas||0),unitPriceSanJorge:Number(en.unitPriceSanJorge||0),unitPriceIsla:Number(en.unitPriceIsla||0),key:$r},Ee=it[rn];(!Ee||Er.key>Ee.key)&&(it[rn]=Er)}}),F(it)}catch(We){console.error("candy_main_orders catalog error:",We),F({})}})()},[n]),g.useEffect(()=>{if(!n)return;const le=sr(bt(Pe,"inventory_candies_sellers"),Ar("date",">=",s),Ar("date","<=",l)),We=jd(le,it=>{const ot=[];it.forEach(Nt=>ot.push({id:Nt.id,...Nt.data()})),K(ot)},it=>{console.error("inventory_candies_sellers error:",it),K([])});return()=>We()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const We=sr(bt(Pe,"expenses_candies"),Ar("date",">=",s),Ar("date","<=",l),In("date","asc")),it=await $t(We),ot=[];it.forEach(Nt=>ot.push({id:Nt.id,...Nt.data()})),Z(ot)}catch(We){console.warn("expenses_candies sin ndice, usando fallback:",We);try{const it=await $t(bt(Pe,"expenses_candies")),ot=[];it.forEach(Nt=>ot.push({id:Nt.id,...Nt.data()})),Z(ot.filter(Nt=>String(Nt.date||"")>=s&&String(Nt.date||"")<=l))}catch(it){console.error(it),Z([])}}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const We=await $t(bt(Pe,"inventory_candies")),it=[];We.forEach(ot=>it.push({id:ot.id,...ot.data()})),L(it)}catch(We){console.error("inventory_candies global error:",We),L([])}})()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const We=await $t(bt(Pe,"inventory_candies_sellers")),it=[];We.forEach(ot=>it.push({id:ot.id,...ot.data()})),re(it)}catch(We){console.error("inventory_candies_sellers global error:",We),re([])}})()},[n]),g.useEffect(()=>{if(!n)return;const le=sr(bt(Pe,"customers_candies")),We=jd(le,it=>{const ot=[];it.forEach(Nt=>{var Rt,nr,_r;return ot.push({id:Nt.id,name:String(((Rt=Nt.data())==null?void 0:Rt.name)||"").trim(),initialDebt:Number(((nr=Nt.data())==null?void 0:nr.initialDebt)||0),initialDebtDate:String(((_r=Nt.data())==null?void 0:_r.initialDebtDate)||"").trim()})}),W(ot)},it=>{console.error("customers_candies snapshot error:",it),W([])});return()=>We()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const We=sr(bt(Pe,"ar_movements"),Ar("date","<=",l),In("date","asc")),it=await $t(We),ot=[];it.forEach(Nt=>ot.push({id:Nt.id,...Nt.data()})),D(ot)}catch(We){console.warn("ar_movements sin ndice, usando fallback:",We);try{const it=await $t(bt(Pe,"ar_movements")),ot=[];it.forEach(Nt=>ot.push({id:Nt.id,...Nt.data()})),D(ot.filter(Nt=>String(Nt.date||"")<=l))}catch(it){console.error(it),D([])}}})()},[n,l]);const Ye=g.useMemo(()=>{let le=[...oe];if(u!=="TODAS"&&(le=le.filter(ot=>ot.status===u)),f==="CASH"&&(le=le.filter(ot=>ot.type==="CONTADO")),f==="CREDITO"&&(le=le.filter(ot=>ot.type==="CREDITO")),h!=="ALL"&&(le=le.filter(ot=>(ot.vendorId||"")===h)),p!=="ALL"&&(le=le.filter(ot=>ot.branch===p)),v.trim()){const ot=v.trim().toLowerCase();le=le.filter(Nt=>(Nt.productName||"").toLowerCase().includes(ot))}if(b.trim()){const ot=b.trim().toLowerCase();le=le.filter(Nt=>(we(Nt)||"").toLowerCase().includes(ot))}const We=j.trim()?Number(j):null,it=_.trim()?Number(_):null;return We!==null&&!Number.isNaN(We)&&(le=le.filter(ot=>(ot.amount||0)>=We)),it!==null&&!Number.isNaN(it)&&(le=le.filter(ot=>(ot.amount||0)<=it)),le},[oe,u,f,h,p,v,b,j,_,pe]),xe=g.useMemo(()=>{let le=0,We=0,it=0,ot=0,Nt=0,Rt=0;for(const _r of Ye){const $r=Rr(_r.packages),or=Rr(_r.amount),kr=Rr(_r.commission);_r.type==="CREDITO"?(We+=$r,ot+=or,Rt+=kr):(le+=$r,it+=or,Nt+=kr)}const nr=zr(it+ot);return{packsCash:hl(le),packsCredit:hl(We),salesCash:zr(it),salesCredit:zr(ot),salesTotal:nr,commCash:zr(Nt),commCredit:zr(Rt),commTotal:zr(Nt+Rt)}},[Ye]),Se=g.useMemo(()=>{let le=0,We=0,it=0,ot=0,Nt=0,Rt=0;for(const nr of ne){const _r=Array.isArray(nr.items)?nr.items:[];for(const $r of _r)le+=Rr($r.totalRivas),We+=Rr($r.totalSanJorge),it+=Rr($r.totalIsla),ot+=Rr($r.gainRivas),Nt+=Rr($r.gainSanJorge),Rt+=Rr($r.gainIsla)}return{expectedRivas:zr(le),expectedSanJorge:zr(We),expectedIsla:zr(it),grossRivas:zr(ot),grossSanJorge:zr(Nt),grossIsla:zr(Rt),grossTotal:zr(ot+Nt+Rt),expectedTotal:zr(le+We+it)}},[ne]),xt=g.useMemo(()=>{const le={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const We of Ye){const it=We.branch;it&&(le[it].sales+=Rr(We.amount),le[it].packages+=Rr(We.packages))}return{RIVAS:{sales:zr(le.RIVAS.sales),packages:hl(le.RIVAS.packages)},SAN_JORGE:{sales:zr(le.SAN_JORGE.sales),packages:hl(le.SAN_JORGE.packages)},ISLA:{sales:zr(le.ISLA.sales),packages:hl(le.ISLA.packages)}}},[Ye]),Pt=g.useMemo(()=>({RIVAS:zr(xt.RIVAS.sales-Se.expectedRivas),SAN_JORGE:zr(xt.SAN_JORGE.sales-Se.expectedSanJorge),ISLA:zr(xt.ISLA.sales-Se.expectedIsla)}),[xt,Se]),It=g.useMemo(()=>{const le={},We={};for(const Nt of Ye){const Rt=(Nt.vendorId||"").trim();if(!Rt)continue;const nr=ue.find(or=>or.id===Rt),_r=(nr==null?void 0:nr.name)||Nt.vendorName||"(sin vendedor)",$r=Rr(Nt.commission);Nt.type==="CREDITO"?(We[Rt]||(We[Rt]={vendorId:Rt,name:_r,total:0}),We[Rt].total=zr(We[Rt].total+$r)):(le[Rt]||(le[Rt]={vendorId:Rt,name:_r,total:0}),le[Rt].total=zr(le[Rt].total+$r))}const it=Object.values(le).sort((Nt,Rt)=>Rt.total-Nt.total),ot=Object.values(We).sort((Nt,Rt)=>Rt.total-Nt.total);return{cashArr:it,creditArr:ot}},[Ye,ue]),Ut=g.useMemo(()=>{const le=(Er,Ee)=>Er.reduce((gt,Zt)=>gt+Number((Zt==null?void 0:Zt[Ee])??0),0),We=Er=>{const Ee=Number(Er);return Number.isFinite(Ee)?Math.floor(Ee):0},it=Er=>{const Ee=Number((Er==null?void 0:Er.totalPackages)??0);if(Ee>0)return Ee;const gt=Array.isArray(Er==null?void 0:Er.items)?Er.items:[];return le(gt,"packages")};let ot=0,Nt=0;for(const Er of ne){const Ee=Array.isArray(Er.items)?Er.items:[];if(Ee.length)for(const gt of Ee)ot+=Number((gt==null?void 0:gt.subtotal)??0);else ot+=Number(Er.subtotal??0);Nt+=it(Er)}let Rt=0,nr=0,_r=0;const $r=Er=>{const Ee=Number(Er==null?void 0:Er.remainingPackages);if(Number.isFinite(Ee)&&Ee>0)return Math.floor(Ee);const gt=Math.max(1,We((Er==null?void 0:Er.unitsPerPackage)??1)),Zt=We((Er==null?void 0:Er.remainingUnits)??(Er==null?void 0:Er.remaining)??0);return Zt>0?Math.max(0,Math.floor(Zt/gt)):0};for(const Er of H)Rt+=Number(Er.subtotal??0),nr+=Number(Er.packages??0),_r+=$r(Er);const or=new Set(ne.filter(Er=>String(Er.date||"")>=s&&String(Er.date||"")<=l).map(Er=>Er.id));let kr=0;for(const Er of Bt){const Ee=String(Er.orderId||"").trim();Ee&&or.has(Ee)&&(kr+=Number(Er.remainingPackages??0))}const en=be.reduce((Er,Ee)=>Er+Rr(Ee.remainingPackages),0),rn=Xe.reduce((Er,Ee)=>Er+Rr(Ee.remainingPackages),0);return{providerTotalMaster:zr(ot),providerTotalVendor:zr(Rt),orderedPacksMaster:hl(Nt),remainingPacksMaster:hl(kr),orderedPacksVendor:hl(nr),remainingPacksVendor:hl(_r),globalRemainingMaster:hl(en),globalRemainingVendor:hl(rn)}},[ne,H,Bt,s,l,be,Xe]),Ht=g.useMemo(()=>{const le={};let We=0;for(const it of V){const ot=String(it.date||"").trim();if(!ot)continue;const Nt=Math.max(0,Rr(it.amount));We+=Nt,le[ot]=zr((le[ot]||0)+Nt)}return{total:zr(We),byDay:le}},[V]),Le=g.useMemo(()=>{let le=0;for(const We of ne){const it=Array.isArray(We.items)?We.items:[];if(it.length)for(const ot of it)le+=Rr(ot==null?void 0:ot.subtotal);else le+=Rr(We.subtotal)}return zr(le)},[ne]),Ce=g.useMemo(()=>{var $r;const le=or=>{const kr=Math.max(1,Math.floor(Rr(or.unitsPerPackage||1))),en=Rr(or.totalUnits)>0?Rr(or.totalUnits):Rr(or.packages)*kr;let rn=0;Rr(or.remainingUnits)>0?rn=Rr(or.remainingUnits):Rr(or.remainingPackages)>0?rn=Rr(or.remainingPackages)*kr:rn=0;const Er=Math.max(0,en-rn);return{orderedUnits:en,remainingUnits:rn,soldUnits:Er,upp:kr}},We=or=>{const kr=je[or];return iI(kr==null?void 0:kr.branch)||"ISLA"},it=(or,kr)=>{var en,rn,Er;return kr==="ISLA"?Rr(((en=Ue[String(or.productId||"")])==null?void 0:en.unitPriceIsla)??or.unitPriceIsla):kr==="RIVAS"?Rr(((rn=Ue[String(or.productId||"")])==null?void 0:rn.unitPriceRivas)??or.unitPriceRivas):kr==="SAN_JORGE"?Rr(((Er=Ue[String(or.productId||"")])==null?void 0:Er.unitPriceSanJorge)??or.unitPriceSanJorge):0},ot=(or,kr)=>{const en=Math.max(0,Math.floor(Rr(or.packages))),rn=it(or,kr),Er=zr(rn*en);if(Er>0)return Er;const Ee=Rr(or.totalVendor)||(kr==="ISLA"?Rr(or.totalIsla):kr==="RIVAS"?Rr(or.totalRivas):kr==="SAN_JORGE"?Rr(or.totalSanJorge):0);if(Ee>0)return Ee;const gt=Rr(or.unitPriceVendor);if(gt>0){const{orderedUnits:Zt}=le(or);return gt*Zt}return 0},Nt=(or,kr)=>{const en=it(or,kr),{orderedUnits:rn,upp:Er}=le(or);if(en>0&&Er>0)return en/Er;const Ee=Rr(or.unitPriceVendor);if(Ee>0)return Ee;const gt=ot(or,kr);return gt>0&&rn>0?gt/rn:0},Rt=new Map;for(const or of H){const kr=String(or.orderId||"").trim(),en=kr||`DOC:${or.id}`,rn=String(or.sellerId||"").trim(),Er=String(or.sellerName||"").trim()||rn&&(($r=je[rn])==null?void 0:$r.name)||""||"(sin vendedor)",Ee=String(or.date||"").trim(),gt=rn?We(rn):"",{orderedUnits:Zt,remainingUnits:Mr,soldUnits:Or}=le(or),ir=ot(or,gt),br=Nt(or,gt),wr=br>0?br*Or:Zt>0?ir*Or/Zt:0,Xr=zr(ir-wr);Rt.has(en)||Rt.set(en,{orderKey:en,orderId:kr||en,date:Ee,sellerId:rn,sellerName:Er,branch:gt,totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0,lines:[]});const Ir=Rt.get(en);Ir.lines.push({...or,orderedUnits:Zt,soldUnits:Or,remainingUnits:Mr,lineTotal:zr(ir),lineSoldValue:zr(wr),lineRemainingValue:zr(Xr)}),Ir.totalOrden+=ir,Ir.vendido+=wr,Ir.restante+=Xr,Ir.comision+=Rr(or.uVendor??or.vendorProfit??or.gainVendor)}for(const or of Rt.values())or.comision=zr(or.comision),or.totalEsperado=zr(or.totalOrden-or.comision),or.totalOrden=zr(or.totalOrden),or.vendido=zr(or.vendido),or.restante=zr(or.restante);const nr=Array.from(Rt.values()).sort((or,kr)=>or.date&&kr.date?or.date<kr.date?1:-1:kr.totalOrden-or.totalOrden),_r=nr.reduce((or,kr)=>(or.totalOrden+=Rr(kr.totalOrden),or.vendido+=Rr(kr.vendido),or.restante+=Rr(kr.restante),or.comision+=Rr(kr.comision),or.totalEsperado+=Rr(kr.totalEsperado),or),{totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0});return{global:{totalOrden:zr(_r.totalOrden),vendido:zr(_r.vendido),restante:zr(_r.restante),comision:zr(_r.comision),totalEsperado:zr(_r.totalEsperado)},orders:nr}},[H,je,Ue]),Ae=g.useMemo(()=>{var ot,Nt,Rt;let le=0,We=0;for(const nr of H){const _r=String(nr.sellerId||"").trim(),$r=_r?je[_r]:void 0,or=iI($r==null?void 0:$r.branch)||"ISLA",kr=Math.max(0,Math.floor(Rr(nr.packages)));if(!kr)continue;const en=Rr(or==="ISLA"?((ot=Ue[String(nr.productId||"")])==null?void 0:ot.unitPriceIsla)??nr.unitPriceIsla:or==="RIVAS"?((Nt=Ue[String(nr.productId||"")])==null?void 0:Nt.unitPriceRivas)??nr.unitPriceRivas:((Rt=Ue[String(nr.productId||"")])==null?void 0:Rt.unitPriceSanJorge)??nr.unitPriceSanJorge);let rn=zr(en*kr);rn||(rn=Rr(or==="ISLA"?nr.totalIsla:or==="RIVAS"?nr.totalRivas:nr.totalSanJorge)),rn&&(le+=rn,We+=rn)}const it=zr(Rr(Se.expectedIsla)-We);return{dispersedTotal:zr(le),dispersedIsla:zr(We),totalExistenteIsla:it}},[H,je,Se.expectedIsla,Ue]),Qe=g.useMemo(()=>({net:zr(H.reduce((We,it)=>{const ot=it.uNeta,Nt=Rr(ot);if(Nt!==0||ot===0)return We+Nt;const Rt=Rr(it.grossProfit),nr=Rr(it.logisticAllocated??it.gastos??it.gasto),_r=Rr(it.uVendor??it.vendorProfit);return We+(Rt-nr-_r)},0))}),[H]),fe=g.useMemo(()=>{let le=0,We=0,it=0;for(const ot of Ye){if(ot.type!=="CREDITO")continue;const Nt=Rr(ot.amount),Rt=Rr(ot.commission);le+=Nt,We+=Nt-Rt}for(const ot of X){const Nt=String(ot.date||"").trim();if(!Nt||Nt<s||Nt>l)continue;const Rt=Rr(ot.amount);(ot.type||(Rt<0?"ABONO":"CARGO"))==="ABONO"&&(it+=Math.abs(Rt))}return{cxc:zr(le),recaudado:zr(it),utilidadBruta:zr(We)}},[Ye,X,s,l]),te=g.useMemo(()=>{if(!ie)return null;const le=Ce.orders.find(ot=>ot.orderKey===ie);if(!le)return null;const We={};for(const ot of le.lines){const Nt=String(ot.productName||"(sin nombre)");We[Nt]||(We[Nt]={productName:Nt,asociados:0,vendidos:0,restantes:0});const Rt=Math.max(0,Math.floor(Rr(ot.packages))),nr=Math.max(1,Math.floor(Rr(ot.unitsPerPackage||1))),_r=Math.max(0,Math.floor(Rr(ot.remainingPackages)||(Rr(ot.remainingUnits)>0?Rr(ot.remainingUnits)/nr:0))),$r=Math.max(0,Rt-_r);We[Nt].asociados+=Rt,We[Nt].vendidos+=$r,We[Nt].restantes+=_r}const it=Object.values(We).map(ot=>({...ot,asociados:Math.floor(ot.asociados),vendidos:Math.floor(ot.vendidos),restantes:Math.floor(ot.restantes)})).sort((ot,Nt)=>Nt.asociados-ot.asociados);return{...le,products:it}},[ie,Ce.orders]),_e=g.useMemo(()=>{const le=be.reduce((it,ot)=>it+Rr(ot.remainingPackages),0),We=Xe.reduce((it,ot)=>it+Rr(ot.remainingPackages),0);return{masterRemainingPackages:hl(le),vendorRemainingPackages:hl(We)}},[be,Xe]),R=g.useMemo(()=>{const le=new Map,We=ot=>E==="DIA"?{key:ot.date,label:ot.date}:E==="VENDEDOR"?{key:ot.vendorId||"",label:ot.vendorName||""}:E==="PRODUCTO"?{key:ot.productName||"",label:ot.productName||""}:{key:ot.branch||"",label:ot.branch||""};for(const ot of Ye){const{key:Nt,label:Rt}=We(ot);le.has(Nt)||le.set(Nt,{key:Nt,label:Rt,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const nr=le.get(Nt);nr.rows.push(ot),ot.type==="CREDITO"?(nr.packsCredit+=Rr(ot.packages),nr.salesCredit+=Rr(ot.amount),nr.commCredit+=Rr(ot.commission)):(nr.packsCash+=Rr(ot.packages),nr.salesCash+=Rr(ot.amount),nr.commCash+=Rr(ot.commission))}const it=Array.from(le.values()).map(ot=>({...ot,packsCash:hl(ot.packsCash),packsCredit:hl(ot.packsCredit),salesCash:zr(ot.salesCash),salesCredit:zr(ot.salesCredit),commCash:zr(ot.commCash),commCredit:zr(ot.commCredit)}));return E==="DIA"?it.sort((ot,Nt)=>ot.key<Nt.key?1:-1):it.sort((ot,Nt)=>Nt.salesCash+Nt.salesCredit-(ot.salesCash+ot.salesCredit)),it},[Ye,E]),Q=g.useMemo(()=>{if(!J)return[];const le=R.find(We=>We.key===J);return(le==null?void 0:le.rows)||[]},[J,R]),G=g.useMemo(()=>{const le={};for(const We of Q){const it=We.productName||"(sin nombre)";le[it]||(le[it]={productName:it,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),We.type==="CREDITO"?(le[it].packsCredit+=Rr(We.packages),le[it].salesCredit+=Rr(We.amount),le[it].commCredit+=Rr(We.commission)):(le[it].packsCash+=Rr(We.packages),le[it].salesCash+=Rr(We.amount),le[it].commCash+=Rr(We.commission))}return Object.values(le).map(We=>({...We,packsCash:hl(We.packsCash),packsCredit:hl(We.packsCredit),salesCash:zr(We.salesCash),salesCredit:zr(We.salesCredit),commCash:zr(We.commCash),commCredit:zr(We.commCredit)})).sort((We,it)=>it.salesCash+it.salesCredit-(We.salesCash+We.salesCredit))},[Q]),se=g.useMemo(()=>{const le={},We=Rt=>(pe[Rt]||"").trim()||Rt;for(const Rt of U){const nr=String(Rt.id||"").trim();nr&&(le[nr]={customerId:nr,name:We(nr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:Rr(Rt.initialDebt),initialDebtDate:String(Rt.initialDebtDate||"").trim(),movements:[]})}for(const Rt of X){const nr=String(Rt.customerId||"").trim();if(!nr)continue;const _r=String(Rt.date||"");_r&&_r>l||(le[nr]||(le[nr]={customerId:nr,name:We(nr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:0,initialDebtDate:"",movements:[]}),le[nr].movements.push(Rt))}const it=(Rt,nr,_r)=>{const $r=Number(Rt||0);if(!$r)return 0;const or=String(nr||"").trim();return or&&_r.some(en=>{var Zt;const rn=Number(en.amount||0);if(!(rn>0))return!1;const Er=Math.abs(rn-$r)<.01,Ee=String(en.date||"").trim()===or,gt=!!((Zt=en.ref)!=null&&Zt.saleId);return Er&&Ee&&gt})?0:$r},ot=Object.values(le).map(Rt=>{const nr=Rt.movements.reduce((kr,en)=>kr+Rr(en.amount),0),_r=it(Rt.initialDebt,Rt.initialDebtDate,Rt.movements);let $r="",or=0;for(const kr of Rt.movements){const en=kr.type||(Rr(kr.amount)<0?"ABONO":"CARGO"),rn=String(kr.date||"");if(en==="ABONO"){const Er=Math.abs(Rr(kr.amount));(!$r||rn>$r)&&($r=rn,or=Er)}}return{customerId:Rt.customerId,name:Rt.name,balance:zr(_r+nr),lastPayment:$r,lastPaymentAmount:zr(or)}}).filter(Rt=>Rt.balance>0).sort((Rt,nr)=>nr.balance-Rt.balance),Nt=zr(ot.reduce((Rt,nr)=>Rt+nr.balance,0));return{count:ot.length,totalPending:Nt,list:ot.slice(0,20)}},[X,pe,U,l]),Ne=g.useMemo(()=>{if(!Ge)return[];const le=X.filter(it=>(it.customerId||"").trim()===Ge.customerId).filter(it=>!it.date||String(it.date)<=l).map(it=>({id:it.id,date:String(it.date||""),type:String(it.type||""),amount:zr(Rr(it.amount))})).sort((it,ot)=>it.date<ot.date?-1:it.date>ot.date?1:0);let We=0;return le.map(it=>{const ot=it.type==="ABONO"?-it.amount:it.amount;return We=zr(We+ot),{...it,running:We}})},[Ge,X,l]),Me=g.useMemo(()=>Ge?oe.filter(le=>(le.customerId||"").trim()===Ge.customerId).filter(le=>!le.date||String(le.date)<=l).sort((le,We)=>le.date<We.date?-1:le.date>We.date?1:0):[],[Ge,oe,l]),ze=g.useMemo(()=>{const le=zr(xe.salesTotal),We=zr(xe.commTotal),it=zr(Ht.total),ot=zr(le-We-it),Nt=new Set;for(const kr of Ye)kr.date&&Nt.add(kr.date);const Rt=Math.max(1,Nt.size),nr=zr(le/Rt),_r=zr(We/Rt),$r=zr(it/Rt),or=zr(ot/Rt);return{ingreso:le,comision:We,gastos:it,gananciaNeta:ot,daysCount:Rt,ingresoDia:nr,comisionDia:_r,gastosDia:$r,netaDia:or}},[xe,Ht.total,Ye]),Ie=g.useMemo(()=>{const le={};for(const Nt of Ye){const Rt=Nt.date;Rt&&(le[Rt]||(le[Rt]={date:Rt,ingreso:0,comision:0}),le[Rt].ingreso+=Rr(Nt.amount),le[Rt].comision+=Rr(Nt.commission))}const We=Object.keys(le).sort((Nt,Rt)=>Nt<Rt?-1:1),it=We.map(Nt=>({label:Nt.slice(5),value:zr(le[Nt].ingreso)})),ot=We.map(Nt=>{var or,kr;const Rt=Rr((or=le[Nt])==null?void 0:or.ingreso),nr=Rr((kr=le[Nt])==null?void 0:kr.comision),_r=Rr(Ht.byDay[Nt]||0),$r=Rt-nr-_r;return{label:Nt.slice(5),value:zr($r)}});return{seriesIngreso:it,seriesNeta:ot,datesCount:We.length}},[Ye,Ht.byDay]),nt=g.useMemo(()=>[{label:"Rivas",value:Rr(xt.RIVAS.sales)},{label:"San Jorge",value:Rr(xt.SAN_JORGE.sales)},{label:"Isla",value:Rr(xt.ISLA.sales)}].map(le=>({...le,value:zr(le.value)})),[xt]),lt=async()=>{if(_t.current){_t.current.classList.add("force-pdf-colors");try{const We=(await Fg(_t.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),it=new an;it.addImage(We,"PNG",10,10,190,0),it.save(`data_center_dulces_${s}_a_${l}.pdf`)}finally{_t.current.classList.remove("force-pdf-colors")}}},ht=()=>{const We=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...Ye.map(Rt=>[Rt.date,Rt.processedDate||"",Rt.status,Rt.type,Rt.vendorId,`"${String(Rt.vendorName||"").replace(/"/g,'""')}"`,Rt.branch||"",`"${String(Rt.productName||"").replace(/"/g,'""')}"`,si(Rt.packages),Qr(Rt.amount),Qr(Rt.commission),Rt.customerId||"",`"${String(we(Rt)||"").replace(/"/g,'""')}"`].join(","))],it=new Blob([We.join(`
`)],{type:"text/csv;charset=utf-8;"}),ot=URL.createObjectURL(it),Nt=document.createElement("a");Nt.href=ot,Nt.download=`data_center_dulces_${s}_a_${l}.csv`,Nt.click(),URL.revokeObjectURL(ot)};return n?i.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-0",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[i.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-end",children:[i.jsx("button",{onClick:lt,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-green-600 text-white hover:bg-green-700 transition-colors\r
              `,children:"Exportar PDF"}),i.jsx("button",{onClick:ht,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-gray-800 text-white hover:bg-black transition-colors\r
              `,children:"Exportar CSV"})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>$e(le=>!le),"aria-expanded":Ft,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${Ft?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Ft?"block":"hidden"} border-t p-3 sm:p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:s,onChange:le=>o(le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:l,onChange:le=>c(le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:u,onChange:le=>d(le.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Tipo"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:f,onChange:le=>A(le.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:h,onChange:le=>m(le.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),ue.map(le=>i.jsx("option",{value:le.id,children:le.name||le.id},le.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Sucursal"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:p,onChange:le=>x(le.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:v,onChange:le=>y(le.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:b,onChange:le=>w(le.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto min"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:j,onChange:le=>I(le.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto max"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:_,onChange:le=>S(le.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:E,onChange:le=>{De(""),B(le.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})})]}),i.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{He(""),Qt("MACRO")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",jt==="MACRO"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Macro"}),i.jsx("button",{onClick:()=>{He(""),Qt("DETALLE")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",jt==="DETALLE"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Detalle"})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Gastos del perodo (expenses_candies):"," ",i.jsxs("strong",{children:["C$",Qr(Ht.total)]})]})]}),i.jsxs("div",{ref:_t,children:[jt==="MACRO"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ze(le=>!le),"aria-expanded":Fe,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${Fe?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Fe?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ingreso (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(ze.ingreso)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin vendedor (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Qr(ze.comision)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(xe.commCash),"  Crdito: C$",Qr(xe.commCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos (expenses_candies)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Qr(ze.gastos)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se calcula automtico por fechas"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia neta (real)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(ze.gananciaNeta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ingreso  Comisin  Gastos"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Promedio neto por da"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(ze.netaDia)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Das con ventas: ",i.jsx("strong",{children:ze.daysCount})]})]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[i.jsx(_K,{title:"Ventas por da (Ingreso)",series:Ie.seriesIngreso,valuePrefix:"C$"}),i.jsx(_K,{title:"Ganancia neta por da (real)",series:Ie.seriesNeta,valuePrefix:"C$"})]}),i.jsx("div",{className:"mb-6",children:i.jsx(gVe,{title:"Distribucin de ventas por sucursal",items:nt})})]}),jt==="DETALLE"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ze(le=>!le),"aria-expanded":Fe,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${Fe?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${Fe?"block":"hidden"} border-t p-3`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(xe.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(xe.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(xe.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(xe.salesCash),"  Crdito: C$",Qr(xe.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(xe.commTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(xe.commCash),"  Crdito: C$",Qr(xe.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Aprox. (rdenes maestras)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Se.grossIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Qr(Se.expectedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Qr(xt.ISLA.sales)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Qr(Pt.ISLA)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado (precio proveedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Le)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes maestras (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad neta (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Qe.net)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"U bruta  Gastos  U vendedor"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(Ut.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:si(Ut.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:si(_e.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(Ut.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:si(Ut.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:si(_e.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ut.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos dispersados (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ae.dispersedTotal)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes de vendedores (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Dispersado Isla (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ae.dispersedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Usado para Total existente"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total existente en productos (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ae.totalExistenteIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esperado Isla  Dispersado Isla"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"CxC (ventas crdito)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(fe.cxc)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(xe.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Recaudacin (abonos)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(fe.recaudado)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"abonos en ar_movements"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta crdito (ventas  comisin)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(fe.utilidadBruta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Paquetes vendidos al crdito"})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>ee(le=>!le),"aria-expanded":Te,children:[i.jsx("span",{children:"rdenes vendedores"}),i.jsx("span",{className:`transition-transform ${Te?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${Te?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-4 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Global)"}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Basado en ",i.jsx("strong",{children:"precio de venta"})," (por sucursal del vendedor)"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.totalEsperado)]})]})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Detalle por orden)"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Click/Tap en una orden para ver productos asociados/vendidos/restantes"})]}),Ce.orders.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:Ce.orders.map(le=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:le.orderId}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1 truncate",children:[le.sellerName," ",le.branch?` ${le.branch}`:""," ",le.date?` ${le.date}`:""]})]}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>He(le.orderKey),children:"Ver"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.totalOrden)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendido"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.vendido)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restante"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.restante)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.comision)]})]})]})]},le.orderKey))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total orden"}),i.jsx("th",{className:"border p-2",children:"Vendido"}),i.jsx("th",{className:"border p-2",children:"Restante"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Total esperado"}),i.jsx("th",{className:"border p-2",children:"Accin"})]})}),i.jsx("tbody",{children:Ce.orders.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:le.sellerName}),i.jsx("td",{className:"border p-2",children:le.branch||""}),i.jsx("td",{className:"border p-2",children:le.date||""}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.totalOrden)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.vendido)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.restante)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.comision)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.totalEsperado)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>He(le.orderKey),children:"Ver detalle"})})]},le.orderKey))})]})}),te&&i.jsxs("div",{className:"mt-4 rounded-2xl border-2 border-gray-100 p-3 sm:p-4 shadow-lg bg-white",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h4",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle orden vendedor "," ",te.orderId]}),i.jsx("button",{onClick:()=>He(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Qr(te.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Qr(te.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Qr(te.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Qr(te.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Qr(te.totalEsperado)]})]})]}),i.jsx("h5",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Productos asociados (Nombre - Asociados - Vendidos - Restantes)"}),i.jsx("div",{className:"md:hidden space-y-2",children:te.products.map(le=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:le.productName}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Asociados"}),i.jsx("div",{className:"font-bold",children:le.asociados})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendidos"}),i.jsx("div",{className:"font-bold",children:le.vendidos})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-bold",children:le.restantes})]})]})]},le.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Nombre producto"}),i.jsx("th",{className:"border p-2",children:"Asociados"}),i.jsx("th",{className:"border p-2",children:"Vendidos"}),i.jsx("th",{className:"border p-2",children:"Restantes"})]})}),i.jsxs("tbody",{children:[te.products.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:le.productName}),i.jsx("td",{className:"border p-2",children:le.asociados}),i.jsx("td",{className:"border p-2",children:le.vendidos}),i.jsx("td",{className:"border p-2",children:le.restantes})]},le.productName)),te.products.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-500",children:"Sin productos."})})]})]})})]})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Re(le=>!le),"aria-expanded":me,children:[i.jsx("span",{children:"Existencias"}),i.jsx("span",{className:`transition-transform ${me?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${me?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(_e.masterRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (vendedores)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(_e.vendorRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>qe(le=>!le),"aria-expanded":he,children:[i.jsx("span",{children:"Vendedores"}),i.jsx("span",{className:`transition-transform ${he?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${he?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),It.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:It.cashArr.map(le=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:le.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Qr(le.total)]})]},le.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),It.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:It.creditArr.map(le=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:le.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Qr(le.total)]})]},le.vendorId))})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-6",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>yt(le=>!le),"aria-expanded":st,children:[i.jsx("span",{children:"Saldos pendientes"}),i.jsx("span",{className:`transition-transform ${st?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${st?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:["Saldos pendientes (hasta ",l,")"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:se.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Qr(se.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),se.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:se.list.map(le=>i.jsxs("div",{className:"border rounded-xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:le.name}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Qr(le.balance)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["ltimo abono:"," ",i.jsxs("b",{children:["C$",Qr(le.lastPaymentAmount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha ult. abono:"," ",i.jsx("span",{className:"font-medium",children:le.lastPayment||""})]}),i.jsx("div",{className:"mt-2",children:i.jsx("button",{type:"button",onClick:()=>dt(le),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},le.customerId))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:se.list.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:le.name}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.balance)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.lastPaymentAmount)]}),i.jsx("td",{className:"border p-2",children:le.lastPayment||""}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{type:"button",onClick:()=>dt(le),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},le.customerId))})]})})]})]})]}),i.jsxs("div",{className:"mb-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold text-sm sm:text-base",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 sm:ml-auto",children:"Tap/Click en Ver detalle para drill-down"})]}),k?i.jsx("p",{className:"text-sm",children:"Cargando..."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2 mb-6",children:R.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."}):R.map(le=>i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:le.label}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>De(le.key),children:"Ver detalle"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"font-bold",children:si(le.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"font-bold",children:si(le.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.commCredit)]})]})]})]},le.key))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-6 shadow-2xl rounded-xl border",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[R.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:le.label}),i.jsx("td",{className:"border p-2",children:si(le.packsCash)}),i.jsx("td",{className:"border p-2",children:si(le.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.commCredit)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>De(le.key),children:"Ver detalle"})})]},le.key)),R.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]})})]}),J&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-3 sm:p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h2",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle "," ",((kt=R.find(le=>le.key===J))==null?void 0:kt.label)||J]}),i.jsx("button",{onClick:()=>De(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Qr(Q.filter(le=>le.type==="CONTADO").reduce((le,We)=>le+Rr(We.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Qr(Q.filter(le=>le.type==="CREDITO").reduce((le,We)=>le+Rr(We.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes cash:"," ",i.jsx("strong",{children:si(Q.filter(le=>le.type==="CONTADO").reduce((le,We)=>le+Rr(We.packages),0))})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes crdito:"," ",i.jsx("strong",{children:si(Q.filter(le=>le.type==="CREDITO").reduce((le,We)=>le+Rr(We.packages),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Ventas incluidas"}),i.jsx("div",{className:"md:hidden space-y-2 mb-4",children:Q.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin detalle."}):Q.map(le=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:le.productName}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Qr(le.amount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:le.vendorName})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Tipo"}),i.jsx("div",{className:"font-bold",children:le.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Sucursal"}),i.jsx("div",{className:"font-bold",children:le.branch||""})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-bold",children:si(le.packages)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.commission)]})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Fecha: ",le.date]})]},le.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[Q.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2",children:le.vendorName}),i.jsx("td",{className:"border p-2",children:le.productName}),i.jsx("td",{className:"border p-2",children:le.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-2",children:le.branch||""}),i.jsx("td",{className:"border p-2",children:si(le.packages)}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.amount)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.commission)]}),i.jsx("td",{className:"border p-2",children:le.date})]},le.id)),Q.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin detalle."})})]})]})}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Consolidado por producto"}),i.jsx("div",{className:"md:hidden space-y-2",children:G.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin consolidado."}):G.map(le=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:le.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq cash"}),i.jsx("div",{className:"font-bold",children:si(le.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq crdito"}),i.jsx("div",{className:"font-bold",children:si(le.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(le.commCredit)]})]})]})]},le.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[G.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:le.productName}),i.jsx("td",{className:"border p-2",children:si(le.packsCash)}),i.jsx("td",{className:"border p-2",children:si(le.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(le.commCredit)]})]},le.productName)),G.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Sin consolidado."})})]})]})})]})]})]}),O&&i.jsx("p",{className:"mt-3 text-sm",children:O})]}),Ge&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:Ge.name}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Saldo pendiente: ",i.jsxs("b",{children:["C$",Qr(Ge.balance)]})]})]}),i.jsx("button",{type:"button",onClick:()=>dt(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Saldo"})]})}),i.jsx("tbody",{children:Ne.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin movimientos."})}):Ne.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:le.date||""}),i.jsx("td",{className:"border p-1",children:le.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(le.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(le.running)]})]},le.id))})]})}),i.jsx("div",{className:"mt-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:Me.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"border p-2 text-center text-gray-500",children:"Sin ventas asociadas."})}):Me.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:le.date||""}),i.jsx("td",{className:"border p-1",children:le.productName||""}),i.jsx("td",{className:"border p-1",children:le.vendorName||""}),i.jsx("td",{className:"border p-1",children:le.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(le.amount)]})]},le.id))})]})})]})})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 md:p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function Use(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=Use(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function as(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=Use(t))&&(n&&(n+=" "),n+=e);return n}var yVe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function VR(t){if(typeof t!="string")return!1;var e=yVe;return e.includes(t)}var bVe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],wVe=new Set(bVe);function Qse(t){return typeof t!="string"?!1:wVe.has(t)}function Vse(t){return typeof t=="string"&&t.startsWith("data-")}function ch(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Qse(r)||Vse(r))&&(e[r]=t[r]);return e}function z2(t){if(t==null)return null;if(g.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return ch(e)}return typeof t=="object"&&!Array.isArray(t)?ch(t):null}function Dd(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Qse(r)||Vse(r)||VR(r))&&(e[r]=t[r]);return e}var NVe=["children","width","height","viewBox","className","style","title","desc"];function wF(){return wF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wF.apply(null,arguments)}function CVe(t,e){if(t==null)return{};var r,n,a=_Ve(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function _Ve(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var HR=g.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:u}=t,d=CVe(t,NVe),f=s||{width:n,height:a,x:0,y:0},A=as("recharts-surface",o);return g.createElement("svg",wF({},Dd(d),{className:A,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),g.createElement("title",null,c),g.createElement("desc",null,u),r)}),EVe=["children","className"];function NF(){return NF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NF.apply(null,arguments)}function SVe(t,e){if(t==null)return{};var r,n,a=IVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function IVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Bc=g.forwardRef((t,e)=>{var{children:r,className:n}=t,a=SVe(t,EVe),s=as("recharts-layer",n);return g.createElement("g",NF({className:s},Dd(a),{ref:e}),r)}),Hse=g.createContext(null),jVe=()=>g.useContext(Hse);function vs(t){return function(){return t}}const $se=Math.cos,oI=Math.sin,Pf=Math.sqrt,lI=Math.PI,bP=2*lI,CF=Math.PI,_F=2*CF,dp=1e-6,PVe=_F-dp;function Kse(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function BVe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Kse;const r=10**e;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class TVe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Kse:BVe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,s,o){this._append`C${+e},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(e,r,n,a,s){if(e=+e,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-e,u=a-r,d=o-e,f=l-r,A=d*d+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(A>dp)if(!(Math.abs(f*c-u*d)>dp)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let h=n-o,m=a-l,p=c*c+u*u,x=h*h+m*m,v=Math.sqrt(p),y=Math.sqrt(A),b=s*Math.tan((CF-Math.acos((p+A-x)/(2*v*y)))/2),w=b/y,j=b/v;Math.abs(w-1)>dp&&this._append`L${e+w*d},${r+w*f}`,this._append`A${s},${s},0,0,${+(f*h>d*m)},${this._x1=e+j*c},${this._y1=r+j*u}`}}arc(e,r,n,a,s,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=e+l,d=r+c,f=1^o,A=o?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>dp||Math.abs(this._y1-d)>dp)&&this._append`L${u},${d}`,n&&(A<0&&(A=A%_F+_F),A>PVe?this._append`A${n},${n},0,1,${f},${e-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:A>dp&&this._append`A${n},${n},0,${+(A>=CF)},${f},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function $R(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new TVe(e)}function KR(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Gse(t){this._context=t}Gse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function wP(t){return new Gse(t)}function qse(t){return t[0]}function zse(t){return t[1]}function Wse(t,e){var r=vs(!0),n=null,a=wP,s=null,o=$R(l);t=typeof t=="function"?t:t===void 0?qse:vs(t),e=typeof e=="function"?e:e===void 0?zse:vs(e);function l(c){var u,d=(c=KR(c)).length,f,A=!1,h;for(n==null&&(s=a(h=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===A&&((A=!A)?s.lineStart():s.lineEnd()),A&&s.point(+t(f,u,c),+e(f,u,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:vs(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:vs(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:vs(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function m_(t,e,r){var n=null,a=vs(!0),s=null,o=wP,l=null,c=$R(u);t=typeof t=="function"?t:t===void 0?qse:vs(+t),e=typeof e=="function"?e:vs(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?zse:vs(+r);function u(f){var A,h,m,p=(f=KR(f)).length,x,v=!1,y,b=new Array(p),w=new Array(p);for(s==null&&(l=o(y=c())),A=0;A<=p;++A){if(!(A<p&&a(x=f[A],A,f))===v)if(v=!v)h=A,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=A-1;m>=h;--m)l.point(b[m],w[m]);l.lineEnd(),l.areaEnd()}v&&(b[A]=+t(x,A,f),w[A]=+e(x,A,f),l.point(n?+n(x,A,f):b[A],r?+r(x,A,f):w[A]))}if(y)return l=null,y+""||null}function d(){return Wse().defined(a).curve(o).context(s)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:vs(+f),n=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:vs(+f),u):t},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:vs(+f),u):n},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:vs(+f),r=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:vs(+f),u):e},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:vs(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(t).y(e)},u.lineY1=function(){return d().x(t).y(r)},u.lineX1=function(){return d().x(n).y(e)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:vs(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class Xse{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function kVe(t){return new Xse(t,!0)}function FVe(t){return new Xse(t,!1)}const GR={draw(t,e){const r=Pf(e/lI);t.moveTo(r,0),t.arc(0,0,r,0,bP)}},OVe={draw(t,e){const r=Pf(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},Yse=Pf(1/3),DVe=Yse*2,RVe={draw(t,e){const r=Pf(e/DVe),n=r*Yse;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},MVe={draw(t,e){const r=Pf(e),n=-r/2;t.rect(n,n,r,r)}},LVe=.8908130915292852,Jse=oI(lI/10)/oI(7*lI/10),UVe=oI(bP/10)*Jse,QVe=-$se(bP/10)*Jse,VVe={draw(t,e){const r=Pf(e*LVe),n=UVe*r,a=QVe*r;t.moveTo(0,-r),t.lineTo(n,a);for(let s=1;s<5;++s){const o=bP*s/5,l=$se(o),c=oI(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*a,c*n+l*a)}t.closePath()}},uB=Pf(3),HVe={draw(t,e){const r=-Pf(e/(uB*3));t.moveTo(0,r*2),t.lineTo(-uB*r,-r),t.lineTo(uB*r,-r),t.closePath()}},id=-.5,od=Pf(3)/2,EF=1/Pf(12),$Ve=(EF/2+1)*3,KVe={draw(t,e){const r=Pf(e/$Ve),n=r/2,a=r*EF,s=n,o=r*EF+r,l=-s,c=o;t.moveTo(n,a),t.lineTo(s,o),t.lineTo(l,c),t.lineTo(id*n-od*a,od*n+id*a),t.lineTo(id*s-od*o,od*s+id*o),t.lineTo(id*l-od*c,od*l+id*c),t.lineTo(id*n+od*a,id*a-od*n),t.lineTo(id*s+od*o,id*o-od*s),t.lineTo(id*l+od*c,id*c-od*l),t.closePath()}};function GVe(t,e){let r=null,n=$R(a);t=typeof t=="function"?t:vs(t||GR),e=typeof e=="function"?e:vs(e===void 0?64:+e);function a(){let s;if(r||(r=s=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:vs(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:vs(+s),a):e},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function cI(){}function uI(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function Zse(t){this._context=t}Zse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:uI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:uI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function qVe(t){return new Zse(t)}function eie(t){this._context=t}eie.prototype={areaStart:cI,areaEnd:cI,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:uI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function zVe(t){return new eie(t)}function tie(t){this._context=t}tie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:uI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function WVe(t){return new tie(t)}function rie(t){this._context=t}rie.prototype={areaStart:cI,areaEnd:cI,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function XVe(t){return new rie(t)}function EK(t){return t<0?-1:1}function SK(t,e,r){var n=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(n||a<0&&-0),o=(r-t._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(EK(s)+EK(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function IK(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function dB(t,e,r){var n=t._x0,a=t._y0,s=t._x1,o=t._y1,l=(s-n)/3;t._context.bezierCurveTo(n+l,a+l*e,s-l,o-l*r,s,o)}function dI(t){this._context=t}dI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:dB(this,this._t0,IK(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,dB(this,IK(this,r=SK(this,t,e)),r);break;default:dB(this,this._t0,r=SK(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function nie(t){this._context=new aie(t)}(nie.prototype=Object.create(dI.prototype)).point=function(t,e){dI.prototype.point.call(this,e,t)};function aie(t){this._context=t}aie.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,s){this._context.bezierCurveTo(e,t,n,r,s,a)}};function YVe(t){return new dI(t)}function JVe(t){return new nie(t)}function sie(t){this._context=t}sie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=jK(t),a=jK(e),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function jK(t){var e,r=t.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function ZVe(t){return new sie(t)}function NP(t,e){this._context=t,this._t=e}NP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function eHe(t){return new NP(t,.5)}function tHe(t){return new NP(t,0)}function rHe(t){return new NP(t,1)}function xg(t,e){if((o=t.length)>1)for(var r=1,n,a,s=t[e[0]],o,l=s.length;r<o;++r)for(a=s,s=t[e[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function SF(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function nHe(t,e){return t[e]}function aHe(t){const e=[];return e.key=t,e}function sHe(){var t=vs([]),e=SF,r=xg,n=nHe;function a(s){var o=Array.from(t.apply(this,arguments),aHe),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=KR(e(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:vs(Array.from(s)),a):t},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:vs(+s),a):n},a.order=function(s){return arguments.length?(e=s==null?SF:typeof s=="function"?s:vs(Array.from(s)),a):e},a.offset=function(s){return arguments.length?(r=s??xg,a):r},a}function iHe(t,e){if((n=t.length)>0){for(var r,n,a=0,s=t[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<n;++r)t[r][a][1]/=o}xg(t,e)}}function oHe(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}xg(t,e)}}function lHe(t,e){if(!(!((o=t.length)>0)||!((s=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=t[e[l]],f=d[n][1]||0,A=d[n-1][1]||0,h=(f-A)/2,m=0;m<l;++m){var p=t[e[m]],x=p[n][1]||0,v=p[n-1][1]||0;h+=x-v}c+=f,u+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,xg(t,e)}}var CP={},iie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(iie);var qR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(qR);var _P={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}t.toKey=e})(_P);var EP={},oie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(oie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oie,r=_P;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=e.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];u?f==="\\"&&l+1<o?(l++,c+=a[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}t.toPath=n})(EP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iie,r=qR,n=_P,a=EP;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||e.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}t.get=s})(CP);var cHe=CP.get;const vg=jA(cHe);var uHe=4;function Y0(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uHe,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function Ci(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((a,s,o)=>{var l=r[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+Y0(l)+s:a+s},"")}var Pl=t=>t===0?0:t>0?1:-1,uh=t=>typeof t=="number"&&t!=+t,wA=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,_n=t=>(typeof t=="number"||t instanceof Number)&&!uh(t),dh=t=>_n(t)||typeof t=="string",dHe=0,W2=t=>{var e=++dHe;return"".concat(t||"").concat(e)},ic=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!_n(e)&&typeof e!="string")return n;var s;if(wA(e)){if(r==null)return n;var o=e.indexOf("%");s=r*parseFloat(e.slice(0,o))/100}else s=+e;return uh(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},lie=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function Eo(t,e,r){return _n(t)&&_n(e)?Y0(t+r*(e-t)):e}function fHe(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):vg(n,e))===r)}var sl=t=>t===null||typeof t>"u",qw=t=>sl(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function hHe(t){return t!=null}function zw(){}var AHe=["type","size","sizeType"];function IF(){return IF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IF.apply(null,arguments)}function PK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function BK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PK(Object(r),!0).forEach(function(n){mHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mHe(t,e,r){return(e=pHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pHe(t){var e=gHe(t,"string");return typeof e=="symbol"?e:e+""}function gHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xHe(t,e){if(t==null)return{};var r,n,a=vHe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vHe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var cie={symbolCircle:GR,symbolCross:OVe,symbolDiamond:RVe,symbolSquare:MVe,symbolStar:VVe,symbolTriangle:HVe,symbolWye:KVe},yHe=Math.PI/180,bHe=t=>{var e="symbol".concat(qw(t));return cie[e]||GR},wHe=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*yHe;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},NHe=(t,e)=>{cie["symbol".concat(qw(t))]=e},zR=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=xHe(t,AHe),s=BK(BK({},a),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var A=bHe(o),h=GVe().type(A).size(wHe(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=Dd(s);return _n(u)&&_n(d)&&_n(r)?g.createElement("path",IF({},f,{className:as("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};zR.registerSymbol=NHe;var uie=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,CHe=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(g.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{VR(a)&&(n[a]=s=>r[a](r,s))}),n},_He=(t,e,r)=>n=>(t(e,r,n),null),Ww=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var s=t[a];VR(a)&&typeof s=="function"&&(n||(n={}),n[a]=_He(s,e,r))}),n};function TK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function EHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?TK(Object(r),!0).forEach(function(n){SHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SHe(t,e,r){return(e=IHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IHe(t){var e=jHe(t,"string");return typeof e=="symbol"?e:e+""}function jHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kl(t,e){var r=EHe({},t),n=e,a=Object.keys(e),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function fI(){return fI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fI.apply(null,arguments)}function kK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function PHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kK(Object(r),!0).forEach(function(n){BHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BHe(t,e,r){return(e=THe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function THe(t){var e=kHe(t,"string");return typeof e=="symbol"?e:e+""}function kHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ad=32,FHe={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function OHe(t){var{data:e,iconType:r,inactiveColor:n}=t,a=Ad/2,s=Ad/6,o=Ad/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return g.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:Ad,y2:a,className:"recharts-legend-icon"})}if(c==="line")return g.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Ad,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return g.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Ad/8,"h").concat(Ad,"v").concat(Ad*3/4,"h").concat(-Ad,"z"),className:"recharts-legend-icon"});if(g.isValidElement(e.legendIcon)){var d=PHe({},e);return delete d.legendIcon,g.cloneElement(e.legendIcon,d)}return g.createElement(zR,{fill:l,cx:a,cy:a,size:Ad,sizeType:"diameter",type:c})}function DHe(t){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=t,l={x:0,y:0,width:Ad,height:Ad},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((d,f)=>{var A=d.formatter||a,h=as({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,p=A?A(d.value,d,f):d.value;return g.createElement("li",fI({className:h,style:c,key:"legend-item-".concat(f)},Ww(t,d,f)),g.createElement(HR,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(p," legend icon")},g.createElement(OHe,{data:d,iconType:o,inactiveColor:s})),g.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},p))})}var RHe=t=>{var e=kl(t,FHe),{payload:r,layout:n,align:a}=e;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return g.createElement("ul",{className:"recharts-default-legend",style:s},g.createElement(DHe,fI({},e,{payload:r})))},die={},fie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}t.uniqBy=e})(fie);var WR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(WR);var hie={},SP={},Aie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(Aie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Aie;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(SP);var mie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(mie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=SP,r=mie;function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(hie);var pie={},gie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=CP;function r(n){return function(a){return e.get(a,n)}}t.property=r})(gie);var xie={},XR={},vie={},YR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(YR);var JR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(JR);var ZR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(ZR);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=YR,r=JR,n=ZR;function a(d,f,A){return typeof A!="function"?a(d,f,()=>{}):s(d,f,function h(m,p,x,v,y,b){const w=A(m,p,x,v,y,b);return w!==void 0?!!w:s(m,p,h,b)},new Map)}function s(d,f,A,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,A,h);case"function":return Object.keys(f).length>0?s(d,{...f},A,h):n.eq(d,f);default:return e.isObject(d)?typeof f=="string"?f==="":!0:n.eq(d,f)}}function o(d,f,A,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,A,h);if(f instanceof Map)return l(d,f,A,h);if(f instanceof Set)return u(d,f,A,h);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let p=0;p<m.length;p++){const x=m[p];if(!r.isPrimitive(d)&&!(x in d)||f[x]===void 0&&d[x]!==void 0||f[x]===null&&d[x]!==null||!A(d[x],f[x],x,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(d,f,A,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,p]of f.entries()){const x=d.get(m);if(A(x,p,m,d,f,h)===!1)return!1}return!0}function c(d,f,A,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let p=0;p<f.length;p++){const x=f[p];let v=!1;for(let y=0;y<d.length;y++){if(m.has(y))continue;const b=d[y];let w=!1;if(A(b,x,p,d,f,h)&&(w=!0),w){m.add(y),v=!0;break}}if(!v)return!1}return!0}function u(d,f,A,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],A,h):!1}t.isMatchWith=a,t.isSetMatch=u})(vie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=vie;function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(XR);var yie={},eM={},bie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(bie);var tM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(tM);var rM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",A="[object ArrayBuffer]",h="[object Object]",m="[object Error]",p="[object DataView]",x="[object Uint8Array]",v="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",j="[object Int8Array]",I="[object Int16Array]",_="[object Int32Array]",S="[object BigInt64Array]",E="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=s,t.arrayBufferTag=A,t.arrayTag=d,t.bigInt64ArrayTag=S,t.bigUint64ArrayTag=w,t.booleanTag=a,t.dataViewTag=p,t.dateTag=l,t.errorTag=m,t.float32ArrayTag=E,t.float64ArrayTag=B,t.functionTag=f,t.int16ArrayTag=I,t.int32ArrayTag=_,t.int8ArrayTag=j,t.mapTag=c,t.numberTag=n,t.objectTag=h,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=y,t.uint32ArrayTag=b,t.uint8ArrayTag=x,t.uint8ClampedArrayTag=v})(rM);var wie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(wie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=bie,r=tM,n=rM,a=JR,s=wie;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,A,h=new Map,m=void 0){const p=m==null?void 0:m(d,f,A,h);if(p!==void 0)return p;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const x=new Array(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return Object.hasOwn(d,"index")&&(x.index=d.index),Object.hasOwn(d,"input")&&(x.input=d.input),x}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const x=new RegExp(d.source,d.flags);return x.lastIndex=d.lastIndex,x}if(d instanceof Map){const x=new Map;h.set(d,x);for(const[v,y]of d)x.set(v,l(y,v,A,h,m));return x}if(d instanceof Set){const x=new Set;h.set(d,x);for(const v of d)x.add(l(v,void 0,A,h,m));return x}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const x=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return x}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const x=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,x),c(x,d,A,h,m),x}if(typeof File<"u"&&d instanceof File){const x=new File([d],d.name,{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(typeof Blob<"u"&&d instanceof Blob){const x=new Blob([d],{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Error){const x=new d.constructor;return h.set(d,x),x.message=d.message,x.name=d.name,x.stack=d.stack,x.cause=d.cause,c(x,d,A,h,m),x}if(d instanceof Boolean){const x=new Boolean(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Number){const x=new Number(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof String){const x=new String(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(typeof d=="object"&&u(d)){const x=Object.create(Object.getPrototypeOf(d));return h.set(d,x),c(x,d,A,h,m),x}return d}function c(d,f,A=d,h,m){const p=[...Object.keys(f),...e.getSymbols(f)];for(let x=0;x<p.length;x++){const v=p[x],y=Object.getOwnPropertyDescriptor(d,v);(y==null||y.writable)&&(d[v]=l(f[v],v,A,h,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(eM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eM;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(yie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=XR,r=yie;function n(a){return a=r.cloneDeep(a),s=>e.isMatch(s,a)}t.matches=n})(xie);var Nie={},Cie={},_ie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eM,r=rM;function n(a,s){return e.cloneDeepWith(a,(o,l,c,u)=>{const d=s==null?void 0:s(o,l,c,u);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return e.copyProperties(f,a),f}case r.argumentsTag:{const f={};return e.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}t.cloneDeepWith=n})(_ie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_ie;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(Cie);var Eie={},nM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(nM);var Sie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=tM;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(Sie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qR,r=nM,n=Sie,a=EP;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=s})(Eie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=XR,r=_P,n=Cie,a=CP,s=Eie;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:e.isMatch(d,c)}}t.matchesProperty=o})(Nie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=WR,r=gie,n=xie,a=Nie;function s(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=s})(pie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=fie,r=WR,n=hie,a=pie;function s(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),a.iteratee(l)):[]}t.uniqBy=s})(die);var MHe=die.uniqBy;const FK=jA(MHe);function Iie(t,e,r){return e===!0?FK(t,r):typeof e=="function"?FK(t,e):t}var jie={exports:{}},Pie={},Bie={exports:{}},Tie={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v=g;function LHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var UHe=typeof Object.is=="function"?Object.is:LHe,QHe=$v.useState,VHe=$v.useEffect,HHe=$v.useLayoutEffect,$He=$v.useDebugValue;function KHe(t,e){var r=e(),n=QHe({inst:{value:r,getSnapshot:e}}),a=n[0].inst,s=n[1];return HHe(function(){a.value=r,a.getSnapshot=e,fB(a)&&s({inst:a})},[t,r,e]),VHe(function(){return fB(a)&&s({inst:a}),t(function(){fB(a)&&s({inst:a})})},[t]),$He(r),r}function fB(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!UHe(t,r)}catch{return!0}}function GHe(t,e){return e()}var qHe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?GHe:KHe;Tie.useSyncExternalStore=$v.useSyncExternalStore!==void 0?$v.useSyncExternalStore:qHe;Bie.exports=Tie;var zHe=Bie.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IP=g,WHe=zHe;function XHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var YHe=typeof Object.is=="function"?Object.is:XHe,JHe=WHe.useSyncExternalStore,ZHe=IP.useRef,e$e=IP.useEffect,t$e=IP.useMemo,r$e=IP.useDebugValue;Pie.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=ZHe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=t$e(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,YHe(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=JHe(t,s[0],s[1]);return e$e(function(){o.hasValue=!0,o.value=l},[l]),r$e(l),l};jie.exports=Pie;var n$e=jie.exports,aM=g.createContext(null),a$e=t=>t,Cs=()=>{var t=g.useContext(aM);return t?t.store.dispatch:a$e},wE=()=>{},s$e=()=>wE,i$e=(t,e)=>t===e;function vn(t){var e=g.useContext(aM);return n$e.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:s$e,e?e.store.getState:wE,e?e.store.getState:wE,e?t:wE,i$e)}function o$e(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function l$e(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function c$e(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var OK=t=>Array.isArray(t)?t:[t];function u$e(t){const e=Array.isArray(t[0])?t[0]:t;return c$e(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function d$e(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var f$e=class{constructor(t){this.value=t}deref(){return this.value}},h$e=typeof WeakRef<"u"?WeakRef:f$e,A$e=0,DK=1;function p_(){return{s:A$e,v:void 0,o:null,p:null}}function kie(t,e={}){let r=p_();const{resultEqualityCheck:n}=e;let a,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let A=0,h=c;A<h;A++){const m=arguments[A];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(m);x===void 0?(l=p_(),p.set(m,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(m);x===void 0?(l=p_(),p.set(m,l)):l=x}}const u=l;let d;if(l.s===DK)d=l.v;else if(d=t.apply(null,arguments),s++,n){const A=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;A!=null&&n(A,d)&&(d=A,s!==0&&s--),a=typeof d=="object"&&d!==null||typeof d=="function"?new h$e(d):d}return u.s=DK,u.v=d,d}return o.clearCache=()=>{r=p_(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function m$e(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let s=0,o=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),o$e(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:A=[],argsMemoize:h=kie,argsMemoizeOptions:m=[]}=d,p=OK(A),x=OK(m),v=u$e(a),y=f(function(){return s++,u.apply(null,arguments)},...p),b=h(function(){o++;const j=d$e(v,arguments);return l=y.apply(null,j),l},...x);return Object.assign(b,{resultFunc:u,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var tr=m$e(kie),p$e=Object.assign((t,e=tr)=>{l$e(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>p$e}),Fie={},Oie={},Die={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=e(n),l=e(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};t.compareValues=r})(Die);var Rie={},sM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(sM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sM,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||e.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}t.isKey=a})(Rie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Die,r=Rie,n=EP;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,m)=>{let p=h;for(let x=0;x<m.length&&p!=null;++x)p=p[m[x]];return p},d=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>d(m,h))})).slice().sort((h,m)=>{for(let p=0;p<f.length;p++){const x=e.compareValues(h.criteria[p],m.criteria[p],l[p]);if(x!==0)return x}return 0}).map(h=>h.original)}t.orderBy=a})(Oie);var Mie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):a.push(d)}};return o(r,0),a}t.flatten=e})(Mie);var iM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=nM,r=SP,n=YR,a=ZR;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}t.isIterateeCall=s})(iM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Oie,r=Mie,n=iM;function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(s,r.flatten(o),["asc"])}t.sortBy=a})(Fie);var g$e=Fie.sortBy;const jP=jA(g$e);var Lie=t=>t.legend.settings,x$e=t=>t.legend.size,v$e=t=>t.legend.payload,y$e=tr([v$e,Lie],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?jP(n,r):n});function b$e(){return vn(y$e)}var g_=1;function Uie(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=g.useState({height:0,left:0,top:0,width:0}),n=g.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-e.height)>g_||Math.abs(o.left-e.left)>g_||Math.abs(o.top-e.top)>g_||Math.abs(o.width-e.width)>g_)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function vl(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var w$e=typeof Symbol=="function"&&Symbol.observable||"@@observable",RK=w$e,hB=()=>Math.random().toString(36).substring(7).split("").join("."),N$e={INIT:`@@redux/INIT${hB()}`,REPLACE:`@@redux/REPLACE${hB()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${hB()}`},hI=N$e;function oM(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Qie(t,e,r){if(typeof t!="function")throw new Error(vl(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(vl(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(vl(1));return r(Qie)(t,e)}let n=t,a=e,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((x,v)=>{o.set(v,x)}))}function d(){if(c)throw new Error(vl(3));return a}function f(x){if(typeof x!="function")throw new Error(vl(4));if(c)throw new Error(vl(5));let v=!0;u();const y=l++;return o.set(y,x),function(){if(v){if(c)throw new Error(vl(6));v=!1,u(),o.delete(y),s=null}}}function A(x){if(!oM(x))throw new Error(vl(7));if(typeof x.type>"u")throw new Error(vl(8));if(typeof x.type!="string")throw new Error(vl(17));if(c)throw new Error(vl(9));try{c=!0,a=n(a,x)}finally{c=!1}return(s=o).forEach(y=>{y()}),x}function h(x){if(typeof x!="function")throw new Error(vl(10));n=x,A({type:hI.REPLACE})}function m(){const x=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(vl(11));function y(){const w=v;w.next&&w.next(d())}return y(),{unsubscribe:x(y)}},[RK](){return this}}}return A({type:hI.INIT}),{dispatch:A,subscribe:f,getState:d,replaceReducer:h,[RK]:m}}function C$e(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:hI.INIT})>"u")throw new Error(vl(12));if(typeof r(void 0,{type:hI.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(vl(13))})}function Vie(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let a;try{C$e(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],A=r[f],h=o[f],m=A(h,l);if(typeof m>"u")throw l&&l.type,new Error(vl(14));u[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?u:o}}function AI(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function _$e(...t){return e=>(r,n)=>{const a=e(r,n);let s=()=>{throw new Error(vl(15))};const o={getState:a.getState,dispatch:(c,...u)=>s(c,...u)},l=t.map(c=>c(o));return s=AI(...l)(a.dispatch),{...a,dispatch:s}}}function Hie(t){return oM(t)&&"type"in t&&typeof t.type=="string"}var $ie=Symbol.for("immer-nothing"),MK=Symbol.for("immer-draftable"),Tc=Symbol.for("immer-state");function cf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Du=Object,Kv=Du.getPrototypeOf,mI="constructor",PP="prototype",jF="configurable",pI="enumerable",NE="writable",X2="value",NA=t=>!!t&&!!t[Tc];function Cf(t){var e;return t?Kie(t)||TP(t)||!!t[MK]||!!((e=t[mI])!=null&&e[MK])||kP(t)||FP(t):!1}var E$e=Du[PP][mI].toString(),LK=new WeakMap;function Kie(t){if(!t||!lM(t))return!1;const e=Kv(t);if(e===null||e===Du[PP])return!0;const r=Du.hasOwnProperty.call(e,mI)&&e[mI];if(r===Object)return!0;if(!Fx(r))return!1;let n=LK.get(r);return n===void 0&&(n=Function.toString.call(r),LK.set(r,n)),n===E$e}function BP(t,e,r=!0){Xw(t)===0?(r?Reflect.ownKeys(t):Du.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function Xw(t){const e=t[Tc];return e?e.type_:TP(t)?1:kP(t)?2:FP(t)?3:0}var UK=(t,e,r=Xw(t))=>r===2?t.has(e):Du[PP].hasOwnProperty.call(t,e),PF=(t,e,r=Xw(t))=>r===2?t.get(e):t[e],gI=(t,e,r,n=Xw(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function S$e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var TP=Array.isArray,kP=t=>t instanceof Map,FP=t=>t instanceof Set,lM=t=>typeof t=="object",Fx=t=>typeof t=="function",AB=t=>typeof t=="boolean";function I$e(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Qh=t=>t.copy_||t.base_,cM=t=>t.modified_?t.copy_:t.base_;function BF(t,e){if(kP(t))return new Map(t);if(FP(t))return new Set(t);if(TP(t))return Array[PP].slice.call(t);const r=Kie(t);if(e===!0||e==="class_only"&&!r){const n=Du.getOwnPropertyDescriptors(t);delete n[Tc];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l[NE]===!1&&(l[NE]=!0,l[jF]=!0),(l.get||l.set)&&(n[o]={[jF]:!0,[NE]:!0,[pI]:l[pI],[X2]:t[o]})}return Du.create(Kv(t),n)}else{const n=Kv(t);if(n!==null&&r)return{...t};const a=Du.create(n);return Du.assign(a,t)}}function uM(t,e=!1){return OP(t)||NA(t)||!Cf(t)||(Xw(t)>1&&Du.defineProperties(t,{set:x_,add:x_,clear:x_,delete:x_}),Du.freeze(t),e&&BP(t,(r,n)=>{uM(n,!0)},!1)),t}function j$e(){cf(2)}var x_={[X2]:j$e};function OP(t){return t===null||!lM(t)?!0:Du.isFrozen(t)}var xI="MapSet",TF="Patches",QK="ArrayMethods",Gie={};function yg(t){const e=Gie[t];return e||cf(0,t),e}var VK=t=>!!Gie[t],Y2,qie=()=>Y2,P$e=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:VK(xI)?yg(xI):void 0,arrayMethodsPlugin_:VK(QK)?yg(QK):void 0});function HK(t,e){e&&(t.patchPlugin_=yg(TF),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function kF(t){FF(t),t.drafts_.forEach(B$e),t.drafts_=null}function FF(t){t===Y2&&(Y2=t.parent_)}var $K=t=>Y2=P$e(Y2,t);function B$e(t){const e=t[Tc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function KK(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[Tc].modified_&&(kF(e),cf(4)),Cf(t)&&(t=GK(e,t));const{patchPlugin_:a}=e;a&&a.generateReplacementPatches_(r[Tc].base_,t,e)}else t=GK(e,r);return T$e(e,t,!0),kF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==$ie?t:void 0}function GK(t,e){if(OP(e))return e;const r=e[Tc];if(!r)return vI(e,t.handledSet_,t);if(!DP(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);Xie(r,t)}return r.copy_}function T$e(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&uM(e,r)}function zie(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var DP=(t,e)=>t.scope_===e,k$e=[];function Wie(t,e,r,n){const a=Qh(t),s=t.type_;if(n!==void 0&&PF(a,n,s)===e){gI(a,n,r,s);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;BP(a,(c,u)=>{if(NA(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=t.draftLocations_.get(e)??k$e;for(const l of o)gI(a,l,r,s)}function F$e(t,e,r){t.callbacks_.push(function(a){var l;const s=e;if(!s||!DP(s,a))return;(l=a.mapSetPlugin_)==null||l.fixSetContents(s);const o=cM(s);Wie(t,s.draft_??s,o,r),Xie(s,a)})}function Xie(t,e){var n;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((n=t.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=e;if(a){const s=a.getPath(t);s&&a.generatePatches_(t,s,e)}zie(t)}}function O$e(t,e,r){const{scope_:n}=t;if(NA(r)){const a=r[Tc];DP(a,n)&&a.callbacks_.push(function(){CE(t);const o=cM(a);Wie(t,r,o,e)})}else Cf(r)&&t.callbacks_.push(function(){const s=Qh(t);t.type_===3?s.has(r)&&vI(r,n.handledSet_,n):PF(s,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&vI(PF(t.copy_,e,t.type_),n.handledSet_,n)})}function vI(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||NA(t)||e.has(t)||!Cf(t)||OP(t)||(e.add(t),BP(t,(n,a)=>{if(NA(a)){const s=a[Tc];if(DP(s,r)){const o=cM(s);gI(t,n,o,t.type_),zie(s)}}else Cf(a)&&vI(a,e,r)})),t}function D$e(t,e){const r=TP(t),n={type_:r?1:0,scope_:e?e.scope_:qie(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=yI;r&&(a=[n],s=J2);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,[l,n]}var yI={get(t,e){if(e===Tc)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r!=null&&r.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const a=Qh(t);if(!UK(a,e,t.type_))return R$e(t,a,e);const s=a[e];if(t.finalized_||!Cf(s)||n&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&I$e(e))return s;if(s===mB(t.base_,e)){CE(t);const o=t.type_===1?+e:e,l=DF(t.scope_,s,t,o);return t.copy_[o]=l}return s},has(t,e){return e in Qh(t)},ownKeys(t){return Reflect.ownKeys(Qh(t))},set(t,e,r){const n=Yie(Qh(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=mB(Qh(t),e),s=a==null?void 0:a[Tc];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(S$e(r,a)&&(r!==void 0||UK(t.base_,e,t.type_)))return!0;CE(t),OF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),O$e(t,e,r)),!0},deleteProperty(t,e){return CE(t),mB(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),OF(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Qh(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[NE]:!0,[jF]:t.type_!==1||e!=="length",[pI]:n[pI],[X2]:r[e]}},defineProperty(){cf(11)},getPrototypeOf(t){return Kv(t.base_)},setPrototypeOf(){cf(12)}},J2={};for(let t in yI){let e=yI[t];J2[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}}J2.deleteProperty=function(t,e){return J2.set.call(this,t,e,void 0)};J2.set=function(t,e,r){return yI.set.call(this,t[0],e,r,t[0])};function mB(t,e){const r=t[Tc];return(r?Qh(r):t)[e]}function R$e(t,e,r){var a;const n=Yie(e,r);return n?X2 in n?n[X2]:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Yie(t,e){if(!(e in t))return;let r=Kv(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Kv(r)}}function OF(t){t.modified_||(t.modified_=!0,t.parent_&&OF(t.parent_))}function CE(t){t.copy_||(t.assigned_=new Map,t.copy_=BF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var M$e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Fx(r)&&!Fx(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Fx(n)||cf(6),a!==void 0&&!Fx(a)&&cf(7);let s;if(Cf(r)){const o=$K(this),l=DF(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?kF(o):FF(o)}return HK(o,a),KK(s,o)}else if(!r||!lM(r)){if(s=n(r),s===void 0&&(s=r),s===$ie&&(s=void 0),this.autoFreeze_&&uM(s,!0),a){const o=[],l=[];yg(TF).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else cf(1,r)},this.produceWithPatches=(r,n)=>{if(Fx(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let a,s;return[this.produce(r,n,(l,c)=>{a=l,s=c}),a,s]},AB(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),AB(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),AB(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Cf(e)||cf(8),NA(e)&&(e=vf(e));const r=$K(this),n=DF(r,e,void 0);return n[Tc].isManual_=!0,FF(r),n}finishDraft(e,r){const n=e&&e[Tc];(!n||!n.isManual_)&&cf(9);const{scope_:a}=n;return HK(a,r),KK(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(r=r.slice(n+1));const a=yg(TF).applyPatches_;return NA(e)?a(e,r):this.produce(e,s=>a(s,r))}};function DF(t,e,r,n){const[a,s]=kP(e)?yg(xI).proxyMap_(e,r):FP(e)?yg(xI).proxySet_(e,r):D$e(e,r);return((r==null?void 0:r.scope_)??qie()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?F$e(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),a}function vf(t){return NA(t)||cf(10,t),Jie(t)}function Jie(t){if(!Cf(t)||OP(t))return t;const e=t[Tc];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=BF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=BF(t,!0);return BP(r,(a,s)=>{gI(r,a,Jie(s))},n),e&&(e.finalized_=!1),r}var L$e=new M$e,Zie=L$e.produce;function eoe(t){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,t):a(s)}var U$e=eoe(),Q$e=eoe,V$e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?AI:AI.apply(null,arguments)};function Rd(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(Lu(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Hie(n)&&n.type===t,r}var toe=class tb extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,tb.prototype)}static get[Symbol.species](){return tb}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new tb(...e[0].concat(this)):new tb(...e.concat(this))}};function qK(t){return Cf(t)?Zie(t,()=>{}):t}function v_(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function H$e(t){return typeof t=="boolean"}var $$e=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=e??{};let o=new toe;return r&&(H$e(r)?o.push(U$e):o.push(Q$e(r.extraArgument))),o},roe="RTK_autoBatch",Ls=()=>t=>({payload:t,meta:{[roe]:!0}}),zK=t=>e=>{setTimeout(e,t)},noe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,s=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:zK(10):t.type==="callback"?t.queueNotification:zK(t.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),A=n.subscribe(f);return l.add(d),()=>{A(),l.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[roe]),s=!a,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},K$e=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new toe(t);return n&&a.push(noe(typeof n=="object"?n:void 0)),a};function G$e(t){const e=$$e(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(oM(r))l=Vie(r);else throw new Error(Lu(1));let c;typeof n=="function"?c=n(e):c=e();let u=AI;a&&(u=V$e({trace:!1,...typeof a=="object"&&a}));const d=_$e(...c),f=K$e(d);let A=typeof o=="function"?o(f):f();const h=u(...A);return Qie(l,s,h)}function aoe(t){const e={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Lu(28));if(l in e)throw new Error(Lu(29));return e[l]=o,a},addAsyncThunk(s,o){return o.pending&&(e[s.pending.type]=o.pending),o.rejected&&(e[s.rejected.type]=o.rejected),o.fulfilled&&(e[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return t(a),[e,r,n]}function q$e(t){return typeof t=="function"}function z$e(t,e){let[r,n,a]=aoe(e),s;if(q$e(t))s=()=>qK(t());else{const l=qK(t);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(NA(d)){const h=f(d,c);return h===void 0?d:h}else{if(Cf(d))return Zie(d,A=>f(A,c));{const A=f(d,c);if(A===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return d},l)}return o.getInitialState=s,o}var W$e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",X$e=(t=21)=>{let e="",r=t;for(;r--;)e+=W$e[Math.random()*64|0];return e},Y$e=Symbol.for("rtk-slice-createasyncthunk");function J$e(t,e){return`${t}/${e}`}function Z$e({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[Y$e];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Lu(11));const l=(typeof a.reducers=="function"?a.reducers(tKe()):a.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,j){const I=typeof w=="string"?w:w.type;if(!I)throw new Error(Lu(12));if(I in u.sliceCaseReducersByType)throw new Error(Lu(13));return u.sliceCaseReducersByType[I]=j,d},addMatcher(w,j){return u.sliceMatchers.push({matcher:w,reducer:j}),d},exposeAction(w,j){return u.actionCreators[w]=j,d},exposeCaseReducer(w,j){return u.sliceCaseReducersByName[w]=j,d}};c.forEach(w=>{const j=l[w],I={reducerName:w,type:J$e(s,w),createNotation:typeof a.reducers=="function"};nKe(j)?sKe(I,j,d,e):rKe(I,j,d)});function f(){const[w={},j=[],I=void 0]=typeof a.extraReducers=="function"?aoe(a.extraReducers):[a.extraReducers],_={...w,...u.sliceCaseReducersByType};return z$e(a.initialState,S=>{for(let E in _)S.addCase(E,_[E]);for(let E of u.sliceMatchers)S.addMatcher(E.matcher,E.reducer);for(let E of j)S.addMatcher(E.matcher,E.reducer);I&&S.addDefaultCase(I)})}const A=w=>w,h=new Map,m=new WeakMap;let p;function x(w,j){return p||(p=f()),p(w,j)}function v(){return p||(p=f()),p.getInitialState()}function y(w,j=!1){function I(S){let E=S[w];return typeof E>"u"&&j&&(E=v_(m,I,v)),E}function _(S=A){const E=v_(h,j,()=>new WeakMap);return v_(E,S,()=>{const B={};for(const[k,P]of Object.entries(a.selectors??{}))B[k]=eKe(P,S,()=>v_(m,S,v),j);return B})}return{reducerPath:w,getSelectors:_,get selectors(){return _(I)},selectSlice:I}}const b={name:s,reducer:x,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...y(o),injectInto(w,{reducerPath:j,...I}={}){const _=j??o;return w.inject({reducerPath:_,reducer:x},I),{...b,...y(_,!0)}}};return b}}function eKe(t,e,r,n){function a(s,...o){let l=e(s);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return a.unwrapped=t,a}var uu=Z$e();function tKe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function rKe({type:t,reducerName:e,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!aKe(n))throw new Error(Lu(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?Rd(t,o):Rd(t))}function nKe(t){return t._reducerDefinitionType==="asyncThunk"}function aKe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function sKe({type:t,reducerName:e},r,n,a){if(!a)throw new Error(Lu(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=a(t,s,d);n.exposeAction(e,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(e,{fulfilled:o||y_,pending:l||y_,rejected:c||y_,settled:u||y_})}function y_(){}var iKe="task",soe="listener",ioe="completed",dM="cancelled",oKe=`task-${dM}`,lKe=`task-${ioe}`,RF=`${soe}-${dM}`,cKe=`${soe}-${ioe}`,RP=class{constructor(t){Br(this,"name","TaskAbortError");Br(this,"message");this.code=t,this.message=`${iKe} ${dM} (reason: ${t})`}},fM=(t,e)=>{if(typeof t!="function")throw new TypeError(Lu(32))},bI=()=>{},ooe=(t,e=bI)=>(t.catch(e),t),loe=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Kp=t=>{if(t.aborted)throw new RP(t.reason)};function coe(t,e){let r=bI;return new Promise((n,a)=>{const s=()=>a(new RP(t.reason));if(t.aborted){s();return}r=loe(t,s),e.finally(()=>r()).then(n,a)}).finally(()=>{r=bI})}var uKe=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof RP?"cancelled":"rejected",error:r}}finally{e==null||e()}},wI=t=>e=>ooe(coe(t,e).then(r=>(Kp(t),r))),uoe=t=>{const e=wI(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:vv}=Object,WK={},MP="listenerMiddleware",dKe=(t,e)=>{const r=n=>loe(t,()=>n.abort(t.reason));return(n,a)=>{fM(n);const s=new AbortController;r(s);const o=uKe(async()=>{Kp(t),Kp(s.signal);const l=await n({pause:wI(s.signal),delay:uoe(s.signal),signal:s.signal});return Kp(s.signal),l},()=>s.abort(lKe));return a!=null&&a.autoJoin&&e.push(o.catch(bI)),{result:wI(t)(o),cancel(){s.abort(oKe)}}}},fKe=(t,e)=>{const r=async(n,a)=>{Kp(e);let s=()=>{};const l=[new Promise((c,u)=>{let d=t({predicate:n,effect:(f,A)=>{A.unsubscribe(),c([f,A.getState(),A.getOriginalState()])}});s=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await coe(e,Promise.race(l));return Kp(e),c}finally{s()}};return(n,a)=>ooe(r(n,a))},doe=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:s}=t;if(e)a=Rd(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Lu(21));return fM(s),{predicate:a,type:e,effect:s}},foe=vv(t=>{const{type:e,predicate:r,effect:n}=doe(t);return{id:X$e(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Lu(22))}}},{withTypes:()=>foe}),XK=(t,e)=>{const{type:r,effect:n,predicate:a}=doe(e);return Array.from(t.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},MF=t=>{t.pending.forEach(e=>{e.abort(RF)})},hKe=(t,e)=>()=>{for(const r of e.keys())MF(r);t.clear()},YK=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},hoe=vv(Rd(`${MP}/add`),{withTypes:()=>hoe}),AKe=Rd(`${MP}/removeAll`),Aoe=vv(Rd(`${MP}/remove`),{withTypes:()=>Aoe}),mKe=(...t)=>{console.error(`${MP}/error`,...t)},Yw=(t={})=>{const e=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=mKe}=t;fM(o);const l=h=>(h.unsubscribe=()=>e.delete(h.id),e.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&MF(h)}),c=h=>{const m=XK(e,h)??foe(h);return l(m)};vv(c,{withTypes:()=>c});const u=h=>{const m=XK(e,h);return m&&(m.unsubscribe(),h.cancelActive&&MF(m)),!!m};vv(u,{withTypes:()=>u});const d=async(h,m,p,x)=>{const v=new AbortController,y=fKe(c,v.signal),b=[];try{h.pending.add(v),n(h),await Promise.resolve(h.effect(m,vv({},p,{getOriginalState:x,condition:(w,j)=>y(w,j).then(Boolean),take:y,delay:uoe(v.signal),pause:wI(v.signal),extra:s,signal:v.signal,fork:dKe(v.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{e.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((w,j,I)=>{w!==v&&(w.abort(RF),I.delete(w))})},cancel:()=>{v.abort(RF),h.pending.delete(v)},throwIfCancelled:()=>{Kp(v.signal)}})))}catch(w){w instanceof RP||YK(o,w,{raisedBy:"effect"})}finally{await Promise.all(b),v.abort(cKe),a(h),h.pending.delete(v)}},f=hKe(e,r);return{middleware:h=>m=>p=>{if(!Hie(p))return m(p);if(hoe.match(p))return c(p.payload);if(AKe.match(p)){f();return}if(Aoe.match(p))return u(p.payload);let x=h.getState();const v=()=>{if(x===WK)throw new Error(Lu(23));return x};let y;try{if(y=m(p),e.size>0){const b=h.getState(),w=Array.from(e.values());for(const j of w){let I=!1;try{I=j.predicate(p,b,x)}catch(_){I=!1,YK(o,_,{raisedBy:"predicate"})}I&&d(j,p,h,v)}}}finally{x=WK}return y},startListening:c,stopListening:u,clearListeners:f}};function Lu(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var pKe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},moe=uu({name:"chartLayout",initialState:pKe,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,s;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(s=e.payload.left)!==null&&s!==void 0?s:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:gKe,setLayout:xKe,setChartSize:vKe,setScale:yKe}=moe.actions,bKe=moe.reducer;function poe(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Ai(t){return Number.isFinite(t)}function Bm(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function JK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ev(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JK(Object(r),!0).forEach(function(n){wKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wKe(t,e,r){return(e=NKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NKe(t){var e=CKe(t,"string");return typeof e=="symbol"?e:e+""}function CKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ks(t,e,r){return sl(t)||sl(e)?r:dh(e)?vg(t,e,r):typeof e=="function"?e(t):r}var _Ke=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&_n(t[s]))return ev(ev({},t),{},{[s]:t[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&_n(t[o]))return ev(ev({},t),{},{[o]:t[o]+(a||0)})}return t},Hg=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",ZK=1e-4,EKe=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-ZK,s=Math.max(n[0],n[1])+ZK,o=t(e[0]),l=t(e[r-1]);(o<a||o>s||l<a||l>s)&&t.domain([e[0],e[r-1]])}},SKe=(t,e)=>{if(!e||e.length!==2||!_n(e[0])||!_n(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!_n(t[0])||t[0]<r)&&(a[0]=r),(!_n(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},IKe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0,l=0;l<r;++l){var c=t[l],u=c==null?void 0:c[a];if(u!=null){var d=u[1],f=u[0],A=uh(d)?f:d;A>=0?(u[0]=s,u[1]=s+A,s=d):(u[0]=o,u[1]=o+A,o=d)}}}},jKe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0;o<r;++o){var l=t[o],c=l==null?void 0:l[a];if(c!=null){var u=uh(c[1])?c[0]:c[1];u>=0?(c[0]=s,c[1]=s+u,s=c[1]):(c[0]=0,c[1]=0)}}}},PKe={sign:IKe,expand:iHe,none:xg,silhouette:oHe,wiggle:lHe,positive:jKe},BKe=(t,e,r)=>{var n,a=(n=PKe[r])!==null&&n!==void 0?n:xg,s=sHe().keys(e).value((l,c)=>Number(ks(l,c,0))).order(SF).offset(a),o=s(t);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=ks(t[d],e[c],0);Array.isArray(f)&&f.length===2&&_n(f[0])&&_n(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function TKe(t){return t==null?void 0:String(t)}var eG=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:s,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=ks(s,e.dataKey,e.scale.domain()[o]);return sl(l)?null:e.scale(l)-a/2+n},kKe=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},FKe=t=>{var e=t.flat(2).filter(_n);return[Math.min(...e),Math.max(...e)]},OKe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],DKe=(t,e,r)=>{if(t!=null)return OKe(Object.keys(t).reduce((n,a)=>{var s=t[a];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=poe(u,e,r),f=FKe(d);return!Ai(f[0])||!Ai(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},tG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,rG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,NI=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=jP(e,d=>d.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],u=a[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function nG(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:s}=t;return ev(ev({},e),{},{dataKey:r,payload:n,value:a,name:s})}function LP(t,e){if(t)return String(t);if(typeof e=="string")return e}var RKe=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},MKe=(t,e)=>e==="centric"?t.angle:t.radius,LA=t=>t.layout.width,UA=t=>t.layout.height,LKe=t=>t.layout.scale,goe=t=>t.layout.margin,UP=tr(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),QP=tr(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),xoe="data-recharts-item-index",voe="data-recharts-item-id",Jw=60;function aG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function b_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aG(Object(r),!0).forEach(function(n){UKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UKe(t,e,r){return(e=QKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QKe(t){var e=VKe(t,"string");return typeof e=="symbol"?e:e+""}function VKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HKe=t=>t.brush.height;function $Ke(t){var e=QP(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Jw;return r+a}return r},0)}function KKe(t){var e=QP(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Jw;return r+a}return r},0)}function GKe(t){var e=UP(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function qKe(t){var e=UP(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ro=tr([LA,UA,goe,HKe,$Ke,KKe,GKe,qKe,Lie,x$e],(t,e,r,n,a,s,o,l,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},A=b_(b_({},f),d),h=A.bottom;A.bottom+=n,A=_Ke(A,c,u);var m=t-A.left-A.right,p=e-A.top-A.bottom;return b_(b_({brushBottom:h},A),{},{width:Math.max(m,0),height:Math.max(p,0)})}),zKe=tr(Ro,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),hM=tr(LA,UA,(t,e)=>({x:0,y:0,width:t,height:e})),WKe=g.createContext(null),qu=()=>g.useContext(WKe)!=null,VP=t=>t.brush,HP=tr([VP,Ro,goe],(t,e,r)=>({height:t.height,x:_n(t.x)?t.x:e.left,y:_n(t.y)?t.y:e.top+e.height+e.brushBottom-((r==null?void 0:r.bottom)||0),width:_n(t.width)?t.width:e.width})),yoe={},boe={},woe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),p()};let A=null;const h=()=>{A!=null&&clearTimeout(A),A=setTimeout(()=>{A=null,f()},n)},m=()=>{A!==null&&(clearTimeout(A),A=null)},p=()=>{m(),o=void 0,l=null},x=()=>{d()},v=function(...y){if(a!=null&&a.aborted)return;o=this,l=y;const b=A==null;h(),c&&b&&d()};return v.schedule=h,v.cancel=p,v.flush=x,a==null||a.addEventListener("abort",p,{once:!0}),v}t.debounce=e})(woe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=woe;function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const A=e.debounce(function(...p){d=n.apply(this,p),f=null},a,{edges:u}),h=function(...p){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,p),f=Date.now(),A.cancel(),A.schedule(),d):(A.apply(this,p),d)},m=()=>(A.flush(),d);return h.cancel=A.cancel,h.flush=m,h}t.debounce=r})(boe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=boe;function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return e.debounce(n,a,{leading:o,maxWait:a,trailing:l})}t.throttle=r})(yoe);var XKe=yoe.throttle;const YKe=jA(XKe);var sG=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},Noe=(t,e,r)=>{var{width:n="100%",height:a="100%",aspect:s,maxHeight:o}=r,l=wA(n)?t:Number(n),c=wA(a)?e:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},JKe={width:0,height:0,overflow:"visible"},ZKe={width:0,overflowX:"visible"},eGe={height:0,overflowY:"visible"},tGe={},rGe=t=>{var{width:e,height:r}=t,n=wA(e),a=wA(r);return n&&a?JKe:n?ZKe:a?eGe:tGe};function nGe(t){var{width:e,height:r,aspect:n}=t,a=e,s=r;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=n&&n>0?void 0:"100%":s===void 0&&(s=n&&n>0?void 0:"100%"),{width:a,height:s}}function LF(){return LF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},LF.apply(null,arguments)}function iG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function oG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iG(Object(r),!0).forEach(function(n){aGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aGe(t,e,r){return(e=sGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sGe(t){var e=iGe(t,"string");return typeof e=="symbol"?e:e+""}function iGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Coe=g.createContext({width:-1,height:-1});function oGe(t){return Bm(t.width)&&Bm(t.height)}function _oe(t){var{children:e,width:r,height:n}=t,a=g.useMemo(()=>({width:r,height:n}),[r,n]);return oGe(a)?g.createElement(Coe.Provider,{value:a},e):null}var AM=()=>g.useContext(Coe),lGe=g.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:f,className:A,onResize:h,style:m={}}=t,p=g.useRef(null),x=g.useRef();x.current=h,g.useImperativeHandle(e,()=>p.current);var[v,y]=g.useState({containerWidth:n.width,containerHeight:n.height}),b=g.useCallback((S,E)=>{y(B=>{var k=Math.round(S),P=Math.round(E);return B.containerWidth===k&&B.containerHeight===P?B:{containerWidth:k,containerHeight:P}})},[]);g.useEffect(()=>{if(p.current==null||typeof ResizeObserver>"u")return zw;var S=P=>{var O,{width:z,height:oe}=P[0].contentRect;b(z,oe),(O=x.current)===null||O===void 0||O.call(x,z,oe)};d>0&&(S=YKe(S,d,{trailing:!0,leading:!1}));var E=new ResizeObserver(S),{width:B,height:k}=p.current.getBoundingClientRect();return b(B,k),E.observe(p.current),()=>{E.disconnect()}},[b,d]);var{containerWidth:w,containerHeight:j}=v;sG(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:I,calculatedHeight:_}=Noe(w,j,{width:a,height:s,aspect:r,maxHeight:c});return sG(I!=null&&I>0||_!=null&&_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,_,a,s,o,l,r),g.createElement("div",{id:f?"".concat(f):void 0,className:as("recharts-responsive-container",A),style:oG(oG({},m),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:p},g.createElement("div",{style:rGe({width:a,height:s})},g.createElement(_oe,{width:I,height:_},u)))}),lG=g.forwardRef((t,e)=>{var r=AM();if(Bm(r.width)&&Bm(r.height))return t.children;var{width:n,height:a}=nGe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:s,calculatedHeight:o}=Noe(void 0,void 0,{width:n,height:a,aspect:t.aspect,maxHeight:t.maxHeight});return _n(s)&&_n(o)?g.createElement(_oe,{width:s,height:o},t.children):g.createElement(lGe,LF({},t,{width:n,height:a,ref:e}))});function Eoe(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var $P=()=>{var t,e=qu(),r=vn(zKe),n=vn(HP),a=(t=vn(VP))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},cGe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},uGe=()=>{var t;return(t=vn(Ro))!==null&&t!==void 0?t:cGe},Soe=()=>vn(LA),Ioe=()=>vn(UA),dGe=()=>vn(t=>t.layout.margin),Ta=t=>t.layout.layoutType,Zw=()=>vn(Ta),fGe=()=>{var t=Zw();return t!==void 0},KP=t=>{var e=Cs(),r=qu(),{width:n,height:a}=t,s=AM(),o=n,l=a;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:a),g.useEffect(()=>{!r&&Bm(o)&&Bm(l)&&e(vKe({width:o,height:l}))},[e,r,o,l]),null},joe=Symbol.for("immer-nothing"),cG=Symbol.for("immer-draftable"),$u=Symbol.for("immer-state");function uf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Z2=Object.getPrototypeOf;function Gv(t){return!!t&&!!t[$u]}function bg(t){var e;return t?Poe(t)||Array.isArray(t)||!!t[cG]||!!((e=t.constructor)!=null&&e[cG])||eN(t)||qP(t):!1}var hGe=Object.prototype.constructor.toString(),uG=new WeakMap;function Poe(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=uG.get(r);return n===void 0&&(n=Function.toString.call(r),uG.set(r,n)),n===hGe}function CI(t,e,r=!0){GP(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function GP(t){const e=t[$u];return e?e.type_:Array.isArray(t)?1:eN(t)?2:qP(t)?3:0}function UF(t,e){return GP(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Boe(t,e,r){const n=GP(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function AGe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function eN(t){return t instanceof Map}function qP(t){return t instanceof Set}function fp(t){return t.copy_||t.base_}function QF(t,e){if(eN(t))return new Map(t);if(qP(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Poe(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[$u];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(Z2(t),n)}else{const n=Z2(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function mM(t,e=!1){return zP(t)||Gv(t)||!bg(t)||(GP(t)>1&&Object.defineProperties(t,{set:w_,add:w_,clear:w_,delete:w_}),Object.freeze(t),e&&Object.values(t).forEach(r=>mM(r,!0))),t}function mGe(){uf(2)}var w_={value:mGe};function zP(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var pGe={};function wg(t){const e=pGe[t];return e||uf(0,t),e}var ew;function Toe(){return ew}function gGe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function dG(t,e){e&&(wg("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function VF(t){HF(t),t.drafts_.forEach(xGe),t.drafts_=null}function HF(t){t===ew&&(ew=t.parent_)}function fG(t){return ew=gGe(ew,t)}function xGe(t){const e=t[$u];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function hG(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[$u].modified_&&(VF(e),uf(4)),bg(t)&&(t=_I(e,t),e.parent_||EI(e,t)),e.patches_&&wg("Patches").generateReplacementPatches_(r[$u].base_,t,e.patches_,e.inversePatches_)):t=_I(e,r,[]),VF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==joe?t:void 0}function _I(t,e,r){if(zP(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[$u];if(!a)return CI(e,(s,o)=>AG(t,a,e,s,o,r),n),e;if(a.scope_!==t)return e;if(!a.modified_)return EI(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),CI(o,(c,u)=>AG(t,a,s,c,u,r,l),n),EI(t,s,!1),r&&t.patches_&&wg("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function AG(t,e,r,n,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=zP(a);if(!(l&&!o)){if(Gv(a)){const c=s&&e&&e.type_!==3&&!UF(e.assigned_,n)?s.concat(n):void 0,u=_I(t,a,c);if(Boe(r,n,u),Gv(u))t.canAutoFreeze_=!1;else return}else o&&r.add(a);if(bg(a)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===a&&l)return;_I(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(eN(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&EI(t,a)}}}function EI(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&mM(e,r)}function vGe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:Toe(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=pM;r&&(a=[n],s=tw);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var pM={get(t,e){if(e===$u)return t;const r=fp(t);if(!UF(r,e))return yGe(t,r,e);const n=r[e];return t.finalized_||!bg(n)?n:n===pB(t.base_,e)?(gB(t),t.copy_[e]=KF(n,t)):n},has(t,e){return e in fp(t)},ownKeys(t){return Reflect.ownKeys(fp(t))},set(t,e,r){const n=koe(fp(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=pB(fp(t),e),s=a==null?void 0:a[$u];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(AGe(r,a)&&(r!==void 0||UF(t.base_,e)))return!0;gB(t),$F(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return pB(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,gB(t),$F(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=fp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){uf(11)},getPrototypeOf(t){return Z2(t.base_)},setPrototypeOf(){uf(12)}},tw={};CI(pM,(t,e)=>{tw[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});tw.deleteProperty=function(t,e){return tw.set.call(this,t,e,void 0)};tw.set=function(t,e,r){return pM.set.call(this,t[0],e,r,t[0])};function pB(t,e){const r=t[$u];return(r?fp(r):t)[e]}function yGe(t,e,r){var a;const n=koe(e,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function koe(t,e){if(!(e in t))return;let r=Z2(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Z2(r)}}function $F(t){t.modified_||(t.modified_=!0,t.parent_&&$F(t.parent_))}function gB(t){t.copy_||(t.copy_=QF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var bGe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&uf(6),n!==void 0&&typeof n!="function"&&uf(7);let a;if(bg(e)){const s=fG(this),o=KF(e,void 0);let l=!0;try{a=r(o),l=!1}finally{l?VF(s):HF(s)}return dG(s,n),hG(a,s)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===joe&&(a=void 0),this.autoFreeze_&&mM(a,!0),n){const s=[],o=[];wg("Patches").generateReplacementPatches_(e,a,s,o),n(s,o)}return a}else uf(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,a;return[this.produce(e,r,(o,l)=>{n=o,a=l}),n,a]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){bg(t)||uf(8),Gv(t)&&(t=wGe(t));const e=fG(this),r=KF(t,void 0);return r[$u].isManual_=!0,HF(e),r}finishDraft(t,e){const r=t&&t[$u];(!r||!r.isManual_)&&uf(9);const{scope_:n}=r;return dG(n,e),hG(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=wg("Patches").applyPatches_;return Gv(t)?n(t,e):this.produce(t,a=>n(a,e))}};function KF(t,e){const r=eN(t)?wg("MapSet").proxyMap_(t,e):qP(t)?wg("MapSet").proxySet_(t,e):vGe(t,e);return(e?e.scope_:Toe()).drafts_.push(r),r}function wGe(t){return Gv(t)||uf(10,t),Foe(t)}function Foe(t){if(!bg(t)||zP(t))return t;const e=t[$u];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=QF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=QF(t,!0);return CI(r,(a,s)=>{Boe(r,a,Foe(s))},n),e&&(e.finalized_=!1),r}var NGe=new bGe;NGe.produce;var CGe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Ooe=uu({name:"legend",initialState:CGe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:Ls()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,a=vf(t).payload.indexOf(r);a>-1&&(t.payload[a]=n)},prepare:Ls()},removeLegendPayload:{reducer(t,e){var r=vf(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:Ls()}}}),{setLegendSize:mG,setLegendSettings:_Ge,addLegendPayload:Doe,replaceLegendPayload:Roe,removeLegendPayload:Moe}=Ooe.actions,EGe=Ooe.reducer,SGe=["contextPayload"];function GF(){return GF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},GF.apply(null,arguments)}function pG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pG(Object(r),!0).forEach(function(n){IGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function IGe(t,e,r){return(e=jGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jGe(t){var e=PGe(t,"string");return typeof e=="symbol"?e:e+""}function PGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BGe(t,e){if(t==null)return{};var r,n,a=TGe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function TGe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function kGe(t){return t.value}function FGe(t){var{contextPayload:e}=t,r=BGe(t,SGe),n=Iie(e,t.payloadUniqBy,kGe),a=qv(qv({},r),{},{payload:n});return g.isValidElement(t.content)?g.cloneElement(t.content,a):typeof t.content=="function"?g.createElement(t.content,a):g.createElement(RHe,a)}function OGe(t,e,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=e,u,d;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?d={top:((a||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),qv(qv({},u),d)}function DGe(t){var e=Cs();return g.useEffect(()=>{e(_Ge(t))},[e,t]),null}function RGe(t){var e=Cs();return g.useEffect(()=>(e(mG(t)),()=>{e(mG({width:0,height:0}))}),[e,t]),null}function MGe(t,e,r,n){return t==="vertical"&&_n(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var LGe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function qF(t){var e=kl(t,LGe),r=b$e(),n=jVe(),a=dGe(),{width:s,height:o,wrapperStyle:l,portal:c}=e,[u,d]=Uie([r]),f=Soe(),A=Ioe();if(f==null||A==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=MGe(e.layout,o,s,h),p=c?l:qv(qv({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},OGe(l,e,a,f,A,u)),l),x=c??n;if(x==null||r==null)return null;var v=g.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},g.createElement(DGe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&g.createElement(RGe,{width:u.width,height:u.height}),g.createElement(FGe,GF({},e,m,{margin:a,chartWidth:f,chartHeight:A,contextPayload:r})));return Mu.createPortal(v,x)}qF.displayName="Legend";function zF(){return zF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zF.apply(null,arguments)}function gG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function xB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gG(Object(r),!0).forEach(function(n){UGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UGe(t,e,r){return(e=QGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QGe(t){var e=VGe(t,"string");return typeof e=="symbol"?e:e+""}function VGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HGe(t){return Array.isArray(t)&&dh(t[0])&&dh(t[1])?t.join(" ~ "):t}var $Ge=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:A=!1}=t,h=()=>{if(s&&s.length){var j={padding:0,margin:0},I=(l?jP(s,l):s).map((_,S)=>{if(_.type==="none")return null;var E=_.formatter||o||HGe,{value:B,name:k}=_,P=B,O=k;if(E){var z=E(B,k,_,S,s);if(Array.isArray(z))[P,O]=z;else if(z!=null)P=z;else return null}var oe=xB({display:"block",paddingTop:4,paddingBottom:4,color:_.color||"#000"},n);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:oe},dh(O)?g.createElement("span",{className:"recharts-tooltip-item-name"},O):null,dh(O)?g.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,g.createElement("span",{className:"recharts-tooltip-item-value"},P),g.createElement("span",{className:"recharts-tooltip-item-unit"},_.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:j},I)}return null},m=xB({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=xB({margin:0},a),x=!sl(d),v=x?d:"",y=as("recharts-default-tooltip",c),b=as("recharts-tooltip-label",u);x&&f&&s!==void 0&&s!==null&&(v=f(d,s));var w=A?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",zF({className:y,style:m},w),g.createElement("p",{className:b,style:p},g.isValidElement(v)?v:"".concat(v)),h())},Ny="recharts-tooltip-wrapper",KGe={visibility:"hidden"};function GGe(t){var{coordinate:e,translateX:r,translateY:n}=t;return as(Ny,{["".concat(Ny,"-right")]:_n(r)&&e&&_n(e.x)&&r>=e.x,["".concat(Ny,"-left")]:_n(r)&&e&&_n(e.x)&&r<e.x,["".concat(Ny,"-bottom")]:_n(n)&&e&&_n(e.y)&&n>=e.y,["".concat(Ny,"-top")]:_n(n)&&e&&_n(e.y)&&n<e.y})}function xG(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(s&&_n(s[n]))return s[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(e[n])return o[n]?d:f;var A=c[n];if(A==null)return 0;if(o[n]){var h=d,m=A;return h<m?Math.max(f,A):Math.max(d,A)}if(u==null)return 0;var p=f+l,x=A+u;return p>x?Math.max(d,A):Math.max(f,A)}function qGe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function zGe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,u,d,f;return o.height>0&&o.width>0&&r?(d=xG({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=xG({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=qGe({translateX:d,translateY:f,useTranslate3d:l})):u=KGe,{cssProperties:u,cssClasses:GGe({translateX:d,translateY:f,coordinate:r})}}function vG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function N_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vG(Object(r),!0).forEach(function(n){WF(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WF(t,e,r){return(e=WGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WGe(t){var e=XGe(t,"string");return typeof e=="symbol"?e:e+""}function XGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YGe extends g.PureComponent{constructor(){super(...arguments),WF(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),WF(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:A,viewBox:h,wrapperStyle:m,lastBoundingBox:p,innerRef:x,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=zGe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:p.height,width:p.width},useTranslate3d:A,viewBox:h}),w=v?{}:N_(N_({transition:c&&e?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),j=N_(N_({},w),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},m);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:j,ref:x},s)}}var Loe=()=>{var t;return(t=vn(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function XF(){return XF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},XF.apply(null,arguments)}function yG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yG(Object(r),!0).forEach(function(n){JGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JGe(t,e,r){return(e=ZGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZGe(t){var e=eqe(t,"string");return typeof e=="symbol"?e:e+""}function eqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wG={curveBasisClosed:zVe,curveBasisOpen:WVe,curveBasis:qVe,curveBumpX:kVe,curveBumpY:FVe,curveLinearClosed:XVe,curveLinear:wP,curveMonotoneX:YVe,curveMonotoneY:JVe,curveNatural:ZVe,curveStep:eHe,curveStepAfter:rHe,curveStepBefore:tHe},SI=t=>Ai(t.x)&&Ai(t.y),NG=t=>t.base!=null&&SI(t.base)&&SI(t),Cy=t=>t.x,_y=t=>t.y,tqe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(qw(t));return(r==="curveMonotone"||r==="curveBump")&&e?wG["".concat(r).concat(e==="vertical"?"Y":"X")]:wG[r]||wP},rqe=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=t,o=tqe(e,a),l=s?r.filter(SI):r,c;if(Array.isArray(n)){var u=r.map((h,m)=>bG(bG({},h),{},{base:n[m]}));a==="vertical"?c=m_().y(_y).x1(Cy).x0(h=>h.base.x):c=m_().x(Cy).y1(_y).y0(h=>h.base.y);var d=c.defined(NG).curve(o),f=s?u.filter(NG):u;return d(f)}a==="vertical"&&_n(n)?c=m_().y(_y).x1(Cy).x0(n):_n(n)?c=m_().x(Cy).y1(_y).y0(n):c=Wse().x(Cy).y(_y);var A=c.defined(SI).curve(o);return A(l)},gM=t=>{var{className:e,points:r,path:n,pathRef:a}=t,s=Zw();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||s,connectNulls:t.connectNulls},l=r&&r.length?rqe(o):n;return g.createElement("path",XF({},ch(t),CHe(t),{className:as("recharts-curve",e),d:l===null?void 0:l,ref:a}))},nqe=["x","y","top","left","width","height","className"];function YF(){return YF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},YF.apply(null,arguments)}function CG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function aqe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CG(Object(r),!0).forEach(function(n){sqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sqe(t,e,r){return(e=iqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iqe(t){var e=oqe(t,"string");return typeof e=="symbol"?e:e+""}function oqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lqe(t,e){if(t==null)return{};var r,n,a=cqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function cqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var uqe=(t,e,r,n,a,s)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(s,",").concat(e,"h").concat(r),dqe=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=t,c=lqe(t,nqe),u=aqe({x:e,y:r,top:n,left:a,width:s,height:o},c);return!_n(e)||!_n(r)||!_n(s)||!_n(o)||!_n(n)||!_n(a)?null:g.createElement("path",YF({},Dd(u),{className:as("recharts-cross",l),d:uqe(e,r,s,o,n,a)}))};function fqe(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function _G(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function EG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_G(Object(r),!0).forEach(function(n){hqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_G(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hqe(t,e,r){return(e=Aqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Aqe(t){var e=mqe(t,"string");return typeof e=="symbol"?e:e+""}function mqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pqe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),Uoe=(t,e,r)=>t.map(n=>"".concat(pqe(n)," ").concat(e,"ms ").concat(r)).join(","),gqe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),rw=(t,e)=>Object.keys(e).reduce((r,n)=>EG(EG({},r),{},{[n]:t(n,e[n])}),{});function SG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function So(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SG(Object(r),!0).forEach(function(n){xqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xqe(t,e,r){return(e=vqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vqe(t){var e=yqe(t,"string");return typeof e=="symbol"?e:e+""}function yqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var II=(t,e,r)=>t+(e-t)*r,JF=t=>{var{from:e,to:r}=t;return e!==r},Qoe=(t,e,r)=>{var n=rw((a,s)=>{if(JF(s)){var[o,l]=t(s.from,s.to,s.velocity);return So(So({},s),{},{from:o,velocity:l})}return s},e);return r<1?rw((a,s)=>JF(s)&&n[a]!=null?So(So({},s),{},{velocity:II(s.velocity,n[a].velocity,r),from:II(s.from,n[a].from,r)}):s,e):Qoe(t,n,r-1)};function bqe(t,e,r,n,a,s){var o,l=n.reduce((A,h)=>So(So({},A),{},{[h]:{from:t[h],velocity:0,to:e[h]}}),{}),c=()=>rw((A,h)=>h.from,l),u=()=>!Object.values(l).filter(JF).length,d=null,f=A=>{o||(o=A);var h=A-o,m=h/r.dt;l=Qoe(r,l,m),a(So(So(So({},t),e),c())),o=A,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var A;(A=d)===null||A===void 0||A()})}function wqe(t,e,r,n,a,s,o){var l=null,c=a.reduce((f,A)=>{var h=t[A],m=e[A];return h==null||m==null?f:So(So({},f),{},{[A]:[h,m]})},{}),u,d=f=>{u||(u=f);var A=(f-u)/n,h=rw((p,x)=>II(...x,r(A)),c);if(s(So(So(So({},t),e),h)),A<1)l=o.setTimeout(d);else{var m=rw((p,x)=>II(...x,r(1)),c);s(So(So(So({},t),e),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const Nqe=(t,e,r,n,a,s)=>{var o=gqe(t,e);return r==null?()=>(a(So(So({},t),e)),()=>{}):r.isStepper===!0?bqe(t,e,r,o,a,s):wqe(t,e,r,n,o,a,s)};var jI=1e-4,Voe=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],Hoe=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),IG=(t,e)=>r=>{var n=Voe(t,e);return Hoe(n,r)},Cqe=(t,e)=>r=>{var n=Voe(t,e),a=[...n.map((s,o)=>s*o).slice(1),0];return Hoe(a,r)},_qe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},Eqe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=_qe(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},Sqe=(t,e,r,n)=>{var a=IG(t,r),s=IG(e,n),o=Cqe(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,A=0;A<8;++A){var h=a(f)-d,m=o(f);if(Math.abs(h-d)<jI||m<jI)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},jG=function(){return Sqe(...Eqe(...arguments))},Iqe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*a/1e3,A=c*a/1e3+o;return Math.abs(A-l)<jI&&Math.abs(f)<jI?[l,0]:[A,f]};return s.isStepper=!0,s.dt=a,s},jqe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return jG(t);case"spring":return Iqe();default:if(t.split("(")[0]==="cubic-bezier")return jG(t)}return typeof t=="function"?t:null};function Pqe(t){var e,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){a=t.setTimeout(s.bind(null,u),c);return}s(c),a=t.setTimeout(s.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class Bqe{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function Tqe(){return Pqe(new Bqe)}var kqe=g.createContext(Tqe);function Fqe(t,e){var r=g.useContext(kqe);return g.useMemo(()=>e??r(t),[t,e,r])}var Oqe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),WP={isSsr:Oqe()},Dqe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},PG={t:0},vB={t:1};function XP(t){var e=kl(t,Dqe),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,d=r==="auto"?!WP.isSsr:r,f=Fqe(e.animationId,e.animationManager),[A,h]=g.useState(d?PG:vB),m=g.useRef(null);return g.useEffect(()=>{d||h(vB)},[d]),g.useEffect(()=>{if(!d||!n)return zw;var p=Nqe(PG,vB,jqe(s),a,h,f.getTimeoutController()),x=()=>{m.current=p()};return f.start([c,o,x,a,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,a,s,o,c,l,f]),u(A.t)}function YP(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=g.useRef(W2(e)),n=g.useRef(t);return n.current!==t&&(r.current=W2(e),n.current=t),r.current}var Rqe=["radius"],Mqe=["radius"],BG,TG,kG,FG,OG,DG,RG,MG,LG,UG;function QG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function VG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QG(Object(r),!0).forEach(function(n){Lqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lqe(t,e,r){return(e=Uqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uqe(t){var e=Qqe(t,"string");return typeof e=="symbol"?e:e+""}function Qqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PI(){return PI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},PI.apply(null,arguments)}function HG(t,e){if(t==null)return{};var r,n,a=Vqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Vqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Qf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var $G=(t,e,r,n,a)=>{var s=Y0(r),o=Y0(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&a instanceof Array){for(var A=[0,0,0,0],h=0,m=4;h<m;h++)A[h]=a[h]>l?l:a[h];f=Ci(BG||(BG=Qf(["M",",",""])),t,e+c*A[0]),A[0]>0&&(f+=Ci(TG||(TG=Qf(["A ",",",",0,0,",",",",",""])),A[0],A[0],d,t+u*A[0],e)),f+=Ci(kG||(kG=Qf(["L ",",",""])),t+r-u*A[1],e),A[1]>0&&(f+=Ci(FG||(FG=Qf(["A ",",",",0,0,",`,
        `,",",""])),A[1],A[1],d,t+r,e+c*A[1])),f+=Ci(OG||(OG=Qf(["L ",",",""])),t+r,e+n-c*A[2]),A[2]>0&&(f+=Ci(DG||(DG=Qf(["A ",",",",0,0,",`,
        `,",",""])),A[2],A[2],d,t+r-u*A[2],e+n)),f+=Ci(RG||(RG=Qf(["L ",",",""])),t+u*A[3],e+n),A[3]>0&&(f+=Ci(MG||(MG=Qf(["A ",",",",0,0,",`,
        `,",",""])),A[3],A[3],d,t,e+n-c*A[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var p=Math.min(l,a);f=Ci(LG||(LG=Qf(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*p,p,p,d,t+u*p,e,t+r-u*p,e,p,p,d,t+r,e+c*p,t+r,e+n-c*p,p,p,d,t+r-u*p,e+n,t+u*p,e+n,p,p,d,t,e+n-c*p)}else f=Ci(UG||(UG=Qf(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return f},KG={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},$oe=t=>{var e=kl(t,KG),r=g.useRef(null),[n,a]=g.useState(-1);g.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ue=r.current.getTotalLength();ue&&a(ue)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=e,{animationEasing:f,animationDuration:A,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:p}=e,x=g.useRef(l),v=g.useRef(c),y=g.useRef(s),b=g.useRef(o),w=g.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),j=YP(w,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var I=as("recharts-rectangle",d);if(!p){var _=Dd(e),{radius:S}=_,E=HG(_,Rqe);return g.createElement("path",PI({},E,{x:Y0(s),y:Y0(o),width:Y0(l),height:Y0(c),radius:typeof u=="number"?u:void 0,className:I,d:$G(s,o,l,c,u)}))}var B=x.current,k=v.current,P=y.current,O=b.current,z="0px ".concat(n===-1?1:n,"px"),oe="".concat(n,"px 0px"),ce=Uoe(["strokeDasharray"],A,typeof f=="string"?f:KG.animationEasing);return g.createElement(XP,{animationId:j,key:j,canBegin:n>0,duration:A,easing:f,isActive:p,begin:h},ue=>{var ge=Eo(B,l,ue),ne=Eo(k,c,ue),Oe=Eo(P,s,ue),Ue=Eo(O,o,ue);r.current&&(x.current=ge,v.current=ne,y.current=Oe,b.current=Ue);var F;m?ue>0?F={transition:ce,strokeDasharray:oe}:F={strokeDasharray:z}:F={strokeDasharray:oe};var H=Dd(e),{radius:K}=H,U=HG(H,Mqe);return g.createElement("path",PI({},U,{radius:typeof u=="number"?u:void 0,className:I,d:$G(Oe,Ue,ge,ne,u),ref:r,style:VG(VG({},F),e.style)}))})};function GG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GG(Object(r),!0).forEach(function(n){Hqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hqe(t,e,r){return(e=$qe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $qe(t){var e=Kqe(t,"string");return typeof e=="symbol"?e:e+""}function Kqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var BI=Math.PI/180,Gqe=t=>t*180/Math.PI,lo=(t,e,r,n)=>({x:t+Math.cos(-BI*n)*r,y:e+Math.sin(-BI*n)*r}),Koe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},qqe=(t,e)=>{var{x:r,y:n}=t,{x:a,y:s}=e;return Math.sqrt((r-a)**2+(n-s)**2)},zqe=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:s}=e,o=qqe({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:Gqe(c),angleInRadian:c}},Wqe=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:e-s*360,endAngle:r-s*360}},Xqe=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return t+o*360},Yqe=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:a,angle:s}=zqe({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:u}=Wqe(e),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?qG(qG({},e),{},{radius:a,angle:Xqe(d,e)}):null};function Goe(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:s}=t,o=lo(e,r,n,a),l=lo(e,r,n,s);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:a,endAngle:s}}var zG,WG,XG,YG,JG,ZG,eq;function ZF(){return ZF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZF.apply(null,arguments)}function Ip(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Jqe=(t,e)=>{var r=Pl(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},C_=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,d=Math.asin(l/u)/BI,f=c?a:a+s*d,A=lo(e,r,u,f),h=lo(e,r,n,f),m=c?a-s*d:a,p=lo(e,r,u*Math.cos(d*BI),m);return{center:A,circleTangency:h,lineTangency:p,theta:d}},qoe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=t,l=Jqe(s,o),c=s+l,u=lo(e,r,a,s),d=lo(e,r,a,c),f=Ci(zG||(zG=Ip(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var A=lo(e,r,n,s),h=lo(e,r,n,c);f+=Ci(WG||(WG=Ip(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),A.x,A.y)}else f+=Ci(XG||(XG=Ip(["L ",","," Z"])),e,r);return f},Zqe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,d=Pl(u-c),{circleTangency:f,lineTangency:A,theta:h}=C_({cx:e,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:p,theta:x}=C_({cx:e,cy:r,radius:a,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),v=l?Math.abs(c-u):Math.abs(c-u)-h-x;if(v<0)return o?Ci(YG||(YG=Ip(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),A.x,A.y,s,s,s*2,s,s,-s*2):qoe({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var y=Ci(JG||(JG=Ip(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),A.x,A.y,s,s,+(d<0),f.x,f.y,a,a,+(v>180),+(d<0),m.x,m.y,s,s,+(d<0),p.x,p.y);if(n>0){var{circleTangency:b,lineTangency:w,theta:j}=C_({cx:e,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:I,lineTangency:_,theta:S}=C_({cx:e,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),E=l?Math.abs(c-u):Math.abs(c-u)-j-S;if(E<0&&s===0)return"".concat(y,"L").concat(e,",").concat(r,"Z");y+=Ci(ZG||(ZG=Ip(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),_.x,_.y,s,s,+(d<0),I.x,I.y,n,n,+(E>180),+(d>0),b.x,b.y,s,s,+(d<0),w.x,w.y)}else y+=Ci(eq||(eq=Ip(["L",",","Z"])),e,r);return y},eze={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},zoe=t=>{var e=kl(t,eze),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=e;if(s<a||u===d)return null;var A=as("recharts-sector",f),h=s-a,m=ic(o,h,0,!0),p;return m>0&&Math.abs(u-d)<360?p=Zqe({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):p=qoe({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d}),g.createElement("path",ZF({},Dd(e),{className:A,d:p}))};function tze(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(uie(e)){if(t==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:o,angle:l}=e,c=lo(n,a,s,l),u=lo(n,a,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Goe(e)}}var Woe={},Xoe={},Yoe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sM;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(Yoe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Yoe;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(Xoe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iM,r=Xoe;function n(a,s,o){o&&typeof o!="number"&&e.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=o;return c}t.range=n})(Woe);var rze=Woe.range;const Joe=jA(rze);function mm(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nze(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function xM(t){let e,r,n;t.length!==2?(e=mm,r=(l,c)=>mm(t(l),c),n=(l,c)=>t(l)-c):(e=t===mm||t===nze?t:aze,r=t,n=t);function a(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function aze(){return 0}function Zoe(t){return t===null?NaN:+t}function*sze(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const ize=xM(mm),tN=ize.right;xM(Zoe).center;class tq extends Map{constructor(e,r=cze){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(rq(this,e))}has(e){return super.has(rq(this,e))}set(e,r){return super.set(oze(this,e),r)}delete(e){return super.delete(lze(this,e))}}function rq({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function oze({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function lze({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function cze(t){return t!==null&&typeof t=="object"?t.valueOf():t}function uze(t=mm){if(t===mm)return ele;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function ele(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const dze=Math.sqrt(50),fze=Math.sqrt(10),hze=Math.sqrt(2);function TI(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=dze?10:s>=fze?5:s>=hze?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?TI(t,e,r*2):[l,c,u]}function eO(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,s,o]=n?TI(e,t,r):TI(t,e,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(a+u)/-o;else for(let u=0;u<l;++u)c[u]=(a+u)*o;return c}function tO(t,e,r){return e=+e,t=+t,r=+r,TI(t,e,r)[2]}function rO(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?tO(e,t,r):tO(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function nq(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function aq(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function tle(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?ele:uze(a);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),A=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(e-u*f/c+A)),m=Math.min(n,Math.floor(e+(c-u)*f/c+A));tle(t,e,h,m,a)}const s=t[e];let o=r,l=n;for(Ey(t,r,e),a(t[n],s)>0&&Ey(t,r,n);o<l;){for(Ey(t,o,l),++o,--l;a(t[o],s)<0;)++o;for(;a(t[l],s)>0;)--l}a(t[r],s)===0?Ey(t,r,l):(++l,Ey(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function Ey(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Aze(t,e,r){if(t=Float64Array.from(sze(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return aq(t);if(e>=1)return nq(t);var n,a=(n-1)*e,s=Math.floor(a),o=nq(tle(t,s).subarray(0,s+1)),l=aq(t.subarray(s+1));return o+(l-o)*(a-s)}}function mze(t,e,r=Zoe){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,s=Math.floor(a),o=+r(t[s],s,t),l=+r(t[s+1],s+1,t);return o+(l-o)*(a-s)}}function pze(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,s=new Array(a);++n<a;)s[n]=t+n*r;return s}function Vd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function QA(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const nO=Symbol("implicit");function vM(){var t=new tq,e=[],r=[],n=nO;function a(s){let o=t.get(s);if(o===void 0){if(n!==nO)return n;t.set(s,o=e.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new tq;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return vM(e,r).unknown(n)},Vd.apply(a,arguments),a}function yM(){var t=vM().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,s,o,l=!1,c=0,u=0,d=.5;delete t.unknown;function f(){var A=e().length,h=a<n,m=h?a:n,p=h?n:a;s=(p-m)/Math.max(1,A-c+u*2),l&&(s=Math.floor(s)),m+=(p-m-s*(A-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var x=pze(A).map(function(v){return m+s*v});return r(h?x.reverse():x)}return t.domain=function(A){return arguments.length?(e(A),f()):e()},t.range=function(A){return arguments.length?([n,a]=A,n=+n,a=+a,f()):[n,a]},t.rangeRound=function(A){return[n,a]=A,n=+n,a=+a,l=!0,f()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(A){return arguments.length?(l=!!A,f()):l},t.padding=function(A){return arguments.length?(c=Math.min(1,u=+A),f()):c},t.paddingInner=function(A){return arguments.length?(c=Math.min(1,A),f()):c},t.paddingOuter=function(A){return arguments.length?(u=+A,f()):u},t.align=function(A){return arguments.length?(d=Math.max(0,Math.min(1,A)),f()):d},t.copy=function(){return yM(e(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Vd.apply(f(),arguments)}function rle(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return rle(e())},t}function gze(){return rle(yM.apply(null,arguments).paddingInner(1))}function bM(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function nle(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function rN(){}var nw=.7,kI=1/nw,yv="\\s*([+-]?\\d+)\\s*",aw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ih="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xze=/^#([0-9a-f]{3,8})$/,vze=new RegExp(`^rgb\\(${yv},${yv},${yv}\\)$`),yze=new RegExp(`^rgb\\(${ih},${ih},${ih}\\)$`),bze=new RegExp(`^rgba\\(${yv},${yv},${yv},${aw}\\)$`),wze=new RegExp(`^rgba\\(${ih},${ih},${ih},${aw}\\)$`),Nze=new RegExp(`^hsl\\(${aw},${ih},${ih}\\)$`),Cze=new RegExp(`^hsla\\(${aw},${ih},${ih},${aw}\\)$`),sq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};bM(rN,sw,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:iq,formatHex:iq,formatHex8:_ze,formatHsl:Eze,formatRgb:oq,toString:oq});function iq(){return this.rgb().formatHex()}function _ze(){return this.rgb().formatHex8()}function Eze(){return ale(this).formatHsl()}function oq(){return this.rgb().formatRgb()}function sw(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=xze.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?lq(e):r===3?new ru(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?__(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?__(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=vze.exec(t))?new ru(e[1],e[2],e[3],1):(e=yze.exec(t))?new ru(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=bze.exec(t))?__(e[1],e[2],e[3],e[4]):(e=wze.exec(t))?__(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Nze.exec(t))?dq(e[1],e[2]/100,e[3]/100,1):(e=Cze.exec(t))?dq(e[1],e[2]/100,e[3]/100,e[4]):sq.hasOwnProperty(t)?lq(sq[t]):t==="transparent"?new ru(NaN,NaN,NaN,0):null}function lq(t){return new ru(t>>16&255,t>>8&255,t&255,1)}function __(t,e,r,n){return n<=0&&(t=e=r=NaN),new ru(t,e,r,n)}function Sze(t){return t instanceof rN||(t=sw(t)),t?(t=t.rgb(),new ru(t.r,t.g,t.b,t.opacity)):new ru}function aO(t,e,r,n){return arguments.length===1?Sze(t):new ru(t,e,r,n??1)}function ru(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}bM(ru,aO,nle(rN,{brighter(t){return t=t==null?kI:Math.pow(kI,t),new ru(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?nw:Math.pow(nw,t),new ru(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ru(Gp(this.r),Gp(this.g),Gp(this.b),FI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cq,formatHex:cq,formatHex8:Ize,formatRgb:uq,toString:uq}));function cq(){return`#${jp(this.r)}${jp(this.g)}${jp(this.b)}`}function Ize(){return`#${jp(this.r)}${jp(this.g)}${jp(this.b)}${jp((isNaN(this.opacity)?1:this.opacity)*255)}`}function uq(){const t=FI(this.opacity);return`${t===1?"rgb(":"rgba("}${Gp(this.r)}, ${Gp(this.g)}, ${Gp(this.b)}${t===1?")":`, ${t})`}`}function FI(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Gp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function jp(t){return t=Gp(t),(t<16?"0":"")+t.toString(16)}function dq(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new df(t,e,r,n)}function ale(t){if(t instanceof df)return new df(t.h,t.s,t.l,t.opacity);if(t instanceof rN||(t=sw(t)),!t)return new df;if(t instanceof df)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(e===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new df(o,l,c,t.opacity)}function jze(t,e,r,n){return arguments.length===1?ale(t):new df(t,e,r,n??1)}function df(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}bM(df,jze,nle(rN,{brighter(t){return t=t==null?kI:Math.pow(kI,t),new df(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?nw:Math.pow(nw,t),new df(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new ru(yB(t>=240?t-240:t+120,a,n),yB(t,a,n),yB(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new df(fq(this.h),E_(this.s),E_(this.l),FI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=FI(this.opacity);return`${t===1?"hsl(":"hsla("}${fq(this.h)}, ${E_(this.s)*100}%, ${E_(this.l)*100}%${t===1?")":`, ${t})`}`}}));function fq(t){return t=(t||0)%360,t<0?t+360:t}function E_(t){return Math.max(0,Math.min(1,t||0))}function yB(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const wM=t=>()=>t;function Pze(t,e){return function(r){return t+r*e}}function Bze(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Tze(t){return(t=+t)==1?sle:function(e,r){return r-e?Bze(e,r,t):wM(isNaN(e)?r:e)}}function sle(t,e){var r=e-t;return r?Pze(t,r):wM(isNaN(t)?e:t)}const hq=function t(e){var r=Tze(e);function n(a,s){var o=r((a=aO(a)).r,(s=aO(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),u=sle(a.opacity,s.opacity);return function(d){return a.r=o(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=t,n}(1);function kze(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=t[a]*(1-s)+e[a]*s;return n}}function Fze(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Oze(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=C1(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function Dze(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function OI(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Rze(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=C1(t[a],e[a]):n[a]=e[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var sO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bB=new RegExp(sO.source,"g");function Mze(t){return function(){return t}}function Lze(t){return function(e){return t(e)+""}}function Uze(t,e){var r=sO.lastIndex=bB.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=sO.exec(t))&&(a=bB.exec(e));)(s=a.index)>r&&(s=e.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:OI(n,a)})),r=bB.lastIndex;return r<e.length&&(s=e.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?Lze(c[0].x):Mze(e):(e=c.length,function(u){for(var d=0,f;d<e;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function C1(t,e){var r=typeof e,n;return e==null||r==="boolean"?wM(e):(r==="number"?OI:r==="string"?(n=sw(e))?(e=n,hq):Uze:e instanceof sw?hq:e instanceof Date?Dze:Fze(e)?kze:Array.isArray(e)?Oze:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Rze:OI)(t,e)}function NM(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Qze(t,e){e===void 0&&(e=t,t=C1);for(var r=0,n=e.length-1,a=e[0],s=new Array(n<0?0:n);r<n;)s[r]=t(a,a=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function Vze(t){return function(){return t}}function DI(t){return+t}var Aq=[0,1];function Sc(t){return t}function iO(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Vze(isNaN(e)?NaN:.5)}function Hze(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function $ze(t,e,r){var n=t[0],a=t[1],s=e[0],o=e[1];return a<n?(n=iO(a,n),s=r(o,s)):(n=iO(n,a),s=r(s,o)),function(l){return s(n(l))}}function Kze(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=iO(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(l){var c=tN(t,l,1,n)-1;return s[c](a[c](l))}}function nN(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function JP(){var t=Aq,e=Aq,r=C1,n,a,s,o=Sc,l,c,u;function d(){var A=Math.min(t.length,e.length);return o!==Sc&&(o=Hze(t[0],t[A-1])),l=A>2?Kze:$ze,c=u=null,f}function f(A){return A==null||isNaN(A=+A)?s:(c||(c=l(t.map(n),e,r)))(n(o(A)))}return f.invert=function(A){return o(a((u||(u=l(e,t.map(n),OI)))(A)))},f.domain=function(A){return arguments.length?(t=Array.from(A,DI),d()):t.slice()},f.range=function(A){return arguments.length?(e=Array.from(A),d()):e.slice()},f.rangeRound=function(A){return e=Array.from(A),r=NM,d()},f.clamp=function(A){return arguments.length?(o=A?!0:Sc,d()):o!==Sc},f.interpolate=function(A){return arguments.length?(r=A,d()):r},f.unknown=function(A){return arguments.length?(s=A,f):s},function(A,h){return n=A,a=h,d()}}function CM(){return JP()(Sc,Sc)}function Gze(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function RI(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function zv(t){return t=RI(Math.abs(t)),t?t[1]:NaN}function qze(t,e){return function(r,n){for(var a=r.length,s=[],o=0,l=t[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return s.reverse().join(e)}}function zze(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var Wze=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function iw(t){if(!(e=Wze.exec(t)))throw new Error("invalid format: "+t);var e;return new _M({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}iw.prototype=_M.prototype;function _M(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}_M.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Xze(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var MI;function Yze(t,e){var r=RI(t,e);if(!r)return MI=void 0,t.toPrecision(e);var n=r[0],a=r[1],s=a-(MI=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+RI(t,Math.max(0,e+s-1))[0]}function mq(t,e){var r=RI(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const pq={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Gze,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>mq(t*100,e),r:mq,s:Yze,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function gq(t){return t}var xq=Array.prototype.map,vq=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Jze(t){var e=t.grouping===void 0||t.thousands===void 0?gq:qze(xq.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?gq:zze(xq.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f,A){f=iw(f);var h=f.fill,m=f.align,p=f.sign,x=f.symbol,v=f.zero,y=f.width,b=f.comma,w=f.precision,j=f.trim,I=f.type;I==="n"?(b=!0,I="g"):pq[I]||(w===void 0&&(w=12),j=!0,I="g"),(v||h==="0"&&m==="=")&&(v=!0,h="0",m="=");var _=(A&&A.prefix!==void 0?A.prefix:"")+(x==="$"?r:x==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():""),S=(x==="$"?n:/[%p]/.test(I)?o:"")+(A&&A.suffix!==void 0?A.suffix:""),E=pq[I],B=/[defgprs%]/.test(I);w=w===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function k(P){var O=_,z=S,oe,ce,ue;if(I==="c")z=E(P)+z,P="";else{P=+P;var ge=P<0||1/P<0;if(P=isNaN(P)?c:E(Math.abs(P),w),j&&(P=Xze(P)),ge&&+P==0&&p!=="+"&&(ge=!1),O=(ge?p==="("?p:l:p==="-"||p==="("?"":p)+O,z=(I==="s"&&!isNaN(P)&&MI!==void 0?vq[8+MI/3]:"")+z+(ge&&p==="("?")":""),B){for(oe=-1,ce=P.length;++oe<ce;)if(ue=P.charCodeAt(oe),48>ue||ue>57){z=(ue===46?a+P.slice(oe+1):P.slice(oe))+z,P=P.slice(0,oe);break}}}b&&!v&&(P=e(P,1/0));var ne=O.length+P.length+z.length,Oe=ne<y?new Array(y-ne+1).join(h):"";switch(b&&v&&(P=e(Oe+P,Oe.length?y-z.length:1/0),Oe=""),m){case"<":P=O+P+z+Oe;break;case"=":P=O+Oe+P+z;break;case"^":P=Oe.slice(0,ne=Oe.length>>1)+O+P+z+Oe.slice(ne);break;default:P=Oe+O+P+z;break}return s(P)}return k.toString=function(){return f+""},k}function d(f,A){var h=Math.max(-8,Math.min(8,Math.floor(zv(A)/3)))*3,m=Math.pow(10,-h),p=u((f=iw(f),f.type="f",f),{suffix:vq[8+h/3]});return function(x){return p(m*x)}}return{format:u,formatPrefix:d}}var S_,EM,ile;Zze({thousands:",",grouping:[3],currency:["$",""]});function Zze(t){return S_=Jze(t),EM=S_.format,ile=S_.formatPrefix,S_}function eWe(t){return Math.max(0,-zv(Math.abs(t)))}function tWe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(zv(e)/3)))*3-zv(Math.abs(t)))}function rWe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,zv(e)-zv(t))+1}function ole(t,e,r,n){var a=rO(t,e,r),s;switch(n=iw(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(s=tWe(a,o))&&(n.precision=s),ile(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=rWe(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=eWe(a))&&(n.precision=s-(n.type==="%")*2);break}}return EM(n)}function Hm(t){var e=t.domain;return t.ticks=function(r){var n=e();return eO(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return ole(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,s=n.length-1,o=n[a],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=a,a=s,s=u);d-- >0;){if(u=tO(o,l,r),u===c)return n[a]=o,n[s]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function lle(){var t=CM();return t.copy=function(){return nN(t,lle())},Vd.apply(t,arguments),Hm(t)}function cle(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,DI),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return cle(t).unknown(e)},t=arguments.length?Array.from(t,DI):[0,1],Hm(r)}function ule(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],s=t[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),t[r]=e.floor(a),t[n]=e.ceil(s),t}function yq(t){return Math.log(t)}function bq(t){return Math.exp(t)}function nWe(t){return-Math.log(-t)}function aWe(t){return-Math.exp(-t)}function sWe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function iWe(t){return t===10?sWe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function oWe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function wq(t){return(e,r)=>-t(-e,r)}function SM(t){const e=t(yq,bq),r=e.domain;let n=10,a,s;function o(){return a=oWe(n),s=iWe(n),r()[0]<0?(a=wq(a),s=wq(s),t(nWe,aWe)):t(yq,bq),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let A=a(u),h=a(d),m,p;const x=l==null?10:+l;let v=[];if(!(n%1)&&h-A<x){if(A=Math.floor(A),h=Math.ceil(h),u>0){for(;A<=h;++A)for(m=1;m<n;++m)if(p=A<0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}}else for(;A<=h;++A)for(m=n-1;m>=1;--m)if(p=A>0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}v.length*2<x&&(v=eO(u,d,x))}else v=eO(A,h,Math.min(h-A,x)).map(s);return f?v.reverse():v},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=iw(c)).precision==null&&(c.trim=!0),c=EM(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},e.nice=()=>r(ule(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),e}function dle(){const t=SM(JP()).domain([1,10]);return t.copy=()=>nN(t,dle()).base(t.base()),Vd.apply(t,arguments),t}function Nq(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Cq(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function IM(t){var e=1,r=t(Nq(e),Cq(e));return r.constant=function(n){return arguments.length?t(Nq(e=+n),Cq(e)):e},Hm(r)}function fle(){var t=IM(JP());return t.copy=function(){return nN(t,fle()).constant(t.constant())},Vd.apply(t,arguments)}function _q(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function lWe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function cWe(t){return t<0?-t*t:t*t}function jM(t){var e=t(Sc,Sc),r=1;function n(){return r===1?t(Sc,Sc):r===.5?t(lWe,cWe):t(_q(r),_q(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},Hm(e)}function PM(){var t=jM(JP());return t.copy=function(){return nN(t,PM()).exponent(t.exponent())},Vd.apply(t,arguments),t}function uWe(){return PM.apply(null,arguments).exponent(.5)}function Eq(t){return Math.sign(t)*t*t}function dWe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function hle(){var t=CM(),e=[0,1],r=!1,n;function a(s){var o=dWe(t(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return t.invert(Eq(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((e=Array.from(s,DI)).map(Eq)),a):e.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return hle(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Vd.apply(a,arguments),Hm(a)}function Ale(){var t=[],e=[],r=[],n;function a(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=mze(t,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:e[tN(r,o)]}return s.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(mm),a()},s.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return Ale().domain(t).range(e).unknown(n)},Vd.apply(s,arguments)}function mle(){var t=0,e=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[tN(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return mle().domain([t,e]).range(a).unknown(s)},Vd.apply(Hm(o),arguments)}function ple(){var t=[.5],e=[0,1],r,n=1;function a(s){return s!=null&&s<=s?e[tN(t,s,0,n)]:r}return a.domain=function(s){return arguments.length?(t=Array.from(s),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return ple().domain(t).range(e).unknown(r)},Vd.apply(a,arguments)}const wB=new Date,NB=new Date;function Mo(t,e,r,n){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),e(s,l),t(s);while(u<s&&s<o);return c},a.filter=s=>Mo(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!s(o););else for(;--l>=0;)for(;e(o,1),!s(o););}),r&&(a.count=(s,o)=>(wB.setTime(+s),NB.setTime(+o),t(wB),t(NB),Math.floor(r(wB,NB))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const LI=Mo(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);LI.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Mo(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):LI);LI.range;const Jh=1e3,Ed=Jh*60,Zh=Ed*60,CA=Zh*24,BM=CA*7,Sq=CA*30,CB=CA*365,Pp=Mo(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Jh)},(t,e)=>(e-t)/Jh,t=>t.getUTCSeconds());Pp.range;const TM=Mo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Jh)},(t,e)=>{t.setTime(+t+e*Ed)},(t,e)=>(e-t)/Ed,t=>t.getMinutes());TM.range;const kM=Mo(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Ed)},(t,e)=>(e-t)/Ed,t=>t.getUTCMinutes());kM.range;const FM=Mo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Jh-t.getMinutes()*Ed)},(t,e)=>{t.setTime(+t+e*Zh)},(t,e)=>(e-t)/Zh,t=>t.getHours());FM.range;const OM=Mo(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Zh)},(t,e)=>(e-t)/Zh,t=>t.getUTCHours());OM.range;const aN=Mo(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ed)/CA,t=>t.getDate()-1);aN.range;const ZP=Mo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/CA,t=>t.getUTCDate()-1);ZP.range;const gle=Mo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/CA,t=>Math.floor(t/CA));gle.range;function $g(t){return Mo(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Ed)/BM)}const e3=$g(0),UI=$g(1),fWe=$g(2),hWe=$g(3),Wv=$g(4),AWe=$g(5),mWe=$g(6);e3.range;UI.range;fWe.range;hWe.range;Wv.range;AWe.range;mWe.range;function Kg(t){return Mo(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/BM)}const t3=Kg(0),QI=Kg(1),pWe=Kg(2),gWe=Kg(3),Xv=Kg(4),xWe=Kg(5),vWe=Kg(6);t3.range;QI.range;pWe.range;gWe.range;Xv.range;xWe.range;vWe.range;const DM=Mo(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());DM.range;const RM=Mo(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());RM.range;const _A=Mo(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());_A.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mo(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});_A.range;const EA=Mo(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());EA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mo(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});EA.range;function xle(t,e,r,n,a,s){const o=[[Pp,1,Jh],[Pp,5,5*Jh],[Pp,15,15*Jh],[Pp,30,30*Jh],[s,1,Ed],[s,5,5*Ed],[s,15,15*Ed],[s,30,30*Ed],[a,1,Zh],[a,3,3*Zh],[a,6,6*Zh],[a,12,12*Zh],[n,1,CA],[n,2,2*CA],[r,1,BM],[e,1,Sq],[e,3,3*Sq],[t,1,CB]];function l(u,d,f){const A=d<u;A&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),m=h?h.range(u,+d+1):[];return A?m.reverse():m}function c(u,d,f){const A=Math.abs(d-u)/f,h=xM(([,,x])=>x).right(o,A);if(h===o.length)return t.every(rO(u/CB,d/CB,f));if(h===0)return LI.every(Math.max(rO(u,d,f),1));const[m,p]=o[A/o[h-1][2]<o[h][2]/A?h-1:h];return m.every(p)}return[l,c]}const[yWe,bWe]=xle(EA,RM,t3,gle,OM,kM),[wWe,NWe]=xle(_A,DM,e3,aN,FM,TM);function _B(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function EB(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Sy(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function CWe(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,s=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=Iy(a),d=jy(a),f=Iy(s),A=jy(s),h=Iy(o),m=jy(o),p=Iy(l),x=jy(l),v=Iy(c),y=jy(c),b={a:ue,A:ge,b:ne,B:Oe,c:null,d:kq,e:kq,f:qWe,g:nXe,G:sXe,H:$We,I:KWe,j:GWe,L:vle,m:zWe,M:WWe,p:Ue,q:F,Q:Dq,s:Rq,S:XWe,u:YWe,U:JWe,V:ZWe,w:eXe,W:tXe,x:null,X:null,y:rXe,Y:aXe,Z:iXe,"%":Oq},w={a:H,A:K,b:U,B:W,c:null,d:Fq,e:Fq,f:uXe,g:yXe,G:wXe,H:oXe,I:lXe,j:cXe,L:ble,m:dXe,M:fXe,p:X,q:D,Q:Dq,s:Rq,S:hXe,u:AXe,U:mXe,V:pXe,w:gXe,W:xXe,x:null,X:null,y:vXe,Y:bXe,Z:NXe,"%":Oq},j={a:B,A:k,b:P,B:O,c:z,d:Bq,e:Bq,f:UWe,g:Pq,G:jq,H:Tq,I:Tq,j:DWe,L:LWe,m:OWe,M:RWe,p:E,q:FWe,Q:VWe,s:HWe,S:MWe,u:jWe,U:PWe,V:BWe,w:IWe,W:TWe,x:oe,X:ce,y:Pq,Y:jq,Z:kWe,"%":QWe};b.x=I(r,b),b.X=I(n,b),b.c=I(e,b),w.x=I(r,w),w.X=I(n,w),w.c=I(e,w);function I(V,Z){return function(be){var L=[],Xe=-1,re=0,J=V.length,De,ie,He;for(be instanceof Date||(be=new Date(+be));++Xe<J;)V.charCodeAt(Xe)===37&&(L.push(V.slice(re,Xe)),(ie=Iq[De=V.charAt(++Xe)])!=null?De=V.charAt(++Xe):ie=De==="e"?" ":"0",(He=Z[De])&&(De=He(be,ie)),L.push(De),re=Xe+1);return L.push(V.slice(re,Xe)),L.join("")}}function _(V,Z){return function(be){var L=Sy(1900,void 0,1),Xe=S(L,V,be+="",0),re,J;if(Xe!=be.length)return null;if("Q"in L)return new Date(L.Q);if("s"in L)return new Date(L.s*1e3+("L"in L?L.L:0));if(Z&&!("Z"in L)&&(L.Z=0),"p"in L&&(L.H=L.H%12+L.p*12),L.m===void 0&&(L.m="q"in L?L.q:0),"V"in L){if(L.V<1||L.V>53)return null;"w"in L||(L.w=1),"Z"in L?(re=EB(Sy(L.y,0,1)),J=re.getUTCDay(),re=J>4||J===0?QI.ceil(re):QI(re),re=ZP.offset(re,(L.V-1)*7),L.y=re.getUTCFullYear(),L.m=re.getUTCMonth(),L.d=re.getUTCDate()+(L.w+6)%7):(re=_B(Sy(L.y,0,1)),J=re.getDay(),re=J>4||J===0?UI.ceil(re):UI(re),re=aN.offset(re,(L.V-1)*7),L.y=re.getFullYear(),L.m=re.getMonth(),L.d=re.getDate()+(L.w+6)%7)}else("W"in L||"U"in L)&&("w"in L||(L.w="u"in L?L.u%7:"W"in L?1:0),J="Z"in L?EB(Sy(L.y,0,1)).getUTCDay():_B(Sy(L.y,0,1)).getDay(),L.m=0,L.d="W"in L?(L.w+6)%7+L.W*7-(J+5)%7:L.w+L.U*7-(J+6)%7);return"Z"in L?(L.H+=L.Z/100|0,L.M+=L.Z%100,EB(L)):_B(L)}}function S(V,Z,be,L){for(var Xe=0,re=Z.length,J=be.length,De,ie;Xe<re;){if(L>=J)return-1;if(De=Z.charCodeAt(Xe++),De===37){if(De=Z.charAt(Xe++),ie=j[De in Iq?Z.charAt(Xe++):De],!ie||(L=ie(V,be,L))<0)return-1}else if(De!=be.charCodeAt(L++))return-1}return L}function E(V,Z,be){var L=u.exec(Z.slice(be));return L?(V.p=d.get(L[0].toLowerCase()),be+L[0].length):-1}function B(V,Z,be){var L=h.exec(Z.slice(be));return L?(V.w=m.get(L[0].toLowerCase()),be+L[0].length):-1}function k(V,Z,be){var L=f.exec(Z.slice(be));return L?(V.w=A.get(L[0].toLowerCase()),be+L[0].length):-1}function P(V,Z,be){var L=v.exec(Z.slice(be));return L?(V.m=y.get(L[0].toLowerCase()),be+L[0].length):-1}function O(V,Z,be){var L=p.exec(Z.slice(be));return L?(V.m=x.get(L[0].toLowerCase()),be+L[0].length):-1}function z(V,Z,be){return S(V,e,Z,be)}function oe(V,Z,be){return S(V,r,Z,be)}function ce(V,Z,be){return S(V,n,Z,be)}function ue(V){return o[V.getDay()]}function ge(V){return s[V.getDay()]}function ne(V){return c[V.getMonth()]}function Oe(V){return l[V.getMonth()]}function Ue(V){return a[+(V.getHours()>=12)]}function F(V){return 1+~~(V.getMonth()/3)}function H(V){return o[V.getUTCDay()]}function K(V){return s[V.getUTCDay()]}function U(V){return c[V.getUTCMonth()]}function W(V){return l[V.getUTCMonth()]}function X(V){return a[+(V.getUTCHours()>=12)]}function D(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var Z=I(V+="",b);return Z.toString=function(){return V},Z},parse:function(V){var Z=_(V+="",!1);return Z.toString=function(){return V},Z},utcFormat:function(V){var Z=I(V+="",w);return Z.toString=function(){return V},Z},utcParse:function(V){var Z=_(V+="",!0);return Z.toString=function(){return V},Z}}}var Iq={"-":"",_:" ",0:"0"},il=/^\s*\d+/,_We=/^%/,EWe=/[\\^$*+?|[\]().{}]/g;function Ba(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(e)+a:a)}function SWe(t){return t.replace(EWe,"\\$&")}function Iy(t){return new RegExp("^(?:"+t.map(SWe).join("|")+")","i")}function jy(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function IWe(t,e,r){var n=il.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function jWe(t,e,r){var n=il.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function PWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function BWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function TWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function jq(t,e,r){var n=il.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Pq(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function kWe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function FWe(t,e,r){var n=il.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function OWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Bq(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function DWe(t,e,r){var n=il.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Tq(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function RWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function MWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function LWe(t,e,r){var n=il.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function UWe(t,e,r){var n=il.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function QWe(t,e,r){var n=_We.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function VWe(t,e,r){var n=il.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function HWe(t,e,r){var n=il.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function kq(t,e){return Ba(t.getDate(),e,2)}function $We(t,e){return Ba(t.getHours(),e,2)}function KWe(t,e){return Ba(t.getHours()%12||12,e,2)}function GWe(t,e){return Ba(1+aN.count(_A(t),t),e,3)}function vle(t,e){return Ba(t.getMilliseconds(),e,3)}function qWe(t,e){return vle(t,e)+"000"}function zWe(t,e){return Ba(t.getMonth()+1,e,2)}function WWe(t,e){return Ba(t.getMinutes(),e,2)}function XWe(t,e){return Ba(t.getSeconds(),e,2)}function YWe(t){var e=t.getDay();return e===0?7:e}function JWe(t,e){return Ba(e3.count(_A(t)-1,t),e,2)}function yle(t){var e=t.getDay();return e>=4||e===0?Wv(t):Wv.ceil(t)}function ZWe(t,e){return t=yle(t),Ba(Wv.count(_A(t),t)+(_A(t).getDay()===4),e,2)}function eXe(t){return t.getDay()}function tXe(t,e){return Ba(UI.count(_A(t)-1,t),e,2)}function rXe(t,e){return Ba(t.getFullYear()%100,e,2)}function nXe(t,e){return t=yle(t),Ba(t.getFullYear()%100,e,2)}function aXe(t,e){return Ba(t.getFullYear()%1e4,e,4)}function sXe(t,e){var r=t.getDay();return t=r>=4||r===0?Wv(t):Wv.ceil(t),Ba(t.getFullYear()%1e4,e,4)}function iXe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ba(e/60|0,"0",2)+Ba(e%60,"0",2)}function Fq(t,e){return Ba(t.getUTCDate(),e,2)}function oXe(t,e){return Ba(t.getUTCHours(),e,2)}function lXe(t,e){return Ba(t.getUTCHours()%12||12,e,2)}function cXe(t,e){return Ba(1+ZP.count(EA(t),t),e,3)}function ble(t,e){return Ba(t.getUTCMilliseconds(),e,3)}function uXe(t,e){return ble(t,e)+"000"}function dXe(t,e){return Ba(t.getUTCMonth()+1,e,2)}function fXe(t,e){return Ba(t.getUTCMinutes(),e,2)}function hXe(t,e){return Ba(t.getUTCSeconds(),e,2)}function AXe(t){var e=t.getUTCDay();return e===0?7:e}function mXe(t,e){return Ba(t3.count(EA(t)-1,t),e,2)}function wle(t){var e=t.getUTCDay();return e>=4||e===0?Xv(t):Xv.ceil(t)}function pXe(t,e){return t=wle(t),Ba(Xv.count(EA(t),t)+(EA(t).getUTCDay()===4),e,2)}function gXe(t){return t.getUTCDay()}function xXe(t,e){return Ba(QI.count(EA(t)-1,t),e,2)}function vXe(t,e){return Ba(t.getUTCFullYear()%100,e,2)}function yXe(t,e){return t=wle(t),Ba(t.getUTCFullYear()%100,e,2)}function bXe(t,e){return Ba(t.getUTCFullYear()%1e4,e,4)}function wXe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Xv(t):Xv.ceil(t),Ba(t.getUTCFullYear()%1e4,e,4)}function NXe(){return"+0000"}function Oq(){return"%"}function Dq(t){return+t}function Rq(t){return Math.floor(+t/1e3)}var yx,Nle,Cle;CXe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function CXe(t){return yx=CWe(t),Nle=yx.format,yx.parse,Cle=yx.utcFormat,yx.utcParse,yx}function _Xe(t){return new Date(t)}function EXe(t){return t instanceof Date?+t:+new Date(+t)}function MM(t,e,r,n,a,s,o,l,c,u){var d=CM(),f=d.invert,A=d.domain,h=u(".%L"),m=u(":%S"),p=u("%I:%M"),x=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),w=u("%Y");function j(I){return(c(I)<I?h:l(I)<I?m:o(I)<I?p:s(I)<I?x:n(I)<I?a(I)<I?v:y:r(I)<I?b:w)(I)}return d.invert=function(I){return new Date(f(I))},d.domain=function(I){return arguments.length?A(Array.from(I,EXe)):A().map(_Xe)},d.ticks=function(I){var _=A();return t(_[0],_[_.length-1],I??10)},d.tickFormat=function(I,_){return _==null?j:u(_)},d.nice=function(I){var _=A();return(!I||typeof I.range!="function")&&(I=e(_[0],_[_.length-1],I??10)),I?A(ule(_,I)):d},d.copy=function(){return nN(d,MM(t,e,r,n,a,s,o,l,c,u))},d}function SXe(){return Vd.apply(MM(wWe,NWe,_A,DM,e3,aN,FM,TM,Pp,Nle).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IXe(){return Vd.apply(MM(yWe,bWe,EA,RM,t3,ZP,OM,kM,Pp,Cle).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function r3(){var t=0,e=1,r,n,a,s,o=Sc,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,r=s(t=+t),n=s(e=+e),a=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(A){var h,m;return arguments.length?([h,m]=A,o=f(h,m),u):[o(0),o(1)]}}return u.range=d(C1),u.rangeRound=d(NM),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(t),n=f(e),a=r===n?0:1/(n-r),u}}function $m(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function _le(){var t=Hm(r3()(Sc));return t.copy=function(){return $m(t,_le())},QA.apply(t,arguments)}function Ele(){var t=SM(r3()).domain([1,10]);return t.copy=function(){return $m(t,Ele()).base(t.base())},QA.apply(t,arguments)}function Sle(){var t=IM(r3());return t.copy=function(){return $m(t,Sle()).constant(t.constant())},QA.apply(t,arguments)}function LM(){var t=jM(r3());return t.copy=function(){return $m(t,LM()).exponent(t.exponent())},QA.apply(t,arguments)}function jXe(){return LM.apply(null,arguments).exponent(.5)}function Ile(){var t=[],e=Sc;function r(n){if(n!=null&&!isNaN(n=+n))return e((tN(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(mm),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>Aze(t,s/n))},r.copy=function(){return Ile(e).domain(t)},QA.apply(r,arguments)}function n3(){var t=0,e=.5,r=1,n=1,a,s,o,l,c,u=Sc,d,f=!1,A;function h(p){return isNaN(p=+p)?A:(p=.5+((p=+d(p))-s)*(n*p<n*s?l:c),u(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([t,e,r]=p,a=d(t=+t),s=d(e=+e),o=d(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h):[t,e,r]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(u=p,h):u};function m(p){return function(x){var v,y,b;return arguments.length?([v,y,b]=x,u=Qze(p,[v,y,b]),h):[u(0),u(.5),u(1)]}}return h.range=m(C1),h.rangeRound=m(NM),h.unknown=function(p){return arguments.length?(A=p,h):A},function(p){return d=p,a=p(t),s=p(e),o=p(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h}}function jle(){var t=Hm(n3()(Sc));return t.copy=function(){return $m(t,jle())},QA.apply(t,arguments)}function Ple(){var t=SM(n3()).domain([.1,1,10]);return t.copy=function(){return $m(t,Ple()).base(t.base())},QA.apply(t,arguments)}function Ble(){var t=IM(n3());return t.copy=function(){return $m(t,Ble()).constant(t.constant())},QA.apply(t,arguments)}function UM(){var t=jM(n3());return t.copy=function(){return $m(t,UM()).exponent(t.exponent())},QA.apply(t,arguments)}function PXe(){return UM.apply(null,arguments).exponent(.5)}const rb=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:yM,scaleDiverging:jle,scaleDivergingLog:Ple,scaleDivergingPow:UM,scaleDivergingSqrt:PXe,scaleDivergingSymlog:Ble,scaleIdentity:cle,scaleImplicit:nO,scaleLinear:lle,scaleLog:dle,scaleOrdinal:vM,scalePoint:gze,scalePow:PM,scaleQuantile:Ale,scaleQuantize:mle,scaleRadial:hle,scaleSequential:_le,scaleSequentialLog:Ele,scaleSequentialPow:LM,scaleSequentialQuantile:Ile,scaleSequentialSqrt:jXe,scaleSequentialSymlog:Sle,scaleSqrt:uWe,scaleSymlog:fle,scaleThreshold:ple,scaleTime:SXe,scaleUtc:IXe,tickFormat:ole},Symbol.toStringTag,{value:"Module"}));var VA=t=>t.chartData,a3=tr([VA],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),Tle=(t,e,r,n)=>n?a3(t):VA(t),BXe=(t,e,r)=>r?a3(t):VA(t);function Tm(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(Ai(e)&&Ai(r))return!0}return!1}function Mq(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function kle(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,s;if(Ai(r))a=r;else if(typeof r=="function")return;if(Ai(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(Tm(o))return o}}function TXe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Tm(n))return Mq(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,s]=t,o,l;if(a==="auto")e!=null&&(o=Math.min(...e));else if(_n(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e==null?void 0:e[0]))}catch{}else if(typeof a=="string"&&tG.test(a)){var c=tG.exec(a);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e==null?void 0:e[0];if(s==="auto")e!=null&&(l=Math.max(...e));else if(_n(s))l=s;else if(typeof s=="function")try{e!=null&&(l=s(e==null?void 0:e[1]))}catch{}else if(typeof s=="string"&&rG.test(s)){var d=rG.exec(s);if(d==null||d[1]==null||e==null)l=void 0;else{var f=+d[1];l=e[1]+f}}else l=e==null?void 0:e[1];var A=[o,l];if(Tm(A))return e==null?A:Mq(A,e,r)}}}var _1=1e9,kXe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},VM,Gs=!0,Md="[DecimalError] ",qp=Md+"Invalid argument: ",QM=Md+"Exponent out of range: ",E1=Math.floor,hp=Math.pow,FXe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Tu,Xo=1e7,js=7,Fle=9007199254740991,VI=E1(Fle/js),ln={};ln.absoluteValue=ln.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};ln.comparedTo=ln.cmp=function(t){var e,r,n,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(n=s.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};ln.decimalPlaces=ln.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*js;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};ln.dividedBy=ln.div=function(t){return uA(this,new this.constructor(t))};ln.dividedToIntegerBy=ln.idiv=function(t){var e=this,r=e.constructor;return ms(uA(e,new r(t),0,1),r.precision)};ln.equals=ln.eq=function(t){return!this.cmp(t)};ln.exponent=function(){return co(this)};ln.greaterThan=ln.gt=function(t){return this.cmp(t)>0};ln.greaterThanOrEqualTo=ln.gte=function(t){return this.cmp(t)>=0};ln.isInteger=ln.isint=function(){return this.e>this.d.length-2};ln.isNegative=ln.isneg=function(){return this.s<0};ln.isPositive=ln.ispos=function(){return this.s>0};ln.isZero=function(){return this.s===0};ln.lessThan=ln.lt=function(t){return this.cmp(t)<0};ln.lessThanOrEqualTo=ln.lte=function(t){return this.cmp(t)<1};ln.logarithm=ln.log=function(t){var e,r=this,n=r.constructor,a=n.precision,s=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Tu))throw Error(Md+"NaN");if(r.s<1)throw Error(Md+(r.s?"NaN":"-Infinity"));return r.eq(Tu)?new n(0):(Gs=!1,e=uA(ow(r,s),ow(t,s),s),Gs=!0,ms(e,a))};ln.minus=ln.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Rle(e,t):Ole(e,(t.s=-t.s,t))};ln.modulo=ln.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(Md+"NaN");return r.s?(Gs=!1,e=uA(r,t,0,1).times(t),Gs=!0,r.minus(e)):ms(new n(r),a)};ln.naturalExponential=ln.exp=function(){return Dle(this)};ln.naturalLogarithm=ln.ln=function(){return ow(this)};ln.negated=ln.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};ln.plus=ln.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Ole(e,t):Rle(e,(t.s=-t.s,t))};ln.precision=ln.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(qp+t);if(e=co(a)+1,n=a.d.length-1,r=n*js+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};ln.squareRoot=ln.sqrt=function(){var t,e,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Md+"NaN")}for(t=co(l),Gs=!1,a=Math.sqrt(+l),a==0||a==1/0?(e=th(l.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=E1((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(uA(l,s,o+2)).times(.5),th(s.d).slice(0,o)===(e=th(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(ms(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(e!="9999")break;o+=4}return Gs=!0,ms(n,r)};ln.times=ln.mul=function(t){var e,r,n,a,s,o,l,c,u,d=this,f=d.constructor,A=d.d,h=(t=new f(t)).d;if(!d.s||!t.s)return new f(0);for(t.s*=d.s,r=d.e+t.e,c=A.length,u=h.length,c<u&&(s=A,A=h,h=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(e=0,a=c+n;a>n;)l=s[a]+h[n]*A[a-n-1]+e,s[a--]=l%Xo|0,e=l/Xo|0;s[a]=(s[a]+e)%Xo|0}for(;!s[--o];)s.pop();return e?++r:s.shift(),t.d=s,t.e=r,Gs?ms(t,f.precision):t};ln.toDecimalPlaces=ln.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(fh(t,0,_1),e===void 0?e=n.rounding:fh(e,0,8),ms(r,t+co(r)+1,e))};ln.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=Ng(n,!0):(fh(t,0,_1),e===void 0?e=a.rounding:fh(e,0,8),n=ms(new a(n),t+1,e),r=Ng(n,!0,t+1)),r};ln.toFixed=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?Ng(a):(fh(t,0,_1),e===void 0?e=s.rounding:fh(e,0,8),n=ms(new s(a),t+co(a)+1,e),r=Ng(n.abs(),!1,t+co(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ln.toInteger=ln.toint=function(){var t=this,e=t.constructor;return ms(new e(t),co(t)+1,e.rounding)};ln.toNumber=function(){return+this};ln.toPower=ln.pow=function(t){var e,r,n,a,s,o,l=this,c=l.constructor,u=12,d=+(t=new c(t));if(!t.s)return new c(Tu);if(l=new c(l),!l.s){if(t.s<1)throw Error(Md+"Infinity");return l}if(l.eq(Tu))return l;if(n=c.precision,t.eq(Tu))return ms(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,s=l.s,o){if((r=d<0?-d:d)<=Fle){for(a=new c(Tu),e=Math.ceil(n/js+4),Gs=!1;r%2&&(a=a.times(l),Uq(a.d,e)),r=E1(r/2),r!==0;)l=l.times(l),Uq(l.d,e);return Gs=!0,t.s<0?new c(Tu).div(a):ms(a,n)}}else if(s<0)throw Error(Md+"NaN");return s=s<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,Gs=!1,a=t.times(ow(l,n+u)),Gs=!0,a=Dle(a),a.s=s,a};ln.toPrecision=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?(r=co(a),n=Ng(a,r<=s.toExpNeg||r>=s.toExpPos)):(fh(t,1,_1),e===void 0?e=s.rounding:fh(e,0,8),a=ms(new s(a),t,e),r=co(a),n=Ng(a,t<=r||r<=s.toExpNeg,t)),n};ln.toSignificantDigits=ln.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(fh(t,1,_1),e===void 0?e=n.rounding:fh(e,0,8)),ms(new n(r),t,e)};ln.toString=ln.valueOf=ln.val=ln.toJSON=ln[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=co(t),r=t.constructor;return Ng(t,e<=r.toExpNeg||e>=r.toExpPos)};function Ole(t,e){var r,n,a,s,o,l,c,u,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),Gs?ms(e,f):e;if(c=t.d,u=e.d,o=t.e,a=e.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,a=o,l=c.length),o=Math.ceil(f/js),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Xo|0,c[s]%=Xo;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=a,Gs?ms(e,f):e}function fh(t,e,r){if(t!==~~t||t<e||t>r)throw Error(qp+t)}function th(t){var e,r,n,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,e=1;e<a;e++)n=t[e]+"",r=js-n.length,r&&(s+=j0(r)),s+=n;o=t[e],n=o+"",r=js-n.length,r&&(s+=j0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var uA=function(){function t(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%Xo|0,o=s/Xo|0;return o&&n.unshift(o),n}function e(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*Xo+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,_,S,E=n.constructor,B=n.s==a.s?1:-1,k=n.d,P=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(Md+"Division by zero");for(c=n.e-a.e,_=P.length,j=k.length,h=new E(B),m=h.d=[],u=0;P[u]==(k[u]||0);)++u;if(P[u]>(k[u]||0)&&--c,s==null?y=s=E.precision:o?y=s+(co(n)-co(a))+1:y=s,y<0)return new E(0);if(y=y/js+2|0,u=0,_==1)for(d=0,P=P[0],y++;(u<j||d)&&y--;u++)b=d*Xo+(k[u]||0),m[u]=b/P|0,d=b%P|0;else{for(d=Xo/(P[0]+1)|0,d>1&&(P=t(P,d),k=t(k,d),_=P.length,j=k.length),w=_,p=k.slice(0,_),x=p.length;x<_;)p[x++]=0;S=P.slice(),S.unshift(0),I=P[0],P[1]>=Xo/2&&++I;do d=0,l=e(P,p,_,x),l<0?(v=p[0],_!=x&&(v=v*Xo+(p[1]||0)),d=v/I|0,d>1?(d>=Xo&&(d=Xo-1),f=t(P,d),A=f.length,x=p.length,l=e(f,p,A,x),l==1&&(d--,r(f,_<A?S:P,A))):(d==0&&(l=d=1),f=P.slice()),A=f.length,A<x&&f.unshift(0),r(p,f,x),l==-1&&(x=p.length,l=e(P,p,_,x),l<1&&(d++,r(p,_<x?S:P,x))),x=p.length):l===0&&(d++,p=[0]),m[u++]=d,l&&p[0]?p[x++]=k[w]||0:(p=[k[w]],x=1);while((w++<j||p[0]!==void 0)&&y--)}return m[0]||m.shift(),h.e=c,ms(h,o?s+co(h)+1:s)}}();function Dle(t,e){var r,n,a,s,o,l,c=0,u=0,d=t.constructor,f=d.precision;if(co(t)>16)throw Error(QM+co(t));if(!t.s)return new d(Tu);for(Gs=!1,l=f,o=new d(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(hp(2,u))/Math.LN10*2+5|0,l+=n,r=a=s=new d(Tu),d.precision=l;;){if(a=ms(a.times(t),l),r=r.times(++c),o=s.plus(uA(a,r,l)),th(o.d).slice(0,l)===th(s.d).slice(0,l)){for(;u--;)s=ms(s.times(s),l);return d.precision=f,e==null?(Gs=!0,ms(s,f)):s}s=o}}function co(t){for(var e=t.e*js,r=t.d[0];r>=10;r/=10)e++;return e}function SB(t,e,r){if(e>t.LN10.sd())throw Gs=!0,r&&(t.precision=r),Error(Md+"LN10 precision limit exceeded");return ms(new t(t.LN10),e)}function j0(t){for(var e="";t--;)e+="0";return e}function ow(t,e){var r,n,a,s,o,l,c,u,d,f=1,A=10,h=t,m=h.d,p=h.constructor,x=p.precision;if(h.s<1)throw Error(Md+(h.s?"NaN":"-Infinity"));if(h.eq(Tu))return new p(0);if(e==null?(Gs=!1,u=x):u=e,h.eq(10))return e==null&&(Gs=!0),SB(p,u);if(u+=A,p.precision=u,r=th(m),n=r.charAt(0),s=co(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(t),r=th(h.d),n=r.charAt(0),f++;s=co(h),n>1?(h=new p("0."+r),s++):h=new p(n+"."+r.slice(1))}else return c=SB(p,u+2,x).times(s+""),h=ow(new p(n+"."+r.slice(1)),u-A).plus(c),p.precision=x,e==null?(Gs=!0,ms(h,x)):h;for(l=o=h=uA(h.minus(Tu),h.plus(Tu),u),d=ms(h.times(h),u),a=3;;){if(o=ms(o.times(d),u),c=l.plus(uA(o,new p(a),u)),th(c.d).slice(0,u)===th(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(SB(p,u+2,x).times(s+""))),l=uA(l,new p(f),u),p.precision=x,e==null?(Gs=!0,ms(l,x)):l;l=c,a+=2}}function Lq(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=E1(r/js),t.d=[],n=(r+1)%js,r<0&&(n+=js),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=js;n<a;)t.d.push(+e.slice(n,n+=js));e=e.slice(n),n=js-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),Gs&&(t.e>VI||t.e<-VI))throw Error(QM+r)}else t.s=0,t.e=0,t.d=[0];return t}function ms(t,e,r){var n,a,s,o,l,c,u,d,f=t.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=e-o,n<0)n+=js,a=e,u=f[d=0];else{if(d=Math.ceil((n+1)/js),s=f.length,d>=s)return t;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=js,a=n-js+o}if(r!==void 0&&(s=hp(10,o-a-1),l=u/s%10|0,c=e<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/hp(10,o-a):0:f[d-1])%10&1||r==(t.s<0?8:7))),e<1||!f[0])return c?(s=co(t),f.length=1,e=e-s-1,f[0]=hp(10,(js-e%js)%js),t.e=E1(-e/js)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=hp(10,js-n),f[d]=a>0?(u/hp(10,o-a)%hp(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Xo&&(f[0]=1,++t.e);break}else{if(f[d]+=s,f[d]!=Xo)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(Gs&&(t.e>VI||t.e<-VI))throw Error(QM+co(t));return t}function Rle(t,e){var r,n,a,s,o,l,c,u,d,f,A=t.constructor,h=A.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new A(t),Gs?ms(e,h):e;if(c=t.d,f=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(h/js),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}o=0}for(d&&(r=c,c=f,f=r,e.s=-e.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Xo-1;--c[s],c[a]+=Xo}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Gs?ms(e,h):e):new A(0)}function Ng(t,e,r){var n,a=co(t),s=th(t.d),o=s.length;return e?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+j0(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+j0(-a-1)+s,r&&(n=r-o)>0&&(s+=j0(n))):a>=o?(s+=j0(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+j0(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=j0(n))),t.s<0?"-"+s:s}function Uq(t,e){if(t.length>e)return t.length=e,!0}function Mle(t){var e,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(qp+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Lq(o,s.toString())}else if(typeof s!="string")throw Error(qp+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,FXe.test(s))Lq(o,s);else throw Error(qp+s)}if(a.prototype=ln,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Mle,a.config=a.set=OXe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function OXe(t){if(!t||typeof t!="object")throw Error(Md+"Object expected");var e,r,n,a=["precision",1,_1,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(E1(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(qp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(qp+r+": "+n);return this}var VM=Mle(kXe);Tu=new VM(1);const Za=VM;var DXe=t=>t,Lle={},Ule=t=>t===Lle,Qq=t=>function e(){return arguments.length===0||arguments.length===1&&Ule(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},Qle=(t,e)=>t===1?e:Qq(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(o=>o!==Lle).length;return s>=t?e(...n):Qle(t-s,Qq(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=n.map(d=>Ule(d)?l.shift():d);return e(...u,...l)}))}),RXe=t=>Qle(t.length,t),oO=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},MXe=RXe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),LXe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return DXe;var a=r.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}};function Vle(t){var e;return t===0?e=1:e=Math.floor(new Za(t).abs().log(10).toNumber())+1,e}function Hle(t,e,r){for(var n=new Za(t),a=0,s=[];n.lt(e)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var $le=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},Kle=(t,e,r)=>{if(t.lte(0))return new Za(0);var n=Vle(t.toNumber()),a=new Za(10).pow(n),s=t.div(a),o=n!==1?.05:.1,l=new Za(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return e?new Za(c.toNumber()):new Za(Math.ceil(c.toNumber()))},UXe=(t,e,r)=>{var n=new Za(1),a=new Za(t);if(!a.isint()&&r){var s=Math.abs(t);s<1?(n=new Za(10).pow(Vle(t)-1),a=new Za(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new Za(Math.floor(t)))}else t===0?a=new Za(Math.floor((e-1)/2)):r||(a=new Za(Math.floor(t)));var o=Math.floor((e-1)/2),l=LXe(MXe(c=>a.add(new Za(c-o).mul(n)).toNumber()),oO);return l(0,e)},Gle=function(e,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new Za(0),tickMin:new Za(0),tickMax:new Za(0)};var o=Kle(new Za(r).sub(e).div(n-1),a,s),l;e<=0&&r>=0?l=new Za(0):(l=new Za(e).add(r).div(2),l=l.sub(new Za(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new Za(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?Gle(e,r,n,a,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new Za(c).mul(o)),tickMax:l.add(new Za(u).mul(o))})},QXe=function(e){var[r,n]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=$le([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...oO(0,a-1).map(()=>1/0)]:[...oO(0,a-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(l===c)return UXe(l,a,s);var{step:d,tickMin:f,tickMax:A}=Gle(l,c,o,s,0),h=Hle(f,A.add(new Za(.1).mul(d)),d);return r>n?h.reverse():h},VXe=function(e,r){var[n,a]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=$le([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),u=Kle(new Za(l).sub(o).div(c-1),s,0),d=[...Hle(new Za(o),new Za(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},qle=t=>t.rootProps.maxBarSize,HXe=t=>t.rootProps.barGap,zle=t=>t.rootProps.barCategoryGap,$Xe=t=>t.rootProps.barSize,sN=t=>t.rootProps.stackOffset,Wle=t=>t.rootProps.reverseStackOrder,HM=t=>t.options.chartName,$M=t=>t.rootProps.syncId,Xle=t=>t.rootProps.syncMethod,KM=t=>t.options.eventEmitter,ac={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Vh={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Su={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},s3=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},KXe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Vh.angleAxisId,includeHidden:!1,name:void 0,reversed:Vh.reversed,scale:Vh.scale,tick:Vh.tick,tickCount:void 0,ticks:void 0,type:Vh.type,unit:void 0},GXe={allowDataOverflow:Su.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Su.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Su.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Su.scale,tick:Su.tick,tickCount:Su.tickCount,ticks:void 0,type:Su.type,unit:void 0},qXe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Vh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Vh.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Vh.scale,tick:Vh.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},zXe={allowDataOverflow:Su.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Su.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Su.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Su.scale,tick:Su.tick,tickCount:Su.tickCount,ticks:void 0,type:"category",unit:void 0},GM=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?qXe:KXe,qM=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?zXe:GXe,i3=t=>t.polarOptions,zM=tr([LA,UA,Ro],Koe),Yle=tr([i3,zM],(t,e)=>{if(t!=null)return ic(t.innerRadius,e,0)}),Jle=tr([i3,zM],(t,e)=>{if(t!=null)return ic(t.outerRadius,e,e*.8)}),WXe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},Zle=tr([i3],WXe);tr([GM,Zle],s3);var ece=tr([zM,Yle,Jle],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});tr([qM,ece],s3);var tce=tr([Ta,i3,Yle,Jle,LA,UA],(t,e,r,n,a,s)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:ic(o,a,a/2),cy:ic(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Xs=(t,e)=>e,iN=(t,e,r)=>r;function WM(t){return t==null?void 0:t.id}function rce(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=WM(l);u.forEach((f,A)=>{var h=s==null||a?A:String(ks(f,s,null)),m=ks(f,l.dataKey,0),p;o.has(h)?p=o.get(h):p={},Object.assign(p,{[d]:m}),o.set(h,p)})}}),Array.from(o.values())}function o3(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var l3=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function c3(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function XXe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Lo=t=>{var e=Ta(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},S1=t=>t.tooltip.settings.axisId;function Vq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function HI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vq(Object(r),!0).forEach(function(n){YXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YXe(t,e,r){return(e=JXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JXe(t){var e=ZXe(t,"string");return typeof e=="symbol"?e:e+""}function ZXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lO=[0,"auto"],Ko={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},nce=(t,e)=>t.cartesianAxis.xAxis[e],HA=(t,e)=>{var r=nce(t,e);return r??Ko},Go={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:lO,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Jw},ace=(t,e)=>t.cartesianAxis.yAxis[e],$A=(t,e)=>{var r=ace(t,e);return r??Go},eYe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},XM=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??eYe},mi=(t,e,r)=>{switch(e){case"xAxis":return HA(t,r);case"yAxis":return $A(t,r);case"zAxis":return XM(t,r);case"angleAxis":return GM(t,r);case"radiusAxis":return qM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},tYe=(t,e,r)=>{switch(e){case"xAxis":return HA(t,r);case"yAxis":return $A(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},oN=(t,e,r)=>{switch(e){case"xAxis":return HA(t,r);case"yAxis":return $A(t,r);case"angleAxis":return GM(t,r);case"radiusAxis":return qM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},sce=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function YM(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var JM=t=>t.graphicalItems.cartesianItems,rYe=tr([Xs,iN],YM),ZM=(t,e,r)=>t.filter(r).filter(n=>(e==null?void 0:e.includeHidden)===!0?!0:!n.hide),lN=tr([JM,mi,rYe],ZM,{memoizeOptions:{resultEqualityCheck:c3}}),ice=tr([lN],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(o3)),oce=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),nYe=tr([lN],oce),e8=t=>t.map(e=>e.data).filter(Boolean).flat(1),aYe=tr([lN],e8,{memoizeOptions:{resultEqualityCheck:c3}}),t8=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},r8=tr([aYe,Tle],t8),n8=(t,e,r)=>(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:ks(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:ks(a,n)}))):t.map(n=>({value:n})),u3=tr([r8,mi,lN],n8);function lce(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function _E(t){if(dh(t)||t instanceof Date){var e=Number(t);if(Ai(e))return e}}function Hq(t){if(Array.isArray(t)){var e=[_E(t[0]),_E(t[1])];return Tm(e)?e:void 0}var r=_E(t);if(r!=null)return[r,r]}function SA(t){return t.map(_E).filter(hHe)}function sYe(t,e,r){return!r||typeof e!="number"||uh(e)?[]:r.length?SA(r.flatMap(n=>{var a=ks(t,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!Ai(s)||!Ai(o)))return[e-s,e+o]})):[]}var Uo=t=>{var e=Lo(t),r=S1(t);return oN(t,e,r)},cN=tr([Uo],t=>t==null?void 0:t.dataKey),iYe=tr([ice,Tle,Uo],rce),cce=(t,e,r,n)=>{var a={},s=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(WM);return[l,{stackedData:BKe(t,d,r),graphicalItems:u}]}))},cO=tr([iYe,ice,sN,Wle],cce),uce=(t,e,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=e;if(n==null&&r!=="zAxis"){var o=DKe(t,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},oYe=tr([mi],t=>t.allowDataOverflow),a8=t=>{var e;if(t==null||!("domain"in t))return lO;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=SA(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:lO},s8=tr([mi],a8),i8=tr([s8,oYe],kle),lYe=tr([cO,VA,Xs,i8],uce,{memoizeOptions:{resultEqualityCheck:l3}}),d3=t=>t.errorBars,cYe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>lce(r,n)),$I=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},o8=(t,e,r,n,a)=>{var s,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(v=>lce(a,v)),A=ks(l,(d=e.dataKey)!==null&&d!==void 0?d:c.dataKey),h=sYe(l,A,f);if(h.length>=2){var m=Math.min(...h),p=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||p>o)&&(o=p)}var x=Hq(A);x!=null&&(s=s==null?x[0]:Math.min(s,x[0]),o=o==null?x[1]:Math.max(o,x[1]))})}),(e==null?void 0:e.dataKey)!=null&&t.forEach(l=>{var c=Hq(ks(l,e.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Ai(s)&&Ai(o))return[s,o]},uYe=tr([r8,mi,nYe,d3,Xs],o8,{memoizeOptions:{resultEqualityCheck:l3}});function dYe(t){var{value:e}=t;if(dh(e)||e instanceof Date)return e}var fYe=(t,e,r)=>{var n=t.map(dYe).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&lie(n))?Joe(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},dce=t=>t.referenceElements.dots,I1=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),hYe=tr([dce,Xs,iN],I1),fce=t=>t.referenceElements.areas,AYe=tr([fce,Xs,iN],I1),hce=t=>t.referenceElements.lines,mYe=tr([hce,Xs,iN],I1),Ace=(t,e)=>{if(t!=null){var r=SA(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},pYe=tr(hYe,Xs,Ace),mce=(t,e)=>{if(t!=null){var r=SA(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},gYe=tr([AYe,Xs],mce);function xYe(t){var e;if(t.x!=null)return SA([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:SA(r)}function vYe(t){var e;if(t.y!=null)return SA([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:SA(r)}var pce=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?xYe(n):vYe(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},yYe=tr([mYe,Xs],pce),bYe=tr(pYe,yYe,gYe,(t,e,r)=>$I(t,r,e)),l8=(t,e,r,n,a,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?$I(n,s,a):$I(s,a);return TXe(e,u,t.allowDataOverflow)},wYe=tr([mi,s8,i8,lYe,uYe,bYe,Ta,Xs],l8,{memoizeOptions:{resultEqualityCheck:l3}}),NYe=[0,1],c8=(t,e,r,n,a,s,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=Hg(e,s);if(u&&l==null){var d;return Joe(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?fYe(n,t,u):a==="expand"?NYe:o}},u8=tr([mi,Ta,r8,u3,sN,Xs,wYe],c8),gce=(t,e,r,n,a)=>{if(t!=null){var{scale:s,type:o}=t;if(s==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(qw(s));return l in rb?l:"point"}}},j1=tr([mi,Ta,sce,HM,Xs],gce);function CYe(t){if(t!=null){if(t in rb)return rb[t]();var e="scale".concat(qw(t));if(e in rb)return rb[e]()}}function d8(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=CYe(e);if(a!=null){var s=a.domain(r).range(n);return EKe(s),s}}}var f8=(t,e,r)=>{var n=a8(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Tm(t))return QXe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Tm(t))return VXe(t,e.tickCount,e.allowDecimals)}},h8=tr([u8,oN,j1],f8),A8=(t,e,r,n)=>{if(n!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&Tm(e)&&Array.isArray(r)&&r.length>0){var a=e[0],s=r[0],o=e[1],l=r[r.length-1];return[Math.min(a,s),Math.max(o,l)]}return e},_Ye=tr([mi,u8,h8,Xs],A8),EYe=tr(u3,mi,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(SA(t.map(f=>f.value))).sort((f,A)=>f-A),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),xce=tr(EYe,Ta,zle,Ro,(t,e,r,n,a)=>a,(t,e,r,n,a)=>{if(!Ai(t))return 0;var s=e==="vertical"?n.height:n.width;if(a==="gap")return t*s/2;if(a==="no-gap"){var o=ic(r,t*s),l=t*s/2;return l-o-(l-o)/s*o}return 0}),SYe=(t,e,r)=>{var n=HA(t,e);return n==null||typeof n.padding!="string"?0:xce(t,"xAxis",e,r,n.padding)},IYe=(t,e,r)=>{var n=$A(t,e);return n==null||typeof n.padding!="string"?0:xce(t,"yAxis",e,r,n.padding)},jYe=tr(HA,SYe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),PYe=tr($A,IYe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),BYe=tr([Ro,jYe,HP,VP,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[t.left+e.left,t.left+t.width-e.right]}),TYe=tr([Ro,Ta,PYe,HP,VP,(t,e,r)=>r],(t,e,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),uN=(t,e,r,n)=>{var a;switch(e){case"xAxis":return BYe(t,r,n);case"yAxis":return TYe(t,r,n);case"zAxis":return(a=XM(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return Zle(t);case"radiusAxis":return ece(t,r);default:return}},vce=tr([mi,uN],s3),f3=tr([mi,j1,_Ye,vce],d8);tr([lN,d3,Xs],cYe);function yce(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var h3=(t,e)=>e,A3=(t,e,r)=>r,kYe=tr(UP,h3,A3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(yce)),FYe=tr(QP,h3,A3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(yce)),bce=(t,e)=>({width:t.width,height:e.height}),OYe=(t,e)=>{var r=typeof e.width=="number"?e.width:Jw;return{width:r,height:t.height}},wce=tr(Ro,HA,bce),DYe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},RYe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},MYe=tr(UA,Ro,kYe,h3,A3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=bce(e,l);o==null&&(o=DYe(e,n,t));var u=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),LYe=tr(LA,Ro,FYe,h3,A3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=OYe(e,l);o==null&&(o=RYe(e,n,t));var u=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),UYe=(t,e)=>{var r=HA(t,e);if(r!=null)return MYe(t,r.orientation,r.mirror)},QYe=tr([Ro,HA,UYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),VYe=(t,e)=>{var r=$A(t,e);if(r!=null)return LYe(t,r.orientation,r.mirror)},HYe=tr([Ro,$A,VYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),Nce=tr(Ro,$A,(t,e)=>{var r=typeof e.width=="number"?e.width:Jw;return{width:r,height:t.height}}),$q=(t,e,r)=>{switch(e){case"xAxis":return wce(t,r).width;case"yAxis":return Nce(t,r).height;default:return}},Cce=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=Hg(t,n),c=e.map(u=>u.value);if(o&&l&&s==="category"&&a&&lie(c))return c}},m8=tr([Ta,u3,mi,Xs],Cce),_ce=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=Hg(t,n);if(o&&(a==="number"||s!=="auto"))return e.map(l=>l.value)}},p8=tr([Ta,u3,oN,Xs],_ce);tr([Ta,tYe,j1,f3,m8,p8,uN,h8,Xs],(t,e,r,n,a,s,o,l,c)=>{if(e!=null){var u=Hg(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var $Ye=(t,e,r,n,a,s,o,l,c)=>{if(!(e==null||n==null)){var u=Hg(t,c),{type:d,ticks:f,tickCount:A}=e,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Pl(s[0]-s[1])*2*m:m;var p=f||a;if(p){var x=p.map((v,y)=>{var b=o?o.indexOf(v):v;return{index:y,coordinate:n(b)+m,value:v,offset:m}});return x.filter(v=>Ai(v.coordinate))}return u&&l?l.map((v,y)=>({coordinate:n(v)+m,value:v,index:y,offset:m})).filter(v=>Ai(v.coordinate)):n.ticks?n.ticks(A).map(v=>({coordinate:n(v)+m,value:v,offset:m})):n.domain().map((v,y)=>({coordinate:n(v)+m,value:o?o[v]:v,index:y,offset:m}))}},Ece=tr([Ta,oN,j1,f3,h8,uN,m8,p8,Xs],$Ye),KYe=(t,e,r,n,a,s,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=Hg(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Pl(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},Yv=tr([Ta,oN,f3,uN,m8,p8,Xs],KYe),Jv=tr(mi,f3,(t,e)=>{if(!(t==null||e==null))return HI(HI({},t),{},{scale:e})}),GYe=tr([mi,j1,u8,vce],d8);tr((t,e,r)=>XM(t,r),GYe,(t,e)=>{if(!(t==null||e==null))return HI(HI({},t),{},{scale:e})});var qYe=tr([Ta,UP,QP],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Sce=t=>t.options.defaultTooltipEventType,Ice=t=>t.options.validateTooltipEventTypes;function jce(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function g8(t,e){var r=Sce(t),n=Ice(t);return jce(e,r,n)}function zYe(t){return vn(e=>g8(e,t))}var Pce=(t,e)=>{var r,n=Number(e);if(!(uh(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},WYe=t=>t.tooltip.settings,Q0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},XYe={itemInteraction:{click:Q0,hover:Q0},axisInteraction:{click:Q0,hover:Q0},keyboardInteraction:Q0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Bce=uu({name:"tooltip",initialState:XYe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:Ls()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,a=vf(t).tooltipItemPayloads.indexOf(r);a>-1&&(t.tooltipItemPayloads[a]=n)},prepare:Ls()},removeTooltipEntrySettings:{reducer(t,e){var r=vf(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Ls()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:YYe,replaceTooltipEntrySettings:JYe,removeTooltipEntrySettings:ZYe,setTooltipSettingsState:eJe,setActiveMouseOverItemIndex:Tce,mouseLeaveItem:tJe,mouseLeaveChart:kce,setActiveClickItemIndex:rJe,setMouseOverAxisIndex:Fce,setMouseClickAxisIndex:nJe,setSyncInteraction:uO,setKeyboardInteraction:dO}=Bce.actions,aJe=Bce.reducer;function Kq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function I_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Kq(Object(r),!0).forEach(function(n){sJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Kq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sJe(t,e,r){return(e=iJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iJe(t){var e=oJe(t,"string");return typeof e=="symbol"?e:e+""}function oJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lJe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function cJe(t){return t.index!=null}var Oce=(t,e,r,n)=>{if(e==null)return Q0;var a=lJe(t,e,r);if(a==null)return Q0;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var s=t.settings.active===!0;if(cJe(a)){if(s)return I_(I_({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return I_(I_({},Q0),{},{coordinate:a.coordinate})};function uJe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function dJe(t,e){var r=uJe(t),n=e[0],a=e[1];if(r===void 0)return!1;var s=Math.min(n,a),o=Math.max(n,a);return r>=s&&r<=o}function fJe(t,e,r){if(r==null||e==null)return!0;var n=ks(t,e);return n==null||!Tm(r)?!0:dJe(n,r)}var x8=(t,e,r,n)=>{var a=t==null?void 0:t.index;if(a==null)return null;var s=Number(a);if(!Ai(s))return a;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(s,l)),u=e[c];return u==null||fJe(u,r,n)?String(c):null},Dce=(t,e,r,n,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,s);if(u!=null)return u;var d=a==null?void 0:a[Number(s)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:d.coordinate}}}},Rce=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=t.itemInteraction.hover.graphicalItemId:a=t.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=t.tooltipItemPayloads[0];return s!=null?[s]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},dN=t=>t.options.tooltipPayloadSearcher,P1=t=>t.tooltip;function Gq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gq(Object(r),!0).forEach(function(n){hJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hJe(t,e,r){return(e=AJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AJe(t){var e=mJe(t,"string");return typeof e=="symbol"?e:e+""}function mJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pJe(t,e){return t??e}var Mce=(t,e,r,n,a,s,o)=>{if(!(e==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return t.reduce((A,h)=>{var m,{dataDefinedOnItem:p,settings:x}=h,v=pJe(p,l),y=Array.isArray(v)?poe(v,u,d):v,b=(m=x==null?void 0:x.dataKey)!==null&&m!==void 0?m:n,w=x==null?void 0:x.nameKey,j;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?j=fHe(y,n,a):j=s(y,e,c,w),Array.isArray(j))j.forEach(_=>{var S=qq(qq({},x),{},{name:_.name,unit:_.unit,color:void 0,fill:void 0});A.push(nG({tooltipEntrySettings:S,dataKey:_.dataKey,payload:_.payload,value:ks(_.payload,_.dataKey),name:_.name}))});else{var I;A.push(nG({tooltipEntrySettings:x,dataKey:b,payload:j,value:ks(j,b),name:(I=ks(j,w))!==null&&I!==void 0?I:x==null?void 0:x.name}))}return A},f)}},v8=tr([Uo,Ta,sce,HM,Lo],gce),gJe=tr([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),xJe=tr([Lo,S1],YM),B1=tr([gJe,Uo,xJe],ZM,{memoizeOptions:{resultEqualityCheck:c3}}),vJe=tr([B1],t=>t.filter(o3)),yJe=tr([B1],e8,{memoizeOptions:{resultEqualityCheck:c3}}),T1=tr([yJe,VA],t8),bJe=tr([vJe,VA,Uo],rce),y8=tr([T1,Uo,B1],n8),Lce=tr([Uo],a8),wJe=tr([Uo],t=>t.allowDataOverflow),Uce=tr([Lce,wJe],kle),NJe=tr([B1],t=>t.filter(o3)),CJe=tr([bJe,NJe,sN,Wle],cce),_Je=tr([CJe,VA,Lo,Uce],uce),EJe=tr([B1],oce),SJe=tr([T1,Uo,EJe,d3,Lo],o8,{memoizeOptions:{resultEqualityCheck:l3}}),IJe=tr([dce,Lo,S1],I1),jJe=tr([IJe,Lo],Ace),PJe=tr([fce,Lo,S1],I1),BJe=tr([PJe,Lo],mce),TJe=tr([hce,Lo,S1],I1),kJe=tr([TJe,Lo],pce),FJe=tr([jJe,kJe,BJe],$I),OJe=tr([Uo,Lce,Uce,_Je,SJe,FJe,Ta,Lo],l8),fN=tr([Uo,Ta,T1,y8,sN,Lo,OJe],c8),DJe=tr([fN,Uo,v8],f8),RJe=tr([Uo,fN,DJe,Lo],A8),Qce=t=>{var e=Lo(t),r=S1(t),n=!1;return uN(t,e,r,n)},Vce=tr([Uo,Qce],s3),Hce=tr([Uo,v8,RJe,Vce],d8),MJe=tr([Ta,y8,Uo,Lo],Cce),LJe=tr([Ta,y8,Uo,Lo],_ce),UJe=(t,e,r,n,a,s,o,l)=>{if(e){var{type:c}=e,u=Hg(t,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Pl(a[0]-a[1])*2*f:f,u&&o?o.map((A,h)=>({coordinate:n(A)+f,value:A,index:h,offset:f})):n.domain().map((A,h)=>({coordinate:n(A)+f,value:s?s[A]:A,index:h,offset:f}))}}},KA=tr([Ta,Uo,v8,Hce,Qce,MJe,LJe,Lo],UJe),b8=tr([Sce,Ice,WYe],(t,e,r)=>jce(r.shared,t,e)),$ce=t=>t.tooltip.settings.trigger,w8=t=>t.tooltip.settings.defaultIndex,hN=tr([P1,b8,$ce,w8],Oce),Cg=tr([hN,T1,cN,fN],x8),Kce=tr([KA,Cg],Pce),N8=tr([hN],t=>{if(t)return t.dataKey}),QJe=tr([hN],t=>{if(t)return t.graphicalItemId}),Gce=tr([P1,b8,$ce,w8],Rce),VJe=tr([LA,UA,Ta,Ro,KA,w8,Gce,dN],Dce),HJe=tr([hN,VJe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),$Je=tr([hN],t=>{var e;return(e=t==null?void 0:t.active)!==null&&e!==void 0?e:!1}),KJe=tr([Gce,Cg,VA,cN,Kce,dN,b8],Mce);tr([KJe],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function zq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Wq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zq(Object(r),!0).forEach(function(n){GJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function GJe(t,e,r){return(e=qJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qJe(t){var e=zJe(t,"string");return typeof e=="symbol"?e:e+""}function zJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WJe=()=>vn(Uo),XJe=()=>{var t=WJe(),e=vn(KA),r=vn(Hce);return NI(!t||!r?void 0:Wq(Wq({},t),{},{scale:r}),e)};function Xq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xq(Object(r),!0).forEach(function(n){YJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YJe(t,e,r){return(e=JJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JJe(t){var e=ZJe(t,"string");return typeof e=="symbol"?e:e+""}function ZJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eZe=(t,e,r,n)=>{var a=e.find(s=>s&&s.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},tZe=(t,e,r,n)=>{var a=e.find(u=>u&&u.index===r);if(a){if(t==="centric"){var s=a.coordinate,{radius:o}=n;return bx(bx(bx({},n),lo(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return bx(bx(bx({},n),lo(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function rZe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var qce=(t,e,r,n,a)=>{var s,o=(s=e==null?void 0:e.length)!==null&&s!==void 0?s:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,A,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,p=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(A=r[l+1])===null||A===void 0?void 0:A.coordinate,x=void 0;if(!(h==null||m==null||p==null))if(Pl(m-h)!==Pl(p-m)){var v=[];if(Pl(p-m)===Pl(a[1]-a[0])){x=p;var y=m+a[1]-a[0];v[0]=Math.min(y,(y+h)/2),v[1]=Math.max(y,(y+h)/2)}else{x=h;var b=p+a[1]-a[0];v[0]=Math.min(m,(b+m)/2),v[1]=Math.max(m,(b+m)/2)}var w=[Math.min(m,(x+m)/2),Math.max(m,(x+m)/2)];if(t>w[0]&&t<=w[1]||t>=v[0]&&t<=v[1]){var j;return(j=r[l])===null||j===void 0?void 0:j.index}}else{var I=Math.min(h,p),_=Math.max(h,p);if(t>(I+m)/2&&t<=(_+m)/2){var S;return(S=r[l])===null||S===void 0?void 0:S.index}}}else if(e)for(var E=0;E<o;E++){var B=e[E];if(B!=null){var k=e[E+1],P=e[E-1];if(E===0&&k!=null&&t<=(B.coordinate+k.coordinate)/2||E===o-1&&P!=null&&t>(B.coordinate+P.coordinate)/2||E>0&&E<o-1&&P!=null&&k!=null&&t>(B.coordinate+P.coordinate)/2&&t<=(B.coordinate+k.coordinate)/2)return B.index}}return-1},nZe=()=>vn(HM),C8=(t,e)=>e,zce=(t,e,r)=>r,_8=(t,e,r,n)=>n,aZe=tr(KA,t=>jP(t,e=>e.coordinate)),E8=tr([P1,C8,zce,_8],Oce),S8=tr([E8,T1,cN,fN],x8),sZe=(t,e,r)=>{if(e!=null){var n=P1(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Wce=tr([P1,C8,zce,_8],Rce),KI=tr([LA,UA,Ta,Ro,KA,_8,Wce,dN],Dce),iZe=tr([E8,KI],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),Xce=tr([KA,S8],Pce),oZe=tr([Wce,S8,VA,cN,Xce,dN,C8],Mce),lZe=tr([E8,S8],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),cZe=(t,e,r,n,a,s,o)=>{if(!(!t||!r||!n||!a)&&rZe(t,o)){var l=RKe(t,e),c=qce(l,s,a,r,n),u=eZe(e,a,c,t);return{activeIndex:String(c),activeCoordinate:u}}},uZe=(t,e,r,n,a,s,o)=>{if(!(!t||!n||!a||!s||!r)){var l=Yqe(t,r);if(l){var c=MKe(l,e),u=qce(c,o,s,n,a),d=tZe(e,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},dZe=(t,e,r,n,a,s,o,l)=>{if(!(!t||!e||!n||!a||!s))return e==="horizontal"||e==="vertical"?cZe(t,e,n,a,s,o,l):uZe(t,e,r,n,a,s,o)},fZe=tr(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),hZe=tr(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(ac)),r=Array.from(new Set(e));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:XXe}});function Yq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yq(Object(r),!0).forEach(function(n){AZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AZe(t,e,r){return(e=mZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mZe(t){var e=pZe(t,"string");return typeof e=="symbol"?e:e+""}function pZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gZe={},xZe={zIndexMap:Object.values(ac).reduce((t,e)=>Jq(Jq({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),gZe)},vZe=new Set(Object.values(ac));function yZe(t){return vZe.has(t)}var Yce=uu({name:"zIndex",initialState:xZe,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Ls()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!yZe(r)&&delete t.zIndexMap[r])},prepare:Ls()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:a}=e.payload;t.zIndexMap[r]?a?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Ls()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:Ls()}}}),{registerZIndexPortal:bZe,unregisterZIndexPortal:wZe,registerZIndexPortalElement:NZe,unregisterZIndexPortalElement:CZe}=Yce.actions,_Ze=Yce.reducer;function vh(t){var{zIndex:e,children:r}=t,n=fGe(),a=n&&e!==void 0&&e!==0,s=qu(),o=Cs();g.useLayoutEffect(()=>a?(o(bZe({zIndex:e})),()=>{o(wZe({zIndex:e}))}):zw,[o,e,a]);var l=vn(c=>fZe(c,e,s));return a?l?Mu.createPortal(r,l):null:r}function fO(){return fO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fO.apply(null,arguments)}function Zq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function j_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zq(Object(r),!0).forEach(function(n){EZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EZe(t,e,r){return(e=SZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SZe(t){var e=IZe(t,"string");return typeof e=="symbol"?e:e+""}function IZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jZe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return g.isValidElement(e)?g.cloneElement(e,n):g.createElement(r,n)}function PZe(t){var e,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=t,f=r,A=n,h=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,p,x;if(d==="ScatterChart")m=f,p=dqe,x=ac.cursorLine;else if(d==="BarChart")m=fqe(l,f,s,o),p=$oe,x=ac.cursorRectangle;else if(l==="radial"&&uie(f)){var{cx:v,cy:y,radius:b,startAngle:w,endAngle:j}=Goe(f);m={cx:v,cy:y,startAngle:w,endAngle:j,innerRadius:b,outerRadius:b},p=zoe,x=ac.cursorLine}else m={points:tze(l,f,s)},p=gM,x=ac.cursorLine;var I=typeof c=="object"&&"className"in c?c.className:void 0,_=j_(j_(j_(j_({stroke:"#ccc",pointerEvents:"none"},s),m),z2(c)),{},{payload:A,payloadIndex:h,className:as("recharts-tooltip-cursor",I)});return g.createElement(vh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:x},g.createElement(jZe,{cursor:c,cursorComp:p,cursorProps:_}))}function BZe(t){var e=XJe(),r=uGe(),n=Zw(),a=nZe();return e==null||r==null||n==null||a==null?null:g.createElement(PZe,fO({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var Jce=g.createContext(null),TZe=()=>g.useContext(Jce),Zce={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,A){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||c,A),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var A=0,h=f.length,m=new Array(h);A<h;A++)m[A]=f[A].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,A,h,m){var p=r?r+u:u;if(!this._events[p])return!1;var x=this._events[p],v=arguments.length,y,b;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),v){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,d),!0;case 3:return x.fn.call(x.context,d,f),!0;case 4:return x.fn.call(x.context,d,f,A),!0;case 5:return x.fn.call(x.context,d,f,A,h),!0;case 6:return x.fn.call(x.context,d,f,A,h,m),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];x.fn.apply(x.context,y)}else{var w=x.length,j;for(b=0;b<w;b++)switch(x[b].once&&this.removeListener(u,x[b].fn,void 0,!0),v){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,d);break;case 3:x[b].fn.call(x[b].context,d,f);break;case 4:x[b].fn.call(x[b].context,d,f,A);break;default:if(!y)for(j=1,y=new Array(v-1);j<v;j++)y[j-1]=arguments[j];x[b].fn.apply(x[b].context,y)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,A){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===d&&(!A||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var p=0,x=[],v=m.length;p<v;p++)(m[p].fn!==d||A&&!m[p].once||f&&m[p].context!==f)&&x.push(m[p]);x.length?this._events[h]=x.length===1?x[0]:x:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(Zce);var kZe=Zce.exports;const FZe=jA(kZe);var lw=new FZe,hO="recharts.syncEvent.tooltip",ez="recharts.syncEvent.brush";function eue(t,e){if(e){var r=Number.parseInt(e,10);if(!uh(r))return t==null?void 0:t[r]}}var OZe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},tue=uu({name:"options",initialState:OZe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),DZe=tue.reducer,{createEventEmitter:RZe}=tue.actions;function MZe(t){return t.tooltip.syncInteraction}var LZe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},rue=uu({name:"chartData",initialState:LZe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:tz,setDataStartEndIndexes:UZe,setComputedData:qit}=rue.actions,QZe=rue.reducer,VZe=["x","y"];function rz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rz(Object(r),!0).forEach(function(n){HZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HZe(t,e,r){return(e=$Ze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Ze(t){var e=KZe(t,"string");return typeof e=="symbol"?e:e+""}function KZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GZe(t,e){if(t==null)return{};var r,n,a=qZe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function qZe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function zZe(){var t=vn($M),e=vn(KM),r=Cs(),n=vn(Xle),a=vn(KA),s=Zw(),o=$P(),l=vn(c=>c.rootProps.className);g.useEffect(()=>{if(t==null)return zw;var c=(u,d,f)=>{if(e!==f&&t===u){if(n==="index"){var A;if(o&&d!==null&&d!==void 0&&(A=d.payload)!==null&&A!==void 0&&A.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:m,y:p}=h,x=GZe(h,VZe),{x:v,y,width:b,height:w}=d.payload.sourceViewBox,j=wx(wx({},x),{},{x:o.x+(b?(m-v)/b:0)*o.width,y:o.y+(w?(p-y)/w:0)*o.height});r(wx(wx({},d),{},{payload:wx(wx({},d.payload),{},{coordinate:j})}))}else r(d);return}if(a!=null){var I;if(typeof n=="function"){var _={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},S=n(a,_);I=a[S]}else n==="value"&&(I=a.find(ce=>String(ce.value)===d.payload.label));var{coordinate:E}=d.payload;if(I==null||d.payload.active===!1||E==null||o==null){r(uO({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:k}=E,P=Math.min(B,o.x+o.width),O=Math.min(k,o.y+o.height),z={x:s==="horizontal"?I.coordinate:P,y:s==="horizontal"?O:I.coordinate},oe=uO({active:d.payload.active,coordinate:z,dataKey:d.payload.dataKey,index:String(I.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(oe)}}};return lw.on(hO,c),()=>{lw.off(hO,c)}},[l,r,e,t,n,a,s,o])}function WZe(){var t=vn($M),e=vn(KM),r=Cs();g.useEffect(()=>{if(t==null)return zw;var n=(a,s,o)=>{e!==o&&t===a&&r(UZe(s))};return lw.on(ez,n),()=>{lw.off(ez,n)}},[r,e,t])}function XZe(){var t=Cs();g.useEffect(()=>{t(RZe())},[t]),zZe(),WZe()}function YZe(t,e,r,n,a,s){var o=vn(h=>sZe(h,t,e)),l=vn(KM),c=vn($M),u=vn(Xle),d=vn(MZe),f=d==null?void 0:d.active,A=$P();g.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=uO({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:A,graphicalItemId:void 0});lw.emit(hO,c,h,l)}},[f,r,o,a,n,l,c,u,s,A])}function nz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function az(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nz(Object(r),!0).forEach(function(n){JZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JZe(t,e,r){return(e=ZZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZZe(t){var e=eet(t,"string");return typeof e=="symbol"?e:e+""}function eet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tet(t){return t.dataKey}function ret(t,e){return g.isValidElement(t)?g.cloneElement(t,e):typeof t=="function"?g.createElement(t,e):g.createElement($Ge,e)}var sz=[],net={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function iz(t){var e,r,n=kl(t,net),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:A,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:y,trigger:b,defaultIndex:w,portal:j,axisId:I}=n,_=Cs(),S=typeof w=="number"?String(w):w;g.useEffect(()=>{_(eJe({shared:y,trigger:b,axisId:I,active:a,defaultIndex:S}))},[_,y,b,I,a,S]);var E=$P(),B=Loe(),k=zYe(y),{activeIndex:P,isActive:O}=(e=vn(X=>lZe(X,k,b,S)))!==null&&e!==void 0?e:{},z=vn(X=>oZe(X,k,b,S)),oe=vn(X=>Xce(X,k,b,S)),ce=vn(X=>iZe(X,k,b,S)),ue=z,ge=TZe(),ne=(r=a??O)!==null&&r!==void 0?r:!1,[Oe,Ue]=Uie([ue,ne]),F=k==="axis"?oe:void 0;YZe(k,b,ce,F,P,ne);var H=j??ge;if(H==null||E==null||k==null)return null;var K=ue??sz;ne||(K=sz),u&&K.length&&(K=Iie(K.filter(X=>X.value!=null&&(X.hide!==!0||n.includeHidden)),A,tet));var U=K.length>0,W=g.createElement(YGe,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:ne,coordinate:ce,hasPayload:U,offset:f,position:h,reverseDirection:m,useTranslate3d:p,viewBox:E,wrapperStyle:x,lastBoundingBox:Oe,innerRef:Ue,hasPortalFromProps:!!j},ret(c,az(az({},n),{},{payload:K,label:F,active:ne,activeIndex:P,coordinate:ce,accessibilityLayer:B})));return g.createElement(g.Fragment,null,Mu.createPortal(W,H),ne&&g.createElement(BZe,{cursor:v,tooltipEventType:k,coordinate:ce,payload:K,index:P}))}var AN=t=>null;AN.displayName="Cell";function aet(t,e,r){return(e=set(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function set(t){var e=iet(t,"string");return typeof e=="symbol"?e:e+""}function iet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oet{constructor(e){aet(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function oz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function cet(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oz(Object(r),!0).forEach(function(n){uet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uet(t,e,r){return(e=det(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function det(t){var e=fet(t,"string");return typeof e=="symbol"?e:e+""}function fet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var het={cacheSize:2e3,enableCache:!0},nue=cet({},het),lz=new oet(nue.cacheSize),Aet={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},cz="recharts_measurement_span";function met(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",s=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var uz=(t,e)=>{try{var r=document.getElementById(cz);r||(r=document.createElement("span"),r.setAttribute("id",cz),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Aet,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Qb=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||WP.isSsr)return{width:0,height:0};if(!nue.enableCache)return uz(e,r);var n=met(e,r),a=lz.get(n);if(a)return a;var s=uz(e,r);return lz.set(n,s),s},aue;function pet(t,e,r){return(e=get(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function get(t){var e=xet(t,"string");return typeof e=="symbol"?e:e+""}function xet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,fz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vet=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,yet=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,bet={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},wet=["cm","mm","pt","pc","in","Q","px"];function Net(t){return wet.includes(t)}var tv="NaN";function Cet(t,e){return t*bet[e]}class bl{static parse(e){var r,[,n,a]=(r=yet.exec(e))!==null&&r!==void 0?r:[];return n==null?bl.NaN:new bl(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,uh(e)&&(this.unit=""),r!==""&&!vet.test(r)&&(this.num=NaN,this.unit=""),Net(r)&&(this.num=Cet(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new bl(NaN,""):new bl(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new bl(NaN,""):new bl(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new bl(NaN,""):new bl(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new bl(NaN,""):new bl(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return uh(this.num)}}aue=bl;pet(bl,"NaN",new aue(NaN,""));function sue(t){if(t==null||t.includes(tv))return tv;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,s]=(r=dz.exec(e))!==null&&r!==void 0?r:[],o=bl.parse(n??""),l=bl.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return tv;e=e.replace(dz,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,d,f,A]=(u=fz.exec(e))!==null&&u!==void 0?u:[],h=bl.parse(d??""),m=bl.parse(A??""),p=f==="+"?h.add(m):h.subtract(m);if(p.isNaN())return tv;e=e.replace(fz,p.toString())}return e}var hz=/\(([^()]*)\)/;function _et(t){for(var e=t,r;(r=hz.exec(e))!=null;){var[,n]=r;e=e.replace(hz,sue(n))}return e}function Eet(t){var e=t.replace(/\s+/g,"");return e=_et(e),e=sue(e),e}function Iet(t){try{return Eet(t)}catch{return tv}}function IB(t){var e=Iet(t.slice(5,-1));return e===tv?"":e}var jet=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],Pet=["dx","dy","angle","className","breakAll"];function AO(){return AO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},AO.apply(null,arguments)}function Az(t,e){if(t==null)return{};var r,n,a=Bet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Bet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var iue=/[ \f\n\r\t\v\u2028\u2029]+/,oue=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];sl(e)||(r?a=e.toString().split(""):a=e.toString().split(iue));var s=a.map(l=>({word:l,width:Qb(l,n).width})),o=r?0:Qb("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function Tet(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var lue=(t,e,r,n)=>t.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};a.push(u)}return a},[]),cue=t=>t.reduce((e,r)=>e.width>r.width?e:r),ket="",mz=(t,e,r,n,a,s,o,l)=>{var c=t.slice(0,e),u=oue({breakAll:r,style:n,children:c+ket});if(!u)return[!1,[]];var d=lue(u.wordsWithComputedWidth,s,o,l),f=d.length>a||cue(d).width>Number(s);return[f,d]},Fet=(t,e,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=t,u=_n(s),d=String(o),f=lue(e,n,r,a);if(!u||a)return f;var A=f.length>s||cue(f).width>Number(n);if(!A)return f;for(var h=0,m=d.length-1,p=0,x;h<=m&&p<=d.length-1;){var v=Math.floor((h+m)/2),y=v-1,[b,w]=mz(d,y,c,l,s,n,r,a),[j]=mz(d,v,c,l,s,n,r,a);if(!b&&!j&&(h=v+1),b&&j&&(m=v-1),!b&&j){x=w;break}p++}return x||f},pz=t=>{var e=sl(t)?[]:t.toString().split(iue);return[{words:e,width:void 0}]},Oet=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=t;if((e||r)&&!WP.isSsr){var l,c,u=oue({breakAll:s,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return pz(n);return Fet({breakAll:s,children:n,maxLines:o,style:a},l,c,e,!!r)}return pz(n)},uue="#808080",Det={angle:0,breakAll:!1,capHeight:"0.71em",fill:uue,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},m3=g.forwardRef((t,e)=>{var r=kl(t,Det),{x:n,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=Az(r,jet),A=g.useMemo(()=>Oet({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:p,className:x,breakAll:v}=f,y=Az(f,Pet);if(!dh(n)||!dh(a)||A.length===0)return null;var b=Number(n)+(_n(h)?h:0),w=Number(a)+(_n(m)?m:0);if(!Ai(b)||!Ai(w))return null;var j;switch(d){case"start":j=IB("calc(".concat(o,")"));break;case"middle":j=IB("calc(".concat((A.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:j=IB("calc(".concat(A.length-1," * -").concat(s,")"));break}var I=[];if(c){var _=A[0].width,{width:S}=f;I.push("scale(".concat(_n(S)&&_n(_)?S/_:1,")"))}return p&&I.push("rotate(".concat(p,", ").concat(b,", ").concat(w,")")),I.length&&(y.transform=I.join(" ")),g.createElement("text",AO({},Dd(y),{ref:e,x:b,y:w,className:as("recharts-text",x),textAnchor:u,fill:l.includes("url")?uue:l}),A.map((E,B)=>{var k=E.words.join(v?"":" ");return g.createElement("tspan",{x:b,dy:B===0?j:s,key:"".concat(k,"-").concat(B)},k)}))});m3.displayName="Text";var Ret=["labelRef"],Met=["content"];function gz(t,e){if(t==null)return{};var r,n,a=Let(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Let(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function xz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Li(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xz(Object(r),!0).forEach(function(n){Uet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Uet(t,e,r){return(e=Qet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qet(t){var e=Vet(t,"string");return typeof e=="symbol"?e:e+""}function Vet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hh(){return Hh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hh.apply(null,arguments)}var due=g.createContext(null),Het=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o,children:l}=t,c=g.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o}),[e,r,n,a,s,o]);return g.createElement(due.Provider,{value:c},l)},fue=()=>{var t=g.useContext(due),e=$P();return t||Eoe(e)},$et=g.createContext(null),Ket=()=>{var t=g.useContext($et),e=vn(tce);return t||e},Get=t=>{var{value:e,formatter:r}=t,n=sl(t.children)?e:t.children;return typeof r=="function"?r(n):n},I8=t=>t!=null&&typeof t=="function",qet=(t,e)=>{var r=Pl(e-t),n=Math.min(Math.abs(e-t),360);return r*n},zet=(t,e,r,n,a)=>{var{offset:s,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:A,clockWise:h}=a,m=(u+d)/2,p=qet(f,A),x=p>=0?1:-1,v,y;switch(e){case"insideStart":v=f+x*s,y=h;break;case"insideEnd":v=A-x*s,y=!h;break;case"end":v=A+x*s,y=h;break;default:throw new Error("Unsupported position ".concat(e))}y=p<=0?y:!y;var b=lo(l,c,m,v),w=lo(l,c,m,v+(y?1:-1)*359),j="M".concat(b.x,",").concat(b.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),I=sl(t.id)?W2("recharts-radial-line-"):t.id;return g.createElement("text",Hh({},n,{dominantBaseline:"central",className:as("recharts-radial-bar-label",o)}),g.createElement("defs",null,g.createElement("path",{id:I,d:j})),g.createElement("textPath",{xlinkHref:"#".concat(I)},r))},Wet=(t,e,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=lo(n,a,o+e,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var A=(s+o)/2,{x:h,y:m}=lo(n,a,A,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},mO=t=>"cx"in t&&_n(t.cx),Xet=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,s;r!=null&&!mO(r)&&(s=r);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:d}=e,f=o,A=o+(c-u)/2,h=(f+A)/2,m=(c+u)/2,p=f+c/2,x=d>=0?1:-1,v=x*n,y=x>0?"end":"start",b=x>0?"start":"end",w=c>=0?1:-1,j=w*n,I=w>0?"end":"start",_=w>0?"start":"end";if(a==="top"){var S={x:f+c/2,y:l-v,textAnchor:"middle",verticalAnchor:y};return Li(Li({},S),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var E={x:A+u/2,y:l+d+v,textAnchor:"middle",verticalAnchor:b};return Li(Li({},E),s?{height:Math.max(s.y+s.height-(l+d),0),width:u}:{})}if(a==="left"){var B={x:h-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"};return Li(Li({},B),s?{width:Math.max(B.x-s.x,0),height:d}:{})}if(a==="right"){var k={x:h+m+j,y:l+d/2,textAnchor:_,verticalAnchor:"middle"};return Li(Li({},k),s?{width:Math.max(s.x+s.width-k.x,0),height:d}:{})}var P=s?{width:m,height:d}:{};return a==="insideLeft"?Li({x:h+j,y:l+d/2,textAnchor:_,verticalAnchor:"middle"},P):a==="insideRight"?Li({x:h+m-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"},P):a==="insideTop"?Li({x:f+c/2,y:l+v,textAnchor:"middle",verticalAnchor:b},P):a==="insideBottom"?Li({x:A+u/2,y:l+d-v,textAnchor:"middle",verticalAnchor:y},P):a==="insideTopLeft"?Li({x:f+j,y:l+v,textAnchor:_,verticalAnchor:b},P):a==="insideTopRight"?Li({x:f+c-j,y:l+v,textAnchor:I,verticalAnchor:b},P):a==="insideBottomLeft"?Li({x:A+j,y:l+d-v,textAnchor:_,verticalAnchor:y},P):a==="insideBottomRight"?Li({x:A+u-j,y:l+d-v,textAnchor:I,verticalAnchor:y},P):a&&typeof a=="object"&&(_n(a.x)||wA(a.x))&&(_n(a.y)||wA(a.y))?Li({x:o+ic(a.x,m),y:l+ic(a.y,d),textAnchor:"end",verticalAnchor:"end"},P):Li({x:p,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},P)},Yet={angle:0,offset:5,zIndex:ac.label,position:"middle",textBreakAll:!1};function P0(t){var e=kl(t,Yet),{viewBox:r,position:n,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:u}=e,d=Ket(),f=fue(),A=n==="center"?f:d??f,h,m,p;if(r==null?h=A:mO(r)?h=r:h=Eoe(r),!h||sl(a)&&sl(s)&&!g.isValidElement(o)&&typeof o!="function")return null;var x=Li(Li({},e),{},{viewBox:h});if(g.isValidElement(o)){var{labelRef:v}=x,y=gz(x,Ret);return g.cloneElement(o,y)}if(typeof o=="function"){var{content:b}=x,w=gz(x,Met);if(m=g.createElement(o,w),g.isValidElement(m))return m}else m=Get(e);var j=Dd(e);if(mO(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return zet(e,n,m,j,h);p=Wet(h,e.offset,e.position)}else p=Xet(e,h);return g.createElement(vh,{zIndex:e.zIndex},g.createElement(m3,Hh({ref:u,className:as("recharts-label",l)},j,p,{textAnchor:Tet(j.textAnchor)?j.textAnchor:p.textAnchor,breakAll:c}),m))}P0.displayName="Label";var Jet=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?g.createElement(P0,Hh({key:"label-implicit"},n)):dh(t)?g.createElement(P0,Hh({key:"label-implicit",value:t},n)):g.isValidElement(t)?t.type===P0?g.cloneElement(t,Li({key:"label-implicit"},n)):g.createElement(P0,Hh({key:"label-implicit",content:t},n)):I8(t)?g.createElement(P0,Hh({key:"label-implicit",content:t},n)):t&&typeof t=="object"?g.createElement(P0,Hh({},t,{key:"label-implicit"},n)):null};function Zet(t){var{label:e,labelRef:r}=t,n=fue();return Jet(e,n,r)||null}var hue={},Aue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(Aue);var mue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(mue);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Aue,r=mue,n=SP;function a(s){if(n.isArrayLike(s))return e.last(r.toArray(s))}t.last=a})(hue);var ett=hue.last;const ttt=jA(ett);var rtt=["valueAccessor"],ntt=["dataKey","clockWise","id","textBreakAll","zIndex"];function GI(){return GI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},GI.apply(null,arguments)}function vz(t,e){if(t==null)return{};var r,n,a=att(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function att(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var stt=t=>Array.isArray(t.value)?ttt(t.value):t.value,pue=g.createContext(void 0),itt=pue.Provider,gue=g.createContext(void 0),ott=gue.Provider;function ltt(){return g.useContext(pue)}function ctt(){return g.useContext(gue)}function EE(t){var{valueAccessor:e=stt}=t,r=vz(t,rtt),{dataKey:n,clockWise:a,id:s,textBreakAll:o,zIndex:l}=r,c=vz(r,ntt),u=ltt(),d=ctt(),f=u||d;return!f||!f.length?null:g.createElement(vh,{zIndex:l??ac.label},g.createElement(Bc,{className:"recharts-label-list"},f.map((A,h)=>{var m,p=sl(n)?e(A,h):ks(A&&A.payload,n),x=sl(s)?{}:{id:"".concat(s,"-").concat(h)};return g.createElement(P0,GI({key:"label-".concat(h)},Dd(A),c,x,{fill:(m=r.fill)!==null&&m!==void 0?m:A.fill,parentViewBox:A.parentViewBox,value:p,textBreakAll:o,viewBox:A.viewBox,index:h,zIndex:0}))})))}EE.displayName="LabelList";function xue(t){var{label:e}=t;return e?e===!0?g.createElement(EE,{key:"labelList-implicit"}):g.isValidElement(e)||I8(e)?g.createElement(EE,{key:"labelList-implicit",content:e}):typeof e=="object"?g.createElement(EE,GI({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var vue=t=>t.graphicalItems.polarItems,utt=tr([Xs,iN],YM),p3=tr([vue,mi,utt],ZM),dtt=tr([p3],e8),g3=tr([dtt,a3],t8),ftt=tr([g3,mi,p3],n8);tr([g3,mi,p3],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var s,o=ks(n,(s=e.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:ks(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var yz=()=>{},htt=tr([g3,mi,p3,d3,Xs],o8),Att=tr([mi,s8,i8,yz,htt,yz,Ta,Xs],l8),yue=tr([mi,Ta,g3,ftt,sN,Xs,Att],c8),mtt=tr([yue,mi,j1],f8);tr([mi,yue,mtt,Xs],A8);var ptt={radiusAxis:{},angleAxis:{}},bue=uu({name:"polarAxis",initialState:ptt,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:zit,removeRadiusAxis:Wit,addAngleAxis:Xit,removeAngleAxis:Yit}=bue.actions,gtt=bue.reducer;function bz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bz(Object(r),!0).forEach(function(n){xtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xtt(t,e,r){return(e=vtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vtt(t){var e=ytt(t,"string");return typeof e=="symbol"?e:e+""}function ytt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var btt=(t,e)=>e,j8=tr([vue,btt],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),wtt=[],P8=(t,e,r)=>(r==null?void 0:r.length)===0?wtt:r,wue=tr([a3,j8,P8],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if((e==null?void 0:e.data)!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>wz(wz({},e.presentationProps),s.props))),a!=null)return a}}),Ntt=tr([wue,j8,P8],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var s,o=ks(n,e.nameKey,e.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:LP(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),Ctt=tr([wue,j8,P8,Ro],(t,e,r,n)=>{if(!(e==null||t==null))return Ert({offset:n,pieSettings:e,displayedData:t,cells:r})}),Nue={exports:{}},ps={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B8=Symbol.for("react.transitional.element"),T8=Symbol.for("react.portal"),x3=Symbol.for("react.fragment"),v3=Symbol.for("react.strict_mode"),y3=Symbol.for("react.profiler"),b3=Symbol.for("react.consumer"),w3=Symbol.for("react.context"),N3=Symbol.for("react.forward_ref"),C3=Symbol.for("react.suspense"),_3=Symbol.for("react.suspense_list"),E3=Symbol.for("react.memo"),S3=Symbol.for("react.lazy"),_tt=Symbol.for("react.view_transition"),Ett=Symbol.for("react.client.reference");function Hd(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case B8:switch(t=t.type,t){case x3:case y3:case v3:case C3:case _3:case _tt:return t;default:switch(t=t&&t.$$typeof,t){case w3:case N3:case S3:case E3:return t;case b3:return t;default:return e}}case T8:return e}}}ps.ContextConsumer=b3;ps.ContextProvider=w3;ps.Element=B8;ps.ForwardRef=N3;ps.Fragment=x3;ps.Lazy=S3;ps.Memo=E3;ps.Portal=T8;ps.Profiler=y3;ps.StrictMode=v3;ps.Suspense=C3;ps.SuspenseList=_3;ps.isContextConsumer=function(t){return Hd(t)===b3};ps.isContextProvider=function(t){return Hd(t)===w3};ps.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===B8};ps.isForwardRef=function(t){return Hd(t)===N3};ps.isFragment=function(t){return Hd(t)===x3};ps.isLazy=function(t){return Hd(t)===S3};ps.isMemo=function(t){return Hd(t)===E3};ps.isPortal=function(t){return Hd(t)===T8};ps.isProfiler=function(t){return Hd(t)===y3};ps.isStrictMode=function(t){return Hd(t)===v3};ps.isSuspense=function(t){return Hd(t)===C3};ps.isSuspenseList=function(t){return Hd(t)===_3};ps.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===x3||t===y3||t===v3||t===C3||t===_3||typeof t=="object"&&t!==null&&(t.$$typeof===S3||t.$$typeof===E3||t.$$typeof===w3||t.$$typeof===b3||t.$$typeof===N3||t.$$typeof===Ett||t.getModuleId!==void 0)};ps.typeOf=Hd;Nue.exports=ps;var Stt=Nue.exports,Nz=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",Cz=null,jB=null,Cue=t=>{if(t===Cz&&Array.isArray(jB))return jB;var e=[];return g.Children.forEach(t,r=>{sl(r)||(Stt.isFragment(r)?e=e.concat(Cue(r.props.children)):e.push(r))}),jB=e,Cz=t,e};function k8(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>Nz(a)):n=[Nz(e)],Cue(t).forEach(a=>{var s=vg(a,"type.displayName")||vg(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var _ue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(_ue);var Itt=_ue.isPlainObject;const jtt=jA(Itt);var _z,Ez,Sz,Iz,jz;function Pz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Bz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pz(Object(r),!0).forEach(function(n){Ptt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ptt(t,e,r){return(e=Btt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Btt(t){var e=Ttt(t,"string");return typeof e=="symbol"?e:e+""}function Ttt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qI(){return qI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qI.apply(null,arguments)}function Py(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Tz=(t,e,r,n,a)=>{var s=r-n,o;return o=Ci(_z||(_z=Py(["M ",",",""])),t,e),o+=Ci(Ez||(Ez=Py(["L ",",",""])),t+r,e),o+=Ci(Sz||(Sz=Py(["L ",",",""])),t+r-s/2,e+a),o+=Ci(Iz||(Iz=Py(["L ",",",""])),t+r-s/2-n,e+a),o+=Ci(jz||(jz=Py(["L ",","," Z"])),t,e),o},ktt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ftt=t=>{var e=kl(t,ktt),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=e,A=g.useRef(null),[h,m]=g.useState(-1),p=g.useRef(a),x=g.useRef(s),v=g.useRef(o),y=g.useRef(r),b=g.useRef(n),w=YP(t,"trapezoid-");if(g.useEffect(()=>{if(A.current&&A.current.getTotalLength)try{var z=A.current.getTotalLength();z&&m(z)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var j=as("recharts-trapezoid",l);if(!f)return g.createElement("g",null,g.createElement("path",qI({},Dd(e),{className:j,d:Tz(r,n,a,s,o)})));var I=p.current,_=x.current,S=v.current,E=y.current,B=b.current,k="0px ".concat(h===-1?1:h,"px"),P="".concat(h,"px 0px"),O=Uoe(["strokeDasharray"],u,c);return g.createElement(XP,{animationId:w,key:w,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},z=>{var oe=Eo(I,a,z),ce=Eo(_,s,z),ue=Eo(S,o,z),ge=Eo(E,r,z),ne=Eo(B,n,z);A.current&&(p.current=oe,x.current=ce,v.current=ue,y.current=ge,b.current=ne);var Oe=z>0?{transition:O,strokeDasharray:P}:{strokeDasharray:k};return g.createElement("path",qI({},Dd(e),{className:j,d:Tz(ge,ne,oe,ce,ue),ref:A,style:Bz(Bz({},Oe),e.style)}))})},Ott=["option","shapeType","activeClassName"];function Dtt(t,e){if(t==null)return{};var r,n,a=Rtt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Rtt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function kz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kz(Object(r),!0).forEach(function(n){Mtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mtt(t,e,r){return(e=Ltt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ltt(t){var e=Utt(t,"string");return typeof e=="symbol"?e:e+""}function Utt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qtt(t,e){return zI(zI({},e),t)}function Vtt(t,e){return t==="symbols"}function Fz(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return g.createElement($oe,r);case"trapezoid":return g.createElement(Ftt,r);case"sector":return g.createElement(zoe,r);case"symbols":if(Vtt(e))return g.createElement(zR,r);break;case"curve":return g.createElement(gM,r);default:return null}}function Htt(t){return g.isValidElement(t)?t.props:t}function Eue(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,a=Dtt(t,Ott),s;if(g.isValidElement(e))s=g.cloneElement(e,zI(zI({},a),Htt(e)));else if(typeof e=="function")s=e(a,a.index);else if(jtt(e)&&typeof e!="boolean"){var o=Qtt(e,a);s=g.createElement(Fz,{shapeType:r,elementProps:o})}else{var l=a;s=g.createElement(Fz,{shapeType:r,elementProps:l})}return a.isActive?g.createElement(Bc,{className:n},s):s}var F8=(t,e,r)=>{var n=Cs();return(a,s)=>o=>{t==null||t(a,s,o),n(Tce({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},O8=t=>{var e=Cs();return(r,n)=>a=>{t==null||t(r,n,a),e(tJe())}},D8=(t,e,r)=>{var n=Cs();return(a,s)=>o=>{t==null||t(a,s,o),n(rJe({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function Sue(t){var{tooltipEntrySettings:e}=t,r=Cs(),n=qu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(YYe(e)):a.current!==e&&r(JYe({prev:a.current,next:e})),a.current=e)},[e,r,n]),g.useLayoutEffect(()=>()=>{a.current&&(r(ZYe(a.current)),a.current=null)},[r]),null}function $tt(t){var{legendPayload:e}=t,r=Cs(),n=qu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(Doe(e)):a.current!==e&&r(Roe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Moe(a.current)),a.current=null)},[r]),null}function Ktt(t){var{legendPayload:e}=t,r=Cs(),n=vn(Ta),a=g.useRef(null);return g.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(Doe(e)):a.current!==e&&r(Roe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Moe(a.current)),a.current=null)},[r]),null}var PB,Gtt=()=>{var[t]=g.useState(()=>W2("uid-"));return t},qtt=(PB=dfe.useId)!==null&&PB!==void 0?PB:Gtt;function ztt(t,e){var r=qtt();return e||(t?"".concat(t,"-").concat(r):r)}var Wtt=g.createContext(void 0),Iue=t=>{var{id:e,type:r,children:n}=t,a=ztt("recharts-".concat(r),e);return g.createElement(Wtt.Provider,{value:a},n(a))},Xtt={cartesianItems:[],polarItems:[]},jue=uu({name:"graphicalItems",initialState:Xtt,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:Ls()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,a=vf(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},prepare:Ls()},removeCartesianGraphicalItem:{reducer(t,e){var r=vf(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Ls()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:Ls()},removePolarGraphicalItem:{reducer(t,e){var r=vf(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Ls()}}}),{addCartesianGraphicalItem:Ytt,replaceCartesianGraphicalItem:Jtt,removeCartesianGraphicalItem:Ztt,addPolarGraphicalItem:ert,removePolarGraphicalItem:trt}=jue.actions,rrt=jue.reducer,nrt=t=>{var e=Cs(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Ytt(t)):r.current!==t&&e(Jtt({prev:r.current,next:t})),r.current=t},[e,t]),g.useLayoutEffect(()=>()=>{r.current&&(e(Ztt(r.current)),r.current=null)},[e]),null},art=g.memo(nrt);function srt(t){var e=Cs();return g.useLayoutEffect(()=>(e(ert(t)),()=>{e(trt(t))}),[e,t]),null}var irt=["key"],ort=["onMouseEnter","onClick","onMouseLeave"],lrt=["id"],crt=["id"];function Oz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Si(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oz(Object(r),!0).forEach(function(n){urt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function urt(t,e,r){return(e=drt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function drt(t){var e=frt(t,"string");return typeof e=="symbol"?e:e+""}function frt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function km(){return km=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},km.apply(null,arguments)}function I3(t,e){if(t==null)return{};var r,n,a=hrt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function hrt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Art(t){var e=g.useMemo(()=>k8(t.children,AN),[t.children]),r=vn(n=>Ntt(n,t.id,e));return r==null?null:g.createElement(Ktt,{legendPayload:r})}var mrt=g.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=t,f={dataDefinedOnItem:n.map(A=>A.tooltipPayload),positions:n.map(A=>A.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:e,nameKey:r,name:LP(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return g.createElement(Sue,{tooltipEntrySettings:f})}),prt=(t,e)=>t>e?"start":t<e?"end":"middle",grt=(t,e,r)=>ic(typeof e=="function"?e(t):e,r,r*.8),xrt=(t,e,r)=>{var{top:n,left:a,width:s,height:o}=e,l=Koe(s,o),c=a+ic(t.cx,s,s/2),u=n+ic(t.cy,o,o/2),d=ic(t.innerRadius,l,0),f=grt(r,t.outerRadius,l),A=t.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:A}},vrt=(t,e)=>{var r=Pl(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function yrt(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var brt=(t,e)=>{if(g.isValidElement(t))return g.cloneElement(t,e);if(typeof t=="function")return t(e);var r=as("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,a=I3(e,irt);return g.createElement(gM,km({},a,{type:"linear",className:r}))},wrt=(t,e,r)=>{if(g.isValidElement(t))return g.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),g.isValidElement(n)))return n;var a=as("recharts-pie-label-text",yrt(t));return g.createElement(m3,km({},e,{alignmentBaseline:"middle",className:a}),n)};function Nrt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!e)return null;var l=ch(r),c=z2(a),u=z2(s),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=e.map((A,h)=>{var m=(A.startAngle+A.endAngle)/2,p=lo(A.cx,A.cy,A.outerRadius+d,m),x=Si(Si(Si(Si({},l),A),{},{stroke:"none"},c),{},{index:h,textAnchor:prt(p.x,A.cx)},p),v=Si(Si(Si(Si({},l),A),{},{fill:"none",stroke:A.fill},u),{},{index:h,points:[lo(A.cx,A.cy,A.outerRadius,m),p],key:"line"});return g.createElement(vh,{zIndex:ac.label,key:"label-".concat(A.startAngle,"-").concat(A.endAngle,"-").concat(A.midAngle,"-").concat(h)},g.createElement(Bc,null,s&&brt(s,v),wrt(a,x,ks(A,o))))});return g.createElement(Bc,{className:"recharts-pie-labels"},f)}function Crt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?g.createElement(xue,{label:a}):g.createElement(Nrt,{sectors:e,props:r,showLabels:n})}function _rt(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:o}=t,l=vn(Cg),c=vn(N8),u=vn(QJe),{onMouseEnter:d,onClick:f,onMouseLeave:A}=a,h=I3(a,ort),m=F8(d,a.dataKey,o),p=O8(A),x=D8(f,a.dataKey,o);return e==null||e.length===0?null:g.createElement(g.Fragment,null,e.map((v,y)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&e.length!==1)return null;var b=u==null||u===o,w=String(y)===l&&(c==null||a.dataKey===c)&&b,j=l?n:null,I=r&&w?r:j,_=Si(Si({},v),{},{stroke:v.stroke,tabIndex:-1,[xoe]:y,[voe]:o});return g.createElement(Bc,km({key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(y),tabIndex:-1,className:"recharts-pie-sector"},Ww(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),g.createElement(Eue,km({option:s??I,index:y,shapeType:"sector",isActive:w},_)))}))}function Ert(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:s}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,A=Math.abs(r.minAngle),h=vrt(l,c),m=Math.abs(h),p=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,x=n.filter(I=>ks(I,u,0)!==0).length,v=(m>=360?x:x-1)*p,y=m-x*A-v,b=n.reduce((I,_)=>{var S=ks(_,u,0);return I+(_n(S)?S:0)},0),w;if(b>0){var j;w=n.map((I,_)=>{var S=ks(I,u,0),E=ks(I,d,_),B=xrt(r,s,I),k=(_n(S)?S:0)/b,P,O=Si(Si({},I),a&&a[_]&&a[_].props);_?P=j.endAngle+Pl(h)*p*(S!==0?1:0):P=l;var z=P+Pl(h)*((S!==0?A:0)+k*y),oe=(P+z)/2,ce=(B.innerRadius+B.outerRadius)/2,ue=[{name:E,value:S,payload:O,dataKey:u,type:f,graphicalItemId:r.id}],ge=lo(B.cx,B.cy,ce,oe);return j=Si(Si(Si(Si({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:E,tooltipPayload:ue,midAngle:oe,middleRadius:ce,tooltipPosition:ge},O),B),{},{value:S,dataKey:u,startAngle:P,endAngle:z,payload:O,paddingAngle:Pl(h)*p}),j})}return w}function Srt(t){var{showLabels:e,sectors:r,children:n}=t,a=g.useMemo(()=>!e||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,e]);return g.createElement(ott,{value:e?a:void 0},n)}function Irt(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:A}=e,h=YP(e,"recharts-pie-"),m=r.current,[p,x]=g.useState(!1),v=g.useCallback(()=>{typeof A=="function"&&A(),x(!1)},[A]),y=g.useCallback(()=>{typeof f=="function"&&f(),x(!0)},[f]);return g.createElement(Srt,{showLabels:!p,sectors:a},g.createElement(XP,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:y,onAnimationEnd:v,key:h},b=>{var w=[],j=a&&a[0],I=j==null?void 0:j.startAngle;return a==null||a.forEach((_,S)=>{var E=m&&m[S],B=S>0?vg(_,"paddingAngle",0):0;if(E){var k=Eo(E.endAngle-E.startAngle,_.endAngle-_.startAngle,b),P=Si(Si({},_),{},{startAngle:I+B,endAngle:I+k+B});w.push(P),I=P.endAngle}else{var{endAngle:O,startAngle:z}=_,oe=Eo(0,O-z,b),ce=Si(Si({},_),{},{startAngle:I+B,endAngle:I+oe+B});w.push(ce),I=ce.endAngle}}),r.current=w,g.createElement(Bc,null,g.createElement(_rt,{sectors:w,activeShape:u,inactiveShape:d,allOtherPieProps:e,shape:e.shape,id:n}))}),g.createElement(Crt,{showLabels:!p,sectors:a,props:e}),e.children)}var jrt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:ac.area};function Prt(t){var{id:e}=t,r=I3(t,lrt),{hide:n,className:a,rootTabIndex:s}=t,o=g.useMemo(()=>k8(t.children,AN),[t.children]),l=vn(d=>Ctt(d,e,o)),c=g.useRef(null),u=as("recharts-pie",a);return n||l==null?(c.current=null,g.createElement(Bc,{tabIndex:s,className:u})):g.createElement(vh,{zIndex:t.zIndex},g.createElement(mrt,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),g.createElement(Bc,{tabIndex:s,className:u},g.createElement(Irt,{props:Si(Si({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function Pue(t){var e=kl(t,jrt),{id:r}=e,n=I3(e,crt),a=ch(n);return g.createElement(Iue,{id:r,type:"pie"},s=>g.createElement(g.Fragment,null,g.createElement(srt,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),g.createElement(Art,km({},n,{id:s})),g.createElement(Prt,km({},n,{id:s}))))}Pue.displayName="Pie";function Dz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Rz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dz(Object(r),!0).forEach(function(n){Brt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Brt(t,e,r){return(e=Trt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Trt(t){var e=krt(t,"string");return typeof e=="symbol"?e:e+""}function krt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Bue=0,Frt={xAxis:{},yAxis:{},zAxis:{}},Tue=uu({name:"cartesianAxis",initialState:Frt,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:Ls()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:Ls()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:Ls()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:Ls()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:Ls()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:Ls()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:Ls()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:Ls()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:Ls()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,a=t.yAxis[r];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-s[0])<=1)return;var o=[...s,n].slice(-3);t.yAxis[r]=Rz(Rz({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:Ort,replaceXAxis:Drt,removeXAxis:Rrt,addYAxis:Mrt,replaceYAxis:Lrt,removeYAxis:Urt,addZAxis:Jit,replaceZAxis:Zit,removeZAxis:eot,updateYAxisWidth:Qrt}=Tue.actions,Vrt=Tue.reducer,Hrt=tr([Ro],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),$rt=tr([Hrt,LA,UA],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),kue=()=>vn($rt),Mz=(t,e,r)=>{var n=r??t;if(!sl(n))return ic(n,e,0)},Krt=(t,e,r)=>{var n={},a=t.filter(o3),s=t.filter(u=>u.stackId==null),o=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),l=Object.entries(o).map(u=>{var[d,f]=u,A=f.map(m=>m.dataKey),h=Mz(e,r,f[0].barSize);return{stackId:d,dataKeys:A,barSize:h}}),c=s.map(u=>{var d=[u.dataKey].filter(A=>A!=null),f=Mz(e,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function Lz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function P_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lz(Object(r),!0).forEach(function(n){Grt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Grt(t,e,r){return(e=qrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qrt(t){var e=zrt(t,"string");return typeof e=="symbol"?e:e+""}function zrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wrt(t,e,r,n,a){var s=n.length;if(!(s<1)){var o=ic(t,r,0,!0),l,c=[];if(Ai(n[0].barSize)){var u=!1,d=r/s,f=n.reduce((v,y)=>v+(y.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&d>0&&(u=!0,d*=.9,f=s*d);var A=(r-f)/2>>0,h={offset:A-o,size:0};l=n.reduce((v,y)=>{var b,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h.offset+h.size+o,size:u?d:(b=y.barSize)!==null&&b!==void 0?b:0}},j=[...v,w];return h=j[j.length-1].position,j},c)}else{var m=ic(e,r,0,!0);r-2*m-(s-1)*o<=0&&(o=0);var p=(r-2*m-(s-1)*o)/s;p>1&&(p>>=0);var x=Ai(a)?Math.min(p,a):p;l=n.reduce((v,y,b)=>[...v,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m+(p+o)*b+(p-x)/2,size:x}}],c)}return l}}var Xrt=(t,e,r,n,a,s,o)=>{var l=sl(o)?e:o,c=Wrt(r,n,a!==s?a:s,t,l);return a!==s&&c!=null&&(c=c.map(u=>P_(P_({},u),{},{position:P_(P_({},u.position),{},{offset:u.position.offset-a/2})}))),c},Yrt=(t,e)=>{var r=WM(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}};function Jrt(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Ai(t.zIndex)?t.zIndex:e}var Fue=t=>{var{chartData:e}=t,r=Cs(),n=qu();return g.useEffect(()=>n?()=>{}:(r(tz(e)),()=>{r(tz(void 0))}),[e,r,n]),null},Uz={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Oue=uu({name:"brush",initialState:Uz,reducers:{setBrushSettings(t,e){return e.payload==null?Uz:e.payload}}}),{setBrushSettings:tot}=Oue.actions,Zrt=Oue.reducer;function ent(t,e,r){return(e=tnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tnt(t){var e=rnt(t,"string");return typeof e=="symbol"?e:e+""}function rnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R8{static create(e){return new R8(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}ent(R8,"EPS",1e-4);function nnt(t){return(t%180+180)%180}var ant=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=nnt(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},snt={dots:[],areas:[],lines:[]},Due=uu({name:"referenceElements",initialState:snt,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=vf(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=vf(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=vf(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:rot,removeDot:not,addArea:aot,removeArea:sot,addLine:iot,removeLine:oot}=Due.actions,int=Due.reducer,ont=g.createContext(void 0),lnt=t=>{var{children:e}=t,[r]=g.useState("".concat(W2("recharts"),"-clip")),n=kue();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return g.createElement(ont.Provider,{value:r},g.createElement("defs",null,g.createElement("clipPath",{id:r},g.createElement("rect",{x:a,y:s,height:l,width:o}))),e)};function Rue(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var a=t[n];a!==void 0&&r.push(a)}return r}function cnt(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return ant(n,r)}function unt(t,e,r){var n=r==="width",{x:a,y:s,width:o,height:l}=t;return e===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function cw(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var s=r();return t*(e-t*s/2-n)>=0&&t*(e+t*s/2-a)<=0}function dnt(t,e){return Rue(t,e+1)}function fnt(t,e,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:Rue(n,u)};var p=c,x,v=()=>(x===void 0&&(x=r(m,p)),x),y=m.coordinate,b=c===0||cw(t,y,v,d,l);b||(c=0,d=o,u+=1),b&&(d=y+t*(v()/2+a),c+=u)},A;u<=s.length;)if(A=f(),A)return A.v;return[]}function hnt(t,e,r,n,a){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,A=!0,h=function(){var y=n[m],b=m,w,j=()=>(w===void 0&&(w=r(y,b)),w),I=y.coordinate,_=m===d||cw(t,I,j,f,c);if(!_)return A=!1,1;_&&(f=I+t*(j()/2+a))},m=d;m<o&&!h();m+=u);if(A){for(var p=[],x=d;x<o;x+=u)p.push(n[x]);return p}}return[]}function Qz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Yl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qz(Object(r),!0).forEach(function(n){Ant(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ant(t,e,r){return(e=mnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mnt(t){var e=pnt(t,"string");return typeof e=="symbol"?e:e+""}function pnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gnt(t,e,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=e,{end:c}=e,u=function(A){var h=s[A],m,p=()=>(m===void 0&&(m=r(h,A)),m);if(A===o-1){var x=t*(h.coordinate+t*p()/2-c);s[A]=h=Yl(Yl({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate})}else s[A]=h=Yl(Yl({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var v=cw(t,h.tickCoord,p,l,c);v&&(c=h.tickCoord-t*(p()/2+a),s[A]=Yl(Yl({},h),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function xnt(t,e,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(s){var d=n[l-1],f=r(d,l-1),A=t*(d.coordinate+t*f/2-u);if(o[l-1]=d=Yl(Yl({},d),{},{tickCoord:A>0?d.coordinate-A*t:d.coordinate}),d.tickCoord!=null){var h=cw(t,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-t*(f/2+a),o[l-1]=Yl(Yl({},d),{},{isShow:!0}))}}for(var m=s?l-1:l,p=function(y){var b=o[y],w,j=()=>(w===void 0&&(w=r(b,y)),w);if(y===0){var I=t*(b.coordinate-t*j()/2-c);o[y]=b=Yl(Yl({},b),{},{tickCoord:I<0?b.coordinate-I*t:b.coordinate})}else o[y]=b=Yl(Yl({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var _=cw(t,b.tickCoord,j,c,u);_&&(c=b.tickCoord+t*(j()/2+a),o[y]=Yl(Yl({},b),{},{isShow:!0}))}},x=0;x<m;x++)p(x);return o}function vnt(t,e,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=t;if(!a||!a.length||!n)return[];if(_n(c)||WP.isSsr){var A;return(A=dnt(a,_n(c)?c:0))!==null&&A!==void 0?A:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",p=d&&m==="width"?Qb(d,{fontSize:e,letterSpacing:r}):{width:0,height:0},x=(b,w)=>{var j=typeof u=="function"?u(b.value,w):b.value;return m==="width"?cnt(Qb(j,{fontSize:e,letterSpacing:r}),p,f):Qb(j,{fontSize:e,letterSpacing:r})[m]},v=a.length>=2?Pl(a[1].coordinate-a[0].coordinate):1,y=unt(s,v,m);return c==="equidistantPreserveStart"?fnt(v,y,x,a,o):c==="equidistantPreserveEnd"?hnt(v,y,x,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=xnt(v,y,x,a,o,c==="preserveStartEnd"):h=gnt(v,y,x,a,o),h.filter(b=>b.isShow))}var ynt=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=t,o=0;if(e){Array.from(e).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},bnt=["axisLine","width","height","className","hide","ticks","axisType"];function wnt(t,e){if(t==null)return{};var r,n,a=Nnt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Nnt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function _g(){return _g=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_g.apply(null,arguments)}function Vz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ao(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vz(Object(r),!0).forEach(function(n){Cnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Cnt(t,e,r){return(e=_nt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _nt(t){var e=Ent(t,"string");return typeof e=="symbol"?e:e+""}function Ent(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zp={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:ac.axis};function Snt(t){var{x:e,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=ao(ao(ao({},c),ch(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=ao(ao({},u),{},{x1:e,y1:r+d*a,x2:e+n,y2:r+d*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=ao(ao({},u),{},{x1:e+f*n,y1:r,x2:e+f*n,y2:r+a})}return g.createElement("line",_g({},u,{className:as("recharts-cartesian-axis-line",vg(l,"className"))}))}function Int(t,e,r,n,a,s,o,l,c){var u,d,f,A,h,m,p=l?-1:1,x=t.tickSize||o,v=_n(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":u=d=t.coordinate,A=r+ +!l*a,f=A-p*x,m=f-p*c,h=v;break;case"left":f=A=t.coordinate,d=e+ +!l*n,u=d-p*x,h=u-p*c,m=v;break;case"right":f=A=t.coordinate,d=e+ +l*n,u=d+p*x,h=u+p*c,m=v;break;default:u=d=t.coordinate,A=r+ +l*a,f=A+p*x,m=f+p*c,h=v;break}return{line:{x1:u,y1:f,x2:d,y2:A},tick:{x:h,y:m}}}function jnt(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function Pnt(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function Bnt(t){var{option:e,tickProps:r,value:n}=t,a,s=as(r.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(e))a=g.cloneElement(e,ao(ao({},r),{},{className:s}));else if(typeof e=="function")a=e(ao(ao({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=as(o,e==null?void 0:e.className)),a=g.createElement(m3,_g({},r,{className:o}),n)}return a}var Tnt=g.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:A,y:h,width:m,height:p,tickSize:x,tickMargin:v,fontSize:y,letterSpacing:b,getTicksConfig:w,events:j,axisType:I}=t,_=vnt(ao(ao({},w),{},{ticks:r}),y,b),S=jnt(d,f),E=Pnt(d,f),B=ch(w),k=z2(n),P={};typeof a=="object"&&(P=a);var O=ao(ao({},B),{},{fill:"none"},P),z=_.map(ue=>ao({entry:ue},Int(ue,A,h,m,p,d,x,f,v))),oe=z.map(ue=>{var{entry:ge,line:ne}=ue;return g.createElement(Bc,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(ge.value,"-").concat(ge.coordinate,"-").concat(ge.tickCoord)},a&&g.createElement("line",_g({},O,ne,{className:as("recharts-cartesian-axis-tick-line",vg(a,"className"))})))}),ce=z.map((ue,ge)=>{var{entry:ne,tick:Oe}=ue,Ue=ao(ao(ao(ao({textAnchor:S,verticalAnchor:E},B),{},{stroke:"none",fill:s},k),Oe),{},{index:ge,payload:ne,visibleTicksCount:_.length,tickFormatter:o,padding:c},u);return g.createElement(Bc,_g({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ne.value,"-").concat(ne.coordinate,"-").concat(ne.tickCoord)},Ww(j,ne,ge)),n&&g.createElement(Bnt,{option:n,tickProps:Ue,value:"".concat(typeof o=="function"?o(ne.value,ge):ne.value).concat(l||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(I,"-ticks")},ce.length>0&&g.createElement(vh,{zIndex:ac.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(I,"-tick-labels"),ref:e},ce)),oe.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(I,"-tick-lines")},oe))}),knt=g.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l,axisType:c}=t,u=wnt(t,bnt),[d,f]=g.useState(""),[A,h]=g.useState(""),m=g.useRef(null);g.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var x;return ynt({ticks:m.current,label:(x=t.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var p=g.useCallback(x=>{if(x){var v=x.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=v;var y=v[0];if(y){var b=window.getComputedStyle(y),w=b.fontSize,j=b.letterSpacing;(w!==d||j!==A)&&(f(w),h(j))}}},[d,A]);return o||n!=null&&n<=0||a!=null&&a<=0?null:g.createElement(vh,{zIndex:t.zIndex},g.createElement(Bc,{className:as("recharts-cartesian-axis",s)},g.createElement(Snt,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:ch(t)}),g.createElement(Tnt,{ref:p,axisType:c,events:u,fontSize:d,getTicksConfig:t,height:t.height,letterSpacing:A,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),g.createElement(Het,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},g.createElement(Zet,{label:t.label,labelRef:t.labelRef}),t.children)))}),M8=g.forwardRef((t,e)=>{var r=kl(t,zp);return g.createElement(knt,_g({},r,{ref:e}))});M8.displayName="CartesianAxis";var Fnt={},Mue=uu({name:"errorBars",initialState:Fnt,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:lot,replaceErrorBar:cot,removeErrorBar:uot}=Mue.actions,Ont=Mue.reducer,Dnt=["children"];function Rnt(t,e){if(t==null)return{};var r,n,a=Mnt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Mnt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Lnt={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Unt=g.createContext(Lnt);function Qnt(t){var{children:e}=t,r=Rnt(t,Dnt);return g.createElement(Unt.Provider,{value:r},e)}function Lue(t,e){var r,n,a=vn(u=>HA(u,t)),s=vn(u=>$A(u,e)),o=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Ko.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:Go.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function Vnt(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=kue(),{needClipX:s,needClipY:o,needClip:l}=Lue(e,r);if(!l||!a)return null;var{x:c,y:u,width:d,height:f}=a;return g.createElement("clipPath",{id:"clipPath-".concat(n)},g.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var Hnt={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mN=g;function $nt(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Knt=typeof Object.is=="function"?Object.is:$nt,Gnt=mN.useSyncExternalStore,qnt=mN.useRef,znt=mN.useEffect,Wnt=mN.useMemo,Xnt=mN.useDebugValue;Hnt.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=qnt(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=Wnt(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,Knt(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=Gnt(t,s[0],s[1]);return znt(function(){o.hasValue=!0,o.value=l},[l]),Xnt(l),l};function Ynt(t){t()}function Jnt(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Ynt(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var Hz={notify(){},get:()=>[]};function Znt(t,e){let r,n=Hz,a=0,s=!1;function o(p){d();const x=n.subscribe(p);let v=!1;return()=>{v||(v=!0,x(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){a++,r||(r=t.subscribe(c),n=Jnt())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Hz)}function A(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:A,tryUnsubscribe:h,getListeners:()=>n};return m}var eat=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",tat=eat(),rat=()=>typeof navigator<"u"&&navigator.product==="ReactNative",nat=rat(),aat=()=>tat||nat?g.useLayoutEffect:g.useEffect,sat=aat();function $z(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function iat(t,e){if($z(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(e,r[a])||!$z(t[r[a]],e[r[a]]))return!1;return!0}var BB=Symbol.for("react-redux-context"),TB=typeof globalThis<"u"?globalThis:{};function oat(){if(!g.createContext)return{};const t=TB[BB]??(TB[BB]=new Map);let e=t.get(g.createContext);return e||(e=g.createContext(null),t.set(g.createContext,e)),e}var lat=oat();function cat(t){const{children:e,context:r,serverState:n,store:a}=t,s=g.useMemo(()=>{const c=Znt(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=g.useMemo(()=>a.getState(),[a]);sat(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||lat;return g.createElement(l.Provider,{value:s},e)}var uat=cat,dat=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function fat(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function L8(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(dat.has(n)){if(t[n]==null&&e[n]==null)continue;if(!iat(t[n],e[n]))return!1}else if(!fat(t[n],e[n]))return!1;return!0}function Gg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:Bue}function qg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:Bue}var hat="Invariant failed";function Aat(t,e){throw new Error(hat)}function pO(){return pO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pO.apply(null,arguments)}function WI(t){return g.createElement(Eue,pO({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var mat=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(_n(e))return e;var s=_n(n)||sl(n);return s?e(n,a):(s||Aat(),r)}},pat=(t,e,r)=>r,gat=(t,e)=>e,pN=tr([JM,gat],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),xat=tr([pN],t=>t==null?void 0:t.maxBarSize),vat=(t,e,r,n)=>n,yat=tr([Ta,JM,Gg,qg,pat],(t,e,r,n,a)=>e.filter(s=>t==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),bat=(t,e,r)=>{var n=Ta(t),a=Gg(t,e),s=qg(t,e);if(!(a==null||s==null))return n==="horizontal"?cO(t,"yAxis",s,r):cO(t,"xAxis",a,r)},wat=(t,e)=>{var r=Ta(t),n=Gg(t,e),a=qg(t,e);if(!(n==null||a==null))return r==="horizontal"?$q(t,"xAxis",n):$q(t,"yAxis",a)},Nat=tr([yat,$Xe,wat],Krt),Cat=(t,e,r)=>{var n,a,s=pN(t,e);if(s!=null){var o=Gg(t,e),l=qg(t,e);if(!(o==null||l==null)){var c=Ta(t),u=qle(t),{maxBarSize:d}=s,f=sl(d)?u:d,A,h;return c==="horizontal"?(A=Jv(t,"xAxis",o,r),h=Yv(t,"xAxis",o,r)):(A=Jv(t,"yAxis",l,r),h=Yv(t,"yAxis",l,r)),(n=(a=NI(A,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0}}},Uue=(t,e,r)=>{var n=Ta(t),a=Gg(t,e),s=qg(t,e);if(!(a==null||s==null)){var o,l;return n==="horizontal"?(o=Jv(t,"xAxis",a,r),l=Yv(t,"xAxis",a,r)):(o=Jv(t,"yAxis",s,r),l=Yv(t,"yAxis",s,r)),NI(o,l)}},_at=tr([Nat,qle,HXe,zle,Cat,Uue,xat],Xrt),Eat=(t,e,r)=>{var n=Gg(t,e);if(n!=null)return Jv(t,"xAxis",n,r)},Sat=(t,e,r)=>{var n=qg(t,e);if(n!=null)return Jv(t,"yAxis",n,r)},Iat=(t,e,r)=>{var n=Gg(t,e);if(n!=null)return Yv(t,"xAxis",n,r)},jat=(t,e,r)=>{var n=qg(t,e);if(n!=null)return Yv(t,"yAxis",n,r)},Pat=tr([_at,pN],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),Bat=tr([bat,pN],Yrt),Tat=tr([Ro,hM,Eat,Sat,Iat,jat,Pat,Ta,BXe,Uue,Bat,pN,vat],(t,e,r,n,a,s,o,l,c,u,d,f,A)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:p}=c;if(!(f==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||u==null)){var{data:x}=f,v;if(x!=null&&x.length>0?v=x:v=h==null?void 0:h.slice(m,p+1),v!=null)return ost({layout:l,barSettings:f,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:v,offset:t,cells:A,dataStartIndex:m})}}),kat=["index"];function gO(){return gO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gO.apply(null,arguments)}function Fat(t,e){if(t==null)return{};var r,n,a=Oat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Oat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Que=g.createContext(void 0),Dat=t=>{var e=g.useContext(Que);if(e!=null)return e.stackId;if(t!=null)return TKe(t)},Rat=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),Mat=t=>{var e=g.useContext(Que);if(e!=null){var{stackId:r}=e;return"url(#".concat(Rat(r,t),")")}},Lat=t=>{var{index:e}=t,r=Fat(t,kat),n=Mat(e);return g.createElement(Bc,gO({className:"recharts-bar-stack-layer",clipPath:n},r))},Uat=["onMouseEnter","onMouseLeave","onClick"],Qat=["value","background","tooltipPosition"],Vat=["id"],Hat=["onMouseEnter","onClick","onMouseLeave"];function IA(){return IA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IA.apply(null,arguments)}function Kz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Cc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Kz(Object(r),!0).forEach(function(n){$at(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Kz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $at(t,e,r){return(e=Kat(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kat(t){var e=Gat(t,"string");return typeof e=="symbol"?e:e+""}function Gat(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XI(t,e){if(t==null)return{};var r,n,a=qat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function qat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var zat=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:s}=t;return[{inactive:s,dataKey:e,type:a,color:n,value:LP(r,e),payload:t}]},Wat=g.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l,tooltipType:c,id:u}=t,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:LP(s,e),hide:o,type:c,color:a,unit:l,graphicalItemId:u}};return g.createElement(Sue,{tooltipEntrySettings:d})});function Xat(t){var e=vn(Cg),{data:r,dataKey:n,background:a,allOtherBarProps:s}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=XI(s,Uat),d=F8(o,n,s.id),f=O8(l),A=D8(c,n,s.id);if(!a||r==null)return null;var h=z2(a);return g.createElement(vh,{zIndex:Jrt(a,ac.barBackground)},r.map((m,p)=>{var{value:x,background:v,tooltipPosition:y}=m,b=XI(m,Qat);if(!v)return null;var w=d(m,p),j=f(m,p),I=A(m,p),_=Cc(Cc(Cc(Cc(Cc({option:a,isActive:String(p)===e},b),{},{fill:"#eee"},v),h),Ww(u,m,p)),{},{onMouseEnter:w,onMouseLeave:j,onClick:I,dataKey:n,index:p,className:"recharts-bar-background-rectangle"});return g.createElement(WI,IA({key:"background-bar-".concat(p)},_))}))}function Yat(t){var{showLabels:e,children:r,rects:n}=t,a=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Cc(Cc({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return g.createElement(itt,{value:e?a:void 0},r)}function Jat(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=t,l=vn(Cg),c=vn(N8),u=r&&String(s)===l&&(c==null||o===c),d=u?r:e;return u?g.createElement(vh,{zIndex:ac.activeBar},g.createElement(WI,IA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))):g.createElement(WI,IA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))}function Zat(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:s}=t;return g.createElement(WI,IA({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:a,dataKey:s}))}function est(t){var e,{data:r,props:n}=t,a=(e=ch(n))!==null&&e!==void 0?e:{},{id:s}=a,o=XI(a,Vat),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:A}=n,h=XI(n,Hat),m=F8(d,c,s),p=O8(A),x=D8(f,c,s);return r?g.createElement(g.Fragment,null,r.map((v,y)=>g.createElement(Lat,IA({index:y,key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(y),className:"recharts-bar-rectangle"},Ww(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),u?g.createElement(Jat,{shape:l,activeBar:u,baseProps:o,entry:v,index:y,dataKey:c}):g.createElement(Zat,{shape:l,baseProps:o,entry:v,index:y,dataKey:c})))):null}function tst(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=e,f=r.current,A=YP(e,"recharts-bar-"),[h,m]=g.useState(!1),p=!h,x=g.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),v=g.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return g.createElement(Yat,{showLabels:p,rects:n},g.createElement(XP,{animationId:A,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:x,onAnimationStart:v,key:A},y=>{var b=y===1?n:n==null?void 0:n.map((w,j)=>{var I=f&&f[j];if(I)return Cc(Cc({},w),{},{x:Eo(I.x,w.x,y),y:Eo(I.y,w.y,y),width:Eo(I.width,w.width,y),height:Eo(I.height,w.height,y)});if(a==="horizontal"){var _=Eo(0,w.height,y),S=Eo(w.stackedBarStart,w.y,y);return Cc(Cc({},w),{},{y:S,height:_})}var E=Eo(0,w.width,y),B=Eo(w.stackedBarStart,w.x,y);return Cc(Cc({},w),{},{width:E,x:B})});return y>0&&(r.current=b??null),b==null?null:g.createElement(Bc,null,g.createElement(est,{props:e,data:b}))}),g.createElement(xue,{label:e.label}),e.children)}function rst(t){var e=g.useRef(null);return g.createElement(tst,{previousRectanglesRef:e,props:t})}var Vue=0,nst=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:ks(t,e)}};class ast extends g.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var d=as("recharts-bar",a),f=u;return g.createElement(Bc,{className:d,id:u},l&&g.createElement("defs",null,g.createElement(Vnt,{clipPathId:f,xAxisId:s,yAxisId:o})),g.createElement(Bc,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},g.createElement(Xat,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),g.createElement(rst,this.props)))}}var sst={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:Vue,xAxisId:0,yAxisId:0,zIndex:ac.bar};function ist(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=t,{needClip:f}=Lue(e,r),A=Zw(),h=qu(),m=k8(t.children,AN),p=vn(y=>Tat(y,t.id,h,m));if(A!=="vertical"&&A!=="horizontal")return null;var x,v=p==null?void 0:p[0];return v==null||v.height==null||v.width==null?x=0:x=A==="vertical"?v.height/2:v.width/2,g.createElement(Qnt,{xAxisId:e,yAxisId:r,data:p,dataPointFormatter:nst,errorBarOffset:x},g.createElement(ast,IA({},t,{layout:A,needClip:f,data:p,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function ost(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:A,cells:h,parentViewBox:m,dataStartIndex:p}=t,x=e==="horizontal"?l:o,v=d?x.scale.domain():null,y=kKe({numericAxis:x}),b=x.scale(y);return f.map((w,j)=>{var I,_,S,E,B,k;if(d){var P=d[j+p];if(P==null)return null;I=SKe(P,v)}else I=ks(w,r),Array.isArray(I)||(I=[y,I]);var O=mat(n,Vue)(I[1],j);if(e==="horizontal"){var z,[oe,ce]=[l.scale(I[0]),l.scale(I[1])];_=eG({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:w,index:j}),S=(z=ce??oe)!==null&&z!==void 0?z:void 0,E=a.size;var ue=oe-ce;if(B=uh(ue)?0:ue,k={x:_,y:A.top,width:E,height:A.height},Math.abs(O)>0&&Math.abs(B)<Math.abs(O)){var ge=Pl(B||O)*(Math.abs(O)-Math.abs(B));S-=ge,B+=ge}}else{var[ne,Oe]=[o.scale(I[0]),o.scale(I[1])];if(_=ne,S=eG({axis:l,ticks:u,bandSize:s,offset:a.offset,entry:w,index:j}),E=Oe-ne,B=a.size,k={x:A.left,y:S,width:A.width,height:B},Math.abs(O)>0&&Math.abs(E)<Math.abs(O)){var Ue=Pl(E||O)*(Math.abs(O)-Math.abs(E));E+=Ue}}if(_==null||S==null||E==null||B==null)return null;var F=Cc(Cc({},w),{},{stackedBarStart:b,x:_,y:S,width:E,height:B,value:d?I:I[1],payload:w,background:k,tooltipPosition:{x:_+E/2,y:S+B/2},parentViewBox:m},h&&h[j]&&h[j].props);return F}).filter(Boolean)}function lst(t){var e=kl(t,sst),r=Dat(e.stackId),n=qu();return g.createElement(Iue,{id:e.id,type:"bar"},a=>g.createElement(g.Fragment,null,g.createElement($tt,{legendPayload:zat(e)}),g.createElement(Wat,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:a}),g.createElement(art,{type:"bar",id:a,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),g.createElement(vh,{zIndex:e.zIndex},g.createElement(ist,IA({},e,{id:a})))))}var xO=g.memo(lst,L8);xO.displayName="Bar";var cst=["domain","range"],ust=["domain","range"];function Gz(t,e){if(t==null)return{};var r,n,a=dst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function dst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function qz(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function Hue(t,e){if(t===e)return!0;var{domain:r,range:n}=t,a=Gz(t,cst),{domain:s,range:o}=e,l=Gz(e,ust);return!qz(r,s)||!qz(n,o)?!1:L8(a,l)}var fst=["dangerouslySetInnerHTML","ticks","scale"],hst=["id","scale"];function vO(){return vO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vO.apply(null,arguments)}function zz(t,e){if(t==null)return{};var r,n,a=Ast(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Ast(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function mst(t){var e=Cs(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Ort(t)):r.current!==t&&e(Drt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(Rrt(r.current)),r.current=null)},[e]),null}var pst=t=>{var{xAxisId:e,className:r}=t,n=vn(hM),a=qu(),s="xAxis",o=vn(v=>Ece(v,s,e,a)),l=vn(v=>wce(v,e)),c=vn(v=>QYe(v,e)),u=vn(v=>nce(v,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:A}=t,h=zz(t,fst),{id:m,scale:p}=u,x=zz(u,hst);return g.createElement(M8,vO({},h,x,{x:c.x,y:c.y,width:l.width,height:l.height,className:as("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},gst={allowDataOverflow:Ko.allowDataOverflow,allowDecimals:Ko.allowDecimals,allowDuplicatedCategory:Ko.allowDuplicatedCategory,angle:Ko.angle,axisLine:zp.axisLine,height:Ko.height,hide:!1,includeHidden:Ko.includeHidden,interval:Ko.interval,minTickGap:Ko.minTickGap,mirror:Ko.mirror,orientation:Ko.orientation,padding:Ko.padding,reversed:Ko.reversed,scale:Ko.scale,tick:Ko.tick,tickCount:Ko.tickCount,tickLine:zp.tickLine,tickSize:zp.tickSize,type:Ko.type,xAxisId:0},xst=t=>{var e=kl(t,gst);return g.createElement(g.Fragment,null,g.createElement(mst,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),g.createElement(pst,e))},$ue=g.memo(xst,Hue);$ue.displayName="XAxis";var vst=["dangerouslySetInnerHTML","ticks","scale"],yst=["id","scale"];function yO(){return yO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yO.apply(null,arguments)}function Wz(t,e){if(t==null)return{};var r,n,a=bst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function bst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function wst(t){var e=Cs(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Mrt(t)):r.current!==t&&e(Lrt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(Urt(r.current)),r.current=null)},[e]),null}var Nst=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,s=g.useRef(null),o=g.useRef(null),l=vn(hM),c=qu(),u=Cs(),d="yAxis",f=vn(I=>Nce(I,e)),A=vn(I=>HYe(I,e)),h=vn(I=>Ece(I,d,e,c)),m=vn(I=>ace(I,e));if(g.useLayoutEffect(()=>{if(!(n!=="auto"||!f||I8(a)||g.isValidElement(a)||m==null)){var I=s.current;if(I){var _=I.getCalculatedWidth();Math.round(f.width)!==Math.round(_)&&u(Qrt({id:e,width:_}))}}},[h,f,u,a,e,n,m]),f==null||A==null||m==null)return null;var{dangerouslySetInnerHTML:p,ticks:x,scale:v}=t,y=Wz(t,vst),{id:b,scale:w}=m,j=Wz(m,yst);return g.createElement(M8,yO({},y,j,{ref:s,labelRef:o,x:A.x,y:A.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:as("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:h,axisType:d}))},Cst={allowDataOverflow:Go.allowDataOverflow,allowDecimals:Go.allowDecimals,allowDuplicatedCategory:Go.allowDuplicatedCategory,angle:Go.angle,axisLine:zp.axisLine,hide:!1,includeHidden:Go.includeHidden,interval:Go.interval,minTickGap:Go.minTickGap,mirror:Go.mirror,orientation:Go.orientation,padding:Go.padding,reversed:Go.reversed,scale:Go.scale,tick:Go.tick,tickCount:Go.tickCount,tickLine:zp.tickLine,tickSize:zp.tickSize,type:Go.type,width:Go.width,yAxisId:0},_st=t=>{var e=kl(t,Cst);return g.createElement(g.Fragment,null,g.createElement(wst,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),g.createElement(Nst,e))},Kue=g.memo(_st,Hue);Kue.displayName="YAxis";var Est=(t,e)=>e,U8=tr([Est,Ta,tce,Lo,Vce,KA,aZe,Ro],dZe),Q8=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Gue=Rd("mouseClick"),que=Yw();que.startListening({actionCreator:Gue,effect:(t,e)=>{var r=t.payload,n=U8(e.getState(),Q8(r));(n==null?void 0:n.activeIndex)!=null&&e.dispatch(nJe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var bO=Rd("mouseMove"),zue=Yw(),B_=null;zue.startListening({actionCreator:bO,effect:(t,e)=>{var r=t.payload;B_!==null&&cancelAnimationFrame(B_);var n=Q8(r);B_=requestAnimationFrame(()=>{var a=e.getState(),s=g8(a,a.tooltip.settings.shared);if(s==="axis"){var o=U8(a,n);(o==null?void 0:o.activeIndex)!=null?e.dispatch(Fce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(kce())}B_=null})}});function Sst(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var Xz={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},Wue=uu({name:"rootProps",initialState:Xz,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:Xz.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),Ist=Wue.reducer,{updateOptions:jst}=Wue.actions,Xue=uu({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:Pst}=Xue.actions,Bst=Xue.reducer,Yue=Rd("keyDown"),Jue=Rd("focus"),V8=Yw();V8.startListening({actionCreator:Yue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=t.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=x8(a,T1(r),cN(r),fN(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=KA(r);if(s==="Enter"){var u=KI(r,"axis","hover",String(a.index));e.dispatch(dO({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=qYe(r),f=d==="left-to-right"?1:-1,A=s==="ArrowRight"?1:-1,h=l+A*f;if(!(c==null||h>=c.length||h<0)){var m=KI(r,"axis","hover",String(h));e.dispatch(dO({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});V8.startListening({actionCreator:Jue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=KI(r,"axis","hover",String(s));e.dispatch(dO({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var fd=Rd("externalEvent"),Zue=Yw(),kB=new Map;Zue.startListening({actionCreator:fd,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var a=n.type,s=kB.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:HJe(l),activeDataKey:N8(l),activeIndex:Cg(l),activeLabel:Kce(l),activeTooltipIndex:Cg(l),isTooltipActive:$Je(l)};r(c,n)}finally{kB.delete(a)}});kB.set(a,o)}}});var Tst=tr([P1],t=>t.tooltipItemPayloads),kst=tr([Tst,dN,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(l=>l.settings.graphicalItemId===n);if(a!=null){var{positions:s}=a;if(s!=null){var o=e(s,r);return o}}}),ede=Rd("touchMove"),tde=Yw();tde.startListening({actionCreator:ede,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),a=g8(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var o=U8(n,Q8({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&e.dispatch(Fce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(xoe),f=(l=u.getAttribute(voe))!==null&&l!==void 0?l:void 0,A=B1(n).find(p=>p.id===f);if(d==null||A==null||f==null)return;var{dataKey:h}=A,m=kst(n,d,f);e.dispatch(Tce({activeDataKey:h,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var Fst=Vie({brush:Zrt,cartesianAxis:Vrt,chartData:QZe,errorBars:Ont,graphicalItems:rrt,layout:bKe,legend:EGe,options:DZe,polarAxis:gtt,polarOptions:Bst,referenceElements:int,rootProps:Ist,tooltip:aJe,zIndex:_Ze}),Ost=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return G$e({reducer:Fst,preloadedState:e,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([que.middleware,zue.middleware,V8.middleware,Zue.middleware,tde.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(noe({type:"raf"}))},devTools:{serialize:{replacer:Sst},name:"recharts-".concat(r)}})};function rde(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=qu(),s=g.useRef(null);if(a)return r;s.current==null&&(s.current=Ost(e,n));var o=aM;return g.createElement(uat,{context:o,store:s.current},r)}function Dst(t){var{layout:e,margin:r}=t,n=Cs(),a=qu();return g.useEffect(()=>{a||(n(xKe(e)),n(gKe(r)))},[n,a,e,r]),null}var nde=g.memo(Dst,L8);function ade(t){var e=Cs();return g.useEffect(()=>{e(jst(t))},[e,t]),null}function Yz(t){var{zIndex:e,isPanorama:r}=t,n=g.useRef(null),a=Cs();return g.useLayoutEffect(()=>(n.current&&a(NZe({zIndex:e,element:n.current,isPanorama:r})),()=>{a(CZe({zIndex:e,isPanorama:r}))}),[a,e,r]),g.createElement("g",{tabIndex:-1,ref:n})}function Jz(t){var{children:e,isPanorama:r}=t,n=vn(hZe);if(!n||n.length===0)return e;var a=n.filter(o=>o<0),s=n.filter(o=>o>0);return g.createElement(g.Fragment,null,a.map(o=>g.createElement(Yz,{key:o,zIndex:o,isPanorama:r})),e,s.map(o=>g.createElement(Yz,{key:o,zIndex:o,isPanorama:r})))}var Rst=["children"];function Mst(t,e){if(t==null)return{};var r,n,a=Lst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Lst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function YI(){return YI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},YI.apply(null,arguments)}var Ust={width:"100%",height:"100%",display:"block"},Qst=g.forwardRef((t,e)=>{var r=Soe(),n=Ioe(),a=Loe();if(!Bm(r)||!Bm(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=t,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0),g.createElement(HR,YI({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:Ust,ref:e}),s)}),Vst=t=>{var{children:e}=t,r=vn(HP);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return g.createElement(HR,{width:n,height:a,x:o,y:s},e)},Zz=g.forwardRef((t,e)=>{var{children:r}=t,n=Mst(t,Rst),a=qu();return a?g.createElement(Vst,null,g.createElement(Jz,{isPanorama:!0},r)):g.createElement(Qst,YI({ref:e},n),g.createElement(Jz,{isPanorama:!1},r))});function Hst(){var t=Cs(),[e,r]=g.useState(null),n=vn(LKe);return g.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),s=a.width/e.offsetWidth;Ai(s)&&s!==n&&t(yKe(s))}},[e,t,n]),r}function eW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function $st(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eW(Object(r),!0).forEach(function(n){Kst(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kst(t,e,r){return(e=Gst(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gst(t){var e=qst(t,"string");return typeof e=="symbol"?e:e+""}function qst(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eg(){return Eg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Eg.apply(null,arguments)}var zst=()=>(XZe(),null);function JI(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var Wst=g.forwardRef((t,e)=>{var r,n,a=g.useRef(null),[s,o]=g.useState({containerWidth:JI((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:JI((n=t.style)===null||n===void 0?void 0:n.height)}),l=g.useCallback((u,d)=>{o(f=>{var A=Math.round(u),h=Math.round(d);return f.containerWidth===A&&f.containerHeight===h?f:{containerWidth:A,containerHeight:h}})},[]),c=g.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var A=m=>{var{width:p,height:x}=m[0].contentRect;l(p,x)},h=new ResizeObserver(A);h.observe(u),a.current=h}},[e,l]);return g.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[l]),g.createElement(g.Fragment,null,g.createElement(KP,{width:s.containerWidth,height:s.containerHeight}),g.createElement("div",Eg({ref:c},t)))}),Xst=g.forwardRef((t,e)=>{var{width:r,height:n}=t,[a,s]=g.useState({containerWidth:JI(r),containerHeight:JI(n)}),o=g.useCallback((c,u)=>{s(d=>{var f=Math.round(c),A=Math.round(u);return d.containerWidth===f&&d.containerHeight===A?d:{containerWidth:f,containerHeight:A}})},[]),l=g.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[e,o]);return g.createElement(g.Fragment,null,g.createElement(KP,{width:a.containerWidth,height:a.containerHeight}),g.createElement("div",Eg({ref:l},t)))}),Yst=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return g.createElement(g.Fragment,null,g.createElement(KP,{width:r,height:n}),g.createElement("div",Eg({ref:e},t)))}),Jst=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return wA(r)||wA(n)?g.createElement(Xst,Eg({},t,{ref:e})):g.createElement(Yst,Eg({},t,{ref:e}))});function Zst(t){return t===!0?Wst:Jst}var eit=g.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:A,onTouchEnd:h,onTouchMove:m,onTouchStart:p,style:x,width:v,responsive:y,dispatchTouchEvents:b=!0}=t,w=g.useRef(null),j=Cs(),[I,_]=g.useState(null),[S,E]=g.useState(null),B=Hst(),k=AM(),P=(k==null?void 0:k.width)>0?k.width:v,O=(k==null?void 0:k.height)>0?k.height:a,z=g.useCallback(V=>{B(V),typeof e=="function"&&e(V),_(V),E(V),V!=null&&(w.current=V)},[B,e,_,E]),oe=g.useCallback(V=>{j(Gue(V)),j(fd({handler:s,reactEvent:V}))},[j,s]),ce=g.useCallback(V=>{j(bO(V)),j(fd({handler:u,reactEvent:V}))},[j,u]),ue=g.useCallback(V=>{j(kce()),j(fd({handler:d,reactEvent:V}))},[j,d]),ge=g.useCallback(V=>{j(bO(V)),j(fd({handler:f,reactEvent:V}))},[j,f]),ne=g.useCallback(()=>{j(Jue())},[j]),Oe=g.useCallback(V=>{j(Yue(V.key))},[j]),Ue=g.useCallback(V=>{j(fd({handler:o,reactEvent:V}))},[j,o]),F=g.useCallback(V=>{j(fd({handler:l,reactEvent:V}))},[j,l]),H=g.useCallback(V=>{j(fd({handler:c,reactEvent:V}))},[j,c]),K=g.useCallback(V=>{j(fd({handler:A,reactEvent:V}))},[j,A]),U=g.useCallback(V=>{j(fd({handler:p,reactEvent:V}))},[j,p]),W=g.useCallback(V=>{b&&j(ede(V)),j(fd({handler:m,reactEvent:V}))},[j,b,m]),X=g.useCallback(V=>{j(fd({handler:h,reactEvent:V}))},[j,h]),D=Zst(y);return g.createElement(Jce.Provider,{value:I},g.createElement(Hse.Provider,{value:S},g.createElement(D,{width:P??(x==null?void 0:x.width),height:O??(x==null?void 0:x.height),className:as("recharts-wrapper",n),style:$st({position:"relative",cursor:"default",width:P,height:O},x),onClick:oe,onContextMenu:Ue,onDoubleClick:F,onFocus:ne,onKeyDown:Oe,onMouseDown:H,onMouseEnter:ce,onMouseLeave:ue,onMouseMove:ge,onMouseUp:K,onTouchEnd:X,onTouchMove:W,onTouchStart:U,ref:z},g.createElement(zst,null),r)))}),tit=["width","height","responsive","children","className","style","compact","title","desc"];function rit(t,e){if(t==null)return{};var r,n,a=nit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function nit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var sde=g.forwardRef((t,e)=>{var{width:r,height:n,responsive:a,children:s,className:o,style:l,compact:c,title:u,desc:d}=t,f=rit(t,tit),A=ch(f);return c?g.createElement(g.Fragment,null,g.createElement(KP,{width:r,height:n}),g.createElement(Zz,{otherAttributes:A,title:u,desc:d},s)):g.createElement(eit,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},g.createElement(Zz,{otherAttributes:A,title:u,desc:d,ref:e},g.createElement(lnt,null,s)))});function wO(){return wO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wO.apply(null,arguments)}var ait={top:5,right:5,bottom:5,left:5},sit={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:ait,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},iit=g.forwardRef(function(e,r){var n,a=kl(e.categoricalChartProps,sit),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return g.createElement(rde,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},g.createElement(Fue,{chartData:u.data}),g.createElement(nde,{layout:a.layout,margin:a.margin}),g.createElement(ade,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(sde,wO({},a,{ref:r})))}),oit=["axis","item"],lit=g.forwardRef((t,e)=>g.createElement(iit,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:oit,tooltipPayloadSearcher:eue,categoricalChartProps:t,ref:e}));function cit(t){var e=Cs();return g.useEffect(()=>{e(Pst(t))},[e,t]),null}var uit=["layout"];function NO(){return NO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NO.apply(null,arguments)}function dit(t,e){if(t==null)return{};var r,n,a=fit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function fit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var hit={top:5,right:5,bottom:5,left:5},ide={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:hit,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Ait=g.forwardRef(function(e,r){var n,a=kl(e.categoricalChartProps,ide),{layout:s}=a,o=dit(a,uit),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return g.createElement(rde,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},g.createElement(Fue,{chartData:a.data}),g.createElement(nde,{layout:s,margin:a.margin}),g.createElement(ade,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(cit,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),g.createElement(sde,NO({},o,{ref:r})))});function tW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tW(Object(r),!0).forEach(function(n){mit(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mit(t,e,r){return(e=pit(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pit(t){var e=git(t,"string");return typeof e=="symbol"?e:e+""}function git(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xit=["item"],vit=rW(rW({},ide),{},{layout:"centric",startAngle:0,endAngle:360}),yit=g.forwardRef((t,e)=>{var r=kl(t,vit);return g.createElement(Ait,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:xit,tooltipPayloadSearcher:eue,categoricalChartProps:r,ref:e})});const bit="sellers_candies",T_="cash_deliveries_candies";function Oa(t){const e=typeof t=="number"?t:parseFloat(String(t??"").replace(/,/g,""));return Number.isFinite(e)?e:0}function Di(t){return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function k_(t,e){return t*e/100}function F_(t,e,r){return t-e-r}function nW(t){return t?Ur(t.toDate(),"yyyy-MM-dd"):""}function O_(t){if(!t)return xr.fromDate(new Date);const[e,r,n]=t.split("-").map(s=>parseInt(s,10)),a=new Date(e,(r||1)-1,n||1,0,0,0,0);return xr.fromDate(a)}function wit(){const t=new Date,[e,r]=g.useState(Ur(Ud(t),"yyyy-MM-dd")),[n,a]=g.useState(Ur(Ld(t),"yyyy-MM-dd")),[s,o]=g.useState([]),l=g.useMemo(()=>{const D=new Map;return s.forEach(V=>D.set(V.id,V)),D},[s]),[c,u]=g.useState([]),[d,f]=g.useState(!0),[A,h]=g.useState(()=>Ur(new Date,"yyyy-MM-dd")),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState("0"),[w,j]=g.useState(""),[I,_]=g.useState(null),[S,E]=g.useState({}),B=g.useRef(null);g.useEffect(()=>{const D=sr(bt(Pe,bit),In("name","asc")),V=jd(D,Z=>{const be=Z.docs.map(L=>{const Xe=L.data();return{id:L.id,name:String((Xe==null?void 0:Xe.name)??""),branch:Xe!=null&&Xe.branch?String(Xe.branch):"",commissionPercent:Oa((Xe==null?void 0:Xe.commissionPercent)??0)}});o(be)},()=>o([]));return()=>V()},[]),g.useEffect(()=>{f(!0);const D=O_(e),V=new Date(O_(n).toDate().getTime());V.setDate(V.getDate()+1);const Z=xr.fromDate(V),be=sr(bt(Pe,T_),Ar("date",">=",D),Ar("date","<",Z),In("date","desc")),L=jd(be,Xe=>{const re=Xe.docs.map(J=>{const De=J.data();return{id:J.id,date:De==null?void 0:De.date,sellerId:String((De==null?void 0:De.sellerId)??""),sellerName:String((De==null?void 0:De.sellerName)??""),amountDelivered:Oa(De==null?void 0:De.amountDelivered),commissionPercent:Oa(De==null?void 0:De.commissionPercent),commissionPaid:Oa(De==null?void 0:De.commissionPaid),extraExpenses:Oa(De==null?void 0:De.extraExpenses),totalFinal:Oa(De==null?void 0:De.totalFinal),comment:String((De==null?void 0:De.comment)??""),createdAt:De==null?void 0:De.createdAt,updatedAt:De==null?void 0:De.updatedAt}});u(re),f(!1)},Xe=>{console.error("Firestore deliveries query error:",Xe),u([]),f(!1),alert("Firestore query fall. Revis consola (probable ndice).")});return()=>L()},[e,n]);const k=g.useMemo(()=>m?l.get(m):void 0,[m,l]),P=Oa((k==null?void 0:k.commissionPercent)??0),O=Oa(x),z=Oa(y),oe=k_(O,P),ce=F_(O,oe,z),ue=g.useMemo(()=>{var V;const D=new Map;for(const Z of c){const be=Z.sellerId||Z.sellerName||"UNKNOWN",L=D.get(be)??{sellerId:Z.sellerId,sellerName:Z.sellerName||((V=l.get(Z.sellerId))==null?void 0:V.name)||"Sin nombre",delivered:0,commission:0,totalFinal:0};L.delivered+=Oa(Z.amountDelivered),L.commission+=Oa(Z.commissionPaid),L.totalFinal+=Oa(Z.totalFinal),D.set(be,L)}return Array.from(D.values()).sort((Z,be)=>Z.sellerName.localeCompare(be.sellerName))},[c,l]),ge=g.useMemo(()=>{let D=0,V=0,Z=0,be=0;for(const L of c)D+=Oa(L.amountDelivered),V+=Oa(L.commissionPaid),Z+=Oa(L.extraExpenses),be+=Oa(L.totalFinal);return{delivered:D,commission:V,expenses:Z,totalFinal:be}},[c]),ne=g.useMemo(()=>ue.map(D=>({name:D.sellerName,Entregado:Number(D.delivered.toFixed(2)),Comision:Number(D.commission.toFixed(2))})),[ue]),Oe=g.useMemo(()=>[{name:"Total Entregado (Bruto)",value:Number(ge.delivered.toFixed(2))},{name:"Total Comisin",value:Number(ge.commission.toFixed(2))},{name:"Total Gastos",value:Number(ge.expenses.toFixed(2))}].filter(D=>D.value>0),[ge]),Ue=["#3B82F6","#F59E0B","#EF4444"];async function F(){if(!m)return alert("Seleccion un vendedor.");if(O<=0)return alert("Ingres un Monto entregado vlido (> 0).");const D=l.get(m),V=(D==null?void 0:D.name)??"Sin nombre",Z=Oa((D==null?void 0:D.commissionPercent)??0),be=k_(O,Z),L=F_(O,be,z);await Zn(bt(Pe,T_),{date:O_(A),sellerId:m,sellerName:V,amountDelivered:O,commissionPercent:Z,commissionPaid:be,extraExpenses:z,totalFinal:L,comment:w??"",createdAt:xr.now()}),v(""),b("0"),j("")}function H(D){_(D.id),E({...D,dateInput:nW(D.date)})}function K(){_(null),E({})}async function U(D){const V=S,Z=String(V.sellerId??""),be=l.get(Z),L=String(V.sellerName??(be==null?void 0:be.name)??"Sin nombre"),Xe=Oa(V.amountDelivered),re=Oa(V.extraExpenses),J=Oa(V.commissionPercent??(be==null?void 0:be.commissionPercent)??0),De=k_(Xe,J),ie=F_(Xe,De,re),He=O_(String(V.dateInput??nW(V.date)));await Fn(er(Pe,T_,D),{date:He,sellerId:Z,sellerName:L,amountDelivered:Xe,commissionPercent:J,commissionPaid:De,extraExpenses:re,totalFinal:ie,comment:String(V.comment??""),updatedAt:xr.now()}),K()}async function W(D){confirm("Eliminar este registro?")&&await qn(er(Pe,T_,D))}async function X(){if(!B.current)return;const D=await Fg(B.current,{scale:2,useCORS:!0,backgroundColor:"#ffffff",scrollX:0,scrollY:-window.scrollY}),V=D.toDataURL("image/png"),Z=new an("p","mm","a4"),be=Z.internal.pageSize.getWidth(),L=Z.internal.pageSize.getHeight(),Xe=be,re=D.height*Xe/D.width;let J=re,De=0;for(Z.addImage(V,"PNG",0,De,Xe,re),J-=L;J>0;)Z.addPage(),De=-(re-J),Z.addImage(V,"PNG",0,De,Xe,re),J-=L;Z.save(`Entregas_Dulces_${e}_a_${n}.pdf`)}return i.jsxs("div",{className:"p-3 md:p-6 max-w-7xl mx-auto space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-2xl font-black text-gray-900",children:"Control Contable - Entregas de Vendedores (Dulces)"}),i.jsxs("p",{className:"text-xs md:text-sm text-gray-600",children:["Periodo: ",i.jsx("span",{className:"font-bold",children:e})," "," ",i.jsx("span",{className:"font-bold",children:n})]})]}),i.jsx("button",{onClick:X,className:"h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Exportar a PDF"})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Filtros de periodo"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:e,onChange:D=>r(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:n,onChange:D=>a(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]})]}),i.jsxs("div",{ref:B,className:"space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"KPIs Consolidados"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Entradas (Neto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Di(ge.totalFinal)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Entregado - Comisin - Gastos"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Comisiones"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Di(ge.commission)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de comisin pagada"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Gastos extras"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Di(ge.expenses)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de gastos registrados"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"Total entregado (Bruto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Di(ge.delivered)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Sin restar nada"})]})]}),i.jsx("div",{className:"font-black text-sm text-gray-900 mt-4 mb-2",children:"KPI Vendedores (sumatoria del periodo)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[520px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"})]})}),i.jsx("tbody",{children:ue.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-2 text-gray-500",colSpan:4,children:"Sin datos en el periodo seleccionado."})}):ue.map(D=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Di(D.delivered)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Di(D.commission)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Di(D.totalFinal)]})]},D.sellerId||D.sellerName))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Entregas y Comisin por vendedor (Barras)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(lG,{children:i.jsxs(lit,{data:ne,children:[i.jsx($ue,{dataKey:"name",interval:0,angle:-12,height:70}),i.jsx(Kue,{}),i.jsx(iz,{}),i.jsx(qF,{}),i.jsx(xO,{dataKey:"Entregado"}),i.jsx(xO,{dataKey:"Comision"})]})})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Distribucin (Pastel)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(lG,{children:i.jsxs(yit,{children:[i.jsx(Pue,{data:Oe,dataKey:"value",nameKey:"name",outerRadius:110,label:!0,children:Oe.map((D,V)=>i.jsx(AN,{fill:Ue[V%Ue.length]},V))}),i.jsx(iz,{}),i.jsx(qF,{})]})})})]})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Agregar movimiento"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:A,onChange:D=>h(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:m,onChange:D=>p(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10 bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",inputMode:"decimal",value:x,onChange:D=>v(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin configurada"}),i.jsx("input",{value:`${P}%`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin pagada"}),i.jsx("input",{value:`$ ${Di(oe)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",inputMode:"decimal",value:y,onChange:D=>b(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Total final"}),i.jsx("input",{value:`$ ${Di(ce)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-900 font-extrabold"})]}),i.jsxs("label",{className:"space-y-1 md:col-span-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{value:w,onChange:D=>j(D.target.value),placeholder:"Opcional...",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:F,className:"w-full md:w-auto h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Guardar movimiento"})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Registro detallado"}),d?i.jsx("div",{className:"text-sm text-gray-500",children:"Cargando..."}):c.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay registros en el periodo."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Monto entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin %"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin pagada"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Comentario"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Acciones"})]})}),i.jsx("tbody",{children:c.map(D=>{if(!(I===D.id))return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Ur(D.date.toDate(),"yyyy-MM-dd")}),i.jsx("td",{className:"p-2 font-semibold",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Di(D.amountDelivered)]}),i.jsxs("td",{className:"p-2 text-right",children:[Di(D.commissionPercent),"%"]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Di(D.commissionPaid)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Di(D.extraExpenses)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Di(D.totalFinal)]}),i.jsx("td",{className:"p-2",children:D.comment}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>W(D.id),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},D.id);const Z=Oa(S.amountDelivered??D.amountDelivered),be=Oa(S.commissionPercent??D.commissionPercent),L=Oa(S.extraExpenses??D.extraExpenses),Xe=k_(Z,be),re=F_(Z,Xe,L);return i.jsxs("tr",{className:"border-t bg-yellow-50/40",children:[i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:J=>E(De=>({...De,dateInput:J.target.value})),className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("select",{value:String(S.sellerId??D.sellerId),onChange:J=>{const De=J.target.value,ie=l.get(De);E(He=>({...He,sellerId:De,sellerName:(ie==null?void 0:ie.name)??"",commissionPercent:Oa((ie==null?void 0:ie.commissionPercent)??0)}))},className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(J=>i.jsxs("option",{value:J.id,children:[J.name," ",J.branch?`(${J.branch})`:""]},J.id))]})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(Z),onChange:J=>E(De=>({...De,amountDelivered:Oa(J.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(be),onChange:J=>E(De=>({...De,commissionPercent:Oa(J.target.value)})),className:"h-9 w-24 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-semibold",children:["$ ",Di(Xe)]}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(L),onChange:J=>E(De=>({...De,extraExpenses:Oa(J.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Di(re)]}),i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"text",value:String(S.comment??D.comment),onChange:J=>E(De=>({...De,comment:J.target.value})),className:"h-9 w-full px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>U(D.id),className:"h-8 px-3 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:K,className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})})]},D.id)})})]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[c.map(D=>i.jsxs("div",{className:"rounded-2xl border border-gray-100 p-3 bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-black text-gray-900",children:D.sellerName}),i.jsx("div",{className:"text-xs font-extrabold bg-gray-100 rounded-full px-3 py-1",children:Ur(D.date.toDate(),"yyyy-MM-dd")})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Monto entregado"}),i.jsxs("div",{className:"font-extrabold",children:["$ ",Di(D.amountDelivered)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin %"}),i.jsxs("div",{className:"font-semibold",children:[Di(D.commissionPercent),"%"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin pagada"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Di(D.commissionPaid)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Gastos"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Di(D.extraExpenses)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Total final"}),i.jsxs("div",{className:"text-base font-black",children:["$ ",Di(D.totalFinal)]})]}),D.comment?i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comentario"}),i.jsx("div",{className:"text-sm text-gray-800",children:D.comment})]}):null]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>W(D.id),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})]},D.id)),I?i.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-3",children:[i.jsx("div",{className:"font-black text-gray-900 mb-3",children:"Editando registro"}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:D=>E(V=>({...V,dateInput:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:String(S.sellerId??""),onChange:D=>{const V=D.target.value,Z=l.get(V);E(be=>({...be,sellerId:V,sellerName:(Z==null?void 0:Z.name)??"",commissionPercent:Oa((Z==null?void 0:Z.commissionPercent)??0)}))},className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",value:String(S.amountDelivered??""),onChange:D=>E(V=>({...V,amountDelivered:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",value:String(S.extraExpenses??""),onChange:D=>E(V=>({...V,extraExpenses:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin %"}),i.jsx("input",{type:"number",value:String(S.commissionPercent??""),onChange:D=>E(V=>({...V,commissionPercent:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{type:"text",value:String(S.comment??""),onChange:D=>E(V=>({...V,comment:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>U(I),className:"flex-1 h-10 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:K,className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})]})]}):null]})]})]})]})]})}const np=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Nit(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function aW(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Cit(t){const e=String(t||"").trim();if(!e)return 0;const r=Date.parse(e);return Number.isFinite(r)?r:0}function _it({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new $2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function Eit(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState("ANY"),[y,b]=g.useState(!1),[w,j]=g.useState({});g.useEffect(()=>{(async()=>{n(!0),s("");try{const we=await $t(sr(bt(Pe,"candy_main_orders"))),Ye=new Map;we.forEach(Se=>{var Le,Ce,Ae;const xt=Se.data(),Pt=Cit(xt.date),It=((Ce=(Le=xt==null?void 0:xt.createdAt)==null?void 0:Le.toMillis)==null?void 0:Ce.call(Le))||((Ae=xt==null?void 0:xt.createdAt)!=null&&Ae.seconds?xt.createdAt.seconds*1e3:0)||0,Ut=Math.max(Pt,It),Ht=Array.isArray(xt.items)?xt.items:[];for(const Qe of Ht){const fe=String((Qe==null?void 0:Qe.id)||(Qe==null?void 0:Qe.productId)||"").trim();if(!fe)continue;const te=String((Qe==null?void 0:Qe.name)||(Qe==null?void 0:Qe.productName)||"").trim(),_e=String((Qe==null?void 0:Qe.category)||"").trim(),R=Number((Qe==null?void 0:Qe.unitPriceIsla)||0),Q=Number((Qe==null?void 0:Qe.unitPriceRivas)||0),G=Number((Qe==null?void 0:Qe.unitsPerPackage)||(Qe==null?void 0:Qe.unitsPerPack)||1),se=Ye.get(fe);(!se||Ut>=se._sortKey)&&Ye.set(fe,{productId:fe,category:_e,productName:te,priceIsla:R,priceRivas:Q,unitsPerPackage:G,_sortKey:Ut})}});const xe=Array.from(Ye.values()).sort((Se,xt)=>Se.productName.localeCompare(xt.productName,"es"));l(xe)}catch(we){console.error(we),s(" Error cargando precios desde rdenes maestras."),l([])}finally{n(!1)}})()},[t]),g.useEffect(()=>{const we=bt(Pe,"products_candies"),Ye=sr(we),xe=jd(Ye,Se=>{const xt={},Pt={},It={},Ut={};Se.forEach(Ht=>{const Le=Ht.data();xt[Ht.id]=Number((Le==null?void 0:Le.providerPrice)||(Le==null?void 0:Le.providerPricePerUnit)||0),It[Ht.id]=Number((Le==null?void 0:Le.unitsPerPackage)||(Le==null?void 0:Le.unitsPerPack)||1)||1;const Ce=String((Le==null?void 0:Le.barcode)||"").trim();Ce&&(Pt[Ht.id]=Ce);const Ae=String((Le==null?void 0:Le.packaging)||(Le==null?void 0:Le.empaque)||"").trim();Ae&&(Ut[Ht.id]=Ae)});try{const Ht=S.current||{};let Le=!1;for(const fe of Object.keys(Pt))if((Pt[fe]||"")!==(Ht[fe]||"")){Le=!0;break}const Ce=B.current||{};let Ae=!1;for(const fe of Object.keys(It))if((It[fe]||0)!==(Ce[fe]||0)){Ae=!0;break}z(xt),ce(It);const Qe={...Pt,...Ht};_(Qe),S.current=Qe,B.current={...It},Oe(Ut),l(fe=>fe.map(te=>({...te,unitsPerPackage:It[te.productId]??te.unitsPerPackage}))),!E.current&&Le&&(s(" Cdigo actualizado."),setTimeout(()=>s(""),3e3)),!E.current&&Ae&&(s(" Unidades x paquete actualizadas."),setTimeout(()=>s(""),3e3)),E.current=!1}catch{z(xt),ce(It),_(Le=>({...Pt,...Le})),B.current={...It},Oe(Ut),l(Le=>Le.map(Ce=>({...Ce,unitsPerPackage:It[Ce.productId]??Ce.unitsPerPackage})))}},Se=>console.error(Se));return()=>xe()},[]);const[I,_]=g.useState({}),S=g.useRef({}),E=g.useRef(!0),B=g.useRef({}),k=g.useRef({}),P=g.useRef(!0),[O,z]=g.useState({}),[oe,ce]=g.useState({}),[ue,ge]=g.useState({}),[ne,Oe]=g.useState({}),[Ue,F]=g.useState("");g.useEffect(()=>{const we=bt(Pe,"inventory_candies"),Ye=sr(we),xe=jd(Ye,Se=>{try{const xt={};Se.forEach(It=>{var Qe,fe,te;const Ut=It.data(),Ht=String(Ut.productId||"").trim();if(!Ht)return;const Le=Number(Ut.unitsPerPackage||Ut.unitsPerPack||0)||0,Ce=((fe=(Qe=Ut==null?void 0:Ut.createdAt)==null?void 0:Qe.toMillis)==null?void 0:fe.call(Qe))||((te=Ut==null?void 0:Ut.createdAt)!=null&&te.seconds?Ut.createdAt.seconds*1e3:0)||0,Ae=xt[Ht];(!Ae||Ce>=Ae.ts)&&(xt[Ht]={val:Le||0,ts:Ce})});const Pt={};for(const It of Object.keys(xt))Pt[It]=xt[It].val||0;ge(Pt);try{const It=k.current||{};let Ut=!1;for(const Ht of Object.keys(Pt))if((Pt[Ht]||0)!==(It[Ht]||0)){Ut=!0;break}k.current={...Pt},!P.current&&Ut&&(s(" Inventario: unidades por paquete actualizadas."),setTimeout(()=>s(""),3e3)),P.current=!1}catch{}l(It=>It.map(Ut=>({...Ut,unitsPerPackage:Pt[Ut.productId]??oe[Ut.productId]??Ut.unitsPerPackage})))}catch(xt){console.error("inventory_candies snapshot error:",xt)}},Se=>console.error(Se));return()=>xe()},[oe]),g.useEffect(()=>{l(we=>we.map(Ye=>({...Ye,unitsPerPackage:ue[Ye.productId]??oe[Ye.productId]??Ye.unitsPerPackage})))},[oe,ue]);const H=g.useMemo(()=>{const we=Nit(c),Ye=String(d||"").trim(),xe=String(Ue||"").trim().toLowerCase(),Se=A.trim()===""?null:aW(A,NaN),xt=m.trim()===""?null:aW(m,NaN);return o.filter(Pt=>{const It=String(ne[Pt.productId]||"").trim().toLowerCase();if(xe)return It===xe;if(we&&!`${Pt.category} ${Pt.productName}`.toLowerCase().includes(we))return!1;if(Ye){const Ce=String(Pt.productId||""),Ae=String(I[Pt.productId]||"");if(!Ce.includes(Ye)&&!Ae.includes(Ye))return!1}const Ut=x==="ISLA"?[Pt.priceIsla]:x==="RIVAS"?[Pt.priceRivas]:[Pt.priceIsla,Pt.priceRivas],Ht=Se==null||!Number.isFinite(Se)?!0:Ut.some(Ce=>Ce>=Se),Le=xt==null||!Number.isFinite(xt)?!0:Ut.some(Ce=>Ce<=xt);return Ht&&Le})},[o,c,A,m,x,I,Ue,ne]),K=g.useMemo(()=>{const we=new Map;for(const Ye of H){const xe=(Ye.category||"Sin categora").trim()||"Sin categora",Se=we.get(xe)||[];Se.push(Ye),we.set(xe,Se)}return Array.from(we.entries()).sort(([Ye],[xe])=>Ye.localeCompare(xe,"es"))},[H]),U=5,[W,X]=g.useState(1),D=Math.max(1,Math.ceil(K.length/U)),V=g.useMemo(()=>{const we=(W-1)*U;return K.slice(we,we+U)},[K,W]);g.useEffect(()=>{X(1)},[c,d,A,m,x,Ue]),g.useEffect(()=>{X(we=>Math.min(we,D))},[D]);const Z=()=>X(1),be=()=>X(we=>Math.max(1,we-1)),L=()=>X(we=>Math.min(D,we+1)),Xe=()=>X(D),re=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Z,disabled:W===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:be,disabled:W===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",W," de ",D]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:L,disabled:W===D,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Xe,disabled:W===D,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[K.length," categora(s)"]})]}),J=we=>{j(Ye=>({...Ye,[we]:!Ye[we]}))},De=()=>{u(""),h(""),p(""),v("ANY"),F("")},[ie,He]=g.useState(!1),[Ge,dt]=g.useState("search"),[_t,Bt]=g.useState(null),[Ot,jt]=g.useState(0),[Qt,Ft]=g.useState(0),[$e,Fe]=g.useState(null),[Ze,Te]=g.useState(""),[ee,me]=g.useState(""),Re=g.useMemo(()=>c.trim()!==""||A.trim()!==""||m.trim()!==""||x!=="ANY"||Ue.trim()!=="",[c,A,m,x,Ue]),[he,qe]=g.useState(!1);g.useEffect(()=>{var xe;const we=window.matchMedia("(max-width: 900px)"),Ye=()=>qe(we.matches);return Ye(),(xe=we.addEventListener)==null||xe.call(we,"change",Ye),()=>{var Se;return(Se=we.removeEventListener)==null?void 0:Se.call(we,"change",Ye)}},[]);const[st,yt]=g.useState(!1);g.useEffect(()=>{const we=vj(Ec,async Ye=>{if(!Ye)return yt(!1);try{const xe=await zs(er(Pe,"users",Ye.uid)),Se=xe.exists()?xe.data():null,xt=Se?Array.isArray(Se.roles)?Se.roles:Se.role?[Se.role]:[]:[];yt(Sn(xt,"admin"))}catch(xe){console.error(xe),yt(!1)}});return()=>we()},[]);const pe=async we=>{var Ye;if(Ge==="search"){f(we);const xe=Object.keys(I).find(Pt=>(I[Pt]||"")===we),Se=(Ye=o.find(Pt=>String(Pt.productId||"").includes(we)))==null?void 0:Ye.productId,xt=xe||Se||null;xt&&(Fe(xt),b(!1)),He(!1);return}if(Ge==="edit"&&_t)try{const xe=bt(Pe,"products_candies"),Se=er(xe,_t);await Fn(Se,{barcode:we}),_(xt=>({...xt,[_t]:we})),Te(we),He(!1),dt("search"),s(" Producto guardado.")}catch(xe){console.error(xe),s(" Error guardando el cdigo.")}},je=async we=>{l(Ye=>Ye.map(xe=>xe.productId===we?{...xe,priceIsla:Number(Ot||0),priceRivas:Number(Qt||0)}:xe));try{const Ye=String(ee||"").trim();await Fn(er(bt(Pe,"products_candies"),we),{packaging:Ye||""}),Oe(xe=>({...xe,[we]:Ye||""}))}catch(Ye){console.error("Error updating packaging:",Ye),s(" Error guardando empaque.")}Bt(null),s(he?" Producto guardado.":"")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Precio Ventas"}),i.jsx("div",{className:"flex gap-2",children:i.jsx(Oc,{onClick:e,loading:r})})]}),i.jsxs("div",{className:"md:hidden mb-3",children:[i.jsxs("button",{type:"button",onClick:()=>b(we=>!we),className:`w-full px-3 py-3 rounded-xl border shadow-sm flex items-center justify-between ${Re?"bg-yellow-50 border-yellow-200":"bg-white"}`,children:[i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Filtros"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Re?"Activos":"Ninguno","  ","Mostrando ",i.jsx("b",{children:H.length})]})]}),i.jsx("div",{className:"text-sm font-semibold",children:y?"Cerrar":"Abrir"})]}),y&&i.jsx("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:c,onChange:we=>u(we.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:Ue,onChange:we=>F(we.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por EAN"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:d,onChange:we=>f(we.target.value),placeholder:"Cdigo EAN"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{dt("search"),He(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{De(),f("")},children:"Limpiar filtros"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>b(!1),children:"Aplicar"})]})]})})]}),i.jsxs("div",{className:"hidden md:block bg-white p-3 rounded shadow border mb-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Filtrar por producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:we=>u(we.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Ue,onChange:we=>F(we.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:A,onChange:we=>h(we.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:m,onChange:we=>p(we.target.value),placeholder:"0"})]}),i.jsx("div",{className:"text-right",children:i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:De,children:"Limpiar"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Fuente: ",i.jsx("b",{children:"candy_main_orders.items[]"}),"  Muestra el"," ",i.jsx("b",{children:"ltimo precio"})," registrado por producto."]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Mostrando:"})," ",i.jsx("b",{children:H.length})]})]})]}),i.jsxs("div",{className:"md:hidden",children:[r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):H.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):i.jsx("div",{className:"space-y-2",children:V.map(([we,Ye])=>{const xe=!!w[we];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>J(we),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:we}),i.jsxs("div",{className:"text-[10px] text-gray-600 truncate",children:[Ye.length," ",Ye.length===1?"producto":"productos"]})]}),i.jsx("div",{className:"text-sm font-semibold",children:xe?"":"+"})]}),xe&&i.jsx("div",{className:"px-3 pb-3 border-t space-y-2",children:Ye.map(Se=>{const xt=$e===Se.productId,Pt=_t===Se.productId,It=O[Se.productId]||0,Ut=Se.priceIsla-It,Ht=Ut*.25;return i.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Fe(Le=>Le===Se.productId?null:Se.productId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:Se.productName}),i.jsx("div",{className:"text-[10px] text-gray-600 truncate",children:Se.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"P. Paquete"}),i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:np(Se.priceIsla)})]})]}),xt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Categora"}),i.jsx("div",{className:"text-sm",children:Se.category}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Unidades x paquete"}),i.jsx("div",{className:"text-sm",children:String(Se.unitsPerPackage||1)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Unidad"}),i.jsx("div",{className:"text-sm tabular-nums",children:np(Se.priceIsla/(Se.unitsPerPackage||1))})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Paquete"}),Pt?i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:String(Ot),onChange:Le=>jt(Number(Le.target.value||0))}):i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:np(Se.priceIsla)})]})]}),i.jsxs("div",{children:[st&&i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-sm tabular-nums",children:np(Ut)})]}),i.jsxs("div",{className:"mt-1",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Comisin"}),i.jsx("div",{className:"text-sm tabular-nums",children:np(Ht)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Cdigo EAN"}),Pt?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:Ze,readOnly:!0}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>{dt("edit"),He(!0)},type:"button",children:"Escanear"})]}):i.jsx("div",{children:I[Se.productId]||""})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Tipo Empaque"}),Pt?i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ee,onChange:Le=>me(Le.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"text-sm",children:ne[Se.productId]||""})]})]})]}),i.jsx("div",{className:"flex gap-2",children:Pt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white",onClick:()=>{je(Se.productId),Fe(null)},type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{dt("edit"),He(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200",onClick:()=>Bt(null),type:"button",children:"Cancelar"})]}):st&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-yellow-400",onClick:()=>{Bt(Se.productId),jt(Se.priceIsla||0),Ft(Se.priceRivas||0),Te(I[Se.productId]||""),me(ne[Se.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white",onClick:()=>l(Le=>Le.filter(Ce=>Ce.productId!==Se.productId)),type:"button",children:"Borrar"})]})})]})})]},Se.productId)})})]},we)})}),!r&&K.length>0&&re(),a&&i.jsx("p",{className:"mt-2 text-sm",children:a})]}),i.jsx(_it,{open:ie,onClose:()=>He(!1),onDetected:pe}),i.jsx("div",{className:"hidden md:block bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin resultados."})}):H.map(we=>i.jsxs("tr",{children:[i.jsx("td",{className:"p-2 border",children:we.category}),i.jsx("td",{className:"p-2 border",children:we.productName}),i.jsx("td",{className:"p-2 border",children:_t===we.productId?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ee,onChange:Ye=>me(Ye.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):ne[we.productId]||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:_t===we.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Ot),onChange:Ye=>jt(Number(Ye.target.value||0))}):np(we.priceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:_t===we.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Qt),onChange:Ye=>Ft(Number(Ye.target.value||0))}):np(we.priceRivas)}),i.jsx("td",{className:"p-2 border text-right",children:_t===we.productId?i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white text-sm",onClick:()=>je(we.productId),type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 text-sm",onClick:()=>Bt(null),type:"button",children:"Cancelar"})]}):st&&i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-sm",onClick:()=>{Bt(we.productId),jt(we.priceIsla||0),Ft(we.priceRivas||0),Te(I[we.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white text-sm",onClick:()=>{Bt(we.productId),dt("edit"),He(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white text-sm",onClick:()=>l(Ye=>Ye.filter(xe=>xe.productId!==we.productId)),type:"button",children:"Borrar"})]})})]},we.productId))})]})}),a&&i.jsx("p",{className:"hidden md:block mt-2 text-sm",children:a})]})}const D_=["Cuaderno","Block","Lapicero","Lpiz","Tajador","Borrador","Corrector","Cartucheras"],sW=["Lider","Scribe","Smarty","Pointer","Paper Mate","Otro"],FB=["Hombre","Mujer","Variado","NA"],Sit=["Universitario Cocido","5 Materia","2 Materia","Doble Raya","Rayado","Cuadriculado","Subrayado","Sublineado","Liso"],zl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function wo(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function yc(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function SE(t,e=1){const r=Math.floor(yc(t,e));return r>0?r:e}function ode(t){return!Number.isFinite(t)||t<=0?0:t}function OB(t){const e=String(t??"").trim();return e||""}function ef(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(wo(a),a));for(const a of e){const s=n.get(wo(a));if(s!=null)return t[s]}}function Iit(t){return Object.values(t||{}).every(r=>wo(r)==="")}function Nx(t){const e=Math.max(0,yc(t.providerPrice,0)),r=Math.max(1,SE(t.quantity,1)),n=ode(yc(t.margin,0)),a=Math.max(0,yc(t.salePrice,0)),s=n>0?e/n:e,o=a>0?a:s,l=o>0?e/o:n,c=e*r,u=(o-e)*r,d=o*r;return{providerPrice:e,quantity:r,margin:l,salePrice:o,facturado:c,gain:u,totalEsperado:d}}function jit(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(!1),[w,j]=g.useState(null),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState(D_[0]),[P,O]=g.useState(sW[0]),[z,oe]=g.useState(""),[ce,ue]=g.useState(0),[ge,ne]=g.useState(1),[Oe,Ue]=g.useState(.7),[F,H]=g.useState(0),[K,U]=g.useState("NA"),[W,X]=g.useState(""),[D,V]=g.useState(""),[Z,be]=g.useState(!1),[L,Xe]=g.useState(""),[re,J]=g.useState([]),[De,ie]=g.useState([]),[He,Ge]=g.useState(!1);g.useEffect(()=>{(async()=>{n(!0),s("");try{const pe=await $t(sr(bt(Pe,"products_stationery"))),je=[];pe.forEach(we=>{const Ye=we.data();je.push({id:we.id,category:Ye.category||"",brand:Ye.brand||"",name:Ye.name||"",providerPrice:Number(Ye.providerPrice||0),quantity:Number(Ye.quantity||1),facturado:Number(Ye.facturado||0),margin:Number(Ye.margin||0),salePrice:Number(Ye.salePrice||0),gain:Number(Ye.gain||0),gender:Ye.gender||"NA",typeProduct:Ye.typeProduct||"",code:Ye.code??"",createdAt:Ye.createdAt,updatedAt:Ye.updatedAt,totalEsperado:Number(Ye.totalEsperado||Number(Ye.salePrice||0)*Number(Ye.quantity||1))})}),l(je)}catch(pe){console.error(pe),s(" Error cargando productos (papelera).")}finally{n(!1)}})()},[t]);const dt=g.useMemo(()=>{const pe=wo(d),je=wo(A),we=m.trim()===""?null:yc(m,NaN),Ye=x.trim()===""?null:yc(x,NaN);return o.filter(xe=>!(pe&&!`${xe.category} ${xe.name}`.toLowerCase().includes(pe)||je&&!String(xe.code||"").toLowerCase().includes(je)||we!=null&&Number.isFinite(we)&&xe.salePrice<we||Ye!=null&&Number.isFinite(Ye)&&xe.salePrice>Ye))},[o,d,A,m,x]),_t=g.useMemo(()=>d.trim()!==""||A.trim()!==""||m.trim()!==""||x.trim()!=="",[d,A,m,x]),Bt=g.useMemo(()=>{const pe=o.length,je=o.reduce((xe,Se)=>xe+(Se.facturado||0),0),we=o.reduce((xe,Se)=>xe+Number(Se.totalEsperado||Number(Se.salePrice||0)*Number(Se.quantity||1)),0),Ye=o.reduce((xe,Se)=>xe+(Se.gain||0),0);return{count:pe,sumFact:je,sumEsperado:we,sumGain:Ye}},[o]),Ot=()=>{k(D_[0]),oe(""),ue(0),ne(1),Ue(.7),H(0),U("NA"),X(""),V(""),j(null)},jt=()=>{Ot(),b(!0)},Qt=pe=>{j(pe),k(pe.category||D_[0]),O(pe.brand||sW[0]),oe(pe.name||""),ue(Number(pe.providerPrice||0)),ne(Number(pe.quantity||1)),Ue(Number(pe.margin||.7)),H(Number(pe.salePrice||0)),U(pe.gender||"NA"),X(pe.typeProduct||""),V(String(pe.code||"")),b(!0)},Ft=async()=>{s("");const pe=String(B||"").trim(),je=String(P||"").trim(),we=String(z||"").trim(),{providerPrice:Ye,quantity:xe,margin:Se,salePrice:xt,facturado:Pt,totalEsperado:It,gain:Ut}=Nx({providerPrice:ce,quantity:ge,margin:Oe,salePrice:F});if(!pe)return s(" Categora requerida.");if(!we)return s(" Producto requerido.");if(Ye<=0)return s(" Precio proveedor debe ser > 0.");if(xe<=0)return s(" Cantidad debe ser > 0.");if(xt<=0)return s(" Precio venta invlido.");if(Se<=0)return s(" Margen invlido.");const Ht={category:pe,brand:je,name:we,providerPrice:Ye,quantity:xe,facturado:Pt,margin:Se,salePrice:xt,gain:Ut,gender:K||"NA",typeProduct:String(W||"").trim(),code:OB(D)||null,updatedAt:xr.now(),totalEsperado:It};try{n(!0),w?(await Fn(er(Pe,"products_stationery",w.id),Ht),s(" Producto actualizado.")):(await Zn(bt(Pe,"products_stationery"),{...Ht,createdAt:xr.now()}),s(" Producto creado.")),b(!1),j(null),Ot(),e()}catch(Le){console.error(Le),s(" Error guardando producto.")}finally{n(!1)}},$e=async()=>{var pe;try{const je=new $2,we=await $2.listVideoInputDevices(),Ye=(pe=we[we.length-1])==null?void 0:pe.deviceId;if(!Ye)return null;const xe=document.createElement("div");xe.className="fixed inset-0 z-[9999] bg-black/70 flex items-center justify-center p-3";const Se=document.createElement("div");Se.className="bg-white w-full max-w-md rounded-xl overflow-hidden shadow-xl";const xt=document.createElement("div");xt.className="p-3 flex items-center justify-between border-b",xt.innerHTML="<div style='font-weight:700'>Escanear cdigo</div>";const Pt=document.createElement("button");Pt.textContent="Cerrar",Pt.className="px-3 py-1 rounded bg-gray-200";const It=document.createElement("div");It.className="p-3";const Ut=document.createElement("video");return Ut.style.width="100%",Ut.style.borderRadius="12px",It.appendChild(Ut),xt.appendChild(Pt),Se.appendChild(xt),Se.appendChild(It),xe.appendChild(Se),document.body.appendChild(xe),await new Promise(async Ht=>{const Le=()=>{xe.remove(),Ht(null)};Pt.onclick=Le;const Ce=await je.decodeFromVideoDevice(Ye,Ut,Ae=>{if(Ae){const Qe=Ae.getText();try{Ce.stop()}catch{}xe.remove(),Ht(Qe)}})})}catch(je){return console.error(je),null}},Fe=async()=>{const pe=await $e();pe&&V(pe)},Ze=async()=>{const pe=await $e();if(!pe)return;const je=o.find(we=>String(we.code||"")===String(pe));je?(E(je),_(!0),s("")):(E(null),_(!0),s(""))},Te=(pe,je)=>{const we=pe.map(Se=>({Id:Se.id,Categoria:Se.category,brand:Se.brand,Producto:Se.name,PrecioProveedor:Se.providerPrice,Cantidad:Se.quantity,Facturado:Se.facturado,TotalEsperado:Se.totalEsperado||Se.salePrice*Se.quantity,Margen:Se.margin,PrecioVenta:Se.salePrice,Ganancia:Se.gain,Genero:Se.gender,TipoProducto:Se.typeProduct,Codigo:Se.code||""})),Ye=Qa.json_to_sheet(we),xe=Qa.book_new();Qa.book_append_sheet(xe,Ye,"Productos"),V2(xe,je)},ee=()=>{const pe=[{Id:"",Categoria:"Cuaderno",brand:"Lider",Producto:"Cuaderno Norma 100 hojas",PrecioProveedor:120,Cantidad:12,Margen:.7,PrecioVenta:"",Genero:"NA",TipoProducto:"Universitario Cocido",Codigo:"1234567890123"}],je=Qa.json_to_sheet(pe),we=Qa.book_new();Qa.book_append_sheet(we,je,"Productos");const Ye=pP(we,{type:"array",bookType:"xlsx"}),xe=new Blob([Ye],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Se=URL.createObjectURL(xe),xt=document.createElement("a");xt.href=Se,xt.download="template_products_stationery.xlsx",document.body.appendChild(xt),xt.click(),xt.remove(),URL.revokeObjectURL(Se)},me=pe=>{const je=[],we=[];pe.forEach((xe,Se)=>{if(!xe||typeof xe!="object"||Iit(xe))return;const xt=Se+2,Pt=String(ef(xe,["Id","ID","docId","DocId"])??"").trim(),It=String(ef(xe,["Categoria","Categora","Category","category"])??"").trim(),Ut=String(ef(xe,["Brand","Marca","brand","marca"])??"").trim(),Ht=String(ef(xe,["Producto","Product","Nombre","Name","name"])??"").trim(),Le=ef(xe,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Costo","providerPrice"]),Ce=ef(xe,["Cantidad","Qty","quantity","cantidad"]),Ae=ef(xe,["Margen","Margin","margen","margin"]),Qe=ef(xe,["PrecioVenta","Precio Venta","SalePrice","salePrice"]),fe=String(ef(xe,["Genero","Gnero","Gender","gender"])??"NA").trim(),te=String(ef(xe,["TipoProducto","Tipo","TypeProduct","typeProduct","Tipo producto"])??"").trim(),_e=ef(xe,["Codigo","Cdigo","Code","Barcode","code"]),R=OB(_e),Q=Math.max(0,yc(Le,0)),G=Math.max(1,SE(Ce,1)),se=ode(yc(Ae,0)),Ne=Math.max(0,yc(Qe,0));It||we.push(`Fila ${xt}: falta Categoria.`),Ht||we.push(`Fila ${xt}: falta Producto.`),Q<=0&&we.push(`Fila ${xt}: PrecioProveedor debe ser > 0.`),G<=0&&we.push(`Fila ${xt}: Cantidad debe ser > 0.`),se<=0&&Ne<=0&&we.push(`Fila ${xt}: Margen debe ser > 0 (o enviar PrecioVenta).`);const ze=FB.includes(fe||"NA")?fe:"NA";It&&Ht&&Q>0&&G>0&&(se>0||Ne>0)&&je.push({id:Pt||void 0,category:It,brand:Ut,name:Ht,providerPrice:Q,quantity:G,margin:se>0?se:.7,salePrice:Ne>0?Ne:void 0,gender:ze,typeProduct:te,code:R||"",_raw:xe})});const Ye=new Map;for(const xe of je){const Se=xe.id?`id::${xe.id}`:`${wo(xe.category)}::${wo(xe.name)}`;Ye.set(Se,xe)}return{rows:Array.from(Ye.values()),errors:we}},Re=async pe=>{if(s(""),ie([]),J([]),Xe((pe==null?void 0:pe.name)||""),!pe)return;const je=pe.name.toLowerCase(),we=je.endsWith(".xlsx")||je.endsWith(".xls"),Ye=je.endsWith(".csv");if(!we&&!Ye){ie(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ge(!0);const xe=new FileReader,Se=await new Promise((Ce,Ae)=>{xe.onerror=()=>Ae(new Error("No se pudo leer el archivo.")),xe.onload=()=>Ce(xe.result),xe.readAsArrayBuffer(pe)}),xt=Vv(new Uint8Array(Se),{type:"array"}),Pt=xt.SheetNames[0],It=xt.Sheets[Pt],Ut=Qa.sheet_to_json(It,{defval:""}),{rows:Ht,errors:Le}=me(Ut);J(Ht),ie(Le),Ht.length===0&&Le.length===0&&ie(["No se encontraron filas vlidas para importar."])}catch(xe){console.error(xe),ie(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ge(!1)}},he=(pe,je)=>{J(we=>{const Ye=[...we],xe=Ye[pe];return xe?(Ye[pe]={...xe,...je},Ye):we})},qe=g.useMemo(()=>{const pe=new Set(o.map(xe=>xe.id)),je=new Set(o.map(xe=>`${wo(xe.category)}::${wo(xe.name)}`));let we=0,Ye=0;for(const xe of re){if(xe.id&&pe.has(xe.id)){we+=1;continue}const Se=`${wo(xe.category)}::${wo(xe.name)}`;je.has(Se)?we+=1:Ye+=1}return{total:re.length,willCreate:Ye,willUpdate:we}},[re,o]),st=async()=>{if(s(""),De.length>0){s(" Correg los errores antes de importar.");return}if(re.length===0){s(" No hay filas para importar.");return}try{Ge(!0);const pe={},je={};o.forEach(Se=>{pe[Se.id]=Se,je[`${wo(Se.category)}::${wo(Se.name)}`]=Se});const we=tu(Pe);let Ye=0,xe=0;for(const Se of re){const xt=String(Se.category||"").trim(),Pt=String(Se.name||"").trim(),{providerPrice:It,quantity:Ut,margin:Ht,salePrice:Le,facturado:Ce,totalEsperado:Ae,gain:Qe}=Nx({providerPrice:Se.providerPrice,quantity:Se.quantity,margin:Se.margin,salePrice:Se.salePrice});if(!xt||!Pt||It<=0||Ut<=0||Le<=0||Ht<=0)continue;const fe={category:xt,name:Pt,providerPrice:It,quantity:Ut,facturado:Ce,totalEsperado:Ae,margin:Ht,salePrice:Le,gain:Qe,gender:Se.gender||"NA",typeProduct:String(Se.typeProduct||"").trim(),code:OB(Se.code)||null,updatedAt:xr.now()};let te;if(Se.id&&pe[Se.id])te=pe[Se.id];else{const _e=`${wo(xt)}::${wo(Pt)}`;te=je[_e]}if(te)we.update(er(Pe,"products_stationery",te.id),fe),xe+=1;else{const _e=er(bt(Pe,"products_stationery"));we.set(_e,{...fe,createdAt:xr.now()}),Ye+=1}}await we.commit(),s(` Importacin lista. Creados: ${Ye}, Actualizados: ${xe}`),be(!1),J([]),ie([]),Xe(""),e()}catch(pe){console.error(pe),s(" Error importando productos a Firestore.")}finally{Ge(!1)}},yt=()=>{f(""),h(""),p(""),v("")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Papelera"}),i.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-900 text-white hover:bg-black",onClick:Ze,type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:jt,type:"button",children:"+ Nuevo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{be(!0),J([]),ie([]),Xe("")},type:"button",children:"Importar (.xlsx)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Te(o,"products_stationery_todo.xlsx"),type:"button",children:"Exportar (todo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Te(dt,"products_stationery_filtrado.xlsx"),type:"button",children:"Exportar (filtrado)"}),i.jsx(Oc,{onClick:e,loading:r||He})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[i.jsx(R_,{label:"Productos",value:Bt.count}),i.jsx(R_,{label:"Facturado",value:zl(Bt.sumFact)}),i.jsx(R_,{label:"Esperado",value:zl(Bt.sumEsperado)}),i.jsx(R_,{label:"Ganancia",value:zl(Bt.sumGain)})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{className:`w-full md:w-auto px-3 py-2 rounded border bg-white hover:bg-gray-50 ${_t?"border-yellow-300 bg-yellow-50":""}`,type:"button",onClick:()=>u(pe=>!pe),children:[c?"Cerrar filtros":"Abrir filtros"," ",_t?"(activos)":""]}),c&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:d,onChange:pe=>f(pe.target.value),placeholder:"Ej: Cuaderno Norma"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:A,onChange:pe=>h(pe.target.value),placeholder:"Barcode"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:m,onChange:pe=>p(pe.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:x,onChange:pe=>v(pe.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"md:col-span-4 flex gap-2 justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:yt,children:"Limpiar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>u(!1),children:"Aplicar"})]})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-600",children:[i.jsxs("div",{children:["Mostrando: ",i.jsx("b",{children:dt.length})]}),i.jsxs("div",{children:["Coleccin: ",i.jsx("b",{children:"products_stationery"})]})]})]})]}),i.jsx("div",{className:"md:hidden space-y-2",children:r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):dt.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):dt.map(pe=>i.jsxs("div",{className:"bg-white border rounded-xl p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:pe.category}),i.jsx("div",{className:"text-base font-bold leading-tight",children:pe.name}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(pe.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Esperado:"," ",i.jsx("b",{children:zl(pe.totalEsperado||pe.salePrice*pe.quantity)})]}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(pe.gain)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Cdigo: ",i.jsx("b",{children:pe.code||""})]}),i.jsx("div",{className:"mt-2 flex gap-2",children:i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Qt(pe),children:"Editar"})})]},pe.id))}),i.jsx("div",{className:"hidden md:block bg-white border rounded overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"Venta"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Cargando"})}):dt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Sin resultados."})}):dt.map(pe=>i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:pe.category}),i.jsx("td",{className:"p-2 border",children:pe.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:pe.quantity}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.facturado)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.totalEsperado||pe.salePrice*pe.quantity)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Number(pe.margin||0).toFixed(2)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.salePrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.gain)}),i.jsx("td",{className:"p-2 border",children:pe.gender}),i.jsx("td",{className:"p-2 border",children:pe.typeProduct}),i.jsx("td",{className:"p-2 border",children:pe.code||""}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Qt(pe),children:"Editar"})})]},pe.id))})]})}),a&&i.jsx("p",{className:"mt-2 text-sm",children:a}),y&&i.jsxs(iW,{onClose:()=>b(!1),title:w?"Editar producto":"Nuevo producto",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:B,onChange:pe=>k(pe.target.value),children:D_.map(pe=>i.jsx("option",{value:pe,children:pe},pe))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:z,onChange:pe=>oe(pe.target.value),placeholder:"Ej: Cuaderno Norma..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(ce)?"":ce,onChange:pe=>ue(Math.max(0,yc(pe.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cantidad"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-2 text-right",value:ge,onChange:pe=>ne(SE(pe.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Facturado (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:zl(Nx({providerPrice:ce,quantity:ge,margin:Oe,salePrice:F}).facturado)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Margen"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(Oe)?"":Oe,onChange:pe=>Ue(Math.max(0,yc(pe.target.value,0)))}),i.jsx("div",{className:"text-[11px] text-gray-600 mt-1",children:"Ej: 0.70 / 0.80"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(Nx({providerPrice:ce,quantity:ge,margin:Oe,salePrice:F}).salePrice)?"":Nx({providerPrice:ce,quantity:ge,margin:Oe,salePrice:F}).salePrice,onChange:pe=>{H(Math.max(0,yc(pe.target.value,0)))}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Ganancia (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:zl(Nx({providerPrice:ce,quantity:ge,margin:Oe,salePrice:F}).gain)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:K,onChange:pe=>U(pe.target.value),children:FB.map(pe=>i.jsx("option",{value:pe,children:pe},pe))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo producto"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:W,onChange:pe=>X(pe.target.value),children:[i.jsx("option",{value:"",children:""}),Sit.map(pe=>i.jsx("option",{value:pe,children:pe},pe))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:D,onChange:pe=>V(pe.target.value),placeholder:"Escane o peg el cdigo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Fe,children:"Escanear"})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:()=>{b(!1),j(null)},children:"Cancelar"}),i.jsx("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:Ft,disabled:r,children:"Guardar"})]})]}),I&&i.jsx(iW,{onClose:()=>_(!1),title:"Resultado de escaneo",children:S?i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:S.category}),i.jsx("div",{className:"text-lg font-bold",children:S.name}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Precio venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(S.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(S.gain)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Proveedor"}),i.jsx("div",{className:"font-semibold tabular-nums",children:zl(S.providerPrice)})]}),i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cantidad"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.quantity})]}),i.jsxs("div",{className:"rounded-lg border p-2 col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cdigo"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.code||""})]})]}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsx("button",{className:"px-4 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>{_(!1),Qt(S)},children:"Editar"})})]}):i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-semibold",children:"No encontrado"}),i.jsxs("div",{className:"text-gray-600 mt-1",children:["Ese cdigo no existe en ",i.jsx("b",{children:"products_stationery"}),"."]})]})}),Z&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar papelera (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>be(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas: Id (opcional), Categoria, Producto, PrecioProveedor, Cantidad, Margen (o PrecioVenta), Genero, TipoProducto, Codigo."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:ee,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:pe=>{var je;return Re(((je=pe.target.files)==null?void 0:je[0])||null)}}),L&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:L})]}),He&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),De.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:De.slice(0,60).map((pe,je)=>i.jsx("li",{children:pe},je))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",qe.total," filas (Crear:"," ",qe.willCreate," / Actualizar:"," ",qe.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:st,disabled:He||re.length===0||De.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1500px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"PrecioVenta"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:re.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):re.slice(0,300).map((pe,je)=>{const we=pe.id?o.some(Se=>Se.id===pe.id):!1,Ye=o.some(Se=>`${wo(Se.category)}::${wo(Se.name)}`==`${wo(pe.category)}::${wo(pe.name)}`),xe=we||Ye;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:pe.id||"",onChange:Se=>he(je,{id:Se.target.value.trim()||void 0}),placeholder:"docId (update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:pe.category,onChange:Se=>he(je,{category:Se.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:pe.name,onChange:Se=>he(je,{name:Se.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:pe.providerPrice,onChange:Se=>he(je,{providerPrice:Math.max(0,yc(Se.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:pe.quantity,onChange:Se=>he(je,{quantity:SE(Se.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-24 border rounded px-2 py-1 text-right",value:pe.margin,onChange:Se=>he(je,{margin:Math.max(0,yc(Se.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:pe.salePrice??"",onChange:Se=>he(je,{salePrice:Math.max(0,yc(Se.target.value,0))||void 0}),placeholder:"Opcional"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("select",{className:"w-28 border rounded px-2 py-1",value:pe.gender,onChange:Se=>he(je,{gender:Se.target.value}),children:FB.map(Se=>i.jsx("option",{value:Se,children:Se},Se))})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:pe.typeProduct,onChange:Se=>he(je,{typeProduct:Se.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:pe.code||"",onChange:Se=>he(je,{code:Se.target.value})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${xe?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:xe?"ACTUALIZA":"CREA"})})]},`${pe.id||""}-${je}`)})})]}),re.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",re.length," filas (importa todas)."]})]})]})]})})]})}function R_({label:t,value:e}){return i.jsxs("div",{className:"bg-white border rounded p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-extrabold",children:e})]})}function iW({title:t,children:e,onClose:r}){return i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-3xl p-4 relative",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:t}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),e]})})}const ld=t=>`C$ ${(Number(t)||0).toFixed(2)}`,w0=t=>Number(t||0).toFixed(3),DB=(t,e)=>{var a,s,o,l;const r=t._raw||{},n=t.customerName||r.customerName||((a=r.customer)==null?void 0:a.name)||r.clientName||((s=r.client)==null?void 0:s.name)||"";return t.type==="CONTADO"&&n?n:(t.customerId?e[t.customerId]:"")||t.customerName||r.customerName||((o=r.customer)==null?void 0:o.name)||r.clientName||((l=r.client)==null?void 0:l.name)||"Nombre cliente"},oW=t=>{const e=t._raw||{},r=cde(e)||t.date,n=rv(r);return isFinite(n)?n:NaN},RB=t=>String((t==null?void 0:t.status)||"").toUpperCase()==="PROCESADA"||t!=null&&t.closureId||t!=null&&t.closureDate||t!=null&&t.processedDate?"PROCESADA":"FLOTANTE",Pit=t=>String(t??"").toLowerCase().trim(),lW=t=>["lb","lbs","libra","libras"].includes(Pit(t)),cW=t=>Number((t==null?void 0:t.qty)??(t==null?void 0:t.quantity)??0)||0,Bit=t=>t?Array.isArray(t.items)&&t.items.length>0?t.items.reduce((e,r)=>lW((r==null?void 0:r.measurement)??(t==null?void 0:t.measurement))?e+cW(r):e,0):lW(t==null?void 0:t.measurement)?cW(t):0:0;function lde(t){if(!t)return"";if(t!=null&&t.toDate)return Ur(t.toDate(),"yyyy-MM-dd");const e=String(t).trim();if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const r=["dd/MM/yyyy","d/M/yyyy","MM/dd/yyyy","M/d/yyyy","yyyy/MM/dd","yyyy-M-d","yyyy/M/d","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSSX"];for(const a of r){const s=bS(e,a,new Date);if(B6(s))return Ur(s,"yyyy-MM-dd")}const n=new Date(e);return isNaN(n.getTime())?"":Ur(n,"yyyy-MM-dd")}function rv(t){const e=lde(t);if(!e)return NaN;const r=bS(e,"yyyy-MM-dd",new Date);return B6(r)?r.getTime():NaN}function cde(t){var n,a;const e=lde(t==null?void 0:t.date),r=(n=t==null?void 0:t.createdAt)!=null&&n.toDate?t.createdAt.toDate():null;if(e&&r){const s=rv(e),o=r.getTime();if(Math.abs(o-s)/(1e3*60*60*24)>30)return Ur(r,"yyyy-MM-dd")}return e||((a=t==null?void 0:t.timestamp)!=null&&a.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):r?Ur(r,"yyyy-MM-dd"):"")}function Tit(t,e){var s,o,l,c;const r=cde(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((u,d)=>u+(Number(d.qty??d.quantity??d.lbs??0)||0),0),a=Number(t.amount??t.total??0)||0):(n=Number(t.quantity??t.lbs??t.weight??0)||0,a=Number(t.amount??t.total??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||((s=t.customer)==null?void 0:s.id)||((o=t.customer)==null?void 0:o.customerId)||t.clientId||void 0,customerName:t.customerName||((l=t.customer)==null?void 0:l.name)||t.clientName||((c=t.client)==null?void 0:c.name)||void 0,_raw:t}}async function kit(t){const e=sr(bt(Pe,"ar_movements"),Ar("ref.saleId","==",t)),r=await $t(e);await Promise.all(r.docs.map(n=>qn(er(Pe,"ar_movements",n.id))))}function Fit({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=Sn(n,"vendedor_pollo"),s=Sn(n,"admin");if(!(Sn(n,"admin")||Sn(n,"vendedor_pollo")||Sn(n,"supervisor_pollo")||Sn(n,"contador")))return i.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center text-red-600",children:"Acceso restringido  Solo administradores, vendedores y supervisores de pollo."});const o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async ee=>{c(!0),d(!0),A(ee),m([]);try{const me=await zs(er(Pe,"salesV2",ee)),Re=me.exists()?me.data():null;if(!Re){m([]);return}let he=[];if(Array.isArray(Re.items)&&Re.items.length>0)he=Re.items;else if(Re.items&&typeof Re.items=="object")try{he=Object.values(Re.items)}catch{he=[]}else Re.item?he=[Re.item]:Array.isArray(Re.products)&&Re.products.length>0?he=Re.products:Array.isArray(Re.lines)&&Re.lines.length>0?he=Re.lines:Array.isArray(Re.detalles)&&Re.detalles.length>0?he=Re.detalles:(Re.productName||Re.product)&&(he=[{productName:Re.productName||Re.product||"",qty:Re.qty??Re.quantity??Re.lbs??0,unitPrice:Re.unitPrice??Re.price??0,discount:Re.discount??0,total:Re.total??Re.amount??0}]);const qe=je=>{if(je==null)return NaN;if(typeof je=="number")return je;let we=String(je).trim();if(!we)return NaN;if(we=we.replace(/[^0-9.,-]/g,""),!we)return NaN;we.indexOf(".")>-1&&we.indexOf(",")>-1?we=we.replace(/,/g,""):we.indexOf(",")>-1&&we.indexOf(".")===-1&&(we=we.replace(/,/g,"."));const Ye=Number(we);return isNaN(Ye)?NaN:Ye},st=new Set;for(const je of he)if(Array.isArray(je==null?void 0:je.allocations))for(const we of je.allocations){const Ye=String((we==null?void 0:we.batchId)||"").trim();Ye&&st.add(Ye)}else if(je!=null&&je.allocations&&typeof je.allocations=="object")try{for(const we of Object.values(je.allocations)){const Ye=String((we==null?void 0:we.batchId)||"").trim();Ye&&st.add(Ye)}}catch{}if(Array.isArray(Re==null?void 0:Re.allocations))for(const je of Re.allocations){const we=String((je==null?void 0:je.batchId)||"").trim();we&&st.add(we)}const yt={};st.size>0&&await Promise.all(Array.from(st).map(async je=>{try{const we=await zs(er(Pe,"inventory_batches",je));if(we.exists()){const Ye=we.data();yt[je]=Number(Ye.salePrice??Ye.sale_price??Ye.price??0)}}catch{}}));const pe=he.map(je=>{const we=String(je.productName||je.product||je.name||"(sin nombre)"),Ye=Number(je.qty??je.quantity??je.lbs??je.weight??0)||0,xe=qe(je.total??je.lineFinal??je.amount??je.monto??je.line_total)||0;let Se=0;const xt=[je.unitPrice,je.unitPricePackage,je.salePrice,je.sale_price,je.price,je.unit_price,je.pricePerUnit,je.price_per_unit];for(const Ut of xt){const Ht=qe(Ut);if(!isNaN(Ht)&&Ht!==0){Se=Ht;break}}if(!Se){const Ut=(Re==null?void 0:Re.salePrice)??(Re==null?void 0:Re.sale_price)??(Re==null?void 0:Re.unitPrice)??(Re==null?void 0:Re.unit_price)??(Re==null?void 0:Re.price)??(Re==null?void 0:Re.pricePerUnit),Ht=qe(Ut);!isNaN(Ht)&&Ht!==0&&(Se=Ht)}if(!Se){const Ut=Array.isArray(je.allocations)?je.allocations[0]:je.allocations&&typeof je.allocations=="object"?Object.values(je.allocations)[0]:null,Ht=Ut?String(Ut.batchId||"").trim():"";Ht&&yt[Ht]&&(Se=yt[Ht]||0)}!Se&&je.productId&&(Se=productPriceMap[String(je.productId)]||0),(!Se||Se===0)&&xe>0&&Ye>0&&(Se=xe/Ye);const Pt=qe(je.discount??je.desc??0)||0;let It=xe;return(!It||It===0)&&(It=Number(Se*Ye||0)),It=Number(It)||0,{productName:we,qty:Ye,unitPrice:Se,discount:Pt,total:It}});m(pe)}catch(me){console.error(me)}finally{d(!1)}},[x,v]=g.useState(Ur(new Date,"yyyy-MM-01")),[y,b]=g.useState(Ur(new Date,"yyyy-MM-dd")),[w,j]=g.useState([]),[I,_]=g.useState([]),[S,E]=g.useState([]),[B,k]=g.useState(!0),[P,O]=g.useState(""),{refreshKey:z,refresh:oe}=Dc(),[ce,ue]=g.useState(""),[ge,ne]=g.useState(""),[Oe,Ue]=g.useState("ALL"),[F,H]=g.useState(""),[K,U]=g.useState(null),W=15,[X,D]=g.useState(1),V=g.useMemo(()=>{const ee={};return w.forEach(me=>ee[me.id]=me.name),ee},[w]);g.useEffect(()=>{Oe!=="ALL"&&!S.includes(Oe)&&Ue("ALL")},[S,Oe]),g.useEffect(()=>{(async()=>{k(!0),O("");try{const ee=[];if(a&&e){const xe=sr(bt(Pe,"customers_pollo"),Ar("vendorId","==",e),In("createdAt","desc"));(await $t(xe)).forEach(xt=>ee.push({id:xt.id,name:xt.data().name||""}))}else(await $t(sr(bt(Pe,"customers_pollo"),In("createdAt","desc")))).forEach(Se=>ee.push({id:Se.id,name:Se.data().name||""}));j(ee);const me={};ee.forEach(xe=>{me[xe.id]=xe.name});const[Re,he,qe]=await Promise.all([$t(sr(bt(Pe,"salesV2"),In("timestamp","desc"))),$t(sr(bt(Pe,"daily_closures"),In("createdAt","desc"))),$t(sr(bt(Pe,"ar_movements_pollo"),Ar("date",">=",x),Ar("date","<=",y)))]),st=new Map;qe.forEach(xe=>{var It;const Se=xe.data(),xt=String(((It=Se==null?void 0:Se.ref)==null?void 0:It.saleId)||"").trim(),Pt=String((Se==null?void 0:Se.customerId)||"").trim();xt&&Pt&&st.set(xt,Pt)});const yt=new Map;he.forEach(xe=>{const Se=xe.data(),xt=Array.isArray(Se==null?void 0:Se.salesV2)?Se.salesV2:[];for(const Pt of xt){const It=String((Pt==null?void 0:Pt.id)||"").trim();if(!It)continue;const Ut=It.split("#")[0];(String((Pt==null?void 0:Pt.status)||"").toUpperCase()==="PROCESADA"||Pt!=null&&Pt.closureDate||Pt!=null&&Pt.processedDate)&&yt.set(Ut,{closureDate:Pt==null?void 0:Pt.closureDate,processedDate:Pt==null?void 0:Pt.processedDate})}});const pe=[];Re.forEach(xe=>{const Se=xe.data(),xt=yt.get(xe.id),Pt=st.get(xe.id);!Se.customerId&&Pt&&(Se.customerId=Pt),!Se.customerName&&Pt&&(Se.customerName=me[Pt]||""),xt&&(Se.status="PROCESADA",!Se.closureDate&&xt.closureDate&&(Se.closureDate=xt.closureDate),!Se.processedDate&&xt.processedDate&&(Se.processedDate=xt.processedDate));const It=Tit(Se,xe.id);It&&pe.push(It)});const je=pe.sort((xe,Se)=>Se.date.localeCompare(xe.date));_(je);const we=rv(x),Ye=rv(y);E(Array.from(new Set(je.filter(xe=>{const Se=oW(xe);return!(!isFinite(Se)||isFinite(we)&&Se<we||isFinite(Ye)&&Se>Ye)}).map(xe=>{var Se,xt,Pt,It;return((Se=xe._raw)==null?void 0:Se.productName)||((It=(Pt=(xt=xe._raw)==null?void 0:xt.items)==null?void 0:Pt[0])==null?void 0:It.productName)||"(sin producto)"}))).sort()),D(1)}catch(ee){console.error(ee),O(" Error cargando transacciones.")}finally{k(!1)}})()},[x,y,z]);const Z=g.useMemo(()=>{const ee=rv(x),me=rv(y);return I.filter(Re=>{const he=oW(Re);return!(!isFinite(he)||isFinite(ee)&&he<ee||isFinite(me)&&he>me)})},[I,x,y]),be=g.useMemo(()=>Z.filter(ee=>{var me,Re,he,qe;if(ce&&ee.customerId!==ce||ge&&ee.type!==ge)return!1;if(Oe&&Oe!=="ALL"){const st=((me=ee._raw)==null?void 0:me.productName)||((qe=(he=(Re=ee._raw)==null?void 0:Re.items)==null?void 0:he[0])==null?void 0:qe.productName)||"";if(!st||st!==Oe)return!1}return!(F&&RB(ee._raw)!==F)}),[Z,ce,ge,Oe,F]),L=g.useMemo(()=>{let ee=0,me=0,Re=0,he=0;for(const yt of be){const pe=Bit(yt._raw);yt.type==="CONTADO"?(ee+=pe,Re+=yt.total):(me+=pe,he+=yt.total)}const qe=ee+me,st=Re+he;return{packsCash:ee,packsCredito:me,packsTotal:qe,montoCash:Re,montoCredito:he,montoTotal:st}},[be]),Xe=g.useMemo(()=>{let ee=0,me=0;for(const he of be)he.type==="CONTADO"?ee+=he.quantity:me+=he.quantity;const Re=ee+me;return{unidadesCash:ee,unidadesCredito:me,unidadesTotal:Re}},[be]),re=Math.max(1,Math.ceil(be.length/W)),J=g.useMemo(()=>{const ee=(X-1)*W;return be.slice(ee,ee+W)},[be,X]),[De,ie]=g.useState(!1),[He,Ge]=g.useState(!1),[dt,_t]=g.useState(!1),Bt=g.useMemo(()=>{const ee=new Map;return J.forEach(me=>{var qe,st,yt,pe;const Re=((qe=me._raw)==null?void 0:qe.productName)||((pe=(yt=(st=me._raw)==null?void 0:st.items)==null?void 0:yt[0])==null?void 0:pe.productName)||"(sin producto)";ee.has(Re)||ee.set(Re,{cash:[],credit:[]});const he=ee.get(Re);me.type==="CONTADO"?he.cash.push(me):he.credit.push(me)}),Array.from(ee.entries()).sort((me,Re)=>me[0].localeCompare(Re[0]))},[J]);g.useMemo(()=>f&&I.find(ee=>ee.id===f)||null,[f,I]);const Ot=async ee=>{if(s&&(U(null),!!window.confirm("Eliminar esta venta? Se restaurar el inventario asociado.")))try{k(!0),await Vre(ee.id),await kit(ee.id),_(me=>me.filter(Re=>Re.id!==ee.id)),O(" Venta eliminada")}catch(me){console.error(me),O(" No se pudo eliminar la venta.")}finally{k(!1)}},jt=()=>{const ee=`Ventas del dia  ${x} a ${y}`,me=st=>(st||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Re=be.map(st=>{var pe,je,we,Ye;const yt=DB(st,V);return(pe=st._raw)!=null&&pe.productName||(Ye=(we=(je=st._raw)==null?void 0:je.items)==null?void 0:we[0])!=null&&Ye.productName,`<tr>
          <td>${st.date}</td>
          <td>${me(yt)}</td>
          <td>${st.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${st.quantity}</td>
          <td style="text-align:right">${ld(st.total)}</td>
        </tr>`}).join(""),he=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${me(ee)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${me(ee)}</h1>
      <div class="kpis">

      
        <div><b>Unidades Cash:</b> ${w0(Xe.unidadesCash)}</div>
        <div><b>Unidades Crdito:</b> ${w0(Xe.unidadesCredito)}</div>
        <div><b>Total Unidades:</b> ${w0(Xe.unidadesTotal)}</div>
      </div>

      <div class="kpis">
        <div><b>Libras Cash:</b> ${L.packsCash}</div>
        <div><b>Libras Crdito:</b> ${L.packsCredito}</div>
        <div><b>Ventas Cash:</b> ${ld(L.montoCash)}</div>
        <div><b>Ventas Crdito:</b> ${ld(L.montoCredito)}</div>
      </div>

      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Libras</th><th>Ventas</th>
      </tr></thead><tbody>
      ${Re||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,qe=window.open("","_blank");qe&&(qe.document.open(),qe.document.write(he),qe.document.close())},Qt=()=>D(1),Ft=()=>D(ee=>Math.max(1,ee-1)),$e=()=>D(ee=>Math.min(re,ee+1)),Fe=()=>D(re),Ze=()=>{const ee=[];if(re<=7)for(let Re=1;Re<=re;Re++)ee.push(Re);else{const Re=Math.max(1,X-2),he=Math.min(re,X+2);ee.push(1),Re>2&&ee.push(-1);for(let qe=Re;qe<=he;qe++)qe!==1&&qe!==re&&ee.push(qe);he<re-1&&ee.push(-2),ee.push(re)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Qt,disabled:X===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ft,disabled:X===1,children:" Anterior"}),ee.map((Re,he)=>typeof Re=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${Re===X?"bg-blue-600 text-white":""}`,onClick:()=>D(Re),children:Re},he):i.jsx("span",{className:"px-2",children:""},he)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:$e,disabled:X===re,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Fe,disabled:X===re,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",X," de ",re,"  ",be.length," transaccin(es)"]})]})},Te=ee=>{var qe,st,yt,pe;const me=DB(ee,V),Re=((qe=ee._raw)==null?void 0:qe.productName)||((pe=(yt=(st=ee._raw)==null?void 0:st.items)==null?void 0:yt[0])==null?void 0:pe.productName)||"(sin producto)",he=RB(ee._raw);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:me}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ee.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:`px-2 py-1 rounded-full border ${he==="PROCESADA"?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700"}`,children:he}),i.jsx("span",{className:`px-2 py-1 rounded-full border ${ee.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:ee.type==="CREDITO"?"Crdito":"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Libras:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:je=>{je.preventDefault(),p(ee.id)},title:"Ver detalle",children:w0(ee.quantity)})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",ld(ee.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:me})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Producto"}),i.jsx("span",{className:"font-medium text-right",children:Re})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ee.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Estado"}),i.jsx("span",{className:"font-medium",children:he})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:ee.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Libras"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ee.id),title:"Ver detalle",children:w0(ee.quantity)})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:ld(ee.total)})]}),i.jsx("div",{className:"flex items-center justify-between",children:s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2 w-full",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>U(je=>je===ee.id?null:ee.id),children:" Acciones"}),K===ee.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Ot(ee),children:"Eliminar"})]})})]})})]})},ee.id)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>ie(ee=>!ee),"aria-expanded":De,children:[i.jsx("span",{children:"Filtros de bsqueda"}),i.jsx("span",{className:`transition-transform ${De?"rotate-180":""}`,children:""})]}),De&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-7 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:ee=>{v(ee.target.value),D(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:ee=>{b(ee.target.value),D(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ce,onChange:ee=>{ue(ee.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(ee=>i.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ge,onChange:ee=>{ne(ee.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Oe,onChange:ee=>{Ue(ee.target.value),D(1)},children:[i.jsx("option",{value:"ALL",children:"Todos"}),S.map(ee=>i.jsx("option",{value:ee,children:ee},ee))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:F,onChange:ee=>{H(ee.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"FLOTANTE",children:"FLOTANTE"}),i.jsx("option",{value:"PROCESADA",children:"PROCESADA"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:jt,children:"Exportar PDF"}),i.jsx("div",{className:"sm:col-span-2 lg:col-span-1 flex",children:i.jsx(Oc,{onClick:oe,loading:B,className:"w-full justify-center"})})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ge(ee=>!ee),"aria-expanded":He,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${He?"rotate-180":""}`,children:""})]}),He&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:w0(L.packsCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:w0(L.packsCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ld(L.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:ld(L.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Total"}),i.jsx("div",{className:"text-xl font-semibold",children:ld(L.montoTotal)})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>_t(ee=>!ee),"aria-expanded":dt,children:[i.jsx("span",{children:"Transacciones"}),i.jsx("span",{className:`transition-transform ${dt?"rotate-180":""}`,children:""})]}),dt&&i.jsxs("div",{className:"p-3 border-t space-y-4",children:[i.jsxs("div",{className:"block md:hidden space-y-3",children:[B?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):J.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):Bt.map(([ee,me])=>i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"font-semibold",children:["Categora: ",ee]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[me.cash.length+me.credit.length," transaccin(es)"]})]}),i.jsxs("div",{className:"p-3 pt-0 space-y-3",children:[i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Cash"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[me.cash.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:me.cash.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):me.cash.map(Te)})]})}),i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Crdito"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[me.credit.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:me.credit.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):me.credit.map(Te)})]})})]})]})},ee)),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:Ze()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):J.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):J.map(ee=>{var qe,st,yt,pe;const me=DB(ee,V),Re=((qe=ee._raw)==null?void 0:qe.productName)||((pe=(yt=(st=ee._raw)==null?void 0:st.items)==null?void 0:yt[0])==null?void 0:pe.productName)||"(sin producto)",he=RB(ee._raw);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.date}),i.jsx("td",{className:"p-2 border",children:he}),i.jsx("td",{className:"p-2 border",children:me}),i.jsx("td",{className:"p-2 border",children:Re}),i.jsx("td",{className:"p-2 border",children:ee.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(ee.id),children:w0(ee.quantity)})}),i.jsx("td",{className:"p-2 border",children:ld(ee.total)}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>U(je=>je===ee.id?null:ee.id),title:"Acciones",children:""}),K===ee.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Ot(ee),children:"Eliminar"})})]})]},ee.id)})})]}),Ze()]})]})]}),P&&i.jsx("p",{className:"mt-2 text-sm",children:P}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{children:i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," ",f?` #${f}`:""]})}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Libras"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((ee,me)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ee.productName}),i.jsx("td",{className:"p-2 border text-right",children:ee.qty}),i.jsx("td",{className:"p-2 border text-right",children:ld(ee.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:ld(ee.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:ld(ee.total)})]},me))})]})})]})})]})}function Oit(){const[t,e]=g.useState(!1);return g.useEffect(()=>{var a;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(a=r.addEventListener)==null||a.call(r,"change",n),()=>{var s;return(s=r.removeEventListener)==null?void 0:s.call(r,"change",n)}},[]),t}function Dit(){const[t,e]=g.useState(null),[r,n]=g.useState(""),[a,s]=g.useState([]),[o,l]=g.useState(""),[c,u]=g.useState(!0),d=Oit(),f=g.useMemo(()=>d?i.jsx(abe,{role:r,roles:a}):i.jsx(nbe,{role:r,roles:a}),[d,r,a]),A=(t==null?void 0:t.email)||"";if(g.useEffect(()=>{const m=vj(Ec,async p=>{if(u(!0),p){e(p);try{const x=er(Pe,"users",p.uid),v=await zs(x);if(v.exists()){const y=v.data(),b=Array.isArray(y.roles)?y.roles:y.role?[y.role]:[],w=y.sellerCandyId||"";s(b),n(b[0]||""),l(w||"")}else n(""),s([]),l("")}catch{n(""),l("")}}else e(null),n(""),l("");u(!1)});return()=>m()},[]),c)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const h=()=>{const m=a&&a.length?a:r;return Sn(m,"admin")?i.jsx(Dh,{to:"financialDashboard",replace:!0}):Sn(m,"vendedor_pollo")?i.jsx(Dh,{to:"salesV2",replace:!0}):Sn(m,"supervisor_pollo")?i.jsx(Dh,{to:"batches",replace:!0}):Sn(m,"contador")?i.jsx(Dh,{to:"batches",replace:!0}):Sn(m,"vendedor_ropa")?i.jsx(Dh,{to:"salesClothes",replace:!0}):Sn(m,"vendedor_dulces")?i.jsx(Dh,{to:"salesCandies",replace:!0}):i.jsx(Dh,{to:"/",replace:!0})};return i.jsx(D0e,{children:i.jsxs(h0e,{children:[i.jsx(Un,{path:"/",element:i.jsx(Zye,{})}),i.jsxs(Un,{path:"/admin",element:i.jsx(zn,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"],children:f}),children:[i.jsx(Un,{index:!0,element:i.jsx(h,{})}),i.jsx(Un,{path:"bills",element:i.jsx(zn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(PPe,{role:r,roles:a})})}),i.jsx(Un,{path:"salesV2",element:i.jsx(zn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(YV,{user:t})})}),i.jsx(Un,{path:"financialDashboard",element:i.jsx(zn,{allowedRoles:["admin","contador","supervisor_pollo"],children:i.jsx(I3e,{})})}),i.jsx(Un,{path:"expenses",element:i.jsx(zn,{allowedRoles:["admin","contador"],children:i.jsx(j3e,{})})}),i.jsx(Un,{path:"polloCashAudits",element:i.jsx(zn,{allowedRoles:["admin","contador"],children:i.jsx(K8e,{})})}),i.jsx(Un,{path:"transactionsPollo",element:i.jsx(zn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(Fit,{role:r,roles:a})})}),i.jsx(Un,{path:"batches",element:i.jsx(zn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(_3e,{role:r,roles:a})})}),i.jsx(Un,{path:"paidBatches",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(D3e,{})})}),i.jsx(Un,{path:"fix",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(T3e,{})})}),i.jsx(Un,{path:"transactionclose",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(E3e,{})})}),i.jsx(Un,{path:"billhistoric",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(BPe,{})})}),i.jsx(Un,{path:"users",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(TPe,{})})}),i.jsx(Un,{path:"products",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(kPe,{})})}),i.jsx(Un,{path:"customersPollo",element:i.jsx(zn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(NLe,{role:r,roles:a,currentUserEmail:A,sellerPolloId:o})})}),i.jsx(Un,{path:"datacenter",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(vVe,{})})}),i.jsx(Un,{path:"productsCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(vQe,{})})}),i.jsx(Un,{path:"mainordersCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(rVe,{})})}),i.jsx(Un,{path:"productsPricesCandies",element:i.jsx(zn,{roles:a,allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Eit,{})})}),i.jsx(Un,{path:"inventoryMainOrderCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(nVe,{})})}),i.jsx(Un,{path:"inventoryCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(EQe,{})})}),i.jsx(Un,{path:"billingsCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(hVe,{})})}),i.jsx(Un,{path:"cashDeliveries",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(wit,{})})}),i.jsx(Un,{path:"customersCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(SQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"salesCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(kQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"expensesCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(FQe,{})})}),i.jsx(Un,{path:"dashboardCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(HQe,{})})}),i.jsx(Un,{path:"transactionCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(MQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"vendorsCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx($Qe,{})})}),i.jsx(Un,{path:"productsVendorsCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(YQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"cierreVentasCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(iVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"reporteCierresCandies",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(mVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"consolidatedVendors",element:i.jsx(zn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(dVe,{})})}),i.jsx(Un,{path:"salesClothes",element:i.jsx(zn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(dLe,{})})}),i.jsx(Un,{path:"notebooksInventory",element:i.jsx(zn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(jit,{})})}),i.jsx(Un,{path:"TransactionsReportClothes",element:i.jsx(zn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(bLe,{})})}),i.jsx(Un,{path:"financialDashboardClothes",element:i.jsx(zn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(ALe,{})})}),i.jsx(Un,{path:"ExpensesClothes",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(mLe,{})})}),i.jsx(Un,{path:"inventoryClothesBatches",element:i.jsx(zn,{allowedRoles:["admin"],children:i.jsx(W8e,{})})}),i.jsx(Un,{path:"productsClothes",element:i.jsx(zn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(iLe,{})})}),i.jsx(Un,{path:"CustomersClothes",element:i.jsx(zn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(lLe,{})})})]}),i.jsx(Un,{path:"/salesV2",element:i.jsx(zn,{allowedRoles:["admin","vendedor_pollo","contador"],children:i.jsx(YV,{user:t})})}),i.jsx(Un,{path:"*",element:i.jsx(Dh,{to:"/"})})]})})}Jye.then(t=>{console.info("Auth persistence mode:",t)}).catch(()=>{}).finally(()=>{MB.createRoot(document.getElementById("root")).render(i.jsx(Ni.StrictMode,{children:i.jsx(Dit,{})}))});export{es as _,Mit as c,jA as g};
