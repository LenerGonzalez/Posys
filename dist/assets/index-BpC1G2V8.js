var X7=Object.defineProperty;var Y7=(t,e,r)=>e in t?X7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Nn=(t,e,r)=>Y7(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var V1e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I3={exports:{}},Ow={},F3={exports:{}},Xr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dx=Symbol.for("react.element"),eV=Symbol.for("react.portal"),tV=Symbol.for("react.fragment"),rV=Symbol.for("react.strict_mode"),nV=Symbol.for("react.profiler"),sV=Symbol.for("react.provider"),aV=Symbol.for("react.context"),iV=Symbol.for("react.forward_ref"),oV=Symbol.for("react.suspense"),lV=Symbol.for("react.memo"),cV=Symbol.for("react.lazy"),S5=Symbol.iterator;function AV(t){return t===null||typeof t!="object"?null:(t=S5&&t[S5]||t["@@iterator"],typeof t=="function"?t:null)}var k3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T3=Object.assign,j3={};function G0(t,e,r){this.props=t,this.context=e,this.refs=j3,this.updater=r||k3}G0.prototype.isReactComponent={};G0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};G0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function P3(){}P3.prototype=G0.prototype;function ME(t,e,r){this.props=t,this.context=e,this.refs=j3,this.updater=r||k3}var QE=ME.prototype=new P3;QE.constructor=ME;T3(QE,G0.prototype);QE.isPureReactComponent=!0;var I5=Array.isArray,R3=Object.prototype.hasOwnProperty,VE={current:null},D3={key:!0,ref:!0,__self:!0,__source:!0};function L3(t,e,r){var n,s={},a=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)R3.call(e,n)&&!D3.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),A=0;A<l;A++)c[A]=arguments[A+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:dx,type:t,key:a,ref:o,props:s,_owner:VE.current}}function uV(t,e){return{$$typeof:dx,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function HE(t){return typeof t=="object"&&t!==null&&t.$$typeof===dx}function dV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var F5=/\/+/g;function gb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dV(""+t.key):e.toString(36)}function M1(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case dx:case eV:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+gb(o,0):n,I5(s)?(r="",t!=null&&(r=t.replace(F5,"$&/")+"/"),M1(s,e,r,"",function(A){return A})):s!=null&&(HE(s)&&(s=uV(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(F5,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",I5(t))for(var l=0;l<t.length;l++){a=t[l];var c=n+gb(a,l);o+=M1(a,e,r,c,s)}else if(c=AV(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=n+gb(a,l++),o+=M1(a,e,r,c,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function dv(t,e,r){if(t==null)return t;var n=[],s=0;return M1(t,n,"","",function(a){return e.call(r,a,s++)}),n}function hV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Li={current:null},Q1={transition:null},fV={ReactCurrentDispatcher:Li,ReactCurrentBatchConfig:Q1,ReactCurrentOwner:VE};function U3(){throw Error("act(...) is not supported in production builds of React.")}Xr.Children={map:dv,forEach:function(t,e,r){dv(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return dv(t,function(){e++}),e},toArray:function(t){return dv(t,function(e){return e})||[]},only:function(t){if(!HE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Xr.Component=G0;Xr.Fragment=tV;Xr.Profiler=nV;Xr.PureComponent=ME;Xr.StrictMode=rV;Xr.Suspense=oV;Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fV;Xr.act=U3;Xr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=T3({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=VE.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)R3.call(e,c)&&!D3.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var A=0;A<c;A++)l[A]=arguments[A+2];n.children=l}return{$$typeof:dx,type:t.type,key:s,ref:a,props:n,_owner:o}};Xr.createContext=function(t){return t={$$typeof:aV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sV,_context:t},t.Consumer=t};Xr.createElement=L3;Xr.createFactory=function(t){var e=L3.bind(null,t);return e.type=t,e};Xr.createRef=function(){return{current:null}};Xr.forwardRef=function(t){return{$$typeof:iV,render:t}};Xr.isValidElement=HE;Xr.lazy=function(t){return{$$typeof:cV,_payload:{_status:-1,_result:t},_init:hV}};Xr.memo=function(t,e){return{$$typeof:lV,type:t,compare:e===void 0?null:e}};Xr.startTransition=function(t){var e=Q1.transition;Q1.transition={};try{t()}finally{Q1.transition=e}};Xr.unstable_act=U3;Xr.useCallback=function(t,e){return Li.current.useCallback(t,e)};Xr.useContext=function(t){return Li.current.useContext(t)};Xr.useDebugValue=function(){};Xr.useDeferredValue=function(t){return Li.current.useDeferredValue(t)};Xr.useEffect=function(t,e){return Li.current.useEffect(t,e)};Xr.useId=function(){return Li.current.useId()};Xr.useImperativeHandle=function(t,e,r){return Li.current.useImperativeHandle(t,e,r)};Xr.useInsertionEffect=function(t,e){return Li.current.useInsertionEffect(t,e)};Xr.useLayoutEffect=function(t,e){return Li.current.useLayoutEffect(t,e)};Xr.useMemo=function(t,e){return Li.current.useMemo(t,e)};Xr.useReducer=function(t,e,r){return Li.current.useReducer(t,e,r)};Xr.useRef=function(t){return Li.current.useRef(t)};Xr.useState=function(t){return Li.current.useState(t)};Xr.useSyncExternalStore=function(t,e,r){return Li.current.useSyncExternalStore(t,e,r)};Xr.useTransition=function(){return Li.current.useTransition()};Xr.version="18.3.1";F3.exports=Xr;var N=F3.exports;const ui=Z7(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mV=N,pV=Symbol.for("react.element"),gV=Symbol.for("react.fragment"),xV=Object.prototype.hasOwnProperty,vV=mV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yV={key:!0,ref:!0,__self:!0,__source:!0};function O3(t,e,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)xV.call(e,n)&&!yV.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:pV,type:t,key:a,ref:o,props:s,_owner:vV.current}}Ow.Fragment=gV;Ow.jsx=O3;Ow.jsxs=O3;I3.exports=Ow;var i=I3.exports,wC={},M3={exports:{}},jo={},Q3={exports:{}},V3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(he,te){var pe=he.length;he.push(te);e:for(;0<pe;){var Ie=pe-1>>>1,S=he[Ie];if(0<s(S,te))he[Ie]=te,he[pe]=S,pe=Ie;else break e}}function r(he){return he.length===0?null:he[0]}function n(he){if(he.length===0)return null;var te=he[0],pe=he.pop();if(pe!==te){he[0]=pe;e:for(var Ie=0,S=he.length,I=S>>>1;Ie<I;){var V=2*(Ie+1)-1,j=he[V],U=V+1,G=he[U];if(0>s(j,pe))U<S&&0>s(G,j)?(he[Ie]=G,he[U]=pe,Ie=U):(he[Ie]=j,he[V]=pe,Ie=V);else if(U<S&&0>s(G,pe))he[Ie]=G,he[U]=pe,Ie=U;else break e}}return te}function s(he,te){var pe=he.sortIndex-te.sortIndex;return pe!==0?pe:he.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],A=[],u=1,d=null,f=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(he){for(var te=r(A);te!==null;){if(te.callback===null)n(A);else if(te.startTime<=he)n(A),te.sortIndex=te.expirationTime,e(c,te);else break;te=r(A)}}function k(he){if(p=!1,b(he),!m)if(r(c)!==null)m=!0,ae(P);else{var te=r(A);te!==null&&fe(k,te.startTime-he)}}function P(he,te){m=!1,p&&(p=!1,g(_),_=-1),h=!0;var pe=f;try{for(b(te),d=r(c);d!==null&&(!(d.expirationTime>te)||he&&!F());){var Ie=d.callback;if(typeof Ie=="function"){d.callback=null,f=d.priorityLevel;var S=Ie(d.expirationTime<=te);te=t.unstable_now(),typeof S=="function"?d.callback=S:d===r(c)&&n(c),b(te)}else n(c);d=r(c)}if(d!==null)var I=!0;else{var V=r(A);V!==null&&fe(k,V.startTime-te),I=!1}return I}finally{d=null,f=pe,h=!1}}var L=!1,E=null,_=-1,B=5,M=-1;function F(){return!(t.unstable_now()-M<B)}function T(){if(E!==null){var he=t.unstable_now();M=he;var te=!0;try{te=E(!0,he)}finally{te?O():(L=!1,E=null)}}else L=!1}var O;if(typeof w=="function")O=function(){w(T)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,me=Y.port2;Y.port1.onmessage=T,O=function(){me.postMessage(null)}}else O=function(){x(T,0)};function ae(he){E=he,L||(L=!0,O())}function fe(he,te){_=x(function(){he(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(he){he.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ae(P))},t.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<he?Math.floor(1e3/he):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(he){switch(f){case 1:case 2:case 3:var te=3;break;default:te=f}var pe=f;f=te;try{return he()}finally{f=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(he,te){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var pe=f;f=he;try{return te()}finally{f=pe}},t.unstable_scheduleCallback=function(he,te,pe){var Ie=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Ie+pe:Ie):pe=Ie,he){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=pe+S,he={id:u++,callback:te,priorityLevel:he,startTime:pe,expirationTime:S,sortIndex:-1},pe>Ie?(he.sortIndex=pe,e(A,he),r(c)===null&&he===r(A)&&(p?(g(_),_=-1):p=!0,fe(k,pe-Ie))):(he.sortIndex=S,e(c,he),m||h||(m=!0,ae(P))),he},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(he){var te=f;return function(){var pe=f;f=te;try{return he.apply(this,arguments)}finally{f=pe}}}})(V3);Q3.exports=V3;var wV=Q3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bV=N,Io=wV;function qt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var H3=new Set,Ag={};function Qh(t,e){C0(t,e),C0(t+"Capture",e)}function C0(t,e){for(Ag[t]=e,t=0;t<e.length;t++)H3.add(e[t])}var yA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bC=Object.prototype.hasOwnProperty,NV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k5={},T5={};function CV(t){return bC.call(T5,t)?!0:bC.call(k5,t)?!1:NV.test(t)?T5[t]=!0:(k5[t]=!0,!1)}function _V(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function EV(t,e,r,n){if(e===null||typeof e>"u"||_V(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ui(t,e,r,n,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var Ja={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ja[t]=new Ui(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ja[e]=new Ui(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ja[t]=new Ui(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ja[t]=new Ui(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ja[t]=new Ui(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ja[t]=new Ui(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ja[t]=new Ui(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ja[t]=new Ui(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ja[t]=new Ui(t,5,!1,t.toLowerCase(),null,!1,!1)});var KE=/[\-:]([a-z])/g;function qE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(KE,qE);Ja[e]=new Ui(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(KE,qE);Ja[e]=new Ui(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(KE,qE);Ja[e]=new Ui(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ja[t]=new Ui(t,1,!1,t.toLowerCase(),null,!1,!1)});Ja.xlinkHref=new Ui("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ja[t]=new Ui(t,1,!1,t.toLowerCase(),null,!0,!0)});function GE(t,e,r,n){var s=Ja.hasOwnProperty(e)?Ja[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EV(e,r,s,n)&&(r=null),n||s===null?CV(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var FA=bV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hv=Symbol.for("react.element"),zf=Symbol.for("react.portal"),Wf=Symbol.for("react.fragment"),$E=Symbol.for("react.strict_mode"),NC=Symbol.for("react.profiler"),K3=Symbol.for("react.provider"),q3=Symbol.for("react.context"),zE=Symbol.for("react.forward_ref"),CC=Symbol.for("react.suspense"),_C=Symbol.for("react.suspense_list"),WE=Symbol.for("react.memo"),mu=Symbol.for("react.lazy"),G3=Symbol.for("react.offscreen"),j5=Symbol.iterator;function jm(t){return t===null||typeof t!="object"?null:(t=j5&&t[j5]||t["@@iterator"],typeof t=="function"?t:null)}var Cs=Object.assign,xb;function op(t){if(xb===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);xb=e&&e[1]||""}return`
`+xb+t}var vb=!1;function yb(t,e){if(!t||vb)return"";vb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(A){var n=A}Reflect.construct(t,[],e)}else{try{e.call()}catch(A){n=A}t.call(e.prototype)}else{try{throw Error()}catch(A){n=A}t()}}catch(A){if(A&&n&&typeof A.stack=="string"){for(var s=A.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{vb=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?op(t):""}function BV(t){switch(t.tag){case 5:return op(t.type);case 16:return op("Lazy");case 13:return op("Suspense");case 19:return op("SuspenseList");case 0:case 2:case 15:return t=yb(t.type,!1),t;case 11:return t=yb(t.type.render,!1),t;case 1:return t=yb(t.type,!0),t;default:return""}}function EC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wf:return"Fragment";case zf:return"Portal";case NC:return"Profiler";case $E:return"StrictMode";case CC:return"Suspense";case _C:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case q3:return(t.displayName||"Context")+".Consumer";case K3:return(t._context.displayName||"Context")+".Provider";case zE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case WE:return e=t.displayName||null,e!==null?e:EC(t.type)||"Memo";case mu:e=t._payload,t=t._init;try{return EC(t(e))}catch{}}return null}function SV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return EC(e);case 8:return e===$E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function $3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function IV(t){var e=$3(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fv(t){t._valueTracker||(t._valueTracker=IV(t))}function z3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=$3(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function vy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function BC(t,e){var r=e.checked;return Cs({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function P5(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Yu(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function W3(t,e){e=e.checked,e!=null&&GE(t,"checked",e,!1)}function SC(t,e){W3(t,e);var r=Yu(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?IC(t,e.type,r):e.hasOwnProperty("defaultValue")&&IC(t,e.type,Yu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function R5(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function IC(t,e,r){(e!=="number"||vy(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var lp=Array.isArray;function c0(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Yu(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function FC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(qt(91));return Cs({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function D5(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(qt(92));if(lp(r)){if(1<r.length)throw Error(qt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Yu(r)}}function J3(t,e){var r=Yu(e.value),n=Yu(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function L5(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function X3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?X3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var mv,Y3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(mv=mv||document.createElement("div"),mv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ug(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Sp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FV=["Webkit","ms","Moz","O"];Object.keys(Sp).forEach(function(t){FV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Sp[e]=Sp[t]})});function Z3(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Sp.hasOwnProperty(t)&&Sp[t]?(""+e).trim():e+"px"}function eR(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Z3(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var kV=Cs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function TC(t,e){if(e){if(kV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(qt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(qt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(qt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(qt(62))}}function jC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var PC=null;function JE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var RC=null,A0=null,u0=null;function U5(t){if(t=mx(t)){if(typeof RC!="function")throw Error(qt(280));var e=t.stateNode;e&&(e=Kw(e),RC(t.stateNode,t.type,e))}}function tR(t){A0?u0?u0.push(t):u0=[t]:A0=t}function rR(){if(A0){var t=A0,e=u0;if(u0=A0=null,U5(t),e)for(t=0;t<e.length;t++)U5(e[t])}}function nR(t,e){return t(e)}function sR(){}var wb=!1;function aR(t,e,r){if(wb)return t(e,r);wb=!0;try{return nR(t,e,r)}finally{wb=!1,(A0!==null||u0!==null)&&(sR(),rR())}}function dg(t,e){var r=t.stateNode;if(r===null)return null;var n=Kw(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(qt(231,e,typeof r));return r}var DC=!1;if(yA)try{var Pm={};Object.defineProperty(Pm,"passive",{get:function(){DC=!0}}),window.addEventListener("test",Pm,Pm),window.removeEventListener("test",Pm,Pm)}catch{DC=!1}function TV(t,e,r,n,s,a,o,l,c){var A=Array.prototype.slice.call(arguments,3);try{e.apply(r,A)}catch(u){this.onError(u)}}var Ip=!1,yy=null,wy=!1,LC=null,jV={onError:function(t){Ip=!0,yy=t}};function PV(t,e,r,n,s,a,o,l,c){Ip=!1,yy=null,TV.apply(jV,arguments)}function RV(t,e,r,n,s,a,o,l,c){if(PV.apply(this,arguments),Ip){if(Ip){var A=yy;Ip=!1,yy=null}else throw Error(qt(198));wy||(wy=!0,LC=A)}}function Vh(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function iR(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function O5(t){if(Vh(t)!==t)throw Error(qt(188))}function DV(t){var e=t.alternate;if(!e){if(e=Vh(t),e===null)throw Error(qt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return O5(s),t;if(a===n)return O5(s),e;a=a.sibling}throw Error(qt(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(qt(189))}}if(r.alternate!==n)throw Error(qt(190))}if(r.tag!==3)throw Error(qt(188));return r.stateNode.current===r?t:e}function oR(t){return t=DV(t),t!==null?lR(t):null}function lR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lR(t);if(e!==null)return e;t=t.sibling}return null}var cR=Io.unstable_scheduleCallback,M5=Io.unstable_cancelCallback,LV=Io.unstable_shouldYield,UV=Io.unstable_requestPaint,Hs=Io.unstable_now,OV=Io.unstable_getCurrentPriorityLevel,XE=Io.unstable_ImmediatePriority,AR=Io.unstable_UserBlockingPriority,by=Io.unstable_NormalPriority,MV=Io.unstable_LowPriority,uR=Io.unstable_IdlePriority,Mw=null,yc=null;function QV(t){if(yc&&typeof yc.onCommitFiberRoot=="function")try{yc.onCommitFiberRoot(Mw,t,void 0,(t.current.flags&128)===128)}catch{}}var Dl=Math.clz32?Math.clz32:KV,VV=Math.log,HV=Math.LN2;function KV(t){return t>>>=0,t===0?32:31-(VV(t)/HV|0)|0}var pv=64,gv=4194304;function cp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ny(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=cp(l):(a&=o,a!==0&&(n=cp(a)))}else o=r&~s,o!==0?n=cp(o):a!==0&&(n=cp(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Dl(e),s=1<<r,n|=t[r],e&=~s;return n}function qV(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GV(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-Dl(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=qV(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function UC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function dR(){var t=pv;return pv<<=1,!(pv&4194240)&&(pv=64),t}function bb(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function hx(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Dl(e),t[e]=r}function $V(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Dl(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function YE(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Dl(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var kn=0;function hR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var fR,ZE,mR,pR,gR,OC=!1,xv=[],Du=null,Lu=null,Uu=null,hg=new Map,fg=new Map,xu=[],zV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Q5(t,e){switch(t){case"focusin":case"focusout":Du=null;break;case"dragenter":case"dragleave":Lu=null;break;case"mouseover":case"mouseout":Uu=null;break;case"pointerover":case"pointerout":hg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fg.delete(e.pointerId)}}function Rm(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=mx(e),e!==null&&ZE(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function WV(t,e,r,n,s){switch(e){case"focusin":return Du=Rm(Du,t,e,r,n,s),!0;case"dragenter":return Lu=Rm(Lu,t,e,r,n,s),!0;case"mouseover":return Uu=Rm(Uu,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return hg.set(a,Rm(hg.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,fg.set(a,Rm(fg.get(a)||null,t,e,r,n,s)),!0}return!1}function xR(t){var e=Zd(t.target);if(e!==null){var r=Vh(e);if(r!==null){if(e=r.tag,e===13){if(e=iR(r),e!==null){t.blockedOn=e,gR(t.priority,function(){mR(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function V1(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=MC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);PC=n,r.target.dispatchEvent(n),PC=null}else return e=mx(r),e!==null&&ZE(e),t.blockedOn=r,!1;e.shift()}return!0}function V5(t,e,r){V1(t)&&r.delete(e)}function JV(){OC=!1,Du!==null&&V1(Du)&&(Du=null),Lu!==null&&V1(Lu)&&(Lu=null),Uu!==null&&V1(Uu)&&(Uu=null),hg.forEach(V5),fg.forEach(V5)}function Dm(t,e){t.blockedOn===e&&(t.blockedOn=null,OC||(OC=!0,Io.unstable_scheduleCallback(Io.unstable_NormalPriority,JV)))}function mg(t){function e(s){return Dm(s,t)}if(0<xv.length){Dm(xv[0],t);for(var r=1;r<xv.length;r++){var n=xv[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Du!==null&&Dm(Du,t),Lu!==null&&Dm(Lu,t),Uu!==null&&Dm(Uu,t),hg.forEach(e),fg.forEach(e),r=0;r<xu.length;r++)n=xu[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<xu.length&&(r=xu[0],r.blockedOn===null);)xR(r),r.blockedOn===null&&xu.shift()}var d0=FA.ReactCurrentBatchConfig,Cy=!0;function XV(t,e,r,n){var s=kn,a=d0.transition;d0.transition=null;try{kn=1,eB(t,e,r,n)}finally{kn=s,d0.transition=a}}function YV(t,e,r,n){var s=kn,a=d0.transition;d0.transition=null;try{kn=4,eB(t,e,r,n)}finally{kn=s,d0.transition=a}}function eB(t,e,r,n){if(Cy){var s=MC(t,e,r,n);if(s===null)Tb(t,e,n,_y,r),Q5(t,n);else if(WV(s,t,e,r,n))n.stopPropagation();else if(Q5(t,n),e&4&&-1<zV.indexOf(t)){for(;s!==null;){var a=mx(s);if(a!==null&&fR(a),a=MC(t,e,r,n),a===null&&Tb(t,e,n,_y,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Tb(t,e,n,null,r)}}var _y=null;function MC(t,e,r,n){if(_y=null,t=JE(n),t=Zd(t),t!==null)if(e=Vh(t),e===null)t=null;else if(r=e.tag,r===13){if(t=iR(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _y=t,null}function vR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OV()){case XE:return 1;case AR:return 4;case by:case MV:return 16;case uR:return 536870912;default:return 16}default:return 16}}var Bu=null,tB=null,H1=null;function yR(){if(H1)return H1;var t,e=tB,r=e.length,n,s="value"in Bu?Bu.value:Bu.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[a-n];n++);return H1=s.slice(t,1<n?1-n:void 0)}function K1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vv(){return!0}function H5(){return!1}function Po(t){function e(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?vv:H5,this.isPropagationStopped=H5,this}return Cs(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vv)},persist:function(){},isPersistent:vv}),e}var $0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rB=Po($0),fx=Cs({},$0,{view:0,detail:0}),ZV=Po(fx),Nb,Cb,Lm,Qw=Cs({},fx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nB,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Lm&&(Lm&&t.type==="mousemove"?(Nb=t.screenX-Lm.screenX,Cb=t.screenY-Lm.screenY):Cb=Nb=0,Lm=t),Nb)},movementY:function(t){return"movementY"in t?t.movementY:Cb}}),K5=Po(Qw),e9=Cs({},Qw,{dataTransfer:0}),t9=Po(e9),r9=Cs({},fx,{relatedTarget:0}),_b=Po(r9),n9=Cs({},$0,{animationName:0,elapsedTime:0,pseudoElement:0}),s9=Po(n9),a9=Cs({},$0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),i9=Po(a9),o9=Cs({},$0,{data:0}),q5=Po(o9),l9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},c9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=A9[t])?!!e[t]:!1}function nB(){return u9}var d9=Cs({},fx,{key:function(t){if(t.key){var e=l9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=K1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?c9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nB,charCode:function(t){return t.type==="keypress"?K1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?K1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),h9=Po(d9),f9=Cs({},Qw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),G5=Po(f9),m9=Cs({},fx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nB}),p9=Po(m9),g9=Cs({},$0,{propertyName:0,elapsedTime:0,pseudoElement:0}),x9=Po(g9),v9=Cs({},Qw,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),y9=Po(v9),w9=[9,13,27,32],sB=yA&&"CompositionEvent"in window,Fp=null;yA&&"documentMode"in document&&(Fp=document.documentMode);var b9=yA&&"TextEvent"in window&&!Fp,wR=yA&&(!sB||Fp&&8<Fp&&11>=Fp),$5=" ",z5=!1;function bR(t,e){switch(t){case"keyup":return w9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function NR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Jf=!1;function N9(t,e){switch(t){case"compositionend":return NR(e);case"keypress":return e.which!==32?null:(z5=!0,$5);case"textInput":return t=e.data,t===$5&&z5?null:t;default:return null}}function C9(t,e){if(Jf)return t==="compositionend"||!sB&&bR(t,e)?(t=yR(),H1=tB=Bu=null,Jf=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wR&&e.locale!=="ko"?null:e.data;default:return null}}var _9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function W5(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_9[t.type]:e==="textarea"}function CR(t,e,r,n){tR(n),e=Ey(e,"onChange"),0<e.length&&(r=new rB("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var kp=null,pg=null;function E9(t){RR(t,0)}function Vw(t){var e=Zf(t);if(z3(e))return t}function B9(t,e){if(t==="change")return e}var _R=!1;if(yA){var Eb;if(yA){var Bb="oninput"in document;if(!Bb){var J5=document.createElement("div");J5.setAttribute("oninput","return;"),Bb=typeof J5.oninput=="function"}Eb=Bb}else Eb=!1;_R=Eb&&(!document.documentMode||9<document.documentMode)}function X5(){kp&&(kp.detachEvent("onpropertychange",ER),pg=kp=null)}function ER(t){if(t.propertyName==="value"&&Vw(pg)){var e=[];CR(e,pg,t,JE(t)),aR(E9,e)}}function S9(t,e,r){t==="focusin"?(X5(),kp=e,pg=r,kp.attachEvent("onpropertychange",ER)):t==="focusout"&&X5()}function I9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vw(pg)}function F9(t,e){if(t==="click")return Vw(e)}function k9(t,e){if(t==="input"||t==="change")return Vw(e)}function T9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ql=typeof Object.is=="function"?Object.is:T9;function gg(t,e){if(Ql(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!bC.call(e,s)||!Ql(t[s],e[s]))return!1}return!0}function Y5(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Z5(t,e){var r=Y5(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Y5(r)}}function BR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?BR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function SR(){for(var t=window,e=vy();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=vy(t.document)}return e}function aB(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function j9(t){var e=SR(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&BR(r.ownerDocument.documentElement,r)){if(n!==null&&aB(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=Z5(r,a);var o=Z5(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var P9=yA&&"documentMode"in document&&11>=document.documentMode,Xf=null,QC=null,Tp=null,VC=!1;function e4(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;VC||Xf==null||Xf!==vy(n)||(n=Xf,"selectionStart"in n&&aB(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Tp&&gg(Tp,n)||(Tp=n,n=Ey(QC,"onSelect"),0<n.length&&(e=new rB("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Xf)))}function yv(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Yf={animationend:yv("Animation","AnimationEnd"),animationiteration:yv("Animation","AnimationIteration"),animationstart:yv("Animation","AnimationStart"),transitionend:yv("Transition","TransitionEnd")},Sb={},IR={};yA&&(IR=document.createElement("div").style,"AnimationEvent"in window||(delete Yf.animationend.animation,delete Yf.animationiteration.animation,delete Yf.animationstart.animation),"TransitionEvent"in window||delete Yf.transitionend.transition);function Hw(t){if(Sb[t])return Sb[t];if(!Yf[t])return t;var e=Yf[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in IR)return Sb[t]=e[r];return t}var FR=Hw("animationend"),kR=Hw("animationiteration"),TR=Hw("animationstart"),jR=Hw("transitionend"),PR=new Map,t4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dd(t,e){PR.set(t,e),Qh(e,[t])}for(var Ib=0;Ib<t4.length;Ib++){var Fb=t4[Ib],R9=Fb.toLowerCase(),D9=Fb[0].toUpperCase()+Fb.slice(1);dd(R9,"on"+D9)}dd(FR,"onAnimationEnd");dd(kR,"onAnimationIteration");dd(TR,"onAnimationStart");dd("dblclick","onDoubleClick");dd("focusin","onFocus");dd("focusout","onBlur");dd(jR,"onTransitionEnd");C0("onMouseEnter",["mouseout","mouseover"]);C0("onMouseLeave",["mouseout","mouseover"]);C0("onPointerEnter",["pointerout","pointerover"]);C0("onPointerLeave",["pointerout","pointerover"]);Qh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ap="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),L9=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ap));function r4(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,RV(n,e,void 0,t),t.currentTarget=null}function RR(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,A=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;r4(s,l,A),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,A=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;r4(s,l,A),a=c}}}if(wy)throw t=LC,wy=!1,LC=null,t}function Zn(t,e){var r=e[$C];r===void 0&&(r=e[$C]=new Set);var n=t+"__bubble";r.has(n)||(DR(e,t,2,!1),r.add(n))}function kb(t,e,r){var n=0;e&&(n|=4),DR(r,t,n,e)}var wv="_reactListening"+Math.random().toString(36).slice(2);function xg(t){if(!t[wv]){t[wv]=!0,H3.forEach(function(r){r!=="selectionchange"&&(L9.has(r)||kb(r,!1,t),kb(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wv]||(e[wv]=!0,kb("selectionchange",!1,e))}}function DR(t,e,r,n){switch(vR(e)){case 1:var s=XV;break;case 4:s=YV;break;default:s=eB}r=s.bind(null,e,r,t),s=void 0,!DC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Tb(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Zd(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}aR(function(){var A=a,u=JE(r),d=[];e:{var f=PR.get(t);if(f!==void 0){var h=rB,m=t;switch(t){case"keypress":if(K1(r)===0)break e;case"keydown":case"keyup":h=h9;break;case"focusin":m="focus",h=_b;break;case"focusout":m="blur",h=_b;break;case"beforeblur":case"afterblur":h=_b;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=K5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=t9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=p9;break;case FR:case kR:case TR:h=s9;break;case jR:h=x9;break;case"scroll":h=ZV;break;case"wheel":h=y9;break;case"copy":case"cut":case"paste":h=i9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=G5}var p=(e&4)!==0,x=!p&&t==="scroll",g=p?f!==null?f+"Capture":null:f;p=[];for(var w=A,b;w!==null;){b=w;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,g!==null&&(k=dg(w,g),k!=null&&p.push(vg(w,k,b)))),x)break;w=w.return}0<p.length&&(f=new h(f,m,null,r,u),d.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&r!==PC&&(m=r.relatedTarget||r.fromElement)&&(Zd(m)||m[wA]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=A,m=m?Zd(m):null,m!==null&&(x=Vh(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=A),h!==m)){if(p=K5,k="onMouseLeave",g="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(p=G5,k="onPointerLeave",g="onPointerEnter",w="pointer"),x=h==null?f:Zf(h),b=m==null?f:Zf(m),f=new p(k,w+"leave",h,r,u),f.target=x,f.relatedTarget=b,k=null,Zd(u)===A&&(p=new p(g,w+"enter",m,r,u),p.target=b,p.relatedTarget=x,k=p),x=k,h&&m)t:{for(p=h,g=m,w=0,b=p;b;b=mf(b))w++;for(b=0,k=g;k;k=mf(k))b++;for(;0<w-b;)p=mf(p),w--;for(;0<b-w;)g=mf(g),b--;for(;w--;){if(p===g||g!==null&&p===g.alternate)break t;p=mf(p),g=mf(g)}p=null}else p=null;h!==null&&n4(d,f,h,p,!1),m!==null&&x!==null&&n4(d,x,m,p,!0)}}e:{if(f=A?Zf(A):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var P=B9;else if(W5(f))if(_R)P=k9;else{P=I9;var L=S9}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=F9);if(P&&(P=P(t,A))){CR(d,P,r,u);break e}L&&L(t,f,A),t==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&IC(f,"number",f.value)}switch(L=A?Zf(A):window,t){case"focusin":(W5(L)||L.contentEditable==="true")&&(Xf=L,QC=A,Tp=null);break;case"focusout":Tp=QC=Xf=null;break;case"mousedown":VC=!0;break;case"contextmenu":case"mouseup":case"dragend":VC=!1,e4(d,r,u);break;case"selectionchange":if(P9)break;case"keydown":case"keyup":e4(d,r,u)}var E;if(sB)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Jf?bR(t,r)&&(_="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(_="onCompositionStart");_&&(wR&&r.locale!=="ko"&&(Jf||_!=="onCompositionStart"?_==="onCompositionEnd"&&Jf&&(E=yR()):(Bu=u,tB="value"in Bu?Bu.value:Bu.textContent,Jf=!0)),L=Ey(A,_),0<L.length&&(_=new q5(_,t,null,r,u),d.push({event:_,listeners:L}),E?_.data=E:(E=NR(r),E!==null&&(_.data=E)))),(E=b9?N9(t,r):C9(t,r))&&(A=Ey(A,"onBeforeInput"),0<A.length&&(u=new q5("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:A}),u.data=E))}RR(d,e)})}function vg(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Ey(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=dg(t,r),a!=null&&n.unshift(vg(t,a,s)),a=dg(t,e),a!=null&&n.push(vg(t,a,s))),t=t.return}return n}function mf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function n4(t,e,r,n,s){for(var a=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,A=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&A!==null&&(l=A,s?(c=dg(r,a),c!=null&&o.unshift(vg(r,c,l))):s||(c=dg(r,a),c!=null&&o.push(vg(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var U9=/\r\n?/g,O9=/\u0000|\uFFFD/g;function s4(t){return(typeof t=="string"?t:""+t).replace(U9,`
`).replace(O9,"")}function bv(t,e,r){if(e=s4(e),s4(t)!==e&&r)throw Error(qt(425))}function By(){}var HC=null,KC=null;function qC(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var GC=typeof setTimeout=="function"?setTimeout:void 0,M9=typeof clearTimeout=="function"?clearTimeout:void 0,a4=typeof Promise=="function"?Promise:void 0,Q9=typeof queueMicrotask=="function"?queueMicrotask:typeof a4<"u"?function(t){return a4.resolve(null).then(t).catch(V9)}:GC;function V9(t){setTimeout(function(){throw t})}function jb(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),mg(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);mg(e)}function Ou(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function i4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var z0=Math.random().toString(36).slice(2),fc="__reactFiber$"+z0,yg="__reactProps$"+z0,wA="__reactContainer$"+z0,$C="__reactEvents$"+z0,H9="__reactListeners$"+z0,K9="__reactHandles$"+z0;function Zd(t){var e=t[fc];if(e)return e;for(var r=t.parentNode;r;){if(e=r[wA]||r[fc]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=i4(t);t!==null;){if(r=t[fc])return r;t=i4(t)}return e}t=r,r=t.parentNode}return null}function mx(t){return t=t[fc]||t[wA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(qt(33))}function Kw(t){return t[yg]||null}var zC=[],e0=-1;function hd(t){return{current:t}}function rs(t){0>e0||(t.current=zC[e0],zC[e0]=null,e0--)}function Wn(t,e){e0++,zC[e0]=t.current,t.current=e}var Zu={},xi=hd(Zu),Xi=hd(!1),vh=Zu;function _0(t,e){var r=t.type.contextTypes;if(!r)return Zu;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Yi(t){return t=t.childContextTypes,t!=null}function Sy(){rs(Xi),rs(xi)}function o4(t,e,r){if(xi.current!==Zu)throw Error(qt(168));Wn(xi,e),Wn(Xi,r)}function LR(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(qt(108,SV(t)||"Unknown",s));return Cs({},r,n)}function Iy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zu,vh=xi.current,Wn(xi,t),Wn(Xi,Xi.current),!0}function l4(t,e,r){var n=t.stateNode;if(!n)throw Error(qt(169));r?(t=LR(t,e,vh),n.__reactInternalMemoizedMergedChildContext=t,rs(Xi),rs(xi),Wn(xi,t)):rs(Xi),Wn(Xi,r)}var tA=null,qw=!1,Pb=!1;function UR(t){tA===null?tA=[t]:tA.push(t)}function q9(t){qw=!0,UR(t)}function fd(){if(!Pb&&tA!==null){Pb=!0;var t=0,e=kn;try{var r=tA;for(kn=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}tA=null,qw=!1}catch(s){throw tA!==null&&(tA=tA.slice(t+1)),cR(XE,fd),s}finally{kn=e,Pb=!1}}return null}var t0=[],r0=0,Fy=null,ky=0,nl=[],sl=0,yh=null,nA=1,sA="";function Md(t,e){t0[r0++]=ky,t0[r0++]=Fy,Fy=t,ky=e}function OR(t,e,r){nl[sl++]=nA,nl[sl++]=sA,nl[sl++]=yh,yh=t;var n=nA;t=sA;var s=32-Dl(n)-1;n&=~(1<<s),r+=1;var a=32-Dl(e)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,nA=1<<32-Dl(e)+s|r<<s|n,sA=a+t}else nA=1<<a|r<<s|n,sA=t}function iB(t){t.return!==null&&(Md(t,1),OR(t,1,0))}function oB(t){for(;t===Fy;)Fy=t0[--r0],t0[r0]=null,ky=t0[--r0],t0[r0]=null;for(;t===yh;)yh=nl[--sl],nl[sl]=null,sA=nl[--sl],nl[sl]=null,nA=nl[--sl],nl[sl]=null}var So=null,_o=null,cs=!1,jl=null;function MR(t,e){var r=il(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function c4(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,So=t,_o=Ou(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,So=t,_o=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=yh!==null?{id:nA,overflow:sA}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=il(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,So=t,_o=null,!0):!1;default:return!1}}function WC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function JC(t){if(cs){var e=_o;if(e){var r=e;if(!c4(t,e)){if(WC(t))throw Error(qt(418));e=Ou(r.nextSibling);var n=So;e&&c4(t,e)?MR(n,r):(t.flags=t.flags&-4097|2,cs=!1,So=t)}}else{if(WC(t))throw Error(qt(418));t.flags=t.flags&-4097|2,cs=!1,So=t}}}function A4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;So=t}function Nv(t){if(t!==So)return!1;if(!cs)return A4(t),cs=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!qC(t.type,t.memoizedProps)),e&&(e=_o)){if(WC(t))throw QR(),Error(qt(418));for(;e;)MR(t,e),e=Ou(e.nextSibling)}if(A4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(qt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){_o=Ou(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}_o=null}}else _o=So?Ou(t.stateNode.nextSibling):null;return!0}function QR(){for(var t=_o;t;)t=Ou(t.nextSibling)}function E0(){_o=So=null,cs=!1}function lB(t){jl===null?jl=[t]:jl.push(t)}var G9=FA.ReactCurrentBatchConfig;function Um(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(qt(309));var n=r.stateNode}if(!n)throw Error(qt(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(qt(284));if(!r._owner)throw Error(qt(290,t))}return t}function Cv(t,e){throw t=Object.prototype.toString.call(e),Error(qt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function u4(t){var e=t._init;return e(t._payload)}function VR(t){function e(g,w){if(t){var b=g.deletions;b===null?(g.deletions=[w],g.flags|=16):b.push(w)}}function r(g,w){if(!t)return null;for(;w!==null;)e(g,w),w=w.sibling;return null}function n(g,w){for(g=new Map;w!==null;)w.key!==null?g.set(w.key,w):g.set(w.index,w),w=w.sibling;return g}function s(g,w){return g=Hu(g,w),g.index=0,g.sibling=null,g}function a(g,w,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<w?(g.flags|=2,w):b):(g.flags|=2,w)):(g.flags|=1048576,w)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,w,b,k){return w===null||w.tag!==6?(w=Qb(b,g.mode,k),w.return=g,w):(w=s(w,b),w.return=g,w)}function c(g,w,b,k){var P=b.type;return P===Wf?u(g,w,b.props.children,k,b.key):w!==null&&(w.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===mu&&u4(P)===w.type)?(k=s(w,b.props),k.ref=Um(g,w,b),k.return=g,k):(k=X1(b.type,b.key,b.props,null,g.mode,k),k.ref=Um(g,w,b),k.return=g,k)}function A(g,w,b,k){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=Vb(b,g.mode,k),w.return=g,w):(w=s(w,b.children||[]),w.return=g,w)}function u(g,w,b,k,P){return w===null||w.tag!==7?(w=oh(b,g.mode,k,P),w.return=g,w):(w=s(w,b),w.return=g,w)}function d(g,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Qb(""+w,g.mode,b),w.return=g,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case hv:return b=X1(w.type,w.key,w.props,null,g.mode,b),b.ref=Um(g,null,w),b.return=g,b;case zf:return w=Vb(w,g.mode,b),w.return=g,w;case mu:var k=w._init;return d(g,k(w._payload),b)}if(lp(w)||jm(w))return w=oh(w,g.mode,b,null),w.return=g,w;Cv(g,w)}return null}function f(g,w,b,k){var P=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return P!==null?null:l(g,w,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case hv:return b.key===P?c(g,w,b,k):null;case zf:return b.key===P?A(g,w,b,k):null;case mu:return P=b._init,f(g,w,P(b._payload),k)}if(lp(b)||jm(b))return P!==null?null:u(g,w,b,k,null);Cv(g,b)}return null}function h(g,w,b,k,P){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(b)||null,l(w,g,""+k,P);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case hv:return g=g.get(k.key===null?b:k.key)||null,c(w,g,k,P);case zf:return g=g.get(k.key===null?b:k.key)||null,A(w,g,k,P);case mu:var L=k._init;return h(g,w,b,L(k._payload),P)}if(lp(k)||jm(k))return g=g.get(b)||null,u(w,g,k,P,null);Cv(w,k)}return null}function m(g,w,b,k){for(var P=null,L=null,E=w,_=w=0,B=null;E!==null&&_<b.length;_++){E.index>_?(B=E,E=null):B=E.sibling;var M=f(g,E,b[_],k);if(M===null){E===null&&(E=B);break}t&&E&&M.alternate===null&&e(g,E),w=a(M,w,_),L===null?P=M:L.sibling=M,L=M,E=B}if(_===b.length)return r(g,E),cs&&Md(g,_),P;if(E===null){for(;_<b.length;_++)E=d(g,b[_],k),E!==null&&(w=a(E,w,_),L===null?P=E:L.sibling=E,L=E);return cs&&Md(g,_),P}for(E=n(g,E);_<b.length;_++)B=h(E,g,_,b[_],k),B!==null&&(t&&B.alternate!==null&&E.delete(B.key===null?_:B.key),w=a(B,w,_),L===null?P=B:L.sibling=B,L=B);return t&&E.forEach(function(F){return e(g,F)}),cs&&Md(g,_),P}function p(g,w,b,k){var P=jm(b);if(typeof P!="function")throw Error(qt(150));if(b=P.call(b),b==null)throw Error(qt(151));for(var L=P=null,E=w,_=w=0,B=null,M=b.next();E!==null&&!M.done;_++,M=b.next()){E.index>_?(B=E,E=null):B=E.sibling;var F=f(g,E,M.value,k);if(F===null){E===null&&(E=B);break}t&&E&&F.alternate===null&&e(g,E),w=a(F,w,_),L===null?P=F:L.sibling=F,L=F,E=B}if(M.done)return r(g,E),cs&&Md(g,_),P;if(E===null){for(;!M.done;_++,M=b.next())M=d(g,M.value,k),M!==null&&(w=a(M,w,_),L===null?P=M:L.sibling=M,L=M);return cs&&Md(g,_),P}for(E=n(g,E);!M.done;_++,M=b.next())M=h(E,g,_,M.value,k),M!==null&&(t&&M.alternate!==null&&E.delete(M.key===null?_:M.key),w=a(M,w,_),L===null?P=M:L.sibling=M,L=M);return t&&E.forEach(function(T){return e(g,T)}),cs&&Md(g,_),P}function x(g,w,b,k){if(typeof b=="object"&&b!==null&&b.type===Wf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case hv:e:{for(var P=b.key,L=w;L!==null;){if(L.key===P){if(P=b.type,P===Wf){if(L.tag===7){r(g,L.sibling),w=s(L,b.props.children),w.return=g,g=w;break e}}else if(L.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===mu&&u4(P)===L.type){r(g,L.sibling),w=s(L,b.props),w.ref=Um(g,L,b),w.return=g,g=w;break e}r(g,L);break}else e(g,L);L=L.sibling}b.type===Wf?(w=oh(b.props.children,g.mode,k,b.key),w.return=g,g=w):(k=X1(b.type,b.key,b.props,null,g.mode,k),k.ref=Um(g,w,b),k.return=g,g=k)}return o(g);case zf:e:{for(L=b.key;w!==null;){if(w.key===L)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){r(g,w.sibling),w=s(w,b.children||[]),w.return=g,g=w;break e}else{r(g,w);break}else e(g,w);w=w.sibling}w=Vb(b,g.mode,k),w.return=g,g=w}return o(g);case mu:return L=b._init,x(g,w,L(b._payload),k)}if(lp(b))return m(g,w,b,k);if(jm(b))return p(g,w,b,k);Cv(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(r(g,w.sibling),w=s(w,b),w.return=g,g=w):(r(g,w),w=Qb(b,g.mode,k),w.return=g,g=w),o(g)):r(g,w)}return x}var B0=VR(!0),HR=VR(!1),Ty=hd(null),jy=null,n0=null,cB=null;function AB(){cB=n0=jy=null}function uB(t){var e=Ty.current;rs(Ty),t._currentValue=e}function XC(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function h0(t,e){jy=t,cB=n0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wi=!0),t.firstContext=null)}function hl(t){var e=t._currentValue;if(cB!==t)if(t={context:t,memoizedValue:e,next:null},n0===null){if(jy===null)throw Error(qt(308));n0=t,jy.dependencies={lanes:0,firstContext:t}}else n0=n0.next=t;return e}var eh=null;function dB(t){eh===null?eh=[t]:eh.push(t)}function KR(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,dB(e)):(r.next=s.next,s.next=r),e.interleaved=r,bA(t,n)}function bA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var pu=!1;function hB(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function AA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Mu(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,An&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,bA(t,r)}return s=n.interleaved,s===null?(e.next=e,dB(n)):(e.next=s.next,s.next=e),n.interleaved=e,bA(t,r)}function q1(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,YE(t,r)}}function d4(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Py(t,e,r,n){var s=t.updateQueue;pu=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,A=c.next;c.next=null,o===null?a=A:o.next=A,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=A:l.next=A,u.lastBaseUpdate=c))}if(a!==null){var d=s.baseState;o=0,u=A=c=null,l=a;do{var f=l.lane,h=l.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(f=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(h,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(h,d,f):m,f==null)break e;d=Cs({},d,f);break e;case 2:pu=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(A=u=h,c=d):u=u.next=h,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(c=d),s.baseState=c,s.firstBaseUpdate=A,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);bh|=o,t.lanes=o,t.memoizedState=d}}function h4(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(qt(191,s));s.call(n)}}}var px={},wc=hd(px),wg=hd(px),bg=hd(px);function th(t){if(t===px)throw Error(qt(174));return t}function fB(t,e){switch(Wn(bg,e),Wn(wg,t),Wn(wc,px),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=kC(e,t)}rs(wc),Wn(wc,e)}function S0(){rs(wc),rs(wg),rs(bg)}function GR(t){th(bg.current);var e=th(wc.current),r=kC(e,t.type);e!==r&&(Wn(wg,t),Wn(wc,r))}function mB(t){wg.current===t&&(rs(wc),rs(wg))}var ys=hd(0);function Ry(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rb=[];function pB(){for(var t=0;t<Rb.length;t++)Rb[t]._workInProgressVersionPrimary=null;Rb.length=0}var G1=FA.ReactCurrentDispatcher,Db=FA.ReactCurrentBatchConfig,wh=0,Ns=null,Aa=null,_a=null,Dy=!1,jp=!1,Ng=0,$9=0;function ei(){throw Error(qt(321))}function gB(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ql(t[r],e[r]))return!1;return!0}function xB(t,e,r,n,s,a){if(wh=a,Ns=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,G1.current=t===null||t.memoizedState===null?X9:Y9,t=r(n,s),jp){a=0;do{if(jp=!1,Ng=0,25<=a)throw Error(qt(301));a+=1,_a=Aa=null,e.updateQueue=null,G1.current=Z9,t=r(n,s)}while(jp)}if(G1.current=Ly,e=Aa!==null&&Aa.next!==null,wh=0,_a=Aa=Ns=null,Dy=!1,e)throw Error(qt(300));return t}function vB(){var t=Ng!==0;return Ng=0,t}function hc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _a===null?Ns.memoizedState=_a=t:_a=_a.next=t,_a}function fl(){if(Aa===null){var t=Ns.alternate;t=t!==null?t.memoizedState:null}else t=Aa.next;var e=_a===null?Ns.memoizedState:_a.next;if(e!==null)_a=e,Aa=t;else{if(t===null)throw Error(qt(310));Aa=t,t={memoizedState:Aa.memoizedState,baseState:Aa.baseState,baseQueue:Aa.baseQueue,queue:Aa.queue,next:null},_a===null?Ns.memoizedState=_a=t:_a=_a.next=t}return _a}function Cg(t,e){return typeof e=="function"?e(t):e}function Lb(t){var e=fl(),r=e.queue;if(r===null)throw Error(qt(311));r.lastRenderedReducer=t;var n=Aa,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,A=a;do{var u=A.lane;if((wh&u)===u)c!==null&&(c=c.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),n=A.hasEagerState?A.eagerState:t(n,A.action);else{var d={lane:u,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};c===null?(l=c=d,o=n):c=c.next=d,Ns.lanes|=u,bh|=u}A=A.next}while(A!==null&&A!==a);c===null?o=n:c.next=l,Ql(n,e.memoizedState)||(Wi=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,Ns.lanes|=a,bh|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Ub(t){var e=fl(),r=e.queue;if(r===null)throw Error(qt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);Ql(a,e.memoizedState)||(Wi=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function $R(){}function zR(t,e){var r=Ns,n=fl(),s=e(),a=!Ql(n.memoizedState,s);if(a&&(n.memoizedState=s,Wi=!0),n=n.queue,yB(XR.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||_a!==null&&_a.memoizedState.tag&1){if(r.flags|=2048,_g(9,JR.bind(null,r,n,s,e),void 0,null),Sa===null)throw Error(qt(349));wh&30||WR(r,e,s)}return s}function WR(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ns.updateQueue,e===null?(e={lastEffect:null,stores:null},Ns.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function JR(t,e,r,n){e.value=r,e.getSnapshot=n,YR(e)&&ZR(t)}function XR(t,e,r){return r(function(){YR(e)&&ZR(t)})}function YR(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ql(t,r)}catch{return!0}}function ZR(t){var e=bA(t,1);e!==null&&Ll(e,t,1,-1)}function f4(t){var e=hc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cg,lastRenderedState:t},e.queue=t,t=t.dispatch=J9.bind(null,Ns,t),[e.memoizedState,t]}function _g(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ns.updateQueue,e===null?(e={lastEffect:null,stores:null},Ns.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function eD(){return fl().memoizedState}function $1(t,e,r,n){var s=hc();Ns.flags|=t,s.memoizedState=_g(1|e,r,void 0,n===void 0?null:n)}function Gw(t,e,r,n){var s=fl();n=n===void 0?null:n;var a=void 0;if(Aa!==null){var o=Aa.memoizedState;if(a=o.destroy,n!==null&&gB(n,o.deps)){s.memoizedState=_g(e,r,a,n);return}}Ns.flags|=t,s.memoizedState=_g(1|e,r,a,n)}function m4(t,e){return $1(8390656,8,t,e)}function yB(t,e){return Gw(2048,8,t,e)}function tD(t,e){return Gw(4,2,t,e)}function rD(t,e){return Gw(4,4,t,e)}function nD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sD(t,e,r){return r=r!=null?r.concat([t]):null,Gw(4,4,nD.bind(null,e,t),r)}function wB(){}function aD(t,e){var r=fl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&gB(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function iD(t,e){var r=fl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&gB(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function oD(t,e,r){return wh&21?(Ql(r,e)||(r=dR(),Ns.lanes|=r,bh|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wi=!0),t.memoizedState=r)}function z9(t,e){var r=kn;kn=r!==0&&4>r?r:4,t(!0);var n=Db.transition;Db.transition={};try{t(!1),e()}finally{kn=r,Db.transition=n}}function lD(){return fl().memoizedState}function W9(t,e,r){var n=Vu(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},cD(t))AD(e,r);else if(r=KR(t,e,r,n),r!==null){var s=Pi();Ll(r,t,n,s),uD(r,e,n)}}function J9(t,e,r){var n=Vu(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(cD(t))AD(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,Ql(l,o)){var c=e.interleaved;c===null?(s.next=s,dB(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=KR(t,e,s,n),r!==null&&(s=Pi(),Ll(r,t,n,s),uD(r,e,n))}}function cD(t){var e=t.alternate;return t===Ns||e!==null&&e===Ns}function AD(t,e){jp=Dy=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function uD(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,YE(t,r)}}var Ly={readContext:hl,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useInsertionEffect:ei,useLayoutEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useMutableSource:ei,useSyncExternalStore:ei,useId:ei,unstable_isNewReconciler:!1},X9={readContext:hl,useCallback:function(t,e){return hc().memoizedState=[t,e===void 0?null:e],t},useContext:hl,useEffect:m4,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,$1(4194308,4,nD.bind(null,e,t),r)},useLayoutEffect:function(t,e){return $1(4194308,4,t,e)},useInsertionEffect:function(t,e){return $1(4,2,t,e)},useMemo:function(t,e){var r=hc();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=hc();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=W9.bind(null,Ns,t),[n.memoizedState,t]},useRef:function(t){var e=hc();return t={current:t},e.memoizedState=t},useState:f4,useDebugValue:wB,useDeferredValue:function(t){return hc().memoizedState=t},useTransition:function(){var t=f4(!1),e=t[0];return t=z9.bind(null,t[1]),hc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ns,s=hc();if(cs){if(r===void 0)throw Error(qt(407));r=r()}else{if(r=e(),Sa===null)throw Error(qt(349));wh&30||WR(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,m4(XR.bind(null,n,a,t),[t]),n.flags|=2048,_g(9,JR.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=hc(),e=Sa.identifierPrefix;if(cs){var r=sA,n=nA;r=(n&~(1<<32-Dl(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ng++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=$9++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Y9={readContext:hl,useCallback:aD,useContext:hl,useEffect:yB,useImperativeHandle:sD,useInsertionEffect:tD,useLayoutEffect:rD,useMemo:iD,useReducer:Lb,useRef:eD,useState:function(){return Lb(Cg)},useDebugValue:wB,useDeferredValue:function(t){var e=fl();return oD(e,Aa.memoizedState,t)},useTransition:function(){var t=Lb(Cg)[0],e=fl().memoizedState;return[t,e]},useMutableSource:$R,useSyncExternalStore:zR,useId:lD,unstable_isNewReconciler:!1},Z9={readContext:hl,useCallback:aD,useContext:hl,useEffect:yB,useImperativeHandle:sD,useInsertionEffect:tD,useLayoutEffect:rD,useMemo:iD,useReducer:Ub,useRef:eD,useState:function(){return Ub(Cg)},useDebugValue:wB,useDeferredValue:function(t){var e=fl();return Aa===null?e.memoizedState=t:oD(e,Aa.memoizedState,t)},useTransition:function(){var t=Ub(Cg)[0],e=fl().memoizedState;return[t,e]},useMutableSource:$R,useSyncExternalStore:zR,useId:lD,unstable_isNewReconciler:!1};function kl(t,e){if(t&&t.defaultProps){e=Cs({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function YC(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Cs({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var $w={isMounted:function(t){return(t=t._reactInternals)?Vh(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Pi(),s=Vu(t),a=AA(n,s);a.payload=e,r!=null&&(a.callback=r),e=Mu(t,a,s),e!==null&&(Ll(e,t,s,n),q1(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Pi(),s=Vu(t),a=AA(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Mu(t,a,s),e!==null&&(Ll(e,t,s,n),q1(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Pi(),n=Vu(t),s=AA(r,n);s.tag=2,e!=null&&(s.callback=e),e=Mu(t,s,n),e!==null&&(Ll(e,t,n,r),q1(e,t,n))}};function p4(t,e,r,n,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,o):e.prototype&&e.prototype.isPureReactComponent?!gg(r,n)||!gg(s,a):!0}function dD(t,e,r){var n=!1,s=Zu,a=e.contextType;return typeof a=="object"&&a!==null?a=hl(a):(s=Yi(e)?vh:xi.current,n=e.contextTypes,a=(n=n!=null)?_0(t,s):Zu),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$w,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function g4(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&$w.enqueueReplaceState(e,e.state,null)}function ZC(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},hB(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=hl(a):(a=Yi(e)?vh:xi.current,s.context=_0(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(YC(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&$w.enqueueReplaceState(s,s.state,null),Py(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function I0(t,e){try{var r="",n=e;do r+=BV(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function Ob(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function e_(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var eH=typeof WeakMap=="function"?WeakMap:Map;function hD(t,e,r){r=AA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Oy||(Oy=!0,A_=n),e_(t,e)},r}function fD(t,e,r){r=AA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){e_(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){e_(t,e),typeof n!="function"&&(Qu===null?Qu=new Set([this]):Qu.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function x4(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new eH;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=fH.bind(null,t,e,r),e.then(t,t))}function v4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function y4(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=AA(-1,1),e.tag=2,Mu(r,e,1))),r.lanes|=1),t)}var tH=FA.ReactCurrentOwner,Wi=!1;function Fi(t,e,r,n){e.child=t===null?HR(e,null,r,n):B0(e,t.child,r,n)}function w4(t,e,r,n,s){r=r.render;var a=e.ref;return h0(e,s),n=xB(t,e,r,n,a,s),r=vB(),t!==null&&!Wi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,NA(t,e,s)):(cs&&r&&iB(e),e.flags|=1,Fi(t,e,n,s),e.child)}function b4(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!IB(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,mD(t,e,a,n,s)):(t=X1(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:gg,r(o,n)&&t.ref===e.ref)return NA(t,e,s)}return e.flags|=1,t=Hu(a,n),t.ref=e.ref,t.return=e,e.child=t}function mD(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(gg(a,n)&&t.ref===e.ref)if(Wi=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Wi=!0);else return e.lanes=t.lanes,NA(t,e,s)}return t_(t,e,r,n,s)}function pD(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(a0,yo),yo|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Wn(a0,yo),yo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Wn(a0,yo),yo|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Wn(a0,yo),yo|=n;return Fi(t,e,s,r),e.child}function gD(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function t_(t,e,r,n,s){var a=Yi(r)?vh:xi.current;return a=_0(e,a),h0(e,s),r=xB(t,e,r,n,a,s),n=vB(),t!==null&&!Wi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,NA(t,e,s)):(cs&&n&&iB(e),e.flags|=1,Fi(t,e,r,s),e.child)}function N4(t,e,r,n,s){if(Yi(r)){var a=!0;Iy(e)}else a=!1;if(h0(e,s),e.stateNode===null)z1(t,e),dD(e,r,n),ZC(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,A=r.contextType;typeof A=="object"&&A!==null?A=hl(A):(A=Yi(r)?vh:xi.current,A=_0(e,A));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==A)&&g4(e,o,n,A),pu=!1;var f=e.memoizedState;o.state=f,Py(e,n,o,s),c=e.memoizedState,l!==n||f!==c||Xi.current||pu?(typeof u=="function"&&(YC(e,r,u,n),c=e.memoizedState),(l=pu||p4(e,r,l,n,f,c,A))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=A,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,qR(t,e),l=e.memoizedProps,A=e.type===e.elementType?l:kl(e.type,l),o.props=A,d=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=hl(c):(c=Yi(r)?vh:xi.current,c=_0(e,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==c)&&g4(e,o,n,c),pu=!1,f=e.memoizedState,o.state=f,Py(e,n,o,s);var m=e.memoizedState;l!==d||f!==m||Xi.current||pu?(typeof h=="function"&&(YC(e,r,h,n),m=e.memoizedState),(A=pu||p4(e,r,A,n,f,m,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=A):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return r_(t,e,r,n,a,s)}function r_(t,e,r,n,s,a){gD(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&l4(e,r,!1),NA(t,e,a);n=e.stateNode,tH.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=B0(e,t.child,null,a),e.child=B0(e,null,l,a)):Fi(t,e,l,a),e.memoizedState=n.state,s&&l4(e,r,!0),e.child}function xD(t){var e=t.stateNode;e.pendingContext?o4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&o4(t,e.context,!1),fB(t,e.containerInfo)}function C4(t,e,r,n,s){return E0(),lB(s),e.flags|=256,Fi(t,e,r,n),e.child}var n_={dehydrated:null,treeContext:null,retryLane:0};function s_(t){return{baseLanes:t,cachePool:null,transitions:null}}function vD(t,e,r){var n=e.pendingProps,s=ys.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Wn(ys,s&1),t===null)return JC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,a?(n=e.mode,a=e.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Jw(o,n,0,null),t=oh(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=s_(r),e.memoizedState=n_,t):bB(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return rH(t,e,o,n,l,s,r);if(a){a=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Hu(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=Hu(l,a):(a=oh(a,o,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,o=t.child.memoizedState,o=o===null?s_(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~r,e.memoizedState=n_,n}return a=t.child,t=a.sibling,n=Hu(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function bB(t,e){return e=Jw({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _v(t,e,r,n){return n!==null&&lB(n),B0(e,t.child,null,r),t=bB(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rH(t,e,r,n,s,a,o){if(r)return e.flags&256?(e.flags&=-257,n=Ob(Error(qt(422))),_v(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=Jw({mode:"visible",children:n.children},s,0,null),a=oh(a,s,o,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&B0(e,t.child,null,o),e.child.memoizedState=s_(o),e.memoizedState=n_,a);if(!(e.mode&1))return _v(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(qt(419)),n=Ob(a,n,void 0),_v(t,e,o,n)}if(l=(o&t.childLanes)!==0,Wi||l){if(n=Sa,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,bA(t,s),Ll(n,t,s,-1))}return SB(),n=Ob(Error(qt(421))),_v(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=mH.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,_o=Ou(s.nextSibling),So=e,cs=!0,jl=null,t!==null&&(nl[sl++]=nA,nl[sl++]=sA,nl[sl++]=yh,nA=t.id,sA=t.overflow,yh=e),e=bB(e,n.children),e.flags|=4096,e)}function _4(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),XC(t.return,e,r)}function Mb(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function yD(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Fi(t,e,n.children,r),n=ys.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_4(t,r,e);else if(t.tag===19)_4(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Wn(ys,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Ry(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Mb(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ry(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Mb(e,!0,r,null,a);break;case"together":Mb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function z1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function NA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),bh|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(qt(153));if(e.child!==null){for(t=e.child,r=Hu(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Hu(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function nH(t,e,r){switch(e.tag){case 3:xD(e),E0();break;case 5:GR(e);break;case 1:Yi(e.type)&&Iy(e);break;case 4:fB(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Wn(Ty,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Wn(ys,ys.current&1),e.flags|=128,null):r&e.child.childLanes?vD(t,e,r):(Wn(ys,ys.current&1),t=NA(t,e,r),t!==null?t.sibling:null);Wn(ys,ys.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return yD(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Wn(ys,ys.current),n)break;return null;case 22:case 23:return e.lanes=0,pD(t,e,r)}return NA(t,e,r)}var wD,a_,bD,ND;wD=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};a_=function(){};bD=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,th(wc.current);var a=null;switch(r){case"input":s=BC(t,s),n=BC(t,n),a=[];break;case"select":s=Cs({},s,{value:void 0}),n=Cs({},n,{value:void 0}),a=[];break;case"textarea":s=FC(t,s),n=FC(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=By)}TC(r,n);var o;r=null;for(A in s)if(!n.hasOwnProperty(A)&&s.hasOwnProperty(A)&&s[A]!=null)if(A==="style"){var l=s[A];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(Ag.hasOwnProperty(A)?a||(a=[]):(a=a||[]).push(A,null));for(A in n){var c=n[A];if(l=s!=null?s[A]:void 0,n.hasOwnProperty(A)&&c!==l&&(c!=null||l!=null))if(A==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(A,r)),r=c;else A==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(A,c)):A==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(A,""+c):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(Ag.hasOwnProperty(A)?(c!=null&&A==="onScroll"&&Zn("scroll",t),a||l===c||(a=[])):(a=a||[]).push(A,c))}r&&(a=a||[]).push("style",r);var A=a;(e.updateQueue=A)&&(e.flags|=4)}};ND=function(t,e,r,n){r!==n&&(e.flags|=4)};function Om(t,e){if(!cs)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ti(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function sH(t,e,r){var n=e.pendingProps;switch(oB(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ti(e),null;case 1:return Yi(e.type)&&Sy(),ti(e),null;case 3:return n=e.stateNode,S0(),rs(Xi),rs(xi),pB(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Nv(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jl!==null&&(h_(jl),jl=null))),a_(t,e),ti(e),null;case 5:mB(e);var s=th(bg.current);if(r=e.type,t!==null&&e.stateNode!=null)bD(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(qt(166));return ti(e),null}if(t=th(wc.current),Nv(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[fc]=e,n[yg]=a,t=(e.mode&1)!==0,r){case"dialog":Zn("cancel",n),Zn("close",n);break;case"iframe":case"object":case"embed":Zn("load",n);break;case"video":case"audio":for(s=0;s<Ap.length;s++)Zn(Ap[s],n);break;case"source":Zn("error",n);break;case"img":case"image":case"link":Zn("error",n),Zn("load",n);break;case"details":Zn("toggle",n);break;case"input":P5(n,a),Zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Zn("invalid",n);break;case"textarea":D5(n,a),Zn("invalid",n)}TC(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&bv(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&bv(n.textContent,l,t),s=["children",""+l]):Ag.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Zn("scroll",n)}switch(r){case"input":fv(n),R5(n,a,!0);break;case"textarea":fv(n),L5(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=By)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=X3(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[fc]=e,t[yg]=n,wD(t,e,!1,!1),e.stateNode=t;e:{switch(o=jC(r,n),r){case"dialog":Zn("cancel",t),Zn("close",t),s=n;break;case"iframe":case"object":case"embed":Zn("load",t),s=n;break;case"video":case"audio":for(s=0;s<Ap.length;s++)Zn(Ap[s],t);s=n;break;case"source":Zn("error",t),s=n;break;case"img":case"image":case"link":Zn("error",t),Zn("load",t),s=n;break;case"details":Zn("toggle",t),s=n;break;case"input":P5(t,n),s=BC(t,n),Zn("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Cs({},n,{value:void 0}),Zn("invalid",t);break;case"textarea":D5(t,n),s=FC(t,n),Zn("invalid",t);break;default:s=n}TC(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?eR(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Y3(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ug(t,c):typeof c=="number"&&ug(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ag.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Zn("scroll",t):c!=null&&GE(t,a,c,o))}switch(r){case"input":fv(t),R5(t,n,!1);break;case"textarea":fv(t),L5(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Yu(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?c0(t,!!n.multiple,a,!1):n.defaultValue!=null&&c0(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=By)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ti(e),null;case 6:if(t&&e.stateNode!=null)ND(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(qt(166));if(r=th(bg.current),th(wc.current),Nv(e)){if(n=e.stateNode,r=e.memoizedProps,n[fc]=e,(a=n.nodeValue!==r)&&(t=So,t!==null))switch(t.tag){case 3:bv(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&bv(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[fc]=e,e.stateNode=n}return ti(e),null;case 13:if(rs(ys),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(cs&&_o!==null&&e.mode&1&&!(e.flags&128))QR(),E0(),e.flags|=98560,a=!1;else if(a=Nv(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(qt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(qt(317));a[fc]=e}else E0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ti(e),a=!1}else jl!==null&&(h_(jl),jl=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ys.current&1?fa===0&&(fa=3):SB())),e.updateQueue!==null&&(e.flags|=4),ti(e),null);case 4:return S0(),a_(t,e),t===null&&xg(e.stateNode.containerInfo),ti(e),null;case 10:return uB(e.type._context),ti(e),null;case 17:return Yi(e.type)&&Sy(),ti(e),null;case 19:if(rs(ys),a=e.memoizedState,a===null)return ti(e),null;if(n=(e.flags&128)!==0,o=a.rendering,o===null)if(n)Om(a,!1);else{if(fa!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ry(t),o!==null){for(e.flags|=128,Om(a,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Wn(ys,ys.current&1|2),e.child}t=t.sibling}a.tail!==null&&Hs()>F0&&(e.flags|=128,n=!0,Om(a,!1),e.lanes=4194304)}else{if(!n)if(t=Ry(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Om(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!cs)return ti(e),null}else 2*Hs()-a.renderingStartTime>F0&&r!==1073741824&&(e.flags|=128,n=!0,Om(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(r=a.last,r!==null?r.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Hs(),e.sibling=null,r=ys.current,Wn(ys,n?r&1|2:r&1),e):(ti(e),null);case 22:case 23:return BB(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?yo&1073741824&&(ti(e),e.subtreeFlags&6&&(e.flags|=8192)):ti(e),null;case 24:return null;case 25:return null}throw Error(qt(156,e.tag))}function aH(t,e){switch(oB(e),e.tag){case 1:return Yi(e.type)&&Sy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return S0(),rs(Xi),rs(xi),pB(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return mB(e),null;case 13:if(rs(ys),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(qt(340));E0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rs(ys),null;case 4:return S0(),null;case 10:return uB(e.type._context),null;case 22:case 23:return BB(),null;case 24:return null;default:return null}}var Ev=!1,fi=!1,iH=typeof WeakSet=="function"?WeakSet:Set,lr=null;function s0(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Fs(t,e,n)}else r.current=null}function i_(t,e,r){try{r()}catch(n){Fs(t,e,n)}}var E4=!1;function oH(t,e){if(HC=Cy,t=SR(),aB(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,A=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==r||s!==0&&d.nodeType!==3||(l=o+s),d!==a||n!==0&&d.nodeType!==3||(c=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===r&&++A===s&&(l=o),f===a&&++u===n&&(c=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(KC={focusedElem:t,selectionRange:r},Cy=!1,lr=e;lr!==null;)if(e=lr,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,lr=t;else for(;lr!==null;){e=lr;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,g=e.stateNode,w=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:kl(e.type,p),x);g.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qt(163))}}catch(k){Fs(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,lr=t;break}lr=e.return}return m=E4,E4=!1,m}function Pp(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&i_(e,r,a)}s=s.next}while(s!==n)}}function zw(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function o_(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function CD(t){var e=t.alternate;e!==null&&(t.alternate=null,CD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fc],delete e[yg],delete e[$C],delete e[H9],delete e[K9])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function _D(t){return t.tag===5||t.tag===3||t.tag===4}function B4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||_D(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function l_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=By));else if(n!==4&&(t=t.child,t!==null))for(l_(t,e,r),t=t.sibling;t!==null;)l_(t,e,r),t=t.sibling}function c_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(c_(t,e,r),t=t.sibling;t!==null;)c_(t,e,r),t=t.sibling}var Ma=null,Tl=!1;function ru(t,e,r){for(r=r.child;r!==null;)ED(t,e,r),r=r.sibling}function ED(t,e,r){if(yc&&typeof yc.onCommitFiberUnmount=="function")try{yc.onCommitFiberUnmount(Mw,r)}catch{}switch(r.tag){case 5:fi||s0(r,e);case 6:var n=Ma,s=Tl;Ma=null,ru(t,e,r),Ma=n,Tl=s,Ma!==null&&(Tl?(t=Ma,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Ma.removeChild(r.stateNode));break;case 18:Ma!==null&&(Tl?(t=Ma,r=r.stateNode,t.nodeType===8?jb(t.parentNode,r):t.nodeType===1&&jb(t,r),mg(t)):jb(Ma,r.stateNode));break;case 4:n=Ma,s=Tl,Ma=r.stateNode.containerInfo,Tl=!0,ru(t,e,r),Ma=n,Tl=s;break;case 0:case 11:case 14:case 15:if(!fi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&i_(r,e,o),s=s.next}while(s!==n)}ru(t,e,r);break;case 1:if(!fi&&(s0(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Fs(r,e,l)}ru(t,e,r);break;case 21:ru(t,e,r);break;case 22:r.mode&1?(fi=(n=fi)||r.memoizedState!==null,ru(t,e,r),fi=n):ru(t,e,r);break;default:ru(t,e,r)}}function S4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new iH),e.forEach(function(n){var s=pH.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Cl(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ma=l.stateNode,Tl=!1;break e;case 3:Ma=l.stateNode.containerInfo,Tl=!0;break e;case 4:Ma=l.stateNode.containerInfo,Tl=!0;break e}l=l.return}if(Ma===null)throw Error(qt(160));ED(a,o,s),Ma=null,Tl=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(A){Fs(s,e,A)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BD(e,t),e=e.sibling}function BD(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Cl(e,t),ic(t),n&4){try{Pp(3,t,t.return),zw(3,t)}catch(p){Fs(t,t.return,p)}try{Pp(5,t,t.return)}catch(p){Fs(t,t.return,p)}}break;case 1:Cl(e,t),ic(t),n&512&&r!==null&&s0(r,r.return);break;case 5:if(Cl(e,t),ic(t),n&512&&r!==null&&s0(r,r.return),t.flags&32){var s=t.stateNode;try{ug(s,"")}catch(p){Fs(t,t.return,p)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=r!==null?r.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&W3(s,a),jC(l,o);var A=jC(l,a);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?eR(s,d):u==="dangerouslySetInnerHTML"?Y3(s,d):u==="children"?ug(s,d):GE(s,u,d,A)}switch(l){case"input":SC(s,a);break;case"textarea":J3(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?c0(s,!!a.multiple,h,!1):f!==!!a.multiple&&(a.defaultValue!=null?c0(s,!!a.multiple,a.defaultValue,!0):c0(s,!!a.multiple,a.multiple?[]:"",!1))}s[yg]=a}catch(p){Fs(t,t.return,p)}}break;case 6:if(Cl(e,t),ic(t),n&4){if(t.stateNode===null)throw Error(qt(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(p){Fs(t,t.return,p)}}break;case 3:if(Cl(e,t),ic(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{mg(e.containerInfo)}catch(p){Fs(t,t.return,p)}break;case 4:Cl(e,t),ic(t);break;case 13:Cl(e,t),ic(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(_B=Hs())),n&4&&S4(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(fi=(A=fi)||u,Cl(e,t),fi=A):Cl(e,t),ic(t),n&8192){if(A=t.memoizedState!==null,(t.stateNode.isHidden=A)&&!u&&t.mode&1)for(lr=t,u=t.child;u!==null;){for(d=lr=u;lr!==null;){switch(f=lr,h=f.child,f.tag){case 0:case 11:case 14:case 15:Pp(4,f,f.return);break;case 1:s0(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Fs(n,r,p)}}break;case 5:s0(f,f.return);break;case 22:if(f.memoizedState!==null){F4(d);continue}}h!==null?(h.return=f,lr=h):F4(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,A?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Z3("display",o))}catch(p){Fs(t,t.return,p)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=A?"":d.memoizedProps}catch(p){Fs(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Cl(e,t),ic(t),n&4&&S4(t);break;case 21:break;default:Cl(e,t),ic(t)}}function ic(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(_D(r)){var n=r;break e}r=r.return}throw Error(qt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ug(s,""),n.flags&=-33);var a=B4(t);c_(t,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=B4(t);l_(t,l,o);break;default:throw Error(qt(161))}}catch(c){Fs(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function lH(t,e,r){lr=t,SD(t)}function SD(t,e,r){for(var n=(t.mode&1)!==0;lr!==null;){var s=lr,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Ev;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||fi;l=Ev;var A=fi;if(Ev=o,(fi=c)&&!A)for(lr=s;lr!==null;)o=lr,c=o.child,o.tag===22&&o.memoizedState!==null?k4(s):c!==null?(c.return=o,lr=c):k4(s);for(;a!==null;)lr=a,SD(a),a=a.sibling;lr=s,Ev=l,fi=A}I4(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,lr=a):I4(t)}}function I4(t){for(;lr!==null;){var e=lr;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fi||zw(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!fi)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:kl(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&h4(e,a,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}h4(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var A=e.alternate;if(A!==null){var u=A.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&mg(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qt(163))}fi||e.flags&512&&o_(e)}catch(f){Fs(e,e.return,f)}}if(e===t){lr=null;break}if(r=e.sibling,r!==null){r.return=e.return,lr=r;break}lr=e.return}}function F4(t){for(;lr!==null;){var e=lr;if(e===t){lr=null;break}var r=e.sibling;if(r!==null){r.return=e.return,lr=r;break}lr=e.return}}function k4(t){for(;lr!==null;){var e=lr;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{zw(4,e)}catch(c){Fs(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Fs(e,s,c)}}var a=e.return;try{o_(e)}catch(c){Fs(e,a,c)}break;case 5:var o=e.return;try{o_(e)}catch(c){Fs(e,o,c)}}}catch(c){Fs(e,e.return,c)}if(e===t){lr=null;break}var l=e.sibling;if(l!==null){l.return=e.return,lr=l;break}lr=e.return}}var cH=Math.ceil,Uy=FA.ReactCurrentDispatcher,NB=FA.ReactCurrentOwner,Al=FA.ReactCurrentBatchConfig,An=0,Sa=null,ta=null,Wa=0,yo=0,a0=hd(0),fa=0,Eg=null,bh=0,Ww=0,CB=0,Rp=null,zi=null,_B=0,F0=1/0,eA=null,Oy=!1,A_=null,Qu=null,Bv=!1,Su=null,My=0,Dp=0,u_=null,W1=-1,J1=0;function Pi(){return An&6?Hs():W1!==-1?W1:W1=Hs()}function Vu(t){return t.mode&1?An&2&&Wa!==0?Wa&-Wa:G9.transition!==null?(J1===0&&(J1=dR()),J1):(t=kn,t!==0||(t=window.event,t=t===void 0?16:vR(t.type)),t):1}function Ll(t,e,r,n){if(50<Dp)throw Dp=0,u_=null,Error(qt(185));hx(t,r,n),(!(An&2)||t!==Sa)&&(t===Sa&&(!(An&2)&&(Ww|=r),fa===4&&vu(t,Wa)),Zi(t,n),r===1&&An===0&&!(e.mode&1)&&(F0=Hs()+500,qw&&fd()))}function Zi(t,e){var r=t.callbackNode;GV(t,e);var n=Ny(t,t===Sa?Wa:0);if(n===0)r!==null&&M5(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&M5(r),e===1)t.tag===0?q9(T4.bind(null,t)):UR(T4.bind(null,t)),Q9(function(){!(An&6)&&fd()}),r=null;else{switch(hR(n)){case 1:r=XE;break;case 4:r=AR;break;case 16:r=by;break;case 536870912:r=uR;break;default:r=by}r=DD(r,ID.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function ID(t,e){if(W1=-1,J1=0,An&6)throw Error(qt(327));var r=t.callbackNode;if(f0()&&t.callbackNode!==r)return null;var n=Ny(t,t===Sa?Wa:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Qy(t,n);else{e=n;var s=An;An|=2;var a=kD();(Sa!==t||Wa!==e)&&(eA=null,F0=Hs()+500,ih(t,e));do try{dH();break}catch(l){FD(t,l)}while(!0);AB(),Uy.current=a,An=s,ta!==null?e=0:(Sa=null,Wa=0,e=fa)}if(e!==0){if(e===2&&(s=UC(t),s!==0&&(n=s,e=d_(t,s))),e===1)throw r=Eg,ih(t,0),vu(t,n),Zi(t,Hs()),r;if(e===6)vu(t,n);else{if(s=t.current.alternate,!(n&30)&&!AH(s)&&(e=Qy(t,n),e===2&&(a=UC(t),a!==0&&(n=a,e=d_(t,a))),e===1))throw r=Eg,ih(t,0),vu(t,n),Zi(t,Hs()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(qt(345));case 2:Qd(t,zi,eA);break;case 3:if(vu(t,n),(n&130023424)===n&&(e=_B+500-Hs(),10<e)){if(Ny(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Pi(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=GC(Qd.bind(null,t,zi,eA),e);break}Qd(t,zi,eA);break;case 4:if(vu(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-Dl(n);a=1<<o,o=e[o],o>s&&(s=o),n&=~a}if(n=s,n=Hs()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*cH(n/1960))-n,10<n){t.timeoutHandle=GC(Qd.bind(null,t,zi,eA),n);break}Qd(t,zi,eA);break;case 5:Qd(t,zi,eA);break;default:throw Error(qt(329))}}}return Zi(t,Hs()),t.callbackNode===r?ID.bind(null,t):null}function d_(t,e){var r=Rp;return t.current.memoizedState.isDehydrated&&(ih(t,e).flags|=256),t=Qy(t,e),t!==2&&(e=zi,zi=r,e!==null&&h_(e)),t}function h_(t){zi===null?zi=t:zi.push.apply(zi,t)}function AH(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Ql(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vu(t,e){for(e&=~CB,e&=~Ww,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Dl(e),n=1<<r;t[r]=-1,e&=~n}}function T4(t){if(An&6)throw Error(qt(327));f0();var e=Ny(t,0);if(!(e&1))return Zi(t,Hs()),null;var r=Qy(t,e);if(t.tag!==0&&r===2){var n=UC(t);n!==0&&(e=n,r=d_(t,n))}if(r===1)throw r=Eg,ih(t,0),vu(t,e),Zi(t,Hs()),r;if(r===6)throw Error(qt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qd(t,zi,eA),Zi(t,Hs()),null}function EB(t,e){var r=An;An|=1;try{return t(e)}finally{An=r,An===0&&(F0=Hs()+500,qw&&fd())}}function Nh(t){Su!==null&&Su.tag===0&&!(An&6)&&f0();var e=An;An|=1;var r=Al.transition,n=kn;try{if(Al.transition=null,kn=1,t)return t()}finally{kn=n,Al.transition=r,An=e,!(An&6)&&fd()}}function BB(){yo=a0.current,rs(a0)}function ih(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,M9(r)),ta!==null)for(r=ta.return;r!==null;){var n=r;switch(oB(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Sy();break;case 3:S0(),rs(Xi),rs(xi),pB();break;case 5:mB(n);break;case 4:S0();break;case 13:rs(ys);break;case 19:rs(ys);break;case 10:uB(n.type._context);break;case 22:case 23:BB()}r=r.return}if(Sa=t,ta=t=Hu(t.current,null),Wa=yo=e,fa=0,Eg=null,CB=Ww=bh=0,zi=Rp=null,eh!==null){for(e=0;e<eh.length;e++)if(r=eh[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}eh=null}return t}function FD(t,e){do{var r=ta;try{if(AB(),G1.current=Ly,Dy){for(var n=Ns.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Dy=!1}if(wh=0,_a=Aa=Ns=null,jp=!1,Ng=0,NB.current=null,r===null||r.return===null){fa=1,Eg=e,ta=null;break}e:{var a=t,o=r.return,l=r,c=e;if(e=Wa,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var A=c,u=l,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=v4(o);if(h!==null){h.flags&=-257,y4(h,o,l,a,e),h.mode&1&&x4(a,A,e),e=h,c=A;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){x4(a,A,e),SB();break e}c=Error(qt(426))}}else if(cs&&l.mode&1){var x=v4(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),y4(x,o,l,a,e),lB(I0(c,l));break e}}a=c=I0(c,l),fa!==4&&(fa=2),Rp===null?Rp=[a]:Rp.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var g=hD(a,c,e);d4(a,g);break e;case 1:l=c;var w=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Qu===null||!Qu.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e;var k=fD(a,l,e);d4(a,k);break e}}a=a.return}while(a!==null)}jD(r)}catch(P){e=P,ta===r&&r!==null&&(ta=r=r.return);continue}break}while(!0)}function kD(){var t=Uy.current;return Uy.current=Ly,t===null?Ly:t}function SB(){(fa===0||fa===3||fa===2)&&(fa=4),Sa===null||!(bh&268435455)&&!(Ww&268435455)||vu(Sa,Wa)}function Qy(t,e){var r=An;An|=2;var n=kD();(Sa!==t||Wa!==e)&&(eA=null,ih(t,e));do try{uH();break}catch(s){FD(t,s)}while(!0);if(AB(),An=r,Uy.current=n,ta!==null)throw Error(qt(261));return Sa=null,Wa=0,fa}function uH(){for(;ta!==null;)TD(ta)}function dH(){for(;ta!==null&&!LV();)TD(ta)}function TD(t){var e=RD(t.alternate,t,yo);t.memoizedProps=t.pendingProps,e===null?jD(t):ta=e,NB.current=null}function jD(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=aH(r,e),r!==null){r.flags&=32767,ta=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{fa=6,ta=null;return}}else if(r=sH(r,e,yo),r!==null){ta=r;return}if(e=e.sibling,e!==null){ta=e;return}ta=e=t}while(e!==null);fa===0&&(fa=5)}function Qd(t,e,r){var n=kn,s=Al.transition;try{Al.transition=null,kn=1,hH(t,e,r,n)}finally{Al.transition=s,kn=n}return null}function hH(t,e,r,n){do f0();while(Su!==null);if(An&6)throw Error(qt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(qt(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if($V(t,a),t===Sa&&(ta=Sa=null,Wa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Bv||(Bv=!0,DD(by,function(){return f0(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Al.transition,Al.transition=null;var o=kn;kn=1;var l=An;An|=4,NB.current=null,oH(t,r),BD(r,t),j9(KC),Cy=!!HC,KC=HC=null,t.current=r,lH(r),UV(),An=l,kn=o,Al.transition=a}else t.current=r;if(Bv&&(Bv=!1,Su=t,My=s),a=t.pendingLanes,a===0&&(Qu=null),QV(r.stateNode),Zi(t,Hs()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Oy)throw Oy=!1,t=A_,A_=null,t;return My&1&&t.tag!==0&&f0(),a=t.pendingLanes,a&1?t===u_?Dp++:(Dp=0,u_=t):Dp=0,fd(),null}function f0(){if(Su!==null){var t=hR(My),e=Al.transition,r=kn;try{if(Al.transition=null,kn=16>t?16:t,Su===null)var n=!1;else{if(t=Su,Su=null,My=0,An&6)throw Error(qt(331));var s=An;for(An|=4,lr=t.current;lr!==null;){var a=lr,o=a.child;if(lr.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var A=l[c];for(lr=A;lr!==null;){var u=lr;switch(u.tag){case 0:case 11:case 15:Pp(8,u,a)}var d=u.child;if(d!==null)d.return=u,lr=d;else for(;lr!==null;){u=lr;var f=u.sibling,h=u.return;if(CD(u),u===A){lr=null;break}if(f!==null){f.return=h,lr=f;break}lr=h}}}var m=a.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}lr=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,lr=o;else e:for(;lr!==null;){if(a=lr,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Pp(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,lr=g;break e}lr=a.return}}var w=t.current;for(lr=w;lr!==null;){o=lr;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,lr=b;else e:for(o=w;lr!==null;){if(l=lr,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zw(9,l)}}catch(P){Fs(l,l.return,P)}if(l===o){lr=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,lr=k;break e}lr=l.return}}if(An=s,fd(),yc&&typeof yc.onPostCommitFiberRoot=="function")try{yc.onPostCommitFiberRoot(Mw,t)}catch{}n=!0}return n}finally{kn=r,Al.transition=e}}return!1}function j4(t,e,r){e=I0(r,e),e=hD(t,e,1),t=Mu(t,e,1),e=Pi(),t!==null&&(hx(t,1,e),Zi(t,e))}function Fs(t,e,r){if(t.tag===3)j4(t,t,r);else for(;e!==null;){if(e.tag===3){j4(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Qu===null||!Qu.has(n))){t=I0(r,t),t=fD(e,t,1),e=Mu(e,t,1),t=Pi(),e!==null&&(hx(e,1,t),Zi(e,t));break}}e=e.return}}function fH(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Pi(),t.pingedLanes|=t.suspendedLanes&r,Sa===t&&(Wa&r)===r&&(fa===4||fa===3&&(Wa&130023424)===Wa&&500>Hs()-_B?ih(t,0):CB|=r),Zi(t,e)}function PD(t,e){e===0&&(t.mode&1?(e=gv,gv<<=1,!(gv&130023424)&&(gv=4194304)):e=1);var r=Pi();t=bA(t,e),t!==null&&(hx(t,e,r),Zi(t,r))}function mH(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),PD(t,r)}function pH(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(qt(314))}n!==null&&n.delete(e),PD(t,r)}var RD;RD=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xi.current)Wi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Wi=!1,nH(t,e,r);Wi=!!(t.flags&131072)}else Wi=!1,cs&&e.flags&1048576&&OR(e,ky,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;z1(t,e),t=e.pendingProps;var s=_0(e,xi.current);h0(e,r),s=xB(null,e,n,t,s,r);var a=vB();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yi(n)?(a=!0,Iy(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,hB(e),s.updater=$w,e.stateNode=s,s._reactInternals=e,ZC(e,n,t,r),e=r_(null,e,n,!0,a,r)):(e.tag=0,cs&&a&&iB(e),Fi(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(z1(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=xH(n),t=kl(n,t),s){case 0:e=t_(null,e,n,t,r);break e;case 1:e=N4(null,e,n,t,r);break e;case 11:e=w4(null,e,n,t,r);break e;case 14:e=b4(null,e,n,kl(n.type,t),r);break e}throw Error(qt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:kl(n,s),t_(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:kl(n,s),N4(t,e,n,s,r);case 3:e:{if(xD(e),t===null)throw Error(qt(387));n=e.pendingProps,a=e.memoizedState,s=a.element,qR(t,e),Py(e,n,null,r);var o=e.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=I0(Error(qt(423)),e),e=C4(t,e,n,r,s);break e}else if(n!==s){s=I0(Error(qt(424)),e),e=C4(t,e,n,r,s);break e}else for(_o=Ou(e.stateNode.containerInfo.firstChild),So=e,cs=!0,jl=null,r=HR(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(E0(),n===s){e=NA(t,e,r);break e}Fi(t,e,n,r)}e=e.child}return e;case 5:return GR(e),t===null&&JC(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,qC(n,s)?o=null:a!==null&&qC(n,a)&&(e.flags|=32),gD(t,e),Fi(t,e,o,r),e.child;case 6:return t===null&&JC(e),null;case 13:return vD(t,e,r);case 4:return fB(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=B0(e,null,n,r):Fi(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:kl(n,s),w4(t,e,n,s,r);case 7:return Fi(t,e,e.pendingProps,r),e.child;case 8:return Fi(t,e,e.pendingProps.children,r),e.child;case 12:return Fi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,Wn(Ty,n._currentValue),n._currentValue=o,a!==null)if(Ql(a.value,o)){if(a.children===s.children&&!Xi.current){e=NA(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=AA(-1,r&-r),c.tag=2;var A=a.updateQueue;if(A!==null){A=A.shared;var u=A.pending;u===null?c.next=c:(c.next=u.next,u.next=c),A.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),XC(a.return,r,e),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(qt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),XC(o,r,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Fi(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,h0(e,r),s=hl(s),n=n(s),e.flags|=1,Fi(t,e,n,r),e.child;case 14:return n=e.type,s=kl(n,e.pendingProps),s=kl(n.type,s),b4(t,e,n,s,r);case 15:return mD(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:kl(n,s),z1(t,e),e.tag=1,Yi(n)?(t=!0,Iy(e)):t=!1,h0(e,r),dD(e,n,s),ZC(e,n,s,r),r_(null,e,n,!0,t,r);case 19:return yD(t,e,r);case 22:return pD(t,e,r)}throw Error(qt(156,e.tag))};function DD(t,e){return cR(t,e)}function gH(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function il(t,e,r,n){return new gH(t,e,r,n)}function IB(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xH(t){if(typeof t=="function")return IB(t)?1:0;if(t!=null){if(t=t.$$typeof,t===zE)return 11;if(t===WE)return 14}return 2}function Hu(t,e){var r=t.alternate;return r===null?(r=il(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function X1(t,e,r,n,s,a){var o=2;if(n=t,typeof t=="function")IB(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Wf:return oh(r.children,s,a,e);case $E:o=8,s|=8;break;case NC:return t=il(12,r,e,s|2),t.elementType=NC,t.lanes=a,t;case CC:return t=il(13,r,e,s),t.elementType=CC,t.lanes=a,t;case _C:return t=il(19,r,e,s),t.elementType=_C,t.lanes=a,t;case G3:return Jw(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case K3:o=10;break e;case q3:o=9;break e;case zE:o=11;break e;case WE:o=14;break e;case mu:o=16,n=null;break e}throw Error(qt(130,t==null?t:typeof t,""))}return e=il(o,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function oh(t,e,r,n){return t=il(7,t,n,e),t.lanes=r,t}function Jw(t,e,r,n){return t=il(22,t,n,e),t.elementType=G3,t.lanes=r,t.stateNode={isHidden:!1},t}function Qb(t,e,r){return t=il(6,t,null,e),t.lanes=r,t}function Vb(t,e,r){return e=il(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function vH(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bb(0),this.expirationTimes=bb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bb(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function FB(t,e,r,n,s,a,o,l,c){return t=new vH(t,e,r,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=il(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},hB(a),t}function yH(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zf,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function LD(t){if(!t)return Zu;t=t._reactInternals;e:{if(Vh(t)!==t||t.tag!==1)throw Error(qt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(qt(171))}if(t.tag===1){var r=t.type;if(Yi(r))return LR(t,r,e)}return e}function UD(t,e,r,n,s,a,o,l,c){return t=FB(r,n,!0,t,s,a,o,l,c),t.context=LD(null),r=t.current,n=Pi(),s=Vu(r),a=AA(n,s),a.callback=e??null,Mu(r,a,s),t.current.lanes=s,hx(t,s,n),Zi(t,n),t}function Xw(t,e,r,n){var s=e.current,a=Pi(),o=Vu(s);return r=LD(r),e.context===null?e.context=r:e.pendingContext=r,e=AA(a,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Mu(s,e,o),t!==null&&(Ll(t,s,o,a),q1(t,s,o)),o}function Vy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function P4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function kB(t,e){P4(t,e),(t=t.alternate)&&P4(t,e)}function wH(){return null}var OD=typeof reportError=="function"?reportError:function(t){console.error(t)};function TB(t){this._internalRoot=t}Yw.prototype.render=TB.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(qt(409));Xw(t,e,null,null)};Yw.prototype.unmount=TB.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Nh(function(){Xw(null,t,null,null)}),e[wA]=null}};function Yw(t){this._internalRoot=t}Yw.prototype.unstable_scheduleHydration=function(t){if(t){var e=pR();t={blockedOn:null,target:t,priority:e};for(var r=0;r<xu.length&&e!==0&&e<xu[r].priority;r++);xu.splice(r,0,t),r===0&&xR(t)}};function jB(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Zw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function R4(){}function bH(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var A=Vy(o);a.call(A)}}var o=UD(e,n,t,0,null,!1,!1,"",R4);return t._reactRootContainer=o,t[wA]=o.current,xg(t.nodeType===8?t.parentNode:t),Nh(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var A=Vy(c);l.call(A)}}var c=FB(t,0,!1,null,null,!1,!1,"",R4);return t._reactRootContainer=c,t[wA]=c.current,xg(t.nodeType===8?t.parentNode:t),Nh(function(){Xw(e,c,r,n)}),c}function e2(t,e,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=Vy(o);l.call(c)}}Xw(e,o,t,s)}else o=bH(r,e,t,s,n);return Vy(o)}fR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=cp(e.pendingLanes);r!==0&&(YE(e,r|1),Zi(e,Hs()),!(An&6)&&(F0=Hs()+500,fd()))}break;case 13:Nh(function(){var n=bA(t,1);if(n!==null){var s=Pi();Ll(n,t,1,s)}}),kB(t,1)}};ZE=function(t){if(t.tag===13){var e=bA(t,134217728);if(e!==null){var r=Pi();Ll(e,t,134217728,r)}kB(t,134217728)}};mR=function(t){if(t.tag===13){var e=Vu(t),r=bA(t,e);if(r!==null){var n=Pi();Ll(r,t,e,n)}kB(t,e)}};pR=function(){return kn};gR=function(t,e){var r=kn;try{return kn=t,e()}finally{kn=r}};RC=function(t,e,r){switch(e){case"input":if(SC(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Kw(n);if(!s)throw Error(qt(90));z3(n),SC(n,s)}}}break;case"textarea":J3(t,r);break;case"select":e=r.value,e!=null&&c0(t,!!r.multiple,e,!1)}};nR=EB;sR=Nh;var NH={usingClientEntryPoint:!1,Events:[mx,Zf,Kw,tR,rR,EB]},Mm={findFiberByHostInstance:Zd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CH={bundleType:Mm.bundleType,version:Mm.version,rendererPackageName:Mm.rendererPackageName,rendererConfig:Mm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:FA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=oR(t),t===null?null:t.stateNode},findFiberByHostInstance:Mm.findFiberByHostInstance||wH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sv.isDisabled&&Sv.supportsFiber)try{Mw=Sv.inject(CH),yc=Sv}catch{}}jo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NH;jo.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jB(e))throw Error(qt(200));return yH(t,e,null,r)};jo.createRoot=function(t,e){if(!jB(t))throw Error(qt(299));var r=!1,n="",s=OD;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=FB(t,1,!1,null,null,r,!1,n,s),t[wA]=e.current,xg(t.nodeType===8?t.parentNode:t),new TB(e)};jo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(qt(188)):(t=Object.keys(t).join(","),Error(qt(268,t)));return t=oR(e),t=t===null?null:t.stateNode,t};jo.flushSync=function(t){return Nh(t)};jo.hydrate=function(t,e,r){if(!Zw(e))throw Error(qt(200));return e2(null,t,e,!0,r)};jo.hydrateRoot=function(t,e,r){if(!jB(t))throw Error(qt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=OD;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=UD(e,null,t,1,r??null,s,!1,a,o),t[wA]=e.current,xg(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Yw(e)};jo.render=function(t,e,r){if(!Zw(e))throw Error(qt(200));return e2(null,t,e,!1,r)};jo.unmountComponentAtNode=function(t){if(!Zw(t))throw Error(qt(40));return t._reactRootContainer?(Nh(function(){e2(null,null,t,!1,function(){t._reactRootContainer=null,t[wA]=null})}),!0):!1};jo.unstable_batchedUpdates=EB;jo.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Zw(r))throw Error(qt(200));if(t==null||t._reactInternals===void 0)throw Error(qt(38));return e2(t,e,r,!1,n)};jo.version="18.3.1-next-f1338f8080-20240426";function MD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(MD)}catch(t){console.error(t)}}MD(),M3.exports=jo;var Ku=M3.exports,D4=Ku;wC.createRoot=D4.createRoot,wC.hydrateRoot=D4.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var L4="popstate";function _H(t={}){function e(n,s){let{pathname:a,search:o,hash:l}=n.location;return f_("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Bg(s)}return BH(e,r,null,t)}function hs(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Vl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function EH(){return Math.random().toString(36).substring(2,10)}function U4(t,e){return{usr:t.state,key:t.key,idx:e}}function f_(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?W0(e):e,state:r,key:e&&e.key||n||EH()}}function Bg({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function W0(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function BH(t,e,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",c=null,A=u();A==null&&(A=0,o.replaceState({...o.state,idx:A},""));function u(){return(o.state||{idx:null}).idx}function d(){l="POP";let x=u(),g=x==null?null:x-A;A=x,c&&c({action:l,location:p.location,delta:g})}function f(x,g){l="PUSH";let w=f_(p.location,x,g);A=u()+1;let b=U4(w,A),k=p.createHref(w);try{o.pushState(b,"",k)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(k)}a&&c&&c({action:l,location:p.location,delta:1})}function h(x,g){l="REPLACE";let w=f_(p.location,x,g);A=u();let b=U4(w,A),k=p.createHref(w);o.replaceState(b,"",k),a&&c&&c({action:l,location:p.location,delta:0})}function m(x){return SH(x)}let p={get action(){return l},get location(){return t(s,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(L4,d),c=x,()=>{s.removeEventListener(L4,d),c=null}},createHref(x){return e(s,x)},createURL:m,encodeLocation(x){let g=m(x);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(x){return o.go(x)}};return p}function SH(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),hs(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:Bg(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function QD(t,e,r="/"){return IH(t,e,r,!1)}function IH(t,e,r,n){let s=typeof e=="string"?W0(e):e,a=CA(s.pathname||"/",r);if(a==null)return null;let o=VD(t);FH(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let A=QH(a);l=OH(o[c],A,n)}return l}function VD(t,e=[],r=[],n="",s=!1){let a=(o,l,c=s,A)=>{let u={relativePath:A===void 0?o.path||"":A,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&c)return;hs(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let d=uA([n,u.relativePath]),f=r.concat(u);o.children&&o.children.length>0&&(hs(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),VD(o.children,e,f,d,c)),!(o.path==null&&!o.index)&&e.push({path:d,score:LH(d,o.index),routesMeta:f})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let A of HD(o.path))a(o,l,!0,A)}),e}function HD(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=HD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function FH(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:UH(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var kH=/^:[\w-]+$/,TH=3,jH=2,PH=1,RH=10,DH=-2,O4=t=>t==="*";function LH(t,e){let r=t.split("/"),n=r.length;return r.some(O4)&&(n+=DH),e&&(n+=jH),r.filter(s=>!O4(s)).reduce((s,a)=>s+(kH.test(a)?TH:a===""?PH:RH),n)}function UH(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function OH(t,e,r=!1){let{routesMeta:n}=t,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],A=l===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",d=Hy({path:c.relativePath,caseSensitive:c.caseSensitive,end:A},u),f=c.route;if(!d&&A&&r&&!n[n.length-1].route.index&&(d=Hy({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:uA([a,d.pathname]),pathnameBase:qH(uA([a,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(a=uA([a,d.pathnameBase]))}return o}function Hy(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=MH(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((A,{paramName:u,isOptional:d},f)=>{if(u==="*"){let m=l[f]||"";o=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[f];return d&&!h?A[u]=void 0:A[u]=(h||"").replace(/%2F/g,"/"),A},{}),pathname:a,pathnameBase:o,pattern:t}}function MH(t,e=!1,r=!0){Vl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function QH(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Vl(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function CA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function VH(t,e="/"){let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?W0(t):t;return{pathname:r?r.startsWith("/")?r:HH(r,e):e,search:GH(n),hash:$H(s)}}function HH(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Hb(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function KH(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function PB(t){let e=KH(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function RB(t,e,r,n=!1){let s;typeof t=="string"?s=W0(t):(s={...t},hs(!s.pathname||!s.pathname.includes("?"),Hb("?","pathname","search",s)),hs(!s.pathname||!s.pathname.includes("#"),Hb("#","pathname","hash",s)),hs(!s.search||!s.search.includes("#"),Hb("#","search","hash",s)));let a=t===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let d=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}l=d>=0?e[d]:"/"}let c=VH(s,l),A=o&&o!=="/"&&o.endsWith("/"),u=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(A||u)&&(c.pathname+="/"),c}var uA=t=>t.join("/").replace(/\/\/+/g,"/"),qH=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GH=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$H=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function zH(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var KD=["POST","PUT","PATCH","DELETE"];new Set(KD);var WH=["GET",...KD];new Set(WH);var J0=N.createContext(null);J0.displayName="DataRouter";var t2=N.createContext(null);t2.displayName="DataRouterState";N.createContext(!1);var qD=N.createContext({isTransitioning:!1});qD.displayName="ViewTransition";var JH=N.createContext(new Map);JH.displayName="Fetchers";var XH=N.createContext(null);XH.displayName="Await";var Gl=N.createContext(null);Gl.displayName="Navigation";var gx=N.createContext(null);gx.displayName="Location";var $l=N.createContext({outlet:null,matches:[],isDataRoute:!1});$l.displayName="Route";var DB=N.createContext(null);DB.displayName="RouteError";function YH(t,{relative:e}={}){hs(X0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=N.useContext(Gl),{hash:s,pathname:a,search:o}=vx(t,{relative:e}),l=a;return r!=="/"&&(l=a==="/"?r:uA([r,a])),n.createHref({pathname:l,search:o,hash:s})}function X0(){return N.useContext(gx)!=null}function md(){return hs(X0(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(gx).location}var GD="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $D(t){N.useContext(Gl).static||N.useLayoutEffect(t)}function xx(){let{isDataRoute:t}=N.useContext($l);return t?hK():ZH()}function ZH(){hs(X0(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(J0),{basename:e,navigator:r}=N.useContext(Gl),{matches:n}=N.useContext($l),{pathname:s}=md(),a=JSON.stringify(PB(n)),o=N.useRef(!1);return $D(()=>{o.current=!0}),N.useCallback((c,A={})=>{if(Vl(o.current,GD),!o.current)return;if(typeof c=="number"){r.go(c);return}let u=RB(c,JSON.parse(a),s,A.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:uA([e,u.pathname])),(A.replace?r.replace:r.push)(u,A.state,A)},[e,r,a,s,t])}var eK=N.createContext(null);function tK(t){let e=N.useContext($l).outlet;return e&&N.createElement(eK.Provider,{value:t},e)}function vx(t,{relative:e}={}){let{matches:r}=N.useContext($l),{pathname:n}=md(),s=JSON.stringify(PB(r));return N.useMemo(()=>RB(t,JSON.parse(s),n,e==="path"),[t,s,n,e])}function rK(t,e){return zD(t,e)}function zD(t,e,r,n){var g;hs(X0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=N.useContext(Gl),{matches:a}=N.useContext($l),o=a[a.length-1],l=o?o.params:{},c=o?o.pathname:"/",A=o?o.pathnameBase:"/",u=o&&o.route;{let w=u&&u.path||"";WD(c,!u||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let d=md(),f;if(e){let w=typeof e=="string"?W0(e):e;hs(A==="/"||((g=w.pathname)==null?void 0:g.startsWith(A)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${w.pathname}" was given in the \`location\` prop.`),f=w}else f=d;let h=f.pathname||"/",m=h;if(A!=="/"){let w=A.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let p=QD(t,{pathname:m});Vl(u||p!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Vl(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=oK(p&&p.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:uA([A,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?A:uA([A,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return e&&x?N.createElement(gx.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},x):x}function nK(){let t=dK(),e=zH(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:a},"ErrorBoundary")," or"," ",N.createElement("code",{style:a},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),r?N.createElement("pre",{style:s},r):null,o)}var sK=N.createElement(nK,null),aK=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?N.createElement($l.Provider,{value:this.props.routeContext},N.createElement(DB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function iK({routeContext:t,match:e,children:r}){let n=N.useContext(J0);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement($l.Provider,{value:t},r)}function oK(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,a=r==null?void 0:r.errors;if(a!=null){let c=s.findIndex(A=>A.route.id&&(a==null?void 0:a[A.route.id])!==void 0);hs(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let A=s[c];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(l=c),A.route.id){let{loaderData:u,errors:d}=r,f=A.route.loader&&!u.hasOwnProperty(A.route.id)&&(!d||d[A.route.id]===void 0);if(A.route.lazy||f){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,A,u)=>{let d,f=!1,h=null,m=null;r&&(d=a&&A.route.id?a[A.route.id]:void 0,h=A.route.errorElement||sK,o&&(l<0&&u===0?(WD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):l===u&&(f=!0,m=A.route.hydrateFallbackElement||null)));let p=e.concat(s.slice(0,u+1)),x=()=>{let g;return d?g=h:f?g=m:A.route.Component?g=N.createElement(A.route.Component,null):A.route.element?g=A.route.element:g=c,N.createElement(iK,{match:A,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:g})};return r&&(A.route.ErrorBoundary||A.route.errorElement||u===0)?N.createElement(aK,{location:r.location,revalidation:r.revalidation,component:h,error:d,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function LB(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lK(t){let e=N.useContext(J0);return hs(e,LB(t)),e}function cK(t){let e=N.useContext(t2);return hs(e,LB(t)),e}function AK(t){let e=N.useContext($l);return hs(e,LB(t)),e}function UB(t){let e=AK(t),r=e.matches[e.matches.length-1];return hs(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function uK(){return UB("useRouteId")}function dK(){var n;let t=N.useContext(DB),e=cK("useRouteError"),r=UB("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function hK(){let{router:t}=lK("useNavigate"),e=UB("useNavigate"),r=N.useRef(!1);return $D(()=>{r.current=!0}),N.useCallback(async(s,a={})=>{Vl(r.current,GD),r.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...a}))},[t,e])}var M4={};function WD(t,e,r){!e&&!M4[t]&&(M4[t]=!0,Vl(!1,r))}N.memo(fK);function fK({routes:t,future:e,state:r}){return zD(t,void 0,r,e)}function Vd({to:t,replace:e,state:r,relative:n}){hs(X0(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=N.useContext(Gl);Vl(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=N.useContext($l),{pathname:o}=md(),l=xx(),c=RB(t,PB(a),o,n==="path"),A=JSON.stringify(c);return N.useEffect(()=>{l(JSON.parse(A),{replace:e,state:r,relative:n})},[l,A,n,e,r]),null}function JD(t){return tK(t.context)}function Mr(t){hs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mK({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:s,static:a=!1}){hs(!X0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof r=="string"&&(r=W0(r));let{pathname:c="/",search:A="",hash:u="",state:d=null,key:f="default"}=r,h=N.useMemo(()=>{let m=CA(c,o);return m==null?null:{location:{pathname:m,search:A,hash:u,state:d,key:f},navigationType:n}},[o,c,A,u,d,f,n]);return Vl(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${A}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:N.createElement(Gl.Provider,{value:l},N.createElement(gx.Provider,{children:e,value:h}))}function pK({children:t,location:e}){return rK(m_(t),e)}function m_(t,e=[]){let r=[];return N.Children.forEach(t,(n,s)=>{if(!N.isValidElement(n))return;let a=[...e,s];if(n.type===N.Fragment){r.push.apply(r,m_(n.props.children,a));return}hs(n.type===Mr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=m_(n.props.children,a)),r.push(o)}),r}var Y1="get",Z1="application/x-www-form-urlencoded";function r2(t){return t!=null&&typeof t.tagName=="string"}function gK(t){return r2(t)&&t.tagName.toLowerCase()==="button"}function xK(t){return r2(t)&&t.tagName.toLowerCase()==="form"}function vK(t){return r2(t)&&t.tagName.toLowerCase()==="input"}function yK(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function wK(t,e){return t.button===0&&(!e||e==="_self")&&!yK(t)}var Iv=null;function bK(){if(Iv===null)try{new FormData(document.createElement("form"),0),Iv=!1}catch{Iv=!0}return Iv}var NK=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kb(t){return t!=null&&!NK.has(t)?(Vl(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Z1}"`),null):t}function CK(t,e){let r,n,s,a,o;if(xK(t)){let l=t.getAttribute("action");n=l?CA(l,e):null,r=t.getAttribute("method")||Y1,s=Kb(t.getAttribute("enctype"))||Z1,a=new FormData(t)}else if(gK(t)||vK(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?CA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||Y1,s=Kb(t.getAttribute("formenctype"))||Kb(l.getAttribute("enctype"))||Z1,a=new FormData(l,t),!bK()){let{name:A,type:u,value:d}=t;if(u==="image"){let f=A?`${A}.`:"";a.append(`${f}x`,"0"),a.append(`${f}y`,"0")}else A&&a.append(A,d)}}else{if(r2(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Y1,n=null,s=Z1,o=t}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function OB(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function _K(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&CA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function EK(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function BK(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function SK(t,e,r){let n=await Promise.all(t.map(async s=>{let a=e.routes[s.route.id];if(a){let o=await EK(a,r);return o.links?o.links():[]}return[]}));return TK(n.flat(1).filter(BK).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Q4(t,e,r,n,s,a){let o=(c,A)=>r[A]?c.route.id!==r[A].route.id:!0,l=(c,A)=>{var u;return r[A].pathname!==c.pathname||((u=r[A].route.path)==null?void 0:u.endsWith("*"))&&r[A].params["*"]!==c.params["*"]};return a==="assets"?e.filter((c,A)=>o(c,A)||l(c,A)):a==="data"?e.filter((c,A)=>{var d;let u=n.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,A)||l(c,A))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((d=r[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function IK(t,e,{includeHydrateFallback:r}={}){return FK(t.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function FK(t){return[...new Set(t)]}function kK(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function TK(t,e){let r=new Set;return new Set(e),t.reduce((n,s)=>{let a=JSON.stringify(kK(s));return r.has(a)||(r.add(a),n.push({key:a,link:s})),n},[])}function XD(){let t=N.useContext(J0);return OB(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function jK(){let t=N.useContext(t2);return OB(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var MB=N.createContext(void 0);MB.displayName="FrameworkContext";function YD(){let t=N.useContext(MB);return OB(t,"You must render this element inside a <HydratedRouter> element"),t}function PK(t,e){let r=N.useContext(MB),[n,s]=N.useState(!1),[a,o]=N.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:A,onMouseLeave:u,onTouchStart:d}=e,f=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=g=>{g.forEach(w=>{o(w.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return f.current&&x.observe(f.current),()=>{x.disconnect()}}},[t]),N.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{s(!0)},m=()=>{s(!1),o(!1)};return r?t!=="intent"?[a,f,{}]:[a,f,{onFocus:Qm(l,h),onBlur:Qm(c,m),onMouseEnter:Qm(A,h),onMouseLeave:Qm(u,m),onTouchStart:Qm(d,h)}]:[!1,f,{}]}function Qm(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function RK({page:t,...e}){let{router:r}=XD(),n=N.useMemo(()=>QD(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?N.createElement(LK,{page:t,matches:n,...e}):null}function DK(t){let{manifest:e,routeModules:r}=YD(),[n,s]=N.useState([]);return N.useEffect(()=>{let a=!1;return SK(t,e,r).then(o=>{a||s(o)}),()=>{a=!0}},[t,e,r]),n}function LK({page:t,matches:e,...r}){let n=md(),{manifest:s,routeModules:a}=YD(),{basename:o}=XD(),{loaderData:l,matches:c}=jK(),A=N.useMemo(()=>Q4(t,e,c,s,n,"data"),[t,e,c,s,n]),u=N.useMemo(()=>Q4(t,e,c,s,n,"assets"),[t,e,c,s,n]),d=N.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(g=>{var b;let w=s.routes[g.route.id];!w||!w.hasLoader||(!A.some(k=>k.route.id===g.route.id)&&g.route.id in l&&((b=a[g.route.id])!=null&&b.shouldRevalidate)||w.hasClientLoader?p=!0:m.add(g.route.id))}),m.size===0)return[];let x=_K(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(g=>m.has(g.route.id)).map(g=>g.route.id).join(",")),[x.pathname+x.search]},[o,l,n,s,A,e,t,a]),f=N.useMemo(()=>IK(u,s),[u,s]),h=DK(u);return N.createElement(N.Fragment,null,d.map(m=>N.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),f.map(m=>N.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>N.createElement("link",{key:m,nonce:r.nonce,...p})))}function UK(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var ZD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ZD&&(window.__reactRouterVersion="7.8.1")}catch{}function OK({basename:t,children:e,window:r}){let n=N.useRef();n.current==null&&(n.current=_H({window:r,v5Compat:!0}));let s=n.current,[a,o]=N.useState({action:s.action,location:s.location}),l=N.useCallback(c=>{N.startTransition(()=>o(c))},[o]);return N.useLayoutEffect(()=>s.listen(l),[s,l]),N.createElement(mK,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:s})}var eL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tL=N.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:c,to:A,preventScrollReset:u,viewTransition:d,...f},h){let{basename:m}=N.useContext(Gl),p=typeof A=="string"&&eL.test(A),x,g=!1;if(typeof A=="string"&&p&&(x=A,ZD))try{let B=new URL(window.location.href),M=A.startsWith("//")?new URL(B.protocol+A):new URL(A),F=CA(M.pathname,m);M.origin===B.origin&&F!=null?A=F+M.search+M.hash:g=!0}catch{Vl(!1,`<Link to="${A}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=YH(A,{relative:s}),[b,k,P]=PK(n,f),L=VK(A,{replace:o,state:l,target:c,preventScrollReset:u,relative:s,viewTransition:d});function E(B){e&&e(B),B.defaultPrevented||L(B)}let _=N.createElement("a",{...f,...P,href:x||w,onClick:g||a?e:E,ref:UK(h,k),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?N.createElement(N.Fragment,null,_,N.createElement(RK,{page:w})):_});tL.displayName="Link";var Er=N.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:c,...A},u){let d=vx(o,{relative:A.relative}),f=md(),h=N.useContext(t2),{navigator:m,basename:p}=N.useContext(Gl),x=h!=null&&$K(d)&&l===!0,g=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,w=f.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(w=w.toLowerCase(),b=b?b.toLowerCase():null,g=g.toLowerCase()),b&&p&&(b=CA(b,p)||b);const k=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let P=w===g||!s&&w.startsWith(g)&&w.charAt(k)==="/",L=b!=null&&(b===g||!s&&b.startsWith(g)&&b.charAt(g.length)==="/"),E={isActive:P,isPending:L,isTransitioning:x},_=P?e:void 0,B;typeof n=="function"?B=n(E):B=[n,P?"active":null,L?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(E):a;return N.createElement(tL,{...A,"aria-current":_,className:B,ref:u,style:M,to:o,viewTransition:l},typeof c=="function"?c(E):c)});Er.displayName="NavLink";var MK=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:s,state:a,method:o=Y1,action:l,onSubmit:c,relative:A,preventScrollReset:u,viewTransition:d,...f},h)=>{let m=qK(),p=GK(l,{relative:A}),x=o.toLowerCase()==="get"?"get":"post",g=typeof l=="string"&&eL.test(l),w=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let k=b.nativeEvent.submitter,P=(k==null?void 0:k.getAttribute("formmethod"))||o;m(k||b.currentTarget,{fetcherKey:e,method:P,navigate:r,replace:s,state:a,relative:A,preventScrollReset:u,viewTransition:d})};return N.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:w,...f,"data-discover":!g&&t==="render"?"true":void 0})});MK.displayName="Form";function QK(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rL(t){let e=N.useContext(J0);return hs(e,QK(t)),e}function VK(t,{target:e,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}={}){let l=xx(),c=md(),A=vx(t,{relative:a});return N.useCallback(u=>{if(wK(u,e)){u.preventDefault();let d=r!==void 0?r:Bg(c)===Bg(A);l(t,{replace:d,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,A,r,n,e,t,s,a,o])}var HK=0,KK=()=>`__${String(++HK)}__`;function qK(){let{router:t}=rL("useSubmit"),{basename:e}=N.useContext(Gl),r=uK();return N.useCallback(async(n,s={})=>{let{action:a,method:o,encType:l,formData:c,body:A}=CK(n,e);if(s.navigate===!1){let u=s.fetcherKey||KK();await t.fetch(u,r,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:A,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,r])}function GK(t,{relative:e}={}){let{basename:r}=N.useContext(Gl),n=N.useContext($l);hs(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...vx(t||".",{relative:e})},o=md();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(u=>u==="")){l.delete("index"),c.filter(d=>d).forEach(d=>l.append("index",d));let u=l.toString();a.search=u?`?${u}`:""}}return(!t||t===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:uA([r,a.pathname])),Bg(a)}function $K(t,{relative:e}={}){let r=N.useContext(qD);hs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=rL("useViewTransitionState"),s=vx(t,{relative:e});if(!r.isTransitioning)return!1;let a=CA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=CA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Hy(s.pathname,o)!=null||Hy(s.pathname,a)!=null}var V4={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nL=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},zK=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],o=t[r++],l=t[r++],c=((s&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},sL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,A=c?t[s+2]:0,u=a>>2,d=(a&3)<<4|l>>4;let f=(l&15)<<2|A>>6,h=A&63;c||(h=64,o||(f=64)),n.push(r[u],r[d],r[f],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(nL(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):zK(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const A=s<t.length?r[t.charAt(s)]:64;++s;const d=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||l==null||A==null||d==null)throw new WK;const f=a<<2|l>>4;if(n.push(f),A!==64){const h=l<<4&240|A>>2;if(n.push(h),d!==64){const m=A<<6&192|d;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WK extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JK=function(t){const e=nL(t);return sL.encodeByteArray(e,!0)},Ky=function(t){return JK(t).replace(/\./g,"")},aL=function(t){try{return sL.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XK(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YK=()=>XK().__FIREBASE_DEFAULTS__,ZK=()=>{if(typeof process>"u"||typeof V4>"u")return;const t=V4.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},eq=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&aL(t[1]);return e&&JSON.parse(e)},n2=()=>{try{return YK()||ZK()||eq()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},iL=t=>{var e,r;return(r=(e=n2())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},tq=t=>{const e=iL(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},oL=()=>{var t;return(t=n2())===null||t===void 0?void 0:t.config},lL=t=>{var e;return(e=n2())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nq(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ky(JSON.stringify(r)),Ky(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sq(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pa())}function aq(){var t;const e=(t=n2())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iq(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oq(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function lq(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cq(){const t=pa();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function cL(){return!aq()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function AL(){try{return typeof indexedDB=="object"}catch{return!1}}function Aq(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uq="FirebaseError";class kA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=uq,Object.setPrototypeOf(this,kA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yx.prototype.create)}}class yx{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?dq(a,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new kA(s,l,n)}}function dq(t,e){return t.replace(hq,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const hq=/\{\$([^}]+)}/g;function fq(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qy(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],o=e[s];if(H4(a)&&H4(o)){if(!qy(a,o))return!1}else if(a!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function H4(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function up(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function dp(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function mq(t,e){const r=new pq(t,e);return r.subscribe.bind(r)}class pq{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");gq(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=qb),s.error===void 0&&(s.error=qb),s.complete===void 0&&(s.complete=qb);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gq(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function qb(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(t){return t&&t._delegate?t._delegate:t}class Ch{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xq{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new rq;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yq(e))try{this.getOrInitializeService({instanceIdentifier:Hd})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=Hd){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Hd){return this.instances.has(e)}getOptions(e=Hd){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(s,a);const o=this.instances.get(s);return o&&e(o,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:vq(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Hd){return this.component?this.component.multipleInstances?e:Hd:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vq(t){return t===Hd?void 0:t}function yq(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new xq(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(rn||(rn={}));const bq={debug:rn.DEBUG,verbose:rn.VERBOSE,info:rn.INFO,warn:rn.WARN,error:rn.ERROR,silent:rn.SILENT},Nq=rn.INFO,Cq={[rn.DEBUG]:"log",[rn.VERBOSE]:"log",[rn.INFO]:"info",[rn.WARN]:"warn",[rn.ERROR]:"error"},_q=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=Cq[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let QB=class{constructor(e){this.name=e,this._logLevel=Nq,this._logHandler=_q,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,rn.DEBUG,...e),this._logHandler(this,rn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,rn.VERBOSE,...e),this._logHandler(this,rn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,rn.INFO,...e),this._logHandler(this,rn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,rn.WARN,...e),this._logHandler(this,rn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,rn.ERROR,...e),this._logHandler(this,rn.ERROR,...e)}};const Eq=(t,e)=>e.some(r=>t instanceof r);let K4,q4;function Bq(){return K4||(K4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Sq(){return q4||(q4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const uL=new WeakMap,p_=new WeakMap,dL=new WeakMap,Gb=new WeakMap,VB=new WeakMap;function Iq(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(qu(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&uL.set(r,t)}).catch(()=>{}),VB.set(e,t),e}function Fq(t){if(p_.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});p_.set(t,e)}let g_={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return p_.get(t);if(e==="objectStoreNames")return t.objectStoreNames||dL.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return qu(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function kq(t){g_=t(g_)}function Tq(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call($b(this),e,...r);return dL.set(n,e.sort?e.sort():[e]),qu(n)}:Sq().includes(t)?function(...e){return t.apply($b(this),e),qu(uL.get(this))}:function(...e){return qu(t.apply($b(this),e))}}function jq(t){return typeof t=="function"?Tq(t):(t instanceof IDBTransaction&&Fq(t),Eq(t,Bq())?new Proxy(t,g_):t)}function qu(t){if(t instanceof IDBRequest)return Iq(t);if(Gb.has(t))return Gb.get(t);const e=jq(t);return e!==t&&(Gb.set(t,e),VB.set(e,t)),e}const $b=t=>VB.get(t);function Pq(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),l=qu(o);return n&&o.addEventListener("upgradeneeded",c=>{n(qu(o.result),c.oldVersion,c.newVersion,qu(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",A=>s(A.oldVersion,A.newVersion,A))}).catch(()=>{}),l}const Rq=["get","getKey","getAll","getAllKeys","count"],Dq=["put","add","delete","clear"],zb=new Map;function G4(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(zb.get(e))return zb.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=Dq.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Rq.includes(r)))return;const a=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let A=c.store;return n&&(A=A.index(l.shift())),(await Promise.all([A[r](...l),s&&c.done]))[0]};return zb.set(e,a),a}kq(t=>({...t,get:(e,r,n)=>G4(e,r)||t.get(e,r,n),has:(e,r)=>!!G4(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lq{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Uq(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Uq(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const x_="@firebase/app",$4="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=new QB("@firebase/app"),Oq="@firebase/app-compat",Mq="@firebase/analytics-compat",Qq="@firebase/analytics",Vq="@firebase/app-check-compat",Hq="@firebase/app-check",Kq="@firebase/auth",qq="@firebase/auth-compat",Gq="@firebase/database",$q="@firebase/data-connect",zq="@firebase/database-compat",Wq="@firebase/functions",Jq="@firebase/functions-compat",Xq="@firebase/installations",Yq="@firebase/installations-compat",Zq="@firebase/messaging",eG="@firebase/messaging-compat",tG="@firebase/performance",rG="@firebase/performance-compat",nG="@firebase/remote-config",sG="@firebase/remote-config-compat",aG="@firebase/storage",iG="@firebase/storage-compat",oG="@firebase/firestore",lG="@firebase/vertexai-preview",cG="@firebase/firestore-compat",AG="firebase",uG="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="[DEFAULT]",dG={[x_]:"fire-core",[Oq]:"fire-core-compat",[Qq]:"fire-analytics",[Mq]:"fire-analytics-compat",[Hq]:"fire-app-check",[Vq]:"fire-app-check-compat",[Kq]:"fire-auth",[qq]:"fire-auth-compat",[Gq]:"fire-rtdb",[$q]:"fire-data-connect",[zq]:"fire-rtdb-compat",[Wq]:"fire-fn",[Jq]:"fire-fn-compat",[Xq]:"fire-iid",[Yq]:"fire-iid-compat",[Zq]:"fire-fcm",[eG]:"fire-fcm-compat",[tG]:"fire-perf",[rG]:"fire-perf-compat",[nG]:"fire-rc",[sG]:"fire-rc-compat",[aG]:"fire-gcs",[iG]:"fire-gcs-compat",[oG]:"fire-fst",[cG]:"fire-fst-compat",[lG]:"fire-vertex","fire-js":"fire-js",[AG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0=new Map,y_=new Map,w_=new Map;function z4(t,e){try{t.container.addComponent(e)}catch(r){_A.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function T0(t){const e=t.name;if(w_.has(e))return _A.debug(`There were multiple attempts to register component ${e}.`),!1;w_.set(e,t);for(const r of k0.values())z4(r,t);for(const r of y_.values())z4(r,t);return!0}function HB(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function mc(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gu=new yx("app","Firebase",hG);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fG{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ch("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=uG;function KB(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:v_,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Gu.create("bad-app-name",{appName:String(s)});if(r||(r=oL()),!r)throw Gu.create("no-options");const a=k0.get(s);if(a){if(qy(r,a.options)&&qy(n,a.config))return a;throw Gu.create("duplicate-app",{appName:s})}const o=new wq(s);for(const c of w_.values())o.addComponent(c);const l=new fG(r,n,o);return k0.set(s,l),l}function qB(t=v_){const e=k0.get(t);if(!e&&t===v_&&oL())return KB();if(!e)throw Gu.create("no-app",{appName:t});return e}async function mG(t){let e=!1;const r=t.name;k0.has(r)?(e=!0,k0.delete(r)):y_.has(r)&&t.decRefCount()<=0&&(y_.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function $u(t,e,r){var n;let s=(n=dG[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const a=s.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${s}" with version "${e}":`];a&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_A.warn(l.join(" "));return}T0(new Ch(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pG="firebase-heartbeat-database",gG=1,Sg="firebase-heartbeat-store";let Wb=null;function hL(){return Wb||(Wb=Pq(pG,gG,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Sg)}catch(r){console.warn(r)}}}}).catch(t=>{throw Gu.create("idb-open",{originalErrorMessage:t.message})})),Wb}async function xG(t){try{const r=(await hL()).transaction(Sg),n=await r.objectStore(Sg).get(fL(t));return await r.done,n}catch(e){if(e instanceof kA)_A.warn(e.message);else{const r=Gu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});_A.warn(r.message)}}}async function W4(t,e){try{const n=(await hL()).transaction(Sg,"readwrite");await n.objectStore(Sg).put(e,fL(t)),await n.done}catch(r){if(r instanceof kA)_A.warn(r.message);else{const n=Gu.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});_A.warn(n.message)}}}function fL(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vG=1024,yG=30*24*60*60*1e3;class wG{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new NG(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=J4();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=yG}),this._storage.overwrite(this._heartbeatsCache))}catch(n){_A.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=J4(),{heartbeatsToSend:n,unsentEntries:s}=bG(this._heartbeatsCache.heartbeats),a=Ky(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return _A.warn(r),""}}}function J4(){return new Date().toISOString().substring(0,10)}function bG(t,e=vG){const r=[];let n=t.slice();for(const s of t){const a=r.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),X4(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),X4(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class NG{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return AL()?Aq().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await xG(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return W4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return W4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function X4(t){return Ky(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CG(t){T0(new Ch("platform-logger",e=>new Lq(e),"PRIVATE")),T0(new Ch("heartbeat",e=>new wG(e),"PRIVATE")),$u(x_,$4,t),$u(x_,$4,"esm2017"),$u("fire-js","")}CG("");function GB(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function mL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _G=mL,pL=new yx("auth","Firebase",mL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy=new QB("@firebase/auth");function EG(t,...e){Gy.logLevel<=rn.WARN&&Gy.warn(`Auth (${Y0}): ${t}`,...e)}function ey(t,...e){Gy.logLevel<=rn.ERROR&&Gy.error(`Auth (${Y0}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(t,...e){throw $B(t,...e)}function bc(t,...e){return $B(t,...e)}function gL(t,e,r){const n=Object.assign(Object.assign({},_G()),{[e]:r});return new yx("auth","Firebase",n).create(e,{appName:t.name})}function dA(t){return gL(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $B(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return pL.create(t,...e)}function Sr(t,e,...r){if(!t)throw $B(e,...r)}function aA(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ey(e),new Error(e)}function EA(t,e){t||aA(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function BG(){return Y4()==="http:"||Y4()==="https:"}function Y4(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BG()||oq()||"connection"in navigator)?navigator.onLine:!0}function IG(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,r){this.shortDelay=e,this.longDelay=r,EA(r>e,"Short delay should be less than long delay!"),this.isMobile=sq()||lq()}get(){return SG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(t,e){EA(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;aA("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;aA("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;aA("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kG=new bx(3e4,6e4);function pd(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function gd(t,e,r,n,s={}){return vL(t,s,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const l=wx(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const A=Object.assign({method:e,headers:c},a);return iq()||(A.referrerPolicy="no-referrer"),xL.fetch()(yL(t,t.config.apiHost,r,l),A)})}async function vL(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},FG),e);try{const s=new jG(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Fv(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const l=a.ok?o.errorMessage:o.error.message,[c,A]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fv(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Fv(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Fv(t,"user-disabled",o);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(A)throw gL(t,u,A);Hl(t,u)}}catch(s){if(s instanceof kA)throw s;Hl(t,"network-request-failed",{message:String(s)})}}async function Nx(t,e,r,n,s={}){const a=await gd(t,e,r,n,s);return"mfaPendingCredential"in a&&Hl(t,"multi-factor-auth-required",{_serverResponse:a}),a}function yL(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?zB(t.config,s):`${t.config.apiScheme}://${s}`}function TG(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jG{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(bc(this.auth,"network-request-failed")),kG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Fv(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=bc(t,e,n);return s.customData._tokenResponse=r,s}function Z4(t){return t!==void 0&&t.enterprise!==void 0}class PG{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return TG(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function RG(t,e){return gd(t,"GET","/v2/recaptchaConfig",pd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DG(t,e){return gd(t,"POST","/v1/accounts:delete",e)}async function wL(t,e){return gd(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LG(t,e=!1){const r=js(t),n=await r.getIdToken(e),s=WB(n);Sr(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:Lp(Jb(s.auth_time)),issuedAtTime:Lp(Jb(s.iat)),expirationTime:Lp(Jb(s.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Jb(t){return Number(t)*1e3}function WB(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ey("JWT malformed, contained fewer than 3 sections"),null;try{const s=aL(r);return s?JSON.parse(s):(ey("Failed to decode base64 JWT payload"),null)}catch(s){return ey("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function eF(t){const e=WB(t);return Sr(e,"internal-error"),Sr(typeof e.exp<"u","internal-error"),Sr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ig(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof kA&&UG(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function UG({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OG{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lp(this.lastLoginAt),this.creationTime=Lp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $y(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Ig(t,wL(r,{idToken:n}));Sr(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?bL(a.providerUserInfo):[],l=QG(t.providerData,o),c=t.isAnonymous,A=!(t.email&&a.passwordHash)&&!(l!=null&&l.length),u=c?A:!1,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new N_(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function MG(t){const e=js(t);await $y(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QG(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function bL(t){return t.map(e=>{var{providerId:r}=e,n=GB(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VG(t,e){const r=await vL(t,{},async()=>{const n=wx({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,o=yL(t,s,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",xL.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function HG(t,e){return gd(t,"POST","/v2/accounts:revokeToken",pd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Sr(e.idToken,"internal-error"),Sr(typeof e.idToken<"u","internal-error"),Sr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):eF(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Sr(e.length!==0,"internal-error");const r=eF(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Sr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await VG(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,o=new m0;return n&&(Sr(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(Sr(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),a&&(Sr(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new m0,this.toJSON())}_performRefresh(){return aA("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(t,e){Sr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class iA{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,a=GB(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new OG(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new N_(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Ig(this,this.stsTokenManager.getToken(this.auth,e));return Sr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return LG(this,e)}reload(){return MG(this)}_assign(e){this!==e&&(Sr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new iA(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Sr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await $y(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mc(this.auth.app))return Promise.reject(dA(this.auth));const e=await this.getIdToken();return await Ig(this,DG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,a,o,l,c,A,u;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,f=(s=r.email)!==null&&s!==void 0?s:void 0,h=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,g=(A=r.createdAt)!==null&&A!==void 0?A:void 0,w=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:k,isAnonymous:P,providerData:L,stsTokenManager:E}=r;Sr(b&&E,e,"internal-error");const _=m0.fromJSON(this.name,E);Sr(typeof b=="string",e,"internal-error"),nu(d,e.name),nu(f,e.name),Sr(typeof k=="boolean",e,"internal-error"),Sr(typeof P=="boolean",e,"internal-error"),nu(h,e.name),nu(m,e.name),nu(p,e.name),nu(x,e.name),nu(g,e.name),nu(w,e.name);const B=new iA({uid:b,auth:e,email:f,emailVerified:k,displayName:d,isAnonymous:P,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:_,createdAt:g,lastLoginAt:w});return L&&Array.isArray(L)&&(B.providerData=L.map(M=>Object.assign({},M))),x&&(B._redirectEventId=x),B}static async _fromIdTokenResponse(e,r,n=!1){const s=new m0;s.updateFromServerResponse(r);const a=new iA({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await $y(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Sr(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?bL(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),l=new m0;l.updateFromIdToken(n);const c=new iA({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),A={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new N_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(c,A),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tF=new Map;function oA(t){EA(t instanceof Function,"Expected a class definition");let e=tF.get(t);return e?(EA(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,tF.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}NL.type="NONE";const rF=NL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t,e,r){return`firebase:${t}:${e}:${r}`}class p0{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=ty(this.userKey,s.apiKey,a),this.fullPersistenceKey=ty("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?iA._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new p0(oA(rF),e,n);const s=(await Promise.all(r.map(async A=>{if(await A._isAvailable())return A}))).filter(A=>A);let a=s[0]||oA(rF);const o=ty(n,e.config.apiKey,e.name);let l=null;for(const A of r)try{const u=await A._get(o);if(u){const d=iA._fromJSON(e,u);A!==a&&(l=d),a=A;break}}catch{}const c=s.filter(A=>A._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new p0(a,e,n):(a=c[0],l&&await a._set(o,l.toJSON()),await Promise.all(r.map(async A=>{if(A!==a)try{await A._remove(o)}catch{}})),new p0(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(BL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IL(e))return"Blackberry";if(FL(e))return"Webos";if(_L(e))return"Safari";if((e.includes("chrome/")||EL(e))&&!e.includes("edge/"))return"Chrome";if(SL(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function CL(t=pa()){return/firefox\//i.test(t)}function _L(t=pa()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function EL(t=pa()){return/crios\//i.test(t)}function BL(t=pa()){return/iemobile/i.test(t)}function SL(t=pa()){return/android/i.test(t)}function IL(t=pa()){return/blackberry/i.test(t)}function FL(t=pa()){return/webos/i.test(t)}function JB(t=pa()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function KG(t=pa()){var e;return JB(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qG(){return cq()&&document.documentMode===10}function kL(t=pa()){return JB(t)||SL(t)||FL(t)||IL(t)||/windows phone/i.test(t)||BL(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(t,e=[]){let r;switch(t){case"Browser":r=nF(pa());break;case"Worker":r=`${nF(pa())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Y0}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,l)=>{try{const c=e(a);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $G(t,e={}){return gd(t,"GET","/v2/passwordPolicy",pd(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zG=6;class WG{constructor(e){var r,n,s,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:zG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,a,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsUppercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JG{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sF(this),this.idTokenSubscription=new sF(this),this.beforeStateQueue=new GG(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=oA(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await p0.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await wL(this,{idToken:e}),n=await iA._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(mc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Sr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await $y(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mc(this.app))return Promise.reject(dA(this));const r=e?js(e):null;return r&&Sr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Sr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mc(this.app)?Promise.reject(dA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mc(this.app)?Promise.reject(dA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(oA(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $G(this),r=new WG(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yx("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await HG(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&oA(e)||this._popupRedirectResolver;Sr(r,this,"argument-error"),this.redirectPersistenceManager=await p0.create(this,[oA(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Sr(l,this,"internal-error"),l.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Sr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&EG(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Hh(t){return js(t)}class sF{constructor(e){this.auth=e,this.observer=null,this.addObserver=mq(r=>this.observer=r)}get next(){return Sr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function XG(t){s2=t}function jL(t){return s2.loadJS(t)}function YG(){return s2.recaptchaEnterpriseScript}function ZG(){return s2.gapiScript}function e$(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const t$="recaptcha-enterprise",r$="NO_RECAPTCHA";class n${constructor(e){this.type=t$,this.auth=Hh(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,l)=>{RG(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const A=new PG(c);return a.tenantId==null?a._agentRecaptchaConfig=A:a._tenantRecaptchaConfigs[a.tenantId]=A,o(A.siteKey)}}).catch(c=>{l(c)})})}function s(a,o,l){const c=window.grecaptcha;Z4(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(A=>{o(A)}).catch(()=>{o(r$)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,o)=>{n(this.auth).then(l=>{if(!r&&Z4(window.grecaptcha))s(l,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=YG();c.length!==0&&(c+=l),jL(c).then(()=>{s(l,a,o)}).catch(A=>{o(A)})}}).catch(l=>{o(l)})})}}async function aF(t,e,r,n=!1){const s=new n$(t);let a;try{a=await s.verify(r)}catch{a=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function C_(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await aF(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await aF(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s$(t,e){const r=HB(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(qy(a,e??{}))return s;Hl(s,"already-initialized")}return r.initialize({options:e})}function a$(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(oA);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function i$(t,e,r){const n=Hh(t);Sr(n._canInitEmulator,n,"emulator-config-failed"),Sr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=PL(e),{host:o,port:l}=o$(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${a}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),l$()}function PL(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function o$(t){const e=PL(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:iF(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:iF(o)}}}function iF(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function l$(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XB{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return aA("not implemented")}_getIdTokenResponse(e){return aA("not implemented")}_linkToIdToken(e,r){return aA("not implemented")}_getReauthenticationResolver(e){return aA("not implemented")}}async function c$(t,e){return gd(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A$(t,e){return Nx(t,"POST","/v1/accounts:signInWithPassword",pd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u$(t,e){return Nx(t,"POST","/v1/accounts:signInWithEmailLink",pd(t,e))}async function d$(t,e){return Nx(t,"POST","/v1/accounts:signInWithEmailLink",pd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg extends XB{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Fg(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Fg(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return C_(e,r,"signInWithPassword",A$);case"emailLink":return u$(e,{email:this._email,oobCode:this._password});default:Hl(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return C_(e,n,"signUpPassword",c$);case"emailLink":return d$(e,{idToken:r,email:this._email,oobCode:this._password});default:Hl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g0(t,e){return Nx(t,"POST","/v1/accounts:signInWithIdp",pd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h$="http://localhost";class _h extends XB{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new _h(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Hl("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,a=GB(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new _h(n,s);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return g0(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,g0(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,g0(e,r)}buildRequest(){const e={requestUri:h$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=wx(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f$(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function m$(t){const e=up(dp(t)).link,r=e?up(dp(e)).deep_link_id:null,n=up(dp(t)).deep_link_id;return(n?up(dp(n)).link:null)||n||r||e||t}class YB{constructor(e){var r,n,s,a,o,l;const c=up(dp(e)),A=(r=c.apiKey)!==null&&r!==void 0?r:null,u=(n=c.oobCode)!==null&&n!==void 0?n:null,d=f$((s=c.mode)!==null&&s!==void 0?s:null);Sr(A&&u&&d,"argument-error"),this.apiKey=A,this.operation=d,this.code=u,this.continueUrl=(a=c.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=m$(e);try{return new YB(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(){this.providerId=Z0.PROVIDER_ID}static credential(e,r){return Fg._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=YB.parseLink(r);return Sr(n,"argument-error"),Fg._fromEmailAndCode(e,n.code,n.tenantId)}}Z0.PROVIDER_ID="password";Z0.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Z0.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx extends RL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends Cx{constructor(){super("facebook.com")}static credential(e){return _h._fromParams({providerId:yu.PROVIDER_ID,signInMethod:yu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yu.credentialFromTaggedObject(e)}static credentialFromError(e){return yu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yu.credential(e.oauthAccessToken)}catch{return null}}}yu.FACEBOOK_SIGN_IN_METHOD="facebook.com";yu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends Cx{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return _h._fromParams({providerId:wu.PROVIDER_ID,signInMethod:wu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return wu.credentialFromTaggedObject(e)}static credentialFromError(e){return wu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return wu.credential(r,n)}catch{return null}}}wu.GOOGLE_SIGN_IN_METHOD="google.com";wu.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends Cx{constructor(){super("github.com")}static credential(e){return _h._fromParams({providerId:bu.PROVIDER_ID,signInMethod:bu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bu.credentialFromTaggedObject(e)}static credentialFromError(e){return bu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bu.credential(e.oauthAccessToken)}catch{return null}}}bu.GITHUB_SIGN_IN_METHOD="github.com";bu.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu extends Cx{constructor(){super("twitter.com")}static credential(e,r){return _h._fromParams({providerId:Nu.PROVIDER_ID,signInMethod:Nu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Nu.credentialFromTaggedObject(e)}static credentialFromError(e){return Nu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Nu.credential(r,n)}catch{return null}}}Nu.TWITTER_SIGN_IN_METHOD="twitter.com";Nu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p$(t,e){return Nx(t,"POST","/v1/accounts:signUp",pd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await iA._fromIdTokenResponse(e,n,s),o=oF(n);return new Eh({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=oF(n);return new Eh({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function oF(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy extends kA{constructor(e,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,zy.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new zy(e,r,n,s)}}function DL(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?zy._fromErrorAndOperation(t,a,e,n):a})}async function g$(t,e,r=!1){const n=await Ig(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Eh._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x$(t,e,r=!1){const{auth:n}=t;if(mc(n.app))return Promise.reject(dA(n));const s="reauthenticate";try{const a=await Ig(t,DL(n,s,e,t),r);Sr(a.idToken,n,"internal-error");const o=WB(a.idToken);Sr(o,n,"internal-error");const{sub:l}=o;return Sr(t.uid===l,n,"user-mismatch"),Eh._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Hl(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(t,e,r=!1){if(mc(t.app))return Promise.reject(dA(t));const n="signIn",s=await DL(t,n,e),a=await Eh._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function v$(t,e){return LL(Hh(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UL(t){const e=Hh(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function y$(t,e,r){if(mc(t.app))return Promise.reject(dA(t));const n=Hh(t),o=await C_(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",p$).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&UL(t),c}),l=await Eh._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function w$(t,e,r){return mc(t.app)?Promise.reject(dA(t)):v$(js(t),Z0.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&UL(t),n})}function b$(t,e,r,n){return js(t).onIdTokenChanged(e,r,n)}function N$(t,e,r){return js(t).beforeAuthStateChanged(e,r)}function OL(t,e,r,n){return js(t).onAuthStateChanged(e,r,n)}function ZB(t){return js(t).signOut()}const Wy="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Wy,"1"),this.storage.removeItem(Wy),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$=1e3,_$=10;class QL extends ML{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);qG()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,_$):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},C$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}QL.type="LOCAL";const E$=QL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL extends ML{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}VL.type="SESSION";const HL=VL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new a2(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async A=>A(r.origin,a)),c=await B$(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}a2.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,o;return new Promise((l,c)=>{const A=eS("",20);s.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(d){const f=d;if(f.data.eventId===A)switch(f.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(f.data.response);break;default:clearTimeout(u),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:A,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(){return window}function I$(t){Nc().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(){return typeof Nc().WorkerGlobalScope<"u"&&typeof Nc().importScripts=="function"}async function F$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function k$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function T$(){return KL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="firebaseLocalStorageDb",j$=1,Jy="firebaseLocalStorage",GL="fbase_key";class _x{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function i2(t,e){return t.transaction([Jy],e?"readwrite":"readonly").objectStore(Jy)}function P$(){const t=indexedDB.deleteDatabase(qL);return new _x(t).toPromise()}function __(){const t=indexedDB.open(qL,j$);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Jy,{keyPath:GL})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Jy)?e(n):(n.close(),await P$(),e(await __()))})})}async function lF(t,e,r){const n=i2(t,!0).put({[GL]:e,value:r});return new _x(n).toPromise()}async function R$(t,e){const r=i2(t,!1).get(e),n=await new _x(r).toPromise();return n===void 0?null:n.value}function cF(t,e){const r=i2(t,!0).delete(e);return new _x(r).toPromise()}const D$=800,L$=3;class $L{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await __(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>L$)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=a2._getInstance(T$()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await F$(),!this.activeServiceWorker)return;this.sender=new S$(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||k$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await __();return await lF(e,Wy,"1"),await cF(e,Wy),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>lF(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>R$(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>cF(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=i2(s,!1).getAll();return new _x(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),D$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$L.type="LOCAL";const U$=$L;new bx(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O$(t,e){return e?oA(e):(Sr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS extends XB{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return g0(e,this._buildIdpRequest())}_linkToIdToken(e,r){return g0(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return g0(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function M$(t){return LL(t.auth,new tS(t),t.bypassAuthState)}function Q$(t){const{auth:e,user:r}=t;return Sr(r,e,"internal-error"),x$(r,new tS(t),t.bypassAuthState)}async function V$(t){const{auth:e,user:r}=t;return Sr(r,e,"internal-error"),g$(r,new tS(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(A){this.reject(A)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return M$;case"linkViaPopup":case"linkViaRedirect":return V$;case"reauthViaPopup":case"reauthViaRedirect":return Q$;default:Hl(this.auth,"internal-error")}}resolve(e){EA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){EA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$=new bx(2e3,1e4);class i0 extends zL{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,i0.currentPopupAction&&i0.currentPopupAction.cancel(),i0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Sr(e,this.auth,"internal-error"),e}async onExecution(){EA(this.filter.length===1,"Popup operations only handle one event");const e=eS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(bc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(bc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,i0.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,H$.get())};e()}}i0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K$="pendingRedirect",ry=new Map;class q$ extends zL{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ry.get(this.auth._key());if(!e){try{const n=await G$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ry.set(this.auth._key(),e)}return this.bypassAuthState||ry.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function G$(t,e){const r=W$(e),n=z$(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function $$(t,e){ry.set(t._key(),e)}function z$(t){return oA(t._redirectPersistence)}function W$(t){return ty(K$,t.config.apiKey,t.name)}async function J$(t,e,r=!1){if(mc(t.app))return Promise.reject(dA(t));const n=Hh(t),s=O$(n,e),o=await new q$(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$=10*60*1e3;class Y${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Z$(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!WL(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(bc(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=X$&&this.cachedEventUids.clear(),this.cachedEventUids.has(AF(e))}saveEventToCache(e){this.cachedEventUids.add(AF(e)),this.lastProcessedEventTime=Date.now()}}function AF(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function WL({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Z$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WL(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ez(t,e={}){return gd(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rz=/^https?/;async function nz(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ez(t);for(const r of e)try{if(sz(r))return}catch{}Hl(t,"unauthorized-domain")}function sz(t){const e=b_(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!rz.test(r))return!1;if(tz.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const az=new bx(3e4,6e4);function uF(){const t=Nc().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function iz(t){return new Promise((e,r)=>{var n,s,a;function o(){uF(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{uF(),r(bc(t,"network-request-failed"))},timeout:az.get()})}if(!((s=(n=Nc().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=Nc().gapi)===null||a===void 0)&&a.load)o();else{const l=e$("iframefcb");return Nc()[l]=()=>{gapi.load?o():r(bc(t,"network-request-failed"))},jL(`${ZG()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw ny=null,e})}let ny=null;function oz(t){return ny=ny||iz(t),ny}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz=new bx(5e3,15e3),cz="__/auth/iframe",Az="emulator/auth/iframe",uz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hz(t){const e=t.config;Sr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?zB(e,Az):`https://${t.config.authDomain}/${cz}`,n={apiKey:e.apiKey,appName:t.name,v:Y0},s=dz.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${wx(n).slice(1)}`}async function fz(t){const e=await oz(t),r=Nc().gapi;return Sr(r,t,"internal-error"),e.open({where:document.body,url:hz(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:uz,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const o=bc(t,"network-request-failed"),l=Nc().setTimeout(()=>{a(o)},lz.get());function c(){Nc().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pz=500,gz=600,xz="_blank",vz="http://localhost";class dF{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yz(t,e,r,n=pz,s=gz){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},mz),{width:n.toString(),height:s.toString(),top:a,left:o}),A=pa().toLowerCase();r&&(l=EL(A)?xz:r),CL(A)&&(e=e||vz,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[h,m])=>`${f}${h}=${m},`,"");if(KG(A)&&l!=="_self")return wz(e||"",l),new dF(null);const d=window.open(e||"",l,u);Sr(d,t,"popup-blocked");try{d.focus()}catch{}return new dF(d)}function wz(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bz="__/auth/handler",Nz="emulator/auth/handler",Cz=encodeURIComponent("fac");async function hF(t,e,r,n,s,a){Sr(t.config.authDomain,t,"auth-domain-config-required"),Sr(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Y0,eventId:s};if(e instanceof RL){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",fq(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof Cx){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await t._getAppCheckToken(),A=c?`#${Cz}=${encodeURIComponent(c)}`:"";return`${_z(t)}?${wx(l).slice(1)}${A}`}function _z({config:t}){return t.emulator?zB(t,Nz):`https://${t.authDomain}/${bz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="webStorageSupport";class Ez{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=HL,this._completeRedirectFn=J$,this._overrideRedirectResult=$$}async _openPopup(e,r,n,s){var a;EA((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await hF(e,r,n,b_(),s);return yz(e,o,eS())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await hF(e,r,n,b_(),s);return I$(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(EA(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await fz(e),n=new Y$(e);return r.register("authEvent",s=>(Sr(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Xb,{type:Xb},s=>{var a;const o=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[Xb];o!==void 0&&r(!!o),Hl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=nz(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return kL()||_L()||JB()}}const Bz=Ez;var fF="@firebase/auth",mF="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Sr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Fz(t){T0(new Ch("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Sr(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TL(t)},A=new JG(n,s,a,c);return a$(A,r),A},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),T0(new Ch("auth-internal",e=>{const r=Hh(e.getProvider("auth").getImmediate());return(n=>new Sz(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),$u(fF,mF,Iz(t)),$u(fF,mF,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz=5*60,Tz=lL("authIdTokenMaxAge")||kz;let pF=null;const jz=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Tz)return;const s=r==null?void 0:r.token;pF!==s&&(pF=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function JL(t=qB()){const e=HB(t,"auth");if(e.isInitialized())return e.getImmediate();const r=s$(t,{popupRedirectResolver:Bz,persistence:[U$,E$,HL]}),n=lL("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=jz(a.toString());N$(r,o,()=>o(r.currentUser)),b$(r,l=>o(l))}}const s=iL("auth");return s&&i$(r,`http://${s}`),r}function Pz(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}XG({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=bc("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",Pz().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Fz("Browser");var Rz="firebase",Dz="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$u(Rz,Dz,"app");var gF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var lh,XL;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,_){function B(){}B.prototype=_.prototype,E.D=_.prototype,E.prototype=new B,E.prototype.constructor=E,E.C=function(M,F,T){for(var O=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)O[Y-2]=arguments[Y];return _.prototype[F].apply(M,O)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,_,B){B||(B=0);var M=Array(16);if(typeof _=="string")for(var F=0;16>F;++F)M[F]=_.charCodeAt(B++)|_.charCodeAt(B++)<<8|_.charCodeAt(B++)<<16|_.charCodeAt(B++)<<24;else for(F=0;16>F;++F)M[F]=_[B++]|_[B++]<<8|_[B++]<<16|_[B++]<<24;_=E.g[0],B=E.g[1],F=E.g[2];var T=E.g[3],O=_+(T^B&(F^T))+M[0]+3614090360&4294967295;_=B+(O<<7&4294967295|O>>>25),O=T+(F^_&(B^F))+M[1]+3905402710&4294967295,T=_+(O<<12&4294967295|O>>>20),O=F+(B^T&(_^B))+M[2]+606105819&4294967295,F=T+(O<<17&4294967295|O>>>15),O=B+(_^F&(T^_))+M[3]+3250441966&4294967295,B=F+(O<<22&4294967295|O>>>10),O=_+(T^B&(F^T))+M[4]+4118548399&4294967295,_=B+(O<<7&4294967295|O>>>25),O=T+(F^_&(B^F))+M[5]+1200080426&4294967295,T=_+(O<<12&4294967295|O>>>20),O=F+(B^T&(_^B))+M[6]+2821735955&4294967295,F=T+(O<<17&4294967295|O>>>15),O=B+(_^F&(T^_))+M[7]+4249261313&4294967295,B=F+(O<<22&4294967295|O>>>10),O=_+(T^B&(F^T))+M[8]+1770035416&4294967295,_=B+(O<<7&4294967295|O>>>25),O=T+(F^_&(B^F))+M[9]+2336552879&4294967295,T=_+(O<<12&4294967295|O>>>20),O=F+(B^T&(_^B))+M[10]+4294925233&4294967295,F=T+(O<<17&4294967295|O>>>15),O=B+(_^F&(T^_))+M[11]+2304563134&4294967295,B=F+(O<<22&4294967295|O>>>10),O=_+(T^B&(F^T))+M[12]+1804603682&4294967295,_=B+(O<<7&4294967295|O>>>25),O=T+(F^_&(B^F))+M[13]+4254626195&4294967295,T=_+(O<<12&4294967295|O>>>20),O=F+(B^T&(_^B))+M[14]+2792965006&4294967295,F=T+(O<<17&4294967295|O>>>15),O=B+(_^F&(T^_))+M[15]+1236535329&4294967295,B=F+(O<<22&4294967295|O>>>10),O=_+(F^T&(B^F))+M[1]+4129170786&4294967295,_=B+(O<<5&4294967295|O>>>27),O=T+(B^F&(_^B))+M[6]+3225465664&4294967295,T=_+(O<<9&4294967295|O>>>23),O=F+(_^B&(T^_))+M[11]+643717713&4294967295,F=T+(O<<14&4294967295|O>>>18),O=B+(T^_&(F^T))+M[0]+3921069994&4294967295,B=F+(O<<20&4294967295|O>>>12),O=_+(F^T&(B^F))+M[5]+3593408605&4294967295,_=B+(O<<5&4294967295|O>>>27),O=T+(B^F&(_^B))+M[10]+38016083&4294967295,T=_+(O<<9&4294967295|O>>>23),O=F+(_^B&(T^_))+M[15]+3634488961&4294967295,F=T+(O<<14&4294967295|O>>>18),O=B+(T^_&(F^T))+M[4]+3889429448&4294967295,B=F+(O<<20&4294967295|O>>>12),O=_+(F^T&(B^F))+M[9]+568446438&4294967295,_=B+(O<<5&4294967295|O>>>27),O=T+(B^F&(_^B))+M[14]+3275163606&4294967295,T=_+(O<<9&4294967295|O>>>23),O=F+(_^B&(T^_))+M[3]+4107603335&4294967295,F=T+(O<<14&4294967295|O>>>18),O=B+(T^_&(F^T))+M[8]+1163531501&4294967295,B=F+(O<<20&4294967295|O>>>12),O=_+(F^T&(B^F))+M[13]+2850285829&4294967295,_=B+(O<<5&4294967295|O>>>27),O=T+(B^F&(_^B))+M[2]+4243563512&4294967295,T=_+(O<<9&4294967295|O>>>23),O=F+(_^B&(T^_))+M[7]+1735328473&4294967295,F=T+(O<<14&4294967295|O>>>18),O=B+(T^_&(F^T))+M[12]+2368359562&4294967295,B=F+(O<<20&4294967295|O>>>12),O=_+(B^F^T)+M[5]+4294588738&4294967295,_=B+(O<<4&4294967295|O>>>28),O=T+(_^B^F)+M[8]+2272392833&4294967295,T=_+(O<<11&4294967295|O>>>21),O=F+(T^_^B)+M[11]+1839030562&4294967295,F=T+(O<<16&4294967295|O>>>16),O=B+(F^T^_)+M[14]+4259657740&4294967295,B=F+(O<<23&4294967295|O>>>9),O=_+(B^F^T)+M[1]+2763975236&4294967295,_=B+(O<<4&4294967295|O>>>28),O=T+(_^B^F)+M[4]+1272893353&4294967295,T=_+(O<<11&4294967295|O>>>21),O=F+(T^_^B)+M[7]+4139469664&4294967295,F=T+(O<<16&4294967295|O>>>16),O=B+(F^T^_)+M[10]+3200236656&4294967295,B=F+(O<<23&4294967295|O>>>9),O=_+(B^F^T)+M[13]+681279174&4294967295,_=B+(O<<4&4294967295|O>>>28),O=T+(_^B^F)+M[0]+3936430074&4294967295,T=_+(O<<11&4294967295|O>>>21),O=F+(T^_^B)+M[3]+3572445317&4294967295,F=T+(O<<16&4294967295|O>>>16),O=B+(F^T^_)+M[6]+76029189&4294967295,B=F+(O<<23&4294967295|O>>>9),O=_+(B^F^T)+M[9]+3654602809&4294967295,_=B+(O<<4&4294967295|O>>>28),O=T+(_^B^F)+M[12]+3873151461&4294967295,T=_+(O<<11&4294967295|O>>>21),O=F+(T^_^B)+M[15]+530742520&4294967295,F=T+(O<<16&4294967295|O>>>16),O=B+(F^T^_)+M[2]+3299628645&4294967295,B=F+(O<<23&4294967295|O>>>9),O=_+(F^(B|~T))+M[0]+4096336452&4294967295,_=B+(O<<6&4294967295|O>>>26),O=T+(B^(_|~F))+M[7]+1126891415&4294967295,T=_+(O<<10&4294967295|O>>>22),O=F+(_^(T|~B))+M[14]+2878612391&4294967295,F=T+(O<<15&4294967295|O>>>17),O=B+(T^(F|~_))+M[5]+4237533241&4294967295,B=F+(O<<21&4294967295|O>>>11),O=_+(F^(B|~T))+M[12]+1700485571&4294967295,_=B+(O<<6&4294967295|O>>>26),O=T+(B^(_|~F))+M[3]+2399980690&4294967295,T=_+(O<<10&4294967295|O>>>22),O=F+(_^(T|~B))+M[10]+4293915773&4294967295,F=T+(O<<15&4294967295|O>>>17),O=B+(T^(F|~_))+M[1]+2240044497&4294967295,B=F+(O<<21&4294967295|O>>>11),O=_+(F^(B|~T))+M[8]+1873313359&4294967295,_=B+(O<<6&4294967295|O>>>26),O=T+(B^(_|~F))+M[15]+4264355552&4294967295,T=_+(O<<10&4294967295|O>>>22),O=F+(_^(T|~B))+M[6]+2734768916&4294967295,F=T+(O<<15&4294967295|O>>>17),O=B+(T^(F|~_))+M[13]+1309151649&4294967295,B=F+(O<<21&4294967295|O>>>11),O=_+(F^(B|~T))+M[4]+4149444226&4294967295,_=B+(O<<6&4294967295|O>>>26),O=T+(B^(_|~F))+M[11]+3174756917&4294967295,T=_+(O<<10&4294967295|O>>>22),O=F+(_^(T|~B))+M[2]+718787259&4294967295,F=T+(O<<15&4294967295|O>>>17),O=B+(T^(F|~_))+M[9]+3951481745&4294967295,E.g[0]=E.g[0]+_&4294967295,E.g[1]=E.g[1]+(F+(O<<21&4294967295|O>>>11))&4294967295,E.g[2]=E.g[2]+F&4294967295,E.g[3]=E.g[3]+T&4294967295}n.prototype.u=function(E,_){_===void 0&&(_=E.length);for(var B=_-this.blockSize,M=this.B,F=this.h,T=0;T<_;){if(F==0)for(;T<=B;)s(this,E,T),T+=this.blockSize;if(typeof E=="string"){for(;T<_;)if(M[F++]=E.charCodeAt(T++),F==this.blockSize){s(this,M),F=0;break}}else for(;T<_;)if(M[F++]=E[T++],F==this.blockSize){s(this,M),F=0;break}}this.h=F,this.o+=_},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var _=1;_<E.length-8;++_)E[_]=0;var B=8*this.o;for(_=E.length-8;_<E.length;++_)E[_]=B&255,B/=256;for(this.u(E),E=Array(16),_=B=0;4>_;++_)for(var M=0;32>M;M+=8)E[B++]=this.g[_]>>>M&255;return E};function a(E,_){var B=l;return Object.prototype.hasOwnProperty.call(B,E)?B[E]:B[E]=_(E)}function o(E,_){this.h=_;for(var B=[],M=!0,F=E.length-1;0<=F;F--){var T=E[F]|0;M&&T==_||(B[F]=T,M=!1)}this.g=B}var l={};function c(E){return-128<=E&&128>E?a(E,function(_){return new o([_|0],0>_?-1:0)}):new o([E|0],0>E?-1:0)}function A(E){if(isNaN(E)||!isFinite(E))return d;if(0>E)return x(A(-E));for(var _=[],B=1,M=0;E>=B;M++)_[M]=E/B|0,B*=4294967296;return new o(_,0)}function u(E,_){if(E.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(E.charAt(0)=="-")return x(u(E.substring(1),_));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var B=A(Math.pow(_,8)),M=d,F=0;F<E.length;F+=8){var T=Math.min(8,E.length-F),O=parseInt(E.substring(F,F+T),_);8>T?(T=A(Math.pow(_,T)),M=M.j(T).add(A(O))):(M=M.j(B),M=M.add(A(O)))}return M}var d=c(0),f=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var E=0,_=1,B=0;B<this.g.length;B++){var M=this.i(B);E+=(0<=M?M:4294967296+M)*_,_*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(m(this))return"0";if(p(this))return"-"+x(this).toString(E);for(var _=A(Math.pow(E,6)),B=this,M="";;){var F=k(B,_).g;B=g(B,F.j(_));var T=((0<B.g.length?B.g[0]:B.h)>>>0).toString(E);if(B=F,m(B))return T+M;for(;6>T.length;)T="0"+T;M=T+M}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function m(E){if(E.h!=0)return!1;for(var _=0;_<E.g.length;_++)if(E.g[_]!=0)return!1;return!0}function p(E){return E.h==-1}t.l=function(E){return E=g(this,E),p(E)?-1:m(E)?0:1};function x(E){for(var _=E.g.length,B=[],M=0;M<_;M++)B[M]=~E.g[M];return new o(B,~E.h).add(f)}t.abs=function(){return p(this)?x(this):this},t.add=function(E){for(var _=Math.max(this.g.length,E.g.length),B=[],M=0,F=0;F<=_;F++){var T=M+(this.i(F)&65535)+(E.i(F)&65535),O=(T>>>16)+(this.i(F)>>>16)+(E.i(F)>>>16);M=O>>>16,T&=65535,O&=65535,B[F]=O<<16|T}return new o(B,B[B.length-1]&-2147483648?-1:0)};function g(E,_){return E.add(x(_))}t.j=function(E){if(m(this)||m(E))return d;if(p(this))return p(E)?x(this).j(x(E)):x(x(this).j(E));if(p(E))return x(this.j(x(E)));if(0>this.l(h)&&0>E.l(h))return A(this.m()*E.m());for(var _=this.g.length+E.g.length,B=[],M=0;M<2*_;M++)B[M]=0;for(M=0;M<this.g.length;M++)for(var F=0;F<E.g.length;F++){var T=this.i(M)>>>16,O=this.i(M)&65535,Y=E.i(F)>>>16,me=E.i(F)&65535;B[2*M+2*F]+=O*me,w(B,2*M+2*F),B[2*M+2*F+1]+=T*me,w(B,2*M+2*F+1),B[2*M+2*F+1]+=O*Y,w(B,2*M+2*F+1),B[2*M+2*F+2]+=T*Y,w(B,2*M+2*F+2)}for(M=0;M<_;M++)B[M]=B[2*M+1]<<16|B[2*M];for(M=_;M<2*_;M++)B[M]=0;return new o(B,0)};function w(E,_){for(;(E[_]&65535)!=E[_];)E[_+1]+=E[_]>>>16,E[_]&=65535,_++}function b(E,_){this.g=E,this.h=_}function k(E,_){if(m(_))throw Error("division by zero");if(m(E))return new b(d,d);if(p(E))return _=k(x(E),_),new b(x(_.g),x(_.h));if(p(_))return _=k(E,x(_)),new b(x(_.g),_.h);if(30<E.g.length){if(p(E)||p(_))throw Error("slowDivide_ only works with positive integers.");for(var B=f,M=_;0>=M.l(E);)B=P(B),M=P(M);var F=L(B,1),T=L(M,1);for(M=L(M,2),B=L(B,2);!m(M);){var O=T.add(M);0>=O.l(E)&&(F=F.add(B),T=O),M=L(M,1),B=L(B,1)}return _=g(E,F.j(_)),new b(F,_)}for(F=d;0<=E.l(_);){for(B=Math.max(1,Math.floor(E.m()/_.m())),M=Math.ceil(Math.log(B)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),T=A(B),O=T.j(_);p(O)||0<O.l(E);)B-=M,T=A(B),O=T.j(_);m(T)&&(T=f),F=F.add(T),E=g(E,O)}return new b(F,E)}t.A=function(E){return k(this,E).h},t.and=function(E){for(var _=Math.max(this.g.length,E.g.length),B=[],M=0;M<_;M++)B[M]=this.i(M)&E.i(M);return new o(B,this.h&E.h)},t.or=function(E){for(var _=Math.max(this.g.length,E.g.length),B=[],M=0;M<_;M++)B[M]=this.i(M)|E.i(M);return new o(B,this.h|E.h)},t.xor=function(E){for(var _=Math.max(this.g.length,E.g.length),B=[],M=0;M<_;M++)B[M]=this.i(M)^E.i(M);return new o(B,this.h^E.h)};function P(E){for(var _=E.g.length+1,B=[],M=0;M<_;M++)B[M]=E.i(M)<<1|E.i(M-1)>>>31;return new o(B,E.h)}function L(E,_){var B=_>>5;_%=32;for(var M=E.g.length-B,F=[],T=0;T<M;T++)F[T]=0<_?E.i(T+B)>>>_|E.i(T+B+1)<<32-_:E.i(T+B);return new o(F,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,XL=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=A,o.fromString=u,lh=o}).apply(typeof gF<"u"?gF:typeof self<"u"?self:typeof window<"u"?window:{});var kv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var YL,hp,ZL,sy,E_,eU,tU,rU;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,H,Z){return y==Array.prototype||y==Object.prototype||(y[H]=Z.value),y};function r(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof kv=="object"&&kv];for(var H=0;H<y.length;++H){var Z=y[H];if(Z&&Z.Math==Math)return Z}throw Error("Cannot find global object")}var n=r(this);function s(y,H){if(H)e:{var Z=n;y=y.split(".");for(var ke=0;ke<y.length-1;ke++){var ft=y[ke];if(!(ft in Z))break e;Z=Z[ft]}y=y[y.length-1],ke=Z[y],H=H(ke),H!=ke&&H!=null&&e(Z,y,{configurable:!0,writable:!0,value:H})}}function a(y,H){y instanceof String&&(y+="");var Z=0,ke=!1,ft={next:function(){if(!ke&&Z<y.length){var bt=Z++;return{value:H(bt,y[bt]),done:!1}}return ke=!0,{done:!0,value:void 0}}};return ft[Symbol.iterator]=function(){return ft},ft}s("Array.prototype.values",function(y){return y||function(){return a(this,function(H,Z){return Z})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var H=typeof y;return H=H!="object"?H:y?Array.isArray(y)?"array":H:"null",H=="array"||H=="object"&&typeof y.length=="number"}function A(y){var H=typeof y;return H=="object"&&y!=null||H=="function"}function u(y,H,Z){return y.call.apply(y.bind,arguments)}function d(y,H,Z){if(!y)throw Error();if(2<arguments.length){var ke=Array.prototype.slice.call(arguments,2);return function(){var ft=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ft,ke),y.apply(H,ft)}}return function(){return y.apply(H,arguments)}}function f(y,H,Z){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,f.apply(null,arguments)}function h(y,H){var Z=Array.prototype.slice.call(arguments,1);return function(){var ke=Z.slice();return ke.push.apply(ke,arguments),y.apply(this,ke)}}function m(y,H){function Z(){}Z.prototype=H.prototype,y.aa=H.prototype,y.prototype=new Z,y.prototype.constructor=y,y.Qb=function(ke,ft,bt){for(var zt=Array(arguments.length-2),sn=2;sn<arguments.length;sn++)zt[sn-2]=arguments[sn];return H.prototype[ft].apply(ke,zt)}}function p(y){const H=y.length;if(0<H){const Z=Array(H);for(let ke=0;ke<H;ke++)Z[ke]=y[ke];return Z}return[]}function x(y,H){for(let Z=1;Z<arguments.length;Z++){const ke=arguments[Z];if(c(ke)){const ft=y.length||0,bt=ke.length||0;y.length=ft+bt;for(let zt=0;zt<bt;zt++)y[ft+zt]=ke[zt]}else y.push(ke)}}class g{constructor(H,Z){this.i=H,this.j=Z,this.h=0,this.g=null}get(){let H;return 0<this.h?(this.h--,H=this.g,this.g=H.next,H.next=null):H=this.i(),H}}function w(y){return/^[\s\xa0]*$/.test(y)}function b(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function k(y){return k[" "](y),y}k[" "]=function(){};var P=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function L(y,H,Z){for(const ke in y)H.call(Z,y[ke],ke,y)}function E(y,H){for(const Z in y)H.call(void 0,y[Z],Z,y)}function _(y){const H={};for(const Z in y)H[Z]=y[Z];return H}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(y,H){let Z,ke;for(let ft=1;ft<arguments.length;ft++){ke=arguments[ft];for(Z in ke)y[Z]=ke[Z];for(let bt=0;bt<B.length;bt++)Z=B[bt],Object.prototype.hasOwnProperty.call(ke,Z)&&(y[Z]=ke[Z])}}function F(y){var H=1;y=y.split(":");const Z=[];for(;0<H&&y.length;)Z.push(y.shift()),H--;return y.length&&Z.push(y.join(":")),Z}function T(y){l.setTimeout(()=>{throw y},0)}function O(){var y=te;let H=null;return y.g&&(H=y.g,y.g=y.g.next,y.g||(y.h=null),H.next=null),H}class Y{constructor(){this.h=this.g=null}add(H,Z){const ke=me.get();ke.set(H,Z),this.h?this.h.next=ke:this.g=ke,this.h=ke}}var me=new g(()=>new ae,y=>y.reset());class ae{constructor(){this.next=this.g=this.h=null}set(H,Z){this.h=H,this.g=Z,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,he=!1,te=new Y,pe=()=>{const y=l.Promise.resolve(void 0);fe=()=>{y.then(Ie)}};var Ie=()=>{for(var y;y=O();){try{y.h.call(y.g)}catch(Z){T(Z)}var H=me;H.j(y),100>H.h&&(H.h++,y.next=H.g,H.g=y)}he=!1};function S(){this.s=this.s,this.C=this.C}S.prototype.s=!1,S.prototype.ma=function(){this.s||(this.s=!0,this.N())},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(y,H){this.type=y,this.g=this.target=H,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,H=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const Z=()=>{};l.addEventListener("test",Z,H),l.removeEventListener("test",Z,H)}catch{}return y}();function j(y,H){if(I.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var Z=this.type=y.type,ke=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=H,H=y.relatedTarget){if(P){e:{try{k(H.nodeName);var ft=!0;break e}catch{}ft=!1}ft||(H=null)}}else Z=="mouseover"?H=y.fromElement:Z=="mouseout"&&(H=y.toElement);this.relatedTarget=H,ke?(this.clientX=ke.clientX!==void 0?ke.clientX:ke.pageX,this.clientY=ke.clientY!==void 0?ke.clientY:ke.pageY,this.screenX=ke.screenX||0,this.screenY=ke.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:U[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&j.aa.h.call(this)}}m(j,I);var U={2:"touch",3:"pen",4:"mouse"};j.prototype.h=function(){j.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var G="closure_listenable_"+(1e6*Math.random()|0),R=0;function X(y,H,Z,ke,ft){this.listener=y,this.proxy=null,this.src=H,this.type=Z,this.capture=!!ke,this.ha=ft,this.key=++R,this.da=this.fa=!1}function se(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ye(y){this.src=y,this.g={},this.h=0}ye.prototype.add=function(y,H,Z,ke,ft){var bt=y.toString();y=this.g[bt],y||(y=this.g[bt]=[],this.h++);var zt=Me(y,H,ke,ft);return-1<zt?(H=y[zt],Z||(H.fa=!1)):(H=new X(H,this.src,bt,!!ke,ft),H.fa=Z,y.push(H)),H};function z(y,H){var Z=H.type;if(Z in y.g){var ke=y.g[Z],ft=Array.prototype.indexOf.call(ke,H,void 0),bt;(bt=0<=ft)&&Array.prototype.splice.call(ke,ft,1),bt&&(se(H),y.g[Z].length==0&&(delete y.g[Z],y.h--))}}function Me(y,H,Z,ke){for(var ft=0;ft<y.length;++ft){var bt=y[ft];if(!bt.da&&bt.listener==H&&bt.capture==!!Z&&bt.ha==ke)return ft}return-1}var re="closure_lm_"+(1e6*Math.random()|0),W={};function q(y,H,Z,ke,ft){if(Array.isArray(H)){for(var bt=0;bt<H.length;bt++)q(y,H[bt],Z,ke,ft);return null}return Z=mt(Z),y&&y[G]?y.K(H,Z,A(ke)?!!ke.capture:!1,ft):oe(y,H,Z,!1,ke,ft)}function oe(y,H,Z,ke,ft,bt){if(!H)throw Error("Invalid event type");var zt=A(ft)?!!ft.capture:!!ft,sn=ct(y);if(sn||(y[re]=sn=new ye(y)),Z=sn.add(H,Z,ke,zt,bt),Z.proxy)return Z;if(ke=de(),Z.proxy=ke,ke.src=y,ke.listener=Z,y.addEventListener)V||(ft=zt),ft===void 0&&(ft=!1),y.addEventListener(H.toString(),ke,ft);else if(y.attachEvent)y.attachEvent($e(H.toString()),ke);else if(y.addListener&&y.removeListener)y.addListener(ke);else throw Error("addEventListener and attachEvent are unavailable.");return Z}function de(){function y(Z){return H.call(y.src,y.listener,Z)}const H=Je;return y}function Be(y,H,Z,ke,ft){if(Array.isArray(H))for(var bt=0;bt<H.length;bt++)Be(y,H[bt],Z,ke,ft);else ke=A(ke)?!!ke.capture:!!ke,Z=mt(Z),y&&y[G]?(y=y.i,H=String(H).toString(),H in y.g&&(bt=y.g[H],Z=Me(bt,Z,ke,ft),-1<Z&&(se(bt[Z]),Array.prototype.splice.call(bt,Z,1),bt.length==0&&(delete y.g[H],y.h--)))):y&&(y=ct(y))&&(H=y.g[H.toString()],y=-1,H&&(y=Me(H,Z,ke,ft)),(Z=-1<y?H[y]:null)&&He(Z))}function He(y){if(typeof y!="number"&&y&&!y.da){var H=y.src;if(H&&H[G])z(H.i,y);else{var Z=y.type,ke=y.proxy;H.removeEventListener?H.removeEventListener(Z,ke,y.capture):H.detachEvent?H.detachEvent($e(Z),ke):H.addListener&&H.removeListener&&H.removeListener(ke),(Z=ct(H))?(z(Z,y),Z.h==0&&(Z.src=null,H[re]=null)):se(y)}}}function $e(y){return y in W?W[y]:W[y]="on"+y}function Je(y,H){if(y.da)y=!0;else{H=new j(H,this);var Z=y.listener,ke=y.ha||y.src;y.fa&&He(y),y=Z.call(ke,H)}return y}function ct(y){return y=y[re],y instanceof ye?y:null}var at="__closure_events_fn_"+(1e9*Math.random()>>>0);function mt(y){return typeof y=="function"?y:(y[at]||(y[at]=function(H){return y.handleEvent(H)}),y[at])}function st(){S.call(this),this.i=new ye(this),this.M=this,this.F=null}m(st,S),st.prototype[G]=!0,st.prototype.removeEventListener=function(y,H,Z,ke){Be(this,y,H,Z,ke)};function Le(y,H){var Z,ke=y.F;if(ke)for(Z=[];ke;ke=ke.F)Z.push(ke);if(y=y.M,ke=H.type||H,typeof H=="string")H=new I(H,y);else if(H instanceof I)H.target=H.target||y;else{var ft=H;H=new I(ke,y),M(H,ft)}if(ft=!0,Z)for(var bt=Z.length-1;0<=bt;bt--){var zt=H.g=Z[bt];ft=ut(zt,ke,!0,H)&&ft}if(zt=H.g=y,ft=ut(zt,ke,!0,H)&&ft,ft=ut(zt,ke,!1,H)&&ft,Z)for(bt=0;bt<Z.length;bt++)zt=H.g=Z[bt],ft=ut(zt,ke,!1,H)&&ft}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var y=this.i,H;for(H in y.g){for(var Z=y.g[H],ke=0;ke<Z.length;ke++)se(Z[ke]);delete y.g[H],y.h--}}this.F=null},st.prototype.K=function(y,H,Z,ke){return this.i.add(String(y),H,!1,Z,ke)},st.prototype.L=function(y,H,Z,ke){return this.i.add(String(y),H,!0,Z,ke)};function ut(y,H,Z,ke){if(H=y.i.g[String(H)],!H)return!0;H=H.concat();for(var ft=!0,bt=0;bt<H.length;++bt){var zt=H[bt];if(zt&&!zt.da&&zt.capture==Z){var sn=zt.listener,xs=zt.ha||zt.src;zt.fa&&z(y.i,zt),ft=sn.call(xs,ke)!==!1&&ft}}return ft&&!ke.defaultPrevented}function be(y,H,Z){if(typeof y=="function")Z&&(y=f(y,Z));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(H)?-1:l.setTimeout(y,H||0)}function ge(y){y.g=be(()=>{y.g=null,y.i&&(y.i=!1,ge(y))},y.l);const H=y.h;y.h=null,y.m.apply(null,H)}class K extends S{constructor(H,Z){super(),this.m=H,this.l=Z,this.h=null,this.i=!1,this.g=null}j(H){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _e(y){S.call(this),this.h=y,this.g={}}m(_e,S);var Oe=[];function Ve(y){L(y.g,function(H,Z){this.g.hasOwnProperty(Z)&&He(H)},y),y.g={}}_e.prototype.N=function(){_e.aa.N.call(this),Ve(this)},_e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ve=l.JSON.stringify,Qe=l.JSON.parse,Ue=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Ee(){}Ee.prototype.h=null;function We(y){return y.h||(y.h=y.i())}function nt(){}var Nt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ot(){I.call(this,"d")}m(ot,I);function wt(){I.call(this,"c")}m(wt,I);var Lt={},cr=null;function ar(){return cr=cr||new st}Lt.La="serverreachability";function yr(y){I.call(this,Lt.La,y)}m(yr,I);function tr(y){const H=ar();Le(H,new yr(H))}Lt.STAT_EVENT="statevent";function et(y,H){I.call(this,Lt.STAT_EVENT,y),this.stat=H}m(et,I);function gt(y){const H=ar();Le(H,new et(H,y))}Lt.Ma="timingevent";function Rt(y,H){I.call(this,Lt.Ma,y),this.size=H}m(Rt,I);function kt(y,H){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},H)}function jt(){this.g=!0}jt.prototype.xa=function(){this.g=!1};function Zt(y,H,Z,ke,ft,bt){y.info(function(){if(y.g)if(bt)for(var zt="",sn=bt.split("&"),xs=0;xs<sn.length;xs++){var qr=sn[xs].split("=");if(1<qr.length){var fn=qr[0];qr=qr[1];var qn=fn.split("_");zt=2<=qn.length&&qn[1]=="type"?zt+(fn+"="+qr+"&"):zt+(fn+"=redacted&")}}else zt=null;else zt=bt;return"XMLHTTP REQ ("+ke+") [attempt "+ft+"]: "+H+`
`+Z+`
`+zt})}function Vt(y,H,Z,ke,ft,bt,zt){y.info(function(){return"XMLHTTP RESP ("+ke+") [ attempt "+ft+"]: "+H+`
`+Z+`
`+bt+" "+zt})}function ie(y,H,Z,ke){y.info(function(){return"XMLHTTP TEXT ("+H+"): "+ue(y,Z)+(ke?" "+ke:"")})}function ne(y,H){y.info(function(){return"TIMEOUT: "+H})}jt.prototype.info=function(){};function ue(y,H){if(!y.g)return H;if(!H)return null;try{var Z=JSON.parse(H);if(Z){for(y=0;y<Z.length;y++)if(Array.isArray(Z[y])){var ke=Z[y];if(!(2>ke.length)){var ft=ke[1];if(Array.isArray(ft)&&!(1>ft.length)){var bt=ft[0];if(bt!="noop"&&bt!="stop"&&bt!="close")for(var zt=1;zt<ft.length;zt++)ft[zt]=""}}}}return ve(Z)}catch{return H}}var xe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},De;function ee(){}m(ee,Ee),ee.prototype.g=function(){return new XMLHttpRequest},ee.prototype.i=function(){return{}},De=new ee;function Te(y,H,Z,ke){this.j=y,this.i=H,this.l=Z,this.R=ke||1,this.U=new _e(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ae}function Ae(){this.i=null,this.g="",this.h=!1}var Pe={},Ce={};function Ze(y,H,Z){y.L=1,y.v=Dc(ra(H)),y.m=Z,y.P=!0,Xe(y,null)}function Xe(y,H){y.F=Date.now(),rt(y),y.A=ra(y.v);var Z=y.A,ke=y.R;Array.isArray(ke)||(ke=[String(ke)]),cf(Z.i,"t",ke),y.C=0,Z=y.j.J,y.h=new Ae,y.g=_s(y.j,Z?H:null,!y.m),0<y.O&&(y.M=new K(f(y.Y,y,y.g),y.O)),H=y.U,Z=y.g,ke=y.ca;var ft="readystatechange";Array.isArray(ft)||(ft&&(Oe[0]=ft.toString()),ft=Oe);for(var bt=0;bt<ft.length;bt++){var zt=q(Z,ft[bt],ke||H.handleEvent,!1,H.h||H);if(!zt)break;H.g[zt.key]=zt}H=y.H?_(y.H):{},y.m?(y.u||(y.u="POST"),H["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,H)):(y.u="GET",y.g.ea(y.A,y.u,null,H)),tr(),Zt(y.i,y.u,y.A,y.l,y.R,y.m)}Te.prototype.ca=function(y){y=y.target;const H=this.M;H&&bi(y)==3?H.j():this.Y(y)},Te.prototype.Y=function(y){try{if(y==this.g)e:{const qn=bi(this.g);var H=this.g.Ba();const io=this.g.Z();if(!(3>qn)&&(qn!=3||this.g&&(this.h.h||this.g.oa()||Bd(this.g)))){this.J||qn!=4||H==7||(H==8||0>=io?tr(3):tr(2)),Mt(this);var Z=this.g.Z();this.X=Z;t:if(Ye(this)){var ke=Bd(this.g);y="";var ft=ke.length,bt=bi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xr(this),Kt(this);var zt="";break t}this.h.i=new l.TextDecoder}for(H=0;H<ft;H++)this.h.h=!0,y+=this.h.i.decode(ke[H],{stream:!(bt&&H==ft-1)});ke.length=0,this.h.g+=y,this.C=0,zt=this.h.g}else zt=this.g.oa();if(this.o=Z==200,Vt(this.i,this.u,this.A,this.l,this.R,qn,Z),this.o){if(this.T&&!this.K){t:{if(this.g){var sn,xs=this.g;if((sn=xs.g?xs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(sn)){var qr=sn;break t}}qr=null}if(Z=qr)ie(this.i,this.l,Z,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hn(this,Z);else{this.o=!1,this.s=3,gt(12),xr(this),Kt(this);break e}}if(this.P){Z=!0;let Ya;for(;!this.J&&this.C<zt.length;)if(Ya=ze(this,zt),Ya==Ce){qn==4&&(this.s=4,gt(14),Z=!1),ie(this.i,this.l,null,"[Incomplete Response]");break}else if(Ya==Pe){this.s=4,gt(15),ie(this.i,this.l,zt,"[Invalid Chunk]"),Z=!1;break}else ie(this.i,this.l,Ya,null),Hn(this,Ya);if(Ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qn!=4||zt.length!=0||this.h.h||(this.s=1,gt(16),Z=!1),this.o=this.o&&Z,!Z)ie(this.i,this.l,zt,"[Invalid Chunked Response]"),xr(this),Kt(this);else if(0<zt.length&&!this.W){this.W=!0;var fn=this.j;fn.g==this&&fn.ba&&!fn.M&&(fn.j.info("Great, no buffering proxy detected. Bytes received: "+zt.length),ir(fn),fn.M=!0,gt(11))}}else ie(this.i,this.l,zt,null),Hn(this,zt);qn==4&&xr(this),this.o&&!this.J&&(qn==4?kr(this.j,this):(this.o=!1,rt(this)))}else uf(this.g),Z==400&&0<zt.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),xr(this),Kt(this)}}}catch{}finally{}};function Ye(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function ze(y,H){var Z=y.C,ke=H.indexOf(`
`,Z);return ke==-1?Ce:(Z=Number(H.substring(Z,ke)),isNaN(Z)?Pe:(ke+=1,ke+Z>H.length?Ce:(H=H.slice(ke,ke+Z),y.C=ke+Z,H)))}Te.prototype.cancel=function(){this.J=!0,xr(this)};function rt(y){y.S=Date.now()+y.I,dt(y,y.I)}function dt(y,H){if(y.B!=null)throw Error("WatchDog timer not null");y.B=kt(f(y.ba,y),H)}function Mt(y){y.B&&(l.clearTimeout(y.B),y.B=null)}Te.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(ne(this.i,this.A),this.L!=2&&(tr(),gt(17)),xr(this),this.s=2,Kt(this)):dt(this,this.S-y)};function Kt(y){y.j.G==0||y.J||kr(y.j,y)}function xr(y){Mt(y);var H=y.M;H&&typeof H.ma=="function"&&H.ma(),y.M=null,Ve(y.U),y.g&&(H=y.g,y.g=null,H.abort(),H.ma())}function Hn(y,H){try{var Z=y.j;if(Z.G!=0&&(Z.g==y||Jn(Z.h,y))){if(!y.K&&Jn(Z.h,y)&&Z.G==3){try{var ke=Z.Da.g.parse(H)}catch{ke=null}if(Array.isArray(ke)&&ke.length==3){var ft=ke;if(ft[0]==0){e:if(!Z.u){if(Z.g)if(Z.g.F+3e3<y.F)Nr(Z),Qo(Z);else break e;Pt(Z),gt(18)}}else Z.za=ft[1],0<Z.za-Z.T&&37500>ft[2]&&Z.F&&Z.v==0&&!Z.C&&(Z.C=kt(f(Z.Za,Z),6e3));if(1>=no(Z.h)&&Z.ca){try{Z.ca()}catch{}Z.ca=void 0}}else gn(Z,11)}else if((y.K||Z.g==y)&&Nr(Z),!w(H))for(ft=Z.Da.g.parse(H),H=0;H<ft.length;H++){let qr=ft[H];if(Z.T=qr[0],qr=qr[1],Z.G==2)if(qr[0]=="c"){Z.K=qr[1],Z.ia=qr[2];const fn=qr[3];fn!=null&&(Z.la=fn,Z.j.info("VER="+Z.la));const qn=qr[4];qn!=null&&(Z.Aa=qn,Z.j.info("SVER="+Z.Aa));const io=qr[5];io!=null&&typeof io=="number"&&0<io&&(ke=1.5*io,Z.L=ke,Z.j.info("backChannelRequestTimeoutMs_="+ke)),ke=Z;const Ya=y.g;if(Ya){const ja=Ya.g?Ya.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ja){var bt=ke.h;bt.g||ja.indexOf("spdy")==-1&&ja.indexOf("quic")==-1&&ja.indexOf("h2")==-1||(bt.j=bt.l,bt.g=new Set,bt.h&&(so(bt,bt.h),bt.h=null))}if(ke.D){const yl=Ya.g?Ya.g.getResponseHeader("X-HTTP-Session-Id"):null;yl&&(ke.ya=yl,Yr(ke.I,ke.D,yl))}}Z.G=3,Z.l&&Z.l.ua(),Z.ba&&(Z.R=Date.now()-y.F,Z.j.info("Handshake RTT: "+Z.R+"ms")),ke=Z;var zt=y;if(ke.qa=yn(ke,ke.J?ke.ia:null,ke.W),zt.K){DA(ke.h,zt);var sn=zt,xs=ke.L;xs&&(sn.I=xs),sn.B&&(Mt(sn),rt(sn)),ke.g=zt}else St(ke);0<Z.i.length&&D(Z)}else qr[0]!="stop"&&qr[0]!="close"||gn(Z,7);else Z.G==3&&(qr[0]=="stop"||qr[0]=="close"?qr[0]=="stop"?gn(Z,7):VA(Z):qr[0]!="noop"&&Z.l&&Z.l.ta(qr),Z.v=0)}}tr(4)}catch{}}var Tn=class{constructor(y,H){this.g=y,this.map=H}};function wi(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Rs(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function no(y){return y.h?1:y.g?y.g.size:0}function Jn(y,H){return y.h?y.h==H:y.g?y.g.has(H):!1}function so(y,H){y.g?y.g.add(H):y.h=H}function DA(y,H){y.h&&y.h==H?y.h=null:y.g&&y.g.has(H)&&y.g.delete(H)}wi.prototype.cancel=function(){if(this.i=Kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Kn(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let H=y.i;for(const Z of y.g.values())H=H.concat(Z.D);return H}return p(y.i)}function Yl(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var H=[],Z=y.length,ke=0;ke<Z;ke++)H.push(y[ke]);return H}H=[],Z=0;for(ke in y)H[Z++]=y[ke];return H}function Ro(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var H=[];y=y.length;for(var Z=0;Z<y;Z++)H.push(Z);return H}H=[],Z=0;for(const ke in y)H[Z++]=ke;return H}}}function Pc(y,H){if(y.forEach&&typeof y.forEach=="function")y.forEach(H,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,H,void 0);else for(var Z=Ro(y),ke=Yl(y),ft=ke.length,bt=0;bt<ft;bt++)H.call(void 0,ke[bt],Z&&Z[bt],y)}var Nd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mi(y,H){if(y){y=y.split("&");for(var Z=0;Z<y.length;Z++){var ke=y[Z].indexOf("="),ft=null;if(0<=ke){var bt=y[Z].substring(0,ke);ft=y[Z].substring(ke+1)}else bt=y[Z];H(bt,ft?decodeURIComponent(ft.replace(/\+/g," ")):"")}}}function Ln(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof Ln){this.h=y.h,Rc(this,y.j),this.o=y.o,this.g=y.g,LA(this,y.s),this.l=y.l;var H=y.i,Z=new Ta;Z.i=H.i,H.g&&(Z.g=new Map(H.g),Z.h=H.h),af(this,Z),this.m=y.m}else y&&(H=String(y).match(Nd))?(this.h=!1,Rc(this,H[1]||"",!0),this.o=Zl(H[2]||""),this.g=Zl(H[3]||"",!0),LA(this,H[4]),this.l=Zl(H[5]||"",!0),af(this,H[6]||"",!0),this.m=Zl(H[7]||"")):(this.h=!1,this.i=new Ta(null,this.h))}Ln.prototype.toString=function(){var y=[],H=this.j;H&&y.push(Do(H,of,!0),":");var Z=this.g;return(Z||H=="file")&&(y.push("//"),(H=this.o)&&y.push(Do(H,of,!0),"@"),y.push(encodeURIComponent(String(Z)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),Z=this.s,Z!=null&&y.push(":",String(Z))),(Z=this.l)&&(this.g&&Z.charAt(0)!="/"&&y.push("/"),y.push(Do(Z,Z.charAt(0)=="/"?fm:hm,!0))),(Z=this.i.toString())&&y.push("?",Z),(Z=this.m)&&y.push("#",Do(Z,lf)),y.join("")};function ra(y){return new Ln(y)}function Rc(y,H,Z){y.j=Z?Zl(H,!0):H,y.j&&(y.j=y.j.replace(/:$/,""))}function LA(y,H){if(H){if(H=Number(H),isNaN(H)||0>H)throw Error("Bad port number "+H);y.s=H}else y.s=null}function af(y,H,Z){H instanceof Ta?(y.i=H,mm(y.i,y.h)):(Z||(H=Do(H,Cd)),y.i=new Ta(H,y.h))}function Yr(y,H,Z){y.i.set(H,Z)}function Dc(y){return Yr(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function Zl(y,H){return y?H?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Do(y,H,Z){return typeof y=="string"?(y=encodeURI(y).replace(H,Lc),Z&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Lc(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var of=/[#\/\?@]/g,hm=/[#\?:]/g,fm=/[#\?]/g,Cd=/[#\?@]/g,lf=/#/g;function Ta(y,H){this.h=this.g=null,this.i=y||null,this.j=!!H}function Lo(y){y.g||(y.g=new Map,y.h=0,y.i&&Mi(y.i,function(H,Z){y.add(decodeURIComponent(H.replace(/\+/g," ")),Z)}))}t=Ta.prototype,t.add=function(y,H){Lo(this),this.i=null,y=br(this,y);var Z=this.g.get(y);return Z||this.g.set(y,Z=[]),Z.push(H),this.h+=1,this};function ec(y,H){Lo(y),H=br(y,H),y.g.has(H)&&(y.i=null,y.h-=y.g.get(H).length,y.g.delete(H))}function UA(y,H){return Lo(y),H=br(y,H),y.g.has(H)}t.forEach=function(y,H){Lo(this),this.g.forEach(function(Z,ke){Z.forEach(function(ft){y.call(H,ft,ke,this)},this)},this)},t.na=function(){Lo(this);const y=Array.from(this.g.values()),H=Array.from(this.g.keys()),Z=[];for(let ke=0;ke<H.length;ke++){const ft=y[ke];for(let bt=0;bt<ft.length;bt++)Z.push(H[ke])}return Z},t.V=function(y){Lo(this);let H=[];if(typeof y=="string")UA(this,y)&&(H=H.concat(this.g.get(br(this,y))));else{y=Array.from(this.g.values());for(let Z=0;Z<y.length;Z++)H=H.concat(y[Z])}return H},t.set=function(y,H){return Lo(this),this.i=null,y=br(this,y),UA(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[H]),this.h+=1,this},t.get=function(y,H){return y?(y=this.V(y),0<y.length?String(y[0]):H):H};function cf(y,H,Z){ec(y,H),0<Z.length&&(y.i=null,y.g.set(br(y,H),p(Z)),y.h+=Z.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],H=Array.from(this.g.keys());for(var Z=0;Z<H.length;Z++){var ke=H[Z];const bt=encodeURIComponent(String(ke)),zt=this.V(ke);for(ke=0;ke<zt.length;ke++){var ft=bt;zt[ke]!==""&&(ft+="="+encodeURIComponent(String(zt[ke]))),y.push(ft)}}return this.i=y.join("&")};function br(y,H){return H=String(H),y.j&&(H=H.toLowerCase()),H}function mm(y,H){H&&!y.j&&(Lo(y),y.i=null,y.g.forEach(function(Z,ke){var ft=ke.toLowerCase();ke!=ft&&(ec(this,ke),cf(this,ft,Z))},y)),y.j=H}function pm(y,H){const Z=new jt;if(l.Image){const ke=new Image;ke.onload=h(va,Z,"TestLoadImage: loaded",!0,H,ke),ke.onerror=h(va,Z,"TestLoadImage: error",!1,H,ke),ke.onabort=h(va,Z,"TestLoadImage: abort",!1,H,ke),ke.ontimeout=h(va,Z,"TestLoadImage: timeout",!1,H,ke),l.setTimeout(function(){ke.ontimeout&&ke.ontimeout()},1e4),ke.src=y}else H(!1)}function gm(y,H){const Z=new jt,ke=new AbortController,ft=setTimeout(()=>{ke.abort(),va(Z,"TestPingServer: timeout",!1,H)},1e4);fetch(y,{signal:ke.signal}).then(bt=>{clearTimeout(ft),bt.ok?va(Z,"TestPingServer: ok",!0,H):va(Z,"TestPingServer: server error",!1,H)}).catch(()=>{clearTimeout(ft),va(Z,"TestPingServer: error",!1,H)})}function va(y,H,Z,ke,ft){try{ft&&(ft.onload=null,ft.onerror=null,ft.onabort=null,ft.ontimeout=null),ke(Z)}catch{}}function xl(){this.g=new Ue}function xm(y,H,Z){const ke=Z||"";try{Pc(y,function(ft,bt){let zt=ft;A(ft)&&(zt=ve(ft)),H.push(ke+bt+"="+encodeURIComponent(zt))})}catch(ft){throw H.push(ke+"type="+encodeURIComponent("_badmap")),ft}}function OA(y){this.l=y.Ub||null,this.j=y.eb||!1}m(OA,Ee),OA.prototype.g=function(){return new vl(this.l,this.j)},OA.prototype.i=function(y){return function(){return y}}({});function vl(y,H){st.call(this),this.D=y,this.o=H,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(vl,st),t=vl.prototype,t.open=function(y,H){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=H,this.readyState=1,Uc(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const H={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(H.body=y),(this.D||l).fetch(new Request(this.A,H)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Uc(this)),this.g&&(this.readyState=3,Uc(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;MA(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function MA(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var H=y.value?y.value:new Uint8Array(0);(H=this.v.decode(H,{stream:!y.done}))&&(this.response=this.responseText+=H)}y.done?ao(this):Uc(this),this.readyState==3&&MA(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,ao(this))},t.Qa=function(y){this.g&&(this.response=y,ao(this))},t.ga=function(){this.g&&ao(this)};function ao(y){y.readyState=4,y.l=null,y.j=null,y.v=null,Uc(y)}t.setRequestHeader=function(y,H){this.u.append(y,H)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],H=this.h.entries();for(var Z=H.next();!Z.done;)Z=Z.value,y.push(Z[0]+": "+Z[1]),Z=H.next();return y.join(`\r
`)};function Uc(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(vl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Uo(y){let H="";return L(y,function(Z,ke){H+=ke,H+=":",H+=Z,H+=`\r
`}),H}function _d(y,H,Z){e:{for(ke in Z){var ke=!1;break e}ke=!0}ke||(Z=Uo(Z),typeof y=="string"?Z!=null&&encodeURIComponent(String(Z)):Yr(y,H,Z))}function jn(y){st.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(jn,st);var Ed=/^https?$/i,Af=["POST","PUT"];t=jn.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,H,Z,ke){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);H=H?H.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?We(this.o):We(De),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(H,String(y),!0),this.B=!1}catch(bt){Oo(this,bt);return}if(y=Z||"",Z=new Map(this.headers),ke)if(Object.getPrototypeOf(ke)===Object.prototype)for(var ft in ke)Z.set(ft,ke[ft]);else if(typeof ke.keys=="function"&&typeof ke.get=="function")for(const bt of ke.keys())Z.set(bt,ke.get(bt));else throw Error("Unknown input type for opt_headers: "+String(ke));ke=Array.from(Z.keys()).find(bt=>bt.toLowerCase()=="content-type"),ft=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Af,H,void 0))||ke||ft||Z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[bt,zt]of Z)this.g.setRequestHeader(bt,zt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{rc(this),this.u=!0,this.g.send(y),this.u=!1}catch(bt){Oo(this,bt)}};function Oo(y,H){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=H,y.m=5,QA(y),tc(y)}function QA(y){y.A||(y.A=!0,Le(y,"complete"),Le(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,Le(this,"complete"),Le(this,"abort"),tc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tc(this,!0)),jn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Oc(this):this.bb())},t.bb=function(){Oc(this)};function Oc(y){if(y.h&&typeof o<"u"&&(!y.v[1]||bi(y)!=4||y.Z()!=2)){if(y.u&&bi(y)==4)be(y.Ea,0,y);else if(Le(y,"readystatechange"),bi(y)==4){y.h=!1;try{const zt=y.Z();e:switch(zt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var H=!0;break e;default:H=!1}var Z;if(!(Z=H)){var ke;if(ke=zt===0){var ft=String(y.D).match(Nd)[1]||null;!ft&&l.self&&l.self.location&&(ft=l.self.location.protocol.slice(0,-1)),ke=!Ed.test(ft?ft.toLowerCase():"")}Z=ke}if(Z)Le(y,"complete"),Le(y,"success");else{y.m=6;try{var bt=2<bi(y)?y.g.statusText:""}catch{bt=""}y.l=bt+" ["+y.Z()+"]",QA(y)}}finally{tc(y)}}}}function tc(y,H){if(y.g){rc(y);const Z=y.g,ke=y.v[0]?()=>{}:null;y.g=null,y.v=null,H||Le(y,"ready");try{Z.onreadystatechange=ke}catch{}}}function rc(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function bi(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<bi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var H=this.g.responseText;return y&&H.indexOf(y)==0&&(H=H.substring(y.length)),Qe(H)}};function Bd(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function uf(y){const H={};y=(y.g&&2<=bi(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let ke=0;ke<y.length;ke++){if(w(y[ke]))continue;var Z=F(y[ke]);const ft=Z[0];if(Z=Z[1],typeof Z!="string")continue;Z=Z.trim();const bt=H[ft]||[];H[ft]=bt,bt.push(Z)}E(H,function(ke){return ke.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ni(y,H,Z){return Z&&Z.internalChannelParams&&Z.internalChannelParams[y]||H}function Mo(y){this.Aa=0,this.i=[],this.j=new jt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ni("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ni("baseRetryDelayMs",5e3,y),this.cb=Ni("retryDelaySeedMs",1e4,y),this.Wa=Ni("forwardChannelMaxRetries",2,y),this.wa=Ni("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new wi(y&&y.concurrentRequestLimit),this.Da=new xl,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Mo.prototype,t.la=8,t.G=1,t.connect=function(y,H,Z,ke){gt(0),this.W=y,this.H=H||{},Z&&ke!==void 0&&(this.H.OSID=Z,this.H.OAID=ke),this.F=this.X,this.I=yn(this,null,this.W),D(this)};function VA(y){if(Sd(y),y.G==3){var H=y.U++,Z=ra(y.I);if(Yr(Z,"SID",y.K),Yr(Z,"RID",H),Yr(Z,"TYPE","terminate"),tt(y,Z),H=new Te(y,y.j,H),H.L=2,H.v=Dc(ra(Z)),Z=!1,l.navigator&&l.navigator.sendBeacon)try{Z=l.navigator.sendBeacon(H.v.toString(),"")}catch{}!Z&&l.Image&&(new Image().src=H.v,Z=!0),Z||(H.g=_s(H.j,null),H.g.ea(H.v)),H.F=Date.now(),rt(H)}ms(y)}function Qo(y){y.g&&(ir(y),y.g.cancel(),y.g=null)}function Sd(y){Qo(y),y.u&&(l.clearTimeout(y.u),y.u=null),Nr(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function D(y){if(!Rs(y.h)&&!y.s){y.s=!0;var H=y.Ga;fe||pe(),he||(fe(),he=!0),te.add(H,y),y.B=0}}function le(y,H){return no(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=H.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=kt(f(y.Ga,y,H),Zr(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const ft=new Te(this,this.j,y);let bt=this.o;if(this.S&&(bt?(bt=_(bt),M(bt,this.S)):bt=this.S),this.m!==null||this.O||(ft.H=bt,bt=null),this.P)e:{for(var H=0,Z=0;Z<this.i.length;Z++){t:{var ke=this.i[Z];if("__data__"in ke.map&&(ke=ke.map.__data__,typeof ke=="string")){ke=ke.length;break t}ke=void 0}if(ke===void 0)break;if(H+=ke,4096<H){H=Z;break e}if(H===4096||Z===this.i.length-1){H=Z+1;break e}}H=1e3}else H=1e3;H=ht(this,ft,H),Z=ra(this.I),Yr(Z,"RID",y),Yr(Z,"CVER",22),this.D&&Yr(Z,"X-HTTP-Session-Id",this.D),tt(this,Z),bt&&(this.O?H="headers="+encodeURIComponent(String(Uo(bt)))+"&"+H:this.m&&_d(Z,this.m,bt)),so(this.h,ft),this.Ua&&Yr(Z,"TYPE","init"),this.P?(Yr(Z,"$req",H),Yr(Z,"SID","null"),ft.T=!0,Ze(ft,Z,null)):Ze(ft,Z,H),this.G=2}}else this.G==3&&(y?Ke(this,y):this.i.length==0||Rs(this.h)||Ke(this))};function Ke(y,H){var Z;H?Z=H.l:Z=y.U++;const ke=ra(y.I);Yr(ke,"SID",y.K),Yr(ke,"RID",Z),Yr(ke,"AID",y.T),tt(y,ke),y.m&&y.o&&_d(ke,y.m,y.o),Z=new Te(y,y.j,Z,y.B+1),y.m===null&&(Z.H=y.o),H&&(y.i=H.D.concat(y.i)),H=ht(y,Z,1e3),Z.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),so(y.h,Z),Ze(Z,ke,H)}function tt(y,H){y.H&&L(y.H,function(Z,ke){Yr(H,ke,Z)}),y.l&&Pc({},function(Z,ke){Yr(H,ke,Z)})}function ht(y,H,Z){Z=Math.min(y.i.length,Z);var ke=y.l?f(y.l.Na,y.l,y):null;e:{var ft=y.i;let bt=-1;for(;;){const zt=["count="+Z];bt==-1?0<Z?(bt=ft[0].g,zt.push("ofs="+bt)):bt=0:zt.push("ofs="+bt);let sn=!0;for(let xs=0;xs<Z;xs++){let qr=ft[xs].g;const fn=ft[xs].map;if(qr-=bt,0>qr)bt=Math.max(0,ft[xs].g-100),sn=!1;else try{xm(fn,zt,"req"+qr+"_")}catch{ke&&ke(fn)}}if(sn){ke=zt.join("&");break e}}}return y=y.i.splice(0,Z),H.D=y,ke}function St(y){if(!y.g&&!y.u){y.Y=1;var H=y.Fa;fe||pe(),he||(fe(),he=!0),te.add(H,y),y.v=0}}function Pt(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=kt(f(y.Fa,y),Zr(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,hr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=kt(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),Qo(this),hr(this))};function ir(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function hr(y){y.g=new Te(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var H=ra(y.qa);Yr(H,"RID","rpc"),Yr(H,"SID",y.K),Yr(H,"AID",y.T),Yr(H,"CI",y.F?"0":"1"),!y.F&&y.ja&&Yr(H,"TO",y.ja),Yr(H,"TYPE","xmlhttp"),tt(y,H),y.m&&y.o&&_d(H,y.m,y.o),y.L&&(y.g.I=y.L);var Z=y.g;y=y.ia,Z.L=1,Z.v=Dc(ra(H)),Z.m=null,Z.P=!0,Xe(Z,y)}t.Za=function(){this.C!=null&&(this.C=null,Qo(this),Pt(this),gt(19))};function Nr(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function kr(y,H){var Z=null;if(y.g==H){Nr(y),ir(y),y.g=null;var ke=2}else if(Jn(y.h,H))Z=H.D,DA(y.h,H),ke=1;else return;if(y.G!=0){if(H.o)if(ke==1){Z=H.m?H.m.length:0,H=Date.now()-H.F;var ft=y.B;ke=ar(),Le(ke,new Rt(ke,Z)),D(y)}else St(y);else if(ft=H.s,ft==3||ft==0&&0<H.X||!(ke==1&&le(y,H)||ke==2&&Pt(y)))switch(Z&&0<Z.length&&(H=y.h,H.i=H.i.concat(Z)),ft){case 1:gn(y,5);break;case 4:gn(y,10);break;case 3:gn(y,6);break;default:gn(y,2)}}}function Zr(y,H){let Z=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(Z*=2),Z*H}function gn(y,H){if(y.j.info("Error code "+H),H==2){var Z=f(y.fb,y),ke=y.Xa;const ft=!ke;ke=new Ln(ke||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Rc(ke,"https"),Dc(ke),ft?pm(ke.toString(),Z):gm(ke.toString(),Z)}else gt(2);y.G=0,y.l&&y.l.sa(H),ms(y),Sd(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function ms(y){if(y.G=0,y.ka=[],y.l){const H=Kn(y.h);(H.length!=0||y.i.length!=0)&&(x(y.ka,H),x(y.ka,y.i),y.h.i.length=0,p(y.i),y.i.length=0),y.l.ra()}}function yn(y,H,Z){var ke=Z instanceof Ln?ra(Z):new Ln(Z);if(ke.g!="")H&&(ke.g=H+"."+ke.g),LA(ke,ke.s);else{var ft=l.location;ke=ft.protocol,H=H?H+"."+ft.hostname:ft.hostname,ft=+ft.port;var bt=new Ln(null);ke&&Rc(bt,ke),H&&(bt.g=H),ft&&LA(bt,ft),Z&&(bt.l=Z),ke=bt}return Z=y.D,H=y.ya,Z&&H&&Yr(ke,Z,H),Yr(ke,"VER",y.la),tt(y,ke),ke}function _s(y,H,Z){if(H&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return H=y.Ca&&!y.pa?new jn(new OA({eb:Z})):new jn(y.pa),H.Ha(y.J),H}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ps(){}t=ps.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Es(){}Es.prototype.g=function(y,H){return new gs(y,H)};function gs(y,H){st.call(this),this.g=new Mo(H),this.l=y,this.h=H&&H.messageUrlParams||null,y=H&&H.messageHeaders||null,H&&H.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=H&&H.initMessageHeaders||null,H&&H.messageContentType&&(y?y["X-WebChannel-Content-Type"]=H.messageContentType:y={"X-WebChannel-Content-Type":H.messageContentType}),H&&H.va&&(y?y["X-WebChannel-Client-Profile"]=H.va:y={"X-WebChannel-Client-Profile":H.va}),this.g.S=y,(y=H&&H.Sb)&&!w(y)&&(this.g.m=y),this.v=H&&H.supportsCrossDomainXhr||!1,this.u=H&&H.sendRawJson||!1,(H=H&&H.httpSessionIdParam)&&!w(H)&&(this.g.D=H,y=this.h,y!==null&&H in y&&(y=this.h,H in y&&delete y[H])),this.j=new Ho(this)}m(gs,st),gs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gs.prototype.close=function(){VA(this.g)},gs.prototype.o=function(y){var H=this.g;if(typeof y=="string"){var Z={};Z.__data__=y,y=Z}else this.u&&(Z={},Z.__data__=ve(y),y=Z);H.i.push(new Tn(H.Ya++,y)),H.G==3&&D(H)},gs.prototype.N=function(){this.g.l=null,delete this.j,VA(this.g),delete this.g,gs.aa.N.call(this)};function Qi(y){ot.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var H=y.__sm__;if(H){e:{for(const Z in H){y=Z;break e}y=void 0}(this.i=y)&&(y=this.i,H=H!==null&&y in H?H[y]:void 0),this.data=H}else this.data=y}m(Qi,ot);function Vo(){wt.call(this),this.status=1}m(Vo,wt);function Ho(y){this.g=y}m(Ho,ps),Ho.prototype.ua=function(){Le(this.g,"a")},Ho.prototype.ta=function(y){Le(this.g,new Qi(y))},Ho.prototype.sa=function(y){Le(this.g,new Vo)},Ho.prototype.ra=function(){Le(this.g,"b")},Es.prototype.createWebChannel=Es.prototype.g,gs.prototype.send=gs.prototype.o,gs.prototype.open=gs.prototype.m,gs.prototype.close=gs.prototype.close,rU=function(){return new Es},tU=function(){return ar()},eU=Lt,E_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xe.NO_ERROR=0,xe.TIMEOUT=8,xe.HTTP_ERROR=6,sy=xe,Fe.COMPLETE="complete",ZL=Fe,nt.EventType=Nt,Nt.OPEN="a",Nt.CLOSE="b",Nt.ERROR="c",Nt.MESSAGE="d",st.prototype.listen=st.prototype.K,hp=nt,jn.prototype.listenOnce=jn.prototype.L,jn.prototype.getLastError=jn.prototype.Ka,jn.prototype.getLastErrorCode=jn.prototype.Ba,jn.prototype.getStatus=jn.prototype.Z,jn.prototype.getResponseJson=jn.prototype.Oa,jn.prototype.getResponseText=jn.prototype.oa,jn.prototype.send=jn.prototype.ea,jn.prototype.setWithCredentials=jn.prototype.Ha,YL=jn}).apply(typeof kv<"u"?kv:typeof self<"u"?self:typeof window<"u"?window:{});const xF="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Va.UNAUTHENTICATED=new Va(null),Va.GOOGLE_CREDENTIALS=new Va("google-credentials-uid"),Va.FIRST_PARTY=new Va("first-party-uid"),Va.MOCK_USER=new Va("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let em="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh=new QB("@firebase/firestore");function Uf(){return Bh.logLevel}function Ht(t,...e){if(Bh.logLevel<=rn.DEBUG){const r=e.map(rS);Bh.debug(`Firestore (${em}): ${t}`,...r)}}function ji(t,...e){if(Bh.logLevel<=rn.ERROR){const r=e.map(rS);Bh.error(`Firestore (${em}): ${t}`,...r)}}function ed(t,...e){if(Bh.logLevel<=rn.WARN){const r=e.map(rS);Bh.warn(`Firestore (${em}): ${t}`,...r)}}function rS(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t="Unexpected state"){const e=`FIRESTORE (${em}) INTERNAL ASSERTION FAILED: `+t;throw ji(e),new Error(e)}function pr(t,e){t||dr()}function Fr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Wt extends kA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Va.UNAUTHENTICATED))}shutdown(){}}class Lz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Uz{constructor(e){this.t=e,this.currentUser=Va.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){pr(this.o===void 0);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Ul;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ul,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Ht("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ht("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ul)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ht("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pr(typeof n.accessToken=="string"),new nU(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pr(e===null||typeof e=="string"),new Va(e)}}class Oz{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Va.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Mz{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Oz(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Va.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vz{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){pr(this.o===void 0);const n=a=>{a.error!=null&&Ht("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,Ht("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{Ht("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):Ht("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(pr(typeof r.token=="string"),this.R=r.token,new Qz(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=Hz(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%e.length))}return n}}function Rr(t,e){return t<e?-1:t>e?1:0}function j0(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}function aU(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Gt(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Rr(this.nanoseconds,e.nanoseconds):Rr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e){this.timestamp=e}static fromTimestamp(e){return new vr(e)}static min(){return new vr(new Gt(0,0))}static max(){return new vr(new Gt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,r,n){r===void 0?r=0:r>e.length&&dr(),n===void 0?n=e.length-r:n>e.length-r&&dr(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return kg.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof kg?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=e.get(s),o=r.get(s);if(a<o)return-1;if(a>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class pn extends kg{construct(e,r,n){return new pn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new pn(r)}static emptyPath(){return new pn([])}}const Kz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class us extends kg{construct(e,r,n){return new us(e,r,n)}static isValidIdentifier(e){return Kz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),us.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new us(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Wt(Bt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Wt(Bt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(a(),s++)}if(a(),o)throw new Wt(Bt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new us(r)}static emptyPath(){return new us([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.path=e}static fromPath(e){return new er(pn.fromString(e))}static fromName(e){return new er(pn.fromString(e).popFirst(5))}static empty(){return new er(pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new er(new pn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,r,n,s){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=s}}function B_(t){return t.fields.find(e=>e.kind===2)}function Kd(t){return t.fields.filter(e=>e.kind!==2)}Xy.UNKNOWN_ID=-1;class ay{constructor(e,r){this.fieldPath=e,this.kind=r}}class Tg{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new Tg(0,Fo.min())}}function qz(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=vr.fromTimestamp(n===1e9?new Gt(r+1,0):new Gt(r,n));return new Fo(s,er.empty(),e)}function iU(t){return new Fo(t.readTime,t.key,-1)}class Fo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Fo(vr.min(),er.empty(),-1)}static max(){return new Fo(vr.max(),er.empty(),-1)}}function sS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=er.comparator(t.documentKey,e.documentKey),r!==0?r:Rr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lU{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kh(t){if(t.code!==Bt.FAILED_PRECONDITION||t.message!==oU)throw t;Ht("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&dr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new yt((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof yt?r:yt.resolve(r)}catch(r){return yt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):yt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):yt.reject(r)}static resolve(e){return new yt((r,n)=>{r(e)})}static reject(e){return new yt((r,n)=>{n(e)})}static waitFor(e){return new yt((r,n)=>{let s=0,a=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++a,o&&a===s&&r()},c=>n(c))}),o=!0,a===s&&r()})}static or(e){let r=yt.resolve(!1);for(const n of e)r=r.next(s=>s?yt.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new yt((n,s)=>{const a=e.length,o=new Array(a);let l=0;for(let c=0;c<a;c++){const A=c;r(e[A]).next(u=>{o[A]=u,++l,l===a&&n(o)},u=>s(u))}})}static doWhile(e,r){return new yt((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new Ul,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new Up(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const s=aS(n.target.error);this.V.reject(new Up(e,s))}}static open(e,r,n,s){try{return new o2(r,e.transaction(s,n))}catch(a){throw new Up(r,a)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Ht("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new $z(r)}}class zu{constructor(e,r,n){this.name=e,this.version=r,this.p=n,zu.S(pa())===12.2&&ji("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Ht("SimpleDb","Removing database:",e),$d(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!AL())return!1;if(zu.v())return!0;const e=pa(),r=zu.S(e),n=0<r&&r<10,s=cU(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Ht("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const o=a.target.result;r(o)},s.onblocked=()=>{n(new Up(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const o=a.target.error;o.name==="VersionError"?n(new Wt(Bt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Wt(Bt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new Up(e,o))},s.onupgradeneeded=a=>{Ht("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.p.O(o,s.transaction,a.oldVersion,this.version).next(()=>{Ht("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,s){const a=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=o2.open(this.db,e,a?"readonly":"readwrite",n),c=s(l).next(A=>(l.g(),A)).catch(A=>(l.abort(A),yt.reject(A))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,A=c.name!=="FirebaseError"&&o<3;if(Ht("SimpleDb","Transaction failed with error:",c.message,"Retrying:",A),this.close(),!A)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cU(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Gz{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return $d(this.B.delete())}}class Up extends Wt{constructor(e,r){super(Bt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function xd(t){return t.name==="IndexedDbTransactionError"}class $z{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Ht("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Ht("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),$d(n)}add(e){return Ht("SimpleDb","ADD",this.store.name,e,e),$d(this.store.add(e))}get(e){return $d(this.store.get(e)).next(r=>(r===void 0&&(r=null),Ht("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Ht("SimpleDb","DELETE",this.store.name,e),$d(this.store.delete(e))}count(){return Ht("SimpleDb","COUNT",this.store.name),$d(this.store.count())}U(e,r){const n=this.options(e,r),s=n.index?this.store.index(n.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(n.range);return new yt((o,l)=>{a.onerror=c=>{l(c.target.error)},a.onsuccess=c=>{o(c.target.result)}})}{const a=this.cursor(n),o=[];return this.W(a,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new yt((s,a)=>{n.onerror=o=>{a(o.target.error)},n.onsuccess=o=>{s(o.target.result)}})}j(e,r){Ht("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const s=this.cursor(n);return this.W(s,(a,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const s=this.cursor(n);return this.W(s,r)}Y(e){const r=this.cursor({});return new yt((n,s)=>{r.onerror=a=>{const o=aS(a.target.error);s(o)},r.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new yt((s,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new Gz(l),A=r(l.primaryKey,l.value,c);if(A instanceof yt){const u=A.catch(d=>(c.done(),yt.reject(d)));n.push(u)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>yt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function $d(t){return new yt((e,r)=>{t.onsuccess=n=>{const s=n.target.result;e(s)},t.onerror=n=>{const s=aS(n.target.error);r(s)}})}let vF=!1;function aS(t){const e=zu.S(pa());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Wt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return vF||(vF=!0,setTimeout(()=>{throw n},0)),n}}return t}class zz{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Ht("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Ht("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){xd(r)?Ht("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Kh(r)}await this.X(6e4)})}}class Wz{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let s=r,a=!0;return yt.doWhile(()=>a===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Ht("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(l=>{s-=l,n.add(o)});a=!1})).next(()=>r-s)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(s=>this.localStore.localDocuments.getNextDocuments(e,r,s,n).next(a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,a)).next(l=>(Ht("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((s,a)=>{const o=iU(a);sS(o,n)>0&&(n=o)}),new Fo(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ol.oe=-1;function Ex(t){return t==null}function jg(t){return t===0&&1/t==-1/0}function Jz(t){return typeof t=="number"&&Number.isInteger(t)&&!jg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=yF(e)),e=Xz(t.get(r),e);return yF(e)}function Xz(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case"":r+="";break;default:r+=a}}return r}function yF(t){return t+""}function pc(t){const e=t.length;if(pr(e>=2),e===2)return pr(t.charAt(0)===""&&t.charAt(1)===""),pn.emptyPath();const r=e-2,n=[];let s="";for(let a=0;a<e;){const o=t.indexOf("",a);switch((o<0||o>r)&&dr(),t.charAt(o+1)){case"":const l=t.substring(a,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),n.push(c);break;case"":s+=t.substring(a,o),s+="\0";break;case"":s+=t.substring(a,o+1);break;default:dr()}a=o+2}return new pn(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t,e){return[t,Ri(e)]}function AU(t,e,r){return[t,Ri(e),r]}const Yz={},Zz=["prefixPath","collectionGroup","readTime","documentId"],eW=["prefixPath","collectionGroup","documentId"],tW=["collectionGroup","readTime","prefixPath","documentId"],rW=["canonicalId","targetId"],nW=["targetId","path"],sW=["path","targetId"],aW=["collectionId","parent"],iW=["indexId","uid"],oW=["uid","sequenceNumber"],lW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],cW=["indexId","uid","orderedDocumentKey"],AW=["userId","collectionPath","documentId"],uW=["userId","collectionPath","largestBatchId"],dW=["userId","collectionGroup","largestBatchId"],uU=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],hW=[...uU,"documentOverlays"],dU=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],hU=dU,iS=[...hU,"indexConfiguration","indexState","indexEntries"],fW=iS,mW=[...iS,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_ extends lU{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function xa(t,e){const r=Fr(t);return zu.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bF(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function qh(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function fU(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,r){this.comparator=e,this.root=r||Ha.EMPTY}insert(e,r){return new fs(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ha.BLACK,null,null))}remove(e){return new fs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ha.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tv(this.root,e,this.comparator,!0)}}class Tv{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ha{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??Ha.RED,this.left=s??Ha.EMPTY,this.right=a??Ha.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new Ha(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ha.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Ha.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ha.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ha.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dr();const e=this.left.check();if(e!==this.right.check())throw dr();return e+(this.isRed()?0:1)}}Ha.EMPTY=null,Ha.RED=!0,Ha.BLACK=!1;Ha.EMPTY=new class{constructor(){this.size=0}get key(){throw dr()}get value(){throw dr()}get color(){throw dr()}get left(){throw dr()}get right(){throw dr()}copy(e,r,n,s,a){return this}insert(e,r,n){return new Ha(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.comparator=e,this.data=new fs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new NF(this.data.getIterator())}getIteratorFrom(e){return new NF(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Dn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Dn(this.comparator);return r.data=e,r}}class NF{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function pf(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.fields=e,e.sort(us.comparator)}static empty(){return new Ji([])}unionWith(e){let r=new Dn(us.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ji(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return j0(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new mU("Invalid base64 string: "+a):a}}(e);return new zs(r)}static fromUint8Array(e){const r=function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a}(e);return new zs(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Rr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zs.EMPTY_BYTE_STRING=new zs("");const pW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function BA(t){if(pr(!!t),typeof t=="string"){let e=0;const r=pW.exec(t);if(pr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ls(t.seconds),nanos:ls(t.nanos)}}function ls(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function td(t){return typeof t=="string"?zs.fromBase64String(t):zs.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function lS(t){const e=t.mapValue.fields.__previous_value__;return oS(e)?lS(e):e}function Pg(t){const e=BA(t.mapValue.fields.__local_write_time__.timestampValue);return new Gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gW{constructor(e,r,n,s,a,o,l,c,A){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=A}}class rd{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new rd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof rd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},oy={nullValue:"NULL_VALUE"};function Sh(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oS(t)?4:pU(t)?9007199254740991:l2(t)?10:11:dr()}function Cc(t,e){if(t===e)return!0;const r=Sh(t);if(r!==Sh(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Pg(t).isEqual(Pg(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=BA(s.timestampValue),l=BA(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return td(s.bytesValue).isEqual(td(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return ls(s.geoPointValue.latitude)===ls(a.geoPointValue.latitude)&&ls(s.geoPointValue.longitude)===ls(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return ls(s.integerValue)===ls(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=ls(s.doubleValue),l=ls(a.doubleValue);return o===l?jg(o)===jg(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return j0(t.arrayValue.values||[],e.arrayValue.values||[],Cc);case 10:case 11:return function(s,a){const o=s.mapValue.fields||{},l=a.mapValue.fields||{};if(bF(o)!==bF(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Cc(o[c],l[c])))return!1;return!0}(t,e);default:return dr()}}function Rg(t,e){return(t.values||[]).find(r=>Cc(r,e))!==void 0}function nd(t,e){if(t===e)return 0;const r=Sh(t),n=Sh(e);if(r!==n)return Rr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return function(a,o){const l=ls(a.integerValue||a.doubleValue),c=ls(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return CF(t.timestampValue,e.timestampValue);case 4:return CF(Pg(t),Pg(e));case 5:return Rr(t.stringValue,e.stringValue);case 6:return function(a,o){const l=td(a),c=td(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const l=a.split("/"),c=o.split("/");for(let A=0;A<l.length&&A<c.length;A++){const u=Rr(l[A],c[A]);if(u!==0)return u}return Rr(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const l=Rr(ls(a.latitude),ls(o.latitude));return l!==0?l:Rr(ls(a.longitude),ls(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _F(t.arrayValue,e.arrayValue);case 10:return function(a,o){var l,c,A,u;const d=a.fields||{},f=o.fields||{},h=(l=d.value)===null||l===void 0?void 0:l.arrayValue,m=(c=f.value)===null||c===void 0?void 0:c.arrayValue,p=Rr(((A=h==null?void 0:h.values)===null||A===void 0?void 0:A.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:_F(h,m)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===Iu.mapValue&&o===Iu.mapValue)return 0;if(a===Iu.mapValue)return 1;if(o===Iu.mapValue)return-1;const l=a.fields||{},c=Object.keys(l),A=o.fields||{},u=Object.keys(A);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const f=Rr(c[d],u[d]);if(f!==0)return f;const h=nd(l[c[d]],A[u[d]]);if(h!==0)return h}return Rr(c.length,u.length)}(t.mapValue,e.mapValue);default:throw dr()}}function CF(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Rr(t,e);const r=BA(t),n=BA(e),s=Rr(r.seconds,n.seconds);return s!==0?s:Rr(r.nanos,n.nanos)}function _F(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=nd(r[s],n[s]);if(a)return a}return Rr(r.length,n.length)}function P0(t){return I_(t)}function I_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=BA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return td(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return er.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=I_(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const o of n)a?a=!1:s+=",",s+=`${o}:${I_(r.fields[o])}`;return s+"}"}(t.mapValue):dr()}function Dg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function F_(t){return!!t&&"integerValue"in t}function Lg(t){return!!t&&"arrayValue"in t}function EF(t){return!!t&&"nullValue"in t}function BF(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ly(t){return!!t&&"mapValue"in t}function l2(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Op(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return qh(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Op(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Op(t.arrayValue.values[r]);return e}return Object.assign({},t)}function pU(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const gU={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function xW(t){return"nullValue"in t?oy:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Dg(rd.empty(),er.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?l2(t)?gU:{mapValue:{}}:dr()}function vW(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Dg(rd.empty(),er.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gU:"mapValue"in t?l2(t)?{mapValue:{}}:Iu:dr()}function SF(t,e){const r=nd(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function IF(t,e){const r=nd(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e){this.value=e}static empty(){return new Ga({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ly(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Op(r)}setAll(e){let r=us.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=Op(o):s.push(l.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());ly(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Cc(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];ly(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){qh(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new Ga(Op(this.value))}}function xU(t){const e=[];return qh(t.fields,(r,n)=>{const s=new us([r]);if(ly(n)){const a=xU(n.mapValue).fields;if(a.length===0)e.push(s);else for(const o of a)e.push(s.child(o))}else e.push(s)}),new Ji(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,r,n,s,a,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new As(e,0,vr.min(),vr.min(),vr.min(),Ga.empty(),0)}static newFoundDocument(e,r,n,s){return new As(e,1,r,vr.min(),n,s,0)}static newNoDocument(e,r){return new As(e,2,r,vr.min(),vr.min(),Ga.empty(),0)}static newUnknownDocument(e,r){return new As(e,3,r,vr.min(),vr.min(),Ga.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(vr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ga.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ga.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof As&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new As(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,r){this.position=e,this.inclusive=r}}function FF(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],o=t.position[s];if(a.field.isKeyField()?n=er.comparator(er.fromName(o.referenceValue),r.key):n=nd(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function kF(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Cc(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,r="asc"){this.field=e,this.dir=r}}function yW(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{}class nn extends vU{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new wW(e,r,n):r==="array-contains"?new CW(e,n):r==="in"?new _U(e,n):r==="not-in"?new _W(e,n):r==="array-contains-any"?new EW(e,n):new nn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new bW(e,n):new NW(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(nd(r,this.value)):r!==null&&Sh(this.value)===Sh(r)&&this.matchesComparison(nd(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends vU{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new In(e,r)}matches(e){return D0(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function D0(t){return t.op==="and"}function k_(t){return t.op==="or"}function cS(t){return yU(t)&&D0(t)}function yU(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function T_(t){if(t instanceof nn)return t.field.canonicalString()+t.op.toString()+P0(t.value);if(cS(t))return t.filters.map(e=>T_(e)).join(",");{const e=t.filters.map(r=>T_(r)).join(",");return`${t.op}(${e})`}}function wU(t,e){return t instanceof nn?function(n,s){return s instanceof nn&&n.op===s.op&&n.field.isEqual(s.field)&&Cc(n.value,s.value)}(t,e):t instanceof In?function(n,s){return s instanceof In&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,o,l)=>a&&wU(o,s.filters[l]),!0):!1}(t,e):void dr()}function bU(t,e){const r=t.filters.concat(e);return In.create(r,t.op)}function NU(t){return t instanceof nn?function(r){return`${r.field.canonicalString()} ${r.op} ${P0(r.value)}`}(t):t instanceof In?function(r){return r.op.toString()+" {"+r.getFilters().map(NU).join(" ,")+"}"}(t):"Filter"}class wW extends nn{constructor(e,r,n){super(e,r,n),this.key=er.fromName(n.referenceValue)}matches(e){const r=er.comparator(e.key,this.key);return this.matchesComparison(r)}}class bW extends nn{constructor(e,r){super(e,"in",r),this.keys=CU("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class NW extends nn{constructor(e,r){super(e,"not-in",r),this.keys=CU("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function CU(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>er.fromName(n.referenceValue))}class CW extends nn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Lg(r)&&Rg(r.arrayValue,this.value)}}class _U extends nn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Rg(this.value.arrayValue,r)}}class _W extends nn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Rg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Rg(this.value.arrayValue,r)}}class EW extends nn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Lg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Rg(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BW{constructor(e,r=null,n=[],s=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=o,this.endAt=l,this.ue=null}}function j_(t,e=null,r=[],n=[],s=null,a=null,o=null){return new BW(t,e,r,n,s,a,o)}function Ih(t){const e=Fr(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>T_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Ex(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>P0(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>P0(n)).join(",")),e.ue=r}return e.ue}function Bx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!yW(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!wU(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!kF(t.startAt,e.startAt)&&kF(t.endAt,e.endAt)}function Yy(t){return er.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Zy(t,e){return t.filters.filter(r=>r instanceof nn&&r.field.isEqual(e))}function TF(t,e,r){let n=oy,s=!0;for(const a of Zy(t,e)){let o=oy,l=!0;switch(a.op){case"<":case"<=":o=xW(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,l=!1;break;case"!=":case"not-in":o=oy}SF({value:n,inclusive:s},{value:o,inclusive:l})<0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];SF({value:n,inclusive:s},{value:o,inclusive:r.inclusive})<0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}function jF(t,e,r){let n=Iu,s=!0;for(const a of Zy(t,e)){let o=Iu,l=!0;switch(a.op){case">=":case">":o=vW(a.value),l=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,l=!1;break;case"!=":case"not-in":o=Iu}IF({value:n,inclusive:s},{value:o,inclusive:l})>0&&(n=o,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=r.position[a];IF({value:n,inclusive:s},{value:o,inclusive:r.inclusive})>0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,r=null,n=[],s=[],a=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function SW(t,e,r,n,s,a,o,l){return new tm(t,e,r,n,s,a,o,l)}function Sx(t){return new tm(t)}function PF(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function EU(t){return t.collectionGroup!==null}function Mp(t){const e=Fr(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Dn(us.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(A=>{A.isInequality()&&(l=l.add(A.field))})}),l})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new Ug(a,n))}),r.has(us.keyField().canonicalString())||e.ce.push(new Ug(us.keyField(),n))}return e.ce}function ul(t){const e=Fr(t);return e.le||(e.le=IW(e,Mp(t))),e.le}function IW(t,e){if(t.limitType==="F")return j_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Ug(s.field,a)});const r=t.endAt?new R0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new R0(t.startAt.position,t.startAt.inclusive):null;return j_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function P_(t,e){const r=t.filters.concat([e]);return new tm(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function ew(t,e,r){return new tm(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function c2(t,e){return Bx(ul(t),ul(e))&&t.limitType===e.limitType}function BU(t){return`${Ih(ul(t))}|lt:${t.limitType}`}function Of(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>NU(s)).join(", ")}]`),Ex(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>P0(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>P0(s)).join(",")),`Target(${n})`}(ul(t))}; limitType=${t.limitType})`}function Ix(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):er.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of Mp(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,c){const A=FF(o,l,c);return o.inclusive?A<=0:A<0}(n.startAt,Mp(n),s)||n.endAt&&!function(o,l,c){const A=FF(o,l,c);return o.inclusive?A>=0:A>0}(n.endAt,Mp(n),s))}(t,e)}function FW(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function SU(t){return(e,r)=>{let n=!1;for(const s of Mp(t)){const a=kW(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function kW(t,e,r){const n=t.field.isKeyField()?er.comparator(e.key,r.key):function(a,o,l){const c=o.data.field(a),A=l.data.field(a);return c!==null&&A!==null?nd(c,A):dr()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return dr()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){qh(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return fU(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW=new fs(er.comparator);function Eo(){return TW}const IU=new fs(er.comparator);function fp(...t){let e=IU;for(const r of t)e=e.insert(r.key,r);return e}function FU(t){let e=IU;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function gc(){return Qp()}function kU(){return Qp()}function Qp(){return new vd(t=>t.toString(),(t,e)=>t.isEqual(e))}const jW=new fs(er.comparator),PW=new Dn(er.comparator);function Kr(...t){let e=PW;for(const r of t)e=e.add(r);return e}const RW=new Dn(Rr);function DW(){return RW}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jg(e)?"-0":e}}function TU(t){return{integerValue:""+t}}function LW(t,e){return Jz(e)?TU(e):AS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(){this._=void 0}}function UW(t,e,r){return t instanceof Og?function(s,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&oS(a)&&(a=lS(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(r,e):t instanceof L0?PU(t,e):t instanceof U0?RU(t,e):function(s,a){const o=jU(s,a),l=RF(o)+RF(s.Pe);return F_(o)&&F_(s.Pe)?TU(l):AS(s.serializer,l)}(t,e)}function OW(t,e,r){return t instanceof L0?PU(t,e):t instanceof U0?RU(t,e):r}function jU(t,e){return t instanceof Mg?function(n){return F_(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Og extends A2{}class L0 extends A2{constructor(e){super(),this.elements=e}}function PU(t,e){const r=DU(e);for(const n of t.elements)r.some(s=>Cc(s,n))||r.push(n);return{arrayValue:{values:r}}}class U0 extends A2{constructor(e){super(),this.elements=e}}function RU(t,e){let r=DU(e);for(const n of t.elements)r=r.filter(s=>!Cc(s,n));return{arrayValue:{values:r}}}class Mg extends A2{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function RF(t){return ls(t.integerValue||t.doubleValue)}function DU(t){return Lg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MW{constructor(e,r){this.field=e,this.transform=r}}function QW(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof L0&&s instanceof L0||n instanceof U0&&s instanceof U0?j0(n.elements,s.elements,Cc):n instanceof Mg&&s instanceof Mg?Cc(n.Pe,s.Pe):n instanceof Og&&s instanceof Og}(t.transform,e.transform)}class VW{constructor(e,r){this.version=e,this.transformResults=r}}class ds{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ds}static exists(e){return new ds(void 0,e)}static updateTime(e){return new ds(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cy(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class u2{}function LU(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new nm(t.key,ds.none()):new rm(t.key,t.data,ds.none());{const r=t.data,n=Ga.empty();let s=new Dn(us.comparator);for(let a of e.fields)if(!s.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),s=s.add(a)}return new TA(t.key,n,new Ji(s.toArray()),ds.none())}}function HW(t,e,r){t instanceof rm?function(s,a,o){const l=s.value.clone(),c=LF(s.fieldTransforms,a,o.transformResults);l.setAll(c),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof TA?function(s,a,o){if(!cy(s.precondition,a))return void a.convertToUnknownDocument(o.version);const l=LF(s.fieldTransforms,a,o.transformResults),c=a.data;c.setAll(UU(s)),c.setAll(l),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function Vp(t,e,r,n){return t instanceof rm?function(a,o,l,c){if(!cy(a.precondition,o))return l;const A=a.value.clone(),u=UF(a.fieldTransforms,c,o);return A.setAll(u),o.convertToFoundDocument(o.version,A).setHasLocalMutations(),null}(t,e,r,n):t instanceof TA?function(a,o,l,c){if(!cy(a.precondition,o))return l;const A=UF(a.fieldTransforms,c,o),u=o.data;return u.setAll(UU(a)),u.setAll(A),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(a,o,l){return cy(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function KW(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=jU(n.transform,s||null);a!=null&&(r===null&&(r=Ga.empty()),r.set(n.field,a))}return r||null}function DF(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&j0(n,s,(a,o)=>QW(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class rm extends u2{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class TA extends u2{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function UU(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function LF(t,e,r){const n=new Map;pr(t.length===r.length);for(let s=0;s<r.length;s++){const a=t[s],o=a.transform,l=e.data.field(a.field);n.set(a.field,OW(o,l,r[s]))}return n}function UF(t,e,r){const n=new Map;for(const s of t){const a=s.transform,o=r.data.field(s.field);n.set(s.field,UW(a,o,e))}return n}class nm extends u2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uS extends u2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&HW(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Vp(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Vp(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=kU();return this.mutations.forEach(s=>{const a=e.get(s.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=r.has(s.key)?null:l;const c=LU(o,l);c!==null&&n.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(vr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Kr())}isEqual(e){return this.batchId===e.batchId&&j0(this.mutations,e.mutations,(r,n)=>DF(r,n))&&j0(this.baseMutations,e.baseMutations,(r,n)=>DF(r,n))}}class hS{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){pr(e.mutations.length===n.length);let s=function(){return jW}();const a=e.mutations;for(let o=0;o<a.length;o++)s=s.insert(a[o].key,n[o].version);return new hS(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qW{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xs,ln;function OU(t){switch(t){default:return dr();case Bt.CANCELLED:case Bt.UNKNOWN:case Bt.DEADLINE_EXCEEDED:case Bt.RESOURCE_EXHAUSTED:case Bt.INTERNAL:case Bt.UNAVAILABLE:case Bt.UNAUTHENTICATED:return!1;case Bt.INVALID_ARGUMENT:case Bt.NOT_FOUND:case Bt.ALREADY_EXISTS:case Bt.PERMISSION_DENIED:case Bt.FAILED_PRECONDITION:case Bt.ABORTED:case Bt.OUT_OF_RANGE:case Bt.UNIMPLEMENTED:case Bt.DATA_LOSS:return!0}}function MU(t){if(t===void 0)return ji("GRPC error has no .code"),Bt.UNKNOWN;switch(t){case Xs.OK:return Bt.OK;case Xs.CANCELLED:return Bt.CANCELLED;case Xs.UNKNOWN:return Bt.UNKNOWN;case Xs.DEADLINE_EXCEEDED:return Bt.DEADLINE_EXCEEDED;case Xs.RESOURCE_EXHAUSTED:return Bt.RESOURCE_EXHAUSTED;case Xs.INTERNAL:return Bt.INTERNAL;case Xs.UNAVAILABLE:return Bt.UNAVAILABLE;case Xs.UNAUTHENTICATED:return Bt.UNAUTHENTICATED;case Xs.INVALID_ARGUMENT:return Bt.INVALID_ARGUMENT;case Xs.NOT_FOUND:return Bt.NOT_FOUND;case Xs.ALREADY_EXISTS:return Bt.ALREADY_EXISTS;case Xs.PERMISSION_DENIED:return Bt.PERMISSION_DENIED;case Xs.FAILED_PRECONDITION:return Bt.FAILED_PRECONDITION;case Xs.ABORTED:return Bt.ABORTED;case Xs.OUT_OF_RANGE:return Bt.OUT_OF_RANGE;case Xs.UNIMPLEMENTED:return Bt.UNIMPLEMENTED;case Xs.DATA_LOSS:return Bt.DATA_LOSS;default:return dr()}}(ln=Xs||(Xs={}))[ln.OK=0]="OK",ln[ln.CANCELLED=1]="CANCELLED",ln[ln.UNKNOWN=2]="UNKNOWN",ln[ln.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ln[ln.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ln[ln.NOT_FOUND=5]="NOT_FOUND",ln[ln.ALREADY_EXISTS=6]="ALREADY_EXISTS",ln[ln.PERMISSION_DENIED=7]="PERMISSION_DENIED",ln[ln.UNAUTHENTICATED=16]="UNAUTHENTICATED",ln[ln.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ln[ln.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ln[ln.ABORTED=10]="ABORTED",ln[ln.OUT_OF_RANGE=11]="OUT_OF_RANGE",ln[ln.UNIMPLEMENTED=12]="UNIMPLEMENTED",ln[ln.INTERNAL=13]="INTERNAL",ln[ln.UNAVAILABLE=14]="UNAVAILABLE",ln[ln.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GW(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=new lh([4294967295,4294967295],0);function OF(t){const e=GW().encode(t),r=new XL;return r.update(e),new Uint8Array(r.digest())}function MF(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new lh([r,n],0),new lh([s,a],0)]}class mS{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new mp(`Invalid padding: ${r}`);if(n<0)throw new mp(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new mp(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new mp(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=lh.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(lh.fromNumber(n)));return s.compare($W)===1&&(s=new lh([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=OF(e),[n,s]=MF(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,s,a);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new mS(a,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=OF(e),[n,s]=MF(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,s,a);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class mp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Fx.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new d2(vr.min(),s,new fs(Rr),Eo(),Kr())}}class Fx{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Fx(n,r,Kr(),Kr(),Kr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class QU{constructor(e,r){this.targetId=e,this.me=r}}class VU{constructor(e,r,n=zs.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class QF{constructor(){this.fe=0,this.ge=HF(),this.pe=zs.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Kr(),r=Kr(),n=Kr();return this.ge.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:dr()}}),new Fx(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=HF()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,pr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class zW{constructor(e){this.Le=e,this.Be=new Map,this.ke=Eo(),this.qe=VF(),this.Qe=new fs(Rr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:dr()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const a=s.target;if(Yy(a))if(n===0){const o=new er(a.path);this.Ue(r,o,As.newNoDocument(o,vr.min()))}else pr(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const A=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,A)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let o,l;try{o=td(n).toUint8Array()}catch(c){if(c instanceof mU)return ed("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new mS(o,s,a)}catch(c){return ed(c instanceof mp?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,a,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((a,o)=>{const l=this.Je(o);if(l){if(a.current&&Yy(l.target)){const c=new er(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,As.newNoDocument(c,e))}a.be&&(r.set(o,a.ve()),a.Ce())}});let n=Kr();this.qe.forEach((a,o)=>{let l=!0;o.forEachWhile(c=>{const A=this.Je(c);return!A||A.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const s=new d2(e,r,this.Qe,this.ke,n);return this.ke=Eo(),this.qe=VF(),this.Qe=new fs(Rr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new QF,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Dn(Rr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ht("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new QF),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function VF(){return new fs(er.comparator)}function HF(){return new fs(er.comparator)}const WW={asc:"ASCENDING",desc:"DESCENDING"},JW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XW={and:"AND",or:"OR"};class YW{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function R_(t,e){return t.useProto3Json||Ex(e)?e:{value:e}}function O0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function HU(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ZW(t,e){return O0(t,e.toTimestamp())}function Ia(t){return pr(!!t),vr.fromTimestamp(function(r){const n=BA(r);return new Gt(n.seconds,n.nanos)}(t))}function pS(t,e){return D_(t,e).canonicalString()}function D_(t,e){const r=function(s){return new pn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function KU(t){const e=pn.fromString(t);return pr(ZU(e)),e}function Qg(t,e){return pS(t.databaseId,e.path)}function hA(t,e){const r=KU(e);if(r.get(1)!==t.databaseId.projectId)throw new Wt(Bt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Wt(Bt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new er($U(r))}function qU(t,e){return pS(t.databaseId,e)}function GU(t){const e=KU(t);return e.length===4?pn.emptyPath():$U(e)}function L_(t){return new pn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $U(t){return pr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function KF(t,e,r){return{name:Qg(t,e),fields:r.value.mapValue.fields}}function eJ(t,e,r){const n=hA(t,e.name),s=Ia(e.updateTime),a=e.createTime?Ia(e.createTime):vr.min(),o=new Ga({mapValue:{fields:e.fields}}),l=As.newFoundDocument(n,s,a,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function tJ(t,e){return"found"in e?function(n,s){pr(!!s.found),s.found.name,s.found.updateTime;const a=hA(n,s.found.name),o=Ia(s.found.updateTime),l=s.found.createTime?Ia(s.found.createTime):vr.min(),c=new Ga({mapValue:{fields:s.found.fields}});return As.newFoundDocument(a,o,l,c)}(t,e):"missing"in e?function(n,s){pr(!!s.missing),pr(!!s.readTime);const a=hA(n,s.missing),o=Ia(s.readTime);return As.newNoDocument(a,o)}(t,e):dr()}function rJ(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(A){return A==="NO_CHANGE"?0:A==="ADD"?1:A==="REMOVE"?2:A==="CURRENT"?3:A==="RESET"?4:dr()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(A,u){return A.useProto3Json?(pr(u===void 0||typeof u=="string"),zs.fromBase64String(u||"")):(pr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),zs.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(A){const u=A.code===void 0?Bt.UNKNOWN:MU(A.code);return new Wt(u,A.message||"")}(o);r=new VU(n,s,a,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=hA(t,n.document.name),a=Ia(n.document.updateTime),o=n.document.createTime?Ia(n.document.createTime):vr.min(),l=new Ga({mapValue:{fields:n.document.fields}}),c=As.newFoundDocument(s,a,o,l),A=n.targetIds||[],u=n.removedTargetIds||[];r=new Ay(A,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=hA(t,n.document),a=n.readTime?Ia(n.readTime):vr.min(),o=As.newNoDocument(s,a),l=n.removedTargetIds||[];r=new Ay([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=hA(t,n.document),a=n.removedTargetIds||[];r=new Ay([],a,s,null)}else{if(!("filter"in e))return dr();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,o=new qW(s,a),l=n.targetId;r=new QU(l,o)}}return r}function Vg(t,e){let r;if(e instanceof rm)r={update:KF(t,e.key,e.value)};else if(e instanceof nm)r={delete:Qg(t,e.key)};else if(e instanceof TA)r={update:KF(t,e.key,e.data),updateMask:lJ(e.fieldMask)};else{if(!(e instanceof uS))return dr();r={verify:Qg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const l=o.transform;if(l instanceof Og)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof L0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof U0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Mg)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw dr()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:ZW(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:dr()}(t,e.precondition)),r}function U_(t,e){const r=e.currentDocument?function(a){return a.updateTime!==void 0?ds.updateTime(Ia(a.updateTime)):a.exists!==void 0?ds.exists(a.exists):ds.none()}(e.currentDocument):ds.none(),n=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)pr(l.setToServerValue==="REQUEST_TIME"),c=new Og;else if("appendMissingElements"in l){const u=l.appendMissingElements.values||[];c=new L0(u)}else if("removeAllFromArray"in l){const u=l.removeAllFromArray.values||[];c=new U0(u)}else"increment"in l?c=new Mg(o,l.increment):dr();const A=us.fromServerFormat(l.fieldPath);return new MW(A,c)}(t,s)):[];if(e.update){e.update.name;const s=hA(t,e.update.name),a=new Ga({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const A=c.fieldPaths||[];return new Ji(A.map(u=>us.fromServerFormat(u)))}(e.updateMask);return new TA(s,a,o,r,n)}return new rm(s,a,r,n)}if(e.delete){const s=hA(t,e.delete);return new nm(s,r)}if(e.verify){const s=hA(t,e.verify);return new uS(s,r)}return dr()}function nJ(t,e){return t&&t.length>0?(pr(e!==void 0),t.map(r=>function(s,a){let o=s.updateTime?Ia(s.updateTime):Ia(a);return o.isEqual(vr.min())&&(o=Ia(a)),new VW(o,s.transformResults||[])}(r,e))):[]}function zU(t,e){return{documents:[qU(t,e.path)]}}function WU(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=qU(t,s);const a=function(A){if(A.length!==0)return YU(In.create(A,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(A){if(A.length!==0)return A.map(u=>function(f){return{field:Mf(f.field),direction:aJ(f.dir)}}(u))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=R_(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(A){return{before:A.inclusive,values:A.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(A){return{before:!A.inclusive,values:A.position}}(e.endAt)),{_t:r,parent:s}}function JU(t){let e=GU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){pr(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(d){const f=XU(d);return f instanceof In&&cS(f)?f.getFilters():[f]}(r.where));let o=[];r.orderBy&&(o=function(d){return d.map(f=>function(m){return new Ug(Qf(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(r.orderBy));let l=null;r.limit&&(l=function(d){let f;return f=typeof d=="object"?d.value:d,Ex(f)?null:f}(r.limit));let c=null;r.startAt&&(c=function(d){const f=!!d.before,h=d.values||[];return new R0(h,f)}(r.startAt));let A=null;return r.endAt&&(A=function(d){const f=!d.before,h=d.values||[];return new R0(h,f)}(r.endAt)),SW(e,s,o,a,l,"F",c,A)}function sJ(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dr()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function XU(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Qf(r.unaryFilter.field);return nn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Qf(r.unaryFilter.field);return nn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Qf(r.unaryFilter.field);return nn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Qf(r.unaryFilter.field);return nn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return dr()}}(t):t.fieldFilter!==void 0?function(r){return nn.create(Qf(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dr()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return In.create(r.compositeFilter.filters.map(n=>XU(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return dr()}}(r.compositeFilter.op))}(t):dr()}function aJ(t){return WW[t]}function iJ(t){return JW[t]}function oJ(t){return XW[t]}function Mf(t){return{fieldPath:t.canonicalString()}}function Qf(t){return us.fromServerFormat(t.fieldPath)}function YU(t){return t instanceof nn?function(r){if(r.op==="=="){if(BF(r.value))return{unaryFilter:{field:Mf(r.field),op:"IS_NAN"}};if(EF(r.value))return{unaryFilter:{field:Mf(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(BF(r.value))return{unaryFilter:{field:Mf(r.field),op:"IS_NOT_NAN"}};if(EF(r.value))return{unaryFilter:{field:Mf(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mf(r.field),op:iJ(r.op),value:r.value}}}(t):t instanceof In?function(r){const n=r.getFilters().map(s=>YU(s));return n.length===1?n[0]:{compositeFilter:{op:oJ(r.op),filters:n}}}(t):dr()}function lJ(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function ZU(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e,r,n,s,a=vr.min(),o=vr.min(),l=zs.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new lA(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new lA(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new lA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new lA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e){this.ct=e}}function cJ(t,e){let r;if(e.document)r=eJ(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=er.fromSegments(e.noDocument.path),s=kh(e.noDocument.readTime);r=As.newNoDocument(n,s),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return dr();{const n=er.fromSegments(e.unknownDocument.path),s=kh(e.unknownDocument.version);r=As.newUnknownDocument(n,s)}}return e.readTime&&r.setReadTime(function(s){const a=new Gt(s[0],s[1]);return vr.fromTimestamp(a)}(e.readTime)),r}function qF(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:tw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,o){return{name:Qg(a,o.key),fields:o.data.value.mapValue.fields,updateTime:O0(a,o.version.toTimestamp()),createTime:O0(a,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:Fh(e.version)};else{if(!e.isUnknownDocument())return dr();n.unknownDocument={path:r.path.toArray(),version:Fh(e.version)}}return n}function tw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Fh(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function kh(t){const e=new Gt(t.seconds,t.nanoseconds);return vr.fromTimestamp(e)}function zd(t,e){const r=(e.baseMutations||[]).map(a=>U_(t.ct,a));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const l=e.mutations[a+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>U_(t.ct,a)),s=Gt.fromMillis(e.localWriteTimeMs);return new dS(e.batchId,s,r,n)}function pp(t){const e=kh(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?kh(t.lastLimboFreeSnapshotVersion):vr.min();let n;return n=function(a){return a.documents!==void 0}(t.query)?function(a){return pr(a.documents.length===1),ul(Sx(GU(a.documents[0])))}(t.query):function(a){return ul(JU(a))}(t.query),new lA(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,zs.fromBase64String(t.resumeToken))}function t6(t,e){const r=Fh(e.snapshotVersion),n=Fh(e.lastLimboFreeSnapshotVersion);let s;s=Yy(e.target)?zU(t.ct,e.target):WU(t.ct,e.target)._t;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ih(e.target),readTime:r,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:s}}function r6(t){const e=JU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ew(e,e.limit,"L"):e}function Yb(t,e){return new fS(e.largestBatchId,U_(t.ct,e.overlayMutation))}function GF(t,e){const r=e.path.lastSegment();return[t,Ri(e.path.popLast()),r]}function $F(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:Fh(n.readTime),documentKey:Ri(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AJ{getBundleMetadata(e,r){return zF(e).get(r).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:kh(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,r){return zF(e).put(function(s){return{bundleId:s.id,createTime:Fh(Ia(s.createTime)),version:s.version}}(r))}getNamedQuery(e,r){return WF(e).get(r).next(n=>{if(n)return function(a){return{name:a.name,query:r6(a.bundledQuery),readTime:kh(a.readTime)}}(n)})}saveNamedQuery(e,r){return WF(e).put(function(s){return{name:s.name,readTime:Fh(Ia(s.readTime)),bundledQuery:s.bundledQuery}}(r))}}function zF(t){return xa(t,"bundles")}function WF(t){return xa(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new h2(e,n)}getOverlay(e,r){return Vm(e).get(GF(this.userId,r)).next(n=>n?Yb(this.serializer,n):null)}getOverlays(e,r){const n=gc();return yt.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){const s=[];return n.forEach((a,o)=>{const l=new fS(r,o);s.push(this.ht(e,l))}),yt.waitFor(s)}removeOverlaysForBatchId(e,r,n){const s=new Set;r.forEach(o=>s.add(Ri(o.getCollectionPath())));const a=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);a.push(Vm(e).j("collectionPathOverlayIndex",l))}),yt.waitFor(a)}getOverlaysForCollection(e,r,n){const s=gc(),a=Ri(r),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Vm(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const A=Yb(this.serializer,c);s.set(A.getKey(),A)}return s})}getOverlaysForCollectionGroup(e,r,n,s){const a=gc();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return Vm(e).J({index:"collectionGroupOverlayIndex",range:l},(c,A,u)=>{const d=Yb(this.serializer,A);a.size()<s||d.largestBatchId===o?(a.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>a)}ht(e,r){return Vm(e).put(function(s,a,o){const[l,c,A]=GF(a,o.mutation.key);return{userId:a,collectionPath:c,documentId:A,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Vg(s.ct,o.mutation)}}(this.serializer,this.userId,r))}}function Vm(t){return xa(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uJ{Pt(e){return xa(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?zs.fromUint8Array(n):zs.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(ls(e.integerValue));else if("doubleValue"in e){const n=ls(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),jg(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=BA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(td(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?pU(e)?this.dt(r,Number.MAX_SAFE_INTEGER):l2(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):dr()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const s of Object.keys(n))this.Vt(s,r),this.Tt(n[s],r)}wt(e,r){var n,s;const a=e.fields||{};this.dt(r,53);const o="value",l=((s=(n=a[o].arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.length)||0;this.dt(r,15),r.At(ls(l)),this.Vt(o,r),this.Tt(a[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const s of n)this.Tt(s,r)}yt(e,r){this.dt(r,37),er.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}Wd.vt=new Wd;function dJ(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function JF(t){const e=64-function(n){let s=0;for(let a=0;a<8;++a){const o=dJ(255&n[a]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class hJ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const s=r.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const s=r.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const r=this.qt(e),n=JF(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=255&r[s]}Kt(e){const r=this.qt(e),n=JF(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=~(255&r[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let s=1;s<r.length;++s)r[s]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const s=new Uint8Array(n);s.set(this.buffer),this.buffer=s}}class fJ{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class mJ{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Hm{constructor(){this.jt=new hJ,this.Ht=new fJ(this.jt),this.Jt=new mJ(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,r,n,s){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=s}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Jd(this.indexId,this.documentKey,this.arrayValue,n)}}function su(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=XF(t.arrayValue,e.arrayValue),r!==0?r:(r=XF(t.directionalValue,e.directionalValue),r!==0?r:er.comparator(t.documentKey,e.documentKey)))}function XF(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e){this.Xt=new Dn((r,n)=>us.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(pr(e.collectionGroup===this.collectionId),this.nn)return!1;const r=B_(e);if(r!==void 0&&!this.sn(r))return!1;const n=Kd(e);let s=new Set,a=0,o=0;for(;a<n.length&&this.sn(n[a]);++a)s=s.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=n[a];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++a}for(;a<n.length;++a){const l=n[a];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Dn(us.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new ay(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new ay(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new ay(n.field,n.dir==="asc"?0:1)));return new Xy(Xy.UNKNOWN_ID,this.collectionId,r,Tg.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){var e,r;if(pr(t instanceof nn||t instanceof In),t instanceof nn){if(t instanceof _U){const s=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(a=>nn.create(t.field,"==",a)))||[];return In.create(s,"or")}return t}const n=t.filters.map(s=>n6(s));return In.create(n,t.op)}function pJ(t){if(t.getFilters().length===0)return[];const e=Q_(n6(t));return pr(s6(e)),O_(e)||M_(e)?[e]:e.getFilters()}function O_(t){return t instanceof nn}function M_(t){return t instanceof In&&cS(t)}function s6(t){return O_(t)||M_(t)||function(r){if(r instanceof In&&k_(r)){for(const n of r.getFilters())if(!O_(n)&&!M_(n))return!1;return!0}return!1}(t)}function Q_(t){if(pr(t instanceof nn||t instanceof In),t instanceof nn)return t;if(t.filters.length===1)return Q_(t.filters[0]);const e=t.filters.map(n=>Q_(n));let r=In.create(e,t.op);return r=rw(r),s6(r)?r:(pr(r instanceof In),pr(D0(r)),pr(r.filters.length>1),r.filters.reduce((n,s)=>gS(n,s)))}function gS(t,e){let r;return pr(t instanceof nn||t instanceof In),pr(e instanceof nn||e instanceof In),r=t instanceof nn?e instanceof nn?function(s,a){return In.create([s,a],"and")}(t,e):ZF(t,e):e instanceof nn?ZF(e,t):function(s,a){if(pr(s.filters.length>0&&a.filters.length>0),D0(s)&&D0(a))return bU(s,a.getFilters());const o=k_(s)?s:a,l=k_(s)?a:s,c=o.filters.map(A=>gS(A,l));return In.create(c,"or")}(t,e),rw(r)}function ZF(t,e){if(D0(e))return bU(e,t.getFilters());{const r=e.filters.map(n=>gS(t,n));return In.create(r,"or")}}function rw(t){if(pr(t instanceof nn||t instanceof In),t instanceof nn)return t;const e=t.getFilters();if(e.length===1)return rw(e[0]);if(yU(t))return t;const r=e.map(s=>rw(s)),n=[];return r.forEach(s=>{s instanceof nn?n.push(s):s instanceof In&&(s.op===t.op?n.push(...s.filters):n.push(s))}),n.length===1?n[0]:In.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gJ{constructor(){this.un=new xS}addToCollectionParentIndex(e,r){return this.un.add(r),yt.resolve()}getCollectionParents(e,r){return yt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return yt.resolve()}deleteFieldIndex(e,r){return yt.resolve()}deleteAllFieldIndexes(e){return yt.resolve()}createTargetIndexes(e,r){return yt.resolve()}getDocumentsMatchingTarget(e,r){return yt.resolve(null)}getIndexType(e,r){return yt.resolve(0)}getFieldIndexes(e,r){return yt.resolve([])}getNextCollectionGroupToUpdate(e){return yt.resolve(null)}getMinOffset(e,r){return yt.resolve(Fo.min())}getMinOffsetFromCollectionGroup(e,r){return yt.resolve(Fo.min())}updateCollectionGroup(e,r,n){return yt.resolve()}updateIndexEntries(e,r){return yt.resolve()}}class xS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Dn(pn.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Dn(pn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv=new Uint8Array(0);class xJ{constructor(e,r){this.databaseId=r,this.cn=new xS,this.ln=new vd(n=>Ih(n),(n,s)=>Bx(n,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),s=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const a={collectionId:n,parent:Ri(s)};return ek(e).put(a)}return yt.resolve()}getCollectionParents(e,r){const n=[],s=IDBKeyRange.bound([r,""],[aU(r),""],!1,!0);return ek(e).U(s).next(a=>{for(const o of a){if(o.collectionId!==r)break;n.push(pc(o.parent))}return n})}addFieldIndex(e,r){const n=Km(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete s.indexId;const a=n.add(s);if(r.indexState){const o=xf(e);return a.next(l=>{o.put($F(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return a.next()}deleteFieldIndex(e,r){const n=Km(e),s=xf(e),a=gf(e);return n.delete(r.indexId).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=Km(e),n=gf(e),s=xf(e);return r.j().next(()=>n.j()).next(()=>s.j())}createTargetIndexes(e,r){return yt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(s=>{if(s===0||s===1){const a=new YF(n).an();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,r){const n=gf(e);let s=!0;const a=new Map;return yt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{s&&(s=!!l),a.set(o,l)})).next(()=>{if(s){let o=Kr();const l=[];return yt.forEach(a,(c,A)=>{Ht("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`}(c)} to execute ${Ih(r)}`);const u=function(b,k){const P=B_(k);if(P===void 0)return null;for(const L of Zy(b,P.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(A,c),d=function(b,k){const P=new Map;for(const L of Kd(k))for(const E of Zy(b,L.fieldPath))switch(E.op){case"==":case"in":P.set(L.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return P.set(L.fieldPath.canonicalString(),E.value),Array.from(P.values())}return null}(A,c),f=function(b,k){const P=[];let L=!0;for(const E of Kd(k)){const _=E.kind===0?TF(b,E.fieldPath,b.startAt):jF(b,E.fieldPath,b.startAt);P.push(_.value),L&&(L=_.inclusive)}return new R0(P,L)}(A,c),h=function(b,k){const P=[];let L=!0;for(const E of Kd(k)){const _=E.kind===0?jF(b,E.fieldPath,b.endAt):TF(b,E.fieldPath,b.endAt);P.push(_.value),L&&(L=_.inclusive)}return new R0(P,L)}(A,c),m=this.In(c,A,f),p=this.In(c,A,h),x=this.Tn(c,A,d),g=this.En(c.indexId,u,m,f.inclusive,p,h.inclusive,x);return yt.forEach(g,w=>n.G(w,r.limit).next(b=>{b.forEach(k=>{const P=er.fromSegments(k.documentKey);o.has(P)||(o=o.add(P),l.push(P))})}))}).next(()=>l)}return yt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=pJ(In.create(e.filters,"and")).map(n=>j_(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,s,a,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,a.length),A=c/(r!=null?r.length:1),u=[];for(let d=0;d<c;++d){const f=r?this.dn(r[d/A]):jv,h=this.An(e,f,n[d%A],s),m=this.Rn(e,f,a[d%A],o),p=l.map(x=>this.An(e,f,x,!0));u.push(...this.createRange(h,m,p))}return u}An(e,r,n,s){const a=new Jd(e,er.empty(),r,n);return s?a:a.Zt()}Rn(e,r,n,s){const a=new Jd(e,er.empty(),r,n);return s?a.Zt():a}Pn(e,r){const n=new YF(r),s=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,s).next(a=>{let o=null;for(const l of a)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const s=this.hn(r);return yt.forEach(s,a=>this.Pn(e,a).next(o=>{o?n!==0&&o.fields.length<function(c){let A=new Dn(us.comparator),u=!1;for(const d of c.filters)for(const f of d.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:A=A.add(f.field));for(const d of c.orderBy)d.field.isKeyField()||(A=A.add(d.field));return A.size+(u?1:0)}(a)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&s.length>1&&n===2?1:n)}Vn(e,r){const n=new Hm;for(const s of Kd(e)){const a=r.data.field(s.fieldPath);if(a==null)return null;const o=n.Yt(s.kind);Wd.vt.It(a,o)}return n.zt()}dn(e){const r=new Hm;return Wd.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new Hm;return Wd.vt.It(Dg(this.databaseId,r),n.Yt(function(a){const o=Kd(a);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let s=[];s.push(new Hm);let a=0;for(const o of Kd(e)){const l=n[a++];for(const c of s)if(this.fn(r,o.fieldPath)&&Lg(l))s=this.gn(s,o,l);else{const A=c.Yt(o.kind);Wd.vt.It(l,A)}}return this.pn(s)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const s=[...e],a=[];for(const o of n.arrayValue.values||[])for(const l of s){const c=new Hm;c.seed(l.zt()),Wd.vt.It(o,c.Yt(r.kind)),a.push(c)}return a}fn(e,r){return!!e.filters.find(n=>n instanceof nn&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=Km(e),s=xf(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(a=>{const o=[];return yt.forEach(a,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(u,d){const f=d?new Tg(d.sequenceNumber,new Fo(kh(d.readTime),new er(pc(d.documentKey)),d.largestBatchId)):Tg.empty(),h=u.fields.map(([m,p])=>new ay(us.fromServerFormat(m),p));return new Xy(u.indexId,u.collectionGroup,h,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,s)=>{const a=n.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:Rr(n.collectionGroup,s.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const s=Km(e),a=xf(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>yt.forEach(l,c=>a.put($F(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return yt.forEach(r,(s,a)=>{const o=n.get(s.collectionGroup);return(o?yt.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(n.set(s.collectionGroup,l),yt.forEach(l,c=>this.wn(e,s,c).next(A=>{const u=this.Sn(a,c);return A.isEqual(u)?yt.resolve():this.bn(e,a,c,A,u)}))))})}Dn(e,r,n,s){return gf(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,s){return gf(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const s=gf(e);let a=new Dn(su);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{a=a.add(new Jd(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>a)}Sn(e,r){let n=new Dn(su);const s=this.Vn(r,e);if(s==null)return n;const a=B_(r);if(a!=null){const o=e.data.field(a.fieldPath);if(Lg(o))for(const l of o.arrayValue.values||[])n=n.add(new Jd(r.indexId,e.key,this.dn(l),s))}else n=n.add(new Jd(r.indexId,e.key,jv,s));return n}bn(e,r,n,s,a){Ht("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,A,u,d,f){const h=c.getIterator(),m=A.getIterator();let p=pf(h),x=pf(m);for(;p||x;){let g=!1,w=!1;if(p&&x){const b=u(p,x);b<0?w=!0:b>0&&(g=!0)}else p!=null?w=!0:g=!0;g?(d(x),x=pf(m)):w?(f(p),p=pf(h)):(p=pf(h),x=pf(m))}}(s,a,su,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),yt.waitFor(o)}yn(e){let r=1;return xf(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,s,a)=>{a.done(),r=s.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>su(o,l)).filter((o,l,c)=>!l||su(o,c[l-1])!==0);const s=[];s.push(e);for(const o of n){const l=su(o,e),c=su(o,r);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(r);const a=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const l=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,jv,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,jv,[]];a.push(IDBKeyRange.bound(l,c))}return a}Cn(e,r){return su(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(tk)}getMinOffset(e,r){return yt.mapArray(this.hn(r),n=>this.Pn(e,n).next(s=>s||dr())).next(tk)}}function ek(t){return xa(t,"collectionParents")}function gf(t){return xa(t,"indexEntries")}function Km(t){return xa(t,"indexConfiguration")}function xf(t){return xa(t,"indexState")}function tk(t){pr(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const s=t[n].indexState.offset;sS(s,e)<0&&(e=s),r<s.largestBatchId&&(r=s.largestBatchId)}return new Fo(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Gi{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Gi(e,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a6(t,e,r){const n=t.store("mutations"),s=t.store("documentMutations"),a=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(u,d,f)=>(l++,f.delete()));a.push(c.next(()=>{pr(l===1)}));const A=[];for(const u of r.mutations){const d=AU(e,u.key.path,r.batchId);a.push(s.delete(d)),A.push(u.key)}return yt.waitFor(a).next(()=>A)}function nw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw dr();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gi.DEFAULT_COLLECTION_PERCENTILE=10,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gi.DEFAULT=new Gi(41943040,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gi.DISABLED=new Gi(-1,0,0);class f2{constructor(e,r,n,s){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=s,this.Fn={}}static lt(e,r,n,s){pr(e.uid!=="");const a=e.isAuthenticated()?e.uid:"";return new f2(a,r,n,s)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return au(e).J({index:"userMutationsIndex",range:n},(s,a,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,s){const a=Vf(e),o=au(e);return o.add({}).next(l=>{pr(typeof l=="number");const c=new dS(l,r,n,s),A=function(h,m,p){const x=p.baseMutations.map(w=>Vg(h.ct,w)),g=p.mutations.map(w=>Vg(h.ct,w));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:g}}(this.serializer,this.userId,c),u=[];let d=new Dn((f,h)=>Rr(f.canonicalString(),h.canonicalString()));for(const f of s){const h=AU(this.userId,f.key.path,l);d=d.add(f.key.path.popLast()),u.push(o.put(A)),u.push(a.put(h,Yz))}return d.forEach(f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),yt.waitFor(u).next(()=>c)})}lookupMutationBatch(e,r){return au(e).get(r).next(n=>n?(pr(n.userId===this.userId),zd(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?yt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const s=n.keys();return this.Fn[r]=s,s}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return au(e).J({index:"userMutationsIndex",range:s},(o,l,c)=>{l.userId===this.userId&&(pr(l.batchId>=n),a=zd(this.serializer,l)),c.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return au(e).J({index:"userMutationsIndex",range:r,reverse:!0},(s,a,o)=>{n=a.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return au(e).U("userMutationsIndex",r).next(n=>n.map(s=>zd(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=iy(this.userId,r.path),s=IDBKeyRange.lowerBound(n),a=[];return Vf(e).J({range:s},(o,l,c)=>{const[A,u,d]=o,f=pc(u);if(A===this.userId&&r.path.isEqual(f))return au(e).get(d).next(h=>{if(!h)throw dr();pr(h.userId===this.userId),a.push(zd(this.serializer,h))});c.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Dn(Rr);const s=[];return r.forEach(a=>{const o=iy(this.userId,a.path),l=IDBKeyRange.lowerBound(o),c=Vf(e).J({range:l},(A,u,d)=>{const[f,h,m]=A,p=pc(h);f===this.userId&&a.path.isEqual(p)?n=n.add(m):d.done()});s.push(c)}),yt.waitFor(s).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1,a=iy(this.userId,n),o=IDBKeyRange.lowerBound(a);let l=new Dn(Rr);return Vf(e).J({range:o},(c,A,u)=>{const[d,f,h]=c,m=pc(f);d===this.userId&&n.isPrefixOf(m)?m.length===s&&(l=l.add(h)):u.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],s=[];return r.forEach(a=>{s.push(au(e).get(a).next(o=>{if(o===null)throw dr();pr(o.userId===this.userId),n.push(zd(this.serializer,o))}))}),yt.waitFor(s).next(()=>n)}removeMutationBatch(e,r){return a6(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),yt.forEach(n,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return yt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Vf(e).J({range:n},(a,o,l)=>{if(a[0]===this.userId){const c=pc(a[1]);s.push(c)}else l.done()}).next(()=>{pr(s.length===0)})})}containsKey(e,r){return i6(e,this.userId,r)}Nn(e){return o6(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function i6(t,e,r){const n=iy(e,r.path),s=n[1],a=IDBKeyRange.lowerBound(n);let o=!1;return Vf(t).J({range:a,H:!0},(l,c,A)=>{const[u,d,f]=l;u===e&&d===s&&(o=!0),A.done()}).next(()=>o)}function au(t){return xa(t,"mutations")}function Vf(t){return xa(t,"documentMutations")}function o6(t){return xa(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Th(0)}static kn(){return new Th(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new Th(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>vr.fromTimestamp(new Gt(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(s=>(s.highestListenSequenceNumber=r,n&&(s.lastRemoteSnapshotVersion=n.toTimestamp()),r>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=r),this.Qn(e,s)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>vf(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(pr(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let s=0;const a=[];return vf(e).J((o,l)=>{const c=pp(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(s++,a.push(this.removeTargetData(e,c)))}).next(()=>yt.waitFor(a)).next(()=>s)}forEachTarget(e,r){return vf(e).J((n,s)=>{const a=pp(s);r(a)})}qn(e){return nk(e).get("targetGlobalKey").next(r=>(pr(r!==null),r))}Qn(e,r){return nk(e).put("targetGlobalKey",r)}Kn(e,r){return vf(e).put(t6(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=Ih(r),s=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return vf(e).J({range:s,index:"queryTargetsIndex"},(o,l,c)=>{const A=pp(l);Bx(r,A.target)&&(a=A,c.done())}).next(()=>a)}addMatchingKeys(e,r,n){const s=[],a=Cu(e);return r.forEach(o=>{const l=Ri(o.path);s.push(a.put({targetId:n,path:l})),s.push(this.referenceDelegate.addReference(e,n,o))}),yt.waitFor(s)}removeMatchingKeys(e,r,n){const s=Cu(e);return yt.forEach(r,a=>{const o=Ri(a.path);return yt.waitFor([s.delete([n,o]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,r){const n=Cu(e),s=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(s)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),s=Cu(e);let a=Kr();return s.J({range:n,H:!0},(o,l,c)=>{const A=pc(o[1]),u=new er(A);a=a.add(u)}).next(()=>a)}containsKey(e,r){const n=Ri(r.path),s=IDBKeyRange.bound([n],[aU(n)],!1,!0);let a=0;return Cu(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,l],c,A)=>{o!==0&&(a++,A.done())}).next(()=>a>0)}ot(e,r){return vf(e).get(r).next(n=>n?pp(n):null)}}function vf(t){return xa(t,"targets")}function nk(t){return xa(t,"targetGlobal")}function Cu(t){return xa(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk([t,e],[r,n]){const s=Rr(t,r);return s===0?Rr(e,n):s}class yJ{constructor(e){this.Un=e,this.buffer=new Dn(sk),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();sk(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class wJ{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Ht("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){xd(r)?Ht("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Kh(r)}await this.Hn(3e5)})}}class bJ{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return yt.resolve(ol.oe);const n=new yJ(r);return this.Jn.forEachTarget(e,s=>n.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>n.zn(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ht("LruGarbageCollector","Garbage collection skipped; disabled"),yt.resolve(rk)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ht("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rk):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,s,a,o,l,c,A;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(Ht("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(e,s))).next(d=>(n=d,l=Date.now(),this.removeTargets(e,n,r))).next(d=>(a=d,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(A=Date.now(),Uf()<=rn.DEBUG&&Ht("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${a} targets in `+(c-l)+`ms
	Removed ${d} documents in `+(A-c)+`ms
Total Duration: ${A-u}ms`),yt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:d})))}}function NJ(t,e){return new bJ(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CJ{constructor(e,r){this.db=e,this.garbageCollector=NJ(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,s)=>r(s))}addReference(e,r,n){return Pv(e,n)}removeReference(e,r,n){return Pv(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return Pv(e,r)}nr(e,r){return function(s,a){let o=!1;return o6(s).Y(l=>i6(s,l,a).next(c=>(c&&(o=!0),yt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(A=>{if(!A)return a++,n.getEntry(e,o).next(()=>(n.removeEntry(o,vr.min()),Cu(e).delete(function(d){return[0,Ri(d.path)]}(o))))});s.push(c)}}).next(()=>yt.waitFor(s)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return Pv(e,r)}tr(e,r){const n=Cu(e);let s,a=ol.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:A})=>{o===0?(a!==ol.oe&&r(new er(pc(s)),a),a=A,s=c):a=ol.oe}).next(()=>{a!==ol.oe&&r(new er(pc(s)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Pv(t,e){return Cu(t).put(function(n,s){return{targetId:0,path:Ri(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(){this.changes=new vd(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,As.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?yt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _J{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return jd(e).put(n)}removeEntry(e,r,n){return jd(e).delete(function(a,o){const l=a.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],tw(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=As.newInvalidDocument(r);return jd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(qm(r))},(s,a)=>{n=this.ir(r,a)}).next(()=>n)}sr(e,r){let n={size:0,document:As.newInvalidDocument(r)};return jd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(qm(r))},(s,a)=>{n={document:this.ir(r,a),size:nw(a)}}).next(()=>n)}getEntries(e,r){let n=Eo();return this._r(e,r,(s,a)=>{const o=this.ir(s,a);n=n.insert(s,o)}).next(()=>n)}ar(e,r){let n=Eo(),s=new fs(er.comparator);return this._r(e,r,(a,o)=>{const l=this.ir(a,o);n=n.insert(a,l),s=s.insert(a,nw(o))}).next(()=>({documents:n,ur:s}))}_r(e,r,n){if(r.isEmpty())return yt.resolve();let s=new Dn(ok);r.forEach(c=>s=s.add(c));const a=IDBKeyRange.bound(qm(s.first()),qm(s.last())),o=s.getIterator();let l=o.getNext();return jd(e).J({index:"documentKeyIndex",range:a},(c,A,u)=>{const d=er.fromSegments([...A.prefixPath,A.collectionGroup,A.documentId]);for(;l&&ok(l,d)<0;)n(l,null),l=o.getNext();l&&l.isEqual(d)&&(n(l,A),l=o.hasNext()?o.getNext():null),l?u.$(qm(l)):u.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,s,a){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),tw(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return jd(e).U(IDBKeyRange.bound(l,c,!0)).next(A=>{a==null||a.incrementDocumentReadCount(A.length);let u=Eo();for(const d of A){const f=this.ir(er.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);f.isFoundDocument()&&(Ix(r,f)||s.has(f.key))&&(u=u.insert(f.key,f))}return u})}getAllFromCollectionGroup(e,r,n,s){let a=Eo();const o=ik(r,n),l=ik(r,Fo.max());return jd(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,A,u)=>{const d=this.ir(er.fromSegments(A.prefixPath.concat(A.collectionGroup,A.documentId)),A);a=a.insert(d.key,d),a.size===s&&u.done()}).next(()=>a)}newChangeBuffer(e){return new EJ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return ak(e).get("remoteDocumentGlobalKey").next(r=>(pr(!!r),r))}rr(e,r){return ak(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=cJ(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(vr.min())))return n}return As.newInvalidDocument(e)}}function c6(t){return new _J(t)}class EJ extends l6{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new vd(n=>n.toString(),(n,s)=>n.isEqual(s))}applyChanges(e){const r=[];let n=0,s=new Dn((a,o)=>Rr(a.canonicalString(),o.canonicalString()));return this.changes.forEach((a,o)=>{const l=this.lr.get(a);if(r.push(this.cr.removeEntry(e,a,l.readTime)),o.isValidDocument()){const c=qF(this.cr.serializer,o);s=s.add(a.path.popLast());const A=nw(c);n+=A-l.size,r.push(this.cr.addEntry(e,a,c))}else if(n-=l.size,this.trackRemovals){const c=qF(this.cr.serializer,o.convertToNoDocument(vr.min()));r.push(this.cr.addEntry(e,a,c))}}),s.forEach(a=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,a))}),r.push(this.cr.updateMetadata(e,n)),yt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:s})=>(s.forEach((a,o)=>{this.lr.set(a,{size:o,readTime:n.get(a).readTime})}),n))}}function ak(t){return xa(t,"remoteDocumentGlobal")}function jd(t){return xa(t,"remoteDocumentsV14")}function qm(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ik(t,e){const r=e.documentKey.path.toArray();return[t,tw(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function ok(t,e){const r=t.path.toArray(),n=e.path.toArray();let s=0;for(let a=0;a<r.length-2&&a<n.length-2;++a)if(s=Rr(r[a],n[a]),s)return s;return s=Rr(r.length,n.length),s||(s=Rr(r[r.length-2],n[n.length-2]),s||Rr(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BJ{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Vp(n.mutation,s,Ji.empty(),Gt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Kr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Kr()){const s=gc();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let o=fp();return a.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=gc();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Kr()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let a=Eo();const o=Qp(),l=function(){return Qp()}();return r.forEach((c,A)=>{const u=n.get(A.key);s.has(A.key)&&(u===void 0||u.mutation instanceof TA)?a=a.insert(A.key,A):u!==void 0?(o.set(A.key,u.mutation.getFieldMask()),Vp(u.mutation,A,u.mutation.getFieldMask(),Gt.now())):o.set(A.key,Ji.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((A,u)=>o.set(A,u)),r.forEach((A,u)=>{var d;return l.set(A,new BJ(u,(d=o.get(A))!==null&&d!==void 0?d:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Qp();let s=new fs((o,l)=>o-l),a=Kr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const A=r.get(c);if(A===null)return;let u=n.get(c)||Ji.empty();u=l.applyToLocalView(A,u),n.set(c,u);const d=(s.get(l.batchId)||Kr()).add(c);s=s.insert(l.batchId,d)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),A=c.key,u=c.value,d=kU();u.forEach(f=>{if(!a.has(f)){const h=LU(r.get(f),n.get(f));h!==null&&d.set(f,h),a=a.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,A,d))}return yt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return er.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):EU(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):yt.resolve(gc());let l=-1,c=a;return o.next(A=>yt.forEach(A,(u,d)=>(l<d.largestBatchId&&(l=d.largestBatchId),a.get(u)?yt.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(e,A,a)).next(()=>this.computeViews(e,c,A,Kr())).next(u=>({batchId:l,changes:FU(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new er(r)).next(n=>{let s=fp();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let o=fp();return this.indexManager.getCollectionParents(e,a).next(l=>yt.forEach(l,c=>{const A=function(d,f){return new tm(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,A,n,s).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(o=>{a.forEach((c,A)=>{const u=A.getKey();o.get(u)===null&&(o=o.insert(u,As.newInvalidDocument(u)))});let l=fp();return o.forEach((c,A)=>{const u=a.get(c);u!==void 0&&Vp(u.mutation,A,Ji.empty(),Gt.now()),Ix(r,A)&&(l=l.insert(c,A))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SJ{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return yt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ia(s.createTime)}}(r)),yt.resolve()}getNamedQuery(e,r){return yt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:r6(s.bundledQuery),readTime:Ia(s.readTime)}}(r)),yt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(){this.overlays=new fs(er.comparator),this.Ir=new Map}getOverlay(e,r){return yt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=gc();return yt.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.ht(e,r,a)}),yt.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),yt.resolve()}getOverlaysForCollection(e,r,n){const s=gc(),a=r.length+1,o=new er(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,A=c.getKey();if(!r.isPrefixOf(A.path))break;A.path.length===a&&c.largestBatchId>n&&s.set(c.getKey(),c)}return yt.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new fs((A,u)=>A-u);const o=this.overlays.getIterator();for(;o.hasNext();){const A=o.getNext().value;if(A.getKey().getCollectionGroup()===r&&A.largestBatchId>n){let u=a.get(A.largestBatchId);u===null&&(u=gc(),a=a.insert(A.largestBatchId,u)),u.set(A.getKey(),A)}}const l=gc(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((A,u)=>l.set(A,u)),!(l.size()>=s)););return yt.resolve(l)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new fS(r,n));let a=this.Ir.get(r);a===void 0&&(a=Kr(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FJ{constructor(){this.sessionToken=zs.EMPTY_BYTE_STRING}getSessionToken(e){return yt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,yt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(){this.Tr=new Dn(Na.Er),this.dr=new Dn(Na.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Na(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Na(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new er(new pn([])),n=new Na(r,e),s=new Na(r,e+1),a=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),a.push(o.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new er(new pn([])),n=new Na(r,e),s=new Na(r,e+1);let a=Kr();return this.dr.forEachInRange([n,s],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new Na(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Na{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return er.comparator(e.key,r.key)||Rr(e.wr,r.wr)}static Ar(e,r){return Rr(e.wr,r.wr)||er.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kJ{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Dn(Na.Er)}checkEmpty(e){return yt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new dS(a,r,n,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Na(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return yt.resolve(o)}lookupMutationBatch(e,r){return yt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return yt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return yt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return yt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Na(r,0),s=new Na(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],o=>{const l=this.Dr(o.wr);a.push(l)}),yt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Dn(Rr);return r.forEach(s=>{const a=new Na(s,0),o=new Na(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,o],l=>{n=n.add(l.wr)})}),yt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;er.isDocumentKey(a)||(a=a.child(""));const o=new Na(new er(a),0);let l=new Dn(Rr);return this.br.forEachWhile(c=>{const A=c.key.path;return!!n.isPrefixOf(A)&&(A.length===s&&(l=l.add(c.wr)),!0)},o),yt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){pr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return yt.forEach(r.mutations,s=>{const a=new Na(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Na(r,0),s=this.br.firstAfterOrEqual(n);return yt.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,yt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e){this.Mr=e,this.docs=function(){return new fs(er.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return yt.resolve(n?n.document.mutableCopy():As.newInvalidDocument(r))}getEntries(e,r){let n=Eo();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():As.newInvalidDocument(s))}),yt.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=Eo();const o=r.path,l=new er(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:A,value:{document:u}}=c.getNext();if(!o.isPrefixOf(A.path))break;A.path.length>o.length+1||sS(iU(u),n)<=0||(s.has(u.key)||Ix(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return yt.resolve(a)}getAllFromCollectionGroup(e,r,n,s){dr()}Or(e,r){return yt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new jJ(this)}getSize(e){return yt.resolve(this.size)}}class jJ extends l6{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),yt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PJ{constructor(e){this.persistence=e,this.Nr=new vd(r=>Ih(r),Bx),this.lastRemoteSnapshotVersion=vr.min(),this.highestTargetId=0,this.Lr=0,this.Br=new vS,this.targetCount=0,this.kr=Th.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),yt.resolve()}getLastRemoteSnapshotVersion(e){return yt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return yt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),yt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),yt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Th(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,yt.resolve()}updateTargetData(e,r){return this.Kn(r),yt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,yt.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),yt.waitFor(a).next(()=>s)}getTargetCount(e){return yt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return yt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),yt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(o=>{a.push(s.markPotentiallyOrphaned(e,o))}),yt.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),yt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return yt.resolve(n)}containsKey(e,r){return yt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,r){this.qr={},this.overlays={},this.Qr=new ol(0),this.Kr=!1,this.Kr=!0,this.$r=new FJ,this.referenceDelegate=e(this),this.Ur=new PJ(this),this.indexManager=new gJ,this.remoteDocumentCache=function(s){return new TJ(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new e6(r),this.Gr=new SJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new IJ,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new kJ(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ht("MemoryPersistence","Starting transaction:",e);const s=new RJ(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(e,r){return yt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class RJ extends lU{constructor(e){super(),this.currentSequenceNumber=e}}class m2{constructor(e){this.persistence=e,this.Jr=new vS,this.Yr=null}static Zr(e){return new m2(e)}get Xr(){if(this.Yr)return this.Yr;throw dr()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),yt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),yt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),yt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return yt.forEach(this.Xr,n=>{const s=er.fromPath(n);return this.ei(e,s).next(a=>{a||r.removeEntry(s,vr.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return yt.or([()=>yt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DJ{constructor(e){this.serializer=e}O(e,r,n,s){const a=new o2("createOrUpgrade",r);n<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wF,{unique:!0}),c.createObjectStore("documentMutations")}(e),lk(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=yt.resolve();return n<3&&s>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),lk(e)),o=o.next(()=>function(c){const A=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:vr.min().toTimestamp(),targetCount:0};return A.put("targetGlobalKey",u)}(a))),n<4&&s>=4&&(n!==0&&(o=o.next(()=>function(c,A){return A.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wF,{unique:!0});const d=A.store("mutations"),f=u.map(h=>d.put(h));return yt.waitFor(f)})}(e,a))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&s>=5&&(o=o.next(()=>this.ni(a))),n<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(a)))),n<7&&s>=7&&(o=o.next(()=>this.ii(a))),n<8&&s>=8&&(o=o.next(()=>this.si(e,a))),n<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&s>=10&&(o=o.next(()=>this.oi(a))),n<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&s>=12&&(o=o.next(()=>{(function(c){const A=c.createObjectStore("documentOverlays",{keyPath:AW});A.createIndex("collectionPathOverlayIndex",uW,{unique:!1}),A.createIndex("collectionGroupOverlayIndex",dW,{unique:!1})})(e)})),n<13&&s>=13&&(o=o.next(()=>function(c){const A=c.createObjectStore("remoteDocumentsV14",{keyPath:Zz});A.createIndex("documentKeyIndex",eW),A.createIndex("collectionGroupIndex",tW)}(e)).next(()=>this._i(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&s>=14&&(o=o.next(()=>this.ai(e,a))),n<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:iW}).createIndex("sequenceNumberIndex",oW,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:lW}).createIndex("documentKeyIndex",cW,{unique:!1})}(e))),n<16&&s>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,s)=>{r+=nw(s)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(s=>yt.forEach(s,a=>{const o=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>yt.forEach(l,c=>{pr(c.userId===a.userId);const A=zd(this.serializer,c);return a6(e,a.userId,A).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const a=[];return n.J((o,l)=>{const c=new pn(o),A=function(d){return[0,Ri(d)]}(c);a.push(r.get(A).next(u=>u?yt.resolve():(d=>r.put({targetId:0,path:Ri(d),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>yt.waitFor(a))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:aW});const n=r.store("collectionParents"),s=new xS,a=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:Ri(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new pn(o);return a(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],A)=>{const u=pc(l);return a(u.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,s)=>{const a=pp(s),o=t6(this.serializer,a);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),s=[];return n.J((a,o)=>{const l=r.store("remoteDocumentsV14"),c=function(d){return d.document?new er(pn.fromString(d.document.name).popFirst(5)):d.noDocument?er.fromSegments(d.noDocument.path):d.unknownDocument?er.fromSegments(d.unknownDocument.path):dr()}(o).path.toArray(),A={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(A))}).next(()=>yt.waitFor(s))}ai(e,r){const n=r.store("mutations"),s=c6(this.serializer),a=new u6(m2.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var A;let u=(A=l.get(c.userId))!==null&&A!==void 0?A:Kr();zd(this.serializer,c).keys().forEach(d=>u=u.add(d)),l.set(c.userId,u)}),yt.forEach(l,(c,A)=>{const u=new Va(A),d=h2.lt(this.serializer,u),f=a.getIndexManager(u),h=f2.lt(u,this.serializer,f,a.referenceDelegate);return new A6(s,h,d,f).recalculateAndSaveOverlaysForDocumentKeys(new S_(r,ol.oe),c).next()})})}}function lk(t){t.createObjectStore("targetDocuments",{keyPath:nW}).createIndex("documentTargetsIndex",sW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",rW,{unique:!0}),t.createObjectStore("targetGlobal")}const Zb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class yS{constructor(e,r,n,s,a,o,l,c,A,u,d=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=a,this.window=o,this.document=l,this.ci=A,this.li=u,this.hi=d,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!yS.D())throw new Wt(Bt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new CJ(this,s),this.Ai=r+"main",this.serializer=new e6(c),this.Ri=new zu(this.Ai,this.hi,new DJ(this.serializer)),this.$r=new uJ,this.Ur=new vJ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=c6(this.serializer),this.Gr=new AJ,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&ji("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Wt(Bt.FAILED_PRECONDITION,Zb);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new ol(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Rv(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(xd(e))return Ht("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ht("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Gm(e).get("owner").next(r=>yt.resolve(this.vi(r)))}Ci(e){return Rv(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=xa(r,"clientMetadata");return n.U().next(s=>{const a=this.xi(s,18e5),o=s.filter(l=>a.indexOf(l)===-1);return yt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?yt.resolve(!0):Gm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Wt(Bt.FAILED_PRECONDITION,Zb);return!1}}return!(!this.networkEnabled||!this.inForeground)||Rv(e).U().next(n=>this.xi(n,5e3).find(s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(a||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Ht("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new S_(e,ol.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Rv(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return f2.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xJ(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return h2.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ht("IndexedDbPersistence","Starting transaction:",e);const s=r==="readonly"?"readonly":"readwrite",a=function(c){return c===17?mW:c===16?fW:c===15?iS:c===14?hU:c===13?dU:c===12?hW:c===11?uU:void dr()}(this.hi);let o;return this.Ri.runTransaction(e,s,a,l=>(o=new S_(l,this.Qr?this.Qr.next():ol.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw ji(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Wt(Bt.FAILED_PRECONDITION,oU);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return Gm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Wt(Bt.FAILED_PRECONDITION,Zb)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gm(e).put("owner",r)}static D(){return zu.D()}bi(e){const r=Gm(e);return r.get("owner").next(n=>this.vi(n)?(Ht("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):yt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(ji(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;cL()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Ht("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return ji("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ji("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Gm(t){return xa(t,"owner")}function Rv(t){return xa(t,"clientMetadata")}function LJ(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Kr(),s=Kr();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new wS(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return cL()?8:cU(pa())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.Yi(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Zi(e,r,s,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new UJ;return this.Xi(e,r,o).next(l=>{if(a.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>a.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(Uf()<=rn.DEBUG&&Ht("QueryEngine","SDK will not create cache indexes for query:",Of(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),yt.resolve()):(Uf()<=rn.DEBUG&&Ht("QueryEngine","Query:",Of(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Uf()<=rn.DEBUG&&Ht("QueryEngine","The SDK decides to create cache indexes for query:",Of(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ul(r))):yt.resolve())}Yi(e,r){if(PF(r))return yt.resolve(null);let n=ul(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=ew(r,null,"F"),n=ul(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=Kr(...a);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const A=this.ts(r,l);return this.ns(r,A,o,c.readTime)?this.Yi(e,ew(r,null,"F")):this.rs(e,A,r,c)}))})))}Zi(e,r,n,s){return PF(r)||s.isEqual(vr.min())?yt.resolve(null):this.Ji.getDocuments(e,n).next(a=>{const o=this.ts(r,a);return this.ns(r,o,n,s)?yt.resolve(null):(Uf()<=rn.DEBUG&&Ht("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Of(r)),this.rs(e,o,r,qz(s,-1)).next(l=>l))})}ts(e,r){let n=new Dn(SU(e));return r.forEach((s,a)=>{Ix(e,a)&&(n=n.add(a))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(e,r,n){return Uf()<=rn.DEBUG&&Ht("QueryEngine","Using full collection scan to execute query:",Of(r)),this.Ji.getDocumentsMatchingQuery(e,r,Fo.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OJ{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new fs(Rr),this._s=new vd(a=>Ih(a),Bx),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new A6(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function h6(t,e,r,n){return new OJ(t,e,r,n)}async function f6(t,e){const r=Fr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],l=[];let c=Kr();for(const A of s){o.push(A.batchId);for(const u of A.mutations)c=c.add(u.key)}for(const A of a){l.push(A.batchId);for(const u of A.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(A=>({hs:A,removedBatchIds:o,addedBatchIds:l}))})})}function MJ(t,e){const r=Fr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,A,u){const d=A.batch,f=d.keys();let h=yt.resolve();return f.forEach(m=>{h=h.next(()=>u.getEntry(c,m)).next(p=>{const x=A.docVersions.get(m);pr(x!==null),p.version.compareTo(x)<0&&(d.applyToRemoteDocument(p,A),p.isValidDocument()&&(p.setReadTime(A.commitVersion),u.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,d))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Kr();for(let A=0;A<l.mutationResults.length;++A)l.mutationResults[A].transformResults.length>0&&(c=c.add(l.batch.mutations[A].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function m6(t){const e=Fr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function QJ(t,e){const r=Fr(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const l=[];e.targetChanges.forEach((u,d)=>{const f=s.get(d);if(!f)return;l.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,d)));let h=f.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(d)!==null?h=h.withResumeToken(zs.EMPTY_BYTE_STRING,vr.min()).withLastLimboFreeSnapshotVersion(vr.min()):u.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(u.resumeToken,n)),s=s.insert(d,h),function(p,x,g){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(f,h,u)&&l.push(r.Ur.updateTargetData(a,h))});let c=Eo(),A=Kr();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),l.push(VJ(a,o,e.documentUpdates).next(u=>{c=u.Ps,A=u.Is})),!n.isEqual(vr.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(d=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));l.push(u)}return yt.waitFor(l).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,A)).next(()=>c)}).then(a=>(r.os=s,a))}function VJ(t,e,r){let n=Kr(),s=Kr();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=Eo();return r.forEach((l,c)=>{const A=a.get(l);c.isFoundDocument()!==A.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(vr.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!A.isValidDocument()||c.version.compareTo(A.version)>0||c.version.compareTo(A.version)===0&&A.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ht("LocalStore","Ignoring outdated watch update for ",l,". Current version:",A.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function HJ(t,e){const r=Fr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function KJ(t,e){const r=Fr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(a=>a?(s=a,yt.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new lA(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function V_(t,e,r){const n=Fr(t),s=n.os.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!xd(o))throw o;Ht("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function ck(t,e,r){const n=Fr(t);let s=vr.min(),a=Kr();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,A,u){const d=Fr(c),f=d._s.get(u);return f!==void 0?yt.resolve(d.os.get(f)):d.Ur.getTargetData(A,u)}(n,o,ul(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{a=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:vr.min(),r?a:Kr())).next(l=>(qJ(n,FW(e),l),{documents:l,Ts:a})))}function qJ(t,e,r){let n=t.us.get(e)||vr.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.us.set(e,n)}class Ak{constructor(){this.activeTargetIds=DW()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class p6{constructor(){this.so=new Ak,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ak,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GJ{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ht("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ht("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dv=null;function eN(){return Dv===null?Dv=function(){return 268435456+Math.round(2147483648*Math.random())}():Dv++,"0x"+Dv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $J={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zJ{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri="WebChannelConnection";class WJ extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,o){const l=eN(),c=this.xo(r,n.toUriEncodedString());Ht("RestConnection",`Sending RPC '${r}' ${l}:`,c,s);const A={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(A,a,o),this.No(r,c,A,s).then(u=>(Ht("RestConnection",`Received RPC '${r}' ${l}: `,u),u),u=>{throw ed("RestConnection",`RPC '${r}' ${l} failed with error: `,u,"url: ",c,"request:",s),u})}Lo(r,n,s,a,o,l){return this.Mo(r,n,s,a,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+em}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>r[o]=a),s&&s.headers.forEach((a,o)=>r[o]=a)}xo(r,n){const s=$J[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const a=eN();return new Promise((o,l)=>{const c=new YL;c.setWithCredentials(!0),c.listenOnce(ZL.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case sy.NO_ERROR:const u=c.getResponseJson();Ht(ri,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(u)),o(u);break;case sy.TIMEOUT:Ht(ri,`RPC '${e}' ${a} timed out`),l(new Wt(Bt.DEADLINE_EXCEEDED,"Request time out"));break;case sy.HTTP_ERROR:const d=c.getStatus();if(Ht(ri,`RPC '${e}' ${a} failed with status:`,d,"response text:",c.getResponseText()),d>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(x){const g=x.toLowerCase().replace(/_/g,"-");return Object.values(Bt).indexOf(g)>=0?g:Bt.UNKNOWN}(h.status);l(new Wt(m,h.message))}else l(new Wt(Bt.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Wt(Bt.UNAVAILABLE,"Connection failed."));break;default:dr()}}finally{Ht(ri,`RPC '${e}' ${a} completed.`)}});const A=JSON.stringify(s);Ht(ri,`RPC '${e}' ${a} sending request:`,s),c.send(r,"POST",A,n,15)})}Bo(e,r,n){const s=eN(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=rU(),l=tU(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},A=this.longPollingOptions.timeoutSeconds;A!==void 0&&(c.longPollingTimeout=Math.round(1e3*A)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=a.join("");Ht(ri,`Creating RPC '${e}' stream ${s}: ${u}`,c);const d=o.createWebChannel(u,c);let f=!1,h=!1;const m=new zJ({Io:x=>{h?Ht(ri,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(f||(Ht(ri,`Opening RPC '${e}' stream ${s} transport.`),d.open(),f=!0),Ht(ri,`RPC '${e}' stream ${s} sending:`,x),d.send(x))},To:()=>d.close()}),p=(x,g,w)=>{x.listen(g,b=>{try{w(b)}catch(k){setTimeout(()=>{throw k},0)}})};return p(d,hp.EventType.OPEN,()=>{h||(Ht(ri,`RPC '${e}' stream ${s} transport opened.`),m.yo())}),p(d,hp.EventType.CLOSE,()=>{h||(h=!0,Ht(ri,`RPC '${e}' stream ${s} transport closed`),m.So())}),p(d,hp.EventType.ERROR,x=>{h||(h=!0,ed(ri,`RPC '${e}' stream ${s} transport errored:`,x),m.So(new Wt(Bt.UNAVAILABLE,"The operation could not be completed")))}),p(d,hp.EventType.MESSAGE,x=>{var g;if(!h){const w=x.data[0];pr(!!w);const b=w,k=b.error||((g=b[0])===null||g===void 0?void 0:g.error);if(k){Ht(ri,`RPC '${e}' stream ${s} received error:`,k);const P=k.status;let L=function(B){const M=Xs[B];if(M!==void 0)return MU(M)}(P),E=k.message;L===void 0&&(L=Bt.INTERNAL,E="Unknown error status: "+P+" with message "+k.message),h=!0,m.So(new Wt(L,E)),d.close()}else Ht(ri,`RPC '${e}' stream ${s} received:`,w),m.bo(w)}}),p(l,eU.STAT_EVENT,x=>{x.stat===E_.PROXY?Ht(ri,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===E_.NOPROXY&&Ht(ri,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JJ(){return typeof window<"u"?window:null}function uy(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(t){return new YW(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,r,n=1e3,s=1.5,a=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Ht("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,r,n,s,a,o,l,c){this.ui=e,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new bS(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Bt.RESOURCE_EXHAUSTED?(ji(r.toString()),ji("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Bt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Wt(Bt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ht("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ht("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class XJ extends g6{constructor(e,r,n,s,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=rJ(this.serializer,e),n=function(a){if(!("targetChange"in a))return vr.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?vr.min():o.readTime?Ia(o.readTime):vr.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=L_(this.serializer),r.addTarget=function(a,o){let l;const c=o.target;if(l=Yy(c)?{documents:zU(a,c)}:{query:WU(a,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=HU(a,o.resumeToken);const A=R_(a,o.expectedCount);A!==null&&(l.expectedCount=A)}else if(o.snapshotVersion.compareTo(vr.min())>0){l.readTime=O0(a,o.snapshotVersion.toTimestamp());const A=R_(a,o.expectedCount);A!==null&&(l.expectedCount=A)}return l}(this.serializer,e);const n=sJ(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=L_(this.serializer),r.removeTarget=e,this.a_(r)}}class YJ extends g6{constructor(e,r,n,s,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return pr(!!e.streamToken),this.lastStreamToken=e.streamToken,pr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){pr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=nJ(e.writeResults,e.commitTime),n=Ia(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=L_(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>Vg(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJ extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Wt(Bt.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,D_(r,n),s,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Bt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Wt(Bt.UNKNOWN,a.toString())})}Lo(e,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,D_(r,n),s,o,l,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Bt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Wt(Bt.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class eX{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ji(r),this.D_=!1):Ht("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tX{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(o=>{n.enqueueAndForget(async()=>{Gh(this)&&(Ht("RemoteStore","Restarting streams for network reachability change."),await async function(c){const A=Fr(c);A.L_.add(4),await kx(A),A.q_.set("Unknown"),A.L_.delete(4),await g2(A)}(this))})}),this.q_=new eX(n,s)}}async function g2(t){if(Gh(t))for(const e of t.B_)await e(!0)}async function kx(t){for(const e of t.B_)await e(!1)}function x6(t,e){const r=Fr(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),ES(r)?_S(r):sm(r).r_()&&CS(r,e))}function NS(t,e){const r=Fr(t),n=sm(r);r.N_.delete(e),n.r_()&&v6(r,e),r.N_.size===0&&(n.r_()?n.o_():Gh(r)&&r.q_.set("Unknown"))}function CS(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(vr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}sm(t).A_(e)}function v6(t,e){t.Q_.xe(e),sm(t).R_(e)}function _S(t){t.Q_=new zW({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),sm(t).start(),t.q_.v_()}function ES(t){return Gh(t)&&!sm(t).n_()&&t.N_.size>0}function Gh(t){return Fr(t).L_.size===0}function y6(t){t.Q_=void 0}async function rX(t){t.q_.set("Online")}async function nX(t){t.N_.forEach((e,r)=>{CS(t,e)})}async function sX(t,e){y6(t),ES(t)?(t.q_.M_(e),_S(t)):t.q_.set("Unknown")}async function aX(t,e,r){if(t.q_.set("Online"),e instanceof VU&&e.state===2&&e.cause)try{await async function(s,a){const o=a.cause;for(const l of a.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(n){Ht("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await sw(t,n)}else if(e instanceof Ay?t.Q_.Ke(e):e instanceof QU?t.Q_.He(e):t.Q_.We(e),!r.isEqual(vr.min()))try{const n=await m6(t.localStore);r.compareTo(n)>=0&&await function(a,o){const l=a.Q_.rt(o);return l.targetChanges.forEach((c,A)=>{if(c.resumeToken.approximateByteSize()>0){const u=a.N_.get(A);u&&a.N_.set(A,u.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,A)=>{const u=a.N_.get(c);if(!u)return;a.N_.set(c,u.withResumeToken(zs.EMPTY_BYTE_STRING,u.snapshotVersion)),v6(a,c);const d=new lA(u.target,c,A,u.sequenceNumber);CS(a,d)}),a.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Ht("RemoteStore","Failed to raise snapshot:",n),await sw(t,n)}}async function sw(t,e,r){if(!xd(e))throw e;t.L_.add(1),await kx(t),t.q_.set("Offline"),r||(r=()=>m6(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ht("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await g2(t)})}function w6(t,e){return e().catch(r=>sw(t,r,e))}async function Tx(t){const e=Fr(t),r=sd(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;iX(e);)try{const s=await HJ(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,oX(e,s)}catch(s){await sw(e,s)}b6(e)&&N6(e)}function iX(t){return Gh(t)&&t.O_.length<10}function oX(t,e){t.O_.push(e);const r=sd(t);r.r_()&&r.V_&&r.m_(e.mutations)}function b6(t){return Gh(t)&&!sd(t).n_()&&t.O_.length>0}function N6(t){sd(t).start()}async function lX(t){sd(t).p_()}async function cX(t){const e=sd(t);for(const r of t.O_)e.m_(r.mutations)}async function AX(t,e,r){const n=t.O_.shift(),s=hS.from(n,e,r);await w6(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Tx(t)}async function uX(t,e){e&&sd(t).V_&&await async function(n,s){if(function(o){return OU(o)&&o!==Bt.ABORTED}(s.code)){const a=n.O_.shift();sd(n).s_(),await w6(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Tx(n)}}(t,e),b6(t)&&N6(t)}async function dk(t,e){const r=Fr(t);r.asyncQueue.verifyOperationInProgress(),Ht("RemoteStore","RemoteStore received new credentials");const n=Gh(r);r.L_.add(3),await kx(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await g2(r)}async function dX(t,e){const r=Fr(t);e?(r.L_.delete(2),await g2(r)):e||(r.L_.add(2),await kx(r),r.q_.set("Unknown"))}function sm(t){return t.K_||(t.K_=function(r,n,s){const a=Fr(r);return a.w_(),new XJ(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:rX.bind(null,t),Ro:nX.bind(null,t),mo:sX.bind(null,t),d_:aX.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),ES(t)?_S(t):t.q_.set("Unknown")):(await t.K_.stop(),y6(t))})),t.K_}function sd(t){return t.U_||(t.U_=function(r,n,s){const a=Fr(r);return a.w_(),new YJ(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:lX.bind(null,t),mo:uX.bind(null,t),f_:cX.bind(null,t),g_:AX.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Tx(t)):(await t.U_.stop(),t.O_.length>0&&(Ht("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Ul,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const o=Date.now()+n,l=new BS(e,r,o,s,a);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Wt(Bt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function SS(t,e){if(ji("AsyncQueue",`${e}: ${t}`),xd(t))return new Wt(Bt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e){this.comparator=e?(r,n)=>e(r,n)||er.comparator(r.key,n.key):(r,n)=>er.comparator(r.key,n.key),this.keyedMap=fp(),this.sortedSet=new fs(this.comparator)}static emptySet(e){return new x0(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof x0)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new x0;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(){this.W_=new fs(er.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):dr():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class M0{constructor(e,r,n,s,a,o,l,c,A){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=A}static fromInitialDocuments(e,r,n,s,a){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new M0(e,r,x0.emptySet(r),o,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&c2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hX{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class fX{constructor(){this.queries=fk(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Fr(r),a=s.queries;s.queries=fk(),a.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Wt(Bt.ABORTED,"Firestore shutting down"))}}function fk(){return new vd(t=>BU(t),c2)}async function IS(t,e){const r=Fr(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.H_()&&e.J_()&&(n=2):(a=new hX,n=e.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=SS(o,`Initialization of query '${Of(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,a),a.j_.push(e),e.Z_(r.onlineState),a.z_&&e.X_(a.z_)&&kS(r)}async function FS(t,e){const r=Fr(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const o=a.j_.indexOf(e);o>=0&&(a.j_.splice(o,1),a.j_.length===0?s=e.J_()?0:1:!a.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function mX(t,e){const r=Fr(t);let n=!1;for(const s of e){const a=s.query,o=r.queries.get(a);if(o){for(const l of o.j_)l.X_(s)&&(n=!0);o.z_=s}}n&&kS(r)}function pX(t,e,r){const n=Fr(t),s=n.queries.get(e);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(e)}function kS(t){t.Y_.forEach(e=>{e.next()})}var H_,mk;(mk=H_||(H_={})).ea="default",mk.Cache="cache";class TS{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new M0(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=M0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==H_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.key=e}}class _6{constructor(e){this.key=e}}class gX{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Kr(),this.mutatedKeys=Kr(),this.Aa=SU(e),this.Ra=new x0(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new hk,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,A=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,d)=>{const f=s.get(u),h=Ix(this.query,d)?d:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(f,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||A&&this.Aa(h,A)<0)&&(l=!0)):!f&&h?(n.track({type:0,doc:h}),x=!0):f&&!h&&(n.track({type:1,doc:f}),x=!0,(c||A)&&(l=!0)),x&&(h?(o=o.add(h),a=p?a.add(u):a.delete(u)):(o=o.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:o,fa:n,ns:l,mutatedKeys:a}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,d)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dr()}};return p(h)-p(m)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(n),s=s!=null&&s;const l=r&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,A=c!==this.Ea;return this.Ea=c,o.length!==0||A?{snapshot:new M0(this.query,e.Ra,a,o,e.mutatedKeys,c===0,A,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new hk,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Kr(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new _6(n))}),this.da.forEach(n=>{e.has(n)||r.push(new C6(n))}),r}ba(e){this.Ta=e.Ts,this.da=Kr();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return M0.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class xX{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class vX{constructor(e){this.key=e,this.va=!1}}class yX{constructor(e,r,n,s,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new vd(l=>BU(l),c2),this.Ma=new Map,this.xa=new Set,this.Oa=new fs(er.comparator),this.Na=new Map,this.La=new vS,this.Ba={},this.ka=new Map,this.qa=Th.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function wX(t,e,r=!0){const n=k6(t);let s;const a=n.Fa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await E6(n,e,r,!0),s}async function bX(t,e){const r=k6(t);await E6(r,e,!0,!1)}async function E6(t,e,r,n){const s=await KJ(t.localStore,ul(e)),a=s.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let l;return n&&(l=await NX(t,e,a,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&x6(t.remoteStore,s),l}async function NX(t,e,r,n,s){t.Ka=(d,f,h)=>async function(p,x,g,w){let b=x.view.ma(g);b.ns&&(b=await ck(p.localStore,x.query,!1).then(({documents:E})=>x.view.ma(E,b)));const k=w&&w.targetChanges.get(x.targetId),P=w&&w.targetMismatches.get(x.targetId)!=null,L=x.view.applyChanges(b,p.isPrimaryClient,k,P);return gk(p,x.targetId,L.wa),L.snapshot}(t,d,f,h);const a=await ck(t.localStore,e,!0),o=new gX(e,a.Ts),l=o.ma(a.documents),c=Fx.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),A=o.applyChanges(l,t.isPrimaryClient,c);gk(t,r,A.wa);const u=new xX(e,r,o);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),A.snapshot}async function CX(t,e,r){const n=Fr(t),s=n.Fa.get(e),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(o=>!c2(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await V_(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&NS(n.remoteStore,s.targetId),K_(n,s.targetId)}).catch(Kh)):(K_(n,s.targetId),await V_(n.localStore,s.targetId,!0))}async function _X(t,e){const r=Fr(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),NS(r.remoteStore,n.targetId))}async function EX(t,e,r){const n=T6(t);try{const s=await function(o,l){const c=Fr(o),A=Gt.now(),u=l.reduce((h,m)=>h.add(m.key),Kr());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Eo(),p=Kr();return c.cs.getEntries(h,u).next(x=>{m=x,m.forEach((g,w)=>{w.isValidDocument()||(p=p.add(g))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{d=x;const g=[];for(const w of l){const b=KW(w,d.get(w.key).overlayedDocument);b!=null&&g.push(new TA(w.key,b,xU(b.value.mapValue),ds.exists(!0)))}return c.mutationQueue.addMutationBatch(h,A,g,l)}).next(x=>{f=x;const g=x.applyToLocalDocumentSet(d,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,g)})}).then(()=>({batchId:f.batchId,changes:FU(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let A=o.Ba[o.currentUser.toKey()];A||(A=new fs(Rr)),A=A.insert(l,c),o.Ba[o.currentUser.toKey()]=A}(n,s.batchId,r),await jx(n,s.changes),await Tx(n.remoteStore)}catch(s){const a=SS(s,"Failed to persist write");r.reject(a)}}async function B6(t,e){const r=Fr(t);try{const n=await QJ(r.localStore,e);e.targetChanges.forEach((s,a)=>{const o=r.Na.get(a);o&&(pr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?pr(o.va):s.removedDocuments.size>0&&(pr(o.va),o.va=!1))}),await jx(r,n,e)}catch(n){await Kh(n)}}function pk(t,e,r){const n=Fr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Fr(o);c.onlineState=l;let A=!1;c.queries.forEach((u,d)=>{for(const f of d.j_)f.Z_(l)&&(A=!0)}),A&&kS(c)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function BX(t,e,r){const n=Fr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),a=s&&s.key;if(a){let o=new fs(er.comparator);o=o.insert(a,As.newNoDocument(a,vr.min()));const l=Kr().add(a),c=new d2(vr.min(),new Map,new fs(Rr),o,l);await B6(n,c),n.Oa=n.Oa.remove(a),n.Na.delete(e),jS(n)}else await V_(n.localStore,e,!1).then(()=>K_(n,e,r)).catch(Kh)}async function SX(t,e){const r=Fr(t),n=e.batch.batchId;try{const s=await MJ(r.localStore,e);I6(r,n,null),S6(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await jx(r,s)}catch(s){await Kh(s)}}async function IX(t,e,r){const n=Fr(t);try{const s=await function(o,l){const c=Fr(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",A=>{let u;return c.mutationQueue.lookupMutationBatch(A,l).next(d=>(pr(d!==null),u=d.keys(),c.mutationQueue.removeMutationBatch(A,d))).next(()=>c.mutationQueue.performConsistencyCheck(A)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(A,u,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(A,u)).next(()=>c.localDocuments.getDocuments(A,u))})}(n.localStore,e);I6(n,e,r),S6(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await jx(n,s)}catch(s){await Kh(s)}}function S6(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function I6(t,e,r){const n=Fr(t);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function K_(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||F6(t,n)})}function F6(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(NS(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),jS(t))}function gk(t,e,r){for(const n of r)n instanceof C6?(t.La.addReference(n.key,e),FX(t,n)):n instanceof _6?(Ht("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||F6(t,n.key)):dr()}function FX(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ht("SyncEngine","New document in limbo: "+r),t.xa.add(n),jS(t))}function jS(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new er(pn.fromString(e)),n=t.qa.next();t.Na.set(n,new vX(r)),t.Oa=t.Oa.insert(r,n),x6(t.remoteStore,new lA(ul(Sx(r.path)),n,"TargetPurposeLimboResolution",ol.oe))}}async function jx(t,e,r){const n=Fr(t),s=[],a=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(A=>{var u;if((A||r)&&n.isPrimaryClient){const d=A?!A.fromCache:(u=r==null?void 0:r.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(A){s.push(A);const d=wS.Wi(c.targetId,A);a.push(d)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(c,A){const u=Fr(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>yt.forEach(A,f=>yt.forEach(f.$i,h=>u.persistence.referenceDelegate.addReference(d,f.targetId,h)).next(()=>yt.forEach(f.Ui,h=>u.persistence.referenceDelegate.removeReference(d,f.targetId,h)))))}catch(d){if(!xd(d))throw d;Ht("LocalStore","Failed to update sequence numbers: "+d)}for(const d of A){const f=d.targetId;if(!d.fromCache){const h=u.os.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);u.os=u.os.insert(f,p)}}}(n.localStore,a))}async function kX(t,e){const r=Fr(t);if(!r.currentUser.isEqual(e)){Ht("SyncEngine","User change. New user:",e.toKey());const n=await f6(r.localStore,e);r.currentUser=e,function(a,o){a.ka.forEach(l=>{l.forEach(c=>{c.reject(new Wt(Bt.CANCELLED,o))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await jx(r,n.hs)}}function TX(t,e){const r=Fr(t),n=r.Na.get(e);if(n&&n.va)return Kr().add(n.key);{let s=Kr();const a=r.Ma.get(e);if(!a)return s;for(const o of a){const l=r.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function k6(t){const e=Fr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=B6.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TX.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BX.bind(null,e),e.Ca.d_=mX.bind(null,e.eventManager),e.Ca.$a=pX.bind(null,e.eventManager),e}function T6(t){const e=Fr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SX.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IX.bind(null,e),e}class Hg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=p2(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return h6(this.persistence,new d6,e.initialUser,this.serializer)}Ga(e){return new u6(m2.Zr,this.serializer)}Wa(e){return new p6}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hg.provider={build:()=>new Hg};class jX extends Hg{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await T6(this.Ja.syncEngine),await Tx(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return h6(this.persistence,new d6,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new wJ(n,e.asyncQueue,r)}Ha(e,r){const n=new Wz(r,this.persistence);return new zz(e.asyncQueue,n)}Ga(e){const r=LJ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Gi.withCacheSize(this.cacheSizeBytes):Gi.DEFAULT;return new yS(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,JJ(),uy(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new p6}}class aw{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>pk(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=kX.bind(null,this.syncEngine),await dX(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new fX}()}createDatastore(e){const r=p2(e.databaseInfo.databaseId),n=function(a){return new WJ(a)}(e.databaseInfo);return function(a,o,l,c){return new ZJ(a,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,o,l){return new tX(n,s,a,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>pk(this.syncEngine,r,0),function(){return uk.D()?new uk:new GJ}())}createSyncEngine(e,r){return function(s,a,o,l,c,A,u){const d=new yX(s,a,o,l,c,A);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=Fr(s);Ht("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await kx(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}aw.provider={build:()=>new aw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ji("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PX{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Wt(Bt.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(s,a){const o=Fr(s),l={documents:a.map(d=>Qg(o.serializer,d))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,pn.emptyPath(),l,a.length),A=new Map;c.forEach(d=>{const f=tJ(o.serializer,d);A.set(f.key.toString(),f)});const u=[];return a.forEach(d=>{const f=A.get(d.toString());pr(!!f),u.push(f)}),u}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new nm(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const s=er.fromPath(n);this.mutations.push(new uS(s,this.precondition(s)))}),await async function(n,s){const a=Fr(n),o={writes:s.map(l=>Vg(a.serializer,l))};await a.Mo("Commit",a.serializer.databaseId,pn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw dr();r=vr.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Wt(Bt.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(vr.min())?ds.exists(!1):ds.updateTime(r):ds.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(vr.min()))throw new Wt(Bt.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ds.updateTime(r)}return ds.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RX{constructor(e,r,n,s,a){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=s,this.deferred=a,this._u=n.maxAttempts,this.t_=new bS(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new PX(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(s=>{this.lu(s)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Ex(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!OU(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DX{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Va.UNAUTHENTICATED,this.clientId=nS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{Ht("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ht("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ul;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=SS(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function tN(t,e){t.asyncQueue.verifyOperationInProgress(),Ht("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await f6(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function xk(t,e){t.asyncQueue.verifyOperationInProgress();const r=await LX(t);Ht("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>dk(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>dk(e.remoteStore,s)),t._onlineComponents=e}async function LX(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ht("FirestoreClient","Using user provided OfflineComponentProvider");try{await tN(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===Bt.FAILED_PRECONDITION||s.code===Bt.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;ed("Error using user provided cache. Falling back to memory cache: "+r),await tN(t,new Hg)}}else Ht("FirestoreClient","Using default OfflineComponentProvider"),await tN(t,new Hg);return t._offlineComponents}async function RS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ht("FirestoreClient","Using user provided OnlineComponentProvider"),await xk(t,t._uninitializedComponentsProvider._online)):(Ht("FirestoreClient","Using default OnlineComponentProvider"),await xk(t,new aw))),t._onlineComponents}function UX(t){return RS(t).then(e=>e.syncEngine)}function OX(t){return RS(t).then(e=>e.datastore)}async function iw(t){const e=await RS(t),r=e.eventManager;return r.onListen=wX.bind(null,e.syncEngine),r.onUnlisten=CX.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=bX.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=_X.bind(null,e.syncEngine),r}function MX(t,e,r={}){const n=new Ul;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,c,A){const u=new PS({next:f=>{u.Za(),o.enqueueAndForget(()=>FS(a,d));const h=f.docs.has(l);!h&&f.fromCache?A.reject(new Wt(Bt.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&c&&c.source==="server"?A.reject(new Wt(Bt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):A.resolve(f)},error:f=>A.reject(f)}),d=new TS(Sx(l.path),u,{includeMetadataChanges:!0,_a:!0});return IS(a,d)}(await iw(t),t.asyncQueue,e,r,n)),n.promise}function QX(t,e,r={}){const n=new Ul;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,c,A){const u=new PS({next:f=>{u.Za(),o.enqueueAndForget(()=>FS(a,d)),f.fromCache&&c.source==="server"?A.reject(new Wt(Bt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):A.resolve(f)},error:f=>A.reject(f)}),d=new TS(l,u,{includeMetadataChanges:!0,_a:!0});return IS(a,d)}(await iw(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j6(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P6(t,e,r){if(!r)throw new Wt(Bt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function R6(t,e,r,n){if(e===!0&&n===!0)throw new Wt(Bt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function yk(t){if(!er.isDocumentKey(t))throw new Wt(Bt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function wk(t){if(er.isDocumentKey(t))throw new Wt(Bt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function x2(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dr()}function Fa(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Wt(Bt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=x2(t);throw new Wt(Bt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Wt(Bt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Wt(Bt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}R6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=j6((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Wt(Bt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Wt(Bt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Wt(Bt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class v2{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bk({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Wt(Bt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Wt(Bt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bk(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new sU;switch(n.type){case"firstParty":return new Mz(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Wt(Bt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=vk.get(r);n&&(Ht("ComponentProvider","Removing Datastore"),vk.delete(r),n.terminate())}(this),Promise.resolve()}}function D6(t,e,r,n={}){var s;const a=(t=Fa(t,v2))._getSettings(),o=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&ed("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Va.MOCK_USER;else{l=nq(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const A=n.mockUserToken.sub||n.mockUserToken.user_id;if(!A)throw new Wt(Bt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Va(A)}t._authCredentials=new Lz(new nU(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new _c(this.firestore,e,this._query)}}class ka{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ka(this.firestore,e,this._key)}}class fA extends _c{constructor(e,r,n){super(e,r,Sx(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ka(this.firestore,null,new er(e))}withConverter(e){return new fA(this.firestore,e,this._path)}}function At(t,e,...r){if(t=js(t),P6("collection","path",e),t instanceof v2){const n=pn.fromString(e,...r);return wk(n),new fA(t,null,n)}{if(!(t instanceof ka||t instanceof fA))throw new Wt(Bt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return wk(n),new fA(t.firestore,null,n)}}function Tt(t,e,...r){if(t=js(t),arguments.length===1&&(e=nS.newId()),P6("doc","path",e),t instanceof v2){const n=pn.fromString(e,...r);return yk(n),new ka(t,null,new er(n))}{if(!(t instanceof ka||t instanceof fA))throw new Wt(Bt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return yk(n),new ka(t.firestore,t instanceof fA?t.converter:null,new er(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new bS(this,"async_queue_retry"),this.Vu=()=>{const n=uy();n&&Ht("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=uy();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=uy();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ul;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!xd(e))throw e;Ht("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw ji("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=BS.createAndSchedule(this,e,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&dr()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function Ck(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class ko extends v2{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Nk,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nk(e),this._firestoreClient=void 0,await e}}}function L6(t,e){const r=typeof t=="object"?t:qB(),n=typeof t=="string"?t:"(default)",s=HB(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=tq("firestore");a&&D6(s,...a)}return s}function $h(t){if(t._terminated)throw new Wt(Bt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||U6(t),t._firestoreClient}function U6(t){var e,r,n;const s=t._freezeSettings(),a=function(l,c,A,u){return new gW(l,c,A,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,j6(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new DX(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function O6(t,e){ed("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return VX(t,aw.provider,{build:n=>new jX(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function VX(t,e,r){if((t=Fa(t,ko))._firestoreClient||t._terminated)throw new Wt(Bt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Wt(Bt.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},U6(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ad(zs.fromBase64String(e))}catch(r){throw new Wt(Bt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ad(zs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Wt(Bt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new us(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Wt(Bt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Wt(Bt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Rr(this._lat,e._lat)||Rr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HX=/^__.*__$/;class KX{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new TA(e,this.data,this.fieldMask,r,this.fieldTransforms):new rm(e,this.data,r,this.fieldTransforms)}}class M6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new TA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Q6(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dr()}}class DS{constructor(e,r,n,s,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new DS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ow(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Q6(this.Cu)&&HX.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class qX{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||p2(e)}Qu(e,r,n,s=!1){return new DS({Cu:e,methodName:r,qu:n,path:us.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function am(t){const e=t._freezeSettings(),r=p2(t._databaseId);return new qX(t._databaseId,!!e.ignoreUndefinedProperties,r)}function N2(t,e,r,n,s,a={}){const o=t.Qu(a.merge||a.mergeFields?2:0,e,r,s);OS("Data must be an object, but it was:",o,n);const l=V6(n,o);let c,A;if(a.merge)c=new Ji(o.fieldMask),A=o.fieldTransforms;else if(a.mergeFields){const u=[];for(const d of a.mergeFields){const f=q_(e,d,r);if(!o.contains(f))throw new Wt(Bt.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);K6(u,f)||u.push(f)}c=new Ji(u),A=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,A=o.fieldTransforms;return new KX(new Ga(l),c,A)}class C2 extends y2{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof C2}}function LS(t,e,r,n){const s=t.Qu(1,e,r);OS("Data must be an object, but it was:",s,n);const a=[],o=Ga.empty();qh(n,(c,A)=>{const u=MS(e,c,r);A=js(A);const d=s.Nu(u);if(A instanceof C2)a.push(u);else{const f=Px(A,d);f!=null&&(a.push(u),o.set(u,f))}});const l=new Ji(a);return new M6(o,l,s.fieldTransforms)}function US(t,e,r,n,s,a){const o=t.Qu(1,e,r),l=[q_(e,n,r)],c=[s];if(a.length%2!=0)throw new Wt(Bt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<a.length;f+=2)l.push(q_(e,a[f])),c.push(a[f+1]);const A=[],u=Ga.empty();for(let f=l.length-1;f>=0;--f)if(!K6(A,l[f])){const h=l[f];let m=c[f];m=js(m);const p=o.Nu(h);if(m instanceof C2)A.push(h);else{const x=Px(m,p);x!=null&&(A.push(h),u.set(h,x))}}const d=new Ji(A);return new M6(u,d,o.fieldTransforms)}function GX(t,e,r,n=!1){return Px(r,t.Qu(n?4:3,e))}function Px(t,e){if(H6(t=js(t)))return OS("Unsupported field value:",e,t),V6(t,e);if(t instanceof y2)return function(n,s){if(!Q6(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const a=[];let o=0;for(const l of n){let c=Px(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=js(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return LW(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Gt.fromDate(n);return{timestampValue:O0(s.serializer,a)}}if(n instanceof Gt){const a=new Gt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:O0(s.serializer,a)}}if(n instanceof w2)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ad)return{bytesValue:HU(s.serializer,n._byteString)};if(n instanceof ka){const a=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:pS(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof b2)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return AS(l.serializer,c)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${x2(n)}`)}(t,e)}function V6(t,e){const r={};return fU(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qh(t,(n,s)=>{const a=Px(s,e.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function H6(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Gt||t instanceof w2||t instanceof ad||t instanceof ka||t instanceof y2||t instanceof b2)}function OS(t,e,r){if(!H6(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=x2(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function q_(t,e,r){if((e=js(e))instanceof zh)return e._internalPath;if(typeof e=="string")return MS(t,e);throw ow("Field path arguments must be of type string or ",t,!1,void 0,r)}const $X=new RegExp("[~\\*/\\[\\]]");function MS(t,e,r){if(e.search($X)>=0)throw ow(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new zh(...e.split("."))._internalPath}catch{throw ow(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function ow(t,e,r,n,s){const a=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(a||o)&&(c+=" (found",a&&(c+=` in field ${n}`),o&&(c+=` in document ${s}`),c+=")"),new Wt(Bt.INVALID_ARGUMENT,l+t+c)}function K6(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new ka(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(_2("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class zX extends lw{data(){return super.data()}}function _2(t,e){return typeof e=="string"?MS(t,e):e instanceof zh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Wt(Bt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class QS{}class E2 extends QS{}function Ot(t,e,...r){let n=[];e instanceof QS&&n.push(e),n=n.concat(r),function(a){const o=a.filter(c=>c instanceof B2).length,l=a.filter(c=>c instanceof Rx).length;if(o>1||o>0&&l>0)throw new Wt(Bt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Rx extends E2{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Rx(e,r,n)}_apply(e){const r=this._parse(e);return $6(e._query,r),new _c(e.firestore,e.converter,P_(e._query,r))}_parse(e){const r=am(e.firestore);return function(a,o,l,c,A,u,d){let f;if(A.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Wt(Bt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Ek(d,u);const h=[];for(const m of d)h.push(_k(c,a,m));f={arrayValue:{values:h}}}else f=_k(c,a,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Ek(d,u),f=GX(l,o,d,u==="in"||u==="not-in");return nn.create(A,u,f)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function $t(t,e,r){const n=e,s=_2("where",t);return Rx._create(s,n,r)}class B2 extends QS{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new B2(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:In.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let o=s;const l=a.getFlattenedFilters();for(const c of l)$6(o,c),o=P_(o,c)}(e._query,r),new _c(e.firestore,e.converter,P_(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class S2 extends E2{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new S2(e,r)}_apply(e){const r=function(s,a,o){if(s.startAt!==null)throw new Wt(Bt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Wt(Bt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ug(a,o)}(e._query,this._field,this._direction);return new _c(e.firestore,e.converter,function(s,a){const o=s.explicitOrderBy.concat([a]);return new tm(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Dr(t,e="asc"){const r=e,n=_2("orderBy",t);return S2._create(n,r)}class I2 extends E2{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new I2(e,r,n)}_apply(e){return new _c(e.firestore,e.converter,ew(e._query,this._limit,this._limitType))}}function G6(t){return I2._create("limit",t,"F")}function _k(t,e,r){if(typeof(r=js(r))=="string"){if(r==="")throw new Wt(Bt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!EU(e)&&r.indexOf("/")!==-1)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(pn.fromString(r));if(!er.isDocumentKey(n))throw new Wt(Bt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Dg(t,new er(n))}if(r instanceof ka)return Dg(t,r._key);throw new Wt(Bt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${x2(r)}.`)}function Ek(t,e){if(!Array.isArray(t)||t.length===0)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function $6(t,e){const r=function(s,a){for(const o of s)for(const l of o.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Wt(Bt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Wt(Bt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class VS{convertValue(e,r="none"){switch(Sh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ls(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(td(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw dr()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return qh(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,s;const a=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>ls(o.doubleValue));return new b2(a)}convertGeoPoint(e){return new w2(ls(e.latitude),ls(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=lS(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Pg(e));default:return null}}convertTimestamp(e){const r=BA(e);return new Gt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pn.fromString(e);pr(ZU(n));const s=new rd(n.get(1),n.get(3)),a=new er(n.popFirst(5));return s.isEqual(r)||ji(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class WX extends VS{constructor(e){super(),this.firestore=e}convertBytes(e){return new ad(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new ka(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class k2 extends lw{constructor(e,r,n,s,a,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Hp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(_2("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Hp extends k2{data(e={}){return super.data(e)}}class HS{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new rh(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Hp(this._firestore,this._userDataWriter,n.key,n,new rh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Wt(Bt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Hp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new rh(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>a||l.type!==3).map(l=>{const c=new Hp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new rh(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let A=-1,u=-1;return l.type!==0&&(A=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),u=o.indexOf(l.doc.key)),{type:JX(l.type),doc:c,oldIndex:A,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function JX(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dr()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t){t=Fa(t,ka);const e=Fa(t.firestore,ko);return MX($h(e),t._key).then(r=>W6(e,t,r))}class T2 extends VS{constructor(e){super(),this.firestore=e}convertBytes(e){return new ad(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new ka(this.firestore,null,r)}}function Ct(t){t=Fa(t,_c);const e=Fa(t.firestore,ko),r=$h(e),n=new T2(e);return q6(t._query),QX(r,t._query).then(s=>new HS(e,n,t,s))}function z6(t,e,r){t=Fa(t,ka);const n=Fa(t.firestore,ko),s=F2(t.converter,e,r);return im(n,[N2(am(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,ds.none())])}function Tr(t,e,r,...n){t=Fa(t,ka);const s=Fa(t.firestore,ko),a=am(s);let o;return o=typeof(e=js(e))=="string"||e instanceof zh?US(a,"updateDoc",t._key,e,r,n):LS(a,"updateDoc",t._key,e),im(s,[o.toMutation(t._key,ds.exists(!0))])}function dn(t){return im(Fa(t.firestore,ko),[new nm(t._key,ds.none())])}function Jr(t,e){const r=Fa(t.firestore,ko),n=Tt(t),s=F2(t.converter,e);return im(r,[N2(am(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,ds.exists(!1))]).then(()=>n)}function Q0(t,...e){var r,n,s;t=js(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Ck(e[o])||(a=e[o],o++);const l={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Ck(e[o])){const d=e[o];e[o]=(r=d.next)===null||r===void 0?void 0:r.bind(d),e[o+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),e[o+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let c,A,u;if(t instanceof ka)A=Fa(t.firestore,ko),u=Sx(t._key.path),c={next:d=>{e[o]&&e[o](W6(A,t,d))},error:e[o+1],complete:e[o+2]};else{const d=Fa(t,_c);A=Fa(d.firestore,ko),u=d._query;const f=new T2(A);c={next:h=>{e[o]&&e[o](new HS(A,f,d,h))},error:e[o+1],complete:e[o+2]},q6(t._query)}return function(f,h,m,p){const x=new PS(p),g=new TS(h,x,m);return f.asyncQueue.enqueueAndForget(async()=>IS(await iw(f),g)),()=>{x.Za(),f.asyncQueue.enqueueAndForget(async()=>FS(await iw(f),g))}}($h(A),u,l,c)}function im(t,e){return function(n,s){const a=new Ul;return n.asyncQueue.enqueueAndForget(async()=>EX(await UX(n),s,a)),a.promise}($h(t),e)}function W6(t,e,r){const n=r.docs.get(e._key),s=new T2(t);return new k2(t,s,e._key,n,new rh(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XX={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=am(e)}set(e,r,n){this._verifyNotCommitted();const s=_u(e,this._firestore),a=F2(s.converter,r,n),o=N2(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,ds.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const a=_u(e,this._firestore);let o;return o=typeof(r=js(r))=="string"||r instanceof zh?US(this._dataReader,"WriteBatch.update",a._key,r,n,s):LS(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(o.toMutation(a._key,ds.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=_u(e,this._firestore);return this._mutations=this._mutations.concat(new nm(r._key,ds.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Wt(Bt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _u(t,e){if((t=js(t)).firestore!==e)throw new Wt(Bt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6 extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=am(r)}get(r){const n=_u(r,this._firestore),s=new WX(this._firestore);return this._transaction.lookup([n._key]).then(a=>{if(!a||a.length!==1)return dr();const o=a[0];if(o.isFoundDocument())return new lw(this._firestore,s,o.key,o,n.converter);if(o.isNoDocument())return new lw(this._firestore,s,n._key,null,n.converter);throw dr()})}set(r,n,s){const a=_u(r,this._firestore),o=F2(a.converter,n,s),l=N2(this._dataReader,"Transaction.set",a._key,o,a.converter!==null,s);return this._transaction.set(a._key,l),this}update(r,n,s,...a){const o=_u(r,this._firestore);let l;return l=typeof(n=js(n))=="string"||n instanceof zh?US(this._dataReader,"Transaction.update",o._key,n,s,a):LS(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=_u(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=_u(e,this._firestore),n=new T2(this._firestore);return super.get(e).then(s=>new k2(this._firestore,n,r._key,s._document,new rh(!1,!1),r.converter))}}function ma(t,e,r){t=Fa(t,ko);const n=Object.assign(Object.assign({},XX),r);return function(a){if(a.maxAttempts<1)throw new Wt(Bt.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(a,o,l){const c=new Ul;return a.asyncQueue.enqueueAndForget(async()=>{const A=await OX(a);new RX(a.asyncQueue,A,l,o,c).au()}),c.promise}($h(t),s=>e(new X6(t,s)),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(t){return $h(t=Fa(t,ko)),new J6(t,e=>im(t,e))}(function(e,r=!0){(function(s){em=s})(Y0),T0(new Ch("firestore",(n,{instanceIdentifier:s,options:a})=>{const o=n.getProvider("app").getImmediate(),l=new ko(new Uz(n.getProvider("auth-internal")),new Vz(n.getProvider("app-check-internal")),function(A,u){if(!Object.prototype.hasOwnProperty.apply(A.options,["projectId"]))throw new Wt(Bt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rd(A.options.projectId,u)}(o,s),o);return a=Object.assign({useFetchStreams:r},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),$u(xF,"4.7.3",e),$u(xF,"4.7.3","esm2017")})();const YX=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:VS,Bytes:ad,CollectionReference:fA,DocumentReference:ka,DocumentSnapshot:k2,FieldPath:zh,FieldValue:y2,Firestore:ko,FirestoreError:Wt,GeoPoint:w2,Query:_c,QueryCompositeFilterConstraint:B2,QueryConstraint:E2,QueryDocumentSnapshot:Hp,QueryFieldFilterConstraint:Rx,QueryLimitConstraint:I2,QueryOrderByConstraint:S2,QuerySnapshot:HS,SnapshotMetadata:rh,Timestamp:Gt,Transaction:X6,VectorValue:b2,WriteBatch:J6,_AutoId:nS,_ByteString:zs,_DatabaseId:rd,_DocumentKey:er,_EmptyAuthCredentialsProvider:sU,_FieldPath:us,_cast:Fa,_logWarn:ed,_validateIsNotUsedTogether:R6,addDoc:Jr,collection:At,connectFirestoreEmulator:D6,deleteDoc:dn,doc:Tt,enableIndexedDbPersistence:O6,ensureFirestoreConfigured:$h,executeWrite:im,getDoc:Xa,getDocs:Ct,getFirestore:L6,limit:G6,onSnapshot:Q0,orderBy:Dr,query:Ot,runTransaction:ma,setDoc:z6,updateDoc:Tr,where:$t,writeBatch:Wh},Symbol.toStringTag,{value:"Module"})),ZX={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},Y6=KB(ZX),je=L6(Y6),Dx=JL(Y6);O6(je).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function eY(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,a]=N.useState(!1),[o,l]=N.useState(""),[c,A]=N.useState(!1),u=xx(),d=h=>{if(localStorage.setItem("role",h),h==="admin")return u("/admin");if(h==="vendedor_pollo")return u("/admin/salesV2");if(h==="vendedor_ropa")return u("/admin/salesClothes");if(h==="vendedor_dulces")return u("/admin/salesCandies")},f=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{A(!0);const m=await w$(Dx,t,r),p=m.user.uid,x=await Xa(Tt(je,"users",p));if(!x.exists()){l("Tu usuario no tiene perfil en la base de datos.");return}const g=x.data(),w=g.role||"",b=g.name||"";if(!["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].includes(w)){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),b&&localStorage.setItem("user_name",b),d(w)}catch(m){const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas.":p==="auth/user-not-found"?"Usuario no encontrado.":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde.":(m==null?void 0:m.message)||"Error al iniciar sesin.")}finally{A(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:f,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:s?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>a(h=>!h),children:s?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function zr({children:t,allowedRoles:e}){const[r,n]=N.useState(!0),[s,a]=N.useState(!1);return N.useEffect(()=>{const o=OL(Dx,async l=>{if(l){const c=Tt(je,"users",l.uid),A=await Xa(c);if(A.exists()){const u=A.data().role;a(e.includes(u))}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):s?t:i.jsx(Vd,{to:"/"})}function tY({role:t}){const e="/admin",r=({isActive:G})=>`block rounded px-3 py-2 text-sm ${G?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,n=xx(),[s,a]=N.useState(!1),[o,l]=N.useState(!1),[c,A]=N.useState(!1),[u,d]=N.useState(!1),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[x,g]=N.useState(!1),[w,b]=N.useState(!1),[k,P]=N.useState(!1),[L,E]=N.useState(!1),[_,B]=N.useState(!1),[M,F]=N.useState(!1),[T,O]=N.useState(!1),[Y,me]=N.useState(!1),[ae,fe]=N.useState(!1),[he,te]=N.useState(!1),pe=async()=>{await ZB(Dx),n("/")},Ie=({open:G,onClick:R,children:X})=>i.jsxs("button",{type:"button",onClick:R,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:X}),i.jsx("span",{className:"text-xs",children:G?"":""})]}),S=({open:G,onClick:R,title:X})=>i.jsxs("button",{type:"button",onClick:R,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:X}),i.jsx("span",{className:"text-xs",children:G?"":""})]}),I=t==="admin",V=t==="vendedor_pollo"||t==="vendedor",j=t==="vendedor_ropa",U=t==="vendedor_dulces";return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>a(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[I&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ie,{open:o,onClick:()=>l(G=>!G),children:"Pollos Bea"}),o&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:c,onClick:()=>A(G=>!G),title:"Inventarios"}),c&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/batches`,className:r,children:"Inventario Pollo"}),i.jsx(Er,{to:`${e}/paidBatches`,className:r,children:"Inventarios Pagados"})]}),i.jsx(S,{open:u,onClick:()=>d(G=>!G),title:"Finanzas"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/financialDashboard`,className:r,children:"Dashboard"}),i.jsx(Er,{to:`${e}/billing`,className:r,children:"Facturacion"}),i.jsx(Er,{to:`${e}/expenses`,className:r,children:"Gastos"}),i.jsx(Er,{to:`${e}/salesV2`,className:r,children:"Venta"}),i.jsx(Er,{to:`${e}/bills`,className:r,children:"Cierre"}),i.jsx(Er,{to:`${e}/billhistoric`,className:r,children:"Historial de Cierres"})]}),i.jsx(S,{open:f,onClick:()=>h(G=>!G),title:"Productos"}),f&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/products`,className:r,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ie,{open:m,onClick:()=>p(G=>!G),children:"Chiqui Look"}),m&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:x,onClick:()=>g(G=>!G),title:"Inventario"}),x&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/InventoryClothesBatches`,className:r,children:"Inventario Ropa"})}),i.jsx(S,{open:w,onClick:()=>b(G=>!G),title:"Productos"}),w&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),i.jsx(S,{open:k,onClick:()=>P(G=>!G),title:"Clientes"}),k&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})}),i.jsx(S,{open:L,onClick:()=>E(G=>!G),title:"Finanzas"}),L&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"})}),L&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/financialDashboardClothes`,className:r,children:"Dashboard Financiero"})}),L&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})}),L&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/ExpensesClothes`,className:r,children:"Gastos Ropa"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ie,{open:M,onClick:()=>F(G=>!G),children:"CandyShop"}),M&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:Y,onClick:()=>me(G=>!G),title:"Vendedores"}),Y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),Y&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsVendorsCandies`,className:r,children:"Sub ordenes"})}),i.jsx(S,{open:T,onClick:()=>O(G=>!G),title:"Inventario"}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/mainordersCandies`,className:r,children:"Ordenes Maestras"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/inventoryMainOrderCandies`,className:r,children:"Lista de Ordenes"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/inventoryCandies`,className:r,children:"Lista Productos"})}),T&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsCandies`,className:r,children:"Productos"})}),i.jsx(S,{open:ae,onClick:()=>fe(G=>!G),title:"Finanzas"}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/datacenter`,className:r,children:"Data Center"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/transactionCandies`,className:r,children:"Transacciones"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/reporteCierresCandies`,className:r,children:"Reporte Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/billingsCandies`,className:r,children:"Facturas"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/consolidatedVendors`,className:r,children:"Consolidado Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/dashboardCandies`,className:r,children:"Dashboard"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/customersCandies`,className:r,children:"Clientes"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/vendorsCandies`,className:r,children:"Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/expensesCandies`,className:r,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Ie,{open:he,onClick:()=>te(G=>!G),children:"Operaciones Otras"}),he&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/users`,className:r,children:"Usuarios"}),i.jsx(Er,{to:`${e}/fix`,className:r,children:"Fix de lotes"}),i.jsx(Er,{to:`${e}/transactionclose`,className:r,children:"Liquidaciones"})]})]})]}),V&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Ie,{open:u,onClick:()=>d(G=>!G),children:"Finanzas (Pollo)"}),u&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/salesV2`,className:r,children:"Venta"}),i.jsx(Er,{to:`${e}/bills`,className:r,children:"Cierre"})]})]}),U&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/transactionCandies`,className:r,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsVendorsCandies`,className:r,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/customersCandies`,className:r,children:"Clientes"})})]}),j&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Ie,{open:m,onClick:()=>p(G=>!G),children:"Operaciones Ropa"}),m&&i.jsxs("div",{className:"pb-2",children:[i.jsx(S,{open:L,onClick:()=>E(G=>!G),title:"Ventas"}),L&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Er,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"}),i.jsx(Er,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})]}),i.jsx(S,{open:w,onClick:()=>b(G=>!G),title:"Productos"}),w&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),i.jsx(S,{open:k,onClick:()=>P(G=>!G),title:"Clientes"}),k&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Er,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:pe,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(JD,{})})]})}function rN(...t){return t.filter(Boolean).join(" ")}function rY({role:t}){const e=xx(),r="/admin",n=t==="admin",s=t==="vendedor_pollo",a=t==="vendedor_dulces",[o,l]=N.useState(()=>s?"POLLO":a?"DULCES":"POLLO"),c=N.useMemo(()=>n?o==="POLLO"?[{key:"dash",label:"Dashboard",to:`${r}/financialDashboard`},{key:"inv",label:"Inventario",to:`${r}/batches`},{key:"cierre",label:"Cierre",to:`${r}/bills`},{key:"hist",label:"Historial",to:`${r}/billhistoric`}]:[{key:"dc",label:"Data",to:`${r}/datacenter`},{key:"ord",label:"rdenes",to:`${r}/productsVendorsCandies`},{key:"maes",label:"Maestras",to:`${r}/mainordersCandies`},{key:"cli",label:"Clientes",to:`${r}/customersCandies`},{key:"cier",label:"Cierres",to:`${r}/cierreVentasCandies`}]:s?[{key:"venta",label:"Venta",to:`${r}/salesV2`},{key:"inv",label:"Inventario",to:`${r}/batches`},{key:"cierre",label:"Cierre",to:`${r}/bills`}]:a?[{key:"venta",label:"Venta",to:`${r}/salesCandies`},{key:"ped",label:"Pedidos",to:`${r}/productsVendorsCandies`},{key:"cli",label:"Clientes",to:`${r}/customersCandies`},{key:"cier",label:"Cierre",to:`${r}/cierreVentasCandies`}]:[{key:"home",label:"Inicio",to:`${r}`}],[n,s,a,o]);N.useEffect(()=>{n&&c.length&&e(c[0].to,{replace:!0})},[o]);const A=async()=>{await ZB(Dx),e("/")},u=({isActive:d})=>rN("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",d?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[n?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>l("POLLO"),className:rN("px-3 py-2 rounded-2xl text-sm font-semibold",o==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Pollos Bea"}),i.jsx("button",{type:"button",onClick:()=>l("DULCES"),className:rN("px-3 py-2 rounded-2xl text-sm font-semibold",o==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"CandyShop"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:s?"Pollos Bea":a?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto flex items-center gap-2",children:i.jsx("button",{onClick:A,className:"px-3 py-2 rounded-2xl bg-red-500 text-white text-sm font-semibold shadow hover:bg-red-600",children:"Cerrar"})})]})}),i.jsx("main",{className:"flex-1 overflow-y-auto px-3 pt-3 pb-20",children:i.jsx(JD,{})}),i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:c.map(d=>i.jsx(Er,{to:d.to,className:u,children:d.label},d.key))})})]})}const Z6=6048e5,nY=864e5,Bk=Symbol.for("constructDateFrom");function Kl(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Bk in t?t[Bk](e):t instanceof Date?new t.constructor(e):new Date(e)}function Oi(t,e){return Kl(e||t,t)}function sY(t,e,r){const n=Oi(t,r==null?void 0:r.in);return isNaN(e)?Kl(t,NaN):(n.setDate(n.getDate()+e),n)}function aY(t,e,r){const n=Oi(t,r==null?void 0:r.in);if(isNaN(e))return Kl(t,NaN);const s=n.getDate(),a=Kl(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const o=a.getDate();return s>=o?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}let iY={};function j2(){return iY}function Kg(t,e){var l,c,A,u;const r=j2(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(A=r.locale)==null?void 0:A.options)==null?void 0:u.weekStartsOn)??0,s=Oi(t,e==null?void 0:e.in),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function cw(t,e){return Kg(t,{...e,weekStartsOn:1})}function eO(t,e){const r=Oi(t,e==null?void 0:e.in),n=r.getFullYear(),s=Kl(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=cw(s),o=Kl(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=cw(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function Sk(t){const e=Oi(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function oY(t,...e){const r=Kl.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function Ik(t,e){const r=Oi(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function lY(t,e,r){const[n,s]=oY(r==null?void 0:r.in,t,e),a=Ik(n),o=Ik(s),l=+a-Sk(a),c=+o-Sk(o);return Math.round((l-c)/nY)}function cY(t,e){const r=eO(t,e),n=Kl(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),cw(n)}function AY(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function uY(t){return!(!AY(t)&&typeof t!="number"||isNaN(+Oi(t)))}function Ec(t,e){const r=Oi(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Bc(t,e){const r=Oi(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function dY(t,e){const r=Oi(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const hY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fY=(t,e,r)=>{let n;const s=hY[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function nN(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const mY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},pY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},gY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xY={date:nN({formats:mY,defaultWidth:"full"}),time:nN({formats:pY,defaultWidth:"full"}),dateTime:nN({formats:gY,defaultWidth:"full"})},vY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yY=(t,e,r,n)=>vY[t];function $m(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return s[a]}}const wY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},NY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},CY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_Y={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},EY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},BY=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},SY={ordinalNumber:BY,era:$m({values:wY,defaultWidth:"wide"}),quarter:$m({values:bY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:$m({values:NY,defaultWidth:"wide"}),day:$m({values:CY,defaultWidth:"wide"}),dayPeriod:$m({values:_Y,defaultWidth:"wide",formattingValues:EY,defaultFormattingWidth:"wide"})};function zm(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?FY(l,d=>d.test(o)):IY(l,d=>d.test(o));let A;A=t.valueCallback?t.valueCallback(c):c,A=r.valueCallback?r.valueCallback(A):A;const u=e.slice(o.length);return{value:A,rest:u}}}function IY(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function FY(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function kY(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const TY=/^(\d+)(th|st|nd|rd)?/i,jY=/\d+/i,PY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},RY={any:[/^b/i,/^(a|c)/i]},DY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},LY={any:[/1/i,/2/i,/3/i,/4/i]},UY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},OY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},MY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},QY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},VY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},HY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},KY={ordinalNumber:kY({matchPattern:TY,parsePattern:jY,valueCallback:t=>parseInt(t,10)}),era:zm({matchPatterns:PY,defaultMatchWidth:"wide",parsePatterns:RY,defaultParseWidth:"any"}),quarter:zm({matchPatterns:DY,defaultMatchWidth:"wide",parsePatterns:LY,defaultParseWidth:"any",valueCallback:t=>t+1}),month:zm({matchPatterns:UY,defaultMatchWidth:"wide",parsePatterns:OY,defaultParseWidth:"any"}),day:zm({matchPatterns:MY,defaultMatchWidth:"wide",parsePatterns:QY,defaultParseWidth:"any"}),dayPeriod:zm({matchPatterns:VY,defaultMatchWidth:"any",parsePatterns:HY,defaultParseWidth:"any"})},qY={code:"en-US",formatDistance:fY,formatLong:xY,formatRelative:yY,localize:SY,match:KY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function GY(t,e){const r=Oi(t,e==null?void 0:e.in);return lY(r,dY(r))+1}function $Y(t,e){const r=Oi(t,e==null?void 0:e.in),n=+cw(r)-+cY(r);return Math.round(n/Z6)+1}function tO(t,e){var u,d,f,h;const r=Oi(t,e==null?void 0:e.in),n=r.getFullYear(),s=j2(),a=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(f=s.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,o=Kl((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Kg(o,e),c=Kl((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const A=Kg(c,e);return+r>=+l?n+1:+r>=+A?n:n-1}function zY(t,e){var l,c,A,u;const r=j2(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(A=r.locale)==null?void 0:A.options)==null?void 0:u.firstWeekContainsDate)??1,s=tO(t,e),a=Kl((e==null?void 0:e.in)||t,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),Kg(a,e)}function WY(t,e){const r=Oi(t,e==null?void 0:e.in),n=+Kg(r,e)-+zY(r,e);return Math.round(n/Z6)+1}function En(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const iu={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return En(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):En(r+1,2)},d(t,e){return En(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return En(t.getHours()%12||12,e.length)},H(t,e){return En(t.getHours(),e.length)},m(t,e){return En(t.getMinutes(),e.length)},s(t,e){return En(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return En(s,e.length)}},yf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Fk={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return iu.y(t,e)},Y:function(t,e,r,n){const s=tO(t,n),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return En(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):En(a,e.length)},R:function(t,e){const r=eO(t);return En(r,e.length)},u:function(t,e){const r=t.getFullYear();return En(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return En(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return En(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return iu.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return En(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=WY(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):En(s,e.length)},I:function(t,e,r){const n=$Y(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):En(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):iu.d(t,e)},D:function(t,e,r){const n=GY(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):En(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return En(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return En(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return En(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=yf.noon:n===0?s=yf.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=yf.evening:n>=12?s=yf.afternoon:n>=4?s=yf.morning:s=yf.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return iu.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):iu.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):En(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):En(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):iu.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):iu.s(t,e)},S:function(t,e){return iu.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Tk(n);case"XXXX":case"XX":return qd(n);case"XXXXX":case"XXX":default:return qd(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return Tk(n);case"xxxx":case"xx":return qd(n);case"xxxxx":case"xxx":default:return qd(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+kk(n,":");case"OOOO":default:return"GMT"+qd(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+kk(n,":");case"zzzz":default:return"GMT"+qd(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return En(n,e.length)},T:function(t,e,r){return En(+t,e.length)}};function kk(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+e+En(a,2)}function Tk(t,e){return t%60===0?(t>0?"-":"+")+En(Math.abs(t)/60,2):qd(t,e)}function qd(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=En(Math.trunc(n/60),2),a=En(n%60,2);return r+s+e+a}const jk=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},rO=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},JY=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return jk(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",jk(n,e)).replace("{{time}}",rO(s,e))},XY={p:rO,P:JY},YY=/^D+$/,ZY=/^Y+$/,eZ=["D","DD","YY","YYYY"];function tZ(t){return YY.test(t)}function rZ(t){return ZY.test(t)}function nZ(t,e,r){const n=sZ(t,e,r);if(console.warn(n),eZ.includes(t))throw new RangeError(n)}function sZ(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const aZ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,iZ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,oZ=/^'([^]*?)'?$/,lZ=/''/g,cZ=/[a-zA-Z]/;function sr(t,e,r){var u,d,f,h;const n=j2(),s=n.locale??qY,a=n.firstWeekContainsDate??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??0,l=Oi(t,r==null?void 0:r.in);if(!uY(l))throw new RangeError("Invalid time value");let c=e.match(iZ).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=XY[p];return x(m,s.formatLong)}return m}).join("").match(aZ).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:AZ(m)};if(Fk[p])return{isToken:!0,value:m};if(p.match(cZ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const A={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(rZ(p)||tZ(p))&&nZ(p,e,String(t));const x=Fk[p[0]];return x(l,p,s.localize,A)}).join("")}function AZ(t){const e=t.match(oZ);return e?e[1].replace(lZ,"'"):t}function nO(t,e,r){return sY(t,-14,r)}function uZ(t,e,r){return aY(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var G_=function(t,e){return G_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},G_(t,e)};function zl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");G_(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var $_=function(){return $_=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},$_.apply(this,arguments)};function Ii(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{A(n.next(u))}catch(d){o(d)}}function c(u){try{A(n.throw(u))}catch(d){o(d)}}function A(u){u.done?a(u.value):s(u.value).then(l,c)}A((n=n.apply(t,[])).next())})}function ci(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(A){return function(u){return c([A,u])}}function c(A){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(a=A[0]&2?s.return:A[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,A[1])).done)return a;switch(s=0,a&&(A=[A[0]&2,a.value]),A[0]){case 0:case 1:a=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,s=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!a||A[1]>a[0]&&A[1]<a[3])){r.label=A[1];break}if(A[0]===6&&r.label<a[1]){r.label=a[1],a=A;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(A);break}a[2]&&r.ops.pop(),r.trys.pop();continue}A=e.call(t,r)}catch(u){A=[6,u],s=0}finally{n=a=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Lv(t,e,r){if(arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||e)}var SA=function(){function t(e,r,n,s){this.left=e,this.top=r,this.width=n,this.height=s}return t.prototype.add=function(e,r,n,s){return new t(this.left+e,this.top+r,this.width+n,this.height+s)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(s){return s.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),P2=function(t,e){return SA.fromClientRect(t,e.getBoundingClientRect())},dZ=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),s=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new SA(0,0,n,s)},R2=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=t.charCodeAt(r++);(a&64512)===56320?e.push(((s&1023)<<10)+(a&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},Vs=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},Pk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Uv=0;Uv<Pk.length;Uv++)hZ[Pk.charCodeAt(Uv)]=Uv;var Rk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gp=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Ov=0;Ov<Rk.length;Ov++)gp[Rk.charCodeAt(Ov)]=Ov;var fZ=function(t){var e=t.length*.75,r=t.length,n,s=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=gp[t.charCodeAt(n)],o=gp[t.charCodeAt(n+1)],l=gp[t.charCodeAt(n+2)],c=gp[t.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},mZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},pZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},ch=5,KS=11,sN=2,gZ=KS-ch,sO=65536>>ch,xZ=1<<ch,aN=xZ-1,vZ=1024>>ch,yZ=sO+vZ,wZ=yZ,bZ=32,NZ=wZ+bZ,CZ=65536>>KS,_Z=1<<gZ,EZ=_Z-1,Dk=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},BZ=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},SZ=function(t,e){var r=fZ(t),n=Array.isArray(r)?pZ(r):new Uint32Array(r),s=Array.isArray(r)?mZ(r):new Uint16Array(r),a=24,o=Dk(s,a/2,n[4]/2),l=n[5]===2?Dk(s,(a+n[4])/2):BZ(n,Math.ceil((a+n[4])/4));return new IZ(n[0],n[1],n[2],n[3],o,l)},IZ=function(){function t(e,r,n,s,a,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>ch],r=(r<<sN)+(e&aN),this.data[r];if(e<=65535)return r=this.index[sO+(e-55296>>ch)],r=(r<<sN)+(e&aN),this.data[r];if(e<this.highStart)return r=NZ-CZ+(e>>KS),r=this.index[r],r+=e>>ch&EZ,r=this.index[r],r=(r<<sN)+(e&aN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),Lk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",FZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Mv=0;Mv<Lk.length;Mv++)FZ[Lk.charCodeAt(Mv)]=Mv;var kZ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Uk=50,TZ=1,aO=2,iO=3,jZ=4,PZ=5,Ok=7,oO=8,Mk=9,Fu=10,z_=11,Qk=12,W_=13,RZ=14,xp=15,J_=16,Qv=17,Wm=18,DZ=19,Vk=20,X_=21,Jm=22,iN=23,wf=24,vo=25,vp=26,yp=27,bf=28,LZ=29,Xd=30,UZ=31,Vv=32,Hv=33,Y_=34,Z_=35,eE=36,qg=37,tE=38,dy=39,hy=40,oN=41,lO=42,OZ=43,MZ=[9001,65288],cO="!",tn="",Kv="",rE=SZ(kZ),qc=[Xd,eE],nE=[TZ,aO,iO,PZ],AO=[Fu,oO],Hk=[yp,vp],QZ=nE.concat(AO),Kk=[tE,dy,hy,Y_,Z_],VZ=[xp,W_],HZ=function(t,e){e===void 0&&(e="strict");var r=[],n=[],s=[];return t.forEach(function(a,o){var l=rE.get(a);if(l>Uk?(s.push(!0),l-=Uk):s.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(a)!==-1)return n.push(o),r.push(J_);if(l===jZ||l===z_){if(o===0)return n.push(o),r.push(Xd);var c=r[o-1];return QZ.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(Xd))}if(n.push(o),l===UZ)return r.push(e==="strict"?X_:qg);if(l===lO||l===LZ)return r.push(Xd);if(l===OZ)return a>=131072&&a<=196605||a>=196608&&a<=262141?r.push(qg):r.push(Xd);r.push(l)}),[n,r,s]},lN=function(t,e,r,n){var s=n[r];if(Array.isArray(t)?t.indexOf(s)!==-1:t===s)for(var a=r;a<=n.length;){a++;var o=n[a];if(o===e)return!0;if(o!==Fu)break}if(s===Fu)for(var a=r;a>0;){a--;var l=n[a];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==Fu)break}if(l!==Fu)break}return!1},qk=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===Fu)r--;else return n}return 0},KZ=function(t,e,r,n,s){if(r[n]===0)return tn;var a=n-1;if(Array.isArray(s)&&s[a]===!0)return tn;var o=a-1,l=a+1,c=e[a],A=o>=0?e[o]:0,u=e[l];if(c===aO&&u===iO)return tn;if(nE.indexOf(c)!==-1)return cO;if(nE.indexOf(u)!==-1||AO.indexOf(u)!==-1)return tn;if(qk(a,e)===oO)return Kv;if(rE.get(t[a])===z_||(c===Vv||c===Hv)&&rE.get(t[l])===z_||c===Ok||u===Ok||c===Mk||[Fu,W_,xp].indexOf(c)===-1&&u===Mk||[Qv,Wm,DZ,wf,bf].indexOf(u)!==-1||qk(a,e)===Jm||lN(iN,Jm,a,e)||lN([Qv,Wm],X_,a,e)||lN(Qk,Qk,a,e))return tn;if(c===Fu)return Kv;if(c===iN||u===iN)return tn;if(u===J_||c===J_)return Kv;if([W_,xp,X_].indexOf(u)!==-1||c===RZ||A===eE&&VZ.indexOf(c)!==-1||c===bf&&u===eE||u===Vk||qc.indexOf(u)!==-1&&c===vo||qc.indexOf(c)!==-1&&u===vo||c===yp&&[qg,Vv,Hv].indexOf(u)!==-1||[qg,Vv,Hv].indexOf(c)!==-1&&u===vp||qc.indexOf(c)!==-1&&Hk.indexOf(u)!==-1||Hk.indexOf(c)!==-1&&qc.indexOf(u)!==-1||[yp,vp].indexOf(c)!==-1&&(u===vo||[Jm,xp].indexOf(u)!==-1&&e[l+1]===vo)||[Jm,xp].indexOf(c)!==-1&&u===vo||c===vo&&[vo,bf,wf].indexOf(u)!==-1)return tn;if([vo,bf,wf,Qv,Wm].indexOf(u)!==-1)for(var d=a;d>=0;){var f=e[d];if(f===vo)return tn;if([bf,wf].indexOf(f)!==-1)d--;else break}if([yp,vp].indexOf(u)!==-1)for(var d=[Qv,Wm].indexOf(c)!==-1?o:a;d>=0;){var f=e[d];if(f===vo)return tn;if([bf,wf].indexOf(f)!==-1)d--;else break}if(tE===c&&[tE,dy,Y_,Z_].indexOf(u)!==-1||[dy,Y_].indexOf(c)!==-1&&[dy,hy].indexOf(u)!==-1||[hy,Z_].indexOf(c)!==-1&&u===hy||Kk.indexOf(c)!==-1&&[Vk,vp].indexOf(u)!==-1||Kk.indexOf(u)!==-1&&c===yp||qc.indexOf(c)!==-1&&qc.indexOf(u)!==-1||c===wf&&qc.indexOf(u)!==-1||qc.concat(vo).indexOf(c)!==-1&&u===Jm&&MZ.indexOf(t[l])===-1||qc.concat(vo).indexOf(u)!==-1&&c===Wm)return tn;if(c===oN&&u===oN){for(var h=r[a],m=1;h>0&&(h--,e[h]===oN);)m++;if(m%2!==0)return tn}return c===Vv&&u===Hv?tn:Kv},qZ=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=HZ(t,e.lineBreak),n=r[0],s=r[1],a=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(s=s.map(function(l){return[vo,Xd,lO].indexOf(l)!==-1?qg:l}));var o=e.wordBreak==="keep-all"?a.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,s,o]},GZ=function(){function t(e,r,n,s){this.codePoints=e,this.required=r===cO,this.start=n,this.end=s}return t.prototype.slice=function(){return Vs.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),$Z=function(t,e){var r=R2(t),n=qZ(r,e),s=n[0],a=n[1],o=n[2],l=r.length,c=0,A=0;return{next:function(){if(A>=l)return{done:!0,value:null};for(var u=tn;A<l&&(u=KZ(r,a,s,++A,o))===tn;);if(u!==tn||A===l){var d=new GZ(r,u,c,A);return c=A,{value:d,done:!1}}return{done:!0,value:null}}}},zZ=1,WZ=2,Lx=4,Gk=8,Aw=10,$k=47,Kp=92,JZ=9,XZ=32,qv=34,Xm=61,YZ=35,ZZ=36,eee=37,Gv=39,$v=40,Ym=41,tee=95,$i=45,ree=33,nee=60,see=62,aee=64,iee=91,oee=93,lee=61,cee=123,zv=63,Aee=125,zk=124,uee=126,dee=128,Wk=65533,cN=42,nh=43,hee=44,fee=58,mee=59,Gg=46,pee=0,gee=8,xee=11,vee=14,yee=31,wee=127,oc=-1,uO=48,dO=97,hO=101,bee=102,Nee=117,Cee=122,fO=65,mO=69,pO=70,_ee=85,Eee=90,di=function(t){return t>=uO&&t<=57},Bee=function(t){return t>=55296&&t<=57343},Nf=function(t){return di(t)||t>=fO&&t<=pO||t>=dO&&t<=bee},See=function(t){return t>=dO&&t<=Cee},Iee=function(t){return t>=fO&&t<=Eee},Fee=function(t){return See(t)||Iee(t)},kee=function(t){return t>=dee},Wv=function(t){return t===Aw||t===JZ||t===XZ},uw=function(t){return Fee(t)||kee(t)||t===tee},Jk=function(t){return uw(t)||di(t)||t===$i},Tee=function(t){return t>=pee&&t<=gee||t===xee||t>=vee&&t<=yee||t===wee},gu=function(t,e){return t!==Kp?!1:e!==Aw},Jv=function(t,e,r){return t===$i?uw(e)||gu(e,r):uw(t)?!0:!!(t===Kp&&gu(t,e))},AN=function(t,e,r){return t===nh||t===$i?di(e)?!0:e===Gg&&di(r):di(t===Gg?e:t)},jee=function(t){var e=0,r=1;(t[e]===nh||t[e]===$i)&&(t[e]===$i&&(r=-1),e++);for(var n=[];di(t[e]);)n.push(t[e++]);var s=n.length?parseInt(Vs.apply(void 0,n),10):0;t[e]===Gg&&e++;for(var a=[];di(t[e]);)a.push(t[e++]);var o=a.length,l=o?parseInt(Vs.apply(void 0,a),10):0;(t[e]===mO||t[e]===hO)&&e++;var c=1;(t[e]===nh||t[e]===$i)&&(t[e]===$i&&(c=-1),e++);for(var A=[];di(t[e]);)A.push(t[e++]);var u=A.length?parseInt(Vs.apply(void 0,A),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*u)},Pee={type:2},Ree={type:3},Dee={type:4},Lee={type:13},Uee={type:8},Oee={type:21},Mee={type:9},Qee={type:10},Vee={type:11},Hee={type:12},Kee={type:14},Xv={type:23},qee={type:1},Gee={type:25},$ee={type:24},zee={type:26},Wee={type:27},Jee={type:28},Xee={type:29},Yee={type:31},sE={type:32},gO=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(R2(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==sE;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case qv:return this.consumeStringToken(qv);case YZ:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(Jk(r)||gu(n,s)){var a=Jv(r,n,s)?WZ:zZ,o=this.consumeName();return{type:5,value:o,flags:a}}break;case ZZ:if(this.peekCodePoint(0)===Xm)return this.consumeCodePoint(),Lee;break;case Gv:return this.consumeStringToken(Gv);case $v:return Pee;case Ym:return Ree;case cN:if(this.peekCodePoint(0)===Xm)return this.consumeCodePoint(),Kee;break;case nh:if(AN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case hee:return Dee;case $i:var l=e,c=this.peekCodePoint(0),A=this.peekCodePoint(1);if(AN(l,c,A))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(Jv(l,c,A))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===$i&&A===see)return this.consumeCodePoint(),this.consumeCodePoint(),$ee;break;case Gg:if(AN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case $k:if(this.peekCodePoint(0)===cN)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===cN&&(u=this.consumeCodePoint(),u===$k))return this.consumeToken();if(u===oc)return this.consumeToken()}break;case fee:return zee;case mee:return Wee;case nee:if(this.peekCodePoint(0)===ree&&this.peekCodePoint(1)===$i&&this.peekCodePoint(2)===$i)return this.consumeCodePoint(),this.consumeCodePoint(),Gee;break;case aee:var d=this.peekCodePoint(0),f=this.peekCodePoint(1),h=this.peekCodePoint(2);if(Jv(d,f,h)){var o=this.consumeName();return{type:7,value:o}}break;case iee:return Jee;case Kp:if(gu(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case oee:return Xee;case lee:if(this.peekCodePoint(0)===Xm)return this.consumeCodePoint(),Uee;break;case cee:return Vee;case Aee:return Hee;case Nee:case _ee:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===nh&&(Nf(p)||p===zv)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case zk:if(this.peekCodePoint(0)===Xm)return this.consumeCodePoint(),Mee;if(this.peekCodePoint(0)===zk)return this.consumeCodePoint(),Oee;break;case uee:if(this.peekCodePoint(0)===Xm)return this.consumeCodePoint(),Qee;break;case oc:return sE}return Wv(e)?(this.consumeWhiteSpace(),Yee):di(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):uw(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Vs(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();Nf(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===zv&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(Vs.apply(void 0,e.map(function(c){return c===zv?uO:c})),16),a=parseInt(Vs.apply(void 0,e.map(function(c){return c===zv?pO:c})),16);return{type:30,start:s,end:a}}var o=parseInt(Vs.apply(void 0,e),16);if(this.peekCodePoint(0)===$i&&Nf(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];Nf(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var a=parseInt(Vs.apply(void 0,l),16);return{type:30,start:o,end:a}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===$v?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===$v?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===oc)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Gv||r===qv){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===oc||this.peekCodePoint(0)===Ym)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),Xv)}for(;;){var s=this.consumeCodePoint();if(s===oc||s===Ym)return{type:22,value:Vs.apply(void 0,e)};if(Wv(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===oc||this.peekCodePoint(0)===Ym?(this.consumeCodePoint(),{type:22,value:Vs.apply(void 0,e)}):(this.consumeBadUrlRemnants(),Xv);if(s===qv||s===Gv||s===$v||Tee(s))return this.consumeBadUrlRemnants(),Xv;if(s===Kp)if(gu(s,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Xv;else e.push(s)}},t.prototype.consumeWhiteSpace=function(){for(;Wv(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===Ym||e===oc)return;gu(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var s=Math.min(r,e);n+=Vs.apply(void 0,this._value.splice(0,s)),e-=s}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var s=this._value[n];if(s===oc||s===void 0||s===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(s===Aw)return this._value.splice(0,n),qee;if(s===Kp){var a=this._value[n+1];a!==oc&&a!==void 0&&(a===Aw?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):gu(s,a)&&(r+=this.consumeStringSlice(n),r+=Vs(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Lx,n=this.peekCodePoint(0);for((n===nh||n===$i)&&e.push(this.consumeCodePoint());di(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===Gg&&di(s))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Gk;di(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var a=this.peekCodePoint(2);if((n===mO||n===hO)&&((s===nh||s===$i)&&di(a)||di(s)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Gk;di(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[jee(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],s=this.peekCodePoint(0),a=this.peekCodePoint(1),o=this.peekCodePoint(2);if(Jv(s,a,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return s===eee?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(Nf(e)){for(var r=Vs(e);Nf(this.peekCodePoint(0))&&r.length<6;)r+=Vs(this.consumeCodePoint());Wv(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||Bee(n)||n>1114111?Wk:n}return e===oc?Wk:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(Jk(r))e+=Vs(r);else if(gu(r,this.peekCodePoint(0)))e+=Vs(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),xO=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new gO;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||ete(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?sE:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Ux=function(t){return t.type===15},om=function(t){return t.type===17},Pn=function(t){return t.type===20},Zee=function(t){return t.type===0},aE=function(t,e){return Pn(t)&&t.value===e},vO=function(t){return t.type!==31},V0=function(t){return t.type!==31&&t.type!==4},Sc=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},ete=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},id=function(t){return t.type===17||t.type===15},ea=function(t){return t.type===16||id(t)},yO=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},za={type:17,number:0,flags:Lx},qS={type:16,number:50,flags:Lx},ku={type:16,number:100,flags:Lx},wp=function(t,e,r){var n=t[0],s=t[1];return[zn(n,e),zn(typeof s<"u"?s:n,r)]},zn=function(t,e){if(t.type===16)return t.number/100*e;if(Ux(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},wO="deg",bO="grad",NO="rad",CO="turn",D2={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case wO:return Math.PI*e.number/180;case bO:return Math.PI/200*e.number;case NO:return e.number;case CO:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},_O=function(t){return t.type===15&&(t.unit===wO||t.unit===bO||t.unit===NO||t.unit===CO)},EO=function(t){var e=t.filter(Pn).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[za,za];case"to top":case"bottom":return ll(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[za,ku];case"to right":case"left":return ll(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[ku,ku];case"to bottom":case"top":return ll(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[ku,za];case"to left":case"right":return ll(270)}return 0},ll=function(t){return Math.PI*t/180},Wu={name:"color",parse:function(t,e){if(e.type===18){var r=tte[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),s=e.value.substring(1,2),a=e.value.substring(2,3);return Tu(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),s=e.value.substring(1,2),a=e.value.substring(2,3),o=e.value.substring(3,4);return Tu(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),s=e.value.substring(2,4),a=e.value.substring(4,6);return Tu(parseInt(n,16),parseInt(s,16),parseInt(a,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),s=e.value.substring(2,4),a=e.value.substring(4,6),o=e.value.substring(6,8);return Tu(parseInt(n,16),parseInt(s,16),parseInt(a,16),parseInt(o,16)/255)}}if(e.type===20){var l=mA[e.value.toUpperCase()];if(typeof l<"u")return l}return mA.TRANSPARENT}},Ju=function(t){return(255&t)===0},ba=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,s=255&t>>24;return e<255?"rgba("+s+","+n+","+r+","+e/255+")":"rgb("+s+","+n+","+r+")"},Tu=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},Xk=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},Yk=function(t,e){var r=e.filter(V0);if(r.length===3){var n=r.map(Xk),s=n[0],a=n[1],o=n[2];return Tu(s,a,o,1)}if(r.length===4){var l=r.map(Xk),s=l[0],a=l[1],o=l[2],c=l[3];return Tu(s,a,o,c)}return 0};function uN(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var Zk=function(t,e){var r=e.filter(V0),n=r[0],s=r[1],a=r[2],o=r[3],l=(n.type===17?ll(n.number):D2.parse(t,n))/(Math.PI*2),c=ea(s)?s.number/100:0,A=ea(a)?a.number/100:0,u=typeof o<"u"&&ea(o)?zn(o,1):1;if(c===0)return Tu(A*255,A*255,A*255,1);var d=A<=.5?A*(c+1):A+c-A*c,f=A*2-d,h=uN(f,d,l+1/3),m=uN(f,d,l),p=uN(f,d,l-1/3);return Tu(h*255,m*255,p*255,u)},tte={hsl:Zk,hsla:Zk,rgb:Yk,rgba:Yk},qp=function(t,e){return Wu.parse(t,xO.create(e).parseComponentValue())},mA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},rte={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Pn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},nte={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},L2=function(t,e){var r=Wu.parse(t,e[0]),n=e[1];return n&&ea(n)?{color:r,stop:n}:{color:r,stop:null}},eT=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=za),n.stop===null&&(n.stop=ku);for(var s=[],a=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=zn(l,e);c>a?s.push(c):s.push(a),a=c}else s.push(null)}for(var A=null,o=0;o<s.length;o++){var u=s[o];if(u===null)A===null&&(A=o);else if(A!==null){for(var d=o-A,f=s[A-1],h=(u-f)/(d+1),m=1;m<=d;m++)s[A+m-1]=h*m;A=null}}return t.map(function(p,x){var g=p.color;return{color:g,stop:Math.max(Math.min(1,s[x]/e),0)}})},ste=function(t,e,r){var n=e/2,s=r/2,a=zn(t[0],e)-n,o=s-zn(t[1],r);return(Math.atan2(o,a)+Math.PI*2)%(Math.PI*2)},ate=function(t,e,r){var n=typeof t=="number"?t:ste(t,e,r),s=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),a=e/2,o=r/2,l=s/2,c=Math.sin(n-Math.PI/2)*l,A=Math.cos(n-Math.PI/2)*l;return[s,a-A,a+A,o-c,o+c]},Fl=function(t,e){return Math.sqrt(t*t+e*e)},tT=function(t,e,r,n,s){var a=[[0,0],[0,e],[t,0],[t,e]];return a.reduce(function(o,l){var c=l[0],A=l[1],u=Fl(r-c,n-A);return(s?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:l,optimumDistance:u}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},ite=function(t,e,r,n,s){var a=0,o=0;switch(t.size){case 0:t.shape===0?a=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(a=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(t.shape===0)a=o=Math.min(Fl(e,r),Fl(e,r-s),Fl(e-n,r),Fl(e-n,r-s));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(e),Math.abs(e-n)),c=tT(n,s,e,r,!0),A=c[0],u=c[1];a=Fl(A-e,(u-r)/l),o=l*a}break;case 1:t.shape===0?a=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(a=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(t.shape===0)a=o=Math.max(Fl(e,r),Fl(e,r-s),Fl(e-n,r),Fl(e-n,r-s));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(e),Math.abs(e-n)),d=tT(n,s,e,r,!1),A=d[0],u=d[1];a=Fl(A-e,(u-r)/l),o=l*a}break}return Array.isArray(t.size)&&(a=zn(t.size[0],n),o=t.size.length===2?zn(t.size[1],s):a),[a,o]},ote=function(t,e){var r=ll(180),n=[];return Sc(e).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&o.value==="to"){r=EO(s);return}else if(_O(o)){r=D2.parse(t,o);return}}var l=L2(t,s);n.push(l)}),{angle:r,stops:n,type:1}},Yv=function(t,e){var r=ll(180),n=[];return Sc(e).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=EO(s);return}else if(_O(o)){r=(D2.parse(t,o)+ll(270))%ll(360);return}}var l=L2(t,s);n.push(l)}),{angle:r,stops:n,type:1}},lte=function(t,e){var r=ll(180),n=[],s=1,a=0,o=3,l=[];return Sc(e).forEach(function(c,A){var u=c[0];if(A===0){if(Pn(u)&&u.value==="linear"){s=1;return}else if(Pn(u)&&u.value==="radial"){s=2;return}}if(u.type===18){if(u.name==="from"){var d=Wu.parse(t,u.values[0]);n.push({stop:za,color:d})}else if(u.name==="to"){var d=Wu.parse(t,u.values[0]);n.push({stop:ku,color:d})}else if(u.name==="color-stop"){var f=u.values.filter(V0);if(f.length===2){var d=Wu.parse(t,f[1]),h=f[0];om(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:d})}}}}),s===1?{angle:(r+ll(180))%ll(360),stops:n,type:s}:{size:o,shape:a,stops:n,position:l,type:s}},BO="closest-side",SO="farthest-side",IO="closest-corner",FO="farthest-corner",kO="circle",TO="ellipse",jO="cover",PO="contain",cte=function(t,e){var r=0,n=3,s=[],a=[];return Sc(e).forEach(function(o,l){var c=!0;if(l===0){var A=!1;c=o.reduce(function(d,f){if(A)if(Pn(f))switch(f.value){case"center":return a.push(qS),d;case"top":case"left":return a.push(za),d;case"right":case"bottom":return a.push(ku),d}else(ea(f)||id(f))&&a.push(f);else if(Pn(f))switch(f.value){case kO:return r=0,!1;case TO:return r=1,!1;case"at":return A=!0,!1;case BO:return n=0,!1;case jO:case SO:return n=1,!1;case PO:case IO:return n=2,!1;case FO:return n=3,!1}else if(id(f)||ea(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)}if(c){var u=L2(t,o);s.push(u)}}),{size:n,shape:r,stops:s,position:a,type:2}},Zv=function(t,e){var r=0,n=3,s=[],a=[];return Sc(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(u,d){if(Pn(d))switch(d.value){case"center":return a.push(qS),!1;case"top":case"left":return a.push(za),!1;case"right":case"bottom":return a.push(ku),!1}else if(ea(d)||id(d))return a.push(d),!1;return u},c):l===1&&(c=o.reduce(function(u,d){if(Pn(d))switch(d.value){case kO:return r=0,!1;case TO:return r=1,!1;case PO:case BO:return n=0,!1;case SO:return n=1,!1;case IO:return n=2,!1;case jO:case FO:return n=3,!1}else if(id(d)||ea(d))return Array.isArray(n)||(n=[]),n.push(d),!1;return u},c)),c){var A=L2(t,o);s.push(A)}}),{size:n,shape:r,stops:s,position:a,type:2}},Ate=function(t){return t.type===1},ute=function(t){return t.type===2},GS={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=RO[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function dte(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!RO[t.name])}var RO={"linear-gradient":ote,"-moz-linear-gradient":Yv,"-ms-linear-gradient":Yv,"-o-linear-gradient":Yv,"-webkit-linear-gradient":Yv,"radial-gradient":cte,"-moz-radial-gradient":Zv,"-ms-radial-gradient":Zv,"-o-radial-gradient":Zv,"-webkit-radial-gradient":Zv,"-webkit-gradient":lte},hte={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return V0(n)&&dte(n)}).map(function(n){return GS.parse(t,n)})}},fte={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Pn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},mte={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Sc(e).map(function(r){return r.filter(ea)}).map(yO)}},pte={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Sc(e).map(function(r){return r.filter(Pn).map(function(n){return n.value}).join(" ")}).map(gte)}},gte=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},v0;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(v0||(v0={}));var xte={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Sc(e).map(function(r){return r.filter(vte)})}},vte=function(t){return Pn(t)||ea(t)},U2=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},yte=U2("top"),wte=U2("right"),bte=U2("bottom"),Nte=U2("left"),O2=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return yO(r.filter(ea))}}},Cte=O2("top-left"),_te=O2("top-right"),Ete=O2("bottom-right"),Bte=O2("bottom-left"),M2=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Ste=M2("top"),Ite=M2("right"),Fte=M2("bottom"),kte=M2("left"),Q2=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Ux(r)?r.number:0}}},Tte=Q2("top"),jte=Q2("right"),Pte=Q2("bottom"),Rte=Q2("left"),Dte={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Lte={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Ute={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Pn).reduce(function(r,n){return r|Ote(n.value)},0)}},Ote=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Mte={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Qte={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},dw;(function(t){t.NORMAL="normal",t.STRICT="strict"})(dw||(dw={}));var Vte={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return dw.STRICT;case"normal":default:return dw.NORMAL}}},Hte={name:"line-height",initialValue:"normal",prefix:!1,type:4},rT=function(t,e){return Pn(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:ea(t)?zn(t,e):e},Kte={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:GS.parse(t,e)}},qte={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},iE={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},V2=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},Gte=V2("top"),$te=V2("right"),zte=V2("bottom"),Wte=V2("left"),Jte={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Pn).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Xte={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},H2=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Yte=H2("top"),Zte=H2("right"),ere=H2("bottom"),tre=H2("left"),rre={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},nre={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},sre={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&aE(e[0],"none")?[]:Sc(e).map(function(r){for(var n={color:mA.TRANSPARENT,offsetX:za,offsetY:za,blur:za},s=0,a=0;a<r.length;a++){var o=r[a];id(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:n.blur=o,s++):n.color=Wu.parse(t,o)}return n})}},are={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},ire={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=cre[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},ore=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},lre=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var s=e[4],a=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,s,a,o,l]:null},cre={matrix:ore,matrix3d:lre},nT={type:16,number:50,flags:Lx},Are=[nT,nT],ure={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(ea);return r.length!==2?Are:[r[0],r[1]]}},dre={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Gp;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Gp||(Gp={}));var hre={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Gp.BREAK_ALL;case"keep-all":return Gp.KEEP_ALL;case"normal":default:return Gp.NORMAL}}},fre={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(om(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},DO={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},mre={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return om(e)?e.number:1}},pre={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},gre={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Pn).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},xre={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},vre={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},yre={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(om(e))return e.number;if(Pn(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},wre={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Pn).map(function(r){return r.value})}},bre={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},da=function(t,e){return(t&e)!==0},Nre={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},Cre={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],s=e.filter(vO),a=0;a<s.length;a++){var o=s[a],l=s[a+1];if(o.type===20){var c=l&&om(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},_re={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(vO),s=0;s<n.length;s++){var a=n[s],o=n[s+1];if(Pn(a)&&a.value!=="none"){var l=o&&om(o)?o.number:0;r.push({counter:a.value,reset:l})}}return r}},Ere={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Ux).map(function(r){return DO.parse(t,r)})}},Bre={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],s=e.filter(Zee);if(s.length%2!==0)return null;for(var a=0;a<s.length;a+=2){var o=s[a].value,l=s[a+1].value;n.push({open:o,close:l})}return n}},sT=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},Sre={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&aE(e[0],"none")?[]:Sc(e).map(function(r){for(var n={color:255,offsetX:za,offsetY:za,blur:za,spread:za,inset:!1},s=0,a=0;a<r.length;a++){var o=r[a];aE(o,"inset")?n.inset=!0:id(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:s===2?n.blur=o:n.spread=o,s++):n.color=Wu.parse(t,o)}return n})}},Ire={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(Pn).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},Fre={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},kre={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Ux(e)?e.number:0}},Tre=function(){function t(e,r){var n,s;this.animationDuration=nr(e,Ere,r.animationDuration),this.backgroundClip=nr(e,rte,r.backgroundClip),this.backgroundColor=nr(e,nte,r.backgroundColor),this.backgroundImage=nr(e,hte,r.backgroundImage),this.backgroundOrigin=nr(e,fte,r.backgroundOrigin),this.backgroundPosition=nr(e,mte,r.backgroundPosition),this.backgroundRepeat=nr(e,pte,r.backgroundRepeat),this.backgroundSize=nr(e,xte,r.backgroundSize),this.borderTopColor=nr(e,yte,r.borderTopColor),this.borderRightColor=nr(e,wte,r.borderRightColor),this.borderBottomColor=nr(e,bte,r.borderBottomColor),this.borderLeftColor=nr(e,Nte,r.borderLeftColor),this.borderTopLeftRadius=nr(e,Cte,r.borderTopLeftRadius),this.borderTopRightRadius=nr(e,_te,r.borderTopRightRadius),this.borderBottomRightRadius=nr(e,Ete,r.borderBottomRightRadius),this.borderBottomLeftRadius=nr(e,Bte,r.borderBottomLeftRadius),this.borderTopStyle=nr(e,Ste,r.borderTopStyle),this.borderRightStyle=nr(e,Ite,r.borderRightStyle),this.borderBottomStyle=nr(e,Fte,r.borderBottomStyle),this.borderLeftStyle=nr(e,kte,r.borderLeftStyle),this.borderTopWidth=nr(e,Tte,r.borderTopWidth),this.borderRightWidth=nr(e,jte,r.borderRightWidth),this.borderBottomWidth=nr(e,Pte,r.borderBottomWidth),this.borderLeftWidth=nr(e,Rte,r.borderLeftWidth),this.boxShadow=nr(e,Sre,r.boxShadow),this.color=nr(e,Dte,r.color),this.direction=nr(e,Lte,r.direction),this.display=nr(e,Ute,r.display),this.float=nr(e,Mte,r.cssFloat),this.fontFamily=nr(e,xre,r.fontFamily),this.fontSize=nr(e,vre,r.fontSize),this.fontStyle=nr(e,bre,r.fontStyle),this.fontVariant=nr(e,wre,r.fontVariant),this.fontWeight=nr(e,yre,r.fontWeight),this.letterSpacing=nr(e,Qte,r.letterSpacing),this.lineBreak=nr(e,Vte,r.lineBreak),this.lineHeight=nr(e,Hte,r.lineHeight),this.listStyleImage=nr(e,Kte,r.listStyleImage),this.listStylePosition=nr(e,qte,r.listStylePosition),this.listStyleType=nr(e,iE,r.listStyleType),this.marginTop=nr(e,Gte,r.marginTop),this.marginRight=nr(e,$te,r.marginRight),this.marginBottom=nr(e,zte,r.marginBottom),this.marginLeft=nr(e,Wte,r.marginLeft),this.opacity=nr(e,mre,r.opacity);var a=nr(e,Jte,r.overflow);this.overflowX=a[0],this.overflowY=a[a.length>1?1:0],this.overflowWrap=nr(e,Xte,r.overflowWrap),this.paddingTop=nr(e,Yte,r.paddingTop),this.paddingRight=nr(e,Zte,r.paddingRight),this.paddingBottom=nr(e,ere,r.paddingBottom),this.paddingLeft=nr(e,tre,r.paddingLeft),this.paintOrder=nr(e,Ire,r.paintOrder),this.position=nr(e,nre,r.position),this.textAlign=nr(e,rre,r.textAlign),this.textDecorationColor=nr(e,pre,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=nr(e,gre,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=nr(e,sre,r.textShadow),this.textTransform=nr(e,are,r.textTransform),this.transform=nr(e,ire,r.transform),this.transformOrigin=nr(e,ure,r.transformOrigin),this.visibility=nr(e,dre,r.visibility),this.webkitTextStrokeColor=nr(e,Fre,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=nr(e,kre,r.webkitTextStrokeWidth),this.wordBreak=nr(e,hre,r.wordBreak),this.zIndex=nr(e,fre,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return Ju(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return da(this.display,4)||da(this.display,33554432)||da(this.display,268435456)||da(this.display,536870912)||da(this.display,67108864)||da(this.display,134217728)},t}(),jre=function(){function t(e,r){this.content=nr(e,Nre,r.content),this.quotes=nr(e,Bre,r.quotes)}return t}(),aT=function(){function t(e,r){this.counterIncrement=nr(e,Cre,r.counterIncrement),this.counterReset=nr(e,_re,r.counterReset)}return t}(),nr=function(t,e,r){var n=new gO,s=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(s);var a=new xO(n.read());switch(e.type){case 2:var o=a.parseComponentValue();return e.parse(t,Pn(o)?o.value:e.initialValue);case 0:return e.parse(t,a.parseComponentValue());case 1:return e.parse(t,a.parseComponentValues());case 4:return a.parseComponentValue();case 3:switch(e.format){case"angle":return D2.parse(t,a.parseComponentValue());case"color":return Wu.parse(t,a.parseComponentValue());case"image":return GS.parse(t,a.parseComponentValue());case"length":var l=a.parseComponentValue();return id(l)?l:za;case"length-percentage":var c=a.parseComponentValue();return ea(c)?c:za;case"time":return DO.parse(t,a.parseComponentValue())}break}},Pre="data-html2canvas-debug",Rre=function(t){var e=t.getAttribute(Pre);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},oE=function(t,e){var r=Rre(t);return r===1||e===r},Ic=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,oE(r,3))debugger;this.styles=new Tre(e,window.getComputedStyle(r,null)),AE(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=P2(this.context,r),oE(r,4)&&(this.flags|=16)}return t}(),Dre="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",iT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bp=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var e1=0;e1<iT.length;e1++)bp[iT.charCodeAt(e1)]=e1;var Lre=function(t){var e=t.length*.75,r=t.length,n,s=0,a,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=bp[t.charCodeAt(n)],o=bp[t.charCodeAt(n+1)],l=bp[t.charCodeAt(n+2)],c=bp[t.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},Ure=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},Ore=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Ah=5,$S=11,dN=2,Mre=$S-Ah,LO=65536>>Ah,Qre=1<<Ah,hN=Qre-1,Vre=1024>>Ah,Hre=LO+Vre,Kre=Hre,qre=32,Gre=Kre+qre,$re=65536>>$S,zre=1<<Mre,Wre=zre-1,oT=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Jre=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},Xre=function(t,e){var r=Lre(t),n=Array.isArray(r)?Ore(r):new Uint32Array(r),s=Array.isArray(r)?Ure(r):new Uint16Array(r),a=24,o=oT(s,a/2,n[4]/2),l=n[5]===2?oT(s,(a+n[4])/2):Jre(n,Math.ceil((a+n[4])/4));return new Yre(n[0],n[1],n[2],n[3],o,l)},Yre=function(){function t(e,r,n,s,a,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Ah],r=(r<<dN)+(e&hN),this.data[r];if(e<=65535)return r=this.index[LO+(e-55296>>Ah)],r=(r<<dN)+(e&hN),this.data[r];if(e<this.highStart)return r=Gre-$re+(e>>$S),r=this.index[r],r+=e>>Ah&Wre,r=this.index[r],r=(r<<dN)+(e&hN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),lT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zre=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var t1=0;t1<lT.length;t1++)Zre[lT.charCodeAt(t1)]=t1;var ene=1,fN=2,mN=3,cT=4,AT=5,tne=7,uT=8,pN=9,gN=10,dT=11,hT=12,fT=13,mT=14,xN=15,rne=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=t.charCodeAt(r++);(a&64512)===56320?e.push(((s&1023)<<10)+(a&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},nne=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},sne=Xre(Dre),el="",vN="",ane=function(t){return sne.get(t)},ine=function(t,e,r){var n=r-2,s=e[n],a=e[r-1],o=e[r];if(a===fN&&o===mN)return el;if(a===fN||a===mN||a===cT||o===fN||o===mN||o===cT)return vN;if(a===uT&&[uT,pN,dT,hT].indexOf(o)!==-1||(a===dT||a===pN)&&(o===pN||o===gN)||(a===hT||a===gN)&&o===gN||o===fT||o===AT||o===tne||a===ene)return el;if(a===fT&&o===mT){for(;s===AT;)s=e[--n];if(s===mT)return el}if(a===xN&&o===xN){for(var l=0;s===xN;)l++,s=e[--n];if(l%2===0)return el}return vN},one=function(t){var e=rne(t),r=e.length,n=0,s=0,a=e.map(ane);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=el;n<r&&(o=ine(e,a,++n))===el;);if(o!==el||n===r){var l=nne.apply(null,e.slice(s,n));return s=n,{value:l,done:!1}}return{done:!0,value:null}}}},lne=function(t){for(var e=one(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},cne=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),a=Math.round(s.height);if(t.body.removeChild(n),a===e)return!0}}return!1},Ane=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,s=R2(n.data).map(function(c){return Vs(c)}),a=0,o={},l=s.every(function(c,A){r.setStart(n,a),r.setEnd(n,a+c.length);var u=r.getBoundingClientRect();a+=c.length;var d=u.x>o.x||u.y>o.y;return o=u,A===0?!0:d});return t.body.removeChild(e),l},une=function(){return typeof new Image().crossOrigin<"u"},dne=function(){return typeof new XMLHttpRequest().responseType=="string"},hne=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},pT=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},fne=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,a=e.toDataURL();s.src=a;var o=lE(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),gT(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var A=t.createElement("div");return A.style.backgroundImage="url("+a+")",A.style.height=r+"px",pT(c)?gT(lE(r,r,0,0,A)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),pT(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},lE=function(t,e,r,n,s){var a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"svg"),l=document.createElementNS(a,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},gT=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Qa={get SUPPORT_RANGE_BOUNDS(){var t=cne(document);return Object.defineProperty(Qa,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Qa.SUPPORT_RANGE_BOUNDS&&Ane(document);return Object.defineProperty(Qa,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=hne(document);return Object.defineProperty(Qa,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?fne(document):Promise.resolve(!1);return Object.defineProperty(Qa,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=une();return Object.defineProperty(Qa,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=dne();return Object.defineProperty(Qa,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Qa,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Qa,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},$p=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),mne=function(t,e,r,n){var s=xne(e,r),a=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Qa.SUPPORT_RANGE_BOUNDS){var c=xT(n,o,l.length).getClientRects();if(c.length>1){var A=zS(l),u=0;A.forEach(function(f){a.push(new $p(f,SA.fromDOMRectList(t,xT(n,u+o,f.length).getClientRects()))),u+=f.length})}else a.push(new $p(l,SA.fromDOMRectList(t,c)))}else{var d=n.splitText(l.length);a.push(new $p(l,pne(t,n))),n=d}else Qa.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),a},pne=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var s=e.parentNode;if(s){s.replaceChild(n,e);var a=P2(t,n);return n.firstChild&&s.replaceChild(n.firstChild,n),a}}return SA.EMPTY},xT=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(t,e),s.setEnd(t,e+r),s},zS=function(t){if(Qa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return lne(t)},gne=function(t,e){if(Qa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return yne(t,e)},xne=function(t,e){return e.letterSpacing!==0?zS(t):gne(t,e)},vne=[32,160,4961,65792,65793,4153,4241],yne=function(t,e){for(var r=$Z(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],s,a=function(){if(s.value){var o=s.value.slice(),l=R2(o),c="";l.forEach(function(A){vne.indexOf(A)===-1?c+=Vs(A):(c.length&&n.push(c),n.push(Vs(A)),c="")}),c.length&&n.push(c)}};!(s=r.next()).done;)a();return n},wne=function(){function t(e,r,n){this.text=bne(r.data,n.textTransform),this.textBounds=mne(e,this.text,n,r)}return t}(),bne=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(Nne,Cne);case 2:return t.toUpperCase();default:return t}},Nne=/(^|\s|:|-|\(|\))([a-z])/g,Cne=function(t,e,r){return t.length>0?e+r.toUpperCase():t},UO=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return e}(Ic),OO=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return e}(Ic),MO=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this,a=new XMLSerializer,o=P2(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(a.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return e}(Ic),QO=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Ic),cE=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return e}(Ic),_ne=[{type:15,flags:0,unit:"px",number:3}],Ene=[{type:16,flags:0,number:50}],Bne=function(t){return t.width>t.height?new SA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new SA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},Sne=function(t){var e=t.type===Ine?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},hw="checkbox",fw="radio",Ine="password",vT=707406591,WS=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=Sne(n),(s.type===hw||s.type===fw)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=Bne(s.bounds)),s.type){case hw:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=_ne;break;case fw:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=Ene;break}return s}return e}(Ic),VO=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this,a=n.options[n.selectedIndex||0];return s.value=a&&a.text||"",s}return e}(Ic),HO=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Ic),KO=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=GO(r,n.contentWindow.document.documentElement);var a=n.contentWindow.document.documentElement?qp(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):mA.TRANSPARENT,o=n.contentWindow.document.body?qp(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):mA.TRANSPARENT;s.backgroundColor=Ju(a)?Ju(o)?s.styles.backgroundColor:o:a}}catch{}return s}return e}(Ic),Fne=["OL","UL","MENU"],fy=function(t,e,r,n){for(var s=e.firstChild,a=void 0;s;s=a)if(a=s.nextSibling,$O(s)&&s.data.trim().length>0)r.textNodes.push(new wne(t,s,r.styles));else if(o0(s))if(XO(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return fy(t,l,r,n)});else{var o=qO(t,s);o.styles.isVisible()&&(kne(s,o,n)?o.flags|=4:Tne(o.styles)&&(o.flags|=2),Fne.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?fy(t,s.shadowRoot,o,n):!mw(s)&&!zO(s)&&!pw(s)&&fy(t,s,o,n))}},qO=function(t,e){return uE(e)?new UO(t,e):WO(e)?new OO(t,e):zO(e)?new MO(t,e):jne(e)?new QO(t,e):Pne(e)?new cE(t,e):Rne(e)?new WS(t,e):pw(e)?new VO(t,e):mw(e)?new HO(t,e):JO(e)?new KO(t,e):new Ic(t,e)},GO=function(t,e){var r=qO(t,e);return r.flags|=4,fy(t,e,r,r),r},kne=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||JS(t)&&r.styles.isTransparent()},Tne=function(t){return t.isPositioned()||t.isFloating()},$O=function(t){return t.nodeType===Node.TEXT_NODE},o0=function(t){return t.nodeType===Node.ELEMENT_NODE},AE=function(t){return o0(t)&&typeof t.style<"u"&&!my(t)},my=function(t){return typeof t.className=="object"},jne=function(t){return t.tagName==="LI"},Pne=function(t){return t.tagName==="OL"},Rne=function(t){return t.tagName==="INPUT"},Dne=function(t){return t.tagName==="HTML"},zO=function(t){return t.tagName==="svg"},JS=function(t){return t.tagName==="BODY"},WO=function(t){return t.tagName==="CANVAS"},yT=function(t){return t.tagName==="VIDEO"},uE=function(t){return t.tagName==="IMG"},JO=function(t){return t.tagName==="IFRAME"},wT=function(t){return t.tagName==="STYLE"},Lne=function(t){return t.tagName==="SCRIPT"},mw=function(t){return t.tagName==="TEXTAREA"},pw=function(t){return t.tagName==="SELECT"},XO=function(t){return t.tagName==="SLOT"},bT=function(t){return t.tagName.indexOf("-")>0},Une=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,s=e.counterReset,a=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(a=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return a&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),NT={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},CT={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},One={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Mne={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Cf=function(t,e,r,n,s,a){return t<e||t>r?$g(t,s,a.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+a},YO=function(t,e,r,n){var s="";do r||t--,s=n(t)+s,t/=e;while(t*e>=e);return s},Ms=function(t,e,r,n,s){var a=r-e+1;return(t<0?"-":"")+(YO(Math.abs(t),a,n,function(o){return Vs(Math.floor(o%a)+e)})+s)},Pd=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return YO(Math.abs(t),n,!1,function(s){return e[Math.floor(s%n)]})+r},Hf=1,du=2,hu=4,Np=8,Gc=function(t,e,r,n,s,a){if(t<-9999||t>9999)return $g(t,4,s.length>0);var o=Math.abs(t),l=s;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var A=o%10;A===0&&da(a,Hf)&&l!==""?l=e[A]+l:A>1||A===1&&c===0||A===1&&c===1&&da(a,du)||A===1&&c===1&&da(a,hu)&&t>100||A===1&&c>1&&da(a,Np)?l=e[A]+(c>0?r[c-1]:"")+l:A===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},_T="",ET="",BT="",yN="",$g=function(t,e,r){var n=r?". ":"",s=r?"":"",a=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Ms(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Pd(t,"",s);case 6:return Cf(t,1,3999,NT,3,n).toLowerCase();case 7:return Cf(t,1,3999,NT,3,n);case 8:return Ms(t,945,969,!1,n);case 9:return Ms(t,97,122,!1,n);case 10:return Ms(t,65,90,!1,n);case 11:return Ms(t,1632,1641,!0,n);case 12:case 49:return Cf(t,1,9999,CT,3,n);case 35:return Cf(t,1,9999,CT,3,n).toLowerCase();case 13:return Ms(t,2534,2543,!0,n);case 14:case 30:return Ms(t,6112,6121,!0,n);case 15:return Pd(t,"",s);case 16:return Pd(t,"",s);case 17:case 48:return Gc(t,"",_T,"",s,du|hu|Np);case 47:return Gc(t,"",ET,"",s,Hf|du|hu|Np);case 42:return Gc(t,"",_T,"",s,du|hu|Np);case 41:return Gc(t,"",ET,"",s,Hf|du|hu|Np);case 26:return Gc(t,"","",BT,s,0);case 25:return Gc(t,"","",BT,s,Hf|du|hu);case 31:return Gc(t,"","",yN,a,Hf|du|hu);case 33:return Gc(t,"","",yN,a,0);case 32:return Gc(t,"","",yN,a,Hf|du|hu);case 18:return Ms(t,2406,2415,!0,n);case 20:return Cf(t,1,19999,Mne,3,n);case 21:return Ms(t,2790,2799,!0,n);case 22:return Ms(t,2662,2671,!0,n);case 22:return Cf(t,1,10999,One,3,n);case 23:return Pd(t,"");case 24:return Pd(t,"");case 27:return Ms(t,3302,3311,!0,n);case 28:return Pd(t,"",s);case 29:return Pd(t,"",s);case 34:return Ms(t,3792,3801,!0,n);case 37:return Ms(t,6160,6169,!0,n);case 38:return Ms(t,4160,4169,!0,n);case 39:return Ms(t,2918,2927,!0,n);case 40:return Ms(t,1776,1785,!0,n);case 43:return Ms(t,3046,3055,!0,n);case 44:return Ms(t,3174,3183,!0,n);case 45:return Ms(t,3664,3673,!0,n);case 46:return Ms(t,3872,3881,!0,n);case 3:default:return Ms(t,48,57,!0,n)}},ZO="data-html2canvas-ignore",ST=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new Une,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,s=Qne(e,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var a=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=s.contentWindow,c=l.document,A=Kne(s).then(function(){return Ii(n,void 0,void 0,function(){var u,d;return ci(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(zne),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),u=this.options.onclone,d=this.clonedReferenceElement,typeof d>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Hne(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,d)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(Gne(document.doctype)+"<html></html>"),$ne(this.referenceElement.ownerDocument,a,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),A},t.prototype.createElementClone=function(e){if(oE(e,2))debugger;if(WO(e))return this.createCanvasClone(e);if(yT(e))return this.createVideoClone(e);if(wT(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return uE(r)&&(uE(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),bT(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return wN(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(a,o){return o&&typeof o.cssText=="string"?a+o.cssText:a},""),s=e.cloneNode(!1);return s.textContent=n,s}}catch(a){if(this.context.logger.error("Unable to access cssRules property",a),a.name!=="SecurityError")throw a}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var s=e.cloneNode(!1);try{s.width=e.width,s.height=e.height;var a=e.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&a)o.putImageData(a.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return s},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var s=e.ownerDocument.createElement("canvas");return s.width=e.offsetWidth,s.height=e.offsetHeight,s},t.prototype.appendChildNode=function(e,r,n){(!o0(r)||!Lne(r)&&!r.hasAttribute(ZO)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!o0(r)||!wT(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var s=this,a=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;a;a=a.nextSibling)if(o0(a)&&XO(a)&&typeof a.assignedNodes=="function"){var o=a.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,n)})}else this.appendChildNode(r,a,n)},t.prototype.cloneNode=function(e,r){if($O(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&o0(e)&&(AE(e)||my(e))){var s=this.createElementClone(e);s.style.transitionProperty="none";var a=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&AE(s)&&(this.clonedReferenceElement=s),JS(s)&&Xne(s);var c=this.counters.parse(new aT(this.context,a)),A=this.resolvePseudoContent(e,s,o,zp.BEFORE);bT(e)&&(r=!0),yT(e)||this.cloneChildNodes(e,s,r),A&&s.insertBefore(A,s.firstChild);var u=this.resolvePseudoContent(e,s,l,zp.AFTER);return u&&s.appendChild(u),this.counters.pop(c),(a&&(this.options.copyStyles||my(e))&&!JO(e)||r)&&wN(a,s),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([s,e.scrollLeft,e.scrollTop]),(mw(e)||pw(e))&&(mw(s)||pw(s))&&(s.value=e.value),s}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,s){var a=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new aT(this.context,n));var c=new jre(this.context,n),A=l.createElement("html2canvaspseudoelement");wN(n,A),c.content.forEach(function(d){if(d.type===0)A.appendChild(l.createTextNode(d.value));else if(d.type===22){var f=l.createElement("img");f.src=d.value,f.style.opacity="1",A.appendChild(f)}else if(d.type===18){if(d.name==="attr"){var h=d.values.filter(Pn);h.length&&A.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(d.name==="counter"){var m=d.values.filter(V0),p=m[0],x=m[1];if(p&&Pn(p)){var g=a.counters.getCounterValue(p.value),w=x&&Pn(x)?iE.parse(a.context,x.value):3;A.appendChild(l.createTextNode($g(g,w,!1)))}}else if(d.name==="counters"){var b=d.values.filter(V0),p=b[0],k=b[1],x=b[2];if(p&&Pn(p)){var P=a.counters.getCounterValues(p.value),L=x&&Pn(x)?iE.parse(a.context,x.value):3,E=k&&k.type===0?k.value:"",_=P.map(function(F){return $g(F,L,!1)}).join(E);A.appendChild(l.createTextNode(_))}}}else if(d.type===20)switch(d.value){case"open-quote":A.appendChild(l.createTextNode(sT(c.quotes,a.quoteDepth++,!0)));break;case"close-quote":A.appendChild(l.createTextNode(sT(c.quotes,--a.quoteDepth,!1)));break;default:A.appendChild(l.createTextNode(d.value))}}),A.className=dE+" "+hE;var u=s===zp.BEFORE?" "+dE:" "+hE;return my(r)?r.className.baseValue+=u:r.className+=u,A}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),zp;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(zp||(zp={}));var Qne=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(ZO,"true"),t.body.appendChild(r),r},Vne=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},Hne=function(t){return Promise.all([].slice.call(t.images,0).map(Vne))},Kne=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var a=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(a),e(t))},50)}})},qne=["all","d","content"],wN=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);qne.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},Gne=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},$ne=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},zne=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},Wne=":before",Jne=":after",dE="___html2canvas___pseudoelement_before",hE="___html2canvas___pseudoelement_after",IT=`{
    content: "" !important;
    display: none !important;
}`,Xne=function(t){Yne(t,"."+dE+Wne+IT+`
         .`+hE+Jne+IT)},Yne=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},eM=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),Zne=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(NN(e)||nse(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return Ii(this,void 0,void 0,function(){var r,n,s,a,o=this;return ci(this,function(l){switch(l.label){case 0:return r=eM.isSameOrigin(e),n=!bN(e)&&this._options.useCORS===!0&&Qa.SUPPORT_CORS_IMAGES&&!r,s=!bN(e)&&!r&&!NN(e)&&typeof this._options.proxy=="string"&&Qa.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!bN(e)&&!NN(e)&&!s&&!n?[2]:(a=e,s?[4,this.proxy(a)]:[3,2]);case 1:a=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,A){var u=new Image;u.onload=function(){return c(u)},u.onerror=A,(sse(a)||n)&&(u.crossOrigin="anonymous"),u.src=a,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return A("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=e.substring(0,256);return new Promise(function(a,o){var l=Qa.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")a(c.response);else{var d=new FileReader;d.addEventListener("load",function(){return a(d.result)},!1),d.addEventListener("error",function(f){return o(f)},!1),d.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var A=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+A+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var u=r._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+s)}}c.send()})},t}(),ese=/^data:image\/svg\+xml/i,tse=/^data:image\/.*;base64,/i,rse=/^data:image\/.*/i,nse=function(t){return Qa.SUPPORT_SVG_DRAWING||!ase(t)},bN=function(t){return rse.test(t)},sse=function(t){return tse.test(t)},NN=function(t){return t.substr(0,4)==="blob"},ase=function(t){return t.substr(-3).toLowerCase()==="svg"||ese.test(t)},rr=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),_f=function(t,e,r){return new rr(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},r1=function(){function t(e,r,n,s){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=s}return t.prototype.subdivide=function(e,r){var n=_f(this.start,this.startControl,e),s=_f(this.startControl,this.endControl,e),a=_f(this.endControl,this.end,e),o=_f(n,s,e),l=_f(s,a,e),c=_f(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,a,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),al=function(t){return t.type===1},ise=function(){function t(e){var r=e.styles,n=e.bounds,s=wp(r.borderTopLeftRadius,n.width,n.height),a=s[0],o=s[1],l=wp(r.borderTopRightRadius,n.width,n.height),c=l[0],A=l[1],u=wp(r.borderBottomRightRadius,n.width,n.height),d=u[0],f=u[1],h=wp(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((a+c)/n.width),x.push((m+d)/n.width),x.push((o+p)/n.height),x.push((A+f)/n.height);var g=Math.max.apply(Math,x);g>1&&(a/=g,o/=g,c/=g,A/=g,d/=g,f/=g,m/=g,p/=g);var w=n.width-c,b=n.height-f,k=n.width-d,P=n.height-p,L=r.borderTopWidth,E=r.borderRightWidth,_=r.borderBottomWidth,B=r.borderLeftWidth,M=zn(r.paddingTop,e.bounds.width),F=zn(r.paddingRight,e.bounds.width),T=zn(r.paddingBottom,e.bounds.width),O=zn(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=a>0||o>0?as(n.left+B/3,n.top+L/3,a-B/3,o-L/3,vn.TOP_LEFT):new rr(n.left+B/3,n.top+L/3),this.topRightBorderDoubleOuterBox=a>0||o>0?as(n.left+w,n.top+L/3,c-E/3,A-L/3,vn.TOP_RIGHT):new rr(n.left+n.width-E/3,n.top+L/3),this.bottomRightBorderDoubleOuterBox=d>0||f>0?as(n.left+k,n.top+b,d-E/3,f-_/3,vn.BOTTOM_RIGHT):new rr(n.left+n.width-E/3,n.top+n.height-_/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?as(n.left+B/3,n.top+P,m-B/3,p-_/3,vn.BOTTOM_LEFT):new rr(n.left+B/3,n.top+n.height-_/3),this.topLeftBorderDoubleInnerBox=a>0||o>0?as(n.left+B*2/3,n.top+L*2/3,a-B*2/3,o-L*2/3,vn.TOP_LEFT):new rr(n.left+B*2/3,n.top+L*2/3),this.topRightBorderDoubleInnerBox=a>0||o>0?as(n.left+w,n.top+L*2/3,c-E*2/3,A-L*2/3,vn.TOP_RIGHT):new rr(n.left+n.width-E*2/3,n.top+L*2/3),this.bottomRightBorderDoubleInnerBox=d>0||f>0?as(n.left+k,n.top+b,d-E*2/3,f-_*2/3,vn.BOTTOM_RIGHT):new rr(n.left+n.width-E*2/3,n.top+n.height-_*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?as(n.left+B*2/3,n.top+P,m-B*2/3,p-_*2/3,vn.BOTTOM_LEFT):new rr(n.left+B*2/3,n.top+n.height-_*2/3),this.topLeftBorderStroke=a>0||o>0?as(n.left+B/2,n.top+L/2,a-B/2,o-L/2,vn.TOP_LEFT):new rr(n.left+B/2,n.top+L/2),this.topRightBorderStroke=a>0||o>0?as(n.left+w,n.top+L/2,c-E/2,A-L/2,vn.TOP_RIGHT):new rr(n.left+n.width-E/2,n.top+L/2),this.bottomRightBorderStroke=d>0||f>0?as(n.left+k,n.top+b,d-E/2,f-_/2,vn.BOTTOM_RIGHT):new rr(n.left+n.width-E/2,n.top+n.height-_/2),this.bottomLeftBorderStroke=m>0||p>0?as(n.left+B/2,n.top+P,m-B/2,p-_/2,vn.BOTTOM_LEFT):new rr(n.left+B/2,n.top+n.height-_/2),this.topLeftBorderBox=a>0||o>0?as(n.left,n.top,a,o,vn.TOP_LEFT):new rr(n.left,n.top),this.topRightBorderBox=c>0||A>0?as(n.left+w,n.top,c,A,vn.TOP_RIGHT):new rr(n.left+n.width,n.top),this.bottomRightBorderBox=d>0||f>0?as(n.left+k,n.top+b,d,f,vn.BOTTOM_RIGHT):new rr(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?as(n.left,n.top+P,m,p,vn.BOTTOM_LEFT):new rr(n.left,n.top+n.height),this.topLeftPaddingBox=a>0||o>0?as(n.left+B,n.top+L,Math.max(0,a-B),Math.max(0,o-L),vn.TOP_LEFT):new rr(n.left+B,n.top+L),this.topRightPaddingBox=c>0||A>0?as(n.left+Math.min(w,n.width-E),n.top+L,w>n.width+E?0:Math.max(0,c-E),Math.max(0,A-L),vn.TOP_RIGHT):new rr(n.left+n.width-E,n.top+L),this.bottomRightPaddingBox=d>0||f>0?as(n.left+Math.min(k,n.width-B),n.top+Math.min(b,n.height-_),Math.max(0,d-E),Math.max(0,f-_),vn.BOTTOM_RIGHT):new rr(n.left+n.width-E,n.top+n.height-_),this.bottomLeftPaddingBox=m>0||p>0?as(n.left+B,n.top+Math.min(P,n.height-_),Math.max(0,m-B),Math.max(0,p-_),vn.BOTTOM_LEFT):new rr(n.left+B,n.top+n.height-_),this.topLeftContentBox=a>0||o>0?as(n.left+B+O,n.top+L+M,Math.max(0,a-(B+O)),Math.max(0,o-(L+M)),vn.TOP_LEFT):new rr(n.left+B+O,n.top+L+M),this.topRightContentBox=c>0||A>0?as(n.left+Math.min(w,n.width+B+O),n.top+L+M,w>n.width+B+O?0:c-B+O,A-(L+M),vn.TOP_RIGHT):new rr(n.left+n.width-(E+F),n.top+L+M),this.bottomRightContentBox=d>0||f>0?as(n.left+Math.min(k,n.width-(B+O)),n.top+Math.min(b,n.height+L+M),Math.max(0,d-(E+F)),f-(_+T),vn.BOTTOM_RIGHT):new rr(n.left+n.width-(E+F),n.top+n.height-(_+T)),this.bottomLeftContentBox=m>0||p>0?as(n.left+B+O,n.top+P,Math.max(0,m-(B+O)),p-(_+T),vn.BOTTOM_LEFT):new rr(n.left+B+O,n.top+n.height-(_+T))}return t}(),vn;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(vn||(vn={}));var as=function(t,e,r,n,s){var a=4*((Math.sqrt(2)-1)/3),o=r*a,l=n*a,c=t+r,A=e+n;switch(s){case vn.TOP_LEFT:return new r1(new rr(t,A),new rr(t,A-l),new rr(c-o,e),new rr(c,e));case vn.TOP_RIGHT:return new r1(new rr(t,e),new rr(t+o,e),new rr(c,A-l),new rr(c,A));case vn.BOTTOM_RIGHT:return new r1(new rr(c,e),new rr(c,e+l),new rr(t+o,A),new rr(t,A));case vn.BOTTOM_LEFT:default:return new r1(new rr(c,A),new rr(c-o,A),new rr(t,e+l),new rr(t,e))}},gw=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},ose=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},xw=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},lse=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),n1=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),cse=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),Ase=function(t){return t.type===0},tM=function(t){return t.type===1},use=function(t){return t.type===2},FT=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},dse=function(t,e,r,n,s){return t.map(function(a,o){switch(o){case 0:return a.add(e,r);case 1:return a.add(e+n,r);case 2:return a.add(e+n,r+s);case 3:return a.add(e,r+s)}return a})},rM=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),nM=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new ise(this.container),this.container.styles.opacity<1&&this.effects.push(new cse(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,a=this.container.styles.transform;this.effects.push(new lse(n,s,a))}if(this.container.styles.overflowX!==0){var o=gw(this.curves),l=xw(this.curves);FT(o,l)?this.effects.push(new n1(o,6)):(this.effects.push(new n1(o,2)),this.effects.push(new n1(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var a=n.effects.filter(function(c){return!tM(c)});if(r||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,a),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=gw(n.curves),l=xw(n.curves);FT(o,l)||s.unshift(new n1(l,6))}}else s.unshift.apply(s,a);n=n.parent}return s.filter(function(c){return da(c.target,e)})},t}(),fE=function(t,e,r,n){t.container.elements.forEach(function(s){var a=da(s.flags,4),o=da(s.flags,2),l=new nM(s,t);da(s.styles.display,2048)&&n.push(l);var c=da(s.flags,8)?[]:n;if(a||o){var A=a||s.styles.isPositioned()?r:e,u=new rM(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var d=s.styles.zIndex.order;if(d<0){var f=0;A.negativeZIndex.some(function(m,p){return d>m.element.container.styles.zIndex.order?(f=p,!1):f>0}),A.negativeZIndex.splice(f,0,u)}else if(d>0){var h=0;A.positiveZIndex.some(function(m,p){return d>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),A.positiveZIndex.splice(h,0,u)}else A.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else s.styles.isFloating()?A.nonPositionedFloats.push(u):A.nonPositionedInlineLevel.push(u);fE(l,u,a?u:r,c)}else s.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),fE(l,e,r,c);da(s.flags,8)&&sM(s,c)})},sM=function(t,e){for(var r=t instanceof cE?t.start:1,n=t instanceof cE?t.reversed:!1,s=0;s<e.length;s++){var a=e[s];a.container instanceof QO&&typeof a.container.value=="number"&&a.container.value!==0&&(r=a.container.value),a.listValue=$g(r,a.container.styles.listStyleType,!0),r+=n?-1:1}},hse=function(t){var e=new nM(t,null),r=new rM(e),n=[];return fE(e,r,r,n),sM(e.container,n),r},kT=function(t,e){switch(e){case 0:return cl(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return cl(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return cl(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return cl(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},fse=function(t,e){switch(e){case 0:return cl(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return cl(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return cl(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return cl(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},mse=function(t,e){switch(e){case 0:return cl(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return cl(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return cl(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return cl(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},pse=function(t,e){switch(e){case 0:return s1(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return s1(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return s1(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return s1(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},s1=function(t,e){var r=[];return al(t)?r.push(t.subdivide(.5,!1)):r.push(t),al(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},cl=function(t,e,r,n){var s=[];return al(t)?s.push(t.subdivide(.5,!1)):s.push(t),al(r)?s.push(r.subdivide(.5,!0)):s.push(r),al(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),al(e)?s.push(e.subdivide(.5,!1).reverse()):s.push(e),s},aM=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},vw=function(t){var e=t.styles,r=t.bounds,n=zn(e.paddingLeft,r.width),s=zn(e.paddingRight,r.width),a=zn(e.paddingTop,r.width),o=zn(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,a+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+s),-(e.borderTopWidth+e.borderBottomWidth+a+o))},gse=function(t,e){return t===0?e.bounds:t===2?vw(e):aM(e)},xse=function(t,e){return t===0?e.bounds:t===2?vw(e):aM(e)},CN=function(t,e,r){var n=gse(Kf(t.styles.backgroundOrigin,e),t),s=xse(Kf(t.styles.backgroundClip,e),t),a=vse(Kf(t.styles.backgroundSize,e),r,n),o=a[0],l=a[1],c=wp(Kf(t.styles.backgroundPosition,e),n.width-o,n.height-l),A=yse(Kf(t.styles.backgroundRepeat,e),c,a,n,s),u=Math.round(n.left+c[0]),d=Math.round(n.top+c[1]);return[A,u,d,o,l]},Ef=function(t){return Pn(t)&&t.value===v0.AUTO},a1=function(t){return typeof t=="number"},vse=function(t,e,r){var n=e[0],s=e[1],a=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(ea(o)&&l&&ea(l))return[zn(o,r.width),zn(l,r.height)];var c=a1(a);if(Pn(o)&&(o.value===v0.CONTAIN||o.value===v0.COVER)){if(a1(a)){var A=r.width/r.height;return A<a!=(o.value===v0.COVER)?[r.width,r.width/a]:[r.height*a,r.height]}return[r.width,r.height]}var u=a1(n),d=a1(s),f=u||d;if(Ef(o)&&(!l||Ef(l))){if(u&&d)return[n,s];if(!c&&!f)return[r.width,r.height];if(f&&c){var h=u?n:s*a,m=d?s:n/a;return[h,m]}var p=u?n:r.width,x=d?s:r.height;return[p,x]}if(c){var g=0,w=0;return ea(o)?g=zn(o,r.width):ea(l)&&(w=zn(l,r.height)),Ef(o)?g=w*a:(!l||Ef(l))&&(w=g/a),[g,w]}var b=null,k=null;if(ea(o)?b=zn(o,r.width):l&&ea(l)&&(k=zn(l,r.height)),b!==null&&(!l||Ef(l))&&(k=u&&d?b/n*s:r.height),k!==null&&Ef(o)&&(b=u&&d?k/s*n:r.width),b!==null&&k!==null)return[b,k];throw new Error("Unable to calculate background-size for element")},Kf=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},yse=function(t,e,r,n,s){var a=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new rr(Math.round(n.left),Math.round(n.top+o)),new rr(Math.round(n.left+n.width),Math.round(n.top+o)),new rr(Math.round(n.left+n.width),Math.round(c+n.top+o)),new rr(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new rr(Math.round(n.left+a),Math.round(n.top)),new rr(Math.round(n.left+a+l),Math.round(n.top)),new rr(Math.round(n.left+a+l),Math.round(n.height+n.top)),new rr(Math.round(n.left+a),Math.round(n.height+n.top))];case 1:return[new rr(Math.round(n.left+a),Math.round(n.top+o)),new rr(Math.round(n.left+a+l),Math.round(n.top+o)),new rr(Math.round(n.left+a+l),Math.round(n.top+o+c)),new rr(Math.round(n.left+a),Math.round(n.top+o+c))];default:return[new rr(Math.round(s.left),Math.round(s.top)),new rr(Math.round(s.left+s.width),Math.round(s.top)),new rr(Math.round(s.left+s.width),Math.round(s.height+s.top)),new rr(Math.round(s.left),Math.round(s.height+s.top))]}},wse="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",TT="Hidden Text",bse=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),s=this._document.createElement("img"),a=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),s.src=wse,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",a.style.fontFamily=e,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.appendChild(this._document.createTextNode(TT)),n.appendChild(a),n.appendChild(s);var l=s.offsetTop-a.offsetTop+2;n.removeChild(a),n.appendChild(this._document.createTextNode(TT)),n.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),iM=function(){function t(e,r){this.context=e,this.options=r}return t}(),Nse=1e4,Cse=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new bse(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return n.applyEffect(s)})},e.prototype.applyEffect=function(r){this.ctx.save(),use(r)&&(this.ctx.globalAlpha=r.opacity),Ase(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),tM(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return Ii(this,void 0,void 0,function(){var n;return ci(this,function(s){switch(s.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return Ii(this,void 0,void 0,function(){return ci(this,function(n){switch(n.label){case 0:if(da(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,s){var a=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=zS(r.text);o.reduce(function(l,c){return a.ctx.fillText(c,l,r.bounds.top+s),l+a.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=Ise(r.fontFamily).join(", "),a=Ux(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,a,s].join(" "),s,a]},e.prototype.renderTextNode=function(r,n){return Ii(this,void 0,void 0,function(){var s,a,o,l,c,A,u,d,f=this;return ci(this,function(h){return s=this.createFontStyle(n),a=s[0],o=s[1],l=s[2],this.ctx.font=a,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),A=c.baseline,u=c.middle,d=n.paintOrder,r.textBounds.forEach(function(m){d.forEach(function(p){switch(p){case 0:f.ctx.fillStyle=ba(n.color),f.renderTextWithLetterSpacing(m,n.letterSpacing,A);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(g){f.ctx.shadowColor=ba(g.color),f.ctx.shadowOffsetX=g.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=g.offsetY.number*f.options.scale,f.ctx.shadowBlur=g.blur.number,f.renderTextWithLetterSpacing(m,n.letterSpacing,A)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),n.textDecorationLine.length&&(f.ctx.fillStyle=ba(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(g){switch(g){case 1:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+A),m.bounds.width,1);break;case 2:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:f.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+u),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(f.ctx.strokeStyle=ba(n.webkitTextStrokeColor),f.ctx.lineWidth=n.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+A)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var a=vw(r),o=xw(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,a.left,a.top,a.width,a.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return Ii(this,void 0,void 0,function(){var n,s,a,o,l,c,w,w,A,u,d,f,k,h,m,P,p,x,g,w,b,k,P;return ci(this,function(L){switch(L.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,s=r.curves,a=n.styles,o=0,l=n.textNodes,L.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,a)]):[3,4];case 2:L.sent(),L.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof UO))return[3,8];L.label=5;case 5:return L.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return w=L.sent(),this.renderReplacedElement(n,s,w),[3,8];case 7:return L.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof OO&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof MO))return[3,12];L.label=9;case 9:return L.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return w=L.sent(),this.renderReplacedElement(n,s,w),[3,12];case 11:return L.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof KO&&n.tree?(A=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,A.render(n.tree)]):[3,14];case 13:u=L.sent(),n.width&&n.height&&this.ctx.drawImage(u,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),L.label=14;case 14:if(n instanceof WS&&(d=Math.min(n.bounds.width,n.bounds.height),n.type===hw?n.checked&&(this.ctx.save(),this.path([new rr(n.bounds.left+d*.39363,n.bounds.top+d*.79),new rr(n.bounds.left+d*.16,n.bounds.top+d*.5549),new rr(n.bounds.left+d*.27347,n.bounds.top+d*.44071),new rr(n.bounds.left+d*.39694,n.bounds.top+d*.5649),new rr(n.bounds.left+d*.72983,n.bounds.top+d*.23),new rr(n.bounds.left+d*.84,n.bounds.top+d*.34085),new rr(n.bounds.left+d*.39363,n.bounds.top+d*.79)]),this.ctx.fillStyle=ba(vT),this.ctx.fill(),this.ctx.restore()):n.type===fw&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+d/2,n.bounds.top+d/2,d/4,0,Math.PI*2,!0),this.ctx.fillStyle=ba(vT),this.ctx.fill(),this.ctx.restore())),_se(n)&&n.value.length){switch(f=this.createFontStyle(a),k=f[0],h=f[1],m=this.fontMetrics.getMetrics(k,h).baseline,this.ctx.font=k,this.ctx.fillStyle=ba(a.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Bse(n.styles.textAlign),P=vw(n),p=0,n.styles.textAlign){case 1:p+=P.width/2;break;case 2:p+=P.width;break}x=P.add(p,0,0,-P.height/2+1),this.ctx.save(),this.path([new rr(P.left,P.top),new rr(P.left+P.width,P.top),new rr(P.left+P.width,P.top+P.height),new rr(P.left,P.top+P.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new $p(n.value,x),a.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!da(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(g=n.styles.listStyleImage,g.type!==0)return[3,18];w=void 0,b=g.url,L.label=15;case 15:return L.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return w=L.sent(),this.ctx.drawImage(w,n.bounds.left-(w.width+10),n.bounds.top),[3,18];case 17:return L.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(k=this.createFontStyle(a)[0],this.ctx.font=k,this.ctx.fillStyle=ba(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",P=new SA(n.bounds.left,n.bounds.top+zn(n.styles.paddingTop,n.bounds.width),n.bounds.width,rT(a.lineHeight,a.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new $p(r.listValue,P),a.letterSpacing,rT(a.lineHeight,a.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),L.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return Ii(this,void 0,void 0,function(){var n,s,g,a,o,g,l,c,g,A,u,g,d,f,g,h,m,g,p,x,g;return ci(this,function(w){switch(w.label){case 0:if(da(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:w.sent(),n=0,s=r.negativeZIndex,w.label=2;case 2:return n<s.length?(g=s[n],[4,this.renderStack(g)]):[3,5];case 3:w.sent(),w.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:w.sent(),a=0,o=r.nonInlineLevel,w.label=7;case 7:return a<o.length?(g=o[a],[4,this.renderNode(g)]):[3,10];case 8:w.sent(),w.label=9;case 9:return a++,[3,7];case 10:l=0,c=r.nonPositionedFloats,w.label=11;case 11:return l<c.length?(g=c[l],[4,this.renderStack(g)]):[3,14];case 12:w.sent(),w.label=13;case 13:return l++,[3,11];case 14:A=0,u=r.nonPositionedInlineLevel,w.label=15;case 15:return A<u.length?(g=u[A],[4,this.renderStack(g)]):[3,18];case 16:w.sent(),w.label=17;case 17:return A++,[3,15];case 18:d=0,f=r.inlineLevel,w.label=19;case 19:return d<f.length?(g=f[d],[4,this.renderNode(g)]):[3,22];case 20:w.sent(),w.label=21;case 21:return d++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,w.label=23;case 23:return h<m.length?(g=m[h],[4,this.renderStack(g)]):[3,26];case 24:w.sent(),w.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,w.label=27;case 27:return p<x.length?(g=x[p],[4,this.renderStack(g)]):[3,30];case 28:w.sent(),w.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(s,a){var o=al(s)?s.start:s;a===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),al(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},e.prototype.renderRepeat=function(r,n,s,a){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(s,a),this.ctx.fill(),this.ctx.translate(-s,-a)},e.prototype.resizeImage=function(r,n,s){var a;if(r.width===n&&r.height===s)return r;var o=(a=this.canvas.ownerDocument)!==null&&a!==void 0?a:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,s),l},e.prototype.renderBackgroundImage=function(r){return Ii(this,void 0,void 0,function(){var n,s,a,o,l,c;return ci(this,function(A){switch(A.label){case 0:n=r.styles.backgroundImage.length-1,s=function(u){var d,f,h,M,ae,fe,O,Y,_,m,M,ae,fe,O,Y,p,x,g,w,b,k,P,L,E,_,B,M,F,T,O,Y,me,ae,fe,he,te,pe,Ie,S,I,V,j;return ci(this,function(U){switch(U.label){case 0:if(u.type!==0)return[3,5];d=void 0,f=u.url,U.label=1;case 1:return U.trys.push([1,3,,4]),[4,a.context.cache.match(f)];case 2:return d=U.sent(),[3,4];case 3:return U.sent(),a.context.logger.error("Error loading background-image "+f),[3,4];case 4:return d&&(h=CN(r,n,[d.width,d.height,d.width/d.height]),M=h[0],ae=h[1],fe=h[2],O=h[3],Y=h[4],_=a.ctx.createPattern(a.resizeImage(d,O,Y),"repeat"),a.renderRepeat(M,_,ae,fe)),[3,6];case 5:Ate(u)?(m=CN(r,n,[null,null,null]),M=m[0],ae=m[1],fe=m[2],O=m[3],Y=m[4],p=ate(u.angle,O,Y),x=p[0],g=p[1],w=p[2],b=p[3],k=p[4],P=document.createElement("canvas"),P.width=O,P.height=Y,L=P.getContext("2d"),E=L.createLinearGradient(g,b,w,k),eT(u.stops,x).forEach(function(G){return E.addColorStop(G.stop,ba(G.color))}),L.fillStyle=E,L.fillRect(0,0,O,Y),O>0&&Y>0&&(_=a.ctx.createPattern(P,"repeat"),a.renderRepeat(M,_,ae,fe))):ute(u)&&(B=CN(r,n,[null,null,null]),M=B[0],F=B[1],T=B[2],O=B[3],Y=B[4],me=u.position.length===0?[qS]:u.position,ae=zn(me[0],O),fe=zn(me[me.length-1],Y),he=ite(u,ae,fe,O,Y),te=he[0],pe=he[1],te>0&&pe>0&&(Ie=a.ctx.createRadialGradient(F+ae,T+fe,0,F+ae,T+fe,te),eT(u.stops,te*2).forEach(function(G){return Ie.addColorStop(G.stop,ba(G.color))}),a.path(M),a.ctx.fillStyle=Ie,te!==pe?(S=r.bounds.left+.5*r.bounds.width,I=r.bounds.top+.5*r.bounds.height,V=pe/te,j=1/V,a.ctx.save(),a.ctx.translate(S,I),a.ctx.transform(1,0,0,V,0,0),a.ctx.translate(-S,-I),a.ctx.fillRect(F,j*(T-I)+I,O,Y*j),a.ctx.restore()):a.ctx.fill())),U.label=6;case 6:return n--,[2]}})},a=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:A.sent(),A.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,s){return Ii(this,void 0,void 0,function(){return ci(this,function(a){return this.path(kT(s,n)),this.ctx.fillStyle=ba(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,s,a){return Ii(this,void 0,void 0,function(){var o,l;return ci(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,s,a)]:[3,2];case 1:return c.sent(),[2];case 2:return o=fse(a,s),this.path(o),this.ctx.fillStyle=ba(r),this.ctx.fill(),l=mse(a,s),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return Ii(this,void 0,void 0,function(){var n,s,a,o,l,c,A,u,d=this;return ci(this,function(f){switch(f.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,s=!Ju(n.backgroundColor)||n.backgroundImage.length,a=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=Ese(Kf(n.backgroundClip,0),r.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Ju(n.backgroundColor)||(this.ctx.fillStyle=ba(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){d.ctx.save();var m=gw(r.curves),p=h.inset?0:Nse,x=dse(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(d.path(m),d.ctx.clip(),d.mask(x)):(d.mask(m),d.ctx.clip(),d.path(x)),d.ctx.shadowOffsetX=h.offsetX.number+p,d.ctx.shadowOffsetY=h.offsetY.number,d.ctx.shadowColor=ba(h.color),d.ctx.shadowBlur=h.blur.number,d.ctx.fillStyle=h.inset?ba(h.color):"rgba(0,0,0,1)",d.ctx.fill(),d.ctx.restore()}),f.label=2;case 2:l=0,c=0,A=a,f.label=3;case 3:return c<A.length?(u=A[c],u.style!==0&&!Ju(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,3)];case 6:return f.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,l,r.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,l,r.curves)];case 10:f.sent(),f.label=11;case 11:l++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,s,a,o){return Ii(this,void 0,void 0,function(){var l,c,A,u,d,f,h,m,p,x,g,w,b,k,P,L,P,L;return ci(this,function(E){return this.ctx.save(),l=pse(a,s),c=kT(a,s),o===2&&(this.path(c),this.ctx.clip()),al(c[0])?(A=c[0].start.x,u=c[0].start.y):(A=c[0].x,u=c[0].y),al(c[1])?(d=c[1].end.x,f=c[1].end.y):(d=c[1].x,f=c[1].y),s===0||s===2?h=Math.abs(A-d):h=Math.abs(u-f),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(g=h/(2*m+p),m*=g,p*=g):(w=Math.floor((h+p)/(m+p)),b=(h-w*m)/(w-1),k=(h-(w+1)*m)/w,p=k<=0||Math.abs(p-b)<Math.abs(p-k)?b:k),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=ba(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(al(c[0])&&(P=c[3],L=c[0],this.ctx.beginPath(),this.formatPath([new rr(P.end.x,P.end.y),new rr(L.start.x,L.start.y)]),this.ctx.stroke()),al(c[1])&&(P=c[1],L=c[2],this.ctx.beginPath(),this.formatPath([new rr(P.end.x,P.end.y),new rr(L.start.x,L.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return Ii(this,void 0,void 0,function(){var n;return ci(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ba(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=hse(r),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(iM),_se=function(t){return t instanceof HO||t instanceof VO?!0:t instanceof WS&&t.type!==fw&&t.type!==hw},Ese=function(t,e){switch(t){case 0:return gw(e);case 2:return ose(e);case 1:default:return xw(e)}},Bse=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Sse=["-apple-system","system-ui"],Ise=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return Sse.indexOf(e)===-1}):t},Fse=function(t){zl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return e.prototype.render=function(r){return Ii(this,void 0,void 0,function(){var n,s;return ci(this,function(a){switch(a.label){case 0:return n=lE(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,kse(n)];case 1:return s=a.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ba(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(iM),kse=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Tse=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Lv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Lv([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Lv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Lv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),jse=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new Tse({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new Zne(this,e)}return t.instanceCount=1,t}(),Jh=function(t,e){return e===void 0&&(e={}),Pse(t,e)};typeof window<"u"&&eM.setContext(window);var Pse=function(t,e){return Ii(void 0,void 0,void 0,function(){var r,n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,w,b,k,P,E,L,E,_,B,M,F,T,O,Y,me,ae,fe,he,te,pe,Ie,S,I,V;return ci(this,function(j){switch(j.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(_=e.allowTaint)!==null&&_!==void 0?_:!1,imageTimeout:(B=e.imageTimeout)!==null&&B!==void 0?B:15e3,proxy:e.proxy,useCORS:(M=e.useCORS)!==null&&M!==void 0?M:!1},a=$_({logging:(F=e.logging)!==null&&F!==void 0?F:!0,cache:e.cache},s),o={windowWidth:(T=e.windowWidth)!==null&&T!==void 0?T:n.innerWidth,windowHeight:(O=e.windowHeight)!==null&&O!==void 0?O:n.innerHeight,scrollX:(Y=e.scrollX)!==null&&Y!==void 0?Y:n.pageXOffset,scrollY:(me=e.scrollY)!==null&&me!==void 0?me:n.pageYOffset},l=new SA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new jse(a,l),A=(ae=e.foreignObjectRendering)!==null&&ae!==void 0?ae:!1,u={allowTaint:(fe=e.allowTaint)!==null&&fe!==void 0?fe:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:A,copyStyles:A},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),d=new ST(c,t,u),f=d.clonedReferenceElement,f?[4,d.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=j.sent(),m=JS(f)||Dne(f)?dZ(f.ownerDocument):P2(c,f),p=m.width,x=m.height,g=m.left,w=m.top,b=Rse(c,f,e.backgroundColor),k={canvas:e.canvas,backgroundColor:b,scale:(te=(he=e.scale)!==null&&he!==void 0?he:n.devicePixelRatio)!==null&&te!==void 0?te:1,x:((pe=e.x)!==null&&pe!==void 0?pe:0)+g,y:((Ie=e.y)!==null&&Ie!==void 0?Ie:0)+w,width:(S=e.width)!==null&&S!==void 0?S:Math.ceil(p),height:(I=e.height)!==null&&I!==void 0?I:Math.ceil(x)},A?(c.logger.debug("Document cloned, using foreign object rendering"),E=new Fse(c,k),[4,E.render(f)]):[3,3];case 2:return P=j.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+g+","+w+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),L=GO(c,f),b===L.styles.backgroundColor&&(L.styles.backgroundColor=mA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+k.x+","+k.y+" with size "+k.width+"x"+k.height),E=new Cse(c,k),[4,E.render(L)];case 4:P=j.sent(),j.label=5;case 5:return(!((V=e.removeContainer)!==null&&V!==void 0)||V)&&(ST.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,P]}})})},Rse=function(t,e,r){var n=e.ownerDocument,s=n.documentElement?qp(t,getComputedStyle(n.documentElement).backgroundColor):mA.TRANSPARENT,a=n.body?qp(t,getComputedStyle(n.body).backgroundColor):mA.TRANSPARENT,o=typeof r=="string"?qp(t,r):r===null?mA.TRANSPARENT:4294967295;return e===n.documentElement?Ju(s)?Ju(a)?o:a:s:o};const XS=Object.freeze(Object.defineProperty({__proto__:null,default:Jh},Symbol.toStringTag,{value:"Module"})),Dse="modulepreload",Lse=function(t){return"/"+t},jT={},pA=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Lse(c),c in jT)return;jT[c]=!0;const A=c.endsWith(".css"),u=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=A?"stylesheet":Dse,A||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),A)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Sn(t){"@babel/helpers - typeof";return Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(t)}var ql=Uint8Array,Bo=Uint16Array,YS=Int32Array,ZS=new ql([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),eI=new ql([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),PT=new ql([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),oM=function(t,e){for(var r=new Bo(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new YS(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},lM=oM(ZS,2),Use=lM.b,mE=lM.r;Use[28]=258,mE[258]=28;var Ose=oM(eI,0),RT=Ose.r,pE=new Bo(32768);for(var ts=0;ts<32768;++ts){var ou=(ts&43690)>>1|(ts&21845)<<1;ou=(ou&52428)>>2|(ou&13107)<<2,ou=(ou&61680)>>4|(ou&3855)<<4,pE[ts]=((ou&65280)>>8|(ou&255)<<8)>>1}var Wp=function(t,e,r){for(var n=t.length,s=0,a=new Bo(e);s<n;++s)t[s]&&++a[t[s]-1];var o=new Bo(e);for(s=1;s<e;++s)o[s]=o[s-1]+a[s-1]<<1;var l;if(r){l=new Bo(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var A=s<<4|t[s],u=e-t[s],d=o[t[s]-1]++<<u,f=d|(1<<u)-1;d<=f;++d)l[pE[d]>>c]=A}else for(l=new Bo(n),s=0;s<n;++s)t[s]&&(l[s]=pE[o[t[s]-1]++]>>15-t[s]);return l},jh=new ql(288);for(var ts=0;ts<144;++ts)jh[ts]=8;for(var ts=144;ts<256;++ts)jh[ts]=9;for(var ts=256;ts<280;++ts)jh[ts]=7;for(var ts=280;ts<288;++ts)jh[ts]=8;var yw=new ql(32);for(var ts=0;ts<32;++ts)yw[ts]=5;var Mse=Wp(jh,9,0),Qse=Wp(yw,5,0),cM=function(t){return(t+7)/8|0},Vse=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new ql(t.subarray(e,r))},$c=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Zm=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},_N=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,a=r.slice();if(!s)return{t:uM,l:0};if(s==1){var o=new ql(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(P,L){return P.f-L.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],A=0,u=1,d=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=r[r[A].f<r[d].f?A++:d++],c=r[A!=u&&r[A].f<r[d].f?A++:d++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var f=a[0].s,n=1;n<s;++n)a[n].s>f&&(f=a[n].s);var h=new Bo(f+1),m=gE(r[u-1],h,0);if(m>e){var n=0,p=0,x=m-e,g=1<<x;for(a.sort(function(L,E){return h[E.s]-h[L.s]||L.f-E.f});n<s;++n){var w=a[n].s;if(h[w]>e)p+=g-(1<<m-h[w]),h[w]=e;else break}for(p>>=x;p>0;){var b=a[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var k=a[n].s;h[k]==e&&(--h[k],++p)}m=e}return{t:new ql(h),l:m}},gE=function(t,e,r){return t.s==-1?Math.max(gE(t.l,e,r+1),gE(t.r,e,r+1)):e[t.s]=r},DT=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Bo(++e),n=0,s=t[0],a=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=t[l]}return{c:r.subarray(0,n),n:e}},ep=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},AM=function(t,e,r){var n=r.length,s=cM(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var a=0;a<n;++a)t[s+a+4]=r[a];return(s+4+n)*8},LT=function(t,e,r,n,s,a,o,l,c,A,u){$c(e,u++,r),++s[256];for(var d=_N(s,15),f=d.t,h=d.l,m=_N(a,15),p=m.t,x=m.l,g=DT(f),w=g.c,b=g.n,k=DT(p),P=k.c,L=k.n,E=new Bo(19),_=0;_<w.length;++_)++E[w[_]&31];for(var _=0;_<P.length;++_)++E[P[_]&31];for(var B=_N(E,7),M=B.t,F=B.l,T=19;T>4&&!M[PT[T-1]];--T);var O=A+5<<3,Y=ep(s,jh)+ep(a,yw)+o,me=ep(s,f)+ep(a,p)+o+14+3*T+ep(E,M)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&O<=Y&&O<=me)return AM(e,u,t.subarray(c,c+A));var ae,fe,he,te;if($c(e,u,1+(me<Y)),u+=2,me<Y){ae=Wp(f,h,0),fe=f,he=Wp(p,x,0),te=p;var pe=Wp(M,F,0);$c(e,u,b-257),$c(e,u+5,L-1),$c(e,u+10,T-4),u+=14;for(var _=0;_<T;++_)$c(e,u+3*_,M[PT[_]]);u+=3*T;for(var Ie=[w,P],S=0;S<2;++S)for(var I=Ie[S],_=0;_<I.length;++_){var V=I[_]&31;$c(e,u,pe[V]),u+=M[V],V>15&&($c(e,u,I[_]>>5&127),u+=I[_]>>12)}}else ae=Mse,fe=jh,he=Qse,te=yw;for(var _=0;_<l;++_){var j=n[_];if(j>255){var V=j>>18&31;Zm(e,u,ae[V+257]),u+=fe[V+257],V>7&&($c(e,u,j>>23&31),u+=ZS[V]);var U=j&31;Zm(e,u,he[U]),u+=te[U],U>3&&(Zm(e,u,j>>5&8191),u+=eI[U])}else Zm(e,u,ae[j]),u+=fe[j]}return Zm(e,u,ae[256]),u+fe[256]},Hse=new YS([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),uM=new ql(0),Kse=function(t,e,r,n,s,a){var o=a.z||t.length,l=new ql(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),A=a.l,u=(a.r||0)&7;if(e){u&&(c[0]=a.r>>3);for(var d=Hse[e-1],f=d>>13,h=d&8191,m=(1<<r)-1,p=a.p||new Bo(32768),x=a.h||new Bo(m+1),g=Math.ceil(r/3),w=2*g,b=function(re){return(t[re]^t[re+1]<<g^t[re+2]<<w)&m},k=new YS(25e3),P=new Bo(288),L=new Bo(32),E=0,_=0,B=a.i||0,M=0,F=a.w||0,T=0;B+2<o;++B){var O=b(B),Y=B&32767,me=x[O];if(p[Y]=me,x[O]=Y,F<=B){var ae=o-B;if((E>7e3||M>24576)&&(ae>423||!A)){u=LT(t,c,0,k,P,L,_,M,T,B-T,u),M=E=_=0,T=B;for(var fe=0;fe<286;++fe)P[fe]=0;for(var fe=0;fe<30;++fe)L[fe]=0}var he=2,te=0,pe=h,Ie=Y-me&32767;if(ae>2&&O==b(B-Ie))for(var S=Math.min(f,ae)-1,I=Math.min(32767,B),V=Math.min(258,ae);Ie<=I&&--pe&&Y!=me;){if(t[B+he]==t[B+he-Ie]){for(var j=0;j<V&&t[B+j]==t[B+j-Ie];++j);if(j>he){if(he=j,te=Ie,j>S)break;for(var U=Math.min(Ie,j-2),G=0,fe=0;fe<U;++fe){var R=B-Ie+fe&32767,X=p[R],se=R-X&32767;se>G&&(G=se,me=R)}}}Y=me,me=p[Y],Ie+=Y-me&32767}if(te){k[M++]=268435456|mE[he]<<18|RT[te];var ye=mE[he]&31,z=RT[te]&31;_+=ZS[ye]+eI[z],++P[257+ye],++L[z],F=B+he,++E}else k[M++]=t[B],++P[t[B]]}}for(B=Math.max(B,F);B<o;++B)k[M++]=t[B],++P[t[B]];u=LT(t,c,A,k,P,L,_,M,T,B-T,u),A||(a.r=u&7|c[u/8|0]<<3,u-=7,a.h=x,a.p=p,a.i=B,a.w=F)}else{for(var B=a.w||0;B<o+A;B+=65535){var Me=B+65535;Me>=o&&(c[u/8|0]=A,Me=o),u=AM(c,u+1,t.subarray(B,Me))}a.i=o}return Vse(l,0,n+cM(u)+s)},dM=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,a=r.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},qse=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new ql(a.length+t.length);o.set(a),o.set(t,a.length),t=o,s.w=a.length}return Kse(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},hM=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Gse=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=dM();s.p(e.dictionary),hM(t,2,s.d())}};function xE(t,e){e||(e={});var r=dM();r.p(t);var n=qse(t,e,e.dictionary?6:2,4);return Gse(n,e),hM(n,n.length-4,r.d()),n}var $se=typeof TextDecoder<"u"&&new TextDecoder,zse=0;try{$se.decode(uM,{stream:!0}),zse=1}catch{}function Wse(t){if(Array.isArray(t))return t}function Jse(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,a,o,l=[],c=!0,A=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(u){A=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(A)throw s}}return l}}function UT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Xse(t,e){if(t){if(typeof t=="string")return UT(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?UT(t,e):void 0}}function Yse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OT(t,e){return Wse(t)||Jse(t,e)||Xse(t,e)||Yse()}function MT(t,e="utf8"){return new TextDecoder(e).decode(t)}const Zse=new TextEncoder;function eae(t){return Zse.encode(t)}const tae=1024*8,rae=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),EN={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class tI{constructor(e=tae,r={}){Nn(this,"buffer");Nn(this,"byteLength");Nn(this,"byteOffset");Nn(this,"length");Nn(this,"offset");Nn(this,"lastWrittenByte");Nn(this,"littleEndian");Nn(this,"_data");Nn(this,"_mark");Nn(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=r.offset?r.offset>>>0:0,a=e.byteLength-s;let o=s;(ArrayBuffer.isView(e)||e instanceof tI)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=EN[r].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===rae&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new EN[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new EN[r](a);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return MT(this.readBytes(e))}decodeText(e=1,r="utf8"){return MT(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(eae(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function lm(t){let e=t.length;for(;--e>=0;)t[e]=0}const nae=3,sae=258,fM=29,aae=256,iae=aae+1+fM,mM=30,oae=512,lae=new Array((iae+2)*2);lm(lae);const cae=new Array(mM*2);lm(cae);const Aae=new Array(oae);lm(Aae);const uae=new Array(sae-nae+1);lm(uae);const dae=new Array(fM);lm(dae);const hae=new Array(mM);lm(hae);const fae=(t,e,r,n)=>{let s=t&65535|0,a=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,a=a+s|0;while(--o);s%=65521,a%=65521}return s|a<<16|0};var vE=fae;const mae=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},pae=new Uint32Array(mae()),gae=(t,e,r,n)=>{const s=pae,a=n+r;t^=-1;for(let o=n;o<a;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var lc=gae,yE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},pM={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const xae=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var vae=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)xae(r,n)&&(t[n]=r[n])}}return t},yae=t=>{let e=0;for(let n=0,s=t.length;n<s;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,s=0,a=t.length;n<a;n++){let o=t[n];r.set(o,s),s+=o.length}return r},gM={assign:vae,flattenChunks:yae};let xM=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{xM=!1}const zg=new Uint8Array(256);for(let t=0;t<256;t++)zg[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;zg[254]=zg[254]=1;var wae=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,s,a,o=t.length,l=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),a=0,s=0;a<l;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const bae=(t,e)=>{if(e<65534&&t.subarray&&xM)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var Nae=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let o=t[n++];if(o<128){a[s++]=o;continue}let l=zg[o];if(l>4){a[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){a[s++]=65533;continue}o<65536?a[s++]=o:(o-=65536,a[s++]=55296|o>>10&1023,a[s++]=56320|o&1023)}return bae(a,s)},Cae=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+zg[t[r]]>e?r:e},wE={string2buf:wae,buf2string:Nae,utf8border:Cae};function _ae(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Eae=_ae;const i1=16209,Bae=16191;var Sae=function(e,r){let n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,w,b,k,P,L,E,_,B,M;const F=e.state;n=e.next_in,B=e.input,s=n+(e.avail_in-5),a=e.next_out,M=e.output,o=a-(r-e.avail_out),l=a+(e.avail_out-257),c=F.dmax,A=F.wsize,u=F.whave,d=F.wnext,f=F.window,h=F.hold,m=F.bits,p=F.lencode,x=F.distcode,g=(1<<F.lenbits)-1,w=(1<<F.distbits)-1;e:do{m<15&&(h+=B[n++]<<m,m+=8,h+=B[n++]<<m,m+=8),b=p[h&g];t:for(;;){if(k=b>>>24,h>>>=k,m-=k,k=b>>>16&255,k===0)M[a++]=b&65535;else if(k&16){P=b&65535,k&=15,k&&(m<k&&(h+=B[n++]<<m,m+=8),P+=h&(1<<k)-1,h>>>=k,m-=k),m<15&&(h+=B[n++]<<m,m+=8,h+=B[n++]<<m,m+=8),b=x[h&w];r:for(;;){if(k=b>>>24,h>>>=k,m-=k,k=b>>>16&255,k&16){if(L=b&65535,k&=15,m<k&&(h+=B[n++]<<m,m+=8,m<k&&(h+=B[n++]<<m,m+=8)),L+=h&(1<<k)-1,L>c){e.msg="invalid distance too far back",F.mode=i1;break e}if(h>>>=k,m-=k,k=a-o,L>k){if(k=L-k,k>u&&F.sane){e.msg="invalid distance too far back",F.mode=i1;break e}if(E=0,_=f,d===0){if(E+=A-k,k<P){P-=k;do M[a++]=f[E++];while(--k);E=a-L,_=M}}else if(d<k){if(E+=A+d-k,k-=d,k<P){P-=k;do M[a++]=f[E++];while(--k);if(E=0,d<P){k=d,P-=k;do M[a++]=f[E++];while(--k);E=a-L,_=M}}}else if(E+=d-k,k<P){P-=k;do M[a++]=f[E++];while(--k);E=a-L,_=M}for(;P>2;)M[a++]=_[E++],M[a++]=_[E++],M[a++]=_[E++],P-=3;P&&(M[a++]=_[E++],P>1&&(M[a++]=_[E++]))}else{E=a-L;do M[a++]=M[E++],M[a++]=M[E++],M[a++]=M[E++],P-=3;while(P>2);P&&(M[a++]=M[E++],P>1&&(M[a++]=M[E++]))}}else if(k&64){e.msg="invalid distance code",F.mode=i1;break e}else{b=x[(b&65535)+(h&(1<<k)-1)];continue r}break}}else if(k&64)if(k&32){F.mode=Bae;break e}else{e.msg="invalid literal/length code",F.mode=i1;break e}else{b=p[(b&65535)+(h&(1<<k)-1)];continue t}break}}while(n<s&&a<l);P=m>>3,n-=P,m-=P<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=a,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=a<l?257+(l-a):257-(a-l),F.hold=h,F.bits=m};const Bf=15,QT=852,VT=592,HT=0,BN=1,KT=2,Iae=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Fae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),kae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Tae=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),jae=(t,e,r,n,s,a,o,l)=>{const c=l.bits;let A=0,u=0,d=0,f=0,h=0,m=0,p=0,x=0,g=0,w=0,b,k,P,L,E,_=null,B;const M=new Uint16Array(Bf+1),F=new Uint16Array(Bf+1);let T=null,O,Y,me;for(A=0;A<=Bf;A++)M[A]=0;for(u=0;u<n;u++)M[e[r+u]]++;for(h=c,f=Bf;f>=1&&M[f]===0;f--);if(h>f&&(h=f),f===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<f&&M[d]===0;d++);for(h<d&&(h=d),x=1,A=1;A<=Bf;A++)if(x<<=1,x-=M[A],x<0)return-1;if(x>0&&(t===HT||f!==1))return-1;for(F[1]=0,A=1;A<Bf;A++)F[A+1]=F[A]+M[A];for(u=0;u<n;u++)e[r+u]!==0&&(o[F[e[r+u]]++]=u);if(t===HT?(_=T=o,B=20):t===BN?(_=Iae,T=Fae,B=257):(_=kae,T=Tae,B=0),w=0,u=0,A=d,E=a,m=h,p=0,P=-1,g=1<<h,L=g-1,t===BN&&g>QT||t===KT&&g>VT)return 1;for(;;){O=A-p,o[u]+1<B?(Y=0,me=o[u]):o[u]>=B?(Y=T[o[u]-B],me=_[o[u]-B]):(Y=96,me=0),b=1<<A-p,k=1<<m,d=k;do k-=b,s[E+(w>>p)+k]=O<<24|Y<<16|me|0;while(k!==0);for(b=1<<A-1;w&b;)b>>=1;if(b!==0?(w&=b-1,w+=b):w=0,u++,--M[A]===0){if(A===f)break;A=e[r+o[u]]}if(A>h&&(w&L)!==P){for(p===0&&(p=h),E+=d,m=A-p,x=1<<m;m+p<f&&(x-=M[m+p],!(x<=0));)m++,x<<=1;if(g+=1<<m,t===BN&&g>QT||t===KT&&g>VT)return 1;P=w&L,s[P]=h<<24|m<<16|E-a|0}}return w!==0&&(s[E+w]=A-p<<24|64<<16|0),l.bits=h,0};var Jp=jae;const Pae=0,vM=1,yM=2,{Z_FINISH:qT,Z_BLOCK:Rae,Z_TREES:o1,Z_OK:Ph,Z_STREAM_END:Dae,Z_NEED_DICT:Lae,Z_STREAM_ERROR:ml,Z_DATA_ERROR:wM,Z_MEM_ERROR:bM,Z_BUF_ERROR:Uae,Z_DEFLATED:GT}=pM,K2=16180,$T=16181,zT=16182,WT=16183,JT=16184,XT=16185,YT=16186,ZT=16187,ej=16188,tj=16189,ww=16190,zc=16191,SN=16192,rj=16193,IN=16194,nj=16195,sj=16196,aj=16197,ij=16198,l1=16199,c1=16200,oj=16201,lj=16202,cj=16203,Aj=16204,uj=16205,FN=16206,dj=16207,hj=16208,is=16209,NM=16210,CM=16211,Oae=852,Mae=592,Qae=15,Vae=Qae,fj=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Hae(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Xh=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<K2||e.mode>CM?1:0},_M=t=>{if(Xh(t))return ml;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=K2,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Oae),e.distcode=e.distdyn=new Int32Array(Mae),e.sane=1,e.back=-1,Ph},EM=t=>{if(Xh(t))return ml;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,_M(t)},BM=(t,e)=>{let r;if(Xh(t))return ml;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ml:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,EM(t))},SM=(t,e)=>{if(!t)return ml;const r=new Hae;t.state=r,r.strm=t,r.window=null,r.mode=K2;const n=BM(t,e);return n!==Ph&&(t.state=null),n},Kae=t=>SM(t,Vae);let mj=!0,kN,TN;const qae=t=>{if(mj){kN=new Int32Array(512),TN=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Jp(vM,t.lens,0,288,kN,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Jp(yM,t.lens,0,32,TN,0,t.work,{bits:5}),mj=!1}t.lencode=kN,t.lenbits=9,t.distcode=TN,t.distbits=5},IM=(t,e,r,n)=>{let s;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(e.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},Gae=(t,e)=>{let r,n,s,a,o,l,c,A,u,d,f,h,m,p,x=0,g,w,b,k,P,L,E,_;const B=new Uint8Array(4);let M,F;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Xh(t)||!t.output||!t.input&&t.avail_in!==0)return ml;r=t.state,r.mode===zc&&(r.mode=SN),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,A=r.hold,u=r.bits,d=l,f=c,_=Ph;e:for(;;)switch(r.mode){case K2:if(r.wrap===0){r.mode=SN;break}for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&2&&A===35615){r.wbits===0&&(r.wbits=15),r.check=0,B[0]=A&255,B[1]=A>>>8&255,r.check=lc(r.check,B,2,0),A=0,u=0,r.mode=$T;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((A&255)<<8)+(A>>8))%31){t.msg="incorrect header check",r.mode=is;break}if((A&15)!==GT){t.msg="unknown compression method",r.mode=is;break}if(A>>>=4,u-=4,E=(A&15)+8,r.wbits===0&&(r.wbits=E),E>15||E>r.wbits){t.msg="invalid window size",r.mode=is;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=A&512?tj:zc,A=0,u=0;break;case $T:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.flags=A,(r.flags&255)!==GT){t.msg="unknown compression method",r.mode=is;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=is;break}r.head&&(r.head.text=A>>8&1),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,r.check=lc(r.check,B,2,0)),A=0,u=0,r.mode=zT;case zT:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.time=A),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,B[2]=A>>>16&255,B[3]=A>>>24&255,r.check=lc(r.check,B,4,0)),A=0,u=0,r.mode=WT;case WT:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=A&255,r.head.os=A>>8),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,r.check=lc(r.check,B,2,0)),A=0,u=0,r.mode=JT;case JT:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length=A,r.head&&(r.head.extra_len=A),r.flags&512&&r.wrap&4&&(B[0]=A&255,B[1]=A>>>8&255,r.check=lc(r.check,B,2,0)),A=0,u=0}else r.head&&(r.head.extra=null);r.mode=XT;case XT:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+h),E)),r.flags&512&&r.wrap&4&&(r.check=lc(r.check,n,h,a)),l-=h,a+=h,r.length-=h),r.length))break e;r.length=0,r.mode=YT;case YT:if(r.flags&2048){if(l===0)break e;h=0;do E=n[a+h++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=lc(r.check,n,h,a)),l-=h,a+=h,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=ZT;case ZT:if(r.flags&4096){if(l===0)break e;h=0;do E=n[a+h++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=lc(r.check,n,h,a)),l-=h,a+=h,E)break e}else r.head&&(r.head.comment=null);r.mode=ej;case ej:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.check&65535)){t.msg="header crc mismatch",r.mode=is;break}A=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=zc;break;case tj:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}t.adler=r.check=fj(A),A=0,u=0,r.mode=ww;case ww:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,Lae;t.adler=r.check=1,r.mode=zc;case zc:if(e===Rae||e===o1)break e;case SN:if(r.last){A>>>=u&7,u-=u&7,r.mode=FN;break}for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}switch(r.last=A&1,A>>>=1,u-=1,A&3){case 0:r.mode=rj;break;case 1:if(qae(r),r.mode=l1,e===o1){A>>>=2,u-=2;break e}break;case 2:r.mode=sj;break;case 3:t.msg="invalid block type",r.mode=is}A>>>=2,u-=2;break;case rj:for(A>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if((A&65535)!==(A>>>16^65535)){t.msg="invalid stored block lengths",r.mode=is;break}if(r.length=A&65535,A=0,u=0,r.mode=IN,e===o1)break e;case IN:r.mode=nj;case nj:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;s.set(n.subarray(a,a+h),o),l-=h,a+=h,c-=h,o+=h,r.length-=h;break}r.mode=zc;break;case sj:for(;u<14;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.nlen=(A&31)+257,A>>>=5,u-=5,r.ndist=(A&31)+1,A>>>=5,u-=5,r.ncode=(A&15)+4,A>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=is;break}r.have=0,r.mode=aj;case aj:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.lens[T[r.have++]]=A&7,A>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,M={bits:r.lenbits},_=Jp(Pae,r.lens,0,19,r.lencode,0,r.work,M),r.lenbits=M.bits,_){t.msg="invalid code lengths set",r.mode=is;break}r.have=0,r.mode=ij;case ij:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[A&(1<<r.lenbits)-1],g=x>>>24,w=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(b<16)A>>>=g,u-=g,r.lens[r.have++]=b;else{if(b===16){for(F=g+2;u<F;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(A>>>=g,u-=g,r.have===0){t.msg="invalid bit length repeat",r.mode=is;break}E=r.lens[r.have-1],h=3+(A&3),A>>>=2,u-=2}else if(b===17){for(F=g+3;u<F;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=g,u-=g,E=0,h=3+(A&7),A>>>=3,u-=3}else{for(F=g+7;u<F;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=g,u-=g,E=0,h=11+(A&127),A>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=is;break}for(;h--;)r.lens[r.have++]=E}}if(r.mode===is)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=is;break}if(r.lenbits=9,M={bits:r.lenbits},_=Jp(vM,r.lens,0,r.nlen,r.lencode,0,r.work,M),r.lenbits=M.bits,_){t.msg="invalid literal/lengths set",r.mode=is;break}if(r.distbits=6,r.distcode=r.distdyn,M={bits:r.distbits},_=Jp(yM,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M),r.distbits=M.bits,_){t.msg="invalid distances set",r.mode=is;break}if(r.mode=l1,e===o1)break e;case l1:r.mode=c1;case c1:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,Sae(t,f),o=t.next_out,s=t.output,c=t.avail_out,a=t.next_in,n=t.input,l=t.avail_in,A=r.hold,u=r.bits,r.mode===zc&&(r.back=-1);break}for(r.back=0;x=r.lencode[A&(1<<r.lenbits)-1],g=x>>>24,w=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(w&&!(w&240)){for(k=g,P=w,L=b;x=r.lencode[L+((A&(1<<k+P)-1)>>k)],g=x>>>24,w=x>>>16&255,b=x&65535,!(k+g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=k,u-=k,r.back+=k}if(A>>>=g,u-=g,r.back+=g,r.length=b,w===0){r.mode=uj;break}if(w&32){r.back=-1,r.mode=zc;break}if(w&64){t.msg="invalid literal/length code",r.mode=is;break}r.extra=w&15,r.mode=oj;case oj:if(r.extra){for(F=r.extra;u<F;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=lj;case lj:for(;x=r.distcode[A&(1<<r.distbits)-1],g=x>>>24,w=x>>>16&255,b=x&65535,!(g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(!(w&240)){for(k=g,P=w,L=b;x=r.distcode[L+((A&(1<<k+P)-1)>>k)],g=x>>>24,w=x>>>16&255,b=x&65535,!(k+g<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=k,u-=k,r.back+=k}if(A>>>=g,u-=g,r.back+=g,w&64){t.msg="invalid distance code",r.mode=is;break}r.offset=b,r.extra=w&15,r.mode=cj;case cj:if(r.extra){for(F=r.extra;u<F;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.offset+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=is;break}r.mode=Aj;case Aj:if(c===0)break e;if(h=f-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=is;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=s,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do s[o++]=p[m++];while(--h);r.length===0&&(r.mode=c1);break;case uj:if(c===0)break e;s[o++]=r.length,c--,r.mode=c1;break;case FN:if(r.wrap){for(;u<32;){if(l===0)break e;l--,A|=n[a++]<<u,u+=8}if(f-=c,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?lc(r.check,s,f,o-f):vE(r.check,s,f,o-f)),f=c,r.wrap&4&&(r.flags?A:fj(A))!==r.check){t.msg="incorrect data check",r.mode=is;break}A=0,u=0}r.mode=dj;case dj:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=is;break}A=0,u=0}r.mode=hj;case hj:_=Dae;break e;case is:_=wM;break e;case NM:return bM;case CM:default:return ml}return t.next_out=o,t.avail_out=c,t.next_in=a,t.avail_in=l,r.hold=A,r.bits=u,(r.wsize||f!==t.avail_out&&r.mode<is&&(r.mode<FN||e!==qT))&&IM(t,t.output,t.next_out,f-t.avail_out),d-=t.avail_in,f-=t.avail_out,t.total_in+=d,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?lc(r.check,s,f,t.next_out-f):vE(r.check,s,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===zc?128:0)+(r.mode===l1||r.mode===IN?256:0),(d===0&&f===0||e===qT)&&_===Ph&&(_=Uae),_},$ae=t=>{if(Xh(t))return ml;let e=t.state;return e.window&&(e.window=null),t.state=null,Ph},zae=(t,e)=>{if(Xh(t))return ml;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,Ph):ml},Wae=(t,e)=>{const r=e.length;let n,s,a;return Xh(t)||(n=t.state,n.wrap!==0&&n.mode!==ww)?ml:n.mode===ww&&(s=1,s=vE(s,e,r,0),s!==n.check)?wM:(a=IM(t,e,r,r),a?(n.mode=NM,bM):(n.havedict=1,Ph))};var Jae=EM,Xae=BM,Yae=_M,Zae=Kae,eie=SM,tie=Gae,rie=$ae,nie=zae,sie=Wae,aie="pako inflate (from Nodeca project)",rA={inflateReset:Jae,inflateReset2:Xae,inflateResetKeep:Yae,inflateInit:Zae,inflateInit2:eie,inflate:tie,inflateEnd:rie,inflateGetHeader:nie,inflateSetDictionary:sie,inflateInfo:aie};function iie(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var oie=iie;const FM=Object.prototype.toString,{Z_NO_FLUSH:lie,Z_FINISH:cie,Z_OK:Wg,Z_STREAM_END:jN,Z_NEED_DICT:PN,Z_STREAM_ERROR:Aie,Z_DATA_ERROR:pj,Z_MEM_ERROR:uie}=pM;function Ox(t){this.options=gM.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Eae,this.strm.avail_out=0;let r=rA.inflateInit2(this.strm,e.windowBits);if(r!==Wg)throw new Error(yE[r]);if(this.header=new oie,rA.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=wE.string2buf(e.dictionary):FM.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=rA.inflateSetDictionary(this.strm,e.dictionary),r!==Wg)))throw new Error(yE[r])}Ox.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?cie:lie,FM.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=rA.inflate(r,o),a===PN&&s&&(a=rA.inflateSetDictionary(r,s),a===Wg?a=rA.inflate(r,o):a===pj&&(a=PN));r.avail_in>0&&a===jN&&r.state.wrap>0&&t[r.next_in]!==0;)rA.inflateReset(r),a=rA.inflate(r,o);switch(a){case Aie:case pj:case PN:case uie:return this.onEnd(a),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||a===jN))if(this.options.to==="string"){let c=wE.utf8border(r.output,r.next_out),A=r.next_out-c,u=wE.buf2string(r.output,c);r.next_out=A,r.avail_out=n-A,A&&r.output.set(r.output.subarray(c,c+A),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===Wg&&l===0)){if(a===jN)return a=rA.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Ox.prototype.onData=function(t){this.chunks.push(t)};Ox.prototype.onEnd=function(t){t===Wg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=gM.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function die(t,e){const r=new Ox(e);if(r.push(t),r.err)throw r.msg||yE[r.err];return r.result}var hie=Ox,fie=die,mie={Inflate:hie,inflate:fie};const{Inflate:pie,inflate:gie}=mie;var gj=pie,xie=gie;const kM=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;kM[t]=e}const xj=4294967295;function vie(t,e,r){let n=t;for(let s=0;s<r;s++)n=kM[(n^e[s])&255]^n>>>8;return n}function yie(t,e){return(vie(xj,t,e)^xj)>>>0}function vj(t,e,r){const n=t.readUint32(),s=yie(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function TM(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function jM(t,e,r,n){let s=0;for(;s<n;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-n]&255}function PM(t,e,r,n){let s=0;if(r.length===0)for(;s<n;s++)e[s]=t[s];else for(;s<n;s++)e[s]=t[s]+r[s]&255}function RM(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-s]>>1)&255}else{for(;a<s;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-s]+r[a]>>1)&255}}function DM(t,e,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-s]&255}else{for(;a<s;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+wie(e[a-s],r[a],r[a-s])&255}}function wie(t,e,r){const n=t+e-r,s=Math.abs(n-t),a=Math.abs(n-e),o=Math.abs(n-r);return s<=a&&s<=o?t:a<=o?e:r}function bie(t,e,r,n,s,a){switch(t){case 0:TM(e,r,s);break;case 1:jM(e,r,s,a);break;case 2:PM(e,r,n,s);break;case 3:RM(e,r,n,s,a);break;case 4:DM(e,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Nie=new Uint16Array([255]),Cie=new Uint8Array(Nie.buffer),_ie=Cie[0]===255;function Eie(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*s,c=new Uint8Array(n*r*l);let A=0;for(let u=0;u<7;u++){const d=o[u],f=Math.ceil((r-d.x)/d.xStep),h=Math.ceil((n-d.y)/d.yStep);if(f<=0||h<=0)continue;const m=f*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const g=e[A++],w=e.subarray(A,A+m);A+=m;const b=new Uint8Array(m);bie(g,w,b,p,m,l),p.set(b);for(let k=0;k<f;k++){const P=d.x+k*d.xStep,L=d.y+x*d.yStep;if(!(P>=r||L>=n))for(let E=0;E<l;E++)c[(L*r+P)*l+E]=b[k*l+E]}}}if(a===16){const u=new Uint16Array(c.buffer);if(_ie)for(let d=0;d<u.length;d++)u[d]=Bie(u[d]);return u}else return c}function Bie(t){return(t&255)<<8|t>>8&255}const Sie=new Uint16Array([255]),Iie=new Uint8Array(Sie.buffer),Fie=Iie[0]===255,kie=new Uint8Array(0);function yj(t){const{data:e,width:r,height:n,channels:s,depth:a}=t,o=Math.ceil(a/8)*s,l=Math.ceil(a/8*s*r),c=new Uint8Array(n*l);let A=kie,u=0,d,f;for(let h=0;h<n;h++){switch(d=e.subarray(u+1,u+1+l),f=c.subarray(h*l,(h+1)*l),e[u]){case 0:TM(d,f,l);break;case 1:jM(d,f,l,o);break;case 2:PM(d,f,A,l);break;case 3:RM(d,f,A,l,o);break;case 4:DM(d,f,A,l,o);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}A=f,u+=l+1}if(a===16){const h=new Uint16Array(c.buffer);if(Fie)for(let m=0;m<h.length;m++)h[m]=Tie(h[m]);return h}else return c}function Tie(t){return(t&255)<<8|t>>8&255}const py=Uint8Array.of(137,80,78,71,13,10,26,10);function wj(t){if(!jie(t.readBytes(py.length)))throw new Error("wrong PNG signature")}function jie(t){if(t.length<py.length)return!1;for(let e=0;e<py.length;e++)if(t[e]!==py[e])return!1;return!0}const Pie="tEXt",Rie=0,LM=new TextDecoder("latin1");function Die(t){if(Uie(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Lie=/^[\u0000-\u00FF]*$/;function Uie(t){if(!Lie.test(t))throw new Error("invalid latin1 text")}function Oie(t,e,r){const n=UM(e);t[n]=Mie(e,r-n.length-1)}function UM(t){for(t.mark();t.readByte()!==Rie;);const e=t.offset;t.reset();const r=LM.decode(t.readBytes(e-t.offset-1));return t.skip(1),Die(r),r}function Mie(t,e){return LM.decode(t.readBytes(e))}const po={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},RN={UNKNOWN:-1,DEFLATE:0},bj={UNKNOWN:-1,ADAPTIVE:0},DN={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},A1={NONE:0,BACKGROUND:1,PREVIOUS:2},LN={SOURCE:0,OVER:1};class Qie extends tI{constructor(r,n={}){super(r);Nn(this,"_checkCrc");Nn(this,"_inflator");Nn(this,"_png");Nn(this,"_apng");Nn(this,"_end");Nn(this,"_hasPalette");Nn(this,"_palette");Nn(this,"_hasTransparency");Nn(this,"_transparency");Nn(this,"_compressionMethod");Nn(this,"_filterMethod");Nn(this,"_interlaceMethod");Nn(this,"_colorType");Nn(this,"_isAnimated");Nn(this,"_numberOfFrames");Nn(this,"_numberOfPlays");Nn(this,"_frames");Nn(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new gj,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=RN.UNKNOWN,this._filterMethod=bj.UNKNOWN,this._interlaceMethod=DN.UNKNOWN,this._colorType=po.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(wj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(wj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Pie:Oie(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vj(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vj(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Vie(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case po.GREYSCALE:s=1;break;case po.TRUECOLOUR:s=3;break;case po.INDEXED_COLOUR:s=1;break;case po.GREYSCALE_ALPHA:s=2;break;case po.TRUECOLOUR_ALPHA:s=4;break;case po.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==RN.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let a=0;a<n;a++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case po.GREYSCALE:case po.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case po.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case po.UNKNOWN:case po.GREYSCALE_ALPHA:case po.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=UM(this),s=this.readUint8();if(s!==RN.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:xie(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=yj({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(s,a,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case A1.NONE:break;case A1.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let o=0;o<this._png.width;o++){const l=(a*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case A1.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,a=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,A=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:A}};switch(n.blendOp){case LN.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[A+u]}break;case LN.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++){const d=n.data[A+this._png.channels-1]/s,f=u%(this._png.channels-1)===0?1:n.data[A+u],h=Math.floor(d*f+(1-d)*r.data[c+u]);r.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==bj.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===DN.NO_INTERLACE)this._png.data=yj({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===DN.ADAM7)this._png.data=Eie({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:A1.NONE,blendOp:LN.SOURCE,data:r}),this._inflator=new gj,this._writingDataChunks=!1}}function Vie(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var Nj;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(Nj||(Nj={}));function Hie(t,e){return new Qie(t,e).decode()}var Ir=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function UN(){Ir.console&&typeof Ir.console.log=="function"&&Ir.console.log.apply(Ir.console,arguments)}var Vn={log:UN,warn:function(t){Ir.console&&(typeof Ir.console.warn=="function"?Ir.console.warn.apply(Ir.console,arguments):UN.call(null,arguments))},error:function(t){Ir.console&&(typeof Ir.console.error=="function"?Ir.console.error.apply(Ir.console,arguments):UN(t))}};function ON(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Gd(n.response,e,r)},n.onerror=function(){Vn.error("could not download file")},n.send()}function Cj(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function u1(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Gd=Ir.saveAs||((typeof window>"u"?"undefined":Sn(window))!=="object"||window!==Ir?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Ir.URL||Ir.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?Cj(s.href)?ON(t,e,r):u1(s,s.target="_blank"):u1(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){u1(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(Cj(t))ON(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){u1(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:Sn(a)!=="object"&&(Vn.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return ON(t,e,r);var s=t.type==="application/octet-stream",a=/constructor/i.test(Ir.HTMLElement)||Ir.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&a)&&(typeof FileReader>"u"?"undefined":Sn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(t)}else{var c=Ir.URL||Ir.webkitURL,A=c.createObjectURL(t);n?n.location=A:location.href=A,n=null,setTimeout(function(){c.revokeObjectURL(A)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function OM(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,o=s.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),A=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),A.length==1&&(A="0"+A),"#"+l+c+A}}var gy=Ir.atob.bind(Ir),_j=Ir.btoa.bind(Ir);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function MN(t,e){var r=t[0],n=t[1],s=t[2],a=t[3];r=ni(r,n,s,a,e[0],7,-680876936),a=ni(a,r,n,s,e[1],12,-389564586),s=ni(s,a,r,n,e[2],17,606105819),n=ni(n,s,a,r,e[3],22,-1044525330),r=ni(r,n,s,a,e[4],7,-176418897),a=ni(a,r,n,s,e[5],12,1200080426),s=ni(s,a,r,n,e[6],17,-1473231341),n=ni(n,s,a,r,e[7],22,-45705983),r=ni(r,n,s,a,e[8],7,1770035416),a=ni(a,r,n,s,e[9],12,-1958414417),s=ni(s,a,r,n,e[10],17,-42063),n=ni(n,s,a,r,e[11],22,-1990404162),r=ni(r,n,s,a,e[12],7,1804603682),a=ni(a,r,n,s,e[13],12,-40341101),s=ni(s,a,r,n,e[14],17,-1502002290),r=si(r,n=ni(n,s,a,r,e[15],22,1236535329),s,a,e[1],5,-165796510),a=si(a,r,n,s,e[6],9,-1069501632),s=si(s,a,r,n,e[11],14,643717713),n=si(n,s,a,r,e[0],20,-373897302),r=si(r,n,s,a,e[5],5,-701558691),a=si(a,r,n,s,e[10],9,38016083),s=si(s,a,r,n,e[15],14,-660478335),n=si(n,s,a,r,e[4],20,-405537848),r=si(r,n,s,a,e[9],5,568446438),a=si(a,r,n,s,e[14],9,-1019803690),s=si(s,a,r,n,e[3],14,-187363961),n=si(n,s,a,r,e[8],20,1163531501),r=si(r,n,s,a,e[13],5,-1444681467),a=si(a,r,n,s,e[2],9,-51403784),s=si(s,a,r,n,e[7],14,1735328473),r=ai(r,n=si(n,s,a,r,e[12],20,-1926607734),s,a,e[5],4,-378558),a=ai(a,r,n,s,e[8],11,-2022574463),s=ai(s,a,r,n,e[11],16,1839030562),n=ai(n,s,a,r,e[14],23,-35309556),r=ai(r,n,s,a,e[1],4,-1530992060),a=ai(a,r,n,s,e[4],11,1272893353),s=ai(s,a,r,n,e[7],16,-155497632),n=ai(n,s,a,r,e[10],23,-1094730640),r=ai(r,n,s,a,e[13],4,681279174),a=ai(a,r,n,s,e[0],11,-358537222),s=ai(s,a,r,n,e[3],16,-722521979),n=ai(n,s,a,r,e[6],23,76029189),r=ai(r,n,s,a,e[9],4,-640364487),a=ai(a,r,n,s,e[12],11,-421815835),s=ai(s,a,r,n,e[15],16,530742520),r=ii(r,n=ai(n,s,a,r,e[2],23,-995338651),s,a,e[0],6,-198630844),a=ii(a,r,n,s,e[7],10,1126891415),s=ii(s,a,r,n,e[14],15,-1416354905),n=ii(n,s,a,r,e[5],21,-57434055),r=ii(r,n,s,a,e[12],6,1700485571),a=ii(a,r,n,s,e[3],10,-1894986606),s=ii(s,a,r,n,e[10],15,-1051523),n=ii(n,s,a,r,e[1],21,-2054922799),r=ii(r,n,s,a,e[8],6,1873313359),a=ii(a,r,n,s,e[15],10,-30611744),s=ii(s,a,r,n,e[6],15,-1560198380),n=ii(n,s,a,r,e[13],21,1309151649),r=ii(r,n,s,a,e[4],6,-145523070),a=ii(a,r,n,s,e[11],10,-1120210379),s=ii(s,a,r,n,e[2],15,718787259),n=ii(n,s,a,r,e[9],21,-343485551),t[0]=ju(r,t[0]),t[1]=ju(n,t[1]),t[2]=ju(s,t[2]),t[3]=ju(a,t[3])}function q2(t,e,r,n,s,a){return e=ju(ju(e,t),ju(n,a)),ju(e<<s|e>>>32-s,r)}function ni(t,e,r,n,s,a,o){return q2(e&r|~e&n,t,e,s,a,o)}function si(t,e,r,n,s,a,o){return q2(e&n|r&~n,t,e,s,a,o)}function ai(t,e,r,n,s,a,o){return q2(e^r^n,t,e,s,a,o)}function ii(t,e,r,n,s,a,o){return q2(r^(e|~n),t,e,s,a,o)}function MM(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)MN(n,Kie(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(MN(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,MN(n,s),n}function Kie(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var Ej="0123456789abcdef".split("");function qie(t){for(var e="",r=0;r<4;r++)e+=Ej[t>>8*r+4&15]+Ej[t>>8*r&15];return e}function Gie(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function bE(t){return MM(t).map(Gie).join("")}var $ie=function(t){for(var e=0;e<t.length;e++)t[e]=qie(t[e]);return t.join("")}(MM("hello"))!="5d41402abc4b2a76b9719d911017c592";function ju(t,e){if($ie){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function NE(t,e){var r,n,s,a;if(t!==r){for(var o=(s=t,a=1+(256/t.length|0),new Array(a+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var A=0;for(c=0;c<256;c++){var u=l[c];A=(A+u+o.charCodeAt(c))%256,l[c]=l[A],l[A]=u}r=t,n=l}else l=n;var d=e.length,f=0,h=0,m="";for(c=0;c<d;c++)h=(h+(u=l[f=(f+1)%256]))%256,l[f]=l[h],l[h]=u,o=l[(l[f]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Bj={print:4,modify:8,copy:16,"annot-forms":32};function qf(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(Bj.perm!==void 0)throw new Error("Invalid permission: "+l);s+=Bj[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^s)),this.encryptionKey=bE(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=NE(this.encryptionKey,this.padding)}function Gf(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):t[n]}return e}function Sj(t){if(Sn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in e[r]){var o=e[r][a];try{o[0].apply(t,n)}catch(l){Ir.console&&Vn.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Jg(t){if(!(this instanceof Jg))return new Jg(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function QM(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Eu(t,e,r,n,s){if(!(this instanceof Eu))return new Eu(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,QM.call(this,n,s)}function sh(t,e,r,n,s){if(!(this instanceof sh))return new sh(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,QM.call(this,n,s)}function or(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],o=[],l=1,c=16,A="S",u=null;Sn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,a=t.compress||t.compressPdf||a,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),A=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var d=t.putOnlyUsedFonts||!1,f={},h={internal:{},__private__:{}};h.__private__.PubSub=Sj;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(D){m=D};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var g=h.__private__.getPageFormat=function(D){return x[D]};s=s||"a4";var w="compat",b="advanced",k=w;function P(){this.saveGraphicsState(),W(new et(ge,0,0,-ge,0,Qo()*ge).toString()+" cm"),this.setFontSize(this.getFontSize()/ge),A="n",k=b}function L(){this.restoreGraphicsState(),A="S",k=w}var E=h.__private__.combineFontStyleAndFontWeight=function(D,le){if(D=="bold"&&le=="normal"||D=="bold"&&le==400||D=="normal"&&le=="italic"||D=="bold"&&le=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return le&&(D=le==400||le==="normal"?D==="italic"?"italic":"normal":le!=700&&le!=="bold"||D!=="normal"?(le==700?"bold":le)+""+D:"bold"),D};h.advancedAPI=function(D){var le=k===w;return le&&P.call(this),typeof D!="function"||(D(this),le&&L.call(this)),this},h.compatAPI=function(D){var le=k===b;return le&&L.call(this),typeof D!="function"||(D(this),le&&P.call(this)),this},h.isAdvancedAPI=function(){return k===b};var _,B=function(D){if(k!==b)throw new Error(D+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},M=h.roundToPrecision=h.__private__.roundToPrecision=function(D,le){var Ke=e||le;if(isNaN(D)||isNaN(Ke))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return D.toFixed(Ke).replace(/0+$/,"")};_=h.hpf=h.__private__.hpf=typeof c=="number"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return M(D,c)}:c==="smart"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return M(D,D>-1&&D<1?16:5)}:function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return M(D,16)};var F=h.f2=h.__private__.f2=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f2");return M(D,2)},T=h.__private__.f3=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f3");return M(D,3)},O=h.scale=h.__private__.scale=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.scale");return k===w?D*ge:k===b?D:void 0},Y=function(D){return O(function(le){return k===w?Qo()-le:k===b?le:void 0}(D))};h.__private__.setPrecision=h.setPrecision=function(D){typeof parseInt(D,10)=="number"&&(e=parseInt(D,10))};var me,ae="00000000000000000000000000000000",fe=h.__private__.getFileId=function(){return ae},he=h.__private__.setFileId=function(D){return ae=D!==void 0&&/^[a-fA-F0-9]{32}$/.test(D)?D.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Ln=new qf(u.userPermissions,u.userPassword,u.ownerPassword,ae)),ae};h.setFileId=function(D){return he(D),this},h.getFileId=function(){return fe()};var te=h.__private__.convertDateToPDFDate=function(D){var le=D.getTimezoneOffset(),Ke=le<0?"+":"-",tt=Math.floor(Math.abs(le/60)),ht=Math.abs(le%60),St=[Ke,V(tt),"'",V(ht),"'"].join("");return["D:",D.getFullYear(),V(D.getMonth()+1),V(D.getDate()),V(D.getHours()),V(D.getMinutes()),V(D.getSeconds()),St].join("")},pe=h.__private__.convertPDFDateToDate=function(D){var le=parseInt(D.substr(2,4),10),Ke=parseInt(D.substr(6,2),10)-1,tt=parseInt(D.substr(8,2),10),ht=parseInt(D.substr(10,2),10),St=parseInt(D.substr(12,2),10),Pt=parseInt(D.substr(14,2),10);return new Date(le,Ke,tt,ht,St,Pt,0)},Ie=h.__private__.setCreationDate=function(D){var le;if(D===void 0&&(D=new Date),D instanceof Date)le=te(D);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(D))throw new Error("Invalid argument passed to jsPDF.setCreationDate");le=D}return me=le},S=h.__private__.getCreationDate=function(D){var le=me;return D==="jsDate"&&(le=pe(me)),le};h.setCreationDate=function(D){return Ie(D),this},h.getCreationDate=function(D){return S(D)};var I,V=h.__private__.padd2=function(D){return("0"+parseInt(D)).slice(-2)},j=h.__private__.padd2Hex=function(D){return("00"+(D=D.toString())).substr(D.length)},U=0,G=[],R=[],X=0,se=[],ye=[],z=!1,Me=R;h.__private__.setCustomOutputDestination=function(D){z=!0,Me=D};var re=function(D){z||(Me=D)};h.__private__.resetCustomOutputDestination=function(){z=!1,Me=R};var W=h.__private__.out=function(D){return D=D.toString(),X+=D.length+1,Me.push(D),Me},q=h.__private__.write=function(D){return W(arguments.length===1?D.toString():Array.prototype.join.call(arguments," "))},oe=h.__private__.getArrayBuffer=function(D){for(var le=D.length,Ke=new ArrayBuffer(le),tt=new Uint8Array(Ke);le--;)tt[le]=D.charCodeAt(le);return Ke},de=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return de};var Be=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(D){return Be=k===b?D/ge:D,this};var He,$e=h.__private__.getFontSize=h.getFontSize=function(){return k===w?Be:Be*ge},Je=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(D){return Je=D,this},h.__private__.getR2L=h.getR2L=function(){return Je};var ct,at=h.__private__.setZoomMode=function(D){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(D))He=D;else if(isNaN(D)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(D)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+D+'" is not recognized.');He=D}else He=parseInt(D,10)};h.__private__.getZoomMode=function(){return He};var mt,st=h.__private__.setPageMode=function(D){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(D)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+D+'" is not recognized.');ct=D};h.__private__.getPageMode=function(){return ct};var Le=h.__private__.setLayoutMode=function(D){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(D)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+D+'" is not recognized.');mt=D};h.__private__.getLayoutMode=function(){return mt},h.__private__.setDisplayMode=h.setDisplayMode=function(D,le,Ke){return at(D),Le(le),st(Ke),this};var ut={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(D){if(Object.keys(ut).indexOf(D)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ut[D]},h.__private__.getDocumentProperties=function(){return ut},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(D){for(var le in ut)ut.hasOwnProperty(le)&&D[le]&&(ut[le]=D[le]);return this},h.__private__.setDocumentProperty=function(D,le){if(Object.keys(ut).indexOf(D)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ut[D]=le};var be,ge,K,_e,Oe,Ve={},ve={},Qe=[],Ue={},Ee={},We={},nt={},Nt=null,ot=0,wt=[],Lt=new Sj(h),cr=t.hotfixes||[],ar={},yr={},tr=[],et=function D(le,Ke,tt,ht,St,Pt){if(!(this instanceof D))return new D(le,Ke,tt,ht,St,Pt);isNaN(le)&&(le=1),isNaN(Ke)&&(Ke=0),isNaN(tt)&&(tt=0),isNaN(ht)&&(ht=1),isNaN(St)&&(St=0),isNaN(Pt)&&(Pt=0),this._matrix=[le,Ke,tt,ht,St,Pt]};Object.defineProperty(et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(et.prototype,"a",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(et.prototype,"b",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(et.prototype,"c",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(et.prototype,"d",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(et.prototype,"e",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(et.prototype,"f",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),et.prototype.join=function(D){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(_).join(D)},et.prototype.multiply=function(D){var le=D.sx*this.sx+D.shy*this.shx,Ke=D.sx*this.shy+D.shy*this.sy,tt=D.shx*this.sx+D.sy*this.shx,ht=D.shx*this.shy+D.sy*this.sy,St=D.tx*this.sx+D.ty*this.shx+this.tx,Pt=D.tx*this.shy+D.ty*this.sy+this.ty;return new et(le,Ke,tt,ht,St,Pt)},et.prototype.decompose=function(){var D=this.sx,le=this.shy,Ke=this.shx,tt=this.sy,ht=this.tx,St=this.ty,Pt=Math.sqrt(D*D+le*le),ir=(D/=Pt)*Ke+(le/=Pt)*tt;Ke-=D*ir,tt-=le*ir;var hr=Math.sqrt(Ke*Ke+tt*tt);return ir/=hr,D*(tt/=hr)<le*(Ke/=hr)&&(D=-D,le=-le,ir=-ir,Pt=-Pt),{scale:new et(Pt,0,0,hr,0,0),translate:new et(1,0,0,1,ht,St),rotate:new et(D,le,-le,D,0,0),skew:new et(1,0,ir,1,0,0)}},et.prototype.toString=function(D){return this.join(" ")},et.prototype.inversed=function(){var D=this.sx,le=this.shy,Ke=this.shx,tt=this.sy,ht=this.tx,St=this.ty,Pt=1/(D*tt-le*Ke),ir=tt*Pt,hr=-le*Pt,Nr=-Ke*Pt,kr=D*Pt;return new et(ir,hr,Nr,kr,-ir*ht-Nr*St,-hr*ht-kr*St)},et.prototype.applyToPoint=function(D){var le=D.x*this.sx+D.y*this.shx+this.tx,Ke=D.x*this.shy+D.y*this.sy+this.ty;return new Oo(le,Ke)},et.prototype.applyToRectangle=function(D){var le=this.applyToPoint(D),Ke=this.applyToPoint(new Oo(D.x+D.w,D.y+D.h));return new QA(le.x,le.y,Ke.x-le.x,Ke.y-le.y)},et.prototype.clone=function(){var D=this.sx,le=this.shy,Ke=this.shx,tt=this.sy,ht=this.tx,St=this.ty;return new et(D,le,Ke,tt,ht,St)},h.Matrix=et;var gt=h.matrixMult=function(D,le){return le.multiply(D)},Rt=new et(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Rt;var kt=function(D,le){if(!Ee[D]){var Ke=(le instanceof Eu?"Sh":"P")+(Object.keys(Ue).length+1).toString(10);le.id=Ke,Ee[D]=Ke,Ue[Ke]=le,Lt.publish("addPattern",le)}};h.ShadingPattern=Eu,h.TilingPattern=sh,h.addShadingPattern=function(D,le){return B("addShadingPattern()"),kt(D,le),this},h.beginTilingPattern=function(D){B("beginTilingPattern()"),tc(D.boundingBox[0],D.boundingBox[1],D.boundingBox[2]-D.boundingBox[0],D.boundingBox[3]-D.boundingBox[1],D.matrix)},h.endTilingPattern=function(D,le){B("endTilingPattern()"),le.stream=ye[I].join(`
`),kt(D,le),Lt.publish("endTilingPattern",le),tr.pop().restore()};var jt,Zt=h.__private__.newObject=function(){var D=Vt();return ie(D,!0),D},Vt=h.__private__.newObjectDeferred=function(){return U++,G[U]=function(){return X},U},ie=function(D,le){return le=typeof le=="boolean"&&le,G[D]=X,le&&W(D+" 0 obj"),D},ne=h.__private__.newAdditionalObject=function(){var D={objId:Vt(),content:""};return se.push(D),D},ue=Vt(),xe=Vt(),Fe=h.__private__.decodeColorString=function(D){var le=D.split(" ");if(le.length!==2||le[1]!=="g"&&le[1]!=="G")le.length!==5||le[4]!=="k"&&le[4]!=="K"||(le=[(1-le[0])*(1-le[3]),(1-le[1])*(1-le[3]),(1-le[2])*(1-le[3]),"r"]);else{var Ke=parseFloat(le[0]);le=[Ke,Ke,Ke,"r"]}for(var tt="#",ht=0;ht<3;ht++)tt+=("0"+Math.floor(255*parseFloat(le[ht])).toString(16)).slice(-2);return tt},De=h.__private__.encodeColorString=function(D){var le;typeof D=="string"&&(D={ch1:D});var Ke=D.ch1,tt=D.ch2,ht=D.ch3,St=D.ch4,Pt=D.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ke=="string"&&Ke.charAt(0)!=="#"){var ir=new OM(Ke);if(ir.ok)Ke=ir.toHex();else if(!/^\d*\.?\d*$/.test(Ke))throw new Error('Invalid color "'+Ke+'" passed to jsPDF.encodeColorString.')}if(typeof Ke=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ke)&&(Ke="#"+Ke[1]+Ke[1]+Ke[2]+Ke[2]+Ke[3]+Ke[3]),typeof Ke=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ke)){var hr=parseInt(Ke.substr(1),16);Ke=hr>>16&255,tt=hr>>8&255,ht=255&hr}if(tt===void 0||St===void 0&&Ke===tt&&tt===ht)le=typeof Ke=="string"?Ke+" "+Pt[0]:D.precision===2?F(Ke/255)+" "+Pt[0]:T(Ke/255)+" "+Pt[0];else if(St===void 0||Sn(St)==="object"){if(St&&!isNaN(St.a)&&St.a===0)return["1.","1.","1.",Pt[1]].join(" ");le=typeof Ke=="string"?[Ke,tt,ht,Pt[1]].join(" "):D.precision===2?[F(Ke/255),F(tt/255),F(ht/255),Pt[1]].join(" "):[T(Ke/255),T(tt/255),T(ht/255),Pt[1]].join(" ")}else le=typeof Ke=="string"?[Ke,tt,ht,St,Pt[2]].join(" "):D.precision===2?[F(Ke),F(tt),F(ht),F(St),Pt[2]].join(" "):[T(Ke),T(tt),T(ht),T(St),Pt[2]].join(" ");return le},ee=h.__private__.getFilters=function(){return o},Te=h.__private__.putStream=function(D){var le=(D=D||{}).data||"",Ke=D.filters||ee(),tt=D.alreadyAppliedFilters||[],ht=D.addLength1||!1,St=le.length,Pt=D.objectId,ir=function(_s){return _s};if(u!==null&&Pt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(ir=Ln.encryptor(Pt,0));var hr={};Ke===!0&&(Ke=["FlateEncode"]);var Nr=D.additionalKeyValues||[],kr=(hr=or.API.processDataByFilters!==void 0?or.API.processDataByFilters(le,Ke):{data:le,reverseChain:[]}).reverseChain+(Array.isArray(tt)?tt.join(" "):tt.toString());if(hr.data.length!==0&&(Nr.push({key:"Length",value:hr.data.length}),ht===!0&&Nr.push({key:"Length1",value:St})),kr.length!=0)if(kr.split("/").length-1==1)Nr.push({key:"Filter",value:kr});else{Nr.push({key:"Filter",value:"["+kr+"]"});for(var Zr=0;Zr<Nr.length;Zr+=1)if(Nr[Zr].key==="DecodeParms"){for(var gn=[],ms=0;ms<hr.reverseChain.split("/").length-1;ms+=1)gn.push("null");gn.push(Nr[Zr].value),Nr[Zr].value="["+gn.join(" ")+"]"}}W("<<");for(var yn=0;yn<Nr.length;yn++)W("/"+Nr[yn].key+" "+Nr[yn].value);W(">>"),hr.data.length!==0&&(W("stream"),W(ir(hr.data)),W("endstream"))},Ae=h.__private__.putPage=function(D){var le=D.number,Ke=D.data,tt=D.objId,ht=D.contentsObjId;ie(tt,!0),W("<</Type /Page"),W("/Parent "+D.rootDictionaryObjId+" 0 R"),W("/Resources "+D.resourceDictionaryObjId+" 0 R"),W("/MediaBox ["+parseFloat(_(D.mediaBox.bottomLeftX))+" "+parseFloat(_(D.mediaBox.bottomLeftY))+" "+_(D.mediaBox.topRightX)+" "+_(D.mediaBox.topRightY)+"]"),D.cropBox!==null&&W("/CropBox ["+_(D.cropBox.bottomLeftX)+" "+_(D.cropBox.bottomLeftY)+" "+_(D.cropBox.topRightX)+" "+_(D.cropBox.topRightY)+"]"),D.bleedBox!==null&&W("/BleedBox ["+_(D.bleedBox.bottomLeftX)+" "+_(D.bleedBox.bottomLeftY)+" "+_(D.bleedBox.topRightX)+" "+_(D.bleedBox.topRightY)+"]"),D.trimBox!==null&&W("/TrimBox ["+_(D.trimBox.bottomLeftX)+" "+_(D.trimBox.bottomLeftY)+" "+_(D.trimBox.topRightX)+" "+_(D.trimBox.topRightY)+"]"),D.artBox!==null&&W("/ArtBox ["+_(D.artBox.bottomLeftX)+" "+_(D.artBox.bottomLeftY)+" "+_(D.artBox.topRightX)+" "+_(D.artBox.topRightY)+"]"),typeof D.userUnit=="number"&&D.userUnit!==1&&W("/UserUnit "+D.userUnit),Lt.publish("putPage",{objId:tt,pageContext:wt[le],pageNumber:le,page:Ke}),W("/Contents "+ht+" 0 R"),W(">>"),W("endobj");var St=Ke.join(`
`);return k===b&&(St+=`
Q`),ie(ht,!0),Te({data:St,filters:ee(),objectId:ht}),W("endobj"),tt},Pe=h.__private__.putPages=function(){var D,le,Ke=[];for(D=1;D<=ot;D++)wt[D].objId=Vt(),wt[D].contentsObjId=Vt();for(D=1;D<=ot;D++)Ke.push(Ae({number:D,data:ye[D],objId:wt[D].objId,contentsObjId:wt[D].contentsObjId,mediaBox:wt[D].mediaBox,cropBox:wt[D].cropBox,bleedBox:wt[D].bleedBox,trimBox:wt[D].trimBox,artBox:wt[D].artBox,userUnit:wt[D].userUnit,rootDictionaryObjId:ue,resourceDictionaryObjId:xe}));ie(ue,!0),W("<</Type /Pages");var tt="/Kids [";for(le=0;le<ot;le++)tt+=Ke[le]+" 0 R ";W(tt+"]"),W("/Count "+ot),W(">>"),W("endobj"),Lt.publish("postPutPages")},Ce=function(D){Lt.publish("putFont",{font:D,out:W,newObject:Zt,putStream:Te}),D.isAlreadyPutted!==!0&&(D.objectNumber=Zt(),W("<<"),W("/Type /Font"),W("/BaseFont /"+Gf(D.postScriptName)),W("/Subtype /Type1"),typeof D.encoding=="string"&&W("/Encoding /"+D.encoding),W("/FirstChar 32"),W("/LastChar 255"),W(">>"),W("endobj"))},Ze=function(D){D.objectNumber=Zt();var le=[];le.push({key:"Type",value:"/XObject"}),le.push({key:"Subtype",value:"/Form"}),le.push({key:"BBox",value:"["+[_(D.x),_(D.y),_(D.x+D.width),_(D.y+D.height)].join(" ")+"]"}),le.push({key:"Matrix",value:"["+D.matrix.toString()+"]"});var Ke=D.pages[1].join(`
`);Te({data:Ke,additionalKeyValues:le,objectId:D.objectNumber}),W("endobj")},Xe=function(D,le){le||(le=21);var Ke=Zt(),tt=function(Pt,ir){var hr,Nr=[],kr=1/(ir-1);for(hr=0;hr<1;hr+=kr)Nr.push(hr);if(Nr.push(1),Pt[0].offset!=0){var Zr={offset:0,color:Pt[0].color};Pt.unshift(Zr)}if(Pt[Pt.length-1].offset!=1){var gn={offset:1,color:Pt[Pt.length-1].color};Pt.push(gn)}for(var ms="",yn=0,_s=0;_s<Nr.length;_s++){for(hr=Nr[_s];hr>Pt[yn+1].offset;)yn++;var ps=Pt[yn].offset,Es=(hr-ps)/(Pt[yn+1].offset-ps),gs=Pt[yn].color,Qi=Pt[yn+1].color;ms+=j(Math.round((1-Es)*gs[0]+Es*Qi[0]).toString(16))+j(Math.round((1-Es)*gs[1]+Es*Qi[1]).toString(16))+j(Math.round((1-Es)*gs[2]+Es*Qi[2]).toString(16))}return ms.trim()}(D.colors,le),ht=[];ht.push({key:"FunctionType",value:"0"}),ht.push({key:"Domain",value:"[0.0 1.0]"}),ht.push({key:"Size",value:"["+le+"]"}),ht.push({key:"BitsPerSample",value:"8"}),ht.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ht.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Te({data:tt,additionalKeyValues:ht,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ke}),W("endobj"),D.objectNumber=Zt(),W("<< /ShadingType "+D.type),W("/ColorSpace /DeviceRGB");var St="/Coords ["+_(parseFloat(D.coords[0]))+" "+_(parseFloat(D.coords[1]))+" ";D.type===2?St+=_(parseFloat(D.coords[2]))+" "+_(parseFloat(D.coords[3])):St+=_(parseFloat(D.coords[2]))+" "+_(parseFloat(D.coords[3]))+" "+_(parseFloat(D.coords[4]))+" "+_(parseFloat(D.coords[5])),W(St+="]"),D.matrix&&W("/Matrix ["+D.matrix.toString()+"]"),W("/Function "+Ke+" 0 R"),W("/Extend [true true]"),W(">>"),W("endobj")},Ye=function(D,le){var Ke=Vt(),tt=Zt();le.push({resourcesOid:Ke,objectOid:tt}),D.objectNumber=tt;var ht=[];ht.push({key:"Type",value:"/Pattern"}),ht.push({key:"PatternType",value:"1"}),ht.push({key:"PaintType",value:"1"}),ht.push({key:"TilingType",value:"1"}),ht.push({key:"BBox",value:"["+D.boundingBox.map(_).join(" ")+"]"}),ht.push({key:"XStep",value:_(D.xStep)}),ht.push({key:"YStep",value:_(D.yStep)}),ht.push({key:"Resources",value:Ke+" 0 R"}),D.matrix&&ht.push({key:"Matrix",value:"["+D.matrix.toString()+"]"}),Te({data:D.stream,additionalKeyValues:ht,objectId:D.objectNumber}),W("endobj")},ze=function(D){for(var le in D.objectNumber=Zt(),W("<<"),D)switch(le){case"opacity":W("/ca "+F(D[le]));break;case"stroke-opacity":W("/CA "+F(D[le]))}W(">>"),W("endobj")},rt=function(D){ie(D.resourcesOid,!0),W("<<"),W("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var le in W("/Font <<"),Ve)Ve.hasOwnProperty(le)&&(d===!1||d===!0&&f.hasOwnProperty(le))&&W("/"+le+" "+Ve[le].objectNumber+" 0 R");W(">>")}(),function(){if(Object.keys(Ue).length>0){for(var le in W("/Shading <<"),Ue)Ue.hasOwnProperty(le)&&Ue[le]instanceof Eu&&Ue[le].objectNumber>=0&&W("/"+le+" "+Ue[le].objectNumber+" 0 R");Lt.publish("putShadingPatternDict"),W(">>")}}(),function(le){if(Object.keys(Ue).length>0){for(var Ke in W("/Pattern <<"),Ue)Ue.hasOwnProperty(Ke)&&Ue[Ke]instanceof h.TilingPattern&&Ue[Ke].objectNumber>=0&&Ue[Ke].objectNumber<le&&W("/"+Ke+" "+Ue[Ke].objectNumber+" 0 R");Lt.publish("putTilingPatternDict"),W(">>")}}(D.objectOid),function(){if(Object.keys(We).length>0){var le;for(le in W("/ExtGState <<"),We)We.hasOwnProperty(le)&&We[le].objectNumber>=0&&W("/"+le+" "+We[le].objectNumber+" 0 R");Lt.publish("putGStateDict"),W(">>")}}(),function(){for(var le in W("/XObject <<"),ar)ar.hasOwnProperty(le)&&ar[le].objectNumber>=0&&W("/"+le+" "+ar[le].objectNumber+" 0 R");Lt.publish("putXobjectDict"),W(">>")}(),W(">>"),W("endobj")},dt=function(D){ve[D.fontName]=ve[D.fontName]||{},ve[D.fontName][D.fontStyle]=D.id},Mt=function(D,le,Ke,tt,ht){var St={id:"F"+(Object.keys(Ve).length+1).toString(10),postScriptName:D,fontName:le,fontStyle:Ke,encoding:tt,isStandardFont:ht||!1,metadata:{}};return Lt.publish("addFont",{font:St,instance:this}),Ve[St.id]=St,dt(St),St.id},Kt=h.__private__.pdfEscape=h.pdfEscape=function(D,le){return function(Ke,tt){var ht,St,Pt,ir,hr,Nr,kr,Zr,gn;if(Pt=(tt=tt||{}).sourceEncoding||"Unicode",hr=tt.outputEncoding,(tt.autoencode||hr)&&Ve[be].metadata&&Ve[be].metadata[Pt]&&Ve[be].metadata[Pt].encoding&&(ir=Ve[be].metadata[Pt].encoding,!hr&&Ve[be].encoding&&(hr=Ve[be].encoding),!hr&&ir.codePages&&(hr=ir.codePages[0]),typeof hr=="string"&&(hr=ir[hr]),hr)){for(kr=!1,Nr=[],ht=0,St=Ke.length;ht<St;ht++)(Zr=hr[Ke.charCodeAt(ht)])?Nr.push(String.fromCharCode(Zr)):Nr.push(Ke[ht]),Nr[ht].charCodeAt(0)>>8&&(kr=!0);Ke=Nr.join("")}for(ht=Ke.length;kr===void 0&&ht!==0;)Ke.charCodeAt(ht-1)>>8&&(kr=!0),ht--;if(!kr)return Ke;for(Nr=tt.noBOM?[]:[254,255],ht=0,St=Ke.length;ht<St;ht++){if((gn=(Zr=Ke.charCodeAt(ht))>>8)>>8)throw new Error("Character at position "+ht+" of string '"+Ke+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Nr.push(gn),Nr.push(Zr-(gn<<8))}return String.fromCharCode.apply(void 0,Nr)}(D,le).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xr=h.__private__.beginPage=function(D){ye[++ot]=[],wt[ot]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(D[0]),topRightY:Number(D[1])}},wi(ot),re(ye[I])},Hn=function(D,le){var Ke,tt,ht;switch(r=le||r,typeof D=="string"&&(Ke=g(D.toLowerCase()),Array.isArray(Ke)&&(tt=Ke[0],ht=Ke[1])),Array.isArray(D)&&(tt=D[0]*ge,ht=D[1]*ge),isNaN(tt)&&(tt=s[0],ht=s[1]),(tt>14400||ht>14400)&&(Vn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),tt=Math.min(14400,tt),ht=Math.min(14400,ht)),s=[tt,ht],r.substr(0,1)){case"l":ht>tt&&(s=[ht,tt]);break;case"p":tt>ht&&(s=[ht,tt])}xr(s),br(UA),W(vl),jn!==0&&W(jn+" J"),Ed!==0&&W(Ed+" j"),Lt.publish("addPage",{pageNumber:ot})},Tn=function(D){D>0&&D<=ot&&(ye.splice(D,1),wt.splice(D,1),ot--,I>ot&&(I=ot),this.setPage(I))},wi=function(D){D>0&&D<=ot&&(I=D)},Rs=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ye.length-1},no=function(D,le,Ke){var tt,ht=void 0;return Ke=Ke||{},D=D!==void 0?D:Ve[be].fontName,le=le!==void 0?le:Ve[be].fontStyle,tt=D.toLowerCase(),ve[tt]!==void 0&&ve[tt][le]!==void 0?ht=ve[tt][le]:ve[D]!==void 0&&ve[D][le]!==void 0?ht=ve[D][le]:Ke.disableWarning===!1&&Vn.warn("Unable to look up font label for font '"+D+"', '"+le+"'. Refer to getFontList() for available fonts."),ht||Ke.noFallback||(ht=ve.times[le])==null&&(ht=ve.times.normal),ht},Jn=h.__private__.putInfo=function(){var D=Zt(),le=function(tt){return tt};for(var Ke in u!==null&&(le=Ln.encryptor(D,0)),W("<<"),W("/Producer ("+Kt(le("jsPDF "+or.version))+")"),ut)ut.hasOwnProperty(Ke)&&ut[Ke]&&W("/"+Ke.substr(0,1).toUpperCase()+Ke.substr(1)+" ("+Kt(le(ut[Ke]))+")");W("/CreationDate ("+Kt(le(me))+")"),W(">>"),W("endobj")},so=h.__private__.putCatalog=function(D){var le=(D=D||{}).rootDictionaryObjId||ue;switch(Zt(),W("<<"),W("/Type /Catalog"),W("/Pages "+le+" 0 R"),He||(He="fullwidth"),He){case"fullwidth":W("/OpenAction [3 0 R /FitH null]");break;case"fullheight":W("/OpenAction [3 0 R /FitV null]");break;case"fullpage":W("/OpenAction [3 0 R /Fit]");break;case"original":W("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ke=""+He;Ke.substr(Ke.length-1)==="%"&&(He=parseInt(He)/100),typeof He=="number"&&W("/OpenAction [3 0 R /XYZ null null "+F(He)+"]")}switch(mt||(mt="continuous"),mt){case"continuous":W("/PageLayout /OneColumn");break;case"single":W("/PageLayout /SinglePage");break;case"two":case"twoleft":W("/PageLayout /TwoColumnLeft");break;case"tworight":W("/PageLayout /TwoColumnRight")}ct&&W("/PageMode /"+ct),Lt.publish("putCatalog"),W(">>"),W("endobj")},DA=h.__private__.putTrailer=function(){W("trailer"),W("<<"),W("/Size "+(U+1)),W("/Root "+U+" 0 R"),W("/Info "+(U-1)+" 0 R"),u!==null&&W("/Encrypt "+Ln.oid+" 0 R"),W("/ID [ <"+ae+"> <"+ae+"> ]"),W(">>")},Kn=h.__private__.putHeader=function(){W("%PDF-"+m),W("%")},Yl=h.__private__.putXRef=function(){var D="0000000000";W("xref"),W("0 "+(U+1)),W("0000000000 65535 f ");for(var le=1;le<=U;le++)typeof G[le]=="function"?W((D+G[le]()).slice(-10)+" 00000 n "):G[le]!==void 0?W((D+G[le]).slice(-10)+" 00000 n "):W("0000000000 00000 n ")},Ro=h.__private__.buildDocument=function(){var D;U=0,X=0,R=[],G=[],se=[],ue=Vt(),xe=Vt(),re(R),Lt.publish("buildDocument"),Kn(),Pe(),function(){Lt.publish("putAdditionalObjects");for(var Ke=0;Ke<se.length;Ke++){var tt=se[Ke];ie(tt.objId,!0),W(tt.content),W("endobj")}Lt.publish("postPutAdditionalObjects")}(),D=[],function(){for(var Ke in Ve)Ve.hasOwnProperty(Ke)&&(d===!1||d===!0&&f.hasOwnProperty(Ke))&&Ce(Ve[Ke])}(),function(){var Ke;for(Ke in We)We.hasOwnProperty(Ke)&&ze(We[Ke])}(),function(){for(var Ke in ar)ar.hasOwnProperty(Ke)&&Ze(ar[Ke])}(),function(Ke){var tt;for(tt in Ue)Ue.hasOwnProperty(tt)&&(Ue[tt]instanceof Eu?Xe(Ue[tt]):Ue[tt]instanceof sh&&Ye(Ue[tt],Ke))}(D),Lt.publish("putResources"),D.forEach(rt),rt({resourcesOid:xe,objectOid:Number.MAX_SAFE_INTEGER}),Lt.publish("postPutResources"),u!==null&&(Ln.oid=Zt(),W("<<"),W("/Filter /Standard"),W("/V "+Ln.v),W("/R "+Ln.r),W("/U <"+Ln.toHexString(Ln.U)+">"),W("/O <"+Ln.toHexString(Ln.O)+">"),W("/P "+Ln.P),W(">>"),W("endobj")),Jn(),so();var le=X;return Yl(),DA(),W("startxref"),W(""+le),W("%%EOF"),re(ye[I]),R.join(`
`)},Pc=h.__private__.getBlob=function(D){return new Blob([oe(D)],{type:"application/pdf"})},Nd=h.output=h.__private__.output=(jt=function(D,le){switch(typeof(le=le||{})=="string"?le={filename:le}:le.filename=le.filename||"generated.pdf",D){case void 0:return Ro();case"save":h.save(le.filename);break;case"arraybuffer":return oe(Ro());case"blob":return Pc(Ro());case"bloburi":case"bloburl":if(Ir.URL!==void 0&&typeof Ir.URL.createObjectURL=="function")return Ir.URL&&Ir.URL.createObjectURL(Pc(Ro()))||void 0;Vn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ke="",tt=Ro();try{Ke=_j(tt)}catch{Ke=_j(unescape(encodeURIComponent(tt)))}return"data:application/pdf;filename="+le.filename+";base64,"+Ke;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var ht="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",St=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';le.pdfObjectUrl&&(ht=le.pdfObjectUrl,St="");var Pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ht+'"'+St+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(le)+");<\/script></body></html>",ir=Ir.open();return ir!==null&&ir.document.write(Pt),ir}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(le.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+le.filename+'" width="500px" height="400px" /></body></html>',Nr=Ir.open();if(Nr!==null){Nr.document.write(hr);var kr=this;Nr.document.documentElement.querySelector("#pdfViewer").onload=function(){Nr.document.title=le.filename,Nr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(kr.output("bloburl"))}}return Nr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ir)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Zr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",le)+'"></iframe></body></html>',gn=Ir.open();if(gn!==null&&(gn.document.write(Zr),gn.document.title=le.filename),gn||typeof safari>"u")return gn;break;case"datauri":case"dataurl":return Ir.document.location.href=this.output("datauristring",le);default:return null}},jt.foo=function(){try{return jt.apply(this,arguments)}catch(Ke){var D=Ke.stack||"";~D.indexOf(" at ")&&(D=D.split(" at ")[1]);var le="Error in function "+D.split(`
`)[0].split("<")[0]+": "+Ke.message;if(!Ir.console)throw new Error(le);Ir.console.error(le,Ke),Ir.alert&&alert(le)}},jt.foo.bar=jt,jt.foo),Mi=function(D){return Array.isArray(cr)===!0&&cr.indexOf(D)>-1};switch(n){case"pt":ge=1;break;case"mm":ge=72/25.4;break;case"cm":ge=72/2.54;break;case"in":ge=72;break;case"px":ge=Mi("px_scaling")==1?.75:96/72;break;case"pc":case"em":ge=12;break;case"ex":ge=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ge=n}var Ln=null;Ie(),he();var ra=h.__private__.getPageInfo=h.getPageInfo=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:wt[D].objId,pageNumber:D,pageContext:wt[D]}},Rc=h.__private__.getPageInfoByObjId=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var le in wt)if(wt[le].objId===D)break;return ra(le)},LA=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:wt[I].objId,pageNumber:I,pageContext:wt[I]}};h.addPage=function(){return Hn.apply(this,arguments),this},h.setPage=function(){return wi.apply(this,arguments),re.call(this,ye[I]),this},h.insertPage=function(D){return this.addPage(),this.movePage(I,D),this},h.movePage=function(D,le){var Ke,tt;if(D>le){Ke=ye[D],tt=wt[D];for(var ht=D;ht>le;ht--)ye[ht]=ye[ht-1],wt[ht]=wt[ht-1];ye[le]=Ke,wt[le]=tt,this.setPage(le)}else if(D<le){Ke=ye[D],tt=wt[D];for(var St=D;St<le;St++)ye[St]=ye[St+1],wt[St]=wt[St+1];ye[le]=Ke,wt[le]=tt,this.setPage(le)}return this},h.deletePage=function(){return Tn.apply(this,arguments),this},h.__private__.text=h.text=function(D,le,Ke,tt,ht){var St,Pt,ir,hr,Nr,kr,Zr,gn,ms,yn=(tt=tt||{}).scope||this;if(typeof D=="number"&&typeof le=="number"&&(typeof Ke=="string"||Array.isArray(Ke))){var _s=Ke;Ke=le,le=D,D=_s}if(arguments[3]instanceof et==0?(ir=arguments[4],hr=arguments[5],Sn(Zr=arguments[3])==="object"&&Zr!==null||(typeof ir=="string"&&(hr=ir,ir=null),typeof Zr=="string"&&(hr=Zr,Zr=null),typeof Zr=="number"&&(ir=Zr,Zr=null),tt={flags:Zr,angle:ir,align:hr})):(B("The transform parameter of text() with a Matrix value"),ms=ht),isNaN(le)||isNaN(Ke)||D==null)throw new Error("Invalid arguments passed to jsPDF.text");if(D.length===0)return yn;var ps,Es="",gs=typeof tt.lineHeightFactor=="number"?tt.lineHeightFactor:ec,Qi=yn.internal.scaleFactor;function Vo(xn){return xn=xn.split("	").join(Array(tt.TabLen||9).join(" ")),Kt(xn,Zr)}function Ho(xn){for(var Un,Ls=xn.concat(),na=[],Qc=Ls.length;Qc--;)typeof(Un=Ls.shift())=="string"?na.push(Un):Array.isArray(xn)&&(Un.length===1||Un[1]===void 0&&Un[2]===void 0)?na.push(Un[0]):na.push([Un[0],Un[1],Un[2]]);return na}function y(xn,Un){var Ls;if(typeof xn=="string")Ls=Un(xn)[0];else if(Array.isArray(xn)){for(var na,Qc,Em=xn.concat(),hf=[],Wx=Em.length;Wx--;)typeof(na=Em.shift())=="string"?hf.push(Un(na)[0]):Array.isArray(na)&&typeof na[0]=="string"&&(Qc=Un(na[0],na[1],na[2]),hf.push([Qc[0],Qc[1],Qc[2]]));Ls=hf}return Ls}var H=!1,Z=!0;if(typeof D=="string")H=!0;else if(Array.isArray(D)){var ke=D.concat();Pt=[];for(var ft,bt=ke.length;bt--;)(typeof(ft=ke.shift())!="string"||Array.isArray(ft)&&typeof ft[0]!="string")&&(Z=!1);H=Z}if(H===!1)throw new Error('Type of text must be string or Array. "'+D+'" is not recognized.');typeof D=="string"&&(D=D.match(/[\r?\n]/)?D.split(/\r\n|\r|\n/g):[D]);var zt=Be/yn.internal.scaleFactor,sn=zt*(gs-1);switch(tt.baseline){case"bottom":Ke-=sn;break;case"top":Ke+=zt-sn;break;case"hanging":Ke+=zt-2*sn;break;case"middle":Ke+=zt/2-sn}if((kr=tt.maxWidth||0)>0&&(typeof D=="string"?D=yn.splitTextToSize(D,kr):Object.prototype.toString.call(D)==="[object Array]"&&(D=D.reduce(function(xn,Un){return xn.concat(yn.splitTextToSize(Un,kr))},[]))),St={text:D,x:le,y:Ke,options:tt,mutex:{pdfEscape:Kt,activeFontKey:be,fonts:Ve,activeFontSize:Be}},Lt.publish("preProcessText",St),D=St.text,ir=(tt=St.options).angle,ms instanceof et==0&&ir&&typeof ir=="number"){ir*=Math.PI/180,tt.rotationDirection===0&&(ir=-ir),k===b&&(ir=-ir);var xs=Math.cos(ir),qr=Math.sin(ir);ms=new et(xs,qr,-qr,xs,0,0)}else ir&&ir instanceof et&&(ms=ir);k!==b||ms||(ms=Rt),(Nr=tt.charSpace||Uo)!==void 0&&(Es+=_(O(Nr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(gn=tt.horizontalScale)!==void 0&&(Es+=_(100*gn)+` Tz
`),tt.lang;var fn=-1,qn=tt.renderingMode!==void 0?tt.renderingMode:tt.stroke,io=yn.internal.getCurrentPageInfo().pageContext;switch(qn){case 0:case!1:case"fill":fn=0;break;case 1:case!0:case"stroke":fn=1;break;case 2:case"fillThenStroke":fn=2;break;case 3:case"invisible":fn=3;break;case 4:case"fillAndAddForClipping":fn=4;break;case 5:case"strokeAndAddPathForClipping":fn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fn=6;break;case 7:case"addToPathForClipping":fn=7}var Ya=io.usedRenderingMode!==void 0?io.usedRenderingMode:-1;fn!==-1?Es+=fn+` Tr
`:Ya!==-1&&(Es+=`0 Tr
`),fn!==-1&&(io.usedRenderingMode=fn),hr=tt.align||"left";var ja,yl=Be*gs,vm=yn.internal.pageSize.getWidth(),ym=Ve[be];Nr=tt.charSpace||Uo,kr=tt.maxWidth||0,Zr=Object.assign({autoencode:!0,noBOM:!0},tt.flags);var HA=[],Id=function(xn){return yn.getStringUnitWidth(xn,{font:ym,charSpace:Nr,fontSize:Be,doKerning:!1})*Be/Qi};if(Object.prototype.toString.call(D)==="[object Array]"){var oo;Pt=Ho(D),hr!=="left"&&(ja=Pt.map(Id));var lo,KA=0;if(hr==="right"){le-=ja[0],D=[],bt=Pt.length;for(var Mc=0;Mc<bt;Mc++)Mc===0?(lo=va(le),oo=xl(Ke)):(lo=O(KA-ja[Mc]),oo=-yl),D.push([Pt[Mc],lo,oo]),KA=ja[Mc]}else if(hr==="center"){le-=ja[0]/2,D=[],bt=Pt.length;for(var qA=0;qA<bt;qA++)qA===0?(lo=va(le),oo=xl(Ke)):(lo=O((KA-ja[qA])/2),oo=-yl),D.push([Pt[qA],lo,oo]),KA=ja[qA]}else if(hr==="left"){D=[],bt=Pt.length;for(var wm=0;wm<bt;wm++)D.push(Pt[wm])}else if(hr==="justify"&&ym.encoding==="Identity-H"){D=[],bt=Pt.length,kr=kr!==0?kr:vm;for(var df=0,Ds=0;Ds<bt;Ds++)if(oo=Ds===0?xl(Ke):-yl,lo=Ds===0?va(le):df,Ds<bt-1){var zx=O((kr-ja[Ds])/(Pt[Ds].split(" ").length-1)),nc=Pt[Ds].split(" ");D.push([nc[0]+" ",lo,oo]),df=0;for(var sc=1;sc<nc.length;sc++){var bm=(Id(nc[sc-1]+" "+nc[sc])-Id(nc[sc]))*Qi+zx;sc==nc.length-1?D.push([nc[sc],bm,0]):D.push([nc[sc]+" ",bm,0]),df-=bm}}else D.push([Pt[Ds],lo,oo]);D.push(["",df,0])}else{if(hr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(D=[],bt=Pt.length,kr=kr!==0?kr:vm,Ds=0;Ds<bt;Ds++){oo=Ds===0?xl(Ke):-yl,lo=Ds===0?va(le):0;var Nm=Pt[Ds].split(" ").length-1,Cm=Nm>0?(kr-ja[Ds])/Nm:0;Ds<bt-1?HA.push(_(O(Cm))):HA.push(0),D.push([Pt[Ds],lo,oo])}}}(typeof tt.R2L=="boolean"?tt.R2L:Je)===!0&&(D=y(D,function(xn,Un,Ls){return[xn.split("").reverse().join(""),Un,Ls]})),St={text:D,x:le,y:Ke,options:tt,mutex:{pdfEscape:Kt,activeFontKey:be,fonts:Ve,activeFontSize:Be}},Lt.publish("postProcessText",St),D=St.text,ps=St.mutex.isHex||!1;var _m=Ve[be].encoding;_m!=="WinAnsiEncoding"&&_m!=="StandardEncoding"||(D=y(D,function(xn,Un,Ls){return[Vo(xn),Un,Ls]})),Pt=Ho(D),D=[];for(var GA,$A,zA,Fd=Array.isArray(Pt[0])?1:0,WA="",kd=function(xn,Un,Ls){var na="";return Ls instanceof et?(Ls=typeof tt.angle=="number"?gt(Ls,new et(1,0,0,1,xn,Un)):gt(new et(1,0,0,1,xn,Un),Ls),k===b&&(Ls=gt(new et(1,0,0,-1,0,0),Ls)),na=Ls.join(" ")+` Tm
`):na=_(xn)+" "+_(Un)+` Td
`,na},Ko=0;Ko<Pt.length;Ko++){switch(WA="",Fd){case 1:zA=(ps?"<":"(")+Pt[Ko][0]+(ps?">":")"),GA=parseFloat(Pt[Ko][1]),$A=parseFloat(Pt[Ko][2]);break;case 0:zA=(ps?"<":"(")+Pt[Ko]+(ps?">":")"),GA=va(le),$A=xl(Ke)}HA!==void 0&&HA[Ko]!==void 0&&(WA=HA[Ko]+` Tw
`),Ko===0?D.push(WA+kd(GA,$A,ms)+zA):Fd===0?D.push(WA+zA):Fd===1&&D.push(WA+kd(GA,$A,ms)+zA)}D=Fd===0?D.join(` Tj
T* `):D.join(` Tj
`),D+=` Tj
`;var ac=`BT
/`;return ac+=be+" "+Be+` Tf
`,ac+=_(Be*gs)+` TL
`,ac+=ao+`
`,ac+=Es,ac+=D,W(ac+="ET"),f[be]=!0,yn};var af=h.__private__.clip=h.clip=function(D){return W(D==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return af("evenodd")},h.__private__.discardPath=h.discardPath=function(){return W("n"),this};var Yr=h.__private__.isValidStyle=function(D){var le=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(D)!==-1&&(le=!0),le};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(D){return Yr(D)&&(A=D),this};var Dc=h.__private__.getStyle=h.getStyle=function(D){var le=A;switch(D){case"D":case"S":le="S";break;case"F":le="f";break;case"FD":case"DF":le="B";break;case"f":case"f*":case"B":case"B*":le=D}return le},Zl=h.close=function(){return W("h"),this};h.stroke=function(){return W("S"),this},h.fill=function(D){return Do("f",D),this},h.fillEvenOdd=function(D){return Do("f*",D),this},h.fillStroke=function(D){return Do("B",D),this},h.fillStrokeEvenOdd=function(D){return Do("B*",D),this};var Do=function(D,le){Sn(le)==="object"?hm(le,D):W(D)},Lc=function(D){D===null||k===b&&D===void 0||(D=Dc(D),W(D))};function of(D,le,Ke,tt,ht){var St=new sh(le||this.boundingBox,Ke||this.xStep,tt||this.yStep,this.gState,ht||this.matrix);St.stream=this.stream;var Pt=D+"$$"+this.cloneIndex+++"$$";return kt(Pt,St),St}var hm=function(D,le){var Ke=Ee[D.key],tt=Ue[Ke];if(tt instanceof Eu)W("q"),W(fm(le)),tt.gState&&h.setGState(tt.gState),W(D.matrix.toString()+" cm"),W("/"+Ke+" sh"),W("Q");else if(tt instanceof sh){var ht=new et(1,0,0,-1,0,Qo());D.matrix&&(ht=ht.multiply(D.matrix||Rt),Ke=of.call(tt,D.key,D.boundingBox,D.xStep,D.yStep,ht).id),W("q"),W("/Pattern cs"),W("/"+Ke+" scn"),tt.gState&&h.setGState(tt.gState),W(le),W("Q")}},fm=function(D){switch(D){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Cd=h.moveTo=function(D,le){return W(_(O(D))+" "+_(Y(le))+" m"),this},lf=h.lineTo=function(D,le){return W(_(O(D))+" "+_(Y(le))+" l"),this},Ta=h.curveTo=function(D,le,Ke,tt,ht,St){return W([_(O(D)),_(Y(le)),_(O(Ke)),_(Y(tt)),_(O(ht)),_(Y(St)),"c"].join(" ")),this};h.__private__.line=h.line=function(D,le,Ke,tt,ht){if(isNaN(D)||isNaN(le)||isNaN(Ke)||isNaN(tt)||!Yr(ht))throw new Error("Invalid arguments passed to jsPDF.line");return k===w?this.lines([[Ke-D,tt-le]],D,le,[1,1],ht||"S"):this.lines([[Ke-D,tt-le]],D,le,[1,1]).stroke()},h.__private__.lines=h.lines=function(D,le,Ke,tt,ht,St){var Pt,ir,hr,Nr,kr,Zr,gn,ms,yn,_s,ps,Es;if(typeof D=="number"&&(Es=Ke,Ke=le,le=D,D=Es),tt=tt||[1,1],St=St||!1,isNaN(le)||isNaN(Ke)||!Array.isArray(D)||!Array.isArray(tt)||!Yr(ht)||typeof St!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Cd(le,Ke),Pt=tt[0],ir=tt[1],Nr=D.length,_s=le,ps=Ke,hr=0;hr<Nr;hr++)(kr=D[hr]).length===2?(_s=kr[0]*Pt+_s,ps=kr[1]*ir+ps,lf(_s,ps)):(Zr=kr[0]*Pt+_s,gn=kr[1]*ir+ps,ms=kr[2]*Pt+_s,yn=kr[3]*ir+ps,_s=kr[4]*Pt+_s,ps=kr[5]*ir+ps,Ta(Zr,gn,ms,yn,_s,ps));return St&&Zl(),Lc(ht),this},h.path=function(D){for(var le=0;le<D.length;le++){var Ke=D[le],tt=Ke.c;switch(Ke.op){case"m":Cd(tt[0],tt[1]);break;case"l":lf(tt[0],tt[1]);break;case"c":Ta.apply(this,tt);break;case"h":Zl()}}return this},h.__private__.rect=h.rect=function(D,le,Ke,tt,ht){if(isNaN(D)||isNaN(le)||isNaN(Ke)||isNaN(tt)||!Yr(ht))throw new Error("Invalid arguments passed to jsPDF.rect");return k===w&&(tt=-tt),W([_(O(D)),_(Y(le)),_(O(Ke)),_(O(tt)),"re"].join(" ")),Lc(ht),this},h.__private__.triangle=h.triangle=function(D,le,Ke,tt,ht,St,Pt){if(isNaN(D)||isNaN(le)||isNaN(Ke)||isNaN(tt)||isNaN(ht)||isNaN(St)||!Yr(Pt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ke-D,tt-le],[ht-Ke,St-tt],[D-ht,le-St]],D,le,[1,1],Pt,!0),this},h.__private__.roundedRect=h.roundedRect=function(D,le,Ke,tt,ht,St,Pt){if(isNaN(D)||isNaN(le)||isNaN(Ke)||isNaN(tt)||isNaN(ht)||isNaN(St)||!Yr(Pt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ir=4/3*(Math.SQRT2-1);return ht=Math.min(ht,.5*Ke),St=Math.min(St,.5*tt),this.lines([[Ke-2*ht,0],[ht*ir,0,ht,St-St*ir,ht,St],[0,tt-2*St],[0,St*ir,-ht*ir,St,-ht,St],[2*ht-Ke,0],[-ht*ir,0,-ht,-St*ir,-ht,-St],[0,2*St-tt],[0,-St*ir,ht*ir,-St,ht,-St]],D+ht,le,[1,1],Pt,!0),this},h.__private__.ellipse=h.ellipse=function(D,le,Ke,tt,ht){if(isNaN(D)||isNaN(le)||isNaN(Ke)||isNaN(tt)||!Yr(ht))throw new Error("Invalid arguments passed to jsPDF.ellipse");var St=4/3*(Math.SQRT2-1)*Ke,Pt=4/3*(Math.SQRT2-1)*tt;return Cd(D+Ke,le),Ta(D+Ke,le-Pt,D+St,le-tt,D,le-tt),Ta(D-St,le-tt,D-Ke,le-Pt,D-Ke,le),Ta(D-Ke,le+Pt,D-St,le+tt,D,le+tt),Ta(D+St,le+tt,D+Ke,le+Pt,D+Ke,le),Lc(ht),this},h.__private__.circle=h.circle=function(D,le,Ke,tt){if(isNaN(D)||isNaN(le)||isNaN(Ke)||!Yr(tt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(D,le,Ke,Ke,tt)},h.setFont=function(D,le,Ke){return Ke&&(le=E(le,Ke)),be=no(D,le,{disableWarning:!1}),this};var Lo=h.__private__.getFont=h.getFont=function(){return Ve[no.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var D,le,Ke={};for(D in ve)if(ve.hasOwnProperty(D))for(le in Ke[D]=[],ve[D])ve[D].hasOwnProperty(le)&&Ke[D].push(le);return Ke},h.addFont=function(D,le,Ke,tt,ht){var St=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&St.indexOf(arguments[3])!==-1?ht=arguments[3]:arguments[3]&&St.indexOf(arguments[3])==-1&&(Ke=E(Ke,tt)),Mt.call(this,D,le,Ke,ht=ht||"Identity-H")};var ec,UA=t.lineWidth||.200025,cf=h.__private__.getLineWidth=h.getLineWidth=function(){return UA},br=h.__private__.setLineWidth=h.setLineWidth=function(D){return UA=D,W(_(O(D))+" w"),this};h.__private__.setLineDash=or.API.setLineDash=or.API.setLineDashPattern=function(D,le){if(D=D||[],le=le||0,isNaN(le)||!Array.isArray(D))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return D=D.map(function(Ke){return _(O(Ke))}).join(" "),le=_(O(le)),W("["+D+"] "+le+" d"),this};var mm=h.__private__.getLineHeight=h.getLineHeight=function(){return Be*ec};h.__private__.getLineHeight=h.getLineHeight=function(){return Be*ec};var pm=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(D){return typeof(D=D||1.15)=="number"&&(ec=D),this},gm=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return ec};pm(t.lineHeight);var va=h.__private__.getHorizontalCoordinate=function(D){return O(D)},xl=h.__private__.getVerticalCoordinate=function(D){return k===b?D:wt[I].mediaBox.topRightY-wt[I].mediaBox.bottomLeftY-O(D)},xm=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(D){return _(va(D))},OA=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(D){return _(xl(D))},vl=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Fe(vl)},h.__private__.setStrokeColor=h.setDrawColor=function(D,le,Ke,tt){return vl=De({ch1:D,ch2:le,ch3:Ke,ch4:tt,pdfColorType:"draw",precision:2}),W(vl),this};var MA=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Fe(MA)},h.__private__.setFillColor=h.setFillColor=function(D,le,Ke,tt){return MA=De({ch1:D,ch2:le,ch3:Ke,ch4:tt,pdfColorType:"fill",precision:2}),W(MA),this};var ao=t.textColor||"0 g",Uc=h.__private__.getTextColor=h.getTextColor=function(){return Fe(ao)};h.__private__.setTextColor=h.setTextColor=function(D,le,Ke,tt){return ao=De({ch1:D,ch2:le,ch3:Ke,ch4:tt,pdfColorType:"text",precision:3}),this};var Uo=t.charSpace,_d=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Uo||0)};h.__private__.setCharSpace=h.setCharSpace=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Uo=D,this};var jn=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(D){var le=h.CapJoinStyles[D];if(le===void 0)throw new Error("Line cap style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jn=le,W(le+" J"),this};var Ed=0;h.__private__.setLineJoin=h.setLineJoin=function(D){var le=h.CapJoinStyles[D];if(le===void 0)throw new Error("Line join style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ed=le,W(le+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(D){if(D=D||0,isNaN(D))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return W(_(O(D))+" M"),this},h.GState=Jg,h.setGState=function(D){(D=typeof D=="string"?We[nt[D]]:Af(null,D)).equals(Nt)||(W("/"+D.id+" gs"),Nt=D)};var Af=function(D,le){if(!D||!nt[D]){var Ke=!1;for(var tt in We)if(We.hasOwnProperty(tt)&&We[tt].equals(le)){Ke=!0;break}if(Ke)le=We[tt];else{var ht="GS"+(Object.keys(We).length+1).toString(10);We[ht]=le,le.id=ht}return D&&(nt[D]=le.id),Lt.publish("addGState",le),le}};h.addGState=function(D,le){return Af(D,le),this},h.saveGraphicsState=function(){return W("q"),Qe.push({key:be,size:Be,color:ao}),this},h.restoreGraphicsState=function(){W("Q");var D=Qe.pop();return be=D.key,Be=D.size,ao=D.color,Nt=null,this},h.setCurrentTransformationMatrix=function(D){return W(D.toString()+" cm"),this},h.comment=function(D){return W("#"+D),this};var Oo=function(D,le){var Ke=D||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ke},set:function(St){isNaN(St)||(Ke=parseFloat(St))}});var tt=le||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return tt},set:function(St){isNaN(St)||(tt=parseFloat(St))}});var ht="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ht},set:function(St){ht=St.toString()}}),this},QA=function(D,le,Ke,tt){Oo.call(this,D,le),this.type="rect";var ht=Ke||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ht},set:function(Pt){isNaN(Pt)||(ht=parseFloat(Pt))}});var St=tt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return St},set:function(Pt){isNaN(Pt)||(St=parseFloat(Pt))}}),this},Oc=function(){this.page=ot,this.currentPage=I,this.pages=ye.slice(0),this.pagesContext=wt.slice(0),this.x=K,this.y=_e,this.matrix=Oe,this.width=bi(I),this.height=uf(I),this.outputDestination=Me,this.id="",this.objectNumber=-1};Oc.prototype.restore=function(){ot=this.page,I=this.currentPage,wt=this.pagesContext,ye=this.pages,K=this.x,_e=this.y,Oe=this.matrix,Bd(I,this.width),Ni(I,this.height),Me=this.outputDestination};var tc=function(D,le,Ke,tt,ht){tr.push(new Oc),ot=I=0,ye=[],K=D,_e=le,Oe=ht,xr([Ke,tt])};for(var rc in h.beginFormObject=function(D,le,Ke,tt,ht){return tc(D,le,Ke,tt,ht),this},h.endFormObject=function(D){return function(le){if(yr[le])tr.pop().restore();else{var Ke=new Oc,tt="Xo"+(Object.keys(ar).length+1).toString(10);Ke.id=tt,yr[le]=tt,ar[tt]=Ke,Lt.publish("addFormObject",Ke),tr.pop().restore()}}(D),this},h.doFormObject=function(D,le){var Ke=ar[yr[D]];return W("q"),W(le.toString()+" cm"),W("/"+Ke.id+" Do"),W("Q"),this},h.getFormObject=function(D){var le=ar[yr[D]];return{x:le.x,y:le.y,width:le.width,height:le.height,matrix:le.matrix}},h.save=function(D,le){return D=D||"generated.pdf",(le=le||{}).returnPromise=le.returnPromise||!1,le.returnPromise===!1?(Gd(Pc(Ro()),D),typeof Gd.unload=="function"&&Ir.setTimeout&&setTimeout(Gd.unload,911),this):new Promise(function(Ke,tt){try{var ht=Gd(Pc(Ro()),D);typeof Gd.unload=="function"&&Ir.setTimeout&&setTimeout(Gd.unload,911),Ke(ht)}catch(St){tt(St.message)}})},or.API)or.API.hasOwnProperty(rc)&&(rc==="events"&&or.API.events.length?function(D,le){var Ke,tt,ht;for(ht=le.length-1;ht!==-1;ht--)Ke=le[ht][0],tt=le[ht][1],D.subscribe.apply(D,[Ke].concat(typeof tt=="function"?[tt]:tt))}(Lt,or.API.events):h[rc]=or.API[rc]);function bi(D){return wt[D].mediaBox.topRightX-wt[D].mediaBox.bottomLeftX}function Bd(D,le){wt[D].mediaBox.topRightX=le+wt[D].mediaBox.bottomLeftX}function uf(D){return wt[D].mediaBox.topRightY-wt[D].mediaBox.bottomLeftY}function Ni(D,le){wt[D].mediaBox.topRightY=le+wt[D].mediaBox.bottomLeftY}var Mo=h.getPageWidth=function(D){return bi(D=D||I)/ge},VA=h.setPageWidth=function(D,le){Bd(D,le*ge)},Qo=h.getPageHeight=function(D){return uf(D=D||I)/ge},Sd=h.setPageHeight=function(D,le){Ni(D,le*ge)};return h.internal={pdfEscape:Kt,getStyle:Dc,getFont:Lo,getFontSize:$e,getCharSpace:_d,getTextColor:Uc,getLineHeight:mm,getLineHeightFactor:gm,getLineWidth:cf,write:q,getHorizontalCoordinate:va,getVerticalCoordinate:xl,getCoordinateString:xm,getVerticalCoordinateString:OA,collections:{},newObject:Zt,newAdditionalObject:ne,newObjectDeferred:Vt,newObjectDeferredBegin:ie,getFilters:ee,putStream:Te,events:Lt,scaleFactor:ge,pageSize:{getWidth:function(){return Mo(I)},setWidth:function(D){VA(I,D)},getHeight:function(){return Qo(I)},setHeight:function(D){Sd(I,D)}},encryptionOptions:u,encryption:Ln,getEncryptor:function(D){return u!==null?Ln.encryptor(D,0):function(le){return le}},output:Nd,getNumberOfPages:Rs,get pages(){return ye},out:W,f2:F,f3:T,getPageInfo:ra,getPageInfoByObjId:Rc,getCurrentPageInfo:LA,getPDFVersion:p,Point:Oo,Rectangle:QA,Matrix:et,hasHotfix:Mi},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Mo(I)},set:function(D){VA(I,D)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Qo(I)},set:function(D){Sd(I,D)},enumerable:!0,configurable:!0}),(function(D){for(var le=0,Ke=de.length;le<Ke;le++){var tt=Mt.call(this,D[le][0],D[le][1],D[le][2],de[le][3],!0);d===!1&&(f[tt]=!0);var ht=D[le][0].split("-");dt({id:tt,fontName:ht[0],fontStyle:ht[1]||""})}Lt.publish("addFonts",{fonts:Ve,dictionary:ve})}).call(h,de),be="F1",Hn(s,r),Lt.publish("initialized"),h}qf.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},qf.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},qf.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},qf.prototype.processOwnerPassword=function(t,e){return NE(bE(e).substr(0,5),t)},qf.prototype.encryptor=function(t,e){var r=bE(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return NE(r,n)}},Jg.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Sn(t)!==Sn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},or.API={events:[]},or.version="3.0.4";var Is=or.API,rI=1,Yh=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Sf=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},jr=function(t){return t.toFixed(2)},lu=function(t){return t.toFixed(5)};Is.__acroform__={};var ro=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Ij=function(t){return t*rI},Ac=function(t){var e=new HM,r=ur.internal.getHeight(t)||0,n=ur.internal.getWidth(t)||0;return e.BBox=[0,0,Number(jr(n)),Number(jr(r))],e},zie=Is.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Wie=Is.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Jie=Is.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Ks=Is.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Jie(t,e-1)},qs=Is.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return zie(t,e-1)},Gs=Is.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Wie(t,e-1)},Xie=Is.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(a)||0,[Number(jr(c.lowerLeft_X)),Number(jr(c.lowerLeft_Y)),Number(jr(c.upperRight_X)),Number(jr(c.upperRight_Y))]},Yie=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=CE(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+jr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Ac(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},CE=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(F){return F.split(`
`)}):s.map(function(F){return[F]});var a=r,o=ur.internal.getHeight(t)||0;o=o<0?-o:o;var l=ur.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(F,T,O){if(F+1<s.length){var Y=T+" "+s[F+1][0];return d1(Y,t,O).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var A,u,d=d1("3",t,a).height,f=t.multiline?o-a:(o-d)/2,h=f+=2,m=0,p=0,x=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+d1(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var g="",w=0,b=0;b<s.length;b++)if(s.hasOwnProperty(b)){var k=!1;if(s[b].length!==1&&x!==s[b].length-1){if((d+2)*(w+2)+2>o)continue e;g+=s[b][x],k=!0,p=b,b--}else{g=(g+=s[b][x]+" ").substr(g.length-1)==" "?g.substr(0,g.length-1):g;var P=parseInt(b),L=c(P,g,a),E=b>=s.length-1;if(L&&!E){g+=" ",x=0;continue}if(L||E){if(E)p=P;else if(t.multiline&&(d+2)*(w+2)+2>o)continue e}else{if(!t.multiline||(d+2)*(w+2)+2>o)continue e;p=P}}for(var _="",B=m;B<=p;B++){var M=s[B];if(t.multiline){if(B===p){_+=M[x]+" ",x=(x+1)%M.length;continue}if(B===m){_+=M[M.length-1]+" ";continue}}_+=M[0]+" "}switch(_=_.substr(_.length-1)==" "?_.substr(0,_.length-1):_,u=d1(_,t,a).width,t.textAlign){case"right":A=l-u-2;break;case"center":A=(l-u)/2;break;default:A=2}e+=jr(A)+" "+jr(h)+` Td
`,e+="("+Yh(_)+`) Tj
`,e+=-jr(A)+` 0 Td
`,h=-(a+2),u=0,m=k?p:p+1,w++,g=""}break}return n.text=e,n.fontSize=a,n},d1=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},Zie={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},eoe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},toe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Wl.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Zie)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");rI=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new KM,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&eoe(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],A=l.Rect;if(l.Rect&&(l.Rect=Xie(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ur.createDefaultAppearanceStream(l),Sn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=A,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=Yie(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var d="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var h=l.appearanceStreamContent[f];if(d+="/"+f+" ",d+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(s,l)),d+="/"+o+" "+m+" ",s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(s,l)),d+="/"+o+" "+m,s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}a&&function(p,x){for(var g in p)if(p.hasOwnProperty(g)){var w=g,b=p[g];x.internal.newObjectDeferredBegin(b.objId,!0),Sn(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[w]}}(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},VM=Is.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var s="[",a=0;a<t.length;a++)switch(a!==0&&(s+=" "),Sn(t[a])){case"boolean":case"number":case"object":s+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+Yh(n(t[a].toString()))+")"):s+=t[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},QN=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Yh(n(t))+")"},xc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};xc.prototype.toString=function(){return this.objId+" 0 R"},xc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},xc.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:VM(s,this.objId,this.scope)}):s instanceof xc?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var HM=function(){xc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};ro(HM,xc);var KM=function(){xc.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Yh(r(t))+")"}},set:function(r){t=r}})};ro(KM,xc);var Wl=function t(){xc.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute F supplied.');e=g}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ks(e,3)},set:function(g){g?this.F=qs(e,3):this.F=Gs(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute Ff supplied.');r=g}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(g){n=g!==void 0?g:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(g){n[0]=g}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(g){n[1]=g}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(g){n[2]=g}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(g){n[3]=g}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(g){switch(g){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=g;break;default:throw new Error('Invalid value "'+g+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof bw)return;a="FieldObject"+t.FieldNum++}var g=function(w){return w};return this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),"("+Yh(g(a))+")"},set:function(g){a=g.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(g){a=g}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(g){o=g}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(g){l=g}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(g){c=g}});var A=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return A===void 0?50/rI:A},set:function(g){A=g}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(g){u=g}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof bw||this instanceof Xu))return QN(d,this.objId,this.scope)},set:function(g){g=g.toString(),d=g}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ua==0?QN(f,this.objId,this.scope):f},set:function(g){g=g.toString(),f=this instanceof ua==0?g.substr(0,1)==="("?Sf(g.substr(1,g.length-2)):Sf(g):g}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ua==1?Sf(f.substr(1,f.length-1)):f},set:function(g){g=g.toString(),f=this instanceof ua==1?"/"+g:g}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(g){this.V=g}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ua==0?QN(h,this.objId,this.scope):h},set:function(g){g=g.toString(),h=this instanceof ua==0?g.substr(0,1)==="("?Sf(g.substr(1,g.length-2)):Sf(g):g}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ua==1?Sf(h.substr(1,h.length-1)):h},set:function(g){g=g.toString(),h=this instanceof ua==1?"/"+g:g}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(g){g=!!g,p=g}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(g){m=g}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,1)},set:function(g){g?this.Ff=qs(this.Ff,1):this.Ff=Gs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,2)},set:function(g){g?this.Ff=qs(this.Ff,2):this.Ff=Gs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,3)},set:function(g){g?this.Ff=qs(this.Ff,3):this.Ff=Gs(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(g){if([0,1,2].indexOf(g)===-1)throw new Error('Invalid value "'+g+'" for attribute Q supplied.');x=g}}),Object.defineProperty(this,"textAlign",{get:function(){var g;switch(x){case 0:default:g="left";break;case 1:g="center";break;case 2:g="right"}return g},configurable:!0,enumerable:!0,set:function(g){switch(g){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};ro(Wl,xc);var uh=function(){Wl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return VM(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,o,l){l||(l=1);for(var c,A=[];c=o.exec(a);)A.push(c[l]);return A}(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,18)},set:function(r){r?this.Ff=qs(this.Ff,18):this.Ff=Gs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=qs(this.Ff,19):this.Ff=Gs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,20)},set:function(r){r?(this.Ff=qs(this.Ff,20),e.sort()):this.Ff=Gs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,22)},set:function(r){r?this.Ff=qs(this.Ff,22):this.Ff=Gs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,23)},set:function(r){r?this.Ff=qs(this.Ff,23):this.Ff=Gs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,27)},set:function(r){r?this.Ff=qs(this.Ff,27):this.Ff=Gs(this.Ff,27)}}),this.hasAppearanceStream=!1};ro(uh,Wl);var dh=function(){uh.call(this),this.fontName="helvetica",this.combo=!1};ro(dh,uh);var hh=function(){dh.call(this),this.combo=!0};ro(hh,dh);var Xp=function(){hh.call(this),this.edit=!0};ro(Xp,hh);var ua=function(){Wl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,15)},set:function(r){r?this.Ff=qs(this.Ff,15):this.Ff=Gs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,16)},set:function(r){r?this.Ff=qs(this.Ff,16):this.Ff=Gs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,17)},set:function(r){r?this.Ff=qs(this.Ff,17):this.Ff=Gs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,26)},set:function(r){r?this.Ff=qs(this.Ff,26):this.Ff=Gs(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+Yh(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Sn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};ro(ua,Wl);var Yp=function(){ua.call(this),this.pushButton=!0};ro(Yp,ua);var fh=function(){ua.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};ro(fh,ua);var bw=function(){var t,e;Wl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+Yh(s(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Sn(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ur.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ro(bw,Wl),fh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},fh.prototype.createOption=function(t){var e=new bw;return e.Parent=this,e.optionName=t,this.Kids.push(e),roe.call(this.scope,e),e};var Zp=function(){ua.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ur.CheckBox.createAppearanceStream()};ro(Zp,ua);var Xu=function(){Wl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,13)},set:function(e){e?this.Ff=qs(this.Ff,13):this.Ff=Gs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,21)},set:function(e){e?this.Ff=qs(this.Ff,21):this.Ff=Gs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,23)},set:function(e){e?this.Ff=qs(this.Ff,23):this.Ff=Gs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,24)},set:function(e){e?this.Ff=qs(this.Ff,24):this.Ff=Gs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,25)},set:function(e){e?this.Ff=qs(this.Ff,25):this.Ff=Gs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,26)},set:function(e){e?this.Ff=qs(this.Ff,26):this.Ff=Gs(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ro(Xu,Wl);var eg=function(){Xu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ks(this.Ff,14)},set:function(t){t?this.Ff=qs(this.Ff,14):this.Ff=Gs(this.Ff,14)}}),this.password=!0};ro(eg,Xu);var ur={CheckBox:{createAppearanceStream:function(){return{N:{On:ur.CheckBox.YesNormal},D:{On:ur.CheckBox.YesPushDown,Off:ur.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Ac(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),a=CE(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+jr(ur.internal.getWidth(t))+" "+jr(ur.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+jr(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Ac(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],a=ur.internal.getHeight(t),o=ur.internal.getWidth(t),l=CE(t,t.caption);return s.push("1 g"),s.push("0 0 "+jr(o)+" "+jr(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+jr(o-1)+" "+jr(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+jr(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=Ac(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+jr(ur.internal.getWidth(t))+" "+jr(ur.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:ur.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=ur.RadioButton.Circle.YesNormal,e.D[t]=ur.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Ac(t);e.scope=t.scope;var r=[],n=ur.internal.getWidth(t)<=ur.internal.getHeight(t)?ur.internal.getWidth(t)/4:ur.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=ur.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+lu(ur.internal.getWidth(t)/2)+" "+lu(ur.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ac(t);e.scope=t.scope;var r=[],n=ur.internal.getWidth(t)<=ur.internal.getHeight(t)?ur.internal.getWidth(t)/4:ur.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*ur.internal.Bezier_C).toFixed(5)),o=Number((n*ur.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+lu(ur.internal.getWidth(t)/2)+" "+lu(ur.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+lu(ur.internal.getWidth(t)/2)+" "+lu(ur.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Ac(t);e.scope=t.scope;var r=[],n=ur.internal.getWidth(t)<=ur.internal.getHeight(t)?ur.internal.getWidth(t)/4:ur.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*ur.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+lu(ur.internal.getWidth(t)/2)+" "+lu(ur.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:ur.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=ur.RadioButton.Cross.YesNormal,e.D[t]=ur.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Ac(t);e.scope=t.scope;var r=[],n=ur.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+jr(ur.internal.getWidth(t)-2)+" "+jr(ur.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(jr(n.x1.x)+" "+jr(n.x1.y)+" m"),r.push(jr(n.x2.x)+" "+jr(n.x2.y)+" l"),r.push(jr(n.x4.x)+" "+jr(n.x4.y)+" m"),r.push(jr(n.x3.x)+" "+jr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ac(t);e.scope=t.scope;var r=ur.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+jr(ur.internal.getWidth(t))+" "+jr(ur.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+jr(ur.internal.getWidth(t)-2)+" "+jr(ur.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(jr(r.x1.x)+" "+jr(r.x1.y)+" m"),n.push(jr(r.x2.x)+" "+jr(r.x2.y)+" l"),n.push(jr(r.x4.x)+" "+jr(r.x4.y)+" m"),n.push(jr(r.x3.x)+" "+jr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Ac(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+jr(ur.internal.getWidth(t))+" "+jr(ur.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};ur.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=ur.internal.getWidth(t),r=ur.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},ur.internal.getWidth=function(t){var e=0;return Sn(t)==="object"&&(e=Ij(t.Rect[2])),e},ur.internal.getHeight=function(t){var e=0;return Sn(t)==="object"&&(e=Ij(t.Rect[3])),e};var roe=Is.addField=function(t){if(toe(this,t),!(t instanceof Wl))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Is.AcroFormChoiceField=uh,Is.AcroFormListBox=dh,Is.AcroFormComboBox=hh,Is.AcroFormEditBox=Xp,Is.AcroFormButton=ua,Is.AcroFormPushButton=Yp,Is.AcroFormRadioButton=fh,Is.AcroFormCheckBox=Zp,Is.AcroFormTextField=Xu,Is.AcroFormPasswordField=eg,Is.AcroFormAppearance=ur,Is.AcroForm={ChoiceField:uh,ListBox:dh,ComboBox:hh,EditBox:Xp,Button:ua,PushButton:Yp,RadioButton:fh,CheckBox:Zp,TextField:Xu,PasswordField:eg,Appearance:ur},or.AcroForm={ChoiceField:uh,ListBox:dh,ComboBox:hh,EditBox:Xp,Button:ua,PushButton:Yp,RadioButton:fh,CheckBox:Zp,TextField:Xu,PasswordField:eg,Appearance:ur};var noe=or.AcroForm;function qM(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(F,T){var O,Y,me,ae,fe,he=r;if((T=T||r)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(L(F))for(fe in n)for(me=n[fe],O=0;O<me.length;O+=1){for(ae=!0,Y=0;Y<me[O].length;Y+=1)if(me[O][Y]!==void 0&&me[O][Y]!==F[Y]){ae=!1;break}if(ae===!0){he=fe;break}}else for(fe in n)for(me=n[fe],O=0;O<me.length;O+=1){for(ae=!0,Y=0;Y<me[O].length;Y+=1)if(me[O][Y]!==void 0&&me[O][Y]!==F.charCodeAt(Y)){ae=!1;break}if(ae===!0){he=fe;break}}return he===r&&T!==r&&(he=T),he},a=function F(T){for(var O=this.internal.write,Y=this.internal.putStream,me=(0,this.internal.getFilters)();me.indexOf("FlateEncode")!==-1;)me.splice(me.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:T.width}),ae.push({key:"Height",value:T.height}),T.colorSpace===g.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===g.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var fe="",he=0,te=T.transparency.length;he<te;he++)fe+=T.transparency[he]+" "+T.transparency[he]+" ";ae.push({key:"Mask",value:"["+fe+"]"})}T.sMask!==void 0&&ae.push({key:"SMask",value:T.objectId+1+" 0 R"});var pe=T.filter!==void 0?["/"+T.filter]:void 0;if(Y({data:T.data,additionalKeyValues:ae,alreadyAppliedFilters:pe,objectId:T.objectId}),O("endobj"),"sMask"in T&&T.sMask!==void 0){var Ie,S=(Ie=T.sMaskBitsPerComponent)!==null&&Ie!==void 0?Ie:T.bitsPerComponent,I={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:S,data:T.sMask};"filter"in T&&(I.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(S," /Columns ").concat(T.width),I.filter=T.filter),F.call(this,I)}if(T.colorSpace===g.INDEXED){var V=this.internal.newObject();Y({data:_(new Uint8Array(T.palette)),objectId:V}),O("endobj")}},o=function(){var F=this.internal.collections[e+"images"];for(var T in F)a.call(this,F[T])},l=function(){var F,T=this.internal.collections[e+"images"],O=this.internal.write;for(var Y in T)O("/I"+(F=T[Y]).index,F.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},A=function(){var F=this.internal.collections[e+"images"];return c.call(this),F},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(F){return typeof t["process"+F.toUpperCase()]=="function"},f=function(F){return Sn(F)==="object"&&F.nodeType===1},h=function(F,T){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var O=""+F.getAttribute("src");if(O.indexOf("data:image/")===0)return gy(unescape(O).split("base64,").pop());var Y=t.loadFile(O,!0);if(Y!==void 0)return Y}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var me;switch(T){case"PNG":me="image/png";break;case"WEBP":me="image/webp";break;default:me="image/jpeg"}return gy(F.toDataURL(me,1).split("base64,").pop())}},m=function(F){var T=this.internal.collections[e+"images"];if(T){for(var O in T)if(F===T[O].alias)return T[O]}},p=function(F,T,O){return F||T||(F=-96,T=-96),F<0&&(F=-1*O.width*72/F/this.internal.scaleFactor),T<0&&(T=-1*O.height*72/T/this.internal.scaleFactor),F===0&&(F=T*O.width/O.height),T===0&&(T=F*O.height/O.width),[F,T]},x=function(F,T,O,Y,me,ae){var fe=p.call(this,O,Y,me),he=this.internal.getCoordinateString,te=this.internal.getVerticalCoordinateString,pe=A.call(this);if(O=fe[0],Y=fe[1],pe[me.index]=me,ae){ae*=Math.PI/180;var Ie=Math.cos(ae),S=Math.sin(ae),I=function(j){return j.toFixed(4)},V=[I(Ie),I(S),I(-1*S),I(Ie),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,he(F),te(T+Y),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([he(O),"0","0",he(Y),"0","0","cm"].join(" "))):this.internal.write([he(O),"0","0",he(Y),he(F),te(T+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+me.index+" Do"),this.internal.write("Q")},g=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(F){var T,O,Y=0;if(typeof F=="string")for(O=F.length,T=0;T<O;T++)Y=(Y<<5)-Y+F.charCodeAt(T),Y|=0;else if(L(F))for(O=F.byteLength/2,T=0;T<O;T++)Y=(Y<<5)-Y+F[T],Y|=0;return Y},k=t.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var T=!0;return F.length===0&&(T=!1),F.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(T=!1),T},P=t.__addimage__.extractImageFromDataUrl=function(F){if(F==null||!(F=F.trim()).startsWith("data:"))return null;var T=F.indexOf(",");return T<0?null:F.substring(0,T).trim().endsWith("base64")?F.substring(T+1):null};t.__addimage__.isArrayBuffer=function(F){return F instanceof ArrayBuffer};var L=t.__addimage__.isArrayBufferView=function(F){return F instanceof Int8Array||F instanceof Uint8Array||F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array},E=t.__addimage__.binaryStringToUint8Array=function(F){for(var T=F.length,O=new Uint8Array(T),Y=0;Y<T;Y++)O[Y]=F.charCodeAt(Y);return O},_=t.__addimage__.arrayBufferToBinaryString=function(F){for(var T="",O=L(F)?F:new Uint8Array(F),Y=0;Y<O.length;Y+=8192)T+=String.fromCharCode.apply(null,O.subarray(Y,Y+8192));return T};t.addImage=function(){var F,T,O,Y,me,ae,fe,he,te;if(typeof arguments[1]=="number"?(T=r,O=arguments[1],Y=arguments[2],me=arguments[3],ae=arguments[4],fe=arguments[5],he=arguments[6],te=arguments[7]):(T=arguments[1],O=arguments[2],Y=arguments[3],me=arguments[4],ae=arguments[5],fe=arguments[6],he=arguments[7],te=arguments[8]),Sn(F=arguments[0])==="object"&&!f(F)&&"imageData"in F){var pe=F;F=pe.imageData,T=pe.format||T||r,O=pe.x||O||0,Y=pe.y||Y||0,me=pe.w||pe.width||me,ae=pe.h||pe.height||ae,fe=pe.alias||fe,he=pe.compression||he,te=pe.rotation||pe.angle||te}var Ie=this.internal.getFilters();if(he===void 0&&Ie.indexOf("FlateEncode")!==-1&&(he="SLOW"),isNaN(O)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var S=B.call(this,F,T,fe,he);return x.call(this,O,Y,me,ae,S,te),this};var B=function(F,T,O,Y){var me,ae,fe;if(typeof F=="string"&&s(F)===r){F=unescape(F);var he=M(F,!1);(he!==""||(he=t.loadFile(F,!0))!==void 0)&&(F=he)}if(f(F)&&(F=h(F,T)),T=s(F,T),!d(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((fe=O)==null||fe.length===0)&&(O=function(te){return typeof te=="string"||L(te)?b(te):L(te.data)?b(te.data):null}(F)),(me=m.call(this,O))||(F instanceof Uint8Array||T==="RGBA"||(ae=F,F=E(F)),me=this["process"+T.toUpperCase()](F,u.call(this),O,function(te){return te&&typeof te=="string"&&(te=te.toUpperCase()),te in t.image_compression?te:w.NONE}(Y),ae)),!me)throw new Error("An unknown error occurred whilst processing the image.");return me},M=t.__addimage__.convertBase64ToBinaryString=function(F,T){T=typeof T!="boolean"||T;var O,Y="";if(typeof F=="string"){var me;O=(me=P(F))!==null&&me!==void 0?me:F;try{Y=gy(O)}catch(ae){if(T)throw k(O)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};t.getImageProperties=function(F){var T,O,Y="";if(f(F)&&(F=h(F)),typeof F=="string"&&s(F)===r&&((Y=M(F,!1))===""&&(Y=t.loadFile(F)||""),F=Y),O=s(F),!d(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(F instanceof Uint8Array||(F=E(F)),!(T=this["process"+O.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=O,T}})(or.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};or.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),A=r.pageContext.annotations,u=!1,d=0;d<A.length&&!u;d++)switch((n=A[d]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var f=0;f<A.length;f++){n=A[f];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(p.objId),w=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(g(n.contents))+")",a+=" /Popup "+x.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+h(g(w))+") >>",p.content=a;var b=p.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",x.content=a,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var k=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(m(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+k+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var P=this.annotations._nameMap[n.options.name];n.options.pageNumber=P.page,n.options.top=P.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var L=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+L+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:A(n),w:c(r+s),h:A(n+a)},options:o,type:"link"})},t.textWithLink=function(r,n,s,a){var o,l,c=this.getTextWidth(r),A=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(A*u)}else l=c,o=A;return this.text(r,n,s,a),s+=.2*A,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-A,l,o,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(or.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&s.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=1};var A=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&a(p)&&e[p.charCodeAt(0)].length==4},d=t.__arabicParser__.resolveLigatures=function(p){var x=0,g=r,w="",b=0;for(x=0;x<p.length;x+=1)g[p.charCodeAt(x)]!==void 0?(b++,typeof(g=g[p.charCodeAt(x)])=="number"&&(w+=String.fromCharCode(g),g=r,b=0),x===p.length-1&&(g=r,w+=p.charAt(x-(b-1)),x-=b-1,b=0)):(g=r,w+=p.charAt(x-b),x-=b,b=0);return w};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var f=t.__arabicParser__.getCorrectForm=function(p,x,g){return o(p)?a(p)===!1?-1:!A(p)||!o(x)&&!o(g)||!o(g)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:u(p)&&o(x)&&!l(x)&&o(g)&&A(g)?3:l(p)||!o(g)?1:2:-1},h=function(p){var x=0,g=0,w=0,b="",k="",P="",L=(p=p||"").split("\\s+"),E=[];for(x=0;x<L.length;x+=1){for(E.push(""),g=0;g<L[x].length;g+=1)b=L[x][g],k=L[x][g-1],P=L[x][g+1],o(b)?(w=f(b,k,P),E[x]+=w!==-1?String.fromCharCode(e[b.charCodeAt(0)][w]):b):E[x]+=b;E[x]=d(E[x])}return E.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,g=[];if(Array.isArray(x)){var w=0;for(g=[],w=0;w<x.length;w+=1)Array.isArray(x[w])?g.push([h(x[w][0]),x[w][1],x[w][2]]):g.push([h(x[w])]);p=g}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(or.API),or.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(or.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var A=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,A){n.call(this);var u=(A=A||{}).fontSize||this.getFontSize(),d=A.font||this.getFont(),f=A.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var g=A.maxWidth;g>0?typeof c=="string"?c=this.splitTextToSize(c,g):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,k){return b.concat(x.splitTextToSize(k,g))},[])):c=Array.isArray(c)?c:[c];for(var w=0;w<c.length;w++)h<(p=this.getStringUnitWidth(c[w],{font:d})*u)&&(h=p);return h!==0&&(m=c.length),{w:h/=f,h:Math.max((m*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/f,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var A=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,f=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return A.lineNumber!==void 0&&(A.lineNumber===c.lineNumber?(c.x=(A.x||0)+(A.width||0),c.y=A.y||0):A.y+A.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,h&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=A.y+A.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,A,u,d,f){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,m,p,x,g=[],w=[],b=[],k={},P={},L=[],E=[],_=(f=f||{}).autoSize||!1,B=f.printHeaders!==!1,M=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,F=f.margins||Object.assign({width:this.getPageWidth()},e),T=typeof f.padding=="number"?f.padding:3,O=f.headerBackgroundColor||"#c8c8c8",Y=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=B,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=O,this.internal.__cell__.headerTextColor=Y,this.setFontSize(M),d==null)w=g=Object.keys(u[0]),b=g.map(function(){return"left"});else if(Array.isArray(d)&&Sn(d[0])==="object")for(g=d.map(function(pe){return pe.name}),w=d.map(function(pe){return pe.prompt||pe.name||""}),b=d.map(function(pe){return pe.align||"left"}),h=0;h<d.length;h+=1)P[d[h].name]=.7499990551181103*d[h].width;else Array.isArray(d)&&typeof d[0]=="string"&&(w=g=d,b=g.map(function(){return"left"}));if(_||Array.isArray(d)&&typeof d[0]=="string")for(h=0;h<g.length;h+=1){for(k[x=g[h]]=u.map(function(pe){return pe[x]}),this.setFont(void 0,"bold"),L.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=k[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)L.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[x]=Math.max.apply(null,L)+T+T,L=[]}if(B){var me={};for(h=0;h<g.length;h+=1)me[g[h]]={},me[g[h]].text=w[h],me[g[h]].align=b[h];var ae=l.call(this,me,P);E=g.map(function(pe){return new a(c,A,P[pe],ae,me[pe].text,void 0,me[pe].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var fe=d.reduce(function(pe,Ie){return pe[Ie.name]=Ie.align,pe},{});for(h=0;h<u.length;h+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:h,data:u[h]},this);var he=l.call(this,u[h],P);for(p=0;p<g.length;p+=1){var te=u[h][g[p]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:h,col:p,data:te},this),o.call(this,new a(c,A,P[g[p]],he,te,h+2,fe[g[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=A,this};var l=function(c,A){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,A[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*d/f+u+u},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,A){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),A&&(u.y=this.internal.__cell__.margins.top||0,f.push(u)),u.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(m)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(or.API);var GM={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$M=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],_E=qM($M),zM=[100,200,300,400,500,600,700,800,900],soe=qM(zM);function VN(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return GM[a=a||"normal"]?a:"normal"}(t.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(t.weight),s=function(a){return typeof _E[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function Fj(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var aoe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},kj={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Tj(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function jj(t){return t.trimLeft()}function ioe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function ooe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var h1,Pj,Rj,If,f1,Dj,Lj,Uj,HN=["times"];function Oj(t,e,r,n,s){var a=4,o=Qj;switch(s){case or.API.image_compression.FAST:a=1,o=Mj;break;case or.API.image_compression.MEDIUM:a=6,o=Vj;break;case or.API.image_compression.SLOW:a=9,o=Hj}t=function(c,A,u,d){for(var f,h=c.length/A,m=new Uint8Array(c.length+h),p=[loe,Mj,Qj,Vj,Hj],x=0;x<h;x+=1){var g=x*A,w=c.subarray(g,g+A);if(d)m.set(d(w,u,f),g+x);else{for(var b=p.length,k=[],P=0;P<b;P+=1)k[P]=p[P](w,u,f);var L=Aoe(k.concat());m.set(k[L],g+x)}f=w}return m}(t,e,Math.ceil(r*n/8),o);var l=xE(t,{level:a});return or.API.__addimage__.arrayBufferToBinaryString(l)}function loe(t){var e=Array.apply([],t);return e.unshift(0),e}function Mj(t,e){var r=t.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=t[s-e]||0;n[s+1]=t[s]-a+256&255}return n}function Qj(t,e,r){var n=t.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var o=r&&r[a]||0;s[a+1]=t[a]-o+256&255}return s}function Vj(t,e,r){var n=t.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var o=t[a-e]||0,l=r&&r[a]||0;s[a+1]=t[a]+256-(o+l>>>1)&255}return s}function Hj(t,e,r){var n=t.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var o=coe(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);s[a+1]=t[a]-o+256&255}return s}function coe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),s=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=s&&n<=a?t:s<=a?e:r}function Aoe(t){var e=t.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function KN(t,e,r){var n=e*r,s=Math.floor(n/8),a=16-(n-8*s+r),o=(1<<r)-1;return WM(t,s)>>a&o}function Kj(t,e,r,n){var s=r*n,a=Math.floor(s/8),o=16-(s-8*a+n),l=(1<<n)-1,c=(e&l)<<o;(function(A,u,d){if(u+1<A.byteLength)A.setUint16(u,d,!1);else{var f=d>>8&255;A.setUint8(u,f)}})(t,a,WM(t,a)&~(l<<o)&65535|c)}function WM(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function uoe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],a=s>>7,o=1<<1+(7&s);t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var A=!0,u=[],d=0,f=null,h=0,m=null;for(this.width=r,this.height=n;A&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((F=t[e++])>=0))throw Error("Invalid block size");if(F===0)break;e+=F}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];d=t[e++]|t[e++]<<8,f=t[e++],1&p||(f=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((F=t[e++])>=0))throw Error("Invalid block size");if(F===0)break;e+=F}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,k=t[e++],P=k>>6&1,L=1<<1+(7&k),E=l,_=c,B=!1;k>>7&&(B=!0,E=e,_=L,e+=3*L);var M=e;for(e++;;){var F;if(!((F=t[e++])>=0))throw Error("Invalid block size");if(F===0)break;e+=F}u.push({x,y:g,width:w,height:b,has_local_palette:B,palette_offset:E,palette_size:_,data_offset:M,data_length:e-M,transparent_index:f,interlaced:!!P,delay:d,disposal:h});break;case 59:A=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,O){var Y=this.frameInfo(T),me=Y.width*Y.height,ae=new Uint8Array(me);qj(t,Y.data_offset,ae,me);var fe=Y.palette_offset,he=Y.transparent_index;he===null&&(he=256);var te=Y.width,pe=r-te,Ie=te,S=4*(Y.y*r+Y.x),I=4*((Y.y+Y.height)*r+Y.x),V=S,j=4*pe;Y.interlaced===!0&&(j+=4*r*7);for(var U=8,G=0,R=ae.length;G<R;++G){var X=ae[G];if(Ie===0&&(Ie=te,(V+=j)>=I&&(j=4*pe+4*r*(U-1),V=S+(te+pe)*(U<<1),U>>=1)),X===he)V+=4;else{var se=t[fe+3*X],ye=t[fe+3*X+1],z=t[fe+3*X+2];O[V++]=z,O[V++]=ye,O[V++]=se,O[V++]=255}--Ie}},this.decodeAndBlitFrameRGBA=function(T,O){var Y=this.frameInfo(T),me=Y.width*Y.height,ae=new Uint8Array(me);qj(t,Y.data_offset,ae,me);var fe=Y.palette_offset,he=Y.transparent_index;he===null&&(he=256);var te=Y.width,pe=r-te,Ie=te,S=4*(Y.y*r+Y.x),I=4*((Y.y+Y.height)*r+Y.x),V=S,j=4*pe;Y.interlaced===!0&&(j+=4*r*7);for(var U=8,G=0,R=ae.length;G<R;++G){var X=ae[G];if(Ie===0&&(Ie=te,(V+=j)>=I&&(j=4*pe+4*r*(U-1),V=S+(te+pe)*(U<<1),U>>=1)),X===he)V+=4;else{var se=t[fe+3*X],ye=t[fe+3*X+1],z=t[fe+3*X+2];O[V++]=se,O[V++]=ye,O[V++]=z,O[V++]=255}--Ie}}}function qj(t,e,r,n){for(var s=t[e++],a=1<<s,o=a+1,l=o+1,c=s+1,A=(1<<c)-1,u=0,d=0,f=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;u<16&&h!==0;)d|=t[e++]<<u,u+=8,h===1?h=t[e++]:--h;if(u<c)break;var x=d&A;if(d>>=c,u-=c,x!==a){if(x===o)break;for(var g=x<l?x:p,w=0,b=g;b>a;)b=m[b]>>8,++w;var k=b;if(f+w+(g!==x?1:0)>n)return void Vn.log("Warning, gif stream longer than expected.");r[f++]=k;var P=f+=w;for(g!==x&&(r[f++]=k),b=g;w--;)b=m[b],r[--P]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|k,l>=A+1&&c<12&&(++c,A=A<<1|1)),p=x}else l=o+1,A=(1<<(c=s+1))-1,p=null}return f!==n&&Vn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function qN(t){var e,r,n,s,a,o=Math.floor,l=new Array(64),c=new Array(64),A=new Array(64),u=new Array(64),d=new Array(65535),f=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,g=7,w=new Array(64),b=new Array(64),k=new Array(64),P=new Array(256),L=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],_=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],me=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(S,I){for(var V=0,j=0,U=new Array,G=1;G<=16;G++){for(var R=1;R<=S[G];R++)U[I[j]]=[],U[I[j]][0]=V,U[I[j]][1]=G,j++,V++;V*=2}return U}function fe(S){for(var I=S[0],V=S[1]-1;V>=0;)I&1<<V&&(x|=1<<g),V--,--g<0&&(x==255?(he(255),he(0)):he(x),g=7,x=0)}function he(S){p.push(S)}function te(S){he(S>>8&255),he(255&S)}function pe(S,I,V,j,U){for(var G,R=U[0],X=U[240],se=function(Be,He){var $e,Je,ct,at,mt,st,Le,ut,be,ge,K=0;for(be=0;be<8;++be){$e=Be[K],Je=Be[K+1],ct=Be[K+2],at=Be[K+3],mt=Be[K+4],st=Be[K+5],Le=Be[K+6];var _e=$e+(ut=Be[K+7]),Oe=$e-ut,Ve=Je+Le,ve=Je-Le,Qe=ct+st,Ue=ct-st,Ee=at+mt,We=at-mt,nt=_e+Ee,Nt=_e-Ee,ot=Ve+Qe,wt=Ve-Qe;Be[K]=nt+ot,Be[K+4]=nt-ot;var Lt=.707106781*(wt+Nt);Be[K+2]=Nt+Lt,Be[K+6]=Nt-Lt;var cr=.382683433*((nt=We+Ue)-(wt=ve+Oe)),ar=.5411961*nt+cr,yr=1.306562965*wt+cr,tr=.707106781*(ot=Ue+ve),et=Oe+tr,gt=Oe-tr;Be[K+5]=gt+ar,Be[K+3]=gt-ar,Be[K+1]=et+yr,Be[K+7]=et-yr,K+=8}for(K=0,be=0;be<8;++be){$e=Be[K],Je=Be[K+8],ct=Be[K+16],at=Be[K+24],mt=Be[K+32],st=Be[K+40],Le=Be[K+48];var Rt=$e+(ut=Be[K+56]),kt=$e-ut,jt=Je+Le,Zt=Je-Le,Vt=ct+st,ie=ct-st,ne=at+mt,ue=at-mt,xe=Rt+ne,Fe=Rt-ne,De=jt+Vt,ee=jt-Vt;Be[K]=xe+De,Be[K+32]=xe-De;var Te=.707106781*(ee+Fe);Be[K+16]=Fe+Te,Be[K+48]=Fe-Te;var Ae=.382683433*((xe=ue+ie)-(ee=Zt+kt)),Pe=.5411961*xe+Ae,Ce=1.306562965*ee+Ae,Ze=.707106781*(De=ie+Zt),Xe=kt+Ze,Ye=kt-Ze;Be[K+40]=Ye+Pe,Be[K+24]=Ye-Pe,Be[K+8]=Xe+Ce,Be[K+56]=Xe-Ce,K++}for(be=0;be<64;++be)ge=Be[be]*He[be],h[be]=ge>0?ge+.5|0:ge-.5|0;return h}(S,I),ye=0;ye<64;++ye)m[E[ye]]=se[ye];var z=m[0]-V;V=m[0],z==0?fe(j[0]):(fe(j[f[G=32767+z]]),fe(d[G]));for(var Me=63;Me>0&&m[Me]==0;)Me--;if(Me==0)return fe(R),V;for(var re,W=1;W<=Me;){for(var q=W;m[W]==0&&W<=Me;)++W;var oe=W-q;if(oe>=16){re=oe>>4;for(var de=1;de<=re;++de)fe(X);oe&=15}G=32767+m[W],fe(U[(oe<<4)+f[G]]),fe(d[G]),W++}return Me!=63&&fe(R),V}function Ie(S){S=Math.min(Math.max(S,1),100),a!=S&&(function(I){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],j=0;j<64;j++){var U=o((V[j]*I+50)/100);U=Math.min(Math.max(U,1),255),l[E[j]]=U}for(var G=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],R=0;R<64;R++){var X=o((G[R]*I+50)/100);X=Math.min(Math.max(X,1),255),c[E[R]]=X}for(var se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ye=0,z=0;z<8;z++)for(var Me=0;Me<8;Me++)A[ye]=1/(l[E[ye]]*se[z]*se[Me]*8),u[ye]=1/(c[E[ye]]*se[z]*se[Me]*8),ye++}(S<50?Math.floor(5e3/S):Math.floor(200-2*S)),a=S)}this.encode=function(S,I){I&&Ie(I),p=new Array,x=0,g=7,te(65496),te(65504),te(16),he(74),he(70),he(73),he(70),he(0),he(1),he(1),he(0),te(1),te(1),he(0),he(0),function(){te(65499),te(132),he(0);for(var Je=0;Je<64;Je++)he(l[Je]);he(1);for(var ct=0;ct<64;ct++)he(c[ct])}(),function(Je,ct){te(65472),te(17),he(8),te(ct),te(Je),he(3),he(1),he(17),he(0),he(2),he(17),he(1),he(3),he(17),he(1)}(S.width,S.height),function(){te(65476),te(418),he(0);for(var Je=0;Je<16;Je++)he(_[Je+1]);for(var ct=0;ct<=11;ct++)he(B[ct]);he(16);for(var at=0;at<16;at++)he(M[at+1]);for(var mt=0;mt<=161;mt++)he(F[mt]);he(1);for(var st=0;st<16;st++)he(T[st+1]);for(var Le=0;Le<=11;Le++)he(O[Le]);he(17);for(var ut=0;ut<16;ut++)he(Y[ut+1]);for(var be=0;be<=161;be++)he(me[be])}(),te(65498),te(12),he(3),he(1),he(0),he(2),he(17),he(3),he(17),he(0),he(63),he(0);var V=0,j=0,U=0;x=0,g=7,this.encode.displayName="_encode_";for(var G,R,X,se,ye,z,Me,re,W,q=S.data,oe=S.width,de=S.height,Be=4*oe,He=0;He<de;){for(G=0;G<Be;){for(ye=Be*He+G,Me=-1,re=0,W=0;W<64;W++)z=ye+(re=W>>3)*Be+(Me=4*(7&W)),He+re>=de&&(z-=Be*(He+1+re-de)),G+Me>=Be&&(z-=G+Me-Be+4),R=q[z++],X=q[z++],se=q[z++],w[W]=(L[R]+L[X+256|0]+L[se+512|0]>>16)-128,b[W]=(L[R+768|0]+L[X+1024|0]+L[se+1280|0]>>16)-128,k[W]=(L[R+1280|0]+L[X+1536|0]+L[se+1792|0]>>16)-128;V=pe(w,A,V,e,n),j=pe(b,u,j,r,s),U=pe(k,u,U,r,s),G+=32}He+=8}if(g>=0){var $e=[];$e[1]=g+1,$e[0]=(1<<g+1)-1,fe($e)}return te(65497),new Uint8Array(p)},t=t||50,function(){for(var S=String.fromCharCode,I=0;I<256;I++)P[I]=S(I)}(),e=ae(_,B),r=ae(T,O),n=ae(M,F),s=ae(Y,me),function(){for(var S=1,I=2,V=1;V<=15;V++){for(var j=S;j<I;j++)f[32767+j]=V,d[32767+j]=[],d[32767+j][1]=V,d[32767+j][0]=j;for(var U=-(I-1);U<=-S;U++)f[32767+U]=V,d[32767+U]=[],d[32767+U][1]=V,d[32767+U][0]=I-1+U;S<<=1,I<<=1}}(),function(){for(var S=0;S<256;S++)L[S]=19595*S,L[S+256|0]=38470*S,L[S+512|0]=7471*S+32768,L[S+768|0]=-11059*S,L[S+1024|0]=-21709*S,L[S+1280|0]=32768*S+8421375,L[S+1536|0]=-27439*S,L[S+1792|0]=-5329*S}(),Ie(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function _l(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Gj(t){function e(B){if(!B)throw Error("assert :P")}function r(B,M,F){for(var T=0;4>T;T++)if(B[M+T]!=F.charCodeAt(T))return!0;return!1}function n(B,M,F,T,O){for(var Y=0;Y<O;Y++)B[M+Y]=F[T+Y]}function s(B,M,F,T){for(var O=0;O<T;O++)B[M+O]=F}function a(B){return new Int32Array(B)}function o(B,M){for(var F=[],T=0;T<B;T++)F.push(new M);return F}function l(B,M){var F=[];return function T(O,Y,me){for(var ae=me[Y],fe=0;fe<ae&&(O.push(me.length>Y+1?[]:new M),!(me.length<Y+1));fe++)T(O[fe],Y+1,me)}(F,0,B),F}var c=function(){var B=this;function M(v,C){for(var Q=1<<C-1>>>0;v&Q;)Q>>>=1;return Q?(v&Q-1)+Q:v}function F(v,C,Q,J,ce){e(!(J%Q));do v[C+(J-=Q)]=ce;while(0<J)}function T(v,C,Q,J,ce){if(e(2328>=ce),512>=ce)var we=a(512);else if((we=a(ce))==null)return 0;return function(Ne,Se,Re,qe,it,vt){var Ge,lt,pt=Se,Et=1<<Re,xt=a(16),It=a(16);for(e(it!=0),e(qe!=null),e(Ne!=null),e(0<Re),lt=0;lt<it;++lt){if(15<qe[lt])return 0;++xt[qe[lt]]}if(xt[0]==it)return 0;for(It[1]=0,Ge=1;15>Ge;++Ge){if(xt[Ge]>1<<Ge)return 0;It[Ge+1]=It[Ge]+xt[Ge]}for(lt=0;lt<it;++lt)Ge=qe[lt],0<qe[lt]&&(vt[It[Ge]++]=lt);if(It[15]==1)return(qe=new O).g=0,qe.value=vt[0],F(Ne,pt,1,Et,qe),Et;var Ft,Qt=-1,Ut=Et-1,gr=0,Ar=1,Ur=1,fr=1<<Re;for(lt=0,Ge=1,it=2;Ge<=Re;++Ge,it<<=1){if(Ar+=Ur<<=1,0>(Ur-=xt[Ge]))return 0;for(;0<xt[Ge];--xt[Ge])(qe=new O).g=Ge,qe.value=vt[lt++],F(Ne,pt+gr,it,fr,qe),gr=M(gr,Ge)}for(Ge=Re+1,it=2;15>=Ge;++Ge,it<<=1){if(Ar+=Ur<<=1,0>(Ur-=xt[Ge]))return 0;for(;0<xt[Ge];--xt[Ge]){if(qe=new O,(gr&Ut)!=Qt){for(pt+=fr,Ft=1<<(Qt=Ge)-Re;15>Qt&&!(0>=(Ft-=xt[Qt]));)++Qt,Ft<<=1;Et+=fr=1<<(Ft=Qt-Re),Ne[Se+(Qt=gr&Ut)].g=Ft+Re,Ne[Se+Qt].value=pt-Se-Qt}qe.g=Ge-Re,qe.value=vt[lt++],F(Ne,pt+(gr>>Re),it,fr,qe),gr=M(gr,Ge)}}return Ar!=2*It[15]-1?0:Et}(v,C,Q,J,ce,we)}function O(){this.value=this.g=0}function Y(){this.value=this.g=0}function me(){this.G=o(5,O),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Id,Y)}function ae(v,C,Q,J){e(v!=null),e(C!=null),e(2147483648>J),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=C,v.pa=Q,v.Jd=C,v.Yc=Q+J,v.Zc=4<=J?Q+J-4+1:Q,R(v)}function fe(v,C){for(var Q=0;0<C--;)Q|=se(v,128)<<C;return Q}function he(v,C){var Q=fe(v,C);return X(v)?-Q:Q}function te(v,C,Q,J){var ce,we=0;for(e(v!=null),e(C!=null),e(4294967288>J),v.Sb=J,v.Ra=0,v.u=0,v.h=0,4<J&&(J=4),ce=0;ce<J;++ce)we+=C[Q+ce]<<8*ce;v.Ra=we,v.bb=J,v.oa=C,v.pa=Q}function pe(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<KA-8>>>0,++v.bb,v.u-=8;j(v)&&(v.h=1,v.u=0)}function Ie(v,C){if(e(0<=C),!v.h&&C<=lo){var Q=V(v)&oo[C];return v.u+=C,pe(v),Q}return v.h=1,v.u=0}function S(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function I(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(v){return v.Ra>>>(v.u&KA-1)>>>0}function j(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>KA}function U(v,C){v.u=C,v.h=j(v)}function G(v){v.u>=Mc&&(e(v.u>=Mc),pe(v))}function R(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function X(v){return fe(v,1)}function se(v,C){var Q=v.Ca;0>v.b&&R(v);var J=v.b,ce=Q*C>>>8,we=(v.I>>>J>ce)+0;for(we?(Q-=ce,v.I-=ce+1<<J>>>0):Q=ce+1,J=Q,ce=0;256<=J;)ce+=8,J>>=8;return J=7^ce+qA[J],v.b-=J,v.Ca=(Q<<J)-1,we}function ye(v,C,Q){v[C+0]=Q>>24&255,v[C+1]=Q>>16&255,v[C+2]=Q>>8&255,v[C+3]=255&Q}function z(v,C){return v[C+0]|v[C+1]<<8}function Me(v,C){return z(v,C)|v[C+2]<<16}function re(v,C){return z(v,C)|z(v,C+2)<<16}function W(v,C){var Q=1<<C;return e(v!=null),e(0<C),v.X=a(Q),v.X==null?0:(v.Mb=32-C,v.Xa=C,1)}function q(v,C){e(v!=null),e(C!=null),e(v.Xa==C.Xa),n(C.X,0,v.X,0,1<<C.Xa)}function oe(){this.X=[],this.Xa=this.Mb=0}function de(v,C,Q,J){e(Q!=null),e(J!=null);var ce=Q[0],we=J[0];return ce==0&&(ce=(v*we+C/2)/C),we==0&&(we=(C*ce+v/2)/v),0>=ce||0>=we?0:(Q[0]=ce,J[0]=we,1)}function Be(v,C){return v+(1<<C)-1>>>C}function He(v,C){return((4278255360&v)+(4278255360&C)>>>0&4278255360)+((16711935&v)+(16711935&C)>>>0&16711935)>>>0}function $e(v,C){B[C]=function(Q,J,ce,we,Ne,Se,Re){var qe;for(qe=0;qe<Ne;++qe){var it=B[v](Se[Re+qe-1],ce,we+qe);Se[Re+qe]=He(Q[J+qe],it)}}}function Je(){this.ud=this.hd=this.jd=0}function ct(v,C){return((4278124286&(v^C))>>>1)+(v&C)>>>0}function at(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function mt(v,C){return at(v+(v-C+.5>>1))}function st(v,C,Q){return Math.abs(C-Q)-Math.abs(v-Q)}function Le(v,C,Q,J,ce,we,Ne){for(J=we[Ne-1],Q=0;Q<ce;++Q)we[Ne+Q]=J=He(v[C+Q],J)}function ut(v,C,Q,J,ce){var we;for(we=0;we<Q;++we){var Ne=v[C+we],Se=Ne>>8&255,Re=16711935&(Re=(Re=16711935&Ne)+((Se<<16)+Se));J[ce+we]=(4278255360&Ne)+Re>>>0}}function be(v,C){C.jd=255&v,C.hd=v>>8&255,C.ud=v>>16&255}function ge(v,C,Q,J,ce,we){var Ne;for(Ne=0;Ne<J;++Ne){var Se=C[Q+Ne],Re=Se>>>8,qe=Se,it=255&(it=(it=Se>>>16)+((v.jd<<24>>24)*(Re<<24>>24)>>>5));qe=255&(qe=(qe+=(v.hd<<24>>24)*(Re<<24>>24)>>>5)+((v.ud<<24>>24)*(it<<24>>24)>>>5)),ce[we+Ne]=(4278255360&Se)+(it<<16)+qe}}function K(v,C,Q,J,ce){B[C]=function(we,Ne,Se,Re,qe,it,vt,Ge,lt){for(Re=vt;Re<Ge;++Re)for(vt=0;vt<lt;++vt)qe[it++]=ce(Se[J(we[Ne++])])},B[v]=function(we,Ne,Se,Re,qe,it,vt){var Ge=8>>we.b,lt=we.Ea,pt=we.K[0],Et=we.w;if(8>Ge)for(we=(1<<we.b)-1,Et=(1<<Ge)-1;Ne<Se;++Ne){var xt,It=0;for(xt=0;xt<lt;++xt)xt&we||(It=J(Re[qe++])),it[vt++]=ce(pt[It&Et]),It>>=Ge}else B["VP8LMapColor"+Q](Re,qe,pt,Et,it,vt,Ne,Se,lt)}}function _e(v,C,Q,J,ce){for(Q=C+Q;C<Q;){var we=v[C++];J[ce++]=we>>16&255,J[ce++]=we>>8&255,J[ce++]=255&we}}function Oe(v,C,Q,J,ce){for(Q=C+Q;C<Q;){var we=v[C++];J[ce++]=we>>16&255,J[ce++]=we>>8&255,J[ce++]=255&we,J[ce++]=we>>24&255}}function Ve(v,C,Q,J,ce){for(Q=C+Q;C<Q;){var we=(Ne=v[C++])>>16&240|Ne>>12&15,Ne=240&Ne|Ne>>28&15;J[ce++]=we,J[ce++]=Ne}}function ve(v,C,Q,J,ce){for(Q=C+Q;C<Q;){var we=(Ne=v[C++])>>16&248|Ne>>13&7,Ne=Ne>>5&224|Ne>>3&31;J[ce++]=we,J[ce++]=Ne}}function Qe(v,C,Q,J,ce){for(Q=C+Q;C<Q;){var we=v[C++];J[ce++]=255&we,J[ce++]=we>>8&255,J[ce++]=we>>16&255}}function Ue(v,C,Q,J,ce,we){if(we==0)for(Q=C+Q;C<Q;)ye(J,((we=v[C++])[0]>>24|we[1]>>8&65280|we[2]<<8&16711680|we[3]<<24)>>>0),ce+=32;else n(J,ce,v,C,Q)}function Ee(v,C){B[C][0]=B[v+"0"],B[C][1]=B[v+"1"],B[C][2]=B[v+"2"],B[C][3]=B[v+"3"],B[C][4]=B[v+"4"],B[C][5]=B[v+"5"],B[C][6]=B[v+"6"],B[C][7]=B[v+"7"],B[C][8]=B[v+"8"],B[C][9]=B[v+"9"],B[C][10]=B[v+"10"],B[C][11]=B[v+"11"],B[C][12]=B[v+"12"],B[C][13]=B[v+"13"],B[C][14]=B[v+"0"],B[C][15]=B[v+"0"]}function We(v){return v==nb||v==sb||v==tv||v==ab}function nt(){this.eb=[],this.size=this.A=this.fb=0}function Nt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ot(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new nt,this.f.kb=new Nt,this.sd=null}function wt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function cr(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function ar(v,C){var Q=v.T,J=C.ba.f.RGBA,ce=J.eb,we=J.fb+v.ka*J.A,Ne=Go[C.ba.S],Se=v.y,Re=v.O,qe=v.f,it=v.N,vt=v.ea,Ge=v.W,lt=C.cc,pt=C.dc,Et=C.Mc,xt=C.Nc,It=v.ka,Ft=v.ka+v.T,Qt=v.U,Ut=Qt+1>>1;for(It==0?Ne(Se,Re,null,null,qe,it,vt,Ge,qe,it,vt,Ge,ce,we,null,null,Qt):(Ne(C.ec,C.fc,Se,Re,lt,pt,Et,xt,qe,it,vt,Ge,ce,we-J.A,ce,we,Qt),++Q);It+2<Ft;It+=2)lt=qe,pt=it,Et=vt,xt=Ge,it+=v.Rc,Ge+=v.Rc,we+=2*J.A,Ne(Se,(Re+=2*v.fa)-v.fa,Se,Re,lt,pt,Et,xt,qe,it,vt,Ge,ce,we-J.A,ce,we,Qt);return Re+=v.fa,v.j+Ft<v.o?(n(C.ec,C.fc,Se,Re,Qt),n(C.cc,C.dc,qe,it,Ut),n(C.Mc,C.Nc,vt,Ge,Ut),Q--):1&Ft||Ne(Se,Re,null,null,qe,it,vt,Ge,qe,it,vt,Ge,ce,we+J.A,null,null,Qt),Q}function yr(v,C,Q){var J=v.F,ce=[v.J];if(J!=null){var we=v.U,Ne=C.ba.S,Se=Ne==ev||Ne==tv;C=C.ba.f.RGBA;var Re=[0],qe=v.ka;Re[0]=v.T,v.Kb&&(qe==0?--Re[0]:(--qe,ce[0]-=v.width),v.j+v.ka+v.T==v.o&&(Re[0]=v.o-v.j-qe));var it=C.eb;qe=C.fb+qe*C.A,v=YI(J,ce[0],v.width,we,Re,it,qe+(Se?0:3),C.A),e(Q==Re),v&&We(Ne)&&Bm(it,qe,Se,we,Re,C.A)}return 0}function tr(v){var C=v.ma,Q=C.ba.S,J=11>Q,ce=Q==Yx||Q==Zx||Q==ev||Q==rb||Q==12||We(Q);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!vm(C.Oa,v,ce?11:12))return 0;if(ce&&We(Q)&&Ho(),v.da)alert("todo:use_scaling");else{if(J){if(C.Ib=cr,v.Kb){if(Q=v.U+1>>1,C.memory=a(v.U+2*Q),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+v.U,C.Mc=C.cc,C.Nc=C.dc+Q,C.Ib=ar,Ho()}}else alert("todo:EmitYUV");ce&&(C.Jb=yr,J&&Qi())}if(J&&!f5){for(v=0;256>v;++v)T7[v]=89858*(v-128)+nv>>rv,R7[v]=-22014*(v-128)+nv,P7[v]=-45773*(v-128),j7[v]=113618*(v-128)+nv>>rv;for(v=Im;v<lb;++v)C=76283*(v-16)+nv>>rv,D7[v-Im]=Jn(C,255),L7[v-Im]=Jn(C+8>>4,15);f5=1}return 1}function et(v){var C=v.ma,Q=v.U,J=v.T;return e(!(1&v.ka)),0>=Q||0>=J?0:(Q=C.Ib(v,C),C.Jb!=null&&C.Jb(v,C,Q),C.Dc+=Q,1)}function gt(v){v.ma.memory=null}function Rt(v,C,Q,J){return Ie(v,8)!=47?0:(C[0]=Ie(v,14)+1,Q[0]=Ie(v,14)+1,J[0]=Ie(v,1),Ie(v,3)!=0?0:!v.h)}function kt(v,C){if(4>v)return v+1;var Q=v-2>>1;return(2+(1&v)<<Q)+Ie(C,Q)+1}function jt(v,C){return 120<C?C-120:1<=(Q=((Q=x7[C-1])>>4)*v+(8-(15&Q)))?Q:1;var Q}function Zt(v,C,Q){var J=V(Q),ce=v[C+=255&J].g-8;return 0<ce&&(U(Q,Q.u+8),J=V(Q),C+=v[C].value,C+=J&(1<<ce)-1),U(Q,Q.u+v[C].g),v[C].value}function Vt(v,C,Q){return Q.g+=v.g,Q.value+=v.value<<C>>>0,e(8>=Q.g),v.g}function ie(v,C,Q){var J=v.xc;return e((C=J==0?0:v.vc[v.md*(Q>>J)+(C>>J)])<v.Wb),v.Ya[C]}function ne(v,C,Q,J){var ce=v.ab,we=v.c*C,Ne=v.C;C=Ne+C;var Se=Q,Re=J;for(J=v.Ta,Q=v.Ua;0<ce--;){var qe=v.gc[ce],it=Ne,vt=C,Ge=Se,lt=Re,pt=(Re=J,Se=Q,qe.Ea);switch(e(it<vt),e(vt<=qe.nc),qe.hc){case 2:Ds(Ge,lt,(vt-it)*pt,Re,Se);break;case 0:var Et=it,xt=vt,It=Re,Ft=Se,Qt=(fr=qe).Ea;Et==0&&(wm(Ge,lt,null,null,1,It,Ft),Le(Ge,lt+1,0,0,Qt-1,It,Ft+1),lt+=Qt,Ft+=Qt,++Et);for(var Ut=1<<fr.b,gr=Ut-1,Ar=Be(Qt,fr.b),Ur=fr.K,fr=fr.w+(Et>>fr.b)*Ar;Et<xt;){var an=Ur,sa=fr,Or=1;for(df(Ge,lt,It,Ft-Qt,1,It,Ft);Or<Qt;){var mr=(Or&~gr)+Ut;mr>Qt&&(mr=Qt),(0,Nm[an[sa++]>>8&15])(Ge,lt+ +Or,It,Ft+Or-Qt,mr-Or,It,Ft+Or),Or=mr}lt+=Qt,Ft+=Qt,++Et&gr||(fr+=Ar)}vt!=qe.nc&&n(Re,Se-pt,Re,Se+(vt-it-1)*pt,pt);break;case 1:for(pt=Ge,xt=lt,Qt=(Ge=qe.Ea)-(Ft=Ge&~(It=(lt=1<<qe.b)-1)),Et=Be(Ge,qe.b),Ut=qe.K,qe=qe.w+(it>>qe.b)*Et;it<vt;){for(gr=Ut,Ar=qe,Ur=new Je,fr=xt+Ft,an=xt+Ge;xt<fr;)be(gr[Ar++],Ur),Cm(Ur,pt,xt,lt,Re,Se),xt+=lt,Se+=lt;xt<an&&(be(gr[Ar++],Ur),Cm(Ur,pt,xt,Qt,Re,Se),xt+=Qt,Se+=Qt),++it&It||(qe+=Et)}break;case 3:if(Ge==Re&&lt==Se&&0<qe.b){for(xt=Re,Ge=pt=Se+(vt-it)*pt-(Ft=(vt-it)*Be(qe.Ea,qe.b)),lt=Re,It=Se,Et=[],Ft=(Qt=Ft)-1;0<=Ft;--Ft)Et[Ft]=lt[It+Ft];for(Ft=Qt-1;0<=Ft;--Ft)xt[Ge+Ft]=Et[Ft];zx(qe,it,vt,Re,pt,Re,Se)}else zx(qe,it,vt,Ge,lt,Re,Se)}Se=J,Re=Q}Re!=Q&&n(J,Q,Se,Re,we)}function ue(v,C){var Q=v.V,J=v.Ba+v.c*v.C,ce=C-v.C;if(e(C<=v.l.o),e(16>=ce),0<ce){var we=v.l,Ne=v.Ta,Se=v.Ua,Re=we.width;if(ne(v,ce,Q,J),ce=Se=[Se],e((Q=v.C)<(J=C)),e(we.v<we.va),J>we.o&&(J=we.o),Q<we.j){var qe=we.j-Q;Q=we.j,ce[0]+=qe*Re}if(Q>=J?Q=0:(ce[0]+=4*we.v,we.ka=Q-we.j,we.U=we.va-we.v,we.T=J-Q,Q=1),Q){if(Se=Se[0],11>(Q=v.ca).S){var it=Q.f.RGBA,vt=(J=Q.S,ce=we.U,we=we.T,qe=it.eb,it.A),Ge=we;for(it=it.fb+v.Ma*it.A;0<Ge--;){var lt=Ne,pt=Se,Et=ce,xt=qe,It=it;switch(J){case Xx:_m(lt,pt,Et,xt,It);break;case Yx:GA(lt,pt,Et,xt,It);break;case nb:GA(lt,pt,Et,xt,It),Bm(xt,It,0,Et,1,0);break;case a5:Fd(lt,pt,Et,xt,It);break;case Zx:Ue(lt,pt,Et,xt,It,1);break;case sb:Ue(lt,pt,Et,xt,It,1),Bm(xt,It,0,Et,1,0);break;case ev:Ue(lt,pt,Et,xt,It,0);break;case tv:Ue(lt,pt,Et,xt,It,0),Bm(xt,It,1,Et,1,0);break;case rb:$A(lt,pt,Et,xt,It);break;case ab:$A(lt,pt,Et,xt,It),XI(xt,It,Et,1,0);break;case i5:zA(lt,pt,Et,xt,It);break;default:e(0)}Se+=Re,it+=vt}v.Ma+=we}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=Q.height)}}v.C=C,e(v.C<=v.i)}function xe(v){var C;if(0<v.ua)return 0;for(C=0;C<v.Wb;++C){var Q=v.Ya[C].G,J=v.Ya[C].H;if(0<Q[1][J[1]+0].g||0<Q[2][J[2]+0].g||0<Q[3][J[3]+0].g)return 0}return 1}function Fe(v,C,Q,J,ce,we){if(v.Z!=0){var Ne=v.qd,Se=v.rd;for(e(XA[v.Z]!=null);C<Q;++C)XA[v.Z](Ne,Se,J,ce,J,ce,we),Ne=J,Se=ce,ce+=we;v.qd=Ne,v.rd=Se}}function De(v,C){var Q=v.l.ma,J=Q.Z==0||Q.Z==1?v.l.j:v.C;if(J=v.C<J?J:v.C,e(C<=v.l.o),C>J){var ce=v.l.width,we=Q.ca,Ne=Q.tb+ce*J,Se=v.V,Re=v.Ba+v.c*J,qe=v.gc;e(v.ab==1),e(qe[0].hc==3),sc(qe[0],J,C,Se,Re,we,Ne),Fe(Q,J,C,we,Ne,ce)}v.C=v.Ma=C}function ee(v,C,Q,J,ce,we,Ne){var Se=v.$/J,Re=v.$%J,qe=v.m,it=v.s,vt=Q+v.$,Ge=vt;ce=Q+J*ce;var lt=Q+J*we,pt=280+it.ua,Et=v.Pb?Se:16777216,xt=0<it.ua?it.Wa:null,It=it.wc,Ft=vt<lt?ie(it,Re,Se):null;e(v.C<we),e(lt<=ce);var Qt=!1;e:for(;;){for(;Qt||vt<lt;){var Ut=0;if(Se>=Et){var gr=vt-Q;e((Et=v).Pb),Et.wd=Et.m,Et.xd=gr,0<Et.s.ua&&q(Et.s.Wa,Et.s.vb),Et=Se+y7}if(Re&It||(Ft=ie(it,Re,Se)),e(Ft!=null),Ft.Qb&&(C[vt]=Ft.qb,Qt=!0),!Qt)if(G(qe),Ft.jc){Ut=qe,gr=C;var Ar=vt,Ur=Ft.pd[V(Ut)&Id-1];e(Ft.jc),256>Ur.g?(U(Ut,Ut.u+Ur.g),gr[Ar]=Ur.value,Ut=0):(U(Ut,Ut.u+Ur.g-256),e(256<=Ur.value),Ut=Ur.value),Ut==0&&(Qt=!0)}else Ut=Zt(Ft.G[0],Ft.H[0],qe);if(qe.h)break;if(Qt||256>Ut){if(!Qt)if(Ft.nd)C[vt]=(Ft.qb|Ut<<8)>>>0;else{if(G(qe),Qt=Zt(Ft.G[1],Ft.H[1],qe),G(qe),gr=Zt(Ft.G[2],Ft.H[2],qe),Ar=Zt(Ft.G[3],Ft.H[3],qe),qe.h)break;C[vt]=(Ar<<24|Qt<<16|Ut<<8|gr)>>>0}if(Qt=!1,++vt,++Re>=J&&(Re=0,++Se,Ne!=null&&Se<=we&&!(Se%16)&&Ne(v,Se),xt!=null))for(;Ge<vt;)Ut=C[Ge++],xt.X[(506832829*Ut&4294967295)>>>xt.Mb]=Ut}else if(280>Ut){if(Ut=kt(Ut-256,qe),gr=Zt(Ft.G[4],Ft.H[4],qe),G(qe),gr=jt(J,gr=kt(gr,qe)),qe.h)break;if(vt-Q<gr||ce-vt<Ut)break e;for(Ar=0;Ar<Ut;++Ar)C[vt+Ar]=C[vt+Ar-gr];for(vt+=Ut,Re+=Ut;Re>=J;)Re-=J,++Se,Ne!=null&&Se<=we&&!(Se%16)&&Ne(v,Se);if(e(vt<=ce),Re&It&&(Ft=ie(it,Re,Se)),xt!=null)for(;Ge<vt;)Ut=C[Ge++],xt.X[(506832829*Ut&4294967295)>>>xt.Mb]=Ut}else{if(!(Ut<pt))break e;for(Qt=Ut-280,e(xt!=null);Ge<vt;)Ut=C[Ge++],xt.X[(506832829*Ut&4294967295)>>>xt.Mb]=Ut;Ut=vt,e(!(Qt>>>(gr=xt).Xa)),C[Ut]=gr.X[Qt],Qt=!0}Qt||e(qe.h==j(qe))}if(v.Pb&&qe.h&&vt<ce)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&q(v.s.vb,v.s.Wa);else{if(qe.h)break e;Ne!=null&&Ne(v,Se>we?we:Se),v.a=0,v.$=vt-Q}return 1}return v.a=3,0}function Te(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var C=v.Wa;C!=null&&(C.X=null),v.vb=null,e(v!=null)}function Ae(){var v=new Nr;return v==null?null:(v.a=0,v.xb=c5,Ee("Predictor","VP8LPredictors"),Ee("Predictor","VP8LPredictors_C"),Ee("PredictorAdd","VP8LPredictorsAdd"),Ee("PredictorAdd","VP8LPredictorsAdd_C"),Ds=ut,Cm=ge,_m=_e,GA=Oe,$A=Ve,zA=ve,Fd=Qe,B.VP8LMapColor32b=nc,B.VP8LMapColor8b=bm,v)}function Pe(v,C,Q,J,ce){var we=1,Ne=[v],Se=[C],Re=J.m,qe=J.s,it=null,vt=0;e:for(;;){if(Q)for(;we&&Ie(Re,1);){var Ge=Ne,lt=Se,pt=J,Et=1,xt=pt.m,It=pt.gc[pt.ab],Ft=Ie(xt,2);if(pt.Oc&1<<Ft)we=0;else{switch(pt.Oc|=1<<Ft,It.hc=Ft,It.Ea=Ge[0],It.nc=lt[0],It.K=[null],++pt.ab,e(4>=pt.ab),Ft){case 0:case 1:It.b=Ie(xt,3)+2,Et=Pe(Be(It.Ea,It.b),Be(It.nc,It.b),0,pt,It.K),It.K=It.K[0];break;case 3:var Qt,Ut=Ie(xt,8)+1,gr=16<Ut?0:4<Ut?1:2<Ut?2:3;if(Ge[0]=Be(It.Ea,gr),It.b=gr,Qt=Et=Pe(Ut,1,0,pt,It.K)){var Ar,Ur=Ut,fr=It,an=1<<(8>>fr.b),sa=a(an);if(sa==null)Qt=0;else{var Or=fr.K[0],mr=fr.w;for(sa[0]=fr.K[0][0],Ar=1;Ar<1*Ur;++Ar)sa[Ar]=He(Or[mr+Ar],sa[Ar-1]);for(;Ar<4*an;++Ar)sa[Ar]=0;fr.K[0]=null,fr.K[0]=sa,Qt=1}}Et=Qt;break;case 2:break;default:e(0)}we=Et}}if(Ne=Ne[0],Se=Se[0],we&&Ie(Re,1)&&!(we=1<=(vt=Ie(Re,4))&&11>=vt)){J.a=3;break e}var Yt;if(Yt=we)t:{var Us,Pr,on,Xn=J,Pa=Ne,Ci=Se,Bs=vt,Za=Q,_i=Xn.m,aa=Xn.s,cn=[null],wn=1,Ss=0,bn=v7[Bs];r:for(;;){if(Za&&Ie(_i,1)){var Ra=Ie(_i,3)+2,bl=Be(Pa,Ra),Os=Be(Ci,Ra),Vi=bl*Os;if(!Pe(bl,Os,0,Xn,cn))break r;for(cn=cn[0],aa.xc=Ra,Us=0;Us<Vi;++Us){var On=cn[Us]>>8&65535;cn[Us]=On,On>=wn&&(wn=On+1)}}if(_i.h)break r;for(Pr=0;5>Pr;++Pr){var ia=o5[Pr];!Pr&&0<Bs&&(ia+=1<<Bs),Ss<ia&&(Ss=ia)}var Ao=o(wn*bn,O),Ei=wn,uo=o(Ei,me);if(uo==null)var ho=null;else e(65536>=Ei),ho=uo;var Hi=a(Ss);if(ho==null||Hi==null||Ao==null){Xn.a=1;break r}var fo=Ao;for(Us=on=0;Us<wn;++Us){var Gn=ho[Us],mo=Gn.G,Nl=Gn.H,Td=0,Hc=1,Da=0;for(Pr=0;5>Pr;++Pr){ia=o5[Pr],mo[Pr]=fo,Nl[Pr]=on,!Pr&&0<Bs&&(ia+=1<<Bs);s:{var av,cb=ia,iv=Xn,Fm=Hi,M7=fo,Q7=on,Ab=0,YA=iv.m,V7=Ie(YA,1);if(s(Fm,0,0,cb),V7){var H7=Ie(YA,1)+1,K7=Ie(YA,1),g5=Ie(YA,K7==0?1:8);Fm[g5]=1,H7==2&&(Fm[g5=Ie(YA,8)]=1);var ov=1}else{var x5=a(19),v5=Ie(YA,4)+4;if(19<v5){iv.a=3;var lv=0;break s}for(av=0;av<v5;++av)x5[g7[av]]=Ie(YA,3);var ub=void 0,km=void 0,y5=iv,q7=x5,cv=cb,w5=Fm,db=0,ZA=y5.m,b5=8,N5=o(128,O);n:for(;T(N5,0,7,q7,19);){if(Ie(ZA,1)){var G7=2+2*Ie(ZA,3);if((ub=2+Ie(ZA,G7))>cv)break n}else ub=cv;for(km=0;km<cv&&ub--;){G(ZA);var C5=N5[0+(127&V(ZA))];U(ZA,ZA.u+C5.g);var ff=C5.value;if(16>ff)w5[km++]=ff,ff!=0&&(b5=ff);else{var $7=ff==16,_5=ff-16,z7=m7[_5],E5=Ie(ZA,f7[_5])+z7;if(km+E5>cv)break n;for(var W7=$7?b5:0;0<E5--;)w5[km++]=W7}}db=1;break n}db||(y5.a=3),ov=db}(ov=ov&&!YA.h)&&(Ab=T(M7,Q7,8,Fm,cb)),ov&&Ab!=0?lv=Ab:(iv.a=3,lv=0)}if(lv==0)break r;if(Hc&&p7[Pr]==1&&(Hc=fo[on].g==0),Td+=fo[on].g,on+=lv,3>=Pr){var Tm,hb=Hi[0];for(Tm=1;Tm<ia;++Tm)Hi[Tm]>hb&&(hb=Hi[Tm]);Da+=hb}}if(Gn.nd=Hc,Gn.Qb=0,Hc&&(Gn.qb=(mo[3][Nl[3]+0].value<<24|mo[1][Nl[1]+0].value<<16|mo[2][Nl[2]+0].value)>>>0,Td==0&&256>mo[0][Nl[0]+0].value&&(Gn.Qb=1,Gn.qb+=mo[0][Nl[0]+0].value<<8)),Gn.jc=!Gn.Qb&&6>Da,Gn.jc){var Av,Kc=Gn;for(Av=0;Av<Id;++Av){var eu=Av,tu=Kc.pd[eu],uv=Kc.G[0][Kc.H[0]+eu];256<=uv.value?(tu.g=uv.g+256,tu.value=uv.value):(tu.g=0,tu.value=0,eu>>=Vt(uv,8,tu),eu>>=Vt(Kc.G[1][Kc.H[1]+eu],16,tu),eu>>=Vt(Kc.G[2][Kc.H[2]+eu],0,tu),Vt(Kc.G[3][Kc.H[3]+eu],24,tu))}}}aa.vc=cn,aa.Wb=wn,aa.Ya=ho,aa.yc=Ao,Yt=1;break t}Yt=0}if(!(we=Yt)){J.a=3;break e}if(0<vt){if(qe.ua=1<<vt,!W(qe.Wa,vt)){J.a=1,we=0;break e}}else qe.ua=0;var fb=J,B5=Ne,J7=Se,mb=fb.s,pb=mb.xc;if(fb.c=B5,fb.i=J7,mb.md=Be(B5,pb),mb.wc=pb==0?-1:(1<<pb)-1,Q){J.xb=B7;break e}if((it=a(Ne*Se))==null){J.a=1,we=0;break e}we=(we=ee(J,it,0,Ne,Se,Se,null))&&!Re.h;break e}return we?(ce!=null?ce[0]=it:(e(it==null),e(Q)),J.$=0,Q||Te(qe)):Te(qe),we}function Ce(v,C){var Q=v.c*v.i,J=Q+C+16*C;return e(v.c<=C),v.V=a(J),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+Q+C,1)}function Ze(v,C){var Q=v.C,J=C-Q,ce=v.V,we=v.Ba+v.c*Q;for(e(C<=v.l.o);0<J;){var Ne=16<J?16:J,Se=v.l.ma,Re=v.l.width,qe=Re*Ne,it=Se.ca,vt=Se.tb+Re*Q,Ge=v.Ta,lt=v.Ua;ne(v,Ne,ce,we),ZI(Ge,lt,it,vt,qe),Fe(Se,Q,Q+Ne,it,vt,Re),J-=Ne,ce+=Ne*v.c,Q+=Ne}e(Q==C),v.C=v.Ma=C}function Xe(){this.ub=this.yd=this.td=this.Rb=0}function Ye(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ze(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function rt(){this.Yb=function(){var v=[];return function C(Q,J,ce){for(var we=ce[J],Ne=0;Ne<we&&(Q.push(ce.length>J+1?[]:0),!(ce.length<J+1));Ne++)C(Q[Ne],J+1,ce)}(v,0,[3,11]),v}()}function dt(){this.jb=a(3),this.Wc=l([4,8],rt),this.Xc=l([4,17],rt)}function Mt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Kt(){this.ld=this.La=this.dd=this.tc=0}function xr(){this.Na=this.la=0}function Hn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Tn(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Kt),this.Y=0,this.ya=Array(new Tn),this.aa=0,this.l=new so}function Rs(){this.y=a(16),this.f=a(8),this.ea=a(8)}function no(){this.cb=this.a=0,this.sc="",this.m=new S,this.Od=new Xe,this.Kc=new Ye,this.ed=new Mt,this.Qa=new ze,this.Ic=this.$c=this.Aa=0,this.D=new wi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,S),this.ia=0,this.pb=o(4,Hn),this.Pa=new dt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Rs),this.Hd=0,this.rb=Array(new xr),this.sb=0,this.wa=Array(new Kt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Tn),this.L=this.aa=0,this.gd=l([4,2],Kt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Jn(v,C){return 0>v?0:v>C?C:v}function so(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function DA(){var v=new no;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Sm||(Sm=Pc)),v}function Kn(v,C,Q){return v.a==0&&(v.a=C,v.sc=Q,v.cb=0),0}function Yl(v,C,Q){return 3<=Q&&v[C+0]==157&&v[C+1]==1&&v[C+2]==42}function Ro(v,C){if(v==null)return 0;if(v.a=0,v.sc="OK",C==null)return Kn(v,2,"null VP8Io passed to VP8GetHeaders()");var Q=C.data,J=C.w,ce=C.ha;if(4>ce)return Kn(v,7,"Truncated header.");var we=Q[J+0]|Q[J+1]<<8|Q[J+2]<<16,Ne=v.Od;if(Ne.Rb=!(1&we),Ne.td=we>>1&7,Ne.yd=we>>4&1,Ne.ub=we>>5,3<Ne.td)return Kn(v,3,"Incorrect keyframe parameters.");if(!Ne.yd)return Kn(v,4,"Frame not displayable.");J+=3,ce-=3;var Se=v.Kc;if(Ne.Rb){if(7>ce)return Kn(v,7,"cannot parse picture header");if(!Yl(Q,J,ce))return Kn(v,3,"Bad code word");Se.c=16383&(Q[J+4]<<8|Q[J+3]),Se.Td=Q[J+4]>>6,Se.i=16383&(Q[J+6]<<8|Q[J+5]),Se.Ud=Q[J+6]>>6,J+=7,ce-=7,v.za=Se.c+15>>4,v.Ub=Se.i+15>>4,C.width=Se.c,C.height=Se.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,s((we=v.Pa).jb,0,255,we.jb.length),e((we=v.Qa)!=null),we.Cb=0,we.Bb=0,we.Fb=1,s(we.Zb,0,0,we.Zb.length),s(we.Lb,0,0,we.Lb)}if(Ne.ub>ce)return Kn(v,7,"bad partition length");ae(we=v.m,Q,J,Ne.ub),J+=Ne.ub,ce-=Ne.ub,Ne.Rb&&(Se.Ld=X(we),Se.Kd=X(we)),Se=v.Qa;var Re,qe=v.Pa;if(e(we!=null),e(Se!=null),Se.Cb=X(we),Se.Cb){if(Se.Bb=X(we),X(we)){for(Se.Fb=X(we),Re=0;4>Re;++Re)Se.Zb[Re]=X(we)?he(we,7):0;for(Re=0;4>Re;++Re)Se.Lb[Re]=X(we)?he(we,6):0}if(Se.Bb)for(Re=0;3>Re;++Re)qe.jb[Re]=X(we)?fe(we,8):255}else Se.Bb=0;if(we.Ka)return Kn(v,3,"cannot parse segment header");if((Se=v.ed).zd=X(we),Se.Tb=fe(we,6),Se.wb=fe(we,3),Se.Pc=X(we),Se.Pc&&X(we)){for(qe=0;4>qe;++qe)X(we)&&(Se.vd[qe]=he(we,6));for(qe=0;4>qe;++qe)X(we)&&(Se.od[qe]=he(we,6))}if(v.L=Se.Tb==0?0:Se.zd?1:2,we.Ka)return Kn(v,3,"cannot parse filter header");var it=ce;if(ce=Re=J,J=Re+it,Se=it,v.Xb=(1<<fe(v.m,2))-1,it<3*(qe=v.Xb))Q=7;else{for(Re+=3*qe,Se-=3*qe,it=0;it<qe;++it){var vt=Q[ce+0]|Q[ce+1]<<8|Q[ce+2]<<16;vt>Se&&(vt=Se),ae(v.Jc[+it],Q,Re,vt),Re+=vt,Se-=vt,ce+=3}ae(v.Jc[+qe],Q,Re,Se),Q=Re<J?0:5}if(Q!=0)return Kn(v,Q,"cannot parse partitions");for(Q=fe(Re=v.m,7),ce=X(Re)?he(Re,4):0,J=X(Re)?he(Re,4):0,Se=X(Re)?he(Re,4):0,qe=X(Re)?he(Re,4):0,Re=X(Re)?he(Re,4):0,it=v.Qa,vt=0;4>vt;++vt){if(it.Cb){var Ge=it.Zb[vt];it.Fb||(Ge+=Q)}else{if(0<vt){v.pb[vt]=v.pb[0];continue}Ge=Q}var lt=v.pb[vt];lt.Sc[0]=ib[Jn(Ge+ce,127)],lt.Sc[1]=ob[Jn(Ge+0,127)],lt.Eb[0]=2*ib[Jn(Ge+J,127)],lt.Eb[1]=101581*ob[Jn(Ge+Se,127)]>>16,8>lt.Eb[1]&&(lt.Eb[1]=8),lt.Qc[0]=ib[Jn(Ge+qe,117)],lt.Qc[1]=ob[Jn(Ge+Re,127)],lt.lc=Ge+Re}if(!Ne.Rb)return Kn(v,4,"Not a key frame.");for(X(we),Ne=v.Pa,Q=0;4>Q;++Q){for(ce=0;8>ce;++ce)for(J=0;3>J;++J)for(Se=0;11>Se;++Se)qe=se(we,_7[Q][ce][J][Se])?fe(we,8):N7[Q][ce][J][Se],Ne.Wc[Q][ce].Yb[J][Se]=qe;for(ce=0;17>ce;++ce)Ne.Xc[Q][ce]=Ne.Wc[Q][E7[ce]]}return v.kc=X(we),v.kc&&(v.Bd=fe(we,8)),v.cb=1}function Pc(v,C,Q,J,ce,we,Ne){var Se=C[ce].Yb[Q];for(Q=0;16>ce;++ce){if(!se(v,Se[Q+0]))return ce;for(;!se(v,Se[Q+1]);)if(Se=C[++ce].Yb[0],Q=0,ce==16)return 16;var Re=C[ce+1].Yb;if(se(v,Se[Q+2])){var qe=v,it=0;if(se(qe,(Ge=Se)[(vt=Q)+3]))if(se(qe,Ge[vt+6])){for(Se=0,vt=2*(it=se(qe,Ge[vt+8]))+(Ge=se(qe,Ge[vt+9+it])),it=0,Ge=w7[vt];Ge[Se];++Se)it+=it+se(qe,Ge[Se]);it+=3+(8<<vt)}else se(qe,Ge[vt+7])?(it=7+2*se(qe,165),it+=se(qe,145)):it=5+se(qe,159);else it=se(qe,Ge[vt+4])?3+se(qe,Ge[vt+5]):2;Se=Re[2]}else it=1,Se=Re[1];Re=Ne+b7[ce],0>(qe=v).b&&R(qe);var vt,Ge=qe.b,lt=(vt=qe.Ca>>1)-(qe.I>>Ge)>>31;--qe.b,qe.Ca+=lt,qe.Ca|=1,qe.I-=(vt+1&lt)<<Ge,we[Re]=((it^lt)-lt)*J[(0<ce)+0]}return 16}function Nd(v){var C=v.rb[v.sb-1];C.la=0,C.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function Mi(v,C,Q,J,ce){ce=v[C+Q+32*J]+(ce>>3),v[C+Q+32*J]=-256&ce?0>ce?0:255:ce}function Ln(v,C,Q,J,ce,we){Mi(v,C,0,Q,J+ce),Mi(v,C,1,Q,J+we),Mi(v,C,2,Q,J-we),Mi(v,C,3,Q,J-ce)}function ra(v){return(20091*v>>16)+v}function Rc(v,C,Q,J){var ce,we=0,Ne=a(16);for(ce=0;4>ce;++ce){var Se=v[C+0]+v[C+8],Re=v[C+0]-v[C+8],qe=(35468*v[C+4]>>16)-ra(v[C+12]),it=ra(v[C+4])+(35468*v[C+12]>>16);Ne[we+0]=Se+it,Ne[we+1]=Re+qe,Ne[we+2]=Re-qe,Ne[we+3]=Se-it,we+=4,C++}for(ce=we=0;4>ce;++ce)Se=(v=Ne[we+0]+4)+Ne[we+8],Re=v-Ne[we+8],qe=(35468*Ne[we+4]>>16)-ra(Ne[we+12]),Mi(Q,J,0,0,Se+(it=ra(Ne[we+4])+(35468*Ne[we+12]>>16))),Mi(Q,J,1,0,Re+qe),Mi(Q,J,2,0,Re-qe),Mi(Q,J,3,0,Se-it),we++,J+=32}function LA(v,C,Q,J){var ce=v[C+0]+4,we=35468*v[C+4]>>16,Ne=ra(v[C+4]),Se=35468*v[C+1]>>16;Ln(Q,J,0,ce+Ne,v=ra(v[C+1]),Se),Ln(Q,J,1,ce+we,v,Se),Ln(Q,J,2,ce-we,v,Se),Ln(Q,J,3,ce-Ne,v,Se)}function af(v,C,Q,J,ce){Rc(v,C,Q,J),ce&&Rc(v,C+16,Q,J+4)}function Yr(v,C,Q,J){kd(v,C+0,Q,J,1),kd(v,C+32,Q,J+128,1)}function Dc(v,C,Q,J){var ce;for(v=v[C+0]+4,ce=0;4>ce;++ce)for(C=0;4>C;++C)Mi(Q,J,C,ce,v)}function Zl(v,C,Q,J){v[C+0]&&xn(v,C+0,Q,J),v[C+16]&&xn(v,C+16,Q,J+4),v[C+32]&&xn(v,C+32,Q,J+128),v[C+48]&&xn(v,C+48,Q,J+128+4)}function Do(v,C,Q,J){var ce,we=a(16);for(ce=0;4>ce;++ce){var Ne=v[C+0+ce]+v[C+12+ce],Se=v[C+4+ce]+v[C+8+ce],Re=v[C+4+ce]-v[C+8+ce],qe=v[C+0+ce]-v[C+12+ce];we[0+ce]=Ne+Se,we[8+ce]=Ne-Se,we[4+ce]=qe+Re,we[12+ce]=qe-Re}for(ce=0;4>ce;++ce)Ne=(v=we[0+4*ce]+3)+we[3+4*ce],Se=we[1+4*ce]+we[2+4*ce],Re=we[1+4*ce]-we[2+4*ce],qe=v-we[3+4*ce],Q[J+0]=Ne+Se>>3,Q[J+16]=qe+Re>>3,Q[J+32]=Ne-Se>>3,Q[J+48]=qe-Re>>3,J+=64}function Lc(v,C,Q){var J,ce=C-32,we=co,Ne=255-v[ce-1];for(J=0;J<Q;++J){var Se,Re=we,qe=Ne+v[C-1];for(Se=0;Se<Q;++Se)v[C+Se]=Re[qe+v[ce+Se]];C+=32}}function of(v,C){Lc(v,C,4)}function hm(v,C){Lc(v,C,8)}function fm(v,C){Lc(v,C,16)}function Cd(v,C){var Q;for(Q=0;16>Q;++Q)n(v,C+32*Q,v,C-32,16)}function lf(v,C){var Q;for(Q=16;0<Q;--Q)s(v,C,v[C-1],16),C+=32}function Ta(v,C,Q){var J;for(J=0;16>J;++J)s(C,Q+32*J,v,16)}function Lo(v,C){var Q,J=16;for(Q=0;16>Q;++Q)J+=v[C-1+32*Q]+v[C+Q-32];Ta(J>>5,v,C)}function ec(v,C){var Q,J=8;for(Q=0;16>Q;++Q)J+=v[C-1+32*Q];Ta(J>>4,v,C)}function UA(v,C){var Q,J=8;for(Q=0;16>Q;++Q)J+=v[C+Q-32];Ta(J>>4,v,C)}function cf(v,C){Ta(128,v,C)}function br(v,C,Q){return v+2*C+Q+2>>2}function mm(v,C){var Q,J=C-32;for(J=new Uint8Array([br(v[J-1],v[J+0],v[J+1]),br(v[J+0],v[J+1],v[J+2]),br(v[J+1],v[J+2],v[J+3]),br(v[J+2],v[J+3],v[J+4])]),Q=0;4>Q;++Q)n(v,C+32*Q,J,0,J.length)}function pm(v,C){var Q=v[C-1],J=v[C-1+32],ce=v[C-1+64],we=v[C-1+96];ye(v,C+0,16843009*br(v[C-1-32],Q,J)),ye(v,C+32,16843009*br(Q,J,ce)),ye(v,C+64,16843009*br(J,ce,we)),ye(v,C+96,16843009*br(ce,we,we))}function gm(v,C){var Q,J=4;for(Q=0;4>Q;++Q)J+=v[C+Q-32]+v[C-1+32*Q];for(J>>=3,Q=0;4>Q;++Q)s(v,C+32*Q,J,4)}function va(v,C){var Q=v[C-1+0],J=v[C-1+32],ce=v[C-1+64],we=v[C-1-32],Ne=v[C+0-32],Se=v[C+1-32],Re=v[C+2-32],qe=v[C+3-32];v[C+0+96]=br(J,ce,v[C-1+96]),v[C+1+96]=v[C+0+64]=br(Q,J,ce),v[C+2+96]=v[C+1+64]=v[C+0+32]=br(we,Q,J),v[C+3+96]=v[C+2+64]=v[C+1+32]=v[C+0+0]=br(Ne,we,Q),v[C+3+64]=v[C+2+32]=v[C+1+0]=br(Se,Ne,we),v[C+3+32]=v[C+2+0]=br(Re,Se,Ne),v[C+3+0]=br(qe,Re,Se)}function xl(v,C){var Q=v[C+1-32],J=v[C+2-32],ce=v[C+3-32],we=v[C+4-32],Ne=v[C+5-32],Se=v[C+6-32],Re=v[C+7-32];v[C+0+0]=br(v[C+0-32],Q,J),v[C+1+0]=v[C+0+32]=br(Q,J,ce),v[C+2+0]=v[C+1+32]=v[C+0+64]=br(J,ce,we),v[C+3+0]=v[C+2+32]=v[C+1+64]=v[C+0+96]=br(ce,we,Ne),v[C+3+32]=v[C+2+64]=v[C+1+96]=br(we,Ne,Se),v[C+3+64]=v[C+2+96]=br(Ne,Se,Re),v[C+3+96]=br(Se,Re,Re)}function xm(v,C){var Q=v[C-1+0],J=v[C-1+32],ce=v[C-1+64],we=v[C-1-32],Ne=v[C+0-32],Se=v[C+1-32],Re=v[C+2-32],qe=v[C+3-32];v[C+0+0]=v[C+1+64]=we+Ne+1>>1,v[C+1+0]=v[C+2+64]=Ne+Se+1>>1,v[C+2+0]=v[C+3+64]=Se+Re+1>>1,v[C+3+0]=Re+qe+1>>1,v[C+0+96]=br(ce,J,Q),v[C+0+64]=br(J,Q,we),v[C+0+32]=v[C+1+96]=br(Q,we,Ne),v[C+1+32]=v[C+2+96]=br(we,Ne,Se),v[C+2+32]=v[C+3+96]=br(Ne,Se,Re),v[C+3+32]=br(Se,Re,qe)}function OA(v,C){var Q=v[C+0-32],J=v[C+1-32],ce=v[C+2-32],we=v[C+3-32],Ne=v[C+4-32],Se=v[C+5-32],Re=v[C+6-32],qe=v[C+7-32];v[C+0+0]=Q+J+1>>1,v[C+1+0]=v[C+0+64]=J+ce+1>>1,v[C+2+0]=v[C+1+64]=ce+we+1>>1,v[C+3+0]=v[C+2+64]=we+Ne+1>>1,v[C+0+32]=br(Q,J,ce),v[C+1+32]=v[C+0+96]=br(J,ce,we),v[C+2+32]=v[C+1+96]=br(ce,we,Ne),v[C+3+32]=v[C+2+96]=br(we,Ne,Se),v[C+3+64]=br(Ne,Se,Re),v[C+3+96]=br(Se,Re,qe)}function vl(v,C){var Q=v[C-1+0],J=v[C-1+32],ce=v[C-1+64],we=v[C-1+96];v[C+0+0]=Q+J+1>>1,v[C+2+0]=v[C+0+32]=J+ce+1>>1,v[C+2+32]=v[C+0+64]=ce+we+1>>1,v[C+1+0]=br(Q,J,ce),v[C+3+0]=v[C+1+32]=br(J,ce,we),v[C+3+32]=v[C+1+64]=br(ce,we,we),v[C+3+64]=v[C+2+64]=v[C+0+96]=v[C+1+96]=v[C+2+96]=v[C+3+96]=we}function MA(v,C){var Q=v[C-1+0],J=v[C-1+32],ce=v[C-1+64],we=v[C-1+96],Ne=v[C-1-32],Se=v[C+0-32],Re=v[C+1-32],qe=v[C+2-32];v[C+0+0]=v[C+2+32]=Q+Ne+1>>1,v[C+0+32]=v[C+2+64]=J+Q+1>>1,v[C+0+64]=v[C+2+96]=ce+J+1>>1,v[C+0+96]=we+ce+1>>1,v[C+3+0]=br(Se,Re,qe),v[C+2+0]=br(Ne,Se,Re),v[C+1+0]=v[C+3+32]=br(Q,Ne,Se),v[C+1+32]=v[C+3+64]=br(J,Q,Ne),v[C+1+64]=v[C+3+96]=br(ce,J,Q),v[C+1+96]=br(we,ce,J)}function ao(v,C){var Q;for(Q=0;8>Q;++Q)n(v,C+32*Q,v,C-32,8)}function Uc(v,C){var Q;for(Q=0;8>Q;++Q)s(v,C,v[C-1],8),C+=32}function Uo(v,C,Q){var J;for(J=0;8>J;++J)s(C,Q+32*J,v,8)}function _d(v,C){var Q,J=8;for(Q=0;8>Q;++Q)J+=v[C+Q-32]+v[C-1+32*Q];Uo(J>>4,v,C)}function jn(v,C){var Q,J=4;for(Q=0;8>Q;++Q)J+=v[C+Q-32];Uo(J>>3,v,C)}function Ed(v,C){var Q,J=4;for(Q=0;8>Q;++Q)J+=v[C-1+32*Q];Uo(J>>3,v,C)}function Af(v,C){Uo(128,v,C)}function Oo(v,C,Q){var J=v[C-Q],ce=v[C+0],we=3*(ce-J)+tb[1020+v[C-2*Q]-v[C+Q]],Ne=Jx[112+(we+4>>3)];v[C-Q]=co[255+J+Jx[112+(we+3>>3)]],v[C+0]=co[255+ce-Ne]}function QA(v,C,Q,J){var ce=v[C+0],we=v[C+Q];return qo[255+v[C-2*Q]-v[C-Q]]>J||qo[255+we-ce]>J}function Oc(v,C,Q,J){return 4*qo[255+v[C-Q]-v[C+0]]+qo[255+v[C-2*Q]-v[C+Q]]<=J}function tc(v,C,Q,J,ce){var we=v[C-3*Q],Ne=v[C-2*Q],Se=v[C-Q],Re=v[C+0],qe=v[C+Q],it=v[C+2*Q],vt=v[C+3*Q];return 4*qo[255+Se-Re]+qo[255+Ne-qe]>J?0:qo[255+v[C-4*Q]-we]<=ce&&qo[255+we-Ne]<=ce&&qo[255+Ne-Se]<=ce&&qo[255+vt-it]<=ce&&qo[255+it-qe]<=ce&&qo[255+qe-Re]<=ce}function rc(v,C,Q,J){var ce=2*J+1;for(J=0;16>J;++J)Oc(v,C+J,Q,ce)&&Oo(v,C+J,Q)}function bi(v,C,Q,J){var ce=2*J+1;for(J=0;16>J;++J)Oc(v,C+J*Q,1,ce)&&Oo(v,C+J*Q,1)}function Bd(v,C,Q,J){var ce;for(ce=3;0<ce;--ce)rc(v,C+=4*Q,Q,J)}function uf(v,C,Q,J){var ce;for(ce=3;0<ce;--ce)bi(v,C+=4,Q,J)}function Ni(v,C,Q,J,ce,we,Ne,Se){for(we=2*we+1;0<ce--;){if(tc(v,C,Q,we,Ne))if(QA(v,C,Q,Se))Oo(v,C,Q);else{var Re=v,qe=C,it=Q,vt=Re[qe-2*it],Ge=Re[qe-it],lt=Re[qe+0],pt=Re[qe+it],Et=Re[qe+2*it],xt=27*(Ft=tb[1020+3*(lt-Ge)+tb[1020+vt-pt]])+63>>7,It=18*Ft+63>>7,Ft=9*Ft+63>>7;Re[qe-3*it]=co[255+Re[qe-3*it]+Ft],Re[qe-2*it]=co[255+vt+It],Re[qe-it]=co[255+Ge+xt],Re[qe+0]=co[255+lt-xt],Re[qe+it]=co[255+pt-It],Re[qe+2*it]=co[255+Et-Ft]}C+=J}}function Mo(v,C,Q,J,ce,we,Ne,Se){for(we=2*we+1;0<ce--;){if(tc(v,C,Q,we,Ne))if(QA(v,C,Q,Se))Oo(v,C,Q);else{var Re=v,qe=C,it=Q,vt=Re[qe-it],Ge=Re[qe+0],lt=Re[qe+it],pt=Jx[112+(4+(Et=3*(Ge-vt))>>3)],Et=Jx[112+(Et+3>>3)],xt=pt+1>>1;Re[qe-2*it]=co[255+Re[qe-2*it]+xt],Re[qe-it]=co[255+vt+Et],Re[qe+0]=co[255+Ge-pt],Re[qe+it]=co[255+lt-xt]}C+=J}}function VA(v,C,Q,J,ce,we){Ni(v,C,Q,1,16,J,ce,we)}function Qo(v,C,Q,J,ce,we){Ni(v,C,1,Q,16,J,ce,we)}function Sd(v,C,Q,J,ce,we){var Ne;for(Ne=3;0<Ne;--Ne)Mo(v,C+=4*Q,Q,1,16,J,ce,we)}function D(v,C,Q,J,ce,we){var Ne;for(Ne=3;0<Ne;--Ne)Mo(v,C+=4,1,Q,16,J,ce,we)}function le(v,C,Q,J,ce,we,Ne,Se){Ni(v,C,ce,1,8,we,Ne,Se),Ni(Q,J,ce,1,8,we,Ne,Se)}function Ke(v,C,Q,J,ce,we,Ne,Se){Ni(v,C,1,ce,8,we,Ne,Se),Ni(Q,J,1,ce,8,we,Ne,Se)}function tt(v,C,Q,J,ce,we,Ne,Se){Mo(v,C+4*ce,ce,1,8,we,Ne,Se),Mo(Q,J+4*ce,ce,1,8,we,Ne,Se)}function ht(v,C,Q,J,ce,we,Ne,Se){Mo(v,C+4,1,ce,8,we,Ne,Se),Mo(Q,J+4,1,ce,8,we,Ne,Se)}function St(){this.ba=new ot,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Pt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ir(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function hr(){this.ua=0,this.Wa=new oe,this.vb=new oe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new me,this.yc=new O}function Nr(){this.xb=this.a=0,this.l=new so,this.ca=new ot,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new I,this.Pb=0,this.wd=new I,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new hr,this.ab=0,this.gc=o(4,ir),this.Oc=0}function kr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new so,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Zr(v,C,Q,J,ce,we,Ne){for(v=v==null?0:v[C+0],C=0;C<Ne;++C)ce[we+C]=v+Q[J+C]&255,v=ce[we+C]}function gn(v,C,Q,J,ce,we,Ne){var Se;if(v==null)Zr(null,null,Q,J,ce,we,Ne);else for(Se=0;Se<Ne;++Se)ce[we+Se]=v[C+Se]+Q[J+Se]&255}function ms(v,C,Q,J,ce,we,Ne){if(v==null)Zr(null,null,Q,J,ce,we,Ne);else{var Se,Re=v[C+0],qe=Re,it=Re;for(Se=0;Se<Ne;++Se)qe=it+(Re=v[C+Se])-qe,it=Q[J+Se]+(-256&qe?0>qe?0:255:qe)&255,qe=Re,ce[we+Se]=it}}function yn(v,C,Q,J){var ce=C.width,we=C.o;if(e(v!=null&&C!=null),0>Q||0>=J||Q+J>we)return null;if(!v.Cc){if(v.ga==null){var Ne;if(v.ga=new kr,(Ne=v.ga==null)||(Ne=C.width*C.o,e(v.Gb.length==0),v.Gb=a(Ne),v.Uc=0,v.Gb==null?Ne=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Ne=1),Ne=!Ne),!Ne){Ne=v.ga;var Se=v.Fa,Re=v.P,qe=v.qc,it=v.mb,vt=v.nb,Ge=Re+1,lt=qe-1,pt=Ne.l;if(e(Se!=null&&it!=null&&C!=null),XA[0]=null,XA[1]=Zr,XA[2]=gn,XA[3]=ms,Ne.ca=it,Ne.tb=vt,Ne.c=C.width,Ne.i=C.height,e(0<Ne.c&&0<Ne.i),1>=qe)C=0;else if(Ne.$a=3&Se[Re+0],Ne.Z=Se[Re+0]>>2&3,Ne.Lc=Se[Re+0]>>4&3,Re=Se[Re+0]>>6&3,0>Ne.$a||1<Ne.$a||4<=Ne.Z||1<Ne.Lc||Re)C=0;else if(pt.put=et,pt.ac=tr,pt.bc=gt,pt.ma=Ne,pt.width=C.width,pt.height=C.height,pt.Da=C.Da,pt.v=C.v,pt.va=C.va,pt.j=C.j,pt.o=C.o,Ne.$a)e:{e(Ne.$a==1),C=Ae();t:for(;;){if(C==null){C=0;break e}if(e(Ne!=null),Ne.mc=C,C.c=Ne.c,C.i=Ne.i,C.l=Ne.l,C.l.ma=Ne,C.l.width=Ne.c,C.l.height=Ne.i,C.a=0,te(C.m,Se,Ge,lt),!Pe(Ne.c,Ne.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&xe(C.s)?(Ne.ic=1,Se=C.c*C.i,C.Ta=null,C.Ua=0,C.V=a(Se),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(Ne.ic=0,C=Ce(C,Ne.c)),!C))break t;C=1;break e}Ne.mc=null,C=0}else C=lt>=Ne.c*Ne.i;Ne=!C}if(Ne)return null;v.ga.Lc!=1?v.Ga=0:J=we-Q}e(v.ga!=null),e(Q+J<=we);e:{if(C=(Se=v.ga).c,we=Se.l.o,Se.$a==0){if(Ge=v.rc,lt=v.Vc,pt=v.Fa,Re=v.P+1+Q*C,qe=v.mb,it=v.nb+Q*C,e(Re<=v.P+v.qc),Se.Z!=0)for(e(XA[Se.Z]!=null),Ne=0;Ne<J;++Ne)XA[Se.Z](Ge,lt,pt,Re,qe,it,C),Ge=qe,lt=it,it+=C,Re+=C;else for(Ne=0;Ne<J;++Ne)n(qe,it,pt,Re,C),Ge=qe,lt=it,it+=C,Re+=C;v.rc=Ge,v.Vc=lt}else{if(e(Se.mc!=null),C=Q+J,e((Ne=Se.mc)!=null),e(C<=Ne.i),Ne.C>=C)C=1;else if(Se.ic||Qi(),Se.ic){Se=Ne.V,Ge=Ne.Ba,lt=Ne.c;var Et=Ne.i,xt=(pt=1,Re=Ne.$/lt,qe=Ne.$%lt,it=Ne.m,vt=Ne.s,Ne.$),It=lt*Et,Ft=lt*C,Qt=vt.wc,Ut=xt<Ft?ie(vt,qe,Re):null;e(xt<=It),e(C<=Et),e(xe(vt));t:for(;;){for(;!it.h&&xt<Ft;){if(qe&Qt||(Ut=ie(vt,qe,Re)),e(Ut!=null),G(it),256>(Et=Zt(Ut.G[0],Ut.H[0],it)))Se[Ge+xt]=Et,++xt,++qe>=lt&&(qe=0,++Re<=C&&!(Re%16)&&De(Ne,Re));else{if(!(280>Et)){pt=0;break t}Et=kt(Et-256,it);var gr,Ar=Zt(Ut.G[4],Ut.H[4],it);if(G(it),!(xt>=(Ar=jt(lt,Ar=kt(Ar,it)))&&It-xt>=Et)){pt=0;break t}for(gr=0;gr<Et;++gr)Se[Ge+xt+gr]=Se[Ge+xt+gr-Ar];for(xt+=Et,qe+=Et;qe>=lt;)qe-=lt,++Re<=C&&!(Re%16)&&De(Ne,Re);xt<Ft&&qe&Qt&&(Ut=ie(vt,qe,Re))}e(it.h==j(it))}De(Ne,Re>C?C:Re);break t}!pt||it.h&&xt<It?(pt=0,Ne.a=it.h?5:3):Ne.$=xt,C=pt}else C=ee(Ne,Ne.V,Ne.Ba,Ne.c,Ne.i,C,Ze);if(!C){J=0;break e}}Q+J>=we&&(v.Cc=1),J=1}if(!J)return null;if(v.Cc&&((J=v.ga)!=null&&(J.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+Q*ce}function _s(v,C,Q,J,ce,we){for(;0<ce--;){var Ne,Se=v,Re=C+(Q?1:0),qe=v,it=C+(Q?0:3);for(Ne=0;Ne<J;++Ne){var vt=qe[it+4*Ne];vt!=255&&(vt*=32897,Se[Re+4*Ne+0]=Se[Re+4*Ne+0]*vt>>23,Se[Re+4*Ne+1]=Se[Re+4*Ne+1]*vt>>23,Se[Re+4*Ne+2]=Se[Re+4*Ne+2]*vt>>23)}C+=we}}function ps(v,C,Q,J,ce){for(;0<J--;){var we;for(we=0;we<Q;++we){var Ne=v[C+2*we+0],Se=15&(qe=v[C+2*we+1]),Re=4369*Se,qe=(240&qe|qe>>4)*Re>>16;v[C+2*we+0]=(240&Ne|Ne>>4)*Re>>16&240|(15&Ne|Ne<<4)*Re>>16>>4&15,v[C+2*we+1]=240&qe|Se}C+=ce}}function Es(v,C,Q,J,ce,we,Ne,Se){var Re,qe,it=255;for(qe=0;qe<ce;++qe){for(Re=0;Re<J;++Re){var vt=v[C+Re];we[Ne+4*Re]=vt,it&=vt}C+=Q,Ne+=Se}return it!=255}function gs(v,C,Q,J,ce){var we;for(we=0;we<ce;++we)Q[J+we]=v[C+we]>>8}function Qi(){Bm=_s,XI=ps,YI=Es,ZI=gs}function Vo(v,C,Q){B[v]=function(J,ce,we,Ne,Se,Re,qe,it,vt,Ge,lt,pt,Et,xt,It,Ft,Qt){var Ut,gr=Qt-1>>1,Ar=Se[Re+0]|qe[it+0]<<16,Ur=vt[Ge+0]|lt[pt+0]<<16;e(J!=null);var fr=3*Ar+Ur+131074>>2;for(C(J[ce+0],255&fr,fr>>16,Et,xt),we!=null&&(fr=3*Ur+Ar+131074>>2,C(we[Ne+0],255&fr,fr>>16,It,Ft)),Ut=1;Ut<=gr;++Ut){var an=Se[Re+Ut]|qe[it+Ut]<<16,sa=vt[Ge+Ut]|lt[pt+Ut]<<16,Or=Ar+an+Ur+sa+524296,mr=Or+2*(an+Ur)>>3;fr=mr+Ar>>1,Ar=(Or=Or+2*(Ar+sa)>>3)+an>>1,C(J[ce+2*Ut-1],255&fr,fr>>16,Et,xt+(2*Ut-1)*Q),C(J[ce+2*Ut-0],255&Ar,Ar>>16,Et,xt+(2*Ut-0)*Q),we!=null&&(fr=Or+Ur>>1,Ar=mr+sa>>1,C(we[Ne+2*Ut-1],255&fr,fr>>16,It,Ft+(2*Ut-1)*Q),C(we[Ne+2*Ut+0],255&Ar,Ar>>16,It,Ft+(2*Ut+0)*Q)),Ar=an,Ur=sa}1&Qt||(fr=3*Ar+Ur+131074>>2,C(J[ce+Qt-1],255&fr,fr>>16,Et,xt+(Qt-1)*Q),we!=null&&(fr=3*Ur+Ar+131074>>2,C(we[Ne+Qt-1],255&fr,fr>>16,It,Ft+(Qt-1)*Q)))}}function Ho(){Go[Xx]=S7,Go[Yx]=A5,Go[a5]=I7,Go[Zx]=u5,Go[ev]=d5,Go[rb]=h5,Go[i5]=F7,Go[nb]=A5,Go[sb]=u5,Go[tv]=d5,Go[ab]=h5}function y(v){return v&-16384?0>v?0:255:v>>k7}function H(v,C){return y((19077*v>>8)+(26149*C>>8)-14234)}function Z(v,C,Q){return y((19077*v>>8)-(6419*C>>8)-(13320*Q>>8)+8708)}function ke(v,C){return y((19077*v>>8)+(33050*C>>8)-17685)}function ft(v,C,Q,J,ce){J[ce+0]=H(v,Q),J[ce+1]=Z(v,C,Q),J[ce+2]=ke(v,C)}function bt(v,C,Q,J,ce){J[ce+0]=ke(v,C),J[ce+1]=Z(v,C,Q),J[ce+2]=H(v,Q)}function zt(v,C,Q,J,ce){var we=Z(v,C,Q);C=we<<3&224|ke(v,C)>>3,J[ce+0]=248&H(v,Q)|we>>5,J[ce+1]=C}function sn(v,C,Q,J,ce){var we=240&ke(v,C)|15;J[ce+0]=240&H(v,Q)|Z(v,C,Q)>>4,J[ce+1]=we}function xs(v,C,Q,J,ce){J[ce+0]=255,ft(v,C,Q,J,ce+1)}function qr(v,C,Q,J,ce){bt(v,C,Q,J,ce),J[ce+3]=255}function fn(v,C,Q,J,ce){ft(v,C,Q,J,ce),J[ce+3]=255}function qn(v,C,Q){B[v]=function(J,ce,we,Ne,Se,Re,qe,it,vt){for(var Ge=it+(-2&vt)*Q;it!=Ge;)C(J[ce+0],we[Ne+0],Se[Re+0],qe,it),C(J[ce+1],we[Ne+0],Se[Re+0],qe,it+Q),ce+=2,++Ne,++Re,it+=2*Q;1&vt&&C(J[ce+0],we[Ne+0],Se[Re+0],qe,it)}}function io(v,C,Q){return Q==0?v==0?C==0?6:5:C==0?4:0:Q}function Ya(v,C,Q,J,ce){switch(v>>>30){case 3:kd(C,Q,J,ce,0);break;case 2:Ko(C,Q,J,ce);break;case 1:xn(C,Q,J,ce)}}function ja(v,C){var Q,J,ce=C.M,we=C.Nb,Ne=v.oc,Se=v.pc+40,Re=v.oc,qe=v.pc+584,it=v.oc,vt=v.pc+600;for(Q=0;16>Q;++Q)Ne[Se+32*Q-1]=129;for(Q=0;8>Q;++Q)Re[qe+32*Q-1]=129,it[vt+32*Q-1]=129;for(0<ce?Ne[Se-1-32]=Re[qe-1-32]=it[vt-1-32]=129:(s(Ne,Se-32-1,127,21),s(Re,qe-32-1,127,9),s(it,vt-32-1,127,9)),J=0;J<v.za;++J){var Ge=C.ya[C.aa+J];if(0<J){for(Q=-1;16>Q;++Q)n(Ne,Se+32*Q-4,Ne,Se+32*Q+12,4);for(Q=-1;8>Q;++Q)n(Re,qe+32*Q-4,Re,qe+32*Q+4,4),n(it,vt+32*Q-4,it,vt+32*Q+4,4)}var lt=v.Gd,pt=v.Hd+J,Et=Ge.ad,xt=Ge.Hc;if(0<ce&&(n(Ne,Se-32,lt[pt].y,0,16),n(Re,qe-32,lt[pt].f,0,8),n(it,vt-32,lt[pt].ea,0,8)),Ge.Za){var It=Ne,Ft=Se-32+16;for(0<ce&&(J>=v.za-1?s(It,Ft,lt[pt].y[15],4):n(It,Ft,lt[pt+1].y,0,4)),Q=0;4>Q;Q++)It[Ft+128+Q]=It[Ft+256+Q]=It[Ft+384+Q]=It[Ft+0+Q];for(Q=0;16>Q;++Q,xt<<=2)It=Ne,Ft=Se+m5[Q],wl[Ge.Ob[Q]](It,Ft),Ya(xt,Et,16*+Q,It,Ft)}else if(It=io(J,ce,Ge.Ob[0]),JA[It](Ne,Se),xt!=0)for(Q=0;16>Q;++Q,xt<<=2)Ya(xt,Et,16*+Q,Ne,Se+m5[Q]);for(Q=Ge.Gc,It=io(J,ce,Ge.Dd),Vc[It](Re,qe),Vc[It](it,vt),xt=Et,It=Re,Ft=qe,255&(Ge=0|Q)&&(170&Ge?ac(xt,256,It,Ft):Un(xt,256,It,Ft)),Ge=it,xt=vt,255&(Q>>=8)&&(170&Q?ac(Et,320,Ge,xt):Un(Et,320,Ge,xt)),ce<v.Ub-1&&(n(lt[pt].y,0,Ne,Se+480,16),n(lt[pt].f,0,Re,qe+224,8),n(lt[pt].ea,0,it,vt+224,8)),Q=8*we*v.B,lt=v.sa,pt=v.ta+16*J+16*we*v.R,Et=v.qa,Ge=v.ra+8*J+Q,xt=v.Ha,It=v.Ia+8*J+Q,Q=0;16>Q;++Q)n(lt,pt+Q*v.R,Ne,Se+32*Q,16);for(Q=0;8>Q;++Q)n(Et,Ge+Q*v.B,Re,qe+32*Q,8),n(xt,It+Q*v.B,it,vt+32*Q,8)}}function yl(v,C,Q,J,ce,we,Ne,Se,Re){var qe=[0],it=[0],vt=0,Ge=Re!=null?Re.kd:0,lt=Re??new Pt;if(v==null||12>Q)return 7;lt.data=v,lt.w=C,lt.ha=Q,C=[C],Q=[Q],lt.gb=[lt.gb];e:{var pt=C,Et=Q,xt=lt.gb;if(e(v!=null),e(Et!=null),e(xt!=null),xt[0]=0,12<=Et[0]&&!r(v,pt[0],"RIFF")){if(r(v,pt[0]+8,"WEBP")){xt=3;break e}var It=re(v,pt[0]+4);if(12>It||4294967286<It){xt=3;break e}if(Ge&&It>Et[0]-8){xt=7;break e}xt[0]=It,pt[0]+=12,Et[0]-=12}xt=0}if(xt!=0)return xt;for(It=0<lt.gb[0],Q=Q[0];;){e:{var Ft=v;Et=C,xt=Q;var Qt=qe,Ut=it,gr=pt=[0];if((fr=vt=[vt])[0]=0,8>xt[0])xt=7;else{if(!r(Ft,Et[0],"VP8X")){if(re(Ft,Et[0]+4)!=10){xt=3;break e}if(18>xt[0]){xt=7;break e}var Ar=re(Ft,Et[0]+8),Ur=1+Me(Ft,Et[0]+12);if(2147483648<=Ur*(Ft=1+Me(Ft,Et[0]+15))){xt=3;break e}gr!=null&&(gr[0]=Ar),Qt!=null&&(Qt[0]=Ur),Ut!=null&&(Ut[0]=Ft),Et[0]+=18,xt[0]-=18,fr[0]=1}xt=0}}if(vt=vt[0],pt=pt[0],xt!=0)return xt;if(Et=!!(2&pt),!It&&vt)return 3;if(we!=null&&(we[0]=!!(16&pt)),Ne!=null&&(Ne[0]=Et),Se!=null&&(Se[0]=0),Ne=qe[0],pt=it[0],vt&&Et&&Re==null){xt=0;break}if(4>Q){xt=7;break}if(It&&vt||!It&&!vt&&!r(v,C[0],"ALPH")){Q=[Q],lt.na=[lt.na],lt.P=[lt.P],lt.Sa=[lt.Sa];e:{Ar=v,xt=C,It=Q;var fr=lt.gb;Qt=lt.na,Ut=lt.P,gr=lt.Sa,Ur=22,e(Ar!=null),e(It!=null),Ft=xt[0];var an=It[0];for(e(Qt!=null),e(gr!=null),Qt[0]=null,Ut[0]=null,gr[0]=0;;){if(xt[0]=Ft,It[0]=an,8>an){xt=7;break e}var sa=re(Ar,Ft+4);if(4294967286<sa){xt=3;break e}var Or=8+sa+1&-2;if(Ur+=Or,0<fr&&Ur>fr){xt=3;break e}if(!r(Ar,Ft,"VP8 ")||!r(Ar,Ft,"VP8L")){xt=0;break e}if(an[0]<Or){xt=7;break e}r(Ar,Ft,"ALPH")||(Qt[0]=Ar,Ut[0]=Ft+8,gr[0]=sa),Ft+=Or,an-=Or}}if(Q=Q[0],lt.na=lt.na[0],lt.P=lt.P[0],lt.Sa=lt.Sa[0],xt!=0)break}Q=[Q],lt.Ja=[lt.Ja],lt.xa=[lt.xa];e:if(fr=v,xt=C,It=Q,Qt=lt.gb[0],Ut=lt.Ja,gr=lt.xa,Ar=xt[0],Ft=!r(fr,Ar,"VP8 "),Ur=!r(fr,Ar,"VP8L"),e(fr!=null),e(It!=null),e(Ut!=null),e(gr!=null),8>It[0])xt=7;else{if(Ft||Ur){if(fr=re(fr,Ar+4),12<=Qt&&fr>Qt-12){xt=3;break e}if(Ge&&fr>It[0]-8){xt=7;break e}Ut[0]=fr,xt[0]+=8,It[0]-=8,gr[0]=Ur}else gr[0]=5<=It[0]&&fr[Ar+0]==47&&!(fr[Ar+4]>>5),Ut[0]=It[0];xt=0}if(Q=Q[0],lt.Ja=lt.Ja[0],lt.xa=lt.xa[0],C=C[0],xt!=0)break;if(4294967286<lt.Ja)return 3;if(Se==null||Et||(Se[0]=lt.xa?2:1),Ne=[Ne],pt=[pt],lt.xa){if(5>Q){xt=7;break}Se=Ne,Ge=pt,Et=we,v==null||5>Q?v=0:5<=Q&&v[C+0]==47&&!(v[C+4]>>5)?(It=[0],fr=[0],Qt=[0],te(Ut=new I,v,C,Q),Rt(Ut,It,fr,Qt)?(Se!=null&&(Se[0]=It[0]),Ge!=null&&(Ge[0]=fr[0]),Et!=null&&(Et[0]=Qt[0]),v=1):v=0):v=0}else{if(10>Q){xt=7;break}Se=pt,v==null||10>Q||!Yl(v,C+3,Q-3)?v=0:(Ge=v[C+0]|v[C+1]<<8|v[C+2]<<16,Et=16383&(v[C+7]<<8|v[C+6]),v=16383&(v[C+9]<<8|v[C+8]),1&Ge||3<(Ge>>1&7)||!(Ge>>4&1)||Ge>>5>=lt.Ja||!Et||!v?v=0:(Ne&&(Ne[0]=Et),Se&&(Se[0]=v),v=1))}if(!v||(Ne=Ne[0],pt=pt[0],vt&&(qe[0]!=Ne||it[0]!=pt)))return 3;Re!=null&&(Re[0]=lt,Re.offset=C-Re.w,e(4294967286>C-Re.w),e(Re.offset==Re.ha-Q));break}return xt==0||xt==7&&vt&&Re==null?(we!=null&&(we[0]|=lt.na!=null&&0<lt.na.length),J!=null&&(J[0]=Ne),ce!=null&&(ce[0]=pt),0):xt}function vm(v,C,Q){var J=C.width,ce=C.height,we=0,Ne=0,Se=J,Re=ce;if(C.Da=v!=null&&0<v.Da,C.Da&&(Se=v.cd,Re=v.bd,we=v.v,Ne=v.j,11>Q||(we&=-2,Ne&=-2),0>we||0>Ne||0>=Se||0>=Re||we+Se>J||Ne+Re>ce))return 0;if(C.v=we,C.j=Ne,C.va=we+Se,C.o=Ne+Re,C.U=Se,C.T=Re,C.da=v!=null&&0<v.da,C.da){if(!de(Se,Re,Q=[v.ib],we=[v.hb]))return 0;C.ib=Q[0],C.hb=we[0]}return C.ob=v!=null&&v.ob,C.Kb=v==null||!v.Sd,C.da&&(C.ob=C.ib<3*J/4&&C.hb<3*ce/4,C.Kb=0),1}function ym(v){if(v==null)return 2;if(11>v.S){var C=v.f.RGBA;C.fb+=(v.height-1)*C.A,C.A=-C.A}else C=v.f.kb,v=v.height,C.O+=(v-1)*C.fa,C.fa=-C.fa,C.N+=(v-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(v-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(v-1)*C.lb,C.lb=-C.lb);return 0}function HA(v,C,Q,J){if(J==null||0>=v||0>=C)return 2;if(Q!=null){if(Q.Da){var ce=Q.cd,we=Q.bd,Ne=-2&Q.v,Se=-2&Q.j;if(0>Ne||0>Se||0>=ce||0>=we||Ne+ce>v||Se+we>C)return 2;v=ce,C=we}if(Q.da){if(!de(v,C,ce=[Q.ib],we=[Q.hb]))return 2;v=ce[0],C=we[0]}}J.width=v,J.height=C;e:{var Re=J.width,qe=J.height;if(v=J.S,0>=Re||0>=qe||!(v>=Xx&&13>v))v=2;else{if(0>=J.Rd&&J.sd==null){Ne=we=ce=C=0;var it=(Se=Re*p5[v])*qe;if(11>v||(we=(qe+1)/2*(C=(Re+1)/2),v==12&&(Ne=(ce=Re)*qe)),(qe=a(it+2*we+Ne))==null){v=1;break e}J.sd=qe,11>v?((Re=J.f.RGBA).eb=qe,Re.fb=0,Re.A=Se,Re.size=it):((Re=J.f.kb).y=qe,Re.O=0,Re.fa=Se,Re.Fd=it,Re.f=qe,Re.N=0+it,Re.Ab=C,Re.Cd=we,Re.ea=qe,Re.W=0+it+we,Re.Db=C,Re.Ed=we,v==12&&(Re.F=qe,Re.J=0+it+2*we),Re.Tc=Ne,Re.lb=ce)}if(C=1,ce=J.S,we=J.width,Ne=J.height,ce>=Xx&&13>ce)if(11>ce)v=J.f.RGBA,C&=(Se=Math.abs(v.A))*(Ne-1)+we<=v.size,C&=Se>=we*p5[ce],C&=v.eb!=null;else{v=J.f.kb,Se=(we+1)/2,it=(Ne+1)/2,Re=Math.abs(v.fa),qe=Math.abs(v.Ab);var vt=Math.abs(v.Db),Ge=Math.abs(v.lb),lt=Ge*(Ne-1)+we;C&=Re*(Ne-1)+we<=v.Fd,C&=qe*(it-1)+Se<=v.Cd,C=(C&=vt*(it-1)+Se<=v.Ed)&Re>=we&qe>=Se&vt>=Se,C&=v.y!=null,C&=v.f!=null,C&=v.ea!=null,ce==12&&(C&=Ge>=we,C&=lt<=v.Tc,C&=v.F!=null)}else C=0;v=C?0:2}}return v!=0||Q!=null&&Q.fd&&(v=ym(J)),v}var Id=64,oo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],lo=24,KA=32,Mc=8,qA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];$e("Predictor0","PredictorAdd0"),B.Predictor0=function(){return 4278190080},B.Predictor1=function(v){return v},B.Predictor2=function(v,C,Q){return C[Q+0]},B.Predictor3=function(v,C,Q){return C[Q+1]},B.Predictor4=function(v,C,Q){return C[Q-1]},B.Predictor5=function(v,C,Q){return ct(ct(v,C[Q+1]),C[Q+0])},B.Predictor6=function(v,C,Q){return ct(v,C[Q-1])},B.Predictor7=function(v,C,Q){return ct(v,C[Q+0])},B.Predictor8=function(v,C,Q){return ct(C[Q-1],C[Q+0])},B.Predictor9=function(v,C,Q){return ct(C[Q+0],C[Q+1])},B.Predictor10=function(v,C,Q){return ct(ct(v,C[Q-1]),ct(C[Q+0],C[Q+1]))},B.Predictor11=function(v,C,Q){var J=C[Q+0];return 0>=st(J>>24&255,v>>24&255,(C=C[Q-1])>>24&255)+st(J>>16&255,v>>16&255,C>>16&255)+st(J>>8&255,v>>8&255,C>>8&255)+st(255&J,255&v,255&C)?J:v},B.Predictor12=function(v,C,Q){var J=C[Q+0];return(at((v>>24&255)+(J>>24&255)-((C=C[Q-1])>>24&255))<<24|at((v>>16&255)+(J>>16&255)-(C>>16&255))<<16|at((v>>8&255)+(J>>8&255)-(C>>8&255))<<8|at((255&v)+(255&J)-(255&C)))>>>0},B.Predictor13=function(v,C,Q){var J=C[Q-1];return(mt((v=ct(v,C[Q+0]))>>24&255,J>>24&255)<<24|mt(v>>16&255,J>>16&255)<<16|mt(v>>8&255,J>>8&255)<<8|mt(255&v,255&J))>>>0};var wm=B.PredictorAdd0;B.PredictorAdd1=Le,$e("Predictor2","PredictorAdd2"),$e("Predictor3","PredictorAdd3"),$e("Predictor4","PredictorAdd4"),$e("Predictor5","PredictorAdd5"),$e("Predictor6","PredictorAdd6"),$e("Predictor7","PredictorAdd7"),$e("Predictor8","PredictorAdd8"),$e("Predictor9","PredictorAdd9"),$e("Predictor10","PredictorAdd10"),$e("Predictor11","PredictorAdd11"),$e("Predictor12","PredictorAdd12"),$e("Predictor13","PredictorAdd13");var df=B.PredictorAdd2;K("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),K("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var Ds,zx=B.ColorIndexInverseTransform,nc=B.MapARGB,sc=B.VP8LColorIndexInverseTransformAlpha,bm=B.MapAlpha,Nm=B.VP8LPredictorsAdd=[];Nm.length=16,(B.VP8LPredictors=[]).length=16,(B.VP8LPredictorsAdd_C=[]).length=16,(B.VP8LPredictors_C=[]).length=16;var Cm,_m,GA,$A,zA,Fd,WA,kd,Ko,ac,xn,Un,Ls,na,Qc,Em,hf,Wx,qI,GI,$I,zI,WI,JI,Bm,XI,YI,ZI,e5=a(511),t5=a(2041),r5=a(225),n5=a(767),s5=0,tb=t5,Jx=r5,co=n5,qo=e5,Xx=0,Yx=1,a5=2,Zx=3,ev=4,rb=5,i5=6,nb=7,sb=8,tv=9,ab=10,f7=[2,3,7],m7=[3,3,11],o5=[280,256,256,256,40],p7=[0,1,1,1,0],g7=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],x7=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],v7=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],y7=8,ib=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ob=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Sm=null,w7=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],b7=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],l5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],N7=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],C7=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],_7=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],E7=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],JA=[],wl=[],Vc=[],B7=1,c5=2,XA=[],Go=[];Vo("UpsampleRgbLinePair",ft,3),Vo("UpsampleBgrLinePair",bt,3),Vo("UpsampleRgbaLinePair",fn,4),Vo("UpsampleBgraLinePair",qr,4),Vo("UpsampleArgbLinePair",xs,4),Vo("UpsampleRgba4444LinePair",sn,2),Vo("UpsampleRgb565LinePair",zt,2);var S7=B.UpsampleRgbLinePair,I7=B.UpsampleBgrLinePair,A5=B.UpsampleRgbaLinePair,u5=B.UpsampleBgraLinePair,d5=B.UpsampleArgbLinePair,h5=B.UpsampleRgba4444LinePair,F7=B.UpsampleRgb565LinePair,rv=16,nv=1<<rv-1,Im=-227,lb=482,k7=6,f5=0,T7=a(256),j7=a(256),P7=a(256),R7=a(256),D7=a(lb-Im),L7=a(lb-Im);qn("YuvToRgbRow",ft,3),qn("YuvToBgrRow",bt,3),qn("YuvToRgbaRow",fn,4),qn("YuvToBgraRow",qr,4),qn("YuvToArgbRow",xs,4),qn("YuvToRgba4444Row",sn,2),qn("YuvToRgb565Row",zt,2);var m5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],sv=[0,2,8],U7=[8,7,6,4,4,2,2,2,1,1,1,1],O7=1;this.WebPDecodeRGBA=function(v,C,Q,J,ce){var we=Yx,Ne=new St,Se=new ot;Ne.ba=Se,Se.S=we,Se.width=[Se.width],Se.height=[Se.height];var Re=Se.width,qe=Se.height,it=new wt;if(it==null||v==null)var vt=2;else e(it!=null),vt=yl(v,C,Q,it.width,it.height,it.Pd,it.Qd,it.format,null);if(vt!=0?Re=0:(Re!=null&&(Re[0]=it.width[0]),qe!=null&&(qe[0]=it.height[0]),Re=1),Re){Se.width=Se.width[0],Se.height=Se.height[0],J!=null&&(J[0]=Se.width),ce!=null&&(ce[0]=Se.height);e:{if(J=new so,(ce=new Pt).data=v,ce.w=C,ce.ha=Q,ce.kd=1,C=[0],e(ce!=null),((v=yl(ce.data,ce.w,ce.ha,null,null,null,C,null,ce))==0||v==7)&&C[0]&&(v=4),(C=v)==0){if(e(Ne!=null),J.data=ce.data,J.w=ce.w+ce.offset,J.ha=ce.ha-ce.offset,J.put=et,J.ac=tr,J.bc=gt,J.ma=Ne,ce.xa){if((v=Ae())==null){Ne=1;break e}if(function(Ge,lt){var pt=[0],Et=[0],xt=[0];t:for(;;){if(Ge==null)return 0;if(lt==null)return Ge.a=2,0;if(Ge.l=lt,Ge.a=0,te(Ge.m,lt.data,lt.w,lt.ha),!Rt(Ge.m,pt,Et,xt)){Ge.a=3;break t}if(Ge.xb=c5,lt.width=pt[0],lt.height=Et[0],!Pe(pt[0],Et[0],1,Ge,null))break t;return 1}return e(Ge.a!=0),0}(v,J)){if(J=(C=HA(J.width,J.height,Ne.Oa,Ne.ba))==0){t:{J=v;r:for(;;){if(J==null){J=0;break t}if(e(J.s.yc!=null),e(J.s.Ya!=null),e(0<J.s.Wb),e((Q=J.l)!=null),e((ce=Q.ma)!=null),J.xb!=0){if(J.ca=ce.ba,J.tb=ce.tb,e(J.ca!=null),!vm(ce.Oa,Q,Zx)){J.a=2;break r}if(!Ce(J,Q.width)||Q.da)break r;if((Q.da||We(J.ca.S))&&Qi(),11>J.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),J.ca.f.kb.F!=null&&Qi()),J.Pb&&0<J.s.ua&&J.s.vb.X==null&&!W(J.s.vb,J.s.Wa.Xa)){J.a=1;break r}J.xb=0}if(!ee(J,J.V,J.Ba,J.c,J.i,Q.o,ue))break r;ce.Dc=J.Ma,J=1;break t}e(J.a!=0),J=0}J=!J}J&&(C=v.a)}else C=v.a}else{if((v=new DA)==null){Ne=1;break e}if(v.Fa=ce.na,v.P=ce.P,v.qc=ce.Sa,Ro(v,J)){if((C=HA(J.width,J.height,Ne.Oa,Ne.ba))==0){if(v.Aa=0,Q=Ne.Oa,e((ce=v)!=null),Q!=null){if(0<(Re=0>(Re=Q.Md)?0:100<Re?255:255*Re/100)){for(qe=it=0;4>qe;++qe)12>(vt=ce.pb[qe]).lc&&(vt.ia=Re*U7[0>vt.lc?0:vt.lc]>>3),it|=vt.ia;it&&(alert("todo:VP8InitRandom"),ce.ia=1)}ce.Ga=Q.Id,100<ce.Ga?ce.Ga=100:0>ce.Ga&&(ce.Ga=0)}(function(Ge,lt){if(Ge==null)return 0;if(lt==null)return Kn(Ge,2,"NULL VP8Io parameter in VP8Decode().");if(!Ge.cb&&!Ro(Ge,lt))return 0;if(e(Ge.cb),lt.ac==null||lt.ac(lt)){lt.ob&&(Ge.L=0);var pt=sv[Ge.L];if(Ge.L==2?(Ge.yb=0,Ge.zb=0):(Ge.yb=lt.v-pt>>4,Ge.zb=lt.j-pt>>4,0>Ge.yb&&(Ge.yb=0),0>Ge.zb&&(Ge.zb=0)),Ge.Va=lt.o+15+pt>>4,Ge.Hb=lt.va+15+pt>>4,Ge.Hb>Ge.za&&(Ge.Hb=Ge.za),Ge.Va>Ge.Ub&&(Ge.Va=Ge.Ub),0<Ge.L){var Et=Ge.ed;for(pt=0;4>pt;++pt){var xt;if(Ge.Qa.Cb){var It=Ge.Qa.Lb[pt];Ge.Qa.Fb||(It+=Et.Tb)}else It=Et.Tb;for(xt=0;1>=xt;++xt){var Ft=Ge.gd[pt][xt],Qt=It;if(Et.Pc&&(Qt+=Et.vd[0],xt&&(Qt+=Et.od[0])),0<(Qt=0>Qt?0:63<Qt?63:Qt)){var Ut=Qt;0<Et.wb&&(Ut=4<Et.wb?Ut>>2:Ut>>1)>9-Et.wb&&(Ut=9-Et.wb),1>Ut&&(Ut=1),Ft.dd=Ut,Ft.tc=2*Qt+Ut,Ft.ld=40<=Qt?2:15<=Qt?1:0}else Ft.tc=0;Ft.La=xt}}}pt=0}else Kn(Ge,6,"Frame setup failed"),pt=Ge.a;if(pt=pt==0){if(pt){Ge.$c=0,0<Ge.Aa||(Ge.Ic=O7);t:{pt=Ge.Ic,Et=4*(Ut=Ge.za);var gr=32*Ut,Ar=Ut+1,Ur=0<Ge.L?Ut*(0<Ge.Aa?2:1):0,fr=(Ge.Aa==2?2:1)*Ut;if((Ft=Et+832+(xt=3*(16*pt+sv[Ge.L])/2*gr)+(It=Ge.Fa!=null&&0<Ge.Fa.length?Ge.Kc.c*Ge.Kc.i:0))!=Ft)pt=0;else{if(Ft>Ge.Vb){if(Ge.Vb=0,Ge.Ec=a(Ft),Ge.Fc=0,Ge.Ec==null){pt=Kn(Ge,1,"no memory during frame initialization.");break t}Ge.Vb=Ft}Ft=Ge.Ec,Qt=Ge.Fc,Ge.Ac=Ft,Ge.Bc=Qt,Qt+=Et,Ge.Gd=o(gr,Rs),Ge.Hd=0,Ge.rb=o(Ar+1,xr),Ge.sb=1,Ge.wa=Ur?o(Ur,Kt):null,Ge.Y=0,Ge.D.Nb=0,Ge.D.wa=Ge.wa,Ge.D.Y=Ge.Y,0<Ge.Aa&&(Ge.D.Y+=Ut),e(!0),Ge.oc=Ft,Ge.pc=Qt,Qt+=832,Ge.ya=o(fr,Tn),Ge.aa=0,Ge.D.ya=Ge.ya,Ge.D.aa=Ge.aa,Ge.Aa==2&&(Ge.D.aa+=Ut),Ge.R=16*Ut,Ge.B=8*Ut,Ut=(gr=sv[Ge.L])*Ge.R,gr=gr/2*Ge.B,Ge.sa=Ft,Ge.ta=Qt+Ut,Ge.qa=Ge.sa,Ge.ra=Ge.ta+16*pt*Ge.R+gr,Ge.Ha=Ge.qa,Ge.Ia=Ge.ra+8*pt*Ge.B+gr,Ge.$c=0,Qt+=xt,Ge.mb=It?Ft:null,Ge.nb=It?Qt:null,e(Qt+It<=Ge.Fc+Ge.Vb),Nd(Ge),s(Ge.Ac,Ge.Bc,0,Et),pt=1}}if(pt){if(lt.ka=0,lt.y=Ge.sa,lt.O=Ge.ta,lt.f=Ge.qa,lt.N=Ge.ra,lt.ea=Ge.Ha,lt.Vd=Ge.Ia,lt.fa=Ge.R,lt.Rc=Ge.B,lt.F=null,lt.J=0,!s5){for(pt=-255;255>=pt;++pt)e5[255+pt]=0>pt?-pt:pt;for(pt=-1020;1020>=pt;++pt)t5[1020+pt]=-128>pt?-128:127<pt?127:pt;for(pt=-112;112>=pt;++pt)r5[112+pt]=-16>pt?-16:15<pt?15:pt;for(pt=-255;510>=pt;++pt)n5[255+pt]=0>pt?0:255<pt?255:pt;s5=1}WA=Do,kd=af,ac=Yr,xn=Dc,Un=Zl,Ko=LA,Ls=VA,na=Qo,Qc=le,Em=Ke,hf=Sd,Wx=D,qI=tt,GI=ht,$I=rc,zI=bi,WI=Bd,JI=uf,wl[0]=gm,wl[1]=of,wl[2]=mm,wl[3]=pm,wl[4]=va,wl[5]=xm,wl[6]=xl,wl[7]=OA,wl[8]=MA,wl[9]=vl,JA[0]=Lo,JA[1]=fm,JA[2]=Cd,JA[3]=lf,JA[4]=ec,JA[5]=UA,JA[6]=cf,Vc[0]=_d,Vc[1]=hm,Vc[2]=ao,Vc[3]=Uc,Vc[4]=Ed,Vc[5]=jn,Vc[6]=Af,pt=1}else pt=0}pt&&(pt=function(an,sa){for(an.M=0;an.M<an.Va;++an.M){var Or,mr=an.Jc[an.M&an.Xb],Yt=an.m,Us=an;for(Or=0;Or<Us.za;++Or){var Pr=Yt,on=Us,Xn=on.Ac,Pa=on.Bc+4*Or,Ci=on.zc,Bs=on.ya[on.aa+Or];if(on.Qa.Bb?Bs.$b=se(Pr,on.Pa.jb[0])?2+se(Pr,on.Pa.jb[2]):se(Pr,on.Pa.jb[1]):Bs.$b=0,on.kc&&(Bs.Ad=se(Pr,on.Bd)),Bs.Za=!se(Pr,145)+0,Bs.Za){var Za=Bs.Ob,_i=0;for(on=0;4>on;++on){var aa,cn=Ci[0+on];for(aa=0;4>aa;++aa){cn=C7[Xn[Pa+aa]][cn];for(var wn=l5[se(Pr,cn[0])];0<wn;)wn=l5[2*wn+se(Pr,cn[wn])];cn=-wn,Xn[Pa+aa]=cn}n(Za,_i,Xn,Pa,4),_i+=4,Ci[0+on]=cn}}else cn=se(Pr,156)?se(Pr,128)?1:3:se(Pr,163)?2:0,Bs.Ob[0]=cn,s(Xn,Pa,cn,4),s(Ci,0,cn,4);Bs.Dd=se(Pr,142)?se(Pr,114)?se(Pr,183)?1:3:2:0}if(Us.m.Ka)return Kn(an,7,"Premature end-of-partition0 encountered.");for(;an.ja<an.za;++an.ja){if(Us=mr,Pr=(Yt=an).rb[Yt.sb-1],Xn=Yt.rb[Yt.sb+Yt.ja],Or=Yt.ya[Yt.aa+Yt.ja],Pa=Yt.kc?Or.Ad:0)Pr.la=Xn.la=0,Or.Za||(Pr.Na=Xn.Na=0),Or.Hc=0,Or.Gc=0,Or.ia=0;else{var Ss,bn;if(Pr=Xn,Xn=Us,Pa=Yt.Pa.Xc,Ci=Yt.ya[Yt.aa+Yt.ja],Bs=Yt.pb[Ci.$b],on=Ci.ad,Za=0,_i=Yt.rb[Yt.sb-1],cn=aa=0,s(on,Za,0,384),Ci.Za)var Ra=0,bl=Pa[3];else{wn=a(16);var Os=Pr.Na+_i.Na;if(Os=Sm(Xn,Pa[1],Os,Bs.Eb,0,wn,0),Pr.Na=_i.Na=(0<Os)+0,1<Os)WA(wn,0,on,Za);else{var Vi=wn[0]+3>>3;for(wn=0;256>wn;wn+=16)on[Za+wn]=Vi}Ra=1,bl=Pa[0]}var On=15&Pr.la,ia=15&_i.la;for(wn=0;4>wn;++wn){var Ao=1&ia;for(Vi=bn=0;4>Vi;++Vi)On=On>>1|(Ao=(Os=Sm(Xn,bl,Os=Ao+(1&On),Bs.Sc,Ra,on,Za))>Ra)<<7,bn=bn<<2|(3<Os?3:1<Os?2:on[Za+0]!=0),Za+=16;On>>=4,ia=ia>>1|Ao<<7,aa=(aa<<8|bn)>>>0}for(bl=On,Ra=ia>>4,Ss=0;4>Ss;Ss+=2){for(bn=0,On=Pr.la>>4+Ss,ia=_i.la>>4+Ss,wn=0;2>wn;++wn){for(Ao=1&ia,Vi=0;2>Vi;++Vi)Os=Ao+(1&On),On=On>>1|(Ao=0<(Os=Sm(Xn,Pa[2],Os,Bs.Qc,0,on,Za)))<<3,bn=bn<<2|(3<Os?3:1<Os?2:on[Za+0]!=0),Za+=16;On>>=2,ia=ia>>1|Ao<<5}cn|=bn<<4*Ss,bl|=On<<4<<Ss,Ra|=(240&ia)<<Ss}Pr.la=bl,_i.la=Ra,Ci.Hc=aa,Ci.Gc=cn,Ci.ia=43690&cn?0:Bs.ia,Pa=!(aa|cn)}if(0<Yt.L&&(Yt.wa[Yt.Y+Yt.ja]=Yt.gd[Or.$b][Or.Za],Yt.wa[Yt.Y+Yt.ja].La|=!Pa),Us.Ka)return Kn(an,7,"Premature end-of-file encountered.")}if(Nd(an),Yt=sa,Us=1,Or=(mr=an).D,Pr=0<mr.L&&mr.M>=mr.zb&&mr.M<=mr.Va,mr.Aa==0)t:{if(Or.M=mr.M,Or.uc=Pr,ja(mr,Or),Us=1,Or=(bn=mr.D).Nb,Pr=(cn=sv[mr.L])*mr.R,Xn=cn/2*mr.B,wn=16*Or*mr.R,Vi=8*Or*mr.B,Pa=mr.sa,Ci=mr.ta-Pr+wn,Bs=mr.qa,on=mr.ra-Xn+Vi,Za=mr.Ha,_i=mr.Ia-Xn+Vi,ia=(On=bn.M)==0,aa=On>=mr.Va-1,mr.Aa==2&&ja(mr,bn),bn.uc)for(Ao=(Os=mr).D.M,e(Os.D.uc),bn=Os.yb;bn<Os.Hb;++bn){Ra=bn,bl=Ao;var Ei=(uo=(Da=Os).D).Nb;Ss=Da.R;var uo=uo.wa[uo.Y+Ra],ho=Da.sa,Hi=Da.ta+16*Ei*Ss+16*Ra,fo=uo.dd,Gn=uo.tc;if(Gn!=0)if(e(3<=Gn),Da.L==1)0<Ra&&zI(ho,Hi,Ss,Gn+4),uo.La&&JI(ho,Hi,Ss,Gn),0<bl&&$I(ho,Hi,Ss,Gn+4),uo.La&&WI(ho,Hi,Ss,Gn);else{var mo=Da.B,Nl=Da.qa,Td=Da.ra+8*Ei*mo+8*Ra,Hc=Da.Ha,Da=Da.Ia+8*Ei*mo+8*Ra;Ei=uo.ld,0<Ra&&(na(ho,Hi,Ss,Gn+4,fo,Ei),Em(Nl,Td,Hc,Da,mo,Gn+4,fo,Ei)),uo.La&&(Wx(ho,Hi,Ss,Gn,fo,Ei),GI(Nl,Td,Hc,Da,mo,Gn,fo,Ei)),0<bl&&(Ls(ho,Hi,Ss,Gn+4,fo,Ei),Qc(Nl,Td,Hc,Da,mo,Gn+4,fo,Ei)),uo.La&&(hf(ho,Hi,Ss,Gn,fo,Ei),qI(Nl,Td,Hc,Da,mo,Gn,fo,Ei))}}if(mr.ia&&alert("todo:DitherRow"),Yt.put!=null){if(bn=16*On,On=16*(On+1),ia?(Yt.y=mr.sa,Yt.O=mr.ta+wn,Yt.f=mr.qa,Yt.N=mr.ra+Vi,Yt.ea=mr.Ha,Yt.W=mr.Ia+Vi):(bn-=cn,Yt.y=Pa,Yt.O=Ci,Yt.f=Bs,Yt.N=on,Yt.ea=Za,Yt.W=_i),aa||(On-=cn),On>Yt.o&&(On=Yt.o),Yt.F=null,Yt.J=null,mr.Fa!=null&&0<mr.Fa.length&&bn<On&&(Yt.J=yn(mr,Yt,bn,On-bn),Yt.F=mr.mb,Yt.F==null&&Yt.F.length==0)){Us=Kn(mr,3,"Could not decode alpha data.");break t}bn<Yt.j&&(cn=Yt.j-bn,bn=Yt.j,e(!(1&cn)),Yt.O+=mr.R*cn,Yt.N+=mr.B*(cn>>1),Yt.W+=mr.B*(cn>>1),Yt.F!=null&&(Yt.J+=Yt.width*cn)),bn<On&&(Yt.O+=Yt.v,Yt.N+=Yt.v>>1,Yt.W+=Yt.v>>1,Yt.F!=null&&(Yt.J+=Yt.v),Yt.ka=bn-Yt.j,Yt.U=Yt.va-Yt.v,Yt.T=On-bn,Us=Yt.put(Yt))}Or+1!=mr.Ic||aa||(n(mr.sa,mr.ta-Pr,Pa,Ci+16*mr.R,Pr),n(mr.qa,mr.ra-Xn,Bs,on+8*mr.B,Xn),n(mr.Ha,mr.Ia-Xn,Za,_i+8*mr.B,Xn))}if(!Us)return Kn(an,6,"Output aborted.")}return 1}(Ge,lt)),lt.bc!=null&&lt.bc(lt),pt&=1}return pt?(Ge.cb=0,pt):0})(v,J)||(C=v.a)}}else C=v.a}C==0&&Ne.Oa!=null&&Ne.Oa.fd&&(C=ym(Ne.ba))}Ne=C}we=Ne!=0?null:11>we?Se.f.RGBA.eb:Se.f.kb.y}else we=null;return we};var p5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function A(B,M){for(var F="",T=0;T<4;T++)F+=String.fromCharCode(B[M++]);return F}function u(B,M){return B[M+0]|B[M+1]<<8}function d(B,M){return(B[M+0]|B[M+1]<<8|B[M+2]<<16)>>>0}function f(B,M){return(B[M+0]|B[M+1]<<8|B[M+2]<<16|B[M+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,g=t,w=function(B,M){var F={},T=0,O=!1,Y=0,me=0;if(F.frames=[],!function(S,I){for(var V=0;V<4;V++)if(S[I+V]!="RIFF".charCodeAt(V))return!0;return!1}(B,M)){for(f(B,M+=4),M+=8;M<B.length;){var ae=A(B,M),fe=f(B,M+=4);M+=4;var he=fe+(1&fe);switch(ae){case"VP8 ":case"VP8L":F.frames[T]===void 0&&(F.frames[T]={}),(Ie=F.frames[T]).src_off=O?me:M-8,Ie.src_size=Y+fe+8,T++,O&&(O=!1,Y=0,me=0);break;case"VP8X":(Ie=F.header={}).feature_flags=B[M];var te=M+4;Ie.canvas_width=1+d(B,te),te+=3,Ie.canvas_height=1+d(B,te),te+=3;break;case"ALPH":O=!0,Y=he+8,me=M-8;break;case"ANIM":(Ie=F.header).bgcolor=f(B,M),te=M+4,Ie.loop_count=u(B,te),te+=2;break;case"ANMF":var pe,Ie;(Ie=F.frames[T]={}).offset_x=2*d(B,M),M+=3,Ie.offset_y=2*d(B,M),M+=3,Ie.width=1+d(B,M),M+=3,Ie.height=1+d(B,M),M+=3,Ie.duration=d(B,M),M+=3,pe=B[M++],Ie.dispose=1&pe,Ie.blend=pe>>1&1}ae!="ANMF"&&(M+=he)}return F}}(g,0);w.response=g,w.rgbaoutput=!0,w.dataurl=!1;var b=w.header?w.header:null,k=w.frames?w.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var P=0;P<k.length&&k[P].blend!=0;P++);}var L=k[0],E=x.WebPDecodeRGBA(g,L.src_off,L.src_size,m,h);L.rgba=E,L.imgwidth=m[0],L.imgheight=h[0];for(var _=0;_<m[0]*h[0]*4;_++)p[_]=E[_];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,s,a,o,l,c,A,u=function(S){return S=S||{},this.isStrokeTransparent=S.isStrokeTransparent||!1,this.strokeOpacity=S.strokeOpacity||1,this.strokeStyle=S.strokeStyle||"#000000",this.fillStyle=S.fillStyle||"#000000",this.isFillTransparent=S.isFillTransparent||!1,this.fillOpacity=S.fillOpacity||1,this.font=S.font||"10px sans-serif",this.textBaseline=S.textBaseline||"alphabetic",this.textAlign=S.textAlign||"left",this.lineWidth=S.lineWidth||1,this.lineJoin=S.lineJoin||"miter",this.lineCap=S.lineCap||"butt",this.path=S.path||[],this.transform=S.transform!==void 0?S.transform.clone():new c,this.globalCompositeOperation=S.globalCompositeOperation||"normal",this.globalAlpha=S.globalAlpha||1,this.clip_path=S.clip_path||[],this.currentPoint=S.currentPoint||new o,this.miterLimit=S.miterLimit||10,this.lastPoint=S.lastPoint||new o,this.lineDashOffset=S.lineDashOffset||0,this.lineDash=S.lineDash||[],this.margin=S.margin||[0,0,0,0],this.prevPageLastElemOffset=S.prevPageLastElemOffset||0,this.ignoreClearRect=typeof S.ignoreClearRect!="boolean"||S.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,A=new u}]);var d=function(S){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=S;Object.defineProperty(this,"pdf",{get:function(){return I}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(W){V=!!W}});var j=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return j},set:function(W){j=!!W}});var U=0;Object.defineProperty(this,"posX",{get:function(){return U},set:function(W){isNaN(W)||(U=W)}});var G=0;Object.defineProperty(this,"posY",{get:function(){return G},set:function(W){isNaN(W)||(G=W)}}),Object.defineProperty(this,"margin",{get:function(){return A.margin},set:function(W){var q;typeof W=="number"?q=[W,W,W,W]:((q=new Array(4))[0]=W[0],q[1]=W.length>=2?W[1]:q[0],q[2]=W.length>=3?W[2]:q[0],q[3]=W.length>=4?W[3]:q[1]),A.margin=q}});var R=!1;Object.defineProperty(this,"autoPaging",{get:function(){return R},set:function(W){R=W}});var X=0;Object.defineProperty(this,"lastBreak",{get:function(){return X},set:function(W){X=W}});var se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return se},set:function(W){se=W}}),Object.defineProperty(this,"ctx",{get:function(){return A},set:function(W){W instanceof u&&(A=W)}}),Object.defineProperty(this,"path",{get:function(){return A.path},set:function(W){A.path=W}});var ye=[];Object.defineProperty(this,"ctxStack",{get:function(){return ye},set:function(W){ye=W}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(W){var q;q=f(W),this.ctx.fillStyle=q.style,this.ctx.isFillTransparent=q.a===0,this.ctx.fillOpacity=q.a,this.pdf.setFillColor(q.r,q.g,q.b,{a:q.a}),this.pdf.setTextColor(q.r,q.g,q.b,{a:q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(W){var q=f(W);this.ctx.strokeStyle=q.style,this.ctx.isStrokeTransparent=q.a===0,this.ctx.strokeOpacity=q.a,q.a===0?this.pdf.setDrawColor(255,255,255):(q.a,this.pdf.setDrawColor(q.r,q.g,q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(W){["butt","round","square"].indexOf(W)!==-1&&(this.ctx.lineCap=W,this.pdf.setLineCap(W))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(W){isNaN(W)||(this.ctx.lineWidth=W,this.pdf.setLineWidth(W))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(W){["bevel","round","miter"].indexOf(W)!==-1&&(this.ctx.lineJoin=W,this.pdf.setLineJoin(W))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(W){isNaN(W)||(this.ctx.miterLimit=W,this.pdf.setMiterLimit(W))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(W){this.ctx.textBaseline=W}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(W){["right","end","center","left","start"].indexOf(W)!==-1&&(this.ctx.textAlign=W)}});var z=null,Me=null,re=null;Object.defineProperty(this,"fontFaces",{get:function(){return re},set:function(W){z=null,Me=null,re=W}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(W){var q;if(this.ctx.font=W,(q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(W))!==null){var oe=q[1];q[2];var de=q[3],Be=q[4];q[5];var He=q[6],$e=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Be)[2];Be=Math.floor($e==="px"?parseFloat(Be)*this.pdf.internal.scaleFactor:$e==="em"?parseFloat(Be)*this.pdf.getFontSize():parseFloat(Be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Be);var Je=function(K){var _e,Oe,Ve=[],ve=K.trim();if(ve==="")return HN;if(ve in kj)return[kj[ve]];for(;ve!=="";){switch(Oe=null,_e=(ve=jj(ve)).charAt(0)){case'"':case"'":Oe=ioe(ve.substring(1),_e);break;default:Oe=ooe(ve)}if(Oe===null||(Ve.push(Oe[0]),(ve=jj(Oe[1]))!==""&&ve.charAt(0)!==","))return HN;ve=ve.replace(/^,/,"")}return Ve}(He);if(this.fontFaces){var ct=function(K,_e){var Oe=K.getFontList(),Ve=JSON.stringify(Oe);if(z===null||Me!==Ve){var ve=function(Qe){var Ue=[];return Object.keys(Qe).forEach(function(Ee){Qe[Ee].forEach(function(We){var nt=null;switch(We){case"bold":nt={family:Ee,weight:"bold"};break;case"italic":nt={family:Ee,style:"italic"};break;case"bolditalic":nt={family:Ee,weight:"bold",style:"italic"};break;case"":case"normal":nt={family:Ee}}nt!==null&&(nt.ref={name:Ee,style:We},Ue.push(nt))})}),Ue}(Oe);z=function(Qe){for(var Ue={},Ee=0;Ee<Qe.length;++Ee){var We=VN(Qe[Ee]),nt=We.family,Nt=We.stretch,ot=We.style,wt=We.weight;Ue[nt]=Ue[nt]||{},Ue[nt][Nt]=Ue[nt][Nt]||{},Ue[nt][Nt][ot]=Ue[nt][Nt][ot]||{},Ue[nt][Nt][ot][wt]=We}return Ue}(ve.concat(_e)),Me=Ve}return z}(this.pdf,this.fontFaces),at=Je.map(function(K){return{family:K,stretch:"normal",weight:de,style:oe}}),mt=function(K,_e,Oe){for(var Ve=(Oe=Oe||{}).defaultFontFamily||"times",ve=Object.assign({},aoe,Oe.genericFontFamilies||{}),Qe=null,Ue=null,Ee=0;Ee<_e.length;++Ee)if(ve[(Qe=VN(_e[Ee])).family]&&(Qe.family=ve[Qe.family]),K.hasOwnProperty(Qe.family)){Ue=K[Qe.family];break}if(!(Ue=Ue||K[Ve]))throw new Error("Could not find a font-family for the rule '"+Tj(Qe)+"' and default family '"+Ve+"'.");if(Ue=function(We,nt){if(nt[We])return nt[We];var Nt=_E[We],ot=Nt<=_E.normal?-1:1,wt=Fj(nt,$M,Nt,ot);if(!wt)throw new Error("Could not find a matching font-stretch value for "+We);return wt}(Qe.stretch,Ue),Ue=function(We,nt){if(nt[We])return nt[We];for(var Nt=GM[We],ot=0;ot<Nt.length;++ot)if(nt[Nt[ot]])return nt[Nt[ot]];throw new Error("Could not find a matching font-style for "+We)}(Qe.style,Ue),!(Ue=function(We,nt){if(nt[We])return nt[We];if(We===400&&nt[500])return nt[500];if(We===500&&nt[400])return nt[400];var Nt=soe[We],ot=Fj(nt,zM,Nt,We<400?-1:1);if(!ot)throw new Error("Could not find a matching font-weight for value "+We);return ot}(Qe.weight,Ue)))throw new Error("Failed to resolve a font for the rule '"+Tj(Qe)+"'.");return Ue}(ct,at);this.pdf.setFont(mt.ref.name,mt.ref.style)}else{var st="";(de==="bold"||parseInt(de,10)>=700||oe==="bold")&&(st="bold"),oe==="italic"&&(st+="italic"),st.length===0&&(st="normal");for(var Le="",ut={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},be=0;be<Je.length;be++){if(this.pdf.internal.getFont(Je[be],st,{noFallback:!0,disableWarning:!0})!==void 0){Le=Je[be];break}if(st==="bolditalic"&&this.pdf.internal.getFont(Je[be],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Le=Je[be],st="bold";else if(this.pdf.internal.getFont(Je[be],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Le=Je[be],st="normal";break}}if(Le===""){for(var ge=0;ge<Je.length;ge++)if(ut[Je[ge]]){Le=ut[Je[ge]];break}}Le=Le===""?"Times":Le,this.pdf.setFont(Le,st)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(W){this.ctx.globalCompositeOperation=W}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(W){this.ctx.globalAlpha=W}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(W){this.ctx.lineDashOffset=W,Ie.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(W){this.ctx.lineDash=W,Ie.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(W){this.ctx.ignoreClearRect=!!W}})};d.prototype.setLineDash=function(S){this.lineDash=S},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){k.call(this,"fill",!1)},d.prototype.stroke=function(){k.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new o(S,I));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(S,I)},d.prototype.closePath=function(){var S=new o(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&Sn(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){S=new o(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(S.x,S.y)},d.prototype.lineTo=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new o(S,I));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),k.call(this,null,!0)},d.prototype.quadraticCurveTo=function(S,I,V,j){if(isNaN(V)||isNaN(j)||isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var U=this.ctx.transform.applyToPoint(new o(V,j)),G=this.ctx.transform.applyToPoint(new o(S,I));this.path.push({type:"qct",x1:G.x,y1:G.y,x:U.x,y:U.y}),this.ctx.lastPoint=new o(U.x,U.y)},d.prototype.bezierCurveTo=function(S,I,V,j,U,G){if(isNaN(U)||isNaN(G)||isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var R=this.ctx.transform.applyToPoint(new o(U,G)),X=this.ctx.transform.applyToPoint(new o(S,I)),se=this.ctx.transform.applyToPoint(new o(V,j));this.path.push({type:"bct",x1:X.x,y1:X.y,x2:se.x,y2:se.y,x:R.x,y:R.y}),this.ctx.lastPoint=new o(R.x,R.y)},d.prototype.arc=function(S,I,V,j,U,G){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j)||isNaN(U))throw Vn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(G=!!G,!this.ctx.transform.isIdentity){var R=this.ctx.transform.applyToPoint(new o(S,I));S=R.x,I=R.y;var X=this.ctx.transform.applyToPoint(new o(0,V)),se=this.ctx.transform.applyToPoint(new o(0,0));V=Math.sqrt(Math.pow(X.x-se.x,2)+Math.pow(X.y-se.y,2))}Math.abs(U-j)>=2*Math.PI&&(j=0,U=2*Math.PI),this.path.push({type:"arc",x:S,y:I,radius:V,startAngle:j,endAngle:U,counterclockwise:G})},d.prototype.arcTo=function(S,I,V,j,U){throw new Error("arcTo not implemented.")},d.prototype.rect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(S,I),this.lineTo(S+V,I),this.lineTo(S+V,I+j),this.lineTo(S,I+j),this.lineTo(S,I),this.lineTo(S+V,I),this.lineTo(S,I)},d.prototype.fillRect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var U={};this.lineCap!=="butt"&&(U.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(U.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(S,I,V,j),this.fill(),U.hasOwnProperty("lineCap")&&(this.lineCap=U.lineCap),U.hasOwnProperty("lineJoin")&&(this.lineJoin=U.lineJoin)}},d.prototype.strokeRect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(S,I,V,j),this.stroke())},d.prototype.clearRect=function(S,I,V,j){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j))throw Vn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(S,I,V,j))},d.prototype.save=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),S){this.ctx.fontSize=this.pdf.internal.getFontSize();var j=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=j}},d.prototype.restore=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(I),S&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(S){var I,V,j,U;if(S.isCanvasGradient===!0&&(S=S.getColor()),!S)return{r:0,g:0,b:0,a:0,style:S};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(S))I=0,V=0,j=0,U=0;else{var G=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(S);if(G!==null)I=parseInt(G[1]),V=parseInt(G[2]),j=parseInt(G[3]),U=1;else if((G=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(S))!==null)I=parseInt(G[1]),V=parseInt(G[2]),j=parseInt(G[3]),U=parseFloat(G[4]);else{if(U=1,typeof S=="string"&&S.charAt(0)!=="#"){var R=new OM(S);S=R.ok?R.toHex():"#000000"}S.length===4?(I=S.substring(1,2),I+=I,V=S.substring(2,3),V+=V,j=S.substring(3,4),j+=j):(I=S.substring(1,3),V=S.substring(3,5),j=S.substring(5,7)),I=parseInt(I,16),V=parseInt(V,16),j=parseInt(j,16)}}return{r:I,g:V,b:j,a:U,style:S}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(S,I,V,j){if(isNaN(I)||isNaN(V)||typeof S!="string")throw Vn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(j=isNaN(j)?void 0:j,!h.call(this)){var U=he(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;T.call(this,{text:S,x:I,y:V,scale:G,angle:U,align:this.textAlign,maxWidth:j})}},d.prototype.strokeText=function(S,I,V,j){if(isNaN(I)||isNaN(V)||typeof S!="string")throw Vn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){j=isNaN(j)?void 0:j;var U=he(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;T.call(this,{text:S,x:I,y:V,scale:G,renderingMode:"stroke",angle:U,align:this.textAlign,maxWidth:j})}},d.prototype.measureText=function(S){if(typeof S!="string")throw Vn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,V=this.pdf.internal.scaleFactor,j=I.internal.getFontSize(),U=I.getStringUnitWidth(S)*j/I.internal.scaleFactor;return new function(G){var R=(G=G||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return R}}),this}({width:U*=Math.round(96*V/72*1e4)/1e4})},d.prototype.scale=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(S,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},d.prototype.rotate=function(S){if(isNaN(S))throw Vn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new c(Math.cos(S),Math.sin(S),-Math.sin(S),Math.cos(S),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},d.prototype.translate=function(S,I){if(isNaN(S)||isNaN(I))throw Vn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,S,I);this.ctx.transform=this.ctx.transform.multiply(V)},d.prototype.transform=function(S,I,V,j,U,G){if(isNaN(S)||isNaN(I)||isNaN(V)||isNaN(j)||isNaN(U)||isNaN(G))throw Vn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var R=new c(S,I,V,j,U,G);this.ctx.transform=this.ctx.transform.multiply(R)},d.prototype.setTransform=function(S,I,V,j,U,G){S=isNaN(S)?1:S,I=isNaN(I)?0:I,V=isNaN(V)?0:V,j=isNaN(j)?1:j,U=isNaN(U)?0:U,G=isNaN(G)?0:G,this.ctx.transform=new c(S,I,V,j,U,G)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(S,I,V,j,U,G,R,X,se){var ye=this.pdf.getImageProperties(S),z=1,Me=1,re=1,W=1;j!==void 0&&X!==void 0&&(re=X/j,W=se/U,z=ye.width/j*X/j,Me=ye.height/U*se/U),G===void 0&&(G=I,R=V,I=0,V=0),j!==void 0&&X===void 0&&(X=j,se=U),j===void 0&&X===void 0&&(X=ye.width,se=ye.height);var q=this.ctx.transform.decompose(),oe=he(q.rotate.shx),de=new c,Be=(de=(de=(de=de.multiply(q.translate)).multiply(q.skew)).multiply(q.scale)).applyToRectangle(new l(G-I*re,R-V*W,j*z,U*Me));if(this.autoPaging){for(var He,$e=x.call(this,Be),Je=[],ct=0;ct<$e.length;ct+=1)Je.indexOf($e[ct])===-1&&Je.push($e[ct]);b(Je);for(var at=Je[0],mt=Je[Je.length-1],st=at;st<mt+1;st++){this.pdf.setPage(st);var Le=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ut=st===1?this.posY+this.margin[0]:this.margin[0],be=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ge=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],K=st===1?0:be+(st-2)*ge;if(this.ctx.clip_path.length!==0){var _e=this.path;He=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(He,this.posX+this.margin[3],-K+ut+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=_e}var Oe=JSON.parse(JSON.stringify(Be));Oe=w([Oe],this.posX+this.margin[3],-K+ut+this.ctx.prevPageLastElemOffset)[0];var Ve=(st>at||st<mt)&&p.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Le,ge,null).clip().discardPath()),this.pdf.addImage(S,"JPEG",Oe.x,Oe.y,Oe.w,Oe.h,null,null,oe),Ve&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(S,"JPEG",Be.x,Be.y,Be.w,Be.h,null,null,oe)};var x=function(S,I,V){var j=[];I=I||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var U=this.posY+this.ctx.prevPageLastElemOffset;switch(S.type){default:case"mt":case"lt":j.push(Math.floor((S.y+U)/V)+1);break;case"arc":j.push(Math.floor((S.y+U-S.radius)/V)+1),j.push(Math.floor((S.y+U+S.radius)/V)+1);break;case"qct":var G=te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x,S.y);j.push(Math.floor((G.y+U)/V)+1),j.push(Math.floor((G.y+G.h+U)/V)+1);break;case"bct":var R=pe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x2,S.y2,S.x,S.y);j.push(Math.floor((R.y+U)/V)+1),j.push(Math.floor((R.y+R.h+U)/V)+1);break;case"rect":j.push(Math.floor((S.y+U)/V)+1),j.push(Math.floor((S.y+S.h+U)/V)+1)}for(var X=0;X<j.length;X+=1)for(;this.pdf.internal.getNumberOfPages()<j[X];)g.call(this);return j},g=function(){var S=this.fillStyle,I=this.strokeStyle,V=this.font,j=this.lineCap,U=this.lineWidth,G=this.lineJoin;this.pdf.addPage(),this.fillStyle=S,this.strokeStyle=I,this.font=V,this.lineCap=j,this.lineWidth=U,this.lineJoin=G},w=function(S,I,V){for(var j=0;j<S.length;j++)switch(S[j].type){case"bct":S[j].x2+=I,S[j].y2+=V;case"qct":S[j].x1+=I,S[j].y1+=V;default:S[j].x+=I,S[j].y+=V}return S},b=function(S){return S.sort(function(I,V){return I-V})},k=function(S,I){var V=this.fillStyle,j=this.strokeStyle,U=this.lineCap,G=this.lineWidth,R=Math.abs(G*this.ctx.transform.scaleX),X=this.lineJoin;if(this.autoPaging){for(var se,ye,z=JSON.parse(JSON.stringify(this.path)),Me=JSON.parse(JSON.stringify(this.path)),re=[],W=0;W<Me.length;W++)if(Me[W].x!==void 0)for(var q=x.call(this,Me[W]),oe=0;oe<q.length;oe+=1)re.indexOf(q[oe])===-1&&re.push(q[oe]);for(var de=0;de<re.length;de++)for(;this.pdf.internal.getNumberOfPages()<re[de];)g.call(this);b(re);for(var Be=re[0],He=re[re.length-1],$e=Be;$e<He+1;$e++){this.pdf.setPage($e),this.fillStyle=V,this.strokeStyle=j,this.lineCap=U,this.lineWidth=R,this.lineJoin=X;var Je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ct=$e===1?this.posY+this.margin[0]:this.margin[0],at=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],st=$e===1?0:at+($e-2)*mt;if(this.ctx.clip_path.length!==0){var Le=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(se,this.posX+this.margin[3],-st+ct+this.ctx.prevPageLastElemOffset),P.call(this,S,!0),this.path=Le}if(ye=JSON.parse(JSON.stringify(z)),this.path=w(ye,this.posX+this.margin[3],-st+ct+this.ctx.prevPageLastElemOffset),I===!1||$e===0){var ut=($e>Be||$e<He)&&p.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,mt,null).clip().discardPath()),P.call(this,S,I),ut&&this.pdf.restoreGraphicsState()}this.lineWidth=G}this.path=z}else this.lineWidth=R,P.call(this,S,I),this.lineWidth=G},P=function(S,I){if((S!=="stroke"||I||!m.call(this))&&(S==="stroke"||I||!h.call(this))){for(var V,j,U=[],G=this.path,R=0;R<G.length;R++){var X=G[R];switch(X.type){case"begin":U.push({begin:!0});break;case"close":U.push({close:!0});break;case"mt":U.push({start:X,deltas:[],abs:[]});break;case"lt":var se=U.length;if(G[R-1]&&!isNaN(G[R-1].x)&&(V=[X.x-G[R-1].x,X.y-G[R-1].y],se>0)){for(;se>=0;se--)if(U[se-1].close!==!0&&U[se-1].begin!==!0){U[se-1].deltas.push(V),U[se-1].abs.push(X);break}}break;case"bct":V=[X.x1-G[R-1].x,X.y1-G[R-1].y,X.x2-G[R-1].x,X.y2-G[R-1].y,X.x-G[R-1].x,X.y-G[R-1].y],U[U.length-1].deltas.push(V);break;case"qct":var ye=G[R-1].x+2/3*(X.x1-G[R-1].x),z=G[R-1].y+2/3*(X.y1-G[R-1].y),Me=X.x+2/3*(X.x1-X.x),re=X.y+2/3*(X.y1-X.y),W=X.x,q=X.y;V=[ye-G[R-1].x,z-G[R-1].y,Me-G[R-1].x,re-G[R-1].y,W-G[R-1].x,q-G[R-1].y],U[U.length-1].deltas.push(V);break;case"arc":U.push({deltas:[],abs:[],arc:!0}),Array.isArray(U[U.length-1].abs)&&U[U.length-1].abs.push(X)}}j=I?null:S==="stroke"?"stroke":"fill";for(var oe=!1,de=0;de<U.length;de++)if(U[de].arc)for(var Be=U[de].abs,He=0;He<Be.length;He++){var $e=Be[He];$e.type==="arc"?_.call(this,$e.x,$e.y,$e.radius,$e.startAngle,$e.endAngle,$e.counterclockwise,void 0,I,!oe):O.call(this,$e.x,$e.y),oe=!0}else if(U[de].close===!0)this.pdf.internal.out("h"),oe=!1;else if(U[de].begin!==!0){var Je=U[de].start.x,ct=U[de].start.y;Y.call(this,U[de].deltas,Je,ct),oe=!0}j&&B.call(this,j),I&&M.call(this)}},L=function(S){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return S-V;case"top":return S+I-V;case"hanging":return S+I-2*V;case"middle":return S+I/2-V;default:return S}},E=function(S){return S+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var S=function(){};return S.colorStops=[],S.addColorStop=function(I,V){this.colorStops.push([I,V])},S.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},S.isCanvasGradient=!0,S},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var _=function(S,I,V,j,U,G,R,X,se){for(var ye=ae.call(this,V,j,U,G),z=0;z<ye.length;z++){var Me=ye[z];z===0&&(se?F.call(this,Me.x1+S,Me.y1+I):O.call(this,Me.x1+S,Me.y1+I)),me.call(this,S,I,Me.x2,Me.y2,Me.x3,Me.y3,Me.x4,Me.y4)}X?M.call(this):B.call(this,R)},B=function(S){switch(S){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(S,I){this.pdf.internal.out(r(S)+" "+n(I)+" m")},T=function(S){var I;switch(S.align){case"right":case"end":I="right";break;case"center":I="center";break;default:I="left"}var V,j,U,G=this.pdf.getTextDimensions(S.text),R=L.call(this,S.y),X=E.call(this,R)-G.h,se=this.ctx.transform.applyToPoint(new o(S.x,R));if(this.autoPaging){var ye=this.ctx.transform.decompose(),z=new c;z=(z=(z=z.multiply(ye.translate)).multiply(ye.skew)).multiply(ye.scale);for(var Me=this.ctx.transform.applyToRectangle(new l(S.x,R,G.w,G.h)),re=z.applyToRectangle(new l(S.x,X,G.w,G.h)),W=x.call(this,re),q=[],oe=0;oe<W.length;oe+=1)q.indexOf(W[oe])===-1&&q.push(W[oe]);b(q);for(var de=q[0],Be=q[q.length-1],He=de;He<Be+1;He++){this.pdf.setPage(He);var $e=He===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[2],at=ct-this.margin[0],mt=this.pdf.internal.pageSize.width-this.margin[1],st=mt-this.margin[3],Le=He===1?0:Je+(He-2)*at;if(this.ctx.clip_path.length!==0){var ut=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(V,this.posX+this.margin[3],-1*Le+$e),P.call(this,"fill",!0),this.path=ut}var be=w([JSON.parse(JSON.stringify(re))],this.posX+this.margin[3],-Le+$e+this.ctx.prevPageLastElemOffset)[0];S.scale>=.01&&(j=this.pdf.internal.getFontSize(),this.pdf.setFontSize(j*S.scale),U=this.lineWidth,this.lineWidth=U*S.scale);var ge=this.autoPaging!=="text";if(ge||be.y+be.h<=ct){if(ge||be.y>=$e&&be.x<=mt){var K=ge?S.text:this.pdf.splitTextToSize(S.text,S.maxWidth||mt-be.x)[0],_e=w([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-Le+$e+this.ctx.prevPageLastElemOffset)[0],Oe=ge&&(He>de||He<Be)&&p.call(this);Oe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],st,at,null).clip().discardPath()),this.pdf.text(K,_e.x,_e.y,{angle:S.angle,align:I,renderingMode:S.renderingMode}),Oe&&this.pdf.restoreGraphicsState()}}else be.y<ct&&(this.ctx.prevPageLastElemOffset+=ct-be.y);S.scale>=.01&&(this.pdf.setFontSize(j),this.lineWidth=U)}}else S.scale>=.01&&(j=this.pdf.internal.getFontSize(),this.pdf.setFontSize(j*S.scale),U=this.lineWidth,this.lineWidth=U*S.scale),this.pdf.text(S.text,se.x+this.posX,se.y+this.posY,{angle:S.angle,align:I,renderingMode:S.renderingMode,maxWidth:S.maxWidth}),S.scale>=.01&&(this.pdf.setFontSize(j),this.lineWidth=U)},O=function(S,I,V,j){V=V||0,j=j||0,this.pdf.internal.out(r(S+V)+" "+n(I+j)+" l")},Y=function(S,I,V){return this.pdf.lines(S,I,V,null,null)},me=function(S,I,V,j,U,G,R,X){this.pdf.internal.out([e(s(V+S)),e(a(j+I)),e(s(U+S)),e(a(G+I)),e(s(R+S)),e(a(X+I)),"c"].join(" "))},ae=function(S,I,V,j){for(var U=2*Math.PI,G=Math.PI/2;I>V;)I-=U;var R=Math.abs(V-I);R<U&&j&&(R=U-R);for(var X=[],se=j?-1:1,ye=I;R>1e-5;){var z=ye+se*Math.min(R,G);X.push(fe.call(this,S,ye,z)),R-=Math.abs(z-ye),ye=z}return X},fe=function(S,I,V){var j=(V-I)/2,U=S*Math.cos(j),G=S*Math.sin(j),R=U,X=-G,se=R*R+X*X,ye=se+R*U+X*G,z=4/3*(Math.sqrt(2*se*ye)-ye)/(R*G-X*U),Me=R-z*X,re=X+z*R,W=Me,q=-re,oe=j+I,de=Math.cos(oe),Be=Math.sin(oe);return{x1:S*Math.cos(I),y1:S*Math.sin(I),x2:Me*de-re*Be,y2:Me*Be+re*de,x3:W*de-q*Be,y3:W*Be+q*de,x4:S*Math.cos(V),y4:S*Math.sin(V)}},he=function(S){return 180*S/Math.PI},te=function(S,I,V,j,U,G){var R=S+.5*(V-S),X=I+.5*(j-I),se=U+.5*(V-U),ye=G+.5*(j-G),z=Math.min(S,U,R,se),Me=Math.max(S,U,R,se),re=Math.min(I,G,X,ye),W=Math.max(I,G,X,ye);return new l(z,re,Me-z,W-re)},pe=function(S,I,V,j,U,G,R,X){var se,ye,z,Me,re,W,q,oe,de,Be,He,$e,Je,ct,at=V-S,mt=j-I,st=U-V,Le=G-j,ut=R-U,be=X-G;for(ye=0;ye<41;ye++)de=(q=(z=S+(se=ye/40)*at)+se*((re=V+se*st)-z))+se*(re+se*(U+se*ut-re)-q),Be=(oe=(Me=I+se*mt)+se*((W=j+se*Le)-Me))+se*(W+se*(G+se*be-W)-oe),ye==0?(He=de,$e=Be,Je=de,ct=Be):(He=Math.min(He,de),$e=Math.min($e,Be),Je=Math.max(Je,de),ct=Math.max(ct,Be));return new l(Math.round(He),Math.round($e),Math.round(Je-He),Math.round(ct-$e))},Ie=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var S,I,V=(S=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:S,lineDashOffset:I}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(or.API),function(t){var e=function(o){var l,c,A,u,d,f,h,m,p,x;for(c=[],A=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>A;A+=4)(d=(o.charCodeAt(A)<<24)+(o.charCodeAt(A+1)<<16)+(o.charCodeAt(A+2)<<8)+o.charCodeAt(A+3))!==0?(f=(d=((d=((d=((d=(d-(x=d%85))/85)-(p=d%85))/85)-(m=d%85))/85)-(h=d%85))/85)%85,c.push(f+33,h+33,m+33,p+33,x+33)):c.push(122);return function(g,w){for(var b=w;b>0;b--)g.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,A,u,d,f=String,h="length",m=255,p="charCodeAt",x="slice",g="replace";for(o[x](-2),o=o[x](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),A=[],u=0,d=(o+=l="uuuuu"[x](o[h]%5||5))[h];d>u;u+=5)c=52200625*(o[p](u)-33)+614125*(o[p](u+1)-33)+7225*(o[p](u+2)-33)+85*(o[p](u+3)-33)+(o[p](u+4)-33),A.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(w,b){for(var k=b;k>0;k--)w.pop()}(A,l[h]),f.fromCharCode.apply(f,A)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",A=0;A<o.length;A+=2)c+=String.fromCharCode("0x"+(o[A]+o[A+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=xE(l)).reduce(function(A,u){return A+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,l){var c=0,A=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":A=r(A),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=e(A),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=s(A),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=n(A),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=a(A),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:A,reverseChain:u.reverse().join(" ")}}}(or.API),function(t){t.loadFile=function(e,r,n){return function(s,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,A,u){var d=new XMLHttpRequest,f=0,h=function(m){var p=m.length,x=[],g=String.fromCharCode;for(f=0;f<p;f+=1)x.push(g(255&m.charCodeAt(f)));return x.join("")};if(d.open("GET",c,!A),d.overrideMimeType("text/plain; charset=x-user-defined"),A===!1&&(d.onload=function(){d.status===200?u(h(this.responseText)):u(void 0)}),d.send(null),A&&d.status===200)return h(d.responseText)}(s,a,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(or.API),function(t){function e(){return(Ir.html2canvas?Promise.resolve(Ir.html2canvas):pA(()=>Promise.resolve().then(()=>XS),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Ir.DOMPurify?Promise.resolve(Ir.DOMPurify):pA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Sn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var A=document.createElement(l);for(var u in c.className&&(A.className=c.className),c.innerHTML&&c.dompurify&&(A.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)A.style[u]=c.style[u];return A},a=function l(c,A){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)A!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||u.appendChild(l(d,A));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var A=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),A);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(A){switch(n(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(A){return this.set({src:s("div",{innerHTML:l,dompurify:A})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,c(this.prop.container,A)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var A=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var m=u[h],p=m.src.find(function(x){return x.format==="truetype"});p&&A.addFont(p.url,m.ref.name,m.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,A.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(A){if(A in o.template.prop)return function(){this.prop[A]=l[A]};switch(A){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[A]=l[A]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var A=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(A):A})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(A,u){return Math.floor(A*u/72*96)}return this.then(function(){(l=l||or.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,A,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),A!=null&&(this.progress.n=A),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,A,u){return this.setProgress(l?this.progress.val+l:null,c||null,A?this.progress.n+A:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var A=this;return this.thenCore(l,c,function(u,d){return A.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(f){return A.updateProgress(null,u),f}).then(u,d).then(function(f){return A.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,A){A=A||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),f=A.call(d,l,c);return o.convert(f,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(A){c=c.thenCore(A)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,or.getPageSize=function(l,c,A){if(Sn(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,A=u.format||A}c=c||"mm",A=A||"a4",l=(""+(l||"P")).toLowerCase();var d,f=(""+A).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(f))p=h[f][1]/d,x=h[f][0]/d;else try{p=A[1],x=A[0]}catch{throw new Error("Invalid format: "+A)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:d,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(VN):null;var A=new o(c);return c.worker?A:A.from(l).doCallback()}}(or.API),or.API.addJS=function(t){return Rj=t,this.internal.events.subscribe("postPutResources",function(){h1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(h1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Pj=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Rj+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){h1!==void 0&&Pj!==void 0&&this.internal.out("/Names <</JavaScript "+h1+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var o=s[a],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var A=this.internal.pages.length,u=[];for(a=0;a<A;a++){var d=r.internal.newObject();u.push(d);var f=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<u.length;a++)r.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var o={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var A=0;A<n.children.length;A++)this.renderItems(n.children[A])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(or.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,a,o,l){var c,A=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(d){for(var f,h=256*d.charCodeAt(4)+d.charCodeAt(5),m=d.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(d.charCodeAt(x+1))!==-1){f=256*d.charCodeAt(x+5)+d.charCodeAt(x+6),p={width:256*d.charCodeAt(x+7)+d.charCodeAt(x+8),height:f,numcomponents:d.charCodeAt(x+9)};break}h=256*d.charCodeAt(x+2)+d.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:A,index:n,alias:s}}return u}}(or.API),or.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var s,a=Hie(t,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,A=a.palette,u=a.depth;s=A&&c===1?function(_){for(var B=_.width,M=_.height,F=_.data,T=_.palette,O=_.depth,Y=!1,me=[],ae=[],fe=void 0,he=!1,te=0,pe=0;pe<T.length;pe++){var Ie=OT(T[pe],4),S=Ie[0],I=Ie[1],V=Ie[2],j=Ie[3];me.push(S,I,V),j!=null&&(j===0?(te++,ae.length<1&&ae.push(pe)):j<255&&(he=!0))}if(he||te>1){Y=!0,ae=void 0;var U=B*M;fe=new Uint8Array(U);for(var G=new DataView(F.buffer),R=0;R<U;R++){var X=KN(G,R,O),se=OT(T[X],4)[3];fe[R]=se}}else te===0&&(ae=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Y?8:void 0,colorBytes:F,alphaBytes:fe,needSMask:Y,palette:me,mask:ae}}(a):c===2||c===4?function(_){for(var B=_.data,M=_.width,F=_.height,T=_.channels,O=_.depth,Y=T===2?"DeviceGray":"DeviceRGB",me=T-1,ae=M*F,fe=me,he=ae*fe,te=1*ae,pe=Math.ceil(he*O/8),Ie=Math.ceil(te*O/8),S=new Uint8Array(pe),I=new Uint8Array(Ie),V=new DataView(B.buffer),j=new DataView(S.buffer),U=new DataView(I.buffer),G=!1,R=0;R<ae;R++){for(var X=R*T,se=0;se<fe;se++)Kj(j,KN(V,X+se,O),R*fe+se,O);var ye=KN(V,X+fe,O);ye<(1<<O)-1&&(G=!0),Kj(U,ye,1*R,O)}return{colorSpace:Y,colorsPerPixel:me,sMaskBitsPerComponent:G?O:void 0,colorBytes:S,alphaBytes:I,needSMask:G}}(a):function(_){var B=_.data,M=_.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:M,colorsPerPixel:M==="DeviceGray"?1:3,colorBytes:B instanceof Uint16Array?function(F){for(var T=F.length,O=new Uint8Array(2*T),Y=new DataView(O.buffer,O.byteOffset,O.byteLength),me=0;me<T;me++)Y.setUint16(2*me,F[me],!1);return O}(B):B,needSMask:!1}}(a);var d,f,h,m=s,p=m.colorSpace,x=m.colorsPerPixel,g=m.sMaskBitsPerComponent,w=m.colorBytes,b=m.alphaBytes,k=m.needSMask,P=m.palette,L=m.mask,E=null;return n!==or.API.image_compression.NONE&&typeof xE=="function"?(E=function(_){var B;switch(_){case or.API.image_compression.FAST:B=11;break;case or.API.image_compression.MEDIUM:B=13;break;case or.API.image_compression.SLOW:B=14;break;default:B=12}return B}(n),d=this.decode.FLATE_DECODE,f="/Predictor ".concat(E," /Colors ").concat(x," /BitsPerComponent ").concat(u," /Columns ").concat(o),t=Oj(w,Math.ceil(o*x*u/8),x,u,n),k&&(h=Oj(b,Math.ceil(o*g/8),1,g,n))):(d=void 0,f=void 0,t=w,k&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:d,decodeParameters:f,transparency:L,palette:P,sMask:h,predictor:E,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:g,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,s){var a=new uoe(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var A={data:c,width:o,height:l},u=new qN(100).encode(A,100);return t.processJPEG.call(this,u,r,n,s)},t.processGIF87A=t.processGIF89A}(or.API),_l.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},_l.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Vn.log("bit decode error:"+r)}},_l.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},_l.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=a>>4,c=15&a,A=this.palette[l];if(this.data[o]=A.blue,this.data[o+1]=A.green,this.data[o+2]=A.red,this.data[o+3]=255,2*s+1>=this.width)break;A=this.palette[c],this.data[o+4]=A.blue,this.data[o+4+1]=A.green,this.data[o+4+2]=A.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},_l.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},_l.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,A=a>>15?255:0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=A}this.pos+=t}},_l.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,A=(o>>11)/e*255|0,u=s*this.width*4+4*a;this.data[u]=A,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},_l.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},_l.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},_l.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,s){var a=new _l(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new qN(100).encode(c,100);return t.processJPEG.call(this,A,r,n,s)}}(or.API),Gj.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,s){var a=new Gj(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new qN(100).encode(c,100);return t.processJPEG.call(this,A,r,n,s)}}(or.API),or.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,a=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,A=0;A<s;A+=4){var u=n[A],d=n[A+1],f=n[A+2],h=n[A+3];a[l++]=u,a[l++]=d,a[l++]=f,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},or.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},If=or.API,f1=If.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,A=e.kerning?e.kerning:s.metadata.Unicode.kerning,u=A.fof?A.fof:1,d=e.doKerning!==!1,f=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?x.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(f=d&&Sn(A[n])==="object"&&!isNaN(parseInt(A[n][m],10))?A[n][m]/u:0,x.push((l[n]||p)/c+f)),m=n;return x},Dj=If.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return If.processArabic&&(t=If.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:f1.apply(this,arguments).reduce(function(a,o){return a+o},0)},Lj=function(t,e,r,n){for(var s=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<r;)l+=e[a],a++;s.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>n&&(s.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&s.push(t.slice(c,a)),s},Uj=function(t,e,r){r||(r={});var n,s,a,o,l,c,A,u=[],d=[u],f=r.textIndent||0,h=0,m=0,p=t.split(" "),x=f1.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var g=Array(c).join(" "),w=[];p.map(function(k){(k=k.split(/\s*\n/)).length>1?w=w.concat(k.map(function(P,L){return(L&&P.length?`
`:"")+P})):w.push(k[0])}),p=w,c=Dj.apply(this,[g,r])}for(a=0,o=p.length;a<o;a++){var b=0;if(n=p[a],c&&n[0]==`
`&&(n=n.substr(1),b=1),f+h+(m=(s=f1.apply(this,[n,r])).reduce(function(k,P){return k+P},0))>e||b){if(m>e){for(l=Lj.apply(this,[n,s,e-(f+h),e]),u.push(l.shift()),u=[l.pop()];l.length;)d.push([l.shift()]);m=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(k,P){return k+P},0)}else u=[n];d.push(u),f=m+c,h=x}else u.push(n),f+=h+m,h=x}return A=c?function(k,P){return(P?g:"")+k.join(" ")}:function(k){return k.join(" ")},d.map(A)},If.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle),f="Unicode";return d.metadata[f]?{widths:d.metadata[f].widths||{0:1},kerning:d.metadata[f].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var l,c,A=[];for(l=0,c=n.length;l<c;l++)A=A.concat(Uj.apply(this,[n[l],o,a]));return A},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=e[a],s[e[a]]=r[a];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=t.__fontmetrics__.compress=function(f){var h,m,p,x,g=["{"];for(var w in f){if(h=f[w],isNaN(parseInt(w,10))?m="'"+w+"'":(w=parseInt(w,10),m=(m=o(w).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+s[p.slice(-1)];else{if(Sn(h)!=="object")throw new Error("Don't know what to do with value type "+Sn(h)+".");p=l(h)}g.push(m+p)}return g.push("}"),g.join("")},c=t.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,g={},w=1,b=g,k=[],P="",L="",E=f.length-1,_=1;_<E;_+=1)(x=f[_])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(k.push([b,p]),b={},p=void 0):x=="}"?((m=k.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?w=-1:p===void 0?n.hasOwnProperty(x)?(P+=n[x],p=parseInt(P,16)*w,w=1,P=""):P+=x:n.hasOwnProperty(x)?(L+=n[x],b[p]=parseInt(L,16)*w,w=1,p=void 0,L=""):L+=x;return g},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(f){var h=f.font,m=d.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=u.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(or.API),function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(gy(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(or),or.API.addSvgAsImage=function(t,e,r,n,s,a,o,l){if(isNaN(e)||isNaN(r))throw Vn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Vn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var A=c.getContext("2d");A.fillStyle="#fff",A.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(Ir.canvg?Promise.resolve(Ir.canvg):pA(()=>import("./index.es-B1YTJEy5.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(A,t,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(u)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),e,r,n,s,o,l)})},or.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},or.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],A=0,u=0,d=0;function f(m,p){var x,g=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(g=!0);return g}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(d=0;d<h;d+=1)r[l[d]].value=r[l[d]].defaultValue,r[l[d]].explicitSet=!1}if(Sn(t)==="object"){for(s in t)if(a=t[s],f(l,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&f(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(A=0;A<a.length;A+=1)if(n=!0,a[A].length===1&&typeof a[A][0]=="number")c.push(String(a[A]-1));else if(a[A].length>1){for(u=0;u<a[A].length;u+=1)typeof a[A][u]!="number"&&(n=!1);n===!0&&c.push([a[A][0]-1,a[A][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),A=a.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+A+" >>"),this.internal.write("stream"),this.internal.write(s+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(or.API),function(t){var e=t.API,r=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,A=["","0","00","000","0000"],u=[""],d=0,f=a.length;d<f;++d){if(l=o.metadata.characterToGlyph(a.charCodeAt(d)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(d),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(A[4-l.length],l)}return u.join("")},n=function(a){var o,l,c,A,u,d,f;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,f=(l=Object.keys(a).sort(function(h,m){return h-m})).length;d<f;d++)o=l[d],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(A=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+A+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var d=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<f.length;m++)h+=String.fromCharCode(f[m]);var p=A();u({data:h,addLength1:!0,objectId:p}),c("endobj");var x=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var g=A();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Gf(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var w=A();c("<<"),c("/Type /Font"),c("/BaseFont /"+Gf(l.fontName)),c("/FontDescriptor "+g+" 0 R"),c("/W "+t.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=A(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+Gf(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+w+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var d=l.metadata.rawData,f="",h=0;h<d.length;h++)f+=String.fromCharCode(d[h]);var m=A();u({data:f,addLength1:!0,objectId:m}),c("endobj");var p=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=A();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Gf(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=A();for(var g=0;g<l.metadata.hmtx.widths.length;g++)l.metadata.hmtx.widths[g]=parseInt(l.metadata.hmtx.widths[g]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Gf(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var s=function(a){var o,l=a.text||"",c=a.x,A=a.y,u=a.options||{},d=a.mutex||{},f=d.pdfEscape,h=d.activeFontKey,m=d.fonts,p=h,x="",g=0,w="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:A,options:u,mutex:d};for(w=l,p=h,Array.isArray(l)&&(w=l[0]),g=0;g<w.length;g+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[w[g].charCodeAt(0)]),o||w[g].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=w[g]:x+="";var k="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?k=f(x,p).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(k=r(x,m[p])),d.isHex=!0,{text:k,x:c,y:A,options:u,mutex:d}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var A=0;for(A=0;A<o.length;A+=1)Array.isArray(o[A])&&o[A].length===3?l.push([s(Object.assign({},c,{text:o[A][0]})).text,o[A][1],o[A][2]]):l.push(s(Object.assign({},c,{text:o[A]})).text);a.text=l}else a.text=s(Object.assign({},c,{text:o})).text}])}(or),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(or.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,a,o,l,c,A,u,d=e,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,b=0;this.__bidiEngine__={};var k=function(F){var T=F.charCodeAt(),O=T>>8,Y=p[O];return Y!==void 0?d[256*Y+(255&T)]:O===252||O===253?"AL":g.test(O)?"L":O===8?"R":"N"},P=function(F){for(var T,O=0;O<F.length;O++){if((T=k(F.charAt(O)))==="L")return!1;if(T==="R")return!0}return!1},L=function(F,T,O,Y){var me,ae,fe,he,te=T[Y];switch(te){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"N":case"AN":break;case"EN":w&&(te="AN");break;case"AL":w=!0,te="R";break;case"WS":case"BN":te="N";break;case"CS":Y<1||Y+1>=T.length||(me=O[Y-1])!=="EN"&&me!=="AN"||(ae=T[Y+1])!=="EN"&&ae!=="AN"?te="N":w&&(ae="AN"),te=ae===me?ae:"N";break;case"ES":te=(me=Y>0?O[Y-1]:"B")==="EN"&&Y+1<T.length&&T[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&O[Y-1]==="EN"){te="EN";break}if(w){te="N";break}for(fe=Y+1,he=T.length;fe<he&&T[fe]==="ET";)fe++;te=fe<he&&T[fe]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(he=T.length,fe=Y+1;fe<he&&T[fe]==="NSM";)fe++;if(fe<he){var pe=F[Y],Ie=pe>=1425&&pe<=2303||pe===64286;if(me=T[fe],Ie&&(me==="R"||me==="AL")){te="R";break}}}te=Y<1||(me=T[Y-1])==="B"?"N":O[Y-1];break;case"B":w=!1,s=!0,te=b;break;case"S":a=!0,te="N"}return te},E=function(F,T,O){var Y=F.split("");return O&&_(Y,O,{hiLevel:b}),Y.reverse(),T&&T.reverse(),Y.join("")},_=function(F,T,O){var Y,me,ae,fe,he,te=-1,pe=F.length,Ie=0,S=[],I=b?h:f,V=[];for(w=!1,s=!1,a=!1,me=0;me<pe;me++)V[me]=k(F[me]);for(ae=0;ae<pe;ae++){if(he=Ie,S[ae]=L(F,V,S,ae),Y=240&(Ie=I[he][m[S[ae]]]),Ie&=15,T[ae]=fe=I[Ie][5],Y>0)if(Y===16){for(me=te;me<ae;me++)T[me]=1;te=-1}else te=-1;if(I[Ie][6])te===-1&&(te=ae);else if(te>-1){for(me=te;me<ae;me++)T[me]=fe;te=-1}V[ae]==="B"&&(T[ae]=0),O.hiLevel|=fe}a&&function(j,U,G){for(var R=0;R<G;R++)if(j[R]==="S"){U[R]=b;for(var X=R-1;X>=0&&j[X]==="WS";X--)U[X]=b}}(V,T,pe)},B=function(F,T,O,Y,me){if(!(me.hiLevel<F)){if(F===1&&b===1&&!s)return T.reverse(),void(O&&O.reverse());for(var ae,fe,he,te,pe=T.length,Ie=0;Ie<pe;){if(Y[Ie]>=F){for(he=Ie+1;he<pe&&Y[he]>=F;)he++;for(te=Ie,fe=he-1;te<fe;te++,fe--)ae=T[te],T[te]=T[fe],T[fe]=ae,O&&(ae=O[te],O[te]=O[fe],O[fe]=ae);Ie=he}Ie++}}},M=function(F,T,O){var Y=F.split(""),me={hiLevel:b};return O||(O=[]),_(Y,O,me),function(ae,fe,he){if(he.hiLevel!==0&&u)for(var te,pe=0;pe<ae.length;pe++)fe[pe]===1&&(te=x.indexOf(ae[pe]))>=0&&(ae[pe]=x[te+1])}(Y,O,me),B(2,Y,T,O,me),B(1,Y,T,O,me),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(F,T,O){if(function(me,ae){if(ae)for(var fe=0;fe<me.length;fe++)ae[fe]=fe;l===void 0&&(l=P(me)),A===void 0&&(A=P(me))}(F,T),o||!c||A)if(o&&c&&l^A)b=l?1:0,F=E(F,T,O);else if(!o&&c&&A)b=l?1:0,F=M(F,T,O),F=E(F,T);else if(!o||l||c||A){if(o&&!c&&l^A)F=E(F,T),l?(b=0,F=M(F,T,O)):(b=1,F=M(F,T,O),F=E(F,T));else if(o&&l&&!c&&A)b=1,F=M(F,T,O),F=E(F,T);else if(!o&&!c&&l^A){var Y=u;l?(b=1,F=M(F,T,O),b=0,u=!1,F=M(F,T,O),u=Y):(b=0,F=M(F,T,O),F=E(F,T),b=1,u=!1,F=M(F,T,O),u=Y,F=E(F,T))}}else b=0,F=M(F,T,O);else b=l?1:0,F=M(F,T,O);return F},this.__bidiEngine__.setOptions=function(F){F&&(o=F.isInputVisual,c=F.isOutputVisual,l=F.isInputRtl,A=F.isOutputRtl,u=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(or),or.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new od(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Eoe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new doe(this.contents),this.head=new foe(this),this.name=new voe(this),this.cmap=new JM(this),this.toUnicode={},this.hhea=new moe(this),this.maxp=new yoe(this),this.hmtx=new woe(this),this.post=new goe(this),this.os2=new poe(this),this.loca=new _oe(this),this.glyf=new boe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,A;for(A=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],A.push(Math.round(e*this.scaleFactor));return A}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)s=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Jl,od=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,a,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,a;for(a=[],n=0,s=e.length;n<s;n++)r=e[n],a.push(this.writeByte(r));return a},t}(),doe=function(){var t;function e(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,a,o,l,c,A,u,d,f,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),d=16*Math.floor(Math.log(h)/c),o=Math.floor(d/c),u=16*h-d,(s=new od).writeInt(this.scalarType),s.writeShort(h),s.writeShort(d),s.writeShort(o),s.writeShort(u),a=16*h,A=s.pos+a,l=null,m=[],r)for(f=r[p],s.writeString(p),s.writeInt(t(f)),s.writeInt(A),s.writeInt(f.length),m=m.concat(f),p==="head"&&(l=A),A+=f.length;A%4;)m.push(0),A++;return s.write(m),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,a,o;for(r=XM.call(r);r.length%4;)r.push(0);for(a=new od(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=a.readUInt32();return 4294967295&s},e}(),hoe={}.hasOwnProperty,Fc=function(t,e){for(var r in e)hoe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Jl=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var foe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new od).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),$j=function(){function t(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,w,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),f=h/2,e.pos+=6,a=function(){var k,P;for(P=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)P.push(e.readUInt16());return P}(),e.pos+=2,p=function(){var k,P;for(P=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)P.push(e.readUInt16());return P}(),A=function(){var k,P;for(P=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)P.push(e.readUInt16());return P}(),u=function(){var k,P;for(P=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)P.push(e.readUInt16());return P}(),s=(this.length-e.pos+this.offset)/2,l=function(){var k,P;for(P=[],c=k=0;0<=s?k<s:k>s;c=0<=s?++k:--k)P.push(e.readUInt16());return P}(),c=g=0,b=a.length;g<b;c=++g)for(x=a[c],n=w=m=p[c];m<=x?w<=x:w>=x;n=m<=x?++w:--w)u[c]===0?o=n+A[c]:(o=l[u[c]/2+(n-m)-(f-c)]||0)!==0&&(o+=A[c]),this.codeMap[n]=65535&o}e.pos=d}return t.encode=function(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g,w,b,k,P,L,E,_,B,M,F,T,O,Y,me,ae,fe,he,te,pe,Ie,S,I,V,j,U,G,R,X,se,ye,z;switch(Y=new od,o=Object.keys(e).sort(function(Me,re){return Me-re}),r){case"macroman":for(p=0,x=function(){var Me=[];for(m=0;m<256;++m)Me.push(0);return Me}(),w={0:0},a={},me=0,te=o.length;me<te;me++)w[X=e[s=o[me]]]==null&&(w[X]=++p),a[s]={old:e[s],new:w[e[s]]},x[s]=w[e[s]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(x),{charMap:a,subtable:Y.data,maxGlyphID:p+1};case"unicode":for(T=[],d=[],b=0,w={},n={},g=A=null,ae=0,pe=o.length;ae<pe;ae++)w[P=e[s=o[ae]]]==null&&(w[P]=++b),n[s]={old:P,new:w[P]},l=w[P]-s,g!=null&&l===A||(g&&d.push(g),T.push(s),A=l),g=s;for(g&&d.push(g),d.push(65535),T.push(65535),M=2*(B=T.length),_=2*Math.pow(Math.log(B)/Math.LN2,2),f=Math.log(_/2)/Math.LN2,E=2*B-_,c=[],L=[],h=[],m=fe=0,Ie=T.length;fe<Ie;m=++fe){if(F=T[m],u=d[m],F===65535){c.push(0),L.push(0);break}if(F-(O=n[F].new)>=32768)for(c.push(0),L.push(2*(h.length+B-m)),s=he=F;F<=u?he<=u:he>=u;s=F<=u?++he:--he)h.push(n[s].new);else c.push(O-F),L.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*B+2*h.length),Y.writeUInt16(0),Y.writeUInt16(M),Y.writeUInt16(_),Y.writeUInt16(f),Y.writeUInt16(E),G=0,S=d.length;G<S;G++)s=d[G],Y.writeUInt16(s);for(Y.writeUInt16(0),R=0,I=T.length;R<I;R++)s=T[R],Y.writeUInt16(s);for(se=0,V=c.length;se<V;se++)l=c[se],Y.writeUInt16(l);for(ye=0,j=L.length;ye<j;ye++)k=L[ye],Y.writeUInt16(k);for(z=0,U=h.length;z<U;z++)p=h[z],Y.writeUInt16(p);return{charMap:n,subtable:Y.data,maxGlyphID:b+1}}},t}(),JM=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new $j(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,s;return r==null&&(r="macroman"),n=$j.encode(e,r),(s=new od).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t}(),moe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),poe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),goe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)r=e.readByte(),s.push(this.names.push(e.readString(r)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),xoe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},voe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,s,a,o,l,c,A,u,d,f;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},a=u=0,d=n.length;u<d;a=++u)s=n[a],e.pos=s.offset,A=e.readString(s.length),o=new xoe(A,s),c[f=s.nameID]==null&&(c[f]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),yoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),woe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,s,a,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var A,u;for(u=[],r=A=0;0<=s?A<s:A>s;r=0<=s?++A:--A)u.push(e.readInt16());return u}(),this.widths=(function(){var A,u,d,f;for(f=[],A=0,u=(d=this.metrics).length;A<u;A++)a=d[A],f.push(a.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),XM=[].slice,boe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,s,a,o,l,c,A,u,d;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new od(r.read(s))).readShort(),A=l.readShort(),d=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[e]=o===-1?new Coe(l,A,d,c,u):new Noe(l,o,A,d,c,u),this.cache[e]))},t.prototype.encode=function(e,r,n){var s,a,o,l,c;for(o=[],a=[],l=0,c=r.length;l<c;l++)s=e[r[l]],a.push(o.length),s&&(o=o.concat(s.encode(n)));return a.push(o.length),{table:o,offsets:a}},t}(),Noe=function(){function t(e,r,n,s,a,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),Coe=function(){function t(e,r,n,s,a){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new od(XM.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),_oe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Fc(t,Jl),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<n.length;++o)if(n[o]=s,a<r.length&&r[a]==o){++a,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var A=new Array(4*n.length),u=0;u<n.length;++u)A[4*u+3]=255&n[u],A[4*u+2]=(65280&n[u])>>8,A[4*u+1]=(16711680&n[u])>>16,A[4*u]=(4278190080&n[u])>>24;return A},t}(),Eoe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,a,o,l,c;for(s={},o=0,l=e.length;o<l;o++)s[a=e[o]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},t.prototype.encode=function(e,r){var n,s,a,o,l,c,A,u,d,f,h,m,p,x,g;for(s in n=JM.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},g=n.charMap)h[(c=g[s]).old]=c.new;for(m in f=n.maxGlyphID,o)m in h||(h[m]=f++);return u=function(w){var b,k;for(b in k={},w)k[w[b]]=b;return k}(h),d=Object.keys(u).sort(function(w,b){return w-b}),p=function(){var w,b,k;for(k=[],w=0,b=d.length;w<b;w++)l=d[w],k.push(u[l]);return k}(),a=this.font.glyf.encode(o,p,h),A=this.font.loca.encode(a.offsets,p),x={cmap:this.font.cmap.raw(),glyf:a.table,loca:A,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();or.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,a,o;if(Array.isArray(r))return"["+function(){var l,c,A;for(A=[],l=0,c=r.length;l<c;l++)n=r[l],A.push(e.convert(n));return A}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)o=r[s],a.push("/"+s+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+r},e}();const EE=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:noe,AcroFormAppearance:ur,AcroFormButton:ua,AcroFormCheckBox:Zp,AcroFormChoiceField:uh,AcroFormComboBox:hh,AcroFormEditBox:Xp,AcroFormListBox:dh,AcroFormPasswordField:eg,AcroFormPushButton:Yp,AcroFormRadioButton:fh,AcroFormTextField:Xu,GState:Jg,ShadingPattern:Eu,TilingPattern:sh,default:or,jsPDF:or},Symbol.toStringTag,{value:"Module"}));async function zj(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:Gt.now()};return Jr(At(je,"inventory_batches"),e)}async function YM(t,e){await Tr(Tt(je,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:Gt.now()})}async function Boe(t,e){const r=Ot(At(je,"batch_allocations"),$t("saleDate",">=",t),$t("saleDate","<=",e)),n=await Ct(r),s={};return n.forEach(a=>{const o=a.data(),l=o.batchId;s[l]||(s[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),s[l].quantity+=Number(o.quantity||0),s[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(s)}async function Soe(t){const e=Tt(je,"salesV2",t),r=await Xa(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const A=String((c==null?void 0:c.batchId)||"").trim(),u=Number((c==null?void 0:c.qty)||0);A&&u&&s.push({batchId:A,qty:u})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),A=Number((l==null?void 0:l.qty)||0);c&&A&&s.push({batchId:c,qty:A})}if(s.length===0)return await ma(je,async l=>{l.delete(e)}),{restored:0};const a=new Map;for(const l of s)a.set(l.batchId,Number((a.get(l.batchId)||0)+l.qty));let o=0;return await ma(je,async l=>{const c=Array.from(a.entries()),A=c.map(([d])=>Tt(je,"inventory_batches",d)),u=await Promise.all(A.map(d=>l.get(d)));c.forEach(([d,f],h)=>{const m=u[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),g=Number((x+Number(f||0)).toFixed(3));l.update(A[h],{remaining:g}),o+=Number(f||0)}),l.delete(e)}),{restored:o}}function Xl(){const[t,e]=N.useState(0),r=N.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const Jo=t=>Math.round((Number(t)||0)*100)/100,m1=t=>Math.round((Number(t)||0)*1e3)/1e3,tp=t=>Number(t??0).toFixed(2),GN=t=>Number(t??0).toFixed(3),Wj=(t,e)=>{var n;const r=t.date??((n=t.timestamp)!=null&&n.toDate?sr(t.timestamp.toDate(),"yyyy-MM-dd"):"");return r?Array.isArray(t.items)&&t.items.length>0?t.items.map((s,a)=>{const o=Number((s==null?void 0:s.qty)??0),l=Number((s==null?void 0:s.lineFinal)??0)||Math.max(0,Number((s==null?void 0:s.unitPrice)||0)*o-Number((s==null?void 0:s.discount)||0));return{id:`${e}#${a}`,productName:String((s==null?void 0:s.productName)??"(sin nombre)"),quantity:o,amount:Jo(l),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(s==null?void 0:s.allocations)?s.allocations:t.allocations,avgUnitCost:Number((s==null?void 0:s.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((s==null?void 0:s.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]:[]};function Ioe({role:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[a,o]=N.useState(null),[l,c]=N.useState(!0),[A,u]=N.useState(""),[d,f]=N.useState("ALL"),[h,m]=N.useState(null),[p,x]=N.useState(0),[g,w]=N.useState(0),[b,k]=N.useState(""),[P,L]=N.useState(0),[E,_]=N.useState("0"),B=sr(new Date,"yyyy-MM-dd"),M=N.useRef(null),{refreshKey:F}=Xl();N.useEffect(()=>{const U=Ot(At(je,"salesV2"),$t("date","==",B)),G=Q0(U,R=>{const X=[];R.forEach(se=>{const ye=Wj(se.data(),se.id);X.push(...ye)}),r(X),c(!1)});return()=>G()},[B,F]),N.useEffect(()=>{const U=Ot(At(je,"salesV2"),$t("status","==","FLOTANTE")),G=Q0(U,R=>{const X=[];R.forEach(se=>{const ye=Wj(se.data(),se.id);X.push(...ye)}),s(X)});return()=>G()},[F]),N.useEffect(()=>{(async()=>{const G=Ot(At(je,"daily_closures"),$t("date","==",B)),R=await Ct(G);if(R.empty)o(null);else{const X=R.docs[0];o({id:X.id,...X.data()})}})()},[B,F]);const T=ui.useMemo(()=>{if(d==="FLOTANTE"){const U=[...e,...n],G=new Map;for(const R of U)R.status==="FLOTANTE"&&G.set(R.id,R);return Array.from(G.values())}if(d==="ALL"){const U=[...e,...n],G=new Map;for(const R of U)G.set(R.id,R);return Array.from(G.values())}return e.filter(U=>U.status==="PROCESADA")},[d,e,n]);Jo(T.reduce((U,G)=>U+(G.amountSuggested||0),0));const O=Jo(T.reduce((U,G)=>U+(G.amount||0),0)),Y=m1(T.reduce((U,G)=>U+(G.quantity||0),0)),me=Jo(T.reduce((U,G)=>U+Number(G.cogsAmount??0),0)),ae=Jo(O-me),fe={};T.forEach(U=>{const G=U.productName||"(sin nombre)";fe[G]||(fe[G]={totalQuantity:0,totalAmount:0}),fe[G].totalQuantity=m1(fe[G].totalQuantity+(U.quantity||0)),fe[G].totalAmount=Jo(fe[G].totalAmount+(U.amount||0))});const he=Object.entries(fe).map(([U,G])=>({productName:U,totalQuantity:G.totalQuantity,totalAmount:G.totalAmount})),te=async()=>{try{const U=T.filter(Me=>Me.status==="FLOTANTE"),G=U.length>0?U:e.filter(Me=>Me.status!=="PROCESADA");if(G.length===0){u("No hay ventas para procesar.");return}const R={totalCharged:Jo(G.reduce((Me,re)=>Me+(re.amount||0),0)),totalSuggested:Jo(G.reduce((Me,re)=>Me+(re.amountSuggested||0),0)),totalUnits:m1(G.reduce((Me,re)=>Me+(re.quantity||0),0)),totalCOGS:Jo(G.reduce((Me,re)=>Me+Number(re.cogsAmount??0),0))},X=Jo(R.totalCharged-R.totalSuggested),se=Jo(R.totalCharged-R.totalCOGS),ye=await Jr(At(je,"daily_closures"),{date:B,createdAt:Gt.now(),totalCharged:R.totalCharged,totalSuggested:R.totalSuggested,totalDifference:X,totalUnits:R.totalUnits,totalCOGS:R.totalCOGS,grossProfit:se,products:G.map(Me=>({productName:Me.productName,quantity:Me.quantity,amount:Me.amount})),salesV2:G.map(Me=>({id:Me.id,productName:Me.productName,quantity:Me.quantity,amount:Me.amount,amountSuggested:Me.amountSuggested,userEmail:Me.userEmail,clientName:Me.clientName,amountReceived:Me.amountReceived,change:Me.change,status:Me.status,cogsAmount:Me.cogsAmount??0,avgUnitCost:Me.avgUnitCost??null,allocations:Me.allocations??[],date:Me.date})),productSummary:Object.entries(G.reduce((Me,re)=>{const W=re.productName||"(sin nombre)";return Me[W]||(Me[W]={totalQuantity:0,totalAmount:0}),Me[W].totalQuantity=m1(Me[W].totalQuantity+(re.quantity||0)),Me[W].totalAmount=Jo(Me[W].totalAmount+(re.amount||0)),Me},{})).map(([Me,re])=>({productName:Me,totalQuantity:re.totalQuantity,totalAmount:re.totalAmount}))}),z=Wh(je);G.forEach(Me=>{z.update(Tt(je,"salesV2",Me.id.split("#")[0]),{status:"PROCESADA",closureId:ye.id,closureDate:B})}),await z.commit(),u(` Cierre guardado. Ventas procesadas: ${G.length}.`)}catch(U){console.error(U),u(" Error al guardar el cierre.")}},pe=async U=>{if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Tr(Tt(je,"salesV2",U.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),u(" Venta revertida a FLOTANTE.")}catch(G){console.error(G),u(" No se pudo revertir la venta.")}},Ie=U=>{m(U),x(U.quantity),w(U.amount),k(U.clientName),L(U.amountReceived),_(U.change)},S=async()=>{if(h)try{await Tr(Tt(je,"salesV2",h.id.split("#")[0]),{quantity:p,amount:g,amountCharged:g,clientName:b,amountReceived:P,change:E}),m(null),u(" Venta actualizada.")}catch(U){console.error(U),u(" No se pudo actualizar la venta.")}},I=async U=>{if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:G}=await Soe(U.split("#")[0]);u(` Venta eliminada. Stock restaurado: ${Number(G).toFixed(2)}.`)}catch(G){console.error(G),u(" No se pudo eliminar la venta.")}},V=async()=>{if(M.current){M.current.classList.add("force-pdf-colors");try{const G=(await Jh(M.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),R=new or;R.addImage(G,"PNG",10,10,190,0),R.save(`cierre_${B}.pdf`)}finally{M.current.classList.remove("force-pdf-colors")}}},j=!t||t==="admin";return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas - ",B]}),i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:d,onChange:U=>f(U.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),l?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:M,children:[i.jsxs("table",{className:"min-w-full border text-sm mb-4  shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[T.map(U=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${U.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:U.status})}),i.jsx("td",{className:"border p-1",children:U.productName}),i.jsx("td",{className:"border p-1",children:GN(U.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",tp(U.amount)]}),i.jsx("td",{className:"border p-1",children:U.date}),i.jsx("td",{className:"border p-1",children:U.userEmail}),i.jsx("td",{className:"border p-1",children:U.status==="FLOTANTE"?i.jsxs("div",{className:"flex gap-2 justify-center",children:[j&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ie(U),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>I(U.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}),!j&&i.jsx("span",{className:"text-gray-400 text-xs",children:""})]}):U.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:j?i.jsx("button",{onClick:()=>pe(U.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},U.id)),T.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm mb-2",children:[i.jsxs("div",{children:[" ","Total Libras/Unidades: ",i.jsx("strong",{children:GN(Y)})]}),i.jsxs("div",{children:[" ","Total cobrado: ",i.jsxs("strong",{children:["C$",tp(O)]})]})]}),(me>0||ae!==O)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:[" ","Calculo a Precio compra:"," ",i.jsxs("strong",{children:["C$",tp(me)]})]}),i.jsxs("div",{children:[" ","Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",tp(ae)]})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[he.map(U=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:U.productName}),i.jsx("td",{className:"border p-1",children:GN(U.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",tp(U.totalAmount)]})]},U.productName)),he.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:te,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:V,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),h&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[h.productName,"  ",h.userEmail]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:p,onChange:U=>x(parseFloat(U.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:g,onChange:U=>w(parseFloat(U.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:b,onChange:U=>k(U.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:P,onChange:U=>L(parseFloat(U.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:E,onChange:U=>_(U.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>m(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:S,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const $o=t=>Number(t??0).toFixed(2),Ff=t=>Number(t??0).toFixed(3);function Foe(){var w,b,k,P;const t=async L=>{if(!window.confirm(`Eliminar el cierre del ${L.date}?`))return;const E=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(E){const _=await Ct(Ot(At(je,"salesV2"),$t("closureId","==",L.id)));if(!_.empty){const B=Wh(je);_.forEach(M=>{B.update(Tt(je,"salesV2",M.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await B.commit()}}await dn(Tt(je,"daily_closures",L.id)),(A==null?void 0:A.id)===L.id&&u(null),await m(),f(` Cierre eliminado${E?" y ventas reabiertas.":"."}`)}catch(_){console.error(_),f(" No se pudo eliminar el cierre.")}},[e,r]=N.useState(sr(nO(new Date),"yyyy-MM-dd")),[n,s]=N.useState(sr(new Date,"yyyy-MM-dd")),[a,o]=N.useState(!0),[l,c]=N.useState([]),[A,u]=N.useState(null),[d,f]=N.useState(""),h=N.useRef(null),m=async()=>{try{o(!0);const L=Ot(At(je,"daily_closures"),$t("date",">=",e),$t("date","<=",n)),E=await Ct(L),_=[];E.forEach(B=>_.push({id:B.id,...B.data()})),_.sort((B,M)=>B.date<M.date?1:B.date>M.date?-1:0),c(_)}catch(L){console.error(L),f(" Error cargando el historial.")}finally{o(!1)}};N.useEffect(()=>{m()},[]);const p=async L=>{L.preventDefault(),m()},x=N.useMemo(()=>{if(!A)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const L=Number(A.totalUnits??0),E=Number(A.totalSuggested??0),_=Number(A.totalCharged??0),B=Number(A.totalDifference??(isFinite(_-E)?_-E:0)),M=Number(A.totalCOGS??0),F=Number(A.grossProfit??(isFinite(_-M)?_-M:0));return{units:L,sug:E,chg:_,diff:B,cogs:M,profit:F}},[A]),g=async()=>{if(!h.current||!A)return;const L=h.current;L.classList.add("force-pdf-colors");try{const[{default:E},{jsPDF:_}]=await Promise.all([pA(()=>Promise.resolve().then(()=>XS),void 0),pA(()=>Promise.resolve().then(()=>EE),void 0)]),M=(await E(L,{backgroundColor:"#ffffff",onclone:O=>{const Y=O.defaultView;O.body.querySelectorAll("*").forEach(ae=>{const fe=Y.getComputedStyle(ae);fe.color&&(ae.style.color=fe.color),fe.backgroundColor&&fe.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ae.style.backgroundColor=fe.backgroundColor),fe.borderColor&&(ae.style.borderColor=fe.borderColor)})}})).toDataURL("image/png"),{jsPDF:F}=await pA(async()=>{const{jsPDF:O}=await Promise.resolve().then(()=>EE);return{jsPDF:O}},void 0),T=new F;T.addImage(M,"PNG",10,10,190,0),T.save(`cierre_${A.date}.pdf`)}finally{L.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:L=>r(L.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:L=>s(L.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),a?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(L=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:L.date}),i.jsx("td",{className:"border p-1",children:Ff(L.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.grossProfit??Number(L.totalCharged??0)-Number(L.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>u(L),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(L),children:"Eliminar"})]})})]},L.id))})]}),A&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",A.date]}),i.jsx("button",{onClick:()=>u(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:g,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:Ff(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",$o(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",$o(x.profit)]})]})]}),(w=A.salesV2)!=null&&w.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:A.salesV2.map((L,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:L.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:Ff(L.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:L.date??""}),i.jsx("td",{className:"border p-1",children:L.userEmail??""})]},E))})]})]}):(b=A.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:A.sales.map((L,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:L.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:Ff(L.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.amount)]}),i.jsx("td",{className:"border p-1",children:L.userEmail??""}),i.jsx("td",{className:"border p-1",children:L.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof L.change=="number"?$o(L.change):L.change??"0"})]},E))})]})]}):(k=A.products)!=null&&k.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:A.products.map((L,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:L.productName}),i.jsx("td",{className:"border p-1",children:Ff(L.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.amount)]})]},E))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(P=A.productSummary)!=null&&P.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:A.productSummary.map((L,E)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:L.productName}),i.jsx("td",{className:"border p-1",children:Ff(L.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",$o(L.totalAmount)]})]},E))})]})]}):null]})]}),d&&i.jsx("p",{className:"mt-3 text-sm",children:d})]})}function koe(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,a]=N.useState(""),[o,l]=N.useState(!1),[c,A]=N.useState("vendedor_pollo"),[u,d]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState([]),[x,g]=N.useState(!0),[w,b]=N.useState(null),[k,P]=N.useState("vendedor_pollo"),[L,E]=N.useState(""),[_,B]=N.useState(!1),[M,F]=N.useState([]),T=I=>!I||I==="vendedor"?"vendedor_pollo":I==="admin"||I==="vendedor_pollo"||I==="vendedor_ropa"||I==="vendedor_dulces"?I:"vendedor_pollo",O=async()=>{g(!0);const I=await Ct(At(je,"users")),V=[];I.forEach(j=>{const U=j.data();V.push({id:j.id,email:U.email??"",name:U.name??"",role:T(U.role),sellerCandyId:U.sellerCandyId??""})}),p(V),g(!1)},Y=async()=>{try{const I=await Ct(At(je,"sellers_candies")),V=[];I.forEach(j=>{const U=j.data();V.push({id:j.id,name:U.name??"(sin nombre)",branchLabel:U.branch??"",commissionPercent:Number(U.commissionPercent??0)})}),F(V)}catch(I){console.error("Error cargando sellers_candies:",I)}};N.useEffect(()=>{O(),Y()},[]);const me=()=>{e(""),n(""),a(""),A("vendedor_pollo"),h("")},ae=async I=>{if(I.preventDefault(),d(""),s.length<4){d(" La contrasea debe tener al menos 4 caracteres.");return}if(!t.trim()){d(" El nombre es obligatorio.");return}try{const V=qB(),j=KB(V.options,"Secondary"),U=JL(j),G=await y$(U,r,s),R=T(c),X=R==="vendedor_dulces"&&f||"";await z6(Tt(At(je,"users"),G.user.uid),{email:r,name:t.trim(),role:R,sellerCandyId:X}),await ZB(U),await mG(j),p(se=>[{id:G.user.uid,email:r,name:t.trim(),role:R,sellerCandyId:X},...se]),d(" Usuario creado correctamente."),me(),B(!1)}catch(V){console.error(V),d(" Error al crear el usuario: "+V.message)}},fe=I=>{b(I.id),P(T(I.role)),E(I.sellerCandyId||"")},he=()=>{b(null),P("vendedor_pollo"),E("")},te=async()=>{if(!w)return;const I=Tt(je,"users",w),V=T(k),j=V==="vendedor_dulces"&&L||"";await Tr(I,{role:V,sellerCandyId:j}),p(U=>U.map(G=>G.id===w?{...G,role:V,sellerCandyId:j}:G)),he()},pe=async I=>{confirm("Eliminar este usuario del listado?")&&(await dn(Tt(je,"users",I)),p(j=>j.filter(U=>U.id!==I)))},Ie=I=>{const V=I==="admin"?"admin":I==="vendedor_ropa"?"vendedor_ropa":I==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",j=V==="admin"?"bg-blue-100 text-blue-700":V==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":V==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${j}`,children:V})},S=I=>`${I.name}  ${I.branchLabel||"Sin sucursal"}  ${I.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>B(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(I=>{const V=w===I.id,j=(V?k:I.role)==="vendedor_dulces";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:I.name||""}),i.jsx("td",{className:"p-2 border",children:I.email}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("select",{className:"w-full border p-1 rounded",value:k,onChange:U=>P(U.target.value),children:[i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),i.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),i.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]}),k==="vendedor_dulces"&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:L,onChange:U=>E(U.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),M.map(U=>i.jsx("option",{value:U.id,children:S(U)},U.id))]})]}):i.jsxs(i.Fragment,{children:[Ie(I.role),j&&I.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:V?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:te,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:he,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>fe(I),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>pe(I.id),children:"Eliminar"})]})})]},I.id)})})]})}),u&&i.jsx("p",{className:"text-sm mt-2",children:u}),_&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>B(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>B(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:I=>e(I.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:I=>n(I.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:s,onChange:I=>a(I.target.value),required:!0}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(I=>!I),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Rol"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:I=>A(I.target.value),children:[i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),i.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),i.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]})]}),c==="vendedor_dulces"&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:f,onChange:I=>h(I.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),M.map(I=>i.jsx("option",{value:I.id,children:S(I)},I.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>B(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Crear usuario"})]})]}),u&&i.jsx("p",{className:"text-sm mt-2",children:u})]})]})]})}const Toe=t=>`C$${(Number(t)||0).toFixed(2)}`;function joe(){const[t,e]=N.useState(""),[r,n]=N.useState(0),[s,a]=N.useState(""),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState([]),[f,h]=N.useState(!0),[m,p]=N.useState(!1),[x,g]=N.useState(null),[w,b]=N.useState(""),[k,P]=N.useState(""),[L,E]=N.useState(""),[_,B]=N.useState(0),[M,F]=N.useState(!1),T=async()=>{h(!0);const pe=await Ct(At(je,"products")),Ie=[];pe.forEach(S=>{const I=S.data();Ie.push({id:S.id,name:I.name??"",price:Number(I.price??0),category:I.category??"",measurement:I.measurement??"",active:I.active!==!1})}),d(Ie),h(!1)};N.useEffect(()=>{T()},[]);const O=async pe=>{if(pe.preventDefault(),a(""),!t||r<=0||!c){a(" Completa nombre, precio vlido y unidad de medida");return}try{const Ie={name:t,price:parseFloat(r.toFixed(2)),category:o,measurement:c,active:!0},S=await Jr(At(je,"products"),Ie);d(I=>[{id:S.id,...Ie},...I]),a(" Producto registrado con exito."),e(""),n(0),A(""),l(""),F(!1)}catch(Ie){a(" Error: "+Ie.message)}},Y=pe=>{g(pe.id),b(pe.name),P(pe.category),E(pe.measurement),B(pe.price)},me=()=>{g(null),b(""),P(""),E(""),B(0)},ae=async()=>{if(!x)return;const pe=Tt(je,"products",x);await Tr(pe,{name:w,category:k,measurement:L,price:parseFloat((_||0).toFixed(2))}),d(Ie=>Ie.map(S=>S.id===x?{...S,name:w,category:k,measurement:L,price:parseFloat((_||0).toFixed(2))}:S)),me()},fe=async pe=>{const Ie=Tt(je,"products",pe.id),S=pe.active===!1;await Tr(Ie,{active:S}),d(I=>I.map(V=>V.id===pe.id?{...V,active:S}:V))},he=async pe=>{const Ie=Ot(At(je,"inventory_batches"),$t("productId","==",pe),G6(1));if(!(await Ct(Ie)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await dn(Tt(je,"products",pe)),d(V=>V.filter(j=>j.id!==pe)))},te=m?u:u.filter(pe=>pe.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{a(""),F(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),M&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>F(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>F(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:O,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:o,onChange:pe=>l(pe.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:pe=>e(pe.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:c,onChange:pe=>A(pe.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:pe=>n(parseFloat(pe.target.value)),onFocus:pe=>pe.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),s&&i.jsx("p",{className:"text-sm mt-2",children:s})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:m,onChange:pe=>p(pe.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:f?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):te.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):te.map(pe=>{const Ie=x===pe.id,S=pe.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ie?i.jsx("input",{className:"w-full border p-1 rounded",value:w,onChange:I=>b(I.target.value)}):pe.name}),i.jsx("td",{className:"p-2 border",children:Ie?i.jsxs("select",{className:"w-full border p-1 rounded",value:k,onChange:I=>P(I.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):pe.category}),i.jsx("td",{className:"p-2 border",children:Ie?i.jsxs("select",{className:"w-full border p-1 rounded",value:L,onChange:I=>E(I.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):pe.measurement}),i.jsx("td",{className:"p-2 border",children:Ie?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(_)?"":_,onChange:I=>B(parseFloat(I.target.value))}):Toe(pe.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${S?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:S?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:Ie?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ae,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:me,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Y(pe),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${S?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>fe(pe),children:S?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>he(pe.id),children:"Eliminar"})]})})]},pe.id)})})]})})]})}const Ua=[];for(let t=0;t<256;++t)Ua.push((t+256).toString(16).slice(1));function Poe(t,e=0){return(Ua[t[e+0]]+Ua[t[e+1]]+Ua[t[e+2]]+Ua[t[e+3]]+"-"+Ua[t[e+4]]+Ua[t[e+5]]+"-"+Ua[t[e+6]]+Ua[t[e+7]]+"-"+Ua[t[e+8]]+Ua[t[e+9]]+"-"+Ua[t[e+10]]+Ua[t[e+11]]+Ua[t[e+12]]+Ua[t[e+13]]+Ua[t[e+14]]+Ua[t[e+15]]).toLowerCase()}let $N;const Roe=new Uint8Array(16);function Doe(){if(!$N){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");$N=crypto.getRandomValues.bind(crypto)}return $N(Roe)}const Loe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Jj={randomUUID:Loe};function Uoe(t,e,r){var s;if(Jj.randomUUID&&!t)return Jj.randomUUID();t=t||{};const n=t.random??((s=t.rng)==null?void 0:s.call(t))??Doe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Poe(n)}async function Ooe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const s=At(t,"inventory_batches"),a=Ot(s,$t("productName","==",e)),c=(await Ct(a)).docs.map(A=>({id:A.id,data:A.data()})).sort((A,u)=>{var p,x;const d=A.data.date??"",f=u.data.date??"";if(d!==f)return d<f?-1:1;const h=((p=A.data.createdAt)==null?void 0:p.seconds)??0,m=((x=u.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(A=>Tt(t,"inventory_batches",A.id));return ma(t,async A=>{let u=Number(r);const d=[],f=await Promise.all(c.map(x=>A.get(x)));for(let x=0;x<c.length&&u>0;x++){const g=c[x],w=f[x];if(!w.exists())continue;const b=w.data(),k=Number(b.quantity??0),P=Number(b.remaining??k??0),L=Number(b.purchasePrice??0);if(P<=0)continue;const E=Math.min(P,u),_=Number((P-E).toFixed(3));A.update(g,{remaining:_}),d.push({batchId:g.id,qty:E,unitCost:L,lineCost:Number((E*L).toFixed(2))}),u=Number((u-E).toFixed(3))}if(u>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${u} unidades.`);const h=Number(d.reduce((x,g)=>x+g.lineCost,0).toFixed(2)),m=d.reduce((x,g)=>x+g.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:d,avgUnitCost:p,cogsAmount:h}})}const ZM=3,Moe=.5*10**-ZM;function vs(t){const e=Number(t??0);return Number(e.toFixed(ZM))}function zN(t,e){return vs((t??0)+(e??0))}function p1(t,e){return vs(t)+Moe>=vs(e)}async function Qoe(t,e){const r=await Ct(At(je,"inventory_batches")),n=t.trim().toLowerCase();let s=0;for(const a of r.docs){const o=a.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await Tr(Tt(je,"inventory_batches",a.id),{productId:e}),s++)}return s}function Xj({user:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[a,o]=N.useState(""),[l,c]=N.useState(sr(new Date,"yyyy-MM-dd")),[A,u]=N.useState(""),[d,f]=N.useState([]),[h,m]=N.useState(0),[p,x]=N.useState(0),[g,w]=N.useState("0"),[b,k]=N.useState(""),[P,L]=N.useState(!1),[E,_]=N.useState({}),B=j=>Math.round(j*100)/100,M=j=>vs(j).toFixed(3),F=j=>{const U=Number(j.specialPrice||0);return U>0?U:Number(j.price||0)},T=async j=>{if(!j)return 0;const U=Ot(At(je,"inventory_batches"),$t("productId","==",j)),G=await Ct(U);let R=0;return G.forEach(X=>{const se=X.data();R=zN(R,Number(se.remaining||0))}),vs(R)},O=async j=>{if(!j)return 0;const U=await Ct(At(je,"inventory_batches"));let G=0;return U.forEach(R=>{const X=R.data();(X.productName||"").trim().toLowerCase()===j.trim().toLowerCase()&&(G=zN(G,Number(X.remaining||0)))}),vs(G)};N.useEffect(()=>{(async()=>{const j=await Ct(At(je,"products")),U=[];j.forEach(G=>{const R=G.data();(R==null?void 0:R.active)!==!1&&U.push({id:G.id,productName:R.name??R.productName??"(sin nombre)",price:Number(R.price??0),measurement:R.measurement??"(sin unidad)",category:R.category??"(sin categora)"})}),r(U)})()},[]),N.useEffect(()=>{(async()=>{const j=await Ct(At(je,"inventory_batches")),U={};j.forEach(G=>{const R=G.data(),X=R.productId,se=Number(R.remaining||0);X&&(U[X]=zN(U[X]||0,se))}),Object.keys(U).forEach(G=>U[G]=vs(U[G])),_(U)})()},[]),N.useEffect(()=>{(async()=>{const j=await Ct(At(je,"users")),U=[];j.forEach(G=>{const R=G.data();U.push({id:G.id,email:R.email??"(sin email)",role:R.role??"USER"})}),s(U)})()},[]);const Y=async()=>{if(!a)return;const j=e.find(G=>G.id===a);if(!j)return;if(d.some(G=>G.productId===j.id)){o("");return}const U=await T(j.id);f(G=>[...G,{productId:j.id,productName:j.productName,measurement:j.measurement,price:Number(j.price||0),specialPrice:0,stock:U,qty:0,discount:0}]),o("")},me=j=>{f(U=>U.filter(G=>G.productId!==j))},ae=async(j,U)=>{f(G=>G.map(R=>{if(R.productId!==j)return R;const X=(R.measurement||"").toLowerCase()!=="lb",se=U===""?0:Number(U),ye=X?Math.max(0,Math.round(se)):vs(se);return{...R,qty:ye}}))},fe=(j,U)=>{f(G=>G.map(R=>{if(R.productId!==j)return R;const X=(U||"").replace(",","."),se=X.trim()===""?0:Number(X),ye=Number.isFinite(se)?Math.max(0,B(se)):0;return{...R,specialPrice:ye}}))},he=(j,U)=>{f(G=>G.map(R=>{if(R.productId!==j)return R;const X=Math.max(0,Math.floor(Number(U||0)));return{...R,discount:X}}))},te=N.useMemo(()=>{let j=0;for(const U of d){const G=F(U),R=Number(G||0)*Number(U.qty||0),X=Math.max(0,R-Math.max(0,Number(U.discount||0)));j+=X}return B(j)},[d]);N.useEffect(()=>{m(te)},[te]),N.useEffect(()=>{const j=Number(p)||0,U=Number(h)||0;w((j-U).toFixed(2))},[p,h]);const pe=j=>{j.key===","&&(j.preventDefault(),j.target.value+=".")},Ie=async()=>{if(d.length===0)return"Agrega al menos un producto.";for(const j of d){if(!j.qty||j.qty<=0)return`Cantidad invlida para "${j.productName}".`;const U=await T(j.productId);if(!p1(U,j.qty)){const G=await O(j.productName);if(p1(G,0)&&!p1(U,0)){const R=await Qoe(j.productName,j.productId),X=await T(j.productId);if(!p1(X,j.qty))return`Stock insuficiente tras corregir ${R} lote(s) para "${j.productName}".`}else return`Stock insuficiente para "${j.productName}". Disponible: ${U}`}}return null},S=async j=>{var G,R;j.preventDefault(),k("");const U=await Ie();if(U){k(" "+U);return}try{L(!0);const X=[];for(const z of d){const Me=z.qty,{allocations:re,avgUnitCost:W,cogsAmount:q}=await Ooe(je,z.productName,Me,!1),oe=F(z),de=Number(oe||0)*Number(Me||0),Be=Math.max(0,Number(z.discount||0)),He=Math.max(0,de-Be);X.push({productId:z.productId,productName:z.productName,measurement:z.measurement,unitPrice:Number(oe||0),regularPrice:Number(z.price||0),specialPrice:Number(z.specialPrice||0)>0?Number(z.specialPrice):null,qty:Me,discount:Be,lineTotal:B(de),lineFinal:B(He),allocations:re,avgUnitCost:W,cogsAmount:q})}const se=X.reduce((z,Me)=>z+Me.lineFinal,0),ye=X.reduce((z,Me)=>z+Number(Me.qty||0),0);await Jr(At(je,"salesV2"),{id:Uoe(),quantity:ye,amount:se,amountCharged:se,amountReceived:Number(p)||0,change:g,clientName:A.trim(),timestamp:Gt.now(),date:l,userEmail:((G=n[0])==null?void 0:G.email)??"sin usuario",vendor:((R=n[0])==null?void 0:R.role)??"sin usuario",status:"FLOTANTE",items:X,itemsTotal:se}),k(" Venta registrada y asignada a inventario (FIFO)."),f([]),o(""),m(0),x(0),w("0"),u(""),c(sr(new Date,"yyyy-MM-dd"))}catch(X){console.error(X),k(` ${(X==null?void 0:X.message)||"Error al registrar la venta."}`)}finally{L(!1)}},I=N.useMemo(()=>new Set(d.map(j=>j.productId)),[d]),V=N.useMemo(()=>e.filter(j=>(E[j.id]||0)>0),[e,E]);return i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:S,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl
                 p-4 sm:p-6 md:p-8
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:a,onChange:j=>o(j.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),V.map(j=>i.jsxs("option",{value:j.id,disabled:I.has(j.id),title:I.has(j.id)?"Ya est en la lista":`Disponible: ${M(E[j.id]||0)}`,children:[j.productName,"  ",j.measurement,"  C$ ",j.price," (disp:"," ",M(E[j.id]||0),")"]},j.id))]}),i.jsx("button",{type:"button",onClick:Y,disabled:!a||I.has(a),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:j=>c(j.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:A,onChange:j=>u(j.target.value),placeholder:"Opcional"})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:d.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):d.map(j=>{const U=F(j),G=Number(U||0)*Number(j.qty||0),R=Math.max(0,G-Math.max(0,Number(j.discount||0))),X=(j.measurement||"").toLowerCase()!=="lb",se=vs(Number(j.stock)-Number(j.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[j.productName,"  ",j.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",B(j.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:j.specialPrice===0?"":j.specialPrice,onKeyDown:pe,onChange:ye=>fe(j.productId,ye.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",B(U).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:se.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:X?1:.01,inputMode:X?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:j.qty===0?"":j.qty,onKeyDown:pe,onChange:ye=>ae(j.productId,ye.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:j.discount===0?"":j.discount,onChange:ye=>he(j.productId,ye.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",B(R).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>me(j.productId),title:"Quitar",children:""})})]},j.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${h.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:p===0?"":p,onChange:j=>x(Number(j.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${g}`,readOnly:!0})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:d.length===0||P,children:P?"Guardando...":"Guardar venta"}),b&&i.jsx("p",{className:`text-sm mt-2 ${b.startsWith("")?"text-green-600":b.startsWith("")?"text-yellow-600":"text-red-600"}`,children:b})]}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}var e8={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Yj=ui.createContext&&ui.createContext(e8),Voe=["attr","size","title"];function Hoe(t,e){if(t==null)return{};var r=Koe(t,e),n,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Koe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Nw(){return Nw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nw.apply(this,arguments)}function Zj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Cw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zj(Object(r),!0).forEach(function(n){qoe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qoe(t,e,r){return e=Goe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Goe(t){var e=$oe(t,"string");return typeof e=="symbol"?e:e+""}function $oe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t8(t){return t&&t.map((e,r)=>ui.createElement(e.tag,Cw({key:r},e.attr),t8(e.child)))}function zoe(t){return e=>ui.createElement(Woe,Nw({attr:Cw({},t.attr)},e),t8(t.child))}function Woe(t){var e=r=>{var{attr:n,size:s,title:a}=t,o=Hoe(t,Voe),l=s||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),ui.createElement("svg",Nw({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:Cw(Cw({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&ui.createElement("title",null,a),t.children)};return Yj!==void 0?ui.createElement(Yj.Consumer,null,r=>e(r)):e(e8)}function Joe(t){return zoe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function kc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(Joe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}const Bi=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function WN(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function Xoe({role:t="",sellerCandyId:e="",currentUserEmail:r}){{const[n,s]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState(!0),[A,u]=N.useState(""),{refreshKey:d,refresh:f}=Xl(),h=t==="admin",[m,p]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[x,g]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[w,b]=N.useState(""),[k,P]=N.useState(!1),[L,E]=N.useState(""),[_,B]=N.useState(sr(new Date,"yyyy-MM-dd")),[M,F]=N.useState("lb"),[T,O]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState(0),[he,te]=N.useState(0),[pe,Ie]=N.useState([]),[S,I]=N.useState(null),[V,j]=N.useState([]),[U,G]=N.useState(!1),[R,X]=N.useState(null),[se,ye]=N.useState(!1),[z,Me]=N.useState(null),re=K=>{const _e=(K||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(_e)||_e==="lb"};N.useEffect(()=>{(async()=>{c(!0),u("");const K=await Ct(At(je,"products")),_e=[];K.forEach(Qe=>{const Ue=Qe.data();Ue.active===!0&&_e.push({id:Qe.id,name:Ue.name??Ue.productName??"(sin nombre)",category:Ue.category??"(sin categora)",measurement:Ue.measurement??"lb",price:Number(Ue.price??0)})}),s(_e);const Oe=Ot(At(je,"inventory_batches"),Dr("date","desc")),Ve=await Ct(Oe),ve=[];Ve.forEach(Qe=>{const Ue=Qe.data(),Ee=vs(Number(Ue.quantity||0)),We=Number(Ue.purchasePrice||0),nt=Number(Ue.salePrice||0),Nt=Number((Ee*We).toFixed(2)),ot=Number((Ee*nt).toFixed(2));ve.push({id:Qe.id,productId:Ue.productId,productName:Ue.productName,category:Ue.category,unit:Ue.unit,quantity:Ee,remaining:vs(Number(Ue.remaining||0)),purchasePrice:We,salePrice:nt,invoiceTotal:Ue.invoiceTotal!=null?Number(Ue.invoiceTotal):Nt,expectedTotal:Ue.expectedTotal!=null?Number(Ue.expectedTotal):ot,date:Ue.date,createdAt:Ue.createdAt,status:Ue.status,notes:Ue.notes,paidAmount:Number(Ue.paidAmount||0),paidAt:Ue.paidAt,batchGroupId:Ue.batchGroupId,orderName:Ue.orderName})}),o(ve),c(!1)})()},[d]);const W=N.useMemo(()=>a.filter(K=>!(m&&K.date<m||x&&K.date>x||w&&K.productId!==w)),[a,m,x,w]),q=N.useMemo(()=>{const K=W.reduce((We,nt)=>We+Number(nt.invoiceTotal||0),0),_e=W.reduce((We,nt)=>We+Number(nt.expectedTotal||0),0);let Oe=0,Ve=0,ve=0,Qe=0;for(const We of W)re(We.unit)?(Oe+=We.quantity,Ve+=We.remaining):(ve+=We.quantity,Qe+=We.remaining);const Ue=W.reduce((We,nt)=>We+nt.quantity,0),Ee=W.reduce((We,nt)=>We+nt.remaining,0);return{lbsIng:Oe,lbsRem:Ve,udsIng:ve,udsRem:Qe,qty:Ue,rem:Ee,totalFacturado:K,totalEsperado:_e}},[W]),oe=N.useMemo(()=>{var Oe,Ve;const K=new Map;for(const ve of W){const Qe=ve.batchGroupId&&String(ve.batchGroupId).trim()||ve.id;K.has(Qe)||K.set(Qe,[]),K.get(Qe).push(ve)}const _e=[];for(const[ve,Qe]of K.entries()){const Ue=[...Qe].sort((tr,et)=>{var kt,jt;const gt=((kt=tr.createdAt)==null?void 0:kt.seconds)??0;return(((jt=et.createdAt)==null?void 0:jt.seconds)??0)-gt}),Ee=((Oe=Ue[0])==null?void 0:Oe.date)||"",We=String(((Ve=Ue[0])==null?void 0:Ve.orderName)||"").trim()||`Pedido ${Ee||""}`.trim()||"Pedido",nt=new Set(Ue.map(tr=>String(tr.category||"").trim()).filter(Boolean)),Nt=nt.size===1?Array.from(nt)[0].toUpperCase():"MIXTO",ot=Ue.some(tr=>tr.status==="PENDIENTE")?"PENDIENTE":"PAGADO",wt=vs(Ue.reduce((tr,et)=>tr+(re(et.unit)?Number(et.quantity||0):0),0)),Lt=vs(Ue.reduce((tr,et)=>tr+(re(et.unit)?Number(et.remaining||0):0),0)),cr=Number(Ue.reduce((tr,et)=>tr+Number(et.invoiceTotal||0),0).toFixed(2)),ar=Number(Ue.reduce((tr,et)=>tr+Number(et.expectedTotal||0),0).toFixed(2)),yr=Number((ar-cr).toFixed(2));_e.push({groupId:ve,orderName:We,date:Ee,typeLabel:Nt,status:ot,lbsIn:wt,lbsRem:Lt,totalFacturado:cr,totalEsperado:ar,utilidadBruta:yr,items:Ue})}return _e.sort((ve,Qe)=>ve.date===Qe.date?ve.groupId<Qe.groupId?1:-1:ve.date<Qe.date?1:-1),_e},[W]),de=N.useMemo(()=>{const K=String(M||"").toLowerCase().trim();return n.filter(Oe=>String(Oe.measurement||"").toLowerCase().trim()===K).sort((Oe,Ve)=>Oe.name.localeCompare(Ve.name,"es"))},[n,M]);N.useEffect(()=>{const K=n.find(_e=>_e.id===T);K&&te(Number(K.price||0))},[T,n,d]);const Be=()=>{u("");const K=n.find(Ee=>Ee.id===T);if(!K){u("Selecciona un producto.");return}if(Y<=0||ae<=0){u("Completa libras a ingresar y precio proveedor.");return}const _e=vs(Y),Oe=K.measurement,Ve=Number((_e*Number(ae||0)).toFixed(2)),ve=Number((_e*Number(he||0)).toFixed(2)),Qe=Number((ve-Ve).toFixed(2)),Ue=pe.findIndex(Ee=>Ee.productId===K.id);if(Ue>=0)Ie(Ee=>Ee.map((We,nt)=>nt!==Ue?We:{...We,quantity:_e,remaining:_e,purchasePrice:Number(ae||0),salePrice:Number(he||0),invoiceTotal:Ve,expectedTotal:ve,utilidadBruta:Qe}));else{const Ee={tempId:WN("IT"),productId:K.id,productName:K.name,category:K.category,unit:Oe,quantity:_e,remaining:_e,purchasePrice:Number(ae||0),salePrice:Number(he||0),invoiceTotal:Ve,expectedTotal:ve,utilidadBruta:Qe};Ie(We=>[...We,Ee])}O(""),me(0),fe(0),te(0)},He=K=>{Ie(_e=>_e.filter(Oe=>Oe.tempId!==K))},$e=(K,_e,Oe)=>{Ie(Ve=>Ve.map(ve=>{if(ve.tempId!==K)return ve;const Qe={...ve};return _e==="quantity"&&(Qe.quantity=vs(Math.max(0,Oe)),Qe.remaining=Qe.quantity),_e==="purchasePrice"&&(Qe.purchasePrice=Math.max(0,Number(Oe||0))),_e==="salePrice"&&(Qe.salePrice=Math.max(0,Number(Oe||0))),Qe.invoiceTotal=Number((Qe.quantity*Qe.purchasePrice).toFixed(2)),Qe.expectedTotal=Number((Qe.quantity*Qe.salePrice).toFixed(2)),Qe.utilidadBruta=Number((Qe.expectedTotal-Qe.invoiceTotal).toFixed(2)),Qe}))},Je=N.useMemo(()=>{const K=vs(pe.reduce((Qe,Ue)=>Qe+(re(Ue.unit)?Number(Ue.quantity||0):0),0)),_e=vs(pe.reduce((Qe,Ue)=>Qe+(re(Ue.unit)?Number(Ue.remaining||0):0),0)),Oe=Number(pe.reduce((Qe,Ue)=>Qe+Number(Ue.invoiceTotal||0),0).toFixed(2)),Ve=Number(pe.reduce((Qe,Ue)=>Qe+Number(Ue.expectedTotal||0),0).toFixed(2)),ve=Number((Ve-Oe).toFixed(2));return{lbsIn:K,lbsRem:_e,totalFacturado:Oe,totalEsperado:Ve,utilidadBruta:ve}},[pe]),ct=()=>{I(null),j([]),E(""),B(sr(new Date,"yyyy-MM-dd")),F("lb"),O(""),me(0),fe(0),te(0),Ie([])},at=async()=>{if(u(""),!pe.length){u("Agrega al menos un producto al pedido.");return}const K=_||sr(new Date,"yyyy-MM-dd"),_e=String(L||"").trim()||`Pedido ${K}`,Oe=S||WN("BATCH");try{if(!S){for(const Ue of pe)await zj({productId:Ue.productId,productName:Ue.productName,category:Ue.category,unit:Ue.unit,quantity:vs(Ue.quantity),purchasePrice:Number(Ue.purchasePrice||0),salePrice:Number(Ue.salePrice||0),invoiceTotal:Number(Ue.invoiceTotal||0),expectedTotal:Number(Ue.expectedTotal||0),date:K,notes:"",batchGroupId:Oe,orderName:_e});u(" Pedido creado"),P(!1),ct(),f();return}const Ve=V,ve=new Map;for(const Ue of Ve)ve.set(Ue.productId,Ue);const Qe=new Set(pe.map(Ue=>Ue.productId));for(const Ue of pe){const Ee=ve.get(Ue.productId),We=vs(Ue.quantity);if(Ee){const nt=vs(Ee.quantity-Ee.remaining),Nt=Math.max(0,vs(We-nt));await Tr(Tt(je,"inventory_batches",Ee.id),{date:K,orderName:_e,batchGroupId:Oe,quantity:We,purchasePrice:Number(Ue.purchasePrice||0),salePrice:Number(Ue.salePrice||0),invoiceTotal:Number(Ue.invoiceTotal||0),expectedTotal:Number(Ue.expectedTotal||0),remaining:Nt})}else await zj({productId:Ue.productId,productName:Ue.productName,category:Ue.category,unit:Ue.unit,quantity:We,purchasePrice:Number(Ue.purchasePrice||0),salePrice:Number(Ue.salePrice||0),invoiceTotal:Number(Ue.invoiceTotal||0),expectedTotal:Number(Ue.expectedTotal||0),date:K,notes:"",batchGroupId:Oe,orderName:_e})}for(const Ue of Ve)Qe.has(Ue.productId)||await dn(Tt(je,"inventory_batches",Ue.id));u(" Pedido actualizado"),P(!1),ct(),f()}catch(Ve){console.error(Ve),u(" Error al guardar pedido")}},mt=K=>{X(K),G(!0)},st=K=>{I(K.groupId),j(K.items),E(K.orderName),B(K.date||sr(new Date,"yyyy-MM-dd"));const _e=K.items.map(Oe=>{const Ve=Number(Oe.invoiceTotal||0),ve=Number(Oe.expectedTotal||0);return{tempId:WN("IT"),productId:Oe.productId,productName:Oe.productName,category:Oe.category,unit:Oe.unit,quantity:vs(Oe.quantity),remaining:vs(Oe.remaining),purchasePrice:Number(Oe.purchasePrice||0),salePrice:Number(Oe.salePrice||0),invoiceTotal:Ve,expectedTotal:ve,utilidadBruta:Number((ve-Ve).toFixed(2))}});Ie(_e),P(!0)},Le=async K=>{if(confirm(`Eliminar el pedido "${K.orderName}" del ${K.date}?`))try{for(const Oe of K.items)await dn(Tt(je,"inventory_batches",Oe.id));u(" Pedido eliminado"),f()}catch(Oe){console.error(Oe),u(" Error al eliminar pedido")}},ut=K=>{Me(K),ye(!0)},be=async()=>{if(z)try{for(const K of z.items){if(K.status!=="PENDIENTE")continue;await YM(K.id),await Tr(Tt(je,"inventory_batches",K.id),{remaining:0});const _e={date:K.date,productName:K.productName,quantity:K.quantity,amount:Number((K.expectedTotal??K.salePrice*K.quantity).toFixed(2)),allocations:[{batchId:K.id,qty:K.quantity,unitCost:K.purchasePrice,lineCost:Number((K.purchasePrice*K.quantity).toFixed(2))}],avgUnitCost:K.purchasePrice,measurement:K.unit,createdAt:Gt.now(),autoGeneratedFromInventory:!0};await Jr(At(je,"salesV2"),_e)}u(" Pedido pagado y reflejado como venta"),f()}catch(K){console.error(K),u(" Error al pagar pedido")}finally{ye(!1),Me(null)}},ge=()=>{ye(!1),Me(null)};return i.jsxs("div",{className:"max-w-6xl mx-auto shadows-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),h&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{ct(),P(!0)},children:"Crear Lote"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:K=>p(K.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:K=>g(K.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:w,onChange:K=>b(K.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),n.map(K=>i.jsxs("option",{value:K.id,children:[K.name,"  ",K.category]},K.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{p(""),g(""),b("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(kc,{onClick:()=>f(),loading:l})})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",q.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",q.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",q.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",q.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",q.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",q.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(q.totalEsperado-q.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",W.length.toLocaleString()]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):oe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin lotes"})}):oe.map(K=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>mt(K),title:K.orderName,children:K.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:K.orderName})]}),i.jsx("td",{className:"p-2 border",children:K.typeLabel}),i.jsx("td",{className:"p-2 border",children:K.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:K.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Bi(K.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:Bi(K.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:Bi(K.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${K.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:K.status})}),i.jsx("td",{className:"p-2 border",children:h?i.jsxs("div",{className:"flex gap-2 justify-center",children:[K.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>ut(K),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>st(K),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Le(K),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},K.groupId))})]})}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),k&&Ku.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>P(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:S?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>P(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:L,onChange:K=>E(K.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:_,onChange:K=>B(K.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:M,onChange:K=>{F(K.target.value),O(""),me(0),fe(0),te(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:T,onChange:K=>O(K.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),de.map(K=>i.jsxs("option",{value:K.id,children:[K.name,"  ",K.category,"  ",K.measurement]},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Y===0?"":Y,onChange:K=>{const _e=K.target.value.replace(",","."),Oe=parseFloat(_e),Ve=Number.isFinite(Oe)?parseFloat(Oe.toFixed(3)):0;me(Math.max(0,Ve))},disabled:!T})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:K=>{const _e=K.target.value.replace(",","."),Oe=parseFloat(_e),Ve=Number.isFinite(Oe)?parseFloat(Oe.toFixed(2)):0;fe(Math.max(0,Ve))},disabled:!T})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:he===0?"":he,onChange:K=>{const _e=K.target.value.replace(",","."),Oe=parseFloat(_e),Ve=Number.isFinite(Oe)?parseFloat(Oe.toFixed(2)):0;te(Math.max(0,Ve))},disabled:!T})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:Be,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:pe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):pe.map(K=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[K.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[K.category,"  ",K.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:K.quantity,onChange:_e=>{const Oe=_e.target.value.replace(",","."),Ve=parseFloat(Oe),ve=Number.isFinite(Ve)?parseFloat(Ve.toFixed(3)):0;$e(K.tempId,"quantity",ve)}})}),i.jsx("td",{className:"p-2 border",children:Number(K.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:K.purchasePrice,onChange:_e=>{const Oe=_e.target.value.replace(",","."),Ve=parseFloat(Oe),ve=Number.isFinite(Ve)?parseFloat(Ve.toFixed(2)):0;$e(K.tempId,"purchasePrice",ve)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:K.salePrice,onChange:_e=>{const Oe=_e.target.value.replace(",","."),Ve=parseFloat(Oe),ve=Number.isFinite(Ve)?parseFloat(Ve.toFixed(2)):0;$e(K.tempId,"salePrice",ve)}})}),i.jsx("td",{className:"p-2 border",children:Bi(K.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:Bi(K.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:Bi(K.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>He(K.tempId),children:"Quitar"})})]},K.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:Je.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:Je.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:Bi(Je.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:Bi(Je.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Bi(Je.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>P(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:at,disabled:pe.length===0,children:S?"Editar pedido":"Crear pedido"})]})]})]}),document.body),U&&R&&Ku.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{G(!1),X(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:R.orderName})," "," ",R.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{G(!1),X(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:R.items.map(K=>{const _e=Number(K.invoiceTotal||0),Oe=Number(K.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:K.productName}),i.jsx("td",{className:"p-2 border",children:(K.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:K.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:K.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Bi(K.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:Bi(K.salePrice)}),i.jsx("td",{className:"p-2 border",children:Bi(_e)}),i.jsx("td",{className:"p-2 border",children:Bi(Oe)}),i.jsx("td",{className:"p-2 border",children:Bi(Oe-_e)}),i.jsx("td",{className:"p-2 border",children:K.status})]},K.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:R.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:R.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Bi(R.utilidadBruta)})]})]})]})]}),document.body),se&&z&&Ku.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:ge}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:z.orderName})," "," ",z.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:be,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:ge,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}}const Wc=t=>`C$${(Number(t)||0).toFixed(2)}`;function Yoe(){const t=uZ(new Date),[e,r]=N.useState(sr(t,"yyyy-MM")),[n,s]=N.useState([]),[a,o]=N.useState(!1),[l,c]=N.useState(""),A=N.useRef(null),u=N.useMemo(()=>{const[x,g]=e.split("-").map(k=>parseInt(k,10)),w=sr(Bc(new Date(x,g-1,1)),"yyyy-MM-dd"),b=sr(Ec(new Date(x,g-1,1)),"yyyy-MM-dd");return{from:w,to:b}},[e]),d=async()=>{o(!0);try{const x=await Boe(u.from,u.to),g=[];for(const w of x){const b=Tt(je,"inventory_batches",w.batchId),k=await Xa(b);if(!k.exists())continue;const P=k.data();g.push({batchId:w.batchId,batchDate:w.batchDate,productName:w.productName,soldQty:Number(w.quantity||0),soldAmount:Number(w.amountCharged||0),status:P.status??"PENDIENTE",purchasePrice:Number(P.purchasePrice||0),salePrice:Number(P.salePrice||0),supplier:P.supplier})}s(g)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};N.useEffect(()=>{d()},[e]);const f=async x=>{confirm("Marcar este lote como PAGADO?")&&(await YM(x),s(w=>w.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=N.useMemo(()=>{const x=n.reduce((k,P)=>k+P.soldQty,0),g=n.reduce((k,P)=>k+P.soldAmount,0),w=n.reduce((k,P)=>k+P.soldQty*P.purchasePrice,0),b=g-w;return{q:x,amt:g,cogs:w,profit:b}},[n]),m=N.useMemo(()=>{const x=new Map;for(const g of n){const w=g.productName||"(sin nombre)";x.has(w)||x.set(w,{productName:w,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(w);b.qty+=g.soldQty,b.revenue+=g.soldAmount;const k=g.soldQty*g.purchasePrice;b.cogs+=k,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((g,w)=>g.productName.localeCompare(w.productName))},[n]),p=async()=>{if(!A.current)return;const x=A.current;x.classList.add("force-pdf-colors");try{const[{default:g},{jsPDF:w}]=await Promise.all([pA(()=>Promise.resolve().then(()=>XS),void 0),pA(()=>Promise.resolve().then(()=>EE),void 0)]),k=(await g(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),P=new w("p","mm","a4"),L=190,E=P.getImageProperties(k),_=L,B=E.height*_/E.width;P.addImage(k,"PNG",10,10,_,B),P.save(`liquidaciones_${e}.pdf`)}catch(g){console.error(g),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:d,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:A,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",Wc(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",Wc(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",Wc(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const g=x.soldQty*x.purchasePrice,w=x.soldAmount-g;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:Wc(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:Wc(g)}),i.jsx("td",{className:`p-2 border ${w>=0?"text-green-700":"text-red-700"}`,children:Wc(w)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>f(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:Wc(x.revenue)}),i.jsx("td",{className:"p-2 border",children:Wc(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:Wc(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Jc=t=>`C$${Number(t??0).toFixed(2)}`,Zoe=()=>sr(new Date,"yyyy-MM-dd"),g1=t=>Number(t||0).toFixed(3);function ele(){const[t,e]=N.useState(()=>{const P=new Date,L=new Date(P.getFullYear(),P.getMonth(),1);return sr(L,"yyyy-MM-dd")}),[r,n]=N.useState(Zoe()),[s,a]=N.useState(!0),[o,l]=N.useState([]),[c,A]=N.useState([]),{refreshKey:u,refresh:d}=Xl();N.useEffect(()=>{(async()=>{a(!0);const L=Ot(At(je,"salesV2"),$t("date",">=",t),$t("date","<=",r)),E=await Ct(L),_=[];E.forEach(T=>{const O=T.data(),Y=O.date??"";if(Array.isArray(O.items)&&O.items.length>0){O.items.forEach((me,ae)=>{const fe=String(me.productName??"(sin nombre)"),he=Number(me.qty??0),te=Number(me.lineFinal??0)||Math.max(0,Number(me.unitPrice||0)*he-Number(me.discount||0));_.push({id:`${T.id}#${ae}`,date:Y,productName:fe,quantity:he,amount:te,allocations:Array.isArray(me.allocations)?me.allocations:O.allocations,avgUnitCost:Number(me.avgUnitCost??O.avgUnitCost??0),measurement:me.measurement??O.measurement??""})});return}_.push({id:T.id,date:Y,productName:O.productName??"(sin nombre)",quantity:Number(O.quantity??0),amount:Number(O.amount??O.amountCharged??0),allocations:Array.isArray(O.allocations)?O.allocations:[],avgUnitCost:Number(O.avgUnitCost??0),measurement:O.measurement??""})}),l(_);const B=Ot(At(je,"expenses"),$t("date",">=",t),$t("date","<=",r)),M=await Ct(B),F=[];M.forEach(T=>{const O=T.data();F.push({id:T.id,date:O.date??"",category:O.category??"(sin categora)",description:O.description??"",amount:Number(O.amount??0),status:O.status??"PAGADO",createdAt:O.createdAt})}),A(F),a(!1)})()},[t,r,u]);const f=N.useMemo(()=>{const P=o.reduce((M,F)=>M+(F.amount||0),0);let L=0;o.forEach(M=>{var F;(F=M.allocations)!=null&&F.length?L+=M.allocations.reduce((T,O)=>T+Number(O.lineCost||0),0):M.avgUnitCost&&M.quantity&&(L+=Number(M.avgUnitCost)*Number(M.quantity))});const E=P-L,_=c.reduce((M,F)=>M+(F.amount||0),0),B=E-_;return{revenue:P,cogsReal:L,grossProfit:E,expensesSum:_,netProfit:B}},[o,c]),h=P=>String(P??"").toLowerCase().trim(),m=P=>Number(P.qty??P.quantity??0),p=P=>["lb","lbs","libra","libras"].includes(h(P)),x=P=>["unidad","unidades","ud","uds","pieza","piezas"].includes(h(P)),g=N.useMemo(()=>o.reduce((P,L)=>p(L.measurement)?P+m(L):P,0),[o]),w=N.useMemo(()=>o.reduce((P,L)=>x(L.measurement)?P+m(L):P,0),[o]),b=N.useMemo(()=>{var L;const P=new Map;for(const E of o){const _=E.productName||"(sin nombre)";P.has(_)||P.set(_,{productName:_,units:0,revenue:0,cogs:0,profit:0,firstDate:E.date||"",lastDate:E.date||""});const B=P.get(_);B.units+=Number(E.quantity||0),B.revenue+=Number(E.amount||0),(!B.firstDate||E.date<(B.firstDate||E.date))&&(B.firstDate=E.date),(!B.lastDate||E.date>(B.lastDate||E.date))&&(B.lastDate=E.date);let M=0;(L=E.allocations)!=null&&L.length?M=E.allocations.reduce((F,T)=>F+Number(T.lineCost||0),0):E.avgUnitCost&&(M=Number(E.avgUnitCost)*Number(E.quantity||0)),B.cogs+=M,B.profit=B.revenue-B.cogs}return Array.from(P.values()).sort((E,_)=>E.productName.localeCompare(_.productName))},[o]),k=N.useMemo(()=>[...b].sort((P,L)=>L.units-P.units).slice(0,3).map((P,L)=>({idx:L+1,name:P.productName,units:P.units})),[b]);return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl ",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Dashboard Financiero"}),i.jsx(kc,{onClick:d,loading:s})]}),i.jsxs("div",{className:"flex flex-wrap items-end gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:t,onChange:P=>e(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2",value:r,onChange:P=>n(P.target.value)})]})]}),s?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-3 rounded-2xl shadow-lg p-4 bg-gray-50",children:[i.jsx(rp,{title:"Ventas",value:Jc(f.revenue)}),i.jsx(rp,{title:"Costo",value:Jc(f.cogsReal)}),i.jsx(rp,{title:"Ganancia Bruta",value:Jc(f.grossProfit),positive:!0}),i.jsx(rp,{title:"Gastos",value:Jc(f.expensesSum)}),i.jsx(rp,{title:"Ganancia Neta",value:Jc(f.netProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-4 bg-gray-50",children:[i.jsx(eP,{title:"Libras Vendidas",value:g1(g)}),i.jsx(eP,{title:"Unidades Vendidas",value:g1(w)}),i.jsx(tle,{title:"Productos ms vendidos",items:k.map(P=>({key:`${P.idx}`,label:`${P.idx}. ${P.name}`,value:`(${g1(P.units)})`}))})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Fechas"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Ingreso"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[b.map(P=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:P.productName}),i.jsx("td",{className:"border p-1",children:P.firstDate&&P.lastDate?P.firstDate===P.lastDate?P.firstDate:`${P.firstDate}  ${P.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:g1(P.units)}),i.jsx("td",{className:"border p-1",children:Jc(P.revenue)}),i.jsx("td",{className:"border p-1",children:Jc(P.cogs)}),i.jsx("td",{className:`border p-1 ${P.profit>=0?"text-green-700":"text-red-700"}`,children:Jc(P.profit)})]},P.productName)),b.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(P=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:P.date}),i.jsx("td",{className:"border p-1",children:P.category}),i.jsx("td",{className:"border p-1",children:P.description}),i.jsx("td",{className:"border p-1",children:Jc(P.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:P.status})})]},P.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})]})]})}function rp({title:t,value:e,positive:r}){return i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"text-[17px] text-gray-500",children:t}),i.jsx("div",{className:`text-[30px] font-bold ${r?"text-green-700":""}`,children:e})]})}function eP({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("div",{className:"text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[20px] font-semibold",children:e})]})}function tle({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}const tP=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],x1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function rle(){const[t,e]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[r,n]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[s,a]=N.useState(sr(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[w,b]=N.useState(!0),[k,P]=N.useState(""),[L,E]=N.useState(null),[_,B]=N.useState(""),[M,F]=N.useState(""),[T,O]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[he,te]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const R=Ot(At(je,"expenses"),Dr("date","desc")),X=await Ct(R),se=[];X.forEach(ye=>{const z=ye.data();se.push({id:ye.id,date:z.date||sr(new Date,"yyyy-MM-dd"),category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||"PENDIENTE",notes:z.notes||"",createdAt:z.createdAt??Gt.now()})}),g(se)}catch(R){console.error(R),P(" Error al cargar gastos")}finally{b(!1)}})()},[]);const pe=N.useMemo(()=>x.filter(R=>!(t&&R.date<t||r&&R.date>r)),[x,t,r]),Ie=N.useMemo(()=>{const R=pe.reduce((ye,z)=>ye+(z.amount||0),0),X=pe.filter(ye=>ye.status==="PAGADO").reduce((ye,z)=>ye+(z.amount||0),0),se=R-X;return{total:R,pagado:X,pendiente:se}},[pe]),S=()=>{a(sr(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},I=async R=>{if(R.preventDefault(),P(""),!o){P("Selecciona una categora.");return}if(!c.trim()){P("Ingresa una descripcin.");return}if(!u||u<=0){P("Ingresa un monto vlido.");return}try{const X=await Jr(At(je,"expenses"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Gt.now()});g(se=>[{id:X.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Gt.now()},...se]),S(),P(" Gasto registrado")}catch(X){console.error(X),P(" Error al guardar gasto")}},V=R=>{E(R.id),B(R.date),F(R.category||""),O(R.description||""),me(Number(R.amount||0)),fe(R.status||"PENDIENTE"),te(R.notes||"")},j=()=>{E(null),B(""),F(""),O(""),me(0),fe("PENDIENTE"),te("")},U=async()=>{if(L){if(!M){P("Selecciona una categora.");return}if(!T.trim()){P("Ingresa una descripcin.");return}if(!Y||Y<=0){P("Ingresa un monto vlido.");return}try{await Tr(Tt(je,"expenses",L),{date:_,category:M,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:he||""}),g(R=>R.map(X=>X.id===L?{...X,date:_,category:M,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:he||""}:X)),j(),P(" Gasto actualizado")}catch(R){console.error(R),P(" Error al actualizar gasto")}}},G=async R=>{confirm(`Eliminar el gasto "${R.description}"?`)&&(await dn(Tt(je,"expenses",R.id)),g(se=>se.filter(ye=>ye.id!==R.id)),P(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Pollo)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:R=>e(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:R=>n(R.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",x1(Ie.total)]}),i.jsxs("div",{children:["Pagado: ",x1(Ie.pagado)]}),i.jsxs("div",{children:["Pendiente: ",x1(Ie.pendiente)]})]})]}),i.jsxs("form",{onSubmit:I,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:R=>a(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:R=>l(R.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),tP.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:R=>A(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:R=>d(Math.max(0,Number(R.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:R=>h(R.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:R=>p(R.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):pe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):pe.slice().sort((R,X)=>R.date.localeCompare(X.date)).map(R=>{const X=L===R.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:_,onChange:se=>B(se.target.value)}):R.date}),i.jsx("td",{className:"p-2 border",children:X?i.jsxs("select",{className:"w-full border p-1 rounded",value:M,onChange:se=>F(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),tP.map(se=>i.jsx("option",{value:se,children:se},se))]}):R.category||""}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>O(se.target.value)}):i.jsx("span",{title:R.description,children:R.description.length>40?R.description.slice(0,40)+"":R.description})}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Y)?"":Y,onChange:se=>me(Math.max(0,Number(se.target.value||0)))}):x1(R.amount)}),i.jsx("td",{className:"p-2 border",children:X?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>fe(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${R.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:R.status})}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:he,onChange:se=>te(se.target.value),maxLength:500}):i.jsx("span",{title:R.notes||"",children:(R.notes||"").length>40?(R.notes||"").slice(0,40)+"":R.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:X?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:U,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:j,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>V(R),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>G(R),children:"Borrar"})]})})})]},R.id)})})]})}),k&&i.jsx("p",{className:"mt-2 text-sm",children:k})]})}function _w(t){return(t||"").trim().toLowerCase()}async function r8(){const t=await Ct(At(je,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),s=_w(n.name??n.productName);s&&e.set(s,r.id)}),e}async function nle(t=!1){const e=await r8(),r=await Ct(At(je,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const s of r.docs){n.checked++;const a=s.data(),o=_w(a.productName);if(!o){n.missingName++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,status:"withoutMatch"});continue}if(a.productId===l){n.alreadyOk++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,newProductId:l,status:"alreadyOk"});continue}t||await Tr(Tt(je,"inventory_batches",s.id),{productId:l}),n.fixed++,n.details.push({batchId:s.id,productName:a.productName??"",oldProductId:a.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function sle(t,e=!1){const r=_w(t),s=(await r8()).get(r);if(!s)throw new Error(`No existe un producto activo con nombre "${t}".`);const a=await Ct(At(je,"inventory_batches"));let o=0;for(const l of a.docs){const c=l.data();_w(c.productName)===r&&c.productId!==s&&(e||await Tr(Tt(je,"inventory_batches",l.id),{productId:s}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function ale(){const[t,e]=N.useState(!1),[r,n]=N.useState(""),s=async()=>{try{e(!0),n("");const c=await nle(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[a,o]=N.useState(""),l=async()=>{if(!a.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await sle(a.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${a}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:s,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:a,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const Yn=t=>`C$ ${Number(t??0).toFixed(2)}`,Rd=t=>Number(t??0).toFixed(3);async function ile(t){const e=new Set;for(const n of t)for(const s of n.batches||[]){const a=(s.batchId||s.id||"").trim();if(!a)continue;(s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)&&e.add(a)}if(e.size===0)return t;const r=new Map;return await Promise.all(Array.from(e).map(async n=>{try{const s=await Xa(Tt(je,"inventory_batches",n));if(s.exists()){const a=s.data();r.set(n,Number(a.purchasePrice||0))}}catch{}})),t.map(n=>({...n,batches:(n.batches||[]).map(s=>{if((s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)){const a=(s.batchId||s.id||"").trim(),o=a?r.get(a):void 0;if(o!==void 0)return{...s,purchasePrice:o}}return s})}))}function JN(t){var p,x;const e=t.batches||[],r=t.expenses||[],n=t.adjustments||[],s=Number(((p=t.totals)==null?void 0:p.lbs)??t.totalLbs??0),a=Number(((x=t.totals)==null?void 0:x.units)??t.totalUnits??0);let o=0,l=0;for(const g of e){const w=Number(g.quantity??0);let b=g.expectedTotal!==void 0&&g.expectedTotal!==null?Number(g.expectedTotal):w*Number(g.salePrice??0);isFinite(b)||(b=0);let k=w*Number(g.purchasePrice??Number.NaN);isFinite(k)||(k=g.invoiceTotal!==void 0&&g.invoiceTotal!==null?Number(g.invoiceTotal):0),o+=b,l+=k}const c=r.reduce((g,w)=>g+Number(w.amount||0),0),A=n.filter(g=>g.type==="DEBITO").reduce((g,w)=>g+Number(w.amount||0),0),u=n.filter(g=>g.type==="CREDITO").reduce((g,w)=>g+Number(w.amount||0),0),d=t.totalDebits!==void 0?Number(t.totalDebits):A,f=t.totalCredits!==void 0?Number(t.totalCredits):u,h=o-l,m=o-c-d+f;return{lbs:s,units:a,expectedSum:o,invoicedSum:l,expenses:c,debits:d,credits:f,grossProfit:h,finalAmount:m}}function ole(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(null),o=N.useRef(null);N.useEffect(()=>{(async()=>{n(!0);const u=Ot(At(je,"invoices"),Dr("date","desc")),d=await Ct(u),f=[];d.forEach(m=>{const p=m.data();f.push({id:m.id,...p,batches:p.batches||[],expenses:p.expenses||[],adjustments:p.adjustments||[],totals:p.totals||{lbs:p.totalLbs||0,units:p.totalUnits||0,amount:p.totalAmount||0,expenses:p.totalExpenses||0,finalAmount:p.finalAmount||0,invoiceTotal:p.invoiceTotal||0},totalDebits:p.totalDebits||0,totalCredits:p.totalCredits||0})});const h=await ile(f);e(h),n(!1)})()},[]);const l=async u=>{const d=u.status==="PAGADA"?"PENDIENTE":"PAGADA";await Tr(Tt(je,"invoices",u.id),{status:d}),e(f=>f.map(h=>h.id===u.id?{...h,status:d}:h)),(s==null?void 0:s.id)===u.id&&a({...u,status:d})},c=async u=>{if(window.confirm(`Eliminar factura del ${u.date}?`))try{const d=Tt(je,"invoices",u.id),f=await Xa(d),h=f.exists()?f.data():null,m=Wh(je),p=(h==null?void 0:h.batches)||[];for(const x of p){const g=x.batchId||x.id;if(!g)continue;const w=Tt(je,"inventory_batches",g);m.update(w,{invoiceId:null,invoiceNumber:null,invoiceTotal:null})}m.delete(d),await m.commit(),e(x=>x.filter(g=>g.id!==u.id)),(s==null?void 0:s.id)===u.id&&a(null)}catch(d){console.error(d),alert("No se pudo eliminar la factura por completo.")}},A=async()=>{if(!o.current||!s)return;const u=o.current,d=await Jh(u,{backgroundColor:"#ffffff",onclone:x=>{const g=x.body;g.style.background="#ffffff",g.querySelectorAll("*").forEach(w=>{const b=x.defaultView.getComputedStyle(w);b.boxShadow&&b.boxShadow!=="none"&&(w.style.boxShadow="none")})},scale:2}),f=d.toDataURL("image/png"),h=new or("p","mm","a4"),m=h.internal.pageSize.getWidth(),p=d.height*m/d.width;h.addImage(f,"PNG",0,0,m,p),h.save(`factura_${s.number||s.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Facturacin"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4",children:i.jsxs("table",{className:"min-w-full w-full- text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"N factura"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Unidades"}),i.jsx("th",{className:"p-2 border",children:"Facturado"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),i.jsx("th",{className:"p-2 border",children:"Gastos"}),i.jsx("th",{className:"p-2 border",children:"Dbitos"}),i.jsx("th",{className:"p-2 border",children:"Crditos"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Sin facturas"})}):t.map(u=>{const d=JN(u);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.date}),i.jsx("td",{className:"p-2 border",children:u.number||""}),i.jsx("td",{className:"p-2 border",children:u.description||""}),i.jsx("td",{className:"p-2 border",children:Rd(d.lbs)}),i.jsx("td",{className:"p-2 border",children:Rd(d.units)}),i.jsx("td",{className:"p-2 border",children:Yn(d.invoicedSum)}),i.jsx("td",{className:"p-2 border",children:Yn(d.expectedSum)}),i.jsx("td",{className:"p-2 border",children:Yn(d.expenses)}),i.jsx("td",{className:"p-2 border",children:Yn(d.debits)}),i.jsx("td",{className:"p-2 border",children:Yn(d.credits)}),i.jsx("td",{className:"p-2 border",children:Yn(d.finalAmount)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:u.status})}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>a(u),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>l(u),children:u.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>c(u),children:"Eliminar"})]})})]},u.id)})})]})}),s&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>a(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const u=JN(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras:"})," ",Rd(u.lbs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades:"})," ",Rd(u.units)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Facturado:"})," ",Yn(u.invoicedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Ventas (Esperado):"})," ",Yn(u.expectedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia Bruta:"})," ",Yn(u.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Yn(u.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Yn(u.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Yn(u.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Lotes"}),i.jsxs("table",{className:"min-w-full text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:(s.batches||[]).map((u,d)=>{const f=Number(u.quantity??0),h=u.expectedTotal!==void 0&&u.expectedTotal!==null?Number(u.expectedTotal):f*Number(u.salePrice??0);let m=f*Number(u.purchasePrice??Number.NaN);isFinite(m)||(m=u.invoiceTotal!==void 0&&u.invoiceTotal!==null?Number(u.invoiceTotal):0);const p=h-m;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.productName||"(sin nombre)"}),i.jsx("td",{className:"p-2 border",children:(u.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Rd(u.quantity)}),i.jsx("td",{className:"p-2 border",children:Yn(u.salePrice)}),i.jsx("td",{className:"p-2 border",children:Yn(m)}),i.jsx("td",{className:"p-2 border",children:Yn(h)}),i.jsx("td",{className:"p-2 border",children:Yn(p)})]},d)})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((u,d)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.date}),i.jsx("td",{className:"p-2 border",children:u.description}),i.jsx("td",{className:"p-2 border",children:Yn(u.amount)})]},d)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin gastos"})})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Fecha"})]})}),i.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((u,d)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:u.description}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:u.type})}),i.jsx("td",{className:"p-2 border",children:Yn(u.amount)}),i.jsx("td",{className:"p-2 border",children:s.date})]},d)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin cargos extras"})})})]}),(()=>{const u=JN(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:Rd(u.lbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:Rd(u.units)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:Yn(u.invoicedSum)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:Yn(u.expectedSum)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:Yn(u.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Yn(u.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Yn(u.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Yn(u.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Monto final (esperado  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Yn(u.finalAmount)})]})})]})})()]})]})}const go=t=>`C$${Number(t||0).toFixed(2)}`,kf=t=>Number(t||0).toFixed(3),lle=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),XN=()=>{const t=new Date;return sr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},v1=()=>sr(new Date,"yyyy-MM-dd");function cle({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,a]=N.useState(XN()),[o,l]=N.useState(v1()),[c,A]=N.useState(""),u=N.useMemo(()=>{const ge=new Map;return n.forEach(K=>ge.set(K.productId,{id:K.productId,name:K.productName})),Array.from(ge.values()).sort((K,_e)=>K.name.localeCompare(_e.name))},[n]),d=N.useMemo(()=>n.filter(ge=>!(s&&ge.date<s||o&&ge.date>o||c&&ge.productId!==c)),[n,s,o,c]),[f,h]=N.useState(v1()),[m,p]=N.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,g]=N.useState(""),[w,b]=N.useState(()=>d.map(ge=>ge.id));N.useEffect(()=>{b(ge=>ge.filter(K=>d.some(_e=>_e.id===K)))},[d]);const[k,P]=N.useState([]),[L,E]=N.useState([]),[_,B]=N.useState(!1),[M,F]=N.useState(XN()),[T,O]=N.useState(v1());N.useEffect(()=>{(async()=>{try{B(!0);const ge=Ot(At(je,"expenses"),Dr("date","desc")),K=await Ct(ge),_e=[];K.forEach(Oe=>{const Ve=Oe.data();_e.push({id:Oe.id,date:Ve.date,description:Ve.description,amount:Number(Ve.amount||0)})}),P(_e)}catch(ge){console.error(ge)}finally{B(!1)}})()},[]);const Y=N.useMemo(()=>k.filter(ge=>!(!ge.date||M&&ge.date<M||T&&ge.date>T)),[k,M,T]),[me,ae]=N.useState([]),[fe,he]=N.useState(!1),[te,pe]=N.useState(""),[Ie,S]=N.useState("DEBITO"),[I,V]=N.useState(""),j=()=>{const ge=Number(I);!te.trim()||!isFinite(ge)||ge<=0||(ae(K=>[...K,{id:`${Date.now()}_${K.length+1}`,description:te.trim(),type:Ie,amount:Number(ge.toFixed(2))}]),pe(""),V(""))},[U,G]=N.useState(null),[R,X]=N.useState(""),[se,ye]=N.useState("DEBITO"),[z,Me]=N.useState(""),re=ge=>{G(ge.id),X(ge.description),ye(ge.type),Me(ge.amount.toFixed(2))},W=()=>{G(null),X(""),ye("DEBITO"),Me("")},q=()=>{if(!U)return;const ge=Number(z);!isFinite(ge)||ge<=0||(ae(K=>K.map(_e=>_e.id===U?{..._e,description:R.trim(),type:se,amount:Number(ge.toFixed(2))}:_e)),W())},oe=ge=>{ae(K=>K.filter(_e=>_e.id!==ge)),U===ge&&W()},de=(ge,K)=>{b(_e=>K?[...new Set([..._e,ge])]:_e.filter(Oe=>Oe!==ge))},Be=ge=>{b(ge?d.map(K=>K.id):[])},He=(ge,K)=>{E(_e=>K?[...new Set([..._e,ge])]:_e.filter(Oe=>Oe!==ge))},$e=N.useMemo(()=>d.filter(ge=>w.includes(ge.id)),[d,w]),Je=N.useMemo(()=>me.filter(ge=>ge.type==="DEBITO").reduce((ge,K)=>ge+K.amount,0),[me]),ct=N.useMemo(()=>me.filter(ge=>ge.type==="CREDITO").reduce((ge,K)=>ge+K.amount,0),[me]),at=N.useMemo(()=>{let ge=0,K=0,_e=0,Oe=0;for(const Qe of $e){lle(Qe.unit)?ge+=Number(Qe.quantity||0):K+=Number(Qe.quantity||0);const Ue=Qe.expectedTotal??Number((Number(Qe.quantity||0)*Number(Qe.salePrice||0)).toFixed(2)),Ee=Qe.invoiceTotal!==void 0&&Qe.invoiceTotal!==null?Number(Qe.invoiceTotal):Number((Number(Qe.quantity||0)*Number(Qe.purchasePrice||0)).toFixed(2));_e+=Number(Ue||0),Oe+=Number(Ee||0)}const Ve=Y.filter(Qe=>L.includes(Qe.id)).reduce((Qe,Ue)=>Qe+Number(Ue.amount||0),0),ve=_e-Ve-Je+ct;return{totalLbs:ge,totalUnits:K,totalExpected:Number(_e.toFixed(2)),totalInvoiced:Number(Oe.toFixed(2)),totalGastos:Number(Ve.toFixed(2)),debits:Number(Je.toFixed(2)),credits:Number(ct.toFixed(2)),finalAmount:Number(ve.toFixed(2)),grossProfit:Number((_e-Oe).toFixed(2))}},[$e,Y,L,Je,ct]),[mt,st]=N.useState(!1),[Le,ut]=N.useState(""),be=async()=>{if(ut(""),$e.length===0){ut("Selecciona al menos 1 lote pagado.");return}try{st(!0);const ge={number:m.trim(),date:f,description:x.trim(),status:"PENDIENTE",createdAt:Gt.now(),totalLbs:Number(kf(at.totalLbs)),totalUnits:Number(kf(at.totalUnits)),totalAmount:at.totalExpected,invoiceTotal:at.totalInvoiced,totalExpenses:at.totalGastos,totalDebits:at.debits,totalCredits:at.credits,finalAmount:at.finalAmount,batches:$e.map(K=>{var _e;return{id:K.id,productId:K.productId,productName:K.productName,unit:K.unit,quantity:Number(kf(K.quantity)),salePrice:Number(Number(K.salePrice||0).toFixed(2)),purchasePrice:Number(Number(K.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(K.quantity||0)*Number(K.salePrice||0)).toFixed(2)),invoiceTotal:K.invoiceTotal!==void 0&&K.invoiceTotal!==null?Number(K.invoiceTotal):Number((Number(K.quantity||0)*Number(K.purchasePrice||0)).toFixed(2)),batchDate:K.date,paidAt:(_e=K.paidAt)!=null&&_e.toDate?sr(K.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:Y.filter(K=>L.includes(K.id)).map(K=>({id:K.id,date:K.date||null,description:K.description||"",amount:Number(Number(K.amount||0).toFixed(2))})),adjustments:me.map(K=>({id:K.id,description:K.description,type:K.type,amount:Number(K.amount.toFixed(2))}))};await Jr(At(je,"invoices"),ge),ut(" Factura creada."),r()}catch(ge){console.error(ge),ut(` Error al crear factura: ${(ge==null?void 0:ge.message)||"desconocido"}`)}finally{st(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:f,onChange:ge=>h(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:ge=>p(ge.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:ge=>g(ge.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:ge=>a(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:ge=>l(ge.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:ge=>A(ge.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),u.map(ge=>i.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{a(XN()),l(v1()),A("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:d.length>0&&w.length===d.length,onChange:ge=>Be(ge.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),d.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha lote"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),i.jsx("tbody",{children:d.map(ge=>{var ve;const K=w.includes(ge.id),_e=ge.expectedTotal??Number((Number(ge.quantity||0)*Number(ge.salePrice||0)).toFixed(2)),Oe=ge.invoiceTotal!==void 0&&ge.invoiceTotal!==null?Number(ge.invoiceTotal):Number((Number(ge.quantity||0)*Number(ge.purchasePrice||0)).toFixed(2)),Ve=_e-Oe;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:K,onChange:Qe=>de(ge.id,Qe.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ge.date}),i.jsx("td",{className:"p-2 border",children:ge.productName}),i.jsx("td",{className:"p-2 border",children:(ge.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:kf(ge.quantity)}),i.jsx("td",{className:"p-2 border",children:go(ge.salePrice)}),i.jsx("td",{className:"p-2 border",children:go(Oe)}),i.jsx("td",{className:"p-2 border",children:go(_e)}),i.jsx("td",{className:"p-2 border",children:go(Ve)}),i.jsx("td",{className:"p-2 border",children:(ve=ge.paidAt)!=null&&ve.toDate?sr(ge.paidAt.toDate(),"yyyy-MM-dd"):""})]},ge.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),_&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:M,onChange:ge=>F(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:T,onChange:ge=>O(ge.target.value)})]})]})]}),Y.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:Y.map(ge=>{const K=L.includes(ge.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:K,onChange:_e=>He(ge.id,_e.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ge.date||""}),i.jsx("td",{className:"p-2 border",children:ge.description||""}),i.jsx("td",{className:"p-2 border",children:go(Number(ge.amount||0))})]},ge.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>he(!0),children:"Crear Cargo"})]}),me.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:me.map(ge=>{const K=U===ge.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:K?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:R,onChange:_e=>X(_e.target.value)}):i.jsx("span",{title:ge.description,children:ge.description.length>60?`${ge.description.slice(0,60)}`:ge.description})}),i.jsx("td",{className:"p-2 border",children:K?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:se,onChange:_e=>ye(_e.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ge.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:ge.type})}),i.jsx("td",{className:"p-2 border",children:K?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:z,onChange:_e=>Me(_e.target.value)}):go(ge.amount)}),i.jsx("td",{className:"p-2 border",children:K?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:q,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:W,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>oe(ge.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>re(ge),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>oe(ge.id),children:"Eliminar"})]})})]},ge.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:kf(at.totalLbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:kf(at.totalUnits)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:go(at.totalInvoiced)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:go(at.totalExpected)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:go(at.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:go(at.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:go(at.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:go(at.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:go(at.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:mt,onClick:be,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:mt?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Le&&i.jsx("span",{className:"text-sm ml-2",children:Le})]}),mt&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),fe&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>he(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:te,onChange:ge=>pe(ge.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Ie,onChange:ge=>S(ge.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:I,onChange:ge=>V(ge.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:j,children:"Agregar"})})]})]})})]})}const Dd=t=>`C$ ${Number(t||0).toFixed(2)}`,Tf=t=>Number(t||0).toFixed(3),Ale=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function ule(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(!1),[o,l]=N.useState(null),[c,A]=N.useState(sr(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[u,d]=N.useState(sr(new Date,"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(!1),{refreshKey:x,refresh:g}=Xl();N.useEffect(()=>{(async()=>{n(!0);const E=Ot(At(je,"inventory_batches"),$t("status","==","PAGADO"),Dr("date","desc")),_=await Ct(E),B=[];_.forEach(M=>{const F=M.data(),T=Number(F.quantity||0),O=Number(F.remaining||0),Y=Number(F.purchasePrice||0),me=Number(F.salePrice||0),ae=Number((T*Y).toFixed(2)),fe=Number((T*me).toFixed(2));B.push({id:M.id,productId:F.productId,productName:F.productName,category:F.category,unit:F.unit,quantity:T,remaining:O,purchasePrice:Y,salePrice:me,invoiceTotal:F.invoiceTotal!=null?Number(F.invoiceTotal):ae,expectedTotal:F.expectedTotal!=null?Number(F.expectedTotal):fe,date:F.date,status:F.status,paidAt:F.paidAt})}),e(B),n(!1)})()},[x]);const w=N.useMemo(()=>t.filter(E=>!(c&&E.date<c||u&&E.date>u||f&&E.productId!==f)),[t,c,u,f]),b=N.useMemo(()=>{let E=0,_=0,B=0,M=0,F=0,T=0;for(const O of w)Ale(O.unit)?(E+=O.quantity,_+=O.remaining):(B+=O.quantity,M+=O.remaining),F+=Number(O.expectedTotal||0),T+=Number(O.invoiceTotal||0);return{lbsIng:E,lbsRem:_,udsIng:B,udsRem:M,totalEsperado:F,totalFact:T,gross:F-T}},[w]),k=E=>{l(E),a(!0)},P=async()=>{if(o)try{const E=Tt(je,"inventory_batches",o.id);await Tr(E,{status:"PENDIENTE",remaining:o.quantity});const _=At(je,"salesV2"),B=await Ct(Ot(_,$t("batchId","==",o.id))),M=await Ct(Ot(_,$t("productName","==",o.productName),$t("date","==",o.date))),F=[...B.docs,...M.docs];for(const T of F)await dn(Tt(je,"salesV2",T.id));e(T=>T.map(O=>O.id===o.id?{...O,status:"PENDIENTE",remaining:o.quantity}:O)),a(!1),l(null),g()}catch(E){console.error("Error al marcar pendiente:",E)}},L=N.useMemo(()=>{const E=new Map;return t.forEach(_=>E.set(_.productId,{id:_.productId,name:_.productName})),Array.from(E.values())},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(kc,{onClick:g,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:E=>A(E.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:E=>d(E.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:E=>h(E.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),L.map(E=>i.jsx("option",{value:E.id,children:E.name},E.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Tf(b.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Tf(b.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Dd(b.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Tf(b.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Tf(b.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Dd(b.totalFact)]}),i.jsxs("div",{className:"col-span-3",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Dd(b.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",w.length.toLocaleString()]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):w.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):w.map(E=>{var _;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:E.date}),i.jsx("td",{className:"p-2 border",children:(E.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:E.productName}),i.jsx("td",{className:"p-2 border",children:(E.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Tf(E.quantity)}),i.jsx("td",{className:"p-2 border",children:Tf(E.remaining)}),i.jsx("td",{className:"p-2 border",children:Dd(E.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:Dd(E.salePrice)}),i.jsx("td",{className:"p-2 border",children:Dd(E.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:Dd(E.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(_=E.paidAt)!=null&&_.toDate?sr(E.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>k(E),children:"Marcar PENDIENTE"})})]},E.id)})})]})}),m&&i.jsx(cle,{paidBatches:w,onClose:()=>p(!1),onCreated:()=>p(!1)}),s&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-[90%] max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas del dashboard."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded",children:"Cancelar"}),i.jsx("button",{onClick:P,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded",children:"Confirmar"})]})]})})]})}const ya=t=>`C$ ${(Number(t)||0).toFixed(2)}`,dle=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function y1(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function hle(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function fle(t){const e="ROP",r=y1(t.subcat).slice(0,3)||"GEN",n=hle(t.gender),s=y1(t.color).slice(0,3)||"COL",a=y1(t.size)||"TLL",o=y1(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${s}-${a}-${o}-${l}`}const np=/^[A-Za-z0-9._-]{0,32}$/;function mle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[u,d]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(sr(new Date,"yyyy-MM-dd")),[w,b]=N.useState(0),[k,P]=N.useState(0),[L,E]=N.useState(0),[_,B]=N.useState(0),[M,F]=N.useState(0),[T,O]=N.useState(""),[Y,me]=N.useState(""),[ae,fe]=N.useState(""),[he,te]=N.useState(""),[pe,Ie]=N.useState(""),[S,I]=N.useState(""),[V,j]=N.useState(""),[U,G]=N.useState(!1),[R,X]=N.useState(""),[se,ye]=N.useState("Camisa"),[z,Me]=N.useState(null),[re,W]=N.useState(""),[q,oe]=N.useState(0),[de,Be]=N.useState(0),[He,$e]=N.useState(0),[Je,ct]=N.useState(0),[at,mt]=N.useState(0),[st,Le]=N.useState(""),[ut,be]=N.useState(""),[ge,K]=N.useState(""),[_e,Oe]=N.useState(""),[Ve,ve]=N.useState(""),[Qe,Ue]=N.useState(""),[Ee,We]=N.useState(""),[nt,Nt]=N.useState(null),[ot,wt]=N.useState({x:0,y:0}),[Lt,cr]=N.useState(!1);N.useEffect(()=>{const ne=()=>Nt(null),ue=xe=>xe.key==="Escape"&&Nt(null);return document.addEventListener("click",ne),document.addEventListener("keydown",ue),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",ue)}},[]);const ar=(ne,ue,xe=192,Fe=160)=>{let ee=ne;ne+xe+8>window.innerWidth&&(ee=ne-xe),ee=Math.max(8,Math.min(ee,window.innerWidth-xe-8));let Te=ue;return ue+Fe+8>window.innerHeight&&(Te=window.innerHeight-Fe-8),Te=Math.max(8,Math.min(Te,window.innerHeight-Fe-8)),{x:ee,y:Te}},yr=(ne,ue)=>{ne.stopPropagation();const xe=ne.currentTarget.getBoundingClientRect(),Fe=xe.right,De=xe.bottom,ee=ar(Fe,De);wt(ee),Nt(Te=>Te===ue?null:ue)};N.useEffect(()=>{const ne=()=>Nt(null),ue=xe=>{xe.key==="Escape"&&Nt(null)};return document.addEventListener("click",ne),document.addEventListener("keydown",ue),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",ue)}},[]),N.useEffect(()=>{if(!nt)return;const ne=()=>Nt(null);return window.addEventListener("scroll",ne,!0),window.addEventListener("resize",ne),()=>{window.removeEventListener("scroll",ne,!0),window.removeEventListener("resize",ne)}},[nt]),N.useEffect(()=>{(async()=>{const ne=await Ct(At(je,"products_clothes")),ue=[];ne.forEach(ee=>{const Te=ee.data();ue.push({id:ee.id,name:Te.name??"(sin nombre)",category:Te.category??"(sin categora)",measurement:Te.measurement??"unidad",price:Number(Te.price??0),sku:Te.sku||"",size:Te.size||"",color:Te.color||"",gender:Te.gender||"",brand:Te.brand||""})}),e(ue);const xe=Ot(At(je,"inventory_clothes_batches"),Dr("date","desc")),Fe=await Ct(xe),De=[];Fe.forEach(ee=>{const Te=ee.data();De.push({id:ee.id,productId:Te.productId,productName:Te.productName,category:Te.category,unit:Te.unit,quantity:Number(Te.quantity||0),remaining:Number(Te.remaining??Te.quantity??0),purchasePrice:Number(Te.purchasePrice||0),salePrice:Number(Te.salePrice||0),invoiceTotal:Number(Te.invoiceTotal??Number(Te.quantity||0)*Number(Te.purchasePrice||0)),expectedTotal:Number(Te.expectedTotal??Number(Te.quantity||0)*Number(Te.salePrice||0)),date:Te.date,createdAt:Te.createdAt,status:Te.status,notes:Te.notes||"",sku:Te.sku||"",size:Te.size||"",color:Te.color||"",gender:Te.gender||"",brand:Te.brand||"",clientCode:Te.clientCode||""})}),n(De),a(!1)})()},[]),N.useEffect(()=>{const ne=t.find(ue=>ue.id===m);ne&&(E(Number(ne.price||0)),ne.sku&&me(ne.sku),ne.size&&fe(ue=>ue||ne.size),ne.color&&te(ue=>ue||ne.color),ne.gender&&Ie(ue=>ue||ne.gender),ne.brand&&I(ue=>ue||ne.brand))},[m,t]),N.useEffect(()=>{B(Math.floor(w*k*100)/100)},[w,k]),N.useEffect(()=>{F(Math.floor(w*L*100)/100)},[w,L]),N.useEffect(()=>{const ne=t.find(Fe=>Fe.id===m);if(ne!=null&&ne.sku){me(ne.sku);return}const ue=U&&se?se:(ne==null?void 0:ne.category)||"";if(!ue&&!pe&&!he&&!ae&&!S){me("");return}const xe=fle({subcat:ue,gender:pe||"",color:he||"",size:ae||"",brand:S||""});me(xe)},[U,se,m,pe,he,ae,S,t]);const tr=N.useMemo(()=>r.filter(ne=>!(c&&ne.date<c||u&&ne.date>u||f&&ne.productId!==f)),[r,c,u,f]),et=N.useMemo(()=>{const ne=tr.reduce((De,ee)=>De+(ee.invoiceTotal||0),0),ue=tr.reduce((De,ee)=>De+(ee.expectedTotal||0),0),xe=tr.reduce((De,ee)=>De+ee.quantity,0),Fe=tr.reduce((De,ee)=>De+ee.remaining,0);return{udsIng:xe,udsRem:Fe,totalFacturado:ne,totalEsperado:ue}},[tr]),gt=async ne=>{ne.preventDefault(),l("");const ue=!!m&&!U,xe=t.find(Te=>Te.id===m),Fe=ue?(xe==null?void 0:xe.name)||"":R||"",De=ue?(xe==null?void 0:xe.category)||"":se||"General",ee=ue&&(xe==null?void 0:xe.measurement)||"unidad";if(!Fe||w<=0||k<=0){l("Completa nombre/cantidad/costo.");return}if(V&&!np.test(V)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const Te=await Jr(At(je,"inventory_clothes_batches"),{productId:ue?xe.id:"",productName:Fe,category:De,unit:ee,quantity:w,remaining:w,purchasePrice:k,salePrice:L,invoiceTotal:_,expectedTotal:M,date:x,createdAt:Gt.now(),status:"PENDIENTE",notes:T||"",sku:Y||"",size:ae||"",color:he||"",gender:pe||"",brand:S||"",clientCode:V||""});n(Ae=>[{id:Te.id,productId:ue?xe.id:"",productName:Fe,category:De,unit:ee,quantity:w,remaining:w,purchasePrice:k,salePrice:L,invoiceTotal:_,expectedTotal:M,date:x,createdAt:Gt.now(),status:"PENDIENTE",notes:T||"",sku:Y||"",size:ae||"",color:he||"",gender:pe||"",brand:S||"",clientCode:V||""},...Ae]),l(" Lote de ropa creado"),p(""),g(sr(new Date,"yyyy-MM-dd")),b(0),P(0),E(0),B(0),F(0),O(""),me(""),fe(""),te(""),Ie(""),I(""),j(""),G(!1),X(""),ye("Camisa")}catch(Te){console.error(Te),l(" Error al crear lote")}},Rt=async ne=>{confirm(`Marcar PAGADO el lote del ${ne.date} (${ne.productName})?`)&&(await Tr(Tt(je,"inventory_clothes_batches",ne.id),{status:"PAGADO"}),n(xe=>xe.map(Fe=>Fe.id===ne.id?{...Fe,status:"PAGADO"}:Fe)))},kt=ne=>{Me(ne.id),W(ne.date),oe(ne.quantity),Be(ne.purchasePrice),$e(ne.salePrice),ct(Number((ne.quantity*ne.purchasePrice).toFixed(2))),mt(Number((ne.quantity*ne.salePrice).toFixed(2))),Le(ne.notes||""),be(ne.sku||""),K(ne.size||""),Oe(ne.color||""),ve(ne.gender||""),Ue(ne.brand||""),We(ne.clientCode||"")},jt=()=>{Me(null),W(""),oe(0),Be(0),$e(0),ct(0),mt(0),Le(""),be(""),K(""),Oe(""),ve(""),Ue(""),We("")};N.useEffect(()=>{z&&ct(Math.floor(q*de*100)/100)},[z,q,de]),N.useEffect(()=>{z&&mt(Math.floor(q*He*100)/100)},[z,q,He]);const Zt=async()=>{if(!z)return;const ne=r.find(De=>De.id===z);if(!ne)return;const ue=Math.max(0,ne.quantity-ne.remaining),xe=Math.max(0,q-ue);if(Ee&&!np.test(Ee)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const Fe=Tt(je,"inventory_clothes_batches",z);await Tr(Fe,{date:re,quantity:q,purchasePrice:de,salePrice:He,invoiceTotal:Je,expectedTotal:at,notes:st,remaining:xe,sku:ut,size:ge,color:_e,gender:Ve||"",brand:Qe||"",clientCode:Ee||""}),n(De=>De.map(ee=>ee.id===z?{...ee,date:re,quantity:q,purchasePrice:de,salePrice:He,invoiceTotal:Je,expectedTotal:at,notes:st,remaining:xe,sku:ut,size:ge,color:_e,gender:Ve||"",brand:Qe||"",clientCode:Ee||""}:ee)),jt(),l(" Lote actualizado")},Vt=async ne=>{confirm(`Eliminar el lote del ${ne.date} (${ne.productName})?`)&&(await dn(Tt(je,"inventory_clothes_batches",ne.id)),n(xe=>xe.filter(Fe=>Fe.id!==ne.id)),l(" Lote eliminado"))},ie=()=>{const ne=(c?`Desde ${c}`:"Desde inicio")+"  "+(u?`Hasta ${u}`:"Hasta hoy"),ue=ee=>(ee||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),xe=tr.map(ee=>`
      <tr>
        <td>${ee.date}</td>
        <td>${(ee.category||"").toUpperCase()}</td>
        <td>${ue(ee.productName)}</td>
        <td>${ue(ee.sku||"")}</td>
        <td>${ue(ee.size||"")}</td>
        <td>${ue(ee.color||"")}</td>
        <td>${ue(ee.clientCode||"")}</td>
        <td>${ue(ee.gender||"")}</td>
        <td>${(ee.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${ee.quantity.toFixed(0)}</td>
        <td style="text-align:right">${ee.remaining.toFixed(0)}</td>
        <td style="text-align:right">${ya(ee.purchasePrice)}</td>
        <td style="text-align:right">${ya(ee.salePrice)}</td>
        <td style="text-align:right">${ya(ee.invoiceTotal||0)}</td>
        <td style="text-align:right">${ya(ee.expectedTotal||0)}</td>
        <td>${ue((ee.notes||"").slice(0,120))}</td>
        <td>${ee.status}</td>
      </tr>`).join(""),Fe=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${ne}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${et.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${et.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${ya(et.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${ya(et.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${ya(Number((et.totalEsperado-et.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${xe||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,De=window.open("","_blank");De&&(De.document.open(),De.document.write(Fe),De.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>cr(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:ne=>A(ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:ne=>d(ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:ne=>h(ne.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(ne=>i.jsxs("option",{value:ne.id,children:[ne.name,"  ",ne.category]},ne.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:ie,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",et.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",et.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",ya(et.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",ya(et.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",ya(Number((et.totalEsperado-et.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):tr.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):tr.map(ne=>{const ue=z===ne.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:ue?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:re,onChange:xe=>W(xe.target.value)}):ne.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(ne.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:ne.productName,children:ne.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:ut,onChange:xe=>be(xe.target.value)}):i.jsx("span",{className:"block truncate",title:ne.sku||"",children:ne.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:ge,onChange:xe=>K(xe.target.value)}):ne.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:_e,onChange:xe=>Oe(xe.target.value)}):ne.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:ue?i.jsx("input",{className:"w-full border p-1 rounded",value:Ee,onChange:xe=>{const Fe=xe.target.value;np.test(Fe)&&We(Fe)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:ne.clientCode||"",children:ne.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:ue?i.jsx("select",{className:"w-full border p-1 rounded",value:Ve,onChange:xe=>ve(xe.target.value),children:dle.map(xe=>i.jsx("option",{value:xe,children:xe||""},xe))}):ne.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(ne.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ue?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(q)?"":q,onChange:xe=>oe(Math.max(0,parseInt(xe.target.value||"0",10)))}):ne.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ue?ne.remaining:ne.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ue?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(de)?"":de,onChange:xe=>Be(Math.max(0,parseFloat(xe.target.value||"0")))}):ya(ne.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ue?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(He)?"":He,onChange:xe=>$e(Math.max(0,parseFloat(xe.target.value||"0")))}):ya(ne.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:ya(ue?Je:ne.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:ya(ue?at:ne.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:ue?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:st,onChange:xe=>Le(xe.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:ne.notes||"",children:ne.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${ne.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ne.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:ue?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Zt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:jt,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:xe=>yr(xe,ne.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},ne.id)})})]})})}),nt&&Ku.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>Nt(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:ot.x,top:ot.y},onClick:ne=>ne.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const ne=tr.find(ue=>ue.id===nt);return(ne==null?void 0:ne.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{Nt(null),Rt(ne)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const ne=tr.find(ue=>ue.id===nt);ne&&(Nt(null),kt(ne))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const ne=tr.find(ue=>ue.id===nt);ne&&(Nt(null),Vt(ne))},children:" Borrar"})]})})]}),document.body),Lt&&Ku.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>cr(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>cr(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:gt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ne=>p(ne.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(ne=>i.jsxs("option",{value:ne.id,children:[ne.name,"  ",ne.category,"  ",ne.sku?`SKU: ${ne.sku}`:""]},ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:ne=>g(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:ne=>b(Math.max(0,parseInt(ne.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:k===0?"":k,onChange:ne=>P(Math.max(0,parseFloat(ne.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:L===0?"":L,onChange:ne=>E(Math.max(0,parseFloat(ne.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Y,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ae,readOnly:!0,onChange:ne=>fe(ne.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:he,readOnly:!0,onChange:ne=>te(ne.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:pe,readOnly:!0,onChange:ne=>Ie(ne.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:S,onChange:ne=>I(ne.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:V,onChange:ne=>{const ue=ne.target.value;np.test(ue)&&j(ue)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!np.test(V)&&V.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:T,onChange:ne=>O(ne.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[T.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:ya(_),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:ya(M),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>cr(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const ple=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],gle=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],xle=["XS","S","M","L","XL","2XL"],vle=["2","4","6","8","10","12","14"],yle=["26","28","30","32","34","36","38"],wle=["Shein","Usado","Otro"],ble=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function w1(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function Nle(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function Cle(t){const e="ROP",r=w1(t.subcat).slice(0,3)||"GEN",n=Nle(t.gender),s=w1(t.color).slice(0,3)||"COL",a=w1(t.size)||"TLL",o=w1(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${s}-${a}-${o}`}const _le=/^[A-Za-z0-9._-]{0,32}$/;function Ele(){const[t,e]=N.useState(""),[r,n]=N.useState("Camisa"),[s,a]=N.useState(""),[o,l]=N.useState(""),[c,A]=N.useState("Shein"),[u,d]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(""),[w,b]=N.useState(""),[k,P]=N.useState("0"),[L,E]=N.useState(""),[_,B]=N.useState(""),M=N.useMemo(()=>{const j=Number(k||0),U=Number(w||0);return Math.floor(j*U*100)/100},[k,w]),[F,T]=N.useState([]),[O,Y]=N.useState(!0),[me,ae]=N.useState(""),{refreshKey:fe,refresh:he}=Xl(),[te,pe]=N.useState(!1),Ie=N.useMemo(()=>r.toLowerCase()==="jean"?yle:u==="NINO"||u==="NINA"?vle:xle,[r,u]);N.useEffect(()=>{p(Cle({subcat:r,gender:u,color:o,size:s,brand:c}))},[r,u,o,s,c]),N.useEffect(()=>{(async()=>{Y(!0);const j=Ot(At(je,"products_clothes"),Dr("createdAt","desc")),U=await Ct(j),G=[];U.forEach(R=>{const X=R.data();G.push({id:R.id,name:X.name??"(sin nombre)",category:X.category??"",measurement:X.measurement??"unidad",sku:X.sku??"",size:X.size||"",color:X.color||"",brand:X.brand||"",gender:X.gender||"",clientCode:X.clientCode||"",notes:X.notes||"",createdAt:X.createdAt??Gt.now()})}),T(G),Y(!1)})()},[fe]);const S=()=>{e(""),n("Camisa"),a(""),l(""),A("Shein"),d(""),h(""),g(""),b(""),P("0"),E(""),B("")},I=async j=>{if(j.preventDefault(),ae(""),!t.trim()){ae("Ingresa el nombre del producto.");return}if(f&&!_le.test(f)){ae("Cdigo del cliente invlido");return}const U=Number(k||0),G=Number(w||0);if(U<0){ae("La cantidad de piezas debe ser 0 o mayor.");return}if(G<0){ae("El precio de venta no puede ser negativo.");return}try{const R=await Jr(At(je,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:u||"",clientCode:f||"",notes:x||"",createdAt:Gt.now(),price:G||0});if(T(X=>[{id:R.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:u||"",clientCode:f||"",notes:x||"",createdAt:Gt.now()},...X]),U>0){const X=new Date().toISOString().slice(0,10),se=L||X;await Jr(At(je,"inventory_clothes_batches"),{productId:R.id,productName:t.trim(),category:r,unit:"unidad",quantity:U,remaining:U,purchasePrice:0,salePrice:G||0,invoiceTotal:0,expectedTotal:M||0,date:se,createdAt:Gt.now(),status:"PENDIENTE",notes:_||"",sku:m||"",size:s||"",color:o||"",gender:u||"",brand:c||"",clientCode:f||""})}ae(U>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),S()}catch(R){console.error(R),ae(" Error al crear producto")}},V=async j=>{confirm(`Eliminar el producto "${j.name}"?`)&&(await dn(Tt(je,"products_clothes",j.id)),T(G=>G.filter(R=>R.id!==j.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(kc,{onClick:he,loading:O}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{pe(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),te&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:I,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:j=>e(j.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:j=>n(j.target.value),children:ple.map(j=>i.jsx("option",{value:j,children:j},j))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:u,onChange:j=>d(j.target.value),children:ble.map(j=>i.jsx("option",{value:j,children:j||""},j))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:s,onChange:j=>a(j.target.value),children:[i.jsx("option",{value:"",children:""}),Ie.map(j=>i.jsx("option",{value:j,children:j},j))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:j=>l(j.target.value),children:[i.jsx("option",{value:"",children:""}),gle.map(j=>i.jsx("option",{value:j,children:j},j))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:j=>A(j.target.value),children:wle.map(j=>i.jsx("option",{value:j,children:j},j))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:j=>h(j.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:w,onChange:j=>b(j.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:k,onChange:j=>P(j.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:L,onChange:j=>E(j.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(M)?"":M.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:S,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>pe(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:O?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):F.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):F.map(j=>{var U;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(U=j.createdAt)!=null&&U.toDate?j.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:j.category}),i.jsx("td",{className:"p-2 border",children:j.name}),i.jsx("td",{className:"p-2 border",children:j.sku}),i.jsx("td",{className:"p-2 border",children:j.size||""}),i.jsx("td",{className:"p-2 border",children:j.color||""}),i.jsx("td",{className:"p-2 border",children:j.brand||""}),i.jsx("td",{className:"p-2 border",children:j.gender||""}),i.jsx("td",{className:"p-2 border",children:j.clientCode||""}),i.jsx("td",{className:"p-2 border",children:j.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>V(j),children:"Borrar"})})]},j.id)})})]})}),me&&i.jsx("p",{className:"mt-2 text-sm",children:me})]})}async function Ble(t){const{productId:e,quantity:r,saleDate:n,saleId:s}=t,a=Math.max(0,Math.floor(Number(r||0)));if(!e||a<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=Ot(At(je,"inventory_clothes_batches"),$t("productId","==",e)),A=(await Ct(o)).docs.map(d=>({id:d.id,data:d.data()})).sort((d,f)=>{var g,w;const h=String(d.data.date||""),m=String(f.data.date||"");if(h!==m)return h<m?-1:1;const p=((g=d.data.createdAt)==null?void 0:g.seconds)??0,x=((w=f.data.createdAt)==null?void 0:w.seconds)??0;return p-x}).map(d=>Tt(je,"inventory_clothes_batches",d.id)),u=[];return await ma(je,async d=>{const f=await Promise.all(A.map(m=>d.get(m)));let h=a;for(let m=0;m<A.length&&h>0;m++){const p=A[m],x=f[m];if(!x.exists())continue;const g=x.data(),w=Math.max(0,Math.floor(Number(g.quantity||0))),b=Number.isFinite(Number(g.remaining))?Math.max(0,Math.floor(Number(g.remaining||0))):w;if(b<=0)continue;const k=Math.min(b,h),P=Math.max(0,b-k);d.update(p,{remaining:P}),u.push({batchId:p.id,qty:k,batchDate:String(g.date||""),productName:String(g.productName||"")}),h-=k}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(s)for(const m of u)await Jr(At(je,"batch_clothes_allocations"),{saleId:s,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:Gt.now()})}),{allocations:u}}async function BE(t){const e=Tt(je,"sales_clothes",t),r=await Xa(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const A=n.allocationsByItem[c],u=String((A==null?void 0:A.productId)||c||"");if(!u)continue;const d=Array.isArray(A==null?void 0:A.allocations)?A.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const A=String((c==null?void 0:c.productId)||"");if(!A)continue;const u=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[A]=u.map(d=>({batchId:String(d.batchId),qty:Math.max(0,Math.floor(Number(d.qty||d.quantity||0)))}))}for(const c of n.items){const A=String((c==null?void 0:c.productId)||"");if(!A)continue;const u=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),d=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):l[A]||[];s.push({productId:A,productName:String((c==null?void 0:c.productName)||""),qty:u,allocations:d.length?d:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),A=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),u=Array.isArray(n.allocations)?n.allocations.map(d=>({batchId:String(d.batchId),qty:Math.max(0,Math.floor(Number(d.qty||d.quantity||0)))})):[];c&&A>0&&s.push({productId:c,productName:String(l.productName||n.productName||""),qty:A,allocations:u.length?u:void 0})}return s.length===0?(await ma(je,async l=>{l.delete(e)}),{restored:0}):s.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await ma(je,async c=>{const A=[];for(const d of s)for(const f of d.allocations||[])A.push({ref:Tt(je,"inventory_clothes_batches",f.batchId),addBack:Math.max(0,Math.floor(Number(f.qty||0)))});const u=await Promise.all(A.map(d=>c.get(d.ref)));for(let d=0;d<A.length;d++){const f=u[d];if(!f.exists())continue;const h=f.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(A[d].ref,{remaining:m+A[d].addBack})}c.delete(e)}),{restored:s.reduce((c,A)=>c+(A.allocations||[]).reduce((u,d)=>u+d.qty,0),0)}):(await ma(je,async l=>{const c={};for(const h of s){if(!h.productId||h.qty<=0)continue;const m=Ot(At(je,"inventory_clothes_batches"),$t("productId","==",h.productId)),x=(await Ct(m)).docs.map(g=>{const w=g.data(),b=Math.max(0,Math.floor(Number(w.quantity||0))),k=Number.isFinite(Number(w.remaining))?Math.max(0,Math.floor(Number(w.remaining||0))):b;return{id:g.id,date:String(w.date||""),quantity:b,remaining:k}}).sort((g,w)=>g.date.localeCompare(w.date));c[h.productId]=x}const A=[];for(const h of s){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)A.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const g=Math.max(0,x.quantity-x.remaining);if(g<=0)continue;const w=Math.min(g,p);A.push({id:x.id,addBack:w}),p-=w}for(const x of m){if(p<=0)break;const g=Math.min(p,h.qty);A.push({id:x.id,addBack:g}),p-=g}}const u={};for(const h of A)u[h.id]=(u[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const d=Object.keys(u).map(h=>Tt(je,"inventory_clothes_batches",h)),f=await Promise.all(d.map(h=>l.get(h)));for(let h=0;h<d.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),g=Math.max(0,Math.floor(Number(u[d[h].id]||0)));l.update(d[h],{remaining:x+g})}l.delete(e)}),{restored:s.reduce((l,c)=>l+c.qty,0)})}const rP=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Xc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function b1(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function nP(t){const e=Ot(At(je,"ar_movements"),$t("ref.saleId","==",t)),r=await Ct(e);await Promise.all(r.docs.map(n=>dn(Tt(je,"ar_movements",n.id))))}function Sle(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,a]=N.useState(null),[o,l]=N.useState([]),c=async et=>{e(!0),n(!0),a(et),l([]);try{const Rt=(await Ct(Ot(At(je,"sales_clothes"),$t("__name__","==",et)))).docs[0],kt=Rt==null?void 0:Rt.data(),Zt=(Array.isArray(kt==null?void 0:kt.items)?kt.items:kt!=null&&kt.item?[kt.item]:[]).map(Vt=>({productName:String(Vt.productName||""),qty:Number(Vt.qty||0),unitPrice:Number(Vt.unitPrice||0),discount:Number(Vt.discount||0),total:Number(Vt.total||0)}));l(Zt)}catch(gt){console.error(gt)}finally{n(!1)}},[A,u]=N.useState(""),[d,f]=N.useState("+505 "),[h,m]=N.useState(""),[p,x]=N.useState(""),[g,w]=N.useState("ACTIVO"),[b,k]=N.useState(0),[P,L]=N.useState([]),[E,_]=N.useState(!0),[B,M]=N.useState(""),[F,T]=N.useState(null),[O,Y]=N.useState(""),[me,ae]=N.useState("+505 "),[fe,he]=N.useState(""),[te,pe]=N.useState(""),[Ie,S]=N.useState("ACTIVO"),[I,V]=N.useState(0),[j,U]=N.useState(!1),[G,R]=N.useState(null),[X,se]=N.useState(!1),[ye,z]=N.useState([]),[Me,re]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[W,q]=N.useState(!1),[oe,de]=N.useState(0),[Be,He]=N.useState(new Date().toISOString().slice(0,10)),[$e,Je]=N.useState(""),[ct,at]=N.useState(!1),[mt,st]=N.useState(null),[Le,ut]=N.useState(""),[be,ge]=N.useState(0),[K,_e]=N.useState(""),[Oe,Ve]=N.useState(!1);N.useEffect(()=>{(async()=>{const et=Ot(At(je,"customers_clothes"),Dr("createdAt","desc")),gt=await Ct(et),Rt=[];gt.forEach(kt=>{const jt=kt.data();Rt.push({id:kt.id,name:jt.name??"",phone:jt.phone??"+505 ",place:jt.place??"",notes:jt.notes??"",status:jt.status??"ACTIVO",creditLimit:Number(jt.creditLimit??0),createdAt:jt.createdAt??Gt.now(),balance:0})});for(const kt of Rt)try{const jt=Ot(At(je,"ar_movements"),$t("customerId","==",kt.id)),Zt=await Ct(jt);let Vt=0;Zt.forEach(ie=>Vt+=Number(ie.data().amount||0)),kt.balance=Vt}catch{kt.balance=0}L(Rt),_(!1)})()},[]);const ve=()=>{u(""),f("+505 "),m(""),x(""),w("ACTIVO"),k(0)},Qe=async et=>{if(et.preventDefault(),M(""),!A.trim()){M("Ingresa el nombre.");return}const gt=b1(d);if(gt.length<6){M("Telfono incompleto.");return}try{const Rt=await Jr(At(je,"customers_clothes"),{name:A.trim(),phone:gt,place:h||"",notes:p||"",status:g,creditLimit:Number(b||0),createdAt:Gt.now()});L(kt=>[{id:Rt.id,name:A.trim(),phone:gt,place:h||"",notes:p||"",status:g,creditLimit:Number(b||0),createdAt:Gt.now(),balance:0},...kt]),ve(),Ve(!1),M(" Cliente creado")}catch(Rt){console.error(Rt),M(" Error al crear cliente")}},Ue=et=>{T(et.id),Y(et.name),ae(et.phone||"+505 "),he(et.place||""),pe(et.notes||""),S(et.status||"ACTIVO"),V(Number(et.creditLimit||0))},Ee=()=>{T(null),Y(""),ae("+505 "),he(""),pe(""),S("ACTIVO"),V(0)},We=async()=>{if(!F)return;const et=b1(me);if(!O.trim()){M("Ingresa el nombre.");return}try{await Tr(Tt(je,"customers_clothes",F),{name:O.trim(),phone:et,place:fe||"",notes:te||"",status:Ie,creditLimit:Number(I||0)}),L(gt=>gt.map(Rt=>Rt.id===F?{...Rt,name:O.trim(),phone:et,place:fe||"",notes:te||"",status:Ie,creditLimit:Number(I||0)}:Rt)),Ee(),M(" Cliente actualizado")}catch(gt){console.error(gt),M(" Error al actualizar")}},nt=async et=>{if(confirm(`Eliminar al cliente "${et.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{_(!0);const Rt=Ot(At(je,"sales_clothes"),$t("customerId","==",et.id)),kt=await Ct(Rt);for(const Vt of kt.docs){const ie=Vt.id;try{await BE(ie)}catch(ne){console.warn("restoreSaleAndDeleteClothes error",ne);try{await dn(Tt(je,"sales_clothes",ie))}catch{}}await nP(ie)}const jt=Ot(At(je,"ar_movements"),$t("customerId","==",et.id)),Zt=await Ct(jt);await Promise.all(Zt.docs.map(Vt=>dn(Tt(je,"ar_movements",Vt.id)))),await dn(Tt(je,"customers_clothes",et.id)),L(Vt=>Vt.filter(ie=>ie.id!==et.id)),M(" Cliente eliminado y prendas devueltas al inventario")}catch(Rt){console.error(Rt),M(" No se pudo eliminar el cliente.")}finally{_(!1)}},Nt=async et=>{R(et),z([]),re({saldoActual:0,totalAbonado:0,totalCargos:0}),U(!0),q(!1),de(0),He(new Date().toISOString().slice(0,10)),Je(""),st(null),se(!0);try{const gt=Ot(At(je,"ar_movements"),$t("customerId","==",et.id)),Rt=await Ct(gt),kt=[];Rt.forEach(jt=>{var Vt,ie;const Zt=jt.data();kt.push({id:jt.id,date:Zt.date??((ie=(Vt=Zt.createdAt)==null?void 0:Vt.toDate)!=null&&ie.call(Vt)?Zt.createdAt.toDate().toISOString().slice(0,10):""),type:Zt.type??"CARGO",amount:Number(Zt.amount||0),ref:Zt.ref||{},comment:Zt.comment||"",createdAt:Zt.createdAt})}),kt.sort((jt,Zt)=>{var ne,ue;if(jt.date!==Zt.date)return jt.date.localeCompare(Zt.date);const Vt=((ne=jt.createdAt)==null?void 0:ne.seconds)||0,ie=((ue=Zt.createdAt)==null?void 0:ue.seconds)||0;return Vt-ie}),z(kt),ot(kt)}catch(gt){console.error(gt),M(" No se pudo cargar el estado de cuenta")}finally{se(!1)}},ot=et=>{const gt=et.reduce((jt,Zt)=>jt+(Number(Zt.amount)||0),0),Rt=et.filter(jt=>Number(jt.amount)<0).reduce((jt,Zt)=>jt+Math.abs(Number(Zt.amount)||0),0),kt=et.filter(jt=>Number(jt.amount)>0).reduce((jt,Zt)=>jt+Number(Zt.amount)||0,0);re({saldoActual:gt,totalAbonado:Rt,totalCargos:kt})},wt=async()=>{if(!G)return;M("");const et=Number(oe||0);if(!(et>0)){M("Ingresa un monto de abono mayor a 0.");return}const gt=parseFloat(et.toFixed(2));if(!Be){M("Selecciona la fecha del abono.");return}try{at(!0);const Rt={customerId:G.id,type:"ABONO",amount:-gt,date:Be,comment:$e||"",createdAt:Gt.now()},jt={id:(await Jr(At(je,"ar_movements"),Rt)).id,date:Be,type:"ABONO",amount:-gt,comment:$e||"",createdAt:Gt.now()},Zt=[...ye,jt].sort((Vt,ie)=>{var xe,Fe;if(Vt.date!==ie.date)return Vt.date.localeCompare(ie.date);const ne=((xe=Vt.createdAt)==null?void 0:xe.seconds)||0,ue=((Fe=ie.createdAt)==null?void 0:Fe.seconds)||0;return ne-ue});z(Zt),ot(Zt),L(Vt=>Vt.map(ie=>ie.id===G.id?{...ie,balance:(ie.balance||0)-gt}:ie)),R(Vt=>Vt&&{...Vt,balance:(Vt.balance||0)-gt}),de(0),Je(""),He(new Date().toISOString().slice(0,10)),q(!1),M(" Abono registrado")}catch(Rt){console.error(Rt),M(" Error al registrar el abono")}finally{at(!1)}},Lt=et=>{st(et.id),ut(et.date||new Date().toISOString().slice(0,10)),ge(Math.abs(Number(et.amount||0))),_e(et.comment||"")},cr=()=>{st(null),ut(""),ge(0),_e("")},ar=async()=>{if(!mt)return;const et=ye.findIndex(jt=>jt.id===mt);if(et===-1)return;const gt=ye[et],Rt=Number(be||0);if(!(Rt>0)){M("El monto debe ser mayor a 0.");return}const kt=gt.type==="ABONO"?-parseFloat(Rt.toFixed(2)):+parseFloat(Rt.toFixed(2));try{await Tr(Tt(je,"ar_movements",mt),{date:Le,amount:kt,comment:K||""});const jt=[...ye];jt[et]={...gt,date:Le,amount:kt,comment:K||""},jt.sort((Vt,ie)=>{var xe,Fe;if(Vt.date!==ie.date)return Vt.date.localeCompare(ie.date);const ne=((xe=Vt.createdAt)==null?void 0:xe.seconds)||0,ue=((Fe=ie.createdAt)==null?void 0:Fe.seconds)||0;return ne-ue}),z(jt),ot(jt);const Zt=jt.reduce((Vt,ie)=>Vt+(Number(ie.amount)||0),0);L(Vt=>Vt.map(ie=>ie.id===(G==null?void 0:G.id)?{...ie,balance:Zt}:ie)),R(Vt=>Vt&&{...Vt,balance:Zt}),cr(),M(" Movimiento actualizado")}catch(jt){console.error(jt),M(" Error al actualizar movimiento")}},yr=async et=>{var Rt,kt;if(confirm(`Eliminar este movimiento (${et.type==="ABONO"?"Abono":"Compra"}) del ${et.date}?${et.type==="CARGO"&&((Rt=et.ref)!=null&&Rt.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(_(!0),et.type==="CARGO"&&((kt=et.ref)!=null&&kt.saleId)){try{await BE(et.ref.saleId)}catch(Vt){console.warn("restoreSaleAndDeleteClothes error",Vt),_(!1),M(" No se pudo devolver inventario de la venta.");return}await nP(et.ref.saleId)}else await dn(Tt(je,"ar_movements",et.id));const jt=ye.filter(Vt=>{var ie,ne;return et.type==="CARGO"&&((ie=et.ref)!=null&&ie.saleId)?((ne=Vt.ref)==null?void 0:ne.saleId)!==et.ref.saleId:Vt.id!==et.id});z(jt),ot(jt);const Zt=jt.reduce((Vt,ie)=>Vt+(Number(ie.amount)||0),0);L(Vt=>Vt.map(ie=>ie.id===(G==null?void 0:G.id)?{...ie,balance:Zt}:ie)),R(Vt=>Vt&&{...Vt,balance:Zt}),M(" Movimiento eliminado")}catch(jt){console.error(jt),M(" Error al eliminar movimiento")}finally{_(!1)}},tr=N.useMemo(()=>[...P].sort((et,gt)=>{var Rt,kt;return et.status!==gt.status?et.status==="BLOQUEADO"?1:-1:(((Rt=gt.createdAt)==null?void 0:Rt.seconds)||0)-(((kt=et.createdAt)==null?void 0:kt.seconds)||0)}),[P]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Ve(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:E?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):tr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):tr.map(et=>{var Rt;const gt=F===et.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Rt=et.createdAt)!=null&&Rt.toDate?et.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{className:"w-full border p-1 rounded",value:O,onChange:kt=>Y(kt.target.value)}):et.name}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{className:"w-full border p-1 rounded",value:me,onChange:kt=>ae(b1(kt.target.value))}):et.phone}),i.jsx("td",{className:"p-2 border",children:gt?i.jsxs("select",{className:"w-full border p-1 rounded",value:fe,onChange:kt=>he(kt.target.value),children:[i.jsx("option",{value:"",children:""}),rP.map(kt=>i.jsx("option",{value:kt,children:kt},kt))]}):et.place||""}),i.jsx("td",{className:"p-2 border",children:gt?i.jsxs("select",{className:"w-full border p-1 rounded",value:Ie,onChange:kt=>S(kt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${et.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:et.status})}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(I)?"":I,onChange:kt=>V(Math.max(0,Number(kt.target.value||0)))}):Xc(et.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Xc(et.balance||0)}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:te,onChange:kt=>pe(kt.target.value),maxLength:500}):i.jsx("span",{title:et.notes||"",children:(et.notes||"").length>40?(et.notes||"").slice(0,40)+"":et.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:gt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:We,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ee,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ue(et),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>nt(et),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Nt(et),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},et.id)})})]})}),B&&i.jsx("p",{className:"mt-2 text-sm",children:B}),Oe&&Ku.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ve(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ve(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Qe,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:A,onChange:et=>u(et.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:et=>f(b1(et.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:et=>m(et.target.value),children:[i.jsx("option",{value:"",children:""}),rP.map(et=>i.jsx("option",{value:et,children:et},et))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:g,onChange:et=>w(et.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:et=>k(Math.max(0,Number(et.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:et=>x(et.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ve(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(G==null?void 0:G.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{de(0),He(new Date().toISOString().slice(0,10)),Je(""),q(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>U(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Xc(Me.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Xc(Me.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Xc(Me.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:X?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):ye.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):ye.map(et=>{var Rt,kt;const gt=mt===et.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Le,onChange:jt=>ut(jt.target.value)}):et.date||""}),i.jsx("td",{className:"p-2 border",children:et.amount>=0?(Rt=et.ref)!=null&&Rt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(et.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(kt=et.ref)!=null&&kt.saleId?`Venta #${et.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:gt?i.jsx("input",{className:"w-full border p-1 rounded",value:K,onChange:jt=>_e(jt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:et.comment||"",children:(et.comment||"").length>40?(et.comment||"").slice(0,40)+"":et.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:gt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(be)?"":be,onChange:jt=>{const Zt=Number(jt.target.value||0),Vt=Number.isFinite(Zt)?Math.max(0,parseFloat(Zt.toFixed(2))):0;ge(Vt)},placeholder:"0.00",title:et.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Xc(et.amount)}),i.jsx("td",{className:"p-2 border",children:gt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ar,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:cr,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Lt(et),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>yr(et),children:"Borrar"})]})})]},et.id)})})]})})]})}),W&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(G==null?void 0:G.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Be,onChange:et=>He(et.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:oe===0?"":oe,onChange:et=>{const gt=Number(et.target.value||0),Rt=Number.isFinite(gt)?Math.max(0,parseFloat(gt.toFixed(2))):0;de(Rt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:$e,onChange:et=>Je(et.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[$e.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>q(!1),disabled:ct,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:wt,disabled:ct,children:ct?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((et,gt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:et.productName}),i.jsx("td",{className:"p-2 border text-right",children:et.qty}),i.jsx("td",{className:"p-2 border text-right",children:Xc(et.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Xc(et.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Xc(et.total)})]},gt))})]})})]})})]})}const jf=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Ile=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function Fle(t){if(!t)return 0;const e=Ot(At(je,"inventory_clothes_batches"),$t("productId","==",t)),r=await Ct(e);let n="0000-00-00",s=-1,a=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),A=Number(l.salePrice||0),u=l.createdAt,d=((u==null?void 0:u.seconds)??0)*1e3+((u==null?void 0:u.nanoseconds)??0)/1e6;c>n?(n=c,s=d,a=A):c===n&&d>s&&(s=d,a=A)}),Number(a||0)}async function sP(t){if(!t)return 0;const e=Ot(At(je,"inventory_clothes_batches"),$t("productId","==",t)),r=await Ct(e);let n=0;return r.forEach(s=>n+=Number(s.data().remaining||0)),n}function aP(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function kle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState({}),[o,l]=N.useState("CONTADO"),[c,A]=N.useState(""),[u,d]=N.useState(""),[f,h]=N.useState(new Date().toISOString().slice(0,10)),[m,p]=N.useState(""),[x,g]=N.useState([]),w=N.useMemo(()=>x.reduce((re,W)=>re+(W.qty||0),0),[x]),b=N.useMemo(()=>{const re=x.reduce((W,q)=>{const oe=Math.max(0,(Number(q.unitPrice)||0)*(q.qty||0)-(Number(q.discount)||0));return W+oe},0);return Math.floor(re*100)/100},[x]),[k,P]=N.useState(0),[L,E]=N.useState(""),[_,B]=N.useState(!1),[M,F]=N.useState(!1),[T,O]=N.useState(""),[Y,me]=N.useState("+505 "),[ae,fe]=N.useState(""),[he,te]=N.useState(""),[pe,Ie]=N.useState("ACTIVO"),[S,I]=N.useState(0),V=()=>{O(""),me("+505 "),fe(""),te(""),Ie("ACTIVO"),I(0)};N.useEffect(()=>{(async()=>{const re=Ot(At(je,"customers_clothes"),Dr("createdAt","desc")),W=await Ct(re),q=[];W.forEach(ct=>{const at=ct.data();q.push({id:ct.id,name:at.name??"",phone:at.phone??"+505 ",place:at.place??"",status:at.status??"ACTIVO",creditLimit:Number(at.creditLimit??0),balance:0})});for(const ct of q)try{const at=Ot(At(je,"ar_movements"),$t("customerId","==",ct.id)),mt=await Ct(at);let st=0;mt.forEach(Le=>st+=Number(Le.data().amount||0)),ct.balance=st}catch{ct.balance=0}e(q);const oe=Ot(At(je,"products_clothes"),Dr("createdAt","desc")),de=await Ct(oe),Be=[];de.forEach(ct=>{const at=ct.data();Be.push({id:ct.id,name:at.name??"(sin nombre)",sku:at.sku??""})}),n(Be);const He=Ot(At(je,"inventory_clothes_batches"),$t("remaining",">",0)),$e=await Ct(He),Je={};$e.forEach(ct=>{const at=ct.data(),mt=at.productId||"",st=Number(at.remaining||0);mt&&(Je[mt]=(Je[mt]||0)+st)}),a(Je)})()},[]);const j=N.useMemo(()=>t.find(re=>re.id===c),[t,c]),U=(j==null?void 0:j.balance)||0,G=o==="CREDITO"?U+Math.max(0,Number(b||0))-Math.max(0,Number(k||0)):0,R=async re=>{if(!re)return;if(x.some(Be=>Be.productId===re)){p("");return}const W=r.find(Be=>Be.id===re);if(!W){p("");return}let q=await Fle(re);q||(q=Number((W==null?void 0:W.price)||0));const oe=await sP(re),de={productId:re,productName:W.name||"",sku:W.sku||"",unitPrice:Number(q)||0,available:Number(oe)||0,qty:0,discount:0};g(Be=>[...Be,de]),p("")},X=(re,W)=>{g(q=>q.map(oe=>{if(oe.productId!==re)return oe;if(W==="")return{...oe,qty:0};const de=Math.max(0,Math.floor(Number(W)));return{...oe,qty:de}}))},se=(re,W)=>{g(q=>q.map(oe=>{if(oe.productId!==re)return oe;if(W==="")return{...oe,discount:0};const de=Math.max(0,Math.floor(Number(W)));return{...oe,discount:de}}))},ye=re=>g(W=>W.filter(q=>q.productId!==re)),z=async()=>{if(!f)return"Selecciona la fecha.";if(x.length===0)return"Agrega al menos un producto.";const re=x.filter(W=>(W.qty||0)>0);if(re.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(b>0))return"El total debe ser mayor a cero.";if(o==="CONTADO"){if(!u.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!c)return"Selecciona un cliente (crdito).";if(k<0)return"El pago inicial no puede ser negativo.";if(k>b)return"El pago inicial no puede superar el total.";if((j==null?void 0:j.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const W of re){const q=await sP(W.productId);if(W.qty>q)return`Inventario insuficiente para "${W.productName}". Disponible: ${q} unidades.`;const oe=(Number(W.unitPrice)||0)*(W.qty||0),de=Number(W.discount)||0;if(!Number.isInteger(de)||de<0)return`El descuento en "${W.productName}" debe ser entero y  0.`;if(de>oe)return`El descuento en "${W.productName}" no puede exceder C$ ${oe.toFixed(2)}.`}return null},Me=async re=>{re.preventDefault(),E("");const W=await z();if(W){E(" "+W);return}try{B(!0);const q=x.filter(He=>(He.qty||0)>0).map(He=>{const $e=(Number(He.unitPrice)||0)*(He.qty||0),Je=Math.max(0,Math.floor(Number(He.discount)||0)),ct=Math.max(0,$e-Je);return{productId:He.productId,productName:He.productName,sku:He.sku||"",qty:He.qty,unitPrice:Number(He.unitPrice)||0,discount:Je,total:Math.floor(ct*100)/100}}),oe={type:o,date:f,createdAt:Gt.now(),itemsTotal:Number(b)||0,total:Number(b)||0,quantity:Number(w)||0,items:q};o==="CONTADO"?oe.customerName=u.trim():(oe.customerId=c,oe.downPayment=Number(k)||0);const de=await Jr(At(je,"sales_clothes"),oe);if(o==="CREDITO"&&c){const He={customerId:c,date:f,createdAt:Gt.now(),ref:{saleId:de.id}};await Jr(At(je,"ar_movements"),{...He,type:"CARGO",amount:Number(b)||0}),Number(k)>0&&await Jr(At(je,"ar_movements"),{...He,type:"ABONO",amount:-Number(k)})}const Be={};for(const He of q)if(He.qty>0){const{allocations:$e}=await Ble({productId:He.productId,quantity:He.qty,saleDate:f,saleId:de.id});Be[He.productId]={productId:He.productId,allocations:$e}}await Tr(Tt(je,"sales_clothes",de.id),{allocationsByItem:Be}),l("CONTADO"),A(""),d(""),h(new Date().toISOString().slice(0,10)),g([]),P(0),o==="CREDITO"&&c&&e(He=>He.map($e=>$e.id===c?{...$e,balance:($e.balance||0)+(Number(b)||0)-(Number(k)||0)}:$e)),E(" Venta registrada"),(async()=>{const He=Ot(At(je,"inventory_clothes_batches"),$t("remaining",">",0)),$e=await Ct(He),Je={};$e.forEach(ct=>{const at=ct.data(),mt=at.productId||"",st=Number(at.remaining||0);mt&&(Je[mt]=(Je[mt]||0)+st)}),a(Je)})()}catch(q){console.error(q),E(" Error al guardar la venta")}finally{B(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:Me,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:re=>l(re.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),o==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:u,onChange:re=>d(re.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:c,onChange:re=>A(re.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),t.map(re=>i.jsxs("option",{value:re.status==="ACTIVO"?re.id:"",disabled:re.status==="BLOQUEADO",children:[re.name," | ",re.phone," | Saldo: ",jf(re.balance||0)]},re.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>F(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:jf(U)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:k===0?"":k,onChange:re=>P(Math.max(0,Number(re.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:jf(G)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:f,onChange:re=>h(re.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:async re=>{const W=re.target.value;p(W),await R(W)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),r.map(re=>{const W=x.some(de=>de.productId===re.id),q=s[re.id]||0,oe=W||q<=0;return i.jsxs("option",{value:oe?"":re.id,disabled:oe,children:[re.name," ",re.sku?` ${re.sku}`:""," ",q>0?`(disp: ${q})`:"(sin stock)",W?" (seleccionado)":""]},re.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),x.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):x.map(re=>{const W=Math.max(0,(re.available||0)-(re.qty||0)),q=(Number(re.unitPrice)||0)*(re.qty||0),oe=Math.max(0,q-(Number(re.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[re.productName,re.sku?`  ${re.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:jf(re.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:W}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(re.qty)||re.qty===0?"":re.qty,onChange:de=>X(re.productId,de.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(re.discount)||re.discount===0?"":re.discount,onChange:de=>se(re.productId,de.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:jf(oe)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>ye(re.productId),title:"Quitar producto",children:""})})]},re.productId)})]}),x.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:w})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:jf(b)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:_,children:_?"Guardando...":"Registrar venta"})})]}),L&&i.jsx("p",{className:"mt-2 text-sm",children:L}),M&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:T,onChange:re=>O(re.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:Y,onChange:re=>me(aP(re.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:re=>fe(re.target.value),children:[i.jsx("option",{value:"",children:""}),Ile.map(re=>i.jsx("option",{value:re,children:re},re))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:pe,onChange:re=>Ie(re.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:S===0?"":S,onChange:re=>I(Math.max(0,Number(re.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:he,onChange:re=>te(re.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{V(),F(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(E(""),!T.trim()){E("Ingresa el nombre del nuevo cliente.");return}const re=aP(Y);try{const W=await Jr(At(je,"customers_clothes"),{name:T.trim(),phone:re,place:ae||"",notes:he||"",status:pe,creditLimit:Number(S||0),createdAt:Gt.now()}),q={id:W.id,name:T.trim(),phone:re,place:ae||"",status:pe,creditLimit:Number(S||0),balance:0};e(oe=>[q,...oe]),A(W.id),V(),F(!1),E(" Cliente creado")}catch(W){console.error(W),E(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),_&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const oa=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function xy(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?sr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function Tle(t,e){const r=xy(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},s=Number(t.quantity??n.qty??0),a=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??a??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:s,unitPrice:Number(n.unitPrice??(a&&s?a/s:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function jle(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,A)=>c.date.localeCompare(A.date));const a=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of a)for(const c of l.items||[]){const A=s[c.productId];if(!A)continue;let u=Number(c.qty||0);if(!(u<=0))for(const d of A.lots){if(u<=0)break;if(d.qtyLeft<=0)continue;const f=Math.min(d.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=f*d.cost),d.qtyLeft-=f,u-=f}}return o}function Ple(){const{refreshKey:t,refresh:e}=Xl(),[r,n]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[s,a]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,A]=N.useState([]),[u,d]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState([]),[w,b]=N.useState(!0),[k,P]=N.useState(""),[L,E]=N.useState(!1),[_,B]=N.useState(null),[M,F]=N.useState([]),[T,O]=N.useState(!1),[Y,me]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});N.useEffect(()=>{(async()=>{b(!0),P("");try{const S=await Ct(At(je,"sales_clothes")),I=[],V=[];S.forEach(re=>{const W=re.data(),q=Tle(W,re.id);q&&(q.date<=s&&I.push(q),q.date>=r&&q.date<=s&&V.push(q))}),A(I),l(V);const j=await Ct(At(je,"inventory_clothes_batches")),U=[];j.forEach(re=>{const W=re.data(),q=xy(W);!q||q>s||U.push({id:re.id,productId:W.productId,productName:W.productName||"",date:q,quantity:Number(W.quantity||0),remaining:Number(W.remaining||0),purchasePrice:Number(W.purchasePrice||0)})}),d(U);const G=await Ct(At(je,"expenses_clothes")),R=[];G.forEach(re=>{const W=re.data(),q=xy(W);q&&q>=r&&q<=s&&R.push({id:re.id,date:q,category:W.category||"",description:W.description||"",amount:Number(W.amount||0),status:W.status||""})}),h(R);const X=await Ct(At(je,"ar_movements")),se=[],ye={};X.forEach(re=>{const W=re.data(),q=xy(W);if(!q)return;const oe=W.customerId,de=Number(W.amount||0);oe&&(ye[oe]=(ye[oe]||0)+de),W.type==="ABONO"&&q>=r&&q<=s&&se.push({id:re.id,customerId:oe,type:"ABONO",amount:de,date:q})}),p(se);const z=await Ct(At(je,"customers_clothes")),Me=[];z.forEach(re=>{const W=re.data();Me.push({id:re.id,name:W.name||"",balance:ye[re.id]||0})}),g(Me)}catch(S){console.error(S),P(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,s,t]);const ae=N.useMemo(()=>{try{return jle(u,c,r,s)}catch(S){return console.error(S),0}},[u,c,r,s]),fe=N.useMemo(()=>{const S=o.reduce((ye,z)=>ye+(z.total||0),0),I=f.reduce((ye,z)=>ye+(z.amount||0),0),V=S-ae,j=V-I,U=m.reduce((ye,z)=>ye+Math.abs(z.amount||0),0),G=x.filter(ye=>(ye.balance||0)>0),R=G.reduce((ye,z)=>ye+(z.balance||0),0);let X=0,se=0;for(const ye of o){const z=(ye.items||[]).reduce((Me,re)=>Me+(Number(re.qty)||0),0);ye.type==="CONTADO"?X+=z:se+=z}return{ventasTotales:S,costoMercaderia:ae,gastosPeriodo:I,gananciaAntes:V,gananciaDespues:j,abonosRecibidos:U,saldosPendientes:R,clientesConSaldo:G.length,prendasCash:X,prendasCredito:se}},[o,f,m,x,ae]),he=N.useMemo(()=>{const S={};for(const I of o){if(I.type!=="CREDITO"||!I.customerId)continue;const V=(I.items||[]).reduce((j,U)=>j+(Number(U.qty)||0),0);S[I.customerId]=(S[I.customerId]||0)+V}return x.filter(I=>(I.balance||0)>0).map(I=>({customerId:I.id,name:I.name,prendasCredito:S[I.id]||0,saldo:I.balance||0})).sort((I,V)=>V.saldo-I.saldo)},[x,o]),te=N.useMemo(()=>{const S={};return x.forEach(I=>S[I.id]=I.name),S},[x]),pe=N.useMemo(()=>[...o].sort((S,I)=>I.date.localeCompare(S.date)).map(S=>{var j;const I=(S.items||[]).reduce((U,G)=>U+(Number(G.qty)||0),0);let V="Cash";return S.type==="CREDITO"&&S.customerId?V=te[S.customerId]||"":S.type==="CONTADO"&&(V=((j=S.customerName)==null?void 0:j.trim())||"Cash"),{id:S.id,date:S.date,type:S.type==="CREDITO"?"Crdito":"Cash",customer:V,piezas:I,total:Number(S.total||0)}}),[o,te]),Ie=async S=>{E(!0),B({id:S.customerId,name:S.name}),F([]),O(!0),me({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const I=[];let V=0,j=0,U=0;for(const se of o)if(!(se.type!=="CREDITO"||se.customerId!==S.customerId))for(const ye of se.items||[]){const z=Number(ye.qty||0),Me=Number(ye.unitPrice||0),re=z*Me,W=Math.max(0,Number(ye.discount||0)),q=Math.max(0,re-W);I.push({saleId:se.id,date:se.date,productName:ye.productName,sku:ye.sku||"",qty:z,unitPrice:Me,lineTotal:re,discount:W,lineFinal:q}),V+=re,j+=W,U+=q}let G=0;for(const se of m)se.customerId===S.customerId&&(G+=Math.abs(se.amount||0));const R=x.find(se=>se.id===S.customerId),X=(R==null?void 0:R.balance)||0;F(I),me({totalBruto:V,totalDescuento:j,totalFiado:U,saldoActual:X,abonadoPeriodo:G})}catch(I){console.error(I),P(" No se pudo cargar el detalle del cliente.")}finally{O(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(kc,{onClick:e,loading:w})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:S=>n(S.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:S=>a(S.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(fe.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(fe.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:oa(fe.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(fe.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:oa(fe.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(fe.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(fe.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):he.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):he.map(S=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ie({customerId:S.customerId,name:S.name}),title:"Ver piezas fiadas del periodo",children:S.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:oa(S.saldo)})]},S.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):pe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):pe.map(S=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.date}),i.jsx("td",{className:"p-2 border",children:S.customer}),i.jsx("td",{className:"p-2 border",children:S.type}),i.jsx("td",{className:"p-2 border",children:S.piezas}),i.jsx("td",{className:"p-2 border",children:oa(S.total)})]},S.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((S,I)=>S.date.localeCompare(I.date)).map(S=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.date}),i.jsx("td",{className:"p-2 border",children:S.category||""}),i.jsx("td",{className:"p-2 border",children:S.description?i.jsx("span",{title:S.description,children:S.description.length>40?S.description.slice(0,40)+"":S.description}):""}),i.jsx("td",{className:"p-2 border",children:oa(S.amount)}),i.jsx("td",{className:"p-2 border",children:S.status||""})]},S.id))})]})}),k&&i.jsx("p",{className:"mt-2 text-sm",children:k}),L&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(_==null?void 0:_.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>E(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(Y.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(Y.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(Y.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(Y.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:oa(Y.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):M.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):M.sort((S,I)=>S.date.localeCompare(I.date)).map((S,I)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:S.date}),i.jsx("td",{className:"p-2 border",children:S.productName}),i.jsx("td",{className:"p-2 border",children:S.sku||""}),i.jsx("td",{className:"p-2 border",children:S.qty}),i.jsx("td",{className:"p-2 border",children:oa(S.unitPrice)}),i.jsx("td",{className:"p-2 border",children:oa(S.lineTotal)}),i.jsx("td",{className:"p-2 border",children:oa(S.discount)}),i.jsx("td",{className:"p-2 border",children:oa(S.lineFinal)})]},`${S.saleId}-${I}`))})]})})]})})]})}const iP=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],N1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Rle(){const[t,e]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[r,n]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[s,a]=N.useState(sr(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[w,b]=N.useState(!0),[k,P]=N.useState(""),[L,E]=N.useState(null),[_,B]=N.useState(""),[M,F]=N.useState(""),[T,O]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[he,te]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const R=Ot(At(je,"expenses_clothes"),Dr("date","desc")),X=await Ct(R),se=[];X.forEach(ye=>{const z=ye.data();se.push({id:ye.id,date:z.date||sr(new Date,"yyyy-MM-dd"),category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||"PENDIENTE",notes:z.notes||"",createdAt:z.createdAt??Gt.now()})}),g(se)}catch(R){console.error(R),P(" Error al cargar gastos")}finally{b(!1)}})()},[]);const pe=N.useMemo(()=>x.filter(R=>!(t&&R.date<t||r&&R.date>r)),[x,t,r]),Ie=N.useMemo(()=>{const R=pe.reduce((ye,z)=>ye+(z.amount||0),0),X=pe.filter(ye=>ye.status==="PAGADO").reduce((ye,z)=>ye+(z.amount||0),0),se=R-X;return{total:R,pagado:X,pendiente:se}},[pe]),S=()=>{a(sr(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},I=async R=>{if(R.preventDefault(),P(""),!o){P("Selecciona una categora.");return}if(!c.trim()){P("Ingresa una descripcin.");return}if(!u||u<=0){P("Ingresa un monto vlido.");return}try{const X=await Jr(At(je,"expenses_clothes"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Gt.now()});g(se=>[{id:X.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Gt.now()},...se]),S(),P(" Gasto registrado")}catch(X){console.error(X),P(" Error al guardar gasto")}},V=R=>{E(R.id),B(R.date),F(R.category||""),O(R.description||""),me(Number(R.amount||0)),fe(R.status||"PENDIENTE"),te(R.notes||"")},j=()=>{E(null),B(""),F(""),O(""),me(0),fe("PENDIENTE"),te("")},U=async()=>{if(L){if(!M){P("Selecciona una categora.");return}if(!T.trim()){P("Ingresa una descripcin.");return}if(!Y||Y<=0){P("Ingresa un monto vlido.");return}try{await Tr(Tt(je,"expenses_clothes",L),{date:_,category:M,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:he||""}),g(R=>R.map(X=>X.id===L?{...X,date:_,category:M,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:he||""}:X)),j(),P(" Gasto actualizado")}catch(R){console.error(R),P(" Error al actualizar gasto")}}},G=async R=>{confirm(`Eliminar el gasto "${R.description}"?`)&&(await dn(Tt(je,"expenses_clothes",R.id)),g(se=>se.filter(ye=>ye.id!==R.id)),P(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:R=>e(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:R=>n(R.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",N1(Ie.total)]}),i.jsxs("div",{children:["Pagado: ",N1(Ie.pagado)]}),i.jsxs("div",{children:["Pendiente: ",N1(Ie.pendiente)]})]})]}),i.jsxs("form",{onSubmit:I,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:R=>a(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:R=>l(R.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),iP.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:R=>A(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:R=>d(Math.max(0,Number(R.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:R=>h(R.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:R=>p(R.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):pe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):pe.slice().sort((R,X)=>R.date.localeCompare(X.date)).map(R=>{const X=L===R.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:_,onChange:se=>B(se.target.value)}):R.date}),i.jsx("td",{className:"p-2 border",children:X?i.jsxs("select",{className:"w-full border p-1 rounded",value:M,onChange:se=>F(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),iP.map(se=>i.jsx("option",{value:se,children:se},se))]}):R.category||""}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>O(se.target.value)}):i.jsx("span",{title:R.description,children:R.description.length>40?R.description.slice(0,40)+"":R.description})}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Y)?"":Y,onChange:se=>me(Math.max(0,Number(se.target.value||0)))}):N1(R.amount)}),i.jsx("td",{className:"p-2 border",children:X?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>fe(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${R.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:R.status})}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:he,onChange:se=>te(se.target.value),maxLength:500}):i.jsx("span",{title:R.notes||"",children:(R.notes||"").length>40?(R.notes||"").slice(0,40)+"":R.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:X?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:U,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:j,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>V(R),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>G(R),children:"Borrar"})]})})})]},R.id)})})]})}),k&&i.jsx("p",{className:"mt-2 text-sm",children:k})]})}const El=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Dle(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?sr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function Lle(t,e){const r=Dle(t);if(!r)return null;const n=t.item||{},s=Number((n==null?void 0:n.qty)??t.quantity??0)||0,a=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(s>0?a/s:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||s||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:s,unitPrice:o,total:s*o}}}async function Ule(t,e){if(e<=0)return;const r=Ot(At(je,"inventory_clothes_batches"),$t("productId","==",t)),n=await Ct(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let a=e;for(const o of s){if(a<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,a);a-=l,await Tr(Tt(je,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}a>0&&console.warn("consumeFIFO: falt inventario",a)}async function Ole(t,e){if(e<=0)return;const r=Ot(At(je,"inventory_clothes_batches"),$t("productId","==",t)),n=await Ct(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let a=e;for(const o of s){if(a<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,a);a-=c,await Tr(Tt(je,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}a>0&&console.warn("restoreFIFO: no se devolvi todo",a)}async function n8(t){const e=Ot(At(je,"ar_movements"),$t("ref.saleId","==",t)),r=await Ct(e);await Promise.all(r.docs.map(n=>dn(Tt(je,"ar_movements",n.id))))}async function Mle(t,e,r){if(await n8(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:Gt.now(),ref:{saleId:t.id}},{addDoc:s}=await pA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>YX);return{addDoc:o}},void 0);await s(At(je,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const a=Math.max(0,Number(r??t.downPayment??0));a>0&&await s(At(je,"ar_movements"),{...n,type:"ABONO",amount:-a})}function Qle(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,a]=N.useState(null),[o,l]=N.useState([]),c=async re=>{e(!0),n(!0),a(re),l([]);try{const q=(await Ct(Ot(At(je,"sales_clothes"),$t("__name__","==",re)))).docs[0],oe=q==null?void 0:q.data(),Be=(Array.isArray(oe==null?void 0:oe.items)?oe.items:oe!=null&&oe.item?[oe.item]:[]).map(He=>({productName:String(He.productName||""),qty:Number(He.qty||0),unitPrice:Number(He.unitPrice||0),discount:Number(He.discount||0),total:Number(He.total||0)}));l(Be)}catch(W){console.error(W)}finally{n(!1)}},[A,u]=N.useState(sr(new Date,"yyyy-MM-01")),[d,f]=N.useState(sr(new Date,"yyyy-MM-dd")),[h,m]=N.useState([]),[p,x]=N.useState([]),[g,w]=N.useState(!0),[b,k]=N.useState(""),[P,L]=N.useState(""),[E,_]=N.useState(""),[B,M]=N.useState(null),[F,T]=N.useState(!1),[O,Y]=N.useState(null),[me,ae]=N.useState(0),fe=15,[he,te]=N.useState(1),pe=N.useMemo(()=>{const re={};return h.forEach(W=>re[W.id]=W.name),re},[h]);N.useEffect(()=>{(async()=>{w(!0),k("");try{const re=await Ct(At(je,"customers_clothes")),W=[];re.forEach(de=>W.push({id:de.id,name:de.data().name||""})),m(W);const q=await Ct(Ot(At(je,"sales_clothes"),Dr("createdAt","desc"))),oe=[];q.forEach(de=>{const Be=Lle(de.data(),de.id);Be&&Be.date>=A&&Be.date<=d&&oe.push(Be)}),x(oe.sort((de,Be)=>Be.date.localeCompare(de.date))),te(1)}catch(re){console.error(re),k(" Error cargando transacciones.")}finally{w(!1)}})()},[A,d]);const Ie=N.useMemo(()=>p.filter(re=>!(P&&re.customerId!==P||E&&re.type!==E)),[p,P,E]),S=N.useMemo(()=>{let re=0,W=0,q=0,oe=0;for(const de of Ie)de.type==="CONTADO"?(re+=de.item.qty,q+=de.total):(W+=de.item.qty,oe+=de.total);return{piezasCash:re,piezasCredito:W,montoCash:q,montoCredito:oe}},[Ie]),I=Math.max(1,Math.ceil(Ie.length/fe)),V=N.useMemo(()=>{const re=(he-1)*fe;return Ie.slice(re,re+fe)},[Ie,he]),j=re=>{M(null),Y(re),ae(re.item.qty||0),T(!0)},U=async re=>{if(M(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{w(!0),await BE(re.id),await n8(re.id),x(W=>W.filter(q=>q.id!==re.id)),k(" Venta eliminada")}catch(W){console.error(W),k(" No se pudo eliminar la venta.")}finally{w(!1)}},G=async()=>{if(!O)return;const re=Number(O.item.qty||0),W=Math.max(1,Math.floor(Number(me)||0));if(W===re){T(!1);return}const q=Number(O.item.unitPrice||0),oe=Number((q*W).toFixed(2));try{w(!0);const de=W-re;de>0?await Ule(O.item.productId,de):de<0&&await Ole(O.item.productId,-de);const Be=Tt(je,"sales_clothes",O.id);await Tr(Be,{quantity:W,total:oe,itemsTotal:oe,"item.qty":W,"item.total":oe,updatedAt:Gt.now()});const He=Math.min(Number(O.downPayment||0),oe);await Mle(O,oe,He),x($e=>$e.map(Je=>Je.id===O.id?{...Je,quantity:W,total:oe,item:{...Je.item,qty:W,total:oe},downPayment:He}:Je)),k(" Venta actualizada"),T(!1)}catch(de){console.error(de),k(" No se pudo actualizar la venta.")}finally{w(!1)}},R=()=>{const re=`Reporte de transacciones (Ropa)  ${A} a ${d}`,W=Be=>(Be||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),q=Ie.map(Be=>{const He=Be.customerName||(Be.customerId?pe[Be.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Be.date}</td>
          <td>${W(He)}</td>
          <td>${Be.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Be.item.qty}</td>
          <td style="text-align:right">${El(Be.total)}</td>
        </tr>`}).join(""),oe=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${W(re)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${W(re)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${S.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${S.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${El(S.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${El(S.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${q||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,de=window.open("","_blank");de&&(de.document.open(),de.document.write(oe),de.document.close())},X=()=>te(1),se=()=>te(re=>Math.max(1,re-1)),ye=()=>te(re=>Math.min(I,re+1)),z=()=>te(I),Me=()=>{const re=[];if(I<=7)for(let q=1;q<=I;q++)re.push(q);else{const q=Math.max(1,he-2),oe=Math.min(I,he+2);re.push(1),q>2&&re.push(-1);for(let de=q;de<=oe;de++)de!==1&&de!==I&&re.push(de);oe<I-1&&re.push(-2),re.push(I)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:X,disabled:he===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:se,disabled:he===1,children:" Anterior"}),re.map((q,oe)=>typeof q=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${q===he?"bg-blue-600 text-white":""}`,onClick:()=>te(q),children:q},oe):i.jsx("span",{className:"px-2",children:""},oe)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ye,disabled:he===I,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:z,disabled:he===I,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",he," de ",I,"  ",Ie.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:re=>{u(re.target.value),te(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:re=>{f(re.target.value),te(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:P,onChange:re=>{L(re.target.value),te(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(re=>i.jsx("option",{value:re.id,children:re.name},re.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:E,onChange:re=>{_(re.target.value),te(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:R,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:S.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:S.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:El(S.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:El(S.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:g?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):V.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):V.map(re=>{const W=re.customerName||(re.customerId?pe[re.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:re.date}),i.jsx("td",{className:"p-2 border",children:W}),i.jsx("td",{className:"p-2 border",children:re.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(re.id),children:re.item.qty})}),i.jsx("td",{className:"p-2 border",children:El(re.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>M(q=>q===re.id?null:re.id),title:"Acciones",children:""}),B===re.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>j(re),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>U(re),children:"Eliminar"})]})]})]},re.id)})})]}),Me()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),F&&O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[O.item.productName," ",O.item.sku?` ${O.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:me,onChange:re=>ae(Math.max(1,Math.floor(Number(re.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:El(O.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:El(Number(O.item.unitPrice)*Number(me||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{T(!1),Y(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:G,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((re,W)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:re.productName}),i.jsx("td",{className:"p-2 border text-right",children:re.qty}),i.jsx("td",{className:"p-2 border text-right",children:El(re.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:El(re.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:El(re.total)})]},W))})]})})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ew={};Ew.version="0.18.5";var s8=1252,Vle=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],nI={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},sI=function(t){Vle.indexOf(t)!=-1&&(s8=nI[0]=t)};function Hle(){sI(1252)}var Pl=function(t){sI(t)};function aI(){Pl(1200),Hle()}function oP(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Kle(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function a8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Cp=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Kle(t.slice(2)):e==254&&r==255?a8(t.slice(2)):e==65279?t.slice(1):t},C1=function(e){return String.fromCharCode(e)},lP=function(e){return String.fromCharCode(e)},Xg,Pu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yg(t){for(var e="",r=0,n=0,s=0,a=0,o=0,l=0,c=0,A=0;A<t.length;)r=t.charCodeAt(A++),a=r>>2,n=t.charCodeAt(A++),o=(r&3)<<4|n>>4,s=t.charCodeAt(A++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),e+=Pu.charAt(a)+Pu.charAt(o)+Pu.charAt(l)+Pu.charAt(c);return e}function To(t){var e="",r=0,n=0,s=0,a=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<t.length;)a=Pu.indexOf(t.charAt(A++)),o=Pu.indexOf(t.charAt(A++)),r=a<<2|o>>4,e+=String.fromCharCode(r),l=Pu.indexOf(t.charAt(A++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Pu.indexOf(t.charAt(A++)),s=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Hr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),jA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ld(t){return Hr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function cP(t){return Hr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var No=function(e){return Hr?jA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function G2(t){if(typeof ArrayBuffer>"u")return No(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function yd(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function qle(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function iI(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return iI(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ea=Hr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:jA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Gle(t){for(var e=[],r=0,n=t.length+250,s=ld(t.length+255),a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(e.push(s.slice(0,r)),r=0,s=ld(65535),n=65530)}return e.push(s.slice(0,r)),Ea(e)}var Di=/\u0000/g,_p=/[\u0001-\u0006]/g;function y0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Rl(t,e){var r=""+t;return r.length>=e?r:ks("0",e-r.length)+r}function oI(t,e){var r=""+t;return r.length>=e?r:ks(" ",e-r.length)+r}function Bw(t,e){var r=""+t;return r.length>=e?r:r+ks(" ",e-r.length)}function $le(t,e){var r=""+Math.round(t);return r.length>=e?r:ks("0",e-r.length)+r}function zle(t,e){var r=""+t;return r.length>=e?r:ks("0",e-r.length)+r}var AP=Math.pow(2,32);function Pf(t,e){if(t>AP||t<-AP)return $le(t,e);var r=Math.round(t);return zle(r,e)}function Sw(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var uP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],YN=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Wle(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Cr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},dP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Jle={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Iw(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,o=1,l=0,c=1,A=0,u=0,d=Math.floor(s);A<e&&(d=Math.floor(s),l=d*o+a,u=d*A+c,!(s-d<5e-8));)s=1/(s-d),a=o,o=l,c=A,A=u;if(u>e&&(A>e?(u=c,l=a):(u=A,l=o)),!r)return[0,n*l,u];var f=Math.floor(n*l/u);return[f,n*l-f*u,u]}function ah(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,o=[],l={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=rce(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var i8=new Date(1899,11,31,0,0,0),Xle=i8.getTime(),Yle=new Date(1900,2,1,0,0,0);function o8(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Yle&&(r+=24*60*60*1e3),(r-(Xle+(t.getTimezoneOffset()-i8.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function lI(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Zle(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ece(t){var e=t<0?12:11,r=lI(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function tce(t){var e=lI(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Zg(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ece(t):e===10?r=t.toFixed(10).substr(0,12):r=tce(t),lI(Zle(r.toUpperCase()))}function Rh(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Zg(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return pl(14,o8(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function rce(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function nce(t,e,r,n){var s="",a=0,o=0,l=r.y,c,A=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,A=2;break;default:c=l%1e4,A=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,A=e.length;break;case 3:return YN[r.m-1][1];case 5:return YN[r.m-1][0];default:return YN[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,A=e.length;break;case 3:return uP[r.q][0];default:return uP[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,A=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,A=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,A=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Rl(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(s=Rl(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}A=e.length===3?1:2;break;case 101:c=l,A=1;break}var u=A>0?Rl(c,A):"";return u}function Ru(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var l8=/%/g;function sce(t,e,r){var n=e.replace(l8,""),s=e.length-n.length;return gA(t,n,r*Math.pow(10,2*s))+ks("%",s)}function ace(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return gA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function c8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+c8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var A8=/# (\?+)( ?)\/( ?)(\d+)/;function ice(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),o=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?ks(" ",t[1].length+1+t[4].length):oI(o,t[1].length)+t[2]+"/"+t[3]+Rl(l,t[4].length))}function oce(t,e,r){return r+(e===0?"":""+e)+ks(" ",t[1].length+2+t[4].length)}var u8=/^#*0*\.([0#]+)/,d8=/\).*[0#]/,h8=/\(###\) ###\\?-####/;function ki(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function hP(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function fP(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function lce(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function cce(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Xo(t,e,r){if(t.charCodeAt(0)===40&&!e.match(d8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xo("n",n,r):"("+Xo("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ace(t,e,r);if(e.indexOf("%")!==-1)return sce(t,e,r);if(e.indexOf("E")!==-1)return c8(e,r);if(e.charCodeAt(0)===36)return"$"+Xo(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(e.match(/^00+$/))return A+Pf(c,e.length);if(e.match(/^[#?]+$/))return s=Pf(r,0),s==="0"&&(s=""),s.length>e.length?s:ki(e.substr(0,e.length-s.length))+s;if(a=e.match(A8))return ice(a,c,A);if(e.match(/^#+0+$/))return A+Pf(c,e.length-e.indexOf("0"));if(a=e.match(u8))return s=hP(r,a[1].length).replace(/^([^\.]+)$/,"$1."+ki(a[1])).replace(/\.$/,"."+ki(a[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+ks("0",ki(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return A+hP(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return A+Ru(Pf(c,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xo(t,e,-r):Ru(""+(Math.floor(r)+lce(r,a[1].length)))+"."+Rl(fP(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Xo(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=y0(Xo(t,e.replace(/[\\-]/g,""),r)),o=0,y0(y0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(h8))return s=Xo(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Iw(c,Math.pow(10,o)-1,!1),s=""+A,u=gA("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Bw(l[2],o),u.length<a[4].length&&(u=ki(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Iw(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?oI(l[1],o)+a[2]+"/"+a[3]+Bw(l[2],o):ks(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=Pf(r,0),e.length<=s.length?s:ki(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=e.indexOf(".")-o,f=e.length-s.length-d;return ki(e.substr(0,d)+s+e.substr(e.length-f))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=fP(r,a[1].length),r<0?"-"+Xo(t,e,-r):Ru(cce(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Rl(0,3-m.length):"")+m})+"."+Rl(o,a[1].length);switch(e){case"###,##0.00":return Xo(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Ru(Pf(c,0));return h!=="0"?A+h:"";case"###,###.00":return Xo(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Xo(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Ace(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return gA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uce(t,e,r){var n=e.replace(l8,""),s=e.length-n.length;return gA(t,n,r*Math.pow(10,2*s))+ks("%",s)}function f8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+f8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function uc(t,e,r){if(t.charCodeAt(0)===40&&!e.match(d8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?uc("n",n,r):"("+uc("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Ace(t,e,r);if(e.indexOf("%")!==-1)return uce(t,e,r);if(e.indexOf("E")!==-1)return f8(e,r);if(e.charCodeAt(0)===36)return"$"+uc(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(e.match(/^00+$/))return A+Rl(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:ki(e.substr(0,e.length-s.length))+s;if(a=e.match(A8))return oce(a,c,A);if(e.match(/^#+0+$/))return A+Rl(c,e.length-e.indexOf("0"));if(a=e.match(u8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ki(a[1])).replace(/\.$/,"."+ki(a[1])),s=s.replace(/\.(\d*)$/,function(m,p){return"."+p+ks("0",ki(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return A+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return A+Ru(""+c);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+uc(t,e,-r):Ru(""+r)+"."+ks("0",a[1].length);if(a=e.match(/^#,#*,#0/))return uc(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=y0(uc(t,e.replace(/[\\-]/g,""),r)),o=0,y0(y0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(h8))return s=uc(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Iw(c,Math.pow(10,o)-1,!1),s=""+A,u=gA("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Bw(l[2],o),u.length<a[4].length&&(u=ki(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Iw(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?oI(l[1],o)+a[2]+"/"+a[3]+Bw(l[2],o):ks(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:ki(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var d=e.indexOf(".")-o,f=e.length-s.length-d;return ki(e.substr(0,d)+s+e.substr(e.length-f))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+uc(t,e,-r):Ru(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Rl(0,3-m.length):"")+m})+"."+Rl(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=Ru(""+c);return h!=="0"?A+h:"";default:if(e.match(/\.[0#?]*$/))return uc(t,e.slice(0,e.lastIndexOf(".")),r)+ki(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function gA(t,e,r){return(r|0)===r?uc(t,e,r):Xo(t,e,r)}function dce(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var m8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cm(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Sw(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(m8))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function hce(t,e,r,n){for(var s=[],a="",o=0,l="",c="t",A,u,d,f="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!Sw(t,o))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(d=t.charCodeAt(++o))!==34&&o<t.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";s[s.length]={t:m,v:h},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(A==null&&(A=ah(e,r,t.charAt(o+1)==="2"),A==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||A==null&&(A=ah(e,r),A==null))return"";for(a=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(A==null&&(A=ah(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(A!=null&&(p.v=A.H>=12?"P":"A"),p.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(A!=null&&(p.v=A.H>=12?"PM":"AM"),p.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="/"?(A!=null&&(p.v=A.H>=12?"":""),p.t="T",o+=5,f="h"):(p.t="t",++o),A==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(a=l;t.charAt(o++)!=="]"&&o<t.length;)a+=t.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(m8)){if(A==null&&(A=ah(e,r),A==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",cm(t)||(s[s.length]={t:"t",v:a}));break;case".":if(A!=null){for(a=l;++o<t.length&&(l=t.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;t.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)a+=t.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++o;break}var x=0,g=0,w;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=f,c="h",x<1&&(x=1);break;case"s":(w=s[o].v.match(/\.0+$/))&&(g=Math.max(g,w[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[o].v.match(/[Hh]/)&&(x=1),x<2&&s[o].v.match(/[Mm]/)&&(x=2),x<3&&s[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var b="",k;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=nce(s[o].t.charCodeAt(0),s[o].v,A,g),s[o].t="t";break;case"n":case"?":for(k=o+1;s[k]!=null&&((l=s[k].t)==="?"||l==="D"||(l===" "||l==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[o].v+=s[k].v,s[k]={v:"",t:";"},++k;b+=s[o].v,o=k-1;break;case"G":s[o].t="t",s[o].v=Rh(e,r);break}var P="",L,E;if(b.length>0){b.charCodeAt(0)==40?(L=e<0&&b.charCodeAt(0)===45?-e:e,E=gA("n",b,L)):(L=e<0&&n>1?-e:e,E=gA("n",b,L),L<0&&s[0]&&s[0].t=="t"&&(E=E.substr(1),s[0].v="-"+s[0].v)),k=E.length-1;var _=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){_=o;break}var B=s.length;if(_===s.length&&E.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(k>=s[o].v.length-1?(k-=s[o].v.length,s[o].v=E.substr(k+1,s[o].v.length)):k<0?s[o].v="":(s[o].v=E.substr(0,k+1),k=-1),s[o].t="t",B=o);k>=0&&B<s.length&&(s[B].v=E.substr(0,k+1)+s[B].v)}else if(_!==s.length&&E.indexOf("E")===-1){for(k=E.indexOf(".")-1,o=_;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===_?s[o].v.indexOf(".")-1:s[o].v.length-1,P=s[o].v.substr(u+1);u>=0;--u)k>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(P=E.charAt(k--)+P);s[o].v=P,s[o].t="t",B=o}for(k>=0&&B<s.length&&(s[B].v=E.substr(0,k+1)+s[B].v),k=E.indexOf(".")+1,o=_;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==_)){for(u=s[o].v.indexOf(".")>-1&&o===_?s[o].v.indexOf(".")+1:0,P=s[o].v.substr(0,u);u<s[o].v.length;++u)k<E.length&&(P+=E.charAt(k++));s[o].v=P,s[o].t="t",B=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(L=n>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=gA(s[o].t,s[o].v,L),s[o].t="t");var M="";for(o=0;o!==s.length;++o)s[o]!=null&&(M+=s[o].v);return M}var mP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function pP(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function fce(t,e){var r=dce(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(mP),l=r[1].match(mP);return pP(e,o)?[n,r[0]]:pP(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function pl(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Cr)[t],n==null&&(n=r.table&&r.table[dP[t]]||Cr[dP[t]]),n==null&&(n=Jle[t]||"General");break}if(Sw(n,0))return Rh(e,r);e instanceof Date&&(e=o8(e,r.date1904));var s=fce(n,e);if(Sw(s[1]))return Rh(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return hce(s[1],e,r,s[0])}function xA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Cr[r]==null){e<0&&(e=r);continue}if(Cr[r]==t){e=r;break}}e<0&&(e=391)}return Cr[e]=t,e}function $2(t){for(var e=0;e!=392;++e)t[e]!==void 0&&xA(t[e],e)}function Am(){Cr=Wle()}var mce={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},p8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pce(t){var e=typeof t=="number"?Cr[t]:t;return e=e.replace(p8,"(\\d+)"),new RegExp("^"+e+"$")}function gce(t,e,r){var n=-1,s=-1,a=-1,o=-1,l=-1,c=-1;(e.match(p8)||[]).forEach(function(d,f){var h=parseInt(r[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var A=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?A:n==-1&&s==-1&&a==-1?u:A+"T"+u}var xce=function(){var t={};t.version="1.2.0";function e(){for(var E=0,_=new Array(256),B=0;B!=256;++B)E=B,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,_[B]=E;return typeof Int32Array<"u"?new Int32Array(_):_}var r=e();function n(E){var _=0,B=0,M=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)F[M]=E[M];for(M=0;M!=256;++M)for(B=E[M],_=256+M;_<4096;_+=256)B=F[_]=B>>>8^E[B&255];var T=[];for(M=1;M!=16;++M)T[M-1]=typeof Int32Array<"u"?F.subarray(M*256,M*256+256):F.slice(M*256,M*256+256);return T}var s=n(r),a=s[0],o=s[1],l=s[2],c=s[3],A=s[4],u=s[5],d=s[6],f=s[7],h=s[8],m=s[9],p=s[10],x=s[11],g=s[12],w=s[13],b=s[14];function k(E,_){for(var B=_^-1,M=0,F=E.length;M<F;)B=B>>>8^r[(B^E.charCodeAt(M++))&255];return~B}function P(E,_){for(var B=_^-1,M=E.length-15,F=0;F<M;)B=b[E[F++]^B&255]^w[E[F++]^B>>8&255]^g[E[F++]^B>>16&255]^x[E[F++]^B>>>24]^p[E[F++]]^m[E[F++]]^h[E[F++]]^f[E[F++]]^d[E[F++]]^u[E[F++]]^A[E[F++]]^c[E[F++]]^l[E[F++]]^o[E[F++]]^a[E[F++]]^r[E[F++]];for(M+=15;F<M;)B=B>>>8^r[(B^E[F++])&255];return~B}function L(E,_){for(var B=_^-1,M=0,F=E.length,T=0,O=0;M<F;)T=E.charCodeAt(M++),T<128?B=B>>>8^r[(B^T)&255]:T<2048?(B=B>>>8^r[(B^(192|T>>6&31))&255],B=B>>>8^r[(B^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,O=E.charCodeAt(M++)&1023,B=B>>>8^r[(B^(240|T>>8&7))&255],B=B>>>8^r[(B^(128|T>>2&63))&255],B=B>>>8^r[(B^(128|O>>6&15|(T&3)<<4))&255],B=B>>>8^r[(B^(128|O&63))&255]):(B=B>>>8^r[(B^(224|T>>12&15))&255],B=B>>>8^r[(B^(128|T>>6&63))&255],B=B>>>8^r[(B^(128|T&63))&255]);return~B}return t.table=r,t.bstr=k,t.buf=P,t.str=L,t}(),wr=function(){var e={};e.version="1.2.1";function r(ie,ne){for(var ue=ie.split("/"),xe=ne.split("/"),Fe=0,De=0,ee=Math.min(ue.length,xe.length);Fe<ee;++Fe){if(De=ue[Fe].length-xe[Fe].length)return De;if(ue[Fe]!=xe[Fe])return ue[Fe]<xe[Fe]?-1:1}return ue.length-xe.length}function n(ie){if(ie.charAt(ie.length-1)=="/")return ie.slice(0,-1).indexOf("/")===-1?ie:n(ie.slice(0,-1));var ne=ie.lastIndexOf("/");return ne===-1?ie:ie.slice(0,ne+1)}function s(ie){if(ie.charAt(ie.length-1)=="/")return s(ie.slice(0,-1));var ne=ie.lastIndexOf("/");return ne===-1?ie:ie.slice(ne+1)}function a(ie,ne){typeof ne=="string"&&(ne=new Date(ne));var ue=ne.getHours();ue=ue<<6|ne.getMinutes(),ue=ue<<5|ne.getSeconds()>>>1,ie.write_shift(2,ue);var xe=ne.getFullYear()-1980;xe=xe<<4|ne.getMonth()+1,xe=xe<<5|ne.getDate(),ie.write_shift(2,xe)}function o(ie){var ne=ie.read_shift(2)&65535,ue=ie.read_shift(2)&65535,xe=new Date,Fe=ue&31;ue>>>=5;var De=ue&15;ue>>>=4,xe.setMilliseconds(0),xe.setFullYear(ue+1980),xe.setMonth(De-1),xe.setDate(Fe);var ee=ne&31;ne>>>=5;var Te=ne&63;return ne>>>=6,xe.setHours(ne),xe.setMinutes(Te),xe.setSeconds(ee<<1),xe}function l(ie){qa(ie,0);for(var ne={},ue=0;ie.l<=ie.length-4;){var xe=ie.read_shift(2),Fe=ie.read_shift(2),De=ie.l+Fe,ee={};switch(xe){case 21589:ue=ie.read_shift(1),ue&1&&(ee.mtime=ie.read_shift(4)),Fe>5&&(ue&2&&(ee.atime=ie.read_shift(4)),ue&4&&(ee.ctime=ie.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}ie.l=De,ne[xe]=ee}return ne}var c;function A(){return c||(c={})}function u(ie,ne){if(ie[0]==80&&ie[1]==75)return nt(ie,ne);if((ie[0]|32)==109&&(ie[1]|32)==105)return et(ie,ne);if(ie.length<512)throw new Error("CFB file size "+ie.length+" < 512");var ue=3,xe=512,Fe=0,De=0,ee=0,Te=0,Ae=0,Pe=[],Ce=ie.slice(0,512);qa(Ce,0);var Ze=d(Ce);switch(ue=Ze[0],ue){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(Ze[1]==0)return nt(ie,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}xe!==512&&(Ce=ie.slice(0,xe),qa(Ce,28));var Xe=ie.slice(0,xe);f(Ce,ue);var Ye=Ce.read_shift(4,"i");if(ue===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);Ce.l+=4,ee=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),Te=Ce.read_shift(4,"i"),Fe=Ce.read_shift(4,"i"),Ae=Ce.read_shift(4,"i"),De=Ce.read_shift(4,"i");for(var ze=-1,rt=0;rt<109&&(ze=Ce.read_shift(4,"i"),!(ze<0));++rt)Pe[rt]=ze;var dt=h(ie,xe);x(Ae,De,dt,xe,Pe);var Mt=w(dt,ee,Pe,xe);Mt[ee].name="!Directory",Fe>0&&Te!==O&&(Mt[Te].name="!MiniFAT"),Mt[Pe[0]].name="!FAT",Mt.fat_addrs=Pe,Mt.ssz=xe;var Kt={},xr=[],Hn=[],Tn=[];b(ee,Mt,dt,xr,Fe,Kt,Hn,Te),m(Hn,Tn,xr),xr.shift();var wi={FileIndex:Hn,FullPaths:Tn};return ne&&ne.raw&&(wi.raw={header:Xe,sectors:dt}),wi}function d(ie){if(ie[ie.l]==80&&ie[ie.l+1]==75)return[0,0];ie.chk(Y,"Header Signature: "),ie.l+=16;var ne=ie.read_shift(2,"u");return[ie.read_shift(2,"u"),ne]}function f(ie,ne){var ue=9;switch(ie.l+=2,ue=ie.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}ie.chk("0600","Mini Sector Shift: "),ie.chk("000000000000","Reserved: ")}function h(ie,ne){for(var ue=Math.ceil(ie.length/ne)-1,xe=[],Fe=1;Fe<ue;++Fe)xe[Fe-1]=ie.slice(Fe*ne,(Fe+1)*ne);return xe[ue-1]=ie.slice(ue*ne),xe}function m(ie,ne,ue){for(var xe=0,Fe=0,De=0,ee=0,Te=0,Ae=ue.length,Pe=[],Ce=[];xe<Ae;++xe)Pe[xe]=Ce[xe]=xe,ne[xe]=ue[xe];for(;Te<Ce.length;++Te)xe=Ce[Te],Fe=ie[xe].L,De=ie[xe].R,ee=ie[xe].C,Pe[xe]===xe&&(Fe!==-1&&Pe[Fe]!==Fe&&(Pe[xe]=Pe[Fe]),De!==-1&&Pe[De]!==De&&(Pe[xe]=Pe[De])),ee!==-1&&(Pe[ee]=xe),Fe!==-1&&xe!=Pe[xe]&&(Pe[Fe]=Pe[xe],Ce.lastIndexOf(Fe)<Te&&Ce.push(Fe)),De!==-1&&xe!=Pe[xe]&&(Pe[De]=Pe[xe],Ce.lastIndexOf(De)<Te&&Ce.push(De));for(xe=1;xe<Ae;++xe)Pe[xe]===xe&&(De!==-1&&Pe[De]!==De?Pe[xe]=Pe[De]:Fe!==-1&&Pe[Fe]!==Fe&&(Pe[xe]=Pe[Fe]));for(xe=1;xe<Ae;++xe)if(ie[xe].type!==0){if(Te=xe,Te!=Pe[Te])do Te=Pe[Te],ne[xe]=ne[Te]+"/"+ne[xe];while(Te!==0&&Pe[Te]!==-1&&Te!=Pe[Te]);Pe[xe]=-1}for(ne[0]+="/",xe=1;xe<Ae;++xe)ie[xe].type!==2&&(ne[xe]+="/")}function p(ie,ne,ue){for(var xe=ie.start,Fe=ie.size,De=[],ee=xe;ue&&Fe>0&&ee>=0;)De.push(ne.slice(ee*T,ee*T+T)),Fe-=T,ee=Yd(ue,ee*4);return De.length===0?_t(0):Ea(De).slice(0,ie.size)}function x(ie,ne,ue,xe,Fe){var De=O;if(ie===O){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(ie!==-1){var ee=ue[ie],Te=(xe>>>2)-1;if(!ee)return;for(var Ae=0;Ae<Te&&(De=Yd(ee,Ae*4))!==O;++Ae)Fe.push(De);x(Yd(ee,xe-4),ne-1,ue,xe,Fe)}}function g(ie,ne,ue,xe,Fe){var De=[],ee=[];Fe||(Fe=[]);var Te=xe-1,Ae=0,Pe=0;for(Ae=ne;Ae>=0;){Fe[Ae]=!0,De[De.length]=Ae,ee.push(ie[Ae]);var Ce=ue[Math.floor(Ae*4/xe)];if(Pe=Ae*4&Te,xe<4+Pe)throw new Error("FAT boundary crossed: "+Ae+" 4 "+xe);if(!ie[Ce])break;Ae=Yd(ie[Ce],Pe)}return{nodes:De,data:SP([ee])}}function w(ie,ne,ue,xe){var Fe=ie.length,De=[],ee=[],Te=[],Ae=[],Pe=xe-1,Ce=0,Ze=0,Xe=0,Ye=0;for(Ce=0;Ce<Fe;++Ce)if(Te=[],Xe=Ce+ne,Xe>=Fe&&(Xe-=Fe),!ee[Xe]){Ae=[];var ze=[];for(Ze=Xe;Ze>=0;){ze[Ze]=!0,ee[Ze]=!0,Te[Te.length]=Ze,Ae.push(ie[Ze]);var rt=ue[Math.floor(Ze*4/xe)];if(Ye=Ze*4&Pe,xe<4+Ye)throw new Error("FAT boundary crossed: "+Ze+" 4 "+xe);if(!ie[rt]||(Ze=Yd(ie[rt],Ye),ze[Ze]))break}De[Xe]={nodes:Te,data:SP([Ae])}}return De}function b(ie,ne,ue,xe,Fe,De,ee,Te){for(var Ae=0,Pe=xe.length?2:0,Ce=ne[ie].data,Ze=0,Xe=0,Ye;Ze<Ce.length;Ze+=128){var ze=Ce.slice(Ze,Ze+128);qa(ze,64),Xe=ze.read_shift(2),Ye=mI(ze,0,Xe-Pe),xe.push(Ye);var rt={name:Ye,type:ze.read_shift(1),color:ze.read_shift(1),L:ze.read_shift(4,"i"),R:ze.read_shift(4,"i"),C:ze.read_shift(4,"i"),clsid:ze.read_shift(16),state:ze.read_shift(4,"i"),start:0,size:0},dt=ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2);dt!==0&&(rt.ct=k(ze,ze.l-8));var Mt=ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2)+ze.read_shift(2);Mt!==0&&(rt.mt=k(ze,ze.l-8)),rt.start=ze.read_shift(4,"i"),rt.size=ze.read_shift(4,"i"),rt.size<0&&rt.start<0&&(rt.size=rt.type=0,rt.start=O,rt.name=""),rt.type===5?(Ae=rt.start,Fe>0&&Ae!==O&&(ne[Ae].name="!StreamData")):rt.size>=4096?(rt.storage="fat",ne[rt.start]===void 0&&(ne[rt.start]=g(ue,rt.start,ne.fat_addrs,ne.ssz)),ne[rt.start].name=rt.name,rt.content=ne[rt.start].data.slice(0,rt.size)):(rt.storage="minifat",rt.size<0?rt.size=0:Ae!==O&&rt.start!==O&&ne[Ae]&&(rt.content=p(rt,ne[Ae].data,(ne[Te]||{}).data))),rt.content&&qa(rt.content,0),De[Ye]=rt,ee.push(rt)}}function k(ie,ne){return new Date((bo(ie,ne+4)/1e7*Math.pow(2,32)+bo(ie,ne)/1e7-11644473600)*1e3)}function P(ie,ne){return A(),u(c.readFileSync(ie),ne)}function L(ie,ne){var ue=ne&&ne.type;switch(ue||Hr&&Buffer.isBuffer(ie)&&(ue="buffer"),ue||"base64"){case"file":return P(ie,ne);case"base64":return u(No(To(ie)),ne);case"binary":return u(No(ie),ne)}return u(ie,ne)}function E(ie,ne){var ue=ne||{},xe=ue.root||"Root Entry";if(ie.FullPaths||(ie.FullPaths=[]),ie.FileIndex||(ie.FileIndex=[]),ie.FullPaths.length!==ie.FileIndex.length)throw new Error("inconsistent CFB structure");ie.FullPaths.length===0&&(ie.FullPaths[0]=xe+"/",ie.FileIndex[0]={name:xe,type:5}),ue.CLSID&&(ie.FileIndex[0].clsid=ue.CLSID),_(ie)}function _(ie){var ne="Sh33tJ5";if(!wr.find(ie,"/"+ne)){var ue=_t(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,ie.FileIndex.push({name:ne,type:2,content:ue,size:4,L:69,R:69,C:69}),ie.FullPaths.push(ie.FullPaths[0]+ne),B(ie)}}function B(ie,ne){E(ie);for(var ue=!1,xe=!1,Fe=ie.FullPaths.length-1;Fe>=0;--Fe){var De=ie.FileIndex[Fe];switch(De.type){case 0:xe?ue=!0:(ie.FileIndex.pop(),ie.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(De.R*De.L*De.C)&&(ue=!0),De.R>-1&&De.L>-1&&De.R==De.L&&(ue=!0);break;default:ue=!0;break}}if(!(!ue&&!ne)){var ee=new Date(1987,1,19),Te=0,Ae=Object.create?Object.create(null):{},Pe=[];for(Fe=0;Fe<ie.FullPaths.length;++Fe)Ae[ie.FullPaths[Fe]]=!0,ie.FileIndex[Fe].type!==0&&Pe.push([ie.FullPaths[Fe],ie.FileIndex[Fe]]);for(Fe=0;Fe<Pe.length;++Fe){var Ce=n(Pe[Fe][0]);xe=Ae[Ce],xe||(Pe.push([Ce,{name:s(Ce).replace("/",""),type:1,clsid:ae,ct:ee,mt:ee,content:null}]),Ae[Ce]=!0)}for(Pe.sort(function(Ye,ze){return r(Ye[0],ze[0])}),ie.FullPaths=[],ie.FileIndex=[],Fe=0;Fe<Pe.length;++Fe)ie.FullPaths[Fe]=Pe[Fe][0],ie.FileIndex[Fe]=Pe[Fe][1];for(Fe=0;Fe<Pe.length;++Fe){var Ze=ie.FileIndex[Fe],Xe=ie.FullPaths[Fe];if(Ze.name=s(Xe).replace("/",""),Ze.L=Ze.R=Ze.C=-(Ze.color=1),Ze.size=Ze.content?Ze.content.length:0,Ze.start=0,Ze.clsid=Ze.clsid||ae,Fe===0)Ze.C=Pe.length>1?1:-1,Ze.size=0,Ze.type=5;else if(Xe.slice(-1)=="/"){for(Te=Fe+1;Te<Pe.length&&n(ie.FullPaths[Te])!=Xe;++Te);for(Ze.C=Te>=Pe.length?-1:Te,Te=Fe+1;Te<Pe.length&&n(ie.FullPaths[Te])!=n(Xe);++Te);Ze.R=Te>=Pe.length?-1:Te,Ze.type=1}else n(ie.FullPaths[Fe+1]||"")==n(Xe)&&(Ze.R=Fe+1),Ze.type=2}}}function M(ie,ne){var ue=ne||{};if(ue.fileType=="mad")return gt(ie,ue);switch(B(ie),ue.fileType){case"zip":return ot(ie,ue)}var xe=function(Ye){for(var ze=0,rt=0,dt=0;dt<Ye.FileIndex.length;++dt){var Mt=Ye.FileIndex[dt];if(Mt.content){var Kt=Mt.content.length;Kt>0&&(Kt<4096?ze+=Kt+63>>6:rt+=Kt+511>>9)}}for(var xr=Ye.FullPaths.length+3>>2,Hn=ze+7>>3,Tn=ze+127>>7,wi=Hn+rt+xr+Tn,Rs=wi+127>>7,no=Rs<=109?0:Math.ceil((Rs-109)/127);wi+Rs+no+127>>7>Rs;)no=++Rs<=109?0:Math.ceil((Rs-109)/127);var Jn=[1,no,Rs,Tn,xr,rt,ze,0];return Ye.FileIndex[0].size=ze<<6,Jn[7]=(Ye.FileIndex[0].start=Jn[0]+Jn[1]+Jn[2]+Jn[3]+Jn[4]+Jn[5])+(Jn[6]+7>>3),Jn}(ie),Fe=_t(xe[7]<<9),De=0,ee=0;{for(De=0;De<8;++De)Fe.write_shift(1,me[De]);for(De=0;De<8;++De)Fe.write_shift(2,0);for(Fe.write_shift(2,62),Fe.write_shift(2,3),Fe.write_shift(2,65534),Fe.write_shift(2,9),Fe.write_shift(2,6),De=0;De<3;++De)Fe.write_shift(2,0);for(Fe.write_shift(4,0),Fe.write_shift(4,xe[2]),Fe.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),Fe.write_shift(4,0),Fe.write_shift(4,4096),Fe.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:O),Fe.write_shift(4,xe[3]),Fe.write_shift(-4,xe[1]?xe[0]-1:O),Fe.write_shift(4,xe[1]),De=0;De<109;++De)Fe.write_shift(-4,De<xe[2]?xe[1]+De:-1)}if(xe[1])for(ee=0;ee<xe[1];++ee){for(;De<236+ee*127;++De)Fe.write_shift(-4,De<xe[2]?xe[1]+De:-1);Fe.write_shift(-4,ee===xe[1]-1?O:ee+1)}var Te=function(Ye){for(ee+=Ye;De<ee-1;++De)Fe.write_shift(-4,De+1);Ye&&(++De,Fe.write_shift(-4,O))};for(ee=De=0,ee+=xe[1];De<ee;++De)Fe.write_shift(-4,fe.DIFSECT);for(ee+=xe[2];De<ee;++De)Fe.write_shift(-4,fe.FATSECT);Te(xe[3]),Te(xe[4]);for(var Ae=0,Pe=0,Ce=ie.FileIndex[0];Ae<ie.FileIndex.length;++Ae)Ce=ie.FileIndex[Ae],Ce.content&&(Pe=Ce.content.length,!(Pe<4096)&&(Ce.start=ee,Te(Pe+511>>9)));for(Te(xe[6]+7>>3);Fe.l&511;)Fe.write_shift(-4,fe.ENDOFCHAIN);for(ee=De=0,Ae=0;Ae<ie.FileIndex.length;++Ae)Ce=ie.FileIndex[Ae],Ce.content&&(Pe=Ce.content.length,!(!Pe||Pe>=4096)&&(Ce.start=ee,Te(Pe+63>>6)));for(;Fe.l&511;)Fe.write_shift(-4,fe.ENDOFCHAIN);for(De=0;De<xe[4]<<2;++De){var Ze=ie.FullPaths[De];if(!Ze||Ze.length===0){for(Ae=0;Ae<17;++Ae)Fe.write_shift(4,0);for(Ae=0;Ae<3;++Ae)Fe.write_shift(4,-1);for(Ae=0;Ae<12;++Ae)Fe.write_shift(4,0);continue}Ce=ie.FileIndex[De],De===0&&(Ce.start=Ce.size?Ce.start-1:O);var Xe=De===0&&ue.root||Ce.name;if(Pe=2*(Xe.length+1),Fe.write_shift(64,Xe,"utf16le"),Fe.write_shift(2,Pe),Fe.write_shift(1,Ce.type),Fe.write_shift(1,Ce.color),Fe.write_shift(-4,Ce.L),Fe.write_shift(-4,Ce.R),Fe.write_shift(-4,Ce.C),Ce.clsid)Fe.write_shift(16,Ce.clsid,"hex");else for(Ae=0;Ae<4;++Ae)Fe.write_shift(4,0);Fe.write_shift(4,Ce.state||0),Fe.write_shift(4,0),Fe.write_shift(4,0),Fe.write_shift(4,0),Fe.write_shift(4,0),Fe.write_shift(4,Ce.start),Fe.write_shift(4,Ce.size),Fe.write_shift(4,0)}for(De=1;De<ie.FileIndex.length;++De)if(Ce=ie.FileIndex[De],Ce.size>=4096)if(Fe.l=Ce.start+1<<9,Hr&&Buffer.isBuffer(Ce.content))Ce.content.copy(Fe,Fe.l,0,Ce.size),Fe.l+=Ce.size+511&-512;else{for(Ae=0;Ae<Ce.size;++Ae)Fe.write_shift(1,Ce.content[Ae]);for(;Ae&511;++Ae)Fe.write_shift(1,0)}for(De=1;De<ie.FileIndex.length;++De)if(Ce=ie.FileIndex[De],Ce.size>0&&Ce.size<4096)if(Hr&&Buffer.isBuffer(Ce.content))Ce.content.copy(Fe,Fe.l,0,Ce.size),Fe.l+=Ce.size+63&-64;else{for(Ae=0;Ae<Ce.size;++Ae)Fe.write_shift(1,Ce.content[Ae]);for(;Ae&63;++Ae)Fe.write_shift(1,0)}if(Hr)Fe.l=Fe.length;else for(;Fe.l<Fe.length;)Fe.write_shift(1,0);return Fe}function F(ie,ne){var ue=ie.FullPaths.map(function(Ae){return Ae.toUpperCase()}),xe=ue.map(function(Ae){var Pe=Ae.split("/");return Pe[Pe.length-(Ae.slice(-1)=="/"?2:1)]}),Fe=!1;ne.charCodeAt(0)===47?(Fe=!0,ne=ue[0].slice(0,-1)+ne):Fe=ne.indexOf("/")!==-1;var De=ne.toUpperCase(),ee=Fe===!0?ue.indexOf(De):xe.indexOf(De);if(ee!==-1)return ie.FileIndex[ee];var Te=!De.match(_p);for(De=De.replace(Di,""),Te&&(De=De.replace(_p,"!")),ee=0;ee<ue.length;++ee)if((Te?ue[ee].replace(_p,"!"):ue[ee]).replace(Di,"")==De||(Te?xe[ee].replace(_p,"!"):xe[ee]).replace(Di,"")==De)return ie.FileIndex[ee];return null}var T=64,O=-2,Y="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(ie,ne,ue){A();var xe=M(ie,ue);c.writeFileSync(ne,xe)}function te(ie){for(var ne=new Array(ie.length),ue=0;ue<ie.length;++ue)ne[ue]=String.fromCharCode(ie[ue]);return ne.join("")}function pe(ie,ne){var ue=M(ie,ne);switch(ne&&ne.type||"buffer"){case"file":return A(),c.writeFileSync(ne.filename,ue),ue;case"binary":return typeof ue=="string"?ue:te(ue);case"base64":return Yg(typeof ue=="string"?ue:te(ue));case"buffer":if(Hr)return Buffer.isBuffer(ue)?ue:jA(ue);case"array":return typeof ue=="string"?No(ue):ue}return ue}var Ie;function S(ie){try{var ne=ie.InflateRaw,ue=new ne;if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),ue.bytesRead)Ie=ie;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function I(ie,ne){if(!Ie)return Ee(ie,ne);var ue=Ie.InflateRaw,xe=new ue,Fe=xe._processChunk(ie.slice(ie.l),xe._finishFlushFlag);return ie.l+=xe.bytesRead,Fe}function V(ie){return Ie?Ie.deflateRawSync(ie):ge(ie)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function R(ie){var ne=(ie<<1|ie<<11)&139536|(ie<<5|ie<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var X=typeof Uint8Array<"u",se=X?new Uint8Array(256):[],ye=0;ye<256;++ye)se[ye]=R(ye);function z(ie,ne){var ue=se[ie&255];return ne<=8?ue>>>8-ne:(ue=ue<<8|se[ie>>8&255],ne<=16?ue>>>16-ne:(ue=ue<<8|se[ie>>16&255],ue>>>24-ne))}function Me(ie,ne){var ue=ne&7,xe=ne>>>3;return(ie[xe]|(ue<=6?0:ie[xe+1]<<8))>>>ue&3}function re(ie,ne){var ue=ne&7,xe=ne>>>3;return(ie[xe]|(ue<=5?0:ie[xe+1]<<8))>>>ue&7}function W(ie,ne){var ue=ne&7,xe=ne>>>3;return(ie[xe]|(ue<=4?0:ie[xe+1]<<8))>>>ue&15}function q(ie,ne){var ue=ne&7,xe=ne>>>3;return(ie[xe]|(ue<=3?0:ie[xe+1]<<8))>>>ue&31}function oe(ie,ne){var ue=ne&7,xe=ne>>>3;return(ie[xe]|(ue<=1?0:ie[xe+1]<<8))>>>ue&127}function de(ie,ne,ue){var xe=ne&7,Fe=ne>>>3,De=(1<<ue)-1,ee=ie[Fe]>>>xe;return ue<8-xe||(ee|=ie[Fe+1]<<8-xe,ue<16-xe)||(ee|=ie[Fe+2]<<16-xe,ue<24-xe)||(ee|=ie[Fe+3]<<24-xe),ee&De}function Be(ie,ne,ue){var xe=ne&7,Fe=ne>>>3;return xe<=5?ie[Fe]|=(ue&7)<<xe:(ie[Fe]|=ue<<xe&255,ie[Fe+1]=(ue&7)>>8-xe),ne+3}function He(ie,ne,ue){var xe=ne&7,Fe=ne>>>3;return ue=(ue&1)<<xe,ie[Fe]|=ue,ne+1}function $e(ie,ne,ue){var xe=ne&7,Fe=ne>>>3;return ue<<=xe,ie[Fe]|=ue&255,ue>>>=8,ie[Fe+1]=ue,ne+8}function Je(ie,ne,ue){var xe=ne&7,Fe=ne>>>3;return ue<<=xe,ie[Fe]|=ue&255,ue>>>=8,ie[Fe+1]=ue&255,ie[Fe+2]=ue>>>8,ne+16}function ct(ie,ne){var ue=ie.length,xe=2*ue>ne?2*ue:ne+5,Fe=0;if(ue>=ne)return ie;if(Hr){var De=cP(xe);if(ie.copy)ie.copy(De);else for(;Fe<ie.length;++Fe)De[Fe]=ie[Fe];return De}else if(X){var ee=new Uint8Array(xe);if(ee.set)ee.set(ie);else for(;Fe<ue;++Fe)ee[Fe]=ie[Fe];return ee}return ie.length=xe,ie}function at(ie){for(var ne=new Array(ie),ue=0;ue<ie;++ue)ne[ue]=0;return ne}function mt(ie,ne,ue){var xe=1,Fe=0,De=0,ee=0,Te=0,Ae=ie.length,Pe=X?new Uint16Array(32):at(32);for(De=0;De<32;++De)Pe[De]=0;for(De=Ae;De<ue;++De)ie[De]=0;Ae=ie.length;var Ce=X?new Uint16Array(Ae):at(Ae);for(De=0;De<Ae;++De)Pe[Fe=ie[De]]++,xe<Fe&&(xe=Fe),Ce[De]=0;for(Pe[0]=0,De=1;De<=xe;++De)Pe[De+16]=Te=Te+Pe[De-1]<<1;for(De=0;De<Ae;++De)Te=ie[De],Te!=0&&(Ce[De]=Pe[Te+16]++);var Ze=0;for(De=0;De<Ae;++De)if(Ze=ie[De],Ze!=0)for(Te=z(Ce[De],xe)>>xe-Ze,ee=(1<<xe+4-Ze)-1;ee>=0;--ee)ne[Te|ee<<Ze]=Ze&15|De<<4;return xe}var st=X?new Uint16Array(512):at(512),Le=X?new Uint16Array(32):at(32);if(!X){for(var ut=0;ut<512;++ut)st[ut]=0;for(ut=0;ut<32;++ut)Le[ut]=0}(function(){for(var ie=[],ne=0;ne<32;ne++)ie.push(5);mt(ie,Le,32);var ue=[];for(ne=0;ne<=143;ne++)ue.push(8);for(;ne<=255;ne++)ue.push(9);for(;ne<=279;ne++)ue.push(7);for(;ne<=287;ne++)ue.push(8);mt(ue,st,288)})();var be=function(){for(var ne=X?new Uint8Array(32768):[],ue=0,xe=0;ue<G.length-1;++ue)for(;xe<G[ue+1];++xe)ne[xe]=ue;for(;xe<32768;++xe)ne[xe]=29;var Fe=X?new Uint8Array(259):[];for(ue=0,xe=0;ue<U.length-1;++ue)for(;xe<U[ue+1];++xe)Fe[xe]=ue;function De(Te,Ae){for(var Pe=0;Pe<Te.length;){var Ce=Math.min(65535,Te.length-Pe),Ze=Pe+Ce==Te.length;for(Ae.write_shift(1,+Ze),Ae.write_shift(2,Ce),Ae.write_shift(2,~Ce&65535);Ce-- >0;)Ae[Ae.l++]=Te[Pe++]}return Ae.l}function ee(Te,Ae){for(var Pe=0,Ce=0,Ze=X?new Uint16Array(32768):[];Ce<Te.length;){var Xe=Math.min(65535,Te.length-Ce);if(Xe<10){for(Pe=Be(Ae,Pe,+(Ce+Xe==Te.length)),Pe&7&&(Pe+=8-(Pe&7)),Ae.l=Pe/8|0,Ae.write_shift(2,Xe),Ae.write_shift(2,~Xe&65535);Xe-- >0;)Ae[Ae.l++]=Te[Ce++];Pe=Ae.l*8;continue}Pe=Be(Ae,Pe,+(Ce+Xe==Te.length)+2);for(var Ye=0;Xe-- >0;){var ze=Te[Ce];Ye=(Ye<<5^ze)&32767;var rt=-1,dt=0;if((rt=Ze[Ye])&&(rt|=Ce&-32768,rt>Ce&&(rt-=32768),rt<Ce))for(;Te[rt+dt]==Te[Ce+dt]&&dt<250;)++dt;if(dt>2){ze=Fe[dt],ze<=22?Pe=$e(Ae,Pe,se[ze+1]>>1)-1:($e(Ae,Pe,3),Pe+=5,$e(Ae,Pe,se[ze-23]>>5),Pe+=3);var Mt=ze<8?0:ze-4>>2;Mt>0&&(Je(Ae,Pe,dt-U[ze]),Pe+=Mt),ze=ne[Ce-rt],Pe=$e(Ae,Pe,se[ze]>>3),Pe-=3;var Kt=ze<4?0:ze-2>>1;Kt>0&&(Je(Ae,Pe,Ce-rt-G[ze]),Pe+=Kt);for(var xr=0;xr<dt;++xr)Ze[Ye]=Ce&32767,Ye=(Ye<<5^Te[Ce])&32767,++Ce;Xe-=dt-1}else ze<=143?ze=ze+48:Pe=He(Ae,Pe,1),Pe=$e(Ae,Pe,se[ze]),Ze[Ye]=Ce&32767,++Ce}Pe=$e(Ae,Pe,0)-1}return Ae.l=(Pe+7)/8|0,Ae.l}return function(Ae,Pe){return Ae.length<8?De(Ae,Pe):ee(Ae,Pe)}}();function ge(ie){var ne=_t(50+Math.floor(ie.length*1.1)),ue=be(ie,ne);return ne.slice(0,ue)}var K=X?new Uint16Array(32768):at(32768),_e=X?new Uint16Array(32768):at(32768),Oe=X?new Uint16Array(128):at(128),Ve=1,ve=1;function Qe(ie,ne){var ue=q(ie,ne)+257;ne+=5;var xe=q(ie,ne)+1;ne+=5;var Fe=W(ie,ne)+4;ne+=4;for(var De=0,ee=X?new Uint8Array(19):at(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ae=1,Pe=X?new Uint8Array(8):at(8),Ce=X?new Uint8Array(8):at(8),Ze=ee.length,Xe=0;Xe<Fe;++Xe)ee[j[Xe]]=De=re(ie,ne),Ae<De&&(Ae=De),Pe[De]++,ne+=3;var Ye=0;for(Pe[0]=0,Xe=1;Xe<=Ae;++Xe)Ce[Xe]=Ye=Ye+Pe[Xe-1]<<1;for(Xe=0;Xe<Ze;++Xe)(Ye=ee[Xe])!=0&&(Te[Xe]=Ce[Ye]++);var ze=0;for(Xe=0;Xe<Ze;++Xe)if(ze=ee[Xe],ze!=0){Ye=se[Te[Xe]]>>8-ze;for(var rt=(1<<7-ze)-1;rt>=0;--rt)Oe[Ye|rt<<ze]=ze&7|Xe<<3}var dt=[];for(Ae=1;dt.length<ue+xe;)switch(Ye=Oe[oe(ie,ne)],ne+=Ye&7,Ye>>>=3){case 16:for(De=3+Me(ie,ne),ne+=2,Ye=dt[dt.length-1];De-- >0;)dt.push(Ye);break;case 17:for(De=3+re(ie,ne),ne+=3;De-- >0;)dt.push(0);break;case 18:for(De=11+oe(ie,ne),ne+=7;De-- >0;)dt.push(0);break;default:dt.push(Ye),Ae<Ye&&(Ae=Ye);break}var Mt=dt.slice(0,ue),Kt=dt.slice(ue);for(Xe=ue;Xe<286;++Xe)Mt[Xe]=0;for(Xe=xe;Xe<30;++Xe)Kt[Xe]=0;return Ve=mt(Mt,K,286),ve=mt(Kt,_e,30),ne}function Ue(ie,ne){if(ie[0]==3&&!(ie[1]&3))return[ld(ne),2];for(var ue=0,xe=0,Fe=cP(ne||1<<18),De=0,ee=Fe.length>>>0,Te=0,Ae=0;!(xe&1);){if(xe=re(ie,ue),ue+=3,xe>>>1)xe>>1==1?(Te=9,Ae=5):(ue=Qe(ie,ue),Te=Ve,Ae=ve);else{ue&7&&(ue+=8-(ue&7));var Pe=ie[ue>>>3]|ie[(ue>>>3)+1]<<8;if(ue+=32,Pe>0)for(!ne&&ee<De+Pe&&(Fe=ct(Fe,De+Pe),ee=Fe.length);Pe-- >0;)Fe[De++]=ie[ue>>>3],ue+=8;continue}for(;;){!ne&&ee<De+32767&&(Fe=ct(Fe,De+32767),ee=Fe.length);var Ce=de(ie,ue,Te),Ze=xe>>>1==1?st[Ce]:K[Ce];if(ue+=Ze&15,Ze>>>=4,!(Ze>>>8&255))Fe[De++]=Ze;else{if(Ze==256)break;Ze-=257;var Xe=Ze<8?0:Ze-4>>2;Xe>5&&(Xe=0);var Ye=De+U[Ze];Xe>0&&(Ye+=de(ie,ue,Xe),ue+=Xe),Ce=de(ie,ue,Ae),Ze=xe>>>1==1?Le[Ce]:_e[Ce],ue+=Ze&15,Ze>>>=4;var ze=Ze<4?0:Ze-2>>1,rt=G[Ze];for(ze>0&&(rt+=de(ie,ue,ze),ue+=ze),!ne&&ee<Ye&&(Fe=ct(Fe,Ye+100),ee=Fe.length);De<Ye;)Fe[De]=Fe[De-rt],++De}}}return ne?[Fe,ue+7>>>3]:[Fe.slice(0,De),ue+7>>>3]}function Ee(ie,ne){var ue=ie.slice(ie.l||0),xe=Ue(ue,ne);return ie.l+=xe[1],xe[0]}function We(ie,ne){if(ie)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function nt(ie,ne){var ue=ie;qa(ue,0);var xe=[],Fe=[],De={FileIndex:xe,FullPaths:Fe};E(De,{root:ne.root});for(var ee=ue.length-4;(ue[ee]!=80||ue[ee+1]!=75||ue[ee+2]!=5||ue[ee+3]!=6)&&ee>=0;)--ee;ue.l=ee+4,ue.l+=4;var Te=ue.read_shift(2);ue.l+=6;var Ae=ue.read_shift(4);for(ue.l=Ae,ee=0;ee<Te;++ee){ue.l+=20;var Pe=ue.read_shift(4),Ce=ue.read_shift(4),Ze=ue.read_shift(2),Xe=ue.read_shift(2),Ye=ue.read_shift(2);ue.l+=8;var ze=ue.read_shift(4),rt=l(ue.slice(ue.l+Ze,ue.l+Ze+Xe));ue.l+=Ze+Xe+Ye;var dt=ue.l;ue.l=ze+4,Nt(ue,Pe,Ce,De,rt),ue.l=dt}return De}function Nt(ie,ne,ue,xe,Fe){ie.l+=2;var De=ie.read_shift(2),ee=ie.read_shift(2),Te=o(ie);if(De&8257)throw new Error("Unsupported ZIP encryption");for(var Ae=ie.read_shift(4),Pe=ie.read_shift(4),Ce=ie.read_shift(4),Ze=ie.read_shift(2),Xe=ie.read_shift(2),Ye="",ze=0;ze<Ze;++ze)Ye+=String.fromCharCode(ie[ie.l++]);if(Xe){var rt=l(ie.slice(ie.l,ie.l+Xe));(rt[21589]||{}).mt&&(Te=rt[21589].mt),((Fe||{})[21589]||{}).mt&&(Te=Fe[21589].mt)}ie.l+=Xe;var dt=ie.slice(ie.l,ie.l+Pe);switch(ee){case 8:dt=I(ie,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var Mt=!1;De&8&&(Ae=ie.read_shift(4),Ae==134695760&&(Ae=ie.read_shift(4),Mt=!0),Pe=ie.read_shift(4),Ce=ie.read_shift(4)),Pe!=ne&&We(Mt,"Bad compressed size: "+ne+" != "+Pe),Ce!=ue&&We(Mt,"Bad uncompressed size: "+ue+" != "+Ce),kt(xe,Ye,dt,{unsafe:!0,mt:Te})}function ot(ie,ne){var ue=ne||{},xe=[],Fe=[],De=_t(1),ee=ue.compression?8:0,Te=0,Ae=0,Pe=0,Ce=0,Ze=0,Xe=ie.FullPaths[0],Ye=Xe,ze=ie.FileIndex[0],rt=[],dt=0;for(Ae=1;Ae<ie.FullPaths.length;++Ae)if(Ye=ie.FullPaths[Ae].slice(Xe.length),ze=ie.FileIndex[Ae],!(!ze.size||!ze.content||Ye=="Sh33tJ5")){var Mt=Ce,Kt=_t(Ye.length);for(Pe=0;Pe<Ye.length;++Pe)Kt.write_shift(1,Ye.charCodeAt(Pe)&127);Kt=Kt.slice(0,Kt.l),rt[Ze]=xce.buf(ze.content,0);var xr=ze.content;ee==8&&(xr=V(xr)),De=_t(30),De.write_shift(4,67324752),De.write_shift(2,20),De.write_shift(2,Te),De.write_shift(2,ee),ze.mt?a(De,ze.mt):De.write_shift(4,0),De.write_shift(-4,rt[Ze]),De.write_shift(4,xr.length),De.write_shift(4,ze.content.length),De.write_shift(2,Kt.length),De.write_shift(2,0),Ce+=De.length,xe.push(De),Ce+=Kt.length,xe.push(Kt),Ce+=xr.length,xe.push(xr),De=_t(46),De.write_shift(4,33639248),De.write_shift(2,0),De.write_shift(2,20),De.write_shift(2,Te),De.write_shift(2,ee),De.write_shift(4,0),De.write_shift(-4,rt[Ze]),De.write_shift(4,xr.length),De.write_shift(4,ze.content.length),De.write_shift(2,Kt.length),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(4,0),De.write_shift(4,Mt),dt+=De.l,Fe.push(De),dt+=Kt.length,Fe.push(Kt),++Ze}return De=_t(22),De.write_shift(4,101010256),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,Ze),De.write_shift(2,Ze),De.write_shift(4,dt),De.write_shift(4,Ce),De.write_shift(2,0),Ea([Ea(xe),Ea(Fe),De])}var wt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lt(ie,ne){if(ie.ctype)return ie.ctype;var ue=ie.name||"",xe=ue.match(/\.([^\.]+)$/);return xe&&wt[xe[1]]||ne&&(xe=(ue=ne).match(/[\.\\]([^\.\\])+$/),xe&&wt[xe[1]])?wt[xe[1]]:"application/octet-stream"}function cr(ie){for(var ne=Yg(ie),ue=[],xe=0;xe<ne.length;xe+=76)ue.push(ne.slice(xe,xe+76));return ue.join(`\r
`)+`\r
`}function ar(ie){var ne=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Pe){var Ce=Pe.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ue=[],xe=ne.split(`\r
`),Fe=0;Fe<xe.length;++Fe){var De=xe[Fe];if(De.length==0){ue.push("");continue}for(var ee=0;ee<De.length;){var Te=76,Ae=De.slice(ee,ee+Te);Ae.charAt(Te-1)=="="?Te--:Ae.charAt(Te-2)=="="?Te-=2:Ae.charAt(Te-3)=="="&&(Te-=3),Ae=De.slice(ee,ee+Te),ee+=Te,ee<De.length&&(Ae+="="),ue.push(Ae)}}return ue.join(`\r
`)}function yr(ie){for(var ne=[],ue=0;ue<ie.length;++ue){for(var xe=ie[ue];ue<=ie.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+ie[++ue];ne.push(xe)}for(var Fe=0;Fe<ne.length;++Fe)ne[Fe]=ne[Fe].replace(/[=][0-9A-Fa-f]{2}/g,function(De){return String.fromCharCode(parseInt(De.slice(1),16))});return No(ne.join(`\r
`))}function tr(ie,ne,ue){for(var xe="",Fe="",De="",ee,Te=0;Te<10;++Te){var Ae=ne[Te];if(!Ae||Ae.match(/^\s*$/))break;var Pe=Ae.match(/^(.*?):\s*([^\s].*)$/);if(Pe)switch(Pe[1].toLowerCase()){case"content-location":xe=Pe[2].trim();break;case"content-type":De=Pe[2].trim();break;case"content-transfer-encoding":Fe=Pe[2].trim();break}}switch(++Te,Fe.toLowerCase()){case"base64":ee=No(To(ne.slice(Te).join("")));break;case"quoted-printable":ee=yr(ne.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Fe)}var Ce=kt(ie,xe.slice(ue.length),ee,{unsafe:!0});De&&(Ce.ctype=De)}function et(ie,ne){if(te(ie.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ue=ne&&ne.root||"",xe=(Hr&&Buffer.isBuffer(ie)?ie.toString("binary"):te(ie)).split(`\r
`),Fe=0,De="";for(Fe=0;Fe<xe.length;++Fe)if(De=xe[Fe],!!/^Content-Location:/i.test(De)&&(De=De.slice(De.indexOf("file")),ue||(ue=De.slice(0,De.lastIndexOf("/")+1)),De.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=ue.slice(0,ue.length-1),ue=ue.slice(0,ue.lastIndexOf("/")+1),De.slice(0,ue.length)!=ue););var ee=(xe[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var Te="--"+(ee[1]||""),Ae=[],Pe=[],Ce={FileIndex:Ae,FullPaths:Pe};E(Ce);var Ze,Xe=0;for(Fe=0;Fe<xe.length;++Fe){var Ye=xe[Fe];Ye!==Te&&Ye!==Te+"--"||(Xe++&&tr(Ce,xe.slice(Ze,Fe),ue),Ze=Fe)}return Ce}function gt(ie,ne){var ue=ne||{},xe=ue.boundary||"SheetJS";xe="------="+xe;for(var Fe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],De=ie.FullPaths[0],ee=De,Te=ie.FileIndex[0],Ae=1;Ae<ie.FullPaths.length;++Ae)if(ee=ie.FullPaths[Ae].slice(De.length),Te=ie.FileIndex[Ae],!(!Te.size||!Te.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var Pe=Te.content,Ce=Hr&&Buffer.isBuffer(Pe)?Pe.toString("binary"):te(Pe),Ze=0,Xe=Math.min(1024,Ce.length),Ye=0,ze=0;ze<=Xe;++ze)(Ye=Ce.charCodeAt(ze))>=32&&Ye<128&&++Ze;var rt=Ze>=Xe*4/5;Fe.push(xe),Fe.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+ee),Fe.push("Content-Transfer-Encoding: "+(rt?"quoted-printable":"base64")),Fe.push("Content-Type: "+Lt(Te,ee)),Fe.push(""),Fe.push(rt?ar(Ce):cr(Ce))}return Fe.push(xe+`--\r
`),Fe.join(`\r
`)}function Rt(ie){var ne={};return E(ne,ie),ne}function kt(ie,ne,ue,xe){var Fe=xe&&xe.unsafe;Fe||E(ie);var De=!Fe&&wr.find(ie,ne);if(!De){var ee=ie.FullPaths[0];ne.slice(0,ee.length)==ee?ee=ne:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+ne).replace("//","/")),De={name:s(ne),type:2},ie.FileIndex.push(De),ie.FullPaths.push(ee),Fe||wr.utils.cfb_gc(ie)}return De.content=ue,De.size=ue?ue.length:0,xe&&(xe.CLSID&&(De.clsid=xe.CLSID),xe.mt&&(De.mt=xe.mt),xe.ct&&(De.ct=xe.ct)),De}function jt(ie,ne){E(ie);var ue=wr.find(ie,ne);if(ue){for(var xe=0;xe<ie.FileIndex.length;++xe)if(ie.FileIndex[xe]==ue)return ie.FileIndex.splice(xe,1),ie.FullPaths.splice(xe,1),!0}return!1}function Zt(ie,ne,ue){E(ie);var xe=wr.find(ie,ne);if(xe){for(var Fe=0;Fe<ie.FileIndex.length;++Fe)if(ie.FileIndex[Fe]==xe)return ie.FileIndex[Fe].name=s(ue),ie.FullPaths[Fe]=ue,!0}return!1}function Vt(ie){B(ie,!0)}return e.find=F,e.read=L,e.parse=u,e.write=pe,e.writeFile=he,e.utils={cfb_new:Rt,cfb_add:kt,cfb_del:jt,cfb_mov:Zt,cfb_gc:Vt,ReadShift:tg,CheckField:U8,prep_blob:qa,bconcat:Ea,use_zlib:S,_deflateRaw:ge,_inflateRaw:Ee,consts:fe},e}();function vce(t){return typeof t=="string"?G2(t):Array.isArray(t)?qle(t):t}function Mx(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=G2(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?vc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([vce(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=yd(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function yce(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ps(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function gP(t,e){for(var r=[],n=Ps(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function z2(t){for(var e=[],r=Ps(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function W2(t){for(var e=[],r=Ps(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function wce(t){for(var e=[],r=Ps(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Fw=new Date(1899,11,30,0,0,0);function ga(t,e){var r=t.getTime(),n=Fw.getTime()+(t.getTimezoneOffset()-Fw.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var g8=new Date,bce=Fw.getTime()+(g8.getTimezoneOffset()-Fw.getTimezoneOffset())*6e4,xP=g8.getTimezoneOffset();function J2(t){var e=new Date;return e.setTime(t*24*60*60*1e3+bce),e.getTimezoneOffset()!==xP&&e.setTime(e.getTime()+(e.getTimezoneOffset()-xP)*6e4),e}function Nce(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var vP=new Date("2017-02-19T19:06:09.000Z"),x8=isNaN(vP.getFullYear())?new Date("2/19/17"):vP,Cce=x8.getFullYear()==2017;function ns(t,e){var r=new Date(t);if(Cce)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(x8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Dh(t,e){if(Hr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return vc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return vc(a8(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return vc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return vc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function ss(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ss(t[r]));return e}function ks(t,e){for(var r="";r.length<e;)r+=t;return r}function Ol(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var _ce=["january","february","march","april","may","june","july","august","september","october","november","december"];function H0(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&_ce.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Ece=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(s),o.push(a[l]);return o}}();function v8(t){return t?t.content&&t.type?Dh(t.content,!0):t.data?Cp(t.data):t.asNodeBuffer&&Hr?Cp(t.asNodeBuffer().toString("binary")):t.asBinary?Cp(t.asBinary()):t._data&&t._data.getContent?Cp(Dh(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function y8(t){if(!t)return null;if(t.data)return oP(t.data);if(t.asNodeBuffer&&Hr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?oP(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Bce(t){return t&&t.name.slice(-4)===".bin"?y8(t):v8(t)}function tl(t,e){for(var r=t.FullPaths||Ps(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function cI(t,e){var r=tl(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Ys(t,e,r){if(!r)return Bce(cI(t,e));if(!e)return null;try{return Ys(t,e)}catch{return null}}function Co(t,e,r){if(!r)return v8(cI(t,e));if(!e)return null;try{return Co(t,e)}catch{return null}}function Sce(t,e,r){return y8(cI(t,e))}function yP(t){for(var e=t.FullPaths||Ps(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Qr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Hr?n=jA(r):n=Gle(r),wr.utils.cfb_add(t,e,n)}wr.utils.cfb_add(t,e,r)}else t.file(e,r)}function AI(){return wr.utils.cfb_new()}function w8(t,e){switch(e.type){case"base64":return wr.read(t,{type:"base64"});case"binary":return wr.read(t,{type:"binary"});case"buffer":case"array":return wr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ep(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Ws=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Ice=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Fce=/<[^>]*>/g,yi=Ws.match(wP)?wP:Fce,kce=/<\w*:/,Tce=/<(\/?)\w+:/;function Br(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var o=t.match(Ice),l=0,c="",A=0,u="",d="",f=1;if(o)for(A=0;A!=o.length;++A){for(d=o[A],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(u=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(f=(s=d.charCodeAt(a+1))==34||s==39?1:0,c=d.slice(a+1+f,d.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[h]&&u.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Tc(t){return t.replace(Tce,"<$1")}var b8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uI=z2(b8),un=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(l,c){return b8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,o)+r(s.slice(o+3))}}(),dI=/[&<>'"]/g,jce=/[\u0000-\u0008\u000b-\u001f]/g;function Fn(t){var e=t+"";return e.replace(dI,function(r){return uI[r]}).replace(jce,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bP(t){return Fn(t).replace(/ /g,"_x0020_")}var N8=/[\u0000-\u001f]/g;function hI(t){var e=t+"";return e.replace(dI,function(r){return uI[r]}).replace(/\n/g,"<br/>").replace(N8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Pce(t){var e=t+"";return e.replace(dI,function(r){return uI[r]}).replace(N8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var NP=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Rce(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function es(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ZN(t){for(var e="",r=0,n=0,s=0,a=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function CP(t){var e=ld(2*t.length),r,n,s=1,a=0,o=0,l;for(n=0;n<t.length;n+=s)s=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function _P(t){return jA(t,"binary").toString("utf8")}var _1="foo bar baz",Rn=Hr&&(_P(_1)==ZN(_1)&&_P||CP(_1)==ZN(_1)&&CP)||ZN,vc=Hr?function(t){return jA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},ex=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),C8=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),Dce=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Lce=/<\/?(?:vt:)?variant>/g,Uce=/<(?:vt:)([^>]*)>([\s\S]*)</;function EP(t,e){var r=Br(t),n=t.match(Dce(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var o=a.replace(Lce,"").match(Uce);o&&s.push({v:Rn(o[2]),t:o[1]})}),s}var _8=/(^\s|\s$|\n)/;function $a(t,e){return"<"+t+(e.match(_8)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function tx(t){return Ps(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Jt(t,e,r){return"<"+t+(r!=null?tx(r):"")+(e!=null?(e.match(_8)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function SE(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Oce(t,e){switch(typeof t){case"string":var r=Jt("vt:lpwstr",Fn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Jt((t|0)==t?"vt:i4":"vt:r8",Fn(String(t)));case"boolean":return Jt("vt:bool",t?"true":"false")}if(t instanceof Date)return Jt("vt:filetime",SE(t));throw new Error("Unable to serialize "+t)}function fI(t){if(Hr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Rn(yd(iI(t)));throw new Error("Bad input format: expected Buffer or string")}var rx=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ha={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Zh=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],wo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mce(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Qce(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,o=n?-e:e;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var l=0;l<=5;++l,a/=256)t[r+l]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var BP=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},SP=Hr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:jA(e)})):BP(t)}:BP,IP=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(cA(t,s)));return n.join("").replace(Di,"")},mI=Hr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Di,""):IP(t,e,r)}:IP,FP=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},E8=Hr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):FP(t,e,r)}:FP,kP=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode($f(t,s)));return n.join("")},Qx=Hr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):kP(e,r,n)}:kP,B8=function(t,e){var r=bo(t,e);return r>0?Qx(t,e+4,e+4+r-1):""},S8=B8,I8=function(t,e){var r=bo(t,e);return r>0?Qx(t,e+4,e+4+r-1):""},F8=I8,k8=function(t,e){var r=2*bo(t,e);return r>0?Qx(t,e+4,e+4+r-1):""},T8=k8,j8=function(e,r){var n=bo(e,r);return n>0?mI(e,r+4,r+4+n):""},P8=j8,R8=function(t,e){var r=bo(t,e);return r>0?Qx(t,e+4,e+4+r):""},D8=R8,L8=function(t,e){return Mce(t,e)},kw=L8,pI=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Hr&&(S8=function(e,r){if(!Buffer.isBuffer(e))return B8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},F8=function(e,r){if(!Buffer.isBuffer(e))return I8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},T8=function(e,r){if(!Buffer.isBuffer(e))return k8(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},P8=function(e,r){if(!Buffer.isBuffer(e))return j8(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},D8=function(e,r){if(!Buffer.isBuffer(e))return R8(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},kw=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):L8(e,r)},pI=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var $f=function(t,e){return t[e]},cA=function(t,e){return t[e+1]*256+t[e]},Vce=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},bo=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Yd=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Hce=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function tg(t,e){var r="",n,s,a=[],o,l,c,A;switch(e){case"dbcs":if(A=this.l,Hr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(cA(this,A)),A+=2;t*=2;break;case"utf8":r=Qx(this,this.l,this.l+t);break;case"utf16le":t*=2,r=mI(this,this.l,this.l+t);break;case"wstr":return tg.call(this,t,"dbcs");case"lpstr-ansi":r=S8(this,this.l),t=4+bo(this,this.l);break;case"lpstr-cp":r=F8(this,this.l),t=4+bo(this,this.l);break;case"lpwstr":r=T8(this,this.l),t=4+2*bo(this,this.l);break;case"lpp4":t=4+bo(this,this.l),r=P8(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+bo(this,this.l),r=D8(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=$f(this,this.l+t++))!==0;)a.push(C1(o));r=a.join("");break;case"_wstr":for(t=0,r="";(o=cA(this,this.l+t))!==0;)a.push(C1(o)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",A=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=$f(this,A),this.l=A+1,l=tg.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(C1(cA(this,A))),A+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",A=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=$f(this,A),this.l=A+1,l=tg.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(C1($f(this,A))),A+=1}r=a.join("");break;default:switch(t){case 1:return n=$f(this,this.l),this.l++,n;case 2:return n=(e==="i"?Vce:cA)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Yd:Hce)(this,this.l),this.l+=4,n):(s=bo(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=kw(this,this.l):s=kw([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=E8(this,this.l,t);break}}return this.l+=t,r}var Kce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},qce=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Gce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function $ce(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)Gce(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Kce(this,e,this.l);break;case 8:if(n=8,r==="f"){Qce(this,e,this.l);break}case 16:break;case-4:n=4,qce(this,e,this.l);break}return this.l+=n,this}function U8(t,e){var r=E8(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function qa(t,e){t.l=e,t.read_shift=tg,t.chk=U8,t.write_shift=$ce}function vi(t,e){t.l+=e}function _t(t){var e=ld(t);return qa(e,0),e}function PA(t,e,r){if(t){var n,s,a;qa(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var A=lx[l]||lx[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;c=t.l+a;var u=A.f&&A.f(t,a,r);if(t.l=c,e(u,A,l))return}}}function eo(){var t=[],e=Hr?256:2048,r=function(A){var u=_t(A);return qa(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(A){return n&&A<n.length-n.l?n:(s(),n=r(Math.max(A+1,e)))},o=function(){return s(),Ea(t)},l=function(A){s(),n=A,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:l,end:o,_bufs:t}}function Dt(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=lx[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=t.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&pI(r)&&t.push(r)}}function rg(t,e,r){var n=ss(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function TP(t,e,r){var n=ss(t);return n.s=rg(n.s,e.s,r),n.e=rg(n.e,e.s,r),n}function ng(t,e){if(t.cRel&&t.c<0)for(t=ss(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ss(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=_r(t);return!t.cRel&&t.cRel!=null&&(r=Jce(r)),!t.rRel&&t.rRel!=null&&(r=zce(r)),r}function eC(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ws(t.s.c)+":"+(t.e.cRel?"":"$")+ws(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+$s(t.s.r)+":"+(t.e.rRel?"":"$")+$s(t.e.r):ng(t.s,e.biff)+":"+ng(t.e,e.biff)}function gI(t){return parseInt(Wce(t),10)-1}function $s(t){return""+(t+1)}function zce(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Wce(t){return t.replace(/\$(\d+)$/,"$1")}function xI(t){for(var e=Xce(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function ws(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Jce(t){return t.replace(/^([A-Z])/,"$$$1")}function Xce(t){return t.replace(/^\$([A-Z])/,"$1")}function Yce(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bs(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function _r(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function to(t){var e=t.indexOf(":");return e==-1?{s:bs(t),e:bs(t)}:{s:bs(t.slice(0,e)),e:bs(t.slice(e+1))}}function Lr(t,e){return typeof e>"u"||typeof e=="number"?Lr(t.s,t.e):(typeof t!="string"&&(t=_r(t)),typeof e!="string"&&(e=_r(e)),t==e?t:t+":"+e)}function hn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function jP(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=pl(t.z,r?ga(e):e)}catch{}try{return t.w=pl((t.XF||{}).numFmtId||(r?14:0),r?ga(e):e)}catch{return""+e}}function IA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?RA[t.v]||t.v:e==null?jP(t,t.v):jP(t,e))}function wd(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function O8(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?bs(n.origin):n.origin;o=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=hn(a["!ref"]);A.s.c=u.s.c,A.s.r=u.s.r,A.e.c=Math.max(A.e.c,u.e.c),A.e.r=Math.max(A.e.r,u.e.r),o==-1&&(A.e.r=o=u.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[d].length;++f)if(!(typeof e[d][f]>"u")){var h={v:e[d][f]},m=o+d,p=l+f;if(A.s.r>m&&(A.s.r=m),A.s.c>p&&(A.s.c=p),A.e.r<m&&(A.e.r=m),A.e.c<p&&(A.e.c=p),e[d][f]&&typeof e[d][f]=="object"&&!Array.isArray(e[d][f])&&!(e[d][f]instanceof Date))h=e[d][f];else if(Array.isArray(h.v)&&(h.f=e[d][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Cr[14],n.cellDates?(h.t="d",h.w=pl(h.z,ga(h.v))):(h.t="n",h.v=ga(h.v),h.w=pl(h.z,h.v))):h.t="s";if(s)a[m]||(a[m]=[]),a[m][p]&&a[m][p].z&&(h.z=a[m][p].z),a[m][p]=h;else{var x=_r({c:p,r:m});a[x]&&a[x].z&&(h.z=a[x].z),a[x]=h}}}return A.s.c<1e7&&(a["!ref"]=Lr(A)),a}function um(t,e){return O8(null,t,e)}function Zce(t){return t.read_shift(4,"i")}function Ml(t,e){return e||(e=_t(4)),e.write_shift(4,t),e}function gi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ba(t,e){var r=!1;return e==null&&(r=!0,e=_t(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function eAe(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function tAe(t,e){return e||(e=_t(4)),e.write_shift(2,0),e.write_shift(2,0),e}function vI(t,e){var r=t.l,n=t.read_shift(1),s=gi(t),a=[],o={t:s,h:s};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)a.push(eAe(t));o.r=a}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function rAe(t,e){var r=!1;return e==null&&(r=!0,e=_t(15+4*t.t.length)),e.write_shift(1,0),Ba(t.t,e),r?e.slice(0,e.l):e}var nAe=vI;function sAe(t,e){var r=!1;return e==null&&(r=!0,e=_t(23+4*t.t.length)),e.write_shift(1,1),Ba(t.t,e),e.write_shift(4,1),tAe({},e),r?e.slice(0,e.l):e}function gl(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ef(t,e){return e==null&&(e=_t(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function tf(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function rf(t,e){return e==null&&(e=_t(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var aAe=gi,M8=Ba;function yI(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Tw(t,e){var r=!1;return e==null&&(r=!0,e=_t(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var iAe=gi,IE=yI,wI=Tw;function bI(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?kw([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Yd(e,0)>>2;return r?s/100:s}function Q8(t,e){e==null&&(e=_t(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function V8(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function oAe(t,e){return e||(e=_t(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var nf=V8,dm=oAe;function pi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Lh(t,e){return(e||_t(8)).write_shift(8,t,"f")}function lAe(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var A=mh[s];A&&(e.rgb=sx(A));break;case 2:e.rgb=sx([o,l,c]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function jw(t,e){if(e||(e=_t(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function cAe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function AAe(t,e){e||(e=_t(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function H8(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function uAe(t){return H8(t,1)}function dAe(t){return H8(t,2)}var NI=2,qi=3,E1=11,PP=12,Pw=19,B1=64,hAe=65,fAe=71,mAe=4108,pAe=4126,Ca=80,K8=81,gAe=[Ca,K8],FE={1:{n:"CodePage",t:NI},2:{n:"Category",t:Ca},3:{n:"PresentationFormat",t:Ca},4:{n:"ByteCount",t:qi},5:{n:"LineCount",t:qi},6:{n:"ParagraphCount",t:qi},7:{n:"SlideCount",t:qi},8:{n:"NoteCount",t:qi},9:{n:"HiddenCount",t:qi},10:{n:"MultimediaClipCount",t:qi},11:{n:"ScaleCrop",t:E1},12:{n:"HeadingPairs",t:mAe},13:{n:"TitlesOfParts",t:pAe},14:{n:"Manager",t:Ca},15:{n:"Company",t:Ca},16:{n:"LinksUpToDate",t:E1},17:{n:"CharacterCount",t:qi},19:{n:"SharedDoc",t:E1},22:{n:"HyperlinksChanged",t:E1},23:{n:"AppVersion",t:qi,p:"version"},24:{n:"DigSig",t:hAe},26:{n:"ContentType",t:Ca},27:{n:"ContentStatus",t:Ca},28:{n:"Language",t:Ca},29:{n:"Version",t:Ca},255:{},2147483648:{n:"Locale",t:Pw},2147483651:{n:"Behavior",t:Pw},1919054434:{}},kE={1:{n:"CodePage",t:NI},2:{n:"Title",t:Ca},3:{n:"Subject",t:Ca},4:{n:"Author",t:Ca},5:{n:"Keywords",t:Ca},6:{n:"Comments",t:Ca},7:{n:"Template",t:Ca},8:{n:"LastAuthor",t:Ca},9:{n:"RevNumber",t:Ca},10:{n:"EditTime",t:B1},11:{n:"LastPrinted",t:B1},12:{n:"CreatedDate",t:B1},13:{n:"ModifiedDate",t:B1},14:{n:"PageCount",t:qi},15:{n:"WordCount",t:qi},16:{n:"CharCount",t:qi},17:{n:"Thumbnail",t:fAe},18:{n:"Application",t:Ca},19:{n:"DocSecurity",t:qi},255:{},2147483648:{n:"Locale",t:Pw},2147483651:{n:"Behavior",t:Pw},1919054434:{}},RP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xAe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vAe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var yAe=vAe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),mh=ss(yAe),RA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},q8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},TE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},S1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function CI(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function wAe(t){var e=CI();if(!t||!t.match)return e;var r={};if((t.match(yi)||[]).forEach(function(n){var s=Br(n);switch(s[0].replace(kce,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[TE[s.ContentType]]!==void 0&&e[TE[s.ContentType]].push(s.PartName);break}}),e.xmlns!==ha.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function G8(t,e){var r=wce(TE),n=[],s;n[n.length]=Ws,n[n.length]=Jt("Types",null,{xmlns:ha.CT,"xmlns:xsd":ha.xsd,"xmlns:xsi":ha.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Jt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(s=t[c][0],n[n.length]=Jt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:S1[c][e.bookType]||S1[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(A){n[n.length]=Jt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:S1[c][e.bookType]||S1[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(A){n[n.length]=Jt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:r[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $r={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function nx(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function sg(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(yi)||[]).forEach(function(s){var a=Br(s);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Ep(a.Target,e);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}function w0(t){var e=[Ws,Jt("Relationships",null,{xmlns:ha.RELS})];return Ps(t["!id"]).forEach(function(r){e[e.length]=Jt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Bn(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[$r.HLINK,$r.XPATH,$r.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var bAe="application/vnd.oasis.opendocument.spreadsheet";function NAe(t,e){for(var r=fI(t),n,s;n=rx.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Br(n[0],!1),s.path=="/"&&s.type!==bAe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function CAe(t){var e=[Ws];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function DP(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function _Ae(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function EAe(t){var e=[Ws];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(DP(t[r][0],t[r][1])),e.push(_Ae("",t[r][0]));return e.push(DP("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function $8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ew.version+"</meta:generator></office:meta></office:document-meta>"}var dl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],BAe=function(){for(var t=new Array(dl.length),e=0;e<dl.length;++e){var r=dl[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function z8(t){var e={};t=Rn(t);for(var r=0;r<dl.length;++r){var n=dl[r],s=t.match(BAe[r]);s!=null&&s.length>0&&(e[n[1]]=un(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=ns(e[n[1]]))}return e}function tC(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Fn(e),n[n.length]=r?Jt(t,e,r):$a(t,e))}function W8(t,e){var r=e||{},n=[Ws,Jt("cp:coreProperties",null,{"xmlns:cp":ha.CORE_PROPS,"xmlns:dc":ha.dc,"xmlns:dcterms":ha.dcterms,"xmlns:dcmitype":ha.dcmitype,"xmlns:xsi":ha.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&tC("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:SE(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&tC("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:SE(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=dl.length;++a){var o=dl[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&tC(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ph=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],J8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function X8(t,e,r,n){var s=[];if(typeof t=="string")s=EP(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(u){return{v:u}}));var o=typeof e=="string"?EP(e,n).map(function(u){return u.v}):e,l=0,c=0;if(o.length>0)for(var A=0;A!==s.length;A+=2){switch(c=+s[A+1].v,s[A].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function SAe(t,e,r){var n={};return e||(e={}),t=Rn(t),ph.forEach(function(s){var a=(t.match(ex(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=un(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var o=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&X8(n.HeadingPairs,n.TitlesOfParts,e,r),e}function Y8(t){var e=[],r=Jt;return t||(t={}),t.Application="SheetJS",e[e.length]=Ws,e[e.length]=Jt("Properties",null,{xmlns:ha.EXT_PROPS,"xmlns:vt":ha.vt}),ph.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Fn(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Fn(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var IAe=/<[^>]+>[^<]*/g;function FAe(t,e){var r={},n="",s=t.match(IAe);if(s)for(var a=0;a!=s.length;++a){var o=s[a],l=Br(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=un(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),A=c[0].slice(4),u=c[1];switch(A){case"lpstr":case"bstr":case"lpwstr":r[n]=un(u);break;case"bool":r[n]=es(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=ns(u);break;case"cy":case"error":r[n]=un(u);break;default:if(A.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,A,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function Z8(t){var e=[Ws,Jt("Properties",null,{xmlns:ha.CUST_PROPS,"xmlns:vt":ha.vt})];if(!t)return e.join("");var r=1;return Ps(t).forEach(function(s){++r,e[e.length]=Jt("property",Oce(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Fn(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var jE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rC;function kAe(t,e,r){rC||(rC=z2(jE)),e=rC[e]||e,t[e]=r}function TAe(t,e){var r=[];return Ps(jE).map(function(n){for(var s=0;s<dl.length;++s)if(dl[s][1]==n)return dl[s];for(s=0;s<ph.length;++s)if(ph[s][1]==n)return ph[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push($a(jE[n[1]]||n[1],s))}}),Jt("DocumentProperties",r.join(""),{xmlns:wo.o})}function jAe(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&Ps(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var o=0;o<dl.length;++o)if(a==dl[o][1])return;for(o=0;o<ph.length;++o)if(a==ph[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=t[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Jt(bP(a),l,{"dt:dt":c}))}}),e&&Ps(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Jt(bP(a),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+wo.o+'">'+s.join("")+"</"+n+">"}function _I(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function PAe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=_t(8);return o.write_shift(4,n),o.write_shift(4,s),o}function eQ(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function tQ(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function rQ(t,e,r){return e===31?tQ(t):eQ(t,e,r)}function PE(t,e,r){return rQ(t,e,r===!1?0:4)}function RAe(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return rQ(t,e,0)}function DAe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Di,""),t.l-s&2&&(t.l+=2)}return r}function LAe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Di,"");return r}function UAe(t){var e=t.l,r=Rw(t,K8);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Rw(t,qi);return[r,n]}function OAe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(UAe(t));return r}function LP(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),o=t.read_shift(4);n[a]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Di,"").replace(_p,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function nQ(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function MAe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Rw(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==PP&&n!==e&&gAe.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===PP?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return eQ(t,n,4).replace(Di,"");case 31:return tQ(t);case 64:return _I(t);case 65:return nQ(t);case 71:return MAe(t);case 80:return PE(t,n,!a.raw).replace(Di,"");case 81:return RAe(t,n).replace(Di,"");case 4108:return OAe(t);case 4126:case 4127:return n==4127?DAe(t):LAe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function UP(t,e){var r=_t(4),n=_t(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=_t(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=PAe(e);break;case 31:case 80:for(n=_t(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Ea([r,n])}function OP(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],o=0,l=0,c=-1,A={};for(o=0;o!=s;++o){var u=t.read_shift(4),d=t.read_shift(4);a[o]=[u,d+r]}a.sort(function(w,b){return w[1]-b[1]});var f={};for(o=0;o!=s;++o){if(t.l!==a[o][1]){var h=!0;if(o>0&&e)switch(e[a[o-1][0]].t){case 2:t.l+2===a[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=a[o][1]&&(t.l=a[o][1],h=!1);break;case 4108:t.l<=a[o][1]&&(t.l=a[o][1],h=!1);break}if((!e||o==0)&&t.l<=a[o][1]&&(h=!1,t.l=a[o][1]),h)throw new Error("Read Error: Expected address "+a[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[a[o][0]];if(f[m.n]=Rw(t,m.t,{raw:!0}),m.p==="version"&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(f[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Pl(l=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(a[o][0]===1){if(l=f.CodePage=Rw(t,NI),Pl(l),c!==-1){var p=t.l;t.l=a[c][1],A=LP(t,l),t.l=p}}else if(a[o][0]===0){if(l===0){c=o,t.l=a[o+1][1];continue}A=LP(t,l)}else{var x=A[a[o][0]],g;switch(t[t.l]){case 65:t.l+=4,g=nQ(t);break;case 30:t.l+=4,g=PE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,g=PE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,g=t.read_shift(4,"i");break;case 19:t.l+=4,g=t.read_shift(4);break;case 5:t.l+=4,g=t.read_shift(8,"f");break;case 11:t.l+=4,g=Qs(t,4);break;case 64:t.l+=4,g=ns(_I(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[x]=g}}return t.l=r+n,f}var sQ=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function QAe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function MP(t,e,r){var n=_t(8),s=[],a=[],o=8,l=0,c=_t(8),A=_t(8);if(c.write_shift(4,2),c.write_shift(4,1200),A.write_shift(4,1),a.push(c),s.push(A),o+=8+c.length,!e){A=_t(8),A.write_shift(4,0),s.unshift(A);var u=[_t(4)];for(u[0].write_shift(4,t.length),l=0;l<t.length;++l){var d=t[l][0];for(c=_t(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Ea(u),a.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(sQ.indexOf(t[l][0])>-1||J8.indexOf(t[l][0])>-1)&&t[l][1]!=null){var f=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}c=UP(m.t,f)}else{var x=QAe(f);x==-1&&(x=31,f=String(f)),c=UP(x,f)}a.push(c),A=_t(8),A.write_shift(4,e?h:2+l),s.push(A),o+=8+c.length}var g=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,g),g+=a[l].length;return n.write_shift(4,o),n.write_shift(4,a.length),Ea([n].concat(s).concat(a))}function QP(t,e,r){var n=t.content;if(!n)return{};qa(n,0);var s,a,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var A=n.read_shift(4),u=n.read_shift(16);if(u!==wr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var d=OP(n,e),f={SystemIdentifier:A};for(var h in d)f[h]=d[h];if(f.FMTID=a,s===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=OP(n,null)}catch{}for(h in m)f[h]=m[h];return f.FMTID=[a,o],f}function VP(t,e,r,n,s,a){var o=_t(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,wr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var c=MP(t,r,n);if(l.push(c),s){var A=MP(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),l.push(A)}return Ea(l)}function cu(t,e){return t.read_shift(e),null}function VAe(t,e){e||(e=_t(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function HAe(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Qs(t,e){return t.read_shift(e)===1}function Ti(t,e){return e||(e=_t(2)),e.write_shift(2,+!!t),e}function Zs(t){return t.read_shift(2,"u")}function rl(t,e){return e||(e=_t(2)),e.write_shift(2,t),e}function aQ(t,e){return HAe(t,e,Zs)}function KAe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function iQ(t,e,r){return r||(r=_t(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Vx(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?t.read_shift(n,s):"";return o}function qAe(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),o=0,l,c={};s&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var A=a==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,A);return s&&(t.l+=4*o),n&&(t.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function GAe(t){var e=t.t||"",r=_t(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=_t(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return Ea(s)}function Uh(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Hx(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Uh(t,n,r)}function sf(t,e,r){if(r.biff>5)return Hx(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function oQ(t,e,r){return r||(r=_t(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function $Ae(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function zAe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Di,"");return n&&(t.l+=24),s}function WAe(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(a>>1,"utf16le").replace(Di,"");return r+o}function JAe(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return zAe(t);case"0303000000000000c000000000000046":return WAe(t);default:throw new Error("Unsupported Moniker "+r)}}function I1(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Di,""):"";return r}function HP(t,e){e||(e=_t(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function XAe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,o,l,c,A="",u,d;s&16&&(a=I1(t,r-t.l)),s&128&&(o=I1(t,r-t.l)),(s&257)===257&&(l=I1(t,r-t.l)),(s&257)===1&&(c=JAe(t,r-t.l)),s&8&&(A=I1(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(d=_I(t)),t.l=r;var f=o||l||c||"";f&&A&&(f+="#"+A),f||(f="#"+A),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),d&&(h.time=d),a&&(h.Tooltip=a),h}function YAe(t){var e=_t(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(a==28)n=n.slice(1),HP(n,e);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),a&8&&HP(s>-1?n.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function lQ(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function cQ(t,e){var r=lQ(t);return r[3]=0,r}function jc(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Oh(t,e,r,n){return n||(n=_t(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function ZAe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function eue(t,e,r){return e===0?"":sf(t,e,r)}function tue(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[s,a,o]}function AQ(t){var e=t.read_shift(2),r=bI(t);return[e,r]}function rue(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Vx(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function X2(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function uQ(t,e){return e||(e=_t(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function dQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var nue=dQ;function hQ(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function sue(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function aue(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function oi(t){t.l+=2,t.l+=t.read_shift(2)}var iue={0:oi,4:oi,5:oi,6:oi,7:aue,8:oi,9:oi,10:oi,11:oi,12:oi,13:sue,14:oi,15:oi,16:oi,17:oi,18:oi,19:oi,20:oi,21:hQ};function oue(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(iue[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function F1(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function EI(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=_t(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function lue(t,e){return e===0||t.read_shift(2),1200}function cue(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=sf(t,0,r);return t.read_shift(e+n-t.l),s}function Aue(t,e){var r=!e||e.biff==8,n=_t(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function uue(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function due(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=Vx(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:a,name:o}}function hue(t,e){var r=!e||e.biff>=8?2:1,n=_t(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function fue(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],o=0;o!=s&&t.l<r;++o)a.push(qAe(t));return a.Count=n,a.Unique=s,a}function mue(t,e){var r=_t(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=GAe(t[s]);var a=Ea([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function pue(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function gue(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function xue(t){var e=ZAe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function vue(t){return t.read_shift(2),t.read_shift(4)}function KP(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function yue(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),A=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:o,FirstTab:l,Selected:c,TabRatio:A}}function wue(){var t=_t(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function bue(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function Nue(t){var e=_t(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Cue(){}function _ue(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Vx(t,0,r),n}function Eue(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=_t(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function Bue(t){var e=jc(t);return e.isst=t.read_shift(4),e}function Sue(t,e,r,n){var s=_t(10);return Oh(t,e,n,s),s.write_shift(4,r),s}function Iue(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=jc(t);r.biff==2&&t.l++;var a=Hx(t,n-t.l,r);return s.val=a,s}function Fue(t,e,r,n,s){var a=!s||s.biff==8,o=_t(8+ +a+(1+a)*r.length);return Oh(t,e,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function kue(t,e,r){var n=t.read_shift(2),s=sf(t,0,r);return[n,s]}function Tue(t,e,r,n){var s=r&&r.biff==5;n||(n=_t(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var jue=sf;function qP(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:a,c:l},e:{r:o,c}}}function Pue(t,e){var r=e.biff==8||!e.biff?4:2,n=_t(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Rue(t){var e=t.read_shift(2),r=t.read_shift(2),n=AQ(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function Due(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(AQ(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(a.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:a}}function Lue(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(a.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:a}}function Uue(t,e,r,n){var s={},a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return s.patternType=xAe[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function Oue(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=Uue(t,e,n.fStyle,r),n}function GP(t,e,r,n){var s=r&&r.biff==5;n||(n=_t(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Mue(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Que(t){var e=_t(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function $P(t,e,r){var n=jc(t);(r.biff==2||e==9)&&++t.l;var s=KAe(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Vue(t,e,r,n,s,a){var o=_t(8);return Oh(t,e,n,o),iQ(r,a,o),o}function Hue(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=jc(t),s=pi(t);return n.val=s,n}function Kue(t,e,r,n){var s=_t(14);return Oh(t,e,n,s),Lh(r,s),s}var zP=eue;function que(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Uh(t,a),l=[];n>t.l;)l.push(Hx(t));return[a,s,o,l]}function WP(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=rue(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var Gue=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function JP(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var A=Uh(t,o,r);s&32&&(A=Gue[A.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var d=n==t.l||l===0||!(u>0)?[]:ome(t,u,r,l);return{chKey:a,Name:A,itab:c,rgce:d}}function fQ(t,e,r){if(r.biff<8)return $ue(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(tue(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function $ue(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Vx(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function zue(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=Uh(t,n,r),o=Uh(t,s,r);return[a,o]}function Wue(t,e,r){var n=dQ(t);t.l++;var s=t.read_shift(1);return e-=8,[lme(t,e,r),s,n]}function XP(t,e,r){var n=nue(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,ame(t,e,r)]}function Jue(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Xue(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=sf(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},l,o,a]}}function Yue(t,e,r){return Xue(t,e,r)}function Zue(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(X2(t));return r}function ede(t){var e=_t(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)uQ(t[r],e);return e}function tde(t,e,r){if(r&&r.biff<8)return nde(t,e,r);var n=hQ(t),s=oue(t,e-22,n[1]);return{cmo:n,ft:s}}var rde={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function nde(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((rde[n]||vi)(t,e,r)),{cmo:[s,n,a],ft:o}}function sde(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:o=$Ae(t,6,r);var l=t.read_shift(2);t.read_shift(2),Zs(t,2);var c=t.read_shift(2);t.l+=c;for(var A=1;A<t.lens.length-1;++A){if(t.l-n!=t.lens[A])throw new Error("TxO: bad continue record");var u=t[t.l],d=Uh(t,t.lens[A+1]-t.lens[A]-1);if(s+=d,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function ade(t,e){var r=X2(t);t.l+=16;var n=XAe(t,e-24);return[r,n]}function ide(t){var e=_t(24),r=bs(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return Ea([e,YAe(t[1])])}function ode(t,e){t.read_shift(2);var r=X2(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Di,""),[r,n]}function lde(t){var e=t[1].Tooltip,r=_t(10+2*(e.length+1));r.write_shift(2,2048);var n=bs(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function cde(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=RP[r]||r,r=t.read_shift(2),e[1]=RP[r]||r,e}function Ade(t){return t||(t=_t(4)),t.write_shift(2,1),t.write_shift(2,1),t}function ude(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cQ(t));return r}function dde(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cQ(t));return r}function hde(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function mQ(t,e,r){if(!r.cellStyles)return vi(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var A={s,e:a,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(A.level=c>>8&7),A}function fde(t,e){var r=_t(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function mde(t,e){var r={};return e<32||(t.l+=16,r.header=pi(t),r.footer=pi(t),t.l+=2),r}function pde(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function gde(t){for(var e=_t(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var xde=jc,vde=aQ,yde=Hx;function wde(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function bde(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=jc(t);++t.l;var s=sf(t,e-7,r);return n.t="str",n.val=s,n}function Nde(t){var e=jc(t);++t.l;var r=pi(t);return e.t="n",e.val=r,e}function Cde(t,e,r){var n=_t(15);return $x(n,t,e),n.write_shift(8,r,"f"),n}function _de(t){var e=jc(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Ede(t,e,r){var n=_t(9);return $x(n,t,e),n.write_shift(2,r),n}function Bde(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Sde(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function Ide(t,e,r){var n=t.l+e,s=jc(t),a=t.read_shift(2),o=Uh(t,a,r);return t.l=n,s.t="str",s.val=o,s}var Fde=[2,3,48,49,131,139,140,245],RE=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=z2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var A=[],u=ld(1);switch(c.type){case"base64":u=No(To(l));break;case"binary":u=No(l);break;case"buffer":case"array":u=l;break}qa(u,0);var d=u.read_shift(1),f=!!(d&136),h=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,x=521;d==2&&(p=u.read_shift(2)),u.l+=3,d!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(x=u.read_shift(2));var g=u.read_shift(2),w=c.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=t[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var b=[],k={},P=Math.min(u.length,d==2?521:x-10-(h?264:0)),L=m?32:11;u.l<P&&u[u.l]!=13;)switch(k={},k.name=Xg.utils.decode(w,u.slice(u.l,u.l+L)).replace(/[\u0000\r\n].*$/g,""),u.l+=L,k.type=String.fromCharCode(u.read_shift(1)),d!=2&&!m&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),d==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&b.push(k),d!=2&&(u.l+=m?13:14),k.type){case"B":(!h||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var E=0,_=0;for(A[0]=[],_=0;_!=b.length;++_)A[0][_]=b[_].name;for(;p-- >0;){if(u[u.l]===42){u.l+=g;continue}for(++u.l,A[++E]=[],_=0,_=0;_!=b.length;++_){var B=u.slice(u.l,u.l+b[_].len);u.l+=b[_].len,qa(B,0);var M=Xg.utils.decode(w,B);switch(b[_].type){case"C":M.trim().length&&(A[E][_]=M.replace(/\s+$/,""));break;case"D":M.length===8?A[E][_]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):A[E][_]=M;break;case"F":A[E][_]=parseFloat(M.trim());break;case"+":case"I":A[E][_]=m?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":A[E][_]=!0;break;case"N":case"F":A[E][_]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));A[E][_]="##MEMO##"+(m?parseInt(M.trim(),10):B.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(A[E][_]=+M||0);break;case"@":A[E][_]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":A[E][_]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":A[E][_]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[E][_]=-B.read_shift(-8,"f");break;case"B":if(h&&b[_].len==8){A[E][_]=B.read_shift(8,"f");break}case"G":case"P":B.l+=b[_].len;break;case"0":if(b[_].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[_].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(A=A.slice(0,c.sheetRows)),c.DBF=b,A}function n(l,c){var A=c||{};A.dateNF||(A.dateNF="yyyymmdd");var u=um(r(l,A),A);return u["!cols"]=A.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete A.DBF,u}function s(l,c){try{return wd(n(l,c),c)}catch(A){if(c&&c.WTF)throw A}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var A=c||{};if(+A.codepage>=0&&Pl(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var u=eo(),d=Uw(l,{header:1,raw:!0,cellDates:!0}),f=d[0],h=d.slice(1),m=l["!cols"]||[],p=0,x=0,g=0,w=1;for(p=0;p<f.length;++p){if(((m[p]||{}).DBF||{}).name){f[p]=m[p].DBF.name,++g;continue}if(f[p]!=null){if(++g,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(x=0;x<1024;++x)if(f.indexOf(f[p]+"_"+x)==-1){f[p]+="_"+x;break}}}}var b=hn(l["!ref"]),k=[],P=[],L=[];for(p=0;p<=b.e.c-b.s.c;++p){var E="",_="",B=0,M=[];for(x=0;x<h.length;++x)h[x][p]!=null&&M.push(h[x][p]);if(M.length==0||f[p]==null){k[p]="?";continue}for(x=0;x<M.length;++x){switch(typeof M[x]){case"number":_="B";break;case"string":_="C";break;case"boolean":_="L";break;case"object":_=M[x]instanceof Date?"D":"C";break;default:_="C"}B=Math.max(B,String(M[x]).length),E=E&&E!=_?"C":_}B>250&&(B=250),_=((m[p]||{}).DBF||{}).type,_=="C"&&m[p].DBF.len>B&&(B=m[p].DBF.len),E=="B"&&_=="N"&&(E="N",L[p]=m[p].DBF.dec,B=m[p].DBF.len),P[p]=E=="C"||_=="N"?B:a[E]||0,w+=P[p],k[p]=E}var F=u.next(32);for(F.write_shift(4,318902576),F.write_shift(4,h.length),F.write_shift(2,296+32*g),F.write_shift(2,w),p=0;p<4;++p)F.write_shift(4,0);for(F.write_shift(4,0|(+e[s8]||3)<<8),p=0,x=0;p<f.length;++p)if(f[p]!=null){var T=u.next(32),O=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,O,"sbcs"),T.write_shift(1,k[p]=="?"?"C":k[p],"sbcs"),T.write_shift(4,x),T.write_shift(1,P[p]||a[k[p]]||0),T.write_shift(1,L[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),x+=P[p]||a[k[p]]||0}var Y=u.next(264);for(Y.write_shift(4,13),p=0;p<65;++p)Y.write_shift(4,0);for(p=0;p<h.length;++p){var me=u.next(w);for(me.write_shift(1,0),x=0;x<f.length;++x)if(f[x]!=null)switch(k[x]){case"L":me.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":me.write_shift(8,h[p][x]||0,"f");break;case"N":var ae="0";for(typeof h[p][x]=="number"&&(ae=h[p][x].toFixed(L[x]||0)),g=0;g<P[x]-ae.length;++g)me.write_shift(1,32);me.write_shift(1,ae,"sbcs");break;case"D":h[p][x]?(me.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var fe=String(h[p][x]!=null?h[p][x]:"").slice(0,P[x]);for(me.write_shift(1,fe,"sbcs"),g=0;g<P[x]-fe.length;++g)me.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),pQ=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ps(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var m=t[h];return typeof m=="number"?lP(m):m},n=function(f,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?f:lP(p)};t["|"]=254;function s(f,h){switch(h.type){case"base64":return a(To(f),h);case"binary":return a(f,h);case"buffer":return a(Hr&&Buffer.isBuffer(f)?f.toString("binary"):yd(f),h);case"array":return a(Dh(f),h)}throw new Error("Unrecognized type "+h.type)}function a(f,h){var m=f.split(/[\n\r]+/),p=-1,x=-1,g=0,w=0,b=[],k=[],P=null,L={},E=[],_=[],B=[],M=0,F;for(+h.codepage>=0&&Pl(+h.codepage);g!==m.length;++g){M=0;var T=m[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),O=T.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),Y=O[0],me;if(T.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&k.push(T.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,fe=!1,he=!1,te=!1,pe=-1,Ie=-1;for(w=1;w<O.length;++w)switch(O[w].charAt(0)){case"A":break;case"X":x=parseInt(O[w].slice(1))-1,fe=!0;break;case"Y":for(p=parseInt(O[w].slice(1))-1,fe||(x=0),F=b.length;F<=p;++F)b[F]=[];break;case"K":me=O[w].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(Ol(me))?isNaN(H0(me).getDate())||(me=ns(me)):(me=Ol(me),P!==null&&cm(P)&&(me=J2(me))),ae=!0;break;case"E":te=!0;var S=b0(O[w].slice(1),{r:p,c:x});b[p][x]=[b[p][x],S];break;case"S":he=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":pe=parseInt(O[w].slice(1))-1;break;case"C":Ie=parseInt(O[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(ae&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=me:b[p][x]=me,P=null),he){if(te)throw new Error("SYLK shared formula cannot have own formula");var I=pe>-1&&b[pe][Ie];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=PQ(I[1],{r:p-pe,c:x-Ie})}break;case"F":var V=0;for(w=1;w<O.length;++w)switch(O[w].charAt(0)){case"X":x=parseInt(O[w].slice(1))-1,++V;break;case"Y":for(p=parseInt(O[w].slice(1))-1,F=b.length;F<=p;++F)b[F]=[];break;case"M":M=parseInt(O[w].slice(1))/20;break;case"F":break;case"G":break;case"P":P=k[parseInt(O[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=O[w].slice(1).split(" "),F=parseInt(B[0],10);F<=parseInt(B[1],10);++F)M=parseInt(B[2],10),_[F-1]=M===0?{hidden:!0}:{wch:M},cd(_[F-1]);break;case"C":x=parseInt(O[w].slice(1))-1,_[x]||(_[x]={});break;case"R":p=parseInt(O[w].slice(1))-1,E[p]||(E[p]={}),M>0?(E[p].hpt=M,E[p].hpx=q0(M)):M===0&&(E[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}V<1&&(P=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return E.length>0&&(L["!rows"]=E),_.length>0&&(L["!cols"]=_),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,L]}function o(f,h){var m=s(f,h),p=m[0],x=m[1],g=um(p,h);return Ps(x).forEach(function(w){g[w]=x[w]}),g}function l(f,h){return wd(o(f,h),h)}function c(f,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(f.t){case"n":x+=f.v||0,f.f&&!f.F&&(x+=";E"+TI(f.f,{r:m,c:p}));break;case"b":x+=f.v?"TRUE":"FALSE";break;case"e":x+=f.w||f.v;break;case"d":x+='"'+(f.w||f.v)+'"';break;case"s":x+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function A(f,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=ax(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=ix(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&f.push(x)})}function u(f,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*ox(m.hpx)+";"),x.length>2&&f.push(x+"R"+(p+1))})}function d(f,h){var m=["ID;PWXL;N;E"],p=[],x=hn(f["!ref"]),g,w=Array.isArray(f),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),f["!cols"]&&A(m,f["!cols"]),f["!rows"]&&u(m,f["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var k=x.s.r;k<=x.e.r;++k)for(var P=x.s.c;P<=x.e.c;++P){var L=_r({r:k,c:P});g=w?(f[k]||[])[P]:f[L],!(!g||g.v==null&&(!g.f||g.F))&&p.push(c(g,f,k,P))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:d}}(),gQ=function(){function t(a,o){switch(o.type){case"base64":return e(To(a),o);case"binary":return e(a,o);case"buffer":return e(Hr&&Buffer.isBuffer(a)?a.toString("binary"):yd(a),o);case"array":return e(Dh(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var l=a.split(`
`),c=-1,A=-1,u=0,d=[];u!==l.length;++u){if(l[u].trim()==="BOT"){d[++c]=[],A=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],m=f[1];++u;for(var p=l[u]||"";(p.match(/["]/g)||[]).length&1&&u<l.length-1;)p+=`
`+l[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){d[++c]=[],A=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[c][A]=!0:p==="FALSE"?d[c][A]=!1:isNaN(Ol(m))?isNaN(H0(m).getDate())?d[c][A]=m:d[c][A]=ns(m):d[c][A]=Ol(m),++A;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[c][A++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function r(a,o){return um(t(a,o),o)}function n(a,o){return wd(r(a,o),o)}var s=function(){var a=function(c,A,u,d,f){c.push(A),c.push(u+","+d),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,A,u,d){c.push(A+","+u),c.push(A==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var A=[],u=hn(c["!ref"]),d,f=Array.isArray(c);a(A,"TABLE",0,1,"sheetjs"),a(A,"VECTORS",0,u.e.r-u.s.r+1,""),a(A,"TUPLES",0,u.e.c-u.s.c+1,""),a(A,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(A,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=_r({r:h,c:m});if(d=f?(c[h]||[])[m]:c[p],!d){o(A,1,0,"");continue}switch(d.t){case"n":var x=d.w;!x&&d.v!=null&&(x=d.v),x==null?d.f&&!d.F?o(A,1,0,"="+d.f):o(A,1,0,""):o(A,0,x,"V");break;case"b":o(A,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(A,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=pl(d.z||Cr[14],ga(ns(d.v)))),o(A,0,d.w,"V");break;default:o(A,1,0,"")}}}o(A,-1,0,"EOD");var g=`\r
`,w=A.join(g);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),xQ=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,f){for(var h=d.split(`
`),m=-1,p=-1,x=0,g=[];x!==h.length;++x){var w=h[x].trim().split(":");if(w[0]==="cell"){var b=bs(w[1]);if(g.length<=b.r)for(m=g.length;m<=b.r;++m)g[m]||(g[m]=[]);switch(m=b.r,p=b.c,w[2]){case"t":g[m][p]=t(w[3]);break;case"v":g[m][p]=+w[3];break;case"vtf":var k=w[w.length-1];case"vtc":switch(w[3]){case"nl":g[m][p]=!!+w[4];break;default:g[m][p]=+w[4];break}w[2]=="vtf"&&(g[m][p]=[g[m][p],k])}}}return f&&f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}function n(d,f){return um(r(d,f),f)}function s(d,f){return wd(n(d,f),f)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function A(d){if(!d||!d["!ref"])return"";for(var f=[],h=[],m,p="",x=to(d["!ref"]),g=Array.isArray(d),w=x.s.r;w<=x.e.r;++w)for(var b=x.s.c;b<=x.e.c;++b)if(p=_r({r:w,c:b}),m=g?(d[w]||[])[b]:d[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=ga(ns(m.v));h[2]="vtc",h[3]="nd",h[4]=""+k,h[5]=m.w||pl(m.z||Cr[14],k);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(d){return[a,o,l,o,A(d),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),K0=function(){function t(u,d,f,h,m){m.raw?d[f][h]=u:u===""||(u==="TRUE"?d[f][h]=!0:u==="FALSE"?d[f][h]=!1:isNaN(Ol(u))?isNaN(H0(u).getDate())?d[f][h]=u:d[f][h]=ns(u):d[f][h]=Ol(u))}function e(u,d){var f=d||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,g=0,w=0;w<=p;++w)g=m[w].indexOf(" "),g==-1?g=m[w].length:g++,x=Math.max(x,g);for(w=0;w<=p;++w){h[w]=[];var b=0;for(t(m[w].slice(0,x).trim(),h,w,b,f),b=1;b<=(m[w].length-x)/10+1;++b)t(m[w].slice(x+(b-1)*10,x+b*10).trim(),h,w,b,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var d={},f=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?f=!f:!f&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h]);if(!m.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function a(u,d){var f=d||{},h="",m=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=s(u.slice(0,1024)):f&&f.FS?h=f.FS:h=s(u.slice(0,1024));var x=0,g=0,w=0,b=0,k=0,P=h.charCodeAt(0),L=!1,E=0,_=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var B=f.dateNF!=null?pce(f.dateNF):null;function M(){var F=u.slice(b,k),T={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)T.t="z";else if(f.raw)T.t="s",T.v=F;else if(F.trim().length===0)T.t="s",T.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(T.t="s",T.v=F.slice(2,-1).replace(/""/g,'"')):qfe(F)?(T.t="n",T.f=F.slice(1)):(T.t="s",T.v=F);else if(F=="TRUE")T.t="b",T.v=!0;else if(F=="FALSE")T.t="b",T.v=!1;else if(!isNaN(w=Ol(F)))T.t="n",f.cellText!==!1&&(T.w=F),T.v=w;else if(!isNaN(H0(F).getDate())||B&&F.match(B)){T.z=f.dateNF||Cr[14];var O=0;B&&F.match(B)&&(F=gce(F,f.dateNF,F.match(B)||[]),O=1),f.cellDates?(T.t="d",T.v=ns(F,O)):(T.t="n",T.v=ga(ns(F,O))),f.cellText!==!1&&(T.w=pl(T.z,T.v instanceof Date?ga(T.v):T.v)),f.cellNF||delete T.z}else T.t="s",T.v=F;if(T.t=="z"||(f.dense?(m[x]||(m[x]=[]),m[x][g]=T):m[_r({c:g,r:x})]=T),b=k+1,_=u.charCodeAt(b),p.e.c<g&&(p.e.c=g),p.e.r<x&&(p.e.r=x),E==P)++g;else if(g=0,++x,f.sheetRows&&f.sheetRows<=x)return!0}e:for(;k<u.length;++k)switch(E=u.charCodeAt(k)){case 34:_===34&&(L=!L);break;case P:case 10:case 13:if(!L&&M())break e;break}return k-b>0&&M(),m["!ref"]=Lr(p),m}function o(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,d):um(e(u,d),d)}function l(u,d){var f="",h=d.type=="string"?[0,0,0,0]:MI(u,d);switch(d.type){case"base64":f=To(u);break;case"binary":f=u;break;case"buffer":d.codepage==65001?f=u.toString("utf8"):d.codepage&&typeof Xg<"u"||(f=Hr&&Buffer.isBuffer(u)?u.toString("binary"):yd(u));break;case"array":f=Dh(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Rn(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=Rn(f):d.type=="binary"&&typeof Xg<"u",f.slice(0,19)=="socialcalc:version:"?xQ.to_sheet(d.type=="string"?f:Rn(f),d):o(f,d)}function c(u,d){return wd(l(u,d),d)}function A(u){for(var d=[],f=hn(u["!ref"]),h,m=Array.isArray(u),p=f.s.r;p<=f.e.r;++p){for(var x=[],g=f.s.c;g<=f.e.c;++g){var w=_r({r:p,c:g});if(h=m?(u[p]||[])[g]:u[w],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(IA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(g===0?" ":""))}d.push(x.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:A}}();function kde(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=pQ.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return K0.to_workbook(t,e)}}var gh=function(){function t(S,I,V){if(S){qa(S,S.l||0);for(var j=V.Enum||pe;S.l<S.length;){var U=S.read_shift(2),G=j[U]||j[65535],R=S.read_shift(2),X=S.l+R,se=G.f&&G.f(S,R,V);if(S.l=X,I(se,G,U))return}}}function e(S,I){switch(I.type){case"base64":return r(No(To(S)),I);case"binary":return r(No(S),I);case"buffer":case"array":return r(S,I)}throw"Unsupported type "+I.type}function r(S,I){if(!S)return S;var V=I||{},j=V.dense?[]:{},U="Sheet1",G="",R=0,X={},se=[],ye=[],z={s:{r:0,c:0},e:{r:0,c:0}},Me=V.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)V.Enum=pe,t(S,function(oe,de,Be){switch(Be){case 0:V.vers=oe,oe>=4096&&(V.qpro=!0);break;case 6:z=oe;break;case 204:oe&&(G=oe);break;case 222:G=oe;break;case 15:case 51:V.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Be==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=V.dateNF||Cr[14],V.cellDates&&(oe[1].t="d",oe[1].v=J2(oe[1].v))),V.qpro&&oe[3]>R&&(j["!ref"]=Lr(z),X[U]=j,se.push(U),j=V.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},R=oe[3],U=G||"Sheet"+(R+1),G="");var He=V.dense?(j[oe[0].r]||[])[oe[0].c]:j[_r(oe[0])];if(He){He.t=oe[1].t,He.v=oe[1].v,oe[1].z!=null&&(He.z=oe[1].z),oe[1].f!=null&&(He.f=oe[1].f);break}V.dense?(j[oe[0].r]||(j[oe[0].r]=[]),j[oe[0].r][oe[0].c]=oe[1]):j[_r(oe[0])]=oe[1];break}},V);else if(S[2]==26||S[2]==14)V.Enum=Ie,S[2]==14&&(V.qpro=!0,S.l=0),t(S,function(oe,de,Be){switch(Be){case 204:U=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>R&&(j["!ref"]=Lr(z),X[U]=j,se.push(U),j=V.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},R=oe[3],U="Sheet"+(R+1)),Me>0&&oe[0].r>=Me)break;V.dense?(j[oe[0].r]||(j[oe[0].r]=[]),j[oe[0].r][oe[0].c]=oe[1]):j[_r(oe[0])]=oe[1],z.e.c<oe[0].c&&(z.e.c=oe[0].c),z.e.r<oe[0].r&&(z.e.r=oe[0].r);break;case 27:oe[14e3]&&(ye[oe[14e3][0]]=oe[14e3][1]);break;case 1537:ye[oe[0]]=oe[1],oe[0]==R&&(U=oe[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(j["!ref"]=Lr(z),X[G||U]=j,se.push(G||U),!ye.length)return{SheetNames:se,Sheets:X};for(var re={},W=[],q=0;q<ye.length;++q)X[se[q]]?(W.push(ye[q]||se[q]),re[ye[q]]=X[ye[q]]||X[se[q]]):(W.push(ye[q]),re[ye[q]]={"!ref":"A1"});return{SheetNames:W,Sheets:re}}function n(S,I){var V=I||{};if(+V.codepage>=0&&Pl(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var j=eo(),U=hn(S["!ref"]),G=Array.isArray(S),R=[];Xt(j,0,a(1030)),Xt(j,6,c(U));for(var X=Math.min(U.e.r,8191),se=U.s.r;se<=X;++se)for(var ye=$s(se),z=U.s.c;z<=U.e.c;++z){se===U.s.r&&(R[z]=ws(z));var Me=R[z]+ye,re=G?(S[se]||[])[z]:S[Me];if(!(!re||re.t=="z"))if(re.t=="n")(re.v|0)==re.v&&re.v>=-32768&&re.v<=32767?Xt(j,13,h(se,z,re.v)):Xt(j,14,p(se,z,re.v));else{var W=IA(re);Xt(j,15,d(se,z,W.slice(0,239)))}}return Xt(j,1),j.end()}function s(S,I){var V=I||{};if(+V.codepage>=0&&Pl(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var j=eo();Xt(j,0,o(S));for(var U=0,G=0;U<S.SheetNames.length;++U)(S.Sheets[S.SheetNames[U]]||{})["!ref"]&&Xt(j,27,te(S.SheetNames[U],G++));var R=0;for(U=0;U<S.SheetNames.length;++U){var X=S.Sheets[S.SheetNames[U]];if(!(!X||!X["!ref"])){for(var se=hn(X["!ref"]),ye=Array.isArray(X),z=[],Me=Math.min(se.e.r,8191),re=se.s.r;re<=Me;++re)for(var W=$s(re),q=se.s.c;q<=se.e.c;++q){re===se.s.r&&(z[q]=ws(q));var oe=z[q]+W,de=ye?(X[re]||[])[q]:X[oe];if(!(!de||de.t=="z"))if(de.t=="n")Xt(j,23,M(re,q,R,de.v));else{var Be=IA(de);Xt(j,22,E(re,q,R,Be.slice(0,239)))}}++R}}return Xt(j,1),j.end()}function a(S){var I=_t(2);return I.write_shift(2,S),I}function o(S){var I=_t(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var V=0,j=0,U=0,G=0;G<S.SheetNames.length;++G){var R=S.SheetNames[G],X=S.Sheets[R];if(!(!X||!X["!ref"])){++U;var se=to(X["!ref"]);V<se.e.r&&(V=se.e.r),j<se.e.c&&(j=se.e.c)}}return V>8191&&(V=8191),I.write_shift(2,V),I.write_shift(1,U),I.write_shift(1,j),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function l(S,I,V){var j={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&V.qpro?(j.s.c=S.read_shift(1),S.l++,j.s.r=S.read_shift(2),j.e.c=S.read_shift(1),S.l++,j.e.r=S.read_shift(2),j):(j.s.c=S.read_shift(2),j.s.r=S.read_shift(2),I==12&&V.qpro&&(S.l+=2),j.e.c=S.read_shift(2),j.e.r=S.read_shift(2),I==12&&V.qpro&&(S.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function c(S){var I=_t(8);return I.write_shift(2,S.s.c),I.write_shift(2,S.s.r),I.write_shift(2,S.e.c),I.write_shift(2,S.e.r),I}function A(S,I,V){var j=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(j[0].c=S.read_shift(1),j[3]=S.read_shift(1),j[0].r=S.read_shift(2),S.l+=2):(j[2]=S.read_shift(1),j[0].c=S.read_shift(2),j[0].r=S.read_shift(2)),j}function u(S,I,V){var j=S.l+I,U=A(S,I,V);if(U[1].t="s",V.vers==20768){S.l++;var G=S.read_shift(1);return U[1].v=S.read_shift(G,"utf8"),U}return V.qpro&&S.l++,U[1].v=S.read_shift(j-S.l,"cstr"),U}function d(S,I,V){var j=_t(7+V.length);j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,S),j.write_shift(1,39);for(var U=0;U<j.length;++U){var G=V.charCodeAt(U);j.write_shift(1,G>=128?95:G)}return j.write_shift(1,0),j}function f(S,I,V){var j=A(S,I,V);return j[1].v=S.read_shift(2,"i"),j}function h(S,I,V){var j=_t(7);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,S),j.write_shift(2,V,"i"),j}function m(S,I,V){var j=A(S,I,V);return j[1].v=S.read_shift(8,"f"),j}function p(S,I,V){var j=_t(13);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,S),j.write_shift(8,V,"f"),j}function x(S,I,V){var j=S.l+I,U=A(S,I,V);if(U[1].v=S.read_shift(8,"f"),V.qpro)S.l=j;else{var G=S.read_shift(2);k(S.slice(S.l,S.l+G),U),S.l+=G}return U}function g(S,I,V){var j=I&32768;return I&=-32769,I=(j?S:0)+(I>=8192?I-16384:I),(j?"":"$")+(V?ws(I):$s(I))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(S,I){qa(S,0);for(var V=[],j=0,U="",G="",R="",X="";S.l<S.length;){var se=S[S.l++];switch(se){case 0:V.push(S.read_shift(8,"f"));break;case 1:G=g(I[0].c,S.read_shift(2),!0),U=g(I[0].r,S.read_shift(2),!1),V.push(G+U);break;case 2:{var ye=g(I[0].c,S.read_shift(2),!0),z=g(I[0].r,S.read_shift(2),!1);G=g(I[0].c,S.read_shift(2),!0),U=g(I[0].r,S.read_shift(2),!1),V.push(ye+z+":"+G+U)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(S.read_shift(2));break;case 6:{for(var Me="";se=S[S.l++];)Me+=String.fromCharCode(se);V.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:X=V.pop(),R=V.pop(),V.push(["AND","OR"][se-20]+"("+R+","+X+")");break;default:if(se<32&&b[se])X=V.pop(),R=V.pop(),V.push(R+b[se]+X);else if(w[se]){if(j=w[se][1],j==69&&(j=S[S.l++]),j>V.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+V.join("|")+"|");return}var re=V.slice(-j);V.length-=j,V.push(w[se][0]+"("+re.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}V.length==1?I[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function P(S){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=S.read_shift(2),I[3]=S[S.l++],I[0].c=S[S.l++],I}function L(S,I){var V=P(S);return V[1].t="s",V[1].v=S.read_shift(I-4,"cstr"),V}function E(S,I,V,j){var U=_t(6+j.length);U.write_shift(2,S),U.write_shift(1,V),U.write_shift(1,I),U.write_shift(1,39);for(var G=0;G<j.length;++G){var R=j.charCodeAt(G);U.write_shift(1,R>=128?95:R)}return U.write_shift(1,0),U}function _(S,I){var V=P(S);V[1].v=S.read_shift(2);var j=V[1].v>>1;if(V[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return V[1].v=j,V}function B(S,I){var V=P(S),j=S.read_shift(4),U=S.read_shift(4),G=S.read_shift(2);if(G==65535)return j===0&&U===3221225472?(V[1].t="e",V[1].v=15):j===0&&U===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var R=G&32768;return G=(G&32767)-16446,V[1].v=(1-R*2)*(U*Math.pow(2,G+32)+j*Math.pow(2,G)),V}function M(S,I,V,j){var U=_t(14);if(U.write_shift(2,S),U.write_shift(1,V),U.write_shift(1,I),j==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var G=0,R=0,X=0,se=0;return j<0&&(G=1,j=-j),R=Math.log2(j)|0,j/=Math.pow(2,R-31),se=j>>>0,se&2147483648||(j/=2,++R,se=j>>>0),j-=se,se|=2147483648,se>>>=0,j*=Math.pow(2,32),X=j>>>0,U.write_shift(4,X),U.write_shift(4,se),R+=16383+(G?32768:0),U.write_shift(2,R),U}function F(S,I){var V=B(S);return S.l+=I-14,V}function T(S,I){var V=P(S),j=S.read_shift(4);return V[1].v=j>>6,V}function O(S,I){var V=P(S),j=S.read_shift(8,"f");return V[1].v=j,V}function Y(S,I){var V=O(S);return S.l+=I-10,V}function me(S,I){return S[S.l+I-1]==0?S.read_shift(I,"cstr"):""}function ae(S,I){var V=S[S.l++];V>I-1&&(V=I-1);for(var j="";j.length<V;)j+=String.fromCharCode(S[S.l++]);return j}function fe(S,I,V){if(!(!V.qpro||I<21)){var j=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var U=S.read_shift(I-21,"cstr");return[j,U]}}function he(S,I){for(var V={},j=S.l+I;S.l<j;){var U=S.read_shift(2);if(U==14e3){for(V[U]=[0,""],V[U][0]=S.read_shift(2);S[S.l];)V[U][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return V}function te(S,I){var V=_t(5+S.length);V.write_shift(2,14e3),V.write_shift(2,I);for(var j=0;j<S.length;++j){var U=S.charCodeAt(j);V[V.l++]=U>127?95:U}return V[V.l++]=0,V}var pe={0:{n:"BOF",f:Zs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:_},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function Tde(t){var e={},r=t.match(yi),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Br(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=nI[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var jde=function(){var t=ex("t"),e=ex("rPr");function r(a){var o=a.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:un(o[1])},c=a.match(e);return c&&(l.s=Tde(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),Pde=function(){var e=/(\r\n|\n)/g;function r(s,a,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),o.push("</b>")),s.i&&(a.push("<i>"),o.push("</i>")),s.strike&&(a.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Rde=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Dde=/<(?:\w+:)?r>/,Lde=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function BI(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=un(Rn(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Rn(t),r&&(n.h=hI(n.t))):t.match(Dde)&&(n.r=Rn(t),n.t=un(Rn((t.replace(Lde,"").match(Rde)||[]).join("").replace(yi,""))),r&&(n.h=Pde(jde(n.r)))),n):{t:""}}var Ude=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ode=/<(?:\w+:)?(?:si|sstItem)>/g,Mde=/<\/(?:\w+:)?(?:si|sstItem)>/;function Qde(t,e){var r=[],n="";if(!t)return r;var s=t.match(Ude);if(s){n=s[2].replace(Ode,"").split(Mde);for(var a=0;a!=n.length;++a){var o=BI(n[a].trim(),e);o!=null&&(r[r.length]=o)}s=Br(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Vde=/^\s|\s$|[\t\n\r]/;function vQ(t,e){if(!e.bookSST)return"";var r=[Ws];r[r.length]=Jt("sst",null,{xmlns:Zh[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Vde)&&(a+=' xml:space="preserve"'),a+=">"+Fn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Hde(t){return[t.read_shift(4),t.read_shift(4)]}function Kde(t,e){var r=[],n=!1;return PA(t,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function qde(t,e){return e||(e=_t(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Gde=rAe;function $de(t){var e=eo();Dt(e,159,qde(t));for(var r=0;r<t.length;++r)Dt(e,19,Gde(t[r]));return Dt(e,160),e.end()}function yQ(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function vA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function zde(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=vA(t,4),e.U=vA(t,4),e.W=vA(t,4),e}function Wde(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Jde(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Wde(t));return e}function Xde(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Yde(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=vA(t,4),e.U=vA(t,4),e.W=vA(t,4),e}function Zde(t){var e=Yde(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function wQ(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function bQ(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function ehe(t){var e=vA(t);switch(e.Minor){case 2:return[e.Minor,the(t)];case 3:return[e.Minor,rhe()];case 4:return[e.Minor,nhe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function the(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=wQ(t,r),s=bQ(t,t.length-t.l);return{t:"Std",h:n,v:s}}function rhe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function nhe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(yi,function(a){var o=Br(a);switch(Tc(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function she(t,e){var r={},n=r.EncryptionVersionInfo=vA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=wQ(t,s),e-=s,r.EncryptionVerifier=bQ(t,e),r}function ahe(t){var e={},r=e.EncryptionVersionInfo=vA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function SI(t){var e=0,r,n=yQ(t),s=n.length+1,a,o,l,c,A;for(r=ld(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],l=e&16384?1:0,c=e<<1&32767,A=l|c,e=A^o;return e^52811}var NQ=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},a=function(o){for(var l=e[o.length-1],c=104,A=o.length-1;A>=0;--A)for(var u=o[A],d=0;d!=7;++d)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=yQ(o),c=a(l),A=l.length,u=ld(16),d=0;d!=16;++d)u[d]=0;var f,h,m;for((A&1)===1&&(f=c>>8,u[A]=s(t[0],f),--A,f=c&255,h=l[l.length-1],u[A]=s(h,f));A>0;)--A,f=c>>8,u[A]=s(l[A],f),--A,f=c&255,u[A]=s(l[A],f);for(A=15,m=15-l.length;m>0;)f=c>>8,u[A]=s(t[m],f),--A,--m,f=c&255,u[A]=s(l[A],f),--A,--m;return u}}(),ihe=function(t,e,r,n,s){s||(s=e),n||(n=NQ(t));var a,o;for(a=0;a!=e.length;++a)o=e[a],o^=n[r],o=(o>>5|o<<3)&255,s[a]=o,++r;return[s,r,n]},ohe=function(t){var e=0,r=NQ(t);return function(n){var s=ihe("",n,e,r);return e=s[1],s[0]}};function lhe(t,e,r,n){var s={key:Zs(t),verificationBytes:Zs(t)};return r.password&&(s.verifier=SI(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=ohe(r.password)),s}function che(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=ahe(t):n.Data=she(t,e),n}function Ahe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?che(t,e-2,n):lhe(t,r.biff>=8?e:e-2,r,n),n}var CQ=function(){function t(s,a){switch(a.type){case"base64":return e(To(s),a);case"binary":return e(s,a);case"buffer":return e(Hr&&Buffer.isBuffer(s)?s.toString("binary"):yd(s),a);case"array":return e(Dh(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var o=a||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,d){Array.isArray(l)&&(l[d]=[]);for(var f=/\\\w+\b/g,h=0,m,p=-1;m=f.exec(u);){switch(m[0]){case"\\cell":var x=u.slice(h,f.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var g={v:x,t:"s"};Array.isArray(l)?l[d][p]=g:l[_r({r:d,c:p})]=g}break}h=f.lastIndex}p>A.e.c&&(A.e.c=p)}),l["!ref"]=Lr(A),l}function r(s,a){return wd(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=hn(s["!ref"]),l,c=Array.isArray(s),A=o.s.r;A<=o.e.r;++A){a.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var d=_r({r:A,c:u});l=c?(s[A]||[])[u]:s[d],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(IA(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function uhe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function sx(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function dhe(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),o=s-a;if(o===0)return[0,0,e];var l=0,c=0,A=s+a;switch(c=o/(A>1?2-A:A),s){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,A/2]}function hhe(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,o=[a,a,a],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var A=0;A!=3;++A)o[A]=Math.round(o[A]*255);return o}function Dw(t,e){if(e===0)return t;var r=dhe(uhe(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),sx(hhe(r))}var _Q=6,fhe=15,mhe=1,mi=_Q;function ax(t){return Math.floor((t+Math.round(128/mi)/256)*mi)}function ix(t){return Math.floor((t-5)/mi*100+.5)/100}function Lw(t){return Math.round((t*mi+5)/mi*256)/256}function nC(t){return Lw(ix(ax(t)))}function II(t){var e=Math.abs(t-nC(t)),r=mi;if(e>.005)for(mi=mhe;mi<fhe;++mi)Math.abs(t-nC(t))<=e&&(e=Math.abs(t-nC(t)),r=mi);mi=r}function cd(t){t.width?(t.wpx=ax(t.width),t.wch=ix(t.wpx),t.MDW=mi):t.wpx?(t.wch=ix(t.wpx),t.width=Lw(t.wch),t.MDW=mi):typeof t.wch=="number"&&(t.width=Lw(t.wch),t.wpx=ax(t.width),t.MDW=mi),t.customWidth&&delete t.customWidth}var phe=96,EQ=phe;function ox(t){return t*96/EQ}function q0(t){return t*EQ/96}var ghe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xhe(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(yi)||[]).forEach(function(o){var l=Br(o);switch(Tc(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=es(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=es(l.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function vhe(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(yi)||[]).forEach(function(o){var l=Br(o);switch(Tc(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function yhe(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(yi)||[]).forEach(function(o){var l=Br(o);switch(Tc(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Rn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?es(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?es(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?es(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?es(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?es(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?es(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?es(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=nI[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=es(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=mh[s.color.index];s.color.index==81&&(c=mh[1]),c||(c=mh[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Dw(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function whe(t,e,r){e.NumberFmt=[];for(var n=Ps(Cr),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Cr[n[s]];var a=t[0].match(yi);if(a)for(s=0;s<a.length;++s){var o=Br(a[s]);switch(Tc(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=un(Rn(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}xA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function bhe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Jt("numFmt",null,{numFmtId:n,formatCode:Fn(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Jt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var k1=["numFmtId","fillId","fontId","borderId","xfId"],T1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Nhe(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(yi)||[]).forEach(function(a){var o=Br(a),l=0;switch(Tc(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<k1.length;++l)n[k1[l]]&&(n[k1[l]]=parseInt(n[k1[l]],10));for(l=0;l<T1.length;++l)n[T1[l]]&&(n[T1[l]]=es(n[T1[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=es(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Che(t){var e=[];return e[e.length]=Jt("cellXfs",null),t.forEach(function(r){e[e.length]=Jt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Jt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var _he=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,A){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=l.match(e))&&whe(d,u,A),(d=l.match(s))&&yhe(d,u,c,A),(d=l.match(n))&&vhe(d,u,c,A),(d=l.match(a))&&xhe(d,u,c,A),(d=l.match(r))&&Nhe(d,u,A),u}}();function BQ(t,e){var r=[Ws,Jt("styleSheet",null,{xmlns:Zh[0],"xmlns:vt":ha.vt})],n;return t.SSF&&(n=bhe(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Che(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ehe(t,e){var r=t.read_shift(2),n=gi(t);return[r,n]}function Bhe(t,e,r){r||(r=_t(6+4*e.length)),r.write_shift(2,t),Ba(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function She(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=cAe(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=lAe(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gi(t),n}function Ihe(t,e){e||(e=_t(25+4*32)),e.write_shift(2,t.sz*20),AAe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),jw(t.color,e);var n=0;return n=2,e.write_shift(1,n),Ba(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Fhe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],sC,khe=vi;function YP(t,e){e||(e=_t(4*3+8*7+16*1)),sC||(sC=z2(Fhe));var r=sC[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(jw({auto:1},e),jw({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function The(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function SQ(t,e,r){r||(r=_t(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function sp(t,e){return e||(e=_t(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var jhe=vi;function Phe(t,e){return e||(e=_t(51)),e.write_shift(1,0),sp(null,e),sp(null,e),sp(null,e),sp(null,e),sp(null,e),e.length>e.l?e.slice(0,e.l):e}function Rhe(t,e){return e||(e=_t(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Tw(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Dhe(t,e,r){var n=_t(2052);return n.write_shift(4,t),Tw(e,n),Tw(r,n),n.length>n.l?n.slice(0,n.l):n}function Lhe(t,e,r){var n={};n.NumberFmt=[];for(var s in Cr)n.NumberFmt[s]=Cr[s];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return PA(t,function(c,A,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],xA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Dw(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(u),o=!0;break;case 38:a.pop(),o=!1;break;default:if(A.T>0)a.push(u);else if(A.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function Uhe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(Dt(t,615,Ml(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Dt(t,44,Bhe(s,e[s]))}),Dt(t,616))}}function Ohe(t){var e=1;Dt(t,611,Ml(e)),Dt(t,43,Ihe({sz:12,color:{theme:1},name:"Calibri",family:2})),Dt(t,612)}function Mhe(t){var e=2;Dt(t,603,Ml(e)),Dt(t,45,YP({patternType:"none"})),Dt(t,45,YP({patternType:"gray125"})),Dt(t,604)}function Qhe(t){var e=1;Dt(t,613,Ml(e)),Dt(t,46,Phe()),Dt(t,614)}function Vhe(t){var e=1;Dt(t,626,Ml(e)),Dt(t,47,SQ({numFmtId:0},65535)),Dt(t,627)}function Hhe(t,e){Dt(t,617,Ml(e.length)),e.forEach(function(r){Dt(t,47,SQ(r,0))}),Dt(t,618)}function Khe(t){var e=1;Dt(t,619,Ml(e)),Dt(t,48,Rhe({xfId:0,name:"Normal"})),Dt(t,620)}function qhe(t){var e=0;Dt(t,505,Ml(e)),Dt(t,506)}function Ghe(t){var e=0;Dt(t,508,Dhe(e,"TableStyleMedium9","PivotStyleMedium4")),Dt(t,509)}function $he(t,e){var r=eo();return Dt(r,278),Uhe(r,t.SSF),Ohe(r),Mhe(r),Qhe(r),Vhe(r),Hhe(r,e.cellXfs),Khe(r),qhe(r),Ghe(r),Dt(r,279),r.end()}var zhe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Whe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(yi)||[]).forEach(function(s){var a=Br(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[zhe.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Jhe(){}function Xhe(){}var Yhe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Zhe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,efe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tfe(t,e,r){e.themeElements={};var n;[["clrScheme",Yhe,Whe],["fontScheme",Zhe,Jhe],["fmtScheme",efe,Xhe]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var rfe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function IQ(t,e){(!t||t.length===0)&&(t=FI());var r,n={};if(!(r=t.match(rfe)))throw new Error("themeElements not found in theme");return tfe(r[0],n,e),n.raw=t,n}function FI(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Ws];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function nfe(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var o;try{o=w8(a,{type:"array"})}catch{return}var l=Co(o,"theme/theme/theme1.xml",!0);if(l)return IQ(l,r)}}function sfe(t){return t.read_shift(4)}function afe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=ife(t,4);break;case 2:e.xclrValue=lQ(t);break;case 3:e.xclrValue=sfe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function ife(t,e){return vi(t,e)}function ofe(t,e){return vi(t,e)}function lfe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=afe(t);break;case 6:n[1]=ofe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function cfe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(lfe(t,r-t.l));return{ixfe:n,ext:a}}function Afe(t,e){e.forEach(function(r){switch(r[0]){}})}function ufe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:gi(t)}}function dfe(t){var e=_t(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ba(t.name,e),e.slice(0,e.l)}function hfe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function ffe(t){var e=_t(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function mfe(t,e){var r=_t(8+2*e.length);return r.write_shift(4,t),Ba(e,r),r.slice(0,r.l)}function pfe(t){return t.l+=4,t.read_shift(4)!=0}function gfe(t,e){var r=_t(8);return r.write_shift(4,t),r.write_shift(4,1),r}function xfe(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],o=!1,l=2;return PA(t,function(c,A,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){l==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):l==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(u),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!A.T){if(!o||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function vfe(){var t=eo();return Dt(t,332),Dt(t,334,Ml(1)),Dt(t,335,dfe({name:"XLDAPR",version:12e4,flags:3496657072})),Dt(t,336),Dt(t,339,mfe(1,"XLDAPR")),Dt(t,52),Dt(t,35,Ml(514)),Dt(t,4096,Ml(0)),Dt(t,4097,rl(1)),Dt(t,36),Dt(t,53),Dt(t,340),Dt(t,337,gfe(1)),Dt(t,51,ffe([[1,0]])),Dt(t,338),Dt(t,333),t.end()}function yfe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,o;return t.replace(yi,function(l){var c=Br(l);switch(Tc(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<n.Types.length;++A)n.Types[A].name==c.name&&(o=n.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function FQ(){var t=[Ws];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function wfe(t){var e=[];if(!t)return e;var r=1;return(t.match(yi)||[]).forEach(function(n){var s=Br(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function bfe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=_r(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Nfe(t,e,r){var n=[];return PA(t,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Cfe(t,e,r,n){if(!t)return t;var s=n||{},a=!1;PA(t,function(l,c,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},s)}function _fe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var l0=1024;function kQ(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Jt("xml",null,{"xmlns:v":wo.v,"xmlns:o":wo.o,"xmlns:x":wo.x,"xmlns:mv":wo.mv}).replace(/\/>/,">"),Jt("o:shapelayout",Jt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Jt("v:shapetype",[Jt("v:stroke",null,{joinstyle:"miter"}),Jt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];l0<t*1e3;)l0+=1e3;return e.forEach(function(a){var o=bs(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Jt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,A=Jt("v:fill",c,l),u={on:"t",obscured:"t"};++l0,s=s.concat(["<v:shape"+tx({id:"_x0000_s"+l0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",A,Jt("v:shadow",null,u),Jt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",$a("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),$a("x:AutoFill","False"),$a("x:Row",String(o.r)),$a("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function ZP(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(o){var l=bs(o.ref);if(s?(t[l.r]||(t[l.r]=[]),a=t[l.r][l.c]):a=t[o.ref],!a){a={t:"z"},s?t[l.r][l.c]=a:t[o.ref]=a;var c=hn(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var A=Lr(c);A!==t["!ref"]&&(t["!ref"]=A)}a.c||(a.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}a.c.push(u)})}function Efe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Br(l[0]),A={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=bs(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var d=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&BI(d[1])||{r:"",t:"",h:""};A.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),A.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(A.h=f.h),n.push(A)}}}}),n}function TQ(t){var e=[Ws,Jt("comments",null,{xmlns:Zh[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=Fn(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Fn(c.a))),a.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push($a("t",Fn(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;e.push($a("t",Fn(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Bfe(t,e){var r=[],n=!1,s={},a=0;return t.replace(yi,function(l,c){var A=Br(l);switch(Tc(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=t.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return l}),r}function Sfe(t,e,r){var n=[Ws,Jt("ThreadedComments",null,{xmlns:ha.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Jt("threadedComment",$a("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Ife(t,e){var r=[],n=!1;return t.replace(yi,function(a){var o=Br(a);switch(Tc(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function Ffe(t){var e=[Ws,Jt("personList",null,{xmlns:ha.TCMNT,"xmlns:x":Zh[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Jt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function kfe(t){var e={};e.iauthor=t.read_shift(4);var r=nf(t);return e.rfx=r.s,e.ref=_r(r.s),t.l+=16,e}function Tfe(t,e){return e==null&&(e=_t(36)),e.write_shift(4,t[1].iauthor),dm(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var jfe=gi;function Pfe(t){return Ba(t.slice(0,54))}function Rfe(t,e){var r=[],n=[],s={},a=!1;return PA(t,function(l,c,A){switch(A){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),r}function Dfe(t){var e=eo(),r=[];return Dt(e,628),Dt(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Dt(e,632,Pfe(s.a)))})}),Dt(e,631),Dt(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:bs(n[0]),e:bs(n[0])};Dt(e,635,Tfe([a,s])),s.t&&s.t.length>0&&Dt(e,637,sAe(s)),Dt(e,636),delete s.iauthor})}),Dt(e,634),Dt(e,629),e.end()}var Lfe="application/vnd.ms-office.vbaProject";function Ufe(t){var e=wr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");wr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),wr.write(e)}function Ofe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&wr.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var jQ=["xlsb","xlsm","xlam","biff8","xla"];function Mfe(){return{"!type":"dialog"}}function Qfe(){return{"!type":"dialog"}}function Vfe(){return{"!type":"macro"}}function Hfe(){return{"!type":"macro"}}var b0=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,o){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var A=a.length>0?parseInt(a,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=e.c:--u,c?A+=e.r:--A,s+(l?"":"$")+ws(u)+(c?"":"$")+$s(A)}return function(s,a){return e=a,s.replace(t,r)}}(),kI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,TI=function(){return function(e,r){return e.replace(kI,function(n,s,a,o,l,c){var A=xI(o)-(a?0:r.c),u=gI(c)-(l?0:r.r),d=u==0?"":l?u+1:"["+u+"]",f=A==0?"":a?A+1:"["+A+"]";return s+"R"+d+"C"+f})}}();function PQ(t,e){return t.replace(kI,function(r,n,s,a,o,l){return n+(s=="$"?s+a:ws(xI(a)+e.c))+(o=="$"?o+l:$s(gI(l)+e.r))})}function Kfe(t,e,r){var n=to(e),s=n.s,a=bs(r),o={r:a.r-s.r,c:a.c-s.c};return PQ(t,o)}function qfe(t){return t.length!=1}function e3(t){return t.replace(/_xlfn\./g,"")}function Js(t){t.l+=1}function Ad(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function RQ(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return DQ(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),o=Ad(t),l=Ad(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function DQ(t){var e=Ad(t),r=Ad(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Gfe(t,e,r){if(r.biff<8)return DQ(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=Ad(t),o=Ad(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function LQ(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return $fe(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Ad(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function $fe(t){var e=Ad(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function zfe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Wfe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Jfe(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function Jfe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Xfe(t,e,r){var n=(t[t.l++]&96)>>5,s=RQ(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Yfe(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var o=RQ(t,a,r);return[n,s,o]}function Zfe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function e0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function t0e(t,e,r){var n=(t[t.l++]&96)>>5,s=Gfe(t,e-1,r);return[n,s]}function r0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function t3(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function n0e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function s0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function a0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function i0e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function o0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function UQ(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function l0e(t){return t.read_shift(2),UQ(t)}function c0e(t){return t.read_shift(2),UQ(t)}function A0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=LQ(t,0,r);return[n,s]}function u0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Wfe(t,0,r);return[n,s]}function d0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=LQ(t,0,r);return[n,s,a]}function h0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[pme[s],QQ[s],n]}function f0e(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:m0e(t);return[s,(a[0]===0?QQ:mme)[a[1]]]}function m0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function p0e(t,e,r){t.l+=r&&r.biff==2?3:4}function g0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function x0e(t){return t.l++,RA[t.read_shift(1)]}function v0e(t){return t.l++,t.read_shift(2)}function y0e(t){return t.l++,t.read_shift(1)!==0}function w0e(t){return t.l++,pi(t)}function b0e(t,e,r){return t.l++,Vx(t,e-1,r)}function N0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Qs(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=RA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=pi(t);break;case 2:r[1]=sf(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function C0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?nf:X2)(t));return s}function _0e(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=N0e(t,r.biff);return o}function E0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function B0e(t,e,r){if(r.biff==5)return S0e(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function S0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function I0e(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function F0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function k0e(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function T0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var j0e=vi,P0e=vi,R0e=vi;function Kx(t,e,r){return t.l+=2,[zfe(t)]}function jI(t){return t.l+=6,[]}var D0e=Kx,L0e=jI,U0e=jI,O0e=Kx;function OQ(t){return t.l+=2,[Zs(t),t.read_shift(2)&1]}var M0e=Kx,Q0e=OQ,V0e=jI,H0e=Kx,K0e=Kx,q0e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function G0e(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),o=q0e[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:s,C:a}}function $0e(t){return t.l+=2,[t.read_shift(4)]}function z0e(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function W0e(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function J0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function X0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Y0e(t){return t.l+=4,[0,0]}var r3={1:{n:"PtgExp",f:g0e},2:{n:"PtgTbl",f:R0e},3:{n:"PtgAdd",f:Js},4:{n:"PtgSub",f:Js},5:{n:"PtgMul",f:Js},6:{n:"PtgDiv",f:Js},7:{n:"PtgPower",f:Js},8:{n:"PtgConcat",f:Js},9:{n:"PtgLt",f:Js},10:{n:"PtgLe",f:Js},11:{n:"PtgEq",f:Js},12:{n:"PtgGe",f:Js},13:{n:"PtgGt",f:Js},14:{n:"PtgNe",f:Js},15:{n:"PtgIsect",f:Js},16:{n:"PtgUnion",f:Js},17:{n:"PtgRange",f:Js},18:{n:"PtgUplus",f:Js},19:{n:"PtgUminus",f:Js},20:{n:"PtgPercent",f:Js},21:{n:"PtgParen",f:Js},22:{n:"PtgMissArg",f:Js},23:{n:"PtgStr",f:b0e},26:{n:"PtgSheet",f:z0e},27:{n:"PtgEndSheet",f:W0e},28:{n:"PtgErr",f:x0e},29:{n:"PtgBool",f:y0e},30:{n:"PtgInt",f:v0e},31:{n:"PtgNum",f:w0e},32:{n:"PtgArray",f:r0e},33:{n:"PtgFunc",f:h0e},34:{n:"PtgFuncVar",f:f0e},35:{n:"PtgName",f:E0e},36:{n:"PtgRef",f:A0e},37:{n:"PtgArea",f:Xfe},38:{n:"PtgMemArea",f:I0e},39:{n:"PtgMemErr",f:j0e},40:{n:"PtgMemNoMem",f:P0e},41:{n:"PtgMemFunc",f:F0e},42:{n:"PtgRefErr",f:k0e},43:{n:"PtgAreaErr",f:Zfe},44:{n:"PtgRefN",f:u0e},45:{n:"PtgAreaN",f:t0e},46:{n:"PtgMemAreaN",f:J0e},47:{n:"PtgMemNoMemN",f:X0e},57:{n:"PtgNameX",f:B0e},58:{n:"PtgRef3d",f:d0e},59:{n:"PtgArea3d",f:Yfe},60:{n:"PtgRefErr3d",f:T0e},61:{n:"PtgAreaErr3d",f:e0e},255:{}},Z0e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},eme={1:{n:"PtgElfLel",f:OQ},2:{n:"PtgElfRw",f:H0e},3:{n:"PtgElfCol",f:D0e},6:{n:"PtgElfRwV",f:K0e},7:{n:"PtgElfColV",f:O0e},10:{n:"PtgElfRadical",f:M0e},11:{n:"PtgElfRadicalS",f:V0e},13:{n:"PtgElfColS",f:L0e},15:{n:"PtgElfColSV",f:U0e},16:{n:"PtgElfRadicalLel",f:Q0e},25:{n:"PtgList",f:G0e},29:{n:"PtgSxName",f:$0e},255:{}},tme={0:{n:"PtgAttrNoop",f:Y0e},1:{n:"PtgAttrSemi",f:o0e},2:{n:"PtgAttrIf",f:a0e},4:{n:"PtgAttrChoose",f:n0e},8:{n:"PtgAttrGoto",f:s0e},16:{n:"PtgAttrSum",f:p0e},32:{n:"PtgAttrBaxcel",f:t3},33:{n:"PtgAttrBaxcel",f:t3},64:{n:"PtgAttrSpace",f:l0e},65:{n:"PtgAttrSpaceSemi",f:c0e},128:{n:"PtgAttrIfError",f:i0e},255:{}};function qx(t,e,r,n){if(n.biff<8)return vi(t,e);for(var s=t.l+e,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=_0e(t,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=C0e(t,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&a.push(vi(t,e)),a}function Gx(t,e,r){for(var n=t.l+e,s,a,o=[];n!=t.l;)e=n-t.l,a=t[t.l],s=r3[a]||r3[Z0e[a]],(a===24||a===25)&&(s=(a===24?eme:tme)[t[t.l+1]]),!s||!s.f?vi(t,e):o.push([s.n,s.f(t,e,r)]);return o}function rme(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var nme={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sme(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function MQ(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function n3(t,e,r){var n=MQ(t,e,r);return n=="#REF"?n:sme(n,r)}function hi(t,e,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,A,u,d=0,f=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",g=0,w=t[0].length;g<w;++g){var b=t[0][g];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),A=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=ks(" ",t[0][p][1][1]);break;case 1:x=ks("\r",t[0][p][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}A=A+x,p=-1}l.push(A+nme[b[0]]+c);break;case"PtgIsect":c=l.pop(),A=l.pop(),l.push(A+" "+c);break;case"PtgUnion":c=l.pop(),A=l.pop(),l.push(A+","+c);break;case"PtgRange":c=l.pop(),A=l.pop(),l.push(A+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=rg(b[1][1],o,s),l.push(ng(u,a));break;case"PtgRefN":u=r?rg(b[1][1],r,s):b[1][1],l.push(ng(u,a));break;case"PtgRef3d":d=b[1][1],u=rg(b[1][2],o,s),m=n3(n,d,s),l.push(m+"!"+ng(u,a));break;case"PtgFunc":case"PtgFuncVar":var k=b[1][0],P=b[1][1];k||(k=0),k&=127;var L=k==0?[]:l.slice(-k);l.length-=k,P==="User"&&(P=L.shift()),l.push(P+"("+L.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=TP(b[1][1],r?{s:r}:o,s),l.push(eC(h,s));break;case"PtgArea":h=TP(b[1][1],o,s),l.push(eC(h,s));break;case"PtgArea3d":d=b[1][1],h=b[1][2],m=n3(n,d,s),l.push(m+"!"+eC(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=b[1][2];var E=(n.names||[])[f-1]||(n[0]||[])[f],_=E?E.Name:"SH33TJSNAME"+String(f);_&&_.slice(0,6)=="_xlfn."&&!s.xlfn&&(_=_.slice(6)),l.push(_);break;case"PtgNameX":var B=b[1][1];f=b[1][2];var M;if(s.biff<=5)B<0&&(B=-B),n[B]&&(M=n[B][f]);else{var F="";if(((n[B]||[])[0]||[])[0]==14849||(((n[B]||[])[0]||[])[0]==1025?n[B][f]&&n[B][f].itab>0&&(F=n.SheetNames[n[B][f].itab-1]+"!"):F=n.SheetNames[f-1]+"!"),n[B]&&n[B][f])F+=n[B][f].Name;else if(n[0]&&n[0][f])F+=n[0][f].Name;else{var T=(MQ(n,B,s)||"").split(";;");T[f-1]?F=T[f-1]:F+="SH33TJSERRX"}l.push(F);break}M||(M={Name:"SH33TJSERRY"}),l.push(M.Name);break;case"PtgParen":var O="(",Y=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:O=ks(" ",t[0][p][1][1])+O;break;case 3:O=ks("\r",t[0][p][1][1])+O;break;case 4:Y=ks(" ",t[0][p][1][1])+Y;break;case 5:Y=ks("\r",t[0][p][1][1])+Y;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(O+l.pop()+Y);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var me={c:r.c,r:r.r};if(n.sharedf[_r(u)]){var ae=n.sharedf[_r(u)];l.push(hi(ae,o,me,n,s))}else{var fe=!1;for(c=0;c!=n.arrayf.length;++c)if(A=n.arrayf[c],!(u.c<A[0].s.c||u.c>A[0].e.c)&&!(u.r<A[0].s.r||u.r>A[0].e.r)){l.push(hi(A[1],o,me,n,s)),fe=!0;break}fe||l.push(b[1])}break;case"PtgArray":l.push("{"+rme(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&he.indexOf(t[0][g][0])==-1){b=t[0][p];var te=!0;switch(b[1][0]){case 4:te=!1;case 0:x=ks(" ",b[1][1]);break;case 5:te=!1;case 1:x=ks("\r",b[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((te?x:"")+l.pop()+(te?"":x)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function ame(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,o=t.read_shift(s);if(o==65535)return[[],vi(t,e-2)];var l=Gx(t,o,r);return e!==o+s&&(a=qx(t,e-o-s,l,r)),t.l=n,[l,a]}function ime(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,o=t.read_shift(s);if(o==65535)return[[],vi(t,e-2)];var l=Gx(t,o,r);return e!==o+s&&(a=qx(t,e-o-s,l,r)),t.l=n,[l,a]}function ome(t,e,r,n){var s=t.l+e,a=Gx(t,n,r),o;return s!==t.l&&(o=qx(t,s-t.l,a,r)),[a,o]}function lme(t,e,r){var n=t.l+e,s,a=t.read_shift(2),o=Gx(t,a,r);return a==65535?[[],vi(t,e-2)]:(e!==a+2&&(s=qx(t,n-a-2,o,r)),[o,s])}function cme(t){var e;if(cA(t,t.l+6)!==65535)return[pi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Ame(t){if(t==null){var e=_t(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Lh(t);return Lh(0)}function aC(t,e,r){var n=t.l+e,s=jc(t);r.biff==2&&++t.l;var a=cme(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=ime(t,n-t.l,r);return{cell:s,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function ume(t,e,r,n,s){var a=Oh(e,r,s),o=Ame(t.v),l=_t(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var A=_t(t.bf.length),u=0;u<t.bf.length;++u)A[u]=t.bf[u];var d=Ea([a,o,l,A]);return d}function Y2(t,e,r){var n=t.read_shift(4),s=Gx(t,n,r),a=t.read_shift(4),o=a>0?qx(t,a,s,r):null;return[s,o]}var dme=Y2,Z2=Y2,hme=Y2,fme=Y2,mme={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},QQ={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},pme={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function s3(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function gme(t){var e="of:="+t.replace(kI,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function iC(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function xme(t){return t.replace(/\./,"!")}var ag={},N0={},ig=typeof Map<"u";function PI(t,e,r){var n=0,s=t.length;if(r){if(ig?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=ig?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(ig?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function eb(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(mi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=ix(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Lw(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function xh(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function bd(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){xA(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function VQ(t,e,r,n,s,a){try{n.cellNF&&(t.z=Cr[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=ns(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Cr[e]==null&&xA(mce[e]||"General",e),t.t==="e")t.w=t.w||RA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zg(t.v);else if(t.t==="d"){var o=ga(t.v);(o|0)===o?t.w=o.toString(10):t.w=Zg(o)}else{if(t.v===void 0)return"";t.w=Rh(t.v,N0)}else t.t==="d"?t.w=pl(e,ga(t.v),N0):t.w=pl(e,t.v,N0)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Dw(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Dw(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function vme(t,e,r){if(t&&t["!ref"]){var n=hn(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function yme(t,e){var r=hn(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Lr(r))}var wme=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,bme=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Nme=/<(?:\w:)?hyperlink [^>]*>/mg,Cme=/"(\w*:\w*)"/,_me=/<(?:\w:)?col\b[^>]*[\/]?>/g,Eme=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Bme=/<(?:\w:)?pageMargins[^>]*\/>/g,HQ=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Sme=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Ime=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Fme(t,e,r,n,s,a,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",u="",d=t.match(bme);d?(A=t.slice(0,d.index),u=t.slice(d.index+d[0].length)):A=u=t;var f=A.match(HQ);f?RI(f[0],l,s,r):(f=A.match(Sme))&&Tme(f[0],f[1]||"",l,s,r);var h=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=A.slice(h,h+50).match(Cme);m&&yme(l,m[1])}var p=A.match(Ime);p&&p[1]&&qme(p[1],s);var x=[];if(e.cellStyles){var g=A.match(_me);g&&Mme(x,g)}d&&zme(d[1],l,e,c,a,o);var w=u.match(Eme);w&&(l["!autofilter"]=Vme(w[0]));var b=[],k=u.match(wme);if(k)for(h=0;h!=k.length;++h)b[h]=hn(k[h].slice(k[h].indexOf('"')+1));var P=u.match(Nme);P&&Lme(l,P,n);var L=u.match(Bme);if(L&&(l["!margins"]=Ume(Br(L[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Lr(c)),e.sheetRows>0&&l["!ref"]){var E=hn(l["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Lr(E))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function kme(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Lr(t[r])+'"/>';return e+"</mergeCells>"}function RI(t,e,r,n){var s=Br(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=un(Rn(s.codeName)))}function Tme(t,e,r,n,s){RI(t.slice(0,t.indexOf(">")),r,n,s)}function jme(t,e,r,n,s){var a=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,o.codeName=vc(Fn(c))}if(t&&t["!outline"]){var A={summaryBelow:1,summaryRight:1};t["!outline"].above&&(A.summaryBelow=0),t["!outline"].left&&(A.summaryRight=0),l=(l||"")+Jt("outlinePr",null,A)}!a&&!l||(s[s.length]=Jt("sheetPr",l,o))}var Pme=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Rme=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Dme(t){var e={sheet:1};return Pme.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Rme.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=SI(t.password).toString(16).toUpperCase()),Jt("sheetProtection",null,e)}function Lme(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Br(Rn(e[s]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+un(a.location))):(a.Target="#"+un(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=hn(a.ref),c=l.s.r;c<=l.e.r;++c)for(var A=l.s.c;A<=l.e.c;++A){var u=_r({c:A,r:c});n?(t[c]||(t[c]=[]),t[c][A]||(t[c][A]={t:"z",v:void 0}),t[c][A].l=a):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=a)}}}function Ume(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Ome(t){return xh(t),Jt("pageMargins",null,t)}function Mme(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Br(e[n],!0);s.hidden&&(s.hidden=es(s.hidden));var a=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,II(s.width)),cd(s);a<=o;)t[a++]=ss(s)}}function Qme(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=Jt("col",null,eb(s,n)));return r[r.length]="</cols>",r.join("")}function Vme(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Hme(t,e,r,n){var s=typeof t.ref=="string"?t.ref:Lr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=to(s);o.s.r==o.e.r&&(o.e.r=to(e["!ref"]).e.r,s=Lr(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Jt("autoFilter",null,{ref:s})}var Kme=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function qme(t,e){e.Views||(e.Views=[{}]),(t.match(Kme)||[]).forEach(function(r,n){var s=Br(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),es(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function Gme(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Jt("sheetViews",Jt("sheetView",null,s),{})}function $me(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=RA[t.v];break;case"d":n&&n.cellDates?s=ns(t.v,-1).toISOString():(t=ss(t),t.t="n",s=""+(t.v=ga(ns(t.v)))),typeof t.z>"u"&&(t.z=Cr[14]);break;default:s=t.v;break}var l=$a("v",Fn(s)),c={r:e},A=bd(n.cellXfs,t,n);switch(A!==0&&(c.s=A),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=$a("v",""+PI(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=a&&(t.t=a,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=Jt("f",Fn(t.f),u)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Jt("c",l,c)}var zme=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=ex("v"),o=ex("f");return function(c,A,u,d,f,h){for(var m=0,p="",x=[],g=[],w=0,b=0,k=0,P="",L,E,_=0,B=0,M,F,T=0,O=0,Y=Array.isArray(h.CellXf),me,ae=[],fe=[],he=Array.isArray(A),te=[],pe={},Ie=!1,S=!!u.sheetStubs,I=c.split(e),V=0,j=I.length;V!=j;++V){p=I[V].trim();var U=p.length;if(U!==0){var G=0;e:for(m=0;m<U;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(E=Br(p.slice(G,m),!0),_=E.r!=null?parseInt(E.r,10):_+1,B=-1,u.sheetRows&&u.sheetRows<_)continue;pe={},Ie=!1,E.ht&&(Ie=!0,pe.hpt=parseFloat(E.ht),pe.hpx=q0(pe.hpt)),E.hidden=="1"&&(Ie=!0,pe.hidden=!0),E.outlineLevel!=null&&(Ie=!0,pe.level=+E.outlineLevel),Ie&&(te[_-1]=pe)}break;case"<":G=m;break}if(G>=m)break;if(E=Br(p.slice(G,m),!0),_=E.r!=null?parseInt(E.r,10):_+1,B=-1,!(u.sheetRows&&u.sheetRows<_)){d.s.r>_-1&&(d.s.r=_-1),d.e.r<_-1&&(d.e.r=_-1),u&&u.cellStyles&&(pe={},Ie=!1,E.ht&&(Ie=!0,pe.hpt=parseFloat(E.ht),pe.hpx=q0(pe.hpt)),E.hidden=="1"&&(Ie=!0,pe.hidden=!0),E.outlineLevel!=null&&(Ie=!0,pe.level=+E.outlineLevel),Ie&&(te[_-1]=pe)),x=p.slice(m).split(t);for(var R=0;R!=x.length&&x[R].trim().charAt(0)=="<";++R);for(x=x.slice(R),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(g=p.match(r),w=m,b=0,k=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,g!=null&&g.length===2){for(w=0,P=g[1],b=0;b!=P.length&&!((k=P.charCodeAt(b)-64)<1||k>26);++b)w=26*w+k;--w,B=w}else++B;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,E=Br(p.slice(0,b),!0),E.r||(E.r=_r({r:_-1,c:B})),P=p.slice(b),L={t:""},(g=P.match(a))!=null&&g[1]!==""&&(L.v=un(g[1])),u.cellFormula){if((g=P.match(o))!=null&&g[1]!==""){if(L.f=un(Rn(g[1])).replace(/\r\n/g,`
`),u.xlfn||(L.f=e3(L.f)),g[0].indexOf('t="array"')>-1)L.F=(P.match(s)||[])[1],L.F.indexOf(":")>-1&&ae.push([hn(L.F),L.F]);else if(g[0].indexOf('t="shared"')>-1){F=Br(g[0]);var X=un(Rn(g[1]));u.xlfn||(X=e3(X)),fe[parseInt(F.si,10)]=[F,X,E.r]}}else(g=P.match(/<f[^>]*\/>/))&&(F=Br(g[0]),fe[F.si]&&(L.f=Kfe(fe[F.si][1],fe[F.si][2],E.r)));var se=bs(E.r);for(b=0;b<ae.length;++b)se.r>=ae[b][0].s.r&&se.r<=ae[b][0].e.r&&se.c>=ae[b][0].s.c&&se.c<=ae[b][0].e.c&&(L.F=ae[b][1])}if(E.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(S)L.t="z";else continue;else L.t=E.t||"n";switch(d.s.c>B&&(d.s.c=B),d.e.c<B&&(d.e.c=B),L.t){case"n":if(L.v==""||L.v==null){if(!S)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!S)continue;L.t="z"}else M=ag[parseInt(L.v,10)],L.v=M.t,L.r=M.r,u.cellHTML&&(L.h=M.h);break;case"str":L.t="s",L.v=L.v!=null?Rn(L.v):"",u.cellHTML&&(L.h=hI(L.v));break;case"inlineStr":g=P.match(n),L.t="s",g!=null&&(M=BI(g[1]))?(L.v=M.t,u.cellHTML&&(L.h=M.h)):L.v="";break;case"b":L.v=es(L.v);break;case"d":u.cellDates?L.v=ns(L.v,1):(L.v=ga(ns(L.v,1)),L.t="n");break;case"e":(!u||u.cellText!==!1)&&(L.w=L.v),L.v=q8[L.v];break}if(T=O=0,me=null,Y&&E.s!==void 0&&(me=h.CellXf[E.s],me!=null&&(me.numFmtId!=null&&(T=me.numFmtId),u.cellStyles&&me.fillId!=null&&(O=me.fillId))),VQ(L,T,O,u,f,h),u.cellDates&&Y&&L.t=="n"&&cm(Cr[T])&&(L.t="d",L.v=J2(L.v)),E.cm&&u.xlmeta){var ye=(u.xlmeta.Cell||[])[+E.cm-1];ye&&ye.type=="XLDAPR"&&(L.D=!0)}if(he){var z=bs(E.r);A[z.r]||(A[z.r]=[]),A[z.r][z.c]=L}else A[E.r]=L}}}}te.length>0&&(A["!rows"]=te)}}();function Wme(t,e,r,n){var s=[],a=[],o=hn(t["!ref"]),l="",c,A="",u=[],d=0,f=0,h=t["!rows"],m=Array.isArray(t),p={r:A},x,g=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=ws(f);for(d=o.s.r;d<=o.e.r;++d){for(a=[],A=$s(d),f=o.s.c;f<=o.e.c;++f){c=u[f]+A;var w=m?(t[d]||[])[f]:t[c];w!==void 0&&(l=$me(w,c,t,e))!=null&&a.push(l)}(a.length>0||h&&h[d])&&(p={r:A},h&&h[d]&&(x=h[d],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=ox(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),s[s.length]=Jt("row",a.join(""),p))}if(h)for(;d<h.length;++d)h&&h[d]&&(p={r:d+1},x=h[d],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=ox(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level),s[s.length]=Jt("row","",p));return s.join("")}function KQ(t,e,r,n){var s=[Ws,Jt("worksheet",null,{xmlns:Zh[0],"xmlns:r":ha.r})],a=r.SheetNames[t],o=0,l="",c=r.Sheets[a];c==null&&(c={});var A=c["!ref"]||"A1",u=hn(A);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+A+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),A=Lr(u)}n||(n={}),c["!comments"]=[];var d=[];jme(c,r,t,e,s),s[s.length]=Jt("dimension",null,{ref:A}),s[s.length]=Gme(c,e,t,r),e.sheetFormat&&(s[s.length]=Jt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Qme(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Wme(c,e),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=Dme(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=Hme(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=kme(c["!merges"]));var f=-1,h,m=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Bn(n,-1,Fn(p[1].Target).replace(/#.*$/,""),$r.HLINK),h["r:id"]="rId"+m),(f=p[1].Target.indexOf("#"))>-1&&(h.location=Fn(p[1].Target.slice(f+1))),p[1].Tooltip&&(h.tooltip=Fn(p[1].Tooltip)),s[s.length]=Jt("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Ome(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=$a("ignoredErrors",Jt("ignoredError",null,{numberStoredAsText:1,sqref:A}))),d.length>0&&(m=Bn(n,-1,"../drawings/drawing"+(t+1)+".xml",$r.DRAW),s[s.length]=Jt("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=d),c["!comments"].length>0&&(m=Bn(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",$r.VML),s[s.length]=Jt("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Jme(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function Xme(t,e,r){var n=_t(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=ox(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var A={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var d=-1,f=-1,h=u<<10;h<u+1<<10;++h){A.c=h;var m=Array.isArray(r)?(r[A.r]||[])[A.c]:r[_r(A)];m&&(d<0&&(d=h),f=h)}d<0||(++l,n.write_shift(4,d),n.write_shift(4,f))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function Yme(t,e,r,n){var s=Xme(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&Dt(t,0,s)}var Zme=nf,epe=dm;function tpe(){}function rpe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=aAe(t),r}function npe(t,e,r){r==null&&(r=_t(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return jw({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),M8(t,r),r.slice(0,r.l)}function spe(t){var e=gl(t);return[e]}function ape(t,e,r){return r==null&&(r=_t(8)),ef(e,r)}function ipe(t){var e=tf(t);return[e]}function ope(t,e,r){return r==null&&(r=_t(4)),rf(e,r)}function lpe(t){var e=gl(t),r=t.read_shift(1);return[e,r,"b"]}function cpe(t,e,r){return r==null&&(r=_t(9)),ef(e,r),r.write_shift(1,t.v?1:0),r}function Ape(t){var e=tf(t),r=t.read_shift(1);return[e,r,"b"]}function upe(t,e,r){return r==null&&(r=_t(5)),rf(e,r),r.write_shift(1,t.v?1:0),r}function dpe(t){var e=gl(t),r=t.read_shift(1);return[e,r,"e"]}function hpe(t,e,r){return r==null&&(r=_t(9)),ef(e,r),r.write_shift(1,t.v),r}function fpe(t){var e=tf(t),r=t.read_shift(1);return[e,r,"e"]}function mpe(t,e,r){return r==null&&(r=_t(8)),rf(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ppe(t){var e=gl(t),r=t.read_shift(4);return[e,r,"s"]}function gpe(t,e,r){return r==null&&(r=_t(12)),ef(e,r),r.write_shift(4,e.v),r}function xpe(t){var e=tf(t),r=t.read_shift(4);return[e,r,"s"]}function vpe(t,e,r){return r==null&&(r=_t(8)),rf(e,r),r.write_shift(4,e.v),r}function ype(t){var e=gl(t),r=pi(t);return[e,r,"n"]}function wpe(t,e,r){return r==null&&(r=_t(16)),ef(e,r),Lh(t.v,r),r}function qQ(t){var e=tf(t),r=pi(t);return[e,r,"n"]}function bpe(t,e,r){return r==null&&(r=_t(12)),rf(e,r),Lh(t.v,r),r}function Npe(t){var e=gl(t),r=bI(t);return[e,r,"n"]}function Cpe(t,e,r){return r==null&&(r=_t(12)),ef(e,r),Q8(t.v,r),r}function _pe(t){var e=tf(t),r=bI(t);return[e,r,"n"]}function Epe(t,e,r){return r==null&&(r=_t(8)),rf(e,r),Q8(t.v,r),r}function Bpe(t){var e=gl(t),r=vI(t);return[e,r,"is"]}function Spe(t){var e=gl(t),r=gi(t);return[e,r,"str"]}function Ipe(t,e,r){return r==null&&(r=_t(12+4*t.v.length)),ef(e,r),Ba(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Fpe(t){var e=tf(t),r=gi(t);return[e,r,"str"]}function kpe(t,e,r){return r==null&&(r=_t(8+4*t.v.length)),rf(e,r),Ba(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Tpe(t,e,r){var n=t.l+e,s=gl(t);s.r=r["!row"];var a=t.read_shift(1),o=[s,a,"b"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=hi(l,null,s,r.supbooks,r)}else t.l=n;return o}function jpe(t,e,r){var n=t.l+e,s=gl(t);s.r=r["!row"];var a=t.read_shift(1),o=[s,a,"e"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=hi(l,null,s,r.supbooks,r)}else t.l=n;return o}function Ppe(t,e,r){var n=t.l+e,s=gl(t);s.r=r["!row"];var a=pi(t),o=[s,a,"n"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=hi(l,null,s,r.supbooks,r)}else t.l=n;return o}function Rpe(t,e,r){var n=t.l+e,s=gl(t);s.r=r["!row"];var a=gi(t),o=[s,a,"str"];if(r.cellFormula){t.l+=2;var l=Z2(t,n-t.l,r);o[3]=hi(l,null,s,r.supbooks,r)}else t.l=n;return o}var Dpe=nf,Lpe=dm;function Upe(t,e){return e==null&&(e=_t(4)),e.write_shift(4,t),e}function Ope(t,e){var r=t.l+e,n=nf(t),s=yI(t),a=gi(t),o=gi(t),l=gi(t);t.l=r;var c={rfx:n,relId:s,loc:a,display:l};return o&&(c.Tooltip=o),c}function Mpe(t,e){var r=_t(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));dm({s:bs(t[0]),e:bs(t[0])},r),wI("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Ba(s||"",r),Ba(t[1].Tooltip||"",r),Ba("",r),r.slice(0,r.l)}function Qpe(){}function Vpe(t,e,r){var n=t.l+e,s=V8(t),a=t.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=dme(t,n-t.l,r);o[1]=l}else t.l=n;return o}function Hpe(t,e,r){var n=t.l+e,s=nf(t),a=[s];if(r.cellFormula){var o=fme(t,n-t.l,r);a[1]=o,t.l=n}else t.l=n;return a}function Kpe(t,e,r){r==null&&(r=_t(18));var n=eb(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var GQ=["left","right","top","bottom","header","footer"];function qpe(t){var e={};return GQ.forEach(function(r){e[r]=pi(t)}),e}function Gpe(t,e){return e==null&&(e=_t(6*8)),xh(t),GQ.forEach(function(r){Lh(t[r],e)}),e}function $pe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function zpe(t,e,r){r==null&&(r=_t(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Wpe(t){var e=_t(24);return e.write_shift(4,4),e.write_shift(4,1),dm(t,e),e}function Jpe(t,e){return e==null&&(e=_t(16*4+2)),e.write_shift(2,t.password?SI(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Xpe(){}function Ype(){}function Zpe(t,e,r,n,s,a,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},A,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,f=!1,h,m,p,x,g,w,b,k,P,L=[];l.biff=12,l["!row"]=0;var E=0,_=!1,B=[],M={},F=l.supbooks||s.supbooks||[[]];if(F.sharedf=M,F.arrayf=B,F.SheetNames=s.SheetNames||s.Sheets.map(function(he){return he.name}),!l.supbooks&&(l.supbooks=F,s.Names))for(var T=0;T<s.Names.length;++T)F[0][T+1]=s.Names[T];var O=[],Y=[],me=!1;lx[16]={n:"BrtShortReal",f:qQ};var ae;if(PA(t,function(te,pe,Ie){if(!f)switch(Ie){case 148:A=te;break;case 0:h=te,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),k=$s(x=h.r),l["!row"]=h.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=q0(te.hpt)),Y[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:te[2]},te[2]){case"n":m.v=te[1];break;case"s":b=ag[te[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!te[1];break;case"e":m.v=te[1],l.cellText!==!1&&(m.w=RA[m.v]);break;case"str":m.t="s",m.v=te[1];break;case"is":m.t="s",m.v=te[1].t;break}if((p=o.CellXf[te[0].iStyleRef])&&VQ(m,p.numFmtId,null,l,a,o),g=te[0].c==-1?g+1:te[0].c,l.dense?(c[x]||(c[x]=[]),c[x][g]=m):c[ws(g)+k]=m,l.cellFormula){for(_=!1,E=0;E<B.length;++E){var S=B[E];h.r>=S[0].s.r&&h.r<=S[0].e.r&&g>=S[0].s.c&&g<=S[0].e.c&&(m.F=Lr(S[0]),_=!0)}!_&&te.length>3&&(m.f=te[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),l.cellDates&&p&&m.t=="n"&&cm(Cr[p.numFmtId])){var I=ah(m.v);I&&(m.t="d",m.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 1:case 12:if(!l.sheetStubs||d)break;m={t:"z",v:void 0},g=te[0].c==-1?g+1:te[0].c,l.dense?(c[x]||(c[x]=[]),c[x][g]=m):c[ws(g)+k]=m,u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 176:L.push(te);break;case 49:ae=((l.xlmeta||{}).Cell||[])[te-1];break;case 494:var V=n["!id"][te.relId];for(V?(te.Target=V.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=V):te.relId==""&&(te.Target="#"+te.loc),x=te.rfx.s.r;x<=te.rfx.e.r;++x)for(g=te.rfx.s.c;g<=te.rfx.e.c;++g)l.dense?(c[x]||(c[x]=[]),c[x][g]||(c[x][g]={t:"z",v:void 0}),c[x][g].l=te):(w=_r({c:g,r:x}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=te);break;case 426:if(!l.cellFormula)break;B.push(te),P=l.dense?c[x][g]:c[ws(g)+k],P.f=hi(te[1],u,{r:h.r,c:g},F,l),P.F=Lr(te[0]);break;case 427:if(!l.cellFormula)break;M[_r(te[0].s)]=te[1],P=l.dense?c[x][g]:c[ws(g)+k],P.f=hi(te[1],u,{r:h.r,c:g},F,l);break;case 60:if(!l.cellStyles)break;for(;te.e>=te.s;)O[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},me||(me=!0,II(te.w/256)),cd(O[te.e+1]);break;case 161:c["!autofilter"]={ref:Lr(te)};break;case 476:c["!margins"]=te;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),te.name&&(s.Sheets[r].CodeName=te.name),(te.above||te.left)&&(c["!outline"]={above:te.above,left:te.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),te.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!pe.T){if(!d||l.WTF)throw new Error("Unexpected record 0x"+Ie.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(c["!ref"]=Lr(A||u)),l.sheetRows&&c["!ref"]){var fe=hn(c["!ref"]);l.sheetRows<=+fe.e.r&&(fe.e.r=l.sheetRows-1,fe.e.r>u.e.r&&(fe.e.r=u.e.r),fe.e.r<fe.s.r&&(fe.s.r=fe.e.r),fe.e.c>u.e.c&&(fe.e.c=u.e.c),fe.e.c<fe.s.c&&(fe.s.c=fe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Lr(fe))}return L.length>0&&(c["!merges"]=L),O.length>0&&(c["!cols"]=O),Y.length>0&&(c["!rows"]=Y),c}function ege(t,e,r,n,s,a,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=ss(e),e.z=e.z||Cr[14],e.v=ga(ns(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=bd(s.cellXfs,e,s),e.l&&a["!links"].push([_r(c),e.l]),e.c&&a["!comments"].push([_r(c),e.c]),e.t){case"s":case"str":return s.bookSST?(l=PI(s.Strings,e.v,s.revStrings),c.t="s",c.v=l,o?Dt(t,18,vpe(e,c)):Dt(t,7,gpe(e,c))):(c.t="str",o?Dt(t,17,kpe(e,c)):Dt(t,6,Ipe(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Dt(t,13,Epe(e,c)):Dt(t,2,Cpe(e,c)):o?Dt(t,16,bpe(e,c)):Dt(t,5,wpe(e,c)),!0;case"b":return c.t="b",o?Dt(t,15,upe(e,c)):Dt(t,4,cpe(e,c)),!0;case"e":return c.t="e",o?Dt(t,14,mpe(e,c)):Dt(t,3,hpe(e,c)),!0}return o?Dt(t,12,ope(e,c)):Dt(t,1,ape(e,c)),!0}function tge(t,e,r,n){var s=hn(e["!ref"]||"A1"),a,o="",l=[];Dt(t,145);var c=Array.isArray(e),A=s.e.r;e["!rows"]&&(A=Math.max(s.e.r,e["!rows"].length-1));for(var u=s.s.r;u<=A;++u){o=$s(u),Yme(t,e,s,u);var d=!1;if(u<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=ws(f)),a=l[f]+o;var h=c?(e[u]||[])[f]:e[a];if(!h){d=!1;continue}d=ege(t,h,u,f,n,e,d)}}Dt(t,146)}function rge(t,e){!e||!e["!merges"]||(Dt(t,177,Upe(e["!merges"].length)),e["!merges"].forEach(function(r){Dt(t,176,Lpe(r))}),Dt(t,178))}function nge(t,e){!e||!e["!cols"]||(Dt(t,390),e["!cols"].forEach(function(r,n){r&&Dt(t,60,Kpe(n,r))}),Dt(t,391))}function sge(t,e){!e||!e["!ref"]||(Dt(t,648),Dt(t,649,Wpe(hn(e["!ref"]))),Dt(t,650))}function age(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Bn(r,-1,n[1].Target.replace(/#.*$/,""),$r.HLINK);Dt(t,494,Mpe(n,s))}}),delete e["!links"]}function ige(t,e,r,n){if(e["!comments"].length>0){var s=Bn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$r.VML);Dt(t,551,wI("rId"+s)),e["!legacy"]=s}}function oge(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:Lr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=to(a);l.s.r==l.e.r&&(l.e.r=to(e["!ref"]).e.r,a=Lr(l));for(var c=0;c<o.length;++c){var A=o[c];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==n){A.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Dt(t,161,dm(hn(a))),Dt(t,162)}}function lge(t,e,r){Dt(t,133),Dt(t,137,zpe(e,r)),Dt(t,138),Dt(t,134)}function cge(t,e){e["!protect"]&&Dt(t,535,Jpe(e["!protect"]))}function Age(t,e,r,n){var s=eo(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=hn(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Dt(s,129),(r.vbaraw||o["!outline"])&&Dt(s,147,npe(l,o["!outline"])),Dt(s,148,epe(c)),lge(s,o,r.Workbook),nge(s,o),tge(s,o,t,e),cge(s,o),oge(s,o,r,t),rge(s,o),age(s,o,n),o["!margins"]&&Dt(s,476,Gpe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&sge(s,o),ige(s,o,t,n),Dt(s,130),s.end()}function uge(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var s=un((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function dge(t,e,r,n,s,a){var o=a||{"!type":"chart"};if(!t)return a;var l=0,c=0,A="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=uge(d);u.s.r=u.s.c=0,u.e.c=l,A=ws(l),f[0].forEach(function(h,m){o[A+$s(m)]={t:"n",v:h,z:f[1]},c=m}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Lr(u)),o}function hge(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(HQ);return l&&RI(l[0],a,s,r),(o=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function fge(t,e){t.l+=10;var r=gi(t);return{name:r}}function mge(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return PA(t,function(c,A,u){switch(u){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var DI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gge=[],xge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function a3(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=es(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function i3(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=es(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function $Q(t){i3(t.WBProps,DI),i3(t.CalcPr,xge),a3(t.WBView,pge),a3(t.Sheets,gge),N0.date1904=es(t.WBProps.date1904)}function vge(t){return!t.Workbook||!t.Workbook.WBProps?"false":es(t.Workbook.WBProps.date1904)?"true":"false"}var yge="][*?/\\".split("");function zQ(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yge.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function wge(t,e,r){t.forEach(function(n,s){zQ(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[s]&&e[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function bge(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];wge(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)vme(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Nge=/<\w+:workbook/;function Cge(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},o=0;if(t.replace(yi,function(c,A){var u=Br(c);switch(Tc(u[0])){case"<?xml":break;case"<workbook":c.match(Nge)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":DI.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=es(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=Rn(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=un(Rn(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Rn(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),es(u.hidden||"0")&&(a.Hidden=!0),o=A+c.length;break;case"</definedName>":a.Ref=un(Rn(t.slice(o,A))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Zh.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $Q(r),r}function WQ(t){var e=[Ws];e[e.length]=Jt("workbook",null,{xmlns:Zh[0],"xmlns:r":ha.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(DI.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Jt("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var o={name:Fn(t.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Jt("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=Jt("definedName",Fn(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function _ge(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=IE(t),r.name=gi(t),r}function Ege(t,e){return e||(e=_t(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),wI(t.strRelID,e),Ba(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Bge(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?gi(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Sge(t,e){e||(e=_t(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),M8(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Ige(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Fge(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=iAe(t),o=hme(t,0,r),l=yI(t);t.l=n;var c={Name:a,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function kge(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],lx[16]={n:"BrtFRTArchID$",f:Ige},PA(t,function(c,A,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=hi(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!A.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),$Q(r),r.Names=a,r.supbooks=o,r}function Tge(t,e){Dt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Dt(t,156,Ege(s))}Dt(t,144)}function jge(t,e){e||(e=_t(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ba("SheetJS",e),Ba(Ew.version,e),Ba(Ew.version,e),Ba("7262",e),e.length>e.l?e.slice(0,e.l):e}function Pge(t,e){e||(e=_t(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Rge(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Dt(t,135),Dt(t,158,Pge(s)),Dt(t,136))}}function Dge(t,e){var r=eo();return Dt(r,131),Dt(r,128,jge()),Dt(r,153,Sge(t.Workbook&&t.Workbook.WBProps||null)),Rge(r,t),Tge(r,t),Dt(r,132),r.end()}function Lge(t,e,r){return e.slice(-4)===".bin"?kge(t,r):Cge(t,r)}function Uge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Zpe(t,n,r,s,a,o,l):Fme(t,n,r,s,a,o,l)}function Oge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?mge(t,n,r,s,a):hge(t,n,r,s,a)}function Mge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Vfe():Hfe()}function Qge(t,e,r,n,s,a,o,l){return e.slice(-4)===".bin"?Mfe():Qfe()}function Vge(t,e,r,n){return e.slice(-4)===".bin"?Lhe(t,r,n):_he(t,r,n)}function Hge(t,e,r){return IQ(t,r)}function Kge(t,e,r){return e.slice(-4)===".bin"?Kde(t,r):Qde(t,r)}function qge(t,e,r){return e.slice(-4)===".bin"?Rfe(t,r):Efe(t,r)}function Gge(t,e,r){return e.slice(-4)===".bin"?Nfe(t):wfe(t)}function $ge(t,e,r,n){return r.slice(-4)===".bin"?Cfe(t,e,r,n):void 0}function zge(t,e,r){return e.slice(-4)===".bin"?xfe(t,e,r):yfe(t,e,r)}function Wge(t,e,r){return(e.slice(-4)===".bin"?Dge:WQ)(t)}function Jge(t,e,r,n,s){return(e.slice(-4)===".bin"?Age:KQ)(t,r,n,s)}function Xge(t,e,r){return(e.slice(-4)===".bin"?$he:BQ)(t,r)}function Yge(t,e,r){return(e.slice(-4)===".bin"?$de:vQ)(t,r)}function Zge(t,e,r){return(e.slice(-4)===".bin"?Dfe:TQ)(t)}function exe(t){return(t.slice(-4)===".bin"?vfe:FQ)()}var JQ=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,XQ=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bl(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(JQ),a,o,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(XQ),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function txe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(JQ),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(XQ),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}var og;function rxe(t,e){var r=og[t]||un(t);return r==="General"?Rh(e):pl(r,e)}function nxe(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=es(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=ns(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[un(e)]=s}function sxe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||RA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zg(t.v):t.w=Rh(t.v):t.w=rxe(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=og[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&cm(n)){var s=ah(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function axe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=ghe[n.Pattern]||n.Pattern)}t[e.ID]=e}function ixe(t,e,r,n,s,a,o,l,c,A){var u="General",d=n.StyleID,f={};A=A||{};var h=[],m=0;for(d===void 0&&l&&(d=l.StyleID),d===void 0&&o&&(d=o.StyleID);a[d]!==void 0&&(a[d].nf&&(u=a[d].nf),a[d].Interior&&h.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=es(t);break;case"String":n.t="s",n.r=NP(un(t)),n.v=t.indexOf("<")>-1?un(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(ns(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=un(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=q8[t],A.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=NP(e||t));break}if(sxe(n,u,A),A.cellFormula!==!1)if(n.Formula){var p=un(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=b0(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=b0("RC:RC",s):n.ArrayRange&&(n.F=b0(n.ArrayRange,s),c.push([hn(n.F),n.F]))}else for(m=0;m<c.length;++m)s.r>=c[m][0].s.r&&s.r<=c[m][0].e.r&&s.c>=c[m][0].s.c&&s.c<=c[m][0].e.c&&(n.F=c[m][1]);A.cellStyles&&(h.forEach(function(x){!f.patternType&&x.patternType&&(f.patternType=x.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function oxe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function oC(t,e){var r=e||{};Am();var n=Cp(fI(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Rn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=ss(r);return o.type="string",K0.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(de){s.indexOf("<"+de)>=0&&(a=!0)}),a)return Gxe(n,r);og={"General Number":"General","General Date":Cr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Cr[15],"Short Date":Cr[14],"Long Time":Cr[19],"Medium Time":Cr[18],"Short Time":Cr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Cr[2],Standard:Cr[4],Percent:Cr[10],Scientific:Cr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],A,u={},d=[],f=r.dense?[]:{},h="",m={},p={},x=Bl('<Data ss:Type="String">'),g=0,w=0,b=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},L={},E="",_=0,B=[],M={},F={},T=0,O=[],Y=[],me={},ae=[],fe,he=!1,te=[],pe=[],Ie={},S=0,I=0,V={Sheets:[],WBProps:{date1904:!1}},j={};rx.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var U="";l=rx.exec(n);)switch(l[3]=(U=l[3]).toLowerCase()){case"data":if(U=="data"){if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?ixe(n.slice(g,l.index),E,x,c[c.length-1][0]=="comment"?me:m,{c:w,r:b},P,ae[w],p,te,r):(E="",x=Bl(l[0]),g=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Y.length>0&&(m.c=Y),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(f[b]||(f[b]=[]),f[b][w]=m):f[ws(w)+$s(b)]=m),m.HRef&&(m.l={Target:un(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(S=w+(parseInt(m.MergeAcross,10)|0),I=b+(parseInt(m.MergeDown,10)|0),B.push({s:{c:w,r:b},e:{c:S,r:I}})),!r.sheetStubs)m.MergeAcross?w=S+1:++w;else if(m.MergeAcross||m.MergeDown){for(var G=w;G<=S;++G)for(var R=b;R<=I;++R)(G>w||R>b)&&(r.dense?(f[R]||(f[R]=[]),f[R][G]={t:"z"}):f[ws(G)+$s(R)]={t:"z"});w=S+1}else++w;else m=txe(l[0]),m.Index&&(w=+m.Index-1),w<k.s.c&&(k.s.c=w),w>k.e.c&&(k.e.c=w),l[0].slice(-2)==="/>"&&++w,Y=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<k.s.r&&(k.s.r=b),b>k.e.r&&(k.e.r=b),l[0].slice(-2)==="/>"&&(p=Bl(l[0]),p.Index&&(b=+p.Index-1)),w=0,++b):(p=Bl(l[0]),p.Index&&(b=+p.Index-1),Ie={},(p.AutoFitHeight=="0"||p.Height)&&(Ie.hpx=parseInt(p.Height,10),Ie.hpt=ox(Ie.hpx),pe[b]=Ie),p.Hidden=="1"&&(Ie.hidden=!0,pe[b]=Ie));break;case"worksheet":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));d.push(h),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(f["!ref"]=Lr(k),r.sheetRows&&r.sheetRows<=k.e.r&&(f["!fullref"]=f["!ref"],k.e.r=r.sheetRows-1,f["!ref"]=Lr(k))),B.length&&(f["!merges"]=B),ae.length>0&&(f["!cols"]=ae),pe.length>0&&(f["!rows"]=pe),u[h]=f}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=w=0,c.push([l[3],!1]),A=Bl(l[0]),h=un(A.Name),f=r.dense?[]:{},B=[],te=[],pe=[],j={name:h,Hidden:0},V.Sheets.push(j);break;case"table":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ae=[],he=!1}break;case"style":l[1]==="/"?axe(P,L,r):L=Bl(l[0]);break;case"numberformat":L.nf=un(Bl(l[0]).Format||"General"),og[L.nf]&&(L.nf=og[L.nf]);for(var X=0;X!=392&&Cr[X]!=L.nf;++X);if(X==392){for(X=57;X!=392;++X)if(Cr[X]==null){xA(L.nf,X);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(fe=Bl(l[0]),fe.Hidden&&(fe.hidden=!0,delete fe.Hidden),fe.Width&&(fe.wpx=parseInt(fe.Width,10)),!he&&fe.wpx>10){he=!0,mi=_Q;for(var se=0;se<ae.length;++se)ae[se]&&cd(ae[se])}he&&cd(fe),ae[fe.Index-1||ae.length]=fe;for(var ye=0;ye<+fe.Span;++ye)ae[ae.length]=ss(fe);break;case"namedrange":if(l[1]==="/")break;V.Names||(V.Names=[]);var z=Br(l[0]),Me={Name:z.Name,Ref:b0(z.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(Me.Sheet=V.Sheets.length-1),V.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?E+=n.slice(_,l.index):_=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=Bl(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?kAe(M,U,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));oxe(me),Y.push(me)}else c.push([l[3],!1]),A=Bl(l[0]),me={a:A.Author};break;case"autofilter":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var re=Bl(l[0]);f["!autofilter"]={ref:b0(re.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return u3(n,r);var W=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:W=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:W=!1}break;case"excelworkbook":switch(l[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:W=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:W=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else T=l.index+l[0].length;break;case"header":f["!margins"]||xh(f["!margins"]={},"xlml"),isNaN(+Br(l[0]).Margin)||(f["!margins"].header=+Br(l[0]).Margin);break;case"footer":f["!margins"]||xh(f["!margins"]={},"xlml"),isNaN(+Br(l[0]).Margin)||(f["!margins"].footer=+Br(l[0]).Margin);break;case"pagemargins":var q=Br(l[0]);f["!margins"]||xh(f["!margins"]={},"xlml"),isNaN(+q.Top)||(f["!margins"].top=+q.Top),isNaN(+q.Left)||(f["!margins"].left=+q.Left),isNaN(+q.Right)||(f["!margins"].right=+q.Right),isNaN(+q.Bottom)||(f["!margins"].bottom=+q.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:W=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:W=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:W=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:W=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:W=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:W=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:W=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:W=!1}break;case"smarttags":break;default:W=!1;break}if(W||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?nxe(F,U,O,n.slice(T,l.index)):(O=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var oe={};return!r.bookSheets&&!r.bookProps&&(oe.Sheets=u),oe.SheetNames=d,oe.Workbook=V,oe.SSF=ss(Cr),oe.Props=M,oe.Custprops=F,oe}function DE(t,e){switch(UI(e=e||{}),e.type||"base64"){case"base64":return oC(To(t),e);case"binary":case"buffer":case"file":return oC(t,e);case"array":return oC(yd(t),e)}}function lxe(t,e){var r=[];return t.Props&&r.push(TAe(t.Props,e)),t.Custprops&&r.push(jAe(t.Props,t.Custprops)),r.join("")}function cxe(){return""}function Axe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push(Jt("NumberFormat",null,{"ss:Format":Fn(Cr[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Jt("Style",a.join(""),o))}),Jt("Styles",r.join(""))}function YQ(t){return Jt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+TI(t.Ref,{r:0,c:0})})}function uxe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(YQ(s)))}return Jt("Names",r.join(""))}function dxe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(YQ(l)))}return a.join("")}function hxe(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(Jt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(Jt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(Jt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Jt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push($a("ProtectContents","True")),t["!protect"].objects&&s.push($a("ProtectObjects","True")),t["!protect"].scenarios&&s.push($a("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push($a("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push($a("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Jt("WorksheetOptions",s.join(""),{xmlns:wo.x})}function fxe(t){return t.map(function(e){var r=Rce(e.t||""),n=Jt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Jt("Comment",n,{"ss:Author":e.a})}).join("")}function mxe(t,e,r,n,s,a,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Fn(TI(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=bs(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Fn(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Fn(t.l.Tooltip))),r["!merges"])for(var A=r["!merges"],u=0;u!=A.length;++u)A[u].s.c!=o.c||A[u].s.r!=o.r||(A[u].e.c>A[u].s.c&&(l["ss:MergeAcross"]=A[u].e.c-A[u].s.c),A[u].e.r>A[u].s.r&&(l["ss:MergeDown"]=A[u].e.r-A[u].s.r));var d="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",f=String(t.v);break;case"b":d="Boolean",f=t.v?"1":"0";break;case"e":d="Error",f=RA[t.v];break;case"d":d="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Cr[14]);break;case"s":d="String",f=Pce(t.v||"");break}var h=bd(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?f:"",p=t.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=fxe(t.c)),Jt("Cell",p,l)}function pxe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=q0(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gxe(t,e,r,n){if(!t["!ref"])return"";var s=hn(t["!ref"]),a=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,g){cd(x);var w=!!x.width,b=eb(g,x),k={"ss:Index":g+1};w&&(k["ss:Width"]=ax(b.width)),x.hidden&&(k["ss:Hidden"]="1"),l.push(Jt("Column",null,k))});for(var c=Array.isArray(t),A=s.s.r;A<=s.e.r;++A){for(var u=[pxe(A,(t["!rows"]||[])[A])],d=s.s.c;d<=s.e.c;++d){var f=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>d)&&!(a[o].s.r>A)&&!(a[o].e.c<d)&&!(a[o].e.r<A)){(a[o].s.c!=d||a[o].s.r!=A)&&(f=!0);break}if(!f){var h={r:A,c:d},m=_r(h),p=c?(t[A]||[])[d]:t[m];u.push(mxe(p,m,t,e,r,n,h))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function xxe(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],o=a?dxe(a,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?gxe(a,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(hxe(a,e,t,r)),n.join("")}function vxe(t,e){e||(e={}),t.SSF||(t.SSF=ss(Cr)),t.SSF&&(Am(),$2(t.SSF),e.revssf=W2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],bd(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(lxe(t,e)),r.push(cxe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Jt("Worksheet",xxe(n,e,t),{"ss:Name":Fn(t.SheetNames[n])}));return r[2]=Axe(t,e),r[3]=uxe(t),Ws+Jt("Workbook",r.join(""),{xmlns:wo.ss,"xmlns:o":wo.o,"xmlns:x":wo.x,"xmlns:ss":wo.ss,"xmlns:dt":wo.dt,"xmlns:html":wo.html})}function yxe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=uAe(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=dAe(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var wxe=[60,1084,2066,2165,2175];function bxe(t,e,r,n,s){var a=n,o=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=a;for(var c=cA(r,r.l),A=LE[c],u=0;A!=null&&wxe.indexOf(c)>-1;)a=cA(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+a),o.push(l),r.l+=4+a,A=LE[c=cA(r,r.l)];var d=Ea(o);qa(d,0);var f=0;d.lens=[];for(var h=0;h<o.length;++h)d.lens.push(f),f+=o[h].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,s)}function cc(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Cr[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||RA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zg(t.v):t.w=Rh(t.v):t.w=pl(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&cm(Cr[n]||String(n))){var s=ah(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function j1(t,e,r){return{v:t,ixfe:e,t:r}}function Nxe(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},o={},l=null,c=[],A="",u={},d,f="",h,m,p,x,g={},w=[],b,k,P=[],L=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},B=function(ge){return ge<8?mh[ge]:ge<64&&L[ge-8]||mh[ge]},M=function(ge,K,_e){var Oe=K.XF.data;if(!(!Oe||!Oe.patternType||!_e||!_e.cellStyles)){K.s={},K.s.patternType=Oe.patternType;var Ve;(Ve=sx(B(Oe.icvFore)))&&(K.s.fgColor={rgb:Ve}),(Ve=sx(B(Oe.icvBack)))&&(K.s.bgColor={rgb:Ve})}},F=function(ge,K,_e){if(!(Ie>1)&&!(_e.sheetRows&&ge.r>=_e.sheetRows)){if(_e.cellStyles&&K.XF&&K.XF.data&&M(ge,K,_e),delete K.ixfe,delete K.XF,d=ge,f=_r(ge),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ge.r<o.s.r&&(o.s.r=ge.r),ge.c<o.s.c&&(o.s.c=ge.c),ge.r+1>o.e.r&&(o.e.r=ge.r+1),ge.c+1>o.e.c&&(o.e.c=ge.c+1),_e.cellFormula&&K.f){for(var Oe=0;Oe<w.length;++Oe)if(!(w[Oe][0].s.c>ge.c||w[Oe][0].s.r>ge.r)&&!(w[Oe][0].e.c<ge.c||w[Oe][0].e.r<ge.r)){K.F=Lr(w[Oe][0]),(w[Oe][0].s.c!=ge.c||w[Oe][0].s.r!=ge.r)&&delete K.f,K.f&&(K.f=""+hi(w[Oe][1],o,ge,te,T));break}}_e.dense?(s[ge.r]||(s[ge.r]=[]),s[ge.r][ge.c]=K):s[f]=K}},T={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var O,Y=[],me=[],ae=[],fe=[],he=!1,te=[];te.SheetNames=T.snames,te.sharedf=T.sharedf,te.arrayf=T.arrayf,te.names=[],te.XTI=[];var pe=0,Ie=0,S=0,I=[],V=[],j;T.codepage=1200,Pl(1200);for(var U=!1;t.l<t.length-1;){var G=t.l,R=t.read_shift(2);if(R===0&&pe===10)break;var X=t.l===t.length?0:t.read_shift(2),se=LE[R];if(se&&se.f){if(e.bookSheets&&pe===133&&R!==133)break;if(pe=R,se.r===2||se.r==12){var ye=t.read_shift(2);if(X-=2,!T.enc&&ye!==R&&((ye&255)<<8|ye>>8)!==R)throw new Error("rt mismatch: "+ye+"!="+R);se.r==12&&(t.l+=10,X-=10)}var z={};if(R===10?z=se.f(t,X,T):z=bxe(R,se,t,X,T),Ie==0&&[9,521,1033,2057].indexOf(pe)===-1)continue;switch(R){case 34:r.opts.Date1904=E.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=z;break;case 66:var Me=Number(z);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}Pl(T.codepage=Me),U=!0;break;case 317:T.rrtabid=z;break;case 25:T.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:T.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:P.push(z);break;case 430:te.push([z]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(z);break;case 24:case 536:j={Name:z.Name,Ref:hi(z.rgce,o,null,te,T)},z.itab>0&&(j.Sheet=z.itab-1),te.names.push(j),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(V[z.itab-1]={ref:Lr(z.rgce[0][0][1][2])});break;case 22:T.ExternCount=z;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(z),te.XTI=te.XTI.concat(z);break;case 2196:if(T.biff<8)break;j!=null&&(j.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&T.WTF&&console.error("Password verifier: "+z);break;case 133:a[z.pos]=z,T.snames.push(z.name);break;case 10:{if(--Ie)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Lr(o),e.sheetRows&&e.sheetRows<=o.e.r){var re=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Lr(o),o.e.r=re}o.e.r++,o.e.c++}Y.length>0&&(s["!merges"]=Y),me.length>0&&(s["!objects"]=me),ae.length>0&&(s["!cols"]=ae),fe.length>0&&(s["!rows"]=fe),E.Sheets.push(_)}A===""?u=s:n[A]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[R]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),T.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(T.biff=5,U=!0,Pl(T.codepage=28591)),T.biff==8&&z.BIFFVer==0&&z.dt==16&&(T.biff=2),Ie++)break;if(s=e.dense?[]:{},T.biff<8&&!U&&(U=!0,Pl(T.codepage=e.codepage||1252)),T.biff<5||z.BIFFVer==0&&z.dt==4096){A===""&&(A="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var W={pos:t.l-X,name:A};a[W.pos]=W,T.snames.push(A)}else A=(a[G]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),Y=[],me=[],T.arrayf=w=[],ae=[],fe=[],he=!1,_={Hidden:(a[G]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[z.r]||[])[z.c]:s[_r({c:z.c,r:z.r})])&&++z.c,b={ixfe:z.ixfe,XF:P[z.ixfe]||{},v:z.val,t:"n"},S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:z.c,r:z.r},b,e);break;case 5:case 517:b={ixfe:z.ixfe,XF:P[z.ixfe],v:z.val,t:z.t},S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:z.c,r:z.r},b,e);break;case 638:b={ixfe:z.ixfe,XF:P[z.ixfe],v:z.rknum,t:"n"},S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:z.c,r:z.r},b,e);break;case 189:for(var q=z.c;q<=z.C;++q){var oe=z.rkrec[q-z.c][0];b={ixfe:oe,XF:P[oe],v:z.rkrec[q-z.c][1],t:"n"},S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:q,r:z.r},b,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){l=z;break}if(b=j1(z.val,z.cell.ixfe,z.tt),b.XF=P[b.ixfe],e.cellFormula){var de=z.formula;if(de&&de[0]&&de[0][0]&&de[0][0][0]=="PtgExp"){var Be=de[0][0][1][0],He=de[0][0][1][1],$e=_r({r:Be,c:He});g[$e]?b.f=""+hi(z.formula,o,z.cell,te,T):b.F=((e.dense?(s[Be]||[])[He]:s[$e])||{}).F}else b.f=""+hi(z.formula,o,z.cell,te,T)}S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F(z.cell,b,e),l=z}break;case 7:case 519:if(l)l.val=z,b=j1(z,l.cell.ixfe,"s"),b.XF=P[b.ixfe],e.cellFormula&&(b.f=""+hi(l.formula,o,l.cell,te,T)),S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(z);var Je=_r(z[0].s);if(h=e.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[Je],e.cellFormula&&h){if(!l||!Je||!h)break;h.f=""+hi(z[1],o,z[0],te,T),h.F=Lr(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!l)break;g[_r(l.cell)]=z[0],h=e.dense?(s[l.cell.r]||[])[l.cell.c]:s[_r(l.cell)],(h||{}).f=""+hi(z[0],o,d,te,T)}}break;case 253:b=j1(c[z.isst].t,z.ixfe,"s"),c[z.isst].h&&(b.h=c[z.isst].h),b.XF=P[b.ixfe],S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:z.c,r:z.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:z.ixfe,XF:P[z.ixfe],t:"z"},S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:z.c,r:z.r},b,e));break;case 190:if(e.sheetStubs)for(var ct=z.c;ct<=z.C;++ct){var at=z.ixfe[ct-z.c];b={ixfe:at,XF:P[at],t:"z"},S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:ct,r:z.r},b,e)}break;case 214:case 516:case 4:b=j1(z.val,z.ixfe,"s"),b.XF=P[b.ixfe],S>0&&(b.z=I[b.ixfe>>8&63]),cc(b,e,r.opts.Date1904),F({c:z.c,r:z.r},b,e);break;case 0:case 512:Ie===1&&(o=z);break;case 252:c=z;break;case 1054:if(T.biff==4){I[S++]=z[1];for(var mt=0;mt<S+163&&Cr[mt]!=z[1];++mt);mt>=163&&xA(z[1],S+163)}else xA(z[1],z[0]);break;case 30:{I[S++]=z;for(var st=0;st<S+163&&Cr[st]!=z;++st);st>=163&&xA(z,S+163)}break;case 229:Y=Y.concat(z);break;case 93:me[z.cmo[0]]=T.lastobj=z;break;case 438:T.lastobj.TxO=z;break;case 127:T.lastobj.ImData=z;break;case 440:for(x=z[0].s.r;x<=z[0].e.r;++x)for(p=z[0].s.c;p<=z[0].e.c;++p)h=e.dense?(s[x]||[])[p]:s[_r({c:p,r:x})],h&&(h.l=z[1]);break;case 2048:for(x=z[0].s.r;x<=z[0].e.r;++x)for(p=z[0].s.c;p<=z[0].e.c;++p)h=e.dense?(s[x]||[])[p]:s[_r({c:p,r:x})],h&&h.l&&(h.l.Tooltip=z[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=e.dense?(s[z[0].r]||[])[z[0].c]:s[_r(z[0])];var Le=me[z[2]];h||(e.dense?(s[z[0].r]||(s[z[0].r]=[]),h=s[z[0].r][z[0].c]={t:"z"}):h=s[_r(z[0])]={t:"z"},o.e.r=Math.max(o.e.r,z[0].r),o.s.r=Math.min(o.s.r,z[0].r),o.e.c=Math.max(o.e.c,z[0].c),o.s.c=Math.min(o.s.c,z[0].c)),h.c||(h.c=[]),m={a:z[1],t:Le.TxO.t},h.c.push(m)}break;case 2173:Afe(P[z.ixfe],z.ext);break;case 125:{if(!T.cellStyles)break;for(;z.e>=z.s;)ae[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},he||(he=!0,II(z.w/256)),cd(ae[z.e+1])}break;case 520:{var ut={};z.level!=null&&(fe[z.r]=ut,ut.level=z.level),z.hidden&&(fe[z.r]=ut,ut.hidden=!0),z.hpt&&(fe[z.r]=ut,ut.hpt=z.hpt,ut.hpx=q0(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||xh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[R]]=z;break;case 161:s["!margins"]||xh(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(E.Views[0].RTL=!0);break;case 146:L=z;break;case 2198:O=z;break;case 140:k=z;break;case 442:A?_.CodeName=z||_.name:E.WBProps.CodeName=z||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+R.toString(16)),t.l+=X}return r.SheetNames=Ps(a).sort(function(be,ge){return Number(be)-Number(ge)}).map(function(be){return a[be].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&V.forEach(function(be,ge){r.Sheets[r.SheetNames[ge]]["!autofilter"]=be}),r.Strings=c,r.SSF=ss(Cr),T.enc&&(r.Encryption=T.enc),O&&(r.Themes=O),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),te.names.length>0&&(E.Names=te.names),r.Workbook=E,r}var lg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Cxe(t,e,r){var n=wr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=QP(n,FE,lg.DSI);for(var a in s)e[a]=s[a]}catch(A){if(r.WTF)throw A}var o=wr.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=QP(o,kE,lg.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(A){if(r.WTF)throw A}e.HeadingPairs&&e.TitlesOfParts&&(X8(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function _xe(t,e){var r=[],n=[],s=[],a=0,o,l=gP(FE,"n"),c=gP(kE,"n");if(t.Props)for(o=Ps(t.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],t.Props[o[a]]]);if(t.Custprops)for(o=Ps(t.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],t.Custprops[o[a]]]);var A=[];for(a=0;a<s.length;++a)sQ.indexOf(s[a][0])>-1||J8.indexOf(s[a][0])>-1||s[a][1]!=null&&A.push(s[a]);n.length&&wr.utils.cfb_add(e,"/SummaryInformation",VP(n,lg.SI,c,kE)),(r.length||A.length)&&wr.utils.cfb_add(e,"/DocumentSummaryInformation",VP(r,lg.DSI,l,FE,A.length?A:null,lg.UDI))}function ZQ(t,e){e||(e={}),UI(e),aI(),e.codepage&&sI(e.codepage);var r,n;if(t.FullPaths){if(wr.find(t,"/encryption"))throw new Error("File is password-protected");r=wr.find(t,"!CompObj"),n=wr.find(t,"/Workbook")||wr.find(t,"/Book")}else{switch(e.type){case"base64":t=No(To(t));break;case"binary":t=No(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}qa(t,0),n={content:t}}var s,a;if(r&&yxe(r),e.bookProps&&!e.bookSheets)s={};else{var o=Hr?"buffer":"array";if(n&&n.content)s=Nxe(n.content,e);else if((a=wr.find(t,"PerfectOffice_MAIN"))&&a.content)s=gh.to_workbook(a.content,(e.type=o,e));else if((a=wr.find(t,"NativeContent_MAIN"))&&a.content)s=gh.to_workbook(a.content,(e.type=o,e));else throw(a=wr.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&wr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Ufe(t))}var l={};return t.FullPaths&&Cxe(t,l,e),s.Props=s.Custprops=l,e.bookFiles&&(s.cfb=t),s}function Exe(t,e){var r=e||{},n=wr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return wr.utils.cfb_add(n,s,e7(t,r)),r.biff==8&&(t.Props||t.Custprops)&&_xe(t,n),r.biff==8&&t.vbaraw&&Ofe(n,wr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var lx={0:{f:Jme},1:{f:spe},2:{f:Npe},3:{f:dpe},4:{f:lpe},5:{f:ype},6:{f:Spe},7:{f:ppe},8:{f:Rpe},9:{f:Ppe},10:{f:Tpe},11:{f:jpe},12:{f:ipe},13:{f:_pe},14:{f:fpe},15:{f:Ape},16:{f:qQ},17:{f:Fpe},18:{f:xpe},19:{f:vI},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Fge},40:{},42:{},43:{f:She},44:{f:Ehe},45:{f:khe},46:{f:jhe},47:{f:The},48:{},49:{f:Zce},50:{},51:{f:hfe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:mQ},62:{f:Bpe},63:{f:bfe},64:{f:Xpe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$pe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rpe},148:{f:Zme,p:16},151:{f:Qpe},152:{},153:{f:Bge},154:{},155:{},156:{f:_ge},157:{},158:{},159:{T:1,f:Hde},160:{T:-1},161:{T:1,f:nf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Dpe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ufe},336:{T:-1},337:{f:pfe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:IE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fQ},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Vpe},427:{f:Hpe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:qpe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tpe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Ope},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:IE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jfe},633:{T:1},634:{T:-1},635:{T:1,f:kfe},636:{T:-1},637:{f:nAe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ype},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},LE={6:{f:aC},10:{f:cu},12:{f:Zs},13:{f:Zs},14:{f:Qs},15:{f:Qs},16:{f:pi},17:{f:Qs},18:{f:Qs},19:{f:Zs},20:{f:zP},21:{f:zP},23:{f:fQ},24:{f:JP},25:{f:Qs},26:{},27:{},28:{f:Yue},29:{},34:{f:Qs},35:{f:WP},38:{f:pi},39:{f:pi},40:{f:pi},41:{f:pi},42:{f:Qs},43:{f:Qs},47:{f:Ahe},49:{f:_ue},51:{f:Zs},60:{},61:{f:yue},64:{f:Qs},65:{f:Cue},66:{f:Zs},77:{},80:{},81:{},82:{},85:{f:Zs},89:{},90:{},91:{},92:{f:cue},93:{f:tde},94:{},95:{f:Qs},96:{},97:{},99:{f:Qs},125:{f:mQ},128:{f:Mue},129:{f:uue},130:{f:Zs},131:{f:Qs},132:{f:Qs},133:{f:due},134:{},140:{f:cde},141:{f:Zs},144:{},146:{f:dde},151:{},152:{},153:{},154:{},155:{},156:{f:Zs},157:{},158:{},160:{f:vde},161:{f:mde},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Due},190:{f:Lue},193:{f:cu},197:{},198:{},199:{},200:{},201:{},202:{f:Qs},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zs},220:{},221:{f:Qs},222:{},224:{f:Oue},225:{f:lue},226:{f:cu},227:{},229:{f:Zue},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:fue},253:{f:Bue},255:{f:pue},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:aQ},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Qs},353:{f:cu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:que},431:{f:Qs},432:{},433:{},434:{},437:{},438:{f:sde},439:{f:Qs},440:{f:ade},441:{},442:{f:Hx},443:{},444:{f:Zs},445:{},446:{},448:{f:cu},449:{f:vue,r:2},450:{f:cu},512:{f:qP},513:{f:xde},515:{f:Hue},516:{f:Iue},517:{f:$P},519:{f:yde},520:{f:gue},523:{},545:{f:XP},549:{f:KP},566:{},574:{f:bue},638:{f:Rue},659:{},1048:{},1054:{f:kue},1084:{},1212:{f:Wue},2048:{f:ode},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:F1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:cu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:hde,r:12},2173:{f:cfe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Qs,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:zue,r:12},2197:{},2198:{f:nfe,r:12},2199:{},2200:{},2201:{},2202:{f:Jue,r:12},2203:{f:cu},2204:{},2205:{},2206:{},2207:{},2211:{f:xue},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:pde},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ude},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:qP},1:{},2:{f:_de},3:{f:Nde},4:{f:bde},5:{f:$P},7:{f:Bde},8:{},9:{f:F1},11:{},22:{f:Zs},30:{f:jue},31:{},32:{},33:{f:XP},36:{},37:{f:KP},50:{f:Sde},62:{},52:{},67:{},68:{f:Zs},69:{},86:{},126:{},127:{f:wde},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ide},223:{},234:{},354:{},421:{},518:{f:aC},521:{f:F1},536:{f:JP},547:{f:WP},561:{},579:{},1030:{f:aC},1033:{f:F1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xt(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&pI(r)&&t.push(r)}}function Bxe(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return Xt(t,e,r,s);var a=e;if(!isNaN(a)){for(var o=r.parts||[],l=0,c=0,A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;var u=t.next(4);for(u.write_shift(2,a),u.write_shift(2,A),t.push(r.slice(c,c+A)),c+=A;c<s;){for(u=t.next(4),u.write_shift(2,60),A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;u.write_shift(2,A),t.push(r.slice(c,c+A)),c+=A}}}function $x(t,e,r){return t||(t=_t(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Sxe(t,e,r,n){var s=_t(9);return $x(s,t,e),iQ(r,n||"b",s),s}function Ixe(t,e,r){var n=_t(8+2*r.length);return $x(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Fxe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?ga(ns(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Xt(t,2,Ede(r,n,s)):Xt(t,3,Cde(r,n,s));return;case"b":case"e":Xt(t,5,Sxe(r,n,e.v,e.t));return;case"s":case"str":Xt(t,4,Ixe(r,n,(e.v||"").slice(0,255)));return}Xt(t,1,$x(null,r,n))}function kxe(t,e,r,n){var s=Array.isArray(e),a=hn(e["!ref"]||"A1"),o,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Lr(a)}for(var A=a.s.r;A<=a.e.r;++A){l=$s(A);for(var u=a.s.c;u<=a.e.c;++u){A===a.s.r&&(c[u]=ws(u)),o=c[u]+l;var d=s?(e[A]||[])[u]:e[o];d&&Fxe(t,d,A,u)}}}function Txe(t,e){for(var r=e||{},n=eo(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Xt(n,r.biff==4?1033:r.biff==3?521:9,EI(t,16,r)),kxe(n,t.Sheets[t.SheetNames[s]],s,r),Xt(n,10),n.end()}function jxe(t,e,r){Xt(t,49,Eue({sz:12,name:"Arial"},r))}function Pxe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Xt(t,1054,Tue(s,e[s],r))})}function Rxe(t,e){var r=_t(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Xt(t,2151,r),r=_t(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uQ(hn(e["!ref"]||"A1"),r),r.write_shift(4,4),Xt(t,2152,r)}function Dxe(t,e){for(var r=0;r<16;++r)Xt(t,224,GP({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Xt(t,224,GP(n,0,e))})}function Lxe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Xt(t,440,ide(n)),n[1].Tooltip&&Xt(t,2048,lde(n))}delete e["!links"]}function Uxe(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Xt(t,125,fde(eb(s,n),s))})}}function Oxe(t,e,r,n,s){var a=16+bd(s.cellXfs,e,s);if(e.v==null&&!e.bf){Xt(t,513,Oh(r,n,a));return}if(e.bf)Xt(t,6,ume(e,r,n,s,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?ga(ns(e.v)):e.v;Xt(t,515,Kue(r,n,o,a));break;case"b":case"e":Xt(t,517,Vue(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var l=PI(s.Strings,e.v,s.revStrings);Xt(t,253,Sue(r,n,l,a))}else Xt(t,516,Fue(r,n,(e.v||"").slice(0,255),a,s));break;default:Xt(t,513,Oh(r,n,a))}}function Mxe(t,e,r){var n=eo(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(a),A=e.biff==8,u,d="",f=[],h=hn(a["!ref"]||"A1"),m=A?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Xt(n,2057,EI(r,16,e)),Xt(n,13,rl(1)),Xt(n,12,rl(100)),Xt(n,15,Ti(!0)),Xt(n,17,Ti(!1)),Xt(n,16,Lh(.001)),Xt(n,95,Ti(!0)),Xt(n,42,Ti(!1)),Xt(n,43,Ti(!1)),Xt(n,130,rl(1)),Xt(n,128,Que()),Xt(n,131,Ti(!1)),Xt(n,132,Ti(!1)),A&&Uxe(n,a["!cols"]),Xt(n,512,Pue(h,e)),A&&(a["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){d=$s(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(f[x]=ws(x)),u=f[x]+d;var g=c?(a[p]||[])[x]:a[u];g&&(Oxe(n,g,p,x,e),A&&g.l&&a["!links"].push([u,g.l]))}}var w=l.CodeName||l.name||s;return A&&Xt(n,574,Nue((o.Views||[])[0])),A&&(a["!merges"]||[]).length&&Xt(n,229,ede(a["!merges"])),A&&Lxe(n,a),Xt(n,442,oQ(w)),A&&Rxe(n,a),Xt(n,10),n.end()}function Qxe(t,e,r){var n=eo(),s=(t||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Xt(n,2057,EI(t,5,r)),r.bookType=="xla"&&Xt(n,135),Xt(n,225,l?rl(1200):null),Xt(n,193,VAe(2)),c&&Xt(n,191),c&&Xt(n,192),Xt(n,226),Xt(n,92,Aue("SheetJS",r)),Xt(n,66,rl(l?1200:1252)),l&&Xt(n,353,rl(0)),l&&Xt(n,448),Xt(n,317,gde(t.SheetNames.length)),l&&t.vbaraw&&Xt(n,211),l&&t.vbaraw){var A=o.CodeName||"ThisWorkbook";Xt(n,442,oQ(A))}Xt(n,156,rl(17)),Xt(n,25,Ti(!1)),Xt(n,18,Ti(!1)),Xt(n,19,rl(0)),l&&Xt(n,431,Ti(!1)),l&&Xt(n,444,rl(0)),Xt(n,61,wue()),Xt(n,64,Ti(!1)),Xt(n,141,rl(0)),Xt(n,34,Ti(vge(t)=="true")),Xt(n,14,Ti(!0)),l&&Xt(n,439,Ti(!1)),Xt(n,218,rl(0)),jxe(n,t,r),Pxe(n,t.SSF,r),Dxe(n,r),l&&Xt(n,352,Ti(!1));var u=n.end(),d=eo();l&&Xt(d,140,Ade()),l&&r.Strings&&Bxe(d,252,mue(r.Strings)),Xt(d,10);var f=d.end(),h=eo(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=u.length+m+f.length;for(p=0;p<t.SheetNames.length;++p){var g=a[p]||{};Xt(h,133,hue({pos:x,hs:g.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var w=h.end();if(m!=w.length)throw new Error("BS8 "+m+" != "+w.length);var b=[];return u.length&&b.push(u),w.length&&b.push(w),f.length&&b.push(f),Ea(b)}function Vxe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=ss(Cr)),t&&t.SSF&&(Am(),$2(t.SSF),r.revssf=W2(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,OI(r),r.cellXfs=[],bd(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=Mxe(s,r,t);return n.unshift(Qxe(t,n,r)),Ea(n)}function e7(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=to(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return Vxe(t,e);case 4:case 3:case 2:return Txe(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function o3(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),o=s.index,l=a&&a.index||t.length,c=Ece(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,u=0,d=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++A,r.sheetRows&&r.sheetRows<=A){--A;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var g=p.split(/<\/t[dh]>/i);for(l=0;l<g.length;++l){var w=g[l].trim();if(w.match(/<t[dh]/i)){for(var b=w,k=0;b.charAt(0)=="<"&&(k=b.indexOf(">"))>-1;)b=b.slice(k+1);for(var P=0;P<m.length;++P){var L=m[P];L.s.c==u&&L.s.r<A&&A<=L.e.r&&(u=L.e.c+1,P=-1)}var E=Br(w.slice(0,w.indexOf(">")));f=E.colspan?+E.colspan:1,((d=+E.rowspan)>1||f>1)&&m.push({s:{r:A,c:u},e:{r:A+(d||1)-1,c:u+f-1}});var _=E.t||E["data-t"]||"";if(!b.length){u+=f;continue}if(b=C8(b),h.s.r>A&&(h.s.r=A),h.e.r<A&&(h.e.r=A),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!b.length){u+=f;continue}var B={t:"s",v:b};r.raw||!b.trim().length||_=="s"||(b==="TRUE"?B={t:"b",v:!0}:b==="FALSE"?B={t:"b",v:!1}:isNaN(Ol(b))?isNaN(H0(b).getDate())||(B={t:"d",v:ns(b)},r.cellDates||(B={t:"n",v:ga(B.v)}),B.z=r.dateNF||Cr[14]):B={t:"n",v:Ol(b)}),r.dense?(n[A]||(n[A]=[]),n[A][u]=B):n[_r({r:A,c:u})]=B,u+=f}}}}return n["!ref"]=Lr(h),m.length&&(n["!merges"]=m),n}function Hxe(t,e,r,n){for(var s=t["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,A=0;A<s.length;++A)if(!(s[A].s.r>r||s[A].s.c>o)&&!(s[A].e.r<r||s[A].e.c<o)){if(s[A].s.r<r||s[A].s.c<o){l=-1;break}l=s[A].e.r-s[A].s.r+1,c=s[A].e.c-s[A].s.c+1;break}if(!(l<0)){var u=_r({r,c:o}),d=n.dense?(t[r]||[])[o]:t[u],f=d&&d.v!=null&&(d.h||hI(d.w||(IA(d),d.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),h.id=(n.id||"sjs")+"-"+u,a.push(Jt("td",f,h))}}var m="<tr>";return m+a.join("")+"</tr>"}var Kxe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qxe="</body></html>";function Gxe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return wd(o3(r[0],e),e);var n=VI();return r.forEach(function(s,a){HI(n,o3(s,e),"Sheet"+(a+1))}),n}function $xe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function t7(t,e){var r=e||{},n=r.header!=null?r.header:Kxe,s=r.footer!=null?r.footer:qxe,a=[n],o=to(t["!ref"]);r.dense=Array.isArray(t),a.push($xe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(Hxe(t,o,l,r));return a.push("</table>"+s),a.join("")}function r7(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?bs(n.origin):n.origin;s=o.r,a=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),A={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var u=to(t["!ref"]);A.s.r=Math.min(A.s.r,u.s.r),A.s.c=Math.min(A.s.c,u.s.c),A.e.r=Math.max(A.e.r,u.e.r),A.e.c=Math.max(A.e.c,u.e.c),s==-1&&(A.e.r=s=u.e.r+1)}var d=[],f=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,g=0,w=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var k=l[m];if(l3(k)){if(n.display)continue;h[p]={hidden:!0}}var P=k.children;for(x=g=0;x<P.length;++x){var L=P[x];if(!(n.display&&l3(L))){var E=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):C8(L.innerHTML),_=L.getAttribute("data-z")||L.getAttribute("z");for(f=0;f<d.length;++f){var B=d[f];B.s.c==g+a&&B.s.r<p+s&&p+s<=B.e.r&&(g=B.e.c+1-a,f=-1)}b=+L.getAttribute("colspan")||1,((w=+L.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:p+s,c:g+a},e:{r:p+s+(w||1)-1,c:g+a+(b||1)-1}});var M={t:"s",v:E},F=L.getAttribute("data-t")||L.getAttribute("t")||"";E!=null&&(E.length==0?M.t=F||"z":n.raw||E.trim().length==0||F=="s"||(E==="TRUE"?M={t:"b",v:!0}:E==="FALSE"?M={t:"b",v:!1}:isNaN(Ol(E))?isNaN(H0(E).getDate())||(M={t:"d",v:ns(E)},n.cellDates||(M={t:"n",v:ga(M.v)}),M.z=n.dateNF||Cr[14]):M={t:"n",v:Ol(E)})),M.z===void 0&&_!=null&&(M.z=_);var T="",O=L.getElementsByTagName("A");if(O&&O.length)for(var Y=0;Y<O.length&&!(O[Y].hasAttribute("href")&&(T=O[Y].getAttribute("href"),T.charAt(0)!="#"));++Y);T&&T.charAt(0)!="#"&&(M.l={Target:T}),n.dense?(t[p+s]||(t[p+s]=[]),t[p+s][g+a]=M):t[_r({c:g+a,r:p+s})]=M,A.e.c<g+a&&(A.e.c=g+a),g+=b}}++p}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),A.e.r=Math.max(A.e.r,p-1+s),t["!ref"]=Lr(A),p>=c&&(t["!fullref"]=Lr((A.e.r=l.length-m+p-1+s,A))),t}function n7(t,e){var r=e||{},n=r.dense?[]:{};return r7(n,t,e)}function zxe(t,e){return wd(n7(t,e),e)}function l3(t){var e="",r=Wxe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Wxe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Jxe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=un(e.replace(/<[^>]*>/g,""));return[r]}var c3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function s7(t,e){var r=e||{},n=fI(t),s=[],a,o,l={name:""},c="",A=0,u,d,f={},h=[],m=r.dense?[]:{},p,x,g={value:""},w="",b=0,k=[],P=-1,L=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},_=0,B={},M=[],F={},T=0,O=0,Y=[],me=1,ae=1,fe=[],he={Names:[]},te={},pe=["",""],Ie=[],S={},I="",V=0,j=!1,U=!1,G=0;for(rx.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=rx.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?m["!ref"]=Lr(E):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=Lr(E)),M.length&&(m["!merges"]=M),Y.length&&(m["!rows"]=Y),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=m,U=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Br(p[0],!1),P=L=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,m=r.dense?[]:{},M=[],Y=[],U=!0);break;case"table-row-group":p[1]==="/"?--_:++_;break;case"table-row":case"":if(p[1]==="/"){P+=me,me=1;break}if(d=Br(p[0],!1),d.?P=d.-1:P==-1&&(P=0),me=+d["number-rows-repeated"]||1,me<10)for(G=0;G<me;++G)_>0&&(Y[P+G]={level:_});L=-1;break;case"covered-table-cell":p[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(m[P]||(m[P]=[]),m[P][L]={t:"z"}):m[_r({r:P,c:L})]={t:"z"}),w="",k=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++L,g=Br(p[0],!1),ae=parseInt(g["number-columns-repeated"]||"1",10),x={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(x.f=s3(un(g.formula))),(g.||g["value-type"])=="string"&&(x.t="s",x.v=un(g["string-value"]||""),r.dense?(m[P]||(m[P]=[]),m[P][L]=x):m[_r({r:P,c:L})]=x),L+=ae-1;else if(p[1]!=="/"){++L,w="",b=0,k=[],ae=1;var R=me?P+me-1:P;if(L>E.e.c&&(E.e.c=L),L<E.s.c&&(E.s.c=L),P<E.s.r&&(E.s.r=P),R>E.e.r&&(E.e.r=R),g=Br(p[0],!1),Ie=[],S={},x={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=un(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(T=parseInt(g["number-matrix-rows-spanned"],10)||0,O=parseInt(g["number-matrix-columns-spanned"],10)||0,F={s:{r:P,c:L},e:{r:P+T-1,c:L+O-1}},x.F=Lr(F),fe.push([F,x.F])),g.formula)x.f=s3(g.formula);else for(G=0;G<fe.length;++G)P>=fe[G][0].s.r&&P<=fe[G][0].e.r&&L>=fe[G][0].s.c&&L<=fe[G][0].e.c&&(x.F=fe[G][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(T=parseInt(g["number-rows-spanned"],10)||0,O=parseInt(g["number-columns-spanned"],10)||0,F={s:{r:P,c:L},e:{r:P+T-1,c:L+O-1}},M.push(F)),g["number-columns-repeated"]&&(ae=parseInt(g["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=es(g["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(g.value);break;case"percentage":x.t="n",x.v=parseFloat(g.value);break;case"currency":x.t="n",x.v=parseFloat(g.value);break;case"date":x.t="d",x.v=ns(g["date-value"]),r.cellDates||(x.t="n",x.v=ga(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=Nce(g["time-value"])/86400,r.cellDates&&(x.t="d",x.v=J2(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(g.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",g["string-value"]!=null&&(w=un(g["string-value"]),k=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(j=!1,x.t==="s"&&(x.v=w||"",k.length&&(x.R=k),j=b==0),te.Target&&(x.l=te),Ie.length>0&&(x.c=Ie,Ie=[]),w&&r.cellText!==!1&&(x.w=w),j&&(x.t="z",delete x.v),(!j||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var X=0;X<me;++X){if(ae=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(m[P+X]||(m[P+X]=[]),m[P+X][L]=X==0?x:ss(x);--ae>0;)m[P+X][L+ae]=ss(x);else for(m[_r({r:P+X,c:L})]=x;--ae>0;)m[_r({r:P+X,c:L+ae})]=ss(x);E.e.c<=L&&(E.e.c=L)}ae=parseInt(g["number-columns-repeated"]||"1",10),L+=ae-1,ae=0,x={},w="",k=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a;S.t=w,k.length&&(S.R=k),S.a=I,Ie.push(S)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);I="",V=0,w="",b=0,k=[];break;case"creator":p[1]==="/"?I=n.slice(V,p.index):V=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);w="",b=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(B[l.name]=c,(a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Br(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Br(p[0],!1),c+=c3[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Br(p[0],!1),c+=c3[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(A,p.index);break}else A=p.index+p[0].length;break;case"named-range":o=Br(p[0],!1),pe=iC(o["cell-range-address"]);var se={Name:o.name,Ref:pe[0]+"!"+pe[1]};U&&(se.Sheet=h.length),he.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!g||!g["string-value"])){var ye=Jxe(n.slice(b,p.index));w=(w.length>0?w+`
`:"")+ye[0]}else Br(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{pe=iC(Br(p[0])["target-range-address"]),f[pe[0]]["!autofilter"]={ref:pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(te=Br(p[0],!1),!te.href)break;te.Target=un(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(pe=iC(te.Target.slice(1)),te.Target="#"+pe[0]+"!"+pe[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var z={Sheets:f,SheetNames:h,Workbook:he};return r.bookSheets&&delete z.Sheets,z}function A3(t,e){e=e||{},tl(t,"META-INF/manifest.xml")&&NAe(Ys(t,"META-INF/manifest.xml"),e);var r=Co(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=s7(Rn(r),e);return tl(t,"meta.xml")&&(n.Props=z8(Ys(t,"meta.xml"))),n}function u3(t,e){return s7(t,e)}var Xxe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+tx({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ws+e}}(),d3=function(){var t=function(a){return Fn(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,l){var c=[];c.push('      <table:table table:name="'+Fn(o.SheetNames[l])+`" table:style-name="ta1">
`);var A=0,u=0,d=to(a["!ref"]||"A1"),f=a["!merges"]||[],h=0,m=Array.isArray(a);if(a["!cols"])for(u=0;u<=d.e.c;++u)c.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=a["!rows"]||[];for(A=0;A<d.s.r;++A)p=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;A<=d.e.r;++A){for(p=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<d.s.c;++u)c.push(e);for(;u<=d.e.c;++u){var g=!1,w={},b="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>u)&&!(f[h].s.r>A)&&!(f[h].e.c<u)&&!(f[h].e.r<A)){(f[h].s.c!=u||f[h].s.r!=A)&&(g=!0),w["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,w["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(g){c.push(r);continue}var k=_r({r:A,c:u}),P=m?(a[A]||[])[u]:a[k];if(P&&P.f&&(w["table:formula"]=Fn(gme(P.f)),P.F&&P.F.slice(0,k.length)==k)){var L=to(P.F);w["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,w["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!P){c.push(e);continue}switch(P.t){case"b":b=P.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=P.v?"true":"false";break;case"n":b=P.w||String(P.v||0),w["office:value-type"]="float",w["office:value"]=P.v||0;break;case"s":case"str":b=P.v==null?"":P.v,w["office:value-type"]="string";break;case"d":b=P.w||ns(P.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=ns(P.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(e);continue}var E=t(b);if(P.l&&P.l.Target){var _=P.l.Target;_=_.charAt(0)=="#"?"#"+xme(_.slice(1)):_,_.charAt(0)!="#"&&!_.match(/^\w+:/)&&(_="../"+_),E=Jt("text:a",E,{"xlink:href":_.replace(/&/g,"&amp;")})}c.push("          "+Jt("table:table-cell",Jt("text:p",E,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!cols"]){for(var u=0;u<A["!cols"].length;++u)if(A["!cols"][u]){var d=A["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;cd(d),d.ods=l;var f=A["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!rows"]){for(var u=0;u<A["!rows"].length;++u)if(A["!rows"][u]){A["!rows"][u].ods=c;var d=A["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Ws],A=tx({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=tx({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+A+u+`>
`),c.push($8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+A+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=o.SheetNames.length;++d)c.push(n(o.Sheets[o.SheetNames[d]],o,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function a7(t,e){if(e.bookType=="fods")return d3(t,e);var r=AI(),n="",s=[],a=[];return n="mimetype",Qr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qr(r,n,d3(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Qr(r,n,Xxe(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Qr(r,n,Ws+$8()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Qr(r,n,EAe(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qr(r,n,CAe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Mh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function UE(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Rn(yd(t))}function Yxe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):No(vc(t))}function Zxe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ud(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function h3(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function eve(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function tve(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function cx(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function _n(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ts(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function mn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=cx(t,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=cx(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var A={data:l,type:a};e[s]==null?e[s]=[A]:e[s].push(A)}return e}function Oa(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(_n(n*8+s.type)),s.type==2&&e.push(_n(s.data.length)),e.push(s.data))})}),ud(e)}function LI(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Yo(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=cx(t,n),a=mn(t.slice(n[0],n[0]+s));n[0]+=s;var o={id:Ts(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=mn(l.data),A=Ts(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+A)}),n[0]+=A}),(e=a[3])!=null&&e[0]&&(o.merge=Ts(a[3][0].data)>>>0>0),r.push(o)}return r}function Rf(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:_n(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:_n(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:_n(o.data.length)}],n[2].push({data:Oa(o.meta),type:2})});var a=Oa(n);e.push(_n(a.length)),e.push(a),s.forEach(function(o){return e.push(o)})}),ud(e)}function rve(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=cx(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,A=0;if(a==1?(A=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(A=(e[r[0]++]>>2)+1,a==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ud(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(A>=c)for(s.push(s[0].slice(-c)),A-=c;A>=s[s.length-1].length;)s.push(s[s.length-1]),A-=s[s.length-1].length;s.push(s[0].slice(-c,-c+A))}}var u=ud(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Zo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(rve(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ud(e)}function Df(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=_n(n),o=a.length;e.push(a),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return ud(e)}function nve(t,e,r,n){var s=Mh(t),a=s.getUint32(4,!0),o=(n>1?12:8)+h3(a&(n>1?3470:398))*4,l=-1,c=-1,A=NaN,u=new Date(2001,0,1);a&512&&(l=s.getUint32(o,!0),o+=4),o+=h3(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(o,!0),o+=4),a&32&&(A=s.getFloat64(o,!0),o+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:A};break;case 3:d={t:"s",v:e[c]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:A>0};break;case 7:d={t:"n",v:A/86400};break;case 8:d={t:"e",v:0};break;case 9:if(l>-1)d={t:"s",v:r[l]};else if(c>-1)d={t:"s",v:e[c]};else if(!isNaN(A))d={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function sve(t,e,r){var n=Mh(t),s=n.getUint32(8,!0),a=12,o=-1,l=-1,c=NaN,A=NaN,u=new Date(2001,0,1);s&1&&(c=eve(t,a),a+=16),s&2&&(A=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(o=n.getUint32(a,!0),a+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:A>0};break;case 7:d={t:"n",v:A/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return d}function lC(t,e){var r=new Uint8Array(32),n=Mh(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,tve(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function cC(t,e){var r=new Uint8Array(32),n=Mh(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function ave(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return nve(t,e,r,t[0]);case 5:return sve(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ai(t){var e=mn(t);return cx(e[1][0].data)}function f3(t,e){var r=mn(e.data),n=Ts(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(o){var l=mn(o.data),c=Ts(l[1][0].data)>>>0;switch(n){case 1:a[c]=UE(l[3][0].data);break;case 8:{var A=t[Ai(l[9][0].data)][0],u=mn(A.data),d=t[Ai(u[1][0].data)][0],f=Ts(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=mn(d.data);a[c]=h[3].map(function(m){return UE(m.data)}).join("")}break}}),a}function ive(t,e){var r,n,s,a,o,l,c,A,u,d,f,h,m,p,x=mn(t),g=Ts(x[1][0].data)>>>0,w=Ts(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Ts(x[8][0].data)>0||!1,k,P;if((a=(s=x[7])==null?void 0:s[0])!=null&&a.data&&e!=0)k=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,P=(A=(c=x[6])==null?void 0:c[0])==null?void 0:A.data;else if((d=(u=x[4])==null?void 0:u[0])!=null&&d.data&&e!=1)k=(h=(f=x[4])==null?void 0:f[0])==null?void 0:h.data,P=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var L=b?4:1,E=Mh(k),_=[],B=0;B<k.length/2;++B){var M=E.getUint16(B*2,!0);M<65535&&_.push([B,M])}if(_.length!=w)throw"Expected ".concat(w," cells, found ").concat(_.length);var F=[];for(B=0;B<_.length-1;++B)F[_[B][0]]=P.subarray(_[B][1]*L,_[B+1][1]*L);return _.length>=1&&(F[_[_.length-1][0]]=P.subarray(_[_.length-1][1]*L)),{R:g,cells:F}}function ove(t,e){var r,n=mn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Ts(n[7][0].data)>>>0>0?1:0:-1,a=LI(n[5],function(o){return ive(o,s)});return{nrows:Ts(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,A){if(o[l.R][A])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(A));o[l.R][A]=c}),o},[])}}function lve(t,e,r){var n,s=mn(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ts(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Ts(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Lr(a);var o=mn(s[4][0].data),l=f3(t,t[Ai(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?f3(t,t[Ai(o[17][0].data)][0]):[],A=mn(o[3][0].data),u=0;A[1].forEach(function(d){var f=mn(d.data),h=t[Ai(f[2][0].data)][0],m=Ts(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=ove(t,h);p.data.forEach(function(x,g){x.forEach(function(w,b){var k=_r({r:u+g,c:b}),P=ave(w,l,c);P&&(r[k]=P)})}),u+=p.nrows})}function cve(t,e){var r=mn(e.data),n={"!ref":"A1"},s=t[Ai(r[2][0].data)],a=Ts(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return lve(t,s[0],n),n}function Ave(t,e){var r,n=mn(e.data),s={name:(r=n[1])!=null&&r[0]?UE(n[1][0].data):"",sheets:[]},a=LI(n[2],Ai);return a.forEach(function(o){t[o].forEach(function(l){var c=Ts(l.meta[1][0].data);c==6e3&&s.sheets.push(cve(t,l))})}),s}function uve(t,e){var r=VI(),n=mn(e.data),s=LI(n[1],Ai);if(s.forEach(function(a){t[a].forEach(function(o){var l=Ts(o.meta[1][0].data);if(l==2){var c=Ave(t,o);c.sheets.forEach(function(A,u){HI(r,A,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function AC(t){var e,r,n,s,a={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var A;try{A=Zo(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var u;try{u=Yo(A)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){a[d.id]=d.messages,o.push(d.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ts(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(c){a[c].forEach(function(A){var u=Ts(A.meta[1][0].data)>>>0;if(u==1)if(!l)l=A;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return uve(a,l)}function dve(t,e,r){var n,s,a,o;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=t[8])==null?void 0:a[0])==null?void 0:o.data)&&Ts(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,A=Mh(t[7][0].data),u=0,d=[],f=Mh(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){A.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}A.setUint16(p*2,u,!0),f.setUint16(p*2,h,!0);var x,g;switch(typeof e[p]){case"string":x=lC({t:"s",v:e[p]},r),g=cC({t:"s",v:e[p]},r);break;case"number":x=lC({t:"n",v:e[p]},r),g=cC({t:"n",v:e[p]},r);break;case"boolean":x=lC({t:"b",v:e[p]},r),g=cC({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}d.push(x),u+=x.length,m.push(g),h+=g.length,++c}for(t[2][0].data=_n(c);p<t[7][0].data.length/2;++p)A.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return t[6][0].data=ud(d),t[3][0].data=ud(m),c}function hve(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=to(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Lr(n)));var a=Uw(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(I){return I.forEach(function(V){typeof V=="string"&&o.push(V)})});var l={},c=[],A=wr.read(e.numbers,{type:"base64"});A.FileIndex.map(function(I,V){return[I,A.FullPaths[V]]}).forEach(function(I){var V=I[0],j=I[1];if(V.type==2&&V.name.match(/\.iwa/)){var U=V.content,G=Zo(U),R=Yo(G);R.forEach(function(X){c.push(X.id),l[X.id]={deps:[],location:j,type:Ts(X.messages[0].meta[1][0].data)}})}}),c.sort(function(I,V){return I-V});var u=c.filter(function(I){return I>1}).map(function(I){return[I,_n(I)]});A.FileIndex.map(function(I,V){return[I,A.FullPaths[V]]}).forEach(function(I){var V=I[0];if(I[1],!!V.name.match(/\.iwa/)){var j=Yo(Zo(V.content));j.forEach(function(U){U.messages.forEach(function(G){u.forEach(function(R){U.messages.some(function(X){return Ts(X.meta[1][0].data)!=11006&&Zxe(X.data,R[1])})&&l[R[0]].deps.push(U.id)})})})}});for(var d=wr.find(A,l[1].location),f=Yo(Zo(d.content)),h,m=0;m<f.length;++m){var p=f[m];p.id==1&&(h=p)}var x=Ai(mn(h.messages[0].data)[1][0].data);for(d=wr.find(A,l[x].location),f=Yo(Zo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);for(x=Ai(mn(h.messages[0].data)[2][0].data),d=wr.find(A,l[x].location),f=Yo(Zo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);for(x=Ai(mn(h.messages[0].data)[2][0].data),d=wr.find(A,l[x].location),f=Yo(Zo(d.content)),m=0;m<f.length;++m)p=f[m],p.id==x&&(h=p);var g=mn(h.messages[0].data);{g[6][0].data=_n(n.e.r+1),g[7][0].data=_n(n.e.c+1);var w=Ai(g[46][0].data),b=wr.find(A,l[w].location),k=Yo(Zo(b.content));{for(var P=0;P<k.length&&k[P].id!=w;++P);if(k[P].id!=w)throw"Bad ColumnRowUIDMapArchive";var L=mn(k[P].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var E=0;E<=n.e.c;++E){var _=[];_[1]=_[2]=[{type:0,data:_n(E+420690)}],L[1].push({type:2,data:Oa(_)}),L[2].push({type:0,data:_n(E)}),L[3].push({type:0,data:_n(E)})}L[4]=[],L[5]=[],L[6]=[];for(var B=0;B<=n.e.r;++B)_=[],_[1]=_[2]=[{type:0,data:_n(B+726270)}],L[4].push({type:2,data:Oa(_)}),L[5].push({type:0,data:_n(B)}),L[6].push({type:0,data:_n(B)});k[P].messages[0].data=Oa(L)}b.content=Df(Rf(k)),b.size=b.content.length,delete g[46];var M=mn(g[4][0].data);{M[7][0].data=_n(n.e.r+1);var F=mn(M[1][0].data),T=Ai(F[2][0].data);b=wr.find(A,l[T].location),k=Yo(Zo(b.content));{if(k[0].id!=T)throw"Bad HeaderStorageBucket";var O=mn(k[0].messages[0].data);for(B=0;B<a.length;++B){var Y=mn(O[2][0].data);Y[1][0].data=_n(B),Y[4][0].data=_n(a[B].length),O[2][B]={type:O[2][0].type,data:Oa(Y)}}k[0].messages[0].data=Oa(O)}b.content=Df(Rf(k)),b.size=b.content.length;var me=Ai(M[2][0].data);b=wr.find(A,l[me].location),k=Yo(Zo(b.content));{if(k[0].id!=me)throw"Bad HeaderStorageBucket";for(O=mn(k[0].messages[0].data),E=0;E<=n.e.c;++E)Y=mn(O[2][0].data),Y[1][0].data=_n(E),Y[4][0].data=_n(n.e.r+1),O[2][E]={type:O[2][0].type,data:Oa(Y)};k[0].messages[0].data=Oa(O)}b.content=Df(Rf(k)),b.size=b.content.length;var ae=Ai(M[4][0].data);(function(){for(var I=wr.find(A,l[ae].location),V=Yo(Zo(I.content)),j,U=0;U<V.length;++U){var G=V[U];G.id==ae&&(j=G)}var R=mn(j.messages[0].data);{R[3]=[];var X=[];o.forEach(function(z,Me){X[1]=[{type:0,data:_n(Me)}],X[2]=[{type:0,data:_n(1)}],X[3]=[{type:2,data:Yxe(z)}],R[3].push({type:2,data:Oa(X)})})}j.messages[0].data=Oa(R);var se=Rf(V),ye=Df(se);I.content=ye,I.size=I.content.length})();var fe=mn(M[3][0].data);{var he=fe[1][0];delete fe[2];var te=mn(he.data);{var pe=Ai(te[2][0].data);(function(){for(var I=wr.find(A,l[pe].location),V=Yo(Zo(I.content)),j,U=0;U<V.length;++U){var G=V[U];G.id==pe&&(j=G)}var R=mn(j.messages[0].data);{delete R[6],delete fe[7];var X=new Uint8Array(R[5][0].data);R[5]=[];for(var se=0,ye=0;ye<=n.e.r;++ye){var z=mn(X);se+=dve(z,a[ye],o),z[1][0].data=_n(ye),R[5].push({data:Oa(z),type:2})}R[1]=[{type:0,data:_n(n.e.c+1)}],R[2]=[{type:0,data:_n(n.e.r+1)}],R[3]=[{type:0,data:_n(se)}],R[4]=[{type:0,data:_n(n.e.r+1)}]}j.messages[0].data=Oa(R);var Me=Rf(V),re=Df(Me);I.content=re,I.size=I.content.length})()}he.data=Oa(te)}M[3][0].data=Oa(fe)}g[4][0].data=Oa(M)}h.messages[0].data=Oa(g);var Ie=Rf(f),S=Df(Ie);return d.content=S,d.size=d.content.length,A}function i7(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function UI(t){i7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function OI(t){i7([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function fve(t){return $r.WS.indexOf(t)>-1?"sheet":t==$r.CS?"chart":t==$r.DS?"dialog":t==$r.MS?"macro":t&&t.length?t:"sheet"}function mve(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,fve(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function pve(t,e,r,n,s,a,o,l,c,A,u,d){try{a[n]=sg(Co(t,r,!0),e);var f=Ys(t,e),h;switch(l){case"sheet":h=Uge(f,e,s,c,a[n],A,u,d);break;case"chart":if(h=Oge(f,e,s,c,a[n],A,u,d),!h||!h["!drawel"])break;var m=Ep(h["!drawel"].Target,e),p=nx(m),x=_fe(Co(t,m,!0),sg(Co(t,p,!0),m)),g=Ep(x,m),w=nx(g);h=dge(Co(t,g,!0),g,c,sg(Co(t,w,!0),g),A,h);break;case"macro":h=Mge(f,e,s,c,a[n],A,u,d);break;case"dialog":h=Qge(f,e,s,c,a[n],A,u,d);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];a&&a[n]&&Ps(a[n]).forEach(function(k){var P="";if(a[n][k].Type==$r.CMNT){P=Ep(a[n][k].Target,e);var L=qge(Ys(t,P,!0),P,c);if(!L||!L.length)return;ZP(h,L,!1)}a[n][k].Type==$r.TCMNT&&(P=Ep(a[n][k].Target,e),b=b.concat(Bfe(Ys(t,P,!0),c)))}),b&&b.length&&ZP(h,b,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function zo(t){return t.charAt(0)=="/"?t.slice(1):t}function gve(t,e){if(Am(),e=e||{},UI(e),tl(t,"META-INF/manifest.xml")||tl(t,"objectdata.xml"))return A3(t,e);if(tl(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof AC<"u"){if(t.FileIndex)return AC(t);var r=wr.utils.cfb_new();return yP(t).forEach(function(Y){Qr(r,Y,Sce(t,Y))}),AC(r)}throw new Error("Unsupported NUMBERS file")}if(!tl(t,"[Content_Types].xml"))throw tl(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):tl(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=yP(t),s=wAe(Co(t,"[Content_Types].xml")),a=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Ys(t,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Ys(t,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},A={};if(!e.bookSheets&&!e.bookProps){if(ag=[],s.sst)try{ag=Kge(Ys(t,zo(s.sst)),s.sst,e)}catch(Y){if(e.WTF)throw Y}e.cellStyles&&s.themes.length&&(c=Hge(Co(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(A=Vge(Ys(t,zo(s.style)),s.style,c,e))}s.links.map(function(Y){try{var me=sg(Co(t,nx(zo(Y))),Y);return $ge(Ys(t,zo(Y)),me,Y,e)}catch{}});var u=Lge(Ys(t,zo(s.workbooks[0])),s.workbooks[0],e),d={},f="";s.coreprops.length&&(f=Ys(t,zo(s.coreprops[0]),!0),f&&(d=z8(f)),s.extprops.length!==0&&(f=Ys(t,zo(s.extprops[0]),!0),f&&SAe(f,d,e)));var h={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(f=Co(t,zo(s.custprops[0]),!0),f&&(h=FAe(f,e)));var m={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(me){return me.name}):d.Worksheets&&d.SheetNames.length>0&&(o=d.SheetNames),e.bookProps&&(m.Props=d,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&s.calcchain&&(p=Gge(Ys(t,zo(s.calcchain)),s.calcchain));var x=0,g={},w,b;{var k=u.Sheets;d.Worksheets=k.length,d.SheetNames=[];for(var P=0;P!=k.length;++P)d.SheetNames[P]=k[P].name}var L=a?"bin":"xml",E=s.workbooks[0].lastIndexOf("/"),_=(s.workbooks[0].slice(0,E+1)+"_rels/"+s.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");tl(t,_)||(_="xl/_rels/workbook."+L+".rels");var B=sg(Co(t,_,!0),_.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=zge(Ys(t,zo(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Ife(Ys(t,zo(s.people[0])),e)),B&&(B=mve(B,u.Sheets));var M=Ys(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=d.Worksheets;++x){var F="sheet";if(B&&B[x]?(w="xl/"+B[x][1].replace(/[\/]?xl\//,""),tl(t,w)||(w=B[x][1]),tl(t,w)||(w=_.replace(/_rels\/.*$/,"")+B[x][1]),F=B[x][2]):(w="xl/worksheets/sheet"+(x+1-M)+"."+L,w=w.replace(/sheet0\./,"sheet.")),b=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(d.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,O=0;O!=e.sheets.length;++O)typeof e.sheets[O]=="number"&&e.sheets[O]==x&&(T=1),typeof e.sheets[O]=="string"&&e.sheets[O].toLowerCase()==d.SheetNames[x].toLowerCase()&&(T=1);if(!T)continue e}}pve(t,w,b,d.SheetNames[x],x,g,o,F,e,u,c,A)}return m={Directory:s,Workbook:u,Props:d,Custprops:h,Deps:p,Sheets:o,SheetNames:d.SheetNames,Strings:ag,Styles:A,Themes:c,SSF:ss(Cr)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(Y,me){Y=Y.replace(/^Root Entry[\/]/,""),m.keys.push(Y),m.files[Y]=t.FileIndex[me]}))),e&&e.bookVBA&&(s.vba.length>0?m.vbaraw=Ys(t,zo(s.vba[0]),!0):s.defaults&&s.defaults.bin===Lfe&&(m.vbaraw=Ys(t,"xl/vbaProject.bin",!0))),m}function xve(t,e){var r=e||{},n="Workbook",s=wr.find(t,n);try{if(n="/!DataSpaces/Version",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(zde(s.content),n="/!DataSpaces/DataSpaceMap",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Jde(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Xde(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Zde(s.content)}catch{}if(n="/EncryptionInfo",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=ehe(s.content);if(n="/EncryptedPackage",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function vve(t,e){return e.bookType=="ods"?a7(t,e):e.bookType=="numbers"?hve(t,e):e.bookType=="xlsb"?yve(t,e):wve(t,e)}function yve(t,e){l0=1024,t&&!t.SSF&&(t.SSF=ss(Cr)),t&&t.SSF&&(Am(),$2(t.SSF),e.revssf=W2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ig?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=jQ.indexOf(e.bookType)>-1,s=CI();OI(e=e||{});var a=AI(),o="",l=0;if(e.cellXfs=[],bd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Qr(a,o,W8(t.Props,e)),s.coreprops.push(o),Bn(e.rels,2,o,$r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],A=0;A<t.SheetNames.length;++A)(t.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(t.SheetNames[A]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Qr(a,o,Y8(t.Props)),s.extprops.push(o),Bn(e.rels,3,o,$r.EXT_PROPS),t.Custprops!==t.Props&&Ps(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Qr(a,o,Z8(t.Custprops)),s.custprops.push(o),Bn(e.rels,4,o,$r.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var u={"!id":{}},d=t.Sheets[t.SheetNames[l-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Qr(a,o,Jge(l-1,o,e,t,u)),s.sheets.push(o),Bn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$r.WS[0])}if(d){var h=d["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Qr(a,p,Zge(h,p)),s.comments.push(p),Bn(u,-1,"../comments"+l+"."+r,$r.CMNT),m=!0),d["!legacy"]&&m&&Qr(a,"xl/drawings/vmlDrawing"+l+".vml",kQ(l,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Qr(a,nx(o),w0(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Qr(a,o,Yge(e.Strings,o,e)),s.strs.push(o),Bn(e.wbrels,-1,"sharedStrings."+r,$r.SST)),o="xl/workbook."+r,Qr(a,o,Wge(t,o)),s.workbooks.push(o),Bn(e.rels,1,o,$r.WB),o="xl/theme/theme1.xml",Qr(a,o,FI(t.Themes,e)),s.themes.push(o),Bn(e.wbrels,-1,"theme/theme1.xml",$r.THEME),o="xl/styles."+r,Qr(a,o,Xge(t,o,e)),s.styles.push(o),Bn(e.wbrels,-1,"styles."+r,$r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Qr(a,o,t.vbaraw),s.vba.push(o),Bn(e.wbrels,-1,"vbaProject.bin",$r.VBA)),o="xl/metadata."+r,Qr(a,o,exe(o)),s.metadata.push(o),Bn(e.wbrels,-1,"metadata."+r,$r.XLMETA),Qr(a,"[Content_Types].xml",G8(s,e)),Qr(a,"_rels/.rels",w0(e.rels)),Qr(a,"xl/_rels/workbook."+r+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,a}function wve(t,e){l0=1024,t&&!t.SSF&&(t.SSF=ss(Cr)),t&&t.SSF&&(Am(),$2(t.SSF),e.revssf=W2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ig?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=jQ.indexOf(e.bookType)>-1,s=CI();OI(e=e||{});var a=AI(),o="",l=0;if(e.cellXfs=[],bd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Qr(a,o,W8(t.Props,e)),s.coreprops.push(o),Bn(e.rels,2,o,$r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],A=0;A<t.SheetNames.length;++A)(t.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(t.SheetNames[A]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Qr(a,o,Y8(t.Props)),s.extprops.push(o),Bn(e.rels,3,o,$r.EXT_PROPS),t.Custprops!==t.Props&&Ps(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Qr(a,o,Z8(t.Custprops)),s.custprops.push(o),Bn(e.rels,4,o,$r.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Qr(a,o,KQ(l-1,e,t,d)),s.sheets.push(o),Bn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$r.WS[0])}if(f){var m=f["!comments"],p=!1,x="";if(m&&m.length>0){var g=!1;m.forEach(function(w){w[1].forEach(function(b){b.T==!0&&(g=!0)})}),g&&(x="xl/threadedComments/threadedComment"+l+"."+r,Qr(a,x,Sfe(m,u,e)),s.threadedcomments.push(x),Bn(d,-1,"../threadedComments/threadedComment"+l+"."+r,$r.TCMNT)),x="xl/comments"+l+"."+r,Qr(a,x,TQ(m)),s.comments.push(x),Bn(d,-1,"../comments"+l+"."+r,$r.CMNT),p=!0}f["!legacy"]&&p&&Qr(a,"xl/drawings/vmlDrawing"+l+".vml",kQ(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Qr(a,nx(o),w0(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Qr(a,o,vQ(e.Strings,e)),s.strs.push(o),Bn(e.wbrels,-1,"sharedStrings."+r,$r.SST)),o="xl/workbook."+r,Qr(a,o,WQ(t)),s.workbooks.push(o),Bn(e.rels,1,o,$r.WB),o="xl/theme/theme1.xml",Qr(a,o,FI(t.Themes,e)),s.themes.push(o),Bn(e.wbrels,-1,"theme/theme1.xml",$r.THEME),o="xl/styles."+r,Qr(a,o,BQ(t,e)),s.styles.push(o),Bn(e.wbrels,-1,"styles."+r,$r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Qr(a,o,t.vbaraw),s.vba.push(o),Bn(e.wbrels,-1,"vbaProject.bin",$r.VBA)),o="xl/metadata."+r,Qr(a,o,FQ()),s.metadata.push(o),Bn(e.wbrels,-1,"metadata."+r,$r.XLMETA),u.length>1&&(o="xl/persons/person.xml",Qr(a,o,Ffe(u)),s.people.push(o),Bn(e.wbrels,-1,"persons/person.xml",$r.PEOPLE)),Qr(a,"[Content_Types].xml",G8(s,e)),Qr(a,"_rels/.rels",w0(e.rels)),Qr(a,"xl/_rels/workbook."+r+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,a}function MI(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=To(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function bve(t,e){return wr.find(t,"EncryptedPackage")?xve(t,e):ZQ(t,e)}function Nve(t,e){var r,n=t,s=e||{};return s.type||(s.type=Hr&&Buffer.isBuffer(t)?"buffer":"base64"),r=w8(n,s),gve(r,s)}function o7(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return DE(t.slice(r),e);default:break e}return K0.to_workbook(t,e)}function Cve(t,e){var r="",n=MI(t,e);switch(e.type){case"base64":r=To(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Dh(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Rn(r)),e.type="binary",o7(r,e)}function _ve(t,e){var r=t;return e.type=="base64"&&(r=To(r)),r=Xg.utils.decode(1200,r.slice(2),"str"),e.type="binary",o7(r,e)}function Eve(t){return t.match(/[^\x00-\x7F]/)?vc(t):t}function uC(t,e,r,n){return n?(r.type="string",K0.to_workbook(t,r)):K0.to_workbook(e,r)}function OE(t,e){aI();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return OE(new Uint8Array(t),(r=ss(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),N0={},r.dateNF&&(N0.dateNF=r.dateNF),r.type||(r.type=Hr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Hr?"buffer":"binary",n=yce(t),typeof Uint8Array<"u"&&!Hr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Eve(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ss(r),r.type="array",OE(iI(n),r)}switch((s=MI(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return bve(wr.read(n,r),r);break;case 9:if(s[1]<=8)return ZQ(n,r);break;case 60:return DE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return kde(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return gQ.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Nve(n,r):uC(t,n,r,a);case 239:return s[3]===60?DE(n,r):uC(t,n,r,a);case 255:if(s[1]===254)return _ve(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return gh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return gh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return RE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return CQ.to_workbook(n,r);break;case 10:case 13:case 32:return Cve(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Fde.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?RE.to_workbook(n,r):uC(t,n,r,a)}function l7(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Mx(e.file,wr.write(t,{type:Hr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return wr.write(t,e)}function Bve(t,e){var r=ss(e||{}),n=vve(t,r);return Sve(n,r)}function Sve(t,e){var r={},n=Hr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?wr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(G2(s))}return e.password&&typeof encrypt_agile<"u"?l7(encrypt_agile(s,e.password),e):e.type==="file"?Mx(e.file,s):e.type=="string"?Rn(s):s}function Ive(t,e){var r=e||{},n=Exe(t,r);return l7(n,r)}function dc(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Yg(vc(n));case"binary":return vc(n);case"string":return t;case"file":return Mx(e.file,n,"utf8");case"buffer":return Hr?jA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):dc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Fve(t,e){switch(e.type){case"base64":return Yg(t);case"binary":return t;case"string":return t;case"file":return Mx(e.file,t,"binary");case"buffer":return Hr?jA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function P1(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Yg(r):e.type=="string"?Rn(r):r;case"file":return Mx(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function c7(t,e){aI(),bge(t);var r=ss(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=c7(t,r);return r.type="array",G2(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return dc(vxe(t,r),r);case"slk":case"sylk":return dc(pQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return dc(t7(t.Sheets[t.SheetNames[s]],r),r);case"txt":return Fve(A7(t.Sheets[t.SheetNames[s]],r),r);case"csv":return dc(QI(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return dc(gQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return P1(RE.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return dc(K0.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return dc(CQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return dc(xQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return dc(a7(t,r),r);case"wk1":return P1(gh.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return P1(gh.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),P1(e7(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Ive(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Bve(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kve(t,e,r,n,s,a,o,l){var c=$s(r),A=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),d=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(A===void 0)continue;a[h]!=null&&(f[a[h]]=A);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[h]!=null){if(p==null)if(m.t=="e"&&p===null)f[a[h]]=null;else if(A!==void 0)f[a[h]]=A;else if(u&&p===null)f[a[h]]=null;else continue;else f[a[h]]=u&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:IA(m,p,l);p!=null&&(d=!1)}}return{row:f,isempty:d}}function Uw(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},A=e||{},u=A.range!=null?A.range:t["!ref"];switch(A.header===1?n=1:A.header==="A"?n=2:Array.isArray(A.header)?n=3:A.header==null&&(n=0),typeof u){case"string":c=hn(u);break;case"number":c=hn(t["!ref"]),c.s.r=u;break;default:c=u}n>0&&(s=0);var d=$s(c.s.r),f=[],h=[],m=0,p=0,x=Array.isArray(t),g=c.s.r,w=0,b={};x&&!t[g]&&(t[g]=[]);var k=A.skipHidden&&t["!cols"]||[],P=A.skipHidden&&t["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(k[w]||{}).hidden)switch(f[w]=ws(w),r=x?t[g][w]:t[f[w]+d],n){case 1:a[w]=w-c.s.c;break;case 2:a[w]=f[w];break;case 3:a[w]=A.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=IA(r,null,A),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}a[w]=l}for(g=c.s.r+s;g<=c.e.r;++g)if(!(P[g]||{}).hidden){var L=kve(t,c,g,f,n,a,x,A);(L.isempty===!1||(n===1?A.blankrows!==!1:A.blankrows))&&(h[m++]=L.row)}return h.length=m,h}var m3=/"/g;function Tve(t,e,r,n,s,a,o,l){for(var c=!0,A=[],u="",d=$s(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var h=l.dense?(t[r]||[])[f]:t[n[f]+d];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:IA(h,null,l));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===s||p===a||p===34||l.forceQuotes){u='"'+u.replace(m3,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(m3,'""')+'"')):u="";A.push(u)}return l.blankrows===!1&&c?null:A.join(o)}function QI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=hn(t["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),A=new RegExp((a=="|"?"\\|":a)+"+$"),u="",d=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(f[m]||{}).hidden||(d[m]=ws(m));for(var p=0,x=s.s.r;x<=s.e.r;++x)(h[x]||{}).hidden||(u=Tve(t,s,x,d,o,c,a,n),u!=null&&(n.strip&&(u=u.replace(A,"")),(u||n.blankrows!==!1)&&r.push((p++?l:"")+u)));return delete n.dense,r.join("")}function A7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=QI(t,e);return r}function jve(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=hn(t["!ref"]),a="",o=[],l,c=[],A=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)o[l]=ws(l);for(var u=s.s.r;u<=s.e.r;++u)for(a=$s(u),l=s.s.c;l<=s.e.c;++l)if(e=o[l]+a,r=A?(t[u]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function u7(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?bs(n.origin):n.origin;o=c.r,l=c.c}var A,u={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(a["!ref"]){var d=hn(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+e.length-1+s)}else o==-1&&(o=0,u.e.r=e.length-1+s);var f=n.header||[],h=0;e.forEach(function(p,x){Ps(p).forEach(function(g){(h=f.indexOf(g))==-1&&(f[h=f.length]=g);var w=p[g],b="z",k="",P=_r({c:l+h,r:o+x+s});A=Ax(a,P),w&&typeof w=="object"&&!(w instanceof Date)?a[P]=w:(typeof w=="number"?b="n":typeof w=="boolean"?b="b":typeof w=="string"?b="s":w instanceof Date?(b="d",n.cellDates||(b="n",w=ga(w)),k=n.dateNF||Cr[14]):w===null&&n.nullError&&(b="e",w=0),A?(A.t=b,A.v=w,delete A.w,delete A.R,k&&(A.z=k)):a[P]=A={t:b,v:w},k&&(A.z=k))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var m=$s(o);if(s)for(h=0;h<f.length;++h)a[ws(h+l)+m]={t:"s",v:f[h]};return a["!ref"]=Lr(u),a}function Pve(t,e){return u7(null,t,e)}function Ax(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=bs(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ax(t,_r(e)):Ax(t,_r({r:e,c:r||0}))}function Rve(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function VI(){return{SheetNames:[],Sheets:{}}}function HI(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(zQ(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Dve(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Rve(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Lve(t,e){return t.z=e,t}function d7(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Uve(t,e,r){return d7(t,"#"+e,r)}function Ove(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Mve(t,e,r,n){for(var s=typeof e!="string"?e:hn(e),a=typeof e=="string"?e:Lr(e),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=Ax(t,o,l);c.t="n",c.F=a,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var R1={encode_col:ws,encode_row:$s,encode_cell:_r,encode_range:Lr,decode_col:xI,decode_row:gI,split_cell:Yce,decode_cell:bs,decode_range:to,format_cell:IA,sheet_add_aoa:O8,sheet_add_json:u7,sheet_add_dom:r7,aoa_to_sheet:um,json_to_sheet:Pve,table_to_sheet:n7,table_to_book:zxe,sheet_to_csv:QI,sheet_to_txt:A7,sheet_to_json:Uw,sheet_to_html:t7,sheet_to_formulae:jve,sheet_to_row_object_array:Uw,sheet_get_cell:Ax,book_new:VI,book_append_sheet:HI,book_set_sheet_visibility:Dve,cell_set_number_format:Lve,cell_set_hyperlink:d7,cell_set_internal_link:Uve,cell_add_comment:Ove,sheet_set_array_formula:Mve,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Qve=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function $n(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function fu(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Ld(t,e=1){const r=Math.floor(fu(t,e));return r>0?r:e}function Vve(t){return Object.values(t||{}).every(r=>$n(r)==="")}function ap(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(s=>n.set($n(s),s));for(const s of e){const a=n.get($n(s));if(a!=null)return t[a]}}function Hve(){const{refreshKey:t,refresh:e}=Xl(),[r,n]=N.useState(!0),[s,a]=N.useState(""),[o,l]=N.useState([]),[c,A]=N.useState(""),[u,d]=N.useState(""),[f,h]=N.useState(0),[m,p]=N.useState(1),[x,g]=N.useState(null),[w,b]=N.useState(""),[k,P]=N.useState(""),[L,E]=N.useState(0),[_,B]=N.useState(1),[M,F]=N.useState(""),[T,O]=N.useState(!1),[Y,me]=N.useState(""),[ae,fe]=N.useState([]),[he,te]=N.useState([]),[pe,Ie]=N.useState(!1);N.useEffect(()=>{(async()=>{n(!0),a("");try{const q=await Ct(Ot(At(je,"products_candies"),Dr("name","asc"))),oe=[];q.forEach(de=>{const Be=de.data();oe.push({id:de.id,name:Be.name||"",category:Be.category||"",providerPrice:Number(Be.providerPrice||0),unitsPerPackage:Number(Be.unitsPerPackage||1),createdAt:Be.createdAt})}),l(oe)}catch(q){console.error(q),a(" Error cargando catlogo de dulces.")}finally{n(!1)}})()},[t]);const S=N.useMemo(()=>{const q=$n(M);return q?o.filter(oe=>`${oe.category} ${oe.name}`.toLowerCase().includes(q)):o},[o,M]),I=N.useMemo(()=>{const q=new Set;return o.forEach(oe=>{const de=String(oe.category||"").trim();de&&q.add(de)}),Array.from(q).sort((oe,de)=>oe.localeCompare(de,"es"))},[o]),V=()=>{A(""),d(""),h(0),p(1)},j=async q=>{q.preventDefault(),a("");const oe=String(c||"").trim(),de=String(u||"").trim(),Be=Math.max(0,fu(f,0)),He=Ld(m,1);if(!oe)return a(" La categora es requerida.");if(!de)return a(" El nombre del producto es requerido.");if(Be<=0)return a(" El precio proveedor debe ser > 0.");if(He<=0)return a(" Und x paquete debe ser > 0.");if(o.some(Je=>$n(Je.category)===$n(oe)&&$n(Je.name)===$n(de)))return a(" Ya existe un producto con esa categora y nombre.");try{n(!0);const Je={category:oe,name:de,providerPrice:Be,unitsPerPackage:He,createdAt:Gt.now()},ct=await Jr(At(je,"products_candies"),Je);l(at=>[...at,{id:ct.id,...Je}].sort((mt,st)=>mt.name.localeCompare(st.name,"es"))),a(" Producto creado."),V()}catch(Je){console.error(Je),a(" Error creando producto.")}finally{n(!1)}},U=q=>{g(q.id),b(q.category),P(q.name),E(q.providerPrice),B(q.unitsPerPackage||1),a("")},G=()=>{g(null),b(""),P(""),E(0),B(1)},R=async()=>{if(!x)return;a("");const q=String(w||"").trim(),oe=String(k||"").trim(),de=Math.max(0,fu(L,0)),Be=Ld(_,1);if(!q)return a(" La categora es requerida.");if(!oe)return a(" El nombre del producto es requerido.");if(de<=0)return a(" El precio proveedor debe ser > 0.");if(Be<=0)return a(" Und x paquete debe ser > 0.");if(o.some($e=>$e.id!==x&&$n($e.category)===$n(q)&&$n($e.name)===$n(oe)))return a(" Ya existe otro producto con esa categora y nombre.");try{n(!0),await Tr(Tt(je,"products_candies",x),{category:q,name:oe,providerPrice:de,unitsPerPackage:Be,updatedAt:Gt.now()}),l($e=>$e.map(Je=>Je.id===x?{...Je,category:q,name:oe,providerPrice:de,unitsPerPackage:Be}:Je).sort((Je,ct)=>Je.name.localeCompare(ct.name,"es"))),a(" Producto actualizado."),G()}catch($e){console.error($e),a(" Error actualizando producto.")}finally{n(!1)}},X=async q=>{if(confirm(`Eliminar "${q.name}" (${q.category}) del catlogo?`))try{n(!0),await dn(Tt(je,"products_candies",q.id)),l(de=>de.filter(Be=>Be.id!==q.id)),a(" Producto eliminado.")}catch(de){console.error(de),a(" Error eliminando producto.")}finally{n(!1)}},se=()=>{const q=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24}],oe=R1.json_to_sheet(q),de=R1.book_new();R1.book_append_sheet(de,oe,"Productos");const Be=c7(de,{type:"array",bookType:"xlsx"}),He=new Blob([Be],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),$e=URL.createObjectURL(He),Je=document.createElement("a");Je.href=$e,Je.download="template_productos_dulces.xlsx",document.body.appendChild(Je),Je.click(),Je.remove(),URL.revokeObjectURL($e)},ye=q=>{const oe=[],de=[];q.forEach((He,$e)=>{if(!He||typeof He!="object"||Vve(He))return;const Je=String(ap(He,["Id","ID","productId","docId"])??"").trim(),ct=String(ap(He,["Categoria","Categora","Category","cat","category"])??"").trim(),at=String(ap(He,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),mt=ap(He,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),st=ap(He,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),Le=Math.max(0,fu(mt,0)),ut=Ld(st,1),be=$e+2;ct||de.push(`Fila ${be}: falta Categoria.`),at||de.push(`Fila ${be}: falta Producto/Nombre.`),Le<=0&&de.push(`Fila ${be}: PrecioProveedor debe ser > 0.`),ut<=0&&de.push(`Fila ${be}: UnidadesPorPaquete debe ser > 0.`),ct&&at&&Le>0&&ut>0&&oe.push({id:Je||void 0,category:ct,name:at,providerPrice:Le,unitsPerPackage:ut,_raw:He})});const Be=new Map;for(const He of oe){const $e=He.id?`id::${He.id}`:`${$n(He.category)}::${$n(He.name)}`;Be.set($e,He)}return{rows:Array.from(Be.values()),errors:de}},z=async q=>{if(a(""),te([]),fe([]),me((q==null?void 0:q.name)||""),!q)return;const oe=q.name.toLowerCase(),de=oe.endsWith(".xlsx")||oe.endsWith(".xls"),Be=oe.endsWith(".csv");if(!de&&!Be){te(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ie(!0);const He=new FileReader,$e=await new Promise((ut,be)=>{He.onerror=()=>be(new Error("No se pudo leer el archivo.")),He.onload=()=>ut(He.result),He.readAsArrayBuffer(q)}),Je=OE(new Uint8Array($e),{type:"array"}),ct=Je.SheetNames[0],at=Je.Sheets[ct],mt=R1.sheet_to_json(at,{defval:""}),{rows:st,errors:Le}=ye(mt);fe(st),te(Le),st.length===0&&Le.length===0&&te(["No se encontraron filas vlidas para importar."])}catch(He){console.error(He),te(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ie(!1)}},Me=(q,oe)=>{fe(de=>{const Be=[...de],He=Be[q];return He?(Be[q]={...He,...oe},Be):de})},re=async()=>{if(a(""),he.length>0){a(" Correg los errores antes de importar.");return}if(ae.length===0){a(" No hay filas para importar.");return}try{Ie(!0);const q={},oe={};o.forEach($e=>{q[$e.id]=$e,oe[`${$n($e.category)}::${$n($e.name)}`]=$e});const de=Wh(je);let Be=0,He=0;for(const $e of ae){const Je=String($e.category||"").trim(),ct=String($e.name||"").trim(),at=Math.max(0,fu($e.providerPrice,0)),mt=Ld($e.unitsPerPackage,1);if(!Je||!ct||at<=0||mt<=0)continue;let st;if($e.id&&q[$e.id])st=q[$e.id];else{const Le=`${$n(Je)}::${$n(ct)}`;st=oe[Le]}if(st)de.update(Tt(je,"products_candies",st.id),{category:Je,name:ct,providerPrice:at,unitsPerPackage:mt,updatedAt:Gt.now()}),He+=1;else{const Le=Tt(At(je,"products_candies"));de.set(Le,{category:Je,name:ct,providerPrice:at,unitsPerPackage:mt,createdAt:Gt.now()}),Be+=1}}await de.commit(),a(` Importacin lista. Creados: ${Be}, Actualizados: ${He}`),O(!1),fe([]),te([]),me(""),e()}catch(q){console.error(q),a(" Error importando productos a Firestore.")}finally{Ie(!1)}},W=N.useMemo(()=>{const q=new Set(o.map(He=>He.id)),oe=new Set(o.map(He=>`${$n(He.category)}::${$n(He.name)}`));let de=0,Be=0;for(const He of ae){if(He.id&&q.has(He.id)){de+=1;continue}const $e=`${$n(He.category)}::${$n(He.name)}`;oe.has($e)?de+=1:Be+=1}return{willCreate:Be,willUpdate:de,total:ae.length}},[ae,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catlogo de Productos (Dulces)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(kc,{onClick:e,loading:r||pe}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{O(!0),fe([]),te([]),me("")},children:"Importar (.xlsx)"})]})]}),i.jsxs("form",{onSubmit:j,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-5 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:q=>A(q.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:u,onChange:q=>d(q.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(f)?"":f,onChange:q=>h(Math.max(0,fu(q.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:q=>p(Ld(q.target.value,1))})]}),i.jsxs("div",{className:"md:col-span-5 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:V,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:M,onChange:q=>F(q.target.value),placeholder:"Buscar por categora o producto"})]}),i.jsxs("div",{className:"w-full md:w-1/2 text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:S.length})]})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin productos."})}):S.map(q=>{const oe=x===q.id;return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:oe?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:w,onChange:de=>b(de.target.value)}):q.category}),i.jsx("td",{className:"p-2 border",children:oe?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:k,onChange:de=>P(de.target.value)}):q.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:oe?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(L)?"":L,onChange:de=>E(Math.max(0,fu(de.target.value,0)))}):Qve(q.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:oe?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:_,onChange:de=>B(Ld(de.target.value,1))}):q.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:oe?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:R,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:G,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>U(q),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>X(q),type:"button",children:"Borrar"})]})})]},q.id)})})]})}),s&&i.jsx("p",{className:"mt-2 text-sm",children:s}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>O(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:se,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:q=>{var oe;return z(((oe=q.target.files)==null?void 0:oe[0])||null)}}),Y&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:Y})]}),pe&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),he.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:he.slice(0,50).map((q,oe)=>i.jsx("li",{children:q},oe))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",W.total," filas (Crear:"," ",W.willCreate," / Actualizar:"," ",W.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:re,disabled:pe||ae.length===0||he.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1100px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):ae.slice(0,300).map((q,oe)=>{const de=q.id?o.some($e=>$e.id===q.id):!1,Be=o.some($e=>`${$n($e.category)}::${$n($e.name)}`==`${$n(q.category)}::${$n(q.name)}`),He=de||Be;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:q.id||"",onChange:$e=>Me(oe,{id:$e.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:q.category,onChange:$e=>Me(oe,{category:$e.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:q.name,onChange:$e=>Me(oe,{name:$e.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(q.providerPrice)?"":q.providerPrice,onChange:$e=>Me(oe,{providerPrice:Math.max(0,fu($e.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:q.unitsPerPackage,onChange:$e=>Me(oe,{unitsPerPackage:Ld($e.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${He?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:He?"ACTUALIZA":"CREA"})})]},`${q.id||""}-${oe}`)})})]}),i.jsx("datalist",{id:"categories-list",children:I.map(q=>i.jsx("option",{value:q},q))})]}),ae.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",ae.length," filas (el import importa todas)."]})]})]})})]})}function KI(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),s=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):s>0?Math.floor(s*e):0}function cg(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):KI(t)}function Kve(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=KI(t);return r>0&&e>0?Math.floor(r/e):Math.max(0,Math.floor(Number(t.packages||0)))}function qve(t){if(typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages))return Math.max(0,Math.floor(Number(t.remainingPackages)));const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=cg(t);return Math.max(0,Math.floor(r/e))}async function Gve(t){const e=Tt(je,"candy_main_orders",t);if((await Xa(e)).exists())return e;const n=Ot(At(je,"candy_main_orders"),$t("orderId","==",t)),s=await Ct(n);return s.empty?null:Tt(je,"candy_main_orders",s.docs[0].id)}async function dC(t){if(!t)return;const e=await Gve(t);if(!e)return;const r=Ot(At(je,"inventory_candies"),$t("orderId","==",t)),n=await Ct(r),s=new Map;n.forEach(l=>{const c=l.data(),A=String(c.productId||"");if(!A)return;const u=Kve(c),d=qve(c),f=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),g=h*u,w=m*u,b=p*u,k=x*u,P=w-g,L=b-g,E=k-g;s.has(A)||s.set(A,{productId:A,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:f,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const _=s.get(A);_.packages+=u,_.remainingPackages+=d,_.subtotal+=g,_.totalRivas+=w,_.totalSanJorge+=b,_.totalIsla+=k,_.gainRivas+=P,_.gainSanJorge+=L,_.gainIsla+=E,_.providerPrice=h,_.unitPriceRivas=m||_.unitPriceRivas,_.unitPriceSanJorge=p||_.unitPriceSanJorge,_.unitPriceIsla=x||_.unitPriceIsla,_.unitsPerPackage=f||_.unitsPerPackage,_.name=String(c.productName||_.name),_.category=String(c.category||_.category)});const a=Array.from(s.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=a.reduce((l,c)=>l+Number(c.packages||0),0);await Tr(e,{totalPackages:o,items:a})}async function $ve(t){const{productId:e,saleDate:r,saleId:n}=t,s=t.quantityPacks,a=t.quantity;if(!e)throw new Error("Parmetros invlidos para allocateSaleFIFOCandy (sin producto)");const o=Ot(At(je,"inventory_candies"),$t("productId","==",e)),l=await Ct(o);if(l.empty)throw new Error("No hay inventario para este producto.");const c=l.docs.map(h=>({id:h.id,data:h.data()})).sort((h,m)=>{var b,k;const p=String(h.data.date||""),x=String(m.data.date||"");if(p!==x)return p<x?-1:1;const g=((b=h.data.createdAt)==null?void 0:b.seconds)??0,w=((k=m.data.createdAt)==null?void 0:k.seconds)??0;return g-w});let A=0;for(const h of c){const m=Number(h.data.unitsPerPackage??0);if(m>0){A=m;break}}if(!A)for(const h of c){const m=h.data,p=Number(m.totalUnits??0),x=Number(m.packages??0);if(p>0&&x>0){A=p/x;break}}A||(A=1);let u;if(s!=null&&!Number.isNaN(Number(s))){const h=Math.max(0,Math.floor(Number(s)));if(h<=0)throw new Error("La cantidad en paquetes debe ser mayor que cero.");u=h*A}else{const h=Math.max(0,Math.floor(Number(a||0)));if(h<=0)throw new Error("La cantidad debe ser mayor que cero.");u=h}const d=c.map(h=>Tt(je,"inventory_candies",h.id)),f=[];return await ma(je,async h=>{const m=await Promise.all(d.map(x=>h.get(x)));let p=u;for(let x=0;x<d.length&&p>0;x++){const g=d[x],w=m[x];if(!w.exists())continue;const b=w.data(),k=cg(b);if(k<=0)continue;const P=Math.min(k,p),L=Math.max(0,k-P),E=Math.max(1,Math.floor(Number(b.unitsPerPackage||1))),_=Math.floor(L/E);h.update(g,{remaining:L,remainingPackages:_,packages:_}),f.push({batchId:g.id,qty:P,batchDate:String(b.date||""),productName:String(b.productName||"")}),p-=P}if(p>0){const x=Math.ceil(p/A);throw new Error(`Inventario insuficiente. Faltan aproximadamente ${x} paquetes.`)}if(n)for(const x of f)await Jr(At(je,"batch_candies_allocations"),{saleId:n,saleDate:r,productId:e,productName:x.productName??"",batchId:x.batchId,batchDate:x.batchDate??"",quantity:x.qty,createdAt:Gt.now()})}),{allocations:f}}function zve(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const s=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const a of s){const o=String(a.inventorySellerId||""),l=Math.max(0,Math.floor(Number(a.units??a.qty??a.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const s=e[n],a=Array.isArray(s==null?void 0:s.allocations)?s.allocations:[];for(const o of a){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function ux(t){const e=t.split("#")[0],r=Tt(je,"sales_candies",e),n=await Xa(r);if(!n.exists())throw new Error("La venta no existe.");const s=n.data(),a=zve(s);if(a&&a.allocations.length>0){let A=0;return await ma(je,async u=>{const d={};for(const p of a.allocations){const x=p.inventorySellerId,g=Math.max(0,Math.floor(Number(p.units||0)));!x||g<=0||(d[x]=(d[x]||0)+g,A+=g)}const h=Object.keys(d).map(p=>Tt(je,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const g=x.data(),w=Number(g.remainingUnits??g.remaining??0),b=Math.max(0,Math.floor(Number(d[h[p].id]||0))),k=w+b,P=Math.max(1,Math.floor(Number(g.unitsPerPackage||1))),L=Math.floor(k/P);u.update(h[p],{remainingUnits:k,remainingPackages:L})}u.delete(r)}),{restored:A}}const o=[];if(Array.isArray(s.items)&&s.items.length>0){const A={};if(s.allocationsByItem&&typeof s.allocationsByItem=="object")for(const u of Object.keys(s.allocationsByItem)){const d=s.allocationsByItem[u],f=String((d==null?void 0:d.productId)||u||"");if(!f)continue;const h=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];A[f]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(s.allocationsByItem))for(const u of s.allocationsByItem){const d=String((u==null?void 0:u.productId)||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];A[d]=f.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const u of s.items){const d=String((u==null?void 0:u.productId)||"");if(!d)continue;const f=Math.max(0,Math.floor(Number((u==null?void 0:u.qty)||(u==null?void 0:u.quantity)||0))),h=Array.isArray(u==null?void 0:u.allocations)?u.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):A[d]||[];o.push({productId:d,productName:String((u==null?void 0:u.productName)||""),qty:f,allocations:h.length?h:void 0})}}else{const A=s.item||{},u=String(A.productId||s.productId||""),d=Math.max(0,Math.floor(Number(A.qty??s.quantity??0))),f=Array.isArray(s.allocations)?s.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];u&&d>0&&o.push({productId:u,productName:String(A.productName||s.productName||""),qty:d,allocations:f.length?f:void 0})}if(o.length===0)return await ma(je,async A=>{A.delete(r)}),{restored:0};if(o.every(A=>Array.isArray(A.allocations)&&A.allocations.length>0)){let A=0;return await ma(je,async u=>{const d=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));A+=p,d.push({ref:Tt(je,"inventory_candies",m.batchId),addBack:p})}const f=await Promise.all(d.map(h=>u.get(h.ref)));for(let h=0;h<d.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),x=cg(p),g=Math.max(0,Math.floor(Number(d[h].addBack||0))),w=x+g,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),k=Math.floor(w/b);u.update(d[h].ref,{remaining:w,remainingPackages:k,packages:k})}u.delete(r)}),{restored:A}}let c=0;return await ma(je,async A=>{const u={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=Ot(At(je,"inventory_candies"),$t("productId","==",p.productId)),w=(await Ct(x)).docs.map(b=>{const k=b.data(),P=KI(k),L=cg(k);return{id:b.id,date:String(k.date||""),baseUnits:P,remaining:L}}).sort((b,k)=>b.date.localeCompare(k.date));u[p.productId]=w}const d=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const w of p.allocations){const b=Math.max(0,Math.floor(Number(w.qty||0)));c+=b,d.push({id:w.batchId,addBack:b})}continue}const x=u[p.productId]||[];let g=p.qty;for(const w of x){if(g<=0)break;const b=Math.max(0,w.baseUnits-w.remaining);if(b<=0)continue;const k=Math.min(b,g);d.push({id:w.id,addBack:k}),c+=k,g-=k}for(const w of x){if(g<=0)break;const b=Math.min(g,p.qty);d.push({id:w.id,addBack:b}),c+=b,g-=b}}const f={};for(const p of d)f[p.id]=(f[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(f).map(p=>Tt(je,"inventory_candies",p)),m=await Promise.all(h.map(p=>A.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const g=x.data(),w=cg(g),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),k=w+b,P=Math.max(1,Math.floor(Number(g.unitsPerPackage||1))),L=Math.floor(k/P);A.update(h[p],{remaining:k,remainingPackages:L,packages:L})}A.delete(r)}),{restored:c}}async function Wve(t){return ux(t)}const Si=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function hC(t){return isFinite(t)?Math.round(t):0}function Sl(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function fC(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function Jve(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const s=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-s}function Xve(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[u,d]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[x,g]=N.useState(null),[w,b]=N.useState(""),[k,P]=N.useState(0),[L,E]=N.useState(!1),[_,B]=N.useState(""),[M,F]=N.useState(""),[T,O]=N.useState([]);N.useEffect(()=>{(async()=>{try{a(!0);const U=await Ct(At(je,"products_candies")),G=[];U.forEach(ye=>{const z=ye.data();G.push({id:ye.id,name:z.name??"(sin nombre)",category:z.category??"(sin categora)"})}),e(G);const R=Ot(At(je,"inventory_candies"),Dr("date","desc")),X=await Ct(R),se=[];X.forEach(ye=>{const z=ye.data(),Me=Number(z.unitsPerPackage||0),re=Number(z.totalUnits??z.quantity??(z.packages||0)*(z.unitsPerPackage||0)),W=Number(z.remaining??z.totalUnits??re??0);se.push({id:ye.id,productId:z.productId,productName:z.productName,category:z.category,measurement:z.measurement??"unidad",packages:Number(z.packages||0),unitsPerPackage:Me,totalUnits:re,remaining:W,remainingPackages:typeof z.remainingPackages=="number"?Number(z.remainingPackages):void 0,providerPrice:Number(z.providerPrice||0),subtotal:Number(z.subtotal||0),totalRivas:Number(z.totalRivas||0),totalSanJorge:Number(z.totalSanJorge||0),totalIsla:Number(z.totalIsla||0),gainRivas:Number(z.gainRivas||0),gainSanJorge:Number(z.gainSanJorge||0),gainIsla:Number(z.gainIsla||0),unitPriceRivas:Number(z.unitPriceRivas||0),unitPriceSanJorge:Number(z.unitPriceSanJorge||0),unitPriceIsla:Number(z.unitPriceIsla||0),date:z.date,createdAt:z.createdAt,status:z.status??"PENDIENTE",orderId:z.orderId??null})}),n(se)}catch(U){console.error(U),l(" Error cargando inventario.")}finally{a(!1)}})()},[]);const Y=N.useMemo(()=>r.filter(U=>!(c&&U.date<c||u&&U.date>u||f&&U.productId!==f||m&&String(U.category||"")!==m)),[r,c,u,f,m]),me=N.useMemo(()=>{const U=new Set;for(const G of t)G.category&&U.add(G.category);return Array.from(U).sort((G,R)=>G.localeCompare(R))},[t]),ae=N.useMemo(()=>{const U=Y.reduce((z,Me)=>z+Sl(Me),0),G=Y.reduce((z,Me)=>z+fC(Me),0),R=Y.reduce((z,Me)=>{const re=Sl(Me);return z+Number(Me.providerPrice||0)*re},0),X=Y.reduce((z,Me)=>{const re=Sl(Me);return z+Number(Me.unitPriceRivas||0)*re},0),se=Y.reduce((z,Me)=>{const re=Sl(Me);return z+Number(Me.unitPriceSanJorge||0)*re},0),ye=Y.reduce((z,Me)=>{const re=Sl(Me);return z+Number(Me.unitPriceIsla||0)*re},0);return{totalPaquetes:U,totalPaquetesRestantes:G,totalSubtotal:R,totalRivas:X,totalSJ:se,totalIsla:ye}},[Y]),fe=N.useMemo(()=>{let U=0,G=0;for(const R of Y)R.status==="PENDIENTE"&&(U+=1),R.status==="PAGADO"&&(G+=1);return{totalLotes:Y.length,pendientes:U,pagados:G}},[Y]),he=N.useMemo(()=>{const U=new Map;for(const R of Y){const X=String(R.productId||"");X&&(U.has(X)||U.set(X,{batches:[]}),U.get(X).batches.push(R))}const G=[];for(const[R,X]of U.entries()){const se=[...X.batches].sort(Jve),ye=se[0],z=se.reduce((at,mt)=>at+Sl(mt),0),Me=se.reduce((at,mt)=>at+fC(mt),0),re=Number((ye==null?void 0:ye.providerPrice)||0),W=Number((ye==null?void 0:ye.unitPriceRivas)||0),q=Number((ye==null?void 0:ye.unitPriceIsla)||0),oe=se.reduce((at,mt)=>{const st=Sl(mt);return at+Number(mt.providerPrice||0)*st},0),de=se.reduce((at,mt)=>{const st=Sl(mt);return at+Number(mt.unitPriceRivas||0)*st},0),Be=se.reduce((at,mt)=>{const st=Sl(mt);return at+Number(mt.unitPriceIsla||0)*st},0),He=de-oe,$e=Be-oe;let Je="",ct;for(const at of se)(!Je||String(at.date||"")>Je)&&(Je=String(at.date||""),ct=at.createdAt);G.push({productId:R,productName:(ye==null?void 0:ye.productName)||"",category:(ye==null?void 0:ye.category)||"",totalPackages:z,remainingPackages:Me,providerPrice:re,unitPriceRivas:W,unitPriceIsla:q,subtotal:oe,totalRivas:de,totalIsla:Be,gainRivas:He,gainIsla:$e,lastDate:Je,lastCreatedAt:ct,batchCount:se.length})}return G.sort((R,X)=>String(X.lastDate).localeCompare(String(R.lastDate))),G},[Y]),te=U=>{g(U.id),b(U.date),P(U.providerPrice),l("")},pe=()=>{g(null),b(""),P(0)},Ie=async()=>{if(!x)return;const U=r.find(Be=>Be.id===x);if(!U)return;if(k<0){l("El precio proveedor no puede ser negativo.");return}const G=Sl(U),R=k*G,X=G>0?R/.8:0,se=G>0?R/.85:0,ye=G>0?R/.7:0,z=X-R,Me=se-R,re=ye-R,W=G>0?hC(X/G):0,q=G>0?hC(se/G):0,oe=G>0?hC(ye/G):0,de=Tt(je,"inventory_candies",x);await Tr(de,{date:w,providerPrice:k,subtotal:R,totalRivas:X,totalSanJorge:se,totalIsla:ye,gainRivas:z,gainSanJorge:Me,gainIsla:re,unitPriceRivas:W,unitPriceSanJorge:q,unitPriceIsla:oe}),n(Be=>Be.map(He=>He.id===x?{...He,date:w,providerPrice:k,subtotal:R,totalRivas:X,totalSanJorge:se,totalIsla:ye,gainRivas:z,gainSanJorge:Me,gainIsla:re,unitPriceRivas:W,unitPriceSanJorge:q,unitPriceIsla:oe}:He)),U.orderId&&await dC(String(U.orderId)),l(" Lote de dulces actualizado"),pe()},S=async U=>{confirm(`Marcar PAGADO el lote del ${U.date} (${U.productName})?`)&&(await Tr(Tt(je,"inventory_candies",U.id),{status:"PAGADO"}),n(R=>R.map(X=>X.id===U.id?{...X,status:"PAGADO"}:X)),l(" Lote marcado como pagado"))},I=async U=>{confirm(`Eliminar el lote del ${U.date} (${U.productName})?`)&&(await dn(Tt(je,"inventory_candies",U.id)),n(R=>R.filter(X=>X.id!==U.id)),U.orderId&&await dC(String(U.orderId)),l(" Lote eliminado"))},V=async(U,G)=>{try{a(!0),l("");const R=Ot(At(je,"inventory_candies"),$t("productId","==",U),Dr("date","desc")),X=await Ct(R),se=[];X.forEach(ye=>{const z=ye.data(),Me=Number(z.unitsPerPackage||0),re=Number(z.totalUnits??z.quantity??(z.packages||0)*(z.unitsPerPackage||0)),W=Number(z.remaining??z.totalUnits??re??0);se.push({id:ye.id,productId:z.productId,productName:z.productName,category:z.category,measurement:z.measurement??"unidad",packages:Number(z.packages||0),unitsPerPackage:Me,totalUnits:re,remaining:W,remainingPackages:typeof z.remainingPackages=="number"?Number(z.remainingPackages):void 0,providerPrice:Number(z.providerPrice||0),subtotal:Number(z.subtotal||0),totalRivas:Number(z.totalRivas||0),totalSanJorge:Number(z.totalSanJorge||0),totalIsla:Number(z.totalIsla||0),gainRivas:Number(z.gainRivas||0),gainSanJorge:Number(z.gainSanJorge||0),gainIsla:Number(z.gainIsla||0),unitPriceRivas:Number(z.unitPriceRivas||0),unitPriceSanJorge:Number(z.unitPriceSanJorge||0),unitPriceIsla:Number(z.unitPriceIsla||0),date:z.date,createdAt:z.createdAt,status:z.status??"PENDIENTE",orderId:z.orderId??null})}),B(U),F(G),O(se),E(!0)}catch(R){console.error(R),l(" Error abriendo detalle del producto.")}finally{a(!1)}},j=async(U,G)=>{const R=r.filter(se=>se.productId===U);if(confirm(`Eliminar COMPLETAMENTE "${G}"?
Esto eliminar ${R.length} lote(s) de este producto.`))try{a(!0),l("");const se=Array.from(new Set(R.map(ye=>ye.orderId?String(ye.orderId):"").filter(Boolean)));for(const ye of R)await dn(Tt(je,"inventory_candies",ye.id));n(ye=>ye.filter(z=>z.productId!==U)),l(" Producto eliminado (todos sus lotes).");for(const ye of se)await dC(ye);L&&_===U&&(E(!1),O([]),B(""),F(""))}catch(se){console.error(se),l(" Error eliminando lotes del producto.")}finally{a(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:U=>A(U.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:U=>d(U.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:U=>p(U.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),me.map(U=>i.jsx("option",{value:U,children:U},U))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:U=>h(U.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(U=>i.jsxs("option",{value:U.id,children:[U.name,"  ",U.category]},U.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",fe.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",fe.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",fe.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ae.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ae.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",Si(ae.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",Si(ae.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",Si(ae.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",Si(ae.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):he.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):he.map(U=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:U.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:U.productName,children:U.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",U.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:U.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:U.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Si(U.gainIsla)}),i.jsx("td",{className:"p-2 border",children:U.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>V(U.productId,U.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>j(U.productId,U.productName),children:"Borrar"})]})})]},U.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),L&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",M||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",_]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{E(!1),O([]),B(""),F(""),pe()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):T.map(U=>{const G=x===U.id,R=Sl(U),X=fC(U);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:G?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:w,onChange:se=>b(se.target.value)}):U.date}),i.jsx("td",{className:"p-2 border align-top",children:U.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:U.productName,children:U.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",U.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:R}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:X}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:U.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:G?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(k)?"":k,onChange:se=>P(Math.max(0,parseFloat(se.target.value||"0")))}):Si(U.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Si(U.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Si(U.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:U.orderId?String(U.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${U.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:U.status})}),i.jsx("td",{className:"p-2 border align-top",children:G?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ie,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:pe,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[U.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>S(U),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>te(U),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>I(U),children:"Borrar"})]})})]},U.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>j(_,M),children:"Borrar producto (todos los lotes)"})})]})})]})}const mC=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Wo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function ip(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function p3(t){const e=Ot(At(je,"ar_movements"),$t("ref.saleId","==",t)),r=await Ct(e);await Promise.all(r.docs.map(n=>dn(Tt(je,"ar_movements",n.id))))}function Yve({role:t="",sellerCandyId:e="",currentUserEmail:r}){const n=String(t||"").trim().toLowerCase(),s=String(e||"").trim(),a=n==="vendedor_dulces",o=n==="admin",[l,c]=N.useState([]),[A,u]=N.useState(!1),[d,f]=N.useState(!1),[h,m]=N.useState(null),[p,x]=N.useState([]),g=async Ae=>{u(!0),f(!0),m(Ae),x([]);try{const Ce=(await Ct(Ot(At(je,"sales_candies"),$t("__name__","==",Ae)))).docs[0],Ze=Ce==null?void 0:Ce.data(),Ye=(Array.isArray(Ze==null?void 0:Ze.items)?Ze.items:Ze!=null&&Ze.item?[Ze.item]:[]).map(ze=>({productName:String(ze.productName||""),qty:Number(ze.qty||0),unitPrice:Number(ze.unitPrice||0),discount:Number(ze.discount||0),total:Number(ze.total||0)}));x(Ye)}catch(Pe){console.error(Pe)}finally{f(!1)}},[w,b]=N.useState(""),[k,P]=N.useState("+505 "),[L,E]=N.useState(""),[_,B]=N.useState(""),[M,F]=N.useState("ACTIVO"),[T,O]=N.useState(0),[Y,me]=N.useState(""),[ae,fe]=N.useState(0),[he,te]=N.useState([]),[pe,Ie]=N.useState(!0),[S,I]=N.useState(""),[V,j]=N.useState(null),[U,G]=N.useState(""),[R,X]=N.useState("+505 "),[se,ye]=N.useState(""),[z,Me]=N.useState(""),[re,W]=N.useState("ACTIVO"),[q,oe]=N.useState(0),[de,Be]=N.useState(""),[He,$e]=N.useState(!1),[Je,ct]=N.useState(null),[at,mt]=N.useState(!1),[st,Le]=N.useState([]),[ut,be]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[ge,K]=N.useState(!1),[_e,Oe]=N.useState(0),[Ve,ve]=N.useState(new Date().toISOString().slice(0,10)),[Qe,Ue]=N.useState(""),[Ee,We]=N.useState(!1),[nt,Nt]=N.useState(null),[ot,wt]=N.useState(""),[Lt,cr]=N.useState(0),[ar,yr]=N.useState(""),[tr,et]=N.useState(!1);N.useEffect(()=>{(async()=>{try{if(Ie(!0),a&&!s){te([]),I(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const Ae=await Ct(At(je,"sellers_candies")),Pe=[];Ae.forEach(Ye=>{const ze=Ye.data(),rt=String(ze.status||"ACTIVO");rt==="ACTIVO"&&Pe.push({id:Ye.id,name:String(ze.name||""),status:rt})}),c(Pe);const Ce=a?Ot(At(je,"customers_candies"),$t("vendorId","==",s),Dr("createdAt","desc")):Ot(At(je,"customers_candies"),Dr("createdAt","desc")),Ze=await Ct(Ce),Xe=[];Ze.forEach(Ye=>{const ze=Ye.data();Xe.push({id:Ye.id,name:ze.name??"",phone:ze.phone??"+505 ",place:ze.place??"",notes:ze.notes??"",status:ze.status??"ACTIVO",creditLimit:Number(ze.creditLimit??0),createdAt:ze.createdAt??Gt.now(),balance:0,sellerId:ze.sellerId||"",vendorId:ze.vendorId||"",vendorName:ze.vendorName||"",initialDebt:Number(ze.initialDebt||0)})});for(const Ye of Xe)try{const ze=Ot(At(je,"ar_movements"),$t("customerId","==",Ye.id)),rt=await Ct(ze);let dt=0;rt.forEach(Mt=>dt+=Number(Mt.data().amount||0)),Ye.balance=dt}catch{Ye.balance=0}te(Xe)}catch(Ae){console.error(Ae),I(" Error cargando clientes.")}finally{Ie(!1)}})()},[a,s]);const gt=()=>{b(""),P("+505 "),E(""),B(""),F("ACTIVO"),O(0),me(""),fe(0)},Rt=async Ae=>{var Xe;if(Ae.preventDefault(),I(""),!w.trim()){I("Ingresa el nombre.");return}const Pe=ip(k);if(Pe.length<6){I("Telfono incompleto.");return}const Ce=a?s:String(Y||"").trim(),Ze=Ce&&((Xe=l.find(Ye=>Ye.id===Ce))==null?void 0:Xe.name)||"";try{const Ye=await Jr(At(je,"customers_candies"),{name:w.trim(),phone:Pe,place:L||"",notes:_||"",status:M,creditLimit:Number(T||0),vendorId:Ce,vendorName:Ze,initialDebt:Number(ae||0),createdAt:Gt.now()});te(ze=>[{id:Ye.id,name:w.trim(),phone:Pe,place:L||"",notes:_||"",status:M,creditLimit:Number(T||0),vendorId:Ce,vendorName:Ze,initialDebt:Number(ae||0),createdAt:Gt.now(),balance:0},...ze]),gt(),et(!1),I(" Cliente creado")}catch(Ye){console.error(Ye),I(" Error al crear cliente")}},kt=Ae=>{if(a){I(" No permitido: vendedores no editan clientes desde el listado.");return}j(Ae.id),G(Ae.name),X(Ae.phone||"+505 "),ye(Ae.place||""),Me(Ae.notes||""),W(Ae.status||"ACTIVO"),oe(Number(Ae.creditLimit||0)),Be(String(Ae.vendorId||""))},jt=()=>{j(null),G(""),X("+505 "),ye(""),Me(""),W("ACTIVO"),oe(0),Be("")},Zt=async()=>{var ze;if(a){I(" No permitido.");return}if(!V)return;const Ae=ip(R);if(!U.trim()){I("Ingresa el nombre.");return}const Pe=he.find(rt=>rt.id===V),Ce=String((Pe==null?void 0:Pe.vendorId)||""),Ze=a?s:String(de||"");if(a&&Ce&&Ce!==s){I(" Este cliente pertenece a otro vendedor.");return}if(o&&Ce&&Ze&&Ce!==Ze){I(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const Xe=a?s:String(de||""),Ye=Xe&&((ze=l.find(rt=>rt.id===Xe))==null?void 0:ze.name)||"";try{await Tr(Tt(je,"customers_candies",V),{name:U.trim(),phone:Ae,place:se||"",notes:z||"",status:re,creditLimit:Number(q||0),vendorId:Xe,vendorName:Ye}),te(rt=>rt.map(dt=>dt.id===V?{...dt,name:U.trim(),phone:Ae,place:se||"",notes:z||"",status:re,creditLimit:Number(q||0),vendorId:Xe,vendorName:Ye}:dt)),jt(),I(" Cliente actualizado")}catch(rt){console.error(rt),I(" Error al actualizar")}},Vt=async Ae=>{if(confirm(`Eliminar al cliente "${Ae.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{Ie(!0);const Ce=Ot(At(je,"sales_candies"),$t("customerId","==",Ae.id)),Ze=await Ct(Ce);for(const ze of Ze.docs){const rt=ze.id;try{await ux(rt)}catch(dt){console.warn("restoreSaleAndDeleteCandy error",dt);try{await dn(Tt(je,"sales_candies",rt))}catch{}}await p3(rt)}const Xe=Ot(At(je,"ar_movements"),$t("customerId","==",Ae.id)),Ye=await Ct(Xe);await Promise.all(Ye.docs.map(ze=>dn(Tt(je,"ar_movements",ze.id)))),await dn(Tt(je,"customers_candies",Ae.id)),te(ze=>ze.filter(rt=>rt.id!==Ae.id)),I(" Cliente eliminado y dulces devueltos al inventario")}catch(Ce){console.error(Ce),I(" No se pudo eliminar el cliente.")}finally{Ie(!1)}},ie=async Ae=>{ct(Ae),Le([]),be({saldoActual:0,totalAbonado:0,totalCargos:0}),$e(!0),K(!1),Oe(0),ve(new Date().toISOString().slice(0,10)),Ue(""),Nt(null),mt(!0);try{const Pe=Ot(At(je,"ar_movements"),$t("customerId","==",Ae.id)),Ce=await Ct(Pe),Ze=[];Ce.forEach(Xe=>{var ze,rt;const Ye=Xe.data();Ze.push({id:Xe.id,date:Ye.date??((rt=(ze=Ye.createdAt)==null?void 0:ze.toDate)!=null&&rt.call(ze)?Ye.createdAt.toDate().toISOString().slice(0,10):""),type:Ye.type??"CARGO",amount:Number(Ye.amount||0),ref:Ye.ref||{},comment:Ye.comment||"",createdAt:Ye.createdAt})}),Ze.sort((Xe,Ye)=>{var dt,Mt;if(Xe.date!==Ye.date)return Xe.date.localeCompare(Ye.date);const ze=((dt=Xe.createdAt)==null?void 0:dt.seconds)||0,rt=((Mt=Ye.createdAt)==null?void 0:Mt.seconds)||0;return ze-rt}),Le(Ze),ne(Ze)}catch(Pe){console.error(Pe),I(" No se pudo cargar el estado de cuenta")}finally{mt(!1)}},ne=Ae=>{const Pe=Ae.reduce((Xe,Ye)=>Xe+(Number(Ye.amount)||0),0),Ce=Ae.filter(Xe=>Number(Xe.amount)<0).reduce((Xe,Ye)=>Xe+Math.abs(Number(Ye.amount)||0),0),Ze=Ae.filter(Xe=>Number(Xe.amount)>0).reduce((Xe,Ye)=>Xe+(Number(Ye.amount)||0),0);be({saldoActual:Pe,totalAbonado:Ce,totalCargos:Ze})},ue=async()=>{if(!Je)return;I("");const Ae=Number(_e||0);if(!(Ae>0)){I("Ingresa un monto de abono mayor a 0.");return}const Pe=parseFloat(Ae.toFixed(2));if(!Ve){I("Selecciona la fecha del abono.");return}try{We(!0);const Ce={customerId:Je.id,type:"ABONO",amount:-Pe,date:Ve,comment:Qe||"",createdAt:Gt.now()},Xe={id:(await Jr(At(je,"ar_movements"),Ce)).id,date:Ve,type:"ABONO",amount:-Pe,comment:Qe||"",createdAt:Gt.now()},Ye=[...st,Xe].sort((ze,rt)=>{var Kt,xr;if(ze.date!==rt.date)return ze.date.localeCompare(rt.date);const dt=((Kt=ze.createdAt)==null?void 0:Kt.seconds)||0,Mt=((xr=rt.createdAt)==null?void 0:xr.seconds)||0;return dt-Mt});Le(Ye),ne(Ye),te(ze=>ze.map(rt=>rt.id===Je.id?{...rt,balance:(rt.balance||0)-Pe}:rt)),ct(ze=>ze&&{...ze,balance:(ze.balance||0)-Pe}),Oe(0),Ue(""),ve(new Date().toISOString().slice(0,10)),K(!1),I(" Abono registrado")}catch(Ce){console.error(Ce),I(" Error al registrar el abono")}finally{We(!1)}},xe=Ae=>{Nt(Ae.id),wt(Ae.date||new Date().toISOString().slice(0,10)),cr(Math.abs(Number(Ae.amount||0))),yr(Ae.comment||"")},Fe=()=>{Nt(null),wt(""),cr(0),yr("")},De=async()=>{if(!nt)return;const Ae=st.findIndex(Xe=>Xe.id===nt);if(Ae===-1)return;const Pe=st[Ae],Ce=Number(Lt||0);if(!(Ce>0)){I("El monto debe ser mayor a 0.");return}const Ze=Pe.type==="ABONO"?-parseFloat(Ce.toFixed(2)):+parseFloat(Ce.toFixed(2));try{await Tr(Tt(je,"ar_movements",nt),{date:ot,amount:Ze,comment:ar||""});const Xe=[...st];Xe[Ae]={...Pe,date:ot,amount:Ze,comment:ar||""},Xe.sort((ze,rt)=>{var Kt,xr;if(ze.date!==rt.date)return ze.date.localeCompare(rt.date);const dt=((Kt=ze.createdAt)==null?void 0:Kt.seconds)||0,Mt=((xr=rt.createdAt)==null?void 0:xr.seconds)||0;return dt-Mt}),Le(Xe),ne(Xe);const Ye=Xe.reduce((ze,rt)=>ze+(Number(rt.amount)||0),0);te(ze=>ze.map(rt=>rt.id===(Je==null?void 0:Je.id)?{...rt,balance:Ye}:rt)),ct(ze=>ze&&{...ze,balance:Ye}),Fe(),I(" Movimiento actualizado")}catch(Xe){console.error(Xe),I(" Error al actualizar movimiento")}},ee=async Ae=>{var Ce,Ze;if(confirm(`Eliminar este movimiento (${Ae.type==="ABONO"?"Abono":"Compra"}) del ${Ae.date}?${Ae.type==="CARGO"&&((Ce=Ae.ref)!=null&&Ce.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`))try{if(Ie(!0),Ae.type==="CARGO"&&((Ze=Ae.ref)!=null&&Ze.saleId)){try{await ux(Ae.ref.saleId)}catch(ze){console.warn("restoreSaleAndDeleteCandy error",ze),Ie(!1),I(" No se pudo devolver inventario de la venta.");return}await p3(Ae.ref.saleId)}else await dn(Tt(je,"ar_movements",Ae.id));const Xe=st.filter(ze=>{var rt,dt;return Ae.type==="CARGO"&&((rt=Ae.ref)!=null&&rt.saleId)?((dt=ze.ref)==null?void 0:dt.saleId)!==Ae.ref.saleId:ze.id!==Ae.id});Le(Xe),ne(Xe);const Ye=Xe.reduce((ze,rt)=>ze+(Number(rt.amount)||0),0);te(ze=>ze.map(rt=>rt.id===(Je==null?void 0:Je.id)?{...rt,balance:Ye}:rt)),ct(ze=>ze&&{...ze,balance:Ye}),I(" Movimiento eliminado")}catch(Xe){console.error(Xe),I(" Error al eliminar movimiento")}finally{Ie(!1)}},Te=N.useMemo(()=>[...he].sort((Ae,Pe)=>{var Ce,Ze;return Ae.status!==Pe.status?Ae.status==="BLOQUEADO"?1:-1:(((Ce=Pe.createdAt)==null?void 0:Ce.seconds)||0)-(((Ze=Ae.createdAt)==null?void 0:Ze.seconds)||0)}),[he]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{et(!0),a&&me(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:pe?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Te.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Te.map(Ae=>{var Ce;const Pe=V===Ae.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Ce=Ae.createdAt)!=null&&Ce.toDate?Ae.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:Pe?i.jsx("input",{className:"w-full border p-1 rounded",value:U,onChange:Ze=>G(Ze.target.value)}):i.jsx("div",{className:"font-medium",children:Ae.name})}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsx("input",{className:"w-full border p-1 rounded",value:R,onChange:Ze=>X(ip(Ze.target.value))}):Ae.phone}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:a?s:de,onChange:Ze=>Be(Ze.target.value),disabled:a,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),l.map(Ze=>i.jsx("option",{value:Ze.id,children:Ze.name},Ze.id))]}):Ae.vendorName||""}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsxs("select",{className:"w-full border p-1 rounded",value:se,onChange:Ze=>ye(Ze.target.value),children:[i.jsx("option",{value:"",children:""}),mC.map(Ze=>i.jsx("option",{value:Ze,children:Ze},Ze))]}):Ae.place||""}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsxs("select",{className:"w-full border p-1 rounded",value:re,onChange:Ze=>W(Ze.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ae.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Ae.status})}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(q)?"":q,onChange:Ze=>oe(Math.max(0,Number(Ze.target.value||0)))}):Wo(Ae.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Wo(Ae.balance||0)}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:z,onChange:Ze=>Me(Ze.target.value),maxLength:500}):i.jsx("span",{title:Ae.notes||"",children:(Ae.notes||"").length>40?(Ae.notes||"").slice(0,40)+"":Ae.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Pe?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Zt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:jt,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>kt(Ae),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Vt(Ae),disabled:!o,title:o?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>ie(Ae),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},Ae.id)})})]})}),i.jsx("div",{className:"md:hidden",children:pe?i.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):Te.length===0?i.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):i.jsx("div",{className:"space-y-3",children:Te.map(Ae=>{var Ze;const Pe=V===Ae.id,Ce=(Ze=Ae.createdAt)!=null&&Ze.toDate?Ae.createdAt.toDate().toISOString().slice(0,10):"";return i.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Nombre"}),i.jsx("div",{className:"font-semibold truncate",children:Pe?i.jsx("input",{className:"w-full border p-2 rounded",value:U,onChange:Xe=>G(Xe.target.value)}):Ae.name})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Estado"}),i.jsx("div",{children:Pe?i.jsxs("select",{className:"border p-2 rounded text-sm",value:re,onChange:Xe=>W(Xe.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`inline-flex px-2 py-0.5 rounded text-xs ${Ae.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Ae.status})})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Fecha"}),i.jsx("div",{className:"font-medium",children:Ce})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Telfono"}),i.jsx("div",{className:"font-medium",children:Pe?i.jsx("input",{className:"w-full border p-2 rounded",value:R,onChange:Xe=>X(ip(Xe.target.value))}):Ae.phone})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedor"}),i.jsx("div",{className:"font-medium",children:Pe?i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:a?s:de,onChange:Xe=>Be(Xe.target.value),disabled:a,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),l.map(Xe=>i.jsx("option",{value:Xe.id,children:Xe.name},Xe.id))]}):Ae.vendorName||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Lugar"}),i.jsx("div",{className:"font-medium",children:Pe?i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:se,onChange:Xe=>ye(Xe.target.value),children:[i.jsx("option",{value:"",children:""}),mC.map(Xe=>i.jsx("option",{value:Xe,children:Xe},Xe))]}):Ae.place||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Lmite"}),i.jsx("div",{className:"font-medium",children:Pe?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(q)?"":q,onChange:Xe=>oe(Math.max(0,Number(Xe.target.value||0)))}):Wo(Ae.creditLimit||0)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:Wo(Ae.balance||0)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Comentario"}),i.jsx("div",{className:"font-medium",children:Pe?i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:z,onChange:Xe=>Me(Xe.target.value),maxLength:500}):i.jsx("div",{title:Ae.notes||"",children:(Ae.notes||"").trim()?Ae.notes:""})})]})]}),i.jsx("div",{className:"mt-3",children:Pe?i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:Zt,children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:jt,children:"Cancelar"})]}):i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>kt(Ae),children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Vt(Ae),disabled:!o,title:o?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>ie(Ae),children:"Estado"})]})})]},Ae.id)})})})]}),S&&i.jsx("p",{className:"mt-2 text-sm",children:S}),tr&&Ku.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>et(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>et(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Rt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:w,onChange:Ae=>b(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:k,onChange:Ae=>P(ip(Ae.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:L,onChange:Ae=>E(Ae.target.value),children:[i.jsx("option",{value:"",children:""}),mC.map(Ae=>i.jsx("option",{value:Ae,children:Ae},Ae))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:M,onChange:Ae=>F(Ae.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a?s:Y,onChange:Ae=>me(Ae.target.value),disabled:a,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),l.map(Ae=>i.jsx("option",{value:Ae.id,children:Ae.name},Ae.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:Ae=>fe(Math.max(0,Number(Ae.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor queda fijo (no cambia)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:T===0?"":T,onChange:Ae=>O(Math.max(0,Number(Ae.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:_,onChange:Ae=>B(Ae.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[_.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>et(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),He&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(Je==null?void 0:Je.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Oe(0),ve(new Date().toISOString().slice(0,10)),Ue(""),K(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>$e(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:Wo(Number((Je==null?void 0:Je.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Wo(ut.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Wo(ut.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Wo(ut.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:at?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):st.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):st.map(Ae=>{var Ce,Ze;const Pe=nt===Ae.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Pe?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:ot,onChange:Xe=>wt(Xe.target.value)}):Ae.date||""}),i.jsx("td",{className:"p-2 border",children:Ae.amount>=0?(Ce=Ae.ref)!=null&&Ce.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>g(Ae.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Ze=Ae.ref)!=null&&Ze.saleId?`Venta #${Ae.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsx("input",{className:"w-full border p-1 rounded",value:ar,onChange:Xe=>yr(Xe.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Ae.comment||"",children:(Ae.comment||"").length>40?(Ae.comment||"").slice(0,40)+"":Ae.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:Pe?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Lt)?"":Lt,onChange:Xe=>{const Ye=Number(Xe.target.value||0),ze=Number.isFinite(Ye)?Math.max(0,parseFloat(Ye.toFixed(2))):0;cr(ze)},placeholder:"0.00",title:Ae.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Wo(Ae.amount)}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:De,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Fe,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xe(Ae),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ee(Ae),children:"Borrar"})]})})]},Ae.id)})})]})})]})}),ge&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(Je==null?void 0:Je.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ve,onChange:Ae=>ve(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:_e===0?"":_e,onChange:Ae=>{const Pe=Number(Ae.target.value||0),Ce=Number.isFinite(Pe)?Math.max(0,parseFloat(Pe.toFixed(2))):0;Oe(Ce)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Qe,onChange:Ae=>Ue(Ae.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Qe.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>K(!1),disabled:Ee,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:ue,disabled:Ee,children:Ee?"Guardando...":"Guardar abono"})]})]})}),A&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",h?` #${h}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>u(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:d?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):p.map((Ae,Pe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Ae.productName}),i.jsx("td",{className:"p-2 border text-right",children:Ae.qty}),i.jsx("td",{className:"p-2 border text-right",children:Wo(Ae.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Wo(Ae.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Wo(Ae.total)})]},Pe))})]})})]})})]})}const Ud=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Zve=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];function e1e(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function t1e(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function r1e(t){const{saleId:e,date:r,customerName:n,branch:s,items:a,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:A}=t,u=new or;let d=12;if(u.setFontSize(16),u.text("Multiservicios Ortiz",10,d),d+=6,u.setFontSize(12),u.text("Recibo de venta certificada",10,d),d+=8,u.setFontSize(12),u.text(`Fecha: ${r}`,10,d),d+=5,u.text(`Cliente: ${n||"Cliente Mostrador"}`,10,d),d+=5,u.text(`Sucursal: ${e1e(s)}`,10,d),d+=5,u.text(`Autorizado: ${e}`,10,d),d+=5,l&&(u.text(`Vendedor: ${l}`,10,d),d+=5),typeof c=="number"){const f=Number(A||0).toFixed(2),h=c.toFixed(2);u.text(`Comisin vendedor: ${h}%  C$ ${f}`,10,d),d+=8}else d+=3;u.setFontSize(12),u.text("Producto",10,d),u.text("Paquetes",110,d,{align:"right"}),u.text("Precio.",150,d,{align:"right"}),u.text("Subtotal",190,d,{align:"right"}),d+=4,u.line(10,d,190,d),d+=4,a.forEach(f=>{d>270&&(u.addPage(),d=12);const h=(f.productName||"").length>50?f.productName.slice(0,47)+"...":f.productName;u.text(h,10,d),u.text(String(f.qty),110,d,{align:"right"}),u.text(`C$ ${Number(f.unitPrice||0).toFixed(2)}`,150,d,{align:"right"}),u.text(`C$ ${Number(f.total||0).toFixed(2)}`,190,d,{align:"right"}),d+=5}),d+=4,u.line(10,d,190,d),d+=6,u.setFontSize(13),u.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,d,{align:"right"}),d+=6,u.setFontSize(9),u.text("Gracias por su compra.",10,d),u.save(`venta_dulces_${e}.pdf`)}async function g3(t,e){if(!t||!e)return 0;const r=Ot(At(je,"inventory_candies_sellers"),$t("sellerId","==",e),$t("productId","==",t)),n=await Ct(r);let s=0;return n.forEach(a=>{const o=a.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(s+=l)}),s}const x3=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function n1e(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:s,saleId:a}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=Ot(At(je,"inventory_candies_sellers"),$t("sellerId","==",r),$t("productId","==",e),$t("remainingUnits",">",0),Dr("date","asc"),Dr("createdAt","asc")),A=await Ct(c);for(const u of A.docs){if(o<=0)break;const d=u.data(),f=Number(d.remainingUnits||0);if(f<=0)continue;const h=Math.min(f,o),m=f-h,p=Math.max(1,Math.floor(Number(d.unitsPerPackage||1))),x=Math.floor(m/p);await Tr(u.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:u.id,productId:e,units:h,saleDate:s,saleId:a}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function v3(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function s1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const[n,s]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState([]),[A,u]=N.useState({}),[d,f]=N.useState("CONTADO"),[h,m]=N.useState("RIVAS"),[p,x]=N.useState(""),[g,w]=N.useState(""),[b,k]=N.useState(x3()),[P,L]=N.useState(""),[E,_]=N.useState(!1),[B,M]=N.useState(""),[F,T]=N.useState([]),O=N.useMemo(()=>F.reduce((ve,Qe)=>ve+(Qe.qtyPackages||0),0),[F]),Y=N.useMemo(()=>F.reduce((ve,Qe)=>ve+(Qe.qtyPackages||0)*(Qe.unitsPerPackage||1),0),[F]),me=N.useMemo(()=>{const ve=F.reduce((Qe,Ue)=>{const Ee=(Number(Ue.pricePerPackage)||0)*(Ue.qtyPackages||0),We=Number(Ue.discount)||0,nt=Math.max(0,Ee-We);return Qe+nt},0);return Math.floor(ve*100)/100},[F]),[ae,fe]=N.useState(0),[he,te]=N.useState(""),[pe,Ie]=N.useState(!1),[S,I]=N.useState(!1),[V,j]=N.useState(""),[U,G]=N.useState("+505 "),[R,X]=N.useState(""),[se,ye]=N.useState(""),[z,Me]=N.useState("ACTIVO"),[re,W]=N.useState(0),[q,oe]=N.useState(""),de=()=>{j(""),G("+505 "),X(""),ye(""),Me("ACTIVO"),W(0)},Be=N.useMemo(()=>n.find(ve=>ve.id===p),[n,p]),He=N.useMemo(()=>E&&P?n.filter(ve=>(ve.vendorId??ve.sellerId??"")===P):n,[n,E,P]),$e=(Be==null?void 0:Be.balance)||0,Je=d==="CREDITO"?$e+Math.max(0,Number(me||0))-Math.max(0,Number(ae||0)):0,ct=N.useMemo(()=>l.find(ve=>ve.id===P)||null,[l,P]),at=(ct==null?void 0:ct.commissionPercent)||0,mt=N.useMemo(()=>{const ve=Number(me||0),Qe=Number(at||0),Ue=ve*Qe/100;return Number(Ue.toFixed(2))},[me,at]);N.useEffect(()=>{(async()=>{const ve=Ot(At(je,"customers_candies"),Dr("createdAt","desc")),Qe=await Ct(ve),Ue=[];Qe.forEach(Nt=>{const ot=Nt.data();Ue.push({id:Nt.id,name:ot.name??"",phone:ot.phone??"+505 ",place:ot.place??"",status:ot.status??"ACTIVO",creditLimit:Number(ot.creditLimit??0),balance:0,sellerId:ot.sellerId??ot.vendorId??"",vendorId:ot.vendorId??ot.sellerId??""})});for(const Nt of Ue)try{const ot=Ot(At(je,"ar_movements"),$t("customerId","==",Nt.id)),wt=await Ct(ot);let Lt=0;wt.forEach(cr=>Lt+=Number(cr.data().amount||0)),Nt.balance=Lt}catch{Nt.balance=0}s(Ue);const Ee=Ot(At(je,"products_candies"),Dr("createdAt","desc")),We=await Ct(Ee),nt=[];We.forEach(Nt=>{const ot=Nt.data();nt.push({id:Nt.id,name:ot.name??"(sin nombre)",sku:ot.sku??"",unitsPerPackage:Number(ot.unitsPerPackage??1),priceRivas:Number(ot.unitPriceRivas??0),priceSanJorge:Number(ot.unitPriceSanJorge??0),priceIsla:Number(ot.unitPriceIsla??0)})}),o(nt);try{const Nt=await Ct(At(je,"sellers_candies")),ot=[];Nt.forEach(wt=>{const Lt=wt.data(),cr=Lt.branch||"Rivas",ar=t1e(cr);ot.push({id:wt.id,name:Lt.name??"(sin nombre)",branch:ar,branchLabel:cr,commissionPercent:Number(Lt.commissionPercent??0)})}),c(ot)}catch(Nt){console.error("Error cargando vendedores:",Nt)}u({})})()},[]),N.useEffect(()=>{if(t==="vendedor_dulces"&&e){L(e),_(!0);try{localStorage.setItem("pos_vendorId",e),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(t==="admin"){_(!1);return}try{const ve=localStorage.getItem("pos_vendorId")||"",Qe=localStorage.getItem("pos_role")||"";ve&&L(ve),Qe.toUpperCase()==="VENDEDOR"&&_(!0)}catch{}},[t,e]);const st=async ve=>{if(!ve){u({});return}const Qe=Ot(At(je,"inventory_candies_sellers"),$t("sellerId","==",ve)),Ue=await Ct(Qe),Ee={};Ue.forEach(We=>{const nt=We.data(),Nt=nt.productId||"";if(!Nt)return;const ot=Number(nt.remainingUnits??nt.remaining??nt.totalUnits??0);ot<=0||(Ee[Nt]=(Ee[Nt]||0)+ot)}),u(Ee),T(We=>{const nt=[];for(const Nt of We){const ot=Ee[Nt.productId]??0;ot>0&&nt.push({...Nt,availableUnits:ot})}return nt})};N.useEffect(()=>{if(!P){u({});return}const ve=l.find(Qe=>Qe.id===P);ve&&m(ve.branch),st(P)},[P,l]),N.useEffect(()=>{T(ve=>ve.map(Qe=>{const Ue=a.find(We=>We.id===Qe.productId);if(!Ue)return Qe;const Ee=h==="RIVAS"?Ue.priceRivas:h==="SAN_JORGE"?Ue.priceSanJorge:Ue.priceIsla;return{...Qe,pricePerPackage:Number(Ee)||0}}))},[h,a]);async function Le(ve){const{productId:Qe,vendorId:Ue,branch:Ee}=ve;if(!Qe||!Ue)return 0;const We=Ot(At(je,"inventory_candies_sellers"),$t("sellerId","==",Ue),$t("productId","==",Qe)),nt=await Ct(We);if(nt.empty)return 0;const Nt=nt.docs[0].data(),ot=Number(Nt.unitPriceVendor??0);if(ot>0)return ot;const wt=Number(Ee==="RIVAS"?Nt.unitPriceRivas??0:Ee==="SAN_JORGE"?Nt.unitPriceSanJorge??0:Nt.unitPriceIsla??0);return Number(wt||0)}const ut=async ve=>{var Nt;if(!ve)return;if(!P){te("Selecciona primero el vendedor para usar su inventario."),M("");return}if(F.some(ot=>ot.productId===ve)){M("");return}const Qe=a.find(ot=>ot.id===ve);if(!Qe){M("");return}const Ue=await g3(ve,P),Ee=((Nt=l.find(ot=>ot.id===P))==null?void 0:Nt.branch)??h,We=await Le({productId:ve,vendorId:P,branch:Ee}),nt={productId:ve,productName:Qe.name||"",sku:Qe.sku||"",unitsPerPackage:Qe.unitsPerPackage||1,pricePerPackage:Number(We)||0,availableUnits:Number(Ue)||0,qtyPackages:0,discount:0};T(ot=>[...ot,nt]),M("")},be=(ve,Qe)=>{T(Ue=>Ue.map(Ee=>{if(Ee.productId!==ve)return Ee;if(Qe==="")return{...Ee,qtyPackages:0};const We=Math.max(0,Math.floor(Number(Qe)));return{...Ee,qtyPackages:We}}))},ge=(ve,Qe)=>{T(Ue=>Ue.map(Ee=>{if(Ee.productId!==ve)return Ee;if(Qe==="")return{...Ee,discount:0};const We=Math.max(0,Math.floor(Number(Qe)));return{...Ee,discount:We}}))},K=ve=>T(Qe=>Qe.filter(Ue=>Ue.productId!==ve)),_e=async()=>{if(!b)return"Selecciona la fecha.";if(!P)return"Selecciona el vendedor para esta venta.";if(F.length===0)return"Agrega al menos un producto.";const ve=F.filter(Qe=>(Qe.qtyPackages||0)>0);if(ve.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(me>0))return"El total debe ser mayor a cero.";if(d==="CONTADO"){if(!g.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!p)return"Selecciona un cliente (crdito).";if(ae<0)return"El pago inicial no puede ser negativo.";if(ae>me)return"El pago inicial no puede superar el total.";if((Be==null?void 0:Be.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Qe of ve){const Ue=Qe.unitsPerPackage||1,Ee=(Qe.qtyPackages||0)*Ue,We=await g3(Qe.productId,P),nt=Math.floor(We/Ue);if(Ee>We)return`Inventario insuficiente en el pedido del vendedor para "${Qe.productName}". Disponible: ${nt} paquetes.`;const Nt=(Number(Qe.pricePerPackage)||0)*(Qe.qtyPackages||0),ot=Number(Qe.discount)||0;if(!Number.isInteger(ot)||ot<0)return`El descuento en "${Qe.productName}" debe ser entero y  0.`;if(ot>Nt)return`El descuento en "${Qe.productName}" no puede exceder C$ ${Nt.toFixed(2)}.`}return null},Oe=async ve=>{ve.preventDefault(),te("");const Qe=await _e();if(Qe){te(" "+Qe);return}try{Ie(!0);const Ue=F.filter(ot=>(ot.qtyPackages||0)>0).map(ot=>{const wt=ot.unitsPerPackage||1,Lt=ot.qtyPackages||0,cr=Lt*wt,ar=(Number(ot.pricePerPackage)||0)*(Lt||0),yr=Math.max(0,Math.floor(Number(ot.discount)||0)),tr=Math.max(0,ar-yr);return{productId:ot.productId,productName:ot.productName,sku:ot.sku||"",qty:cr,packages:Lt,unitsPerPackage:wt,branch:h,unitPricePackage:Number(ot.pricePerPackage)||0,discount:yr,total:Math.floor(tr*100)/100}}),Ee={type:d,branch:h,date:b,createdAt:Gt.now(),itemsTotal:Number(me)||0,total:Number(me)||0,quantity:Number(Y)||0,packagesTotal:Number(O)||0,items:Ue,vendorId:P},We=l.find(ot=>ot.id===P);We&&(Ee.vendorName=We.name,Ee.vendorBranch=We.branch,Ee.vendorBranchLabel=We.branchLabel,Ee.vendorCommissionPercent=We.commissionPercent||0,Ee.vendorCommissionAmount=mt||0),d==="CONTADO"?Ee.customerName=g.trim():(Ee.customerId=p,Ee.downPayment=Number(ae)||0);const nt=await Jr(At(je,"sales_candies"),Ee);if(d==="CONTADO"){const ot=(g||"").trim();if(ot)try{await Jr(At(je,"cash_customers"),{name:ot,date:b,branch:h,vendorId:P,createdAt:Gt.now()})}catch(wt){console.warn("No se pudo guardar cash_customer:",wt)}}if(d==="CREDITO"&&p){const ot={customerId:p,date:b,createdAt:Gt.now(),ref:{saleId:nt.id}},wt=Number((Be==null?void 0:Be.balance)||0);if(await Jr(At(je,"ar_movements"),{...ot,type:"CARGO",amount:Number(me)||0}),Number(ae)>0&&await Jr(At(je,"ar_movements"),{...ot,type:"ABONO",amount:-Number(ae)}),wt===0)try{await Tr(Tt(je,"customers_candies",p),{initialDebt:Number(me)||0,initialDebtDate:b})}catch(Lt){console.warn("No se pudo setear initialDebt:",Lt)}}const Nt={};for(const ot of Ue)if(ot.qty>0){const{allocations:wt}=await n1e({productId:ot.productId,vendorId:P,quantityUnits:ot.qty,saleDate:b,saleId:nt.id});Nt[ot.productId]={productId:ot.productId,vendorId:P,allocations:wt}}await Tr(Tt(je,"sales_candies",nt.id),{allocationsByItem:Nt});try{const ot=d==="CONTADO"?g.trim()||"Cliente Mostrador":(Be==null?void 0:Be.name)||"Cliente crdito";r1e({saleId:nt.id,date:b,customerName:ot,branch:h,items:Ue.map(wt=>({productName:wt.productName,qty:wt.packages,unitPrice:wt.unitPricePackage,total:wt.total})),total:Number(me)||0,vendorName:We==null?void 0:We.name,vendorCommissionPercent:(We==null?void 0:We.commissionPercent)||0,vendorCommissionAmount:mt})}catch(ot){console.error("Error generando voucher PDF:",ot)}f("CONTADO"),x(""),w(""),k(x3()),T([]),fe(0),d==="CREDITO"&&p&&s(ot=>ot.map(wt=>wt.id===p?{...wt,balance:(wt.balance||0)+(Number(me)||0)-(Number(ae)||0)}:wt)),te(" Venta de dulces registrada"),P?await st(P):u({})}catch(Ue){console.error(Ue),te(" Error al guardar la venta de dulces")}finally{Ie(!1)}},Ve=N.useMemo(()=>a.filter(ve=>{const Qe=A[ve.id]||0,Ue=Math.max(1,Number(ve.unitsPerPackage||1));return Math.floor(Qe/Ue)>0}).sort((ve,Qe)=>(ve.name||"").localeCompare(Qe.name||"")),[a,A]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),i.jsxs("form",{onSubmit:Oe,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:d,onChange:ve=>f(ve.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),d==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:g,onChange:ve=>w(ve.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:p,onChange:ve=>x(ve.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),He.map(ve=>i.jsxs("option",{value:ve.status==="ACTIVO"?ve.id:"",disabled:ve.status==="BLOQUEADO",children:[ve.name," | ",ve.phone," | Saldo: ",Ud(ve.balance||0)]},ve.id))]}),i.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>I(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Ud($e)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:ve=>fe(Math.max(0,Number(ve.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Ud(Je)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:b,onChange:ve=>k(ve.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:ve=>{L(ve.target.value),T([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.map(ve=>i.jsxs("option",{value:ve.id,children:[ve.name,"  ",ve.branchLabel,"  ",ve.commissionPercent.toFixed(2),"%"," comisin"]},ve.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:h==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:h==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:h==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:B,onChange:async ve=>{const Qe=ve.target.value;M(Qe),await ut(Qe)},disabled:!P,children:[i.jsx("option",{value:"",children:P?"Selecciona un producto":"Selecciona un vendedor primero"}),Ve.map(ve=>{const Qe=F.some(nt=>nt.productId===ve.id),Ue=A[ve.id]||0,Ee=Math.max(1,Number(ve.unitsPerPackage||1)),We=Math.floor(Ue/Ee);return We<=0?null:i.jsxs("option",{value:Qe?"":ve.id,disabled:Qe,children:[ve.name," ",ve.sku?` ${ve.sku}`:""," (disp: ",We," ","paq.)",Qe?" ":""]},ve.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),F.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):F.map(ve=>{const Qe=A[ve.productId]??ve.availableUnits??0,Ue=ve.unitsPerPackage?Math.floor(Qe/ve.unitsPerPackage):0,Ee=Math.max(0,Ue-(ve.qtyPackages||0)),We=(Number(ve.pricePerPackage)||0)*(ve.qtyPackages||0),nt=Math.max(0,We-(Number(ve.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[ve.productName,ve.sku?`  ${ve.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Ud(ve.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[Ee," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ve.qtyPackages)||ve.qtyPackages===0?"":ve.qtyPackages,onChange:Nt=>be(ve.productId,Nt.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de paquetes"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ve.discount)||ve.discount===0?"":ve.discount,onChange:Nt=>ge(ve.productId,Nt.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:Ud(nt)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>K(ve.productId),title:"Quitar producto",children:""})})]},ve.productId)})]})}),F.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:O})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Ud(me)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Ud(mt)," ",at?`(${at.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:pe,children:pe?"Guardando...":"Registrar venta"})})]}),he&&i.jsx("p",{className:"mt-2 text-sm",children:he}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:V,onChange:ve=>j(ve.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:U,onChange:ve=>G(v3(ve.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:R,onChange:ve=>X(ve.target.value),children:[i.jsx("option",{value:"",children:""}),Zve.map(ve=>i.jsx("option",{value:ve,children:ve},ve))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:z,onChange:ve=>Me(ve.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:q,onChange:ve=>oe(ve.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.filter(ve=>(ve.status??"ACTIVO")==="ACTIVO").map(ve=>i.jsxs("option",{value:ve.id,children:[ve.name,"  ",ve.branchLabel]},ve.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:re===0?"":re,onChange:ve=>W(Math.max(0,Number(ve.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:se,onChange:ve=>ye(ve.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{de(),I(!1)},children:"Cancelar"}),i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var Ue;const ve=E?P||e:q;if(!ve){te("Selecciona el vendedor para asociar este cliente.");return}if(te(""),!V.trim()){te("Ingresa el nombre del nuevo cliente.");return}const Qe=v3(U);try{const Ee=await Jr(At(je,"customers_candies"),{name:V.trim(),phone:Qe,place:R||"",notes:se||"",status:z,creditLimit:Number(re||0),createdAt:Gt.now(),sellerId:ve,vendorId:ve,vendorName:((Ue=l.find(nt=>nt.id===ve))==null?void 0:Ue.name)||""}),We={id:Ee.id,name:V.trim(),phone:Qe,place:R||"",status:z,creditLimit:Number(re||0),balance:0,sellerId:ve};s(nt=>[We,...nt]),x(Ee.id),de(),I(!1),te(" Cliente creado")}catch(Ee){console.error(Ee),te(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),pe&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const y3=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],D1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function a1e(){const[t,e]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[r,n]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[s,a]=N.useState(sr(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,A]=N.useState(""),[u,d]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[x,g]=N.useState([]),[w,b]=N.useState(!0),[k,P]=N.useState(""),[L,E]=N.useState(null),[_,B]=N.useState(""),[M,F]=N.useState(""),[T,O]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[he,te]=N.useState("");N.useEffect(()=>{(async()=>{b(!0);try{const R=Ot(At(je,"expenses_candies"),Dr("date","desc")),X=await Ct(R),se=[];X.forEach(ye=>{const z=ye.data();se.push({id:ye.id,date:z.date||sr(new Date,"yyyy-MM-dd"),category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||"PENDIENTE",notes:z.notes||"",createdAt:z.createdAt??Gt.now()})}),g(se)}catch(R){console.error(R),P(" Error al cargar gastos")}finally{b(!1)}})()},[]);const pe=N.useMemo(()=>x.filter(R=>!(t&&R.date<t||r&&R.date>r)),[x,t,r]),Ie=N.useMemo(()=>{const R=pe.reduce((ye,z)=>ye+(z.amount||0),0),X=pe.filter(ye=>ye.status==="PAGADO").reduce((ye,z)=>ye+(z.amount||0),0),se=R-X;return{total:R,pagado:X,pendiente:se}},[pe]),S=()=>{a(sr(new Date,"yyyy-MM-dd")),l(""),A(""),d(0),h("PENDIENTE"),p("")},I=async R=>{if(R.preventDefault(),P(""),!o){P("Selecciona una categora.");return}if(!c.trim()){P("Ingresa una descripcin.");return}if(!u||u<=0){P("Ingresa un monto vlido.");return}try{const X=await Jr(At(je,"expenses_candies"),{date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Gt.now()});g(se=>[{id:X.id,date:s,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:f,notes:m||"",createdAt:Gt.now()},...se]),S(),P(" Gasto registrado")}catch(X){console.error(X),P(" Error al guardar gasto")}},V=R=>{E(R.id),B(R.date),F(R.category||""),O(R.description||""),me(Number(R.amount||0)),fe(R.status||"PENDIENTE"),te(R.notes||"")},j=()=>{E(null),B(""),F(""),O(""),me(0),fe("PENDIENTE"),te("")},U=async()=>{if(L){if(!M){P("Selecciona una categora.");return}if(!T.trim()){P("Ingresa una descripcin.");return}if(!Y||Y<=0){P("Ingresa un monto vlido.");return}try{await Tr(Tt(je,"expenses_candies",L),{date:_,category:M,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:he||""}),g(R=>R.map(X=>X.id===L?{...X,date:_,category:M,description:T.trim(),amount:Number(Y.toFixed(2)),status:ae,notes:he||""}:X)),j(),P(" Gasto actualizado")}catch(R){console.error(R),P(" Error al actualizar gasto")}}},G=async R=>{confirm(`Eliminar el gasto "${R.description}"?`)&&(await dn(Tt(je,"expenses_candies",R.id)),g(se=>se.filter(ye=>ye.id!==R.id)),P(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:R=>e(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:R=>n(R.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",D1(Ie.total)]}),i.jsxs("div",{children:["Pagado: ",D1(Ie.pagado)]}),i.jsxs("div",{children:["Pendiente: ",D1(Ie.pendiente)]})]})]}),i.jsxs("form",{onSubmit:I,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:R=>a(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:R=>l(R.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),y3.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:R=>A(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:R=>d(Math.max(0,Number(R.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:R=>h(R.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:R=>p(R.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):pe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):pe.slice().sort((R,X)=>R.date.localeCompare(X.date)).map(R=>{const X=L===R.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:_,onChange:se=>B(se.target.value)}):R.date}),i.jsx("td",{className:"p-2 border",children:X?i.jsxs("select",{className:"w-full border p-1 rounded",value:M,onChange:se=>F(se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),y3.map(se=>i.jsx("option",{value:se,children:se},se))]}):R.category||""}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:se=>O(se.target.value)}):i.jsx("span",{title:R.description,children:R.description.length>40?R.description.slice(0,40)+"":R.description})}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Y)?"":Y,onChange:se=>me(Math.max(0,Number(se.target.value||0)))}):D1(R.amount)}),i.jsx("td",{className:"p-2 border",children:X?i.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:se=>fe(se.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${R.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:R.status})}),i.jsx("td",{className:"p-2 border",children:X?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:he,onChange:se=>te(se.target.value),maxLength:500}):i.jsx("span",{title:R.notes||"",children:(R.notes||"").length>40?(R.notes||"").slice(0,40)+"":R.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:X?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:U,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:j,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>V(R),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>G(R),children:"Borrar"})]})})})]},R.id)})})]})}),k&&i.jsx("p",{className:"mt-2 text-sm",children:k})]})}const Il=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function i1e(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?sr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function o1e(t,e){var a,o,l;const r=i1e(t);if(!r)return null;let n=0,s=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((c,A)=>c+(Number(A.packages??A.qty??A.quantity??0)||0),0),s=Number(t.total??t.itemsTotal??0)||0):(n=Number(t.packagesTotal??t.quantity??((a=t.item)==null?void 0:a.packages)??((o=t.item)==null?void 0:o.qty)??0)||0,s=Number(t.total??((l=t.item)==null?void 0:l.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:s,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}async function l1e(t){const e=Ot(At(je,"ar_movements"),$t("ref.saleId","==",t)),r=await Ct(e);await Promise.all(r.docs.map(n=>dn(Tt(je,"ar_movements",n.id))))}function c1e({role:t="",sellerCandyId:e=""}){const r=t==="vendedor_dulces",n=t==="admin",s=n?8:7,[a,o]=N.useState(!1),[l,c]=N.useState(!1),[A,u]=N.useState(null),[d,f]=N.useState([]),h=async q=>{o(!0),c(!0),u(q),f([]);try{const oe=await Xa(Tt(je,"sales_candies",q)),de=oe.exists()?oe.data():null;if(!de){f([]);return}const He=(Array.isArray(de==null?void 0:de.items)?de.items:de!=null&&de.item?[de.item]:[]).map($e=>({productName:String($e.productName||""),qty:Number($e.packages??$e.qty??$e.quantity??0),unitPrice:Number($e.unitPricePackage??$e.unitPrice??0),discount:Number($e.discount||0),total:Number($e.total??$e.lineFinal??0)}));f(He)}catch(oe){console.error(oe)}finally{c(!1)}},[m,p]=N.useState(sr(new Date,"yyyy-MM-01")),[x,g]=N.useState(sr(new Date,"yyyy-MM-dd")),[w,b]=N.useState([]),[k,P]=N.useState([]),[L,E]=N.useState([]),[_,B]=N.useState(!0),[M,F]=N.useState(""),[T,O]=N.useState(""),[Y,me]=N.useState(""),[ae,fe]=N.useState(null),he=15,[te,pe]=N.useState(1),Ie=N.useMemo(()=>{const q={};return w.forEach(oe=>q[oe.id]=oe.name),q},[w]),S=N.useMemo(()=>{const q={};return L.forEach(oe=>{q[oe.id]=oe}),q},[L]),I=q=>{const oe=Number(q.vendorCommissionAmount||0);if(oe>0)return oe;if(!q.vendorId)return 0;const de=S[q.vendorId];if(!de||!de.commissionPercent)return 0;const Be=(Number(q.total)||0)*(Number(de.commissionPercent)||0)/100;return Number(Be.toFixed(2))};N.useEffect(()=>{(async()=>{B(!0),F("");try{const q=await Ct(At(je,"customers_candies")),oe=[];q.forEach(Je=>oe.push({id:Je.id,name:Je.data().name||""})),b(oe);const de=await Ct(At(je,"sellers_candies")),Be=[];de.forEach(Je=>{const ct=Je.data();Be.push({id:Je.id,name:ct.name||"",commissionPercent:Number(ct.commissionPercent||0)})}),E(Be);const He=await Ct(Ot(At(je,"sales_candies"),Dr("createdAt","desc"))),$e=[];He.forEach(Je=>{const ct=o1e(Je.data(),Je.id);ct&&ct.date>=m&&ct.date<=x&&$e.push(ct)}),P($e.sort((Je,ct)=>ct.date.localeCompare(Je.date))),pe(1)}catch(q){console.error(q),F(" Error cargando transacciones.")}finally{B(!1)}})()},[m,x]);const V=N.useMemo(()=>k.filter(q=>!(r&&(!e||!q.vendorId||q.vendorId!==e)||T&&q.customerId!==T||Y&&q.type!==Y)),[k,T,Y,r,e]),j=N.useMemo(()=>{let q=0,oe=0,de=0,Be=0;for(const He of V)He.type==="CONTADO"?(q+=He.quantity,de+=He.total):(oe+=He.quantity,Be+=He.total);return{packsCash:q,packsCredito:oe,montoCash:de,montoCredito:Be}},[V]),U=Math.max(1,Math.ceil(V.length/he)),G=N.useMemo(()=>{const q=(te-1)*he;return V.slice(q,q+he)},[V,te]),R=N.useMemo(()=>A&&k.find(q=>q.id===A)||null,[A,k]),X=async q=>{if(n&&(fe(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{B(!0),await ux(q.id),await l1e(q.id),P(oe=>oe.filter(de=>de.id!==q.id)),F(" Venta eliminada")}catch(oe){console.error(oe),F(" No se pudo eliminar la venta.")}finally{B(!1)}},se=()=>{const q=`Ventas del dia  ${m} a ${x}`,oe=$e=>($e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),de=V.map($e=>{const Je=$e.customerName||($e.customerId?Ie[$e.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${$e.date}</td>
          <td>${oe(Je)}</td>
          <td>${$e.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${$e.quantity}</td>
          <td style="text-align:right">${Il($e.total)}</td>
        </tr>`}).join(""),Be=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${oe(q)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${oe(q)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${j.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${j.packsCredito}</div>
        <div><b>Monto Cash:</b> ${Il(j.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Il(j.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${de||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,He=window.open("","_blank");He&&(He.document.open(),He.document.write(Be),He.document.close())},ye=()=>pe(1),z=()=>pe(q=>Math.max(1,q-1)),Me=()=>pe(q=>Math.min(U,q+1)),re=()=>pe(U),W=()=>{const q=[];if(U<=7)for(let de=1;de<=U;de++)q.push(de);else{const de=Math.max(1,te-2),Be=Math.min(U,te+2);q.push(1),de>2&&q.push(-1);for(let He=de;He<=Be;He++)He!==1&&He!==U&&q.push(He);Be<U-1&&q.push(-2),q.push(U)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ye,disabled:te===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:z,disabled:te===1,children:" Anterior"}),q.map((de,Be)=>typeof de=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${de===te?"bg-blue-600 text-white":""}`,onClick:()=>pe(de),children:de},Be):i.jsx("span",{className:"px-2",children:""},Be)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Me,disabled:te===U,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:re,disabled:te===U,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",te," de ",U,"  ",V.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:q=>{p(q.target.value),pe(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:q=>{g(q.target.value),pe(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:T,onChange:q=>{O(q.target.value),pe(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(q=>i.jsx("option",{value:q.id,children:q.name},q.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:Y,onChange:q=>{me(q.target.value),pe(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:se,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:j.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:j.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Il(j.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Il(j.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),n&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:_?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Cargando"})}):G.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Sin transacciones en el rango."})}):G.map(q=>{const oe=q.customerName||(q.customerId?Ie[q.customerId]:"")||"Nombre cliente",de=I(q);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:q.date}),i.jsx("td",{className:"p-2 border",children:oe}),i.jsx("td",{className:"p-2 border",children:q.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>h(q.id),children:q.quantity})}),i.jsx("td",{className:"p-2 border",children:Il(q.total)}),i.jsx("td",{className:"p-2 border",children:de>0?Il(de):""}),i.jsx("td",{className:"p-2 border",children:q.vendorName||""}),n&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>fe(Be=>Be===q.id?null:q.id),title:"Acciones",children:""}),ae===q.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>X(q),children:"Eliminar"})})]})]},q.id)})})]}),W()]}),M&&i.jsx("p",{className:"mt-2 text-sm",children:M}),a&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",A?` #${A}`:""]}),R&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:I(R)>0?Il(I(R)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>o(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):d.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):d.map((q,oe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:q.productName}),i.jsx("td",{className:"p-2 border text-right",children:q.qty}),i.jsx("td",{className:"p-2 border text-right",children:Il(q.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Il(q.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Il(q.total)})]},oe))})]})})]})})]})}const en=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Bp(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?sr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function A1e(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,a=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/s:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(a||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}});if(t!=null&&t.item){const n=t.item,s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,a=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/s:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(a||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0)}]:[]}function u1e(t,e){const r=Bp(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,s=t.vendorName||t.sellerName||void 0,a=A1e(t);let o=Number(t.total??t.itemsTotal??0)||a.reduce((l,c)=>{const A=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),u=Math.max(0,Number(c.discount||0)),d=Math.max(0,A-u);return l+d},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:a,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:s}}function d1e(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,A)=>c.date.localeCompare(A.date));const a=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of a)for(const c of l.items||[]){const A=s[c.productId];if(!A)continue;let u=Number(c.qty||0);if(!(u<=0))for(const d of A.lots){if(u<=0)break;if(d.qtyLeft<=0)continue;const f=Math.min(d.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=f*d.cost),d.qtyLeft-=f,u-=f}}return o}async function h1e(t){const e=Ot(At(je,"ar_movements"),$t("ref.saleId","==",t)),r=await Ct(e);await Promise.all(r.docs.map(n=>dn(Tt(je,"ar_movements",n.id))))}function f1e(){const{refreshKey:t,refresh:e}=Xl(),[r,n]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[s,a]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,A]=N.useState([]),[u,d]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState([]),[w,b]=N.useState(!0),[k,P]=N.useState(""),[L,E]=N.useState([]),[_,B]=N.useState({}),[M,F]=N.useState({}),[T,O]=N.useState(!1),[Y,me]=N.useState(null),[ae,fe]=N.useState([]),[he,te]=N.useState(!1),[pe,Ie]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[S,I]=N.useState(!1),[V,j]=N.useState(""),[U,G]=N.useState([]),[R,X]=N.useState(!1),[se,ye]=N.useState(!1),[z,Me]=N.useState(null);N.useEffect(()=>{(async()=>{try{const Le=await Ct(At(je,"sellers_candies")),ut=[];Le.forEach(be=>{const ge=be.data();ut.push({id:be.id,name:ge.name||"",commissionPercent:Number(ge.commissionPercent||0)})}),E(ut)}catch(Le){console.error("Error cargando sellers_candies",Le)}})()},[]);const re=N.useMemo(()=>{const Le={};return L.forEach(ut=>{Le[ut.id]=ut}),Le},[L]);N.useEffect(()=>{(async()=>{b(!0),P("");try{const Le=await Ct(At(je,"sales_candies")),ut=[],be=[];Le.forEach(ot=>{const wt=ot.data(),Lt=u1e(wt,ot.id);Lt&&(Lt.date<=s&&ut.push(Lt),Lt.date>=r&&Lt.date<=s&&be.push(Lt))}),A(ut),l(be);const ge=await Ct(At(je,"inventory_candies")),K=[];ge.forEach(ot=>{const wt=ot.data(),Lt=Bp(wt);if(!Lt||Lt>s)return;const cr=Math.max(1,Math.floor(Number(wt.unitsPerPackage||1))),ar=Number(wt.totalUnits??wt.quantity??0),yr=Number(wt.packages??0),tr=Number(wt.remaining??0),et=Number(wt.remainingPackages??0),gt=yr>0?yr:ar>0?Math.floor(ar/cr):0,Rt=et>0?et:tr>0?Math.floor(tr/cr):0;K.push({id:ot.id,productId:wt.productId,productName:wt.productName||"",date:Lt,quantity:Number(gt||0),remaining:Number(Rt||0),purchasePrice:Number(wt.providerPrice||wt.purchasePrice||0),unitsPerPackage:cr})}),d(K);const _e=await Ct(At(je,"expenses_candies")),Oe=[];_e.forEach(ot=>{const wt=ot.data(),Lt=Bp(wt);Lt&&Lt>=r&&Lt<=s&&Oe.push({id:ot.id,date:Lt,category:wt.category||"",description:wt.description||"",amount:Number(wt.amount||0),status:wt.status||""})}),h(Oe);const Ve=await Ct(At(je,"ar_movements")),ve=[],Qe={};Ve.forEach(ot=>{const wt=ot.data(),Lt=Bp(wt);if(!Lt)return;const cr=wt.customerId,ar=Number(wt.amount||0);cr&&(Qe[cr]=(Qe[cr]||0)+ar),wt.type==="ABONO"&&Lt>=r&&Lt<=s&&ve.push({id:ot.id,customerId:cr,type:"ABONO",amount:ar,date:Lt})}),p(ve);const Ue=await Ct(At(je,"customers_candies")),Ee=[];Ue.forEach(ot=>{const wt=ot.data();Ee.push({id:ot.id,name:wt.name||"",balance:Qe[ot.id]||0})}),g(Ee);const We=await Ct(At(je,"inventory_candies_sellers")),nt={},Nt={};We.forEach(ot=>{const wt=ot.data(),Lt=Bp(wt);if(!Lt||Lt<r||Lt>s)return;const cr=wt.sellerId||wt.vendorId||"NO_VENDOR",ar=wt.productName||"",yr=wt.sku||"",tr=Math.max(1,Math.floor(Number(wt.unitsPerPackage||1))),et=Number(wt.totalUnits??0),gt=Number(wt.packages??0),Rt=Number(wt.remainingUnits??wt.remaining??0),kt=Number(wt.remainingPackages??0),jt=gt>0?gt:et>0?Math.floor(et/tr):0,Zt=kt>0?kt:Rt>0?Math.floor(Rt/tr):0,Vt=Number(wt.totalVendor??0),ie=Number(wt.gainVendor??0),ne=jt,ue=ne>0?Vt/ne:0,xe=ne>0?ie/ne:0;if(nt[cr]||(nt[cr]={associated:[],remaining:[]}),jt>0){const Fe=jt,De=Fe*ue,ee=De,Te=Fe*xe;nt[cr].associated.push({saleId:ot.id,date:Lt,productName:ar,sku:yr,qty:Fe,unitPrice:ue,lineTotal:De,discount:0,lineFinal:ee,vendorCommissionAmount:Te,type:"ASSOCIATED"}),Nt[cr]=(Nt[cr]||0)+Fe}if(Zt>0){const Fe=Zt,De=Fe*ue,ee=De,Te=Fe*xe;nt[cr].remaining.push({saleId:ot.id,date:Lt,productName:ar,sku:yr,qty:Fe,unitPrice:ue,lineTotal:De,discount:0,lineFinal:ee,vendorCommissionAmount:Te,type:"REMAINING"})}}),B(nt),F(Nt)}catch(Le){console.error(Le),P(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,s,t]);const W=N.useCallback(Le=>{if(Le.vendorId&&re[Le.vendorId])return re[Le.vendorId];const ut=(Le.vendorName||"").trim().toLowerCase();if(ut)return L.find(be=>(be.name||"").trim().toLowerCase()===ut)},[re,L]),q=N.useCallback((Le,ut)=>{const be=Number(ut.vendorCommissionAmount||0);if(be)return be;const ge=W(Le);if(!ge||!ge.commissionPercent)return 0;const K=Number(ut.qty||0),_e=Number(ut.unitPrice||0),Oe=K*_e,Ve=Math.max(0,Number(ut.discount||0)),ve=Math.max(0,Oe-Ve);if(!ve)return 0;const Qe=Number(ge.commissionPercent)||0;return ve*Qe/100},[W]),oe=N.useMemo(()=>{try{return d1e(u,c,r,s)}catch(Le){return console.error(Le),0}},[u,c,r,s]),de=N.useMemo(()=>{const Le=o.reduce((Ee,We)=>Ee+(We.total||0),0),ut=f.reduce((Ee,We)=>Ee+(We.amount||0),0),be=Le-oe,ge=be-ut,K=m.reduce((Ee,We)=>Ee+Math.abs(We.amount||0),0),_e=x.filter(Ee=>(Ee.balance||0)>0),Oe=_e.reduce((Ee,We)=>Ee+(We.balance||0),0);let Ve=0,ve=0,Qe=0,Ue=0;for(const Ee of o){const We=(Ee.items||[]).reduce((Nt,ot)=>Nt+(Number(ot.qty)||0),0),nt=(Ee.items||[]).reduce((Nt,ot)=>Nt+q(Ee,ot),0);Ee.type==="CONTADO"?(Ve+=We,Qe+=nt):(ve+=We,Ue+=nt)}return{ventasTotales:Le,costoMercaderia:oe,gastosPeriodo:ut,gananciaAntes:be,gananciaDespues:ge,abonosRecibidos:K,saldosPendientes:Oe,clientesConSaldo:_e.length,paquetesCash:Ve,paquetesCredito:ve,comisionCash:Qe,comisionCredito:Ue}},[o,f,m,x,oe,q]),Be=N.useMemo(()=>{const Le={},ut={};for(const be of o)if(!(be.type!=="CREDITO"||!be.customerId))for(const ge of be.items||[]){const K=Number(ge.qty||0),_e=Number(ge.unitPrice||0),Oe=K*_e,Ve=Math.max(0,Number(ge.discount||0)),ve=Math.max(0,Oe-Ve);Le[be.customerId]=(Le[be.customerId]||0)+K,ut[be.customerId]=(ut[be.customerId]||0)+ve}return x.filter(be=>(be.balance||0)>0).map(be=>({customerId:be.id,name:be.name,paquetesAsociados:Le[be.id]||0,saldoTotal:ut[be.id]||0,saldoPendiente:be.balance||0})).sort((be,ge)=>ge.saldoPendiente-be.saldoPendiente)},[x,o]),He=N.useMemo(()=>{const Le={};return x.forEach(ut=>Le[ut.id]=ut.name),Le},[x]),$e=N.useMemo(()=>[...o].sort((Le,ut)=>ut.date.localeCompare(Le.date)).map(Le=>{var K;const ut=(Le.items||[]).reduce((_e,Oe)=>_e+(Number(Oe.qty)||0),0);let be="Cash";Le.type==="CREDITO"&&Le.customerId?be=He[Le.customerId]||"":Le.type==="CONTADO"&&(be=((K=Le.customerName)==null?void 0:K.trim())||"Cash");const ge=ut>0?Le.total/ut:0;return{id:Le.id,date:Le.date,type:Le.type==="CREDITO"?"Crdito":"Cash",customer:be,paquetes:ut,total:Number(Le.total||0),avgPrice:ge}}),[o,He]),Je=N.useMemo(()=>{var ut,be;const Le=new Map;for(const ge of o){const K=ge.vendorId||"NO_VENDOR",_e=ge.vendorName||((ut=re[K])==null?void 0:ut.name)||"Sin vendedor";Le.has(K)||Le.set(K,{vendorId:K,vendorName:_e,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const Oe=Le.get(K);for(const Ve of ge.items||[]){const ve=Number(Ve.qty||0),Qe=Number(Ve.unitPrice||0),Ue=ve*Qe,Ee=Math.max(0,Number(Ve.discount||0)),We=Math.max(0,Ue-Ee),nt=q(ge,Ve);ge.type==="CONTADO"?(Oe.paquetesVendidos+=ve,Oe.totalVendido+=We,Oe.comisionCash+=nt):(Oe.paquetesFiados+=ve,Oe.totalFiado+=We,Oe.comisionCredito+=nt)}}for(const[ge,K]of Object.entries(M)){const _e=Le.get(ge),Oe=(_e==null?void 0:_e.vendorName)||((be=re[ge])==null?void 0:be.name)||"Sin vendedor",Ve=_e||{vendorId:ge,vendorName:Oe,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};Ve.paquetesAsociados=K,Ve.paquetesRestantes=Math.max(K-Ve.paquetesVendidos-Ve.paquetesFiados,0),Le.set(ge,Ve)}return Array.from(Le.values()).sort((ge,K)=>K.totalVendido+K.totalFiado-(ge.totalVendido+ge.totalFiado))},[o,M,re,q]),ct=async Le=>{O(!0),me({id:Le.customerId,name:Le.name}),fe([]),te(!0),Ie({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const ut=[];let be=0,ge=0,K=0;for(const ve of o)if(!(ve.type!=="CREDITO"||ve.customerId!==Le.customerId))for(const Qe of ve.items||[]){const Ue=Number(Qe.qty||0),Ee=Number(Qe.unitPrice||0),We=Ue*Ee,nt=Math.max(0,Number(Qe.discount||0)),Nt=Math.max(0,We-nt);ut.push({saleId:ve.id,date:ve.date,productName:Qe.productName,sku:Qe.sku||"",qty:Ue,unitPrice:Ee,lineTotal:We,discount:nt,lineFinal:Nt}),be+=We,ge+=nt,K+=Nt}let _e=0;for(const ve of m)ve.customerId===Le.customerId&&(_e+=Math.abs(ve.amount||0));const Oe=x.find(ve=>ve.id===Le.customerId),Ve=(Oe==null?void 0:Oe.balance)||0;fe(ut),Ie({totalBruto:be,totalDescuento:ge,totalFiado:K,saldoActual:Ve,abonadoPeriodo:_e})}catch(ut){console.error(ut),P(" No se pudo cargar el detalle del cliente.")}finally{te(!1)}},at=(Le,ut,be)=>{I(!0);let ge="";be==="ASSOCIATED"?ge=`Paquetes asociados  ${ut}`:be==="REMAINING"?ge=`Paquetes restantes  ${ut}`:be==="CASH"?ge=`Paquetes vendidos (Cash)  ${ut}`:ge=`Paquetes fiados (Crdito)  ${ut}`,j(ge),G([]),X(!0);try{if(be==="ASSOCIATED"||be==="REMAINING"){const _e=_[Le],Oe=be==="ASSOCIATED"?(_e==null?void 0:_e.associated)||[]:(_e==null?void 0:_e.remaining)||[];G([...Oe].sort((Ve,ve)=>Ve.date.localeCompare(ve.date))),X(!1);return}const K=[];for(const _e of o)if(((_e.vendorId||"NO_VENDOR")===Le||!_e.vendorId&&Le==="NO_VENDOR")&&!(be==="CASH"&&_e.type!=="CONTADO")&&!(be==="CREDIT"&&_e.type!=="CREDITO"))for(const Ve of _e.items||[]){const ve=Number(Ve.qty||0),Qe=Number(Ve.unitPrice||0),Ue=ve*Qe,Ee=Math.max(0,Number(Ve.discount||0)),We=Math.max(0,Ue-Ee),nt=q(_e,Ve);K.push({saleId:_e.id,date:_e.date,productName:Ve.productName,sku:Ve.sku||"",qty:ve,unitPrice:Qe,lineTotal:Ue,discount:Ee,lineFinal:We,vendorCommissionAmount:nt,type:be})}G(K.sort((_e,Oe)=>_e.date.localeCompare(Oe.date)))}catch(K){console.error(K),P(" No se pudo cargar el detalle del vendedor.")}finally{X(!1)}},mt=Le=>{const ut=o.find(be=>be.id===Le)||null;Me(ut),ye(!0)},st=async Le=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await ux(Le),await h1e(Le),l(ut=>ut.filter(be=>be.id!==Le)),A(ut=>ut.filter(be=>be.id!==Le)),ye(!1),Me(null)}catch(ut){console.error(ut),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(kc,{onClick:e,loading:w})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Le=>n(Le.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:Le=>a(Le.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:en(de.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(de.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(de.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:en(de.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(de.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:en(de.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:en(de.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:de.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:de.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:de.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:en(de.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:en(de.comisionCredito)})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Be.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Be.map(Le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Le.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ct({customerId:Le.customerId,name:Le.name}),title:"Ver paquetes fiados del periodo",children:Le.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:en(Le.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:en(Le.saldoPendiente)})]},Le.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Je.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Je.map(Le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Le.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>at(Le.vendorId,Le.vendorName,"ASSOCIATED"),children:Le.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>at(Le.vendorId,Le.vendorName,"REMAINING"),children:Le.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>at(Le.vendorId,Le.vendorName,"CASH"),children:Le.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Le.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Le.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>at(Le.vendorId,Le.vendorName,"CREDIT"),children:Le.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Le.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Le.comisionCredito)})]},Le.vendorId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):$e.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):$e.map(Le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Le.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Le.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Le.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>mt(Le.id),children:Le.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Le.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Le.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>st(Le.id),children:"Eliminar"})})]},Le.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((Le,ut)=>Le.date.localeCompare(ut.date)).map(Le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Le.date}),i.jsx("td",{className:"p-2 border",children:Le.category||""}),i.jsx("td",{className:"p-2 border",children:Le.description?i.jsx("span",{title:Le.description,children:Le.description.length>40?Le.description.slice(0,40)+"":Le.description}):""}),i.jsx("td",{className:"p-2 border",children:en(Le.amount)}),i.jsx("td",{className:"p-2 border",children:Le.status||""})]},Le.id))})]})}),k&&i.jsx("p",{className:"mt-2 text-sm",children:k}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(Y==null?void 0:Y.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>O(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(pe.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(pe.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(pe.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:en(pe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(pe.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:he?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ae.sort((Le,ut)=>Le.date.localeCompare(ut.date)).map((Le,ut)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Le.date}),i.jsx("td",{className:"p-2 border",children:Le.productName}),i.jsx("td",{className:"p-2 border",children:Le.sku||""}),i.jsx("td",{className:"p-2 border",children:Le.qty}),i.jsx("td",{className:"p-2 border",children:en(Le.unitPrice)}),i.jsx("td",{className:"p-2 border",children:en(Le.lineTotal)}),i.jsx("td",{className:"p-2 border",children:en(Le.discount)}),i.jsx("td",{className:"p-2 border",children:en(Le.lineFinal)})]},`${Le.saleId}-${ut}`))})]})})]})}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:V}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>I(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:R?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):U.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):U.map((Le,ut)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Le.date}),i.jsx("td",{className:"p-2 border",children:Le.productName}),i.jsx("td",{className:"p-2 border",children:Le.sku||""}),i.jsx("td",{className:"p-2 border",children:Le.qty}),i.jsx("td",{className:"p-2 border",children:en(Le.unitPrice)}),i.jsx("td",{className:"p-2 border",children:en(Le.lineTotal)}),i.jsx("td",{className:"p-2 border",children:en(Le.discount)}),i.jsx("td",{className:"p-2 border",children:en(Le.lineFinal)}),i.jsx("td",{className:"p-2 border",children:en(Le.vendorCommissionAmount)})]},`${Le.saleId}-${ut}`))})]})})]})}),se&&z&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",z.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ye(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(z.items||[]).map((Le,ut)=>{const be=Number(Le.qty||0),ge=Number(Le.unitPrice||0),K=be*ge,_e=q(z,Le);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Le.productName}),i.jsx("td",{className:"p-2 border",children:Le.sku||""}),i.jsx("td",{className:"p-2 border",children:be}),i.jsx("td",{className:"p-2 border",children:en(ge)}),i.jsx("td",{className:"p-2 border",children:en(K)}),i.jsx("td",{className:"p-2 border",children:en(_e)})]},ut)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),en(z.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>st(z.id),children:"Eliminar venta"})]})]})})]})}const w3=["Rivas","Isla Ometepe","San Jorge"];function m1e(){const{refreshKey:t,refresh:e}=Xl(),[r,n]=N.useState([]),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(!1),[u,d]=N.useState(""),[f,h]=N.useState("0"),[m,p]=N.useState("Rivas"),[x,g]=N.useState(null),[w,b]=N.useState(""),[k,P]=N.useState("0"),[L,E]=N.useState("Rivas");N.useEffect(()=>{(async()=>{a(!0),l("");try{const Y=Ot(At(je,"sellers_candies"),Dr("name","asc")),me=await Ct(Y),ae=[];me.forEach(fe=>{const he=fe.data();ae.push({id:fe.id,name:he.name||"",commissionPercent:Number(he.commissionPercent||0),branch:he.branch||"Rivas",createdAt:he.createdAt||Gt.now()})}),n(ae)}catch(Y){console.error(Y),l(" Error cargando vendedores.")}finally{a(!1)}})()},[t]);const _=()=>{d(""),h("0"),p("Rivas")},B=async Y=>{Y.preventDefault(),l("");const me=u.trim();if(!me){l("Ingresa el nombre y apellido del vendedor.");return}const ae=Number(f||0);if(ae<0){l("La comisin no puede ser negativa.");return}try{const fe={name:me,commissionPercent:ae,branch:m,createdAt:Gt.now()},he=await Jr(At(je,"sellers_candies"),fe);n(te=>[{id:he.id,...fe},...te]),l(" Vendedor creado correctamente."),_(),A(!1)}catch(fe){console.error(fe),l(" Error al crear el vendedor.")}},M=Y=>{g(Y.id),b(Y.name),P(Y.commissionPercent.toString()),E(Y.branch)},F=()=>{g(null),b(""),P("0"),E("Rivas")},T=async()=>{if(!x)return;l("");const Y=w.trim();if(!Y){l("El nombre y apellido no pueden estar vacos.");return}const me=Number(k||0);if(me<0){l("La comisin no puede ser negativa.");return}try{await Tr(Tt(je,"sellers_candies",x),{name:Y,commissionPercent:me,branch:L}),n(ae=>ae.map(fe=>fe.id===x?{...fe,name:Y,commissionPercent:me,branch:L}:fe)),l(" Vendedor actualizado."),F()}catch(ae){console.error(ae),l(" Error al actualizar el vendedor.")}},O=async Y=>{if(window.confirm(`Eliminar al vendedor "${Y.name}"? Esta accin no se puede deshacer.`))try{await dn(Tt(je,"sellers_candies",Y.id)),n(ae=>ae.filter(fe=>fe.id!==Y.id)),l(" Vendedor eliminado.")}catch(ae){console.error(ae),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(kc,{onClick:e,loading:s}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>A(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:B,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:u,onChange:Y=>d(Y.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comisin (% sobre venta total)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:f,onChange:Y=>h(Y.target.value),placeholder:"Ej: 10"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje se usa para calcular la comisin del vendedor sobre el total de la venta (no es el margen del producto)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:Y=>p(Y.target.value),children:w3.map(Y=>i.jsx("option",{value:Y,children:Y},Y))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{_(),A(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Comisin (%)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(Y=>{const me=x===Y.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:me?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:w,onChange:ae=>b(ae.target.value)}):Y.name}),i.jsx("td",{className:"p-2 border",children:me?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:k,onChange:ae=>P(ae.target.value)}):`${Y.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:me?i.jsx("select",{className:"border p-1 rounded text-xs",value:L,onChange:ae=>E(ae.target.value),children:w3.map(ae=>i.jsx("option",{value:ae,children:ae},ae))}):Y.branch}),i.jsx("td",{className:"p-2 border",children:me?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:T,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:F,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>M(Y),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>O(Y),children:"Borrar"})]})})]},Y.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Ka=t=>Math.max(0,Math.floor(Number(t||0)));function p1e(t){return Math.max(1,Ka(t.unitsPerPackage||1))}async function g1e(t){const{orderId:e,productId:r}=t;let n=Ka(t.packagesToReturn);if(!e||!r||n<=0)return;const s=Ot(At(je,"inventory_candies"),$t("orderId","==",e),$t("productId","==",r),Dr("createdAt","asc")),a=await Ct(s);if(a.empty)return;const o=a.docs.map(l=>l.ref);await ma(je,async l=>{const c=await Promise.all(o.map(A=>l.get(A)));for(let A=0;A<o.length&&n>0;A++){const u=c[A];if(!u.exists())continue;const d=u.data(),f=p1e(d),h=n*f,p=Ka(d.remaining??0)+h,x=Math.floor(p/f);l.update(o[A],{remaining:p,remainingPackages:x,packages:x,updatedAt:Gt.now()}),n=0}})}async function x1e(t){const{orderId:e,productId:r}=t,n=Ka(t.packagesToReturn);if(!e||!r||n<=0)return;const s=Tt(je,"candy_main_orders",e);await ma(je,async a=>{const o=await a.get(s);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let A=!1;const u=c.map(d=>String((d==null?void 0:d.id)||"")!==String(r)?d:(A=!0,{...d,remainingPackages:Ka(d.remainingPackages)+n}));A&&a.update(s,{items:u,updatedAt:Gt.now()})})}function v1e(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),s=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),a=Ka((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,Ka((r==null?void 0:r.unitsPerPackage)||1));!n||!s||a<=0||e.push({batchId:n,masterOrderId:s,units:a,unitsPerPackage:o})}return e}function b3(t,e){const r=Ka(t),n=Math.max(1,Ka(e));return Math.floor(r/n)}async function N3(t){if(!t)throw new Error("vendorInventoryId requerido");const e=Tt(je,"inventory_candies_sellers",t),r=await Xa(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),s=String(n.productId||""),a=Ka(n.packages||n.remainingPackages||0),o=v1e(n.masterAllocations||n.allocations||n.allocationsByBatch);if(!o.length){const c=String(n.orderId||"");if(!c)throw new Error("La orden del vendedor no tiene orderId");if(!s)throw new Error("La orden del vendedor no tiene productId");return a<=0?(await ma(je,async A=>{A.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await g1e({orderId:c,productId:s,packagesToReturn:a}),await x1e({orderId:c,productId:s,packagesToReturn:a}),await ma(je,async A=>{A.delete(e)}),{restoredPackages:a,mode:"legacy"})}let l=0;return await ma(je,async c=>{const A={};for(const x of o){const g=Math.max(1,Ka(x.unitsPerPackage||1)),w=Ka(x.units),b=b3(w,g);b>0&&(A[x.masterOrderId]=(A[x.masterOrderId]||0)+b)}const u=o.map(x=>Tt(je,"inventory_candies",x.batchId)),f=Object.keys(A).map(x=>Tt(je,"candy_main_orders",x)),[h,m]=await Promise.all([Promise.all(u.map(x=>c.get(x))),Promise.all(f.map(x=>c.get(x)))]);let p=0;for(let x=0;x<o.length;x++){const g=o[x],w=h[x];if(!w.exists())continue;const b=w.data(),k=Math.max(1,Ka(g.unitsPerPackage||b.unitsPerPackage||1)),P=Ka(g.units),E=Ka(b.remaining??0)+P,_=Math.floor(E/k);c.update(u[x],{remaining:E,remainingPackages:_,packages:_,updatedAt:Gt.now()});const B=b3(P,k);B>0&&(p+=B)}for(let x=0;x<f.length;x++){const g=m[x];if(!g.exists())continue;const w=f[x].id,b=Ka(A[w]||0);if(b<=0)continue;const k=g.data(),P=Array.isArray(k.items)?k.items:[];let L=!1;const E=P.map(_=>String((_==null?void 0:_.id)||"")!==String(s)?_:(L=!0,{..._,remainingPackages:Ka(_.remainingPackages)+b}));L&&c.update(f[x],{items:E,updatedAt:Gt.now()})}c.delete(e),l=p}),{restoredPackages:l,mode:"blind"}}const Wr=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function y1e(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const C3=t=>Math.max(0,Math.floor(Number(t||0)));function w1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const{refreshKey:n,refresh:s}=Xl(),a=!t||t==="admin",o=t==="vendedor_dulces",l=(r||"").trim().toLowerCase(),c=!a&&o,[A,u]=N.useState({}),[d,f]=N.useState([]),[h,m]=N.useState([]),[p,x]=N.useState({}),[g,w]=N.useState(null),[b,k]=N.useState([]),[P,L]=N.useState(!0),[E,_]=N.useState(""),[B,M]=N.useState(!1),[F,T]=N.useState(null),[O,Y]=N.useState([]),[me,ae]=N.useState(""),[fe,he]=N.useState(""),[te,pe]=N.useState(""),[Ie,S]=N.useState("0"),[I,V]=N.useState([]),[j,U]=N.useState(!1),G=N.useMemo(()=>d.find(ee=>ee.id===me)||null,[me,d]),R=G==null?void 0:G.branch,X=N.useMemo(()=>h.find(ee=>ee.id===te)||null,[te,h]),se=N.useMemo(()=>new Set(I.map(ee=>ee.productId)),[I]),ye=N.useMemo(()=>h.filter(ee=>(p[ee.id]??0)>0||se.has(ee.id)).sort((ee,Te)=>ee.name.localeCompare(Te.name)),[h,p,se]),z=N.useMemo(()=>{const ee={};return d.forEach(Te=>ee[Te.id]=Te),ee},[d]),Me=N.useMemo(()=>!o||!l?null:d.find(ee=>(ee.email||"").trim().toLowerCase()===l)||null,[o,l,d]),re=N.useMemo(()=>{const ee=d.find(Te=>(Te.email||"").trim().toLowerCase()===l)||null;return(ee==null?void 0:ee.name)||(r||"").trim()||""},[d,l,r]),W=async()=>{try{const ee=At(je,"inventory_transfers_candies");if(!o){const Ye=await Ct(ee),ze={};Ye.forEach(rt=>{const dt=rt.data(),Mt=Number(dt.packagesMoved||0),Kt=String(dt.fromOrderKey||""),xr=String(dt.toOrderKey||"");Kt&&(ze[Kt]=ze[Kt]||{out:0,in:0},ze[Kt].out+=Mt),xr&&(ze[xr]=ze[xr]||{out:0,in:0},ze[xr].in+=Mt)}),u(ze);return}const Te=Ot(ee,$t("fromSellerId","==",e)),Ae=Ot(ee,$t("toSellerId","==",e)),[Pe,Ce]=await Promise.all([Ct(Te),Ct(Ae)]),Ze={},Xe=(Ye,ze)=>{Ye.forEach(rt=>{const dt=rt.data(),Mt=Number(dt.packagesMoved||0),Kt=String(ze==="out"?dt.fromOrderKey||"":dt.toOrderKey||"");Kt&&(Ze[Kt]=Ze[Kt]||{out:0,in:0},Ze[Kt][ze]+=Mt)})};Xe(Pe.docs,"out"),Xe(Ce.docs,"in"),u(Ze)}catch(ee){console.error(ee),u({})}};N.useEffect(()=>{(async()=>{L(!0),_("");try{const ee=await Ct(Ot(At(je,"sellers_candies"),Dr("name","asc"))),Te=[];ee.forEach(rt=>{const dt=rt.data(),Mt=dt.branch||dt.branchLabel||dt.route||dt.sucursal||dt.location||"";Te.push({id:rt.id,name:dt.name||"",email:dt.email||"",commissionPercent:Number(dt.commissionPercent||0),branch:y1e(Mt),branchLabel:Mt})}),f(Te);const Ae=await Ct(At(je,"inventory_candies")),Pe={},Ce={};Ae.forEach(rt=>{var so;const dt=rt.data(),Mt=String(dt.productId||"");if(!Mt)return;const Kt=Number(dt.remainingPackages);if(Number.isFinite(Kt))Pe[Mt]=(Pe[Mt]||0)+Math.max(0,Math.floor(Kt));else{const DA=Number(dt.remaining??dt.quantity??0),Kn=Number(dt.unitsPerPackage||0);let Yl=0;Kn>0?Yl=DA/Kn:Yl=Number(dt.packages||0),Pe[Mt]=(Pe[Mt]||0)+Math.max(0,Yl)}const xr=String(dt.date||""),Hn=Number(((so=dt.createdAt)==null?void 0:so.seconds)??0),Tn={unitPriceRivas:Number(dt.unitPriceRivas||0),unitPriceSanJorge:Number(dt.unitPriceSanJorge||0),unitPriceIsla:Number(dt.unitPriceIsla||0),date:xr,createdAtSec:Hn};if(!(Tn.unitPriceRivas>0||Tn.unitPriceSanJorge>0||Tn.unitPriceIsla>0))return;const Rs=Ce[Mt];if(!Rs){Ce[Mt]=Tn;return}const no=`${Rs.date}#${String(Rs.createdAtSec).padStart(10,"0")}`;`${Tn.date}#${String(Tn.createdAtSec).padStart(10,"0")}`>no&&(Ce[Mt]=Tn)}),Object.keys(Pe).forEach(rt=>Pe[rt]=Math.floor(Pe[rt])),x(Pe);const Ze=await Ct(Ot(At(je,"products_candies"),Dr("name","asc"))),Xe=[];Ze.forEach(rt=>{const dt=rt.data(),Mt=rt.id,Kt=Ce[Mt];Xe.push({id:Mt,name:dt.name||"",category:dt.category||"",providerPrice:Number(dt.providerPrice||0),packages:Number(dt.packages||0),unitsPerPackage:Number(dt.unitsPerPackage||0),unitPriceRivas:Number((Kt==null?void 0:Kt.unitPriceRivas)||0),unitPriceSanJorge:Number((Kt==null?void 0:Kt.unitPriceSanJorge)||0),unitPriceIsla:Number((Kt==null?void 0:Kt.unitPriceIsla)||0)})}),m(Xe);const Ye=await Ct(o?Ot(At(je,"inventory_candies_sellers"),$t("sellerId","==",e),Dr("createdAt","desc")):Ot(At(je,"inventory_candies_sellers"),Dr("createdAt","desc"))),ze=[];Ye.forEach(rt=>{const dt=rt.data();ze.push({id:rt.id,sellerId:dt.sellerId,sellerName:dt.sellerName||"",productId:dt.productId,productName:dt.productName||"",category:dt.category||"",orderId:dt.orderId||null,packages:Number(dt.packages||0),unitsPerPackage:Number(dt.unitsPerPackage||0),totalUnits:Number(dt.totalUnits||0),remainingPackages:Number(dt.remainingPackages||0),remainingUnits:Number(dt.remainingUnits||0),providerPrice:Number(dt.providerPrice||0),totalRivas:Number(dt.totalRivas||0),totalSanJorge:Number(dt.totalSanJorge||0),totalIsla:Number(dt.totalIsla||0),unitPriceRivas:Number(dt.unitPriceRivas||0),unitPriceSanJorge:Number(dt.unitPriceSanJorge||0),unitPriceIsla:Number(dt.unitPriceIsla||0),markupPercent:Number(dt.markupPercent||0),subtotal:Number(dt.subtotal||0),totalVendor:Number(dt.totalVendor||0),gainVendor:Number(dt.gainVendor||0),unitPriceVendor:Number(dt.unitPriceVendor||0),date:dt.date||"",createdAt:dt.createdAt||Gt.now()})}),k(ze),await W()}catch(ee){console.error(ee),_(" Error cargando datos de vendedores / pedidos.")}finally{L(!1)}})()},[n,t,e]);const q=N.useMemo(()=>o&&Me?b.filter(ee=>ee.sellerId===Me.id):b,[b,o,Me,me]),oe=ee=>q.filter(Te=>(Te.orderId||Te.id)===ee),de=N.useMemo(()=>{var Te;const ee={};for(const Ae of q){const Pe=Ae.orderId||Ae.id,Ce=ee[Pe],Ze=Ae.date||((Te=Ae.createdAt)!=null&&Te.toDate?Ae.createdAt.toDate().toISOString().slice(0,10):"");if(Ce)Ce.totalPackages+=Ae.packages,Ce.totalRemainingPackages+=Ae.remainingPackages,Ce.subtotal+=Ae.subtotal,Ce.totalVendor+=Ae.totalVendor,Ze>Ce.date&&(Ce.date=Ze);else{const Xe=A[Pe]||{out:0,in:0};ee[Pe]={orderKey:Pe,sellerId:Ae.sellerId,sellerName:Ae.sellerName,date:Ze,totalPackages:Ae.packages,totalRemainingPackages:Ae.remainingPackages,subtotal:Ae.subtotal,totalVendor:Ae.totalVendor,transferredOut:Xe.out,transferredIn:Xe.in}}}return Object.values(ee).map(Ae=>{const Pe=A[Ae.orderKey]||{out:0,in:0};return{...Ae,transferredOut:Pe.out||0,transferredIn:Pe.in||0}}).sort((Ae,Pe)=>Pe.date.localeCompare(Ae.date))},[q,A]),Be=N.useMemo(()=>{const ee={};return de.forEach(Te=>ee[Te.orderKey]=Te),ee},[de]),He=N.useMemo(()=>{const ee=I.reduce((Xe,Ye)=>Xe+Ye.packages,0),Te=I.reduce((Xe,Ye)=>Xe+Ye.subtotal,0),Ae=I.reduce((Xe,Ye)=>Xe+Ye.totalVendor,0),Pe=I.reduce((Xe,Ye)=>Xe+Ye.gainVendor,0),Ce=Number((G==null?void 0:G.commissionPercent)||0),Ze=Ae*Ce/100;return{totalPackages:ee,subtotal:Te,totalVendor:Ae,gainVendor:Pe,commissionPercent:Ce,commissionAmount:Ze}},[I,G]),$e=()=>{T(null),Y([]),ae(""),he(""),pe(""),S("0"),V([])};function Je(ee){const Te=Number(ee.providerPrice||0),Ae=Number(ee.packages||0),Pe=Number(ee.unitPriceRivas||0),Ce=Number(ee.unitPriceSanJorge||0),Ze=Number(ee.unitPriceIsla||0),Xe=Te*Ae,Ye=Pe*Ae,ze=Ce*Ae,rt=Ze*Ae;let dt=Pe,Mt=Ye;switch(ee.sellerBranch){case"SAN_JORGE":dt=Ce,Mt=ze;break;case"ISLA":dt=Ze,Mt=rt;break;case"RIVAS":default:dt=Pe,Mt=Ye;break}const Kt=Mt-Xe;return{subtotal:Xe,totalVendor:Mt,gainVendor:Kt,pricePerPackage:dt,totalRivas:Ye,totalSanJorge:ze,totalIsla:rt,unitPriceRivas:Pe,unitPriceSanJorge:Ce,unitPriceIsla:Ze}}function ct(ee,Te){const{subtotal:Ae,totalVendor:Pe,gainVendor:Ce,pricePerPackage:Ze,totalRivas:Xe,totalSanJorge:Ye,totalIsla:ze,unitPriceRivas:rt,unitPriceSanJorge:dt,unitPriceIsla:Mt}=Je({providerPrice:ee.providerPrice,unitPriceRivas:ee.unitPriceRivas,unitPriceSanJorge:ee.unitPriceSanJorge,unitPriceIsla:ee.unitPriceIsla,packages:Te,sellerBranch:R});return{id:`${ee.id}-${Date.now()}-${Math.random()}`,productId:ee.id,productName:ee.name,category:ee.category,providerPrice:ee.providerPrice,unitsPerPackage:ee.unitsPerPackage,packages:Te,subtotal:Ae,totalVendor:Pe,gainVendor:Ce,pricePerPackage:Ze,totalRivas:Xe,totalSanJorge:Ye,totalIsla:ze,unitPriceRivas:rt,unitPriceSanJorge:dt,unitPriceIsla:Mt,remainingPackages:Te}}const at=()=>{if(c)return;if(!X){_("Selecciona un producto antes de agregarlo.");return}if(se.has(X.id)){_("Ese producto ya est agregado en este pedido.");return}const ee=Number(Ie||0);if(ee<=0){_("La cantidad de paquetes debe ser mayor a 0.");return}const Te=p[X.id]??0;if(!F&&ee>Te){_(`No hay suficientes paquetes en inventario general. Disponibles: ${Te}`);return}const Ae=ct(X,ee);V(Pe=>[...Pe,Ae]),pe(""),S("0")},mt=ee=>{c||V(Te=>Te.filter(Ae=>Ae.id!==ee))},st=(ee,Te)=>{if(c)return;const Ae=Number(Te||0);V(Pe=>Pe.map(Ce=>{if(Ce.id!==ee)return Ce;const{subtotal:Ze,totalVendor:Xe,gainVendor:Ye,pricePerPackage:ze,totalRivas:rt,totalSanJorge:dt,totalIsla:Mt}=Je({providerPrice:Ce.providerPrice,unitPriceRivas:Ce.unitPriceRivas,unitPriceSanJorge:Ce.unitPriceSanJorge,unitPriceIsla:Ce.unitPriceIsla,packages:Ae,sellerBranch:R});return{...Ce,packages:Ae,subtotal:Ze,totalVendor:Xe,gainVendor:Ye,pricePerPackage:ze,totalRivas:rt,totalSanJorge:dt,totalIsla:Mt}}))};async function Le(ee,Te,Ae){const Pe=await $ve({productId:ee,quantityPacks:Te,saleDate:Ae}),Ce=Array.isArray(Pe==null?void 0:Pe.allocations)?Pe.allocations:[];if(!Ce.length)return[];const Ze=Ce.map(ze=>String(ze.batchId||"")).filter(Boolean),Xe=await Promise.all(Ze.map(ze=>Xa(Tt(je,"inventory_candies",ze)))),Ye=[];for(let ze=0;ze<Ce.length;ze++){const rt=Ce[ze],dt=String(rt.batchId||""),Mt=C3(rt.qty||rt.units||rt.quantity||0),Kt=Xe[ze];if(!dt||Mt<=0||!Kt.exists())continue;const xr=Kt.data(),Hn=String(xr.orderId||""),Tn=Math.max(1,C3(xr.unitsPerPackage||1));Hn&&Ye.push({batchId:dt,masterOrderId:Hn,units:Mt,unitsPerPackage:Tn})}return Ye}const ut=async ee=>{if(ee.preventDefault(),j)return;if(!a){_("No tienes permiso para guardar pedidos.");return}if(_(""),!G){_("Selecciona un vendedor.");return}if(!I.length){_("Agrega al menos un producto al pedido.");return}const Te=new Date().toISOString().slice(0,10),Ae=fe||Te;try{if(L(!0),U(!0),F){const Pe={};O.forEach(Xe=>{Pe[Xe.productId]=Xe});const Ce={};I.forEach(Xe=>{Ce[Xe.productId]=Xe});for(const Xe of Object.keys(Ce)){const Ye=Ce[Xe],ze=Pe[Xe],rt=Number(Ye.packages||0),dt=ze?Number(ze.packages||0):0,Mt=rt-dt;if(Mt>0){const Kt=await Le(Xe,Mt,Ae);if(ze&&Kt.length){const xr=Tt(je,"inventory_candies_sellers",ze.id),Hn=await Xa(xr),Tn=Hn.exists()?Hn.data():{},Rs=[...Array.isArray(Tn.masterAllocations)?Tn.masterAllocations:[],...Kt];await Tr(xr,{masterAllocations:Rs,updatedAt:Gt.now()})}}else Mt<0}let Ze=[...b];for(const Xe of Object.keys(Ce)){const Ye=Ce[Xe],ze=Pe[Xe],rt=h.find(Kt=>Kt.id===Xe),dt=(rt==null?void 0:rt.unitsPerPackage)||Ye.unitsPerPackage||0,Mt=Ye.packages>0&&dt>0?Ye.packages*dt:0;if(ze)await Tr(Tt(je,"inventory_candies_sellers",ze.id),{sellerId:G.id,sellerName:G.name,productId:Xe,productName:Ye.productName,category:Ye.category,packages:Ye.packages,unitsPerPackage:dt,totalUnits:Mt,remainingPackages:Ye.packages,remainingUnits:Mt,providerPrice:Ye.providerPrice,totalRivas:Ye.totalRivas,totalSanJorge:Ye.totalSanJorge,totalIsla:Ye.totalIsla,unitPriceRivas:Ye.unitPriceRivas,unitPriceSanJorge:Ye.unitPriceSanJorge,unitPriceIsla:Ye.unitPriceIsla,markupPercent:0,subtotal:Ye.subtotal,totalVendor:Ye.totalVendor,gainVendor:Ye.gainVendor,unitPriceVendor:Ye.pricePerPackage,date:Ae,orderId:ze.orderId||F,updatedAt:Gt.now()}),Ze=Ze.map(Kt=>Kt.id===ze.id?{...Kt,sellerId:G.id,sellerName:G.name,productId:Xe,productName:Ye.productName,category:Ye.category,packages:Ye.packages,unitsPerPackage:dt,totalUnits:Mt,remainingPackages:Ye.packages,remainingUnits:Mt,providerPrice:Ye.providerPrice,totalRivas:Ye.totalRivas,totalSanJorge:Ye.totalSanJorge,totalIsla:Ye.totalIsla,unitPriceRivas:Ye.unitPriceRivas,unitPriceSanJorge:Ye.unitPriceSanJorge,unitPriceIsla:Ye.unitPriceIsla,markupPercent:0,subtotal:Ye.subtotal,totalVendor:Ye.totalVendor,gainVendor:Ye.gainVendor,unitPriceVendor:Ye.pricePerPackage,date:Ae,orderId:ze.orderId||F}:Kt);else{const Kt=await Le(Xe,Ye.packages,Ae),xr={sellerId:G.id,sellerName:G.name,productId:Xe,productName:Ye.productName,category:Ye.category,orderId:F,packages:Ye.packages,unitsPerPackage:dt,totalUnits:Mt,remainingPackages:Ye.packages,remainingUnits:Mt,providerPrice:Ye.providerPrice,totalRivas:Ye.totalRivas,totalSanJorge:Ye.totalSanJorge,totalIsla:Ye.totalIsla,unitPriceRivas:Ye.unitPriceRivas,unitPriceSanJorge:Ye.unitPriceSanJorge,unitPriceIsla:Ye.unitPriceIsla,markupPercent:0,subtotal:Ye.subtotal,totalVendor:Ye.totalVendor,gainVendor:Ye.gainVendor,unitPriceVendor:Ye.pricePerPackage,date:Ae,createdAt:Gt.now(),status:"ASIGNADO",masterAllocations:Kt};Ze=[{id:(await Jr(At(je,"inventory_candies_sellers"),xr)).id,...xr},...Ze]}}for(const Xe of Object.keys(Pe))if(!Ce[Xe]){const Ye=Pe[Xe];await N3(Ye.id),Ze=Ze.filter(ze=>ze.id!==Ye.id)}k(Ze),_(" Pedido actualizado para el vendedor y sincronizado con inventario principal.")}else{const Pe=`ORD-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;for(const Ce of I){const Ze=h.find(dt=>dt.id===Ce.productId);if(!Ze)continue;const Xe=Ce.packages>0&&Ze.unitsPerPackage>0?Ce.packages*Ze.unitsPerPackage:0,Ye=await Le(Ce.productId,Ce.packages,Ae),ze={sellerId:G.id,sellerName:G.name,productId:Ce.productId,productName:Ce.productName,category:Ce.category,orderId:Pe,packages:Ce.packages,unitsPerPackage:Ze.unitsPerPackage,totalUnits:Xe,remainingPackages:Ce.packages,remainingUnits:Xe,providerPrice:Ce.providerPrice,totalRivas:Ce.totalRivas,totalSanJorge:Ce.totalSanJorge,totalIsla:Ce.totalIsla,unitPriceRivas:Ce.unitPriceRivas,unitPriceSanJorge:Ce.unitPriceSanJorge,unitPriceIsla:Ce.unitPriceIsla,markupPercent:0,subtotal:Ce.subtotal,totalVendor:Ce.totalVendor,gainVendor:Ce.gainVendor,unitPriceVendor:Ce.pricePerPackage,date:Ae,createdAt:Gt.now(),status:"ASIGNADO",masterAllocations:Ye},rt=await Jr(At(je,"inventory_candies_sellers"),ze);k(dt=>[{id:rt.id,...ze},...dt])}_(" Pedido asignado al vendedor y descontado del inventario.")}$e(),M(!1)}catch(Pe){console.error(Pe),_((Pe==null?void 0:Pe.message)||" Error al guardar el pedido del vendedor / ajustar inventario.")}finally{U(!1),L(!1)}},be=()=>{if(!G){_("Selecciona un vendedor para imprimir el pedido.");return}if(!I.length){_("No hay productos en el pedido para imprimir.");return}const ee=fe||new Date().toISOString().slice(0,10),Te=Xe=>(Xe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Ae="Pedido de dulces para vendedor",Pe=I.map(Xe=>`
      <tr>
        <td>${Te(Xe.productName)}</td>
        <td class="right">${Te(Xe.category||"")}</td>
        <td class="right">${Xe.packages}</td>

        <td class="right">${Wr(Xe.providerPrice)}</td>
        <td class="right">${Wr(Xe.subtotal)}</td>
        <td class="right">${Wr(Xe.pricePerPackage)}</td>
        <td class="right">${Wr(Xe.totalVendor)}</td>
      </tr>`).join(""),Ce=`<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>${Te(Ae)}</title>
  <style>
    *{font-family: Arial, sans-serif; box-sizing:border-box;}
    body{margin:16px;font-size:13px;}
    h1{font-size:18px;margin:0 0 4px;}
    h2{font-size:14px;margin:12px 0 6px;}
    .muted{color:#555;font-size:11px;margin-bottom:10px;}
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 18px;margin:10px 0 14px;}
    .card{border:1px solid #ddd;border-radius:6px;padding:6px 8px;background:#fafafa;}
    .label{font-size:11px;color:#555;margin-bottom:2px;}
    .value{font-size:14px;font-weight:bold;}
    table{width:100%;border-collapse:collapse;margin-top:8px;font-size:12px;}
    th,td{border:1px solid #ddd;padding:4px 6px;}
    th{background:#f5f5f5;text-align:left;}
    .right{text-align:right;}
    @media print{
      @page{size:A5;margin:10mm;}
      body{margin:0;font-size:12px;}
    }
  </style>
</head>
<body>
  <h1>${Te(Ae)}</h1>
  <div class="muted">
    Fecha pedido: <b>${Te(ee)}</b><br/>
    Vendedor: <b>${Te(G.name)}</b>${G.commissionPercent?` &mdash; Comisin: <b>${G.commissionPercent.toFixed(2)}%</b>`:""}${G.branchLabel?`<br/>Ruta / sucursal: <b>${Te(G.branchLabel)}</b>`:""}
  </div>

  <div class="grid">
    <div class="card">
      <div class="label">Paquetes totales del pedido</div>
      <div class="value">${He.totalPackages}</div>
    </div>
    <div class="card">
      <div class="label">Subtotal costo (proveedor)</div>
      <div class="value">${Wr(He.subtotal)}</div>
    </div>
    <div class="card">
      <div class="label">Total vendedor (precio venta)</div>
      <div class="value">${Wr(He.totalVendor)}</div>
    </div>
    <div class="card">
      <div class="label">Comisin posible del vendedor</div>
      <div class="value">${Wr(He.commissionAmount)}</div>
    </div>
  </div>

  <h2>Detalle del pedido</h2>
  <table>
    <thead>
      <tr>
        <th>Producto</th>
        <th class="right">Categora</th>
        <th class="right">Paquetes</th>
        <th class="right">P. Proveedor (paq)</th>
        <th class="right">Subtotal</th>
        <th class="right">P. Paquete vendedor</th>
        <th class="right">Total vendedor</th>
      </tr>
    </thead>
    <tbody>
      ${Pe}
    </tbody>
  </table>

  <script>window.print()<\/script>
</body>
</html>`,Ze=window.open("","_blank");if(!Ze){alert("No se pudo abrir la ventana de impresin (revisa bloqueadores de pop-ups).");return}Ze.document.open(),Ze.document.write(Ce),Ze.document.close()},ge=ee=>{const Te=q.filter(Ce=>(Ce.orderId||Ce.id)===ee);if(!Te.length){_("No se encontraron filas para este pedido.");return}const Ae=Te[0];if(o&&Me&&Ae.sellerId!==Me.id){_("No tienes permiso para ver este pedido.");return}T(ee),Y(Te),ae(Ae.sellerId),he(Ae.date);const Pe=Te.map(Ce=>{const Ze=Ce.unitPriceRivas||0,Xe=Ce.unitPriceSanJorge||0,Ye=Ce.unitPriceIsla||0,ze=Ce.totalRivas||Ze*Number(Ce.packages||0),rt=Ce.totalSanJorge||Xe*Number(Ce.packages||0),dt=Ce.totalIsla||Ye*Number(Ce.packages||0);return{id:Ce.id,productId:Ce.productId,productName:Ce.productName,category:Ce.category,providerPrice:Ce.providerPrice,unitsPerPackage:Ce.unitsPerPackage,packages:Ce.packages,subtotal:Ce.subtotal,totalVendor:Ce.totalVendor,gainVendor:Ce.gainVendor,pricePerPackage:Ce.unitPriceVendor,totalRivas:ze,totalSanJorge:rt,totalIsla:dt,unitPriceRivas:Ze,unitPriceSanJorge:Xe,unitPriceIsla:Ye,remainingPackages:Ce.remainingPackages}});V(Pe),pe(""),S("0"),M(!0)},K=async ee=>{if(!a){_("No tienes permiso para borrar pedidos.");return}const Te=b.filter(Ce=>(Ce.orderId||Ce.id)===ee);if(!Te.length)return;const Ae=Te[0].sellerName||"";if(confirm(`Eliminar COMPLETAMENTE este pedido del vendedor "${Ae}"? Se regresarn los paquetes al inventario principal.`))try{L(!0);for(const Ce of Te)await N3(Ce.id);k(Ce=>Ce.filter(Ze=>(Ze.orderId||Ze.id)!==ee)),_(" Pedido eliminado y paquetes regresados correctamente.")}catch(Ce){console.error(Ce),_(" Error al eliminar el pedido / regresar paquetes.")}finally{L(!1)}},[_e,Oe]=N.useState(!1),[Ve,ve]=N.useState(!1),[Qe,Ue]=N.useState([]),[Ee,We]=N.useState(""),[nt,Nt]=N.useState(""),[ot,wt]=N.useState(""),[Lt,cr]=N.useState(""),[ar,yr]=N.useState("0"),[tr,et]=N.useState(""),[gt,Rt]=N.useState(!1),kt=N.useMemo(()=>de.map(ee=>ee.orderKey),[de]),jt=N.useMemo(()=>Ee?q.filter(ee=>(ee.orderId||ee.id)===Ee):[],[q,Ee]),Zt=N.useMemo(()=>jt.filter(ee=>Number(ee.remainingPackages||0)>0),[jt]),Vt=N.useMemo(()=>nt&&q.find(ee=>ee.id===nt)||null,[q,nt]),ie=N.useMemo(()=>ot?q.filter(ee=>(ee.orderId||ee.id)===ot):[],[q,ot]),ne=N.useMemo(()=>Vt?ie.filter(ee=>ee.productId===Vt.productId):[],[ie,Vt]),ue=async()=>{try{ve(!0);let ee=[];if(o&&e){const Te=Ot(At(je,"inventory_transfers_candies"),$t("fromSellerId","==",e),Dr("createdAt","desc")),Ae=Ot(At(je,"inventory_transfers_candies"),$t("toSellerId","==",e),Dr("createdAt","desc")),[Pe,Ce]=await Promise.all([Ct(Te),Ct(Ae)]),Ze=new Set,Xe=Ye=>{Ye.forEach(ze=>{if(Ze.has(ze.id))return;Ze.add(ze.id);const rt=ze.data();ee.push({id:ze.id,createdAt:rt.createdAt,date:rt.date,createdByEmail:rt.createdByEmail||"",createdByName:rt.createdByName||"",productId:rt.productId||"",productName:rt.productName||"",packagesMoved:Number(rt.packagesMoved||0),providerPrice:Number(rt.providerPrice||0),unitPriceRivas:Number(rt.unitPriceRivas||0),unitPriceIsla:Number(rt.unitPriceIsla||0),toSellerId:rt.toSellerId||"",toSellerName:rt.toSellerName||"",toOrderKey:rt.toOrderKey||"",toOrderLabel:rt.toOrderLabel||"",comment:rt.comment||"",fromSellerId:rt.fromSellerId||"",fromSellerName:rt.fromSellerName||"",fromOrderKey:rt.fromOrderKey||"",fromOrderLabel:rt.fromOrderLabel||"",fromVendorRowId:rt.fromVendorRowId||"",toVendorRowId:rt.toVendorRowId||""})})};Xe(Pe),Xe(Ce),ee.sort((Ye,ze)=>{var Mt,Kt;const rt=((Mt=Ye.createdAt)==null?void 0:Mt.seconds)||0;return(((Kt=ze.createdAt)==null?void 0:Kt.seconds)||0)-rt})}else{const Te=Ot(At(je,"inventory_transfers_candies"),Dr("createdAt","desc"));(await Ct(Te)).forEach(Pe=>{const Ce=Pe.data();ee.push({id:Pe.id,createdAt:Ce.createdAt,date:Ce.date,createdByEmail:Ce.createdByEmail||"",createdByName:Ce.createdByName||"",productId:Ce.productId||"",productName:Ce.productName||"",packagesMoved:Number(Ce.packagesMoved||0),providerPrice:Number(Ce.providerPrice||0),unitPriceRivas:Number(Ce.unitPriceRivas||0),unitPriceIsla:Number(Ce.unitPriceIsla||0),toSellerId:Ce.toSellerId||"",toSellerName:Ce.toSellerName||"",toOrderKey:Ce.toOrderKey||"",toOrderLabel:Ce.toOrderLabel||"",comment:Ce.comment||"",fromSellerId:Ce.fromSellerId||"",fromSellerName:Ce.fromSellerName||"",fromOrderKey:Ce.fromOrderKey||"",fromOrderLabel:Ce.fromOrderLabel||"",fromVendorRowId:Ce.fromVendorRowId||"",toVendorRowId:Ce.toVendorRowId||""})})}Ue(ee)}catch(ee){console.error(ee),_(" Error cargando traslados.")}finally{ve(!1)}},xe=async()=>{Oe(!0),await ue()},Fe=()=>{We(""),Nt(""),wt(""),cr(""),yr("0"),et("")},De=async()=>{if(!a){_("No tienes permiso para hacer traslados.");return}_("");const ee=Number(ar||0);if(!(ee>0)){_("La cantidad de paquetes debe ser mayor a 0.");return}if(!tr.trim()){_("Debes escribir el motivo de la movida.");return}if(!Ee||!nt){_("Selecciona el pedido origen y el producto.");return}if(!ot||!Lt){_("Selecciona el pedido destino y el producto destino.");return}if(nt===Lt){_("Origen y destino no pueden ser el mismo.");return}const Te=b.find(Pe=>Pe.id===nt)||null,Ae=b.find(Pe=>Pe.id===Lt)||null;if(!Te||!Ae){_("No se encontr la fila origen/destino.");return}if(Te.productId!==Ae.productId){_("El producto destino no coincide con el producto origen.");return}if(Number(Te.remainingPackages||0)<ee){_("El origen no tiene suficientes paquetes disponibles.");return}try{Rt(!0),L(!0);const Pe=Tt(je,"inventory_candies_sellers",Te.id),Ce=Tt(je,"inventory_candies_sellers",Ae.id),Ze=Gt.now(),Xe=new Date().toISOString().slice(0,10);await ma(je,async Ye=>{const ze=await Ye.get(Pe),rt=await Ye.get(Ce);if(!ze.exists())throw new Error("Orden origen no existe.");if(!rt.exists())throw new Error("Orden destino no existe.");const dt=ze.data(),Mt=rt.data(),Kt=Number(dt.remainingPackages||0);if(Kt<ee)throw new Error("Origen no tiene suficientes paquetes.");const xr=Number(dt.unitsPerPackage||Mt.unitsPerPackage||0),Hn=xr>0?ee*xr:0;Ye.update(Pe,{remainingPackages:Kt-ee,...xr>0?{remainingUnits:Number(dt.remainingUnits||0)-Hn}:{},updatedAt:Ze}),Ye.update(Ce,{remainingPackages:Number(Mt.remainingPackages||0)+ee,...xr>0?{remainingUnits:Number(Mt.remainingUnits||0)+Hn}:{},updatedAt:Ze});const Tn=Tt(At(je,"inventory_transfers_candies"));Ye.set(Tn,{createdAt:Ze,date:Xe,createdByEmail:(r||"").trim(),createdByName:String(re||"").trim(),productId:String(dt.productId||""),productName:String(dt.productName||""),packagesMoved:ee,providerPrice:Number(dt.providerPrice||0),unitPriceRivas:Number(dt.unitPriceRivas||0),unitPriceIsla:Number(dt.unitPriceIsla||0),fromSellerId:String(dt.sellerId||""),fromSellerName:String(dt.sellerName||""),fromOrderKey:String(dt.orderId||Te.id||""),fromOrderLabel:String(dt.orderId||Te.id||""),toSellerId:String(Mt.sellerId||""),toSellerName:String(Mt.sellerName||""),toOrderKey:String(Mt.orderId||Ae.id||""),toOrderLabel:String(Mt.orderId||Ae.id||""),fromVendorRowId:Te.id,toVendorRowId:Ae.id,comment:tr.trim()})}),k(Ye=>Ye.map(ze=>{if(ze.id===Te.id){const rt=Number(ze.unitsPerPackage||0),dt=rt>0?ee*rt:0;return{...ze,remainingPackages:Number(ze.remainingPackages||0)-ee,remainingUnits:rt>0?Number(ze.remainingUnits||0)-dt:ze.remainingUnits}}if(ze.id===Ae.id){const rt=Number(ze.unitsPerPackage||0),dt=rt>0?ee*rt:0;return{...ze,remainingPackages:Number(ze.remainingPackages||0)+ee,remainingUnits:rt>0?Number(ze.remainingUnits||0)+dt:ze.remainingUnits}}return ze})),await ue(),u(Ye=>{const ze={...Ye},rt=Ee,dt=ot,Mt=Number(ar||0);return rt&&(ze[rt]=ze[rt]||{out:0,in:0},ze[rt].out+=Mt),dt&&(ze[dt]=ze[dt]||{out:0,in:0},ze[dt].in+=Mt),ze}),Fe(),_(" Traslado realizado.")}catch(Pe){console.error(Pe),_((Pe==null?void 0:Pe.message)||" Error realizando el traslado.")}finally{Rt(!1),L(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes de Rutas"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(kc,{onClick:s,loading:P}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 disabled:opacity-30 disabled:bg-gray-300",onClick:xe,type:"button",disabled:!a,children:"Traslados"}),a&&i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{$e(),M(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo pedido a vendedor"]})]})]}),_e&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[gt&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Oe(!1),Fe()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ee,onChange:ee=>{We(ee.target.value),Nt(""),wt(""),cr(""),yr("0")},disabled:!a,children:[i.jsx("option",{value:"",children:"Selecciona"}),kt.map(ee=>{const Te=Be[ee];return i.jsxs("option",{value:ee,children:["Vendedor: ",(Te==null?void 0:Te.sellerName)||"","  Existencias: ","",(Te==null?void 0:Te.totalRemainingPackages)||"0"," Paquetes - Fecha Orden: ",(Te==null?void 0:Te.date)||""]},ee)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:nt,onChange:ee=>{Nt(ee.target.value),wt(""),cr(""),yr("0")},disabled:!a||!Ee,children:[i.jsx("option",{value:"",children:"Selecciona"}),Zt.map(ee=>i.jsxs("option",{value:ee.id,children:["Tipo: ",ee.category," - ",ee.productName,"  Existencias:"," ",Number(ee.remainingPackages||0)," Paquetes - Precio Costo: $",ee.providerPrice]},ee.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ot,onChange:ee=>{wt(ee.target.value),cr("")},disabled:!a||!nt,children:[i.jsx("option",{value:"",children:"Selecciona"}),kt.filter(ee=>ee!==Ee).map(ee=>{const Te=Be[ee];return i.jsxs("option",{value:ee,children:["Vendedor: ",(Te==null?void 0:Te.sellerName)||"","  Existencias: ","",(Te==null?void 0:Te.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Te==null?void 0:Te.date)||""]},ee)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Lt,onChange:ee=>cr(ee.target.value),disabled:!a||!ot||!Vt,children:[i.jsx("option",{value:"",children:"Selecciona"}),ne.map(ee=>i.jsxs("option",{value:ee.id,children:["Tipo: ",ee.category," - ",ee.productName,"  Existencias:"," ",Number(ee.remainingPackages||0)," Paquetes - Precio Costo: $",ee.providerPrice]},ee.id))]}),ot&&Vt&&ne.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. (Debe existir en el pedido destino)"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:ar,onChange:ee=>yr(ee.target.value),disabled:!a||!nt||!Lt})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:tr,onChange:ee=>et(ee.target.value),disabled:!a,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:Fe,disabled:!a||gt,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:De,disabled:!a||gt||!nt||!Lt||Number(ar||0)<=0||!tr.trim(),children:"Hacer traslado"})]})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ue,disabled:Ve,type:"button",children:Ve?"Cargando...":"Recargar"})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Movido a vendedor"}),i.jsx("th",{className:"p-2 border",children:"Movido a orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:Ve?i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Cargando"})}):Qe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Sin traslados"})}):Qe.map(ee=>{var Ce,Ze;const Te=((Ze=(Ce=ee.createdAt)==null?void 0:Ce.toDate)==null?void 0:Ze.call(Ce))||(ee.createdAt?new Date(ee.createdAt.seconds*1e3):null),Ae=Te?`${Te.toISOString().slice(0,10)} ${Te.toISOString().slice(11,19)}`:ee.date||"",Pe=(ee.createdByName||"").trim()||(ee.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Ae}),i.jsx("td",{className:"p-2 border",children:Pe}),i.jsx("td",{className:"p-2 border text-left",children:ee.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(ee.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:ee.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:ee.toOrderLabel||ee.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:ee.comment||""})]},ee.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}),B&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm relative",children:[j&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando pedido..."})}),i.jsx("h3",{className:"text-xl font-bold mb-4",children:F?"Editar pedido de vendedor":"Nuevo pedido para vendedor"}),d.length===0&&i.jsx("p",{className:"text-sm text-red-600 mb-2",children:" No hay vendedores. Primero crea vendedores en la pantalla correspondiente."}),i.jsxs("form",{onSubmit:ut,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:me,onChange:ee=>ae(ee.target.value),disabled:c,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),d.map(ee=>i.jsxs("option",{value:ee.id,children:[ee.name,ee.branchLabel?` - ${ee.branchLabel}`:"",ee.commissionPercent?` (${ee.commissionPercent.toFixed(1)}% comisin)`:""]},ee.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:fe,onChange:ee=>he(ee.target.value),disabled:c})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:te,onChange:ee=>pe(ee.target.value),disabled:c,children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),ye.map(ee=>{const Te=p[ee.id]??0,Ae=[];Ae.push(ee.category?`${ee.category} - ${ee.name}`:ee.name);const Pe=[];ee.unitPriceRivas>0&&Pe.push(`R: ${Wr(ee.unitPriceRivas)}`),ee.unitPriceSanJorge>0&&Pe.push(`SJ: ${Wr(ee.unitPriceSanJorge)}`),ee.unitPriceIsla>0&&Pe.push(`I: ${Wr(ee.unitPriceIsla)}`),Pe.length&&Ae.push(Pe.join(" | ")),Ae.push(`Disp: ${Te} paq`);const Ce=se.has(ee.id);return i.jsx("option",{value:ee.id,disabled:Ce,children:Ce?` (Agregado) ${Ae.join("  ")}`:Ae.join("  ")},ee.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes / bolsas"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:Ie,onChange:ee=>S(ee.target.value),disabled:c})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:at,className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",disabled:c||!te||se.has(te),title:se.has(te)?"Ese producto ya est en el pedido":"",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Paq x Und (ref)"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),i.jsx("th",{className:"p-2 border",children:"P. paquete vendedor"}),i.jsx("th",{className:"p-2 border",children:"Total vendedor"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:I.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center text-gray-500",children:"No hay productos en este pedido. Agrega al menos uno."})}):I.map(ee=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:ee.productName}),i.jsx("td",{className:"p-2 border",children:ee.category}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",min:0,className:"border p-1 rounded text-right text-xs w-20",value:ee.packages,onChange:Te=>st(ee.id,Te.target.value),disabled:c})}),i.jsx("td",{className:"p-2 border",children:ee.remainingPackages??ee.packages}),i.jsx("td",{className:"p-2 border",children:ee.unitsPerPackage||""}),i.jsx("td",{className:"p-2 border",children:Wr(ee.providerPrice)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.subtotal)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.totalRivas)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.totalSanJorge)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.totalIsla)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.unitPriceRivas)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.unitPriceSanJorge)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.unitPriceIsla)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.pricePerPackage)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.totalVendor)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs disabled:opacity-50",onClick:()=>mt(ee.id),disabled:c,children:"Quitar"})})]},ee.id))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales del pedido"}),i.jsx("div",{className:"text-lg font-semibold",children:He.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),i.jsx("div",{className:"text-lg font-semibold",children:Wr(He.subtotal)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total vendedor (precio venta)"}),i.jsx("div",{className:"text-lg font-semibold text-green-600",children:Wr(He.totalVendor)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin posible vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:Wr(He.commissionAmount)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a&&i.jsx("button",{type:"button",onClick:$e,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:j,children:"Limpiar pedido"}),i.jsx("button",{type:"button",onClick:()=>{$e(),M(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:j,children:"Cerrar"}),i.jsx("button",{type:"button",onClick:be,className:"px-3 py-1 rounded bg-purple-600 text-white hover:bg-purple-700",disabled:!G||I.length===0,children:"Imprimir pedido"}),a&&i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",disabled:j||!G||I.length===0,children:j?"Guardando...":"Guardar pedido"})]})]})]})}),i.jsx("div",{className:"block md:hidden space-y-3 mt-4",children:de.map(ee=>{var Xe,Ye;const Te=z[ee.sellerId],Ae=Number((Te==null?void 0:Te.commissionPercent)||0),Pe=ee.totalVendor*Ae/100,Ce=g===ee.orderKey,Ze=Ce?oe(ee.orderKey):[];return i.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-sm",children:ee.sellerName}),i.jsx("div",{className:"text-xs text-gray-500",children:(Te==null?void 0:Te.branchLabel)||""})]}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[i.jsx("div",{children:ee.date||""}),i.jsx("div",{className:"truncate max-w-[140px]",children:ee.orderKey})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Paquetes:"})," ",i.jsx("b",{children:ee.totalPackages})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Restantes:"})," ",i.jsx("b",{children:ee.totalRemainingPackages})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Trasl. OUT:"})," ",i.jsx("b",{children:((Xe=A[ee.orderKey])==null?void 0:Xe.out)||0})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Trasl. IN:"})," ",i.jsx("b",{children:((Ye=A[ee.orderKey])==null?void 0:Ye.in)||0})]})]}),i.jsxs("div",{className:"text-sm border-t pt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),i.jsx("span",{children:Wr(ee.subtotal)})]}),i.jsxs("div",{className:"flex justify-between font-semibold",children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:Wr(ee.totalVendor)})]}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[i.jsx("span",{children:"Comisin:"}),i.jsx("span",{children:Wr(Pe)})]})]}),i.jsxs("div",{className:"flex gap-2 mt-3",children:[i.jsx("button",{className:"flex-1 bg-blue-600 text-white py-2 rounded text-xs",onClick:()=>ge(ee.orderKey),children:"Ver / Editar"}),a&&i.jsx("button",{className:"flex-1 bg-red-600 text-white py-2 rounded text-xs",onClick:()=>K(ee.orderKey),children:"Borrar"})]}),i.jsx("button",{type:"button",className:"w-full mt-2 border rounded py-2 text-xs bg-gray-50 hover:bg-gray-100",onClick:()=>{w(ze=>ze===ee.orderKey?null:ee.orderKey)},children:Ce?"Ocultar detalle":"Ver detalle del pedido"}),Ce&&i.jsxs("div",{className:"mt-2 border rounded bg-white overflow-hidden",children:[i.jsx("div",{className:"px-3 py-2 text-xs font-semibold bg-gray-100",children:"Detalle del pedido"}),Ze.length===0?i.jsx("div",{className:"p-3 text-xs text-gray-500",children:"Sin detalle"}):i.jsx("div",{className:"divide-y",children:Ze.map(ze=>i.jsxs("div",{className:"p-3 text-xs",children:[i.jsxs("div",{className:"flex justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ze.productName}),i.jsx("div",{className:"text-gray-500 truncate",children:ze.category||""})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Paq:"})," ",i.jsx("b",{children:Number(ze.packages||0)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Rem:"})," ",i.jsx("b",{children:Number(ze.remainingPackages||0)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"Costo:"}),i.jsx("span",{children:Wr(Number(ze.providerPrice||0))})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-500",children:"Total:"}),i.jsx("span",{className:"font-semibold",children:Wr(Number(ze.totalVendor||0))})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 text-[11px] text-gray-600",children:[i.jsxs("div",{className:"text-center border rounded py-1",children:["R ",Wr(Number(ze.unitPriceRivas||0))]}),i.jsxs("div",{className:"text-center border rounded py-1",children:["SJ ",Wr(Number(ze.unitPriceSanJorge||0))]}),i.jsxs("div",{className:"text-center border rounded py-1",children:["I ",Wr(Number(ze.unitPriceIsla||0))]})]})]},ze.id))})]})]},ee.orderKey)})}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto mt-4",children:[i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Listado de pedidos"}),i.jsxs("table",{className:"min-w-[1000px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes Trasladados"}),i.jsx("th",{className:"p-2 border",children:"Paquetes Adicionales"}),i.jsx("th",{className:"p-2 border",children:"Subtotal costo"}),i.jsx("th",{className:"p-2 border",children:"Total vendedor"}),i.jsx("th",{className:"p-2 border",children:"Comisin posible"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Cargando"})}):de.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Sin pedidos asignados a vendedores."})}):de.map(ee=>{var Ce,Ze;const Te=z[ee.sellerId],Ae=Number((Te==null?void 0:Te.commissionPercent)||0),Pe=ee.totalVendor*Ae/100;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:ee.date||""}),i.jsxs("td",{className:"p-2 border",children:[ee.sellerName,Te!=null&&Te.branchLabel?` - ${Te.branchLabel}`:""]}),i.jsx("td",{className:"p-2 border",children:ee.totalPackages}),i.jsx("td",{className:"p-2 border",children:ee.totalRemainingPackages}),i.jsx("td",{className:"p-2 border",children:((Ce=A[ee.orderKey])==null?void 0:Ce.out)||0}),i.jsx("td",{className:"p-2 border",children:((Ze=A[ee.orderKey])==null?void 0:Ze.in)||0}),i.jsx("td",{className:"p-2 border",children:Wr(ee.subtotal)}),i.jsx("td",{className:"p-2 border",children:Wr(ee.totalVendor)}),i.jsx("td",{className:"p-2 border",children:Wr(Pe)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>ge(ee.orderKey),children:"Ver / Editar"}),a&&i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>K(ee.orderKey),children:"Borrar"})]})})]},ee.orderKey)})})]})]}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E})]})}function pC(t){return isFinite(t)?Math.round(t):0}function Qn(t){const e=Number(t);return Number.isFinite(e)?Math.floor(e):0}function h7(t){const e=Math.max(1,Qn(t.unitsPerPackage||1)),r=Qn(t.totalUnits||0),n=Qn(t.quantity||0),s=Qn(t.packages||0);return r>0?r:n>0?n:s>0?s*e:0}function b1e(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):h7(t)}function _3(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,Qn(t.unitsPerPackage||1)),n=b1e(t);return Math.max(0,Math.floor(n/r))}function N1e(t){const e=Math.max(1,Qn(t.unitsPerPackage||1)),r=h7(t);return Math.max(0,Math.floor(r/e))}function C1e(){const{refreshKey:t,refresh:e}=Xl(),[r,n]=N.useState(""),[s,a]=N.useState(!0),[o,l]=N.useState([]),[c,A]=N.useState(!1),[u,d]=N.useState([]),[f,h]=N.useState({}),[m,p]=N.useState(!1),[x,g]=N.useState(null),[w,b]=N.useState(""),[k,P]=N.useState(""),[L,E]=N.useState("20"),[_,B]=N.useState("15"),[M,F]=N.useState("30"),[T,O]=N.useState([]),[Y,me]=N.useState(""),[ae,fe]=N.useState(""),[he,te]=N.useState(""),[pe,Ie]=N.useState("1"),[S,I]=N.useState("0"),V=N.useMemo(()=>{const q=new Set;for(const oe of o){const de=String(oe.category||"").trim();de&&q.add(de)}return Array.from(q).sort((oe,de)=>oe.localeCompare(de,"es"))},[o]);N.useEffect(()=>{!Y&&V.length>0&&me(V[0])},[V]);const j=(q,oe,de)=>{const Be=q*oe,He=Math.min(Math.max(de.marginR,0),99.9)/100,$e=Math.min(Math.max(de.marginSJ,0),99.9)/100,Je=Math.min(Math.max(de.marginIsla,0),99.9)/100,ct=oe>0&&He<1?Be/(1-He):Be,at=oe>0&&$e<1?Be/(1-$e):Be,mt=oe>0&&Je<1?Be/(1-Je):Be,st=ct-Be,Le=at-Be,ut=mt-Be,be=oe>0?pC(ct/oe):0,ge=oe>0?pC(at/oe):0,K=oe>0?pC(mt/oe):0;return{subtotal:Be,totalRivas:ct,totalSanJorge:at,totalIsla:mt,gainRivas:st,gainSanJorge:Le,gainIsla:ut,unitPriceRivas:be,unitPriceSanJorge:ge,unitPriceIsla:K}},U=()=>{g(null),b(""),P(""),O([]),me(V[0]||""),fe(""),te(""),I("0"),Ie("1"),E("20"),B("15"),F("30")},G=async()=>{A(!0);try{const q=await Ct(Ot(At(je,"products_candies"),Dr("createdAt","desc"))),oe=[];q.forEach(de=>{const Be=de.data();oe.push({id:de.id,name:String(Be.name??"").trim(),category:String(Be.category??"").trim()||"Caramelo",providerPrice:Number(Be.providerPrice??0),unitsPerPackage:Number(Be.unitsPerPackage??1)})}),l(oe)}catch(q){console.error(q),n(" Error cargando catlogo de dulces.")}finally{A(!1)}};N.useEffect(()=>{G()},[t]);const R=N.useMemo(()=>(Y.trim().length>0?o.filter(oe=>oe.category===Y):o).sort((oe,de)=>oe.name.localeCompare(de.name,"es")),[o,Y]);N.useEffect(()=>{if(!ae){te(""),Ie("1");return}const q=o.find(oe=>oe.id===ae);q&&(te(String(q.providerPrice??0)),Ie(String(q.unitsPerPackage??1)))},[ae,o]);const X=()=>{if(n(""),!ae){n("Selecciona un producto del catlogo.");return}const q=o.find(at=>at.id===ae);if(!q){n("Producto de catlogo no encontrado (refresca).");return}const oe=Number(q.providerPrice||0),de=Qn(S||0),Be=Qn(q.unitsPerPackage||0);if(oe<0){n("El precio proveedor no puede ser negativo.");return}if(de<=0){n("Los paquetes del pedido general deben ser mayor que 0.");return}if(Be<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const He=Number(L||0),$e=Number(_||0),Je=Number(M||0);if(T.find(at=>at.id===q.id))O(at=>at.map(mt=>{if(mt.id!==q.id)return mt;const st=Qn(mt.packages||0)+de,Le=j(oe,st,{marginR:Number(mt.marginRivas||He),marginSJ:Number(mt.marginSanJorge||$e),marginIsla:Number(mt.marginIsla||Je)});return{...mt,providerPrice:oe,unitsPerPackage:Be,packages:st,remainingPackages:Qn(mt.remainingPackages??mt.packages)+de,...Le}}));else{const at=j(oe,de,{marginR:He,marginSJ:$e,marginIsla:Je}),mt={id:q.id,name:q.name,category:q.category,providerPrice:oe,packages:de,unitsPerPackage:Be,marginRivas:He,marginSanJorge:$e,marginIsla:Je,subtotal:at.subtotal,totalRivas:at.totalRivas,totalSanJorge:at.totalSanJorge,totalIsla:at.totalIsla,gainRivas:at.gainRivas,gainSanJorge:at.gainSanJorge,gainIsla:at.gainIsla,unitPriceRivas:at.unitPriceRivas,unitPriceSanJorge:at.unitPriceSanJorge,unitPriceIsla:at.unitPriceIsla,remainingPackages:de};O(st=>[...st,mt])}fe(""),I("0")},se=q=>{O(oe=>oe.filter(de=>de.id!==q))},ye=N.useMemo(()=>{const q=T.reduce(($e,Je)=>$e+Qn(Je.packages),0),oe=T.reduce(($e,Je)=>$e+Number(Je.subtotal||0),0),de=T.reduce(($e,Je)=>$e+Number(Je.totalRivas||0),0),Be=T.reduce(($e,Je)=>$e+Number(Je.totalSanJorge||0),0),He=T.reduce(($e,Je)=>$e+Number(Je.totalIsla||0),0);return{totalPackages:q,subtotal:oe,totalRivas:de,totalSanJorge:Be,totalIsla:He}},[T]),z=(q,oe,de)=>{O(Be=>Be.map(He=>{if(He.id!==q)return He;let $e={...He};if(oe==="packages"&&($e.packages=Qn(de||0)),oe==="unitsPerPackage"&&($e.unitsPerPackage=Qn(de||0)),oe==="marginRivas"&&($e.marginRivas=Number(de||0)),oe==="marginSanJorge"&&($e.marginSanJorge=Number(de||0)),oe==="marginIsla"&&($e.marginIsla=Number(de||0)),oe==="packages"||oe==="marginRivas"||oe==="marginSanJorge"||oe==="marginIsla"){const Je=j($e.providerPrice,$e.packages,{marginR:Number($e.marginRivas||0),marginSJ:Number($e.marginSanJorge||0),marginIsla:Number($e.marginIsla||0)});$e={...$e,...Je}}return $e}))};N.useEffect(()=>{(async()=>{a(!0);try{const q=Ot(At(je,"candy_main_orders"),Dr("createdAt","desc")),oe=await Ct(q),de=[];oe.forEach($e=>{const Je=$e.data();de.push({id:$e.id,name:Je.name??"",date:Je.date??"",totalPackages:Number(Je.totalPackages??0),subtotal:Number(Je.subtotal??0),totalRivas:Number(Je.totalRivas??0),totalSanJorge:Number(Je.totalSanJorge??0),totalIsla:Number(Je.totalIsla??0),marginRivas:Number(Je.marginRivas??20),marginSanJorge:Number(Je.marginSanJorge??15),marginIsla:Number(Je.marginIsla??30),createdAt:Je.createdAt??Gt.now()})}),d(de);const Be=await Ct(At(je,"inventory_candies")),He={};Be.forEach($e=>{const Je=$e.data(),ct=Je.orderId;if(!ct)return;const at=N1e(Je),mt=_3(Je);He[ct]||(He[ct]={orderId:ct,totalPackages:0,remainingPackages:0}),He[ct].totalPackages+=at,He[ct].remainingPackages+=mt}),h(He)}catch(q){console.error(q),n(" Error cargando pedidos generales.")}finally{a(!1)}})()},[t]);const Me=async q=>{if(q.preventDefault(),n(""),!T.length){n("Agrega al menos un producto al pedido general.");return}try{const oe=new Date().toISOString().slice(0,10),de=k||oe,Be=ye,He=Number(L||0),$e=Number(_||0),Je=Number(M||0);for(const at of T){if(!at.name.trim()){n("Hay un producto sin nombre en el pedido.");return}if(at.providerPrice<0){n(`El precio proveedor no puede ser negativo (producto: ${at.name}).`);return}if(at.packages<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${at.name}).`);return}if(at.unitsPerPackage<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${at.name}).`);return}}const ct={name:w||`Pedido ${de}`,date:de,totalPackages:Be.totalPackages,subtotal:Be.subtotal,totalRivas:Be.totalRivas,totalSanJorge:Be.totalSanJorge,totalIsla:Be.totalIsla,marginRivas:He,marginSanJorge:$e,marginIsla:Je,items:T};if(x){await Tr(Tt(je,"candy_main_orders",x),{...ct});for(const st of T){const Le=await Ct(Ot(At(je,"inventory_candies"),$t("orderId","==",x),$t("productId","==",st.id))),ut=Qn(st.packages)*Qn(st.unitsPerPackage),be=Math.max(1,Qn(st.unitsPerPackage||1));if(Le.empty)await Jr(At(je,"inventory_candies"),{productId:st.id,productName:st.name,category:st.category,measurement:"unidad",quantity:ut,remaining:ut,packages:Qn(st.packages),remainingPackages:Qn(st.packages),unitsPerPackage:be,totalUnits:ut,providerPrice:st.providerPrice,subtotal:st.subtotal,totalRivas:st.totalRivas,totalSanJorge:st.totalSanJorge,totalIsla:st.totalIsla,gainRivas:st.gainRivas,gainSanJorge:st.gainSanJorge,gainIsla:st.gainIsla,unitPriceRivas:st.unitPriceRivas,unitPriceSanJorge:st.unitPriceSanJorge,unitPriceIsla:st.unitPriceIsla,date:de,createdAt:Gt.now(),status:"PENDIENTE",orderId:x});else for(const ge of Le.docs){const K=ge.data(),_e=Qn(K.totalUnits??0),Oe=Qn(K.remaining??_e),Ve=ut-_e,ve=Math.max(0,Oe+Ve),Qe=Math.max(0,Math.floor(ve/be));await Tr(Tt(je,"inventory_candies",ge.id),{productName:st.name,category:st.category,unitsPerPackage:be,totalUnits:ut,quantity:ut,remaining:ve,packages:Qn(st.packages),remainingPackages:Qe,providerPrice:st.providerPrice,subtotal:st.subtotal,totalRivas:st.totalRivas,totalSanJorge:st.totalSanJorge,totalIsla:st.totalIsla,gainRivas:st.gainRivas,gainSanJorge:st.gainSanJorge,gainIsla:st.gainIsla,unitPriceRivas:st.unitPriceRivas,unitPriceSanJorge:st.unitPriceSanJorge,unitPriceIsla:st.unitPriceIsla,date:de})}}const at=await Ct(Ot(At(je,"inventory_candies"),$t("orderId","==",x))),mt=new Set(T.map(st=>st.id));for(const st of at.docs){const Le=st.data(),ut=String(Le.productId||"");ut&&!mt.has(ut)&&await dn(Tt(je,"inventory_candies",st.id))}d(st=>st.map(Le=>Le.id===x?{...Le,name:ct.name,date:ct.date,totalPackages:ct.totalPackages,subtotal:ct.subtotal,totalRivas:ct.totalRivas,totalSanJorge:ct.totalSanJorge,totalIsla:ct.totalIsla,marginRivas:ct.marginRivas,marginSanJorge:ct.marginSanJorge,marginIsla:ct.marginIsla}:Le)),n(" Orden maestra actualizada (pedido + inventario).")}else{const mt=(await Jr(At(je,"candy_main_orders"),{...ct,createdAt:Gt.now()})).id,st=Wh(je);for(const Le of T){const ut=Math.max(1,Qn(Le.unitsPerPackage||1)),be=Qn(Le.packages)*ut,ge=Tt(At(je,"inventory_candies"));st.set(ge,{productId:Le.id,productName:Le.name,category:Le.category,measurement:"unidad",quantity:be,remaining:be,packages:Qn(Le.packages),remainingPackages:Qn(Le.packages),unitsPerPackage:ut,totalUnits:be,providerPrice:Le.providerPrice,subtotal:Le.subtotal,totalRivas:Le.totalRivas,totalSanJorge:Le.totalSanJorge,totalIsla:Le.totalIsla,gainRivas:Le.gainRivas,gainSanJorge:Le.gainSanJorge,gainIsla:Le.gainIsla,unitPriceRivas:Le.unitPriceRivas,unitPriceSanJorge:Le.unitPriceSanJorge,unitPriceIsla:Le.unitPriceIsla,date:de,createdAt:Gt.now(),status:"PENDIENTE",orderId:mt})}await st.commit(),n(" Orden maestra creada y registrada en inventario.")}U(),p(!1),e()}catch(oe){console.error(oe),n(" Error al guardar orden maestra.")}},re=async q=>{try{a(!0),n(""),g(q.id),b(q.name),P(q.date),E(String(q.marginRivas??20)),B(String(q.marginSanJorge??15)),F(String(q.marginIsla??30));const oe=Tt(je,"candy_main_orders",q.id),de=await Xa(oe);if(!de.exists()){n(" No se encontr la orden.");return}const Be=de.data(),He=Array.isArray(Be.items)?Be.items:[],$e=await Ct(Ot(At(je,"inventory_candies"),$t("orderId","==",q.id))),Je={};$e.forEach(at=>{const mt=at.data(),st=String(mt.productId||"");if(!st)return;const Le=_3(mt);Je[st]=(Je[st]||0)+Le});const ct=He.map(at=>{const mt=o.find(be=>be.id===at.id),st=Number((mt==null?void 0:mt.providerPrice)??at.providerPrice??0),Le=Math.max(1,Qn((mt==null?void 0:mt.unitsPerPackage)??at.unitsPerPackage??1)),ut=j(st,Qn(at.packages||0),{marginR:Number(at.marginRivas||0),marginSJ:Number(at.marginSanJorge||0),marginIsla:Number(at.marginIsla||0)});return{...at,name:String((mt==null?void 0:mt.name)??at.name??""),category:String((mt==null?void 0:mt.category)??at.category??"Caramelo"),providerPrice:st,unitsPerPackage:Le,remainingPackages:Je[at.id]??at.remainingPackages??at.packages??0,...ut}});O(ct),p(!0)}catch(oe){console.error(oe),n(" Error al abrir orden maestra.")}finally{a(!1)}},W=async q=>{if(confirm(`Eliminar la orden "${q.name}" y todo su inventario asociado?`)){n("");try{const de=await Ct(Ot(At(je,"inventory_candies"),$t("orderId","==",q.id)));for(const Be of de.docs)await dn(Tt(je,"inventory_candies",Be.id));await dn(Tt(je,"candy_main_orders",q.id)),d(Be=>Be.filter(He=>He.id!==q.id)),n(" Orden maestra eliminada."),e()}catch(de){console.error(de),n(" Error al eliminar orden maestra.")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(kc,{onClick:e,loading:s||c}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700",onClick:()=>{U(),p(!0)},children:[i.jsx("span",{className:"inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nueva Orden"]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:x?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("form",{onSubmit:Me,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:w,onChange:q=>b(q.target.value),placeholder:"Ej: Pedido diciembre 01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:k,onChange:q=>P(q.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:L,onChange:q=>E(q.target.value),disabled:!!x})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia San Jorge"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:_,onChange:q=>B(q.target.value),disabled:!!x})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:M,onChange:q=>F(q.target.value),disabled:!!x})]})]}),!x&&i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:Y,onChange:q=>{me(q.target.value),fe("")},disabled:c,children:V.length===0?i.jsx("option",{value:"",children:c?"Cargando...":"No hay categoras en catlogo"}):V.map(q=>i.jsx("option",{value:q,children:q},q))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:q=>fe(q.target.value),children:[i.jsx("option",{value:"",children:c?"Cargando catlogo...":"Selecciona producto"}),R.map(q=>i.jsx("option",{value:q.id,children:q.name},q.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:he,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:S,onChange:q=>I(q.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:pe,readOnly:!0})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:X,className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),!x&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:x?16:17,className:"p-4 text-center text-gray-500",children:"No hay productos en esta orden."})}):T.map(q=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:q.name}),i.jsx("td",{className:"p-2 border",children:q.category}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-24 border p-1 rounded text-right",value:q.packages,onChange:oe=>z(q.id,"packages",oe.target.value)})}),i.jsx("td",{className:"p-2 border",children:q.remainingPackages??q.packages}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.unitsPerPackage,onChange:oe=>z(q.id,"unitsPerPackage",oe.target.value)})}),i.jsx("td",{className:"p-2 border",children:Number(q.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.marginRivas??0,onChange:oe=>z(q.id,"marginRivas",oe.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.marginSanJorge??0,onChange:oe=>z(q.id,"marginSanJorge",oe.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:q.marginIsla??0,onChange:oe=>z(q.id,"marginIsla",oe.target.value)})}),i.jsx("td",{className:"p-2 border",children:Number(q.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(q.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(q.totalSanJorge||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(q.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:q.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:q.unitPriceIsla}),!x&&i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>se(q.id),children:"Quitar"})})]},q.id))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales de la orden"}),i.jsx("div",{className:"text-lg font-semibold",children:ye.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),i.jsx("div",{className:"text-lg font-semibold",children:ye.subtotal.toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Rivas (orden)"}),i.jsx("div",{className:"text-lg font-semibold",children:ye.totalRivas.toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total San Jorge / Isla"}),i.jsxs("div",{className:"text-sm font-semibold",children:["SJ: ",ye.totalSanJorge.toFixed(2),i.jsx("br",{}),"Isla: ",ye.totalIsla.toFixed(2)]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",onClick:U,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{U(),p(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",disabled:T.length===0,children:"Guardar orden"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-4",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):u.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin ordenes maestras."})}):u.map(q=>{var de;q.totalPackages>0&&Math.round(q.totalRivas/q.totalPackages),q.totalPackages>0&&Math.round(q.totalSanJorge/q.totalPackages),q.totalPackages>0&&Math.round(q.totalIsla/q.totalPackages);const oe=f[q.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:q.date||((de=q.createdAt)!=null&&de.toDate?q.createdAt.toDate().toISOString().slice(0,10):"")}),i.jsx("td",{className:"p-2 border",children:q.name}),i.jsx("td",{className:"p-2 border",children:q.totalPackages}),i.jsx("td",{className:"p-2 border",children:oe?oe.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:(q.subtotal/q.totalPackages).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:q.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>re(q),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>W(q),children:"Borrar"})]})})]},q.id)})})]})}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]})}const Au=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function gC(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),s=r*e,a=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),A=s*(1+o/100),u=s*(1+l/100),d=s*(1+c/100),f=A-s,h=u-s,m=d-s,p=A/a,x=u/a,g=d/a;return{...t,subtotal:Number(s.toFixed(2)),totalRivas:Number(A.toFixed(2)),totalSanJorge:Number(u.toFixed(2)),totalIsla:Number(d.toFixed(2)),gainRivas:Number(f.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(g.toFixed(2))}}function E3(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function Ki(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function xC(t){const{margin:e,gain:r,subtotal:n,orderMargin:s}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const a=Number(n||0),o=Number(r);return Number.isFinite(o)&&a>0?o/a*100:Number(s||0)}function _1e(){var j,U,G;const[t,e]=N.useState([]),[r,n]=N.useState({}),[s,a]=N.useState(!0),[o,l]=N.useState(""),[c,A]=N.useState(sr(Bc(new Date),"yyyy-MM-dd")),[u,d]=N.useState(sr(Ec(new Date),"yyyy-MM-dd")),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[x,g]=N.useState(null),[w,b]=N.useState([]),[k,P]=N.useState(0),[L,E]=N.useState(0),[_,B]=N.useState(0),[M,F]=N.useState(""),[T,O]=N.useState(""),[Y,me]=N.useState(0),[ae,fe]=N.useState(0),[he,te]=N.useState(1);N.useEffect(()=>{(async()=>{try{a(!0),l("");const R=Ot(At(je,"candy_main_orders"),Dr("createdAt","desc")),X=await Ct(R),se=[];X.forEach(Me=>{const re=Me.data();se.push({id:Me.id,name:re.name??"",date:re.date??"",totalPackages:Number(re.totalPackages??0),subtotal:Number(re.subtotal??0),totalRivas:Number(re.totalRivas??0),totalSanJorge:Number(re.totalSanJorge??0),totalIsla:Number(re.totalIsla??0),marginRivas:Number(re.marginRivas??0),marginSanJorge:Number(re.marginSanJorge??0),marginIsla:Number(re.marginIsla??0),createdAt:re.createdAt??Gt.now()})}),e(se);const ye=await Ct(Ot(At(je,"inventory_candies"))),z={};ye.forEach(Me=>{const re=Me.data(),W=re.orderId;if(!W)return;const q=Number(re.unitsPerPackage||1)||1,oe=Number(re.totalUnits??(re.packages||0)*q),de=Math.round(oe/q),Be=Number(re.remaining??re.totalUnits??oe),He=Number(re.remainingPackages??NaN),$e=Number.isFinite(He)?Math.round(He):Math.round(Be/q);z[W]||(z[W]={orderId:W,totalPackages:0,remainingPackages:0}),z[W].totalPackages+=de,z[W].remainingPackages+=$e}),n(z)}catch(R){console.error(R),l(" Error cargando inventario de pedidos.")}finally{a(!1)}})()},[]);const pe=N.useMemo(()=>t.filter(R=>{var se;const X=R.date||((se=R.createdAt)!=null&&se.toDate?R.createdAt.toDate().toISOString().slice(0,10):"");return!(!X||c&&X<c||u&&X>u)}),[t,c,u]),Ie=N.useMemo(()=>{let R=0,X=0,se=0,ye=0,z=0,Me=0;for(const re of pe){R+=re.totalPackages,X+=re.subtotal,se+=re.totalRivas,ye+=re.totalSanJorge,z+=re.totalIsla;const W=r[re.id];W&&(Me+=W.remainingPackages)}return{totalPaquetes:R,totalSubtotal:X,totalRivas:se,totalSJ:ye,totalIsla:z,totalPaquetesRestantes:Me,totalPedidos:pe.length}},[pe,r]),S=async(R,X,se)=>{if(!x)return;const ye=Number(se||0),z=w.map(W=>W.id!==R?W:gC({...W,[X]:ye}));b(z);const Me=z.find(W=>W.id===R);if(!Me)return;const re=E3(z);try{await Tr(Tt(je,"products_candies",R),{marginRivas:Me.marginRivas,marginSanJorge:Me.marginSanJorge,marginIsla:Me.marginIsla,subtotal:Me.subtotal,totalRivas:Me.totalRivas,totalSanJorge:Me.totalSanJorge,totalIsla:Me.totalIsla,unitPriceRivas:Me.unitPriceRivas,unitPriceSanJorge:Me.unitPriceSanJorge,unitPriceIsla:Me.unitPriceIsla,gainRivas:Me.gainRivas,gainSanJorge:Me.gainSanJorge,gainIsla:Me.gainIsla}),await Tr(Tt(je,"candy_main_orders",x.id),{totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),g(W=>W&&{...W,totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(W){console.error(W),l(" Error actualizando mrgenes del producto.")}},I=async()=>{if(x)try{l("");const R=Number.isFinite(k)&&k!==0?k:x.marginRivas||0,X=Number.isFinite(L)&&L!==0?L:x.marginSanJorge||0,se=Number.isFinite(_)&&_!==0?_:x.marginIsla||0,ye=gC({id:"tmp",name:M.trim(),category:T.trim(),providerPrice:Number(Y||0),packages:Number(ae||0),unitsPerPackage:Number(he||1),marginRivas:Number(R||0),marginSanJorge:Number(X||0),marginIsla:Number(se||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ae||0)}),z=await Jr(At(je,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:ye.name,category:ye.category,providerPrice:ye.providerPrice,packages:ye.packages,unitsPerPackage:ye.unitsPerPackage,marginRivas:ye.marginRivas,marginSanJorge:ye.marginSanJorge,marginIsla:ye.marginIsla,gainRivas:ye.gainRivas,gainSanJorge:ye.gainSanJorge,gainIsla:ye.gainIsla,subtotal:ye.subtotal,totalRivas:ye.totalRivas,totalSanJorge:ye.totalSanJorge,totalIsla:ye.totalIsla,unitPriceRivas:ye.unitPriceRivas,unitPriceSanJorge:ye.unitPriceSanJorge,unitPriceIsla:ye.unitPriceIsla,createdAt:Gt.now()}),re=[{...ye,id:z.id},...w];b(re);const W=E3(re);await Tr(Tt(je,"candy_main_orders",x.id),{totalPackages:W.totalPackages,subtotal:Number(W.subtotal.toFixed(2)),totalRivas:Number(W.totalRivas.toFixed(2)),totalSanJorge:Number(W.totalSanJorge.toFixed(2)),totalIsla:Number(W.totalIsla.toFixed(2))}),g(q=>q&&{...q,totalPackages:W.totalPackages,subtotal:Number(W.subtotal.toFixed(2)),totalRivas:Number(W.totalRivas.toFixed(2)),totalSanJorge:Number(W.totalSanJorge.toFixed(2)),totalIsla:Number(W.totalIsla.toFixed(2))}),P(0),E(0),B(0),F(""),O(""),me(0),fe(0),te(1),l(" Producto agregado con mrgenes por sucursal.")}catch(R){console.error(R),l(" Error agregando producto al pedido.")}},V=async R=>{try{g(R),b([]),h(!0),p(!0),l("");const X=await Ct(Ot(At(je,"inventory_candies"),$t("orderId","==",R.id))),se={};X.forEach(Me=>{const re=Me.data(),W=re.productId;if(!W)return;const q=Number(re.unitsPerPackage||1)||1,oe=Number(re.remaining??re.totalUnits??0),de=Number(re.remainingPackages??NaN),Be=Number.isFinite(de)?Math.round(de):Math.round(oe/q);se[W]=(se[W]||0)+Be});const ye=await Ct(Ot(At(je,"products_candies"),$t("orderId","==",R.id))),z=[];ye.forEach(Me=>{const re=Me.data(),W=Ki(re.providerPrice,0),q=Ki(re.packages,0),oe=re.subtotal??W*q,de=xC({margin:re.marginRivas,gain:re.gainRivas,subtotal:oe,orderMargin:R.marginRivas||0}),Be=xC({margin:re.marginSanJorge,gain:re.gainSanJorge,subtotal:oe,orderMargin:R.marginSanJorge||0}),He=xC({margin:re.marginIsla,gain:re.gainIsla,subtotal:oe,orderMargin:R.marginIsla||0}),$e=gC({id:Me.id,name:re.name??"",category:re.category??"",providerPrice:W,packages:q,unitsPerPackage:Ki(re.unitsPerPackage,1),marginRivas:Number(de||0),marginSanJorge:Number(Be||0),marginIsla:Number(He||0),subtotal:Ki(re.subtotal,0),totalRivas:Ki(re.totalRivas,0),totalSanJorge:Ki(re.totalSanJorge,0),totalIsla:Ki(re.totalIsla,0),gainRivas:Ki(re.gainRivas,0),gainSanJorge:Ki(re.gainSanJorge,0),gainIsla:Ki(re.gainIsla,0),unitPriceRivas:Ki(re.unitPriceRivas,0),unitPriceSanJorge:Ki(re.unitPriceSanJorge,0),unitPriceIsla:Ki(re.unitPriceIsla,0),remainingPackages:se[Me.id]??Ki(re.packages,0)});z.push($e)}),b(z)}catch(X){console.error(X),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:R=>A(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:R=>d(R.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),d("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:Ie.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Ie.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Ie.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",Au(Ie.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",Au(Ie.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",Au(Ie.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",Au(Ie.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):pe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):pe.map(R=>{var re;const X=R.totalPackages>0?Math.round(R.totalRivas/R.totalPackages):0,se=R.totalPackages>0?Math.round(R.totalSanJorge/R.totalPackages):0,ye=R.totalPackages>0?Math.round(R.totalIsla/R.totalPackages):0,z=R.date||((re=R.createdAt)!=null&&re.toDate?R.createdAt.toDate().toISOString().slice(0,10):""),Me=r[R.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:z}),i.jsx("td",{className:"p-2 border",children:R.name}),i.jsx("td",{className:"p-2 border",children:R.totalPackages}),i.jsx("td",{className:"p-2 border",children:Me?Me.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:R.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:X}),i.jsx("td",{className:"p-2 border",children:se}),i.jsx("td",{className:"p-2 border",children:ye}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>V(R),children:"Ver pedido"})})]},R.id)})})]})}),f&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),g(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((j=x.createdAt)!=null&&j.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((U=r[x.id])==null?void 0:U.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((G=r[x.id])==null?void 0:G.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:Au(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:Au(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:Au(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:Au(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:k,onChange:R=>P(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:L,onChange:R=>E(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:_,onChange:R=>B(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:M,onChange:R=>F(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:T,onChange:R=>O(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:Y,onChange:R=>me(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ae,onChange:R=>fe(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:he,onChange:R=>te(Number(R.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:I,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):w.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):w.map(R=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:R.name}),i.jsx("td",{className:"p-2 border",children:R.category}),i.jsx("td",{className:"p-2 border",children:R.packages}),i.jsx("td",{className:"p-2 border",children:R.remainingPackages??R.packages}),i.jsx("td",{className:"p-2 border",children:R.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:R.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:R.marginRivas??0,onChange:X=>S(R.id,"marginRivas",X.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:R.marginSanJorge??0,onChange:X=>S(R.id,"marginSanJorge",X.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:R.marginIsla??0,onChange:X=>S(R.id,"marginIsla",X.target.value)})}),i.jsx("td",{className:"p-2 border",children:R.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:R.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:R.unitPriceIsla})]},R.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!f&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Mn=t=>Math.round((Number(t)||0)*100)/100,Lf=t=>Math.round((Number(t)||0)*1e3)/1e3,La=t=>Number(t??0).toFixed(2),Od=t=>Number(t??0).toFixed(3),E1e=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?sr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",a=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,A=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),g=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let w=0;return c>0&&l>0&&Number(g||0)>0&&(w=Mn(c*Number(g||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:Mn(g),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:a,vendorId:o,vendorCommissionAmount:w,processedDate:A||""}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0;let f=0;return f=Mn(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:u,amount:d,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:a,vendorId:o,vendorCommissionAmount:f,processedDate:A||""}]};function B1e({role:t,currentUserEmail:e,sellerCandyId:r}){const[n,s]=N.useState([]),[a,o]=N.useState(null),[l,c]=N.useState(!0),[A,u]=N.useState(""),[d,f]=N.useState("ALL"),h=sr(new Date,"yyyy-MM-dd"),[m,p]=N.useState(h),[x,g]=N.useState(h),[w,b]=N.useState("ALL"),[k,P]=N.useState(null),[L,E]=N.useState(0),[_,B]=N.useState(0),[M,F]=N.useState(""),[T,O]=N.useState(0),[Y,me]=N.useState("0"),ae=N.useRef(null),fe=!t||t==="admin",he=t==="vendedor_dulces",te=(e||"").trim().toLowerCase(),[pe,Ie]=N.useState([]);N.useEffect(()=>{if(!m||!x)return;c(!0);const be=Ot(At(je,"sales_candies"),$t("date",">=",m),$t("date","<=",x),Dr("date","asc")),ge=Q0(be,K=>{const _e=[];K.forEach(Oe=>{const Ve=E1e(Oe.data(),Oe.id);_e.push(...Ve)}),s(_e),c(!1)},K=>{console.error("Error cargando ventas por periodo:",K),s([]),c(!1)});return()=>ge()},[m,x]),N.useEffect(()=>{(async()=>{const ge=Ot(At(je,"daily_closures_candies"),$t("date","==",h)),K=await Ct(ge);if(K.empty)o(null);else{const _e=K.docs[0];o({id:_e.id,..._e.data()})}})()},[h]),N.useEffect(()=>{(async()=>{try{const ge=await Ct(At(je,"sellers_candies")),K=[];ge.forEach(_e=>{const Oe=_e.data();K.push({id:_e.id,name:Oe.name||"",commissionPercent:Number(Oe.commissionPercent||0)})}),Ie(K)}catch(ge){console.error("Error cargando sellers_candies",ge)}})()},[]);const S=be=>Mn(Number(be.vendorCommissionAmount??0)||0),I=ui.useMemo(()=>{let be=[...n];return d==="FLOTANTE"&&(be=be.filter(ge=>ge.status==="FLOTANTE")),d==="PROCESADA"&&(be=be.filter(ge=>ge.status==="PROCESADA")),fe&&w!=="ALL"&&(be=be.filter(ge=>(ge.vendorId||"")===w)),he&&(r?be=be.filter(ge=>(ge.vendorId||"")===r):te?be=be.filter(ge=>(ge.sellerEmail||"").toLowerCase()===te):be=[]),be},[d,n,fe,w,he,r,te]),V=ui.useMemo(()=>I.filter(be=>be.status==="FLOTANTE").length,[I]),j=ui.useMemo(()=>I.filter(be=>be.status==="PROCESADA").length,[I]),U=ui.useMemo(()=>I.filter(be=>be.type==="CREDITO").length,[I]),G=ui.useMemo(()=>I.filter(be=>be.type!=="CREDITO").length,[I]),R=Lf(I.reduce((be,ge)=>be+(ge.quantity||0),0)),X=Mn(I.reduce((be,ge)=>be+Number(ge.cogsAmount??0),0)),se=Mn(I.reduce((be,ge)=>be+(ge.amount||0),0)),ye=Mn(se-X);let z=0,Me=0,re=0,W=0,q=0,oe=0,de=0;I.forEach(be=>{const ge=Number(be.amount||0),K=Number(be.amountReceived||0),_e=S(be);q+=_e,be.type==="CREDITO"?(z+=be.quantity||0,re+=ge-K,de+=_e):(Me+=be.quantity||0,W+=ge,oe+=_e)}),re=Mn(re),W=Mn(W),q=Mn(q),oe=Mn(oe),de=Mn(de);const Be=ui.useMemo(()=>{const be={};for(const ge of I){const K=(ge.vendorId||"").trim();if(!K||ge.type==="CREDITO")continue;const _e=S(ge);if(!be[K]){const Oe=pe.find(Ve=>Ve.id===K);be[K]={vendorId:K,name:(Oe==null?void 0:Oe.name)||ge.userEmail||"(sin vendedor)",total:0}}be[K].total=Mn(be[K].total+_e)}return Object.values(be).filter(ge=>ge.total>0).sort((ge,K)=>K.total-ge.total)},[I,pe]),He=ui.useMemo(()=>{const be={};for(const ge of I){const K=(ge.vendorId||"").trim();if(!K||ge.type!=="CREDITO")continue;const _e=S(ge);if(!be[K]){const Oe=pe.find(Ve=>Ve.id===K);be[K]={vendorId:K,name:(Oe==null?void 0:Oe.name)||ge.userEmail||"(sin vendedor)",total:0}}be[K].total=Mn(be[K].total+_e)}return Object.values(be).filter(ge=>ge.total>0).sort((ge,K)=>K.total-ge.total)},[I,pe]),$e={};I.forEach(be=>{const ge=be.productName||"(sin nombre)";$e[ge]||($e[ge]={totalQuantity:0,totalAmount:0,totalCommission:0}),$e[ge].totalQuantity=Lf($e[ge].totalQuantity+(be.quantity||0)),$e[ge].totalAmount=Mn($e[ge].totalAmount+(be.amount||0)),$e[ge].totalCommission=Mn($e[ge].totalCommission+S(be))});const Je=Object.entries($e).map(([be,ge])=>({productName:be,totalQuantity:ge.totalQuantity,totalAmount:ge.totalAmount,totalCommission:ge.totalCommission})),ct=async()=>{if(fe)try{const be=I.filter(Ue=>Ue.status==="FLOTANTE");if(be.length===0){u("No hay ventas flotantes para procesar en este perodo.");return}const ge={totalCharged:Mn(be.reduce((Ue,Ee)=>Ue+(Ee.amount||0),0)),totalSuggested:Mn(be.reduce((Ue,Ee)=>Ue+(Ee.amountSuggested||0),0)),totalUnits:Lf(be.reduce((Ue,Ee)=>Ue+(Ee.quantity||0),0)),totalCOGS:Mn(be.reduce((Ue,Ee)=>Ue+Number(Ee.cogsAmount??0),0))},K=Mn(ge.totalCharged-ge.totalSuggested),_e=Mn(ge.totalCharged-ge.totalCOGS),Oe=be.reduce((Ue,Ee)=>{const We=Number(Ee.quantity||0),nt=Number(Ee.amount||0),Nt=Number(Ee.vendorCommissionAmount||0);return Ee.type==="CREDITO"?(Ue.packsCredit+=We,Ue.amountCredit+=nt,Ue.comCredit+=Nt):(Ue.packsCash+=We,Ue.amountCash+=nt,Ue.comCash+=Nt),Ue},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),Ve={totalPacksCash:Lf(Oe.packsCash),totalPacksCredit:Lf(Oe.packsCredit),totalAmountCash:Mn(Oe.amountCash),totalAmountCredit:Mn(Oe.amountCredit),totalCommissionCash:Mn(Oe.comCash),totalCommissionCredit:Mn(Oe.comCredit)},ve=await Jr(At(je,"daily_closures_candies"),{date:h,createdAt:Gt.now(),periodStart:m,periodEnd:x,totalCharged:ge.totalCharged,totalSuggested:ge.totalSuggested,totalDifference:K,totalUnits:ge.totalUnits,totalCOGS:ge.totalCOGS,grossProfit:_e,...Ve,products:be.map(Ue=>({productName:Ue.productName,quantity:Ue.quantity,amount:Ue.amount})),sales:be.map(Ue=>({id:Ue.id,productName:Ue.productName,quantity:Ue.quantity,amount:Ue.amount,amountSuggested:Ue.amountSuggested,userEmail:Ue.userEmail,clientName:Ue.clientName,amountReceived:Ue.amountReceived,change:Ue.change,status:Ue.status,cogsAmount:Ue.cogsAmount??0,avgUnitCost:Ue.avgUnitCost??null,allocations:Ue.allocations??[],date:Ue.date,type:Ue.type??"CONTADO",vendorId:Ue.vendorId??"",vendorCommissionAmount:Number(Ue.vendorCommissionAmount??0)||0,processedDate:h})),productSummary:Object.entries(be.reduce((Ue,Ee)=>{const We=Ee.productName||"(sin nombre)";return Ue[We]||(Ue[We]={totalQuantity:0,totalAmount:0}),Ue[We].totalQuantity=Lf(Ue[We].totalQuantity+(Ee.quantity||0)),Ue[We].totalAmount=Mn(Ue[We].totalAmount+(Ee.amount||0)),Ue},{})).map(([Ue,Ee])=>({productName:Ue,totalQuantity:Ee.totalQuantity,totalAmount:Ee.totalAmount}))}),Qe=Wh(je);be.forEach(Ue=>{Qe.update(Tt(je,"sales_candies",Ue.id.split("#")[0]),{status:"PROCESADA",closureId:ve.id,closureDate:h,processedDate:h,processedAt:Gt.now()})}),await Qe.commit(),u(` Cierre guardado. Ventas procesadas: ${be.length}. (Proceso: ${h})`)}catch(be){console.error(be),u(" Error al guardar el cierre de dulces.")}},at=async be=>{if(fe&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Tr(Tt(je,"sales_candies",be.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),u(" Venta revertida a FLOTANTE.")}catch(ge){console.error(ge),u(" No se pudo revertir la venta.")}},mt=be=>{fe&&(P(be),E(be.quantity),B(be.amount),F(be.clientName),O(be.amountReceived),me(be.change))},st=async()=>{if(!(!k||!fe))try{await Tr(Tt(je,"sales_candies",k.id.split("#")[0]),{packagesTotal:L,amount:_,amountCharged:_,clientName:M,amountReceived:T,change:Y}),P(null),u(" Venta de dulces actualizada.")}catch(be){console.error(be),u(" No se pudo actualizar la venta de dulces.")}},Le=async be=>{if(fe&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const{restored:ge}=await Wve(be.split("#")[0]);u(` Venta eliminada. Stock restaurado (unidades internas): ${Number(ge).toFixed(2)}.`)}catch(ge){console.error(ge),u(" No se pudo eliminar la venta de dulces.")}},ut=async()=>{if(ae.current){ae.current.classList.add("force-pdf-colors"),ae.current.classList.add("pdf-print-mode");try{const ge=(await Jh(ae.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),K=new or;K.addImage(ge,"PNG",10,10,190,0),K.save(`cierre_dulces_${m}_a_${x}_proc_${h}.pdf`)}finally{ae.current.classList.remove("pdf-print-mode"),ae.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",h]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:be=>p(be.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:x,onChange:be=>g(be.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:d,onChange:be=>f(be.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),fe&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:w,onChange:be=>b(be.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),pe.map(be=>i.jsx("option",{value:be.id,children:be.name||be.id},be.id))]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:V}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:j}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:U}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:G}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",La(oe)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",La(de)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",x]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),Be.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Be.map(be=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:be.name}),i.jsxs("strong",{className:"ml-2",children:["C$",La(be.total)]})]},be.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),He.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:He.map(be=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:be.name}),i.jsxs("strong",{className:"ml-2",children:["C$",La(be.total)]})]},be.vendorId))})]})]}),l?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:ae,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[I.map(be=>{const ge=S(be),K=(be.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${be.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:be.status})}),i.jsx("td",{className:"border p-1",children:be.productName}),i.jsx("td",{className:"border p-1",children:be.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Od(be.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",La(be.amount)]}),i.jsx("td",{className:"border p-1",children:ge>0?`C$${La(ge)}`:""}),i.jsx("td",{className:"border p-1",children:be.date}),i.jsx("td",{className:"border p-1",children:K||""}),i.jsx("td",{className:"border p-1",children:be.userEmail}),i.jsx("td",{className:"border p-1",children:be.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:fe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>mt(be),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Le(be.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):be.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:fe?i.jsx("button",{onClick:()=>at(be.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},be.id)}),I.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[I.map(be=>{const ge=S(be),K=(be.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:be.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:[be.type==="CREDITO"?"Crdito":"Cash","  ",be.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",La(be.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${be.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:be.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Od(be.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:ge>0?`C$${La(ge)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:K||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:be.userEmail})]}),i.jsx("div",{className:"pt-2",children:be.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:fe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>mt(be),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Le(be.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):be.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:fe?i.jsx("button",{onClick:()=>at(be.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},be.id)}),I.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:Od(z)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:Od(Me)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",La(re)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",La(W)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",La(q)]})]})]}),(X>0||ye!==se)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",La(X)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",La(ye)]})]}),i.jsxs("div",{children:["Total paquetes (visibles):"," ",i.jsx("strong",{children:Od(R)})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsxs("tbody",{children:[Je.map(be=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:be.productName}),i.jsx("td",{className:"border p-1",children:Od(be.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",La(be.totalAmount)]}),i.jsx("td",{className:"border p-1",children:be.totalCommission>0?`C$${La(be.totalCommission)}`:""})]},be.productName)),Je.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-2",children:[Je.map(be=>i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[i.jsx("div",{className:"font-semibold",children:be.productName}),i.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),i.jsx("strong",{children:Od(be.totalQuantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total dinero"}),i.jsxs("strong",{children:["C$",La(be.totalAmount)]})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:be.totalCommission>0?`C$${La(be.totalCommission)}`:""})]})]})]},be.productName)),Je.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[fe&&i.jsx("button",{onClick:ct,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),i.jsx("button",{onClick:ut,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),A&&i.jsx("p",{className:"mt-2 text-sm",children:A}),k&&fe&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[k.productName,"  ",k.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:L,onChange:be=>E(parseFloat(be.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:_,onChange:be=>B(parseFloat(be.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:M,onChange:be=>F(be.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:T,onChange:be=>O(parseFloat(be.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:Y,onChange:be=>me(be.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>P(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:st,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Yc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,xo=t=>Math.round((Number(t)||0)*100)/100;function S1e(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function I1e(t){return t.toISOString().slice(0,10)}function F1e(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function k1e(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return I1e(r)}function T1e(){const[t,e]=N.useState(F1e()),[r,n]=N.useState(k1e()),[s,a]=N.useState(!1),[o,l]=N.useState(""),[c,A]=N.useState({}),[u,d]=N.useState({}),[f,h]=N.useState([]),[m,p]=N.useState([]),[x,g]=N.useState({}),[w,b]=N.useState(!1),[k,P]=N.useState(null),[L,E]=N.useState(null),_=N.useMemo(()=>k&&f.find(ae=>ae.vendorId===k)||null,[k,f]),B=N.useMemo(()=>{var ae;return!k||!L?[]:((ae=x[k])==null?void 0:ae[L])||[]},[k,L,x]),M=N.useMemo(()=>xo(f.reduce((ae,fe)=>ae+(fe.totalSoldMoney||0),0)),[f]),F=N.useMemo(()=>xo(f.reduce((ae,fe)=>ae+(fe.totalCreditMoney||0),0)),[f]);N.useEffect(()=>{(async()=>{try{const ae=await Ct(At(je,"sellers_candies")),fe={};ae.forEach(pe=>{const Ie=pe.data(),S=Ie.branch||"Rivas";let I="RIVAS";S==="San Jorge"?I="SAN_JORGE":S==="Isla Ometepe"&&(I="ISLA"),fe[pe.id]={id:pe.id,name:Ie.name??"(sin nombre)",branch:I,branchLabel:S,commissionPercent:Number(Ie.commissionPercent??0)}});const he=await Ct(At(je,"products_candies")),te={};he.forEach(pe=>{const Ie=pe.data();te[pe.id]={id:pe.id,name:Ie.name??"(sin nombre)"}}),A(fe),d(te)}catch(ae){console.error(ae),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const T=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}a(!0),l("");try{const ae={},fe={},he=Ot(At(je,"inventory_candies_sellers"),$t("date",">=",t),$t("date","<=",r)),te=await Ct(he),pe={},Ie={},S={},I={};te.forEach(oe=>{var Nt,ot;const de=oe.data(),Be=de.sellerId||"";if(!Be)return;const He=de.productId||"",$e=de.productName||((Nt=u[He])==null?void 0:Nt.name)||"(sin nombre)",Je=Math.max(1,Math.floor(Number(de.unitsPerPackage||1))),ct=Number(de.totalUnits??0),at=Number(de.packages??0),mt=Number(de.remainingUnits??de.remaining??0),st=Number(de.remainingPackages??0),Le=at>0?at:ct>0?Math.floor(ct/Je):0,ut=st>0?st:mt>0?Math.floor(mt/Je):0;pe[Be]=(pe[Be]||0)+Le,Ie[Be]=(Ie[Be]||0)+ut;const be=de.orderId||de.vendorOrderId||de.orderNumber||de.order||oe.id;S[Be]||(S[Be]=new Set),S[Be].add(be);const ge=((ot=c[Be])==null?void 0:ot.name)||de.sellerName||"(sin vendedor)",K=String(de.date||""),_e=Number(de.totalVendor??0),Oe=Number(de.gainVendor??0),Ve=at>0?at:ct>0?Math.floor(ct/Je):0,ve=Ve>0?_e/Ve:0,Qe=Ve>0?Oe/Ve:0,Ue=xo(Le*ve),Ee=xo(Le*Qe),We=xo(ut*ve),nt=xo(ut*Qe);I[Be]||(I[Be]={ordered:[],remaining:[]}),Le>0&&I[Be].ordered.push({date:K,vendorName:ge,productName:$e,packages:Le,totalMoney:Ue,vendorCommission:Ee}),ut>0&&I[Be].remaining.push({date:K,vendorName:ge,productName:$e,packages:ut,totalMoney:We,vendorCommission:nt})});const V={};Object.keys(S).forEach(oe=>{V[oe]=S[oe].size});const j=Ot(At(je,"sales_candies"),$t("date",">=",t),$t("date","<=",r)),U=await Ct(j),G={},R={},X={},se={},ye={},z={};U.forEach(oe=>{const de=oe.data(),Be=de.date||"",He=de.vendorId||de.sellerId||"";if(!He)return;const $e=c[He],Je=de.vendorName||($e==null?void 0:$e.name)||"(sin vendedor)",ct=Number(de.vendorCommissionPercent??($e==null?void 0:$e.commissionPercent)??0)||0,at=Array.isArray(de.items)?de.items:[];if(!at.length)return;const mt=String(de.type||"").toUpperCase()==="CREDITO";ye[He]||(ye[He]={sold:[],credit:[]}),at.forEach(st=>{var Ue;const Le=st.productName||((Ue=u[st.productId||""])==null?void 0:Ue.name)||"(sin nombre)",ut=st.packages??st.qty??st.quantity??0,be=Number(ut||0);if(be<=0)return;const ge=Number(st.unitPricePackage??st.unitPrice??0)||0,K=Math.max(0,Number(st.discount||0)),_e=be*ge,Oe=xo(Math.max(0,_e-K));if(Oe<=0)return;console.log("DBG",{isCredit:mt,vendorId:He,commissionPercent:ct,lineFinal:Oe,storedItemCommission:Number(st.vendorCommissionAmount??0)});let Ve=0;const ve=Number(st.vendorCommissionAmount??0);ve?Ve=xo(ve):ct>0&&(Ve=xo(Oe*ct/100)),mt?(R[He]=(R[He]||0)+be,se[He]=(se[He]||0)+Oe):(G[He]=(G[He]||0)+be,X[He]=(X[He]||0)+Oe),mt?fe[He]=(fe[He]||0)+Ve:ae[He]=(ae[He]||0)+Ve,mt?ye[He].credit.push({date:Be,vendorName:Je,productName:Le,packages:be,totalMoney:Oe,vendorCommission:0}):ye[He].sold.push({date:Be,vendorName:Je,productName:Le,packages:be,totalMoney:Oe,vendorCommission:Ve});const Qe=Le;z[Qe]||(z[Qe]={productName:Le,packages:0,totalMoney:0}),z[Qe].packages+=be,z[Qe].totalMoney+=Oe})});const Me=new Set([...Object.keys(pe),...Object.keys(Ie),...Object.keys(G),...Object.keys(R)]),re=[],W={};Me.forEach(oe=>{var ut,be,ge,K;const de=c[oe],Be=(de==null?void 0:de.name)||"(sin vendedor)",He=de?de.branchLabel||S1e(de.branch):"",$e=pe[oe]||0,Je=Ie[oe]||0,ct=G[oe]||0,at=R[oe]||0,mt=xo(X[oe]||0),st=xo(se[oe]||0),Le=V[oe]||0;re.push({vendorId:oe,vendorName:Be,branchLabel:He,orderedPackages:$e,remainingPackages:Je,soldPackages:ct,creditPackages:at,totalSoldMoney:mt,totalCreditMoney:st,ordersCreated:Le,commissionCash:xo(ae[oe]||0),commissionCredit:0}),W[oe]={ordered:(((ut=I[oe])==null?void 0:ut.ordered)||[]).sort((_e,Oe)=>_e.date.localeCompare(Oe.date)),remaining:(((be=I[oe])==null?void 0:be.remaining)||[]).sort((_e,Oe)=>_e.date.localeCompare(Oe.date)),sold:(((ge=ye[oe])==null?void 0:ge.sold)||[]).sort((_e,Oe)=>_e.date.localeCompare(Oe.date)),credit:(((K=ye[oe])==null?void 0:K.credit)||[]).sort((_e,Oe)=>_e.date.localeCompare(Oe.date))}}),re.sort((oe,de)=>oe.vendorName.localeCompare(de.vendorName,"es")),h(re),g(W);const q=Object.values(z).map(oe=>({productName:oe.productName,packages:oe.packages,totalMoney:xo(oe.totalMoney)})).sort((oe,de)=>de.packages-oe.packages).slice(0,10);p(q),re.length||l("Sin datos para el rango seleccionado.")}catch(ae){console.error(ae),l(" Error cargando consolidado de vendedores.")}finally{a(!1)}};N.useEffect(()=>{Object.keys(c).length&&T()},[c]);const O=(ae,fe)=>{P(ae),E(fe),b(!0)},Y=()=>{b(!1),P(null),E(null)},me=()=>{if(!f.length){l("No hay datos para exportar.");return}const ae=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],fe=f.map(S=>[S.vendorName,S.branchLabel,S.orderedPackages.toString(),S.remainingPackages.toString(),S.soldPackages.toString(),S.creditPackages.toString(),S.totalSoldMoney.toFixed(2),S.commissionCash.toFixed(2),S.totalCreditMoney.toFixed(2),S.commissionCredit.toFixed(2),S.ordersCreated.toString()]),he=[ae,...fe].map(S=>S.map(I=>`"${String(I).replace(/"/g,'""')}"`).join(",")).join(`
`),te=new Blob([he],{type:"text/csv;charset=utf-8;"}),pe=URL.createObjectURL(te),Ie=document.createElement("a");Ie.href=pe,Ie.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Ie.click(),URL.revokeObjectURL(pe)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ae=>e(ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ae=>n(ae.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:s,children:s?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:me,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Yc(M)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Yc(F)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:f.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[f.map(ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ae.vendorName}),i.jsx("td",{className:"border p-1",children:ae.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ae.vendorId,"ordered"),children:ae.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ae.vendorId,"remaining"),children:ae.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ae.vendorId,"sold"),children:ae.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(ae.vendorId,"credit"),children:ae.creditPackages})}),i.jsx("td",{className:"border p-1",children:Yc(ae.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Yc(ae.commissionCash)}),i.jsx("td",{className:"border p-1",children:Yc(ae.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Yc(ae.commissionCredit)}),i.jsx("td",{className:"border p-1",children:ae.ordersCreated})]},ae.vendorId)),f.length===0&&!s&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((ae,fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:fe+1}),i.jsx("td",{className:"border p-1",children:ae.productName}),i.jsx("td",{className:"border p-1",children:ae.packages}),i.jsx("td",{className:"border p-1",children:Yc(ae.totalMoney)})]},ae.productName)),m.length===0&&!s&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),w&&L&&k&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",L==="ordered"?"Paquetes ordenados":L==="remaining"?"Paquetes restantes":L==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[_==null?void 0:_.vendorName,"  ",_==null?void 0:_.branchLabel]})]}),i.jsx("button",{onClick:Y,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[B.map((ae,fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ae.date}),i.jsx("td",{className:"border p-1",children:ae.productName}),i.jsx("td",{className:"border p-1",children:ae.packages}),i.jsx("td",{className:"border p-1",children:Yc(ae.totalMoney)}),i.jsx("td",{className:"border p-1",children:ae.vendorName}),i.jsx("td",{className:"border p-1",children:Yc(ae.vendorCommission)})]},fe)),B.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const li=t=>`C$${Number(t||0).toFixed(2)}`,L1=t=>Number(t||0).toFixed(3),vC=()=>{const t=new Date;return sr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},U1=()=>sr(new Date,"yyyy-MM-dd");function j1e({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,a]=N.useState([]),o=N.useMemo(()=>{const Ee={};return s.forEach(We=>{We.email&&(Ee[We.email.trim().toLowerCase()]=We)}),Ee},[s]);N.useEffect(()=>{(async()=>{try{const Ee=Ot(At(je,"sellers_candies"),Dr("name","asc")),We=await Ct(Ee),nt=[];We.forEach(Nt=>{const ot=Nt.data();nt.push({id:Nt.id,name:ot.name||"",email:ot.email||"",commissionPercent:Number(ot.commissionPercent||0)})}),a(nt)}catch(Ee){console.error(Ee)}})()},[]);const[l,c]=N.useState(vC()),[A,u]=N.useState(U1()),[d,f]=N.useState(""),[h,m]=N.useState(""),p=N.useMemo(()=>{const Ee=new Map;return n.forEach(We=>{const nt=We.productId||We.productName;Ee.set(nt,{key:nt,name:We.productName})}),Array.from(Ee.values()).sort((We,nt)=>We.name.localeCompare(nt.name))},[n]),x=N.useMemo(()=>{const Ee=new Map;return n.forEach(We=>{const nt=(We.sellerEmail||"").trim().toLowerCase();if(!nt)return;const Nt=o[nt],ot=(Nt==null?void 0:Nt.name)||We.vendorName||nt;Ee.set(nt,{email:nt,label:ot})}),Array.from(Ee.values()).sort((We,nt)=>We.label.localeCompare(nt.label))},[n,o]),g=N.useMemo(()=>n.filter(Ee=>!(l&&Ee.date<l||A&&Ee.date>A||d&&(Ee.productId||Ee.productName)!==d||h&&(Ee.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,A,d,h]),[w,b]=N.useState(U1()),[k,P]=N.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[L,E]=N.useState(""),[_,B]=N.useState("0"),[M,F]=N.useState(()=>g.map(Ee=>Ee.id));N.useEffect(()=>{F(Ee=>Ee.filter(We=>g.some(nt=>nt.id===We)))},[g]);const[T,O]=N.useState([]),[Y,me]=N.useState([]),[ae,fe]=N.useState(!1),[he,te]=N.useState(vC()),[pe,Ie]=N.useState(U1());N.useEffect(()=>{(async()=>{try{fe(!0);const Ee=Ot(At(je,"expensesCandies"),Dr("date","desc")),We=await Ct(Ee),nt=[];We.forEach(Nt=>{const ot=Nt.data();nt.push({id:Nt.id,date:ot.date,description:ot.description,amount:Number(ot.amount||0)})}),O(nt)}catch(Ee){console.error(Ee)}finally{fe(!1)}})()},[]);const S=N.useMemo(()=>T.filter(Ee=>!(!Ee.date||he&&Ee.date<he||pe&&Ee.date>pe)),[T,he,pe]),[I,V]=N.useState([]),[j,U]=N.useState(!1),[G,R]=N.useState(""),[X,se]=N.useState("DEBITO"),[ye,z]=N.useState(""),Me=()=>{const Ee=Number(ye);!G.trim()||!isFinite(Ee)||Ee<=0||(V(We=>[...We,{id:`${Date.now()}_${We.length+1}`,description:G.trim(),type:X,amount:Number(Ee.toFixed(2))}]),R(""),z(""))},[re,W]=N.useState(null),[q,oe]=N.useState(""),[de,Be]=N.useState("DEBITO"),[He,$e]=N.useState(""),Je=Ee=>{W(Ee.id),oe(Ee.description),Be(Ee.type),$e(Ee.amount.toFixed(2))},ct=()=>{W(null),oe(""),Be("DEBITO"),$e("")},at=()=>{if(!re)return;const Ee=Number(He);!isFinite(Ee)||Ee<=0||(V(We=>We.map(nt=>nt.id===re?{...nt,description:q.trim(),type:de,amount:Number(Ee.toFixed(2))}:nt)),ct())},mt=Ee=>{V(We=>We.filter(nt=>nt.id!==Ee)),re===Ee&&ct()},st=(Ee,We)=>{F(nt=>We?[...new Set([...nt,Ee])]:nt.filter(Nt=>Nt!==Ee))},Le=Ee=>{F(Ee?g.map(We=>We.id):[])},ut=(Ee,We)=>{me(nt=>We?[...new Set([...nt,Ee])]:nt.filter(Nt=>Nt!==Ee))},be=N.useMemo(()=>g.filter(Ee=>M.includes(Ee.id)),[g,M]),ge=N.useMemo(()=>I.filter(Ee=>Ee.type==="DEBITO").reduce((Ee,We)=>Ee+We.amount,0),[I]),K=N.useMemo(()=>I.filter(Ee=>Ee.type==="CREDITO").reduce((Ee,We)=>Ee+We.amount,0),[I]),_e=N.useMemo(()=>{let Ee=0,We=0,nt=0,Nt=0;for(const yr of be){const tr=Number(yr.packages||0),et=Number(yr.cogsAmount||0),gt=Number(yr.amount||0);Ee+=tr,We+=et,nt+=gt;const Rt=(yr.sellerEmail||"").trim().toLowerCase(),kt=o[Rt],jt=Number((kt==null?void 0:kt.commissionPercent)||0),Zt=gt*jt/100;Nt+=Zt}const ot=S.filter(yr=>Y.includes(yr.id)).reduce((yr,tr)=>yr+Number(tr.amount||0),0),wt=nt-We,Lt=nt-ot-ge+K-Nt,cr=Number(_||0),ar=nt*cr/100;return{totalPackages:Number(L1(Ee)),totalProvider:Number(We.toFixed(2)),totalSale:Number(nt.toFixed(2)),totalGastos:Number(ot.toFixed(2)),debits:Number(ge.toFixed(2)),credits:Number(K.toFixed(2)),grossProfit:Number(wt.toFixed(2)),finalAmount:Number(Lt.toFixed(2)),totalCommissionVendors:Number(Nt.toFixed(2)),branchProfit:Number(ar.toFixed(2)),branchFactor:cr}},[be,S,Y,ge,K,o,_]),[Oe,Ve]=N.useState(!1),[ve,Qe]=N.useState(""),Ue=async()=>{if(Qe(""),be.length===0){Qe("Selecciona al menos 1 transaccin procesada.");return}try{Ve(!0);const Ee={number:k.trim(),date:w,description:L.trim(),status:"PENDIENTE",createdAt:Gt.now(),totalPackages:_e.totalPackages,totalProvider:_e.totalProvider,totalSale:_e.totalSale,totalExpenses:_e.totalGastos,totalDebits:_e.debits,totalCredits:_e.credits,grossProfit:_e.grossProfit,totalCommissionVendors:_e.totalCommissionVendors,branchFactorPercent:_e.branchFactor,branchProfit:_e.branchProfit,finalAmount:_e.finalAmount,transactions:be.map(We=>{const nt=Number(We.packages||0)||1,Nt=Number(We.cogsAmount||0),ot=Number(We.amount||0),wt=Nt/nt,Lt=ot/nt,cr=(We.sellerEmail||"").trim().toLowerCase(),ar=o[cr],yr=Number((ar==null?void 0:ar.commissionPercent)||0),tr=ot*yr/100;return{id:We.id,date:We.date,productId:We.productId||null,productName:We.productName,vendorName:We.vendorName,sellerEmail:We.sellerEmail||null,packages:Number(L1(We.packages)),providerPricePack:Number(wt.toFixed(4)),salePricePack:Number(Lt.toFixed(4)),totalProvider:Number(Nt.toFixed(2)),totalSale:Number(ot.toFixed(2)),commissionPercent:yr,commissionAmount:Number(tr.toFixed(2))}}),expenses:S.filter(We=>Y.includes(We.id)).map(We=>({id:We.id,date:We.date||null,description:We.description||"",amount:Number(Number(We.amount||0).toFixed(2))})),adjustments:I.map(We=>({id:We.id,description:We.description,type:We.type,amount:Number(We.amount.toFixed(2))}))};await Jr(At(je,"invoicesCandies"),Ee),Qe(" Factura de dulces creada."),r()}catch(Ee){console.error(Ee),Qe(` Error al crear factura: ${(Ee==null?void 0:Ee.message)||"desconocido"}`)}finally{Ve(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:w,onChange:Ee=>b(Ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:k,onChange:Ee=>P(Ee.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:_,onChange:Ee=>B(Ee.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:L,onChange:Ee=>E(Ee.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:Ee=>c(Ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:Ee=>u(Ee.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:d,onChange:Ee=>f(Ee.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(Ee=>i.jsx("option",{value:Ee.key,children:Ee.name},Ee.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:Ee=>m(Ee.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(Ee=>i.jsx("option",{value:Ee.email,children:Ee.label},Ee.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(vC()),u(U1()),f(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:g.length>0&&M.length===g.length,onChange:Ee=>Le(Ee.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),g.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:g.map(Ee=>{const We=M.includes(Ee.id),nt=Number(Ee.packages||0)||1,Nt=Number(Ee.cogsAmount||0),ot=Number(Ee.amount||0),wt=Nt/nt,Lt=ot/nt,cr=(Ee.sellerEmail||"").trim().toLowerCase(),ar=o[cr],yr=Number((ar==null?void 0:ar.commissionPercent)||0),tr=ot*yr/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:We,onChange:et=>st(Ee.id,et.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Ee.date}),i.jsx("td",{className:"p-2 border",children:(ar==null?void 0:ar.name)||Ee.vendorName}),i.jsx("td",{className:"p-2 border",children:Ee.productName}),i.jsx("td",{className:"p-2 border",children:L1(Ee.packages)}),i.jsx("td",{className:"p-2 border",children:li(wt)}),i.jsx("td",{className:"p-2 border",children:li(Lt)}),i.jsx("td",{className:"p-2 border",children:li(Nt)}),i.jsx("td",{className:"p-2 border",children:li(ot)}),i.jsx("td",{className:"p-2 border",children:yr>0?`${li(tr)} (${yr.toFixed(2)}%)`:""})]},Ee.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ae&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:he,onChange:Ee=>te(Ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:pe,onChange:Ee=>Ie(Ee.target.value)})]})]})]}),S.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:S.map(Ee=>{const We=Y.includes(Ee.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:We,onChange:nt=>ut(Ee.id,nt.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Ee.date||""}),i.jsx("td",{className:"p-2 border",children:Ee.description||""}),i.jsx("td",{className:"p-2 border",children:li(Number(Ee.amount||0))})]},Ee.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>U(!0),children:"Crear Cargo"})]}),I.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:I.map(Ee=>{const We=re===Ee.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:We?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:q,onChange:nt=>oe(nt.target.value)}):i.jsx("span",{title:Ee.description,children:Ee.description.length>60?`${Ee.description.slice(0,60)}`:Ee.description})}),i.jsx("td",{className:"p-2 border",children:We?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:de,onChange:nt=>Be(nt.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ee.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:Ee.type})}),i.jsx("td",{className:"p-2 border",children:We?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:He,onChange:nt=>$e(nt.target.value)}):li(Ee.amount)}),i.jsx("td",{className:"p-2 border",children:We?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:at,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:ct,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>mt(Ee.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>Je(Ee),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>mt(Ee.id),children:"Eliminar"})]})})]},Ee.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:L1(_e.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:li(_e.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:li(_e.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:li(_e.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:li(_e.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:li(_e.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:li(_e.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:li(_e.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:li(_e.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:li(_e.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:Oe,onClick:Ue,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:Oe?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),ve&&i.jsx("span",{className:"text-sm ml-2",children:ve})]}),Oe&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),j&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>U(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:G,onChange:Ee=>R(Ee.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:X,onChange:Ee=>se(Ee.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:ye,onChange:Ee=>z(Ee.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Me,children:"Agregar"})})]})]})})]})}const Cn=t=>`C$ ${Number(t??0).toFixed(2)}`,O1=t=>Number(t??0).toFixed(3);function yC(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),s=Number(t.totalSale??0),a=Number(t.totalCommissionVendors??0);if(e.length>0&&(s===0||r===0)){r=0,n=0,s=0,a=0;for(const g of e){const w=Number(g.packages??0);r+=w,n+=Number(g.totalProvider??w*(g.providerPricePack??0)),s+=Number(g.totalSale??w*(g.salePricePack??0));const b=g.commissionAmount??Number(g.totalSale??0)*Number(g.commissionPercent??0)/100;a+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((g,w)=>g+Number(w.amount||0),0),A=l.filter(g=>g.type==="DEBITO").reduce((g,w)=>g+Number(w.amount||0),0),u=l.filter(g=>g.type==="CREDITO").reduce((g,w)=>g+Number(w.amount||0),0),d=t.totalDebits!==void 0?Number(t.totalDebits):A,f=t.totalCredits!==void 0?Number(t.totalCredits):u,h=s-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):s-a-c-d+f;return{totalPackages:r,totalProvider:n,totalSale:s,commissionTotal:a,expenses:c,debits:d,credits:f,grossProfit:h,branchProfit:p,finalAmount:x}}function B3(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function P1e(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,a]=N.useState(null),o=N.useRef(null),[l,c]=N.useState(!1),A=async()=>{n(!0);const h=Ot(At(je,"invoicesCandies"),Dr("date","desc")),m=await Ct(h),p=[];m.forEach(x=>{const g=x.data();p.push({id:x.id,date:g.date,number:g.number,description:g.description,status:g.status||"PENDIENTE",totalPackages:g.totalPackages||0,totalProvider:g.totalProvider||0,totalSale:g.totalSale||0,totalExpenses:g.totalExpenses||0,totalDebits:g.totalDebits||0,totalCredits:g.totalCredits||0,totalCommissionVendors:g.totalCommissionVendors||0,finalAmount:g.finalAmount||0,branchFactorPercent:g.branchFactorPercent||0,branchProfit:g.branchProfit||0,transactions:(g.transactions||[]).map(w=>({id:w.id,date:w.date,vendorId:w.vendorId||null,vendorName:w.vendorName||"Sin nombre",sellerEmail:w.sellerEmail||null,productId:w.productId,productName:w.productName||"Sin nombre",packages:Number(w.packages||0),providerPricePack:Number(w.providerPricePack||0),salePricePack:Number(w.salePricePack||0),totalProvider:Number(w.totalProvider||0),totalSale:Number(w.totalSale||0),commissionPercent:Number(w.commissionPercent||0),commissionAmount:Number(w.commissionAmount||0)})),expenses:(g.expenses||[]).map(w=>({id:w.id,description:w.description||"",date:w.date||null,amount:Number(w.amount||0)})),adjustments:(g.adjustments||[]).map(w=>({id:w.id,description:w.description||"",type:w.type||"DEBITO",amount:Number(w.amount||0)}))})}),e(p),n(!1)};N.useEffect(()=>{A()},[]);const u=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await Tr(Tt(je,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(s==null?void 0:s.id)===h.id&&a({...h,status:m})},d=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await dn(Tt(je,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(s==null?void 0:s.id)===h.id&&a(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},f=async()=>{if(!o.current||!s)return;const h=o.current,m=await Jh(h,{backgroundColor:"#ffffff",onclone:b=>{const k=b.body;k.style.background="#ffffff",k.querySelectorAll("*").forEach(P=>{const L=b.defaultView.getComputedStyle(P);L.boxShadow&&L.boxShadow!=="none"&&(P.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new or("p","mm","a4"),g=x.internal.pageSize.getWidth(),w=m.height*g/m.width;x.addImage(p,"PNG",0,0,g,w),x.save(`factura_candy_${s.number||s.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(j1e,{onClose:()=>c(!1),onCreated:()=>{c(!1),A()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=yC(h),p=B3(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:O1(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>a(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>u(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>d(h),children:"Eliminar"})]})})]},h.id)})})]})}),s&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>a(null),children:"Cerrar"}),i.jsx("button",{onClick:f,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=yC(s),m=B3(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",O1(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Cn(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Cn(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Cn(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Cn(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Cn(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Cn(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Cn(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(s.transactions||[]).length>0?(s.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:O1(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Cn(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:s.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=yC(s);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:O1(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:Cn(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:Cn(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:Cn(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:Cn(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:Cn(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Cn(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Cn(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Cn(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Cn(h.finalAmount)})]})})]})})()]})]})}const os=t=>Math.round((Number(t)||0)*100)/100,uu=t=>Math.round((Number(t)||0)*1e3)/1e3,la=t=>Number(t??0).toFixed(2),Zc=t=>Number(t??0).toFixed(3),R1e=(t,e)=>{var f,h;const r=t.date??((f=t.timestamp)!=null&&f.toDate?sr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",a=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),g=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let w=0;return c>0&&l>0&&Number(g||0)>0&&(w=os(c*Number(g||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:os(g),date:r,type:a,vendorId:o,userEmail:s,vendorCommissionAmount:w}});const A=Number(t.packagesTotal??t.quantity??0),u=Number(t.amount??t.amountCharged??t.total??0)||0,d=os(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:((h=String(t))==null?void 0:h.productName)??"(sin nombre)",quantity:A,amount:os(u),date:r,type:a,vendorId:o,userEmail:s,vendorCommissionAmount:d}]};function D1e({role:t}){const e=!t||t==="admin",r="daily_closures_candies",n="sales_candies",s="sellers_candies",[a,o]=N.useState(sr(nO(new Date),"yyyy-MM-dd")),[l,c]=N.useState(sr(new Date,"yyyy-MM-dd")),[A,u]=N.useState(!0),[d,f]=N.useState([]),[h,m]=N.useState(null),[p,x]=N.useState(""),[g,w]=N.useState([]),[b,k]=N.useState("ALL"),[P,L]=N.useState({}),E=N.useRef(null);if(!e)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const _=async()=>{try{const I=await Ct(At(je,s)),V=[];I.forEach(j=>{const U=j.data();V.push({id:j.id,name:U.name||"",commissionPercent:Number(U.commissionPercent||0)})}),w(V)}catch(I){console.error("Error cargando sellers_candies",I)}},B=async()=>{const I=performance.now();try{u(!0);const V=Ot(At(je,r),$t("date",">=",a),$t("date","<=",l)),j=await Ct(V),U=performance.now();console.log(" getDocs ms:",(U-I).toFixed(1),"docs:",j.size);const G=[];j.forEach(ye=>G.push({id:ye.id,...ye.data()}));const R=performance.now();console.log(" parse+set ms:",(R-U).toFixed(1),"rows:",G.length),G.sort((ye,z)=>ye.date<z.date?1:ye.date>z.date?-1:0),f(G),m(null);const X=new Set;G.forEach(ye=>{(ye.sales||[]).forEach(z=>{const Me=String((z==null?void 0:z.id)??"").split("#")[0].trim();Me&&X.add(Me)})});const se=Array.from(X).filter(ye=>!P[ye]);if(se.length>0){const ye={};for(const z of se)try{const Me=await Xa(Tt(je,n,z));if(Me.exists()){const re=Me.data();ye[z]=R1e(re,z)}else ye[z]=[]}catch(Me){console.error("Error leyendo sale",z,Me),ye[z]=[]}L(z=>({...z,...ye}))}}catch(V){console.error(V),x(" Error cargando liquidaciones.")}finally{u(!1)}};N.useEffect(()=>{_()},[]),N.useEffect(()=>{B()},[]);const M=async I=>{I.preventDefault(),await B()},F=N.useMemo(()=>{const I={};return g.forEach(V=>I[V.id]=V.name||V.id),I},[g]),T=I=>{const V=[];return(I.sales||[]).forEach(j=>{const U=String((j==null?void 0:j.id)??"").trim();if(!U)return;const G=U.split("#")[0],X=(P[G]||[]).find(se=>se.id===U);X?V.push(X):V.push({id:U,productName:String((j==null?void 0:j.productName)??"(sin nombre)"),quantity:Number((j==null?void 0:j.quantity)??0),amount:os(Number((j==null?void 0:j.amount)??0)),date:String((j==null?void 0:j.date)??""),type:"CONTADO",vendorId:"",userEmail:String((j==null?void 0:j.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),V},O=I=>b==="ALL"?I:I.filter(V=>(V.vendorId||"")===b),Y=N.useMemo(()=>d.map(I=>{const V=O(T(I));let j=0,U=0,G=0,R=0,X=0,se=0;for(const ye of V){const z=Number(ye.quantity||0),Me=Number(ye.amount||0),re=Number(ye.vendorCommissionAmount||0);ye.type==="CREDITO"?(U+=z,R+=Me,se+=re):(j+=z,G+=Me,X+=re)}return{...I,_sales:V,_packsCash:uu(j),_packsCredit:uu(U),_amountCash:os(G),_amountCredit:os(R),_comCash:os(X),_comCredit:os(se)}}),[d,P,b]),me=N.useMemo(()=>{let I=0,V=0,j=0,U=0,G=0,R=0;for(const X of Y)I+=Number(X._packsCash||0),V+=Number(X._packsCredit||0),j+=Number(X._amountCash||0),U+=Number(X._amountCredit||0),G+=Number(X._comCash||0),R+=Number(X._comCredit||0);return{packsCash:uu(I),packsCredit:uu(V),totalSales:os(j+U),amountCash:os(j),amountCredit:os(U),comCash:os(G),comCredit:os(R)}},[Y]),ae=N.useMemo(()=>{const I={},V={};for(const j of Y){const U=j._sales||[];for(const G of U){const R=(G.vendorId||"").trim();if(!R)continue;const X=F[R]||G.userEmail||R,se=os(Number(G.vendorCommissionAmount||0));G.type==="CREDITO"?(V[R]||(V[R]={vendorId:R,name:X,total:0}),V[R].total=os(V[R].total+se)):(I[R]||(I[R]={vendorId:R,name:X,total:0}),I[R].total=os(I[R].total+se))}}return{cashRows:Object.values(I).filter(j=>j.total>0).sort((j,U)=>U.total-j.total),creditRows:Object.values(V).filter(j=>j.total>0).sort((j,U)=>U.total-j.total)}},[Y,F]),fe=N.useMemo(()=>g.map(I=>({id:I.id,label:I.name||I.id})).sort((I,V)=>I.label.localeCompare(V.label)),[g]),he=N.useMemo(()=>h&&Y.find(I=>I.id===h.id)||null,[h,Y]),te=N.useMemo(()=>he?he._sales||[]:[],[he]),pe=N.useMemo(()=>{let I=0,V=0,j=0,U=0;for(const G of te)G.type==="CREDITO"?(V+=Number(G.quantity||0),U+=Number(G.amount||0)):(I+=Number(G.quantity||0),j+=Number(G.amount||0));return{packsCash:uu(I),packsCredit:uu(V),amountCash:os(j),amountCredit:os(U)}},[te]),Ie=N.useMemo(()=>{const I={};for(const V of te){const j=V.productName||"(sin nombre)";I[j]||(I[j]={productName:j,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const U=Number(V.quantity||0),G=Number(V.amount||0),R=Number(V.vendorCommissionAmount||0);V.type==="CREDITO"?(I[j].packsCredit=uu(I[j].packsCredit+U),I[j].amountCredit=os(I[j].amountCredit+G),I[j].comCredit=os(I[j].comCredit+R)):(I[j].packsCash=uu(I[j].packsCash+U),I[j].amountCash=os(I[j].amountCash+G),I[j].comCash=os(I[j].comCash+R))}return Object.values(I)},[te]),S=async()=>{if(!E.current||!he)return;const I=E.current;I.classList.add("force-pdf-colors");try{const j=(await Jh(I,{backgroundColor:"#ffffff"})).toDataURL("image/png"),U=new or;U.addImage(j,"PNG",10,10,190,0),U.save(`liquidacion_${he.date}.pdf`)}finally{I.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:M,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:I=>o(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:I=>c(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:b,onChange:I=>k(I.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),fe.map(I=>i.jsx("option",{value:I.id,children:I.label},I.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Zc(me.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Zc(me.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",la(me.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",la(me.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",la(me.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",la(me.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",la(me.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),ae.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.cashRows.map(I=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:I.name}),i.jsxs("strong",{className:"ml-2",children:["C$",la(I.total)]})]},I.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),ae.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.creditRows.map(I=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:I.name}),i.jsxs("strong",{className:"ml-2",children:["C$",la(I.total)]})]},I.vendorId))})]})]}),A?i.jsx("p",{children:"Cargando..."}):Y.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:Y.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.date}),i.jsx("td",{className:"border p-1",children:Zc(I._packsCash)}),i.jsx("td",{className:"border p-1",children:Zc(I._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",la(I._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",la(I._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",la(I._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",la(I._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>m(I),children:"Ver detalle"})})})]},I.id))})]}),he&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",he.date]}),i.jsx("button",{onClick:()=>m(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:S,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:E,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",la(pe.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",la(pe.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Zc(pe.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Zc(pe.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),te.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:te.map((I,V)=>{const j=I.vendorId&&F[I.vendorId]?F[I.vendorId]:I.userEmail,U=os(Number(I.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j}),i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:I.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Zc(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",la(I.amount)]}),i.jsx("td",{className:"border p-1",children:U>0?`C$${la(U)}`:""}),i.jsx("td",{className:"border p-1",children:I.date||""})]},V)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),Ie.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:Ie.map((I,V)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:Zc(I.packsCash)}),i.jsx("td",{className:"border p-1",children:Zc(I.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",la(I.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",la(I.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",la(I.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",la(I.comCredit)]})]},V))})]})]})]}),p&&i.jsx("p",{className:"mt-3 text-sm",children:p})]})}const Gr=t=>Math.round((Number(t)||0)*100)/100,ca=t=>Math.round((Number(t)||0)*1e3)/1e3,Vr=t=>Number(t??0).toFixed(2),wa=t=>Number(t??0).toFixed(3),S3=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},L1e=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?sr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),s=t.status??"FLOTANTE",a=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),A=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",u=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,d=Number(t.vendorCommissionAmount??0)||0,f=S3(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((g,w)=>{const b=Number((g==null?void 0:g.packages)??0)||0,k=Number((g==null?void 0:g.total)??0)||Math.max(0,Number((g==null?void 0:g.unitPricePackage)||0)*b-Number((g==null?void 0:g.discount)||0)),P=S3(g==null?void 0:g.branch)||f;let L=0;return d>0&&u>0&&k>0&&(L=Gr(d*k/u)),{id:`${e}#${w}`,docId:e,productId:String((g==null?void 0:g.productId)??""),productName:String((g==null?void 0:g.productName)??"(sin nombre)"),date:r,processedDate:n,status:s,type:a,vendorId:o,vendorName:l,customerId:c,customerName:A,branch:P||"",packages:b,amount:Gr(k),commission:Gr(L)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=Gr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:s,type:a,vendorId:o,vendorName:l,customerId:c,customerName:A,branch:f||"",packages:h,amount:Gr(m),commission:Gr(p)}]};function U1e({role:t}){var ge;const e=!t||t==="admin",r=sr(new Date,"yyyy-MM-dd"),[n,s]=N.useState(r),[a,o]=N.useState(r),[l,c]=N.useState("TODAS"),[A,u]=N.useState("AMBAS"),[d,f]=N.useState("ALL"),[h,m]=N.useState("ALL"),[p,x]=N.useState(""),[g,w]=N.useState(""),[b,k]=N.useState(""),[P,L]=N.useState(""),[E,_]=N.useState("DIA"),[B,M]=N.useState(!0),[F,T]=N.useState(""),[O,Y]=N.useState([]),[me,ae]=N.useState([]),[fe,he]=N.useState([]),[te,pe]=N.useState([]),[Ie,S]=N.useState([]),[I,V]=N.useState([]),[j,U]=N.useState([]),[G,R]=N.useState([]),[X,se]=N.useState(""),ye=N.useRef(null),[z,Me]=N.useState([]),re=N.useMemo(()=>{const K={};return Ie.forEach(_e=>{K[_e.id]=String(_e.name||"").trim()}),K},[Ie]),W=K=>{const _e=K.customerId?re[K.customerId]:"";return(K.customerName||_e||"").trim()||(K.customerId?re[K.customerId]||K.customerId:"")||""};N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=await Ct(At(je,"inventory_candies")),Oe=[];_e.forEach(Ve=>Oe.push({id:Ve.id,...Ve.data()})),Me(Oe)}catch(_e){console.error("inventory_candies all error:",_e),Me([])}})()},[e]),N.useEffect(()=>{(async()=>{try{const _e=await Ct(At(je,"sellers_candies")),Oe=[];_e.forEach(ve=>{const Qe=ve.data();Oe.push({id:ve.id,name:String(Qe.name||"").trim(),commissionPercent:Number(Qe.commissionPercent||0),branch:Qe.branch||""})});const Ve=new Map;Oe.forEach(ve=>Ve.set(ve.id,ve)),ae(Array.from(Ve.values()).sort((ve,Qe)=>ve.name.localeCompare(Qe.name)))}catch(_e){console.error(_e)}})()},[]),N.useEffect(()=>{if(!e||!n||!a)return;M(!0),T("");const K=Ot(At(je,"sales_candies"),$t("date",">=",n),$t("date","<=",a),Dr("date","asc")),_e=Q0(K,Oe=>{const Ve=[];Oe.forEach(ve=>Ve.push(...L1e(ve.data(),ve.id))),Y(Ve),M(!1)},Oe=>{console.error("sales_candies periodo error:",Oe),Y([]),M(!1),T(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>_e()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=Ot(At(je,"candy_main_orders"),$t("date",">=",n),$t("date","<=",a)),Oe=await Ct(_e),Ve=[];Oe.forEach(ve=>Ve.push({id:ve.id,...ve.data()})),he(Ve)}catch(_e){console.error("candy_main_orders error:",_e),he([])}})()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=Ot(At(je,"inventory_candies_sellers"),$t("date",">=",n),$t("date","<=",a)),Oe=await Ct(_e),Ve=[];Oe.forEach(ve=>Ve.push({id:ve.id,...ve.data()})),pe(Ve)}catch(_e){console.error("inventory_candies_sellers error:",_e),pe([])}})()},[e,n,a]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=await Ct(At(je,"inventory_candies")),Oe=[];_e.forEach(Ve=>Oe.push({id:Ve.id,...Ve.data()})),U(Oe)}catch(_e){console.error("inventory_candies global error:",_e),U([])}})()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=await Ct(At(je,"inventory_candies_sellers")),Oe=[];_e.forEach(Ve=>Oe.push({id:Ve.id,...Ve.data()})),R(Oe)}catch(_e){console.error("inventory_candies_sellers global error:",_e),R([])}})()},[e]),N.useEffect(()=>{if(!e)return;const K=Ot(At(je,"customers_candies")),_e=Q0(K,Oe=>{const Ve=[];Oe.forEach(ve=>{var Qe;return Ve.push({id:ve.id,name:String(((Qe=ve.data())==null?void 0:Qe.name)||"").trim()})}),S(Ve)},Oe=>{console.error("customers_candies snapshot error:",Oe),S([])});return()=>_e()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=Ot(At(je,"ar_movements"),$t("date","<=",a),Dr("date","asc")),Oe=await Ct(_e),Ve=[];Oe.forEach(ve=>Ve.push({id:ve.id,...ve.data()})),V(Ve)}catch(_e){console.warn("ar_movements sin ndice, usando fallback:",_e);try{const Oe=await Ct(At(je,"ar_movements")),Ve=[];Oe.forEach(ve=>Ve.push({id:ve.id,...ve.data()})),V(Ve.filter(ve=>String(ve.date||"")<=a))}catch(Oe){console.error(Oe),V([])}}})()},[e,a]);const q=N.useMemo(()=>{let K=[...O];if(l!=="TODAS"&&(K=K.filter(Ve=>Ve.status===l)),A==="CASH"&&(K=K.filter(Ve=>Ve.type==="CONTADO")),A==="CREDITO"&&(K=K.filter(Ve=>Ve.type==="CREDITO")),d!=="ALL"&&(K=K.filter(Ve=>(Ve.vendorId||"")===d)),h!=="ALL"&&(K=K.filter(Ve=>Ve.branch===h)),p.trim()){const Ve=p.trim().toLowerCase();K=K.filter(ve=>(ve.productName||"").toLowerCase().includes(Ve))}if(g.trim()){const Ve=g.trim().toLowerCase();K=K.filter(ve=>(W(ve)||"").toLowerCase().includes(Ve))}const _e=b.trim()?Number(b):null,Oe=P.trim()?Number(P):null;return _e!==null&&!Number.isNaN(_e)&&(K=K.filter(Ve=>(Ve.amount||0)>=_e)),Oe!==null&&!Number.isNaN(Oe)&&(K=K.filter(Ve=>(Ve.amount||0)<=Oe)),K},[O,l,A,d,h,p,g,b,P,re]),oe=N.useMemo(()=>{let K=0,_e=0,Oe=0,Ve=0,ve=0,Qe=0;for(const Ee of q){const We=Number(Ee.packages||0),nt=Number(Ee.amount||0),Nt=Number(Ee.commission||0);Ee.type==="CREDITO"?(_e+=We,Ve+=nt,Qe+=Nt):(K+=We,Oe+=nt,ve+=Nt)}const Ue=Gr(Oe+Ve);return{packsCash:ca(K),packsCredit:ca(_e),salesCash:Gr(Oe),salesCredit:Gr(Ve),salesTotal:Ue,commCash:Gr(ve),commCredit:Gr(Qe)}},[q]),de=N.useMemo(()=>{let K=0,_e=0,Oe=0,Ve=0,ve=0,Qe=0;for(const Ue of fe){const Ee=Array.isArray(Ue.items)?Ue.items:[];for(const We of Ee)K+=Number(We.totalRivas??0),_e+=Number(We.totalSanJorge??0),Oe+=Number(We.totalIsla??0),Ve+=Number(We.gainRivas??0),ve+=Number(We.gainSanJorge??0),Qe+=Number(We.gainIsla??0)}return{expectedRivas:Gr(K),expectedSanJorge:Gr(_e),expectedIsla:Gr(Oe),grossRivas:Gr(Ve),grossSanJorge:Gr(ve),grossIsla:Gr(Qe),grossTotal:Gr(Ve+ve+Qe)}},[fe]),Be=N.useMemo(()=>{const K={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const _e of q){const Oe=_e.branch;Oe&&(K[Oe].sales+=Number(_e.amount||0),K[Oe].packages+=Number(_e.packages||0))}return{RIVAS:{sales:Gr(K.RIVAS.sales),packages:ca(K.RIVAS.packages)},SAN_JORGE:{sales:Gr(K.SAN_JORGE.sales),packages:ca(K.SAN_JORGE.packages)},ISLA:{sales:Gr(K.ISLA.sales),packages:ca(K.ISLA.packages)}}},[q]),He=N.useMemo(()=>({RIVAS:Gr(Be.RIVAS.sales-de.expectedRivas),SAN_JORGE:Gr(Be.SAN_JORGE.sales-de.expectedSanJorge),ISLA:Gr(Be.ISLA.sales-de.expectedIsla)}),[Be,de]),$e=N.useMemo(()=>{const K={},_e={};for(const ve of q){const Qe=(ve.vendorId||"").trim();if(!Qe)continue;const Ue=me.find(nt=>nt.id===Qe),Ee=(Ue==null?void 0:Ue.name)||ve.vendorName||"(sin vendedor)",We=Number(ve.commission||0);ve.type==="CREDITO"?(_e[Qe]||(_e[Qe]={vendorId:Qe,name:Ee,total:0}),_e[Qe].total=Gr(_e[Qe].total+We)):(K[Qe]||(K[Qe]={vendorId:Qe,name:Ee,total:0}),K[Qe].total=Gr(K[Qe].total+We))}const Oe=Object.values(K).sort((ve,Qe)=>Qe.total-ve.total),Ve=Object.values(_e).sort((ve,Qe)=>Qe.total-ve.total);return{cashArr:Oe,creditArr:Ve}},[q,me]),Je=N.useMemo(()=>{const K=(gt,Rt)=>gt.reduce((kt,jt)=>kt+Number((jt==null?void 0:jt[Rt])??0),0),_e=gt=>{const Rt=gt.map(jt=>Number((jt==null?void 0:jt.remainingPackages)??0)).filter(jt=>Number.isFinite(jt));return Rt.length===0?0:Rt.every(jt=>jt===Rt[0])?Rt[0]:Rt.reduce((jt,Zt)=>jt+Zt,0)},Oe=gt=>{const Rt=Number((gt==null?void 0:gt.totalPackages)??0);if(Rt>0)return Rt;const kt=Array.isArray(gt==null?void 0:gt.items)?gt.items:[];return K(kt,"packages")},Ve=gt=>{const Rt=Number((gt==null?void 0:gt.remainingPackages)??0);if(Rt>0)return Rt;const kt=Array.isArray(gt==null?void 0:gt.items)?gt.items:[];return _e(kt)},ve=gt=>{const Rt=Number(gt);return Number.isFinite(Rt)?Math.floor(Rt):0},Qe=gt=>{const Rt=Number(gt==null?void 0:gt.remainingPackages);if(Number.isFinite(Rt)&&Rt>0)return Math.floor(Rt);const kt=Math.max(1,ve((gt==null?void 0:gt.unitsPerPackage)??1)),jt=ve((gt==null?void 0:gt.remainingUnits)??(gt==null?void 0:gt.remaining)??0);return jt>0?Math.max(0,Math.floor(jt/kt)):0};let Ue=0,Ee=0,We=0;for(const gt of fe){const Rt=Array.isArray(gt.items)?gt.items:[];if(Rt.length)for(const kt of Rt)Ue+=Number((kt==null?void 0:kt.subtotal)??0);else Ue+=Number(gt.subtotal??0);Ee+=Oe(gt),We+=Ve(gt)}let nt=0,Nt=0,ot=0;const wt={};for(const gt of te){nt+=Number(gt.subtotal??0),Nt+=Number(gt.packages??0);const Rt=Qe(gt);ot+=Rt;const kt=String(gt.sellerId||"").trim();if(!kt)continue;const jt=String(gt.sellerName||"").trim()||"(sin vendedor)";wt[kt]||(wt[kt]={sellerId:kt,sellerName:jt,ordered:0,remaining:0}),wt[kt].ordered+=Number(gt.packages??0),wt[kt].remaining+=Rt}const Lt=Object.values(wt).map(gt=>({...gt,ordered:ca(gt.ordered),remaining:ca(gt.remaining)})).sort((gt,Rt)=>Rt.ordered-gt.ordered),cr=[...Lt].sort((gt,Rt)=>Rt.remaining-gt.remaining),ar=We,yr=ot,tr=new Set(fe.filter(gt=>String(gt.date||"")>=n&&String(gt.date||"")<=a).map(gt=>gt.id));let et=0;for(const gt of z){const Rt=String(gt.orderId||"").trim();Rt&&tr.has(Rt)&&(et+=Number(gt.remainingPackages??0))}return{providerTotalMaster:Gr(Ue),providerTotalVendor:Gr(nt),orderedPacksMaster:ca(Ee),remainingPacksMaster:ca(et),orderedPacksVendor:ca(Nt),remainingPacksVendor:ca(ot),globalRemainingMaster:ca(ar),globalRemainingVendor:ca(yr),vendorRowsOrdered:Lt,vendorRowsRemaining:cr}},[fe,te,z,n,a]),ct=N.useMemo(()=>{const K=j.reduce((Oe,Ve)=>Oe+Number(Ve.remainingPackages??0),0),_e=G.reduce((Oe,Ve)=>Oe+Number(Ve.remainingPackages??0),0);return{masterRemainingPackages:ca(K),vendorRemainingPackages:ca(_e)}},[j,G]),at=N.useMemo(()=>{const K=new Map,_e=Ve=>E==="DIA"?{key:Ve.date,label:Ve.date}:E==="VENDEDOR"?{key:Ve.vendorId||"",label:Ve.vendorName||""}:E==="PRODUCTO"?{key:Ve.productName||"",label:Ve.productName||""}:{key:Ve.branch||"",label:Ve.branch||""};for(const Ve of q){const{key:ve,label:Qe}=_e(Ve);K.has(ve)||K.set(ve,{key:ve,label:Qe,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const Ue=K.get(ve);Ue.rows.push(Ve),Ve.type==="CREDITO"?(Ue.packsCredit+=Number(Ve.packages||0),Ue.salesCredit+=Number(Ve.amount||0),Ue.commCredit+=Number(Ve.commission||0)):(Ue.packsCash+=Number(Ve.packages||0),Ue.salesCash+=Number(Ve.amount||0),Ue.commCash+=Number(Ve.commission||0))}const Oe=Array.from(K.values()).map(Ve=>({...Ve,packsCash:ca(Ve.packsCash),packsCredit:ca(Ve.packsCredit),salesCash:Gr(Ve.salesCash),salesCredit:Gr(Ve.salesCredit),commCash:Gr(Ve.commCash),commCredit:Gr(Ve.commCredit)}));return E==="DIA"?Oe.sort((Ve,ve)=>Ve.key<ve.key?1:-1):Oe.sort((Ve,ve)=>ve.salesCash+ve.salesCredit-(Ve.salesCash+Ve.salesCredit)),Oe},[q,E]),mt=N.useMemo(()=>{if(!X)return[];const K=at.find(_e=>_e.key===X);return(K==null?void 0:K.rows)||[]},[X,at]),st=N.useMemo(()=>{const K={};for(const _e of mt){const Oe=_e.productName||"(sin nombre)";K[Oe]||(K[Oe]={productName:Oe,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),_e.type==="CREDITO"?(K[Oe].packsCredit+=Number(_e.packages||0),K[Oe].salesCredit+=Number(_e.amount||0),K[Oe].commCredit+=Number(_e.commission||0)):(K[Oe].packsCash+=Number(_e.packages||0),K[Oe].salesCash+=Number(_e.amount||0),K[Oe].commCash+=Number(_e.commission||0))}return Object.values(K).map(_e=>({..._e,packsCash:ca(_e.packsCash),packsCredit:ca(_e.packsCredit),salesCash:Gr(_e.salesCash),salesCredit:Gr(_e.salesCredit),commCash:Gr(_e.commCash),commCredit:Gr(_e.commCredit)})).sort((_e,Oe)=>Oe.salesCash+Oe.salesCredit-(_e.salesCash+_e.salesCredit))},[mt]),Le=N.useMemo(()=>{const K={},_e=ve=>(re[ve]||"").trim()||ve;for(const ve of I){const Qe=String(ve.customerId||"").trim();if(!Qe)continue;const Ue=String(ve.date||"");if(Ue&&Ue>a)continue;K[Qe]||(K[Qe]={customerId:Qe,name:_e(Qe),balance:0,lastPayment:""});const Ee=Number(ve.amount||0);ve.type==="CARGO"&&(K[Qe].balance+=Ee),ve.type==="ABONO"&&(K[Qe].balance-=Ee,(!K[Qe].lastPayment||Ue>K[Qe].lastPayment)&&(K[Qe].lastPayment=Ue))}const Oe=Object.values(K).map(ve=>({...ve,balance:Gr(ve.balance)})).filter(ve=>ve.balance>0).sort((ve,Qe)=>Qe.balance-ve.balance),Ve=Gr(Oe.reduce((ve,Qe)=>ve+Qe.balance,0));return{count:Oe.length,totalPending:Ve,list:Oe.slice(0,20)}},[I,re,a]),ut=async()=>{if(ye.current){ye.current.classList.add("force-pdf-colors");try{const _e=(await Jh(ye.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Oe=new or;Oe.addImage(_e,"PNG",10,10,190,0),Oe.save(`data_center_dulces_${n}_a_${a}.pdf`)}finally{ye.current.classList.remove("force-pdf-colors")}}},be=()=>{const _e=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...q.map(Qe=>[Qe.date,Qe.processedDate||"",Qe.status,Qe.type,Qe.vendorId,`"${String(Qe.vendorName||"").replace(/"/g,'""')}"`,Qe.branch||"",`"${String(Qe.productName||"").replace(/"/g,'""')}"`,wa(Qe.packages),Vr(Qe.amount),Vr(Qe.commission),Qe.customerId||"",`"${String(W(Qe)||"").replace(/"/g,'""')}"`].join(","))],Oe=new Blob([_e.join(`
`)],{type:"text/csv;charset=utf-8;"}),Ve=URL.createObjectURL(Oe),ve=document.createElement("a");ve.href=Ve,ve.download=`data_center_dulces_${n}_a_${a}.csv`,ve.click(),URL.revokeObjectURL(Ve)};return e?i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[i.jsx("button",{onClick:ut,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Exportar PDF"}),i.jsx("button",{onClick:be,className:"bg-gray-800 text-white px-4 py-2 rounded hover:bg-black",children:"Exportar CSV"})]})]}),i.jsx("div",{className:"rounded-2xl border border-gray-100 p-4 mb-4 shadow-sm bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:n,onChange:K=>s(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:a,onChange:K=>o(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:l,onChange:K=>c(K.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:A,onChange:K=>u(K.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:d,onChange:K=>f(K.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),me.map(K=>i.jsx("option",{value:K.id,children:K.name||K.id},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Sucursal"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:K=>m(K.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:p,onChange:K=>x(K.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:g,onChange:K=>w(K.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Monto min"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:b,onChange:K=>k(K.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Monto max"}),i.jsx("input",{className:"border rounded px-2 py-1 w-full",value:P,onChange:K=>L(K.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"md:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-sm",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:E,onChange:K=>{se(""),_(K.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})}),i.jsxs("div",{ref:ye,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(oe.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(oe.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Vr(oe.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Vr(oe.salesCash),"  Crdito: C$",Vr(oe.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Vr(oe.commCash+oe.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Vr(oe.commCash),"  Crdito: C$",Vr(oe.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gross Profit total (rdenes maestras)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Vr(de.grossTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["R: ",Vr(de.grossRivas),"  SJ:"," ",Vr(de.grossSanJorge),"  I:"," ",Vr(de.grossIsla)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Expected Total (Rivas/SJ/Isla)"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Vr(de.expectedRivas)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Vr(de.expectedSanJorge)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Vr(de.expectedIsla)]})]})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas por sucursal"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Vr(Be.RIVAS.sales)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Vr(Be.SAN_JORGE.sales)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Vr(Be.ISLA.sales)]})]})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs expected"}),i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Rivas"}),i.jsxs("strong",{children:["C$",Vr(He.RIVAS)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"San Jorge"}),i.jsxs("strong",{children:["C$",Vr(He.SAN_JORGE)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Isla"}),i.jsxs("strong",{children:["C$",Vr(He.ISLA)]})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes maestras)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Vr(Je.providerTotalMaster)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Vr(Je.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",a]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(Je.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:wa(Je.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:wa(ct.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-2xl font-bold",children:wa(Je.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:wa(Je.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:wa(ct.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados por vendedor (perodo)"}),Je.vendorRowsOrdered.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:Je.vendorRowsOrdered.map(K=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:K.sellerName}),i.jsx("strong",{className:"ml-2",children:wa(K.ordered)})]},K.sellerId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes existentes por vendedor (perodo)"}),Je.vendorRowsRemaining.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:Je.vendorRowsRemaining.map(K=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:K.sellerName}),i.jsx("strong",{className:"ml-2",children:wa(K.remaining)})]},K.sellerId))})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),$e.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:$e.cashArr.map(K=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:K.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Vr(K.total)]})]},K.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),$e.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-36 overflow-auto pr-1",children:$e.creditArr.map(K=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:K.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Vr(K.total)]})]},K.vendorId))})]})]}),i.jsxs("div",{className:"border rounded-2xl p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("h3",{className:"font-semibold mb-2",children:["Cartera (saldo pendiente hasta ",a,")"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:Le.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Vr(Le.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),Le.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"})]})}),i.jsx("tbody",{children:Le.list.map(K=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:K.name}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.balance)]}),i.jsx("td",{className:"border p-1",children:K.lastPayment||""})]},K.customerId))})]})]}),i.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"Click en Ver detalle para drill-down"})]}),B?i.jsx("p",{children:"Cargando..."}):i.jsxs("table",{className:"min-w-full border text-sm mb-6 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[at.map(K=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:K.label}),i.jsx("td",{className:"border p-1",children:wa(K.packsCash)}),i.jsx("td",{className:"border p-1",children:wa(K.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.salesCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.salesCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.commCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.commCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>se(K.key),children:"Ver detalle"})})]},K.key)),at.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]}),X&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle "," ",((ge=at.find(K=>K.key===X))==null?void 0:ge.label)||X]}),i.jsx("button",{onClick:()=>se(""),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Vr(mt.filter(K=>K.type==="CONTADO").reduce((K,_e)=>K+Number(_e.amount||0),0))]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Vr(mt.filter(K=>K.type==="CREDITO").reduce((K,_e)=>K+Number(_e.amount||0),0))]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:wa(mt.filter(K=>K.type==="CONTADO").reduce((K,_e)=>K+Number(_e.packages||0),0))})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:wa(mt.filter(K=>K.type==="CREDITO").reduce((K,_e)=>K+Number(_e.packages||0),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas incluidas"}),i.jsxs("table",{className:"min-w-full border text-sm mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[mt.map(K=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:K.vendorName}),i.jsx("td",{className:"border p-1",children:K.productName}),i.jsx("td",{className:"border p-1",children:K.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:K.branch||""}),i.jsx("td",{className:"border p-1",children:wa(K.packages)}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.commission)]}),i.jsx("td",{className:"border p-1",children:K.date})]},K.id)),mt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin detalle."})})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[st.map(K=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:K.productName}),i.jsx("td",{className:"border p-1",children:wa(K.packsCash)}),i.jsx("td",{className:"border p-1",children:wa(K.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.salesCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.salesCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.commCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Vr(K.commCredit)]})]},K.productName)),st.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-3 text-center text-gray-500",children:"Sin consolidado."})})]})]})]})]}),F&&i.jsx("p",{className:"mt-3 text-sm",children:F})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function O1e(){const[t,e]=N.useState(!1);return N.useEffect(()=>{var s;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(s=r.addEventListener)==null||s.call(r,"change",n),()=>{var a;return(a=r.removeEventListener)==null?void 0:a.call(r,"change",n)}},[]),t}function M1e(){const[t,e]=N.useState(null),[r,n]=N.useState(""),[s,a]=N.useState(""),[o,l]=N.useState(!0),c=O1e(),A=N.useMemo(()=>c?i.jsx(rY,{role:r}):i.jsx(tY,{role:r}),[c,r]),u=(t==null?void 0:t.email)||"";if(N.useEffect(()=>{const f=OL(Dx,async h=>{if(l(!0),h){e(h);try{const m=Tt(je,"users",h.uid),p=await Xa(m);if(p.exists()){const x=p.data(),g=x.role||"",w=x.sellerCandyId||"";n(g||""),a(w||"")}else n(""),a("")}catch{n(""),a("")}}else e(null),n(""),a("");l(!1)});return()=>f()},[]),o)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const d=()=>r==="admin"?i.jsx(Vd,{to:"financialDashboard",replace:!0}):r==="vendedor_pollo"?i.jsx(Vd,{to:"salesV2",replace:!0}):r==="vendedor_ropa"?i.jsx(Vd,{to:"salesClothes",replace:!0}):r==="vendedor_dulces"?i.jsx(Vd,{to:"salesCandies",replace:!0}):i.jsx(Vd,{to:"/",replace:!0});return i.jsx(OK,{children:i.jsxs(pK,{children:[i.jsx(Mr,{path:"/",element:i.jsx(eY,{})}),i.jsxs(Mr,{path:"/admin",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"],children:A}),children:[i.jsx(Mr,{index:!0,element:i.jsx(d,{})}),i.jsx(Mr,{path:"bills",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Ioe,{})})}),i.jsx(Mr,{path:"salesV2",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Xj,{user:t})})}),i.jsx(Mr,{path:"financialDashboard",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ele,{})})}),i.jsx(Mr,{path:"expenses",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(rle,{})})}),i.jsx(Mr,{path:"billing",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ole,{})})}),i.jsx(Mr,{path:"batches",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Xoe,{role:r})})}),i.jsx(Mr,{path:"paidBatches",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ule,{})})}),i.jsx(Mr,{path:"fix",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(ale,{})})}),i.jsx(Mr,{path:"transactionclose",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(Yoe,{})})}),i.jsx(Mr,{path:"billhistoric",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(Foe,{})})}),i.jsx(Mr,{path:"users",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(koe,{})})}),i.jsx(Mr,{path:"products",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(joe,{})})}),i.jsx(Mr,{path:"datacenter",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(U1e,{})})}),i.jsx(Mr,{path:"productsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Hve,{})})}),i.jsx(Mr,{path:"mainordersCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(C1e,{})})}),i.jsx(Mr,{path:"inventoryMainOrderCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(_1e,{})})}),i.jsx(Mr,{path:"inventoryCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Xve,{})})}),i.jsx(Mr,{path:"billingsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(P1e,{})})}),i.jsx(Mr,{path:"customersCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Yve,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Mr,{path:"salesCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(s1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Mr,{path:"expensesCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(a1e,{})})}),i.jsx(Mr,{path:"dashboardCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(f1e,{})})}),i.jsx(Mr,{path:"transactionCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(c1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Mr,{path:"vendorsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(m1e,{})})}),i.jsx(Mr,{path:"productsVendorsCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(w1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Mr,{path:"cierreVentasCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(B1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Mr,{path:"reporteCierresCandies",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(D1e,{role:r,currentUserEmail:u,sellerCandyId:s})})}),i.jsx(Mr,{path:"consolidatedVendors",element:i.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(T1e,{})})}),i.jsx(Mr,{path:"salesClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(kle,{})})}),i.jsx(Mr,{path:"TransactionsReportClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Qle,{})})}),i.jsx(Mr,{path:"financialDashboardClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Ple,{})})}),i.jsx(Mr,{path:"ExpensesClothes",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(Rle,{})})}),i.jsx(Mr,{path:"inventoryClothesBatches",element:i.jsx(zr,{allowedRoles:["admin"],children:i.jsx(mle,{})})}),i.jsx(Mr,{path:"productsClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Ele,{})})}),i.jsx(Mr,{path:"CustomersClothes",element:i.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Sle,{})})})]}),i.jsx(Mr,{path:"/salesV2",element:i.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:i.jsx(Xj,{user:t})})}),i.jsx(Mr,{path:"*",element:i.jsx(Vd,{to:"/"})})]})})}wC.createRoot(document.getElementById("root")).render(i.jsx(ui.StrictMode,{children:i.jsx(M1e,{})}));export{Sn as _,V1e as c,Z7 as g};
