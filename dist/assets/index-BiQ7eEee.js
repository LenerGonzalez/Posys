var Kde=Object.defineProperty;var qde=(t,e,r)=>e in t?Kde(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Br=(t,e,r)=>qde(t,typeof e!="symbol"?e+"":e,r);function zde(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Rit=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var cW={exports:{}},JI={},uW={exports:{}},ca={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uw=Symbol.for("react.element"),Wde=Symbol.for("react.portal"),Xde=Symbol.for("react.fragment"),Yde=Symbol.for("react.strict_mode"),Jde=Symbol.for("react.profiler"),Zde=Symbol.for("react.provider"),efe=Symbol.for("react.context"),tfe=Symbol.for("react.forward_ref"),rfe=Symbol.for("react.suspense"),nfe=Symbol.for("react.memo"),afe=Symbol.for("react.lazy"),_L=Symbol.iterator;function sfe(t){return t===null||typeof t!="object"?null:(t=_L&&t[_L]||t["@@iterator"],typeof t=="function"?t:null)}var dW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fW=Object.assign,hW={};function Zv(t,e,r){this.props=t,this.context=e,this.refs=hW,this.updater=r||dW}Zv.prototype.isReactComponent={};Zv.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zv.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function AW(){}AW.prototype=Zv.prototype;function NO(t,e,r){this.props=t,this.context=e,this.refs=hW,this.updater=r||dW}var CO=NO.prototype=new AW;CO.constructor=NO;fW(CO,Zv.prototype);CO.isPureReactComponent=!0;var EL=Array.isArray,mW=Object.prototype.hasOwnProperty,_O={current:null},pW={key:!0,ref:!0,__self:!0,__source:!0};function gW(t,e,r){var n,a={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)mW.call(e,n)&&!pW.hasOwnProperty(n)&&(a[n]=e[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:uw,type:t,key:s,ref:o,props:a,_owner:_O.current}}function ife(t,e){return{$$typeof:uw,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function EO(t){return typeof t=="object"&&t!==null&&t.$$typeof===uw}function ofe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var SL=/\/+/g;function $3(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ofe(""+t.key):e.toString(36)}function M_(t,e,r,n,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case uw:case Wde:o=!0}}if(o)return o=t,a=a(o),t=n===""?"."+$3(o,0):n,EL(a)?(r="",t!=null&&(r=t.replace(SL,"$&/")+"/"),M_(a,e,r,"",function(u){return u})):a!=null&&(EO(a)&&(a=ife(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(SL,"$&/")+"/")+t)),e.push(a)),1;if(o=0,n=n===""?".":n+":",EL(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+$3(s,l);o+=M_(s,e,r,c,a)}else if(c=sfe(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+$3(s,l++),o+=M_(s,e,r,c,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ON(t,e,r){if(t==null)return t;var n=[],a=0;return M_(t,n,"","",function(s){return e.call(r,s,a++)}),n}function lfe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kc={current:null},L_={transition:null},cfe={ReactCurrentDispatcher:kc,ReactCurrentBatchConfig:L_,ReactCurrentOwner:_O};function xW(){throw Error("act(...) is not supported in production builds of React.")}ca.Children={map:ON,forEach:function(t,e,r){ON(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ON(t,function(){e++}),e},toArray:function(t){return ON(t,function(e){return e})||[]},only:function(t){if(!EO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ca.Component=Zv;ca.Fragment=Xde;ca.Profiler=Jde;ca.PureComponent=NO;ca.StrictMode=Yde;ca.Suspense=rfe;ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cfe;ca.act=xW;ca.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=fW({},t.props),a=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=_O.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)mW.call(e,c)&&!pW.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:uw,type:t.type,key:a,ref:s,props:n,_owner:o}};ca.createContext=function(t){return t={$$typeof:efe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Zde,_context:t},t.Consumer=t};ca.createElement=gW;ca.createFactory=function(t){var e=gW.bind(null,t);return e.type=t,e};ca.createRef=function(){return{current:null}};ca.forwardRef=function(t){return{$$typeof:tfe,render:t}};ca.isValidElement=EO;ca.lazy=function(t){return{$$typeof:afe,_payload:{_status:-1,_result:t},_init:lfe}};ca.memo=function(t,e){return{$$typeof:nfe,type:t,compare:e===void 0?null:e}};ca.startTransition=function(t){var e=L_.transition;L_.transition={};try{t()}finally{L_.transition=e}};ca.unstable_act=xW;ca.useCallback=function(t,e){return kc.current.useCallback(t,e)};ca.useContext=function(t){return kc.current.useContext(t)};ca.useDebugValue=function(){};ca.useDeferredValue=function(t){return kc.current.useDeferredValue(t)};ca.useEffect=function(t,e){return kc.current.useEffect(t,e)};ca.useId=function(){return kc.current.useId()};ca.useImperativeHandle=function(t,e,r){return kc.current.useImperativeHandle(t,e,r)};ca.useInsertionEffect=function(t,e){return kc.current.useInsertionEffect(t,e)};ca.useLayoutEffect=function(t,e){return kc.current.useLayoutEffect(t,e)};ca.useMemo=function(t,e){return kc.current.useMemo(t,e)};ca.useReducer=function(t,e,r){return kc.current.useReducer(t,e,r)};ca.useRef=function(t){return kc.current.useRef(t)};ca.useState=function(t){return kc.current.useState(t)};ca.useSyncExternalStore=function(t,e,r){return kc.current.useSyncExternalStore(t,e,r)};ca.useTransition=function(){return kc.current.useTransition()};ca.version="18.3.1";uW.exports=ca;var g=uW.exports;const Ui=jA(g),ufe=zde({__proto__:null,default:Ui},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dfe=g,ffe=Symbol.for("react.element"),hfe=Symbol.for("react.fragment"),Afe=Object.prototype.hasOwnProperty,mfe=dfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pfe={key:!0,ref:!0,__self:!0,__source:!0};function vW(t,e,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Afe.call(e,n)&&!pfe.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:ffe,type:t,key:s,ref:o,props:a,_owner:mfe.current}}JI.Fragment=hfe;JI.jsx=vW;JI.jsxs=vW;cW.exports=JI;var i=cW.exports,RB={},yW={exports:{}},Gu={},bW={exports:{}},wW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(me,se){var ke=me.length;me.push(se);e:for(;0<ke;){var Re=ke-1>>>1,F=me[Re];if(0<a(F,se))me[Re]=se,me[ke]=F,ke=Re;else break e}}function r(me){return me.length===0?null:me[0]}function n(me){if(me.length===0)return null;var se=me[0],ke=me.pop();if(ke!==se){me[0]=ke;e:for(var Re=0,F=me.length,H=F>>>1;Re<H;){var K=2*(Re+1)-1,L=me[K],W=K+1,Y=me[W];if(0>a(L,ke))W<F&&0>a(Y,L)?(me[Re]=Y,me[W]=ke,Re=W):(me[Re]=L,me[K]=ke,Re=K);else if(W<F&&0>a(Y,ke))me[Re]=Y,me[W]=ke,Re=W;else break e}}return se}function a(me,se){var ke=me.sortIndex-se.sortIndex;return ke!==0?ke:me.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,A=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(me){for(var se=r(u);se!==null;){if(se.callback===null)n(u);else if(se.startTime<=me)n(u),se.sortIndex=se.expirationTime,e(c,se);else break;se=r(u)}}function w(me){if(p=!1,b(me),!m)if(r(c)!==null)m=!0,de(j);else{var se=r(u);se!==null&&ue(w,se.startTime-me)}}function j(me,se){m=!1,p&&(p=!1,v(S),S=-1),h=!0;var ke=A;try{for(b(se),f=r(c);f!==null&&(!(f.expirationTime>se)||me&&!T());){var Re=f.callback;if(typeof Re=="function"){f.callback=null,A=f.priorityLevel;var F=Re(f.expirationTime<=se);se=t.unstable_now(),typeof F=="function"?f.callback=F:f===r(c)&&n(c),b(se)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var K=r(u);K!==null&&ue(w,K.startTime-se),H=!1}return H}finally{f=null,A=ke,h=!1}}var I=!1,_=null,S=-1,E=5,B=-1;function T(){return!(t.unstable_now()-B<E)}function P(){if(_!==null){var me=t.unstable_now();B=me;var se=!0;try{se=_(!0,me)}finally{se?O():(I=!1,_=null)}}else I=!1}var O;if(typeof y=="function")O=function(){y(P)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,ce=z.port2;z.port1.onmessage=P,O=function(){ce.postMessage(null)}}else O=function(){x(P,0)};function de(me){_=me,I||(I=!0,O())}function ue(me,se){S=x(function(){me(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(me){me.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,de(j))},t.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<me?Math.floor(1e3/me):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(me){switch(A){case 1:case 2:case 3:var se=3;break;default:se=A}var ke=A;A=se;try{return me()}finally{A=ke}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(me,se){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var ke=A;A=me;try{return se()}finally{A=ke}},t.unstable_scheduleCallback=function(me,se,ke){var Re=t.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?Re+ke:Re):ke=Re,me){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ke+F,me={id:d++,callback:se,priorityLevel:me,startTime:ke,expirationTime:F,sortIndex:-1},ke>Re?(me.sortIndex=ke,e(u,me),r(c)===null&&me===r(u)&&(p?(v(S),S=-1):p=!0,ue(w,ke-Re))):(me.sortIndex=F,e(c,me),m||h||(m=!0,de(j))),me},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(me){var se=A;return function(){var ke=A;A=se;try{return me.apply(this,arguments)}finally{A=ke}}}})(wW);bW.exports=wW;var gfe=bW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xfe=g,Uu=gfe;function Fr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NW=new Set,Vb={};function Sg(t,e){bv(t,e),bv(t+"Capture",e)}function bv(t,e){for(Vb[t]=e,t=0;t<e.length;t++)NW.add(e[t])}var dA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),MB=Object.prototype.hasOwnProperty,vfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,IL={},jL={};function yfe(t){return MB.call(jL,t)?!0:MB.call(IL,t)?!1:vfe.test(t)?jL[t]=!0:(IL[t]=!0,!1)}function bfe(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function wfe(t,e,r,n){if(e===null||typeof e>"u"||bfe(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fc(t,e,r,n,a,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Tl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tl[t]=new Fc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tl[e]=new Fc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tl[t]=new Fc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tl[t]=new Fc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tl[t]=new Fc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tl[t]=new Fc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tl[t]=new Fc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tl[t]=new Fc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tl[t]=new Fc(t,5,!1,t.toLowerCase(),null,!1,!1)});var SO=/[\-:]([a-z])/g;function IO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(SO,IO);Tl[e]=new Fc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(SO,IO);Tl[e]=new Fc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(SO,IO);Tl[e]=new Fc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tl[t]=new Fc(t,1,!1,t.toLowerCase(),null,!1,!1)});Tl.xlinkHref=new Fc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tl[t]=new Fc(t,1,!1,t.toLowerCase(),null,!0,!0)});function jO(t,e,r,n){var a=Tl.hasOwnProperty(e)?Tl[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(wfe(e,r,a,n)&&(r=null),n||a===null?yfe(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var PA=xfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,DN=Symbol.for("react.element"),Ox=Symbol.for("react.portal"),Dx=Symbol.for("react.fragment"),PO=Symbol.for("react.strict_mode"),LB=Symbol.for("react.profiler"),CW=Symbol.for("react.provider"),_W=Symbol.for("react.context"),BO=Symbol.for("react.forward_ref"),UB=Symbol.for("react.suspense"),QB=Symbol.for("react.suspense_list"),TO=Symbol.for("react.memo"),_0=Symbol.for("react.lazy"),EW=Symbol.for("react.offscreen"),PL=Symbol.iterator;function q1(t){return t===null||typeof t!="object"?null:(t=PL&&t[PL]||t["@@iterator"],typeof t=="function"?t:null)}var di=Object.assign,G3;function By(t){if(G3===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);G3=e&&e[1]||""}return`
`+G3+t}var K3=!1;function q3(t,e){if(!t||K3)return"";K3=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{K3=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?By(t):""}function Nfe(t){switch(t.tag){case 5:return By(t.type);case 16:return By("Lazy");case 13:return By("Suspense");case 19:return By("SuspenseList");case 0:case 2:case 15:return t=q3(t.type,!1),t;case 11:return t=q3(t.type.render,!1),t;case 1:return t=q3(t.type,!0),t;default:return""}}function VB(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Dx:return"Fragment";case Ox:return"Portal";case LB:return"Profiler";case PO:return"StrictMode";case UB:return"Suspense";case QB:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _W:return(t.displayName||"Context")+".Consumer";case CW:return(t._context.displayName||"Context")+".Provider";case BO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case TO:return e=t.displayName||null,e!==null?e:VB(t.type)||"Memo";case _0:e=t._payload,t=t._init;try{return VB(t(e))}catch{}}return null}function Cfe(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return VB(e);case 8:return e===PO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pm(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function SW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _fe(t){var e=SW(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function RN(t){t._valueTracker||(t._valueTracker=_fe(t))}function IW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=SW(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function SE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function HB(t,e){var r=e.checked;return di({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function BL(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=pm(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jW(t,e){e=e.checked,e!=null&&jO(t,"checked",e,!1)}function $B(t,e){jW(t,e);var r=pm(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?GB(t,e.type,r):e.hasOwnProperty("defaultValue")&&GB(t,e.type,pm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function TL(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function GB(t,e,r){(e!=="number"||SE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ty=Array.isArray;function nv(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+pm(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function KB(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Fr(91));return di({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kL(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Fr(92));if(Ty(r)){if(1<r.length)throw Error(Fr(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:pm(r)}}function PW(t,e){var r=pm(e.value),n=pm(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function FL(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function BW(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qB(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?BW(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var MN,TW=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(MN=MN||document.createElement("div"),MN.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=MN.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hb(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var nb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Efe=["Webkit","ms","Moz","O"];Object.keys(nb).forEach(function(t){Efe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nb[e]=nb[t]})});function kW(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||nb.hasOwnProperty(t)&&nb[t]?(""+e).trim():e+"px"}function FW(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=kW(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var Sfe=di({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zB(t,e){if(e){if(Sfe[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Fr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Fr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Fr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Fr(62))}}function WB(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var XB=null;function kO(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var YB=null,av=null,sv=null;function OL(t){if(t=hw(t)){if(typeof YB!="function")throw Error(Fr(280));var e=t.stateNode;e&&(e=nj(e),YB(t.stateNode,t.type,e))}}function OW(t){av?sv?sv.push(t):sv=[t]:av=t}function DW(){if(av){var t=av,e=sv;if(sv=av=null,OL(t),e)for(t=0;t<e.length;t++)OL(e[t])}}function RW(t,e){return t(e)}function MW(){}var z3=!1;function LW(t,e,r){if(z3)return t(e,r);z3=!0;try{return RW(t,e,r)}finally{z3=!1,(av!==null||sv!==null)&&(MW(),DW())}}function $b(t,e){var r=t.stateNode;if(r===null)return null;var n=nj(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Fr(231,e,typeof r));return r}var JB=!1;if(dA)try{var z1={};Object.defineProperty(z1,"passive",{get:function(){JB=!0}}),window.addEventListener("test",z1,z1),window.removeEventListener("test",z1,z1)}catch{JB=!1}function Ife(t,e,r,n,a,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var ab=!1,IE=null,jE=!1,ZB=null,jfe={onError:function(t){ab=!0,IE=t}};function Pfe(t,e,r,n,a,s,o,l,c){ab=!1,IE=null,Ife.apply(jfe,arguments)}function Bfe(t,e,r,n,a,s,o,l,c){if(Pfe.apply(this,arguments),ab){if(ab){var u=IE;ab=!1,IE=null}else throw Error(Fr(198));jE||(jE=!0,ZB=u)}}function Ig(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function UW(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function DL(t){if(Ig(t)!==t)throw Error(Fr(188))}function Tfe(t){var e=t.alternate;if(!e){if(e=Ig(t),e===null)throw Error(Fr(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return DL(a),t;if(s===n)return DL(a),e;s=s.sibling}throw Error(Fr(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(Fr(189))}}if(r.alternate!==n)throw Error(Fr(190))}if(r.tag!==3)throw Error(Fr(188));return r.stateNode.current===r?t:e}function QW(t){return t=Tfe(t),t!==null?VW(t):null}function VW(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=VW(t);if(e!==null)return e;t=t.sibling}return null}var HW=Uu.unstable_scheduleCallback,RL=Uu.unstable_cancelCallback,kfe=Uu.unstable_shouldYield,Ffe=Uu.unstable_requestPaint,Vi=Uu.unstable_now,Ofe=Uu.unstable_getCurrentPriorityLevel,FO=Uu.unstable_ImmediatePriority,$W=Uu.unstable_UserBlockingPriority,PE=Uu.unstable_NormalPriority,Dfe=Uu.unstable_LowPriority,GW=Uu.unstable_IdlePriority,ZI=null,rh=null;function Rfe(t){if(rh&&typeof rh.onCommitFiberRoot=="function")try{rh.onCommitFiberRoot(ZI,t,void 0,(t.current.flags&128)===128)}catch{}}var Af=Math.clz32?Math.clz32:Ufe,Mfe=Math.log,Lfe=Math.LN2;function Ufe(t){return t>>>=0,t===0?32:31-(Mfe(t)/Lfe|0)|0}var LN=64,UN=4194304;function ky(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function BE(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=ky(l):(s&=o,s!==0&&(n=ky(s)))}else o=r&~a,o!==0?n=ky(o):s!==0&&(n=ky(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Af(e),a=1<<r,n|=t[r],e&=~a;return n}function Qfe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vfe(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Af(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=Qfe(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function eT(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KW(){var t=LN;return LN<<=1,!(LN&4194240)&&(LN=64),t}function W3(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function dw(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Af(e),t[e]=r}function Hfe(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-Af(r),s=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~s}}function OO(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Af(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var ns=0;function qW(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var zW,DO,WW,XW,YW,tT=!1,QN=[],J0=null,Z0=null,em=null,Gb=new Map,Kb=new Map,B0=[],$fe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ML(t,e){switch(t){case"focusin":case"focusout":J0=null;break;case"dragenter":case"dragleave":Z0=null;break;case"mouseover":case"mouseout":em=null;break;case"pointerover":case"pointerout":Gb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kb.delete(e.pointerId)}}function W1(t,e,r,n,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},e!==null&&(e=hw(e),e!==null&&DO(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Gfe(t,e,r,n,a){switch(e){case"focusin":return J0=W1(J0,t,e,r,n,a),!0;case"dragenter":return Z0=W1(Z0,t,e,r,n,a),!0;case"mouseover":return em=W1(em,t,e,r,n,a),!0;case"pointerover":var s=a.pointerId;return Gb.set(s,W1(Gb.get(s)||null,t,e,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Kb.set(s,W1(Kb.get(s)||null,t,e,r,n,a)),!0}return!1}function JW(t){var e=yp(t.target);if(e!==null){var r=Ig(e);if(r!==null){if(e=r.tag,e===13){if(e=UW(r),e!==null){t.blockedOn=e,YW(t.priority,function(){WW(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function U_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=rT(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);XB=n,r.target.dispatchEvent(n),XB=null}else return e=hw(r),e!==null&&DO(e),t.blockedOn=r,!1;e.shift()}return!0}function LL(t,e,r){U_(t)&&r.delete(e)}function Kfe(){tT=!1,J0!==null&&U_(J0)&&(J0=null),Z0!==null&&U_(Z0)&&(Z0=null),em!==null&&U_(em)&&(em=null),Gb.forEach(LL),Kb.forEach(LL)}function X1(t,e){t.blockedOn===e&&(t.blockedOn=null,tT||(tT=!0,Uu.unstable_scheduleCallback(Uu.unstable_NormalPriority,Kfe)))}function qb(t){function e(a){return X1(a,t)}if(0<QN.length){X1(QN[0],t);for(var r=1;r<QN.length;r++){var n=QN[r];n.blockedOn===t&&(n.blockedOn=null)}}for(J0!==null&&X1(J0,t),Z0!==null&&X1(Z0,t),em!==null&&X1(em,t),Gb.forEach(e),Kb.forEach(e),r=0;r<B0.length;r++)n=B0[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<B0.length&&(r=B0[0],r.blockedOn===null);)JW(r),r.blockedOn===null&&B0.shift()}var iv=PA.ReactCurrentBatchConfig,TE=!0;function qfe(t,e,r,n){var a=ns,s=iv.transition;iv.transition=null;try{ns=1,RO(t,e,r,n)}finally{ns=a,iv.transition=s}}function zfe(t,e,r,n){var a=ns,s=iv.transition;iv.transition=null;try{ns=4,RO(t,e,r,n)}finally{ns=a,iv.transition=s}}function RO(t,e,r,n){if(TE){var a=rT(t,e,r,n);if(a===null)s4(t,e,n,kE,r),ML(t,n);else if(Gfe(a,t,e,r,n))n.stopPropagation();else if(ML(t,n),e&4&&-1<$fe.indexOf(t)){for(;a!==null;){var s=hw(a);if(s!==null&&zW(s),s=rT(t,e,r,n),s===null&&s4(t,e,n,kE,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else s4(t,e,n,null,r)}}var kE=null;function rT(t,e,r,n){if(kE=null,t=kO(n),t=yp(t),t!==null)if(e=Ig(t),e===null)t=null;else if(r=e.tag,r===13){if(t=UW(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return kE=t,null}function ZW(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ofe()){case FO:return 1;case $W:return 4;case PE:case Dfe:return 16;case GW:return 536870912;default:return 16}default:return 16}}var V0=null,MO=null,Q_=null;function eX(){if(Q_)return Q_;var t,e=MO,r=e.length,n,a="value"in V0?V0.value:V0.textContent,s=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===a[s-n];n++);return Q_=a.slice(t,1<n?1-n:void 0)}function V_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function VN(){return!0}function UL(){return!1}function Ku(t){function e(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?VN:UL,this.isPropagationStopped=UL,this}return di(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=VN)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=VN)},persist:function(){},isPersistent:VN}),e}var e1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LO=Ku(e1),fw=di({},e1,{view:0,detail:0}),Wfe=Ku(fw),X3,Y3,Y1,ej=di({},fw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:UO,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Y1&&(Y1&&t.type==="mousemove"?(X3=t.screenX-Y1.screenX,Y3=t.screenY-Y1.screenY):Y3=X3=0,Y1=t),X3)},movementY:function(t){return"movementY"in t?t.movementY:Y3}}),QL=Ku(ej),Xfe=di({},ej,{dataTransfer:0}),Yfe=Ku(Xfe),Jfe=di({},fw,{relatedTarget:0}),J3=Ku(Jfe),Zfe=di({},e1,{animationName:0,elapsedTime:0,pseudoElement:0}),ehe=Ku(Zfe),the=di({},e1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rhe=Ku(the),nhe=di({},e1,{data:0}),VL=Ku(nhe),ahe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},she={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ihe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ohe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ihe[t])?!!e[t]:!1}function UO(){return ohe}var lhe=di({},fw,{key:function(t){if(t.key){var e=ahe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=V_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?she[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:UO,charCode:function(t){return t.type==="keypress"?V_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?V_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),che=Ku(lhe),uhe=di({},ej,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),HL=Ku(uhe),dhe=di({},fw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:UO}),fhe=Ku(dhe),hhe=di({},e1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ahe=Ku(hhe),mhe=di({},ej,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),phe=Ku(mhe),ghe=[9,13,27,32],QO=dA&&"CompositionEvent"in window,sb=null;dA&&"documentMode"in document&&(sb=document.documentMode);var xhe=dA&&"TextEvent"in window&&!sb,tX=dA&&(!QO||sb&&8<sb&&11>=sb),$L=" ",GL=!1;function rX(t,e){switch(t){case"keyup":return ghe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nX(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Rx=!1;function vhe(t,e){switch(t){case"compositionend":return nX(e);case"keypress":return e.which!==32?null:(GL=!0,$L);case"textInput":return t=e.data,t===$L&&GL?null:t;default:return null}}function yhe(t,e){if(Rx)return t==="compositionend"||!QO&&rX(t,e)?(t=eX(),Q_=MO=V0=null,Rx=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tX&&e.locale!=="ko"?null:e.data;default:return null}}var bhe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KL(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bhe[t.type]:e==="textarea"}function aX(t,e,r,n){OW(n),e=FE(e,"onChange"),0<e.length&&(r=new LO("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ib=null,zb=null;function whe(t){mX(t,0)}function tj(t){var e=Ux(t);if(IW(e))return t}function Nhe(t,e){if(t==="change")return e}var sX=!1;if(dA){var Z3;if(dA){var e4="oninput"in document;if(!e4){var qL=document.createElement("div");qL.setAttribute("oninput","return;"),e4=typeof qL.oninput=="function"}Z3=e4}else Z3=!1;sX=Z3&&(!document.documentMode||9<document.documentMode)}function zL(){ib&&(ib.detachEvent("onpropertychange",iX),zb=ib=null)}function iX(t){if(t.propertyName==="value"&&tj(zb)){var e=[];aX(e,zb,t,kO(t)),LW(whe,e)}}function Che(t,e,r){t==="focusin"?(zL(),ib=e,zb=r,ib.attachEvent("onpropertychange",iX)):t==="focusout"&&zL()}function _he(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return tj(zb)}function Ehe(t,e){if(t==="click")return tj(e)}function She(t,e){if(t==="input"||t==="change")return tj(e)}function Ihe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yf=typeof Object.is=="function"?Object.is:Ihe;function Wb(t,e){if(yf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!MB.call(e,a)||!yf(t[a],e[a]))return!1}return!0}function WL(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function XL(t,e){var r=WL(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=WL(r)}}function oX(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oX(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function lX(){for(var t=window,e=SE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=SE(t.document)}return e}function VO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jhe(t){var e=lX(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&oX(r.ownerDocument.documentElement,r)){if(n!==null&&VO(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!t.extend&&s>n&&(a=n,n=s,s=a),a=XL(r,s);var o=XL(r,n);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Phe=dA&&"documentMode"in document&&11>=document.documentMode,Mx=null,nT=null,ob=null,aT=!1;function YL(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;aT||Mx==null||Mx!==SE(n)||(n=Mx,"selectionStart"in n&&VO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ob&&Wb(ob,n)||(ob=n,n=FE(nT,"onSelect"),0<n.length&&(e=new LO("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Mx)))}function HN(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Lx={animationend:HN("Animation","AnimationEnd"),animationiteration:HN("Animation","AnimationIteration"),animationstart:HN("Animation","AnimationStart"),transitionend:HN("Transition","TransitionEnd")},t4={},cX={};dA&&(cX=document.createElement("div").style,"AnimationEvent"in window||(delete Lx.animationend.animation,delete Lx.animationiteration.animation,delete Lx.animationstart.animation),"TransitionEvent"in window||delete Lx.transitionend.transition);function rj(t){if(t4[t])return t4[t];if(!Lx[t])return t;var e=Lx[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in cX)return t4[t]=e[r];return t}var uX=rj("animationend"),dX=rj("animationiteration"),fX=rj("animationstart"),hX=rj("transitionend"),AX=new Map,JL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fm(t,e){AX.set(t,e),Sg(e,[t])}for(var r4=0;r4<JL.length;r4++){var n4=JL[r4],Bhe=n4.toLowerCase(),The=n4[0].toUpperCase()+n4.slice(1);Fm(Bhe,"on"+The)}Fm(uX,"onAnimationEnd");Fm(dX,"onAnimationIteration");Fm(fX,"onAnimationStart");Fm("dblclick","onDoubleClick");Fm("focusin","onFocus");Fm("focusout","onBlur");Fm(hX,"onTransitionEnd");bv("onMouseEnter",["mouseout","mouseover"]);bv("onMouseLeave",["mouseout","mouseover"]);bv("onPointerEnter",["pointerout","pointerover"]);bv("onPointerLeave",["pointerout","pointerover"]);Sg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),khe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fy));function ZL(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Bfe(n,e,void 0,t),t.currentTarget=null}function mX(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;ZL(a,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;ZL(a,l,u),s=c}}}if(jE)throw t=ZB,jE=!1,ZB=null,t}function Es(t,e){var r=e[cT];r===void 0&&(r=e[cT]=new Set);var n=t+"__bubble";r.has(n)||(pX(e,t,2,!1),r.add(n))}function a4(t,e,r){var n=0;e&&(n|=4),pX(r,t,n,e)}var $N="_reactListening"+Math.random().toString(36).slice(2);function Xb(t){if(!t[$N]){t[$N]=!0,NW.forEach(function(r){r!=="selectionchange"&&(khe.has(r)||a4(r,!1,t),a4(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$N]||(e[$N]=!0,a4("selectionchange",!1,e))}}function pX(t,e,r,n){switch(ZW(e)){case 1:var a=qfe;break;case 4:a=zfe;break;default:a=RO}r=a.bind(null,e,r,t),a=void 0,!JB||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function s4(t,e,r,n,a){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=yp(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}LW(function(){var u=s,d=kO(r),f=[];e:{var A=AX.get(t);if(A!==void 0){var h=LO,m=t;switch(t){case"keypress":if(V_(r)===0)break e;case"keydown":case"keyup":h=che;break;case"focusin":m="focus",h=J3;break;case"focusout":m="blur",h=J3;break;case"beforeblur":case"afterblur":h=J3;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=QL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Yfe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=fhe;break;case uX:case dX:case fX:h=ehe;break;case hX:h=Ahe;break;case"scroll":h=Wfe;break;case"wheel":h=phe;break;case"copy":case"cut":case"paste":h=rhe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=HL}var p=(e&4)!==0,x=!p&&t==="scroll",v=p?A!==null?A+"Capture":null:A;p=[];for(var y=u,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=$b(y,v),w!=null&&p.push(Yb(y,w,b)))),x)break;y=y.return}0<p.length&&(A=new h(A,m,null,r,d),f.push({event:A,listeners:p}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",A&&r!==XB&&(m=r.relatedTarget||r.fromElement)&&(yp(m)||m[fA]))break e;if((h||A)&&(A=d.window===d?d:(A=d.ownerDocument)?A.defaultView||A.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?yp(m):null,m!==null&&(x=Ig(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(p=QL,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=HL,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=h==null?A:Ux(h),b=m==null?A:Ux(m),A=new p(w,y+"leave",h,r,d),A.target=x,A.relatedTarget=b,w=null,yp(d)===u&&(p=new p(v,y+"enter",m,r,d),p.target=b,p.relatedTarget=x,w=p),x=w,h&&m)t:{for(p=h,v=m,y=0,b=p;b;b=Yg(b))y++;for(b=0,w=v;w;w=Yg(w))b++;for(;0<y-b;)p=Yg(p),y--;for(;0<b-y;)v=Yg(v),b--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=Yg(p),v=Yg(v)}p=null}else p=null;h!==null&&eU(f,A,h,p,!1),m!==null&&x!==null&&eU(f,x,m,p,!0)}}e:{if(A=u?Ux(u):window,h=A.nodeName&&A.nodeName.toLowerCase(),h==="select"||h==="input"&&A.type==="file")var j=Nhe;else if(KL(A))if(sX)j=She;else{j=_he;var I=Che}else(h=A.nodeName)&&h.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(j=Ehe);if(j&&(j=j(t,u))){aX(f,j,r,d);break e}I&&I(t,A,u),t==="focusout"&&(I=A._wrapperState)&&I.controlled&&A.type==="number"&&GB(A,"number",A.value)}switch(I=u?Ux(u):window,t){case"focusin":(KL(I)||I.contentEditable==="true")&&(Mx=I,nT=u,ob=null);break;case"focusout":ob=nT=Mx=null;break;case"mousedown":aT=!0;break;case"contextmenu":case"mouseup":case"dragend":aT=!1,YL(f,r,d);break;case"selectionchange":if(Phe)break;case"keydown":case"keyup":YL(f,r,d)}var _;if(QO)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Rx?rX(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(tX&&r.locale!=="ko"&&(Rx||S!=="onCompositionStart"?S==="onCompositionEnd"&&Rx&&(_=eX()):(V0=d,MO="value"in V0?V0.value:V0.textContent,Rx=!0)),I=FE(u,S),0<I.length&&(S=new VL(S,t,null,r,d),f.push({event:S,listeners:I}),_?S.data=_:(_=nX(r),_!==null&&(S.data=_)))),(_=xhe?vhe(t,r):yhe(t,r))&&(u=FE(u,"onBeforeInput"),0<u.length&&(d=new VL("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=_))}mX(f,e)})}function Yb(t,e,r){return{instance:t,listener:e,currentTarget:r}}function FE(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=$b(t,r),s!=null&&n.unshift(Yb(t,s,a)),s=$b(t,e),s!=null&&n.push(Yb(t,s,a))),t=t.return}return n}function Yg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function eU(t,e,r,n,a){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=$b(r,s),c!=null&&o.unshift(Yb(r,c,l))):a||(c=$b(r,s),c!=null&&o.push(Yb(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Fhe=/\r\n?/g,Ohe=/\u0000|\uFFFD/g;function tU(t){return(typeof t=="string"?t:""+t).replace(Fhe,`
`).replace(Ohe,"")}function GN(t,e,r){if(e=tU(e),tU(t)!==e&&r)throw Error(Fr(425))}function OE(){}var sT=null,iT=null;function oT(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lT=typeof setTimeout=="function"?setTimeout:void 0,Dhe=typeof clearTimeout=="function"?clearTimeout:void 0,rU=typeof Promise=="function"?Promise:void 0,Rhe=typeof queueMicrotask=="function"?queueMicrotask:typeof rU<"u"?function(t){return rU.resolve(null).then(t).catch(Mhe)}:lT;function Mhe(t){setTimeout(function(){throw t})}function i4(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),qb(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);qb(e)}function tm(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nU(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var t1=Math.random().toString(36).slice(2),Kf="__reactFiber$"+t1,Jb="__reactProps$"+t1,fA="__reactContainer$"+t1,cT="__reactEvents$"+t1,Lhe="__reactListeners$"+t1,Uhe="__reactHandles$"+t1;function yp(t){var e=t[Kf];if(e)return e;for(var r=t.parentNode;r;){if(e=r[fA]||r[Kf]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=nU(t);t!==null;){if(r=t[Kf])return r;t=nU(t)}return e}t=r,r=t.parentNode}return null}function hw(t){return t=t[Kf]||t[fA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ux(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Fr(33))}function nj(t){return t[Jb]||null}var uT=[],Qx=-1;function Om(t){return{current:t}}function Ts(t){0>Qx||(t.current=uT[Qx],uT[Qx]=null,Qx--)}function bs(t,e){Qx++,uT[Qx]=t.current,t.current=e}var gm={},oc=Om(gm),nu=Om(!1),Wp=gm;function wv(t,e){var r=t.type.contextTypes;if(!r)return gm;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function au(t){return t=t.childContextTypes,t!=null}function DE(){Ts(nu),Ts(oc)}function aU(t,e,r){if(oc.current!==gm)throw Error(Fr(168));bs(oc,e),bs(nu,r)}function gX(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(Fr(108,Cfe(t)||"Unknown",a));return di({},r,n)}function RE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gm,Wp=oc.current,bs(oc,t),bs(nu,nu.current),!0}function sU(t,e,r){var n=t.stateNode;if(!n)throw Error(Fr(169));r?(t=gX(t,e,Wp),n.__reactInternalMemoizedMergedChildContext=t,Ts(nu),Ts(oc),bs(oc,t)):Ts(nu),bs(nu,r)}var Lh=null,aj=!1,o4=!1;function xX(t){Lh===null?Lh=[t]:Lh.push(t)}function Qhe(t){aj=!0,xX(t)}function Dm(){if(!o4&&Lh!==null){o4=!0;var t=0,e=ns;try{var r=Lh;for(ns=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Lh=null,aj=!1}catch(a){throw Lh!==null&&(Lh=Lh.slice(t+1)),HW(FO,Dm),a}finally{ns=e,o4=!1}}return null}var Vx=[],Hx=0,ME=null,LE=0,xd=[],vd=0,Xp=null,$h=1,Gh="";function ap(t,e){Vx[Hx++]=LE,Vx[Hx++]=ME,ME=t,LE=e}function vX(t,e,r){xd[vd++]=$h,xd[vd++]=Gh,xd[vd++]=Xp,Xp=t;var n=$h;t=Gh;var a=32-Af(n)-1;n&=~(1<<a),r+=1;var s=32-Af(e)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,$h=1<<32-Af(e)+a|r<<a|n,Gh=s+t}else $h=1<<s|r<<a|n,Gh=t}function HO(t){t.return!==null&&(ap(t,1),vX(t,1,0))}function $O(t){for(;t===ME;)ME=Vx[--Hx],Vx[Hx]=null,LE=Vx[--Hx],Vx[Hx]=null;for(;t===Xp;)Xp=xd[--vd],xd[vd]=null,Gh=xd[--vd],xd[vd]=null,$h=xd[--vd],xd[vd]=null}var Ru=null,ku=null,Qs=!1,sf=null;function yX(t,e){var r=bd(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function iU(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ru=t,ku=tm(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ru=t,ku=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Xp!==null?{id:$h,overflow:Gh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=bd(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ru=t,ku=null,!0):!1;default:return!1}}function dT(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fT(t){if(Qs){var e=ku;if(e){var r=e;if(!iU(t,e)){if(dT(t))throw Error(Fr(418));e=tm(r.nextSibling);var n=Ru;e&&iU(t,e)?yX(n,r):(t.flags=t.flags&-4097|2,Qs=!1,Ru=t)}}else{if(dT(t))throw Error(Fr(418));t.flags=t.flags&-4097|2,Qs=!1,Ru=t}}}function oU(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ru=t}function KN(t){if(t!==Ru)return!1;if(!Qs)return oU(t),Qs=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!oT(t.type,t.memoizedProps)),e&&(e=ku)){if(dT(t))throw bX(),Error(Fr(418));for(;e;)yX(t,e),e=tm(e.nextSibling)}if(oU(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Fr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ku=tm(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ku=null}}else ku=Ru?tm(t.stateNode.nextSibling):null;return!0}function bX(){for(var t=ku;t;)t=tm(t.nextSibling)}function Nv(){ku=Ru=null,Qs=!1}function GO(t){sf===null?sf=[t]:sf.push(t)}var Vhe=PA.ReactCurrentBatchConfig;function J1(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Fr(309));var n=r.stateNode}if(!n)throw Error(Fr(147,t));var a=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Fr(284));if(!r._owner)throw Error(Fr(290,t))}return t}function qN(t,e){throw t=Object.prototype.toString.call(e),Error(Fr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lU(t){var e=t._init;return e(t._payload)}function wX(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=sm(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=A4(b,v.mode,w),y.return=v,y):(y=a(y,b),y.return=v,y)}function c(v,y,b,w){var j=b.type;return j===Dx?d(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===_0&&lU(j)===y.type)?(w=a(y,b.props),w.ref=J1(v,y,b),w.return=v,w):(w=W_(b.type,b.key,b.props,null,v.mode,w),w.ref=J1(v,y,b),w.return=v,w)}function u(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=m4(b,v.mode,w),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function d(v,y,b,w,j){return y===null||y.tag!==7?(y=Tp(b,v.mode,w,j),y.return=v,y):(y=a(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=A4(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case DN:return b=W_(y.type,y.key,y.props,null,v.mode,b),b.ref=J1(v,null,y),b.return=v,b;case Ox:return y=m4(y,v.mode,b),y.return=v,y;case _0:var w=y._init;return f(v,w(y._payload),b)}if(Ty(y)||q1(y))return y=Tp(y,v.mode,b,null),y.return=v,y;qN(v,y)}return null}function A(v,y,b,w){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case DN:return b.key===j?c(v,y,b,w):null;case Ox:return b.key===j?u(v,y,b,w):null;case _0:return j=b._init,A(v,y,j(b._payload),w)}if(Ty(b)||q1(b))return j!==null?null:d(v,y,b,w,null);qN(v,b)}return null}function h(v,y,b,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case DN:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,j);case Ox:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,j);case _0:var I=w._init;return h(v,y,b,I(w._payload),j)}if(Ty(w)||q1(w))return v=v.get(b)||null,d(y,v,w,j,null);qN(y,w)}return null}function m(v,y,b,w){for(var j=null,I=null,_=y,S=y=0,E=null;_!==null&&S<b.length;S++){_.index>S?(E=_,_=null):E=_.sibling;var B=A(v,_,b[S],w);if(B===null){_===null&&(_=E);break}t&&_&&B.alternate===null&&e(v,_),y=s(B,y,S),I===null?j=B:I.sibling=B,I=B,_=E}if(S===b.length)return r(v,_),Qs&&ap(v,S),j;if(_===null){for(;S<b.length;S++)_=f(v,b[S],w),_!==null&&(y=s(_,y,S),I===null?j=_:I.sibling=_,I=_);return Qs&&ap(v,S),j}for(_=n(v,_);S<b.length;S++)E=h(_,v,S,b[S],w),E!==null&&(t&&E.alternate!==null&&_.delete(E.key===null?S:E.key),y=s(E,y,S),I===null?j=E:I.sibling=E,I=E);return t&&_.forEach(function(T){return e(v,T)}),Qs&&ap(v,S),j}function p(v,y,b,w){var j=q1(b);if(typeof j!="function")throw Error(Fr(150));if(b=j.call(b),b==null)throw Error(Fr(151));for(var I=j=null,_=y,S=y=0,E=null,B=b.next();_!==null&&!B.done;S++,B=b.next()){_.index>S?(E=_,_=null):E=_.sibling;var T=A(v,_,B.value,w);if(T===null){_===null&&(_=E);break}t&&_&&T.alternate===null&&e(v,_),y=s(T,y,S),I===null?j=T:I.sibling=T,I=T,_=E}if(B.done)return r(v,_),Qs&&ap(v,S),j;if(_===null){for(;!B.done;S++,B=b.next())B=f(v,B.value,w),B!==null&&(y=s(B,y,S),I===null?j=B:I.sibling=B,I=B);return Qs&&ap(v,S),j}for(_=n(v,_);!B.done;S++,B=b.next())B=h(_,v,S,B.value,w),B!==null&&(t&&B.alternate!==null&&_.delete(B.key===null?S:B.key),y=s(B,y,S),I===null?j=B:I.sibling=B,I=B);return t&&_.forEach(function(P){return e(v,P)}),Qs&&ap(v,S),j}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Dx&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case DN:e:{for(var j=b.key,I=y;I!==null;){if(I.key===j){if(j=b.type,j===Dx){if(I.tag===7){r(v,I.sibling),y=a(I,b.props.children),y.return=v,v=y;break e}}else if(I.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===_0&&lU(j)===I.type){r(v,I.sibling),y=a(I,b.props),y.ref=J1(v,I,b),y.return=v,v=y;break e}r(v,I);break}else e(v,I);I=I.sibling}b.type===Dx?(y=Tp(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=W_(b.type,b.key,b.props,null,v.mode,w),w.ref=J1(v,y,b),w.return=v,v=w)}return o(v);case Ox:e:{for(I=b.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=m4(b,v.mode,w),y.return=v,v=y}return o(v);case _0:return I=b._init,x(v,y,I(b._payload),w)}if(Ty(b))return m(v,y,b,w);if(q1(b))return p(v,y,b,w);qN(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=A4(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return x}var Cv=wX(!0),NX=wX(!1),UE=Om(null),QE=null,$x=null,KO=null;function qO(){KO=$x=QE=null}function zO(t){var e=UE.current;Ts(UE),t._currentValue=e}function hT(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ov(t,e){QE=t,KO=$x=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zc=!0),t.firstContext=null)}function Td(t){var e=t._currentValue;if(KO!==t)if(t={context:t,memoizedValue:e,next:null},$x===null){if(QE===null)throw Error(Fr(308));$x=t,QE.dependencies={lanes:0,firstContext:t}}else $x=$x.next=t;return e}var bp=null;function WO(t){bp===null?bp=[t]:bp.push(t)}function CX(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,WO(e)):(r.next=a.next,a.next=r),e.interleaved=r,hA(t,n)}function hA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var E0=!1;function XO(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _X(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function eA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function rm(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ca&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,hA(t,r)}return a=n.interleaved,a===null?(e.next=e,WO(n)):(e.next=a.next,a.next=e),n.interleaved=e,hA(t,r)}function H_(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,OO(t,r)}}function cU(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=e:s=s.next=e}else a=s=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function VE(t,e,r,n){var a=t.updateQueue;E0=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;o=0,d=u=c=null,l=s;do{var A=l.lane,h=l.eventTime;if((n&A)===A){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(A=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(h,f,A);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,A=typeof m=="function"?m.call(h,f,A):m,A==null)break e;f=di({},f,A);break e;case 2:E0=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=a.effects,A===null?a.effects=[l]:A.push(l))}else h={eventTime:h,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=A;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;A=l,l=A.next,A.next=null,a.lastBaseUpdate=A,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);Jp|=o,t.lanes=o,t.memoizedState=f}}function uU(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Fr(191,a));a.call(n)}}}var Aw={},nh=Om(Aw),Zb=Om(Aw),e2=Om(Aw);function wp(t){if(t===Aw)throw Error(Fr(174));return t}function YO(t,e){switch(bs(e2,e),bs(Zb,t),bs(nh,Aw),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qB(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qB(e,t)}Ts(nh),bs(nh,e)}function _v(){Ts(nh),Ts(Zb),Ts(e2)}function EX(t){wp(e2.current);var e=wp(nh.current),r=qB(e,t.type);e!==r&&(bs(Zb,t),bs(nh,r))}function JO(t){Zb.current===t&&(Ts(nh),Ts(Zb))}var ii=Om(0);function HE(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var l4=[];function ZO(){for(var t=0;t<l4.length;t++)l4[t]._workInProgressVersionPrimary=null;l4.length=0}var $_=PA.ReactCurrentDispatcher,c4=PA.ReactCurrentBatchConfig,Yp=0,ui=null,No=null,Yo=null,$E=!1,lb=!1,t2=0,Hhe=0;function Ml(){throw Error(Fr(321))}function eD(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!yf(t[r],e[r]))return!1;return!0}function tD(t,e,r,n,a,s){if(Yp=s,ui=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$_.current=t===null||t.memoizedState===null?qhe:zhe,t=r(n,a),lb){s=0;do{if(lb=!1,t2=0,25<=s)throw Error(Fr(301));s+=1,Yo=No=null,e.updateQueue=null,$_.current=Whe,t=r(n,a)}while(lb)}if($_.current=GE,e=No!==null&&No.next!==null,Yp=0,Yo=No=ui=null,$E=!1,e)throw Error(Fr(300));return t}function rD(){var t=t2!==0;return t2=0,t}function Gf(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yo===null?ui.memoizedState=Yo=t:Yo=Yo.next=t,Yo}function kd(){if(No===null){var t=ui.alternate;t=t!==null?t.memoizedState:null}else t=No.next;var e=Yo===null?ui.memoizedState:Yo.next;if(e!==null)Yo=e,No=t;else{if(t===null)throw Error(Fr(310));No=t,t={memoizedState:No.memoizedState,baseState:No.baseState,baseQueue:No.baseQueue,queue:No.queue,next:null},Yo===null?ui.memoizedState=Yo=t:Yo=Yo.next=t}return Yo}function r2(t,e){return typeof e=="function"?e(t):e}function u4(t){var e=kd(),r=e.queue;if(r===null)throw Error(Fr(311));r.lastRenderedReducer=t;var n=No,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((Yp&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,ui.lanes|=d,Jp|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,yf(n,e.memoizedState)||(Zc=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do s=a.lane,ui.lanes|=s,Jp|=s,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function d4(t){var e=kd(),r=e.queue;if(r===null)throw Error(Fr(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,s=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=t(s,o.action),o=o.next;while(o!==a);yf(s,e.memoizedState)||(Zc=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function SX(){}function IX(t,e){var r=ui,n=kd(),a=e(),s=!yf(n.memoizedState,a);if(s&&(n.memoizedState=a,Zc=!0),n=n.queue,nD(BX.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Yo!==null&&Yo.memoizedState.tag&1){if(r.flags|=2048,n2(9,PX.bind(null,r,n,a,e),void 0,null),tl===null)throw Error(Fr(349));Yp&30||jX(r,e,a)}return a}function jX(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ui.updateQueue,e===null?(e={lastEffect:null,stores:null},ui.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function PX(t,e,r,n){e.value=r,e.getSnapshot=n,TX(e)&&kX(t)}function BX(t,e,r){return r(function(){TX(e)&&kX(t)})}function TX(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!yf(t,r)}catch{return!0}}function kX(t){var e=hA(t,1);e!==null&&mf(e,t,1,-1)}function dU(t){var e=Gf();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r2,lastRenderedState:t},e.queue=t,t=t.dispatch=Khe.bind(null,ui,t),[e.memoizedState,t]}function n2(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ui.updateQueue,e===null?(e={lastEffect:null,stores:null},ui.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function FX(){return kd().memoizedState}function G_(t,e,r,n){var a=Gf();ui.flags|=t,a.memoizedState=n2(1|e,r,void 0,n===void 0?null:n)}function sj(t,e,r,n){var a=kd();n=n===void 0?null:n;var s=void 0;if(No!==null){var o=No.memoizedState;if(s=o.destroy,n!==null&&eD(n,o.deps)){a.memoizedState=n2(e,r,s,n);return}}ui.flags|=t,a.memoizedState=n2(1|e,r,s,n)}function fU(t,e){return G_(8390656,8,t,e)}function nD(t,e){return sj(2048,8,t,e)}function OX(t,e){return sj(4,2,t,e)}function DX(t,e){return sj(4,4,t,e)}function RX(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function MX(t,e,r){return r=r!=null?r.concat([t]):null,sj(4,4,RX.bind(null,e,t),r)}function aD(){}function LX(t,e){var r=kd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&eD(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function UX(t,e){var r=kd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&eD(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function QX(t,e,r){return Yp&21?(yf(r,e)||(r=KW(),ui.lanes|=r,Jp|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zc=!0),t.memoizedState=r)}function $he(t,e){var r=ns;ns=r!==0&&4>r?r:4,t(!0);var n=c4.transition;c4.transition={};try{t(!1),e()}finally{ns=r,c4.transition=n}}function VX(){return kd().memoizedState}function Ghe(t,e,r){var n=am(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},HX(t))$X(e,r);else if(r=CX(t,e,r,n),r!==null){var a=Ic();mf(r,t,n,a),GX(r,e,n)}}function Khe(t,e,r){var n=am(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(HX(t))$X(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,yf(l,o)){var c=e.interleaved;c===null?(a.next=a,WO(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=CX(t,e,a,n),r!==null&&(a=Ic(),mf(r,t,n,a),GX(r,e,n))}}function HX(t){var e=t.alternate;return t===ui||e!==null&&e===ui}function $X(t,e){lb=$E=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function GX(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,OO(t,r)}}var GE={readContext:Td,useCallback:Ml,useContext:Ml,useEffect:Ml,useImperativeHandle:Ml,useInsertionEffect:Ml,useLayoutEffect:Ml,useMemo:Ml,useReducer:Ml,useRef:Ml,useState:Ml,useDebugValue:Ml,useDeferredValue:Ml,useTransition:Ml,useMutableSource:Ml,useSyncExternalStore:Ml,useId:Ml,unstable_isNewReconciler:!1},qhe={readContext:Td,useCallback:function(t,e){return Gf().memoizedState=[t,e===void 0?null:e],t},useContext:Td,useEffect:fU,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,G_(4194308,4,RX.bind(null,e,t),r)},useLayoutEffect:function(t,e){return G_(4194308,4,t,e)},useInsertionEffect:function(t,e){return G_(4,2,t,e)},useMemo:function(t,e){var r=Gf();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Gf();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Ghe.bind(null,ui,t),[n.memoizedState,t]},useRef:function(t){var e=Gf();return t={current:t},e.memoizedState=t},useState:dU,useDebugValue:aD,useDeferredValue:function(t){return Gf().memoizedState=t},useTransition:function(){var t=dU(!1),e=t[0];return t=$he.bind(null,t[1]),Gf().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ui,a=Gf();if(Qs){if(r===void 0)throw Error(Fr(407));r=r()}else{if(r=e(),tl===null)throw Error(Fr(349));Yp&30||jX(n,e,r)}a.memoizedState=r;var s={value:r,getSnapshot:e};return a.queue=s,fU(BX.bind(null,n,s,t),[t]),n.flags|=2048,n2(9,PX.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Gf(),e=tl.identifierPrefix;if(Qs){var r=Gh,n=$h;r=(n&~(1<<32-Af(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=t2++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Hhe++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zhe={readContext:Td,useCallback:LX,useContext:Td,useEffect:nD,useImperativeHandle:MX,useInsertionEffect:OX,useLayoutEffect:DX,useMemo:UX,useReducer:u4,useRef:FX,useState:function(){return u4(r2)},useDebugValue:aD,useDeferredValue:function(t){var e=kd();return QX(e,No.memoizedState,t)},useTransition:function(){var t=u4(r2)[0],e=kd().memoizedState;return[t,e]},useMutableSource:SX,useSyncExternalStore:IX,useId:VX,unstable_isNewReconciler:!1},Whe={readContext:Td,useCallback:LX,useContext:Td,useEffect:nD,useImperativeHandle:MX,useInsertionEffect:OX,useLayoutEffect:DX,useMemo:UX,useReducer:d4,useRef:FX,useState:function(){return d4(r2)},useDebugValue:aD,useDeferredValue:function(t){var e=kd();return No===null?e.memoizedState=t:QX(e,No.memoizedState,t)},useTransition:function(){var t=d4(r2)[0],e=kd().memoizedState;return[t,e]},useMutableSource:SX,useSyncExternalStore:IX,useId:VX,unstable_isNewReconciler:!1};function nf(t,e){if(t&&t.defaultProps){e=di({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function AT(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:di({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var ij={isMounted:function(t){return(t=t._reactInternals)?Ig(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ic(),a=am(t),s=eA(n,a);s.payload=e,r!=null&&(s.callback=r),e=rm(t,s,a),e!==null&&(mf(e,t,a,n),H_(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ic(),a=am(t),s=eA(n,a);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=rm(t,s,a),e!==null&&(mf(e,t,a,n),H_(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ic(),n=am(t),a=eA(r,n);a.tag=2,e!=null&&(a.callback=e),e=rm(t,a,n),e!==null&&(mf(e,t,n,r),H_(e,t,n))}};function hU(t,e,r,n,a,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Wb(r,n)||!Wb(a,s):!0}function KX(t,e,r){var n=!1,a=gm,s=e.contextType;return typeof s=="object"&&s!==null?s=Td(s):(a=au(e)?Wp:oc.current,n=e.contextTypes,s=(n=n!=null)?wv(t,a):gm),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ij,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function AU(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&ij.enqueueReplaceState(e,e.state,null)}function mT(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},XO(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=Td(s):(s=au(e)?Wp:oc.current,a.context=wv(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(AT(t,e,s,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&ij.enqueueReplaceState(a,a.state,null),VE(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Ev(t,e){try{var r="",n=e;do r+=Nfe(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function f4(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function pT(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Xhe=typeof WeakMap=="function"?WeakMap:Map;function qX(t,e,r){r=eA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){qE||(qE=!0,ET=n),pT(t,e)},r}function zX(t,e,r){r=eA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){pT(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){pT(t,e),typeof n!="function"&&(nm===null?nm=new Set([this]):nm.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function mU(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Xhe;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=uAe.bind(null,t,e,r),e.then(t,t))}function pU(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gU(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=eA(-1,1),e.tag=2,rm(r,e,1))),r.lanes|=1),t)}var Yhe=PA.ReactCurrentOwner,Zc=!1;function bc(t,e,r,n){e.child=t===null?NX(e,null,r,n):Cv(e,t.child,r,n)}function xU(t,e,r,n,a){r=r.render;var s=e.ref;return ov(e,a),n=tD(t,e,r,n,s,a),r=rD(),t!==null&&!Zc?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,AA(t,e,a)):(Qs&&r&&HO(e),e.flags|=1,bc(t,e,n,a),e.child)}function vU(t,e,r,n,a){if(t===null){var s=r.type;return typeof s=="function"&&!fD(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,WX(t,e,s,n,a)):(t=W_(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Wb,r(o,n)&&t.ref===e.ref)return AA(t,e,a)}return e.flags|=1,t=sm(s,n),t.ref=e.ref,t.return=e,e.child=t}function WX(t,e,r,n,a){if(t!==null){var s=t.memoizedProps;if(Wb(s,n)&&t.ref===e.ref)if(Zc=!1,e.pendingProps=n=s,(t.lanes&a)!==0)t.flags&131072&&(Zc=!0);else return e.lanes=t.lanes,AA(t,e,a)}return gT(t,e,r,n,a)}function XX(t,e,r){var n=e.pendingProps,a=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},bs(Kx,Eu),Eu|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,bs(Kx,Eu),Eu|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,bs(Kx,Eu),Eu|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,bs(Kx,Eu),Eu|=n;return bc(t,e,a,r),e.child}function YX(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function gT(t,e,r,n,a){var s=au(r)?Wp:oc.current;return s=wv(e,s),ov(e,a),r=tD(t,e,r,n,s,a),n=rD(),t!==null&&!Zc?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,AA(t,e,a)):(Qs&&n&&HO(e),e.flags|=1,bc(t,e,r,a),e.child)}function yU(t,e,r,n,a){if(au(r)){var s=!0;RE(e)}else s=!1;if(ov(e,a),e.stateNode===null)K_(t,e),KX(e,r,n),mT(e,r,n,a),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Td(u):(u=au(r)?Wp:oc.current,u=wv(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&AU(e,o,n,u),E0=!1;var A=e.memoizedState;o.state=A,VE(e,n,o,a),c=e.memoizedState,l!==n||A!==c||nu.current||E0?(typeof d=="function"&&(AT(e,r,d,n),c=e.memoizedState),(l=E0||hU(e,r,l,n,A,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,_X(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:nf(e.type,l),o.props=u,f=e.pendingProps,A=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Td(c):(c=au(r)?Wp:oc.current,c=wv(e,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||A!==c)&&AU(e,o,n,c),E0=!1,A=e.memoizedState,o.state=A,VE(e,n,o,a);var m=e.memoizedState;l!==f||A!==m||nu.current||E0?(typeof h=="function"&&(AT(e,r,h,n),m=e.memoizedState),(u=E0||hU(e,r,u,n,A,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),n=!1)}return xT(t,e,r,n,s,a)}function xT(t,e,r,n,a,s){YX(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return a&&sU(e,r,!1),AA(t,e,s);n=e.stateNode,Yhe.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Cv(e,t.child,null,s),e.child=Cv(e,null,l,s)):bc(t,e,l,s),e.memoizedState=n.state,a&&sU(e,r,!0),e.child}function JX(t){var e=t.stateNode;e.pendingContext?aU(t,e.pendingContext,e.pendingContext!==e.context):e.context&&aU(t,e.context,!1),YO(t,e.containerInfo)}function bU(t,e,r,n,a){return Nv(),GO(a),e.flags|=256,bc(t,e,r,n),e.child}var vT={dehydrated:null,treeContext:null,retryLane:0};function yT(t){return{baseLanes:t,cachePool:null,transitions:null}}function ZX(t,e,r){var n=e.pendingProps,a=ii.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),bs(ii,a&1),t===null)return fT(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cj(o,n,0,null),t=Tp(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=yT(r),e.memoizedState=vT,t):sD(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return Jhe(t,e,o,n,l,a,r);if(s){s=n.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=sm(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=sm(l,s):(s=Tp(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?yT(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=vT,n}return s=t.child,t=s.sibling,n=sm(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function sD(t,e){return e=cj({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zN(t,e,r,n){return n!==null&&GO(n),Cv(e,t.child,null,r),t=sD(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Jhe(t,e,r,n,a,s,o){if(r)return e.flags&256?(e.flags&=-257,n=f4(Error(Fr(422))),zN(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,a=e.mode,n=cj({mode:"visible",children:n.children},a,0,null),s=Tp(s,a,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Cv(e,t.child,null,o),e.child.memoizedState=yT(o),e.memoizedState=vT,s);if(!(e.mode&1))return zN(t,e,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Fr(419)),n=f4(s,n,void 0),zN(t,e,o,n)}if(l=(o&t.childLanes)!==0,Zc||l){if(n=tl,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,hA(t,a),mf(n,t,a,-1))}return dD(),n=f4(Error(Fr(421))),zN(t,e,o,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=dAe.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,ku=tm(a.nextSibling),Ru=e,Qs=!0,sf=null,t!==null&&(xd[vd++]=$h,xd[vd++]=Gh,xd[vd++]=Xp,$h=t.id,Gh=t.overflow,Xp=e),e=sD(e,n.children),e.flags|=4096,e)}function wU(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),hT(t.return,e,r)}function h4(t,e,r,n,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function eY(t,e,r){var n=e.pendingProps,a=n.revealOrder,s=n.tail;if(bc(t,e,n.children,r),n=ii.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wU(t,r,e);else if(t.tag===19)wU(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(bs(ii,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&HE(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),h4(e,!1,a,r,s);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&HE(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}h4(e,!0,r,null,s);break;case"together":h4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function K_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function AA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Jp|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Fr(153));if(e.child!==null){for(t=e.child,r=sm(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=sm(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Zhe(t,e,r){switch(e.tag){case 3:JX(e),Nv();break;case 5:EX(e);break;case 1:au(e.type)&&RE(e);break;case 4:YO(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;bs(UE,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(bs(ii,ii.current&1),e.flags|=128,null):r&e.child.childLanes?ZX(t,e,r):(bs(ii,ii.current&1),t=AA(t,e,r),t!==null?t.sibling:null);bs(ii,ii.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return eY(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),bs(ii,ii.current),n)break;return null;case 22:case 23:return e.lanes=0,XX(t,e,r)}return AA(t,e,r)}var tY,bT,rY,nY;tY=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};bT=function(){};rY=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,wp(nh.current);var s=null;switch(r){case"input":a=HB(t,a),n=HB(t,n),s=[];break;case"select":a=di({},a,{value:void 0}),n=di({},n,{value:void 0}),s=[];break;case"textarea":a=KB(t,a),n=KB(t,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=OE)}zB(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Vb.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Vb.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Es("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};nY=function(t,e,r,n){r!==n&&(e.flags|=4)};function Z1(t,e){if(!Qs)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ll(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function eAe(t,e,r){var n=e.pendingProps;switch($O(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ll(e),null;case 1:return au(e.type)&&DE(),Ll(e),null;case 3:return n=e.stateNode,_v(),Ts(nu),Ts(oc),ZO(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(KN(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sf!==null&&(jT(sf),sf=null))),bT(t,e),Ll(e),null;case 5:JO(e);var a=wp(e2.current);if(r=e.type,t!==null&&e.stateNode!=null)rY(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Fr(166));return Ll(e),null}if(t=wp(nh.current),KN(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Kf]=e,n[Jb]=s,t=(e.mode&1)!==0,r){case"dialog":Es("cancel",n),Es("close",n);break;case"iframe":case"object":case"embed":Es("load",n);break;case"video":case"audio":for(a=0;a<Fy.length;a++)Es(Fy[a],n);break;case"source":Es("error",n);break;case"img":case"image":case"link":Es("error",n),Es("load",n);break;case"details":Es("toggle",n);break;case"input":BL(n,s),Es("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Es("invalid",n);break;case"textarea":kL(n,s),Es("invalid",n)}zB(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&GN(n.textContent,l,t),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&GN(n.textContent,l,t),a=["children",""+l]):Vb.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Es("scroll",n)}switch(r){case"input":RN(n),TL(n,s,!0);break;case"textarea":RN(n),FL(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=OE)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=BW(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Kf]=e,t[Jb]=n,tY(t,e,!1,!1),e.stateNode=t;e:{switch(o=WB(r,n),r){case"dialog":Es("cancel",t),Es("close",t),a=n;break;case"iframe":case"object":case"embed":Es("load",t),a=n;break;case"video":case"audio":for(a=0;a<Fy.length;a++)Es(Fy[a],t);a=n;break;case"source":Es("error",t),a=n;break;case"img":case"image":case"link":Es("error",t),Es("load",t),a=n;break;case"details":Es("toggle",t),a=n;break;case"input":BL(t,n),a=HB(t,n),Es("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=di({},n,{value:void 0}),Es("invalid",t);break;case"textarea":kL(t,n),a=KB(t,n),Es("invalid",t);break;default:a=n}zB(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?FW(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&TW(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Hb(t,c):typeof c=="number"&&Hb(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Vb.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Es("scroll",t):c!=null&&jO(t,s,c,o))}switch(r){case"input":RN(t),TL(t,n,!1);break;case"textarea":RN(t),FL(t);break;case"option":n.value!=null&&t.setAttribute("value",""+pm(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?nv(t,!!n.multiple,s,!1):n.defaultValue!=null&&nv(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=OE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ll(e),null;case 6:if(t&&e.stateNode!=null)nY(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Fr(166));if(r=wp(e2.current),wp(nh.current),KN(e)){if(n=e.stateNode,r=e.memoizedProps,n[Kf]=e,(s=n.nodeValue!==r)&&(t=Ru,t!==null))switch(t.tag){case 3:GN(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&GN(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Kf]=e,e.stateNode=n}return Ll(e),null;case 13:if(Ts(ii),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qs&&ku!==null&&e.mode&1&&!(e.flags&128))bX(),Nv(),e.flags|=98560,s=!1;else if(s=KN(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Fr(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Fr(317));s[Kf]=e}else Nv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ll(e),s=!1}else sf!==null&&(jT(sf),sf=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ii.current&1?To===0&&(To=3):dD())),e.updateQueue!==null&&(e.flags|=4),Ll(e),null);case 4:return _v(),bT(t,e),t===null&&Xb(e.stateNode.containerInfo),Ll(e),null;case 10:return zO(e.type._context),Ll(e),null;case 17:return au(e.type)&&DE(),Ll(e),null;case 19:if(Ts(ii),s=e.memoizedState,s===null)return Ll(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)Z1(s,!1);else{if(To!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=HE(t),o!==null){for(e.flags|=128,Z1(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return bs(ii,ii.current&1|2),e.child}t=t.sibling}s.tail!==null&&Vi()>Sv&&(e.flags|=128,n=!0,Z1(s,!1),e.lanes=4194304)}else{if(!n)if(t=HE(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Z1(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Qs)return Ll(e),null}else 2*Vi()-s.renderingStartTime>Sv&&r!==1073741824&&(e.flags|=128,n=!0,Z1(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Vi(),e.sibling=null,r=ii.current,bs(ii,n?r&1|2:r&1),e):(Ll(e),null);case 22:case 23:return uD(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Eu&1073741824&&(Ll(e),e.subtreeFlags&6&&(e.flags|=8192)):Ll(e),null;case 24:return null;case 25:return null}throw Error(Fr(156,e.tag))}function tAe(t,e){switch($O(e),e.tag){case 1:return au(e.type)&&DE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _v(),Ts(nu),Ts(oc),ZO(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return JO(e),null;case 13:if(Ts(ii),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Fr(340));Nv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ts(ii),null;case 4:return _v(),null;case 10:return zO(e.type._context),null;case 22:case 23:return uD(),null;case 24:return null;default:return null}}var WN=!1,tc=!1,rAe=typeof WeakSet=="function"?WeakSet:Set,an=null;function Gx(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ci(t,e,n)}else r.current=null}function wT(t,e,r){try{r()}catch(n){Ci(t,e,n)}}var NU=!1;function nAe(t,e){if(sT=TE,t=lX(),VO(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=t,A=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)A=f,f=h;for(;;){if(f===t)break t;if(A===r&&++u===a&&(l=o),A===s&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=A,A=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(iT={focusedElem:t,selectionRange:r},TE=!1,an=e;an!==null;)if(e=an,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,an=t;else for(;an!==null;){e=an;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:nf(e.type,p),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Fr(163))}}catch(w){Ci(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,an=t;break}an=e.return}return m=NU,NU=!1,m}function cb(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&wT(e,r,s)}a=a.next}while(a!==n)}}function oj(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function NT(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function aY(t){var e=t.alternate;e!==null&&(t.alternate=null,aY(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Kf],delete e[Jb],delete e[cT],delete e[Lhe],delete e[Uhe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sY(t){return t.tag===5||t.tag===3||t.tag===4}function CU(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||sY(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function CT(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=OE));else if(n!==4&&(t=t.child,t!==null))for(CT(t,e,r),t=t.sibling;t!==null;)CT(t,e,r),t=t.sibling}function _T(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(_T(t,e,r),t=t.sibling;t!==null;)_T(t,e,r),t=t.sibling}var yl=null,af=!1;function i0(t,e,r){for(r=r.child;r!==null;)iY(t,e,r),r=r.sibling}function iY(t,e,r){if(rh&&typeof rh.onCommitFiberUnmount=="function")try{rh.onCommitFiberUnmount(ZI,r)}catch{}switch(r.tag){case 5:tc||Gx(r,e);case 6:var n=yl,a=af;yl=null,i0(t,e,r),yl=n,af=a,yl!==null&&(af?(t=yl,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):yl.removeChild(r.stateNode));break;case 18:yl!==null&&(af?(t=yl,r=r.stateNode,t.nodeType===8?i4(t.parentNode,r):t.nodeType===1&&i4(t,r),qb(t)):i4(yl,r.stateNode));break;case 4:n=yl,a=af,yl=r.stateNode.containerInfo,af=!0,i0(t,e,r),yl=n,af=a;break;case 0:case 11:case 14:case 15:if(!tc&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&wT(r,e,o),a=a.next}while(a!==n)}i0(t,e,r);break;case 1:if(!tc&&(Gx(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ci(r,e,l)}i0(t,e,r);break;case 21:i0(t,e,r);break;case 22:r.mode&1?(tc=(n=tc)||r.memoizedState!==null,i0(t,e,r),tc=n):i0(t,e,r);break;default:i0(t,e,r)}}function _U(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new rAe),e.forEach(function(n){var a=fAe.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function zd(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:yl=l.stateNode,af=!1;break e;case 3:yl=l.stateNode.containerInfo,af=!0;break e;case 4:yl=l.stateNode.containerInfo,af=!0;break e}l=l.return}if(yl===null)throw Error(Fr(160));iY(s,o,a),yl=null,af=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Ci(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oY(e,t),e=e.sibling}function oY(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zd(e,t),Of(t),n&4){try{cb(3,t,t.return),oj(3,t)}catch(p){Ci(t,t.return,p)}try{cb(5,t,t.return)}catch(p){Ci(t,t.return,p)}}break;case 1:zd(e,t),Of(t),n&512&&r!==null&&Gx(r,r.return);break;case 5:if(zd(e,t),Of(t),n&512&&r!==null&&Gx(r,r.return),t.flags&32){var a=t.stateNode;try{Hb(a,"")}catch(p){Ci(t,t.return,p)}}if(n&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&jW(a,s),WB(l,o);var u=WB(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?FW(a,f):d==="dangerouslySetInnerHTML"?TW(a,f):d==="children"?Hb(a,f):jO(a,d,f,u)}switch(l){case"input":$B(a,s);break;case"textarea":PW(a,s);break;case"select":var A=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?nv(a,!!s.multiple,h,!1):A!==!!s.multiple&&(s.defaultValue!=null?nv(a,!!s.multiple,s.defaultValue,!0):nv(a,!!s.multiple,s.multiple?[]:"",!1))}a[Jb]=s}catch(p){Ci(t,t.return,p)}}break;case 6:if(zd(e,t),Of(t),n&4){if(t.stateNode===null)throw Error(Fr(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(p){Ci(t,t.return,p)}}break;case 3:if(zd(e,t),Of(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qb(e.containerInfo)}catch(p){Ci(t,t.return,p)}break;case 4:zd(e,t),Of(t);break;case 13:zd(e,t),Of(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(lD=Vi())),n&4&&_U(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(tc=(u=tc)||d,zd(e,t),tc=u):zd(e,t),Of(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(an=t,d=t.child;d!==null;){for(f=an=d;an!==null;){switch(A=an,h=A.child,A.tag){case 0:case 11:case 14:case 15:cb(4,A,A.return);break;case 1:Gx(A,A.return);var m=A.stateNode;if(typeof m.componentWillUnmount=="function"){n=A,r=A.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Ci(n,r,p)}}break;case 5:Gx(A,A.return);break;case 22:if(A.memoizedState!==null){SU(f);continue}}h!==null?(h.return=A,an=h):SU(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=kW("display",o))}catch(p){Ci(t,t.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Ci(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:zd(e,t),Of(t),n&4&&_U(t);break;case 21:break;default:zd(e,t),Of(t)}}function Of(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(sY(r)){var n=r;break e}r=r.return}throw Error(Fr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Hb(a,""),n.flags&=-33);var s=CU(t);_T(t,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=CU(t);CT(t,l,o);break;default:throw Error(Fr(161))}}catch(c){Ci(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function aAe(t,e,r){an=t,lY(t)}function lY(t,e,r){for(var n=(t.mode&1)!==0;an!==null;){var a=an,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||WN;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||tc;l=WN;var u=tc;if(WN=o,(tc=c)&&!u)for(an=a;an!==null;)o=an,c=o.child,o.tag===22&&o.memoizedState!==null?IU(a):c!==null?(c.return=o,an=c):IU(a);for(;s!==null;)an=s,lY(s),s=s.sibling;an=a,WN=l,tc=u}EU(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,an=s):EU(t)}}function EU(t){for(;an!==null;){var e=an;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tc||oj(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!tc)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:nf(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&uU(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}uU(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&qb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Fr(163))}tc||e.flags&512&&NT(e)}catch(A){Ci(e,e.return,A)}}if(e===t){an=null;break}if(r=e.sibling,r!==null){r.return=e.return,an=r;break}an=e.return}}function SU(t){for(;an!==null;){var e=an;if(e===t){an=null;break}var r=e.sibling;if(r!==null){r.return=e.return,an=r;break}an=e.return}}function IU(t){for(;an!==null;){var e=an;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{oj(4,e)}catch(c){Ci(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(c){Ci(e,a,c)}}var s=e.return;try{NT(e)}catch(c){Ci(e,s,c)}break;case 5:var o=e.return;try{NT(e)}catch(c){Ci(e,o,c)}}}catch(c){Ci(e,e.return,c)}if(e===t){an=null;break}var l=e.sibling;if(l!==null){l.return=e.return,an=l;break}an=e.return}}var sAe=Math.ceil,KE=PA.ReactCurrentDispatcher,iD=PA.ReactCurrentOwner,Sd=PA.ReactCurrentBatchConfig,Ca=0,tl=null,io=null,Bl=0,Eu=0,Kx=Om(0),To=0,a2=null,Jp=0,lj=0,oD=0,ub=null,Yc=null,lD=0,Sv=1/0,Mh=null,qE=!1,ET=null,nm=null,XN=!1,H0=null,zE=0,db=0,ST=null,q_=-1,z_=0;function Ic(){return Ca&6?Vi():q_!==-1?q_:q_=Vi()}function am(t){return t.mode&1?Ca&2&&Bl!==0?Bl&-Bl:Vhe.transition!==null?(z_===0&&(z_=KW()),z_):(t=ns,t!==0||(t=window.event,t=t===void 0?16:ZW(t.type)),t):1}function mf(t,e,r,n){if(50<db)throw db=0,ST=null,Error(Fr(185));dw(t,r,n),(!(Ca&2)||t!==tl)&&(t===tl&&(!(Ca&2)&&(lj|=r),To===4&&T0(t,Bl)),su(t,n),r===1&&Ca===0&&!(e.mode&1)&&(Sv=Vi()+500,aj&&Dm()))}function su(t,e){var r=t.callbackNode;Vfe(t,e);var n=BE(t,t===tl?Bl:0);if(n===0)r!==null&&RL(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&RL(r),e===1)t.tag===0?Qhe(jU.bind(null,t)):xX(jU.bind(null,t)),Rhe(function(){!(Ca&6)&&Dm()}),r=null;else{switch(qW(n)){case 1:r=FO;break;case 4:r=$W;break;case 16:r=PE;break;case 536870912:r=GW;break;default:r=PE}r=pY(r,cY.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function cY(t,e){if(q_=-1,z_=0,Ca&6)throw Error(Fr(327));var r=t.callbackNode;if(lv()&&t.callbackNode!==r)return null;var n=BE(t,t===tl?Bl:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=WE(t,n);else{e=n;var a=Ca;Ca|=2;var s=dY();(tl!==t||Bl!==e)&&(Mh=null,Sv=Vi()+500,Bp(t,e));do try{lAe();break}catch(l){uY(t,l)}while(!0);qO(),KE.current=s,Ca=a,io!==null?e=0:(tl=null,Bl=0,e=To)}if(e!==0){if(e===2&&(a=eT(t),a!==0&&(n=a,e=IT(t,a))),e===1)throw r=a2,Bp(t,0),T0(t,n),su(t,Vi()),r;if(e===6)T0(t,n);else{if(a=t.current.alternate,!(n&30)&&!iAe(a)&&(e=WE(t,n),e===2&&(s=eT(t),s!==0&&(n=s,e=IT(t,s))),e===1))throw r=a2,Bp(t,0),T0(t,n),su(t,Vi()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(Fr(345));case 2:sp(t,Yc,Mh);break;case 3:if(T0(t,n),(n&130023424)===n&&(e=lD+500-Vi(),10<e)){if(BE(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Ic(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=lT(sp.bind(null,t,Yc,Mh),e);break}sp(t,Yc,Mh);break;case 4:if(T0(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var o=31-Af(n);s=1<<o,o=e[o],o>a&&(a=o),n&=~s}if(n=a,n=Vi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*sAe(n/1960))-n,10<n){t.timeoutHandle=lT(sp.bind(null,t,Yc,Mh),n);break}sp(t,Yc,Mh);break;case 5:sp(t,Yc,Mh);break;default:throw Error(Fr(329))}}}return su(t,Vi()),t.callbackNode===r?cY.bind(null,t):null}function IT(t,e){var r=ub;return t.current.memoizedState.isDehydrated&&(Bp(t,e).flags|=256),t=WE(t,e),t!==2&&(e=Yc,Yc=r,e!==null&&jT(e)),t}function jT(t){Yc===null?Yc=t:Yc.push.apply(Yc,t)}function iAe(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!yf(s(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function T0(t,e){for(e&=~oD,e&=~lj,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Af(e),n=1<<r;t[r]=-1,e&=~n}}function jU(t){if(Ca&6)throw Error(Fr(327));lv();var e=BE(t,0);if(!(e&1))return su(t,Vi()),null;var r=WE(t,e);if(t.tag!==0&&r===2){var n=eT(t);n!==0&&(e=n,r=IT(t,n))}if(r===1)throw r=a2,Bp(t,0),T0(t,e),su(t,Vi()),r;if(r===6)throw Error(Fr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,sp(t,Yc,Mh),su(t,Vi()),null}function cD(t,e){var r=Ca;Ca|=1;try{return t(e)}finally{Ca=r,Ca===0&&(Sv=Vi()+500,aj&&Dm())}}function Zp(t){H0!==null&&H0.tag===0&&!(Ca&6)&&lv();var e=Ca;Ca|=1;var r=Sd.transition,n=ns;try{if(Sd.transition=null,ns=1,t)return t()}finally{ns=n,Sd.transition=r,Ca=e,!(Ca&6)&&Dm()}}function uD(){Eu=Kx.current,Ts(Kx)}function Bp(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Dhe(r)),io!==null)for(r=io.return;r!==null;){var n=r;switch($O(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&DE();break;case 3:_v(),Ts(nu),Ts(oc),ZO();break;case 5:JO(n);break;case 4:_v();break;case 13:Ts(ii);break;case 19:Ts(ii);break;case 10:zO(n.type._context);break;case 22:case 23:uD()}r=r.return}if(tl=t,io=t=sm(t.current,null),Bl=Eu=e,To=0,a2=null,oD=lj=Jp=0,Yc=ub=null,bp!==null){for(e=0;e<bp.length;e++)if(r=bp[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}bp=null}return t}function uY(t,e){do{var r=io;try{if(qO(),$_.current=GE,$E){for(var n=ui.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}$E=!1}if(Yp=0,Yo=No=ui=null,lb=!1,t2=0,iD.current=null,r===null||r.return===null){To=1,a2=e,io=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=Bl,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var A=d.alternate;A?(d.updateQueue=A.updateQueue,d.memoizedState=A.memoizedState,d.lanes=A.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=pU(o);if(h!==null){h.flags&=-257,gU(h,o,l,s,e),h.mode&1&&mU(s,u,e),e=h,c=u;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){mU(s,u,e),dD();break e}c=Error(Fr(426))}}else if(Qs&&l.mode&1){var x=pU(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),gU(x,o,l,s,e),GO(Ev(c,l));break e}}s=c=Ev(c,l),To!==4&&(To=2),ub===null?ub=[s]:ub.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=qX(s,c,e);cU(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(nm===null||!nm.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=zX(s,l,e);cU(s,w);break e}}s=s.return}while(s!==null)}hY(r)}catch(j){e=j,io===r&&r!==null&&(io=r=r.return);continue}break}while(!0)}function dY(){var t=KE.current;return KE.current=GE,t===null?GE:t}function dD(){(To===0||To===3||To===2)&&(To=4),tl===null||!(Jp&268435455)&&!(lj&268435455)||T0(tl,Bl)}function WE(t,e){var r=Ca;Ca|=2;var n=dY();(tl!==t||Bl!==e)&&(Mh=null,Bp(t,e));do try{oAe();break}catch(a){uY(t,a)}while(!0);if(qO(),Ca=r,KE.current=n,io!==null)throw Error(Fr(261));return tl=null,Bl=0,To}function oAe(){for(;io!==null;)fY(io)}function lAe(){for(;io!==null&&!kfe();)fY(io)}function fY(t){var e=mY(t.alternate,t,Eu);t.memoizedProps=t.pendingProps,e===null?hY(t):io=e,iD.current=null}function hY(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=tAe(r,e),r!==null){r.flags&=32767,io=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{To=6,io=null;return}}else if(r=eAe(r,e,Eu),r!==null){io=r;return}if(e=e.sibling,e!==null){io=e;return}io=e=t}while(e!==null);To===0&&(To=5)}function sp(t,e,r){var n=ns,a=Sd.transition;try{Sd.transition=null,ns=1,cAe(t,e,r,n)}finally{Sd.transition=a,ns=n}return null}function cAe(t,e,r,n){do lv();while(H0!==null);if(Ca&6)throw Error(Fr(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Fr(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Hfe(t,s),t===tl&&(io=tl=null,Bl=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||XN||(XN=!0,pY(PE,function(){return lv(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Sd.transition,Sd.transition=null;var o=ns;ns=1;var l=Ca;Ca|=4,iD.current=null,nAe(t,r),oY(r,t),jhe(iT),TE=!!sT,iT=sT=null,t.current=r,aAe(r),Ffe(),Ca=l,ns=o,Sd.transition=s}else t.current=r;if(XN&&(XN=!1,H0=t,zE=a),s=t.pendingLanes,s===0&&(nm=null),Rfe(r.stateNode),su(t,Vi()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(qE)throw qE=!1,t=ET,ET=null,t;return zE&1&&t.tag!==0&&lv(),s=t.pendingLanes,s&1?t===ST?db++:(db=0,ST=t):db=0,Dm(),null}function lv(){if(H0!==null){var t=qW(zE),e=Sd.transition,r=ns;try{if(Sd.transition=null,ns=16>t?16:t,H0===null)var n=!1;else{if(t=H0,H0=null,zE=0,Ca&6)throw Error(Fr(331));var a=Ca;for(Ca|=4,an=t.current;an!==null;){var s=an,o=s.child;if(an.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(an=u;an!==null;){var d=an;switch(d.tag){case 0:case 11:case 15:cb(8,d,s)}var f=d.child;if(f!==null)f.return=d,an=f;else for(;an!==null;){d=an;var A=d.sibling,h=d.return;if(aY(d),d===u){an=null;break}if(A!==null){A.return=h,an=A;break}an=h}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}an=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,an=o;else e:for(;an!==null;){if(s=an,s.flags&2048)switch(s.tag){case 0:case 11:case 15:cb(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,an=v;break e}an=s.return}}var y=t.current;for(an=y;an!==null;){o=an;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,an=b;else e:for(o=y;an!==null;){if(l=an,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:oj(9,l)}}catch(j){Ci(l,l.return,j)}if(l===o){an=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,an=w;break e}an=l.return}}if(Ca=a,Dm(),rh&&typeof rh.onPostCommitFiberRoot=="function")try{rh.onPostCommitFiberRoot(ZI,t)}catch{}n=!0}return n}finally{ns=r,Sd.transition=e}}return!1}function PU(t,e,r){e=Ev(r,e),e=qX(t,e,1),t=rm(t,e,1),e=Ic(),t!==null&&(dw(t,1,e),su(t,e))}function Ci(t,e,r){if(t.tag===3)PU(t,t,r);else for(;e!==null;){if(e.tag===3){PU(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(nm===null||!nm.has(n))){t=Ev(r,t),t=zX(e,t,1),e=rm(e,t,1),t=Ic(),e!==null&&(dw(e,1,t),su(e,t));break}}e=e.return}}function uAe(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ic(),t.pingedLanes|=t.suspendedLanes&r,tl===t&&(Bl&r)===r&&(To===4||To===3&&(Bl&130023424)===Bl&&500>Vi()-lD?Bp(t,0):oD|=r),su(t,e)}function AY(t,e){e===0&&(t.mode&1?(e=UN,UN<<=1,!(UN&130023424)&&(UN=4194304)):e=1);var r=Ic();t=hA(t,e),t!==null&&(dw(t,e,r),su(t,r))}function dAe(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),AY(t,r)}function fAe(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Fr(314))}n!==null&&n.delete(e),AY(t,r)}var mY;mY=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||nu.current)Zc=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Zc=!1,Zhe(t,e,r);Zc=!!(t.flags&131072)}else Zc=!1,Qs&&e.flags&1048576&&vX(e,LE,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;K_(t,e),t=e.pendingProps;var a=wv(e,oc.current);ov(e,r),a=tD(null,e,n,t,a,r);var s=rD();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,au(n)?(s=!0,RE(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,XO(e),a.updater=ij,e.stateNode=a,a._reactInternals=e,mT(e,n,t,r),e=xT(null,e,n,!0,s,r)):(e.tag=0,Qs&&s&&HO(e),bc(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(K_(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=AAe(n),t=nf(n,t),a){case 0:e=gT(null,e,n,t,r);break e;case 1:e=yU(null,e,n,t,r);break e;case 11:e=xU(null,e,n,t,r);break e;case 14:e=vU(null,e,n,nf(n.type,t),r);break e}throw Error(Fr(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),gT(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),yU(t,e,n,a,r);case 3:e:{if(JX(e),t===null)throw Error(Fr(387));n=e.pendingProps,s=e.memoizedState,a=s.element,_X(t,e),VE(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=Ev(Error(Fr(423)),e),e=bU(t,e,n,r,a);break e}else if(n!==a){a=Ev(Error(Fr(424)),e),e=bU(t,e,n,r,a);break e}else for(ku=tm(e.stateNode.containerInfo.firstChild),Ru=e,Qs=!0,sf=null,r=NX(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Nv(),n===a){e=AA(t,e,r);break e}bc(t,e,n,r)}e=e.child}return e;case 5:return EX(e),t===null&&fT(e),n=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,o=a.children,oT(n,a)?o=null:s!==null&&oT(n,s)&&(e.flags|=32),YX(t,e),bc(t,e,o,r),e.child;case 6:return t===null&&fT(e),null;case 13:return ZX(t,e,r);case 4:return YO(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Cv(e,null,n,r):bc(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),xU(t,e,n,a,r);case 7:return bc(t,e,e.pendingProps,r),e.child;case 8:return bc(t,e,e.pendingProps.children,r),e.child;case 12:return bc(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,s=e.memoizedProps,o=a.value,bs(UE,n._currentValue),n._currentValue=o,s!==null)if(yf(s.value,o)){if(s.children===a.children&&!nu.current){e=AA(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=eA(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),hT(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Fr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),hT(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}bc(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,ov(e,r),a=Td(a),n=n(a),e.flags|=1,bc(t,e,n,r),e.child;case 14:return n=e.type,a=nf(n,e.pendingProps),a=nf(n.type,a),vU(t,e,n,a,r);case 15:return WX(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:nf(n,a),K_(t,e),e.tag=1,au(n)?(t=!0,RE(e)):t=!1,ov(e,r),KX(e,n,a),mT(e,n,a,r),xT(null,e,n,!0,t,r);case 19:return eY(t,e,r);case 22:return XX(t,e,r)}throw Error(Fr(156,e.tag))};function pY(t,e){return HW(t,e)}function hAe(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bd(t,e,r,n){return new hAe(t,e,r,n)}function fD(t){return t=t.prototype,!(!t||!t.isReactComponent)}function AAe(t){if(typeof t=="function")return fD(t)?1:0;if(t!=null){if(t=t.$$typeof,t===BO)return 11;if(t===TO)return 14}return 2}function sm(t,e){var r=t.alternate;return r===null?(r=bd(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function W_(t,e,r,n,a,s){var o=2;if(n=t,typeof t=="function")fD(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Dx:return Tp(r.children,a,s,e);case PO:o=8,a|=8;break;case LB:return t=bd(12,r,e,a|2),t.elementType=LB,t.lanes=s,t;case UB:return t=bd(13,r,e,a),t.elementType=UB,t.lanes=s,t;case QB:return t=bd(19,r,e,a),t.elementType=QB,t.lanes=s,t;case EW:return cj(r,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CW:o=10;break e;case _W:o=9;break e;case BO:o=11;break e;case TO:o=14;break e;case _0:o=16,n=null;break e}throw Error(Fr(130,t==null?t:typeof t,""))}return e=bd(o,r,e,a),e.elementType=t,e.type=n,e.lanes=s,e}function Tp(t,e,r,n){return t=bd(7,t,n,e),t.lanes=r,t}function cj(t,e,r,n){return t=bd(22,t,n,e),t.elementType=EW,t.lanes=r,t.stateNode={isHidden:!1},t}function A4(t,e,r){return t=bd(6,t,null,e),t.lanes=r,t}function m4(t,e,r){return e=bd(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mAe(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=W3(0),this.expirationTimes=W3(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=W3(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function hD(t,e,r,n,a,s,o,l,c){return t=new mAe(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=bd(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},XO(s),t}function pAe(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ox,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function gY(t){if(!t)return gm;t=t._reactInternals;e:{if(Ig(t)!==t||t.tag!==1)throw Error(Fr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(au(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Fr(171))}if(t.tag===1){var r=t.type;if(au(r))return gX(t,r,e)}return e}function xY(t,e,r,n,a,s,o,l,c){return t=hD(r,n,!0,t,a,s,o,l,c),t.context=gY(null),r=t.current,n=Ic(),a=am(r),s=eA(n,a),s.callback=e??null,rm(r,s,a),t.current.lanes=a,dw(t,a,n),su(t,n),t}function uj(t,e,r,n){var a=e.current,s=Ic(),o=am(a);return r=gY(r),e.context===null?e.context=r:e.pendingContext=r,e=eA(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=rm(a,e,o),t!==null&&(mf(t,a,o,s),H_(t,a,o)),o}function XE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function BU(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function AD(t,e){BU(t,e),(t=t.alternate)&&BU(t,e)}function gAe(){return null}var vY=typeof reportError=="function"?reportError:function(t){console.error(t)};function mD(t){this._internalRoot=t}dj.prototype.render=mD.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Fr(409));uj(t,e,null,null)};dj.prototype.unmount=mD.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zp(function(){uj(null,t,null,null)}),e[fA]=null}};function dj(t){this._internalRoot=t}dj.prototype.unstable_scheduleHydration=function(t){if(t){var e=XW();t={blockedOn:null,target:t,priority:e};for(var r=0;r<B0.length&&e!==0&&e<B0[r].priority;r++);B0.splice(r,0,t),r===0&&JW(t)}};function pD(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fj(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function TU(){}function xAe(t,e,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=XE(o);s.call(u)}}var o=xY(e,n,t,0,null,!1,!1,"",TU);return t._reactRootContainer=o,t[fA]=o.current,Xb(t.nodeType===8?t.parentNode:t),Zp(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=XE(c);l.call(u)}}var c=hD(t,0,!1,null,null,!1,!1,"",TU);return t._reactRootContainer=c,t[fA]=c.current,Xb(t.nodeType===8?t.parentNode:t),Zp(function(){uj(e,c,r,n)}),c}function hj(t,e,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=XE(o);l.call(c)}}uj(e,o,t,a)}else o=xAe(r,e,t,a,n);return XE(o)}zW=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ky(e.pendingLanes);r!==0&&(OO(e,r|1),su(e,Vi()),!(Ca&6)&&(Sv=Vi()+500,Dm()))}break;case 13:Zp(function(){var n=hA(t,1);if(n!==null){var a=Ic();mf(n,t,1,a)}}),AD(t,1)}};DO=function(t){if(t.tag===13){var e=hA(t,134217728);if(e!==null){var r=Ic();mf(e,t,134217728,r)}AD(t,134217728)}};WW=function(t){if(t.tag===13){var e=am(t),r=hA(t,e);if(r!==null){var n=Ic();mf(r,t,e,n)}AD(t,e)}};XW=function(){return ns};YW=function(t,e){var r=ns;try{return ns=t,e()}finally{ns=r}};YB=function(t,e,r){switch(e){case"input":if($B(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=nj(n);if(!a)throw Error(Fr(90));IW(n),$B(n,a)}}}break;case"textarea":PW(t,r);break;case"select":e=r.value,e!=null&&nv(t,!!r.multiple,e,!1)}};RW=cD;MW=Zp;var vAe={usingClientEntryPoint:!1,Events:[hw,Ux,nj,OW,DW,cD]},ey={findFiberByHostInstance:yp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yAe={bundleType:ey.bundleType,version:ey.version,rendererPackageName:ey.rendererPackageName,rendererConfig:ey.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:PA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=QW(t),t===null?null:t.stateNode},findFiberByHostInstance:ey.findFiberByHostInstance||gAe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var YN=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!YN.isDisabled&&YN.supportsFiber)try{ZI=YN.inject(yAe),rh=YN}catch{}}Gu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vAe;Gu.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pD(e))throw Error(Fr(200));return pAe(t,e,null,r)};Gu.createRoot=function(t,e){if(!pD(t))throw Error(Fr(299));var r=!1,n="",a=vY;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=hD(t,1,!1,null,null,r,!1,n,a),t[fA]=e.current,Xb(t.nodeType===8?t.parentNode:t),new mD(e)};Gu.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Fr(188)):(t=Object.keys(t).join(","),Error(Fr(268,t)));return t=QW(e),t=t===null?null:t.stateNode,t};Gu.flushSync=function(t){return Zp(t)};Gu.hydrate=function(t,e,r){if(!fj(e))throw Error(Fr(200));return hj(null,t,e,!0,r)};Gu.hydrateRoot=function(t,e,r){if(!pD(t))throw Error(Fr(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=vY;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=xY(e,null,t,1,r??null,a,!1,s,o),t[fA]=e.current,Xb(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new dj(e)};Gu.render=function(t,e,r){if(!fj(e))throw Error(Fr(200));return hj(null,t,e,!1,r)};Gu.unmountComponentAtNode=function(t){if(!fj(t))throw Error(Fr(40));return t._reactRootContainer?(Zp(function(){hj(null,null,t,!1,function(){t._reactRootContainer=null,t[fA]=null})}),!0):!1};Gu.unstable_batchedUpdates=cD;Gu.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!fj(r))throw Error(Fr(200));if(t==null||t._reactInternals===void 0)throw Error(Fr(38));return hj(t,e,r,!1,n)};Gu.version="18.3.1-next-f1338f8080-20240426";function yY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yY)}catch(t){console.error(t)}}yY(),yW.exports=Gu;var Mu=yW.exports,kU=Mu;RB.createRoot=kU.createRoot,RB.hydrateRoot=kU.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var FU="popstate";function bAe(t={}){function e(n,a){let{pathname:s,search:o,hash:l}=n.location;return PT("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:s2(a)}return NAe(e,r,null,t)}function qs(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function bf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function wAe(){return Math.random().toString(36).substring(2,10)}function OU(t,e){return{usr:t.state,key:t.key,idx:e}}function PT(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?r1(e):e,state:r,key:e&&e.key||n||wAe()}}function s2({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function r1(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function NAe(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let x=d(),v=x==null?null:x-u;u=x,c&&c({action:l,location:p.location,delta:v})}function A(x,v){l="PUSH";let y=PT(p.location,x,v);u=d()+1;let b=OU(y,u),w=p.createHref(y);try{o.pushState(b,"",w)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(w)}s&&c&&c({action:l,location:p.location,delta:1})}function h(x,v){l="REPLACE";let y=PT(p.location,x,v);u=d();let b=OU(y,u),w=p.createHref(y);o.replaceState(b,"",w),s&&c&&c({action:l,location:p.location,delta:0})}function m(x){return CAe(x)}let p={get action(){return l},get location(){return t(a,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(FU,f),c=x,()=>{a.removeEventListener(FU,f),c=null}},createHref(x){return e(a,x)},createURL:m,encodeLocation(x){let v=m(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:A,replace:h,go(x){return o.go(x)}};return p}function CAe(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),qs(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:s2(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function bY(t,e,r="/"){return _Ae(t,e,r,!1)}function _Ae(t,e,r,n){let a=typeof e=="string"?r1(e):e,s=mA(a.pathname||"/",r);if(s==null)return null;let o=wY(t);EAe(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=RAe(s);l=OAe(o[c],u,n)}return l}function wY(t,e=[],r=[],n="",a=!1){let s=(o,l,c=a,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;qs(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=tA([n,d.relativePath]),A=r.concat(d);o.children&&o.children.length>0&&(qs(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),wY(o.children,e,A,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:kAe(f,o.index),routesMeta:A})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let u of NY(o.path))s(o,l,!0,u)}),e}function NY(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=NY(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function EAe(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:FAe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var SAe=/^:[\w-]+$/,IAe=3,jAe=2,PAe=1,BAe=10,TAe=-2,DU=t=>t==="*";function kAe(t,e){let r=t.split("/"),n=r.length;return r.some(DU)&&(n+=TAe),e&&(n+=jAe),r.filter(a=>!DU(a)).reduce((a,s)=>a+(SAe.test(s)?IAe:s===""?PAe:BAe),n)}function FAe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function OAe(t,e,r=!1){let{routesMeta:n}=t,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=YE({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),A=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=YE({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:tA([s,f.pathname]),pathnameBase:QAe(tA([s,f.pathnameBase])),route:A}),f.pathnameBase!=="/"&&(s=tA([s,f.pathnameBase]))}return o}function YE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=DAe(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},A)=>{if(d==="*"){let m=l[A]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[A];return f&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function DAe(t,e=!1,r=!0){bf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function RAe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return bf(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function mA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function MAe(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?r1(t):t;return{pathname:r?r.startsWith("/")?r:LAe(r,e):e,search:VAe(n),hash:HAe(a)}}function LAe(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function p4(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function UAe(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function gD(t){let e=UAe(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function xD(t,e,r,n=!1){let a;typeof t=="string"?a=r1(t):(a={...t},qs(!a.pathname||!a.pathname.includes("?"),p4("?","pathname","search",a)),qs(!a.pathname||!a.pathname.includes("#"),p4("#","pathname","hash",a)),qs(!a.search||!a.search.includes("#"),p4("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let A=o.split("/");for(;A[0]==="..";)A.shift(),f-=1;a.pathname=A.join("/")}l=f>=0?e[f]:"/"}let c=MAe(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var tA=t=>t.join("/").replace(/\/\/+/g,"/"),QAe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VAe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,HAe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function $Ae(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var CY=["POST","PUT","PATCH","DELETE"];new Set(CY);var GAe=["GET",...CY];new Set(GAe);var n1=g.createContext(null);n1.displayName="DataRouter";var Aj=g.createContext(null);Aj.displayName="DataRouterState";g.createContext(!1);var _Y=g.createContext({isTransitioning:!1});_Y.displayName="ViewTransition";var KAe=g.createContext(new Map);KAe.displayName="Fetchers";var qAe=g.createContext(null);qAe.displayName="Await";var _f=g.createContext(null);_f.displayName="Navigation";var mw=g.createContext(null);mw.displayName="Location";var Ef=g.createContext({outlet:null,matches:[],isDataRoute:!1});Ef.displayName="Route";var vD=g.createContext(null);vD.displayName="RouteError";function zAe(t,{relative:e}={}){qs(a1(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=g.useContext(_f),{hash:a,pathname:s,search:o}=gw(t,{relative:e}),l=s;return r!=="/"&&(l=s==="/"?r:tA([r,s])),n.createHref({pathname:l,search:o,hash:a})}function a1(){return g.useContext(mw)!=null}function BA(){return qs(a1(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(mw).location}var EY="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function SY(t){g.useContext(_f).static||g.useLayoutEffect(t)}function pw(){let{isDataRoute:t}=g.useContext(Ef);return t?c0e():WAe()}function WAe(){qs(a1(),"useNavigate() may be used only in the context of a <Router> component.");let t=g.useContext(n1),{basename:e,navigator:r}=g.useContext(_f),{matches:n}=g.useContext(Ef),{pathname:a}=BA(),s=JSON.stringify(gD(n)),o=g.useRef(!1);return SY(()=>{o.current=!0}),g.useCallback((c,u={})=>{if(bf(o.current,EY),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=xD(c,JSON.parse(s),a,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:tA([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,s,a,t])}var XAe=g.createContext(null);function YAe(t){let e=g.useContext(Ef).outlet;return e&&g.createElement(XAe.Provider,{value:t},e)}function gw(t,{relative:e}={}){let{matches:r}=g.useContext(Ef),{pathname:n}=BA(),a=JSON.stringify(gD(r));return g.useMemo(()=>xD(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function JAe(t,e){return IY(t,e)}function IY(t,e,r,n){var v;qs(a1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(_f),{matches:s}=g.useContext(Ef),o=s[s.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let y=d&&d.path||"";jY(c,!d||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let f=BA(),A;if(e){let y=typeof e=="string"?r1(e):e;qs(u==="/"||((v=y.pathname)==null?void 0:v.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${y.pathname}" was given in the \`location\` prop.`),A=y}else A=f;let h=A.pathname||"/",m=h;if(u!=="/"){let y=u.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=bY(t,{pathname:m});bf(d||p!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),bf(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=n0e(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:tA([u,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:tA([u,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&x?g.createElement(mw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},x):x}function ZAe(){let t=l0e(),e=$Ae(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=g.createElement(g.Fragment,null,g.createElement("p",null," Hey developer "),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:s},"ErrorBoundary")," or"," ",g.createElement("code",{style:s},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),r?g.createElement("pre",{style:a},r):null,o)}var e0e=g.createElement(ZAe,null),t0e=class extends g.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?g.createElement(Ef.Provider,{value:this.props.routeContext},g.createElement(vD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function r0e({routeContext:t,match:e,children:r}){let n=g.useContext(n1);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(Ef.Provider,{value:t},r)}function n0e(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,s=r==null?void 0:r.errors;if(s!=null){let c=a.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);qs(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<a.length;c++){let u=a[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:f}=r,A=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||A){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,u,d)=>{let f,A=!1,h=null,m=null;r&&(f=s&&u.route.id?s[u.route.id]:void 0,h=u.route.errorElement||e0e,o&&(l<0&&d===0?(jY("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,m=null):l===d&&(A=!0,m=u.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,d+1)),x=()=>{let v;return f?v=h:A?v=m:u.route.Component?v=g.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=c,g.createElement(r0e,{match:u,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:v})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?g.createElement(t0e,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function yD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function a0e(t){let e=g.useContext(n1);return qs(e,yD(t)),e}function s0e(t){let e=g.useContext(Aj);return qs(e,yD(t)),e}function i0e(t){let e=g.useContext(Ef);return qs(e,yD(t)),e}function bD(t){let e=i0e(t),r=e.matches[e.matches.length-1];return qs(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function o0e(){return bD("useRouteId")}function l0e(){var n;let t=g.useContext(vD),e=s0e("useRouteError"),r=bD("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function c0e(){let{router:t}=a0e("useNavigate"),e=bD("useNavigate"),r=g.useRef(!1);return SY(()=>{r.current=!0}),g.useCallback(async(a,s={})=>{bf(r.current,EY),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var RU={};function jY(t,e,r){!e&&!RU[t]&&(RU[t]=!0,bf(!1,r))}g.memo(u0e);function u0e({routes:t,future:e,state:r}){return IY(t,void 0,r,e)}function Dh({to:t,replace:e,state:r,relative:n}){qs(a1(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(_f);bf(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=g.useContext(Ef),{pathname:o}=BA(),l=pw(),c=xD(t,gD(s),o,n==="path"),u=JSON.stringify(c);return g.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function PY(t){return YAe(t.context)}function Un(t){qs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function d0e({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){qs(!a1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=g.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof r=="string"&&(r=r1(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:A="default"}=r,h=g.useMemo(()=>{let m=mA(c,o);return m==null?null:{location:{pathname:m,search:u,hash:d,state:f,key:A},navigationType:n}},[o,c,u,d,f,A,n]);return bf(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:g.createElement(_f.Provider,{value:l},g.createElement(mw.Provider,{children:e,value:h}))}function f0e({children:t,location:e}){return JAe(BT(t),e)}function BT(t,e=[]){let r=[];return g.Children.forEach(t,(n,a)=>{if(!g.isValidElement(n))return;let s=[...e,a];if(n.type===g.Fragment){r.push.apply(r,BT(n.props.children,s));return}qs(n.type===Un,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),qs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=BT(n.props.children,s)),r.push(o)}),r}var X_="get",Y_="application/x-www-form-urlencoded";function mj(t){return t!=null&&typeof t.tagName=="string"}function h0e(t){return mj(t)&&t.tagName.toLowerCase()==="button"}function A0e(t){return mj(t)&&t.tagName.toLowerCase()==="form"}function m0e(t){return mj(t)&&t.tagName.toLowerCase()==="input"}function p0e(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function g0e(t,e){return t.button===0&&(!e||e==="_self")&&!p0e(t)}var JN=null;function x0e(){if(JN===null)try{new FormData(document.createElement("form"),0),JN=!1}catch{JN=!0}return JN}var v0e=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function g4(t){return t!=null&&!v0e.has(t)?(bf(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Y_}"`),null):t}function y0e(t,e){let r,n,a,s,o;if(A0e(t)){let l=t.getAttribute("action");n=l?mA(l,e):null,r=t.getAttribute("method")||X_,a=g4(t.getAttribute("enctype"))||Y_,s=new FormData(t)}else if(h0e(t)||m0e(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?mA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||X_,a=g4(t.getAttribute("formenctype"))||g4(l.getAttribute("enctype"))||Y_,s=new FormData(l,t),!x0e()){let{name:u,type:d,value:f}=t;if(d==="image"){let A=u?`${u}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else u&&s.append(u,f)}}else{if(mj(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=X_,n=null,a=Y_,o=t}return s&&a==="text/plain"&&(o=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function wD(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function b0e(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&mA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function w0e(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function N0e(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function C0e(t,e,r){let n=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await w0e(s,r);return o.links?o.links():[]}return[]}));return I0e(n.flat(1).filter(N0e).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function MU(t,e,r,n,a,s){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):s==="data"?e.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let A=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function _0e(t,e,{includeHydrateFallback:r}={}){return E0e(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function E0e(t){return[...new Set(t)]}function S0e(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function I0e(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let s=JSON.stringify(S0e(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function BY(){let t=g.useContext(n1);return wD(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function j0e(){let t=g.useContext(Aj);return wD(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var ND=g.createContext(void 0);ND.displayName="FrameworkContext";function TY(){let t=g.useContext(ND);return wD(t,"You must render this element inside a <HydratedRouter> element"),t}function P0e(t,e){let r=g.useContext(ND),[n,a]=g.useState(!1),[s,o]=g.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=e,A=g.useRef(null);g.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=v=>{v.forEach(y=>{o(y.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return A.current&&x.observe(A.current),()=>{x.disconnect()}}},[t]),g.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{a(!0)},m=()=>{a(!1),o(!1)};return r?t!=="intent"?[s,A,{}]:[s,A,{onFocus:ty(l,h),onBlur:ty(c,m),onMouseEnter:ty(u,h),onMouseLeave:ty(d,m),onTouchStart:ty(f,h)}]:[!1,A,{}]}function ty(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function B0e({page:t,...e}){let{router:r}=BY(),n=g.useMemo(()=>bY(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?g.createElement(k0e,{page:t,matches:n,...e}):null}function T0e(t){let{manifest:e,routeModules:r}=TY(),[n,a]=g.useState([]);return g.useEffect(()=>{let s=!1;return C0e(t,e,r).then(o=>{s||a(o)}),()=>{s=!0}},[t,e,r]),n}function k0e({page:t,matches:e,...r}){let n=BA(),{manifest:a,routeModules:s}=TY(),{basename:o}=BY(),{loaderData:l,matches:c}=j0e(),u=g.useMemo(()=>MU(t,e,c,a,n,"data"),[t,e,c,a,n]),d=g.useMemo(()=>MU(t,e,c,a,n,"assets"),[t,e,c,a,n]),f=g.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(v=>{var b;let y=a.routes[v.route.id];!y||!y.hasLoader||(!u.some(w=>w.route.id===v.route.id)&&v.route.id in l&&((b=s[v.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(v.route.id))}),m.size===0)return[];let x=b0e(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[x.pathname+x.search]},[o,l,n,a,u,e,t,s]),A=g.useMemo(()=>_0e(d,a),[d,a]),h=T0e(d);return g.createElement(g.Fragment,null,f.map(m=>g.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),A.map(m=>g.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>g.createElement("link",{key:m,nonce:r.nonce,...p})))}function F0e(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var kY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{kY&&(window.__reactRouterVersion="7.8.1")}catch{}function O0e({basename:t,children:e,window:r}){let n=g.useRef();n.current==null&&(n.current=bAe({window:r,v5Compat:!0}));let a=n.current,[s,o]=g.useState({action:a.action,location:a.location}),l=g.useCallback(c=>{g.startTransition(()=>o(c))},[o]);return g.useLayoutEffect(()=>a.listen(l),[a,l]),g.createElement(d0e,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var FY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,OY=g.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...A},h){let{basename:m}=g.useContext(_f),p=typeof u=="string"&&FY.test(u),x,v=!1;if(typeof u=="string"&&p&&(x=u,kY))try{let E=new URL(window.location.href),B=u.startsWith("//")?new URL(E.protocol+u):new URL(u),T=mA(B.pathname,m);B.origin===E.origin&&T!=null?u=T+B.search+B.hash:v=!0}catch{bf(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=zAe(u,{relative:a}),[b,w,j]=P0e(n,A),I=M0e(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:f});function _(E){e&&e(E),E.defaultPrevented||I(E)}let S=g.createElement("a",{...A,...j,href:x||y,onClick:v||s?e:_,ref:F0e(h,w),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?g.createElement(g.Fragment,null,S,g.createElement(B0e,{page:y})):S});OY.displayName="Link";var bn=g.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:o,viewTransition:l,children:c,...u},d){let f=gw(o,{relative:u.relative}),A=BA(),h=g.useContext(Aj),{navigator:m,basename:p}=g.useContext(_f),x=h!=null&&H0e(f)&&l===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=A.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=mA(b,p)||b);const w=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let j=y===v||!a&&y.startsWith(v)&&y.charAt(w)==="/",I=b!=null&&(b===v||!a&&b.startsWith(v)&&b.charAt(v.length)==="/"),_={isActive:j,isPending:I,isTransitioning:x},S=j?e:void 0,E;typeof n=="function"?E=n(_):E=[n,j?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let B=typeof s=="function"?s(_):s;return g.createElement(OY,{...u,"aria-current":S,className:E,ref:d,style:B,to:o,viewTransition:l},typeof c=="function"?c(_):c)});bn.displayName="NavLink";var D0e=g.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:s,method:o=X_,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...A},h)=>{let m=Q0e(),p=V0e(l,{relative:u}),x=o.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&FY.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let w=b.nativeEvent.submitter,j=(w==null?void 0:w.getAttribute("formmethod"))||o;m(w||b.currentTarget,{fetcherKey:e,method:j,navigate:r,replace:a,state:s,relative:u,preventScrollReset:d,viewTransition:f})};return g.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:y,...A,"data-discover":!v&&t==="render"?"true":void 0})});D0e.displayName="Form";function R0e(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DY(t){let e=g.useContext(n1);return qs(e,R0e(t)),e}function M0e(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:o}={}){let l=pw(),c=BA(),u=gw(t,{relative:s});return g.useCallback(d=>{if(g0e(d,e)){d.preventDefault();let f=r!==void 0?r:s2(c)===s2(u);l(t,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,u,r,n,e,t,a,s,o])}var L0e=0,U0e=()=>`__${String(++L0e)}__`;function Q0e(){let{router:t}=DY("useSubmit"),{basename:e}=g.useContext(_f),r=o0e();return g.useCallback(async(n,a={})=>{let{action:s,method:o,encType:l,formData:c,body:u}=y0e(n,e);if(a.navigate===!1){let d=a.fetcherKey||U0e();await t.fetch(d,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function V0e(t,{relative:e}={}){let{basename:r}=g.useContext(_f),n=g.useContext(Ef);qs(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...gw(t||".",{relative:e})},o=BA();if(t==null){s.search=o.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();s.search=d?`?${d}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:tA([r,s.pathname])),s2(s)}function H0e(t,{relative:e}={}){let r=g.useContext(_Y);qs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=DY("useViewTransitionState"),a=gw(t,{relative:e});if(!r.isTransitioning)return!1;let s=mA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=mA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return YE(a.pathname,o)!=null||YE(a.pathname,s)!=null}function En(t,e){if(!t)return!1;const r=String(e);if(Array.isArray(t))return t.map(String).includes(r);const n=String(t);return n===r||n==="vendedor"&&r==="vendedor_pollo"}var LU={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RY=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},$0e=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[r++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[r++],o=t[r++],l=t[r++],c=((a&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|o&63)}}return e.join("")},MY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const s=t[a],o=a+1<t.length,l=o?t[a+1]:0,c=a+2<t.length,u=c?t[a+2]:0,d=s>>2,f=(s&3)<<4|l>>4;let A=(l&15)<<2|u>>6,h=u&63;c||(h=64,o||(A=64)),n.push(r[d],r[f],r[A],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(RY(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$0e(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const s=r[t.charAt(a++)],l=a<t.length?r[t.charAt(a)]:0;++a;const u=a<t.length?r[t.charAt(a)]:64;++a;const f=a<t.length?r[t.charAt(a)]:64;if(++a,s==null||l==null||u==null||f==null)throw new G0e;const A=s<<2|l>>4;if(n.push(A),u!==64){const h=l<<4&240|u>>2;if(n.push(h),f!==64){const m=u<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class G0e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K0e=function(t){const e=RY(t);return MY.encodeByteArray(e,!0)},JE=function(t){return K0e(t).replace(/\./g,"")},LY=function(t){try{return MY.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0e=()=>q0e().__FIREBASE_DEFAULTS__,W0e=()=>{if(typeof process>"u"||typeof LU>"u")return;const t=LU.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},X0e=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&LY(t[1]);return e&&JSON.parse(e)},pj=()=>{try{return z0e()||W0e()||X0e()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},UY=t=>{var e,r;return(r=(e=pj())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Y0e=t=>{const e=UY(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},QY=()=>{var t;return(t=pj())===null||t===void 0?void 0:t.config},VY=t=>{var e;return(e=pj())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0e(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[JE(JSON.stringify(r)),JE(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fo())}function tme(){var t;const e=(t=pj())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rme(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ame(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sme(){const t=Fo();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function HY(){return!tme()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $Y(){try{return typeof indexedDB=="object"}catch{return!1}}function ime(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ome="FirebaseError";class TA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=ome,Object.setPrototypeOf(this,TA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xw.prototype.create)}}class xw{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],o=s?lme(s,n):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new TA(a,l,n)}}function lme(t,e){return t.replace(cme,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const cme=/\{\$([^}]+)}/g;function ume(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function i2(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const s=t[a],o=e[a];if(UU(s)&&UU(o)){if(!i2(s,o))return!1}else if(s!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function UU(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Oy(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,s]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(s)}}),e}function Dy(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function dme(t,e){const r=new fme(t,e);return r.subscribe.bind(r)}class fme{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");hme(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=x4),a.error===void 0&&(a.error=x4),a.complete===void 0&&(a.complete=x4);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function hme(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function x4(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(t){return t&&t._delegate?t._delegate:t}class eg{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ame=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new J0e;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pme(e))try{this.getOrInitializeService({instanceIdentifier:ip})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=ip){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ip){return this.instances.has(e)}getOptions(e=ip){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const o=this.instances.get(a);return o&&e(o,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:mme(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ip){return this.component?this.component.multipleInstances?e:ip:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function mme(t){return t===ip?void 0:t}function pme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gme{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Ame(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ha;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ha||(ha={}));const xme={debug:ha.DEBUG,verbose:ha.VERBOSE,info:ha.INFO,warn:ha.WARN,error:ha.ERROR,silent:ha.SILENT},vme=ha.INFO,yme={[ha.DEBUG]:"log",[ha.VERBOSE]:"log",[ha.INFO]:"info",[ha.WARN]:"warn",[ha.ERROR]:"error"},bme=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=yme[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let CD=class{constructor(e){this.name=e,this._logLevel=vme,this._logHandler=bme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ha))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ha.DEBUG,...e),this._logHandler(this,ha.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ha.VERBOSE,...e),this._logHandler(this,ha.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ha.INFO,...e),this._logHandler(this,ha.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ha.WARN,...e),this._logHandler(this,ha.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ha.ERROR,...e),this._logHandler(this,ha.ERROR,...e)}};const wme=(t,e)=>e.some(r=>t instanceof r);let QU,VU;function Nme(){return QU||(QU=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Cme(){return VU||(VU=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GY=new WeakMap,TT=new WeakMap,KY=new WeakMap,v4=new WeakMap,_D=new WeakMap;function _me(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{r(im(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&GY.set(r,t)}).catch(()=>{}),_D.set(e,t),e}function Eme(t){if(TT.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});TT.set(t,e)}let kT={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return TT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||KY.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return im(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Sme(t){kT=t(kT)}function Ime(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(y4(this),e,...r);return KY.set(n,e.sort?e.sort():[e]),im(n)}:Cme().includes(t)?function(...e){return t.apply(y4(this),e),im(GY.get(this))}:function(...e){return im(t.apply(y4(this),e))}}function jme(t){return typeof t=="function"?Ime(t):(t instanceof IDBTransaction&&Eme(t),wme(t,Nme())?new Proxy(t,kT):t)}function im(t){if(t instanceof IDBRequest)return _me(t);if(v4.has(t))return v4.get(t);const e=jme(t);return e!==t&&(v4.set(t,e),_D.set(e,t)),e}const y4=t=>_D.get(t);function Pme(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const o=indexedDB.open(t,e),l=im(o);return n&&o.addEventListener("upgradeneeded",c=>{n(im(o.result),c.oldVersion,c.newVersion,im(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Bme=["get","getKey","getAll","getAllKeys","count"],Tme=["put","add","delete","clear"],b4=new Map;function HU(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(b4.get(e))return b4.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=Tme.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||Bme.includes(r)))return;const s=async function(o,...l){const c=this.transaction(o,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),a&&c.done]))[0]};return b4.set(e,s),s}Sme(t=>({...t,get:(e,r,n)=>HU(e,r)||t.get(e,r,n),has:(e,r)=>!!HU(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Fme(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Fme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const FT="@firebase/app",$U="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=new CD("@firebase/app"),Ome="@firebase/app-compat",Dme="@firebase/analytics-compat",Rme="@firebase/analytics",Mme="@firebase/app-check-compat",Lme="@firebase/app-check",Ume="@firebase/auth",Qme="@firebase/auth-compat",Vme="@firebase/database",Hme="@firebase/data-connect",$me="@firebase/database-compat",Gme="@firebase/functions",Kme="@firebase/functions-compat",qme="@firebase/installations",zme="@firebase/installations-compat",Wme="@firebase/messaging",Xme="@firebase/messaging-compat",Yme="@firebase/performance",Jme="@firebase/performance-compat",Zme="@firebase/remote-config",epe="@firebase/remote-config-compat",tpe="@firebase/storage",rpe="@firebase/storage-compat",npe="@firebase/firestore",ape="@firebase/vertexai-preview",spe="@firebase/firestore-compat",ipe="firebase",ope="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="[DEFAULT]",lpe={[FT]:"fire-core",[Ome]:"fire-core-compat",[Rme]:"fire-analytics",[Dme]:"fire-analytics-compat",[Lme]:"fire-app-check",[Mme]:"fire-app-check-compat",[Ume]:"fire-auth",[Qme]:"fire-auth-compat",[Vme]:"fire-rtdb",[Hme]:"fire-data-connect",[$me]:"fire-rtdb-compat",[Gme]:"fire-fn",[Kme]:"fire-fn-compat",[qme]:"fire-iid",[zme]:"fire-iid-compat",[Wme]:"fire-fcm",[Xme]:"fire-fcm-compat",[Yme]:"fire-perf",[Jme]:"fire-perf-compat",[Zme]:"fire-rc",[epe]:"fire-rc-compat",[tpe]:"fire-gcs",[rpe]:"fire-gcs-compat",[npe]:"fire-fst",[spe]:"fire-fst-compat",[ape]:"fire-vertex","fire-js":"fire-js",[ipe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv=new Map,DT=new Map,RT=new Map;function GU(t,e){try{t.container.addComponent(e)}catch(r){pA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function jv(t){const e=t.name;if(RT.has(e))return pA.debug(`There were multiple attempts to register component ${e}.`),!1;RT.set(e,t);for(const r of Iv.values())GU(r,t);for(const r of DT.values())GU(r,t);return!0}function ED(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Wf(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cpe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},om=new xw("app","Firebase",cpe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class upe{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new eg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw om.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=ope;function SD(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:OT,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw om.create("bad-app-name",{appName:String(a)});if(r||(r=QY()),!r)throw om.create("no-options");const s=Iv.get(a);if(s){if(i2(r,s.options)&&i2(n,s.config))return s;throw om.create("duplicate-app",{appName:a})}const o=new gme(a);for(const c of RT.values())o.addComponent(c);const l=new upe(r,n,o);return Iv.set(a,l),l}function ID(t=OT){const e=Iv.get(t);if(!e&&t===OT&&QY())return SD();if(!e)throw om.create("no-app",{appName:t});return e}async function dpe(t){let e=!1;const r=t.name;Iv.has(r)?(e=!0,Iv.delete(r)):DT.has(r)&&t.decRefCount()<=0&&(DT.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function lm(t,e,r){var n;let a=(n=lpe[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const s=a.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${a}" with version "${e}":`];s&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pA.warn(l.join(" "));return}jv(new eg(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fpe="firebase-heartbeat-database",hpe=1,o2="firebase-heartbeat-store";let w4=null;function qY(){return w4||(w4=Pme(fpe,hpe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(o2)}catch(r){console.warn(r)}}}}).catch(t=>{throw om.create("idb-open",{originalErrorMessage:t.message})})),w4}async function Ape(t){try{const r=(await qY()).transaction(o2),n=await r.objectStore(o2).get(zY(t));return await r.done,n}catch(e){if(e instanceof TA)pA.warn(e.message);else{const r=om.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pA.warn(r.message)}}}async function KU(t,e){try{const n=(await qY()).transaction(o2,"readwrite");await n.objectStore(o2).put(e,zY(t)),await n.done}catch(r){if(r instanceof TA)pA.warn(r.message);else{const n=om.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});pA.warn(n.message)}}}function zY(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mpe=1024,ppe=30*24*60*60*1e3;class gpe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new vpe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=qU();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=ppe}),this._storage.overwrite(this._heartbeatsCache))}catch(n){pA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=qU(),{heartbeatsToSend:n,unsentEntries:a}=xpe(this._heartbeatsCache.heartbeats),s=JE(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return pA.warn(r),""}}}function qU(){return new Date().toISOString().substring(0,10)}function xpe(t,e=mpe){const r=[];let n=t.slice();for(const a of t){const s=r.find(o=>o.agent===a.agent);if(s){if(s.dates.push(a.date),zU(r)>e){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),zU(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class vpe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $Y()?ime().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ape(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return KU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return KU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function zU(t){return JE(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ype(t){jv(new eg("platform-logger",e=>new kme(e),"PRIVATE")),jv(new eg("heartbeat",e=>new gpe(e),"PRIVATE")),lm(FT,$U,t),lm(FT,$U,"esm2017"),lm("fire-js","")}ype("");function jD(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function WY(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bpe=WY,XY=new xw("auth","Firebase",WY());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE=new CD("@firebase/auth");function wpe(t,...e){ZE.logLevel<=ha.WARN&&ZE.warn(`Auth (${s1}): ${t}`,...e)}function J_(t,...e){ZE.logLevel<=ha.ERROR&&ZE.error(`Auth (${s1}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(t,...e){throw PD(t,...e)}function ah(t,...e){return PD(t,...e)}function YY(t,e,r){const n=Object.assign(Object.assign({},bpe()),{[e]:r});return new xw("auth","Firebase",n).create(e,{appName:t.name})}function rA(t){return YY(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function PD(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return XY.create(t,...e)}function Rn(t,e,...r){if(!t)throw PD(e,...r)}function Kh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw J_(e),new Error(e)}function gA(t,e){t||Kh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Npe(){return WU()==="http:"||WU()==="https:"}function WU(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cpe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Npe()||nme()||"connection"in navigator)?navigator.onLine:!0}function _pe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,r){this.shortDelay=e,this.longDelay=r,gA(r>e,"Short delay should be less than long delay!"),this.isMobile=eme()||ame()}get(){return Cpe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BD(t,e){gA(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JY{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Kh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Kh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Kh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Epe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Spe=new yw(3e4,6e4);function kA(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function FA(t,e,r,n,a={}){return ZY(t,a,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=vw(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return rme()||(u.referrerPolicy="no-referrer"),JY.fetch()(eJ(t,t.config.apiHost,r,l),u)})}async function ZY(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Epe),e);try{const a=new jpe(t),s=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw ZN(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ZN(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ZN(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw ZN(t,"user-disabled",o);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw YY(t,d,u);wf(t,d)}}catch(a){if(a instanceof TA)throw a;wf(t,"network-request-failed",{message:String(a)})}}async function bw(t,e,r,n,a={}){const s=await FA(t,e,r,n,a);return"mfaPendingCredential"in s&&wf(t,"multi-factor-auth-required",{_serverResponse:s}),s}function eJ(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?BD(t.config,a):`${t.config.apiScheme}://${a}`}function Ipe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jpe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ah(this.auth,"network-request-failed")),Spe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ZN(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=ah(t,e,n);return a.customData._tokenResponse=r,a}function XU(t){return t!==void 0&&t.enterprise!==void 0}class Ppe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Ipe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Bpe(t,e){return FA(t,"GET","/v2/recaptchaConfig",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tpe(t,e){return FA(t,"POST","/v1/accounts:delete",e)}async function tJ(t,e){return FA(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kpe(t,e=!1){const r=fi(t),n=await r.getIdToken(e),a=TD(n);Rn(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:fb(N4(a.auth_time)),issuedAtTime:fb(N4(a.iat)),expirationTime:fb(N4(a.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function N4(t){return Number(t)*1e3}function TD(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return J_("JWT malformed, contained fewer than 3 sections"),null;try{const a=LY(r);return a?JSON.parse(a):(J_("Failed to decode base64 JWT payload"),null)}catch(a){return J_("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function YU(t){const e=TD(t);return Rn(e,"internal-error"),Rn(typeof e.exp<"u","internal-error"),Rn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l2(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof TA&&Fpe(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Fpe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ope{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=fb(this.lastLoginAt),this.creationTime=fb(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eS(t){var e;const r=t.auth,n=await t.getIdToken(),a=await l2(t,tJ(r,{idToken:n}));Rn(a==null?void 0:a.users.length,r,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?rJ(s.providerUserInfo):[],l=Rpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new LT(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function Dpe(t){const e=fi(t);await eS(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Rpe(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function rJ(t){return t.map(e=>{var{providerId:r}=e,n=jD(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mpe(t,e){const r=await ZY(t,{},async()=>{const n=vw({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,o=eJ(t,a,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",JY.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Lpe(t,e){return FA(t,"POST","/v2/accounts:revokeToken",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rn(e.idToken,"internal-error"),Rn(typeof e.idToken<"u","internal-error"),Rn(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):YU(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Rn(e.length!==0,"internal-error");const r=YU(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Rn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:s}=await Mpe(e,r);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:s}=r,o=new cv;return n&&(Rn(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(Rn(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),s&&(Rn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cv,this.toJSON())}_performRefresh(){return Kh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(t,e){Rn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qh{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,s=jD(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ope(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new LT(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await l2(this,this.stsTokenManager.getToken(this.auth,e));return Rn(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return kpe(this,e)}reload(){return Dpe(this)}_assign(e){this!==e&&(Rn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new qh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Rn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await eS(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Wf(this.auth.app))return Promise.reject(rA(this.auth));const e=await this.getIdToken();return await l2(this,Tpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,s,o,l,c,u,d;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,A=(a=r.email)!==null&&a!==void 0?a:void 0,h=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=r.createdAt)!==null&&u!==void 0?u:void 0,y=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:b,emailVerified:w,isAnonymous:j,providerData:I,stsTokenManager:_}=r;Rn(b&&_,e,"internal-error");const S=cv.fromJSON(this.name,_);Rn(typeof b=="string",e,"internal-error"),o0(f,e.name),o0(A,e.name),Rn(typeof w=="boolean",e,"internal-error"),Rn(typeof j=="boolean",e,"internal-error"),o0(h,e.name),o0(m,e.name),o0(p,e.name),o0(x,e.name),o0(v,e.name),o0(y,e.name);const E=new qh({uid:b,auth:e,email:A,emailVerified:w,displayName:f,isAnonymous:j,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:v,lastLoginAt:y});return I&&Array.isArray(I)&&(E.providerData=I.map(B=>Object.assign({},B))),x&&(E._redirectEventId=x),E}static async _fromIdTokenResponse(e,r,n=!1){const a=new cv;a.updateFromServerResponse(r);const s=new qh({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await eS(s),s}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];Rn(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?rJ(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),l=new cv;l.updateFromIdToken(n);const c=new qh({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new LT(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JU=new Map;function zh(t){gA(t instanceof Function,"Expected a class definition");let e=JU.get(t);return e?(gA(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,JU.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}nJ.type="NONE";const ZU=nJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(t,e,r){return`firebase:${t}:${e}:${r}`}class uv{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=Z_(this.userKey,a.apiKey,s),this.fullPersistenceKey=Z_("persistence",a.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new uv(zh(ZU),e,n);const a=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=a[0]||zh(ZU);const o=Z_(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(o);if(d){const f=qh._fromJSON(e,d);u!==s&&(l=f),s=u;break}}catch{}const c=a.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new uv(s,e,n):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new uv(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e7(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(oJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cJ(e))return"Blackberry";if(uJ(e))return"Webos";if(sJ(e))return"Safari";if((e.includes("chrome/")||iJ(e))&&!e.includes("edge/"))return"Chrome";if(lJ(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function aJ(t=Fo()){return/firefox\//i.test(t)}function sJ(t=Fo()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iJ(t=Fo()){return/crios\//i.test(t)}function oJ(t=Fo()){return/iemobile/i.test(t)}function lJ(t=Fo()){return/android/i.test(t)}function cJ(t=Fo()){return/blackberry/i.test(t)}function uJ(t=Fo()){return/webos/i.test(t)}function kD(t=Fo()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Upe(t=Fo()){var e;return kD(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Qpe(){return sme()&&document.documentMode===10}function dJ(t=Fo()){return kD(t)||lJ(t)||uJ(t)||cJ(t)||/windows phone/i.test(t)||oJ(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fJ(t,e=[]){let r;switch(t){case"Browser":r=e7(Fo());break;case"Worker":r=`${e7(Fo())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${s1}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vpe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hpe(t,e={}){return FA(t,"GET","/v2/passwordPolicy",kA(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $pe=6;class Gpe{constructor(e){var r,n,a,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:$pe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(a=c.containsLowercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kpe{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new t7(this),this.idTokenSubscription=new t7(this),this.beforeStateQueue=new Vpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=zh(r)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await uv.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await tJ(this,{idToken:e}),n=await qh._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Wf(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=a==null?void 0:a._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(a=c.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Rn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await eS(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_pe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Wf(this.app))return Promise.reject(rA(this));const r=e?fi(e):null;return r&&Rn(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Rn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Wf(this.app)?Promise.reject(rA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Wf(this.app)?Promise.reject(rA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Hpe(this),r=new Gpe(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xw("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Lpe(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&zh(e)||this._popupRedirectResolver;Rn(r,this,"argument-error"),this.redirectPersistenceManager=await uv.create(this,[zh(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rn(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,a);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&wpe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Rm(t){return fi(t)}class t7{constructor(e){this.auth=e,this.observer=null,this.addObserver=dme(r=>this.observer=r)}get next(){return Rn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gj={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qpe(t){gj=t}function hJ(t){return gj.loadJS(t)}function zpe(){return gj.recaptchaEnterpriseScript}function Wpe(){return gj.gapiScript}function Xpe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const Ype="recaptcha-enterprise",Jpe="NO_RECAPTCHA";class Zpe{constructor(e){this.type=Ype,this.auth=Rm(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Bpe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Ppe(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function a(s,o,l){const c=window.grecaptcha;XU(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(Jpe)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{n(this.auth).then(l=>{if(!r&&XU(window.grecaptcha))a(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=zpe();c.length!==0&&(c+=l),hJ(c).then(()=>{a(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function r7(t,e,r,n=!1){const a=new Zpe(t);let s;try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function tS(t,e,r,n){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await r7(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await r7(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ege(t,e){const r=ED(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),s=r.getOptions();if(i2(s,e??{}))return a;wf(a,"already-initialized")}return r.initialize({options:e})}function tge(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(zh);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function rge(t,e,r){const n=Rm(t);Rn(n._canInitEmulator,n,"emulator-config-failed"),Rn(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=AJ(e),{host:o,port:l}=nge(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${s}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),age()}function AJ(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nge(t){const e=AJ(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:n7(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:n7(o)}}}function n7(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function age(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Kh("not implemented")}_getIdTokenResponse(e){return Kh("not implemented")}_linkToIdToken(e,r){return Kh("not implemented")}_getReauthenticationResolver(e){return Kh("not implemented")}}async function sge(t,e){return FA(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ige(t,e){return bw(t,"POST","/v1/accounts:signInWithPassword",kA(t,e))}async function oge(t,e){return FA(t,"POST","/v1/accounts:sendOobCode",kA(t,e))}async function lge(t,e){return oge(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cge(t,e){return bw(t,"POST","/v1/accounts:signInWithEmailLink",kA(t,e))}async function uge(t,e){return bw(t,"POST","/v1/accounts:signInWithEmailLink",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2 extends FD{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new c2(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new c2(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tS(e,r,"signInWithPassword",ige);case"emailLink":return cge(e,{email:this._email,oobCode:this._password});default:wf(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tS(e,n,"signUpPassword",sge);case"emailLink":return uge(e,{idToken:r,email:this._email,oobCode:this._password});default:wf(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dv(t,e){return bw(t,"POST","/v1/accounts:signInWithIdp",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dge="http://localhost";class tg extends FD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new tg(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):wf("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,s=jD(r,["providerId","signInMethod"]);if(!n||!a)return null;const o=new tg(n,a);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return dv(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,dv(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,dv(e,r)}buildRequest(){const e={requestUri:dge,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=vw(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function hge(t){const e=Oy(Dy(t)).link,r=e?Oy(Dy(e)).deep_link_id:null,n=Oy(Dy(t)).deep_link_id;return(n?Oy(Dy(n)).link:null)||n||r||e||t}class OD{constructor(e){var r,n,a,s,o,l;const c=Oy(Dy(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,f=fge((a=c.mode)!==null&&a!==void 0?a:null);Rn(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=hge(e);try{return new OD(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(){this.providerId=i1.PROVIDER_ID}static credential(e,r){return c2._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=OD.parseLink(r);return Rn(n,"argument-error"),c2._fromEmailAndCode(e,n.code,n.tenantId)}}i1.PROVIDER_ID="password";i1.EMAIL_PASSWORD_SIGN_IN_METHOD="password";i1.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mJ{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww extends mJ{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0 extends ww{constructor(){super("facebook.com")}static credential(e){return tg._fromParams({providerId:k0.PROVIDER_ID,signInMethod:k0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return k0.credentialFromTaggedObject(e)}static credentialFromError(e){return k0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return k0.credential(e.oauthAccessToken)}catch{return null}}}k0.FACEBOOK_SIGN_IN_METHOD="facebook.com";k0.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0 extends ww{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return tg._fromParams({providerId:F0.PROVIDER_ID,signInMethod:F0.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return F0.credentialFromTaggedObject(e)}static credentialFromError(e){return F0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return F0.credential(r,n)}catch{return null}}}F0.GOOGLE_SIGN_IN_METHOD="google.com";F0.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends ww{constructor(){super("github.com")}static credential(e){return tg._fromParams({providerId:O0.PROVIDER_ID,signInMethod:O0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return O0.credentialFromTaggedObject(e)}static credentialFromError(e){return O0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return O0.credential(e.oauthAccessToken)}catch{return null}}}O0.GITHUB_SIGN_IN_METHOD="github.com";O0.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0 extends ww{constructor(){super("twitter.com")}static credential(e,r){return tg._fromParams({providerId:D0.PROVIDER_ID,signInMethod:D0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return D0.credentialFromTaggedObject(e)}static credentialFromError(e){return D0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return D0.credential(r,n)}catch{return null}}}D0.TWITTER_SIGN_IN_METHOD="twitter.com";D0.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Age(t,e){return bw(t,"POST","/v1/accounts:signUp",kA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const s=await qh._fromIdTokenResponse(e,n,a),o=a7(n);return new rg({user:s,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=a7(n);return new rg({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function a7(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS extends TA{constructor(e,r,n,a){var s;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,rS.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new rS(e,r,n,a)}}function pJ(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?rS._fromErrorAndOperation(t,s,e,n):s})}async function mge(t,e,r=!1){const n=await l2(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return rg._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pge(t,e,r=!1){const{auth:n}=t;if(Wf(n.app))return Promise.reject(rA(n));const a="reauthenticate";try{const s=await l2(t,pJ(n,a,e,t),r);Rn(s.idToken,n,"internal-error");const o=TD(s.idToken);Rn(o,n,"internal-error");const{sub:l}=o;return Rn(t.uid===l,n,"user-mismatch"),rg._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&wf(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gJ(t,e,r=!1){if(Wf(t.app))return Promise.reject(rA(t));const n="signIn",a=await pJ(t,n,e),s=await rg._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(s.user),s}async function gge(t,e){return gJ(Rm(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xJ(t){const e=Rm(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function xge(t,e,r){const n=Rm(t);await tS(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",lge)}async function vge(t,e,r){if(Wf(t.app))return Promise.reject(rA(t));const n=Rm(t),o=await tS(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Age).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&xJ(t),c}),l=await rg._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function yge(t,e,r){return Wf(t.app)?Promise.reject(rA(t)):gge(fi(t),i1.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&xJ(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(t,e){return fi(t).setPersistence(e)}function bge(t,e,r,n){return fi(t).onIdTokenChanged(e,r,n)}function wge(t,e,r){return fi(t).beforeAuthStateChanged(e,r)}function xj(t,e,r,n){return fi(t).onAuthStateChanged(e,r,n)}function DD(t){return fi(t).signOut()}const nS="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(nS,"1"),this.storage.removeItem(nS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nge=1e3,Cge=10;class yJ extends vJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);Qpe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Cge):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Nge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}yJ.type="LOCAL";const RD=yJ;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bJ extends vJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}bJ.type="SESSION";const MD=bJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _ge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new vj(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:s}=r.data,o=this.handlersMap[a];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const l=Array.from(o).map(async u=>u(r.origin,s)),c=await _ge(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vj.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LD(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ege{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=LD("",20);a.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(f){const A=f;if(A.data.eventId===u)switch(A.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(A.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(){return window}function Sge(t){sh().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wJ(){return typeof sh().WorkerGlobalScope<"u"&&typeof sh().importScripts=="function"}async function Ige(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Pge(){return wJ()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NJ="firebaseLocalStorageDb",Bge=1,aS="firebaseLocalStorage",CJ="fbase_key";class Nw{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function yj(t,e){return t.transaction([aS],e?"readwrite":"readonly").objectStore(aS)}function Tge(){const t=indexedDB.deleteDatabase(NJ);return new Nw(t).toPromise()}function UT(){const t=indexedDB.open(NJ,Bge);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(aS,{keyPath:CJ})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(aS)?e(n):(n.close(),await Tge(),e(await UT()))})})}async function s7(t,e,r){const n=yj(t,!0).put({[CJ]:e,value:r});return new Nw(n).toPromise()}async function kge(t,e){const r=yj(t,!1).get(e),n=await new Nw(r).toPromise();return n===void 0?null:n.value}function i7(t,e){const r=yj(t,!0).delete(e);return new Nw(r).toPromise()}const Fge=800,Oge=3;class _J{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await UT(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Oge)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wJ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vj._getInstance(Pge()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await Ige(),!this.activeServiceWorker)return;this.sender=new Ege(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await UT();return await s7(e,nS,"1"),await i7(e,nS),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>s7(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>kge(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>i7(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=yj(a,!1).getAll();return new Nw(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Fge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_J.type="LOCAL";const EJ=_J;new yw(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dge(t,e){return e?zh(e):(Rn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD extends FD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return dv(e,this._buildIdpRequest())}_linkToIdToken(e,r){return dv(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return dv(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Rge(t){return gJ(t.auth,new UD(t),t.bypassAuthState)}function Mge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),pge(r,new UD(t),t.bypassAuthState)}async function Lge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),mge(r,new UD(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SJ{constructor(e,r,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Rge;case"linkViaPopup":case"linkViaRedirect":return Lge;case"reauthViaPopup":case"reauthViaRedirect":return Mge;default:wf(this.auth,"internal-error")}}resolve(e){gA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uge=new yw(2e3,1e4);class qx extends SJ{constructor(e,r,n,a,s){super(e,r,a,s),this.provider=n,this.authWindow=null,this.pollId=null,qx.currentPopupAction&&qx.currentPopupAction.cancel(),qx.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rn(e,this.auth,"internal-error"),e}async onExecution(){gA(this.filter.length===1,"Popup operations only handle one event");const e=LD();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ah(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ah(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qx.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ah(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Uge.get())};e()}}qx.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qge="pendingRedirect",tE=new Map;class Vge extends SJ{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=tE.get(this.auth._key());if(!e){try{const n=await Hge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}tE.set(this.auth._key(),e)}return this.bypassAuthState||tE.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Hge(t,e){const r=Kge(e),n=Gge(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function $ge(t,e){tE.set(t._key(),e)}function Gge(t){return zh(t._redirectPersistence)}function Kge(t){return Z_(Qge,t.config.apiKey,t.name)}async function qge(t,e,r=!1){if(Wf(t.app))return Promise.reject(rA(t));const n=Rm(t),a=Dge(n,e),o=await new Vge(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zge=10*60*1e3;class Wge{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Xge(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!IJ(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ah(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zge&&this.cachedEventUids.clear(),this.cachedEventUids.has(o7(e))}saveEventToCache(e){this.cachedEventUids.add(o7(e)),this.lastProcessedEventTime=Date.now()}}function o7(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function IJ({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Xge(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return IJ(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yge(t,e={}){return FA(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jge=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zge=/^https?/;async function exe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Yge(t);for(const r of e)try{if(txe(r))return}catch{}wf(t,"unauthorized-domain")}function txe(t){const e=MT(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!Zge.test(r))return!1;if(Jge.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rxe=new yw(3e4,6e4);function l7(){const t=sh().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function nxe(t){return new Promise((e,r)=>{var n,a,s;function o(){l7(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{l7(),r(ah(t,"network-request-failed"))},timeout:rxe.get()})}if(!((a=(n=sh().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=sh().gapi)===null||s===void 0)&&s.load)o();else{const l=Xpe("iframefcb");return sh()[l]=()=>{gapi.load?o():r(ah(t,"network-request-failed"))},hJ(`${Wpe()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw rE=null,e})}let rE=null;function axe(t){return rE=rE||nxe(t),rE}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sxe=new yw(5e3,15e3),ixe="__/auth/iframe",oxe="emulator/auth/iframe",lxe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cxe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uxe(t){const e=t.config;Rn(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?BD(e,oxe):`https://${t.config.authDomain}/${ixe}`,n={apiKey:e.apiKey,appName:t.name,v:s1},a=cxe.get(t.config.apiHost);a&&(n.eid=a);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${vw(n).slice(1)}`}async function dxe(t){const e=await axe(t),r=sh().gapi;return Rn(r,t,"internal-error"),e.open({where:document.body,url:uxe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lxe,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const o=ah(t,"network-request-failed"),l=sh().setTimeout(()=>{s(o)},sxe.get());function c(){sh().clearTimeout(l),a(n)}n.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fxe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hxe=500,Axe=600,mxe="_blank",pxe="http://localhost";class c7{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gxe(t,e,r,n=hxe,a=Axe){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},fxe),{width:n.toString(),height:a.toString(),top:s,left:o}),u=Fo().toLowerCase();r&&(l=iJ(u)?mxe:r),aJ(u)&&(e=e||pxe,c.scrollbars="yes");const d=Object.entries(c).reduce((A,[h,m])=>`${A}${h}=${m},`,"");if(Upe(u)&&l!=="_self")return xxe(e||"",l),new c7(null);const f=window.open(e||"",l,d);Rn(f,t,"popup-blocked");try{f.focus()}catch{}return new c7(f)}function xxe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vxe="__/auth/handler",yxe="emulator/auth/handler",bxe=encodeURIComponent("fac");async function u7(t,e,r,n,a,s){Rn(t.config.authDomain,t,"auth-domain-config-required"),Rn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:s1,eventId:a};if(e instanceof mJ){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",ume(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof ww){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${bxe}=${encodeURIComponent(c)}`:"";return`${wxe(t)}?${vw(l).slice(1)}${u}`}function wxe({config:t}){return t.emulator?BD(t,yxe):`https://${t.authDomain}/${vxe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4="webStorageSupport";class Nxe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=MD,this._completeRedirectFn=qge,this._overrideRedirectResult=$ge}async _openPopup(e,r,n,a){var s;gA((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await u7(e,r,n,MT(),a);return gxe(e,o,LD())}async _openRedirect(e,r,n,a){await this._originValidation(e);const s=await u7(e,r,n,MT(),a);return Sge(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:s}=this.eventManagers[r];return a?Promise.resolve(a):(gA(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await dxe(e),n=new Wge(e);return r.register("authEvent",a=>(Rn(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(C4,{type:C4},a=>{var s;const o=(s=a==null?void 0:a[0])===null||s===void 0?void 0:s[C4];o!==void 0&&r(!!o),wf(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=exe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return dJ()||sJ()||kD()}}const Cxe=Nxe;var d7="@firebase/auth",f7="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _xe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Rn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Exe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Sxe(t){jv(new eg("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Rn(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fJ(t)},u=new Kpe(n,a,s,c);return tge(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),jv(new eg("auth-internal",e=>{const r=Rm(e.getProvider("auth").getImmediate());return(n=>new _xe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),lm(d7,f7,Exe(t)),lm(d7,f7,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ixe=5*60,jxe=VY("authIdTokenMaxAge")||Ixe;let h7=null;const Pxe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>jxe)return;const a=r==null?void 0:r.token;h7!==a&&(h7=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function QT(t=ID()){const e=ED(t,"auth");if(e.isInitialized())return e.getImmediate();const r=ege(t,{popupRedirectResolver:Cxe,persistence:[EJ,RD,MD]}),n=VY("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=Pxe(s.toString());wge(r,o,()=>o(r.currentUser)),bge(r,l=>o(l))}}const a=UY("auth");return a&&rge(r,`http://${a}`),r}function Bxe(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}qpe({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const s=ah("internal-error");s.customData=a,r(s)},n.type="text/javascript",n.charset="UTF-8",Bxe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Sxe("Browser");var Txe="firebase",kxe="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lm(Txe,kxe,"app");var A7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kp,jJ;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,S){function E(){}E.prototype=S.prototype,_.D=S.prototype,_.prototype=new E,_.prototype.constructor=_,_.C=function(B,T,P){for(var O=Array(arguments.length-2),z=2;z<arguments.length;z++)O[z-2]=arguments[z];return S.prototype[T].apply(B,O)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(_,S,E){E||(E=0);var B=Array(16);if(typeof S=="string")for(var T=0;16>T;++T)B[T]=S.charCodeAt(E++)|S.charCodeAt(E++)<<8|S.charCodeAt(E++)<<16|S.charCodeAt(E++)<<24;else for(T=0;16>T;++T)B[T]=S[E++]|S[E++]<<8|S[E++]<<16|S[E++]<<24;S=_.g[0],E=_.g[1],T=_.g[2];var P=_.g[3],O=S+(P^E&(T^P))+B[0]+3614090360&4294967295;S=E+(O<<7&4294967295|O>>>25),O=P+(T^S&(E^T))+B[1]+3905402710&4294967295,P=S+(O<<12&4294967295|O>>>20),O=T+(E^P&(S^E))+B[2]+606105819&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(S^T&(P^S))+B[3]+3250441966&4294967295,E=T+(O<<22&4294967295|O>>>10),O=S+(P^E&(T^P))+B[4]+4118548399&4294967295,S=E+(O<<7&4294967295|O>>>25),O=P+(T^S&(E^T))+B[5]+1200080426&4294967295,P=S+(O<<12&4294967295|O>>>20),O=T+(E^P&(S^E))+B[6]+2821735955&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(S^T&(P^S))+B[7]+4249261313&4294967295,E=T+(O<<22&4294967295|O>>>10),O=S+(P^E&(T^P))+B[8]+1770035416&4294967295,S=E+(O<<7&4294967295|O>>>25),O=P+(T^S&(E^T))+B[9]+2336552879&4294967295,P=S+(O<<12&4294967295|O>>>20),O=T+(E^P&(S^E))+B[10]+4294925233&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(S^T&(P^S))+B[11]+2304563134&4294967295,E=T+(O<<22&4294967295|O>>>10),O=S+(P^E&(T^P))+B[12]+1804603682&4294967295,S=E+(O<<7&4294967295|O>>>25),O=P+(T^S&(E^T))+B[13]+4254626195&4294967295,P=S+(O<<12&4294967295|O>>>20),O=T+(E^P&(S^E))+B[14]+2792965006&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(S^T&(P^S))+B[15]+1236535329&4294967295,E=T+(O<<22&4294967295|O>>>10),O=S+(T^P&(E^T))+B[1]+4129170786&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(S^E))+B[6]+3225465664&4294967295,P=S+(O<<9&4294967295|O>>>23),O=T+(S^E&(P^S))+B[11]+643717713&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(T^P))+B[0]+3921069994&4294967295,E=T+(O<<20&4294967295|O>>>12),O=S+(T^P&(E^T))+B[5]+3593408605&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(S^E))+B[10]+38016083&4294967295,P=S+(O<<9&4294967295|O>>>23),O=T+(S^E&(P^S))+B[15]+3634488961&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(T^P))+B[4]+3889429448&4294967295,E=T+(O<<20&4294967295|O>>>12),O=S+(T^P&(E^T))+B[9]+568446438&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(S^E))+B[14]+3275163606&4294967295,P=S+(O<<9&4294967295|O>>>23),O=T+(S^E&(P^S))+B[3]+4107603335&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(T^P))+B[8]+1163531501&4294967295,E=T+(O<<20&4294967295|O>>>12),O=S+(T^P&(E^T))+B[13]+2850285829&4294967295,S=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(S^E))+B[2]+4243563512&4294967295,P=S+(O<<9&4294967295|O>>>23),O=T+(S^E&(P^S))+B[7]+1735328473&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^S&(T^P))+B[12]+2368359562&4294967295,E=T+(O<<20&4294967295|O>>>12),O=S+(E^T^P)+B[5]+4294588738&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^T)+B[8]+2272392833&4294967295,P=S+(O<<11&4294967295|O>>>21),O=T+(P^S^E)+B[11]+1839030562&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^S)+B[14]+4259657740&4294967295,E=T+(O<<23&4294967295|O>>>9),O=S+(E^T^P)+B[1]+2763975236&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^T)+B[4]+1272893353&4294967295,P=S+(O<<11&4294967295|O>>>21),O=T+(P^S^E)+B[7]+4139469664&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^S)+B[10]+3200236656&4294967295,E=T+(O<<23&4294967295|O>>>9),O=S+(E^T^P)+B[13]+681279174&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^T)+B[0]+3936430074&4294967295,P=S+(O<<11&4294967295|O>>>21),O=T+(P^S^E)+B[3]+3572445317&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^S)+B[6]+76029189&4294967295,E=T+(O<<23&4294967295|O>>>9),O=S+(E^T^P)+B[9]+3654602809&4294967295,S=E+(O<<4&4294967295|O>>>28),O=P+(S^E^T)+B[12]+3873151461&4294967295,P=S+(O<<11&4294967295|O>>>21),O=T+(P^S^E)+B[15]+530742520&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^S)+B[2]+3299628645&4294967295,E=T+(O<<23&4294967295|O>>>9),O=S+(T^(E|~P))+B[0]+4096336452&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~T))+B[7]+1126891415&4294967295,P=S+(O<<10&4294967295|O>>>22),O=T+(S^(P|~E))+B[14]+2878612391&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~S))+B[5]+4237533241&4294967295,E=T+(O<<21&4294967295|O>>>11),O=S+(T^(E|~P))+B[12]+1700485571&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~T))+B[3]+2399980690&4294967295,P=S+(O<<10&4294967295|O>>>22),O=T+(S^(P|~E))+B[10]+4293915773&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~S))+B[1]+2240044497&4294967295,E=T+(O<<21&4294967295|O>>>11),O=S+(T^(E|~P))+B[8]+1873313359&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~T))+B[15]+4264355552&4294967295,P=S+(O<<10&4294967295|O>>>22),O=T+(S^(P|~E))+B[6]+2734768916&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~S))+B[13]+1309151649&4294967295,E=T+(O<<21&4294967295|O>>>11),O=S+(T^(E|~P))+B[4]+4149444226&4294967295,S=E+(O<<6&4294967295|O>>>26),O=P+(E^(S|~T))+B[11]+3174756917&4294967295,P=S+(O<<10&4294967295|O>>>22),O=T+(S^(P|~E))+B[2]+718787259&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~S))+B[9]+3951481745&4294967295,_.g[0]=_.g[0]+S&4294967295,_.g[1]=_.g[1]+(T+(O<<21&4294967295|O>>>11))&4294967295,_.g[2]=_.g[2]+T&4294967295,_.g[3]=_.g[3]+P&4294967295}n.prototype.u=function(_,S){S===void 0&&(S=_.length);for(var E=S-this.blockSize,B=this.B,T=this.h,P=0;P<S;){if(T==0)for(;P<=E;)a(this,_,P),P+=this.blockSize;if(typeof _=="string"){for(;P<S;)if(B[T++]=_.charCodeAt(P++),T==this.blockSize){a(this,B),T=0;break}}else for(;P<S;)if(B[T++]=_[P++],T==this.blockSize){a(this,B),T=0;break}}this.h=T,this.o+=S},n.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var S=1;S<_.length-8;++S)_[S]=0;var E=8*this.o;for(S=_.length-8;S<_.length;++S)_[S]=E&255,E/=256;for(this.u(_),_=Array(16),S=E=0;4>S;++S)for(var B=0;32>B;B+=8)_[E++]=this.g[S]>>>B&255;return _};function s(_,S){var E=l;return Object.prototype.hasOwnProperty.call(E,_)?E[_]:E[_]=S(_)}function o(_,S){this.h=S;for(var E=[],B=!0,T=_.length-1;0<=T;T--){var P=_[T]|0;B&&P==S||(E[T]=P,B=!1)}this.g=E}var l={};function c(_){return-128<=_&&128>_?s(_,function(S){return new o([S|0],0>S?-1:0)}):new o([_|0],0>_?-1:0)}function u(_){if(isNaN(_)||!isFinite(_))return f;if(0>_)return x(u(-_));for(var S=[],E=1,B=0;_>=E;B++)S[B]=_/E|0,E*=4294967296;return new o(S,0)}function d(_,S){if(_.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(_.charAt(0)=="-")return x(d(_.substring(1),S));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(S,8)),B=f,T=0;T<_.length;T+=8){var P=Math.min(8,_.length-T),O=parseInt(_.substring(T,T+P),S);8>P?(P=u(Math.pow(S,P)),B=B.j(P).add(u(O))):(B=B.j(E),B=B.add(u(O)))}return B}var f=c(0),A=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var _=0,S=1,E=0;E<this.g.length;E++){var B=this.i(E);_+=(0<=B?B:4294967296+B)*S,S*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(m(this))return"0";if(p(this))return"-"+x(this).toString(_);for(var S=u(Math.pow(_,6)),E=this,B="";;){var T=w(E,S).g;E=v(E,T.j(S));var P=((0<E.g.length?E.g[0]:E.h)>>>0).toString(_);if(E=T,m(E))return P+B;for(;6>P.length;)P="0"+P;B=P+B}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function m(_){if(_.h!=0)return!1;for(var S=0;S<_.g.length;S++)if(_.g[S]!=0)return!1;return!0}function p(_){return _.h==-1}t.l=function(_){return _=v(this,_),p(_)?-1:m(_)?0:1};function x(_){for(var S=_.g.length,E=[],B=0;B<S;B++)E[B]=~_.g[B];return new o(E,~_.h).add(A)}t.abs=function(){return p(this)?x(this):this},t.add=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0,T=0;T<=S;T++){var P=B+(this.i(T)&65535)+(_.i(T)&65535),O=(P>>>16)+(this.i(T)>>>16)+(_.i(T)>>>16);B=O>>>16,P&=65535,O&=65535,E[T]=O<<16|P}return new o(E,E[E.length-1]&-2147483648?-1:0)};function v(_,S){return _.add(x(S))}t.j=function(_){if(m(this)||m(_))return f;if(p(this))return p(_)?x(this).j(x(_)):x(x(this).j(_));if(p(_))return x(this.j(x(_)));if(0>this.l(h)&&0>_.l(h))return u(this.m()*_.m());for(var S=this.g.length+_.g.length,E=[],B=0;B<2*S;B++)E[B]=0;for(B=0;B<this.g.length;B++)for(var T=0;T<_.g.length;T++){var P=this.i(B)>>>16,O=this.i(B)&65535,z=_.i(T)>>>16,ce=_.i(T)&65535;E[2*B+2*T]+=O*ce,y(E,2*B+2*T),E[2*B+2*T+1]+=P*ce,y(E,2*B+2*T+1),E[2*B+2*T+1]+=O*z,y(E,2*B+2*T+1),E[2*B+2*T+2]+=P*z,y(E,2*B+2*T+2)}for(B=0;B<S;B++)E[B]=E[2*B+1]<<16|E[2*B];for(B=S;B<2*S;B++)E[B]=0;return new o(E,0)};function y(_,S){for(;(_[S]&65535)!=_[S];)_[S+1]+=_[S]>>>16,_[S]&=65535,S++}function b(_,S){this.g=_,this.h=S}function w(_,S){if(m(S))throw Error("division by zero");if(m(_))return new b(f,f);if(p(_))return S=w(x(_),S),new b(x(S.g),x(S.h));if(p(S))return S=w(_,x(S)),new b(x(S.g),S.h);if(30<_.g.length){if(p(_)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var E=A,B=S;0>=B.l(_);)E=j(E),B=j(B);var T=I(E,1),P=I(B,1);for(B=I(B,2),E=I(E,2);!m(B);){var O=P.add(B);0>=O.l(_)&&(T=T.add(E),P=O),B=I(B,1),E=I(E,1)}return S=v(_,T.j(S)),new b(T,S)}for(T=f;0<=_.l(S);){for(E=Math.max(1,Math.floor(_.m()/S.m())),B=Math.ceil(Math.log(E)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),P=u(E),O=P.j(S);p(O)||0<O.l(_);)E-=B,P=u(E),O=P.j(S);m(P)&&(P=A),T=T.add(P),_=v(_,O)}return new b(T,_)}t.A=function(_){return w(this,_).h},t.and=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)&_.i(B);return new o(E,this.h&_.h)},t.or=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)|_.i(B);return new o(E,this.h|_.h)},t.xor=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)^_.i(B);return new o(E,this.h^_.h)};function j(_){for(var S=_.g.length+1,E=[],B=0;B<S;B++)E[B]=_.i(B)<<1|_.i(B-1)>>>31;return new o(E,_.h)}function I(_,S){var E=S>>5;S%=32;for(var B=_.g.length-E,T=[],P=0;P<B;P++)T[P]=0<S?_.i(P+E)>>>S|_.i(P+E+1)<<32-S:_.i(P+E);return new o(T,_.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,jJ=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,kp=o}).apply(typeof A7<"u"?A7:typeof self<"u"?self:typeof window<"u"?window:{});var eC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var PJ,Ry,BJ,nE,VT,TJ,kJ,FJ;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(C,J,ge){return C==Array.prototype||C==Object.prototype||(C[J]=ge.value),C};function r(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof eC=="object"&&eC];for(var J=0;J<C.length;++J){var ge=C[J];if(ge&&ge.Math==Math)return ge}throw Error("Cannot find global object")}var n=r(this);function a(C,J){if(J)e:{var ge=n;C=C.split(".");for(var et=0;et<C.length-1;et++){var Gt=C[et];if(!(Gt in ge))break e;ge=ge[Gt]}C=C[C.length-1],et=ge[C],J=J(et),J!=et&&J!=null&&e(ge,C,{configurable:!0,writable:!0,value:J})}}function s(C,J){C instanceof String&&(C+="");var ge=0,et=!1,Gt={next:function(){if(!et&&ge<C.length){var tr=ge++;return{value:J(tr,C[tr]),done:!1}}return et=!0,{done:!0,value:void 0}}};return Gt[Symbol.iterator]=function(){return Gt},Gt}a("Array.prototype.values",function(C){return C||function(){return s(this,function(J,ge){return ge})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(C){var J=typeof C;return J=J!="object"?J:C?Array.isArray(C)?"array":J:"null",J=="array"||J=="object"&&typeof C.length=="number"}function u(C){var J=typeof C;return J=="object"&&C!=null||J=="function"}function d(C,J,ge){return C.call.apply(C.bind,arguments)}function f(C,J,ge){if(!C)throw Error();if(2<arguments.length){var et=Array.prototype.slice.call(arguments,2);return function(){var Gt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Gt,et),C.apply(J,Gt)}}return function(){return C.apply(J,arguments)}}function A(C,J,ge){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,A.apply(null,arguments)}function h(C,J){var ge=Array.prototype.slice.call(arguments,1);return function(){var et=ge.slice();return et.push.apply(et,arguments),C.apply(this,et)}}function m(C,J){function ge(){}ge.prototype=J.prototype,C.aa=J.prototype,C.prototype=new ge,C.prototype.constructor=C,C.Qb=function(et,Gt,tr){for(var Rr=Array(arguments.length-2),ma=2;ma<arguments.length;ma++)Rr[ma-2]=arguments[ma];return J.prototype[Gt].apply(et,Rr)}}function p(C){const J=C.length;if(0<J){const ge=Array(J);for(let et=0;et<J;et++)ge[et]=C[et];return ge}return[]}function x(C,J){for(let ge=1;ge<arguments.length;ge++){const et=arguments[ge];if(c(et)){const Gt=C.length||0,tr=et.length||0;C.length=Gt+tr;for(let Rr=0;Rr<tr;Rr++)C[Gt+Rr]=et[Rr]}else C.push(et)}}class v{constructor(J,ge){this.i=J,this.j=ge,this.h=0,this.g=null}get(){let J;return 0<this.h?(this.h--,J=this.g,this.g=J.next,J.next=null):J=this.i(),J}}function y(C){return/^[\s\xa0]*$/.test(C)}function b(){var C=l.navigator;return C&&(C=C.userAgent)?C:""}function w(C){return w[" "](C),C}w[" "]=function(){};var j=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function I(C,J,ge){for(const et in C)J.call(ge,C[et],et,C)}function _(C,J){for(const ge in C)J.call(void 0,C[ge],ge,C)}function S(C){const J={};for(const ge in C)J[ge]=C[ge];return J}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(C,J){let ge,et;for(let Gt=1;Gt<arguments.length;Gt++){et=arguments[Gt];for(ge in et)C[ge]=et[ge];for(let tr=0;tr<E.length;tr++)ge=E[tr],Object.prototype.hasOwnProperty.call(et,ge)&&(C[ge]=et[ge])}}function T(C){var J=1;C=C.split(":");const ge=[];for(;0<J&&C.length;)ge.push(C.shift()),J--;return C.length&&ge.push(C.join(":")),ge}function P(C){l.setTimeout(()=>{throw C},0)}function O(){var C=se;let J=null;return C.g&&(J=C.g,C.g=C.g.next,C.g||(C.h=null),J.next=null),J}class z{constructor(){this.h=this.g=null}add(J,ge){const et=ce.get();et.set(J,ge),this.h?this.h.next=et:this.g=et,this.h=et}}var ce=new v(()=>new de,C=>C.reset());class de{constructor(){this.next=this.g=this.h=null}set(J,ge){this.h=J,this.g=ge,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,me=!1,se=new z,ke=()=>{const C=l.Promise.resolve(void 0);ue=()=>{C.then(Re)}};var Re=()=>{for(var C;C=O();){try{C.h.call(C.g)}catch(ge){P(ge)}var J=ce;J.j(C),100>J.h&&(J.h++,C.next=J.g,J.g=C)}me=!1};function F(){this.s=this.s,this.C=this.C}F.prototype.s=!1,F.prototype.ma=function(){this.s||(this.s=!0,this.N())},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(C,J){this.type=C,this.g=this.target=J,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var C=!1,J=Object.defineProperty({},"passive",{get:function(){C=!0}});try{const ge=()=>{};l.addEventListener("test",ge,J),l.removeEventListener("test",ge,J)}catch{}return C}();function L(C,J){if(H.call(this,C?C.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,C){var ge=this.type=C.type,et=C.changedTouches&&C.changedTouches.length?C.changedTouches[0]:null;if(this.target=C.target||C.srcElement,this.g=J,J=C.relatedTarget){if(j){e:{try{w(J.nodeName);var Gt=!0;break e}catch{}Gt=!1}Gt||(J=null)}}else ge=="mouseover"?J=C.fromElement:ge=="mouseout"&&(J=C.toElement);this.relatedTarget=J,et?(this.clientX=et.clientX!==void 0?et.clientX:et.pageX,this.clientY=et.clientY!==void 0?et.clientY:et.pageY,this.screenX=et.screenX||0,this.screenY=et.screenY||0):(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0),this.button=C.button,this.key=C.key||"",this.ctrlKey=C.ctrlKey,this.altKey=C.altKey,this.shiftKey=C.shiftKey,this.metaKey=C.metaKey,this.pointerId=C.pointerId||0,this.pointerType=typeof C.pointerType=="string"?C.pointerType:W[C.pointerType]||"",this.state=C.state,this.i=C,C.defaultPrevented&&L.aa.h.call(this)}}m(L,H);var W={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var C=this.i;C.preventDefault?C.preventDefault():C.returnValue=!1};var Y="closure_listenable_"+(1e6*Math.random()|0),D=0;function Q(C,J,ge,et,Gt){this.listener=C,this.proxy=null,this.src=J,this.type=ge,this.capture=!!et,this.ha=Gt,this.key=++D,this.da=this.fa=!1}function ee(C){C.da=!0,C.listener=null,C.proxy=null,C.src=null,C.ha=null}function ve(C){this.src=C,this.g={},this.h=0}ve.prototype.add=function(C,J,ge,et,Gt){var tr=C.toString();C=this.g[tr],C||(C=this.g[tr]=[],this.h++);var Rr=Ye(C,J,et,Gt);return-1<Rr?(J=C[Rr],ge||(J.fa=!1)):(J=new Q(J,this.src,tr,!!et,Gt),J.fa=ge,C.push(J)),J};function M(C,J){var ge=J.type;if(ge in C.g){var et=C.g[ge],Gt=Array.prototype.indexOf.call(et,J,void 0),tr;(tr=0<=Gt)&&Array.prototype.splice.call(et,Gt,1),tr&&(ee(J),C.g[ge].length==0&&(delete C.g[ge],C.h--))}}function Ye(C,J,ge,et){for(var Gt=0;Gt<C.length;++Gt){var tr=C[Gt];if(!tr.da&&tr.listener==J&&tr.capture==!!ge&&tr.ha==et)return Gt}return-1}var ae="closure_lm_"+(1e6*Math.random()|0),X={};function De(C,J,ge,et,Gt){if(Array.isArray(J)){for(var tr=0;tr<J.length;tr++)De(C,J[tr],ge,et,Gt);return null}return ge=$t(ge),C&&C[Y]?C.K(J,ge,u(et)?!!et.capture:!1,Gt):le(C,J,ge,!1,et,Gt)}function le(C,J,ge,et,Gt,tr){if(!J)throw Error("Invalid event type");var Rr=u(Gt)?!!Gt.capture:!!Gt,ma=Mt(C);if(ma||(C[ae]=ma=new ve(C)),ge=ma.add(J,ge,et,Rr,tr),ge.proxy)return ge;if(et=$e(),ge.proxy=et,et.src=C,et.listener=ge,C.addEventListener)K||(Gt=Rr),Gt===void 0&&(Gt=!1),C.addEventListener(J.toString(),et,Gt);else if(C.attachEvent)C.attachEvent(xt(J.toString()),et);else if(C.addListener&&C.removeListener)C.addListener(et);else throw Error("addEventListener and attachEvent are unavailable.");return ge}function $e(){function C(ge){return J.call(C.src,C.listener,ge)}const J=jt;return C}function Xe(C,J,ge,et,Gt){if(Array.isArray(J))for(var tr=0;tr<J.length;tr++)Xe(C,J[tr],ge,et,Gt);else et=u(et)?!!et.capture:!!et,ge=$t(ge),C&&C[Y]?(C=C.i,J=String(J).toString(),J in C.g&&(tr=C.g[J],ge=Ye(tr,ge,et,Gt),-1<ge&&(ee(tr[ge]),Array.prototype.splice.call(tr,ge,1),tr.length==0&&(delete C.g[J],C.h--)))):C&&(C=Mt(C))&&(J=C.g[J.toString()],C=-1,J&&(C=Ye(J,ge,et,Gt)),(ge=-1<C?J[C]:null)&&it(ge))}function it(C){if(typeof C!="number"&&C&&!C.da){var J=C.src;if(J&&J[Y])M(J.i,C);else{var ge=C.type,et=C.proxy;J.removeEventListener?J.removeEventListener(ge,et,C.capture):J.detachEvent?J.detachEvent(xt(ge),et):J.addListener&&J.removeListener&&J.removeListener(et),(ge=Mt(J))?(M(ge,C),ge.h==0&&(ge.src=null,J[ae]=null)):ee(C)}}}function xt(C){return C in X?X[C]:X[C]="on"+C}function jt(C,J){if(C.da)C=!0;else{J=new L(J,this);var ge=C.listener,et=C.ha||C.src;C.fa&&it(C),C=ge.call(et,J)}return C}function Mt(C){return C=C[ae],C instanceof ve?C:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function $t(C){return typeof C=="function"?C:(C[Ft]||(C[Ft]=function(J){return C.handleEvent(J)}),C[Ft])}function kt(){F.call(this),this.i=new ve(this),this.M=this,this.F=null}m(kt,F),kt.prototype[Y]=!0,kt.prototype.removeEventListener=function(C,J,ge,et){Xe(this,C,J,ge,et)};function Ge(C,J){var ge,et=C.F;if(et)for(ge=[];et;et=et.F)ge.push(et);if(C=C.M,et=J.type||J,typeof J=="string")J=new H(J,C);else if(J instanceof H)J.target=J.target||C;else{var Gt=J;J=new H(et,C),B(J,Gt)}if(Gt=!0,ge)for(var tr=ge.length-1;0<=tr;tr--){var Rr=J.g=ge[tr];Gt=ie(Rr,et,!0,J)&&Gt}if(Rr=J.g=C,Gt=ie(Rr,et,!0,J)&&Gt,Gt=ie(Rr,et,!1,J)&&Gt,ge)for(tr=0;tr<ge.length;tr++)Rr=J.g=ge[tr],Gt=ie(Rr,et,!1,J)&&Gt}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var C=this.i,J;for(J in C.g){for(var ge=C.g[J],et=0;et<ge.length;et++)ee(ge[et]);delete C.g[J],C.h--}}this.F=null},kt.prototype.K=function(C,J,ge,et){return this.i.add(String(C),J,!1,ge,et)},kt.prototype.L=function(C,J,ge,et){return this.i.add(String(C),J,!0,ge,et)};function ie(C,J,ge,et){if(J=C.i.g[String(J)],!J)return!0;J=J.concat();for(var Gt=!0,tr=0;tr<J.length;++tr){var Rr=J[tr];if(Rr&&!Rr.da&&Rr.capture==ge){var ma=Rr.listener,ei=Rr.ha||Rr.src;Rr.fa&&M(C.i,Rr),Gt=ma.call(ei,et)!==!1&&Gt}}return Gt&&!et.defaultPrevented}function Ue(C,J,ge){if(typeof C=="function")ge&&(C=A(C,ge));else if(C&&typeof C.handleEvent=="function")C=A(C.handleEvent,C);else throw Error("Invalid listener argument");return 2147483647<Number(J)?-1:l.setTimeout(C,J||0)}function Ne(C){C.g=Ue(()=>{C.g=null,C.i&&(C.i=!1,Ne(C))},C.l);const J=C.h;C.h=null,C.m.apply(null,J)}class be extends F{constructor(J,ge){super(),this.m=J,this.l=ge,this.h=null,this.i=!1,this.g=null}j(J){this.h=arguments,this.g?this.i=!0:Ne(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ce(C){F.call(this),this.h=C,this.g={}}m(Ce,F);var Le=[];function Ae(C){I(C.g,function(J,ge){this.g.hasOwnProperty(ge)&&it(J)},C),C.g={}}Ce.prototype.N=function(){Ce.aa.N.call(this),Ae(this)},Ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var We=l.JSON.stringify,ct=l.JSON.parse,_t=class{stringify(C){return l.JSON.stringify(C,void 0)}parse(C){return l.JSON.parse(C,void 0)}};function pe(){}pe.prototype.h=null;function Pe(C){return C.h||(C.h=C.i())}function Ee(){}var Ze={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xe(){H.call(this,"d")}m(xe,H);function Se(){H.call(this,"c")}m(Se,H);var gt={},Et=null;function Nt(){return Et=Et||new kt}gt.La="serverreachability";function Tt(C){H.call(this,gt.La,C)}m(Tt,H);function Lt(C){const J=Nt();Ge(J,new Tt(J))}gt.STAT_EVENT="statevent";function Me(C,J){H.call(this,gt.STAT_EVENT,C),this.stat=J}m(Me,H);function _e(C){const J=Nt();Ge(J,new Me(J,C))}gt.Ma="timingevent";function U(C,J){H.call(this,gt.Ma,C),this.size=J}m(U,H);function ye(C,J){if(typeof C!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){C()},J)}function te(){this.g=!0}te.prototype.xa=function(){this.g=!1};function Ve(C,J,ge,et,Gt,tr){C.info(function(){if(C.g)if(tr)for(var Rr="",ma=tr.split("&"),ei=0;ei<ma.length;ei++){var ra=ma[ei].split("=");if(1<ra.length){var Sa=ra[0];ra=ra[1];var gs=Sa.split("_");Rr=2<=gs.length&&gs[1]=="type"?Rr+(Sa+"="+ra+"&"):Rr+(Sa+"=redacted&")}}else Rr=null;else Rr=tr;return"XMLHTTP REQ ("+et+") [attempt "+Gt+"]: "+J+`
`+ge+`
`+Rr})}function qe(C,J,ge,et,Gt,tr,Rr){C.info(function(){return"XMLHTTP RESP ("+et+") [ attempt "+Gt+"]: "+J+`
`+ge+`
`+tr+" "+Rr})}function G(C,J,ge,et){C.info(function(){return"XMLHTTP TEXT ("+J+"): "+Z(C,ge)+(et?" "+et:"")})}function V(C,J){C.info(function(){return"TIMEOUT: "+J})}te.prototype.info=function(){};function Z(C,J){if(!C.g)return J;if(!J)return null;try{var ge=JSON.parse(J);if(ge){for(C=0;C<ge.length;C++)if(Array.isArray(ge[C])){var et=ge[C];if(!(2>et.length)){var Gt=et[1];if(Array.isArray(Gt)&&!(1>Gt.length)){var tr=Gt[0];if(tr!="noop"&&tr!="stop"&&tr!="close")for(var Rr=1;Rr<Gt.length;Rr++)Gt[Rr]=""}}}}return We(ge)}catch{return J}}var re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},we={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Fe;function st(){}m(st,pe),st.prototype.g=function(){return new XMLHttpRequest},st.prototype.i=function(){return{}},Fe=new st;function Be(C,J,ge,et){this.j=C,this.i=J,this.l=ge,this.R=et||1,this.U=new Ce(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new at}function at(){this.i=null,this.g="",this.h=!1}var lt={},dt={};function Pt(C,J,ge){C.L=1,C.v=vt(gn(J)),C.m=ge,C.P=!0,he(C,null)}function he(C,J){C.F=Date.now(),ne(C),C.A=gn(C.v);var ge=C.A,et=C.R;Array.isArray(et)||(et=[String(et)]),Cr(ge.i,"t",et),C.C=0,ge=C.j.J,C.h=new at,C.g=pi(C.j,ge?J:null,!C.m),0<C.O&&(C.M=new be(A(C.Y,C,C.g),C.O)),J=C.U,ge=C.g,et=C.ca;var Gt="readystatechange";Array.isArray(Gt)||(Gt&&(Le[0]=Gt.toString()),Gt=Le);for(var tr=0;tr<Gt.length;tr++){var Rr=De(ge,Gt[tr],et||J.handleEvent,!1,J.h||J);if(!Rr)break;J.g[Rr.key]=Rr}J=C.H?S(C.H):{},C.m?(C.u||(C.u="POST"),J["Content-Type"]="application/x-www-form-urlencoded",C.g.ea(C.A,C.u,C.m,J)):(C.u="GET",C.g.ea(C.A,C.u,null,J)),Lt(),Ve(C.i,C.u,C.A,C.l,C.R,C.m)}Be.prototype.ca=function(C){C=C.target;const J=this.M;J&&ol(C)==3?J.j():this.Y(C)},Be.prototype.Y=function(C){try{if(C==this.g)e:{const gs=ol(this.g);var J=this.g.Ba();const hu=this.g.Z();if(!(3>gs)&&(gs!=3||this.g&&(this.h.h||this.g.oa()||fu(this.g)))){this.J||gs!=4||J==7||(J==8||0>=hu?Lt(3):Lt(2)),pt(this);var ge=this.g.Z();this.X=ge;t:if(ze(this)){var et=fu(this.g);C="";var Gt=et.length,tr=ol(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){rr(this),Dt(this);var Rr="";break t}this.h.i=new l.TextDecoder}for(J=0;J<Gt;J++)this.h.h=!0,C+=this.h.i.decode(et[J],{stream:!(tr&&J==Gt-1)});et.length=0,this.h.g+=C,this.C=0,Rr=this.h.g}else Rr=this.g.oa();if(this.o=ge==200,qe(this.i,this.u,this.A,this.l,this.R,gs,ge),this.o){if(this.T&&!this.K){t:{if(this.g){var ma,ei=this.g;if((ma=ei.g?ei.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(ma)){var ra=ma;break t}}ra=null}if(ge=ra)G(this.i,this.l,ge,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zt(this,ge);else{this.o=!1,this.s=3,_e(12),rr(this),Dt(this);break e}}if(this.P){ge=!0;let Dl;for(;!this.J&&this.C<Rr.length;)if(Dl=nt(this,Rr),Dl==dt){gs==4&&(this.s=4,_e(14),ge=!1),G(this.i,this.l,null,"[Incomplete Response]");break}else if(Dl==lt){this.s=4,_e(15),G(this.i,this.l,Rr,"[Invalid Chunk]"),ge=!1;break}else G(this.i,this.l,Dl,null),zt(this,Dl);if(ze(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gs!=4||Rr.length!=0||this.h.h||(this.s=1,_e(16),ge=!1),this.o=this.o&&ge,!ge)G(this.i,this.l,Rr,"[Invalid Chunked Response]"),rr(this),Dt(this);else if(0<Rr.length&&!this.W){this.W=!0;var Sa=this.j;Sa.g==this&&Sa.ba&&!Sa.M&&(Sa.j.info("Great, no buffering proxy detected. Bytes received: "+Rr.length),nn(Sa),Sa.M=!0,_e(11))}}else G(this.i,this.l,Rr,null),zt(this,Rr);gs==4&&rr(this),this.o&&!this.J&&(gs==4?Vn(this.j,this):(this.o=!1,ne(this)))}else KA(this.g),ge==400&&0<Rr.indexOf("Unknown SID")?(this.s=3,_e(12)):(this.s=0,_e(13)),rr(this),Dt(this)}}}catch{}finally{}};function ze(C){return C.g?C.u=="GET"&&C.L!=2&&C.j.Ca:!1}function nt(C,J){var ge=C.C,et=J.indexOf(`
`,ge);return et==-1?dt:(ge=Number(J.substring(ge,et)),isNaN(ge)?lt:(et+=1,et+ge>J.length?dt:(J=J.slice(et,et+ge),C.C=et+ge,J)))}Be.prototype.cancel=function(){this.J=!0,rr(this)};function ne(C){C.S=Date.now()+C.I,He(C,C.I)}function He(C,J){if(C.B!=null)throw Error("WatchDog timer not null");C.B=ye(A(C.ba,C),J)}function pt(C){C.B&&(l.clearTimeout(C.B),C.B=null)}Be.prototype.ba=function(){this.B=null;const C=Date.now();0<=C-this.S?(V(this.i,this.A),this.L!=2&&(Lt(),_e(17)),rr(this),this.s=2,Dt(this)):He(this,this.S-C)};function Dt(C){C.j.G==0||C.J||Vn(C.j,C)}function rr(C){pt(C);var J=C.M;J&&typeof J.ma=="function"&&J.ma(),C.M=null,Ae(C.U),C.g&&(J=C.g,C.g=null,J.abort(),J.ma())}function zt(C,J){try{var ge=C.j;if(ge.G!=0&&(ge.g==C||nr(ge.h,C))){if(!C.K&&nr(ge.h,C)&&ge.G==3){try{var et=ge.Da.g.parse(J)}catch{et=null}if(Array.isArray(et)&&et.length==3){var Gt=et;if(Gt[0]==0){e:if(!ge.u){if(ge.g)if(ge.g.F+3e3<C.F)Tn(ge),fo(ge);else break e;wr(ge),_e(18)}}else ge.za=Gt[1],0<ge.za-ge.T&&37500>Gt[2]&&ge.F&&ge.v==0&&!ge.C&&(ge.C=ye(A(ge.Za,ge),6e3));if(1>=br(ge.h)&&ge.ca){try{ge.ca()}catch{}ge.ca=void 0}}else ka(ge,11)}else if((C.K||ge.g==C)&&Tn(ge),!y(J))for(Gt=ge.Da.g.parse(J),J=0;J<Gt.length;J++){let ra=Gt[J];if(ge.T=ra[0],ra=ra[1],ge.G==2)if(ra[0]=="c"){ge.K=ra[1],ge.ia=ra[2];const Sa=ra[3];Sa!=null&&(ge.la=Sa,ge.j.info("VER="+ge.la));const gs=ra[4];gs!=null&&(ge.Aa=gs,ge.j.info("SVER="+ge.Aa));const hu=ra[5];hu!=null&&typeof hu=="number"&&0<hu&&(et=1.5*hu,ge.L=et,ge.j.info("backChannelRequestTimeoutMs_="+et)),et=ge;const Dl=C.g;if(Dl){const cl=Dl.g?Dl.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cl){var tr=et.h;tr.g||cl.indexOf("spdy")==-1&&cl.indexOf("quic")==-1&&cl.indexOf("h2")==-1||(tr.j=tr.l,tr.g=new Set,tr.h&&(ir(tr,tr.h),tr.h=null))}if(et.D){const $d=Dl.g?Dl.g.getResponseHeader("X-HTTP-Session-Id"):null;$d&&(et.ya=$d,tt(et.I,et.D,$d))}}ge.G=3,ge.l&&ge.l.ua(),ge.ba&&(ge.R=Date.now()-C.F,ge.j.info("Handshake RTT: "+ge.R+"ms")),et=ge;var Rr=C;if(et.qa=Va(et,et.J?et.ia:null,et.W),Rr.K){Nr(et.h,Rr);var ma=Rr,ei=et.L;ei&&(ma.I=ei),ma.B&&(pt(ma),ne(ma)),et.g=Rr}else Ar(et);0<ge.i.length&&R(ge)}else ra[0]!="stop"&&ra[0]!="close"||ka(ge,7);else ge.G==3&&(ra[0]=="stop"||ra[0]=="close"?ra[0]=="stop"?ka(ge,7):Bf(ge):ra[0]!="noop"&&ge.l&&ge.l.ta(ra),ge.v=0)}}Lt(4)}catch{}}var Ot=class{constructor(C,J){this.g=C,this.map=J}};function lr(C){this.l=C||10,l.PerformanceNavigationTiming?(C=l.performance.getEntriesByType("navigation"),C=0<C.length&&(C[0].nextHopProtocol=="hq"||C[0].nextHopProtocol=="h2")):C=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=C?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Dr(C){return C.h?!0:C.g?C.g.size>=C.j:!1}function br(C){return C.h?1:C.g?C.g.size:0}function nr(C,J){return C.h?C.h==J:C.g?C.g.has(J):!1}function ir(C,J){C.g?C.g.add(J):C.h=J}function Nr(C,J){C.h&&C.h==J?C.h=null:C.g&&C.g.has(J)&&C.g.delete(J)}lr.prototype.cancel=function(){if(this.i=Pr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const C of this.g.values())C.cancel();this.g.clear()}};function Pr(C){if(C.h!=null)return C.i.concat(C.h.D);if(C.g!=null&&C.g.size!==0){let J=C.i;for(const ge of C.g.values())J=J.concat(ge.D);return J}return p(C.i)}function xr(C){if(C.V&&typeof C.V=="function")return C.V();if(typeof Map<"u"&&C instanceof Map||typeof Set<"u"&&C instanceof Set)return Array.from(C.values());if(typeof C=="string")return C.split("");if(c(C)){for(var J=[],ge=C.length,et=0;et<ge;et++)J.push(C[et]);return J}J=[],ge=0;for(et in C)J[ge++]=C[et];return J}function $r(C){if(C.na&&typeof C.na=="function")return C.na();if(!C.V||typeof C.V!="function"){if(typeof Map<"u"&&C instanceof Map)return Array.from(C.keys());if(!(typeof Set<"u"&&C instanceof Set)){if(c(C)||typeof C=="string"){var J=[];C=C.length;for(var ge=0;ge<C;ge++)J.push(ge);return J}J=[],ge=0;for(const et in C)J[ge++]=et;return J}}}function cr(C,J){if(C.forEach&&typeof C.forEach=="function")C.forEach(J,void 0);else if(c(C)||typeof C=="string")Array.prototype.forEach.call(C,J,void 0);else for(var ge=$r(C),et=xr(C),Gt=et.length,tr=0;tr<Gt;tr++)J.call(void 0,et[tr],ge&&ge[tr],C)}var Zr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wr(C,J){if(C){C=C.split("&");for(var ge=0;ge<C.length;ge++){var et=C[ge].indexOf("="),Gt=null;if(0<=et){var tr=C[ge].substring(0,et);Gt=C[ge].substring(et+1)}else tr=C[ge];J(tr,Gt?decodeURIComponent(Gt.replace(/\+/g," ")):"")}}}function zr(C){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,C instanceof zr){this.h=C.h,Nn(this,C.j),this.o=C.o,this.g=C.g,Sn(this,C.s),this.l=C.l;var J=C.i,ge=new Qt;ge.i=J.i,J.g&&(ge.g=new Map(J.g),ge.h=J.h),fe(this,ge),this.m=C.m}else C&&(J=String(C).match(Zr))?(this.h=!1,Nn(this,J[1]||"",!0),this.o=mt(J[2]||""),this.g=mt(J[3]||"",!0),Sn(this,J[4]),this.l=mt(J[5]||"",!0),fe(this,J[6]||"",!0),this.m=mt(J[7]||"")):(this.h=!1,this.i=new Qt(null,this.h))}zr.prototype.toString=function(){var C=[],J=this.j;J&&C.push(Oe(J,It,!0),":");var ge=this.g;return(ge||J=="file")&&(C.push("//"),(J=this.o)&&C.push(Oe(J,It,!0),"@"),C.push(encodeURIComponent(String(ge)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ge=this.s,ge!=null&&C.push(":",String(ge))),(ge=this.l)&&(this.g&&ge.charAt(0)!="/"&&C.push("/"),C.push(Oe(ge,ge.charAt(0)=="/"?bt:Ct,!0))),(ge=this.i.toString())&&C.push("?",ge),(ge=this.m)&&C.push("#",Oe(ge,Jt)),C.join("")};function gn(C){return new zr(C)}function Nn(C,J,ge){C.j=ge?mt(J,!0):J,C.j&&(C.j=C.j.replace(/:$/,""))}function Sn(C,J){if(J){if(J=Number(J),isNaN(J)||0>J)throw Error("Bad port number "+J);C.s=J}else C.s=null}function fe(C,J,ge){J instanceof Qt?(C.i=J,tn(C.i,C.h)):(ge||(J=Oe(J,St)),C.i=new Qt(J,C.h))}function tt(C,J,ge){C.i.set(J,ge)}function vt(C){return tt(C,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),C}function mt(C,J){return C?J?decodeURI(C.replace(/%25/g,"%2525")):decodeURIComponent(C):""}function Oe(C,J,ge){return typeof C=="string"?(C=encodeURI(C).replace(J,At),ge&&(C=C.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C):null}function At(C){return C=C.charCodeAt(0),"%"+(C>>4&15).toString(16)+(C&15).toString(16)}var It=/[#\/\?@]/g,Ct=/[#\?:]/g,bt=/[#\?]/g,St=/[#\?@]/g,Jt=/#/g;function Qt(C,J){this.h=this.g=null,this.i=C||null,this.j=!!J}function ar(C){C.g||(C.g=new Map,C.h=0,C.i&&Wr(C.i,function(J,ge){C.add(decodeURIComponent(J.replace(/\+/g," ")),ge)}))}t=Qt.prototype,t.add=function(C,J){ar(this),this.i=null,C=Ut(this,C);var ge=this.g.get(C);return ge||this.g.set(C,ge=[]),ge.push(J),this.h+=1,this};function or(C,J){ar(C),J=Ut(C,J),C.g.has(J)&&(C.i=null,C.h-=C.g.get(J).length,C.g.delete(J))}function _r(C,J){return ar(C),J=Ut(C,J),C.g.has(J)}t.forEach=function(C,J){ar(this),this.g.forEach(function(ge,et){ge.forEach(function(Gt){C.call(J,Gt,et,this)},this)},this)},t.na=function(){ar(this);const C=Array.from(this.g.values()),J=Array.from(this.g.keys()),ge=[];for(let et=0;et<J.length;et++){const Gt=C[et];for(let tr=0;tr<Gt.length;tr++)ge.push(J[et])}return ge},t.V=function(C){ar(this);let J=[];if(typeof C=="string")_r(this,C)&&(J=J.concat(this.g.get(Ut(this,C))));else{C=Array.from(this.g.values());for(let ge=0;ge<C.length;ge++)J=J.concat(C[ge])}return J},t.set=function(C,J){return ar(this),this.i=null,C=Ut(this,C),_r(this,C)&&(this.h-=this.g.get(C).length),this.g.set(C,[J]),this.h+=1,this},t.get=function(C,J){return C?(C=this.V(C),0<C.length?String(C[0]):J):J};function Cr(C,J,ge){or(C,J),0<ge.length&&(C.i=null,C.g.set(Ut(C,J),p(ge)),C.h+=ge.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const C=[],J=Array.from(this.g.keys());for(var ge=0;ge<J.length;ge++){var et=J[ge];const tr=encodeURIComponent(String(et)),Rr=this.V(et);for(et=0;et<Rr.length;et++){var Gt=tr;Rr[et]!==""&&(Gt+="="+encodeURIComponent(String(Rr[et]))),C.push(Gt)}}return this.i=C.join("&")};function Ut(C,J){return J=String(J),C.j&&(J=J.toLowerCase()),J}function tn(C,J){J&&!C.j&&(ar(C),C.i=null,C.g.forEach(function(ge,et){var Gt=et.toLowerCase();et!=Gt&&(or(this,et),Cr(this,Gt,ge))},C)),C.j=J}function Gr(C,J){const ge=new te;if(l.Image){const et=new Image;et.onload=h(yr,ge,"TestLoadImage: loaded",!0,J,et),et.onerror=h(yr,ge,"TestLoadImage: error",!1,J,et),et.onabort=h(yr,ge,"TestLoadImage: abort",!1,J,et),et.ontimeout=h(yr,ge,"TestLoadImage: timeout",!1,J,et),l.setTimeout(function(){et.ontimeout&&et.ontimeout()},1e4),et.src=C}else J(!1)}function Ir(C,J){const ge=new te,et=new AbortController,Gt=setTimeout(()=>{et.abort(),yr(ge,"TestPingServer: timeout",!1,J)},1e4);fetch(C,{signal:et.signal}).then(tr=>{clearTimeout(Gt),tr.ok?yr(ge,"TestPingServer: ok",!0,J):yr(ge,"TestPingServer: server error",!1,J)}).catch(()=>{clearTimeout(Gt),yr(ge,"TestPingServer: error",!1,J)})}function yr(C,J,ge,et,Gt){try{Gt&&(Gt.onload=null,Gt.onerror=null,Gt.onabort=null,Gt.ontimeout=null),et(ge)}catch{}}function jr(){this.g=new _t}function Bn(C,J,ge){const et=ge||"";try{cr(C,function(Gt,tr){let Rr=Gt;u(Gt)&&(Rr=We(Gt)),J.push(et+tr+"="+encodeURIComponent(Rr))})}catch(Gt){throw J.push(et+"type="+encodeURIComponent("_badmap")),Gt}}function yn(C){this.l=C.Ub||null,this.j=C.eb||!1}m(yn,pe),yn.prototype.g=function(){return new mn(this.l,this.j)},yn.prototype.i=function(C){return function(){return C}}({});function mn(C,J){kt.call(this),this.D=C,this.o=J,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(mn,kt),t=mn.prototype,t.open=function(C,J){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=C,this.A=J,this.readyState=1,Yi(this)},t.send=function(C){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const J={headers:this.u,method:this.B,credentials:this.m,cache:void 0};C&&(J.body=C),(this.D||l).fetch(new Request(this.A,J)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ga(this)),this.readyState=0},t.Sa=function(C){if(this.g&&(this.l=C,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=C.headers,this.readyState=2,Yi(this)),this.g&&(this.readyState=3,Yi(this),this.g)))if(this.responseType==="arraybuffer")C.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in C){if(this.j=C.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ua(this)}else C.text().then(this.Ra.bind(this),this.ga.bind(this))};function ua(C){C.j.read().then(C.Pa.bind(C)).catch(C.ga.bind(C))}t.Pa=function(C){if(this.g){if(this.o&&C.value)this.response.push(C.value);else if(!this.o){var J=C.value?C.value:new Uint8Array(0);(J=this.v.decode(J,{stream:!C.done}))&&(this.response=this.responseText+=J)}C.done?ga(this):Yi(this),this.readyState==3&&ua(this)}},t.Ra=function(C){this.g&&(this.response=this.responseText=C,ga(this))},t.Qa=function(C){this.g&&(this.response=C,ga(this))},t.ga=function(){this.g&&ga(this)};function ga(C){C.readyState=4,C.l=null,C.j=null,C.v=null,Yi(C)}t.setRequestHeader=function(C,J){this.u.append(C,J)},t.getResponseHeader=function(C){return this.h&&this.h.get(C.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const C=[],J=this.h.entries();for(var ge=J.next();!ge.done;)ge=ge.value,C.push(ge[0]+": "+ge[1]),ge=J.next();return C.join(`\r
`)};function Yi(C){C.onreadystatechange&&C.onreadystatechange.call(C)}Object.defineProperty(mn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(C){this.m=C?"include":"same-origin"}});function Ji(C){let J="";return I(C,function(ge,et){J+=et,J+=":",J+=ge,J+=`\r
`}),J}function Fl(C,J,ge){e:{for(et in ge){var et=!1;break e}et=!0}et||(ge=Ji(ge),typeof C=="string"?ge!=null&&encodeURIComponent(String(ge)):tt(C,J,ge))}function xa(C){kt.call(this),this.headers=new Map,this.o=C||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(xa,kt);var Qn=/^https?$/i,du=["POST","PUT"];t=xa.prototype,t.Ha=function(C){this.J=C},t.ea=function(C,J,ge,et){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+C);J=J?J.toUpperCase():"GET",this.D=C,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Fe.g(),this.v=this.o?Pe(this.o):Pe(Fe),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(J,String(C),!0),this.B=!1}catch(tr){Ol(this,tr);return}if(C=ge||"",ge=new Map(this.headers),et)if(Object.getPrototypeOf(et)===Object.prototype)for(var Gt in et)ge.set(Gt,et[Gt]);else if(typeof et.keys=="function"&&typeof et.get=="function")for(const tr of et.keys())ge.set(tr,et.get(tr));else throw Error("Unknown input type for opt_headers: "+String(et));et=Array.from(ge.keys()).find(tr=>tr.toLowerCase()=="content-type"),Gt=l.FormData&&C instanceof l.FormData,!(0<=Array.prototype.indexOf.call(du,J,void 0))||et||Gt||ge.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[tr,Rr]of ge)this.g.setRequestHeader(tr,Rr);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{dc(this),this.u=!0,this.g.send(C),this.u=!1}catch(tr){Ol(this,tr)}};function Ol(C,J){C.h=!1,C.g&&(C.j=!0,C.g.abort(),C.j=!1),C.l=J,C.m=5,Zi(C),Mc(C)}function Zi(C){C.A||(C.A=!0,Ge(C,"complete"),Ge(C,"error"))}t.abort=function(C){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=C||7,Ge(this,"complete"),Ge(this,"abort"),Mc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mc(this,!0)),xa.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rc(this):this.bb())},t.bb=function(){Rc(this)};function Rc(C){if(C.h&&typeof o<"u"&&(!C.v[1]||ol(C)!=4||C.Z()!=2)){if(C.u&&ol(C)==4)Ue(C.Ea,0,C);else if(Ge(C,"readystatechange"),ol(C)==4){C.h=!1;try{const Rr=C.Z();e:switch(Rr){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var J=!0;break e;default:J=!1}var ge;if(!(ge=J)){var et;if(et=Rr===0){var Gt=String(C.D).match(Zr)[1]||null;!Gt&&l.self&&l.self.location&&(Gt=l.self.location.protocol.slice(0,-1)),et=!Qn.test(Gt?Gt.toLowerCase():"")}ge=et}if(ge)Ge(C,"complete"),Ge(C,"success");else{C.m=6;try{var tr=2<ol(C)?C.g.statusText:""}catch{tr=""}C.l=tr+" ["+C.Z()+"]",Zi(C)}}finally{Mc(C)}}}}function Mc(C,J){if(C.g){dc(C);const ge=C.g,et=C.v[0]?()=>{}:null;C.g=null,C.v=null,J||Ge(C,"ready");try{ge.onreadystatechange=et}catch{}}}function dc(C){C.I&&(l.clearTimeout(C.I),C.I=null)}t.isActive=function(){return!!this.g};function ol(C){return C.g?C.g.readyState:0}t.Z=function(){try{return 2<ol(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(C){if(this.g){var J=this.g.responseText;return C&&J.indexOf(C)==0&&(J=J.substring(C.length)),ct(J)}};function fu(C){try{if(!C.g)return null;if("response"in C.g)return C.g.response;switch(C.H){case"":case"text":return C.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in C.g)return C.g.mozResponseArrayBuffer}return null}catch{return null}}function KA(C){const J={};C=(C.g&&2<=ol(C)&&C.g.getAllResponseHeaders()||"").split(`\r
`);for(let et=0;et<C.length;et++){if(y(C[et]))continue;var ge=T(C[et]);const Gt=ge[0];if(ge=ge[1],typeof ge!="string")continue;ge=ge.trim();const tr=J[Gt]||[];J[Gt]=tr,tr.push(ge)}_(J,function(et){return et.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ll(C,J,ge){return ge&&ge.internalChannelParams&&ge.internalChannelParams[C]||J}function Lc(C){this.Aa=0,this.i=[],this.j=new te,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ll("failFast",!1,C),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ll("baseRetryDelayMs",5e3,C),this.cb=ll("retryDelaySeedMs",1e4,C),this.Wa=ll("forwardChannelMaxRetries",2,C),this.wa=ll("forwardChannelRequestTimeoutMs",2e4,C),this.pa=C&&C.xmlHttpFactory||void 0,this.Xa=C&&C.Tb||void 0,this.Ca=C&&C.useFetchStreams||!1,this.L=void 0,this.J=C&&C.supportsCrossDomainXhr||!1,this.K="",this.h=new lr(C&&C.concurrentRequestLimit),this.Da=new jr,this.P=C&&C.fastHandshake||!1,this.O=C&&C.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=C&&C.Rb||!1,C&&C.xa&&this.j.xa(),C&&C.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&C&&C.detectBufferingProxy||!1,this.ja=void 0,C&&C.longPollingTimeout&&0<C.longPollingTimeout&&(this.ja=C.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Lc.prototype,t.la=8,t.G=1,t.connect=function(C,J,ge,et){_e(0),this.W=C,this.H=J||{},ge&&et!==void 0&&(this.H.OSID=ge,this.H.OAID=et),this.F=this.X,this.I=Va(this,null,this.W),R(this)};function Bf(C){if(zu(C),C.G==3){var J=C.U++,ge=gn(C.I);if(tt(ge,"SID",C.K),tt(ge,"RID",J),tt(ge,"TYPE","terminate"),wt(C,ge),J=new Be(C,C.j,J),J.L=2,J.v=vt(gn(ge)),ge=!1,l.navigator&&l.navigator.sendBeacon)try{ge=l.navigator.sendBeacon(J.v.toString(),"")}catch{}!ge&&l.Image&&(new Image().src=J.v,ge=!0),ge||(J.g=pi(J.j,null),J.g.ea(J.v)),J.F=Date.now(),ne(J)}Ys(C)}function fo(C){C.g&&(nn(C),C.g.cancel(),C.g=null)}function zu(C){fo(C),C.u&&(l.clearTimeout(C.u),C.u=null),Tn(C),C.h.cancel(),C.s&&(typeof C.s=="number"&&l.clearTimeout(C.s),C.s=null)}function R(C){if(!Dr(C.h)&&!C.s){C.s=!0;var J=C.Ga;ue||ke(),me||(ue(),me=!0),se.add(J,C),C.B=0}}function je(C,J){return br(C.h)>=C.h.j-(C.s?1:0)?!1:C.s?(C.i=J.D.concat(C.i),!0):C.G==1||C.G==2||C.B>=(C.Va?0:C.Wa)?!1:(C.s=ye(A(C.Ga,C,J),da(C,C.B)),C.B++,!0)}t.Ga=function(C){if(this.s)if(this.s=null,this.G==1){if(!C){this.U=Math.floor(1e5*Math.random()),C=this.U++;const Gt=new Be(this,this.j,C);let tr=this.o;if(this.S&&(tr?(tr=S(tr),B(tr,this.S)):tr=this.S),this.m!==null||this.O||(Gt.H=tr,tr=null),this.P)e:{for(var J=0,ge=0;ge<this.i.length;ge++){t:{var et=this.i[ge];if("__data__"in et.map&&(et=et.map.__data__,typeof et=="string")){et=et.length;break t}et=void 0}if(et===void 0)break;if(J+=et,4096<J){J=ge;break e}if(J===4096||ge===this.i.length-1){J=ge+1;break e}}J=1e3}else J=1e3;J=Vt(this,Gt,J),ge=gn(this.I),tt(ge,"RID",C),tt(ge,"CVER",22),this.D&&tt(ge,"X-HTTP-Session-Id",this.D),wt(this,ge),tr&&(this.O?J="headers="+encodeURIComponent(String(Ji(tr)))+"&"+J:this.m&&Fl(ge,this.m,tr)),ir(this.h,Gt),this.Ua&&tt(ge,"TYPE","init"),this.P?(tt(ge,"$req",J),tt(ge,"SID","null"),Gt.T=!0,Pt(Gt,ge,null)):Pt(Gt,ge,J),this.G=2}}else this.G==3&&(C?ut(this,C):this.i.length==0||Dr(this.h)||ut(this))};function ut(C,J){var ge;J?ge=J.l:ge=C.U++;const et=gn(C.I);tt(et,"SID",C.K),tt(et,"RID",ge),tt(et,"AID",C.T),wt(C,et),C.m&&C.o&&Fl(et,C.m,C.o),ge=new Be(C,C.j,ge,C.B+1),C.m===null&&(ge.H=C.o),J&&(C.i=J.D.concat(C.i)),J=Vt(C,ge,1e3),ge.I=Math.round(.5*C.wa)+Math.round(.5*C.wa*Math.random()),ir(C.h,ge),Pt(ge,et,J)}function wt(C,J){C.H&&I(C.H,function(ge,et){tt(J,et,ge)}),C.l&&cr({},function(ge,et){tt(J,et,ge)})}function Vt(C,J,ge){ge=Math.min(C.i.length,ge);var et=C.l?A(C.l.Na,C.l,C):null;e:{var Gt=C.i;let tr=-1;for(;;){const Rr=["count="+ge];tr==-1?0<ge?(tr=Gt[0].g,Rr.push("ofs="+tr)):tr=0:Rr.push("ofs="+tr);let ma=!0;for(let ei=0;ei<ge;ei++){let ra=Gt[ei].g;const Sa=Gt[ei].map;if(ra-=tr,0>ra)tr=Math.max(0,Gt[ei].g-100),ma=!1;else try{Bn(Sa,Rr,"req"+ra+"_")}catch{et&&et(Sa)}}if(ma){et=Rr.join("&");break e}}}return C=C.i.splice(0,ge),J.D=C,et}function Ar(C){if(!C.g&&!C.u){C.Y=1;var J=C.Fa;ue||ke(),me||(ue(),me=!0),se.add(J,C),C.v=0}}function wr(C){return C.g||C.u||3<=C.v?!1:(C.Y++,C.u=ye(A(C.Fa,C),da(C,C.v)),C.v++,!0)}t.Fa=function(){if(this.u=null,un(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var C=2*this.R;this.j.info("BP detection timer enabled: "+C),this.A=ye(A(this.ab,this),C)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_e(10),fo(this),un(this))};function nn(C){C.A!=null&&(l.clearTimeout(C.A),C.A=null)}function un(C){C.g=new Be(C,C.j,"rpc",C.Y),C.m===null&&(C.g.H=C.o),C.g.O=0;var J=gn(C.qa);tt(J,"RID","rpc"),tt(J,"SID",C.K),tt(J,"AID",C.T),tt(J,"CI",C.F?"0":"1"),!C.F&&C.ja&&tt(J,"TO",C.ja),tt(J,"TYPE","xmlhttp"),wt(C,J),C.m&&C.o&&Fl(J,C.m,C.o),C.L&&(C.g.I=C.L);var ge=C.g;C=C.ia,ge.L=1,ge.v=vt(gn(J)),ge.m=null,ge.P=!0,he(ge,C)}t.Za=function(){this.C!=null&&(this.C=null,fo(this),wr(this),_e(19))};function Tn(C){C.C!=null&&(l.clearTimeout(C.C),C.C=null)}function Vn(C,J){var ge=null;if(C.g==J){Tn(C),nn(C),C.g=null;var et=2}else if(nr(C.h,J))ge=J.D,Nr(C.h,J),et=1;else return;if(C.G!=0){if(J.o)if(et==1){ge=J.m?J.m.length:0,J=Date.now()-J.F;var Gt=C.B;et=Nt(),Ge(et,new U(et,ge)),R(C)}else Ar(C);else if(Gt=J.s,Gt==3||Gt==0&&0<J.X||!(et==1&&je(C,J)||et==2&&wr(C)))switch(ge&&0<ge.length&&(J=C.h,J.i=J.i.concat(ge)),Gt){case 1:ka(C,5);break;case 4:ka(C,10);break;case 3:ka(C,6);break;default:ka(C,2)}}}function da(C,J){let ge=C.Ta+Math.floor(Math.random()*C.cb);return C.isActive()||(ge*=2),ge*J}function ka(C,J){if(C.j.info("Error code "+J),J==2){var ge=A(C.fb,C),et=C.Xa;const Gt=!et;et=new zr(et||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Nn(et,"https"),vt(et),Gt?Gr(et.toString(),ge):Ir(et.toString(),ge)}else _e(2);C.G=0,C.l&&C.l.sa(J),Ys(C),zu(C)}t.fb=function(C){C?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))};function Ys(C){if(C.G=0,C.ka=[],C.l){const J=Pr(C.h);(J.length!=0||C.i.length!=0)&&(x(C.ka,J),x(C.ka,C.i),C.h.i.length=0,p(C.i),C.i.length=0),C.l.ra()}}function Va(C,J,ge){var et=ge instanceof zr?gn(ge):new zr(ge);if(et.g!="")J&&(et.g=J+"."+et.g),Sn(et,et.s);else{var Gt=l.location;et=Gt.protocol,J=J?J+"."+Gt.hostname:Gt.hostname,Gt=+Gt.port;var tr=new zr(null);et&&Nn(tr,et),J&&(tr.g=J),Gt&&Sn(tr,Gt),ge&&(tr.l=ge),et=tr}return ge=C.D,J=C.ya,ge&&J&&tt(et,ge,J),tt(et,"VER",C.la),wt(C,et),et}function pi(C,J,ge){if(J&&!C.J)throw Error("Can't create secondary domain capable XhrIo object.");return J=C.Ca&&!C.pa?new xa(new yn({eb:ge})):new xa(C.pa),J.Ha(C.J),J}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Js(){}t=Js.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function gi(){}gi.prototype.g=function(C,J){return new Zs(C,J)};function Zs(C,J){kt.call(this),this.g=new Lc(J),this.l=C,this.h=J&&J.messageUrlParams||null,C=J&&J.messageHeaders||null,J&&J.clientProtocolHeaderRequired&&(C?C["X-Client-Protocol"]="webchannel":C={"X-Client-Protocol":"webchannel"}),this.g.o=C,C=J&&J.initMessageHeaders||null,J&&J.messageContentType&&(C?C["X-WebChannel-Content-Type"]=J.messageContentType:C={"X-WebChannel-Content-Type":J.messageContentType}),J&&J.va&&(C?C["X-WebChannel-Client-Profile"]=J.va:C={"X-WebChannel-Client-Profile":J.va}),this.g.S=C,(C=J&&J.Sb)&&!y(C)&&(this.g.m=C),this.v=J&&J.supportsCrossDomainXhr||!1,this.u=J&&J.sendRawJson||!1,(J=J&&J.httpSessionIdParam)&&!y(J)&&(this.g.D=J,C=this.h,C!==null&&J in C&&(C=this.h,J in C&&delete C[J])),this.j=new Xu(this)}m(Zs,kt),Zs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zs.prototype.close=function(){Bf(this.g)},Zs.prototype.o=function(C){var J=this.g;if(typeof C=="string"){var ge={};ge.__data__=C,C=ge}else this.u&&(ge={},ge.__data__=We(C),C=ge);J.i.push(new Ot(J.Ya++,C)),J.G==3&&R(J)},Zs.prototype.N=function(){this.g.l=null,delete this.j,Bf(this.g),delete this.g,Zs.aa.N.call(this)};function Uc(C){xe.call(this),C.__headers__&&(this.headers=C.__headers__,this.statusCode=C.__status__,delete C.__headers__,delete C.__status__);var J=C.__sm__;if(J){e:{for(const ge in J){C=ge;break e}C=void 0}(this.i=C)&&(C=this.i,J=J!==null&&C in J?J[C]:void 0),this.data=J}else this.data=C}m(Uc,xe);function Wu(){Se.call(this),this.status=1}m(Wu,Se);function Xu(C){this.g=C}m(Xu,Js),Xu.prototype.ua=function(){Ge(this.g,"a")},Xu.prototype.ta=function(C){Ge(this.g,new Uc(C))},Xu.prototype.sa=function(C){Ge(this.g,new Wu)},Xu.prototype.ra=function(){Ge(this.g,"b")},gi.prototype.createWebChannel=gi.prototype.g,Zs.prototype.send=Zs.prototype.o,Zs.prototype.open=Zs.prototype.m,Zs.prototype.close=Zs.prototype.close,FJ=function(){return new gi},kJ=function(){return Nt()},TJ=gt,VT={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},re.NO_ERROR=0,re.TIMEOUT=8,re.HTTP_ERROR=6,nE=re,we.COMPLETE="complete",BJ=we,Ee.EventType=Ze,Ze.OPEN="a",Ze.CLOSE="b",Ze.ERROR="c",Ze.MESSAGE="d",kt.prototype.listen=kt.prototype.K,Ry=Ee,xa.prototype.listenOnce=xa.prototype.L,xa.prototype.getLastError=xa.prototype.Ka,xa.prototype.getLastErrorCode=xa.prototype.Ba,xa.prototype.getStatus=xa.prototype.Z,xa.prototype.getResponseJson=xa.prototype.Oa,xa.prototype.getResponseText=xa.prototype.oa,xa.prototype.send=xa.prototype.ea,xa.prototype.setWithCredentials=xa.prototype.Ha,PJ=xa}).apply(typeof eC<"u"?eC:typeof self<"u"?self:typeof window<"u"?window:{});const m7="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nl.UNAUTHENTICATED=new Nl(null),Nl.GOOGLE_CREDENTIALS=new Nl("google-credentials-uid"),Nl.FIRST_PARTY=new Nl("first-party-uid"),Nl.MOCK_USER=new Nl("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let o1="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=new CD("@firebase/firestore");function Cx(){return ng.logLevel}function kr(t,...e){if(ng.logLevel<=ha.DEBUG){const r=e.map(QD);ng.debug(`Firestore (${o1}): ${t}`,...r)}}function _c(t,...e){if(ng.logLevel<=ha.ERROR){const r=e.map(QD);ng.error(`Firestore (${o1}): ${t}`,...r)}}function xm(t,...e){if(ng.logLevel<=ha.WARN){const r=e.map(QD);ng.warn(`Firestore (${o1}): ${t}`,...r)}}function QD(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(t="Unexpected state"){const e=`FIRESTORE (${o1}) INTERNAL ASSERTION FAILED: `+t;throw _c(e),new Error(e)}function An(t,e){t||cn()}function Ln(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ur extends TA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OJ{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class DJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Nl.UNAUTHENTICATED))}shutdown(){}}class Fxe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Oxe{constructor(e){this.t=e,this.currentUser=Nl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){An(this.o===void 0);let n=this.i;const a=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new pf;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pf,e.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await a(this.currentUser)})},l=c=>{kr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(kr("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pf)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(kr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(An(typeof n.accessToken=="string"),new OJ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return An(e===null||typeof e=="string"),new Nl(e)}}class Dxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Nl.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Rxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Dxe(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Nl.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Mxe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Lxe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){An(this.o===void 0);const n=s=>{s.error!=null&&kr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,kr("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{kr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?a(s):kr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(An(typeof r.token=="string"),this.R=r.token,new Mxe(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uxe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=Uxe(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=e.charAt(a[s]%e.length))}return n}}function Gn(t,e){return t<e?-1:t>e?1:0}function Pv(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}function RJ(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ur(hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ur(hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ur(hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ur(hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return vr.fromMillis(Date.now())}static fromDate(e){return vr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new vr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Gn(this.nanoseconds,e.nanoseconds):Gn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new wn(e)}static min(){return new wn(new vr(0,0))}static max(){return new wn(new vr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e,r,n){r===void 0?r=0:r>e.length&&cn(),n===void 0?n=e.length-r:n>e.length-r&&cn(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return u2.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof u2?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const s=e.get(a),o=r.get(a);if(s<o)return-1;if(s>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Pa extends u2{construct(e,r,n){return new Pa(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ur(hr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new Pa(r)}static emptyPath(){return new Pa([])}}const Qxe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hs extends u2{construct(e,r,n){return new Hs(e,r,n)}static isValidIdentifier(e){return Qxe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Hs(["__name__"])}static fromServerFormat(e){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Ur(hr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new Ur(hr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[a+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ur(hr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(n+=l,a++):(s(),a++)}if(s(),o)throw new Ur(hr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hs(r)}static emptyPath(){return new Hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.path=e}static fromPath(e){return new Xr(Pa.fromString(e))}static fromName(e){return new Xr(Pa.fromString(e).popFirst(5))}static empty(){return new Xr(Pa.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pa.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Pa.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xr(new Pa(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,r,n,a){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=a}}function HT(t){return t.fields.find(e=>e.kind===2)}function op(t){return t.fields.filter(e=>e.kind!==2)}sS.UNKNOWN_ID=-1;class aE{constructor(e,r){this.fieldPath=e,this.kind=r}}class d2{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new d2(0,Qu.min())}}function Vxe(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=wn.fromTimestamp(n===1e9?new vr(r+1,0):new vr(r,n));return new Qu(a,Xr.empty(),e)}function MJ(t){return new Qu(t.readTime,t.key,-1)}class Qu{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Qu(wn.min(),Xr.empty(),-1)}static max(){return new Qu(wn.max(),Xr.empty(),-1)}}function HD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Xr.comparator(t.documentKey,e.documentKey),r!==0?r:Gn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class UJ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jg(t){if(t.code!==hr.FAILED_PRECONDITION||t.message!==LJ)throw t;kr("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&cn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Yt((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Yt?r:Yt.resolve(r)}catch(r){return Yt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Yt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Yt.reject(r)}static resolve(e){return new Yt((r,n)=>{r(e)})}static reject(e){return new Yt((r,n)=>{n(e)})}static waitFor(e){return new Yt((r,n)=>{let a=0,s=0,o=!1;e.forEach(l=>{++a,l.next(()=>{++s,o&&s===a&&r()},c=>n(c))}),o=!0,s===a&&r()})}static or(e){let r=Yt.resolve(!1);for(const n of e)r=r.next(a=>a?Yt.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(e,r){return new Yt((n,a)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;r(e[u]).next(d=>{o[u]=d,++l,l===s&&n(o)},d=>a(d))}})}static doWhile(e,r){return new Yt((n,a)=>{const s=()=>{e()===!0?r().next(()=>{s()},a):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new pf,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new hb(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const a=$D(n.target.error);this.V.reject(new hb(e,a))}}static open(e,r,n,a){try{return new bj(r,e.transaction(a,n))}catch(s){throw new hb(r,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(kr("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new $xe(r)}}class cm{constructor(e,r,n){this.name=e,this.version=r,this.p=n,cm.S(Fo())===12.2&&_c("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return kr("SimpleDb","Removing database:",e),Ap(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!$Y())return!1;if(cm.v())return!0;const e=Fo(),r=cm.S(e),n=0<r&&r<10,a=QJ(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(kr("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const o=s.target.result;r(o)},a.onblocked=()=>{n(new hb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Ur(hr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Ur(hr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new hb(e,o))},a.onupgradeneeded=s=>{kr("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,a.transaction,s.oldVersion,this.version).next(()=>{kr("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,a){const s=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=bj.open(this.db,e,s?"readonly":"readwrite",n),c=a(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Yt.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(kr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function QJ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Hxe{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ap(this.B.delete())}}class hb extends Ur{constructor(e,r){super(hr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Mm(t){return t.name==="IndexedDbTransactionError"}class $xe{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(kr("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(kr("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ap(n)}add(e){return kr("SimpleDb","ADD",this.store.name,e,e),Ap(this.store.add(e))}get(e){return Ap(this.store.get(e)).next(r=>(r===void 0&&(r=null),kr("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return kr("SimpleDb","DELETE",this.store.name,e),Ap(this.store.delete(e))}count(){return kr("SimpleDb","COUNT",this.store.name),Ap(this.store.count())}U(e,r){const n=this.options(e,r),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new Yt((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(n),o=[];return this.W(s,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Yt((a,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{a(o.target.result)}})}j(e,r){kr("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const a=this.cursor(n);return this.W(a,(s,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const a=this.cursor(n);return this.W(a,r)}Y(e){const r=this.cursor({});return new Yt((n,a)=>{r.onerror=s=>{const o=$D(s.target.error);a(o)},r.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new Yt((a,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void a();const c=new Hxe(l),u=r(l.primaryKey,l.value,c);if(u instanceof Yt){const d=u.catch(f=>(c.done(),Yt.reject(f)));n.push(d)}c.isDone?a():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Yt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function Ap(t){return new Yt((e,r)=>{t.onsuccess=n=>{const a=n.target.result;e(a)},t.onerror=n=>{const a=$D(n.target.error);r(a)}})}let p7=!1;function $D(t){const e=cm.S(Fo());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Ur("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return p7||(p7=!0,setTimeout(()=>{throw n},0)),n}}return t}class Gxe{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){kr("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{kr("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){Mm(r)?kr("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await jg(r)}await this.X(6e4)})}}class Kxe{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let a=r,s=!0;return Yt.doWhile(()=>s===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return kr("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,a).next(l=>{a-=l,n.add(o)});s=!1})).next(()=>r-a)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(a=>this.localStore.localDocuments.getNextDocuments(e,r,a,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(a,s)).next(l=>(kr("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((a,s)=>{const o=MJ(s);HD(o,n)>0&&(n=o)}),new Qu(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}wd.oe=-1;function Cw(t){return t==null}function f2(t){return t===0&&1/t==-1/0}function qxe(t){return typeof t=="number"&&Number.isInteger(t)&&!f2(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=g7(e)),e=zxe(t.get(r),e);return g7(e)}function zxe(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const s=t.charAt(a);switch(s){case"\0":r+="";break;case"":r+="";break;default:r+=s}}return r}function g7(t){return t+""}function Xf(t){const e=t.length;if(An(e>=2),e===2)return An(t.charAt(0)===""&&t.charAt(1)===""),Pa.emptyPath();const r=e-2,n=[];let a="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>r)&&cn(),t.charAt(o+1)){case"":const l=t.substring(s,o);let c;a.length===0?c=l:(a+=l,c=a,a=""),n.push(c);break;case"":a+=t.substring(s,o),a+="\0";break;case"":a+=t.substring(s,o+1);break;default:cn()}s=o+2}return new Pa(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x7=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(t,e){return[t,jc(e)]}function VJ(t,e,r){return[t,jc(e),r]}const Wxe={},Xxe=["prefixPath","collectionGroup","readTime","documentId"],Yxe=["prefixPath","collectionGroup","documentId"],Jxe=["collectionGroup","readTime","prefixPath","documentId"],Zxe=["canonicalId","targetId"],eve=["targetId","path"],tve=["path","targetId"],rve=["collectionId","parent"],nve=["indexId","uid"],ave=["uid","sequenceNumber"],sve=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ive=["indexId","uid","orderedDocumentKey"],ove=["userId","collectionPath","documentId"],lve=["userId","collectionPath","largestBatchId"],cve=["userId","collectionGroup","largestBatchId"],HJ=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],uve=[...HJ,"documentOverlays"],$J=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],GJ=$J,GD=[...GJ,"indexConfiguration","indexState","indexEntries"],dve=GD,fve=[...GD,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T extends UJ{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function Do(t,e){const r=Ln(t);return cm.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v7(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Pg(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function KJ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,r){this.comparator=e,this.root=r||Cl.EMPTY}insert(e,r){return new Ws(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Cl.BLACK,null,null))}remove(e){return new Ws(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cl.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tC(this.root,e,this.comparator,!1)}getReverseIterator(){return new tC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tC(this.root,e,this.comparator,!0)}}class tC{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cl{constructor(e,r,n,a,s){this.key=e,this.value=r,this.color=n??Cl.RED,this.left=a??Cl.EMPTY,this.right=s??Cl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,s){return new Cl(e??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Cl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return Cl.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw cn();const e=this.left.check();if(e!==this.right.check())throw cn();return e+(this.isRed()?0:1)}}Cl.EMPTY=null,Cl.RED=!0,Cl.BLACK=!1;Cl.EMPTY=new class{constructor(){this.size=0}get key(){throw cn()}get value(){throw cn()}get color(){throw cn()}get left(){throw cn()}get right(){throw cn()}copy(e,r,n,a,s){return this}insert(e,r,n){return new Cl(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e){this.comparator=e,this.data=new Ws(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new y7(this.data.getIterator())}getIteratorFrom(e){return new y7(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof us)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new us(this.comparator);return r.data=e,r}}class y7{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Jg(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e){this.fields=e,e.sort(Hs.comparator)}static empty(){return new eu([])}unionWith(e){let r=new us(Hs.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new eu(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Pv(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qJ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new qJ("Invalid base64 string: "+s):s}}(e);return new Wi(r)}static fromUint8Array(e){const r=function(a){let s="";for(let o=0;o<a.length;++o)s+=String.fromCharCode(a[o]);return s}(e);return new Wi(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Gn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wi.EMPTY_BYTE_STRING=new Wi("");const hve=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xA(t){if(An(!!t),typeof t=="string"){let e=0;const r=hve.exec(t);if(An(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Us(t.seconds),nanos:Us(t.nanos)}}function Us(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vm(t){return typeof t=="string"?Wi.fromBase64String(t):Wi.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KD(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function qD(t){const e=t.mapValue.fields.__previous_value__;return KD(e)?qD(e):e}function h2(t){const e=xA(t.mapValue.fields.__local_write_time__.timestampValue);return new vr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ave{constructor(e,r,n,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class ym{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new ym("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ym&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},iE={nullValue:"NULL_VALUE"};function ag(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?KD(t)?4:zJ(t)?9007199254740991:wj(t)?10:11:cn()}function oh(t,e){if(t===e)return!0;const r=ag(t);if(r!==ag(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return h2(t).isEqual(h2(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const o=xA(a.timestampValue),l=xA(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,s){return vm(a.bytesValue).isEqual(vm(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,s){return Us(a.geoPointValue.latitude)===Us(s.geoPointValue.latitude)&&Us(a.geoPointValue.longitude)===Us(s.geoPointValue.longitude)}(t,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return Us(a.integerValue)===Us(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const o=Us(a.doubleValue),l=Us(s.doubleValue);return o===l?f2(o)===f2(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Pv(t.arrayValue.values||[],e.arrayValue.values||[],oh);case 10:case 11:return function(a,s){const o=a.mapValue.fields||{},l=s.mapValue.fields||{};if(v7(o)!==v7(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!oh(o[c],l[c])))return!1;return!0}(t,e);default:return cn()}}function A2(t,e){return(t.values||[]).find(r=>oh(r,e))!==void 0}function bm(t,e){if(t===e)return 0;const r=ag(t),n=ag(e);if(r!==n)return Gn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Gn(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Us(s.integerValue||s.doubleValue),c=Us(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return b7(t.timestampValue,e.timestampValue);case 4:return b7(h2(t),h2(e));case 5:return Gn(t.stringValue,e.stringValue);case 6:return function(s,o){const l=vm(s),c=vm(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Gn(l[u],c[u]);if(d!==0)return d}return Gn(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=Gn(Us(s.latitude),Us(o.latitude));return l!==0?l:Gn(Us(s.longitude),Us(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return w7(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,d;const f=s.fields||{},A=o.fields||{},h=(l=f.value)===null||l===void 0?void 0:l.arrayValue,m=(c=A.value)===null||c===void 0?void 0:c.arrayValue,p=Gn(((u=h==null?void 0:h.values)===null||u===void 0?void 0:u.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:w7(h,m)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===$0.mapValue&&o===$0.mapValue)return 0;if(s===$0.mapValue)return 1;if(o===$0.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const A=Gn(c[f],d[f]);if(A!==0)return A;const h=bm(l[c[f]],u[d[f]]);if(h!==0)return h}return Gn(c.length,d.length)}(t.mapValue,e.mapValue);default:throw cn()}}function b7(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Gn(t,e);const r=xA(t),n=xA(e),a=Gn(r.seconds,n.seconds);return a!==0?a:Gn(r.nanos,n.nanos)}function w7(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=bm(r[a],n[a]);if(s)return s}return Gn(r.length,n.length)}function Bv(t){return GT(t)}function GT(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=xA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return vm(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Xr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const s of r.values||[])a?a=!1:n+=",",n+=GT(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",s=!0;for(const o of n)s?s=!1:a+=",",a+=`${o}:${GT(r.fields[o])}`;return a+"}"}(t.mapValue):cn()}function m2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function KT(t){return!!t&&"integerValue"in t}function p2(t){return!!t&&"arrayValue"in t}function N7(t){return!!t&&"nullValue"in t}function C7(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function oE(t){return!!t&&"mapValue"in t}function wj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Ab(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Pg(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ab(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ab(t.arrayValue.values[r]);return e}return Object.assign({},t)}function zJ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const WJ={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function mve(t){return"nullValue"in t?iE:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?m2(ym.empty(),Xr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?wj(t)?WJ:{mapValue:{}}:cn()}function pve(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?m2(ym.empty(),Xr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?WJ:"mapValue"in t?wj(t)?{mapValue:{}}:$0:cn()}function _7(t,e){const r=bm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function E7(t,e){const r=bm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e){this.value=e}static empty(){return new El({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!oE(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ab(r)}setAll(e){let r=Hs.emptyPath(),n={},a=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,a),n={},a=[],r=l.popLast()}o?n[l.lastSegment()]=Ab(o):a.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(e){const r=this.field(e.popLast());oE(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return oh(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];oE(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Pg(r,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new El(Ab(this.value))}}function XJ(t){const e=[];return Pg(t.fields,(r,n)=>{const a=new Hs([r]);if(oE(n)){const s=XJ(n.mapValue).fields;if(s.length===0)e.push(a);else for(const o of s)e.push(a.child(o))}else e.push(a)}),new eu(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,r,n,a,s,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Vs(e,0,wn.min(),wn.min(),wn.min(),El.empty(),0)}static newFoundDocument(e,r,n,a){return new Vs(e,1,r,wn.min(),n,a,0)}static newNoDocument(e,r){return new Vs(e,2,r,wn.min(),wn.min(),El.empty(),0)}static newUnknownDocument(e,r){return new Vs(e,3,r,wn.min(),wn.min(),El.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(wn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=El.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=El.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=wn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,r){this.position=e,this.inclusive=r}}function S7(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const s=e[a],o=t.position[a];if(s.field.isKeyField()?n=Xr.comparator(Xr.fromName(o.referenceValue),r.key):n=bm(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function I7(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!oh(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e,r="asc"){this.field=e,this.dir=r}}function gve(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YJ{}class Aa extends YJ{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new xve(e,r,n):r==="array-contains"?new bve(e,n):r==="in"?new nZ(e,n):r==="not-in"?new wve(e,n):r==="array-contains-any"?new Nve(e,n):new Aa(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new vve(e,n):new yve(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(bm(r,this.value)):r!==null&&ag(this.value)===ag(r)&&this.matchesComparison(bm(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return cn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends YJ{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ts(e,r)}matches(e){return kv(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function kv(t){return t.op==="and"}function qT(t){return t.op==="or"}function zD(t){return JJ(t)&&kv(t)}function JJ(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function zT(t){if(t instanceof Aa)return t.field.canonicalString()+t.op.toString()+Bv(t.value);if(zD(t))return t.filters.map(e=>zT(e)).join(",");{const e=t.filters.map(r=>zT(r)).join(",");return`${t.op}(${e})`}}function ZJ(t,e){return t instanceof Aa?function(n,a){return a instanceof Aa&&n.op===a.op&&n.field.isEqual(a.field)&&oh(n.value,a.value)}(t,e):t instanceof ts?function(n,a){return a instanceof ts&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,o,l)=>s&&ZJ(o,a.filters[l]),!0):!1}(t,e):void cn()}function eZ(t,e){const r=t.filters.concat(e);return ts.create(r,t.op)}function tZ(t){return t instanceof Aa?function(r){return`${r.field.canonicalString()} ${r.op} ${Bv(r.value)}`}(t):t instanceof ts?function(r){return r.op.toString()+" {"+r.getFilters().map(tZ).join(" ,")+"}"}(t):"Filter"}class xve extends Aa{constructor(e,r,n){super(e,r,n),this.key=Xr.fromName(n.referenceValue)}matches(e){const r=Xr.comparator(e.key,this.key);return this.matchesComparison(r)}}class vve extends Aa{constructor(e,r){super(e,"in",r),this.keys=rZ("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class yve extends Aa{constructor(e,r){super(e,"not-in",r),this.keys=rZ("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function rZ(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Xr.fromName(n.referenceValue))}class bve extends Aa{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return p2(r)&&A2(r.arrayValue,this.value)}}class nZ extends Aa{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&A2(this.value.arrayValue,r)}}class wve extends Aa{constructor(e,r){super(e,"not-in",r)}matches(e){if(A2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!A2(this.value.arrayValue,r)}}class Nve extends Aa{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!p2(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>A2(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cve{constructor(e,r=null,n=[],a=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function WT(t,e=null,r=[],n=[],a=null,s=null,o=null){return new Cve(t,e,r,n,a,s,o)}function sg(t){const e=Ln(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>zT(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Cw(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Bv(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Bv(n)).join(",")),e.ue=r}return e.ue}function _w(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!gve(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!ZJ(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!I7(t.startAt,e.startAt)&&I7(t.endAt,e.endAt)}function iS(t){return Xr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function oS(t,e){return t.filters.filter(r=>r instanceof Aa&&r.field.isEqual(e))}function j7(t,e,r){let n=iE,a=!0;for(const s of oS(t,e)){let o=iE,l=!0;switch(s.op){case"<":case"<=":o=mve(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=iE}_7({value:n,inclusive:a},{value:o,inclusive:l})<0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];_7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})<0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}function P7(t,e,r){let n=$0,a=!0;for(const s of oS(t,e)){let o=$0,l=!0;switch(s.op){case">=":case">":o=pve(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=$0}E7({value:n,inclusive:a},{value:o,inclusive:l})>0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];E7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})>0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,r=null,n=[],a=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function _ve(t,e,r,n,a,s,o,l){return new l1(t,e,r,n,a,s,o,l)}function Ew(t){return new l1(t)}function B7(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function aZ(t){return t.collectionGroup!==null}function mb(t){const e=Ln(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new us(Hs.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new g2(s,n))}),r.has(Hs.keyField().canonicalString())||e.ce.push(new g2(Hs.keyField(),n))}return e.ce}function Id(t){const e=Ln(t);return e.le||(e.le=Eve(e,mb(t))),e.le}function Eve(t,e){if(t.limitType==="F")return WT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new g2(a.field,s)});const r=t.endAt?new Tv(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Tv(t.startAt.position,t.startAt.inclusive):null;return WT(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function XT(t,e){const r=t.filters.concat([e]);return new l1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function lS(t,e,r){return new l1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Nj(t,e){return _w(Id(t),Id(e))&&t.limitType===e.limitType}function sZ(t){return`${sg(Id(t))}|lt:${t.limitType}`}function _x(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>tZ(a)).join(", ")}]`),Cw(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>Bv(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>Bv(a)).join(",")),`Target(${n})`}(Id(t))}; limitType=${t.limitType})`}function Sw(t,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Xr.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,a){for(const s of mb(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(o,l,c){const u=S7(o,l,c);return o.inclusive?u<=0:u<0}(n.startAt,mb(n),a)||n.endAt&&!function(o,l,c){const u=S7(o,l,c);return o.inclusive?u>=0:u>0}(n.endAt,mb(n),a))}(t,e)}function Sve(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function iZ(t){return(e,r)=>{let n=!1;for(const a of mb(t)){const s=Ive(a,e,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function Ive(t,e,r){const n=t.field.isKeyField()?Xr.comparator(e.key,r.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?bm(c,u):cn()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return cn()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Pg(this.inner,(r,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return KJ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jve=new Ws(Xr.comparator);function Fu(){return jve}const oZ=new Ws(Xr.comparator);function My(...t){let e=oZ;for(const r of t)e=e.insert(r.key,r);return e}function lZ(t){let e=oZ;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Yf(){return pb()}function cZ(){return pb()}function pb(){return new Lm(t=>t.toString(),(t,e)=>t.isEqual(e))}const Pve=new Ws(Xr.comparator),Bve=new us(Xr.comparator);function ta(...t){let e=Bve;for(const r of t)e=e.add(r);return e}const Tve=new us(Gn);function kve(){return Tve}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WD(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:f2(e)?"-0":e}}function uZ(t){return{integerValue:""+t}}function Fve(t,e){return qxe(e)?uZ(e):WD(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(){this._=void 0}}function Ove(t,e,r){return t instanceof x2?function(a,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&KD(s)&&(s=qD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,e):t instanceof ig?fZ(t,e):t instanceof Fv?hZ(t,e):function(a,s){const o=dZ(a,s),l=T7(o)+T7(a.Pe);return KT(o)&&KT(a.Pe)?uZ(l):WD(a.serializer,l)}(t,e)}function Dve(t,e,r){return t instanceof ig?fZ(t,e):t instanceof Fv?hZ(t,e):r}function dZ(t,e){return t instanceof v2?function(n){return KT(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class x2 extends Cj{}class ig extends Cj{constructor(e){super(),this.elements=e}}function fZ(t,e){const r=AZ(e);for(const n of t.elements)r.some(a=>oh(a,n))||r.push(n);return{arrayValue:{values:r}}}class Fv extends Cj{constructor(e){super(),this.elements=e}}function hZ(t,e){let r=AZ(e);for(const n of t.elements)r=r.filter(a=>!oh(a,n));return{arrayValue:{values:r}}}class v2 extends Cj{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function T7(t){return Us(t.integerValue||t.doubleValue)}function AZ(t){return p2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mZ{constructor(e,r){this.field=e,this.transform=r}}function Rve(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof ig&&a instanceof ig||n instanceof Fv&&a instanceof Fv?Pv(n.elements,a.elements,oh):n instanceof v2&&a instanceof v2?oh(n.Pe,a.Pe):n instanceof x2&&a instanceof x2}(t.transform,e.transform)}class Mve{constructor(e,r){this.version=e,this.transformResults=r}}class $s{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new $s}static exists(e){return new $s(void 0,e)}static updateTime(e){return new $s(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lE(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class _j{}function pZ(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new u1(t.key,$s.none()):new c1(t.key,t.data,$s.none());{const r=t.data,n=El.empty();let a=new us(Hs.comparator);for(let s of e.fields)if(!a.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),a=a.add(s)}return new OA(t.key,n,new eu(a.toArray()),$s.none())}}function Lve(t,e,r){t instanceof c1?function(a,s,o){const l=a.value.clone(),c=F7(a.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof OA?function(a,s,o){if(!lE(a.precondition,s))return void s.convertToUnknownDocument(o.version);const l=F7(a.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(gZ(a)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(a,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function gb(t,e,r,n){return t instanceof c1?function(s,o,l,c){if(!lE(s.precondition,o))return l;const u=s.value.clone(),d=O7(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof OA?function(s,o,l,c){if(!lE(s.precondition,o))return l;const u=O7(s.fieldTransforms,c,o),d=o.data;return d.setAll(gZ(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,o,l){return lE(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function Uve(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),s=dZ(n.transform,a||null);s!=null&&(r===null&&(r=El.empty()),r.set(n.field,s))}return r||null}function k7(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Pv(n,a,(s,o)=>Rve(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class c1 extends _j{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class OA extends _j{constructor(e,r,n,a,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function gZ(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function F7(t,e,r){const n=new Map;An(t.length===r.length);for(let a=0;a<r.length;a++){const s=t[a],o=s.transform,l=e.data.field(s.field);n.set(s.field,Dve(o,l,r[a]))}return n}function O7(t,e,r){const n=new Map;for(const a of t){const s=a.transform,o=r.data.field(a.field);n.set(a.field,Ove(s,o,e))}return n}class u1 extends _j{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XD extends _j{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&Lve(s,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=gb(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=gb(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=cZ();return this.mutations.forEach(a=>{const s=e.get(a.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(a.key)?null:l;const c=pZ(o,l);c!==null&&n.set(a.key,c),o.isValidDocument()||o.convertToNoDocument(wn.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ta())}isEqual(e){return this.batchId===e.batchId&&Pv(this.mutations,e.mutations,(r,n)=>k7(r,n))&&Pv(this.baseMutations,e.baseMutations,(r,n)=>k7(r,n))}}class JD{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){An(e.mutations.length===n.length);let a=function(){return Pve}();const s=e.mutations;for(let o=0;o<s.length;o++)a=a.insert(s[o].key,n[o].version);return new JD(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qve{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var to,ya;function xZ(t){switch(t){default:return cn();case hr.CANCELLED:case hr.UNKNOWN:case hr.DEADLINE_EXCEEDED:case hr.RESOURCE_EXHAUSTED:case hr.INTERNAL:case hr.UNAVAILABLE:case hr.UNAUTHENTICATED:return!1;case hr.INVALID_ARGUMENT:case hr.NOT_FOUND:case hr.ALREADY_EXISTS:case hr.PERMISSION_DENIED:case hr.FAILED_PRECONDITION:case hr.ABORTED:case hr.OUT_OF_RANGE:case hr.UNIMPLEMENTED:case hr.DATA_LOSS:return!0}}function vZ(t){if(t===void 0)return _c("GRPC error has no .code"),hr.UNKNOWN;switch(t){case to.OK:return hr.OK;case to.CANCELLED:return hr.CANCELLED;case to.UNKNOWN:return hr.UNKNOWN;case to.DEADLINE_EXCEEDED:return hr.DEADLINE_EXCEEDED;case to.RESOURCE_EXHAUSTED:return hr.RESOURCE_EXHAUSTED;case to.INTERNAL:return hr.INTERNAL;case to.UNAVAILABLE:return hr.UNAVAILABLE;case to.UNAUTHENTICATED:return hr.UNAUTHENTICATED;case to.INVALID_ARGUMENT:return hr.INVALID_ARGUMENT;case to.NOT_FOUND:return hr.NOT_FOUND;case to.ALREADY_EXISTS:return hr.ALREADY_EXISTS;case to.PERMISSION_DENIED:return hr.PERMISSION_DENIED;case to.FAILED_PRECONDITION:return hr.FAILED_PRECONDITION;case to.ABORTED:return hr.ABORTED;case to.OUT_OF_RANGE:return hr.OUT_OF_RANGE;case to.UNIMPLEMENTED:return hr.UNIMPLEMENTED;case to.DATA_LOSS:return hr.DATA_LOSS;default:return cn()}}(ya=to||(to={}))[ya.OK=0]="OK",ya[ya.CANCELLED=1]="CANCELLED",ya[ya.UNKNOWN=2]="UNKNOWN",ya[ya.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ya[ya.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ya[ya.NOT_FOUND=5]="NOT_FOUND",ya[ya.ALREADY_EXISTS=6]="ALREADY_EXISTS",ya[ya.PERMISSION_DENIED=7]="PERMISSION_DENIED",ya[ya.UNAUTHENTICATED=16]="UNAUTHENTICATED",ya[ya.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ya[ya.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ya[ya.ABORTED=10]="ABORTED",ya[ya.OUT_OF_RANGE=11]="OUT_OF_RANGE",ya[ya.UNIMPLEMENTED=12]="UNIMPLEMENTED",ya[ya.INTERNAL=13]="INTERNAL",ya[ya.UNAVAILABLE=14]="UNAVAILABLE",ya[ya.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vve(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hve=new kp([4294967295,4294967295],0);function D7(t){const e=Vve().encode(t),r=new jJ;return r.update(e),new Uint8Array(r.digest())}function R7(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new kp([r,n],0),new kp([a,s],0)]}class e6{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ly(`Invalid padding: ${r}`);if(n<0)throw new Ly(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ly(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ly(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=kp.fromNumber(this.Ie)}Ee(e,r,n){let a=e.add(r.multiply(kp.fromNumber(n)));return a.compare(Hve)===1&&(a=new kp([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=D7(e),[n,a]=R7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);if(!this.de(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new e6(s,a,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=D7(e),[n,a]=R7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ly extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,r,n,a,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,Iw.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ej(wn.min(),a,new Ws(Gn),Fu(),ta())}}class Iw{constructor(e,r,n,a,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Iw(n,r,ta(),ta(),ta())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,r,n,a){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=a}}class yZ{constructor(e,r){this.targetId=e,this.me=r}}class bZ{constructor(e,r,n=Wi.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class M7{constructor(){this.fe=0,this.ge=U7(),this.pe=Wi.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ta(),r=ta(),n=ta();return this.ge.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:cn()}}),new Iw(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=U7()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,An(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class $ve{constructor(e){this.Le=e,this.Be=new Map,this.ke=Fu(),this.qe=L7(),this.Qe=new Ws(Gn)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:cn()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,a)=>{this.ze(a)&&r(a)})}He(e){const r=e.targetId,n=e.me.count,a=this.Je(r);if(a){const s=a.target;if(iS(s))if(n===0){const o=new Xr(s.path);this.Ue(r,o,Vs.newNoDocument(o,wn.min()))}else An(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let o,l;try{o=vm(n).toUint8Array()}catch(c){if(c instanceof qJ)return xm("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new e6(o,a,s)}catch(c){return xm(c instanceof Ly?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,s,null),a++)}),a}rt(e){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&iS(l.target)){const c=new Xr(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Vs.newNoDocument(c,e))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=ta();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const a=new Ej(e,r,this.Qe,this.ke,n);return this.ke=Fu(),this.qe=L7(),this.Qe=new Ws(Gn),a}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,r)?a.Fe(r,1):a.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new M7,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new us(Gn),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||kr("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new M7),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function L7(){return new Ws(Xr.comparator)}function U7(){return new Ws(Xr.comparator)}const Gve={asc:"ASCENDING",desc:"DESCENDING"},Kve={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qve={and:"AND",or:"OR"};class zve{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function YT(t,e){return t.useProto3Json||Cw(e)?e:{value:e}}function Ov(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wZ(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Wve(t,e){return Ov(t,e.toTimestamp())}function rl(t){return An(!!t),wn.fromTimestamp(function(r){const n=xA(r);return new vr(n.seconds,n.nanos)}(t))}function t6(t,e){return JT(t,e).canonicalString()}function JT(t,e){const r=function(a){return new Pa(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function NZ(t){const e=Pa.fromString(t);return An(TZ(e)),e}function y2(t,e){return t6(t.databaseId,e.path)}function nA(t,e){const r=NZ(e);if(r.get(1)!==t.databaseId.projectId)throw new Ur(hr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ur(hr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Xr(EZ(r))}function CZ(t,e){return t6(t.databaseId,e)}function _Z(t){const e=NZ(t);return e.length===4?Pa.emptyPath():EZ(e)}function ZT(t){return new Pa(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function EZ(t){return An(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Q7(t,e,r){return{name:y2(t,e),fields:r.value.mapValue.fields}}function Xve(t,e,r){const n=nA(t,e.name),a=rl(e.updateTime),s=e.createTime?rl(e.createTime):wn.min(),o=new El({mapValue:{fields:e.fields}}),l=Vs.newFoundDocument(n,a,s,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function Yve(t,e){return"found"in e?function(n,a){An(!!a.found),a.found.name,a.found.updateTime;const s=nA(n,a.found.name),o=rl(a.found.updateTime),l=a.found.createTime?rl(a.found.createTime):wn.min(),c=new El({mapValue:{fields:a.found.fields}});return Vs.newFoundDocument(s,o,l,c)}(t,e):"missing"in e?function(n,a){An(!!a.missing),An(!!a.readTime);const s=nA(n,a.missing),o=rl(a.readTime);return Vs.newNoDocument(s,o)}(t,e):cn()}function Jve(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:cn()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(An(d===void 0||typeof d=="string"),Wi.fromBase64String(d||"")):(An(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Wi.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?hr.UNKNOWN:vZ(u.code);return new Ur(d,u.message||"")}(o);r=new bZ(n,a,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=nA(t,n.document.name),s=rl(n.document.updateTime),o=n.document.createTime?rl(n.document.createTime):wn.min(),l=new El({mapValue:{fields:n.document.fields}}),c=Vs.newFoundDocument(a,s,o,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new cE(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=nA(t,n.document),s=n.readTime?rl(n.readTime):wn.min(),o=Vs.newNoDocument(a,s),l=n.removedTargetIds||[];r=new cE([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=nA(t,n.document),s=n.removedTargetIds||[];r=new cE([],s,a,null)}else{if(!("filter"in e))return cn();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,o=new Qve(a,s),l=n.targetId;r=new yZ(l,o)}}return r}function b2(t,e){let r;if(e instanceof c1)r={update:Q7(t,e.key,e.value)};else if(e instanceof u1)r={delete:y2(t,e.key)};else if(e instanceof OA)r={update:Q7(t,e.key,e.data),updateMask:a1e(e.fieldMask)};else{if(!(e instanceof XD))return cn();r={verify:y2(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof x2)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ig)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof v2)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw cn()}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:Wve(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:cn()}(t,e.precondition)),r}function ek(t,e){const r=e.currentDocument?function(s){return s.updateTime!==void 0?$s.updateTime(rl(s.updateTime)):s.exists!==void 0?$s.exists(s.exists):$s.none()}(e.currentDocument):$s.none(),n=e.updateTransforms?e.updateTransforms.map(a=>function(o,l){let c=null;if("setToServerValue"in l)An(l.setToServerValue==="REQUEST_TIME"),c=new x2;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new ig(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new Fv(d)}else"increment"in l?c=new v2(o,l.increment):cn();const u=Hs.fromServerFormat(l.fieldPath);return new mZ(u,c)}(t,a)):[];if(e.update){e.update.name;const a=nA(t,e.update.name),s=new El({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new eu(u.map(d=>Hs.fromServerFormat(d)))}(e.updateMask);return new OA(a,s,o,r,n)}return new c1(a,s,r,n)}if(e.delete){const a=nA(t,e.delete);return new u1(a,r)}if(e.verify){const a=nA(t,e.verify);return new XD(a,r)}return cn()}function Zve(t,e){return t&&t.length>0?(An(e!==void 0),t.map(r=>function(a,s){let o=a.updateTime?rl(a.updateTime):rl(s);return o.isEqual(wn.min())&&(o=rl(s)),new Mve(o,a.transformResults||[])}(r,e))):[]}function SZ(t,e){return{documents:[CZ(t,e.path)]}}function IZ(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=CZ(t,a);const s=function(u){if(u.length!==0)return BZ(ts.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(A){return{field:Ex(A.field),direction:t1e(A.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=YT(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:a}}function jZ(t){let e=_Z(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){An(n===1);const d=r.from[0];d.allDescendants?a=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(f){const A=PZ(f);return A instanceof ts&&zD(A)?A.getFilters():[A]}(r.where));let o=[];r.orderBy&&(o=function(f){return f.map(A=>function(m){return new g2(Sx(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(A))}(r.orderBy));let l=null;r.limit&&(l=function(f){let A;return A=typeof f=="object"?f.value:f,Cw(A)?null:A}(r.limit));let c=null;r.startAt&&(c=function(f){const A=!!f.before,h=f.values||[];return new Tv(h,A)}(r.startAt));let u=null;return r.endAt&&(u=function(f){const A=!f.before,h=f.values||[];return new Tv(h,A)}(r.endAt)),_ve(e,a,o,s,l,"F",c,u)}function e1e(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cn()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function PZ(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Sx(r.unaryFilter.field);return Aa.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Sx(r.unaryFilter.field);return Aa.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Sx(r.unaryFilter.field);return Aa.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Sx(r.unaryFilter.field);return Aa.create(o,"!=",{nullValue:"NULL_VALUE"});default:return cn()}}(t):t.fieldFilter!==void 0?function(r){return Aa.create(Sx(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return cn()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ts.create(r.compositeFilter.filters.map(n=>PZ(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return cn()}}(r.compositeFilter.op))}(t):cn()}function t1e(t){return Gve[t]}function r1e(t){return Kve[t]}function n1e(t){return qve[t]}function Ex(t){return{fieldPath:t.canonicalString()}}function Sx(t){return Hs.fromServerFormat(t.fieldPath)}function BZ(t){return t instanceof Aa?function(r){if(r.op==="=="){if(C7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NAN"}};if(N7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(C7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NOT_NAN"}};if(N7(r.value))return{unaryFilter:{field:Ex(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ex(r.field),op:r1e(r.op),value:r.value}}}(t):t instanceof ts?function(r){const n=r.getFilters().map(a=>BZ(a));return n.length===1?n[0]:{compositeFilter:{op:n1e(r.op),filters:n}}}(t):cn()}function a1e(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function TZ(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,r,n,a,s=wn.min(),o=wn.min(),l=Wi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Wh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kZ{constructor(e){this.ct=e}}function s1e(t,e){let r;if(e.document)r=Xve(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Xr.fromSegments(e.noDocument.path),a=lg(e.noDocument.readTime);r=Vs.newNoDocument(n,a),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return cn();{const n=Xr.fromSegments(e.unknownDocument.path),a=lg(e.unknownDocument.version);r=Vs.newUnknownDocument(n,a)}}return e.readTime&&r.setReadTime(function(a){const s=new vr(a[0],a[1]);return wn.fromTimestamp(s)}(e.readTime)),r}function V7(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:cS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:y2(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ov(s,o.version.toTimestamp()),createTime:Ov(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:og(e.version)};else{if(!e.isUnknownDocument())return cn();n.unknownDocument={path:r.path.toArray(),version:og(e.version)}}return n}function cS(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function og(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function lg(t){const e=new vr(t.seconds,t.nanoseconds);return wn.fromTimestamp(e)}function mp(t,e){const r=(e.baseMutations||[]).map(s=>ek(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>ek(t.ct,s)),a=vr.fromMillis(e.localWriteTimeMs);return new YD(e.batchId,a,r,n)}function Uy(t){const e=lg(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?lg(t.lastLimboFreeSnapshotVersion):wn.min();let n;return n=function(s){return s.documents!==void 0}(t.query)?function(s){return An(s.documents.length===1),Id(Ew(_Z(s.documents[0])))}(t.query):function(s){return Id(jZ(s))}(t.query),new Wh(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Wi.fromBase64String(t.resumeToken))}function FZ(t,e){const r=og(e.snapshotVersion),n=og(e.lastLimboFreeSnapshotVersion);let a;a=iS(e.target)?SZ(t.ct,e.target):IZ(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:sg(e.target),readTime:r,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function OZ(t){const e=jZ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?lS(e,e.limit,"L"):e}function _4(t,e){return new ZD(e.largestBatchId,ek(t.ct,e.overlayMutation))}function H7(t,e){const r=e.path.lastSegment();return[t,jc(e.path.popLast()),r]}function $7(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:og(n.readTime),documentKey:jc(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1e{getBundleMetadata(e,r){return G7(e).get(r).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:lg(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,r){return G7(e).put(function(a){return{bundleId:a.id,createTime:og(rl(a.createTime)),version:a.version}}(r))}getNamedQuery(e,r){return K7(e).get(r).next(n=>{if(n)return function(s){return{name:s.name,query:OZ(s.bundledQuery),readTime:lg(s.readTime)}}(n)})}saveNamedQuery(e,r){return K7(e).put(function(a){return{name:a.name,readTime:og(rl(a.readTime)),bundledQuery:a.bundledQuery}}(r))}}function G7(t){return Do(t,"bundles")}function K7(t){return Do(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new Sj(e,n)}getOverlay(e,r){return ry(e).get(H7(this.userId,r)).next(n=>n?_4(this.serializer,n):null)}getOverlays(e,r){const n=Yf();return Yt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){const a=[];return n.forEach((s,o)=>{const l=new ZD(r,o);a.push(this.ht(e,l))}),Yt.waitFor(a)}removeOverlaysForBatchId(e,r,n){const a=new Set;r.forEach(o=>a.add(jc(o.getCollectionPath())));const s=[];return a.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(ry(e).j("collectionPathOverlayIndex",l))}),Yt.waitFor(s)}getOverlaysForCollection(e,r,n){const a=Yf(),s=jc(r),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ry(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=_4(this.serializer,c);a.set(u.getKey(),u)}return a})}getOverlaysForCollectionGroup(e,r,n,a){const s=Yf();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return ry(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const f=_4(this.serializer,u);s.size()<a||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,r){return ry(e).put(function(a,s,o){const[l,c,u]=H7(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:b2(a.ct,o.mutation)}}(this.serializer,this.userId,r))}}function ry(t){return Do(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1e{Pt(e){return Do(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Wi.fromUint8Array(n):Wi.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(Us(e.integerValue));else if("doubleValue"in e){const n=Us(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),f2(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=xA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(vm(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?zJ(e)?this.dt(r,Number.MAX_SAFE_INTEGER):wj(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):cn()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const a of Object.keys(n))this.Vt(a,r),this.Tt(n[a],r)}wt(e,r){var n,a;const s=e.fields||{};this.dt(r,53);const o="value",l=((a=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.length)||0;this.dt(r,15),r.At(Us(l)),this.Vt(o,r),this.Tt(s[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const a of n)this.Tt(a,r)}yt(e,r){this.dt(r,37),Xr.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}pp.vt=new pp;function l1e(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function q7(t){const e=64-function(n){let a=0;for(let s=0;s<8;++s){const o=l1e(255&n[s]);if(a+=o,o!==8)break}return a}(t);return Math.ceil(e/8)}class c1e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const a=r.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const a=r.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const r=this.qt(e),n=q7(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=255&r[a]}Kt(e){const r=this.qt(e),n=q7(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=~(255&r[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let a=1;a<r.length;++a)r[a]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class u1e{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class d1e{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ny{constructor(){this.jt=new c1e,this.Ht=new u1e(this.jt),this.Jt=new d1e(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,r,n,a){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=a}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new gp(this.indexId,this.documentKey,this.arrayValue,n)}}function l0(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=z7(t.arrayValue,e.arrayValue),r!==0?r:(r=z7(t.directionalValue,e.directionalValue),r!==0?r:Xr.comparator(t.documentKey,e.documentKey)))}function z7(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(e){this.Xt=new us((r,n)=>Hs.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(An(e.collectionGroup===this.collectionId),this.nn)return!1;const r=HT(e);if(r!==void 0&&!this.sn(r))return!1;const n=op(e);let a=new Set,s=0,o=0;for(;s<n.length&&this.sn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!a.has(l.field.canonicalString())){const c=n[s];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new us(Hs.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new aE(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new aE(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new aE(n.field,n.dir==="asc"?0:1)));return new sS(sS.UNKNOWN_ID,this.collectionId,r,d2.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DZ(t){var e,r;if(An(t instanceof Aa||t instanceof ts),t instanceof Aa){if(t instanceof nZ){const a=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(s=>Aa.create(t.field,"==",s)))||[];return ts.create(a,"or")}return t}const n=t.filters.map(a=>DZ(a));return ts.create(n,t.op)}function f1e(t){if(t.getFilters().length===0)return[];const e=nk(DZ(t));return An(RZ(e)),tk(e)||rk(e)?[e]:e.getFilters()}function tk(t){return t instanceof Aa}function rk(t){return t instanceof ts&&zD(t)}function RZ(t){return tk(t)||rk(t)||function(r){if(r instanceof ts&&qT(r)){for(const n of r.getFilters())if(!tk(n)&&!rk(n))return!1;return!0}return!1}(t)}function nk(t){if(An(t instanceof Aa||t instanceof ts),t instanceof Aa)return t;if(t.filters.length===1)return nk(t.filters[0]);const e=t.filters.map(n=>nk(n));let r=ts.create(e,t.op);return r=uS(r),RZ(r)?r:(An(r instanceof ts),An(kv(r)),An(r.filters.length>1),r.filters.reduce((n,a)=>r6(n,a)))}function r6(t,e){let r;return An(t instanceof Aa||t instanceof ts),An(e instanceof Aa||e instanceof ts),r=t instanceof Aa?e instanceof Aa?function(a,s){return ts.create([a,s],"and")}(t,e):X7(t,e):e instanceof Aa?X7(e,t):function(a,s){if(An(a.filters.length>0&&s.filters.length>0),kv(a)&&kv(s))return eZ(a,s.getFilters());const o=qT(a)?a:s,l=qT(a)?s:a,c=o.filters.map(u=>r6(u,l));return ts.create(c,"or")}(t,e),uS(r)}function X7(t,e){if(kv(e))return eZ(e,t.getFilters());{const r=e.filters.map(n=>r6(t,n));return ts.create(r,"or")}}function uS(t){if(An(t instanceof Aa||t instanceof ts),t instanceof Aa)return t;const e=t.getFilters();if(e.length===1)return uS(e[0]);if(JJ(t))return t;const r=e.map(a=>uS(a)),n=[];return r.forEach(a=>{a instanceof Aa?n.push(a):a instanceof ts&&(a.op===t.op?n.push(...a.filters):n.push(a))}),n.length===1?n[0]:ts.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1e{constructor(){this.un=new n6}addToCollectionParentIndex(e,r){return this.un.add(r),Yt.resolve()}getCollectionParents(e,r){return Yt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Yt.resolve()}deleteFieldIndex(e,r){return Yt.resolve()}deleteAllFieldIndexes(e){return Yt.resolve()}createTargetIndexes(e,r){return Yt.resolve()}getDocumentsMatchingTarget(e,r){return Yt.resolve(null)}getIndexType(e,r){return Yt.resolve(0)}getFieldIndexes(e,r){return Yt.resolve([])}getNextCollectionGroupToUpdate(e){return Yt.resolve(null)}getMinOffset(e,r){return Yt.resolve(Qu.min())}getMinOffsetFromCollectionGroup(e,r){return Yt.resolve(Qu.min())}updateCollectionGroup(e,r,n){return Yt.resolve()}updateIndexEntries(e,r){return Yt.resolve()}}class n6{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new us(Pa.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new us(Pa.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=new Uint8Array(0);class A1e{constructor(e,r){this.databaseId=r,this.cn=new n6,this.ln=new Lm(n=>sg(n),(n,a)=>_w(n,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),a=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const s={collectionId:n,parent:jc(a)};return Y7(e).put(s)}return Yt.resolve()}getCollectionParents(e,r){const n=[],a=IDBKeyRange.bound([r,""],[RJ(r),""],!1,!0);return Y7(e).U(a).next(s=>{for(const o of s){if(o.collectionId!==r)break;n.push(Xf(o.parent))}return n})}addFieldIndex(e,r){const n=ay(e),a=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete a.indexId;const s=n.add(a);if(r.indexState){const o=ex(e);return s.next(l=>{o.put($7(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return s.next()}deleteFieldIndex(e,r){const n=ay(e),a=ex(e),s=Zg(e);return n.delete(r.indexId).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=ay(e),n=Zg(e),a=ex(e);return r.j().next(()=>n.j()).next(()=>a.j())}createTargetIndexes(e,r){return Yt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(a=>{if(a===0||a===1){const s=new W7(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,r){const n=Zg(e);let a=!0;const s=new Map;return Yt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{a&&(a=!!l),s.set(o,l)})).next(()=>{if(a){let o=ta();const l=[];return Yt.forEach(s,(c,u)=>{kr("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(w=>`${w.fieldPath}:${w.kind}`).join(",")}`}(c)} to execute ${sg(r)}`);const d=function(b,w){const j=HT(w);if(j===void 0)return null;for(const I of oS(b,j.fieldPath))switch(I.op){case"array-contains-any":return I.value.arrayValue.values||[];case"array-contains":return[I.value]}return null}(u,c),f=function(b,w){const j=new Map;for(const I of op(w))for(const _ of oS(b,I.fieldPath))switch(_.op){case"==":case"in":j.set(I.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return j.set(I.fieldPath.canonicalString(),_.value),Array.from(j.values())}return null}(u,c),A=function(b,w){const j=[];let I=!0;for(const _ of op(w)){const S=_.kind===0?j7(b,_.fieldPath,b.startAt):P7(b,_.fieldPath,b.startAt);j.push(S.value),I&&(I=S.inclusive)}return new Tv(j,I)}(u,c),h=function(b,w){const j=[];let I=!0;for(const _ of op(w)){const S=_.kind===0?P7(b,_.fieldPath,b.endAt):j7(b,_.fieldPath,b.endAt);j.push(S.value),I&&(I=S.inclusive)}return new Tv(j,I)}(u,c),m=this.In(c,u,A),p=this.In(c,u,h),x=this.Tn(c,u,f),v=this.En(c.indexId,d,m,A.inclusive,p,h.inclusive,x);return Yt.forEach(v,y=>n.G(y,r.limit).next(b=>{b.forEach(w=>{const j=Xr.fromSegments(w.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return Yt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=f1e(ts.create(e.filters,"and")).map(n=>WT(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,a,s,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,s.length),u=c/(r!=null?r.length:1),d=[];for(let f=0;f<c;++f){const A=r?this.dn(r[f/u]):rC,h=this.An(e,A,n[f%u],a),m=this.Rn(e,A,s[f%u],o),p=l.map(x=>this.An(e,A,x,!0));d.push(...this.createRange(h,m,p))}return d}An(e,r,n,a){const s=new gp(e,Xr.empty(),r,n);return a?s:s.Zt()}Rn(e,r,n,a){const s=new gp(e,Xr.empty(),r,n);return a?s.Zt():s}Pn(e,r){const n=new W7(r),a=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,a).next(s=>{let o=null;for(const l of s)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const a=this.hn(r);return Yt.forEach(a,s=>this.Pn(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let u=new us(Hs.comparator),d=!1;for(const f of c.filters)for(const A of f.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?d=!0:u=u.add(A.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&a.length>1&&n===2?1:n)}Vn(e,r){const n=new ny;for(const a of op(e)){const s=r.data.field(a.fieldPath);if(s==null)return null;const o=n.Yt(a.kind);pp.vt.It(s,o)}return n.zt()}dn(e){const r=new ny;return pp.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new ny;return pp.vt.It(m2(this.databaseId,r),n.Yt(function(s){const o=op(s);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let a=[];a.push(new ny);let s=0;for(const o of op(e)){const l=n[s++];for(const c of a)if(this.fn(r,o.fieldPath)&&p2(l))a=this.gn(a,o,l);else{const u=c.Yt(o.kind);pp.vt.It(l,u)}}return this.pn(a)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const a=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of a){const c=new ny;c.seed(l.zt()),pp.vt.It(o,c.Yt(r.kind)),s.push(c)}return s}fn(e,r){return!!e.filters.find(n=>n instanceof Aa&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=ay(e),a=ex(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(s=>{const o=[];return Yt.forEach(s,l=>a.get([l.indexId,this.uid]).next(c=>{o.push(function(d,f){const A=f?new d2(f.sequenceNumber,new Qu(lg(f.readTime),new Xr(Xf(f.documentKey)),f.largestBatchId)):d2.empty(),h=d.fields.map(([m,p])=>new aE(Hs.fromServerFormat(m),p));return new sS(d.indexId,d.collectionGroup,h,A)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:Gn(n.collectionGroup,a.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const a=ay(e),s=ex(e);return this.yn(e).next(o=>a.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>Yt.forEach(l,c=>s.put($7(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return Yt.forEach(r,(a,s)=>{const o=n.get(a.collectionGroup);return(o?Yt.resolve(o):this.getFieldIndexes(e,a.collectionGroup)).next(l=>(n.set(a.collectionGroup,l),Yt.forEach(l,c=>this.wn(e,a,c).next(u=>{const d=this.Sn(s,c);return u.isEqual(d)?Yt.resolve():this.bn(e,s,c,u,d)}))))})}Dn(e,r,n,a){return Zg(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,a){return Zg(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const a=Zg(e);let s=new us(l0);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{s=s.add(new gp(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,r){let n=new us(l0);const a=this.Vn(r,e);if(a==null)return n;const s=HT(r);if(s!=null){const o=e.data.field(s.fieldPath);if(p2(o))for(const l of o.arrayValue.values||[])n=n.add(new gp(r.indexId,e.key,this.dn(l),a))}else n=n.add(new gp(r.indexId,e.key,rC,a));return n}bn(e,r,n,a,s){kr("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,u,d,f,A){const h=c.getIterator(),m=u.getIterator();let p=Jg(h),x=Jg(m);for(;p||x;){let v=!1,y=!1;if(p&&x){const b=d(p,x);b<0?y=!0:b>0&&(v=!0)}else p!=null?y=!0:v=!0;v?(f(x),x=Jg(m)):y?(A(p),p=Jg(h)):(p=Jg(h),x=Jg(m))}}(a,s,l0,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),Yt.waitFor(o)}yn(e){let r=1;return ex(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,a,s)=>{s.done(),r=a.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>l0(o,l)).filter((o,l,c)=>!l||l0(o,c[l-1])!==0);const a=[];a.push(e);for(const o of n){const l=l0(o,e),c=l0(o,r);if(l===0)a[0]=e.Zt();else if(l>0&&c<0)a.push(o),a.push(o.Zt());else if(c>0)break}a.push(r);const s=[];for(let o=0;o<a.length;o+=2){if(this.Cn(a[o],a[o+1]))return[];const l=[a[o].indexId,this.uid,a[o].arrayValue,a[o].directionalValue,rC,[]],c=[a[o+1].indexId,this.uid,a[o+1].arrayValue,a[o+1].directionalValue,rC,[]];s.push(IDBKeyRange.bound(l,c))}return s}Cn(e,r){return l0(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(J7)}getMinOffset(e,r){return Yt.mapArray(this.hn(r),n=>this.Pn(e,n).next(a=>a||cn())).next(J7)}}function Y7(t){return Do(t,"collectionParents")}function Zg(t){return Do(t,"indexEntries")}function ay(t){return Do(t,"indexConfiguration")}function ex(t){return Do(t,"indexState")}function J7(t){An(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const a=t[n].indexState.offset;HD(a,e)<0&&(e=a),r<a.largestBatchId&&(r=a.largestBatchId)}return new Qu(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z7={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Wc{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Wc(e,Wc.DEFAULT_COLLECTION_PERCENTILE,Wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MZ(t,e,r){const n=t.store("mutations"),a=t.store("documentMutations"),s=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(d,f,A)=>(l++,A.delete()));s.push(c.next(()=>{An(l===1)}));const u=[];for(const d of r.mutations){const f=VJ(e,d.key.path,r.batchId);s.push(a.delete(f)),u.push(d.key)}return Yt.waitFor(s).next(()=>u)}function dS(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw cn();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wc.DEFAULT_COLLECTION_PERCENTILE=10,Wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wc.DEFAULT=new Wc(41943040,Wc.DEFAULT_COLLECTION_PERCENTILE,Wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wc.DISABLED=new Wc(-1,0,0);class Ij{constructor(e,r,n,a){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=a,this.Fn={}}static lt(e,r,n,a){An(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Ij(s,r,n,a)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return c0(e).J({index:"userMutationsIndex",range:n},(a,s,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,a){const s=Ix(e),o=c0(e);return o.add({}).next(l=>{An(typeof l=="number");const c=new YD(l,r,n,a),u=function(h,m,p){const x=p.baseMutations.map(y=>b2(h.ct,y)),v=p.mutations.map(y=>b2(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:v}}(this.serializer,this.userId,c),d=[];let f=new us((A,h)=>Gn(A.canonicalString(),h.canonicalString()));for(const A of a){const h=VJ(this.userId,A.key.path,l);f=f.add(A.key.path.popLast()),d.push(o.put(u)),d.push(s.put(h,Wxe))}return f.forEach(A=>{d.push(this.indexManager.addToCollectionParentIndex(e,A))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Yt.waitFor(d).next(()=>c)})}lookupMutationBatch(e,r){return c0(e).get(r).next(n=>n?(An(n.userId===this.userId),mp(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?Yt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const a=n.keys();return this.Fn[r]=a,a}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return c0(e).J({index:"userMutationsIndex",range:a},(o,l,c)=>{l.userId===this.userId&&(An(l.batchId>=n),s=mp(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return c0(e).J({index:"userMutationsIndex",range:r,reverse:!0},(a,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return c0(e).U("userMutationsIndex",r).next(n=>n.map(a=>mp(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=sE(this.userId,r.path),a=IDBKeyRange.lowerBound(n),s=[];return Ix(e).J({range:a},(o,l,c)=>{const[u,d,f]=o,A=Xf(d);if(u===this.userId&&r.path.isEqual(A))return c0(e).get(f).next(h=>{if(!h)throw cn();An(h.userId===this.userId),s.push(mp(this.serializer,h))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new us(Gn);const a=[];return r.forEach(s=>{const o=sE(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=Ix(e).J({range:l},(u,d,f)=>{const[A,h,m]=u,p=Xf(h);A===this.userId&&s.path.isEqual(p)?n=n.add(m):f.done()});a.push(c)}),Yt.waitFor(a).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1,s=sE(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new us(Gn);return Ix(e).J({range:o},(c,u,d)=>{const[f,A,h]=c,m=Xf(A);f===this.userId&&n.isPrefixOf(m)?m.length===a&&(l=l.add(h)):d.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],a=[];return r.forEach(s=>{a.push(c0(e).get(s).next(o=>{if(o===null)throw cn();An(o.userId===this.userId),n.push(mp(this.serializer,o))}))}),Yt.waitFor(a).next(()=>n)}removeMutationBatch(e,r){return MZ(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),Yt.forEach(n,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Yt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),a=[];return Ix(e).J({range:n},(s,o,l)=>{if(s[0]===this.userId){const c=Xf(s[1]);a.push(c)}else l.done()}).next(()=>{An(a.length===0)})})}containsKey(e,r){return LZ(e,this.userId,r)}Nn(e){return UZ(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function LZ(t,e,r){const n=sE(e,r.path),a=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return Ix(t).J({range:s,H:!0},(l,c,u)=>{const[d,f,A]=l;d===e&&f===a&&(o=!0),u.done()}).next(()=>o)}function c0(t){return Do(t,"mutations")}function Ix(t){return Do(t,"documentMutations")}function UZ(t){return Do(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new cg(0)}static kn(){return new cg(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1e{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new cg(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>wn.fromTimestamp(new vr(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(a=>(a.highestListenSequenceNumber=r,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),r>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=r),this.Qn(e,a)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>tx(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(An(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let a=0;const s=[];return tx(e).J((o,l)=>{const c=Uy(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(a++,s.push(this.removeTargetData(e,c)))}).next(()=>Yt.waitFor(s)).next(()=>a)}forEachTarget(e,r){return tx(e).J((n,a)=>{const s=Uy(a);r(s)})}qn(e){return e9(e).get("targetGlobalKey").next(r=>(An(r!==null),r))}Qn(e,r){return e9(e).put("targetGlobalKey",r)}Kn(e,r){return tx(e).put(FZ(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=sg(r),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return tx(e).J({range:a,index:"queryTargetsIndex"},(o,l,c)=>{const u=Uy(l);_w(r,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,r,n){const a=[],s=R0(e);return r.forEach(o=>{const l=jc(o.path);a.push(s.put({targetId:n,path:l})),a.push(this.referenceDelegate.addReference(e,n,o))}),Yt.waitFor(a)}removeMatchingKeys(e,r,n){const a=R0(e);return Yt.forEach(r,s=>{const o=jc(s.path);return Yt.waitFor([a.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,r){const n=R0(e),a=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),a=R0(e);let s=ta();return a.J({range:n,H:!0},(o,l,c)=>{const u=Xf(o[1]),d=new Xr(u);s=s.add(d)}).next(()=>s)}containsKey(e,r){const n=jc(r.path),a=IDBKeyRange.bound([n],[RJ(n)],!1,!0);let s=0;return R0(e).J({index:"documentTargetsIndex",H:!0,range:a},([o,l],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,r){return tx(e).get(r).next(n=>n?Uy(n):null)}}function tx(t){return Do(t,"targets")}function e9(t){return Do(t,"targetGlobal")}function R0(t){return Do(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t9([t,e],[r,n]){const a=Gn(t,r);return a===0?Gn(e,n):a}class p1e{constructor(e){this.Un=e,this.buffer=new us(t9),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();t9(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class g1e{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){kr("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Mm(r)?kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await jg(r)}await this.Hn(3e5)})}}class x1e{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Yt.resolve(wd.oe);const n=new p1e(r);return this.Jn.forEachTarget(e,a=>n.zn(a.sequenceNumber)).next(()=>this.Jn.Zn(e,a=>n.zn(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(kr("LruGarbageCollector","Garbage collection skipped; disabled"),Yt.resolve(Z7)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(kr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Z7):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,a,s,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(kr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),a=this.params.maximumSequenceNumbersToCollect):a=f,o=Date.now(),this.nthSequenceNumber(e,a))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,r))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(u=Date.now(),Cx()<=ha.DEBUG&&kr("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${a} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Yt.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:f})))}}function v1e(t,e){return new x1e(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1e{constructor(e,r){this.db=e,this.garbageCollector=v1e(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,a)=>r(a))}addReference(e,r,n){return nC(e,n)}removeReference(e,r,n){return nC(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return nC(e,r)}nr(e,r){return function(a,s){let o=!1;return UZ(a).Y(l=>LZ(a,l,s).next(c=>(c&&(o=!0),Yt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(u=>{if(!u)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,wn.min()),R0(e).delete(function(f){return[0,jc(f.path)]}(o))))});a.push(c)}}).next(()=>Yt.waitFor(a)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return nC(e,r)}tr(e,r){const n=R0(e);let a,s=wd.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{o===0?(s!==wd.oe&&r(new Xr(Xf(a)),s),s=u,a=c):s=wd.oe}).next(()=>{s!==wd.oe&&r(new Xr(Xf(a)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nC(t,e){return R0(t).put(function(n,a){return{targetId:0,path:jc(n.path),sequenceNumber:a}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QZ{constructor(){this.changes=new Lm(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Vs.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Yt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Wm(e).put(n)}removeEntry(e,r,n){return Wm(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],cS(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=Vs.newInvalidDocument(r);return Wm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(sy(r))},(a,s)=>{n=this.ir(r,s)}).next(()=>n)}sr(e,r){let n={size:0,document:Vs.newInvalidDocument(r)};return Wm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(sy(r))},(a,s)=>{n={document:this.ir(r,s),size:dS(s)}}).next(()=>n)}getEntries(e,r){let n=Fu();return this._r(e,r,(a,s)=>{const o=this.ir(a,s);n=n.insert(a,o)}).next(()=>n)}ar(e,r){let n=Fu(),a=new Ws(Xr.comparator);return this._r(e,r,(s,o)=>{const l=this.ir(s,o);n=n.insert(s,l),a=a.insert(s,dS(o))}).next(()=>({documents:n,ur:a}))}_r(e,r,n){if(r.isEmpty())return Yt.resolve();let a=new us(a9);r.forEach(c=>a=a.add(c));const s=IDBKeyRange.bound(sy(a.first()),sy(a.last())),o=a.getIterator();let l=o.getNext();return Wm(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{const f=Xr.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&a9(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,u),l=o.hasNext()?o.getNext():null),l?d.$(sy(l)):d.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,a,s){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),cS(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Wm(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=Fu();for(const f of u){const A=this.ir(Xr.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);A.isFoundDocument()&&(Sw(r,A)||a.has(A.key))&&(d=d.insert(A.key,A))}return d})}getAllFromCollectionGroup(e,r,n,a){let s=Fu();const o=n9(r,n),l=n9(r,Qu.max());return Wm(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const f=this.ir(Xr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===a&&d.done()}).next(()=>s)}newChangeBuffer(e){return new w1e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return r9(e).get("remoteDocumentGlobalKey").next(r=>(An(!!r),r))}rr(e,r){return r9(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=s1e(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(wn.min())))return n}return Vs.newInvalidDocument(e)}}function VZ(t){return new b1e(t)}class w1e extends QZ{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new Lm(n=>n.toString(),(n,a)=>n.isEqual(a))}applyChanges(e){const r=[];let n=0,a=new us((s,o)=>Gn(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(r.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=V7(this.cr.serializer,o);a=a.add(s.path.popLast());const u=dS(c);n+=u-l.size,r.push(this.cr.addEntry(e,s,c))}else if(n-=l.size,this.trackRemovals){const c=V7(this.cr.serializer,o.convertToNoDocument(wn.min()));r.push(this.cr.addEntry(e,s,c))}}),a.forEach(s=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),r.push(this.cr.updateMetadata(e,n)),Yt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:a})=>(a.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function r9(t){return Do(t,"remoteDocumentGlobal")}function Wm(t){return Do(t,"remoteDocumentsV14")}function sy(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function n9(t,e){const r=e.documentKey.path.toArray();return[t,cS(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function a9(t,e){const r=t.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<r.length-2&&s<n.length-2;++s)if(a=Gn(r[s],n[s]),a)return a;return a=Gn(r.length,n.length),a||(a=Gn(r[r.length-2],n[n.length-2]),a||Gn(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HZ{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&gb(n.mutation,a,eu.empty(),vr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ta()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ta()){const a=Yf();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(s=>{let o=My();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Yf();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ta()))}populateOverlays(e,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,a){let s=Fu();const o=pb(),l=function(){return pb()}();return r.forEach((c,u)=>{const d=n.get(u.key);a.has(u.key)&&(d===void 0||d.mutation instanceof OA)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),gb(d.mutation,u,d.mutation.getFieldMask(),vr.now())):o.set(u.key,eu.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),r.forEach((u,d)=>{var f;return l.set(u,new N1e(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=pb();let a=new Ws((o,l)=>o-l),s=ta();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||eu.empty();d=l.applyToLocalView(u,d),n.set(c,d);const f=(a.get(l.batchId)||ta()).add(c);a=a.insert(l.batchId,f)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=cZ();d.forEach(A=>{if(!s.has(A)){const h=pZ(r.get(A),n.get(A));h!==null&&f.set(A,h),s=s.add(A)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Yt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(o){return Xr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):aZ(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(s=>{const o=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-s.size):Yt.resolve(Yf());let l=-1,c=s;return o.next(u=>Yt.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(d)?Yt.resolve():this.remoteDocumentCache.getEntry(e,d).next(A=>{c=c.insert(d,A)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,ta())).next(d=>({batchId:l,changes:lZ(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Xr(r)).next(n=>{let a=My();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const s=r.collectionGroup;let o=My();return this.indexManager.getCollectionParents(e,s).next(l=>Yt.forEach(l,c=>{const u=function(f,A){return new l1(A,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,a).next(d=>{d.forEach((f,A)=>{o=o.insert(f,A)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,a))).next(o=>{s.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Vs.newInvalidDocument(d)))});let l=My();return o.forEach((c,u)=>{const d=s.get(c);d!==void 0&&gb(d.mutation,u,eu.empty(),vr.now()),Sw(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1e{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Yt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:rl(a.createTime)}}(r)),Yt.resolve()}getNamedQuery(e,r){return Yt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(a){return{name:a.name,query:OZ(a.bundledQuery),readTime:rl(a.readTime)}}(r)),Yt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1e{constructor(){this.overlays=new Ws(Xr.comparator),this.Ir=new Map}getOverlay(e,r){return Yt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Yf();return Yt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,s)=>{this.ht(e,r,s)}),Yt.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Yt.resolve()}getOverlaysForCollection(e,r,n){const a=Yf(),s=r.length+1,o=new Xr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>n&&a.set(c.getKey(),c)}return Yt.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let s=new Ws((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=s.get(u.largestBatchId);d===null&&(d=Yf(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Yf(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=a)););return Yt.resolve(l)}ht(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new ZD(r,n));let s=this.Ir.get(r);s===void 0&&(s=ta(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1e{constructor(){this.sessionToken=Wi.EMPTY_BYTE_STRING}getSessionToken(e){return Yt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Yt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(){this.Tr=new us(zo.Er),this.dr=new us(zo.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new zo(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new zo(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Xr(new Pa([])),n=new zo(r,e),a=new zo(r,e+1),s=[];return this.dr.forEachInRange([n,a],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Xr(new Pa([])),n=new zo(r,e),a=new zo(r,e+1);let s=ta();return this.dr.forEachInRange([n,a],o=>{s=s.add(o.key)}),s}containsKey(e){const r=new zo(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class zo{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Xr.comparator(e.key,r.key)||Gn(e.wr,r.wr)}static Ar(e,r){return Gn(e.wr,r.wr)||Xr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new us(zo.Er)}checkEmpty(e){return Yt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new YD(s,r,n,a);this.mutationQueue.push(o);for(const l of a)this.br=this.br.add(new zo(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Yt.resolve(o)}lookupMutationBatch(e,r){return Yt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.vr(n),s=a<0?0:a;return Yt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Yt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Yt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new zo(r,0),a=new zo(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,a],o=>{const l=this.Dr(o.wr);s.push(l)}),Yt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new us(Gn);return r.forEach(a=>{const s=new zo(a,0),o=new zo(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),Yt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let s=n;Xr.isDocumentKey(s)||(s=s.child(""));const o=new zo(new Xr(s),0);let l=new us(Gn);return this.br.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===a&&(l=l.add(c.wr)),!0)},o),Yt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const a=this.Dr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){An(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Yt.forEach(r.mutations,a=>{const s=new zo(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new zo(r,0),a=this.br.firstAfterOrEqual(n);return Yt.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Yt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1e{constructor(e){this.Mr=e,this.docs=function(){return new Ws(Xr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Yt.resolve(n?n.document.mutableCopy():Vs.newInvalidDocument(r))}getEntries(e,r){let n=Fu();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():Vs.newInvalidDocument(a))}),Yt.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let s=Fu();const o=r.path,l=new Xr(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||HD(MJ(d),n)<=0||(a.has(d.key)||Sw(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Yt.resolve(s)}getAllFromCollectionGroup(e,r,n,a){cn()}Or(e,r){return Yt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new j1e(this)}getSize(e){return Yt.resolve(this.size)}}class j1e extends QZ{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)}),Yt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1e{constructor(e){this.persistence=e,this.Nr=new Lm(r=>sg(r),_w),this.lastRemoteSnapshotVersion=wn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new a6,this.targetCount=0,this.kr=cg.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,a)=>r(a)),Yt.resolve()}getLastRemoteSnapshotVersion(e){return Yt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Yt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Yt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Yt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new cg(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Yt.resolve()}updateTargetData(e,r){return this.Kn(r),Yt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Yt.resolve()}removeTargets(e,r,n){let a=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)}),Yt.waitFor(s).next(()=>a)}getTargetCount(e){return Yt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Yt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Yt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(o=>{s.push(a.markPotentiallyOrphaned(e,o))}),Yt.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Yt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Yt.resolve(n)}containsKey(e,r){return Yt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Z{constructor(e,r){this.qr={},this.overlays={},this.Qr=new wd(0),this.Kr=!1,this.Kr=!0,this.$r=new E1e,this.referenceDelegate=e(this),this.Ur=new P1e(this),this.indexManager=new h1e,this.remoteDocumentCache=function(a){return new I1e(a)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new kZ(r),this.Gr=new C1e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new _1e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new S1e(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){kr("MemoryPersistence","Starting transaction:",e);const a=new B1e(this.Qr.next());return this.referenceDelegate.zr(),n(a).next(s=>this.referenceDelegate.jr(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Hr(e,r){return Yt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class B1e extends UJ{constructor(e){super(),this.currentSequenceNumber=e}}class jj{constructor(e){this.persistence=e,this.Jr=new a6,this.Yr=null}static Zr(e){return new jj(e)}get Xr(){if(this.Yr)return this.Yr;throw cn()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Yt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Yt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Yt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(a=>this.Xr.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Yt.forEach(this.Xr,n=>{const a=Xr.fromPath(n);return this.ei(e,a).next(s=>{s||r.removeEntry(a,wn.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Yt.or([()=>Yt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1e{constructor(e){this.serializer=e}O(e,r,n,a){const s=new bj("createOrUpgrade",r);n<1&&a>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",x7,{unique:!0}),c.createObjectStore("documentMutations")}(e),s9(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=Yt.resolve();return n<3&&a>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),s9(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:wn.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),n<4&&a>=4&&(n!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",x7,{unique:!0});const f=u.store("mutations"),A=d.map(h=>f.put(h));return Yt.waitFor(A)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&a>=5&&(o=o.next(()=>this.ni(s))),n<6&&a>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&a>=7&&(o=o.next(()=>this.ii(s))),n<8&&a>=8&&(o=o.next(()=>this.si(e,s))),n<9&&a>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&a>=10&&(o=o.next(()=>this.oi(s))),n<11&&a>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&a>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:ove});u.createIndex("collectionPathOverlayIndex",lve,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",cve,{unique:!1})})(e)})),n<13&&a>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:Xxe});u.createIndex("documentKeyIndex",Yxe),u.createIndex("collectionGroupIndex",Jxe)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&a>=14&&(o=o.next(()=>this.ai(e,s))),n<15&&a>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:nve}).createIndex("sequenceNumberIndex",ave,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:sve}).createIndex("documentKeyIndex",ive,{unique:!1})}(e))),n<16&&a>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&a>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,a)=>{r+=dS(a)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(a=>Yt.forEach(a,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>Yt.forEach(l,c=>{An(c.userId===s.userId);const u=mp(this.serializer,c);return MZ(e,s.userId,u).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const s=[];return n.J((o,l)=>{const c=new Pa(o),u=function(f){return[0,jc(f)]}(c);s.push(r.get(u).next(d=>d?Yt.resolve():(f=>r.put({targetId:0,path:jc(f),sequenceNumber:a.highestListenSequenceNumber}))(c)))}).next(()=>Yt.waitFor(s))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:rve});const n=r.store("collectionParents"),a=new n6,s=o=>{if(a.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:jc(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new Pa(o);return s(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],u)=>{const d=Xf(l);return s(d.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,a)=>{const s=Uy(a),o=FZ(this.serializer,s);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),a=[];return n.J((s,o)=>{const l=r.store("remoteDocumentsV14"),c=function(f){return f.document?new Xr(Pa.fromString(f.document.name).popFirst(5)):f.noDocument?Xr.fromSegments(f.noDocument.path):f.unknownDocument?Xr.fromSegments(f.unknownDocument.path):cn()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};a.push(l.put(u))}).next(()=>Yt.waitFor(a))}ai(e,r){const n=r.store("mutations"),a=VZ(this.serializer),s=new $Z(jj.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:ta();mp(this.serializer,c).keys().forEach(f=>d=d.add(f)),l.set(c.userId,d)}),Yt.forEach(l,(c,u)=>{const d=new Nl(u),f=Sj.lt(this.serializer,d),A=s.getIndexManager(d),h=Ij.lt(d,this.serializer,A,s.referenceDelegate);return new HZ(a,h,f,A).recalculateAndSaveOverlaysForDocumentKeys(new $T(r,wd.oe),c).next()})})}}function s9(t){t.createObjectStore("targetDocuments",{keyPath:eve}).createIndex("documentTargetsIndex",tve,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Zxe,{unique:!0}),t.createObjectStore("targetGlobal")}const E4="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class s6{constructor(e,r,n,a,s,o,l,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=s,this.window=o,this.document=l,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=A=>Promise.resolve(),!s6.D())throw new Ur(hr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new y1e(this,a),this.Ai=r+"main",this.serializer=new kZ(c),this.Ri=new cm(this.Ai,this.hi,new T1e(this.serializer)),this.$r=new o1e,this.Ur=new m1e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=VZ(this.serializer),this.Gr=new i1e,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&_c("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ur(hr.FAILED_PRECONDITION,E4);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new wd(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>aC(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(Mm(e))return kr("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return iy(e).get("owner").next(r=>Yt.resolve(this.vi(r)))}Ci(e){return aC(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=Do(r,"clientMetadata");return n.U().next(a=>{const s=this.xi(a,18e5),o=a.filter(l=>s.indexOf(l)===-1);return Yt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Yt.resolve(!0):iy(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Ur(hr.FAILED_PRECONDITION,E4);return!1}}return!(!this.networkEnabled||!this.inForeground)||aC(e).U().next(n=>this.xi(n,5e3).find(a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,o=!this.inForeground&&a.inForeground,l=this.networkEnabled===a.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&kr("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new $T(e,wd.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>aC(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return Ij.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new A1e(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Sj.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){kr("IndexedDbPersistence","Starting transaction:",e);const a=r==="readonly"?"readonly":"readwrite",s=function(c){return c===17?fve:c===16?dve:c===15?GD:c===14?GJ:c===13?$J:c===12?uve:c===11?HJ:void cn()}(this.hi);let o;return this.Ri.runTransaction(e,a,s,l=>(o=new $T(l,this.Qr?this.Qr.next():wd.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw _c(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Ur(hr.FAILED_PRECONDITION,LJ);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return iy(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Ur(hr.FAILED_PRECONDITION,E4)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return iy(e).put("owner",r)}static D(){return cm.D()}bi(e){const r=iy(e);return r.get("owner").next(n=>this.vi(n)?(kr("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):Yt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(_c(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;HY()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return kr("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return _c("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){_c("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function iy(t){return Do(t,"owner")}function aC(t){return Do(t,"clientMetadata")}function k1e(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=a}static Wi(e,r){let n=ta(),a=ta();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new i6(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GZ{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return HY()?8:QJ(Fo())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,a){const s={result:null};return this.Yi(e,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,r,a,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new F1e;return this.Xi(e,r,o).next(l=>{if(s.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>s.result)}es(e,r,n,a){return n.documentReadCount<this.ji?(Cx()<=ha.DEBUG&&kr("QueryEngine","SDK will not create cache indexes for query:",_x(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Yt.resolve()):(Cx()<=ha.DEBUG&&kr("QueryEngine","Query:",_x(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(Cx()<=ha.DEBUG&&kr("QueryEngine","The SDK decides to create cache indexes for query:",_x(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Id(r))):Yt.resolve())}Yi(e,r){if(B7(r))return Yt.resolve(null);let n=Id(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=lS(r,null,"F"),n=Id(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=ta(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.ts(r,l);return this.ns(r,u,o,c.readTime)?this.Yi(e,lS(r,null,"F")):this.rs(e,u,r,c)}))})))}Zi(e,r,n,a){return B7(r)||a.isEqual(wn.min())?Yt.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,a)?Yt.resolve(null):(Cx()<=ha.DEBUG&&kr("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),_x(r)),this.rs(e,o,r,Vxe(a,-1)).next(l=>l))})}ts(e,r){let n=new us(iZ(e));return r.forEach((a,s)=>{Sw(e,s)&&(n=n.add(s))}),n}ns(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Xi(e,r,n){return Cx()<=ha.DEBUG&&kr("QueryEngine","Using full collection scan to execute query:",_x(r)),this.Ji.getDocumentsMatchingQuery(e,r,Qu.min(),n)}rs(e,r,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1e{constructor(e,r,n,a){this.persistence=e,this.ss=r,this.serializer=a,this.os=new Ws(Gn),this._s=new Lm(s=>sg(s),_w),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new HZ(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function KZ(t,e,r,n){return new O1e(t,e,r,n)}async function qZ(t,e){const r=Ln(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let c=ta();for(const u of a){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of s){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function D1e(t,e){const r=Ln(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,A=f.keys();let h=Yt.resolve();return A.forEach(m=>{h=h.next(()=>d.getEntry(c,m)).next(p=>{const x=u.docVersions.get(m);An(x!==null),p.version.compareTo(x)<0&&(f.applyToRemoteDocument(p,u),p.isValidDocument()&&(p.setReadTime(u.commitVersion),d.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=ta();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function zZ(t){const e=Ln(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function R1e(t,e){const r=Ln(t),n=e.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const l=[];e.targetChanges.forEach((d,f)=>{const A=a.get(f);if(!A)return;l.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,f)));let h=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?h=h.withResumeToken(Wi.EMPTY_BYTE_STRING,wn.min()).withLastLimboFreeSnapshotVersion(wn.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,n)),a=a.insert(f,h),function(p,x,v){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(A,h,d)&&l.push(r.Ur.updateTargetData(s,h))});let c=Fu(),u=ta();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),l.push(M1e(s,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!n.isEqual(wn.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(f=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(d)}return Yt.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(r.os=a,s))}function M1e(t,e,r){let n=ta(),a=ta();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let o=Fu();return r.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(a=a.add(l)),c.isNoDocument()&&c.version.isEqual(wn.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):kr("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:a}})}function L1e(t,e){const r=Ln(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function U1e(t,e){const r=Ln(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Ur.getTargetData(n,e).next(s=>s?(a=s,Yt.resolve(a)):r.Ur.allocateTargetId(n).next(o=>(a=new Wh(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function ak(t,e,r){const n=Ln(t),a=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!Mm(o))throw o;kr("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function i9(t,e,r){const n=Ln(t);let a=wn.min(),s=ta();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=Ln(c),A=f._s.get(d);return A!==void 0?Yt.resolve(f.os.get(A)):f.Ur.getTargetData(u,d)}(n,o,Id(e)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?a:wn.min(),r?s:ta())).next(l=>(Q1e(n,Sve(e),l),{documents:l,Ts:s})))}function Q1e(t,e,r){let n=t.us.get(e)||wn.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class o9{constructor(){this.activeTargetIds=kve()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class WZ{constructor(){this.so=new o9,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new o9,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1e{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sC=null;function S4(){return sC===null?sC=function(){return 268435456+Math.round(2147483648*Math.random())}():sC++,"0x"+sC.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1e{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul="WebChannelConnection";class G1e extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${a}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${s}`}get Fo(){return!1}Mo(r,n,a,s,o){const l=S4(),c=this.xo(r,n.toUriEncodedString());kr("RestConnection",`Sending RPC '${r}' ${l}:`,c,a);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(r,c,u,a).then(d=>(kr("RestConnection",`Received RPC '${r}' ${l}: `,d),d),d=>{throw xm("RestConnection",`RPC '${r}' ${l} failed with error: `,d,"url: ",c,"request:",a),d})}Lo(r,n,a,s,o,l){return this.Mo(r,n,a,s,o)}Oo(r,n,a){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+o1}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),a&&a.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const a=H1e[r];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,a){const s=S4();return new Promise((o,l)=>{const c=new PJ;c.setWithCredentials(!0),c.listenOnce(BJ.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case nE.NO_ERROR:const d=c.getResponseJson();kr(Ul,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case nE.TIMEOUT:kr(Ul,`RPC '${e}' ${s} timed out`),l(new Ur(hr.DEADLINE_EXCEEDED,"Request time out"));break;case nE.HTTP_ERROR:const f=c.getStatus();if(kr(Ul,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let A=c.getResponseJson();Array.isArray(A)&&(A=A[0]);const h=A==null?void 0:A.error;if(h&&h.status&&h.message){const m=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(hr).indexOf(v)>=0?v:hr.UNKNOWN}(h.status);l(new Ur(m,h.message))}else l(new Ur(hr.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ur(hr.UNAVAILABLE,"Connection failed."));break;default:cn()}}finally{kr(Ul,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(a);kr(Ul,`RPC '${e}' ${s} sending request:`,a),c.send(r,"POST",u,n,15)})}Bo(e,r,n){const a=S4(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=FJ(),l=kJ(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=s.join("");kr(Ul,`Creating RPC '${e}' stream ${a}: ${d}`,c);const f=o.createWebChannel(d,c);let A=!1,h=!1;const m=new $1e({Io:x=>{h?kr(Ul,`Not sending because RPC '${e}' stream ${a} is closed:`,x):(A||(kr(Ul,`Opening RPC '${e}' stream ${a} transport.`),f.open(),A=!0),kr(Ul,`RPC '${e}' stream ${a} sending:`,x),f.send(x))},To:()=>f.close()}),p=(x,v,y)=>{x.listen(v,b=>{try{y(b)}catch(w){setTimeout(()=>{throw w},0)}})};return p(f,Ry.EventType.OPEN,()=>{h||(kr(Ul,`RPC '${e}' stream ${a} transport opened.`),m.yo())}),p(f,Ry.EventType.CLOSE,()=>{h||(h=!0,kr(Ul,`RPC '${e}' stream ${a} transport closed`),m.So())}),p(f,Ry.EventType.ERROR,x=>{h||(h=!0,xm(Ul,`RPC '${e}' stream ${a} transport errored:`,x),m.So(new Ur(hr.UNAVAILABLE,"The operation could not be completed")))}),p(f,Ry.EventType.MESSAGE,x=>{var v;if(!h){const y=x.data[0];An(!!y);const b=y,w=b.error||((v=b[0])===null||v===void 0?void 0:v.error);if(w){kr(Ul,`RPC '${e}' stream ${a} received error:`,w);const j=w.status;let I=function(E){const B=to[E];if(B!==void 0)return vZ(B)}(j),_=w.message;I===void 0&&(I=hr.INTERNAL,_="Unknown error status: "+j+" with message "+w.message),h=!0,m.So(new Ur(I,_)),f.close()}else kr(Ul,`RPC '${e}' stream ${a} received:`,y),m.bo(y)}}),p(l,TJ.STAT_EVENT,x=>{x.stat===VT.PROXY?kr(Ul,`RPC '${e}' stream ${a} detected buffering proxy`):x.stat===VT.NOPROXY&&kr(Ul,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1e(){return typeof window<"u"?window:null}function uE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(t){return new zve(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,r,n=1e3,a=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=a,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,r-n);a>0&&kr("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XZ{constructor(e,r,n,a,s,o,l,c){this.ui=e,this.Ho=n,this.Jo=a,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new o6(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===hr.RESOURCE_EXHAUSTED?(_c(r.toString()),_c("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===hr.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.Yo===r&&this.P_(n,a)},n=>{e(()=>{const a=new Ur(hr.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{n(()=>this.I_(a))}),this.stream.onMessage(a=>{n(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return kr("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class q1e extends XZ{constructor(e,r,n,a,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=Jve(this.serializer,e),n=function(s){if(!("targetChange"in s))return wn.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?wn.min():o.readTime?rl(o.readTime):wn.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=ZT(this.serializer),r.addTarget=function(s,o){let l;const c=o.target;if(l=iS(c)?{documents:SZ(s,c)}:{query:IZ(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=wZ(s,o.resumeToken);const u=YT(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(wn.min())>0){l.readTime=Ov(s,o.snapshotVersion.toTimestamp());const u=YT(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=e1e(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=ZT(this.serializer),r.removeTarget=e,this.a_(r)}}class z1e extends XZ{constructor(e,r,n,a,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return An(!!e.streamToken),this.lastStreamToken=e.streamToken,An(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){An(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=Zve(e.writeResults,e.commitTime),n=rl(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=ZT(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>b2(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1e extends class{}{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new Ur(hr.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,JT(r,n),a,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===hr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ur(hr.UNKNOWN,s.toString())})}Lo(e,r,n,a,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,JT(r,n),a,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===hr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ur(hr.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class X1e{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(_c(r),this.D_=!1):kr("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1e{constructor(e,r,n,a,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{Bg(this)&&(kr("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Ln(c);u.L_.add(4),await jw(u),u.q_.set("Unknown"),u.L_.delete(4),await Bj(u)}(this))})}),this.q_=new X1e(n,a)}}async function Bj(t){if(Bg(t))for(const e of t.B_)await e(!0)}async function jw(t){for(const e of t.B_)await e(!1)}function YZ(t,e){const r=Ln(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),d6(r)?u6(r):d1(r).r_()&&c6(r,e))}function l6(t,e){const r=Ln(t),n=d1(r);r.N_.delete(e),n.r_()&&JZ(r,e),r.N_.size===0&&(n.r_()?n.o_():Bg(r)&&r.q_.set("Unknown"))}function c6(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(wn.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}d1(t).A_(e)}function JZ(t,e){t.Q_.xe(e),d1(t).R_(e)}function u6(t){t.Q_=new $ve({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),d1(t).start(),t.q_.v_()}function d6(t){return Bg(t)&&!d1(t).n_()&&t.N_.size>0}function Bg(t){return Ln(t).L_.size===0}function ZZ(t){t.Q_=void 0}async function J1e(t){t.q_.set("Online")}async function Z1e(t){t.N_.forEach((e,r)=>{c6(t,e)})}async function eye(t,e){ZZ(t),d6(t)?(t.q_.M_(e),u6(t)):t.q_.set("Unknown")}async function tye(t,e,r){if(t.q_.set("Online"),e instanceof bZ&&e.state===2&&e.cause)try{await async function(a,s){const o=s.cause;for(const l of s.targetIds)a.N_.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.N_.delete(l),a.Q_.removeTarget(l))}(t,e)}catch(n){kr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await fS(t,n)}else if(e instanceof cE?t.Q_.Ke(e):e instanceof yZ?t.Q_.He(e):t.Q_.We(e),!r.isEqual(wn.min()))try{const n=await zZ(t.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Wi.EMPTY_BYTE_STRING,d.snapshotVersion)),JZ(s,c);const f=new Wh(d.target,c,u,d.sequenceNumber);c6(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){kr("RemoteStore","Failed to raise snapshot:",n),await fS(t,n)}}async function fS(t,e,r){if(!Mm(e))throw e;t.L_.add(1),await jw(t),t.q_.set("Offline"),r||(r=()=>zZ(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{kr("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Bj(t)})}function eee(t,e){return e().catch(r=>fS(t,r,e))}async function Pw(t){const e=Ln(t),r=wm(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rye(e);)try{const a=await L1e(e.localStore,n);if(a===null){e.O_.length===0&&r.o_();break}n=a.batchId,nye(e,a)}catch(a){await fS(e,a)}tee(e)&&ree(e)}function rye(t){return Bg(t)&&t.O_.length<10}function nye(t,e){t.O_.push(e);const r=wm(t);r.r_()&&r.V_&&r.m_(e.mutations)}function tee(t){return Bg(t)&&!wm(t).n_()&&t.O_.length>0}function ree(t){wm(t).start()}async function aye(t){wm(t).p_()}async function sye(t){const e=wm(t);for(const r of t.O_)e.m_(r.mutations)}async function iye(t,e,r){const n=t.O_.shift(),a=JD.from(n,e,r);await eee(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await Pw(t)}async function oye(t,e){e&&wm(t).V_&&await async function(n,a){if(function(o){return xZ(o)&&o!==hr.ABORTED}(a.code)){const s=n.O_.shift();wm(n).s_(),await eee(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await Pw(n)}}(t,e),tee(t)&&ree(t)}async function c9(t,e){const r=Ln(t);r.asyncQueue.verifyOperationInProgress(),kr("RemoteStore","RemoteStore received new credentials");const n=Bg(r);r.L_.add(3),await jw(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Bj(r)}async function lye(t,e){const r=Ln(t);e?(r.L_.delete(2),await Bj(r)):e||(r.L_.add(2),await jw(r),r.q_.set("Unknown"))}function d1(t){return t.K_||(t.K_=function(r,n,a){const s=Ln(r);return s.w_(),new q1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:J1e.bind(null,t),Ro:Z1e.bind(null,t),mo:eye.bind(null,t),d_:tye.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),d6(t)?u6(t):t.q_.set("Unknown")):(await t.K_.stop(),ZZ(t))})),t.K_}function wm(t){return t.U_||(t.U_=function(r,n,a){const s=Ln(r);return s.w_(),new z1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:aye.bind(null,t),mo:oye.bind(null,t),f_:sye.bind(null,t),g_:iye.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Pw(t)):(await t.U_.stop(),t.O_.length>0&&(kr("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e,r,n,a,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new pf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,s){const o=Date.now()+n,l=new f6(e,r,o,a,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ur(hr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function h6(t,e){if(_c("AsyncQueue",`${e}: ${t}`),Mm(t))return new Ur(hr.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Xr.comparator(r.key,n.key):(r,n)=>Xr.comparator(r.key,n.key),this.keyedMap=My(),this.sortedSet=new Ws(this.comparator)}static emptySet(e){return new fv(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof fv)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new fv;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{constructor(){this.W_=new Ws(Xr.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):cn():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Dv{constructor(e,r,n,a,s,o,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,a,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new Dv(e,r,fv.emptySet(r),o,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nj(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cye{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class uye{constructor(){this.queries=d9(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const a=Ln(r),s=a.queries;a.queries=d9(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Ur(hr.ABORTED,"Firestore shutting down"))}}function d9(){return new Lm(t=>sZ(t),Nj)}async function A6(t,e){const r=Ln(t);let n=3;const a=e.query;let s=r.queries.get(a);s?!s.H_()&&e.J_()&&(n=2):(s=new cye,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(a,!0);break;case 1:s.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const l=h6(o,`Initialization of query '${_x(e.query)}' failed`);return void e.onError(l)}r.queries.set(a,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&p6(r)}async function m6(t,e){const r=Ln(t),n=e.query;let a=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?a=e.J_()?0:1:!s.H_()&&e.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function dye(t,e){const r=Ln(t);let n=!1;for(const a of e){const s=a.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(a)&&(n=!0);o.z_=a}}n&&p6(r)}function fye(t,e,r){const n=Ln(t),a=n.queries.get(e);if(a)for(const s of a.j_)s.onError(r);n.queries.delete(e)}function p6(t){t.Y_.forEach(e=>{e.next()})}var sk,f9;(f9=sk||(sk={})).ea="default",f9.Cache="cache";class g6{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Dv(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Dv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==sk.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nee{constructor(e){this.key=e}}class aee{constructor(e){this.key=e}}class hye{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ta(),this.mutatedKeys=ta(),this.Aa=iZ(e),this.Ra=new fv(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new u9,a=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=a,l=!1;const c=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,u=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((d,f)=>{const A=a.get(d),h=Sw(this.query,f)?f:null,m=!!A&&this.mutatedKeys.has(A.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;A&&h?A.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(A,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||u&&this.Aa(h,u)<0)&&(l=!0)):!A&&h?(n.track({type:0,doc:h}),x=!0):A&&!h&&(n.track({type:1,doc:A}),x=!0,(c||u)&&(l=!0)),x&&(h?(o=o.add(h),s=p?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cn()}};return p(h)-p(m)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(n),a=a!=null&&a;const l=r&&!a?this.ya():[],c=this.da.size===0&&this.current&&!a?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Dv(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new u9,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ta(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new aee(n))}),this.da.forEach(n=>{e.has(n)||r.push(new nee(n))}),r}ba(e){this.Ta=e.Ts,this.da=ta();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Dv.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Aye{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class mye{constructor(e){this.key=e,this.va=!1}}class pye{constructor(e,r,n,a,s,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Lm(l=>sZ(l),Nj),this.Ma=new Map,this.xa=new Set,this.Oa=new Ws(Xr.comparator),this.Na=new Map,this.La=new a6,this.Ba={},this.ka=new Map,this.qa=cg.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function gye(t,e,r=!0){const n=uee(t);let a;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await see(n,e,r,!0),a}async function xye(t,e){const r=uee(t);await see(r,e,!0,!1)}async function see(t,e,r,n){const a=await U1e(t.localStore,Id(e)),s=a.targetId,o=t.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await vye(t,e,s,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&YZ(t.remoteStore,a),l}async function vye(t,e,r,n,a){t.Ka=(f,A,h)=>async function(p,x,v,y){let b=x.view.ma(v);b.ns&&(b=await i9(p.localStore,x.query,!1).then(({documents:_})=>x.view.ma(_,b)));const w=y&&y.targetChanges.get(x.targetId),j=y&&y.targetMismatches.get(x.targetId)!=null,I=x.view.applyChanges(b,p.isPrimaryClient,w,j);return A9(p,x.targetId,I.wa),I.snapshot}(t,f,A,h);const s=await i9(t.localStore,e,!0),o=new hye(e,s.Ts),l=o.ma(s.documents),c=Iw.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),u=o.applyChanges(l,t.isPrimaryClient,c);A9(t,r,u.wa);const d=new Aye(e,r,o);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function yye(t,e,r){const n=Ln(t),a=n.Fa.get(e),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(o=>!Nj(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await ak(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&l6(n.remoteStore,a.targetId),ik(n,a.targetId)}).catch(jg)):(ik(n,a.targetId),await ak(n.localStore,a.targetId,!0))}async function bye(t,e){const r=Ln(t),n=r.Fa.get(e),a=r.Ma.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),l6(r.remoteStore,n.targetId))}async function wye(t,e,r){const n=dee(t);try{const a=await function(o,l){const c=Ln(o),u=vr.now(),d=l.reduce((h,m)=>h.add(m.key),ta());let f,A;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Fu(),p=ta();return c.cs.getEntries(h,d).next(x=>{m=x,m.forEach((v,y)=>{y.isValidDocument()||(p=p.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{f=x;const v=[];for(const y of l){const b=Uve(y,f.get(y.key).overlayedDocument);b!=null&&v.push(new OA(y.key,b,XJ(b.value.mapValue),$s.exists(!0)))}return c.mutationQueue.addMutationBatch(h,u,v,l)}).next(x=>{A=x;const v=x.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,v)})}).then(()=>({batchId:A.batchId,changes:lZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Ws(Gn)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(n,a.batchId,r),await Bw(n,a.changes),await Pw(n.remoteStore)}catch(a){const s=h6(a,"Failed to persist write");r.reject(s)}}async function iee(t,e){const r=Ln(t);try{const n=await R1e(r.localStore,e);e.targetChanges.forEach((a,s)=>{const o=r.Na.get(s);o&&(An(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?An(o.va):a.removedDocuments.size>0&&(An(o.va),o.va=!1))}),await Bw(r,n,e)}catch(n){await jg(n)}}function h9(t,e,r){const n=Ln(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&a.push(l.snapshot)}),function(o,l){const c=Ln(o);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const A of f.j_)A.Z_(l)&&(u=!0)}),u&&p6(c)}(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Nye(t,e,r){const n=Ln(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Na.get(e),s=a&&a.key;if(s){let o=new Ws(Xr.comparator);o=o.insert(s,Vs.newNoDocument(s,wn.min()));const l=ta().add(s),c=new Ej(wn.min(),new Map,new Ws(Gn),o,l);await iee(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),x6(n)}else await ak(n.localStore,e,!1).then(()=>ik(n,e,r)).catch(jg)}async function Cye(t,e){const r=Ln(t),n=e.batch.batchId;try{const a=await D1e(r.localStore,e);lee(r,n,null),oee(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Bw(r,a)}catch(a){await jg(a)}}async function _ye(t,e,r){const n=Ln(t);try{const a=await function(o,l){const c=Ln(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(An(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);lee(n,e,r),oee(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Bw(n,a)}catch(a){await jg(a)}}function oee(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function lee(t,e,r){const n=Ln(t);let a=n.Ba[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(r?s.reject(r):s.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function ik(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||cee(t,n)})}function cee(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(l6(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),x6(t))}function A9(t,e,r){for(const n of r)n instanceof nee?(t.La.addReference(n.key,e),Eye(t,n)):n instanceof aee?(kr("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||cee(t,n.key)):cn()}function Eye(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(kr("SyncEngine","New document in limbo: "+r),t.xa.add(n),x6(t))}function x6(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Xr(Pa.fromString(e)),n=t.qa.next();t.Na.set(n,new mye(r)),t.Oa=t.Oa.insert(r,n),YZ(t.remoteStore,new Wh(Id(Ew(r.path)),n,"TargetPurposeLimboResolution",wd.oe))}}async function Bw(t,e,r){const n=Ln(t),a=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const f=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){a.push(u);const f=i6.Wi(c.targetId,u);s.push(f)}}))}),await Promise.all(o),n.Ca.d_(a),await async function(c,u){const d=Ln(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Yt.forEach(u,A=>Yt.forEach(A.$i,h=>d.persistence.referenceDelegate.addReference(f,A.targetId,h)).next(()=>Yt.forEach(A.Ui,h=>d.persistence.referenceDelegate.removeReference(f,A.targetId,h)))))}catch(f){if(!Mm(f))throw f;kr("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const A=f.targetId;if(!f.fromCache){const h=d.os.get(A),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.os=d.os.insert(A,p)}}}(n.localStore,s))}async function Sye(t,e){const r=Ln(t);if(!r.currentUser.isEqual(e)){kr("SyncEngine","User change. New user:",e.toKey());const n=await qZ(r.localStore,e);r.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new Ur(hr.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Bw(r,n.hs)}}function Iye(t,e){const r=Ln(t),n=r.Na.get(e);if(n&&n.va)return ta().add(n.key);{let a=ta();const s=r.Ma.get(e);if(!s)return a;for(const o of s){const l=r.Fa.get(o);a=a.unionWith(l.view.Va)}return a}}function uee(t){const e=Ln(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=iee.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Iye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Nye.bind(null,e),e.Ca.d_=dye.bind(null,e.eventManager),e.Ca.$a=fye.bind(null,e.eventManager),e}function dee(t){const e=Ln(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Cye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_ye.bind(null,e),e}class w2{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pj(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return KZ(this.persistence,new GZ,e.initialUser,this.serializer)}Ga(e){return new $Z(jj.Zr,this.serializer)}Wa(e){return new WZ}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}w2.provider={build:()=>new w2};class jye extends w2{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await dee(this.Ja.syncEngine),await Pw(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return KZ(this.persistence,new GZ,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new g1e(n,e.asyncQueue,r)}Ha(e,r){const n=new Kxe(r,this.persistence);return new Gxe(e.asyncQueue,n)}Ga(e){const r=k1e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Wc.withCacheSize(this.cacheSizeBytes):Wc.DEFAULT;return new s6(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,K1e(),uE(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new WZ}}class hS{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>h9(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Sye.bind(null,this.syncEngine),await lye(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new uye}()}createDatastore(e){const r=Pj(e.databaseInfo.databaseId),n=function(s){return new G1e(s)}(e.databaseInfo);return function(s,o,l,c){return new W1e(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,s,o,l){return new Y1e(n,a,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>h9(this.syncEngine,r,0),function(){return l9.D()?new l9:new V1e}())}createSyncEngine(e,r){return function(a,s,o,l,c,u,d){const f=new pye(a,s,o,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const s=Ln(a);kr("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await jw(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}hS.provider={build:()=>new hS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):_c("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pye{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ur(hr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(a,s){const o=Ln(a),l={documents:s.map(f=>y2(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,Pa.emptyPath(),l,s.length),u=new Map;c.forEach(f=>{const A=Yve(o.serializer,f);u.set(A.key.toString(),A)});const d=[];return s.forEach(f=>{const A=u.get(f.toString());An(!!A),d.push(A)}),d}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new u1(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const a=Xr.fromPath(n);this.mutations.push(new XD(a,this.precondition(a)))}),await async function(n,a){const s=Ln(n),o={writes:a.map(l=>b2(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,Pa.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw cn();r=wn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Ur(hr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(wn.min())?$s.exists(!1):$s.updateTime(r):$s.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(wn.min()))throw new Ur(hr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $s.updateTime(r)}return $s.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bye{constructor(e,r,n,a,s){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=a,this.deferred=s,this._u=n.maxAttempts,this.t_=new o6(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new Pye(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(a=>{this.lu(a)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Cw(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!xZ(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tye{constructor(e,r,n,a,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Nl.UNAUTHENTICATED,this.clientId=VD.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{kr("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(kr("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=h6(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function I4(t,e){t.asyncQueue.verifyOperationInProgress(),kr("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await qZ(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function m9(t,e){t.asyncQueue.verifyOperationInProgress();const r=await kye(t);kr("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>c9(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>c9(e.remoteStore,a)),t._onlineComponents=e}async function kye(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){kr("FirestoreClient","Using user provided OfflineComponentProvider");try{await I4(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===hr.FAILED_PRECONDITION||a.code===hr.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;xm("Error using user provided cache. Falling back to memory cache: "+r),await I4(t,new w2)}}else kr("FirestoreClient","Using default OfflineComponentProvider"),await I4(t,new w2);return t._offlineComponents}async function y6(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(kr("FirestoreClient","Using user provided OnlineComponentProvider"),await m9(t,t._uninitializedComponentsProvider._online)):(kr("FirestoreClient","Using default OnlineComponentProvider"),await m9(t,new hS))),t._onlineComponents}function Fye(t){return y6(t).then(e=>e.syncEngine)}function Oye(t){return y6(t).then(e=>e.datastore)}async function AS(t){const e=await y6(t),r=e.eventManager;return r.onListen=gye.bind(null,e.syncEngine),r.onUnlisten=yye.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=xye.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=bye.bind(null,e.syncEngine),r}function Dye(t,e,r={}){const n=new pf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new v6({next:A=>{d.Za(),o.enqueueAndForget(()=>m6(s,f));const h=A.docs.has(l);!h&&A.fromCache?u.reject(new Ur(hr.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&A.fromCache&&c&&c.source==="server"?u.reject(new Ur(hr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new g6(Ew(l.path),d,{includeMetadataChanges:!0,_a:!0});return A6(s,f)}(await AS(t),t.asyncQueue,e,r,n)),n.promise}function Rye(t,e,r={}){const n=new pf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new v6({next:A=>{d.Za(),o.enqueueAndForget(()=>m6(s,f)),A.fromCache&&c.source==="server"?u.reject(new Ur(hr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new g6(l,d,{includeMetadataChanges:!0,_a:!0});return A6(s,f)}(await AS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fee(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p9=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hee(t,e,r){if(!r)throw new Ur(hr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Aee(t,e,r,n){if(e===!0&&n===!0)throw new Ur(hr.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function g9(t){if(!Xr.isDocumentKey(t))throw new Ur(hr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function x9(t){if(Xr.isDocumentKey(t))throw new Ur(hr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Tj(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":cn()}function nl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ur(hr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Tj(t);throw new Ur(hr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ur(hr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ur(hr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Aee("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fee((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ur(hr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ur(hr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ur(hr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kj{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new v9({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ur(hr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ur(hr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new v9(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new DJ;switch(n.type){case"firstParty":return new Rxe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ur(hr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=p9.get(r);n&&(kr("ComponentProvider","Removing Datastore"),p9.delete(r),n.terminate())}(this),Promise.resolve()}}function mee(t,e,r,n={}){var a;const s=(t=nl(t,kj))._getSettings(),o=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&xm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Nl.MOCK_USER;else{l=Z0e(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Ur(hr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Nl(u)}t._authCredentials=new Fxe(new OJ(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new hh(this.firestore,e,this._query)}}class al{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new aA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new al(this.firestore,e,this._key)}}class aA extends hh{constructor(e,r,n){super(e,r,Ew(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new al(this.firestore,null,new Xr(e))}withConverter(e){return new aA(this.firestore,e,this._path)}}function yt(t,e,...r){if(t=fi(t),hee("collection","path",e),t instanceof kj){const n=Pa.fromString(e,...r);return x9(n),new aA(t,null,n)}{if(!(t instanceof al||t instanceof aA))throw new Ur(hr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pa.fromString(e,...r));return x9(n),new aA(t.firestore,null,n)}}function Zt(t,e,...r){if(t=fi(t),arguments.length===1&&(e=VD.newId()),hee("doc","path",e),t instanceof kj){const n=Pa.fromString(e,...r);return g9(n),new al(t,null,new Xr(n))}{if(!(t instanceof al||t instanceof aA))throw new Ur(hr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pa.fromString(e,...r));return g9(n),new al(t.firestore,t instanceof aA?t.converter:null,new Xr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new o6(this,"async_queue_retry"),this.Vu=()=>{const n=uE();n&&kr("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=uE();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=uE();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new pf;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Mm(e))throw e;kr("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const a=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw _c("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const a=f6.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(a),a}fu(){this.Eu&&cn()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function b9(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const s of n)if(s in a&&typeof a[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Vu extends kj{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new y9,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new y9(e),this._firestoreClient=void 0,await e}}}function pee(t,e){const r=typeof t=="object"?t:ID(),n=typeof t=="string"?t:"(default)",a=ED(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=Y0e("firestore");s&&mee(a,...s)}return a}function Tg(t){if(t._terminated)throw new Ur(hr.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||gee(t),t._firestoreClient}function gee(t){var e,r,n;const a=t._freezeSettings(),s=function(l,c,u,d){return new Ave(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,fee(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new Tye(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function xee(t,e){xm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return Mye(t,hS.provider,{build:n=>new jye(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function Mye(t,e,r){if((t=nl(t,Vu))._firestoreClient||t._terminated)throw new Ur(hr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Ur(hr.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},gee(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nm(Wi.fromBase64String(e))}catch(r){throw new Ur(hr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Nm(Wi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ur(hr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ur(hr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ur(hr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Gn(this._lat,e._lat)||Gn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lye=/^__.*__$/;class Uye{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new OA(e,this.data,this.fieldMask,r,this.fieldTransforms):new c1(e,this.data,r,this.fieldTransforms)}}class vee{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new OA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function yee(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cn()}}class Dj{constructor(e,r,n,a,s,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Dj(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return mS(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(yee(this.Cu)&&Lye.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Qye{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Pj(e)}Qu(e,r,n,a=!1){return new Dj({Cu:e,methodName:r,qu:n,path:Hs.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function f1(t){const e=t._freezeSettings(),r=Pj(t._databaseId);return new Qye(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Rj(t,e,r,n,a,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,r,a);C6("Data must be an object, but it was:",o,n);const l=bee(n,o);let c,u;if(s.merge)c=new eu(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const A=ok(e,f,r);if(!o.contains(A))throw new Ur(hr.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);Nee(d,A)||d.push(A)}c=new eu(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new Uye(new El(l),c,u)}class Mj extends Tw{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mj}}function Vye(t,e,r){return new Dj({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class b6 extends Tw{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=Vye(this,e,!0),n=this.Ku.map(s=>h1(s,r)),a=new ig(n);return new mZ(e.path,a)}isEqual(e){return e instanceof b6&&i2(this.Ku,e.Ku)}}function w6(t,e,r,n){const a=t.Qu(1,e,r);C6("Data must be an object, but it was:",a,n);const s=[],o=El.empty();Pg(n,(c,u)=>{const d=_6(e,c,r);u=fi(u);const f=a.Nu(d);if(u instanceof Mj)s.push(d);else{const A=h1(u,f);A!=null&&(s.push(d),o.set(d,A))}});const l=new eu(s);return new vee(o,l,a.fieldTransforms)}function N6(t,e,r,n,a,s){const o=t.Qu(1,e,r),l=[ok(e,n,r)],c=[a];if(s.length%2!=0)throw new Ur(hr.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)l.push(ok(e,s[A])),c.push(s[A+1]);const u=[],d=El.empty();for(let A=l.length-1;A>=0;--A)if(!Nee(u,l[A])){const h=l[A];let m=c[A];m=fi(m);const p=o.Nu(h);if(m instanceof Mj)u.push(h);else{const x=h1(m,p);x!=null&&(u.push(h),d.set(h,x))}}const f=new eu(u);return new vee(d,f,o.fieldTransforms)}function Hye(t,e,r,n=!1){return h1(r,t.Qu(n?4:3,e))}function h1(t,e){if(wee(t=fi(t)))return C6("Unsupported field value:",e,t),bee(t,e);if(t instanceof Tw)return function(n,a){if(!yee(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,a){const s=[];let o=0;for(const l of n){let c=h1(l,a.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(n,a){if((n=fi(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Fve(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=vr.fromDate(n);return{timestampValue:Ov(a.serializer,s)}}if(n instanceof vr){const s=new vr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ov(a.serializer,s)}}if(n instanceof Fj)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Nm)return{bytesValue:wZ(a.serializer,n._byteString)};if(n instanceof al){const s=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:t6(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Oj)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return WD(l.serializer,c)})}}}}}}(n,a);throw a.Bu(`Unsupported field value: ${Tj(n)}`)}(t,e)}function bee(t,e){const r={};return KJ(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pg(t,(n,a)=>{const s=h1(a,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function wee(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vr||t instanceof Fj||t instanceof Nm||t instanceof al||t instanceof Tw||t instanceof Oj)}function C6(t,e,r){if(!wee(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=Tj(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function ok(t,e,r){if((e=fi(e))instanceof kg)return e._internalPath;if(typeof e=="string")return _6(t,e);throw mS("Field path arguments must be of type string or ",t,!1,void 0,r)}const $ye=new RegExp("[~\\*/\\[\\]]");function _6(t,e,r){if(e.search($ye)>=0)throw mS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new kg(...e.split("."))._internalPath}catch{throw mS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function mS(t,e,r,n,a){const s=n&&!n.isEmpty(),o=a!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${a}`),c+=")"),new Ur(hr.INVALID_ARGUMENT,l+t+c)}function Nee(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,r,n,a,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new al(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Gye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Lj("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Gye extends pS{data(){return super.data()}}function Lj(t,e){return typeof e=="string"?_6(t,e):e instanceof kg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cee(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ur(hr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class E6{}class Uj extends E6{}function sr(t,e,...r){let n=[];e instanceof E6&&n.push(e),n=n.concat(r),function(s){const o=s.filter(c=>c instanceof Qj).length,l=s.filter(c=>c instanceof kw).length;if(o>1||o>0&&l>0)throw new Ur(hr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class kw extends Uj{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new kw(e,r,n)}_apply(e){const r=this._parse(e);return _ee(e._query,r),new hh(e.firestore,e.converter,XT(e._query,r))}_parse(e){const r=f1(e.firestore);return function(s,o,l,c,u,d,f){let A;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ur(hr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){N9(f,d);const h=[];for(const m of f)h.push(w9(c,s,m));A={arrayValue:{values:h}}}else A=w9(c,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||N9(f,d),A=Hye(l,o,f,d==="in"||d==="not-in");return Aa.create(u,d,A)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function mr(t,e,r){const n=e,a=Lj("where",t);return kw._create(a,n,r)}class Qj extends E6{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Qj(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ts.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,s){let o=a;const l=s.getFlattenedFilters();for(const c of l)_ee(o,c),o=XT(o,c)}(e._query,r),new hh(e.firestore,e.converter,XT(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Vj extends Uj{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Vj(e,r)}_apply(e){const r=function(a,s,o){if(a.startAt!==null)throw new Ur(hr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Ur(hr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new g2(s,o)}(e._query,this._field,this._direction);return new hh(e.firestore,e.converter,function(a,s){const o=a.explicitOrderBy.concat([s]);return new l1(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,r))}}function In(t,e="asc"){const r=e,n=Lj("orderBy",t);return Vj._create(n,r)}class Hj extends Uj{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Hj(e,r,n)}_apply(e){return new hh(e.firestore,e.converter,lS(e._query,this._limit,this._limitType))}}function gS(t){return Hj._create("limit",t,"F")}function w9(t,e,r){if(typeof(r=fi(r))=="string"){if(r==="")throw new Ur(hr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aZ(e)&&r.indexOf("/")!==-1)throw new Ur(hr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Pa.fromString(r));if(!Xr.isDocumentKey(n))throw new Ur(hr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return m2(t,new Xr(n))}if(r instanceof al)return m2(t,r._key);throw new Ur(hr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Tj(r)}.`)}function N9(t,e){if(!Array.isArray(t)||t.length===0)throw new Ur(hr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _ee(t,e){const r=function(a,s){for(const o of a)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ur(hr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ur(hr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class S6{convertValue(e,r="none"){switch(ag(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Us(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(vm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw cn()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Pg(e,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,a;const s=(a=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(o=>Us(o.doubleValue));return new Oj(s)}convertGeoPoint(e){return new Fj(Us(e.latitude),Us(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=qD(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(h2(e));default:return null}}convertTimestamp(e){const r=xA(e);return new vr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Pa.fromString(e);An(TZ(n));const a=new ym(n.get(1),n.get(3)),s=new Xr(n.popFirst(5));return a.isEqual(r)||_c(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $j(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Kye extends S6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new al(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gj extends pS{constructor(e,r,n,a,s,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new xb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Lj("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class xb extends Gj{data(e={}){return super.data(e)}}class I6{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Np(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new xb(this._firestore,this._userDataWriter,n.key,n,new Np(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ur(hr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const c=new xb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Np(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new xb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Np(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:qye(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function qye(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cn()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zs(t){t=nl(t,al);const e=nl(t.firestore,Vu);return Dye(Tg(e),t._key).then(r=>See(e,t,r))}class Kj extends S6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new al(this.firestore,null,r)}}function Ht(t){t=nl(t,hh);const e=nl(t.firestore,Vu),r=Tg(e),n=new Kj(e);return Cee(t._query),Rye(r,t._query).then(a=>new I6(e,n,t,a))}function Eee(t,e,r){t=nl(t,al);const n=nl(t.firestore,Vu),a=$j(t.converter,e,r);return A1(n,[Rj(f1(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,$s.none())])}function Fn(t,e,r,...n){t=nl(t,al);const a=nl(t.firestore,Vu),s=f1(a);let o;return o=typeof(e=fi(e))=="string"||e instanceof kg?N6(s,"updateDoc",t._key,e,r,n):w6(s,"updateDoc",t._key,e),A1(a,[o.toMutation(t._key,$s.exists(!0))])}function Kn(t){return A1(nl(t.firestore,Vu),[new u1(t._key,$s.none())])}function Jn(t,e){const r=nl(t.firestore,Vu),n=Zt(t),a=$j(t.converter,e);return A1(r,[Rj(f1(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,$s.exists(!1))]).then(()=>n)}function jd(t,...e){var r,n,a;t=fi(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||b9(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(b9(e[o])){const f=e[o];e[o]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(a=f.complete)===null||a===void 0?void 0:a.bind(f)}let c,u,d;if(t instanceof al)u=nl(t.firestore,Vu),d=Ew(t._key.path),c={next:f=>{e[o]&&e[o](See(u,t,f))},error:e[o+1],complete:e[o+2]};else{const f=nl(t,hh);u=nl(f.firestore,Vu),d=f._query;const A=new Kj(u);c={next:h=>{e[o]&&e[o](new I6(u,A,f,h))},error:e[o+1],complete:e[o+2]},Cee(t._query)}return function(A,h,m,p){const x=new v6(p),v=new g6(h,x,m);return A.asyncQueue.enqueueAndForget(async()=>A6(await AS(A),v)),()=>{x.Za(),A.asyncQueue.enqueueAndForget(async()=>m6(await AS(A),v))}}(Tg(u),d,l,c)}function A1(t,e){return function(n,a){const s=new pf;return n.asyncQueue.enqueueAndForget(async()=>wye(await Fye(n),a,s)),s.promise}(Tg(t),e)}function See(t,e,r){const n=r.docs.get(e._key),a=new Kj(t);return new Gj(t,a,e._key,n,new Np(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zye={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iee{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=f1(e)}set(e,r,n){this._verifyNotCommitted();const a=M0(e,this._firestore),s=$j(a.converter,r,n),o=Rj(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,$s.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const s=M0(e,this._firestore);let o;return o=typeof(r=fi(r))=="string"||r instanceof kg?N6(this._dataReader,"WriteBatch.update",s._key,r,n,a):w6(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,$s.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=M0(e,this._firestore);return this._mutations=this._mutations.concat(new u1(r._key,$s.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ur(hr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function M0(t,e){if((t=fi(t)).firestore!==e)throw new Ur(hr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jee extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=f1(r)}get(r){const n=M0(r,this._firestore),a=new Kye(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return cn();const o=s[0];if(o.isFoundDocument())return new pS(this._firestore,a,o.key,o,n.converter);if(o.isNoDocument())return new pS(this._firestore,a,n._key,null,n.converter);throw cn()})}set(r,n,a){const s=M0(r,this._firestore),o=$j(s.converter,n,a),l=Rj(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,a);return this._transaction.set(s._key,l),this}update(r,n,a,...s){const o=M0(r,this._firestore);let l;return l=typeof(n=fi(n))=="string"||n instanceof kg?N6(this._dataReader,"Transaction.update",o._key,n,a,s):w6(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=M0(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=M0(e,this._firestore),n=new Kj(this._firestore);return super.get(e).then(a=>new Gj(this._firestore,n,r._key,a._document,new Np(!1,!1),r.converter))}}function Gs(t,e,r){t=nl(t,Vu);const n=Object.assign(Object.assign({},zye),r);return function(s){if(s.maxAttempts<1)throw new Ur(hr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){const c=new pf;return s.asyncQueue.enqueueAndForget(async()=>{const u=await Oye(s);new Bye(s.asyncQueue,u,l,o,c).au()}),c.promise}(Tg(t),a=>e(new jee(t,a)),n)}function Pee(...t){return new b6("arrayUnion",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t){return Tg(t=nl(t,Vu)),new Iee(t,e=>A1(t,e))}(function(e,r=!0){(function(a){o1=a})(s1),jv(new eg("firestore",(n,{instanceIdentifier:a,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new Vu(new Oxe(n.getProvider("auth-internal")),new Lxe(n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Ur(hr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ym(u.options.projectId,d)}(o,a),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),lm(m7,"4.7.3",e),lm(m7,"4.7.3","esm2017")})();const Wye=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:S6,Bytes:Nm,CollectionReference:aA,DocumentReference:al,DocumentSnapshot:Gj,FieldPath:kg,FieldValue:Tw,Firestore:Vu,FirestoreError:Ur,GeoPoint:Fj,Query:hh,QueryCompositeFilterConstraint:Qj,QueryConstraint:Uj,QueryDocumentSnapshot:xb,QueryFieldFilterConstraint:kw,QueryLimitConstraint:Hj,QueryOrderByConstraint:Vj,QuerySnapshot:I6,SnapshotMetadata:Np,Timestamp:vr,Transaction:jee,VectorValue:Oj,WriteBatch:Iee,_AutoId:VD,_ByteString:Wi,_DatabaseId:ym,_DocumentKey:Xr,_EmptyAuthCredentialsProvider:DJ,_FieldPath:Hs,_cast:nl,_logWarn:xm,_validateIsNotUsedTogether:Aee,addDoc:Jn,arrayUnion:Pee,collection:yt,connectFirestoreEmulator:mee,deleteDoc:Kn,doc:Zt,enableIndexedDbPersistence:xee,ensureFirestoreConfigured:Tg,executeWrite:A1,getDoc:zs,getDocs:Ht,getFirestore:pee,limit:gS,onSnapshot:jd,orderBy:In,query:sr,runTransaction:Gs,setDoc:Eee,updateDoc:Fn,where:mr,writeBatch:tu},Symbol.toStringTag,{value:"Module"})),Xye={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},Bee=SD(Xye),Ie=pee(Bee),Ec=QT(Bee),Yye=(async()=>{try{return await eE(Ec,RD),console.info(" Auth persistence: browserLocalPersistence enabled"),"local"}catch(t){console.warn(" browserLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await eE(Ec,EJ),console.info(" Auth persistence: indexedDBLocalPersistence enabled"),"indexeddb"}catch(t){console.warn(" indexedDBLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await eE(Ec,MD),console.info(" Auth persistence: browserSessionPersistence enabled (session only)"),"session"}catch(t){console.warn(" browserSessionPersistence failed:",(t==null?void 0:t.code)||t)}return console.warn(" No se pudo establecer ninguna persistencia para Auth."),"none"})();xee(Ie).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function Jye(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState(!1),d=pw();g.useEffect(()=>{let h=!0;const m=xj(Ec,async p=>{if(!(!p||!h))try{const x=await zs(Zt(Ie,"users",p.uid));if(!x.exists())return;const v=x.data(),y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"";localStorage.setItem("user_email",p.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin",{replace:!0})}catch{}});return()=>{h=!1,m()}},[d]);const f=h=>{if(Array.isArray(h)){if(h.length!==1)return localStorage.setItem("role",h[0]||""),d("/admin");h=h[0]||""}const m=String(h||"");if(localStorage.setItem("role",m),En(m,"admin"))return d("/admin");if(En(m,"vendedor_pollo"))return d("/admin/salesV2");if(En(m,"vendedor_ropa"))return d("/admin/salesClothes");if(En(m,"vendedor_dulces"))return d("/admin/salesCandies");if(En(m,"supervisor_pollo")||En(m,"contador"))return d("/admin/batches")},A=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{u(!0),console.info&&console.info("[Login] attempting signIn",{email:t}),await eE(Ec,RD);const m=await yge(Ec,t,r);console.info&&console.info("[Login] signInWithEmailAndPassword success",{uid:m.user.uid,email:m.user.email});const p=m.user.uid;localStorage.setItem("POSYS_LOGIN_AT",String(Date.now()));const x=await zs(Zt(Ie,"users",p));if(console.info&&console.info("[Login] firestore users doc snap: exists=",x.exists()),!x.exists()){console.warn&&console.warn("[Login] user doc missing for uid",p),l("Tu usuario no tiene perfil en la base de datos.");return}const v=x.data();console.info&&console.info("[Login] user profile:",v);const y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"",j=["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"];if(!y.some(I=>j.includes(I))){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin")}catch(m){console.error&&console.error("[Login] sign-in error:",m);const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas. ("+p+")":p==="auth/user-not-found"?"Usuario no encontrado. ("+p+")":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde. ("+p+")":((m==null?void 0:m.message)||"Error al iniciar sesin.")+(p?` (${p})`:""))}finally{u(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:A,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:a?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>s(h=>!h),children:a?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function qn({children:t,allowedRoles:e}){const[r,n]=g.useState(!0),[a,s]=g.useState(!1);return g.useEffect(()=>{const o=xj(Ec,async l=>{if(l){const c=Zt(Ie,"users",l.uid),u=await zs(c);if(u.exists()){const d=u.data(),f=Array.isArray(d.roles)?d.roles:d.role?[d.role]:[];try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e):console.debug&&console.debug("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e)}catch{}let A=!1;for(const h of e)if(En(f,h)){A=!0;break}s(A)}else try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] no user doc for uid:",l.uid):console.debug&&console.debug("[PrivateRoute] no user doc for uid:",l.uid)}catch{}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):a?t:i.jsx(Dh,{to:"/"})}const Zye={admin:{},supervisor_pollo:{bills:{view:!0,edit:!1},expenses:{view:!0,edit:!1},customersPollo:{view:!0,edit:!1},transactionsPollo:{view:!0,edit:!1},batches:{view:!0,edit:!1}},contador:{salesV2:{view:!0,edit:!0},customersPollo:{view:!0,edit:!0},batches:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},expenses:{view:!0,edit:!0},financialDashboard:{view:!0,edit:!1},polloCashAudits:{view:!0,edit:!0}},vendedor_pollo:{salesV2:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},customersPollo:{view:!0,edit:!0}},vendedor_dulces:{salesCandies:{view:!0,edit:!0},productsVendorsCandies:{view:!0,edit:!1},productsPricesCandies:{view:!0,edit:!1},transactionCandies:{view:!0,edit:!1},cierreVentasCandies:{view:!0,edit:!1},customersCandies:{view:!0,edit:!0}},vendedor_ropa:{}};function Tee(t){return t?Array.isArray(t)?t.filter(Boolean):[t].filter(Boolean):[]}function aa(t,e,r="view"){const n=Tee(t);return n.some(a=>a==="admin")?!0:n.some(a=>{var s,o;return!!((o=(s=Zye[a])==null?void 0:s[e])!=null&&o[r])})}const ebe={admin:{},supervisor_pollo:{bills:{cerrarVentas:!1},batches:{create:!1,update:!1,delete:!1,export:!1}},contador:{batches:{create:!0,update:!1,delete:!1,export:!0},bills:{cerrarVentas:!1}},vendedor_pollo:{salesV2:{create:!0,update:!0},customersPollo:{update:!0},bills:{cerrarVentas:!0}},vendedor_dulces:{salesCandies:{create:!0,update:!0},productsVendorsCandies:{create:!0,update:!1,delete:!1},customersCandies:{update:!0},productsPricesCandies:{price_edit:!1}},vendedor_ropa:{}};function tbe(t,e,r){const n=Tee(t);return n.some(a=>a==="admin")?!0:aa(t,e,"view")?n.some(a=>{var o;const s=(o=ebe[a])==null?void 0:o[e];return!!(s!=null&&s[r])}):!1}function rbe({role:t,roles:e}){const r="/admin",n=({isActive:ae})=>`block rounded px-3 py-2 text-sm ${ae?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,a=pw(),[s,o]=g.useState(!1),[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(!1),[h,m]=g.useState(!1),[p,x]=g.useState(!1),[v,y]=g.useState(!1),[b,w]=g.useState(!1),[j,I]=g.useState(!1),[_,S]=g.useState(!1),[E,B]=g.useState(!1),[T,P]=g.useState(!1),[O,z]=g.useState(!1),[ce,de]=g.useState(!1),[ue,me]=g.useState(!1),[se,ke]=g.useState(!1),[Re,F]=g.useState(!1),[H,K]=g.useState(!1),L=async()=>{K(!0)},W=async()=>{try{await DD(Ec)}catch(ae){console.error("signOut error:",ae)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}K(!1),a("/")}},Y=({open:ae,onClick:X,children:De})=>i.jsxs("button",{type:"button",onClick:X,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:De}),i.jsx("span",{className:"text-xs",children:ae?"":""})]}),D=({open:ae,onClick:X,title:De})=>i.jsxs("button",{type:"button",onClick:X,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:De}),i.jsx("span",{className:"text-xs",children:ae?"":""})]}),Q=e&&e.length?e:t,ee=En(Q,"admin");En(Q,"vendedor_pollo");const ve=En(Q,"vendedor_ropa");En(Q,"vendedor_dulces"),En(Q,"supervisor_pollo")||En(Q,"contador"),En(Q,"contador");const M=aa(Q,"salesV2","view")||aa(Q,"customersPollo","view")||aa(Q,"transactionsPollo","view")||aa(Q,"bills","view")||aa(Q,"expenses","view")||aa(Q,"batches","view"),Ye=aa(Q,"salesCandies","view")||aa(Q,"productsVendorsCandies","view")||aa(Q,"customersCandies","view")||aa(Q,"productsPricesCandies","view")||aa(Q,"transactionCandies","view")||aa(Q,"cierreVentasCandies","view");return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>o(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[ee&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:l,onClick:()=>c(ae=>!ae),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:p,onClick:()=>x(ae=>!ae),title:"Operaciones"}),p&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(bn,{to:`${r}/salesV2`,className:n,children:"Vender"}),i.jsx(bn,{to:`${r}/customersPollo`,className:n,children:"Saldo Pendientes"}),i.jsx(bn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),i.jsx(bn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"})]}),i.jsx(D,{open:u,onClick:()=>d(ae=>!ae),title:"Inventarios"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(bn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),i.jsx(bn,{to:`${r}/paidBatches`,className:n,children:"Inventarios Pagados"})]}),i.jsx(D,{open:f,onClick:()=>A(ae=>!ae),title:"Finanzas"}),f&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(bn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),i.jsx(bn,{to:`${r}/billing`,className:n,children:"Facturacion"}),i.jsx(bn,{to:`${r}/expenses`,className:n,children:"Gastos"}),i.jsx(bn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),i.jsx(bn,{to:`${r}/salesV2`,className:n,children:"Venta"}),i.jsx(bn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),i.jsx(bn,{to:`${r}/billhistoric`,className:n,children:"Historial de Cierres"})]}),i.jsx(D,{open:h,onClick:()=>m(ae=>!ae),title:"Productos"}),h&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/products`,className:n,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:v,onClick:()=>y(ae=>!ae),children:"Gonper"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:b,onClick:()=>w(ae=>!ae),title:"Inventarios"}),b&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/notebooksInventory`,className:n,children:"Productos y Precios"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:O,onClick:()=>z(ae=>!ae),children:"CandyShop"}),O&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:ue,onClick:()=>me(ae=>!ae),title:"Vendedores"}),ue&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),ue&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/productsVendorsCandies`,className:n,children:"Sub ordenes"})}),ue&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})}),i.jsx(D,{open:ce,onClick:()=>de(ae=>!ae),title:"Inventario"}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/mainordersCandies`,className:n,children:"Ordenes Maestras"})}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/inventoryMainOrderCandies`,className:n,children:"Lista de Ordenes"})}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/inventoryCandies`,className:n,children:"Lista Productos"})}),ce&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/productsCandies`,className:n,children:"Productos"})}),i.jsx(D,{open:se,onClick:()=>ke(ae=>!ae),title:"Finanzas"}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/datacenter`,className:n,children:"Data Center"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/cashDeliveries`,className:n,children:"Entregas Cash"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/transactionCandies`,className:n,children:"Transacciones"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierres"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/reporteCierresCandies`,className:n,children:"Reporte Cierres"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/billingsCandies`,className:n,children:"Facturas"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/consolidatedVendors`,className:n,children:"Consolidado Vendedores"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/dashboardCandies`,className:n,children:"Dashboard"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/vendorsCandies`,className:n,children:"Vendedores"})}),se&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/expensesCandies`,className:n,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:Re,onClick:()=>F(ae=>!ae),children:"Operaciones Otras"}),Re&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(bn,{to:`${r}/users`,className:n,children:"Usuarios"}),i.jsx(bn,{to:`${r}/fix`,className:n,children:"Fix de lotes"}),i.jsx(bn,{to:`${r}/transactionclose`,className:n,children:"Liquidaciones"})]})]})]}),!ee&&M&&i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:l,onClick:()=>c(ae=>!ae),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[aa(Q,"salesV2")&&i.jsx(bn,{to:`${r}/salesV2`,className:n,children:"Vender"}),aa(Q,"financialDashboard")&&i.jsx(bn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),aa(Q,"batches")&&i.jsx(bn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),aa(Q,"bills")&&i.jsx(bn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),aa(Q,"transactionsPollo")&&i.jsx(bn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),aa(Q,"expenses")&&i.jsx(bn,{to:`${r}/expenses`,className:n,children:"Gastos"}),En(Q,"contador")&&i.jsx(bn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),aa(Q,"customersPollo")&&i.jsx(bn,{to:`${r}/customersPollo`,className:n,children:"Saldos Pendientes"})]})]}),!ee&&Ye&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:aa(Q,"salesCandies")&&i.jsx(bn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:aa(Q,"transactionCandies")&&i.jsx(bn,{to:`${r}/transactionCandies`,className:n,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:aa(Q,"cierreVentasCandies")&&i.jsx(bn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:aa(Q,"productsVendorsCandies")&&i.jsx(bn,{to:`${r}/productsVendorsCandies`,className:n,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:aa(Q,"customersCandies")&&i.jsx(bn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:aa(Q,"productsPricesCandies")&&i.jsx(bn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})})]}),ve&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Y,{open:v,onClick:()=>y(ae=>!ae),children:"Operaciones Ropa"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:E,onClick:()=>B(ae=>!ae),title:"Ventas"}),E&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(bn,{to:`${r}/salesClothes`,className:n,children:"Venta Ropa"}),i.jsx(bn,{to:`${r}/TransactionsReportClothes`,className:n,children:"Transacciones"})]}),i.jsx(D,{open:j,onClick:()=>I(ae=>!ae),title:"Productos"}),j&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/productsClothes`,className:n,children:"Agregar Productos"})}),i.jsx(D,{open:_,onClick:()=>S(ae=>!ae),title:"Clientes"}),_&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(bn,{to:`${r}/CustomersClothes`,className:n,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:L,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-700",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))}),H&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>K(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>K(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:W,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(PY,{})})]})}function oy(...t){return t.filter(Boolean).join(" ")}function nbe({role:t,roles:e}){const r=pw(),n=BA(),a="/admin",s=e&&e.length?e:t,o=En(s,"admin"),l=En(s,"vendedor_pollo"),c=En(s,"vendedor_dulces"),u=En(s,"supervisor_pollo")||En(s,"contador"),d=En(s,"contador"),f=aa(s,"salesV2","view")||aa(s,"batches","view")||aa(s,"bills","view")||aa(s,"transactionsPollo","view")||aa(s,"customersPollo","view"),A=aa(s,"salesCandies","view")||aa(s,"productsVendorsCandies","view")||aa(s,"customersCandies","view")||aa(s,"productsPricesCandies","view")||aa(s,"transactionCandies","view")||aa(s,"cierreVentasCandies","view"),h=f&&A,[m,p]=g.useState(()=>{try{const B=typeof window<"u"?localStorage.getItem("rubro"):null;if(B==="POLLO"||B==="DULCES")return B}catch{}return f?"POLLO":A?"DULCES":"POLLO"}),[x,v]=g.useState(!1),[y,b]=g.useState(!1),w=g.useMemo(()=>{let B=[];if(o||h){if(m==="POLLO")if(o)B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"invPag",label:"Factura",to:`${a}/paidBatches`},{key:"gastos",label:"Gastos",to:`${a}/expenses`},{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}];else if(u){const O=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`}];En(s,"contador")&&(B=O)}else l?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:d?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];m==="DULCES"&&(o?B=[{key:"dc",label:"Data Center Reporte",to:`${a}/datacenter`},{key:"maes",label:"Inventario Maestro",to:`${a}/mainordersCandies`},{key:"ord",label:"Inventario Vendedor",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas del dia",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre de ventas",to:`${a}/cierreVentasCandies`},{key:"cash",label:"Entregas Efectivo ",to:`${a}/cashDeliveries`},{key:"items",label:"Productos",to:`${a}/productsCandies`},{key:"precios",label:"Precio Ventas",to:`${a}/productsPricesCandies`},{key:"gonper",label:"Productos Gonper",to:`${a}/notebooksInventory`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}])}else if(u){const O=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre",to:`${a}/bills`}];En(s,"contador")?B=[...O,{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}]:B=O}else l?B=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];const T=new Set(["bills","customersPollo","transactionsPollo","batches","salesV2","financialDashboard","polloCashAudits","salesCandies","productsVendorsCandies","productsPricesCandies","transactionCandies","cierreVentasCandies","customersCandies"]);return B.filter(O=>{const ce=O.to.replace(`${a}/`,"");return T.has(ce)?aa(s,ce,"view"):!0})},[a,m,o,h,u,l,c,d,s]);g.useEffect(()=>{if((o||h)&&w.length){try{localStorage.setItem("rubro",m)}catch{}r(w[0].to,{replace:!0})}},[m]),g.useEffect(()=>{x&&v(!1)},[n.pathname]),g.useEffect(()=>{const B=T=>{T.key==="Escape"&&v(!1)};return x&&window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[x]);const j=async()=>{b(!0)},I=async()=>{try{await DD(Ec)}catch(B){console.error("signOut error:",B)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}b(!1),v(!1),r("/")}},_=({isActive:B})=>oy("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",B?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),S=w.length<=2,E=({isActive:B})=>oy("w-full flex items-center justify-between px-4 py-3 rounded-xl border",B?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[o||h?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>p("POLLO"),className:oy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Carniceria"}),i.jsx("button",{type:"button",onClick:()=>p("DULCES"),className:oy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Mr. Candy"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:l?"Pollos Bea":c?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto flex items-center gap-2",children:i.jsx("button",{type:"button",onClick:()=>v(!0),className:"px-3 py-2 rounded-2xl bg-gray-100 text-gray-800 text-sm font-bold shadow hover:bg-gray-200","aria-label":"Abrir men",title:"Men",children:""})})]})}),x&&i.jsxs("div",{className:"fixed inset-0 z-[80]",children:[i.jsx("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:()=>v(!1),"aria-label":"Cerrar men"}),i.jsxs("aside",{className:"absolute right-0 top-0 h-full w-[86%] max-w-sm bg-white shadow-2xl border-l flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-bold text-gray-900",children:"Men"}),i.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200",children:""})]}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-600",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))})]}),i.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-2",children:w.map(B=>i.jsxs(bn,{to:B.to,className:E,children:[i.jsx("span",{className:"font-semibold",children:B.label}),i.jsx("span",{className:"text-sm opacity-80",children:""})]},B.key))}),i.jsxs("div",{className:"p-3 border-t space-y-2 pb-[calc(12px+env(safe-area-inset-bottom))]",children:[i.jsx("button",{onClick:j,className:"w-full px-4 py-3 rounded-xl bg-red-500 text-white font-semibold shadow hover:bg-red-600",children:"Cerrar sesin"}),y&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>b(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>b(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:I,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]})]}),i.jsx("main",{className:oy("flex-1 overflow-y-auto px-3 pt-3",S?"pb-[calc(92px+env(safe-area-inset-bottom))]":"pb-[calc(16px+env(safe-area-inset-bottom))]"),children:i.jsx(PY,{})}),S&&i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md pb-[env(safe-area-inset-bottom)]",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:w.map(B=>i.jsx(bn,{to:B.to,className:_,children:B.label},B.key))})})]})}const kee=6048e5,abe=864e5,sbe=6e4,ibe=36e5,obe=1e3,C9=Symbol.for("constructDateFrom");function uo(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&C9 in t?t[C9](e):t instanceof Date?new t.constructor(e):new Date(e)}function hi(t,e){return uo(e||t,t)}function j6(t,e,r){const n=hi(t,r==null?void 0:r.in);return isNaN(e)?uo((r==null?void 0:r.in)||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function lbe(t,e,r){const n=hi(t,r==null?void 0:r.in);if(isNaN(e))return uo(t,NaN);const a=n.getDate(),s=uo(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}let cbe={};function m1(){return cbe}function Cm(t,e){var l,c,u,d;const r=m1(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=hi(t,e==null?void 0:e.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Rv(t,e){return Cm(t,{...e,weekStartsOn:1})}function Fee(t,e){const r=hi(t,e==null?void 0:e.in),n=r.getFullYear(),a=uo(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Rv(a),o=uo(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Rv(o);return r.getTime()>=s.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function xS(t){const e=hi(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function ube(t,...e){const r=uo.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function _9(t,e){const r=hi(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function dbe(t,e,r){const[n,a]=ube(r==null?void 0:r.in,t,e),s=_9(n),o=_9(a),l=+s-xS(s),c=+o-xS(o);return Math.round((l-c)/abe)}function fbe(t,e){const r=Fee(t,e),n=uo(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Rv(n)}function hbe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function P6(t){return!(!hbe(t)&&typeof t!="number"||isNaN(+hi(t)))}function Ld(t,e){const r=hi(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Ud(t,e){const r=hi(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function Abe(t,e){const r=hi(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const mbe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pbe=(t,e,r)=>{let n;const a=mbe[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function j4(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const gbe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xbe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vbe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ybe={date:j4({formats:gbe,defaultWidth:"full"}),time:j4({formats:xbe,defaultWidth:"full"}),dateTime:j4({formats:vbe,defaultWidth:"full"})},bbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},wbe=(t,e,r,n)=>bbe[t];function ly(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return a[s]}}const Nbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Cbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},_be={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ebe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Sbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ibe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},jbe=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Pbe={ordinalNumber:jbe,era:ly({values:Nbe,defaultWidth:"wide"}),quarter:ly({values:Cbe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ly({values:_be,defaultWidth:"wide"}),day:ly({values:Ebe,defaultWidth:"wide"}),dayPeriod:ly({values:Sbe,defaultWidth:"wide",formattingValues:Ibe,defaultFormattingWidth:"wide"})};function cy(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(a);if(!s)return null;const o=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Tbe(l,f=>f.test(o)):Bbe(l,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function Bbe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function Tbe(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function kbe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const Fbe=/^(\d+)(th|st|nd|rd)?/i,Obe=/\d+/i,Dbe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Rbe={any:[/^b/i,/^(a|c)/i]},Mbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Lbe={any:[/1/i,/2/i,/3/i,/4/i]},Ube={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Qbe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Vbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Hbe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},$be={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Gbe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Kbe={ordinalNumber:kbe({matchPattern:Fbe,parsePattern:Obe,valueCallback:t=>parseInt(t,10)}),era:cy({matchPatterns:Dbe,defaultMatchWidth:"wide",parsePatterns:Rbe,defaultParseWidth:"any"}),quarter:cy({matchPatterns:Mbe,defaultMatchWidth:"wide",parsePatterns:Lbe,defaultParseWidth:"any",valueCallback:t=>t+1}),month:cy({matchPatterns:Ube,defaultMatchWidth:"wide",parsePatterns:Qbe,defaultParseWidth:"any"}),day:cy({matchPatterns:Vbe,defaultMatchWidth:"wide",parsePatterns:Hbe,defaultParseWidth:"any"}),dayPeriod:cy({matchPatterns:$be,defaultMatchWidth:"any",parsePatterns:Gbe,defaultParseWidth:"any"})},Oee={code:"en-US",formatDistance:pbe,formatLong:ybe,formatRelative:wbe,localize:Pbe,match:Kbe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function qbe(t,e){const r=hi(t,e==null?void 0:e.in);return dbe(r,Abe(r))+1}function Dee(t,e){const r=hi(t,e==null?void 0:e.in),n=+Rv(r)-+fbe(r);return Math.round(n/kee)+1}function B6(t,e){var d,f,A,h;const r=hi(t,e==null?void 0:e.in),n=r.getFullYear(),a=m1(),s=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(A=a.locale)==null?void 0:A.options)==null?void 0:h.firstWeekContainsDate)??1,o=uo((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const l=Cm(o,e),c=uo((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const u=Cm(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function zbe(t,e){var l,c,u,d;const r=m1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=B6(t,e),s=uo((e==null?void 0:e.in)||t,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),Cm(s,e)}function Ree(t,e){const r=hi(t,e==null?void 0:e.in),n=+Cm(r,e)-+zbe(r,e);return Math.round(n/kee)+1}function Ya(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const u0={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Ya(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Ya(r+1,2)},d(t,e){return Ya(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Ya(t.getHours()%12||12,e.length)},H(t,e){return Ya(t.getHours(),e.length)},m(t,e){return Ya(t.getMinutes(),e.length)},s(t,e){return Ya(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ya(a,e.length)}},rx={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},E9={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return u0.y(t,e)},Y:function(t,e,r,n){const a=B6(t,n),s=a>0?a:1-a;if(e==="YY"){const o=s%100;return Ya(o,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ya(s,e.length)},R:function(t,e){const r=Fee(t);return Ya(r,e.length)},u:function(t,e){const r=t.getFullYear();return Ya(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Ya(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Ya(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return u0.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Ya(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=Ree(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):Ya(a,e.length)},I:function(t,e,r){const n=Dee(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Ya(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):u0.d(t,e)},D:function(t,e,r){const n=qbe(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ya(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Ya(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Ya(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return Ya(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=rx.noon:n===0?a=rx.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=rx.evening:n>=12?a=rx.afternoon:n>=4?a=rx.morning:a=rx.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return u0.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):u0.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ya(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ya(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):u0.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):u0.s(t,e)},S:function(t,e){return u0.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return I9(n);case"XXXX":case"XX":return lp(n);case"XXXXX":case"XXX":default:return lp(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return I9(n);case"xxxx":case"xx":return lp(n);case"xxxxx":case"xxx":default:return lp(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+S9(n,":");case"OOOO":default:return"GMT"+lp(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+S9(n,":");case"zzzz":default:return"GMT"+lp(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return Ya(n,e.length)},T:function(t,e,r){return Ya(+t,e.length)}};function S9(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+e+Ya(s,2)}function I9(t,e){return t%60===0?(t>0?"-":"+")+Ya(Math.abs(t)/60,2):lp(t,e)}function lp(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Ya(Math.trunc(n/60),2),s=Ya(n%60,2);return r+a+e+s}const j9=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Mee=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Wbe=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return j9(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",j9(n,e)).replace("{{time}}",Mee(a,e))},lk={p:Mee,P:Wbe},Xbe=/^D+$/,Ybe=/^Y+$/,Jbe=["D","DD","YY","YYYY"];function Lee(t){return Xbe.test(t)}function Uee(t){return Ybe.test(t)}function ck(t,e,r){const n=Zbe(t,e,r);if(console.warn(n),Jbe.includes(t))throw new RangeError(n)}function Zbe(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const e2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,t2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,r2e=/^'([^]*?)'?$/,n2e=/''/g,a2e=/[a-zA-Z]/;function Mr(t,e,r){var d,f,A,h;const n=m1(),a=n.locale??Oee,s=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(A=n.locale)==null?void 0:A.options)==null?void 0:h.weekStartsOn)??0,l=hi(t,r==null?void 0:r.in);if(!P6(l))throw new RangeError("Invalid time value");let c=e.match(t2e).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=lk[p];return x(m,a.formatLong)}return m}).join("").match(e2e).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:s2e(m)};if(E9[p])return{isToken:!0,value:m};if(p.match(a2e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const u={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(Uee(p)||Lee(p))&&ck(p,e,String(t));const x=E9[p[0]];return x(l,p,a.localize,u)}).join("")}function s2e(t){const e=t.match(r2e);return e?e[1].replace(n2e,"'"):t}function i2e(){return Object.assign({},m1())}function o2e(t,e){const r=hi(t,e==null?void 0:e.in).getDay();return r===0?7:r}function l2e(t,e){const r=c2e(e)?new e(0):uo(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function c2e(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const u2e=10;class Qee{constructor(){Br(this,"subPriority",0)}validate(e,r){return!0}}class d2e extends Qee{constructor(e,r,n,a,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class f2e extends Qee{constructor(r,n){super();Br(this,"priority",u2e);Br(this,"subPriority",-1);this.context=r||(a=>uo(n,a))}set(r,n){return n.timestampIsSet?r:uo(r,l2e(r,this.context))}}let Ra=class{run(e,r,n,a){const s=this.parse(e,r,n,a);return s?{setter:new d2e(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}};class h2e extends Ra{constructor(){super(...arguments);Br(this,"priority",140);Br(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,n,a){return n.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}const Ki={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},qf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function qi(t,e){return t&&{value:e(t.value),rest:t.rest}}function oi(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function zf(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,a=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(a*ibe+s*sbe+o*obe),rest:e.slice(r[0].length)}}function Vee(t){return oi(Ki.anyDigitsSigned,t)}function Ii(t,e){switch(t){case 1:return oi(Ki.singleDigit,e);case 2:return oi(Ki.twoDigits,e);case 3:return oi(Ki.threeDigits,e);case 4:return oi(Ki.fourDigits,e);default:return oi(new RegExp("^\\d{1,"+t+"}"),e)}}function vS(t,e){switch(t){case 1:return oi(Ki.singleDigitSigned,e);case 2:return oi(Ki.twoDigitsSigned,e);case 3:return oi(Ki.threeDigitsSigned,e);case 4:return oi(Ki.fourDigitsSigned,e);default:return oi(new RegExp("^-?\\d{1,"+t+"}"),e)}}function T6(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Hee(t,e){const r=e>0,n=r?e:1-e;let a;if(n<=50)a=t||100;else{const s=n+50,o=Math.trunc(s/100)*100,l=t>=s%100;a=t+o-(l?100:0)}return r?a:1-a}function $ee(t){return t%400===0||t%4===0&&t%100!==0}class A2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return qi(Ii(4,r),s);case"yo":return qi(a.ordinalNumber(r,{unit:"year"}),s);default:return qi(Ii(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a){const s=r.getFullYear();if(a.isTwoDigitYear){const l=Hee(a.year,s);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class m2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return qi(Ii(4,r),s);case"Yo":return qi(a.ordinalNumber(r,{unit:"year"}),s);default:return qi(Ii(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a,s){const o=B6(r,s);if(a.isTwoDigitYear){const c=Hee(a.year,o);return r.setFullYear(c,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Cm(r,s)}const l=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Cm(r,s)}}class p2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return vS(n==="R"?4:n.length,r)}set(r,n,a){const s=uo(r,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Rv(s)}}class g2e extends Ra{constructor(){super(...arguments);Br(this,"priority",130);Br(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return vS(n==="u"?4:n.length,r)}set(r,n,a){return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class x2e extends Ra{constructor(){super(...arguments);Br(this,"priority",120);Br(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"Q":case"QQ":return Ii(n.length,r);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})||a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class v2e extends Ra{constructor(){super(...arguments);Br(this,"priority",120);Br(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"q":case"qq":return Ii(n.length,r);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})||a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class y2e extends Ra{constructor(){super(...arguments);Br(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Br(this,"priority",110)}parse(r,n,a){const s=o=>o-1;switch(n){case"M":return qi(oi(Ki.month,r),s);case"MM":return qi(Ii(2,r),s);case"Mo":return qi(a.ordinalNumber(r,{unit:"month"}),s);case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})||a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}class b2e extends Ra{constructor(){super(...arguments);Br(this,"priority",110);Br(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,a){const s=o=>o-1;switch(n){case"L":return qi(oi(Ki.month,r),s);case"LL":return qi(Ii(2,r),s);case"Lo":return qi(a.ordinalNumber(r,{unit:"month"}),s);case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})||a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}function w2e(t,e,r){const n=hi(t,r==null?void 0:r.in),a=Ree(n,r)-e;return n.setDate(n.getDate()-a*7),hi(n,r==null?void 0:r.in)}class N2e extends Ra{constructor(){super(...arguments);Br(this,"priority",100);Br(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,a){switch(n){case"w":return oi(Ki.week,r);case"wo":return a.ordinalNumber(r,{unit:"week"});default:return Ii(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a,s){return Cm(w2e(r,a,s),s)}}function C2e(t,e,r){const n=hi(t,r==null?void 0:r.in),a=Dee(n,r)-e;return n.setDate(n.getDate()-a*7),n}class _2e extends Ra{constructor(){super(...arguments);Br(this,"priority",100);Br(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,a){switch(n){case"I":return oi(Ki.week,r);case"Io":return a.ordinalNumber(r,{unit:"week"});default:return Ii(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a){return Rv(C2e(r,a))}}const E2e=[31,28,31,30,31,30,31,31,30,31,30,31],S2e=[31,29,31,30,31,30,31,31,30,31,30,31];class I2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"subPriority",1);Br(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"d":return oi(Ki.date,r);case"do":return a.ordinalNumber(r,{unit:"date"});default:return Ii(n.length,r)}}validate(r,n){const a=r.getFullYear(),s=$ee(a),o=r.getMonth();return s?n>=1&&n<=S2e[o]:n>=1&&n<=E2e[o]}set(r,n,a){return r.setDate(a),r.setHours(0,0,0,0),r}}class j2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"subpriority",1);Br(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,a){switch(n){case"D":case"DD":return oi(Ki.dayOfYear,r);case"Do":return a.ordinalNumber(r,{unit:"date"});default:return Ii(n.length,r)}}validate(r,n){const a=r.getFullYear();return $ee(a)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,a){return r.setMonth(0,a),r.setHours(0,0,0,0),r}}function k6(t,e,r){var f,A,h,m;const n=m1(),a=(r==null?void 0:r.weekStartsOn)??((A=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:A.weekStartsOn)??n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,s=hi(t,r==null?void 0:r.in),o=s.getDay(),c=(e%7+7)%7,u=7-a,d=e<0||e>6?e-(o+u)%7:(c+u)%7-(o+u)%7;return j6(s,d,r)}class P2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=k6(r,a,s),r.setHours(0,0,0,0),r}}class B2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return qi(Ii(n.length,r),o);case"eo":return qi(a.ordinalNumber(r,{unit:"day"}),o);case"eee":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=k6(r,a,s),r.setHours(0,0,0,0),r}}class T2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return qi(Ii(n.length,r),o);case"co":return qi(a.ordinalNumber(r,{unit:"day"}),o);case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})||a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=k6(r,a,s),r.setHours(0,0,0,0),r}}function k2e(t,e,r){const n=hi(t,r==null?void 0:r.in),a=o2e(n,r),s=e-a;return j6(n,s,r)}class F2e extends Ra{constructor(){super(...arguments);Br(this,"priority",90);Br(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return Ii(n.length,r);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return qi(a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return qi(a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return qi(a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return qi(a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,a){return r=k2e(r,a),r.setHours(0,0,0,0),r}}class O2e extends Ra{constructor(){super(...arguments);Br(this,"priority",80);Br(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(T6(a),0,0,0),r}}class D2e extends Ra{constructor(){super(...arguments);Br(this,"priority",80);Br(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(T6(a),0,0,0),r}}class R2e extends Ra{constructor(){super(...arguments);Br(this,"priority",80);Br(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(T6(a),0,0,0),r}}class M2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,a){switch(n){case"h":return oi(Ki.hour12h,r);case"ho":return a.ordinalNumber(r,{unit:"hour"});default:return Ii(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,a){const s=r.getHours()>=12;return s&&a<12?r.setHours(a+12,0,0,0):!s&&a===12?r.setHours(0,0,0,0):r.setHours(a,0,0,0),r}}class L2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,a){switch(n){case"H":return oi(Ki.hour23h,r);case"Ho":return a.ordinalNumber(r,{unit:"hour"});default:return Ii(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,a){return r.setHours(a,0,0,0),r}}class U2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,a){switch(n){case"K":return oi(Ki.hour11h,r);case"Ko":return a.ordinalNumber(r,{unit:"hour"});default:return Ii(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.getHours()>=12&&a<12?r.setHours(a+12,0,0,0):r.setHours(a,0,0,0),r}}class Q2e extends Ra{constructor(){super(...arguments);Br(this,"priority",70);Br(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,a){switch(n){case"k":return oi(Ki.hour24h,r);case"ko":return a.ordinalNumber(r,{unit:"hour"});default:return Ii(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,a){const s=a<=24?a%24:a;return r.setHours(s,0,0,0),r}}class V2e extends Ra{constructor(){super(...arguments);Br(this,"priority",60);Br(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"m":return oi(Ki.minute,r);case"mo":return a.ordinalNumber(r,{unit:"minute"});default:return Ii(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setMinutes(a,0,0),r}}class H2e extends Ra{constructor(){super(...arguments);Br(this,"priority",50);Br(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"s":return oi(Ki.second,r);case"so":return a.ordinalNumber(r,{unit:"second"});default:return Ii(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setSeconds(a,0),r}}class $2e extends Ra{constructor(){super(...arguments);Br(this,"priority",30);Br(this,"incompatibleTokens",["t","T"])}parse(r,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return qi(Ii(n.length,r),a)}set(r,n,a){return r.setMilliseconds(a),r}}class G2e extends Ra{constructor(){super(...arguments);Br(this,"priority",10);Br(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return zf(qf.basicOptionalMinutes,r);case"XX":return zf(qf.basic,r);case"XXXX":return zf(qf.basicOptionalSeconds,r);case"XXXXX":return zf(qf.extendedOptionalSeconds,r);case"XXX":default:return zf(qf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:uo(r,r.getTime()-xS(r)-a)}}class K2e extends Ra{constructor(){super(...arguments);Br(this,"priority",10);Br(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return zf(qf.basicOptionalMinutes,r);case"xx":return zf(qf.basic,r);case"xxxx":return zf(qf.basicOptionalSeconds,r);case"xxxxx":return zf(qf.extendedOptionalSeconds,r);case"xxx":default:return zf(qf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:uo(r,r.getTime()-xS(r)-a)}}class q2e extends Ra{constructor(){super(...arguments);Br(this,"priority",40);Br(this,"incompatibleTokens","*")}parse(r){return Vee(r)}set(r,n,a){return[uo(r,a*1e3),{timestampIsSet:!0}]}}class z2e extends Ra{constructor(){super(...arguments);Br(this,"priority",20);Br(this,"incompatibleTokens","*")}parse(r){return Vee(r)}set(r,n,a){return[uo(r,a),{timestampIsSet:!0}]}}const W2e={G:new h2e,y:new A2e,Y:new m2e,R:new p2e,u:new g2e,Q:new x2e,q:new v2e,M:new y2e,L:new b2e,w:new N2e,I:new _2e,d:new I2e,D:new j2e,E:new P2e,e:new B2e,c:new T2e,i:new F2e,a:new O2e,b:new D2e,B:new R2e,h:new M2e,H:new L2e,K:new U2e,k:new Q2e,m:new V2e,s:new H2e,S:new $2e,X:new G2e,x:new K2e,t:new q2e,T:new z2e},X2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Y2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,J2e=/^'([^]*?)'?$/,Z2e=/''/g,ewe=/\S/,twe=/[a-zA-Z]/;function yS(t,e,r,n){var x,v,y,b;const a=()=>uo(r,NaN),s=i2e(),o=s.locale??Oee,l=s.firstWeekContainsDate??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.firstWeekContainsDate)??1,c=s.weekStartsOn??((b=(y=s.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??0;if(!e)return t?a():hi(r,n==null?void 0:n.in);const u={firstWeekContainsDate:l,weekStartsOn:c,locale:o},d=[new f2e(n==null?void 0:n.in,r)],f=e.match(Y2e).map(w=>{const j=w[0];if(j in lk){const I=lk[j];return I(w,o.formatLong)}return w}).join("").match(X2e),A=[];for(let w of f){Uee(w)&&ck(w,e,t),Lee(w)&&ck(w,e,t);const j=w[0],I=W2e[j];if(I){const{incompatibleTokens:_}=I;if(Array.isArray(_)){const E=A.find(B=>_.includes(B.token)||B.token===j);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${w}\` at the same time`)}else if(I.incompatibleTokens==="*"&&A.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);A.push({token:j,fullToken:w});const S=I.run(t,w,o.match,u);if(!S)return a();d.push(S.setter),t=S.rest}else{if(j.match(twe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(w==="''"?w="'":j==="'"&&(w=rwe(w)),t.indexOf(w)===0)t=t.slice(w.length);else return a()}}if(t.length>0&&ewe.test(t))return a();const h=d.map(w=>w.priority).sort((w,j)=>j-w).filter((w,j,I)=>I.indexOf(w)===j).map(w=>d.filter(j=>j.priority===w).sort((j,I)=>I.subPriority-j.subPriority)).map(w=>w[0]);let m=hi(r,n==null?void 0:n.in);if(isNaN(+m))return a();const p={};for(const w of h){if(!w.validate(m,u))return a();const j=w.set(m,p,u);Array.isArray(j)?(m=j[0],Object.assign(p,j[1])):m=j}return m}function rwe(t){return t.match(J2e)[1].replace(Z2e,"'")}function Gee(t,e,r){return j6(t,-14,r)}function nwe(t,e,r){return lbe(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uk=function(t,e){return uk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},uk(t,e)};function Sf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");uk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var dk=function(){return dk=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},dk.apply(this,arguments)};function vc(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,[])).next())})}function Xl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function iC(t,e,r){if(arguments.length===2)for(var n=0,a=e.length,s;n<a;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||e)}var vA=function(){function t(e,r,n,a){this.left=e,this.top=r,this.width=n,this.height=a}return t.prototype.add=function(e,r,n,a){return new t(this.left+e,this.top+r,this.width+n,this.height+a)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),qj=function(t,e){return vA.fromClientRect(t,e.getBoundingClientRect())},awe=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),a=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new vA(0,0,n,a)},zj=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},Li=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},P9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",swe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var oC=0;oC<P9.length;oC++)swe[P9.charCodeAt(oC)]=oC;var B9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lC=0;lC<B9.length;lC++)Qy[B9.charCodeAt(lC)]=lC;var iwe=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Qy[t.charCodeAt(n)],o=Qy[t.charCodeAt(n+1)],l=Qy[t.charCodeAt(n+2)],c=Qy[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},owe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},lwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Fp=5,F6=11,P4=2,cwe=F6-Fp,Kee=65536>>Fp,uwe=1<<Fp,B4=uwe-1,dwe=1024>>Fp,fwe=Kee+dwe,hwe=fwe,Awe=32,mwe=hwe+Awe,pwe=65536>>F6,gwe=1<<cwe,xwe=gwe-1,T9=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},vwe=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},ywe=function(t,e){var r=iwe(t),n=Array.isArray(r)?lwe(r):new Uint32Array(r),a=Array.isArray(r)?owe(r):new Uint16Array(r),s=24,o=T9(a,s/2,n[4]/2),l=n[5]===2?T9(a,(s+n[4])/2):vwe(n,Math.ceil((s+n[4])/4));return new bwe(n[0],n[1],n[2],n[3],o,l)},bwe=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Fp],r=(r<<P4)+(e&B4),this.data[r];if(e<=65535)return r=this.index[Kee+(e-55296>>Fp)],r=(r<<P4)+(e&B4),this.data[r];if(e<this.highStart)return r=mwe-pwe+(e>>F6),r=this.index[r],r+=e>>Fp&xwe,r=this.index[r],r=(r<<P4)+(e&B4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),k9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wwe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cC=0;cC<k9.length;cC++)wwe[k9.charCodeAt(cC)]=cC;var Nwe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",F9=50,Cwe=1,qee=2,zee=3,_we=4,Ewe=5,O9=7,Wee=8,D9=9,G0=10,fk=11,R9=12,hk=13,Swe=14,Vy=15,Ak=16,uC=17,uy=18,Iwe=19,M9=20,mk=21,dy=22,T4=23,nx=24,_u=25,Hy=26,$y=27,ax=28,jwe=29,xp=30,Pwe=31,dC=32,fC=33,pk=34,gk=35,xk=36,N2=37,vk=38,dE=39,fE=40,k4=41,Xee=42,Bwe=43,Twe=[9001,65288],Yee="!",fa="",hC="",yk=ywe(Nwe),_h=[xp,xk],bk=[Cwe,qee,zee,Ewe],Jee=[G0,Wee],L9=[$y,Hy],kwe=bk.concat(Jee),U9=[vk,dE,fE,pk,gk],Fwe=[Vy,hk],Owe=function(t,e){e===void 0&&(e="strict");var r=[],n=[],a=[];return t.forEach(function(s,o){var l=yk.get(s);if(l>F9?(a.push(!0),l-=F9):a.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(o),r.push(Ak);if(l===_we||l===fk){if(o===0)return n.push(o),r.push(xp);var c=r[o-1];return kwe.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(xp))}if(n.push(o),l===Pwe)return r.push(e==="strict"?mk:N2);if(l===Xee||l===jwe)return r.push(xp);if(l===Bwe)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(N2):r.push(xp);r.push(l)}),[n,r,a]},F4=function(t,e,r,n){var a=n[r];if(Array.isArray(t)?t.indexOf(a)!==-1:t===a)for(var s=r;s<=n.length;){s++;var o=n[s];if(o===e)return!0;if(o!==G0)break}if(a===G0)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==G0)break}if(l!==G0)break}return!1},Q9=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===G0)r--;else return n}return 0},Dwe=function(t,e,r,n,a){if(r[n]===0)return fa;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return fa;var o=s-1,l=s+1,c=e[s],u=o>=0?e[o]:0,d=e[l];if(c===qee&&d===zee)return fa;if(bk.indexOf(c)!==-1)return Yee;if(bk.indexOf(d)!==-1||Jee.indexOf(d)!==-1)return fa;if(Q9(s,e)===Wee)return hC;if(yk.get(t[s])===fk||(c===dC||c===fC)&&yk.get(t[l])===fk||c===O9||d===O9||c===D9||[G0,hk,Vy].indexOf(c)===-1&&d===D9||[uC,uy,Iwe,nx,ax].indexOf(d)!==-1||Q9(s,e)===dy||F4(T4,dy,s,e)||F4([uC,uy],mk,s,e)||F4(R9,R9,s,e))return fa;if(c===G0)return hC;if(c===T4||d===T4)return fa;if(d===Ak||c===Ak)return hC;if([hk,Vy,mk].indexOf(d)!==-1||c===Swe||u===xk&&Fwe.indexOf(c)!==-1||c===ax&&d===xk||d===M9||_h.indexOf(d)!==-1&&c===_u||_h.indexOf(c)!==-1&&d===_u||c===$y&&[N2,dC,fC].indexOf(d)!==-1||[N2,dC,fC].indexOf(c)!==-1&&d===Hy||_h.indexOf(c)!==-1&&L9.indexOf(d)!==-1||L9.indexOf(c)!==-1&&_h.indexOf(d)!==-1||[$y,Hy].indexOf(c)!==-1&&(d===_u||[dy,Vy].indexOf(d)!==-1&&e[l+1]===_u)||[dy,Vy].indexOf(c)!==-1&&d===_u||c===_u&&[_u,ax,nx].indexOf(d)!==-1)return fa;if([_u,ax,nx,uC,uy].indexOf(d)!==-1)for(var f=s;f>=0;){var A=e[f];if(A===_u)return fa;if([ax,nx].indexOf(A)!==-1)f--;else break}if([$y,Hy].indexOf(d)!==-1)for(var f=[uC,uy].indexOf(c)!==-1?o:s;f>=0;){var A=e[f];if(A===_u)return fa;if([ax,nx].indexOf(A)!==-1)f--;else break}if(vk===c&&[vk,dE,pk,gk].indexOf(d)!==-1||[dE,pk].indexOf(c)!==-1&&[dE,fE].indexOf(d)!==-1||[fE,gk].indexOf(c)!==-1&&d===fE||U9.indexOf(c)!==-1&&[M9,Hy].indexOf(d)!==-1||U9.indexOf(d)!==-1&&c===$y||_h.indexOf(c)!==-1&&_h.indexOf(d)!==-1||c===nx&&_h.indexOf(d)!==-1||_h.concat(_u).indexOf(c)!==-1&&d===dy&&Twe.indexOf(t[l])===-1||_h.concat(_u).indexOf(d)!==-1&&c===uy)return fa;if(c===k4&&d===k4){for(var h=r[s],m=1;h>0&&(h--,e[h]===k4);)m++;if(m%2!==0)return fa}return c===dC&&d===fC?fa:hC},Rwe=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=Owe(t,e.lineBreak),n=r[0],a=r[1],s=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(a=a.map(function(l){return[_u,xp,Xee].indexOf(l)!==-1?N2:l}));var o=e.wordBreak==="keep-all"?s.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,a,o]},Mwe=function(){function t(e,r,n,a){this.codePoints=e,this.required=r===Yee,this.start=n,this.end=a}return t.prototype.slice=function(){return Li.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),Lwe=function(t,e){var r=zj(t),n=Rwe(r,e),a=n[0],s=n[1],o=n[2],l=r.length,c=0,u=0;return{next:function(){if(u>=l)return{done:!0,value:null};for(var d=fa;u<l&&(d=Dwe(r,s,a,++u,o))===fa;);if(d!==fa||u===l){var f=new Mwe(r,d,c,u);return c=u,{value:f,done:!1}}return{done:!0,value:null}}}},Uwe=1,Qwe=2,Fw=4,V9=8,bS=10,H9=47,vb=92,Vwe=9,Hwe=32,AC=34,fy=61,$we=35,Gwe=36,Kwe=37,mC=39,pC=40,hy=41,qwe=95,Xc=45,zwe=33,Wwe=60,Xwe=62,Ywe=64,Jwe=91,Zwe=93,eNe=61,tNe=123,gC=63,rNe=125,$9=124,nNe=126,aNe=128,G9=65533,O4=42,Cp=43,sNe=44,iNe=58,oNe=59,C2=46,lNe=0,cNe=8,uNe=11,dNe=14,fNe=31,hNe=127,Df=-1,Zee=48,ete=97,tte=101,ANe=102,mNe=117,pNe=122,rte=65,nte=69,ate=70,gNe=85,xNe=90,Zl=function(t){return t>=Zee&&t<=57},vNe=function(t){return t>=55296&&t<=57343},sx=function(t){return Zl(t)||t>=rte&&t<=ate||t>=ete&&t<=ANe},yNe=function(t){return t>=ete&&t<=pNe},bNe=function(t){return t>=rte&&t<=xNe},wNe=function(t){return yNe(t)||bNe(t)},NNe=function(t){return t>=aNe},xC=function(t){return t===bS||t===Vwe||t===Hwe},wS=function(t){return wNe(t)||NNe(t)||t===qwe},K9=function(t){return wS(t)||Zl(t)||t===Xc},CNe=function(t){return t>=lNe&&t<=cNe||t===uNe||t>=dNe&&t<=fNe||t===hNe},S0=function(t,e){return t!==vb?!1:e!==bS},vC=function(t,e,r){return t===Xc?wS(e)||S0(e,r):wS(t)?!0:!!(t===vb&&S0(t,e))},D4=function(t,e,r){return t===Cp||t===Xc?Zl(e)?!0:e===C2&&Zl(r):Zl(t===C2?e:t)},_Ne=function(t){var e=0,r=1;(t[e]===Cp||t[e]===Xc)&&(t[e]===Xc&&(r=-1),e++);for(var n=[];Zl(t[e]);)n.push(t[e++]);var a=n.length?parseInt(Li.apply(void 0,n),10):0;t[e]===C2&&e++;for(var s=[];Zl(t[e]);)s.push(t[e++]);var o=s.length,l=o?parseInt(Li.apply(void 0,s),10):0;(t[e]===nte||t[e]===tte)&&e++;var c=1;(t[e]===Cp||t[e]===Xc)&&(t[e]===Xc&&(c=-1),e++);for(var u=[];Zl(t[e]);)u.push(t[e++]);var d=u.length?parseInt(Li.apply(void 0,u),10):0;return r*(a+l*Math.pow(10,-o))*Math.pow(10,c*d)},ENe={type:2},SNe={type:3},INe={type:4},jNe={type:13},PNe={type:8},BNe={type:21},TNe={type:9},kNe={type:10},FNe={type:11},ONe={type:12},DNe={type:14},yC={type:23},RNe={type:1},MNe={type:25},LNe={type:24},UNe={type:26},QNe={type:27},VNe={type:28},HNe={type:29},$Ne={type:31},wk={type:32},ste=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(zj(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==wk;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case AC:return this.consumeStringToken(AC);case $we:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(K9(r)||S0(n,a)){var s=vC(r,n,a)?Qwe:Uwe,o=this.consumeName();return{type:5,value:o,flags:s}}break;case Gwe:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),jNe;break;case mC:return this.consumeStringToken(mC);case pC:return ENe;case hy:return SNe;case O4:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),DNe;break;case Cp:if(D4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case sNe:return INe;case Xc:var l=e,c=this.peekCodePoint(0),u=this.peekCodePoint(1);if(D4(l,c,u))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(vC(l,c,u))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===Xc&&u===Xwe)return this.consumeCodePoint(),this.consumeCodePoint(),LNe;break;case C2:if(D4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case H9:if(this.peekCodePoint(0)===O4)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===O4&&(d=this.consumeCodePoint(),d===H9))return this.consumeToken();if(d===Df)return this.consumeToken()}break;case iNe:return UNe;case oNe:return QNe;case Wwe:if(this.peekCodePoint(0)===zwe&&this.peekCodePoint(1)===Xc&&this.peekCodePoint(2)===Xc)return this.consumeCodePoint(),this.consumeCodePoint(),MNe;break;case Ywe:var f=this.peekCodePoint(0),A=this.peekCodePoint(1),h=this.peekCodePoint(2);if(vC(f,A,h)){var o=this.consumeName();return{type:7,value:o}}break;case Jwe:return VNe;case vb:if(S0(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case Zwe:return HNe;case eNe:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),PNe;break;case tNe:return FNe;case rNe:return ONe;case mNe:case gNe:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===Cp&&(sx(p)||p===gC)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case $9:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),TNe;if(this.peekCodePoint(0)===$9)return this.consumeCodePoint(),BNe;break;case nNe:if(this.peekCodePoint(0)===fy)return this.consumeCodePoint(),kNe;break;case Df:return wk}return xC(e)?(this.consumeWhiteSpace(),$Ne):Zl(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):wS(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Li(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();sx(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===gC&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(Li.apply(void 0,e.map(function(c){return c===gC?Zee:c})),16),s=parseInt(Li.apply(void 0,e.map(function(c){return c===gC?ate:c})),16);return{type:30,start:a,end:s}}var o=parseInt(Li.apply(void 0,e),16);if(this.peekCodePoint(0)===Xc&&sx(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];sx(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt(Li.apply(void 0,l),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===pC?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===pC?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Df)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===mC||r===AC){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Df||this.peekCodePoint(0)===hy)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),yC)}for(;;){var a=this.consumeCodePoint();if(a===Df||a===hy)return{type:22,value:Li.apply(void 0,e)};if(xC(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Df||this.peekCodePoint(0)===hy?(this.consumeCodePoint(),{type:22,value:Li.apply(void 0,e)}):(this.consumeBadUrlRemnants(),yC);if(a===AC||a===mC||a===pC||CNe(a))return this.consumeBadUrlRemnants(),yC;if(a===vb)if(S0(a,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),yC;else e.push(a)}},t.prototype.consumeWhiteSpace=function(){for(;xC(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===hy||e===Df)return;S0(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var a=Math.min(r,e);n+=Li.apply(void 0,this._value.splice(0,a)),e-=a}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var a=this._value[n];if(a===Df||a===void 0||a===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===bS)return this._value.splice(0,n),RNe;if(a===vb){var s=this._value[n+1];s!==Df&&s!==void 0&&(s===bS?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):S0(a,s)&&(r+=this.consumeStringSlice(n),r+=Li(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Fw,n=this.peekCodePoint(0);for((n===Cp||n===Xc)&&e.push(this.consumeCodePoint());Zl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===C2&&Zl(a))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=V9;Zl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===nte||n===tte)&&((a===Cp||a===Xc)&&Zl(s)||Zl(a)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=V9;Zl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[_Ne(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(vC(a,s,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===Kwe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(sx(e)){for(var r=Li(e);sx(this.peekCodePoint(0))&&r.length<6;)r+=Li(this.consumeCodePoint());xC(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||vNe(n)||n>1114111?G9:n}return e===Df?G9:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(K9(r))e+=Li(r);else if(S0(r,this.peekCodePoint(0)))e+=Li(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),ite=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new ste;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||KNe(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?wk:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Ow=function(t){return t.type===15},p1=function(t){return t.type===17},ls=function(t){return t.type===20},GNe=function(t){return t.type===0},Nk=function(t,e){return ls(t)&&t.value===e},ote=function(t){return t.type!==31},Mv=function(t){return t.type!==31&&t.type!==4},Ah=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},KNe=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},_m=function(t){return t.type===17||t.type===15},so=function(t){return t.type===16||_m(t)},lte=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Il={type:17,number:0,flags:Fw},O6={type:16,number:50,flags:Fw},K0={type:16,number:100,flags:Fw},Gy=function(t,e,r){var n=t[0],a=t[1];return[ys(n,e),ys(typeof a<"u"?a:n,r)]},ys=function(t,e){if(t.type===16)return t.number/100*e;if(Ow(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},cte="deg",ute="grad",dte="rad",fte="turn",Wj={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case cte:return Math.PI*e.number/180;case ute:return Math.PI/200*e.number;case dte:return e.number;case fte:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},hte=function(t){return t.type===15&&(t.unit===cte||t.unit===ute||t.unit===dte||t.unit===fte)},Ate=function(t){var e=t.filter(ls).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Il,Il];case"to top":case"bottom":return Nd(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Il,K0];case"to right":case"left":return Nd(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[K0,K0];case"to bottom":case"top":return Nd(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[K0,Il];case"to left":case"right":return Nd(270)}return 0},Nd=function(t){return Math.PI*t/180},um={name:"color",parse:function(t,e){if(e.type===18){var r=qNe[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3);return q0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return q0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6);return q0(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return q0(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var l=sA[e.value.toUpperCase()];if(typeof l<"u")return l}return sA.TRANSPARENT}},dm=function(t){return(255&t)===0},Ho=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,a=255&t>>24;return e<255?"rgba("+a+","+n+","+r+","+e/255+")":"rgb("+a+","+n+","+r+")"},q0=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},q9=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},z9=function(t,e){var r=e.filter(Mv);if(r.length===3){var n=r.map(q9),a=n[0],s=n[1],o=n[2];return q0(a,s,o,1)}if(r.length===4){var l=r.map(q9),a=l[0],s=l[1],o=l[2],c=l[3];return q0(a,s,o,c)}return 0};function R4(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var W9=function(t,e){var r=e.filter(Mv),n=r[0],a=r[1],s=r[2],o=r[3],l=(n.type===17?Nd(n.number):Wj.parse(t,n))/(Math.PI*2),c=so(a)?a.number/100:0,u=so(s)?s.number/100:0,d=typeof o<"u"&&so(o)?ys(o,1):1;if(c===0)return q0(u*255,u*255,u*255,1);var f=u<=.5?u*(c+1):u+c-u*c,A=u*2-f,h=R4(A,f,l+1/3),m=R4(A,f,l),p=R4(A,f,l-1/3);return q0(h*255,m*255,p*255,d)},qNe={hsl:W9,hsla:W9,rgb:z9,rgba:z9},yb=function(t,e){return um.parse(t,ite.create(e).parseComponentValue())},sA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},zNe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(ls(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},WNe={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Xj=function(t,e){var r=um.parse(t,e[0]),n=e[1];return n&&so(n)?{color:r,stop:n}:{color:r,stop:null}},X9=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=Il),n.stop===null&&(n.stop=K0);for(var a=[],s=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=ys(l,e);c>s?a.push(c):a.push(s),s=c}else a.push(null)}for(var u=null,o=0;o<a.length;o++){var d=a[o];if(d===null)u===null&&(u=o);else if(u!==null){for(var f=o-u,A=a[u-1],h=(d-A)/(f+1),m=1;m<=f;m++)a[u+m-1]=h*m;u=null}}return t.map(function(p,x){var v=p.color;return{color:v,stop:Math.max(Math.min(1,a[x]/e),0)}})},XNe=function(t,e,r){var n=e/2,a=r/2,s=ys(t[0],e)-n,o=a-ys(t[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},YNe=function(t,e,r){var n=typeof t=="number"?t:XNe(t,e,r),a=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),s=e/2,o=r/2,l=a/2,c=Math.sin(n-Math.PI/2)*l,u=Math.cos(n-Math.PI/2)*l;return[a,s-u,s+u,o-c,o+c]},tf=function(t,e){return Math.sqrt(t*t+e*e)},Y9=function(t,e,r,n,a){var s=[[0,0],[0,e],[t,0],[t,e]];return s.reduce(function(o,l){var c=l[0],u=l[1],d=tf(r-c,n-u);return(a?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},JNe=function(t,e,r,n,a){var s=0,o=0;switch(t.size){case 0:t.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(t.shape===0)s=o=Math.min(tf(e,r),tf(e,r-a),tf(e-n,r),tf(e-n,r-a));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(e),Math.abs(e-n)),c=Y9(n,a,e,r,!0),u=c[0],d=c[1];s=tf(u-e,(d-r)/l),o=l*s}break;case 1:t.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(t.shape===0)s=o=Math.max(tf(e,r),tf(e,r-a),tf(e-n,r),tf(e-n,r-a));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(e),Math.abs(e-n)),f=Y9(n,a,e,r,!1),u=f[0],d=f[1];s=tf(u-e,(d-r)/l),o=l*s}break}return Array.isArray(t.size)&&(s=ys(t.size[0],n),o=t.size.length===2?ys(t.size[1],a):s),[s,o]},ZNe=function(t,e){var r=Nd(180),n=[];return Ah(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&o.value==="to"){r=Ate(a);return}else if(hte(o)){r=Wj.parse(t,o);return}}var l=Xj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},bC=function(t,e){var r=Nd(180),n=[];return Ah(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=Ate(a);return}else if(hte(o)){r=(Wj.parse(t,o)+Nd(270))%Nd(360);return}}var l=Xj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},eCe=function(t,e){var r=Nd(180),n=[],a=1,s=0,o=3,l=[];return Ah(e).forEach(function(c,u){var d=c[0];if(u===0){if(ls(d)&&d.value==="linear"){a=1;return}else if(ls(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var f=um.parse(t,d.values[0]);n.push({stop:Il,color:f})}else if(d.name==="to"){var f=um.parse(t,d.values[0]);n.push({stop:K0,color:f})}else if(d.name==="color-stop"){var A=d.values.filter(Mv);if(A.length===2){var f=um.parse(t,A[1]),h=A[0];p1(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:f})}}}}),a===1?{angle:(r+Nd(180))%Nd(360),stops:n,type:a}:{size:o,shape:s,stops:n,position:l,type:a}},mte="closest-side",pte="farthest-side",gte="closest-corner",xte="farthest-corner",vte="circle",yte="ellipse",bte="cover",wte="contain",tCe=function(t,e){var r=0,n=3,a=[],s=[];return Ah(e).forEach(function(o,l){var c=!0;if(l===0){var u=!1;c=o.reduce(function(f,A){if(u)if(ls(A))switch(A.value){case"center":return s.push(O6),f;case"top":case"left":return s.push(Il),f;case"right":case"bottom":return s.push(K0),f}else(so(A)||_m(A))&&s.push(A);else if(ls(A))switch(A.value){case vte:return r=0,!1;case yte:return r=1,!1;case"at":return u=!0,!1;case mte:return n=0,!1;case bte:case pte:return n=1,!1;case wte:case gte:return n=2,!1;case xte:return n=3,!1}else if(_m(A)||so(A))return Array.isArray(n)||(n=[]),n.push(A),!1;return f},c)}if(c){var d=Xj(t,o);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},wC=function(t,e){var r=0,n=3,a=[],s=[];return Ah(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,f){if(ls(f))switch(f.value){case"center":return s.push(O6),!1;case"top":case"left":return s.push(Il),!1;case"right":case"bottom":return s.push(K0),!1}else if(so(f)||_m(f))return s.push(f),!1;return d},c):l===1&&(c=o.reduce(function(d,f){if(ls(f))switch(f.value){case vte:return r=0,!1;case yte:return r=1,!1;case wte:case mte:return n=0,!1;case pte:return n=1,!1;case gte:return n=2,!1;case bte:case xte:return n=3,!1}else if(_m(f)||so(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)),c){var u=Xj(t,o);a.push(u)}}),{size:n,shape:r,stops:a,position:s,type:2}},rCe=function(t){return t.type===1},nCe=function(t){return t.type===2},D6={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=Nte[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function aCe(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!Nte[t.name])}var Nte={"linear-gradient":ZNe,"-moz-linear-gradient":bC,"-ms-linear-gradient":bC,"-o-linear-gradient":bC,"-webkit-linear-gradient":bC,"radial-gradient":tCe,"-moz-radial-gradient":wC,"-ms-radial-gradient":wC,"-o-radial-gradient":wC,"-webkit-radial-gradient":wC,"-webkit-gradient":eCe},sCe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Mv(n)&&aCe(n)}).map(function(n){return D6.parse(t,n)})}},iCe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(ls(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},oCe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Ah(e).map(function(r){return r.filter(so)}).map(lte)}},lCe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Ah(e).map(function(r){return r.filter(ls).map(function(n){return n.value}).join(" ")}).map(cCe)}},cCe=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},hv;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(hv||(hv={}));var uCe={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Ah(e).map(function(r){return r.filter(dCe)})}},dCe=function(t){return ls(t)||so(t)},Yj=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},fCe=Yj("top"),hCe=Yj("right"),ACe=Yj("bottom"),mCe=Yj("left"),Jj=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return lte(r.filter(so))}}},pCe=Jj("top-left"),gCe=Jj("top-right"),xCe=Jj("bottom-right"),vCe=Jj("bottom-left"),Zj=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},yCe=Zj("top"),bCe=Zj("right"),wCe=Zj("bottom"),NCe=Zj("left"),eP=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Ow(r)?r.number:0}}},CCe=eP("top"),_Ce=eP("right"),ECe=eP("bottom"),SCe=eP("left"),ICe={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},jCe={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},PCe={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).reduce(function(r,n){return r|BCe(n.value)},0)}},BCe=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},TCe={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},kCe={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},NS;(function(t){t.NORMAL="normal",t.STRICT="strict"})(NS||(NS={}));var FCe={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return NS.STRICT;case"normal":default:return NS.NORMAL}}},OCe={name:"line-height",initialValue:"normal",prefix:!1,type:4},J9=function(t,e){return ls(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:so(t)?ys(t,e):e},DCe={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:D6.parse(t,e)}},RCe={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},Ck={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},tP=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},MCe=tP("top"),LCe=tP("right"),UCe=tP("bottom"),QCe=tP("left"),VCe={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},HCe={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},rP=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},$Ce=rP("top"),GCe=rP("right"),KCe=rP("bottom"),qCe=rP("left"),zCe={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},WCe={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},XCe={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Nk(e[0],"none")?[]:Ah(e).map(function(r){for(var n={color:sA.TRANSPARENT,offsetX:Il,offsetY:Il,blur:Il},a=0,s=0;s<r.length;s++){var o=r[s];_m(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:n.blur=o,a++):n.color=um.parse(t,o)}return n})}},YCe={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},JCe={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=t_e[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},ZCe=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},e_e=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var a=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,a,s,o,l]:null},t_e={matrix:ZCe,matrix3d:e_e},Z9={type:16,number:50,flags:Fw},r_e=[Z9,Z9],n_e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(so);return r.length!==2?r_e:[r[0],r[1]]}},a_e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},bb;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(bb||(bb={}));var s_e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return bb.BREAK_ALL;case"keep-all":return bb.KEEP_ALL;case"normal":default:return bb.NORMAL}}},i_e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(p1(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Cte={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},o_e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return p1(e)?e.number:1}},l_e={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},c_e={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},u_e={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},d_e={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},f_e={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(p1(e))return e.number;if(ls(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},h_e={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(ls).map(function(r){return r.value})}},A_e={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Io=function(t,e){return(t&e)!==0},m_e={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},p_e={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=e.filter(ote),s=0;s<a.length;s++){var o=a[s],l=a[s+1];if(o.type===20){var c=l&&p1(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},g_e={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(ote),a=0;a<n.length;a++){var s=n[a],o=n[a+1];if(ls(s)&&s.value!=="none"){var l=o&&p1(o)?o.number:0;r.push({counter:s.value,reset:l})}}return r}},x_e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Ow).map(function(r){return Cte.parse(t,r)})}},v_e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],a=e.filter(GNe);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var o=a[s].value,l=a[s+1].value;n.push({open:o,close:l})}return n}},eQ=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},y_e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Nk(e[0],"none")?[]:Ah(e).map(function(r){for(var n={color:255,offsetX:Il,offsetY:Il,blur:Il,spread:Il,inset:!1},a=0,s=0;s<r.length;s++){var o=r[s];Nk(o,"inset")?n.inset=!0:_m(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:a===2?n.blur=o:n.spread=o,a++):n.color=um.parse(t,o)}return n})}},b_e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(ls).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},w_e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},N_e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Ow(e)?e.number:0}},C_e=function(){function t(e,r){var n,a;this.animationDuration=en(e,x_e,r.animationDuration),this.backgroundClip=en(e,zNe,r.backgroundClip),this.backgroundColor=en(e,WNe,r.backgroundColor),this.backgroundImage=en(e,sCe,r.backgroundImage),this.backgroundOrigin=en(e,iCe,r.backgroundOrigin),this.backgroundPosition=en(e,oCe,r.backgroundPosition),this.backgroundRepeat=en(e,lCe,r.backgroundRepeat),this.backgroundSize=en(e,uCe,r.backgroundSize),this.borderTopColor=en(e,fCe,r.borderTopColor),this.borderRightColor=en(e,hCe,r.borderRightColor),this.borderBottomColor=en(e,ACe,r.borderBottomColor),this.borderLeftColor=en(e,mCe,r.borderLeftColor),this.borderTopLeftRadius=en(e,pCe,r.borderTopLeftRadius),this.borderTopRightRadius=en(e,gCe,r.borderTopRightRadius),this.borderBottomRightRadius=en(e,xCe,r.borderBottomRightRadius),this.borderBottomLeftRadius=en(e,vCe,r.borderBottomLeftRadius),this.borderTopStyle=en(e,yCe,r.borderTopStyle),this.borderRightStyle=en(e,bCe,r.borderRightStyle),this.borderBottomStyle=en(e,wCe,r.borderBottomStyle),this.borderLeftStyle=en(e,NCe,r.borderLeftStyle),this.borderTopWidth=en(e,CCe,r.borderTopWidth),this.borderRightWidth=en(e,_Ce,r.borderRightWidth),this.borderBottomWidth=en(e,ECe,r.borderBottomWidth),this.borderLeftWidth=en(e,SCe,r.borderLeftWidth),this.boxShadow=en(e,y_e,r.boxShadow),this.color=en(e,ICe,r.color),this.direction=en(e,jCe,r.direction),this.display=en(e,PCe,r.display),this.float=en(e,TCe,r.cssFloat),this.fontFamily=en(e,u_e,r.fontFamily),this.fontSize=en(e,d_e,r.fontSize),this.fontStyle=en(e,A_e,r.fontStyle),this.fontVariant=en(e,h_e,r.fontVariant),this.fontWeight=en(e,f_e,r.fontWeight),this.letterSpacing=en(e,kCe,r.letterSpacing),this.lineBreak=en(e,FCe,r.lineBreak),this.lineHeight=en(e,OCe,r.lineHeight),this.listStyleImage=en(e,DCe,r.listStyleImage),this.listStylePosition=en(e,RCe,r.listStylePosition),this.listStyleType=en(e,Ck,r.listStyleType),this.marginTop=en(e,MCe,r.marginTop),this.marginRight=en(e,LCe,r.marginRight),this.marginBottom=en(e,UCe,r.marginBottom),this.marginLeft=en(e,QCe,r.marginLeft),this.opacity=en(e,o_e,r.opacity);var s=en(e,VCe,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=en(e,HCe,r.overflowWrap),this.paddingTop=en(e,$Ce,r.paddingTop),this.paddingRight=en(e,GCe,r.paddingRight),this.paddingBottom=en(e,KCe,r.paddingBottom),this.paddingLeft=en(e,qCe,r.paddingLeft),this.paintOrder=en(e,b_e,r.paintOrder),this.position=en(e,WCe,r.position),this.textAlign=en(e,zCe,r.textAlign),this.textDecorationColor=en(e,l_e,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=en(e,c_e,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=en(e,XCe,r.textShadow),this.textTransform=en(e,YCe,r.textTransform),this.transform=en(e,JCe,r.transform),this.transformOrigin=en(e,n_e,r.transformOrigin),this.visibility=en(e,a_e,r.visibility),this.webkitTextStrokeColor=en(e,w_e,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=en(e,N_e,r.webkitTextStrokeWidth),this.wordBreak=en(e,s_e,r.wordBreak),this.zIndex=en(e,i_e,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return dm(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return Io(this.display,4)||Io(this.display,33554432)||Io(this.display,268435456)||Io(this.display,536870912)||Io(this.display,67108864)||Io(this.display,134217728)},t}(),__e=function(){function t(e,r){this.content=en(e,m_e,r.content),this.quotes=en(e,v_e,r.quotes)}return t}(),tQ=function(){function t(e,r){this.counterIncrement=en(e,p_e,r.counterIncrement),this.counterReset=en(e,g_e,r.counterReset)}return t}(),en=function(t,e,r){var n=new ste,a=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(a);var s=new ite(n.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(t,ls(o)?o.value:e.initialValue);case 0:return e.parse(t,s.parseComponentValue());case 1:return e.parse(t,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return Wj.parse(t,s.parseComponentValue());case"color":return um.parse(t,s.parseComponentValue());case"image":return D6.parse(t,s.parseComponentValue());case"length":var l=s.parseComponentValue();return _m(l)?l:Il;case"length-percentage":var c=s.parseComponentValue();return so(c)?c:Il;case"time":return Cte.parse(t,s.parseComponentValue())}break}},E_e="data-html2canvas-debug",S_e=function(t){var e=t.getAttribute(E_e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},_k=function(t,e){var r=S_e(t);return r===1||e===r},mh=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,_k(r,3))debugger;this.styles=new C_e(e,window.getComputedStyle(r,null)),Ik(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=qj(this.context,r),_k(r,4)&&(this.flags|=16)}return t}(),I_e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",rQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ky=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var NC=0;NC<rQ.length;NC++)Ky[rQ.charCodeAt(NC)]=NC;var j_e=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Ky[t.charCodeAt(n)],o=Ky[t.charCodeAt(n+1)],l=Ky[t.charCodeAt(n+2)],c=Ky[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},P_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},B_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Op=5,R6=11,M4=2,T_e=R6-Op,_te=65536>>Op,k_e=1<<Op,L4=k_e-1,F_e=1024>>Op,O_e=_te+F_e,D_e=O_e,R_e=32,M_e=D_e+R_e,L_e=65536>>R6,U_e=1<<T_e,Q_e=U_e-1,nQ=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},V_e=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},H_e=function(t,e){var r=j_e(t),n=Array.isArray(r)?B_e(r):new Uint32Array(r),a=Array.isArray(r)?P_e(r):new Uint16Array(r),s=24,o=nQ(a,s/2,n[4]/2),l=n[5]===2?nQ(a,(s+n[4])/2):V_e(n,Math.ceil((s+n[4])/4));return new $_e(n[0],n[1],n[2],n[3],o,l)},$_e=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Op],r=(r<<M4)+(e&L4),this.data[r];if(e<=65535)return r=this.index[_te+(e-55296>>Op)],r=(r<<M4)+(e&L4),this.data[r];if(e<this.highStart)return r=M_e-L_e+(e>>R6),r=this.index[r],r+=e>>Op&Q_e,r=this.index[r],r=(r<<M4)+(e&L4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),aQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G_e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var CC=0;CC<aQ.length;CC++)G_e[aQ.charCodeAt(CC)]=CC;var K_e=1,U4=2,Q4=3,sQ=4,iQ=5,q_e=7,oQ=8,V4=9,H4=10,lQ=11,cQ=12,uQ=13,dQ=14,$4=15,z_e=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},W_e=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},X_e=H_e(I_e),md="",G4="",Y_e=function(t){return X_e.get(t)},J_e=function(t,e,r){var n=r-2,a=e[n],s=e[r-1],o=e[r];if(s===U4&&o===Q4)return md;if(s===U4||s===Q4||s===sQ||o===U4||o===Q4||o===sQ)return G4;if(s===oQ&&[oQ,V4,lQ,cQ].indexOf(o)!==-1||(s===lQ||s===V4)&&(o===V4||o===H4)||(s===cQ||s===H4)&&o===H4||o===uQ||o===iQ||o===q_e||s===K_e)return md;if(s===uQ&&o===dQ){for(;a===iQ;)a=e[--n];if(a===dQ)return md}if(s===$4&&o===$4){for(var l=0;a===$4;)l++,a=e[--n];if(l%2===0)return md}return G4},Z_e=function(t){var e=z_e(t),r=e.length,n=0,a=0,s=e.map(Y_e);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=md;n<r&&(o=J_e(e,s,++n))===md;);if(o!==md||n===r){var l=W_e.apply(null,e.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},eEe=function(t){for(var e=Z_e(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},tEe=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(t.body.removeChild(n),s===e)return!0}}return!1},rEe=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,a=zj(n.data).map(function(c){return Li(c)}),s=0,o={},l=a.every(function(c,u){r.setStart(n,s),r.setEnd(n,s+c.length);var d=r.getBoundingClientRect();s+=c.length;var f=d.x>o.x||d.y>o.y;return o=d,u===0?!0:f});return t.body.removeChild(e),l},nEe=function(){return typeof new Image().crossOrigin<"u"},aEe=function(){return typeof new XMLHttpRequest().responseType=="string"},sEe=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},fQ=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},iEe=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=e.toDataURL();a.src=s;var o=Ek(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),hQ(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var u=t.createElement("div");return u.style.backgroundImage="url("+s+")",u.style.height=r+"px",fQ(c)?hQ(Ek(r,r,0,0,u)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),fQ(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Ek=function(t,e,r,n,a){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(a),o},hQ=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},wl={get SUPPORT_RANGE_BOUNDS(){var t=tEe(document);return Object.defineProperty(wl,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=wl.SUPPORT_RANGE_BOUNDS&&rEe(document);return Object.defineProperty(wl,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=sEe(document);return Object.defineProperty(wl,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?iEe(document):Promise.resolve(!1);return Object.defineProperty(wl,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=nEe();return Object.defineProperty(wl,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=aEe();return Object.defineProperty(wl,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(wl,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(wl,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},wb=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),oEe=function(t,e,r,n){var a=uEe(e,r),s=[],o=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(wl.SUPPORT_RANGE_BOUNDS){var c=AQ(n,o,l.length).getClientRects();if(c.length>1){var u=M6(l),d=0;u.forEach(function(A){s.push(new wb(A,vA.fromDOMRectList(t,AQ(n,d+o,A.length).getClientRects()))),d+=A.length})}else s.push(new wb(l,vA.fromDOMRectList(t,c)))}else{var f=n.splitText(l.length);s.push(new wb(l,lEe(t,n))),n=f}else wl.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),s},lEe=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(n,e);var s=qj(t,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return vA.EMPTY},AQ=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(t,e),a.setEnd(t,e+r),a},M6=function(t){if(wl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return eEe(t)},cEe=function(t,e){if(wl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return fEe(t,e)},uEe=function(t,e){return e.letterSpacing!==0?M6(t):cEe(t,e)},dEe=[32,160,4961,65792,65793,4153,4241],fEe=function(t,e){for(var r=Lwe(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],a,s=function(){if(a.value){var o=a.value.slice(),l=zj(o),c="";l.forEach(function(u){dEe.indexOf(u)===-1?c+=Li(u):(c.length&&n.push(c),n.push(Li(u)),c="")}),c.length&&n.push(c)}};!(a=r.next()).done;)s();return n},hEe=function(){function t(e,r,n){this.text=AEe(r.data,n.textTransform),this.textBounds=oEe(e,this.text,n,r)}return t}(),AEe=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(mEe,pEe);case 2:return t.toUpperCase();default:return t}},mEe=/(^|\s|:|-|\(|\))([a-z])/g,pEe=function(t,e,r){return t.length>0?e+r.toUpperCase():t},Ete=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return e}(mh),Ste=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return e}(mh),Ite=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=new XMLSerializer,o=qj(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return e}(mh),jte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(mh),Sk=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return e}(mh),gEe=[{type:15,flags:0,unit:"px",number:3}],xEe=[{type:16,flags:0,number:50}],vEe=function(t){return t.width>t.height?new vA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new vA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},yEe=function(t){var e=t.type===bEe?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},CS="checkbox",_S="radio",bEe="password",mQ=707406591,L6=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=yEe(n),(a.type===CS||a.type===_S)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=vEe(a.bounds)),a.type){case CS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=gEe;break;case _S:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=xEe;break}return a}return e}(mh),Pte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return e}(mh),Bte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(mh),Tte=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=Fte(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?yb(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):sA.TRANSPARENT,o=n.contentWindow.document.body?yb(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):sA.TRANSPARENT;a.backgroundColor=dm(s)?dm(o)?a.styles.backgroundColor:o:s}}catch{}return a}return e}(mh),wEe=["OL","UL","MENU"],hE=function(t,e,r,n){for(var a=e.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,Ote(a)&&a.data.trim().length>0)r.textNodes.push(new hEe(t,a,r.styles));else if(zx(a))if(Lte(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return hE(t,l,r,n)});else{var o=kte(t,a);o.styles.isVisible()&&(NEe(a,o,n)?o.flags|=4:CEe(o.styles)&&(o.flags|=2),wEe.indexOf(a.tagName)!==-1&&(o.flags|=8),r.elements.push(o),a.slot,a.shadowRoot?hE(t,a.shadowRoot,o,n):!ES(a)&&!Dte(a)&&!SS(a)&&hE(t,a,o,n))}},kte=function(t,e){return jk(e)?new Ete(t,e):Rte(e)?new Ste(t,e):Dte(e)?new Ite(t,e):_Ee(e)?new jte(t,e):EEe(e)?new Sk(t,e):SEe(e)?new L6(t,e):SS(e)?new Pte(t,e):ES(e)?new Bte(t,e):Mte(e)?new Tte(t,e):new mh(t,e)},Fte=function(t,e){var r=kte(t,e);return r.flags|=4,hE(t,e,r,r),r},NEe=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||U6(t)&&r.styles.isTransparent()},CEe=function(t){return t.isPositioned()||t.isFloating()},Ote=function(t){return t.nodeType===Node.TEXT_NODE},zx=function(t){return t.nodeType===Node.ELEMENT_NODE},Ik=function(t){return zx(t)&&typeof t.style<"u"&&!AE(t)},AE=function(t){return typeof t.className=="object"},_Ee=function(t){return t.tagName==="LI"},EEe=function(t){return t.tagName==="OL"},SEe=function(t){return t.tagName==="INPUT"},IEe=function(t){return t.tagName==="HTML"},Dte=function(t){return t.tagName==="svg"},U6=function(t){return t.tagName==="BODY"},Rte=function(t){return t.tagName==="CANVAS"},pQ=function(t){return t.tagName==="VIDEO"},jk=function(t){return t.tagName==="IMG"},Mte=function(t){return t.tagName==="IFRAME"},gQ=function(t){return t.tagName==="STYLE"},jEe=function(t){return t.tagName==="SCRIPT"},ES=function(t){return t.tagName==="TEXTAREA"},SS=function(t){return t.tagName==="SELECT"},Lte=function(t){return t.tagName==="SLOT"},xQ=function(t){return t.tagName.indexOf("-")>0},PEe=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,a=e.counterReset,s=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return s&&a.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),vQ={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},yQ={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},BEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},TEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},ix=function(t,e,r,n,a,s){return t<e||t>r?_2(t,a,s.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+s},Ute=function(t,e,r,n){var a="";do r||t--,a=n(t)+a,t/=e;while(t*e>=e);return a},Fi=function(t,e,r,n,a){var s=r-e+1;return(t<0?"-":"")+(Ute(Math.abs(t),s,n,function(o){return Li(Math.floor(o%s)+e)})+a)},Xm=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return Ute(Math.abs(t),n,!1,function(a){return e[Math.floor(a%n)]})+r},jx=1,N0=2,C0=4,qy=8,Eh=function(t,e,r,n,a,s){if(t<-9999||t>9999)return _2(t,4,a.length>0);var o=Math.abs(t),l=a;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var u=o%10;u===0&&Io(s,jx)&&l!==""?l=e[u]+l:u>1||u===1&&c===0||u===1&&c===1&&Io(s,N0)||u===1&&c===1&&Io(s,C0)&&t>100||u===1&&c>1&&Io(s,qy)?l=e[u]+(c>0?r[c-1]:"")+l:u===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},bQ="",wQ="",NQ="",K4="",_2=function(t,e,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Fi(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Xm(t,"",a);case 6:return ix(t,1,3999,vQ,3,n).toLowerCase();case 7:return ix(t,1,3999,vQ,3,n);case 8:return Fi(t,945,969,!1,n);case 9:return Fi(t,97,122,!1,n);case 10:return Fi(t,65,90,!1,n);case 11:return Fi(t,1632,1641,!0,n);case 12:case 49:return ix(t,1,9999,yQ,3,n);case 35:return ix(t,1,9999,yQ,3,n).toLowerCase();case 13:return Fi(t,2534,2543,!0,n);case 14:case 30:return Fi(t,6112,6121,!0,n);case 15:return Xm(t,"",a);case 16:return Xm(t,"",a);case 17:case 48:return Eh(t,"",bQ,"",a,N0|C0|qy);case 47:return Eh(t,"",wQ,"",a,jx|N0|C0|qy);case 42:return Eh(t,"",bQ,"",a,N0|C0|qy);case 41:return Eh(t,"",wQ,"",a,jx|N0|C0|qy);case 26:return Eh(t,"","",NQ,a,0);case 25:return Eh(t,"","",NQ,a,jx|N0|C0);case 31:return Eh(t,"","",K4,s,jx|N0|C0);case 33:return Eh(t,"","",K4,s,0);case 32:return Eh(t,"","",K4,s,jx|N0|C0);case 18:return Fi(t,2406,2415,!0,n);case 20:return ix(t,1,19999,TEe,3,n);case 21:return Fi(t,2790,2799,!0,n);case 22:return Fi(t,2662,2671,!0,n);case 22:return ix(t,1,10999,BEe,3,n);case 23:return Xm(t,"");case 24:return Xm(t,"");case 27:return Fi(t,3302,3311,!0,n);case 28:return Xm(t,"",a);case 29:return Xm(t,"",a);case 34:return Fi(t,3792,3801,!0,n);case 37:return Fi(t,6160,6169,!0,n);case 38:return Fi(t,4160,4169,!0,n);case 39:return Fi(t,2918,2927,!0,n);case 40:return Fi(t,1776,1785,!0,n);case 43:return Fi(t,3046,3055,!0,n);case 44:return Fi(t,3174,3183,!0,n);case 45:return Fi(t,3664,3673,!0,n);case 46:return Fi(t,3872,3881,!0,n);case 3:default:return Fi(t,48,57,!0,n)}},Qte="data-html2canvas-ignore",CQ=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new PEe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,a=kEe(e,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=a.contentWindow,c=l.document,u=DEe(a).then(function(){return vc(n,void 0,void 0,function(){var d,f;return Xl(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(UEe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,OEe(c)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,f)}).then(function(){return a})]:[2,a]}})})});return c.open(),c.write(MEe(document.doctype)+"<html></html>"),LEe(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),u},t.prototype.createElementClone=function(e){if(_k(e,2))debugger;if(Rte(e))return this.createCanvasClone(e);if(pQ(e))return this.createVideoClone(e);if(gQ(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return jk(r)&&(jk(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),xQ(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return q4(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),a=e.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var a=e.cloneNode(!1);try{a.width=e.width,a.height=e.height;var s=e.getContext("2d"),o=a.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return a},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var a=e.ownerDocument.createElement("canvas");return a.width=e.offsetWidth,a.height=e.offsetHeight,a},t.prototype.appendChildNode=function(e,r,n){(!zx(r)||!jEe(r)&&!r.hasAttribute(Qte)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!zx(r)||!gQ(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var a=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(zx(s)&&Lte(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},t.prototype.cloneNode=function(e,r){if(Ote(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&zx(e)&&(Ik(e)||AE(e))){var a=this.createElementClone(e);a.style.transitionProperty="none";var s=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&Ik(a)&&(this.clonedReferenceElement=a),U6(a)&&HEe(a);var c=this.counters.parse(new tQ(this.context,s)),u=this.resolvePseudoContent(e,a,o,Nb.BEFORE);xQ(e)&&(r=!0),pQ(e)||this.cloneChildNodes(e,a,r),u&&a.insertBefore(u,a.firstChild);var d=this.resolvePseudoContent(e,a,l,Nb.AFTER);return d&&a.appendChild(d),this.counters.pop(c),(s&&(this.options.copyStyles||AE(e))&&!Mte(e)||r)&&q4(s,a),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([a,e.scrollLeft,e.scrollTop]),(ES(e)||SS(e))&&(ES(a)||SS(a))&&(a.value=e.value),a}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,a){var s=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new tQ(this.context,n));var c=new __e(this.context,n),u=l.createElement("html2canvaspseudoelement");q4(n,u),c.content.forEach(function(f){if(f.type===0)u.appendChild(l.createTextNode(f.value));else if(f.type===22){var A=l.createElement("img");A.src=f.value,A.style.opacity="1",u.appendChild(A)}else if(f.type===18){if(f.name==="attr"){var h=f.values.filter(ls);h.length&&u.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(f.name==="counter"){var m=f.values.filter(Mv),p=m[0],x=m[1];if(p&&ls(p)){var v=s.counters.getCounterValue(p.value),y=x&&ls(x)?Ck.parse(s.context,x.value):3;u.appendChild(l.createTextNode(_2(v,y,!1)))}}else if(f.name==="counters"){var b=f.values.filter(Mv),p=b[0],w=b[1],x=b[2];if(p&&ls(p)){var j=s.counters.getCounterValues(p.value),I=x&&ls(x)?Ck.parse(s.context,x.value):3,_=w&&w.type===0?w.value:"",S=j.map(function(T){return _2(T,I,!1)}).join(_);u.appendChild(l.createTextNode(S))}}}else if(f.type===20)switch(f.value){case"open-quote":u.appendChild(l.createTextNode(eQ(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":u.appendChild(l.createTextNode(eQ(c.quotes,--s.quoteDepth,!1)));break;default:u.appendChild(l.createTextNode(f.value))}}),u.className=Pk+" "+Bk;var d=a===Nb.BEFORE?" "+Pk:" "+Bk;return AE(r)?r.className.baseValue+=d:r.className+=d,u}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),Nb;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Nb||(Nb={}));var kEe=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(Qte,"true"),t.body.appendChild(r),r},FEe=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},OEe=function(t){return Promise.all([].slice.call(t.images,0).map(FEe))},DEe=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),e(t))},50)}})},REe=["all","d","content"],q4=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);REe.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},MEe=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},LEe=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},UEe=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},QEe=":before",VEe=":after",Pk="___html2canvas___pseudoelement_before",Bk="___html2canvas___pseudoelement_after",_Q=`{
    content: "" !important;
    display: none !important;
}`,HEe=function(t){$Ee(t,"."+Pk+QEe+_Q+`
         .`+Bk+VEe+_Q)},$Ee=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},Vte=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),GEe=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(W4(e)||WEe(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return vc(this,void 0,void 0,function(){var r,n,a,s,o=this;return Xl(this,function(l){switch(l.label){case 0:return r=Vte.isSameOrigin(e),n=!z4(e)&&this._options.useCORS===!0&&wl.SUPPORT_CORS_IMAGES&&!r,a=!z4(e)&&!r&&!W4(e)&&typeof this._options.proxy=="string"&&wl.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!z4(e)&&!W4(e)&&!a&&!n?[2]:(s=e,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,u){var d=new Image;d.onload=function(){return c(d)},d.onerror=u,(XEe(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return u("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=e.substring(0,256);return new Promise(function(s,o){var l=wl.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")s(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return s(f.result)},!1),f.addEventListener("error",function(A){return o(A)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+a+" with status code "+c.status)},c.onerror=o;var u=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+u+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+a)}}c.send()})},t}(),KEe=/^data:image\/svg\+xml/i,qEe=/^data:image\/.*;base64,/i,zEe=/^data:image\/.*/i,WEe=function(t){return wl.SUPPORT_SVG_DRAWING||!YEe(t)},z4=function(t){return zEe.test(t)},XEe=function(t){return qEe.test(t)},W4=function(t){return t.substr(0,4)==="blob"},YEe=function(t){return t.substr(-3).toLowerCase()==="svg"||KEe.test(t)},Jr=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),ox=function(t,e,r){return new Jr(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},_C=function(){function t(e,r,n,a){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=a}return t.prototype.subdivide=function(e,r){var n=ox(this.start,this.startControl,e),a=ox(this.startControl,this.endControl,e),s=ox(this.endControl,this.end,e),o=ox(n,a,e),l=ox(a,s,e),c=ox(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,s,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),yd=function(t){return t.type===1},JEe=function(){function t(e){var r=e.styles,n=e.bounds,a=Gy(r.borderTopLeftRadius,n.width,n.height),s=a[0],o=a[1],l=Gy(r.borderTopRightRadius,n.width,n.height),c=l[0],u=l[1],d=Gy(r.borderBottomRightRadius,n.width,n.height),f=d[0],A=d[1],h=Gy(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((s+c)/n.width),x.push((m+f)/n.width),x.push((o+p)/n.height),x.push((u+A)/n.height);var v=Math.max.apply(Math,x);v>1&&(s/=v,o/=v,c/=v,u/=v,f/=v,A/=v,m/=v,p/=v);var y=n.width-c,b=n.height-A,w=n.width-f,j=n.height-p,I=r.borderTopWidth,_=r.borderRightWidth,S=r.borderBottomWidth,E=r.borderLeftWidth,B=ys(r.paddingTop,e.bounds.width),T=ys(r.paddingRight,e.bounds.width),P=ys(r.paddingBottom,e.bounds.width),O=ys(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?Ds(n.left+E/3,n.top+I/3,s-E/3,o-I/3,Ua.TOP_LEFT):new Jr(n.left+E/3,n.top+I/3),this.topRightBorderDoubleOuterBox=s>0||o>0?Ds(n.left+y,n.top+I/3,c-_/3,u-I/3,Ua.TOP_RIGHT):new Jr(n.left+n.width-_/3,n.top+I/3),this.bottomRightBorderDoubleOuterBox=f>0||A>0?Ds(n.left+w,n.top+b,f-_/3,A-S/3,Ua.BOTTOM_RIGHT):new Jr(n.left+n.width-_/3,n.top+n.height-S/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?Ds(n.left+E/3,n.top+j,m-E/3,p-S/3,Ua.BOTTOM_LEFT):new Jr(n.left+E/3,n.top+n.height-S/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?Ds(n.left+E*2/3,n.top+I*2/3,s-E*2/3,o-I*2/3,Ua.TOP_LEFT):new Jr(n.left+E*2/3,n.top+I*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?Ds(n.left+y,n.top+I*2/3,c-_*2/3,u-I*2/3,Ua.TOP_RIGHT):new Jr(n.left+n.width-_*2/3,n.top+I*2/3),this.bottomRightBorderDoubleInnerBox=f>0||A>0?Ds(n.left+w,n.top+b,f-_*2/3,A-S*2/3,Ua.BOTTOM_RIGHT):new Jr(n.left+n.width-_*2/3,n.top+n.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?Ds(n.left+E*2/3,n.top+j,m-E*2/3,p-S*2/3,Ua.BOTTOM_LEFT):new Jr(n.left+E*2/3,n.top+n.height-S*2/3),this.topLeftBorderStroke=s>0||o>0?Ds(n.left+E/2,n.top+I/2,s-E/2,o-I/2,Ua.TOP_LEFT):new Jr(n.left+E/2,n.top+I/2),this.topRightBorderStroke=s>0||o>0?Ds(n.left+y,n.top+I/2,c-_/2,u-I/2,Ua.TOP_RIGHT):new Jr(n.left+n.width-_/2,n.top+I/2),this.bottomRightBorderStroke=f>0||A>0?Ds(n.left+w,n.top+b,f-_/2,A-S/2,Ua.BOTTOM_RIGHT):new Jr(n.left+n.width-_/2,n.top+n.height-S/2),this.bottomLeftBorderStroke=m>0||p>0?Ds(n.left+E/2,n.top+j,m-E/2,p-S/2,Ua.BOTTOM_LEFT):new Jr(n.left+E/2,n.top+n.height-S/2),this.topLeftBorderBox=s>0||o>0?Ds(n.left,n.top,s,o,Ua.TOP_LEFT):new Jr(n.left,n.top),this.topRightBorderBox=c>0||u>0?Ds(n.left+y,n.top,c,u,Ua.TOP_RIGHT):new Jr(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||A>0?Ds(n.left+w,n.top+b,f,A,Ua.BOTTOM_RIGHT):new Jr(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?Ds(n.left,n.top+j,m,p,Ua.BOTTOM_LEFT):new Jr(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||o>0?Ds(n.left+E,n.top+I,Math.max(0,s-E),Math.max(0,o-I),Ua.TOP_LEFT):new Jr(n.left+E,n.top+I),this.topRightPaddingBox=c>0||u>0?Ds(n.left+Math.min(y,n.width-_),n.top+I,y>n.width+_?0:Math.max(0,c-_),Math.max(0,u-I),Ua.TOP_RIGHT):new Jr(n.left+n.width-_,n.top+I),this.bottomRightPaddingBox=f>0||A>0?Ds(n.left+Math.min(w,n.width-E),n.top+Math.min(b,n.height-S),Math.max(0,f-_),Math.max(0,A-S),Ua.BOTTOM_RIGHT):new Jr(n.left+n.width-_,n.top+n.height-S),this.bottomLeftPaddingBox=m>0||p>0?Ds(n.left+E,n.top+Math.min(j,n.height-S),Math.max(0,m-E),Math.max(0,p-S),Ua.BOTTOM_LEFT):new Jr(n.left+E,n.top+n.height-S),this.topLeftContentBox=s>0||o>0?Ds(n.left+E+O,n.top+I+B,Math.max(0,s-(E+O)),Math.max(0,o-(I+B)),Ua.TOP_LEFT):new Jr(n.left+E+O,n.top+I+B),this.topRightContentBox=c>0||u>0?Ds(n.left+Math.min(y,n.width+E+O),n.top+I+B,y>n.width+E+O?0:c-E+O,u-(I+B),Ua.TOP_RIGHT):new Jr(n.left+n.width-(_+T),n.top+I+B),this.bottomRightContentBox=f>0||A>0?Ds(n.left+Math.min(w,n.width-(E+O)),n.top+Math.min(b,n.height+I+B),Math.max(0,f-(_+T)),A-(S+P),Ua.BOTTOM_RIGHT):new Jr(n.left+n.width-(_+T),n.top+n.height-(S+P)),this.bottomLeftContentBox=m>0||p>0?Ds(n.left+E+O,n.top+j,Math.max(0,m-(E+O)),p-(S+P),Ua.BOTTOM_LEFT):new Jr(n.left+E+O,n.top+n.height-(S+P))}return t}(),Ua;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ua||(Ua={}));var Ds=function(t,e,r,n,a){var s=4*((Math.sqrt(2)-1)/3),o=r*s,l=n*s,c=t+r,u=e+n;switch(a){case Ua.TOP_LEFT:return new _C(new Jr(t,u),new Jr(t,u-l),new Jr(c-o,e),new Jr(c,e));case Ua.TOP_RIGHT:return new _C(new Jr(t,e),new Jr(t+o,e),new Jr(c,u-l),new Jr(c,u));case Ua.BOTTOM_RIGHT:return new _C(new Jr(c,e),new Jr(c,e+l),new Jr(t+o,u),new Jr(t,u));case Ua.BOTTOM_LEFT:default:return new _C(new Jr(c,u),new Jr(c-o,u),new Jr(t,e+l),new Jr(t,e))}},IS=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},ZEe=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},jS=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},eSe=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),EC=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),tSe=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),rSe=function(t){return t.type===0},Hte=function(t){return t.type===1},nSe=function(t){return t.type===2},EQ=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},aSe=function(t,e,r,n,a){return t.map(function(s,o){switch(o){case 0:return s.add(e,r);case 1:return s.add(e+n,r);case 2:return s.add(e+n,r+a);case 3:return s.add(e,r+a)}return s})},$te=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),Gte=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new JEe(this.container),this.container.styles.opacity<1&&this.effects.push(new tSe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new eSe(n,a,s))}if(this.container.styles.overflowX!==0){var o=IS(this.curves),l=jS(this.curves);EQ(o,l)?this.effects.push(new EC(o,6)):(this.effects.push(new EC(o,2)),this.effects.push(new EC(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(c){return!Hte(c)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=IS(n.curves),l=jS(n.curves);EQ(o,l)||a.unshift(new EC(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(c){return Io(c.target,e)})},t}(),Tk=function(t,e,r,n){t.container.elements.forEach(function(a){var s=Io(a.flags,4),o=Io(a.flags,2),l=new Gte(a,t);Io(a.styles.display,2048)&&n.push(l);var c=Io(a.flags,8)?[]:n;if(s||o){var u=s||a.styles.isPositioned()?r:e,d=new $te(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var f=a.styles.zIndex.order;if(f<0){var A=0;u.negativeZIndex.some(function(m,p){return f>m.element.container.styles.zIndex.order?(A=p,!1):A>0}),u.negativeZIndex.splice(A,0,d)}else if(f>0){var h=0;u.positiveZIndex.some(function(m,p){return f>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),u.positiveZIndex.splice(h,0,d)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?u.nonPositionedFloats.push(d):u.nonPositionedInlineLevel.push(d);Tk(l,d,s?d:r,c)}else a.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),Tk(l,e,r,c);Io(a.flags,8)&&Kte(a,c)})},Kte=function(t,e){for(var r=t instanceof Sk?t.start:1,n=t instanceof Sk?t.reversed:!1,a=0;a<e.length;a++){var s=e[a];s.container instanceof jte&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=_2(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},sSe=function(t){var e=new Gte(t,null),r=new $te(e),n=[];return Tk(e,r,r,n),Kte(e.container,n),r},SQ=function(t,e){switch(e){case 0:return Cd(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Cd(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Cd(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Cd(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},iSe=function(t,e){switch(e){case 0:return Cd(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Cd(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Cd(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Cd(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},oSe=function(t,e){switch(e){case 0:return Cd(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Cd(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Cd(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Cd(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},lSe=function(t,e){switch(e){case 0:return SC(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return SC(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return SC(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return SC(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},SC=function(t,e){var r=[];return yd(t)?r.push(t.subdivide(.5,!1)):r.push(t),yd(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},Cd=function(t,e,r,n){var a=[];return yd(t)?a.push(t.subdivide(.5,!1)):a.push(t),yd(r)?a.push(r.subdivide(.5,!0)):a.push(r),yd(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),yd(e)?a.push(e.subdivide(.5,!1).reverse()):a.push(e),a},qte=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},PS=function(t){var e=t.styles,r=t.bounds,n=ys(e.paddingLeft,r.width),a=ys(e.paddingRight,r.width),s=ys(e.paddingTop,r.width),o=ys(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+a),-(e.borderTopWidth+e.borderBottomWidth+s+o))},cSe=function(t,e){return t===0?e.bounds:t===2?PS(e):qte(e)},uSe=function(t,e){return t===0?e.bounds:t===2?PS(e):qte(e)},X4=function(t,e,r){var n=cSe(Px(t.styles.backgroundOrigin,e),t),a=uSe(Px(t.styles.backgroundClip,e),t),s=dSe(Px(t.styles.backgroundSize,e),r,n),o=s[0],l=s[1],c=Gy(Px(t.styles.backgroundPosition,e),n.width-o,n.height-l),u=fSe(Px(t.styles.backgroundRepeat,e),c,s,n,a),d=Math.round(n.left+c[0]),f=Math.round(n.top+c[1]);return[u,d,f,o,l]},lx=function(t){return ls(t)&&t.value===hv.AUTO},IC=function(t){return typeof t=="number"},dSe=function(t,e,r){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(so(o)&&l&&so(l))return[ys(o,r.width),ys(l,r.height)];var c=IC(s);if(ls(o)&&(o.value===hv.CONTAIN||o.value===hv.COVER)){if(IC(s)){var u=r.width/r.height;return u<s!=(o.value===hv.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=IC(n),f=IC(a),A=d||f;if(lx(o)&&(!l||lx(l))){if(d&&f)return[n,a];if(!c&&!A)return[r.width,r.height];if(A&&c){var h=d?n:a*s,m=f?a:n/s;return[h,m]}var p=d?n:r.width,x=f?a:r.height;return[p,x]}if(c){var v=0,y=0;return so(o)?v=ys(o,r.width):so(l)&&(y=ys(l,r.height)),lx(o)?v=y*s:(!l||lx(l))&&(y=v/s),[v,y]}var b=null,w=null;if(so(o)?b=ys(o,r.width):l&&so(l)&&(w=ys(l,r.height)),b!==null&&(!l||lx(l))&&(w=d&&f?b/n*a:r.height),w!==null&&lx(o)&&(b=d&&f?w/a*n:r.width),b!==null&&w!==null)return[b,w];throw new Error("Unable to calculate background-size for element")},Px=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},fSe=function(t,e,r,n,a){var s=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new Jr(Math.round(n.left),Math.round(n.top+o)),new Jr(Math.round(n.left+n.width),Math.round(n.top+o)),new Jr(Math.round(n.left+n.width),Math.round(c+n.top+o)),new Jr(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new Jr(Math.round(n.left+s),Math.round(n.top)),new Jr(Math.round(n.left+s+l),Math.round(n.top)),new Jr(Math.round(n.left+s+l),Math.round(n.height+n.top)),new Jr(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new Jr(Math.round(n.left+s),Math.round(n.top+o)),new Jr(Math.round(n.left+s+l),Math.round(n.top+o)),new Jr(Math.round(n.left+s+l),Math.round(n.top+o+c)),new Jr(Math.round(n.left+s),Math.round(n.top+o+c))];default:return[new Jr(Math.round(a.left),Math.round(a.top)),new Jr(Math.round(a.left+a.width),Math.round(a.top)),new Jr(Math.round(a.left+a.width),Math.round(a.height+a.top)),new Jr(Math.round(a.left),Math.round(a.height+a.top))]}},hSe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",IQ="Hidden Text",ASe=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),a.src=hSe,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(IQ)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(IQ)),n.style.lineHeight="normal",a.style.verticalAlign="super";var c=a.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),zte=function(){function t(e,r){this.context=e,this.options=r}return t}(),mSe=1e4,pSe=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new ASe(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},e.prototype.applyEffect=function(r){this.ctx.save(),nSe(r)&&(this.ctx.globalAlpha=r.opacity),rSe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),Hte(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return vc(this,void 0,void 0,function(){var n;return Xl(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return vc(this,void 0,void 0,function(){return Xl(this,function(n){switch(n.label){case 0:if(Io(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var o=M6(r.text);o.reduce(function(l,c){return s.ctx.fillText(c,l,r.bounds.top+a),l+s.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),a=bSe(r.fontFamily).join(", "),s=Ow(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},e.prototype.renderTextNode=function(r,n){return vc(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A=this;return Xl(this,function(h){return a=this.createFontStyle(n),s=a[0],o=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),u=c.baseline,d=c.middle,f=n.paintOrder,r.textBounds.forEach(function(m){f.forEach(function(p){switch(p){case 0:A.ctx.fillStyle=Ho(n.color),A.renderTextWithLetterSpacing(m,n.letterSpacing,u);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(v){A.ctx.shadowColor=Ho(v.color),A.ctx.shadowOffsetX=v.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=v.offsetY.number*A.options.scale,A.ctx.shadowBlur=v.blur.number,A.renderTextWithLetterSpacing(m,n.letterSpacing,u)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),n.textDecorationLine.length&&(A.ctx.fillStyle=Ho(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(v){switch(v){case 1:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+u),m.bounds.width,1);break;case 2:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:A.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+d),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(A.ctx.strokeStyle=Ho(n.webkitTextStrokeColor),A.ctx.lineWidth=n.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+u)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=PS(r),o=jS(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return vc(this,void 0,void 0,function(){var n,a,s,o,l,c,y,y,u,d,f,A,w,h,m,j,p,x,v,y,b,w,j;return Xl(this,function(I){switch(I.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,o=0,l=n.textNodes,I.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:I.sent(),I.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof Ete))return[3,8];I.label=5;case 5:return I.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,8];case 7:return I.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof Ste&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof Ite))return[3,12];I.label=9;case 9:return I.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,12];case 11:return I.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof Tte&&n.tree?(u=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,u.render(n.tree)]):[3,14];case 13:d=I.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),I.label=14;case 14:if(n instanceof L6&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===CS?n.checked&&(this.ctx.save(),this.path([new Jr(n.bounds.left+f*.39363,n.bounds.top+f*.79),new Jr(n.bounds.left+f*.16,n.bounds.top+f*.5549),new Jr(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new Jr(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new Jr(n.bounds.left+f*.72983,n.bounds.top+f*.23),new Jr(n.bounds.left+f*.84,n.bounds.top+f*.34085),new Jr(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=Ho(mQ),this.ctx.fill(),this.ctx.restore()):n.type===_S&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ho(mQ),this.ctx.fill(),this.ctx.restore())),gSe(n)&&n.value.length){switch(A=this.createFontStyle(s),w=A[0],h=A[1],m=this.fontMetrics.getMetrics(w,h).baseline,this.ctx.font=w,this.ctx.fillStyle=Ho(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=vSe(n.styles.textAlign),j=PS(n),p=0,n.styles.textAlign){case 1:p+=j.width/2;break;case 2:p+=j.width;break}x=j.add(p,0,0,-j.height/2+1),this.ctx.save(),this.path([new Jr(j.left,j.top),new Jr(j.left+j.width,j.top),new Jr(j.left+j.width,j.top+j.height),new Jr(j.left,j.top+j.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new wb(n.value,x),s.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Io(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(v=n.styles.listStyleImage,v.type!==0)return[3,18];y=void 0,b=v.url,I.label=15;case 15:return I.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=I.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return I.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(w=this.createFontStyle(s)[0],this.ctx.font=w,this.ctx.fillStyle=Ho(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",j=new vA(n.bounds.left,n.bounds.top+ys(n.styles.paddingTop,n.bounds.width),n.bounds.width,J9(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new wb(r.listValue,j),s.letterSpacing,J9(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),I.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return vc(this,void 0,void 0,function(){var n,a,v,s,o,v,l,c,v,u,d,v,f,A,v,h,m,v,p,x,v;return Xl(this,function(y){switch(y.label){case 0:if(Io(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,a=r.negativeZIndex,y.label=2;case 2:return n<a.length?(v=a[n],[4,this.renderStack(v)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),s=0,o=r.nonInlineLevel,y.label=7;case 7:return s<o.length?(v=o[s],[4,this.renderNode(v)]):[3,10];case 8:y.sent(),y.label=9;case 9:return s++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(v=c[l],[4,this.renderStack(v)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:u=0,d=r.nonPositionedInlineLevel,y.label=15;case 15:return u<d.length?(v=d[u],[4,this.renderStack(v)]):[3,18];case 16:y.sent(),y.label=17;case 17:return u++,[3,15];case 18:f=0,A=r.inlineLevel,y.label=19;case 19:return f<A.length?(v=A[f],[4,this.renderNode(v)]):[3,22];case 20:y.sent(),y.label=21;case 21:return f++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(v=m[h],[4,this.renderStack(v)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,y.label=27;case 27:return p<x.length?(v=x[p],[4,this.renderStack(v)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var o=yd(a)?a.start:a;s===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),yd(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},e.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},e.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},e.prototype.renderBackgroundImage=function(r){return vc(this,void 0,void 0,function(){var n,a,s,o,l,c;return Xl(this,function(u){switch(u.label){case 0:n=r.styles.backgroundImage.length-1,a=function(d){var f,A,h,B,de,ue,O,z,S,m,B,de,ue,O,z,p,x,v,y,b,w,j,I,_,S,E,B,T,P,O,z,ce,de,ue,me,se,ke,Re,F,H,K,L;return Xl(this,function(W){switch(W.label){case 0:if(d.type!==0)return[3,5];f=void 0,A=d.url,W.label=1;case 1:return W.trys.push([1,3,,4]),[4,s.context.cache.match(A)];case 2:return f=W.sent(),[3,4];case 3:return W.sent(),s.context.logger.error("Error loading background-image "+A),[3,4];case 4:return f&&(h=X4(r,n,[f.width,f.height,f.width/f.height]),B=h[0],de=h[1],ue=h[2],O=h[3],z=h[4],S=s.ctx.createPattern(s.resizeImage(f,O,z),"repeat"),s.renderRepeat(B,S,de,ue)),[3,6];case 5:rCe(d)?(m=X4(r,n,[null,null,null]),B=m[0],de=m[1],ue=m[2],O=m[3],z=m[4],p=YNe(d.angle,O,z),x=p[0],v=p[1],y=p[2],b=p[3],w=p[4],j=document.createElement("canvas"),j.width=O,j.height=z,I=j.getContext("2d"),_=I.createLinearGradient(v,b,y,w),X9(d.stops,x).forEach(function(Y){return _.addColorStop(Y.stop,Ho(Y.color))}),I.fillStyle=_,I.fillRect(0,0,O,z),O>0&&z>0&&(S=s.ctx.createPattern(j,"repeat"),s.renderRepeat(B,S,de,ue))):nCe(d)&&(E=X4(r,n,[null,null,null]),B=E[0],T=E[1],P=E[2],O=E[3],z=E[4],ce=d.position.length===0?[O6]:d.position,de=ys(ce[0],O),ue=ys(ce[ce.length-1],z),me=JNe(d,de,ue,O,z),se=me[0],ke=me[1],se>0&&ke>0&&(Re=s.ctx.createRadialGradient(T+de,P+ue,0,T+de,P+ue,se),X9(d.stops,se*2).forEach(function(Y){return Re.addColorStop(Y.stop,Ho(Y.color))}),s.path(B),s.ctx.fillStyle=Re,se!==ke?(F=r.bounds.left+.5*r.bounds.width,H=r.bounds.top+.5*r.bounds.height,K=ke/se,L=1/K,s.ctx.save(),s.ctx.translate(F,H),s.ctx.transform(1,0,0,K,0,0),s.ctx.translate(-F,-H),s.ctx.fillRect(T,L*(P-H)+H,O,z*L),s.ctx.restore()):s.ctx.fill())),W.label=6;case 6:return n--,[2]}})},s=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),u.label=1;case 1:return o<l.length?(c=l[o],[5,a(c)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,a){return vc(this,void 0,void 0,function(){return Xl(this,function(s){return this.path(SQ(a,n)),this.ctx.fillStyle=Ho(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,a,s){return vc(this,void 0,void 0,function(){var o,l;return Xl(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=iSe(s,a),this.path(o),this.ctx.fillStyle=Ho(r),this.ctx.fill(),l=oSe(s,a),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return vc(this,void 0,void 0,function(){var n,a,s,o,l,c,u,d,f=this;return Xl(this,function(A){switch(A.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!dm(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=xSe(Px(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),dm(n.backgroundColor)||(this.ctx.fillStyle=Ho(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){f.ctx.save();var m=IS(r.curves),p=h.inset?0:mSe,x=aSe(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(f.path(m),f.ctx.clip(),f.mask(x)):(f.mask(m),f.ctx.clip(),f.path(x)),f.ctx.shadowOffsetX=h.offsetX.number+p,f.ctx.shadowOffsetY=h.offsetY.number,f.ctx.shadowColor=Ho(h.color),f.ctx.shadowBlur=h.blur.number,f.ctx.fillStyle=h.inset?Ho(h.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),A.label=2;case 2:l=0,c=0,u=s,A.label=3;case 3:return c<u.length?(d=u[c],d.style!==0&&!dm(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return A.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:A.sent(),A.label=11;case 11:l++,A.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,a,s,o){return vc(this,void 0,void 0,function(){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,j,I;return Xl(this,function(_){return this.ctx.save(),l=lSe(s,a),c=SQ(s,a),o===2&&(this.path(c),this.ctx.clip()),yd(c[0])?(u=c[0].start.x,d=c[0].start.y):(u=c[0].x,d=c[0].y),yd(c[1])?(f=c[1].end.x,A=c[1].end.y):(f=c[1].x,A=c[1].y),a===0||a===2?h=Math.abs(u-f):h=Math.abs(d-A),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(v=h/(2*m+p),m*=v,p*=v):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),w=(h-(y+1)*m)/y,p=w<=0||Math.abs(p-b)<Math.abs(p-w)?b:w),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Ho(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(yd(c[0])&&(j=c[3],I=c[0],this.ctx.beginPath(),this.formatPath([new Jr(j.end.x,j.end.y),new Jr(I.start.x,I.start.y)]),this.ctx.stroke()),yd(c[1])&&(j=c[1],I=c[2],this.ctx.beginPath(),this.formatPath([new Jr(j.end.x,j.end.y),new Jr(I.start.x,I.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return vc(this,void 0,void 0,function(){var n;return Xl(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ho(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=sSe(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(zte),gSe=function(t){return t instanceof Bte||t instanceof Pte?!0:t instanceof L6&&t.type!==_S&&t.type!==CS},xSe=function(t,e){switch(t){case 0:return IS(e);case 2:return ZEe(e);case 1:default:return jS(e)}},vSe=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},ySe=["-apple-system","system-ui"],bSe=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return ySe.indexOf(e)===-1}):t},wSe=function(t){Sf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return e.prototype.render=function(r){return vc(this,void 0,void 0,function(){var n,a;return Xl(this,function(s){switch(s.label){case 0:return n=Ek(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,NSe(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ho(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(zte),NSe=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},CSe=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,iC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,iC([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,iC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,iC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),_Se=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new CSe({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new GEe(this,e)}return t.instanceCount=1,t}(),Fg=function(t,e){return e===void 0&&(e={}),ESe(t,e)};typeof window<"u"&&Vte.setContext(window);var ESe=function(t,e){return vc(void 0,void 0,void 0,function(){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,_,I,_,S,E,B,T,P,O,z,ce,de,ue,me,se,ke,Re,F,H,K;return Xl(this,function(L){switch(L.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(S=e.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(E=e.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:e.proxy,useCORS:(B=e.useCORS)!==null&&B!==void 0?B:!1},s=dk({logging:(T=e.logging)!==null&&T!==void 0?T:!0,cache:e.cache},a),o={windowWidth:(P=e.windowWidth)!==null&&P!==void 0?P:n.innerWidth,windowHeight:(O=e.windowHeight)!==null&&O!==void 0?O:n.innerHeight,scrollX:(z=e.scrollX)!==null&&z!==void 0?z:n.pageXOffset,scrollY:(ce=e.scrollY)!==null&&ce!==void 0?ce:n.pageYOffset},l=new vA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new _Se(s,l),u=(de=e.foreignObjectRendering)!==null&&de!==void 0?de:!1,d={allowTaint:(ue=e.allowTaint)!==null&&ue!==void 0?ue:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:u,copyStyles:u},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new CQ(c,t,d),A=f.clonedReferenceElement,A?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=L.sent(),m=U6(A)||IEe(A)?awe(A.ownerDocument):qj(c,A),p=m.width,x=m.height,v=m.left,y=m.top,b=SSe(c,A,e.backgroundColor),w={canvas:e.canvas,backgroundColor:b,scale:(se=(me=e.scale)!==null&&me!==void 0?me:n.devicePixelRatio)!==null&&se!==void 0?se:1,x:((ke=e.x)!==null&&ke!==void 0?ke:0)+v,y:((Re=e.y)!==null&&Re!==void 0?Re:0)+y,width:(F=e.width)!==null&&F!==void 0?F:Math.ceil(p),height:(H=e.height)!==null&&H!==void 0?H:Math.ceil(x)},u?(c.logger.debug("Document cloned, using foreign object rendering"),_=new wSe(c,w),[4,_.render(A)]):[3,3];case 2:return j=L.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+v+","+y+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),I=Fte(c,A),b===I.styles.backgroundColor&&(I.styles.backgroundColor=sA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+w.x+","+w.y+" with size "+w.width+"x"+w.height),_=new pSe(c,w),[4,_.render(I)];case 4:j=L.sent(),L.label=5;case 5:return(!((K=e.removeContainer)!==null&&K!==void 0)||K)&&(CQ.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,j]}})})},SSe=function(t,e,r){var n=e.ownerDocument,a=n.documentElement?yb(t,getComputedStyle(n.documentElement).backgroundColor):sA.TRANSPARENT,s=n.body?yb(t,getComputedStyle(n.body).backgroundColor):sA.TRANSPARENT,o=typeof r=="string"?yb(t,r):r===null?sA.TRANSPARENT:4294967295;return e===n.documentElement?dm(a)?dm(s)?o:s:a:o};const Q6=Object.freeze(Object.defineProperty({__proto__:null,default:Fg},Symbol.toStringTag,{value:"Module"})),ISe="modulepreload",jSe=function(t){return"/"+t},jQ={},iA=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=jSe(c),c in jQ)return;jQ[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":ISe,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((A,h)=>{f.addEventListener("load",A),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function es(t){"@babel/helpers - typeof";return es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},es(t)}var Nf=Uint8Array,Ou=Uint16Array,V6=Int32Array,H6=new Nf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$6=new Nf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),PQ=new Nf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Wte=function(t,e){for(var r=new Ou(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new V6(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},Xte=Wte(H6,2),PSe=Xte.b,kk=Xte.r;PSe[28]=258,kk[258]=28;var BSe=Wte($6,0),BQ=BSe.r,Fk=new Ou(32768);for(var Bs=0;Bs<32768;++Bs){var d0=(Bs&43690)>>1|(Bs&21845)<<1;d0=(d0&52428)>>2|(d0&13107)<<2,d0=(d0&61680)>>4|(d0&3855)<<4,Fk[Bs]=((d0&65280)>>8|(d0&255)<<8)>>1}var Cb=function(t,e,r){for(var n=t.length,a=0,s=new Ou(e);a<n;++a)t[a]&&++s[t[a]-1];var o=new Ou(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new Ou(1<<e);var c=15-e;for(a=0;a<n;++a)if(t[a])for(var u=a<<4|t[a],d=e-t[a],f=o[t[a]-1]++<<d,A=f|(1<<d)-1;f<=A;++f)l[Fk[f]>>c]=u}else for(l=new Ou(n),a=0;a<n;++a)t[a]&&(l[a]=Fk[o[t[a]-1]++]>>15-t[a]);return l},ug=new Nf(288);for(var Bs=0;Bs<144;++Bs)ug[Bs]=8;for(var Bs=144;Bs<256;++Bs)ug[Bs]=9;for(var Bs=256;Bs<280;++Bs)ug[Bs]=7;for(var Bs=280;Bs<288;++Bs)ug[Bs]=8;var BS=new Nf(32);for(var Bs=0;Bs<32;++Bs)BS[Bs]=5;var TSe=Cb(ug,9,0),kSe=Cb(BS,5,0),Yte=function(t){return(t+7)/8|0},FSe=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Nf(t.subarray(e,r))},Sh=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Ay=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Y4=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,s=r.slice();if(!a)return{t:Zte,l:0};if(a==1){var o=new Nf(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(j,I){return j.f-I.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=a-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var A=s[0].s,n=1;n<a;++n)s[n].s>A&&(A=s[n].s);var h=new Ou(A+1),m=Ok(r[d-1],h,0);if(m>e){var n=0,p=0,x=m-e,v=1<<x;for(s.sort(function(I,_){return h[_.s]-h[I.s]||I.f-_.f});n<a;++n){var y=s[n].s;if(h[y]>e)p+=v-(1<<m-h[y]),h[y]=e;else break}for(p>>=x;p>0;){var b=s[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var w=s[n].s;h[w]==e&&(--h[w],++p)}m=e}return{t:new Nf(h),l:m}},Ok=function(t,e,r){return t.s==-1?Math.max(Ok(t.l,e,r+1),Ok(t.r,e,r+1)):e[t.s]=r},TQ=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ou(++e),n=0,a=t[0],s=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==a&&l!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[l]}return{c:r.subarray(0,n),n:e}},my=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},Jte=function(t,e,r){var n=r.length,a=Yte(e+2);t[a]=n&255,t[a+1]=n>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var s=0;s<n;++s)t[a+s+4]=r[s];return(a+4+n)*8},kQ=function(t,e,r,n,a,s,o,l,c,u,d){Sh(e,d++,r),++a[256];for(var f=Y4(a,15),A=f.t,h=f.l,m=Y4(s,15),p=m.t,x=m.l,v=TQ(A),y=v.c,b=v.n,w=TQ(p),j=w.c,I=w.n,_=new Ou(19),S=0;S<y.length;++S)++_[y[S]&31];for(var S=0;S<j.length;++S)++_[j[S]&31];for(var E=Y4(_,7),B=E.t,T=E.l,P=19;P>4&&!B[PQ[P-1]];--P);var O=u+5<<3,z=my(a,ug)+my(s,BS)+o,ce=my(a,A)+my(s,p)+o+14+3*P+my(_,B)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&O<=z&&O<=ce)return Jte(e,d,t.subarray(c,c+u));var de,ue,me,se;if(Sh(e,d,1+(ce<z)),d+=2,ce<z){de=Cb(A,h,0),ue=A,me=Cb(p,x,0),se=p;var ke=Cb(B,T,0);Sh(e,d,b-257),Sh(e,d+5,I-1),Sh(e,d+10,P-4),d+=14;for(var S=0;S<P;++S)Sh(e,d+3*S,B[PQ[S]]);d+=3*P;for(var Re=[y,j],F=0;F<2;++F)for(var H=Re[F],S=0;S<H.length;++S){var K=H[S]&31;Sh(e,d,ke[K]),d+=B[K],K>15&&(Sh(e,d,H[S]>>5&127),d+=H[S]>>12)}}else de=TSe,ue=ug,me=kSe,se=BS;for(var S=0;S<l;++S){var L=n[S];if(L>255){var K=L>>18&31;Ay(e,d,de[K+257]),d+=ue[K+257],K>7&&(Sh(e,d,L>>23&31),d+=H6[K]);var W=L&31;Ay(e,d,me[W]),d+=se[W],W>3&&(Ay(e,d,L>>5&8191),d+=$6[W])}else Ay(e,d,de[L]),d+=ue[L]}return Ay(e,d,de[256]),d+ue[256]},OSe=new V6([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Zte=new Nf(0),DSe=function(t,e,r,n,a,s){var o=s.z||t.length,l=new Nf(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,d=(s.r||0)&7;if(e){d&&(c[0]=s.r>>3);for(var f=OSe[e-1],A=f>>13,h=f&8191,m=(1<<r)-1,p=s.p||new Ou(32768),x=s.h||new Ou(m+1),v=Math.ceil(r/3),y=2*v,b=function(ae){return(t[ae]^t[ae+1]<<v^t[ae+2]<<y)&m},w=new V6(25e3),j=new Ou(288),I=new Ou(32),_=0,S=0,E=s.i||0,B=0,T=s.w||0,P=0;E+2<o;++E){var O=b(E),z=E&32767,ce=x[O];if(p[z]=ce,x[O]=z,T<=E){var de=o-E;if((_>7e3||B>24576)&&(de>423||!u)){d=kQ(t,c,0,w,j,I,S,B,P,E-P,d),B=_=S=0,P=E;for(var ue=0;ue<286;++ue)j[ue]=0;for(var ue=0;ue<30;++ue)I[ue]=0}var me=2,se=0,ke=h,Re=z-ce&32767;if(de>2&&O==b(E-Re))for(var F=Math.min(A,de)-1,H=Math.min(32767,E),K=Math.min(258,de);Re<=H&&--ke&&z!=ce;){if(t[E+me]==t[E+me-Re]){for(var L=0;L<K&&t[E+L]==t[E+L-Re];++L);if(L>me){if(me=L,se=Re,L>F)break;for(var W=Math.min(Re,L-2),Y=0,ue=0;ue<W;++ue){var D=E-Re+ue&32767,Q=p[D],ee=D-Q&32767;ee>Y&&(Y=ee,ce=D)}}}z=ce,ce=p[z],Re+=z-ce&32767}if(se){w[B++]=268435456|kk[me]<<18|BQ[se];var ve=kk[me]&31,M=BQ[se]&31;S+=H6[ve]+$6[M],++j[257+ve],++I[M],T=E+me,++_}else w[B++]=t[E],++j[t[E]]}}for(E=Math.max(E,T);E<o;++E)w[B++]=t[E],++j[t[E]];d=kQ(t,c,u,w,j,I,S,B,P,E-P,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=x,s.p=p,s.i=E,s.w=T)}else{for(var E=s.w||0;E<o+u;E+=65535){var Ye=E+65535;Ye>=o&&(c[d/8|0]=u,Ye=o),d=Jte(c,d+1,t.subarray(E,Ye))}s.i=o}return FSe(l,0,n+Yte(d)+a)},ere=function(){var t=1,e=0;return{p:function(r){for(var n=t,a=e,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}t=n,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},RSe=function(t,e,r,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Nf(s.length+t.length);o.set(s),o.set(t,s.length),t=o,a.w=s.length}return DSe(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,a)},tre=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},MSe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=ere();a.p(e.dictionary),tre(t,2,a.d())}};function Dk(t,e){e||(e={});var r=ere();r.p(t);var n=RSe(t,e,e.dictionary?6:2,4);return MSe(n,e),tre(n,n.length-4,r.d()),n}var LSe=typeof TextDecoder<"u"&&new TextDecoder,USe=0;try{LSe.decode(Zte,{stream:!0}),USe=1}catch{}function QSe(t){if(Array.isArray(t))return t}function VSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function FQ(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function HSe(t,e){if(t){if(typeof t=="string")return FQ(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?FQ(t,e):void 0}}function $Se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OQ(t,e){return QSe(t)||VSe(t,e)||HSe(t,e)||$Se()}function DQ(t,e="utf8"){return new TextDecoder(e).decode(t)}const GSe=new TextEncoder;function KSe(t){return GSe.encode(t)}const qSe=1024*8,zSe=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),J4={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class G6{constructor(e=qSe,r={}){Br(this,"buffer");Br(this,"byteLength");Br(this,"byteOffset");Br(this,"length");Br(this,"offset");Br(this,"lastWrittenByte");Br(this,"littleEndian");Br(this,"_data");Br(this,"_mark");Br(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const a=r.offset?r.offset>>>0:0,s=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof G6)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=J4[r].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===zSe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new J4[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new J4[r](s);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return DQ(this.readBytes(e))}decodeText(e=1,r="utf8"){return DQ(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(KSe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function g1(t){let e=t.length;for(;--e>=0;)t[e]=0}const WSe=3,XSe=258,rre=29,YSe=256,JSe=YSe+1+rre,nre=30,ZSe=512,eIe=new Array((JSe+2)*2);g1(eIe);const tIe=new Array(nre*2);g1(tIe);const rIe=new Array(ZSe);g1(rIe);const nIe=new Array(XSe-WSe+1);g1(nIe);const aIe=new Array(rre);g1(aIe);const sIe=new Array(nre);g1(sIe);const iIe=(t,e,r,n)=>{let a=t&65535|0,s=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+e[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var Rk=iIe;const oIe=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},lIe=new Uint32Array(oIe()),cIe=(t,e,r,n)=>{const a=lIe,s=n+r;t^=-1;for(let o=n;o<s;o++)t=t>>>8^a[(t^e[o])&255];return t^-1};var Rf=cIe,Mk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},are={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const uIe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var dIe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)uIe(r,n)&&(t[n]=r[n])}}return t},fIe=t=>{let e=0;for(let n=0,a=t.length;n<a;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,a=0,s=t.length;n<s;n++){let o=t[n];r.set(o,a),a+=o.length}return r},sre={assign:dIe,flattenChunks:fIe};let ire=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ire=!1}const E2=new Uint8Array(256);for(let t=0;t<256;t++)E2[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;E2[254]=E2[254]=1;var hIe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,a,s,o=t.length,l=0;for(a=0;a<o;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),s=0,a=0;s<l;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const AIe=(t,e)=>{if(e<65534&&t.subarray&&ire)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var mIe=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=t[n++];if(o<128){s[a++]=o;continue}let l=E2[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return AIe(s,a)},pIe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+E2[t[r]]>e?r:e},Lk={string2buf:hIe,buf2string:mIe,utf8border:pIe};function gIe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var xIe=gIe;const jC=16209,vIe=16191;var yIe=function(e,r){let n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,_,S,E,B;const T=e.state;n=e.next_in,E=e.input,a=n+(e.avail_in-5),s=e.next_out,B=e.output,o=s-(r-e.avail_out),l=s+(e.avail_out-257),c=T.dmax,u=T.wsize,d=T.whave,f=T.wnext,A=T.window,h=T.hold,m=T.bits,p=T.lencode,x=T.distcode,v=(1<<T.lenbits)-1,y=(1<<T.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=p[h&v];t:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w===0)B[s++]=b&65535;else if(w&16){j=b&65535,w&=15,w&&(m<w&&(h+=E[n++]<<m,m+=8),j+=h&(1<<w)-1,h>>>=w,m-=w),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=x[h&y];r:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w&16){if(I=b&65535,w&=15,m<w&&(h+=E[n++]<<m,m+=8,m<w&&(h+=E[n++]<<m,m+=8)),I+=h&(1<<w)-1,I>c){e.msg="invalid distance too far back",T.mode=jC;break e}if(h>>>=w,m-=w,w=s-o,I>w){if(w=I-w,w>d&&T.sane){e.msg="invalid distance too far back",T.mode=jC;break e}if(_=0,S=A,f===0){if(_+=u-w,w<j){j-=w;do B[s++]=A[_++];while(--w);_=s-I,S=B}}else if(f<w){if(_+=u+f-w,w-=f,w<j){j-=w;do B[s++]=A[_++];while(--w);if(_=0,f<j){w=f,j-=w;do B[s++]=A[_++];while(--w);_=s-I,S=B}}}else if(_+=f-w,w<j){j-=w;do B[s++]=A[_++];while(--w);_=s-I,S=B}for(;j>2;)B[s++]=S[_++],B[s++]=S[_++],B[s++]=S[_++],j-=3;j&&(B[s++]=S[_++],j>1&&(B[s++]=S[_++]))}else{_=s-I;do B[s++]=B[_++],B[s++]=B[_++],B[s++]=B[_++],j-=3;while(j>2);j&&(B[s++]=B[_++],j>1&&(B[s++]=B[_++]))}}else if(w&64){e.msg="invalid distance code",T.mode=jC;break e}else{b=x[(b&65535)+(h&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){T.mode=vIe;break e}else{e.msg="invalid literal/length code",T.mode=jC;break e}else{b=p[(b&65535)+(h&(1<<w)-1)];continue t}break}}while(n<a&&s<l);j=m>>3,n-=j,m-=j<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?5+(a-n):5-(n-a),e.avail_out=s<l?257+(l-s):257-(s-l),T.hold=h,T.bits=m};const cx=15,RQ=852,MQ=592,LQ=0,Z4=1,UQ=2,bIe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wIe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),NIe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),CIe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),_Ie=(t,e,r,n,a,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=0,b,w,j,I,_,S=null,E;const B=new Uint16Array(cx+1),T=new Uint16Array(cx+1);let P=null,O,z,ce;for(u=0;u<=cx;u++)B[u]=0;for(d=0;d<n;d++)B[e[r+d]]++;for(h=c,A=cx;A>=1&&B[A]===0;A--);if(h>A&&(h=A),A===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<A&&B[f]===0;f++);for(h<f&&(h=f),x=1,u=1;u<=cx;u++)if(x<<=1,x-=B[u],x<0)return-1;if(x>0&&(t===LQ||A!==1))return-1;for(T[1]=0,u=1;u<cx;u++)T[u+1]=T[u]+B[u];for(d=0;d<n;d++)e[r+d]!==0&&(o[T[e[r+d]]++]=d);if(t===LQ?(S=P=o,E=20):t===Z4?(S=bIe,P=wIe,E=257):(S=NIe,P=CIe,E=0),y=0,d=0,u=f,_=s,m=h,p=0,j=-1,v=1<<h,I=v-1,t===Z4&&v>RQ||t===UQ&&v>MQ)return 1;for(;;){O=u-p,o[d]+1<E?(z=0,ce=o[d]):o[d]>=E?(z=P[o[d]-E],ce=S[o[d]-E]):(z=96,ce=0),b=1<<u-p,w=1<<m,f=w;do w-=b,a[_+(y>>p)+w]=O<<24|z<<16|ce|0;while(w!==0);for(b=1<<u-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,d++,--B[u]===0){if(u===A)break;u=e[r+o[d]]}if(u>h&&(y&I)!==j){for(p===0&&(p=h),_+=f,m=u-p,x=1<<m;m+p<A&&(x-=B[m+p],!(x<=0));)m++,x<<=1;if(v+=1<<m,t===Z4&&v>RQ||t===UQ&&v>MQ)return 1;j=y&I,a[j]=h<<24|m<<16|_-s|0}}return y!==0&&(a[_+y]=u-p<<24|64<<16|0),l.bits=h,0};var _b=_Ie;const EIe=0,ore=1,lre=2,{Z_FINISH:QQ,Z_BLOCK:SIe,Z_TREES:PC,Z_OK:dg,Z_STREAM_END:IIe,Z_NEED_DICT:jIe,Z_STREAM_ERROR:Fd,Z_DATA_ERROR:cre,Z_MEM_ERROR:ure,Z_BUF_ERROR:PIe,Z_DEFLATED:VQ}=are,nP=16180,HQ=16181,$Q=16182,GQ=16183,KQ=16184,qQ=16185,zQ=16186,WQ=16187,XQ=16188,YQ=16189,TS=16190,Ih=16191,e5=16192,JQ=16193,t5=16194,ZQ=16195,eV=16196,tV=16197,rV=16198,BC=16199,TC=16200,nV=16201,aV=16202,sV=16203,iV=16204,oV=16205,r5=16206,lV=16207,cV=16208,Rs=16209,dre=16210,fre=16211,BIe=852,TIe=592,kIe=15,FIe=kIe,uV=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function OIe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Og=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<nP||e.mode>fre?1:0},hre=t=>{if(Og(t))return Fd;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=nP,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(BIe),e.distcode=e.distdyn=new Int32Array(TIe),e.sane=1,e.back=-1,dg},Are=t=>{if(Og(t))return Fd;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,hre(t)},mre=(t,e)=>{let r;if(Og(t))return Fd;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Fd:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Are(t))},pre=(t,e)=>{if(!t)return Fd;const r=new OIe;t.state=r,r.strm=t,r.window=null,r.mode=nP;const n=mre(t,e);return n!==dg&&(t.state=null),n},DIe=t=>pre(t,FIe);let dV=!0,n5,a5;const RIe=t=>{if(dV){n5=new Int32Array(512),a5=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(_b(ore,t.lens,0,288,n5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;_b(lre,t.lens,0,32,a5,0,t.work,{bits:5}),dV=!1}t.lencode=n5,t.lenbits=9,t.distcode=a5,t.distbits=5},gre=(t,e,r,n)=>{let a;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(e.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},MIe=(t,e)=>{let r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=0,v,y,b,w,j,I,_,S;const E=new Uint8Array(4);let B,T;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Og(t)||!t.output||!t.input&&t.avail_in!==0)return Fd;r=t.state,r.mode===Ih&&(r.mode=e5),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,f=l,A=c,S=dg;e:for(;;)switch(r.mode){case nP:if(r.wrap===0){r.mode=e5;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0),u=0,d=0,r.mode=HQ;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=Rs;break}if((u&15)!==VQ){t.msg="unknown compression method",r.mode=Rs;break}if(u>>>=4,d-=4,_=(u&15)+8,r.wbits===0&&(r.wbits=_),_>15||_>r.wbits){t.msg="invalid window size",r.mode=Rs;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?YQ:Ih,u=0,d=0;break;case HQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==VQ){t.msg="unknown compression method",r.mode=Rs;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Rs;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0)),u=0,d=0,r.mode=$Q;case $Q:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=Rf(r.check,E,4,0)),u=0,d=0,r.mode=GQ;case GQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0)),u=0,d=0,r.mode=KQ;case KQ:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Rf(r.check,E,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=qQ;case qQ:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),_)),r.flags&512&&r.wrap&4&&(r.check=Rf(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=zQ;case zQ:if(r.flags&2048){if(l===0)break e;h=0;do _=n[s+h++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Rf(r.check,n,h,s)),l-=h,s+=h,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=WQ;case WQ:if(r.flags&4096){if(l===0)break e;h=0;do _=n[s+h++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Rf(r.check,n,h,s)),l-=h,s+=h,_)break e}else r.head&&(r.head.comment=null);r.mode=XQ;case XQ:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Rs;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ih;break;case YQ:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.adler=r.check=uV(u),u=0,d=0,r.mode=TS;case TS:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,jIe;t.adler=r.check=1,r.mode=Ih;case Ih:if(e===SIe||e===PC)break e;case e5:if(r.last){u>>>=d&7,d-=d&7,r.mode=r5;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=JQ;break;case 1:if(RIe(r),r.mode=BC,e===PC){u>>>=2,d-=2;break e}break;case 2:r.mode=eV;break;case 3:t.msg="invalid block type",r.mode=Rs}u>>>=2,d-=2;break;case JQ:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Rs;break}if(r.length=u&65535,u=0,d=0,r.mode=t5,e===PC)break e;case t5:r.mode=ZQ;case ZQ:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=Ih;break;case eV:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Rs;break}r.have=0,r.mode=tV;case tV:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[P[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},S=_b(EIe,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid code lengths set",r.mode=Rs;break}r.have=0,r.mode=rV;case rV:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(b<16)u>>>=v,d-=v,r.lens[r.have++]=b;else{if(b===16){for(T=v+2;d<T;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=v,d-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=Rs;break}_=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(b===17){for(T=v+3;d<T;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,_=0,h=3+(u&7),u>>>=3,d-=3}else{for(T=v+7;d<T;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,_=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Rs;break}for(;h--;)r.lens[r.have++]=_}}if(r.mode===Rs)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Rs;break}if(r.lenbits=9,B={bits:r.lenbits},S=_b(ore,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid literal/lengths set",r.mode=Rs;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},S=_b(lre,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,S){t.msg="invalid distances set",r.mode=Rs;break}if(r.mode=BC,e===PC)break e;case BC:r.mode=TC;case TC:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,yIe(t,A),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,r.mode===Ih&&(r.back=-1);break}for(r.back=0;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(y&&!(y&240)){for(w=v,j=y,I=b;x=r.lencode[I+((u&(1<<w+j)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,r.length=b,y===0){r.mode=oV;break}if(y&32){r.back=-1,r.mode=Ih;break}if(y&64){t.msg="invalid literal/length code",r.mode=Rs;break}r.extra=y&15,r.mode=nV;case nV:if(r.extra){for(T=r.extra;d<T;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=aV;case aV:for(;x=r.distcode[u&(1<<r.distbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(y&240)){for(w=v,j=y,I=b;x=r.distcode[I+((u&(1<<w+j)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,y&64){t.msg="invalid distance code",r.mode=Rs;break}r.offset=b,r.extra=y&15,r.mode=sV;case sV:if(r.extra){for(T=r.extra;d<T;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Rs;break}r.mode=iV;case iV:if(c===0)break e;if(h=A-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Rs;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=a,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[o++]=p[m++];while(--h);r.length===0&&(r.mode=TC);break;case oV:if(c===0)break e;a[o++]=r.length,c--,r.mode=TC;break;case r5:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(A-=c,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Rf(r.check,a,A,o-A):Rk(r.check,a,A,o-A)),A=c,r.wrap&4&&(r.flags?u:uV(u))!==r.check){t.msg="incorrect data check",r.mode=Rs;break}u=0,d=0}r.mode=lV;case lV:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Rs;break}u=0,d=0}r.mode=cV;case cV:S=IIe;break e;case Rs:S=cre;break e;case dre:return ure;case fre:default:return Fd}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,(r.wsize||A!==t.avail_out&&r.mode<Rs&&(r.mode<r5||e!==QQ))&&gre(t,t.output,t.next_out,A-t.avail_out),f-=t.avail_in,A-=t.avail_out,t.total_in+=f,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Rf(r.check,a,A,t.next_out-A):Rk(r.check,a,A,t.next_out-A)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ih?128:0)+(r.mode===BC||r.mode===t5?256:0),(f===0&&A===0||e===QQ)&&S===dg&&(S=PIe),S},LIe=t=>{if(Og(t))return Fd;let e=t.state;return e.window&&(e.window=null),t.state=null,dg},UIe=(t,e)=>{if(Og(t))return Fd;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,dg):Fd},QIe=(t,e)=>{const r=e.length;let n,a,s;return Og(t)||(n=t.state,n.wrap!==0&&n.mode!==TS)?Fd:n.mode===TS&&(a=1,a=Rk(a,e,r,0),a!==n.check)?cre:(s=gre(t,e,r,r),s?(n.mode=dre,ure):(n.havedict=1,dg))};var VIe=Are,HIe=mre,$Ie=hre,GIe=DIe,KIe=pre,qIe=MIe,zIe=LIe,WIe=UIe,XIe=QIe,YIe="pako inflate (from Nodeca project)",Uh={inflateReset:VIe,inflateReset2:HIe,inflateResetKeep:$Ie,inflateInit:GIe,inflateInit2:KIe,inflate:qIe,inflateEnd:zIe,inflateGetHeader:WIe,inflateSetDictionary:XIe,inflateInfo:YIe};function JIe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ZIe=JIe;const xre=Object.prototype.toString,{Z_NO_FLUSH:eje,Z_FINISH:tje,Z_OK:S2,Z_STREAM_END:s5,Z_NEED_DICT:i5,Z_STREAM_ERROR:rje,Z_DATA_ERROR:fV,Z_MEM_ERROR:nje}=are;function Dw(t){this.options=sre.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new xIe,this.strm.avail_out=0;let r=Uh.inflateInit2(this.strm,e.windowBits);if(r!==S2)throw new Error(Mk[r]);if(this.header=new ZIe,Uh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Lk.string2buf(e.dictionary):xre.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Uh.inflateSetDictionary(this.strm,e.dictionary),r!==S2)))throw new Error(Mk[r])}Dw.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?tje:eje,xre.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Uh.inflate(r,o),s===i5&&a&&(s=Uh.inflateSetDictionary(r,a),s===S2?s=Uh.inflate(r,o):s===fV&&(s=i5));r.avail_in>0&&s===s5&&r.state.wrap>0&&t[r.next_in]!==0;)Uh.inflateReset(r),s=Uh.inflate(r,o);switch(s){case rje:case fV:case i5:case nje:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===s5))if(this.options.to==="string"){let c=Lk.utf8border(r.output,r.next_out),u=r.next_out-c,d=Lk.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===S2&&l===0)){if(s===s5)return s=Uh.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Dw.prototype.onData=function(t){this.chunks.push(t)};Dw.prototype.onEnd=function(t){t===S2&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=sre.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function aje(t,e){const r=new Dw(e);if(r.push(t),r.err)throw r.msg||Mk[r.err];return r.result}var sje=Dw,ije=aje,oje={Inflate:sje,inflate:ije};const{Inflate:lje,inflate:cje}=oje;var hV=lje,uje=cje;const vre=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;vre[t]=e}const AV=4294967295;function dje(t,e,r){let n=t;for(let a=0;a<r;a++)n=vre[(n^e[a])&255]^n>>>8;return n}function fje(t,e){return(dje(AV,t,e)^AV)>>>0}function mV(t,e,r){const n=t.readUint32(),a=fje(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function yre(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function bre(t,e,r,n){let a=0;for(;a<n;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-n]&255}function wre(t,e,r,n){let a=0;if(r.length===0)for(;a<n;a++)e[a]=t[a];else for(;a<n;a++)e[a]=t[a]+r[a]&255}function Nre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-a]>>1)&255}else{for(;s<a;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-a]+r[s]>>1)&255}}function Cre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-a]&255}else{for(;s<a;s++)e[s]=t[s]+r[s]&255;for(;s<n;s++)e[s]=t[s]+hje(e[s-a],r[s],r[s-a])&255}}function hje(t,e,r){const n=t+e-r,a=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-r);return a<=s&&a<=o?t:s<=o?e:r}function Aje(t,e,r,n,a,s){switch(t){case 0:yre(e,r,a);break;case 1:bre(e,r,a,s);break;case 2:wre(e,r,n,a);break;case 3:Nre(e,r,n,a,s);break;case 4:Cre(e,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const mje=new Uint16Array([255]),pje=new Uint8Array(mje.buffer),gje=pje[0]===255;function xje(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],A=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(A<=0||h<=0)continue;const m=A*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const v=e[u++],y=e.subarray(u,u+m);u+=m;const b=new Uint8Array(m);Aje(v,y,b,p,m,l),p.set(b);for(let w=0;w<A;w++){const j=f.x+w*f.xStep,I=f.y+x*f.yStep;if(!(j>=r||I>=n))for(let _=0;_<l;_++)c[(I*r+j)*l+_]=b[w*l+_]}}}if(s===16){const d=new Uint16Array(c.buffer);if(gje)for(let f=0;f<d.length;f++)d[f]=vje(d[f]);return d}else return c}function vje(t){return(t&255)<<8|t>>8&255}const yje=new Uint16Array([255]),bje=new Uint8Array(yje.buffer),wje=bje[0]===255,Nje=new Uint8Array(0);function pV(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let u=Nje,d=0,f,A;for(let h=0;h<n;h++){switch(f=e.subarray(d+1,d+1+l),A=c.subarray(h*l,(h+1)*l),e[d]){case 0:yre(f,A,l);break;case 1:bre(f,A,l,o);break;case 2:wre(f,A,u,l);break;case 3:Nre(f,A,u,l,o);break;case 4:Cre(f,A,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}u=A,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(wje)for(let m=0;m<h.length;m++)h[m]=Cje(h[m]);return h}else return c}function Cje(t){return(t&255)<<8|t>>8&255}const mE=Uint8Array.of(137,80,78,71,13,10,26,10);function gV(t){if(!_je(t.readBytes(mE.length)))throw new Error("wrong PNG signature")}function _je(t){if(t.length<mE.length)return!1;for(let e=0;e<mE.length;e++)if(t[e]!==mE[e])return!1;return!0}const Eje="tEXt",Sje=0,_re=new TextDecoder("latin1");function Ije(t){if(Pje(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const jje=/^[\u0000-\u00FF]*$/;function Pje(t){if(!jje.test(t))throw new Error("invalid latin1 text")}function Bje(t,e,r){const n=Ere(e);t[n]=Tje(e,r-n.length-1)}function Ere(t){for(t.mark();t.readByte()!==Sje;);const e=t.offset;t.reset();const r=_re.decode(t.readBytes(e-t.offset-1));return t.skip(1),Ije(r),r}function Tje(t,e){return _re.decode(t.readBytes(e))}const wu={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},o5={UNKNOWN:-1,DEFLATE:0},xV={UNKNOWN:-1,ADAPTIVE:0},l5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},kC={NONE:0,BACKGROUND:1,PREVIOUS:2},c5={SOURCE:0,OVER:1};class kje extends G6{constructor(r,n={}){super(r);Br(this,"_checkCrc");Br(this,"_inflator");Br(this,"_png");Br(this,"_apng");Br(this,"_end");Br(this,"_hasPalette");Br(this,"_palette");Br(this,"_hasTransparency");Br(this,"_transparency");Br(this,"_compressionMethod");Br(this,"_filterMethod");Br(this,"_interlaceMethod");Br(this,"_colorType");Br(this,"_isAnimated");Br(this,"_numberOfFrames");Br(this,"_numberOfPlays");Br(this,"_frames");Br(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new hV,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=o5.UNKNOWN,this._filterMethod=xV.UNKNOWN,this._interlaceMethod=l5.UNKNOWN,this._colorType=wu.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(gV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(gV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Eje:Bje(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?mV(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?mV(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Fje(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case wu.GREYSCALE:a=1;break;case wu.TRUECOLOUR:a=3;break;case wu.INDEXED_COLOUR:a=1;break;case wu.GREYSCALE_ALPHA:a=2;break;case wu.TRUECOLOUR_ALPHA:a=4;break;case wu.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==o5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case wu.GREYSCALE:case wu.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case wu.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case wu.UNKNOWN:case wu.GREYSCALE_ALPHA:case wu.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Ere(this),a=this.readUint8();if(a!==o5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:uje(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=pV({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case kC.NONE:break;case kC.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case kC.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case c5.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case c5.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/a,A=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*A+(1-f)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==xV.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===l5.NO_INTERLACE)this._png.data=pV({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===l5.ADAM7)this._png.data=xje({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:kC.NONE,blendOp:c5.SOURCE,data:r}),this._inflator=new hV,this._writingDataChunks=!1}}function Fje(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var vV;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(vV||(vV={}));function Oje(t,e){return new kje(t,e).decode()}var Mn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function u5(){Mn.console&&typeof Mn.console.log=="function"&&Mn.console.log.apply(Mn.console,arguments)}var hs={log:u5,warn:function(t){Mn.console&&(typeof Mn.console.warn=="function"?Mn.console.warn.apply(Mn.console,arguments):u5.call(null,arguments))},error:function(t){Mn.console&&(typeof Mn.console.error=="function"?Mn.console.error.apply(Mn.console,arguments):u5(t))}};function d5(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){cp(n.response,e,r)},n.onerror=function(){hs.error("could not download file")},n.send()}function yV(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function FC(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var cp=Mn.saveAs||((typeof window>"u"?"undefined":es(window))!=="object"||window!==Mn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Mn.URL||Mn.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?yV(a.href)?d5(t,e,r):FC(a,a.target="_blank"):FC(a)):(a.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){FC(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(yV(t))d5(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){FC(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:es(s)!=="object"&&(hs.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return d5(t,e,r);var a=t.type==="application/octet-stream",s=/constructor/i.test(Mn.HTMLElement)||Mn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":es(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=Mn.URL||Mn.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Sre(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var pE=Mn.atob.bind(Mn),bV=Mn.btoa.bind(Mn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function f5(t,e){var r=t[0],n=t[1],a=t[2],s=t[3];r=Ql(r,n,a,s,e[0],7,-680876936),s=Ql(s,r,n,a,e[1],12,-389564586),a=Ql(a,s,r,n,e[2],17,606105819),n=Ql(n,a,s,r,e[3],22,-1044525330),r=Ql(r,n,a,s,e[4],7,-176418897),s=Ql(s,r,n,a,e[5],12,1200080426),a=Ql(a,s,r,n,e[6],17,-1473231341),n=Ql(n,a,s,r,e[7],22,-45705983),r=Ql(r,n,a,s,e[8],7,1770035416),s=Ql(s,r,n,a,e[9],12,-1958414417),a=Ql(a,s,r,n,e[10],17,-42063),n=Ql(n,a,s,r,e[11],22,-1990404162),r=Ql(r,n,a,s,e[12],7,1804603682),s=Ql(s,r,n,a,e[13],12,-40341101),a=Ql(a,s,r,n,e[14],17,-1502002290),r=Vl(r,n=Ql(n,a,s,r,e[15],22,1236535329),a,s,e[1],5,-165796510),s=Vl(s,r,n,a,e[6],9,-1069501632),a=Vl(a,s,r,n,e[11],14,643717713),n=Vl(n,a,s,r,e[0],20,-373897302),r=Vl(r,n,a,s,e[5],5,-701558691),s=Vl(s,r,n,a,e[10],9,38016083),a=Vl(a,s,r,n,e[15],14,-660478335),n=Vl(n,a,s,r,e[4],20,-405537848),r=Vl(r,n,a,s,e[9],5,568446438),s=Vl(s,r,n,a,e[14],9,-1019803690),a=Vl(a,s,r,n,e[3],14,-187363961),n=Vl(n,a,s,r,e[8],20,1163531501),r=Vl(r,n,a,s,e[13],5,-1444681467),s=Vl(s,r,n,a,e[2],9,-51403784),a=Vl(a,s,r,n,e[7],14,1735328473),r=Hl(r,n=Vl(n,a,s,r,e[12],20,-1926607734),a,s,e[5],4,-378558),s=Hl(s,r,n,a,e[8],11,-2022574463),a=Hl(a,s,r,n,e[11],16,1839030562),n=Hl(n,a,s,r,e[14],23,-35309556),r=Hl(r,n,a,s,e[1],4,-1530992060),s=Hl(s,r,n,a,e[4],11,1272893353),a=Hl(a,s,r,n,e[7],16,-155497632),n=Hl(n,a,s,r,e[10],23,-1094730640),r=Hl(r,n,a,s,e[13],4,681279174),s=Hl(s,r,n,a,e[0],11,-358537222),a=Hl(a,s,r,n,e[3],16,-722521979),n=Hl(n,a,s,r,e[6],23,76029189),r=Hl(r,n,a,s,e[9],4,-640364487),s=Hl(s,r,n,a,e[12],11,-421815835),a=Hl(a,s,r,n,e[15],16,530742520),r=$l(r,n=Hl(n,a,s,r,e[2],23,-995338651),a,s,e[0],6,-198630844),s=$l(s,r,n,a,e[7],10,1126891415),a=$l(a,s,r,n,e[14],15,-1416354905),n=$l(n,a,s,r,e[5],21,-57434055),r=$l(r,n,a,s,e[12],6,1700485571),s=$l(s,r,n,a,e[3],10,-1894986606),a=$l(a,s,r,n,e[10],15,-1051523),n=$l(n,a,s,r,e[1],21,-2054922799),r=$l(r,n,a,s,e[8],6,1873313359),s=$l(s,r,n,a,e[15],10,-30611744),a=$l(a,s,r,n,e[6],15,-1560198380),n=$l(n,a,s,r,e[13],21,1309151649),r=$l(r,n,a,s,e[4],6,-145523070),s=$l(s,r,n,a,e[11],10,-1120210379),a=$l(a,s,r,n,e[2],15,718787259),n=$l(n,a,s,r,e[9],21,-343485551),t[0]=z0(r,t[0]),t[1]=z0(n,t[1]),t[2]=z0(a,t[2]),t[3]=z0(s,t[3])}function aP(t,e,r,n,a,s){return e=z0(z0(e,t),z0(n,s)),z0(e<<a|e>>>32-a,r)}function Ql(t,e,r,n,a,s,o){return aP(e&r|~e&n,t,e,a,s,o)}function Vl(t,e,r,n,a,s,o){return aP(e&n|r&~n,t,e,a,s,o)}function Hl(t,e,r,n,a,s,o){return aP(e^r^n,t,e,a,s,o)}function $l(t,e,r,n,a,s,o){return aP(r^(e|~n),t,e,a,s,o)}function Ire(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)f5(n,Dje(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(f5(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*r,f5(n,a),n}function Dje(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var wV="0123456789abcdef".split("");function Rje(t){for(var e="",r=0;r<4;r++)e+=wV[t>>8*r+4&15]+wV[t>>8*r&15];return e}function Mje(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Uk(t){return Ire(t).map(Mje).join("")}var Lje=function(t){for(var e=0;e<t.length;e++)t[e]=Rje(t[e]);return t.join("")}(Ire("hello"))!="5d41402abc4b2a76b9719d911017c592";function z0(t,e){if(Lje){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Qk(t,e){var r,n,a,s;if(t!==r){for(var o=(a=t,s=1+(256/t.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var f=e.length,A=0,h=0,m="";for(c=0;c<f;c++)h=(h+(d=l[A=(A+1)%256]))%256,l[A]=l[h],l[h]=d,o=l[(l[A]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var NV={print:4,modify:8,copy:16,"annot-forms":32};function Bx(t,e,r,n){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(NV.perm!==void 0)throw new Error("Invalid permission: "+l);a+=NV[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=Uk(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Qk(this.encryptionKey,this.padding)}function Tx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var a=t.charCodeAt(n);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[n]}return e}function CV(t){if(es(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[r]){var o=e[r][s];try{o[0].apply(t,n)}catch(l){Mn.console&&hs.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function I2(t){if(!(this instanceof I2))return new I2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function jre(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function L0(t,e,r,n,a){if(!(this instanceof L0))return new L0(t,e,r,n,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,jre.call(this,n,a)}function _p(t,e,r,n,a){if(!(this instanceof _p))return new _p(t,e,r,n,a);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,jre.call(this,n,a)}function rn(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;es(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,a=t.format||a,s=t.compress||t.compressPdf||s,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,A={},h={internal:{},__private__:{}};h.__private__.PubSub=CV;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(R){m=R};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var v=h.__private__.getPageFormat=function(R){return x[R]};a=a||"a4";var y="compat",b="advanced",w=y;function j(){this.saveGraphicsState(),X(new Me(Ne,0,0,-Ne,0,fo()*Ne).toString()+" cm"),this.setFontSize(this.getFontSize()/Ne),u="n",w=b}function I(){this.restoreGraphicsState(),u="S",w=y}var _=h.__private__.combineFontStyleAndFontWeight=function(R,je){if(R=="bold"&&je=="normal"||R=="bold"&&je==400||R=="normal"&&je=="italic"||R=="bold"&&je=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return je&&(R=je==400||je==="normal"?R==="italic"?"italic":"normal":je!=700&&je!=="bold"||R!=="normal"?(je==700?"bold":je)+""+R:"bold"),R};h.advancedAPI=function(R){var je=w===y;return je&&j.call(this),typeof R!="function"||(R(this),je&&I.call(this)),this},h.compatAPI=function(R){var je=w===b;return je&&I.call(this),typeof R!="function"||(R(this),je&&j.call(this)),this},h.isAdvancedAPI=function(){return w===b};var S,E=function(R){if(w!==b)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=h.roundToPrecision=h.__private__.roundToPrecision=function(R,je){var ut=e||je;if(isNaN(R)||isNaN(ut))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(ut).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf=typeof c=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return B(R,c)}:c==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return B(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return B(R,16)};var T=h.f2=h.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return B(R,2)},P=h.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return B(R,3)},O=h.scale=h.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return w===y?R*Ne:w===b?R:void 0},z=function(R){return O(function(je){return w===y?fo()-je:w===b?je:void 0}(R))};h.__private__.setPrecision=h.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(e=parseInt(R,10))};var ce,de="00000000000000000000000000000000",ue=h.__private__.getFileId=function(){return de},me=h.__private__.setFileId=function(R){return de=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():de.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(zr=new Bx(d.userPermissions,d.userPassword,d.ownerPassword,de)),de};h.setFileId=function(R){return me(R),this},h.getFileId=function(){return ue()};var se=h.__private__.convertDateToPDFDate=function(R){var je=R.getTimezoneOffset(),ut=je<0?"+":"-",wt=Math.floor(Math.abs(je/60)),Vt=Math.abs(je%60),Ar=[ut,K(wt),"'",K(Vt),"'"].join("");return["D:",R.getFullYear(),K(R.getMonth()+1),K(R.getDate()),K(R.getHours()),K(R.getMinutes()),K(R.getSeconds()),Ar].join("")},ke=h.__private__.convertPDFDateToDate=function(R){var je=parseInt(R.substr(2,4),10),ut=parseInt(R.substr(6,2),10)-1,wt=parseInt(R.substr(8,2),10),Vt=parseInt(R.substr(10,2),10),Ar=parseInt(R.substr(12,2),10),wr=parseInt(R.substr(14,2),10);return new Date(je,ut,wt,Vt,Ar,wr,0)},Re=h.__private__.setCreationDate=function(R){var je;if(R===void 0&&(R=new Date),R instanceof Date)je=se(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");je=R}return ce=je},F=h.__private__.getCreationDate=function(R){var je=ce;return R==="jsDate"&&(je=ke(ce)),je};h.setCreationDate=function(R){return Re(R),this},h.getCreationDate=function(R){return F(R)};var H,K=h.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},L=h.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},W=0,Y=[],D=[],Q=0,ee=[],ve=[],M=!1,Ye=D;h.__private__.setCustomOutputDestination=function(R){M=!0,Ye=R};var ae=function(R){M||(Ye=R)};h.__private__.resetCustomOutputDestination=function(){M=!1,Ye=D};var X=h.__private__.out=function(R){return R=R.toString(),Q+=R.length+1,Ye.push(R),Ye},De=h.__private__.write=function(R){return X(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},le=h.__private__.getArrayBuffer=function(R){for(var je=R.length,ut=new ArrayBuffer(je),wt=new Uint8Array(ut);je--;)wt[je]=R.charCodeAt(je);return ut},$e=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return $e};var Xe=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(R){return Xe=w===b?R/Ne:R,this};var it,xt=h.__private__.getFontSize=h.getFontSize=function(){return w===y?Xe:Xe*Ne},jt=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(R){return jt=R,this},h.__private__.getR2L=h.getR2L=function(){return jt};var Mt,Ft=h.__private__.setZoomMode=function(R){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))it=R;else if(isNaN(R)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');it=R}else it=parseInt(R,10)};h.__private__.getZoomMode=function(){return it};var $t,kt=h.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');Mt=R};h.__private__.getPageMode=function(){return Mt};var Ge=h.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');$t=R};h.__private__.getLayoutMode=function(){return $t},h.__private__.setDisplayMode=h.setDisplayMode=function(R,je,ut){return Ft(R),Ge(je),kt(ut),this};var ie={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(R){if(Object.keys(ie).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ie[R]},h.__private__.getDocumentProperties=function(){return ie},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(R){for(var je in ie)ie.hasOwnProperty(je)&&R[je]&&(ie[je]=R[je]);return this},h.__private__.setDocumentProperty=function(R,je){if(Object.keys(ie).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ie[R]=je};var Ue,Ne,be,Ce,Le,Ae={},We={},ct=[],_t={},pe={},Pe={},Ee={},Ze=null,xe=0,Se=[],gt=new CV(h),Et=t.hotfixes||[],Nt={},Tt={},Lt=[],Me=function R(je,ut,wt,Vt,Ar,wr){if(!(this instanceof R))return new R(je,ut,wt,Vt,Ar,wr);isNaN(je)&&(je=1),isNaN(ut)&&(ut=0),isNaN(wt)&&(wt=0),isNaN(Vt)&&(Vt=1),isNaN(Ar)&&(Ar=0),isNaN(wr)&&(wr=0),this._matrix=[je,ut,wt,Vt,Ar,wr]};Object.defineProperty(Me.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Me.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Me.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Me.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Me.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Me.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Me.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Me.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Me.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Me.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Me.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Me.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Me.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Me.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Me.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Me.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Me.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(R)},Me.prototype.multiply=function(R){var je=R.sx*this.sx+R.shy*this.shx,ut=R.sx*this.shy+R.shy*this.sy,wt=R.shx*this.sx+R.sy*this.shx,Vt=R.shx*this.shy+R.sy*this.sy,Ar=R.tx*this.sx+R.ty*this.shx+this.tx,wr=R.tx*this.shy+R.ty*this.sy+this.ty;return new Me(je,ut,wt,Vt,Ar,wr)},Me.prototype.decompose=function(){var R=this.sx,je=this.shy,ut=this.shx,wt=this.sy,Vt=this.tx,Ar=this.ty,wr=Math.sqrt(R*R+je*je),nn=(R/=wr)*ut+(je/=wr)*wt;ut-=R*nn,wt-=je*nn;var un=Math.sqrt(ut*ut+wt*wt);return nn/=un,R*(wt/=un)<je*(ut/=un)&&(R=-R,je=-je,nn=-nn,wr=-wr),{scale:new Me(wr,0,0,un,0,0),translate:new Me(1,0,0,1,Vt,Ar),rotate:new Me(R,je,-je,R,0,0),skew:new Me(1,0,nn,1,0,0)}},Me.prototype.toString=function(R){return this.join(" ")},Me.prototype.inversed=function(){var R=this.sx,je=this.shy,ut=this.shx,wt=this.sy,Vt=this.tx,Ar=this.ty,wr=1/(R*wt-je*ut),nn=wt*wr,un=-je*wr,Tn=-ut*wr,Vn=R*wr;return new Me(nn,un,Tn,Vn,-nn*Vt-Tn*Ar,-un*Vt-Vn*Ar)},Me.prototype.applyToPoint=function(R){var je=R.x*this.sx+R.y*this.shx+this.tx,ut=R.x*this.shy+R.y*this.sy+this.ty;return new Ol(je,ut)},Me.prototype.applyToRectangle=function(R){var je=this.applyToPoint(R),ut=this.applyToPoint(new Ol(R.x+R.w,R.y+R.h));return new Zi(je.x,je.y,ut.x-je.x,ut.y-je.y)},Me.prototype.clone=function(){var R=this.sx,je=this.shy,ut=this.shx,wt=this.sy,Vt=this.tx,Ar=this.ty;return new Me(R,je,ut,wt,Vt,Ar)},h.Matrix=Me;var _e=h.matrixMult=function(R,je){return je.multiply(R)},U=new Me(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=U;var ye=function(R,je){if(!pe[R]){var ut=(je instanceof L0?"Sh":"P")+(Object.keys(_t).length+1).toString(10);je.id=ut,pe[R]=ut,_t[ut]=je,gt.publish("addPattern",je)}};h.ShadingPattern=L0,h.TilingPattern=_p,h.addShadingPattern=function(R,je){return E("addShadingPattern()"),ye(R,je),this},h.beginTilingPattern=function(R){E("beginTilingPattern()"),Mc(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},h.endTilingPattern=function(R,je){E("endTilingPattern()"),je.stream=ve[H].join(`
`),ye(R,je),gt.publish("endTilingPattern",je),Lt.pop().restore()};var te,Ve=h.__private__.newObject=function(){var R=qe();return G(R,!0),R},qe=h.__private__.newObjectDeferred=function(){return W++,Y[W]=function(){return Q},W},G=function(R,je){return je=typeof je=="boolean"&&je,Y[R]=Q,je&&X(R+" 0 obj"),R},V=h.__private__.newAdditionalObject=function(){var R={objId:qe(),content:""};return ee.push(R),R},Z=qe(),re=qe(),we=h.__private__.decodeColorString=function(R){var je=R.split(" ");if(je.length!==2||je[1]!=="g"&&je[1]!=="G")je.length!==5||je[4]!=="k"&&je[4]!=="K"||(je=[(1-je[0])*(1-je[3]),(1-je[1])*(1-je[3]),(1-je[2])*(1-je[3]),"r"]);else{var ut=parseFloat(je[0]);je=[ut,ut,ut,"r"]}for(var wt="#",Vt=0;Vt<3;Vt++)wt+=("0"+Math.floor(255*parseFloat(je[Vt])).toString(16)).slice(-2);return wt},Fe=h.__private__.encodeColorString=function(R){var je;typeof R=="string"&&(R={ch1:R});var ut=R.ch1,wt=R.ch2,Vt=R.ch3,Ar=R.ch4,wr=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ut=="string"&&ut.charAt(0)!=="#"){var nn=new Sre(ut);if(nn.ok)ut=nn.toHex();else if(!/^\d*\.?\d*$/.test(ut))throw new Error('Invalid color "'+ut+'" passed to jsPDF.encodeColorString.')}if(typeof ut=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ut)&&(ut="#"+ut[1]+ut[1]+ut[2]+ut[2]+ut[3]+ut[3]),typeof ut=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ut)){var un=parseInt(ut.substr(1),16);ut=un>>16&255,wt=un>>8&255,Vt=255&un}if(wt===void 0||Ar===void 0&&ut===wt&&wt===Vt)je=typeof ut=="string"?ut+" "+wr[0]:R.precision===2?T(ut/255)+" "+wr[0]:P(ut/255)+" "+wr[0];else if(Ar===void 0||es(Ar)==="object"){if(Ar&&!isNaN(Ar.a)&&Ar.a===0)return["1.","1.","1.",wr[1]].join(" ");je=typeof ut=="string"?[ut,wt,Vt,wr[1]].join(" "):R.precision===2?[T(ut/255),T(wt/255),T(Vt/255),wr[1]].join(" "):[P(ut/255),P(wt/255),P(Vt/255),wr[1]].join(" ")}else je=typeof ut=="string"?[ut,wt,Vt,Ar,wr[2]].join(" "):R.precision===2?[T(ut),T(wt),T(Vt),T(Ar),wr[2]].join(" "):[P(ut),P(wt),P(Vt),P(Ar),wr[2]].join(" ");return je},st=h.__private__.getFilters=function(){return o},Be=h.__private__.putStream=function(R){var je=(R=R||{}).data||"",ut=R.filters||st(),wt=R.alreadyAppliedFilters||[],Vt=R.addLength1||!1,Ar=je.length,wr=R.objectId,nn=function(pi){return pi};if(d!==null&&wr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(nn=zr.encryptor(wr,0));var un={};ut===!0&&(ut=["FlateEncode"]);var Tn=R.additionalKeyValues||[],Vn=(un=rn.API.processDataByFilters!==void 0?rn.API.processDataByFilters(je,ut):{data:je,reverseChain:[]}).reverseChain+(Array.isArray(wt)?wt.join(" "):wt.toString());if(un.data.length!==0&&(Tn.push({key:"Length",value:un.data.length}),Vt===!0&&Tn.push({key:"Length1",value:Ar})),Vn.length!=0)if(Vn.split("/").length-1==1)Tn.push({key:"Filter",value:Vn});else{Tn.push({key:"Filter",value:"["+Vn+"]"});for(var da=0;da<Tn.length;da+=1)if(Tn[da].key==="DecodeParms"){for(var ka=[],Ys=0;Ys<un.reverseChain.split("/").length-1;Ys+=1)ka.push("null");ka.push(Tn[da].value),Tn[da].value="["+ka.join(" ")+"]"}}X("<<");for(var Va=0;Va<Tn.length;Va++)X("/"+Tn[Va].key+" "+Tn[Va].value);X(">>"),un.data.length!==0&&(X("stream"),X(nn(un.data)),X("endstream"))},at=h.__private__.putPage=function(R){var je=R.number,ut=R.data,wt=R.objId,Vt=R.contentsObjId;G(wt,!0),X("<</Type /Page"),X("/Parent "+R.rootDictionaryObjId+" 0 R"),X("/Resources "+R.resourceDictionaryObjId+" 0 R"),X("/MediaBox ["+parseFloat(S(R.mediaBox.bottomLeftX))+" "+parseFloat(S(R.mediaBox.bottomLeftY))+" "+S(R.mediaBox.topRightX)+" "+S(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&X("/CropBox ["+S(R.cropBox.bottomLeftX)+" "+S(R.cropBox.bottomLeftY)+" "+S(R.cropBox.topRightX)+" "+S(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&X("/BleedBox ["+S(R.bleedBox.bottomLeftX)+" "+S(R.bleedBox.bottomLeftY)+" "+S(R.bleedBox.topRightX)+" "+S(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&X("/TrimBox ["+S(R.trimBox.bottomLeftX)+" "+S(R.trimBox.bottomLeftY)+" "+S(R.trimBox.topRightX)+" "+S(R.trimBox.topRightY)+"]"),R.artBox!==null&&X("/ArtBox ["+S(R.artBox.bottomLeftX)+" "+S(R.artBox.bottomLeftY)+" "+S(R.artBox.topRightX)+" "+S(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&X("/UserUnit "+R.userUnit),gt.publish("putPage",{objId:wt,pageContext:Se[je],pageNumber:je,page:ut}),X("/Contents "+Vt+" 0 R"),X(">>"),X("endobj");var Ar=ut.join(`
`);return w===b&&(Ar+=`
Q`),G(Vt,!0),Be({data:Ar,filters:st(),objectId:Vt}),X("endobj"),wt},lt=h.__private__.putPages=function(){var R,je,ut=[];for(R=1;R<=xe;R++)Se[R].objId=qe(),Se[R].contentsObjId=qe();for(R=1;R<=xe;R++)ut.push(at({number:R,data:ve[R],objId:Se[R].objId,contentsObjId:Se[R].contentsObjId,mediaBox:Se[R].mediaBox,cropBox:Se[R].cropBox,bleedBox:Se[R].bleedBox,trimBox:Se[R].trimBox,artBox:Se[R].artBox,userUnit:Se[R].userUnit,rootDictionaryObjId:Z,resourceDictionaryObjId:re}));G(Z,!0),X("<</Type /Pages");var wt="/Kids [";for(je=0;je<xe;je++)wt+=ut[je]+" 0 R ";X(wt+"]"),X("/Count "+xe),X(">>"),X("endobj"),gt.publish("postPutPages")},dt=function(R){gt.publish("putFont",{font:R,out:X,newObject:Ve,putStream:Be}),R.isAlreadyPutted!==!0&&(R.objectNumber=Ve(),X("<<"),X("/Type /Font"),X("/BaseFont /"+Tx(R.postScriptName)),X("/Subtype /Type1"),typeof R.encoding=="string"&&X("/Encoding /"+R.encoding),X("/FirstChar 32"),X("/LastChar 255"),X(">>"),X("endobj"))},Pt=function(R){R.objectNumber=Ve();var je=[];je.push({key:"Type",value:"/XObject"}),je.push({key:"Subtype",value:"/Form"}),je.push({key:"BBox",value:"["+[S(R.x),S(R.y),S(R.x+R.width),S(R.y+R.height)].join(" ")+"]"}),je.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var ut=R.pages[1].join(`
`);Be({data:ut,additionalKeyValues:je,objectId:R.objectNumber}),X("endobj")},he=function(R,je){je||(je=21);var ut=Ve(),wt=function(wr,nn){var un,Tn=[],Vn=1/(nn-1);for(un=0;un<1;un+=Vn)Tn.push(un);if(Tn.push(1),wr[0].offset!=0){var da={offset:0,color:wr[0].color};wr.unshift(da)}if(wr[wr.length-1].offset!=1){var ka={offset:1,color:wr[wr.length-1].color};wr.push(ka)}for(var Ys="",Va=0,pi=0;pi<Tn.length;pi++){for(un=Tn[pi];un>wr[Va+1].offset;)Va++;var Js=wr[Va].offset,gi=(un-Js)/(wr[Va+1].offset-Js),Zs=wr[Va].color,Uc=wr[Va+1].color;Ys+=L(Math.round((1-gi)*Zs[0]+gi*Uc[0]).toString(16))+L(Math.round((1-gi)*Zs[1]+gi*Uc[1]).toString(16))+L(Math.round((1-gi)*Zs[2]+gi*Uc[2]).toString(16))}return Ys.trim()}(R.colors,je),Vt=[];Vt.push({key:"FunctionType",value:"0"}),Vt.push({key:"Domain",value:"[0.0 1.0]"}),Vt.push({key:"Size",value:"["+je+"]"}),Vt.push({key:"BitsPerSample",value:"8"}),Vt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Vt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Be({data:wt,additionalKeyValues:Vt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ut}),X("endobj"),R.objectNumber=Ve(),X("<< /ShadingType "+R.type),X("/ColorSpace /DeviceRGB");var Ar="/Coords ["+S(parseFloat(R.coords[0]))+" "+S(parseFloat(R.coords[1]))+" ";R.type===2?Ar+=S(parseFloat(R.coords[2]))+" "+S(parseFloat(R.coords[3])):Ar+=S(parseFloat(R.coords[2]))+" "+S(parseFloat(R.coords[3]))+" "+S(parseFloat(R.coords[4]))+" "+S(parseFloat(R.coords[5])),X(Ar+="]"),R.matrix&&X("/Matrix ["+R.matrix.toString()+"]"),X("/Function "+ut+" 0 R"),X("/Extend [true true]"),X(">>"),X("endobj")},ze=function(R,je){var ut=qe(),wt=Ve();je.push({resourcesOid:ut,objectOid:wt}),R.objectNumber=wt;var Vt=[];Vt.push({key:"Type",value:"/Pattern"}),Vt.push({key:"PatternType",value:"1"}),Vt.push({key:"PaintType",value:"1"}),Vt.push({key:"TilingType",value:"1"}),Vt.push({key:"BBox",value:"["+R.boundingBox.map(S).join(" ")+"]"}),Vt.push({key:"XStep",value:S(R.xStep)}),Vt.push({key:"YStep",value:S(R.yStep)}),Vt.push({key:"Resources",value:ut+" 0 R"}),R.matrix&&Vt.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),Be({data:R.stream,additionalKeyValues:Vt,objectId:R.objectNumber}),X("endobj")},nt=function(R){for(var je in R.objectNumber=Ve(),X("<<"),R)switch(je){case"opacity":X("/ca "+T(R[je]));break;case"stroke-opacity":X("/CA "+T(R[je]))}X(">>"),X("endobj")},ne=function(R){G(R.resourcesOid,!0),X("<<"),X("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var je in X("/Font <<"),Ae)Ae.hasOwnProperty(je)&&(f===!1||f===!0&&A.hasOwnProperty(je))&&X("/"+je+" "+Ae[je].objectNumber+" 0 R");X(">>")}(),function(){if(Object.keys(_t).length>0){for(var je in X("/Shading <<"),_t)_t.hasOwnProperty(je)&&_t[je]instanceof L0&&_t[je].objectNumber>=0&&X("/"+je+" "+_t[je].objectNumber+" 0 R");gt.publish("putShadingPatternDict"),X(">>")}}(),function(je){if(Object.keys(_t).length>0){for(var ut in X("/Pattern <<"),_t)_t.hasOwnProperty(ut)&&_t[ut]instanceof h.TilingPattern&&_t[ut].objectNumber>=0&&_t[ut].objectNumber<je&&X("/"+ut+" "+_t[ut].objectNumber+" 0 R");gt.publish("putTilingPatternDict"),X(">>")}}(R.objectOid),function(){if(Object.keys(Pe).length>0){var je;for(je in X("/ExtGState <<"),Pe)Pe.hasOwnProperty(je)&&Pe[je].objectNumber>=0&&X("/"+je+" "+Pe[je].objectNumber+" 0 R");gt.publish("putGStateDict"),X(">>")}}(),function(){for(var je in X("/XObject <<"),Nt)Nt.hasOwnProperty(je)&&Nt[je].objectNumber>=0&&X("/"+je+" "+Nt[je].objectNumber+" 0 R");gt.publish("putXobjectDict"),X(">>")}(),X(">>"),X("endobj")},He=function(R){We[R.fontName]=We[R.fontName]||{},We[R.fontName][R.fontStyle]=R.id},pt=function(R,je,ut,wt,Vt){var Ar={id:"F"+(Object.keys(Ae).length+1).toString(10),postScriptName:R,fontName:je,fontStyle:ut,encoding:wt,isStandardFont:Vt||!1,metadata:{}};return gt.publish("addFont",{font:Ar,instance:this}),Ae[Ar.id]=Ar,He(Ar),Ar.id},Dt=h.__private__.pdfEscape=h.pdfEscape=function(R,je){return function(ut,wt){var Vt,Ar,wr,nn,un,Tn,Vn,da,ka;if(wr=(wt=wt||{}).sourceEncoding||"Unicode",un=wt.outputEncoding,(wt.autoencode||un)&&Ae[Ue].metadata&&Ae[Ue].metadata[wr]&&Ae[Ue].metadata[wr].encoding&&(nn=Ae[Ue].metadata[wr].encoding,!un&&Ae[Ue].encoding&&(un=Ae[Ue].encoding),!un&&nn.codePages&&(un=nn.codePages[0]),typeof un=="string"&&(un=nn[un]),un)){for(Vn=!1,Tn=[],Vt=0,Ar=ut.length;Vt<Ar;Vt++)(da=un[ut.charCodeAt(Vt)])?Tn.push(String.fromCharCode(da)):Tn.push(ut[Vt]),Tn[Vt].charCodeAt(0)>>8&&(Vn=!0);ut=Tn.join("")}for(Vt=ut.length;Vn===void 0&&Vt!==0;)ut.charCodeAt(Vt-1)>>8&&(Vn=!0),Vt--;if(!Vn)return ut;for(Tn=wt.noBOM?[]:[254,255],Vt=0,Ar=ut.length;Vt<Ar;Vt++){if((ka=(da=ut.charCodeAt(Vt))>>8)>>8)throw new Error("Character at position "+Vt+" of string '"+ut+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Tn.push(ka),Tn.push(da-(ka<<8))}return String.fromCharCode.apply(void 0,Tn)}(R,je).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rr=h.__private__.beginPage=function(R){ve[++xe]=[],Se[xe]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},lr(xe),ae(ve[H])},zt=function(R,je){var ut,wt,Vt;switch(r=je||r,typeof R=="string"&&(ut=v(R.toLowerCase()),Array.isArray(ut)&&(wt=ut[0],Vt=ut[1])),Array.isArray(R)&&(wt=R[0]*Ne,Vt=R[1]*Ne),isNaN(wt)&&(wt=a[0],Vt=a[1]),(wt>14400||Vt>14400)&&(hs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),wt=Math.min(14400,wt),Vt=Math.min(14400,Vt)),a=[wt,Vt],r.substr(0,1)){case"l":Vt>wt&&(a=[Vt,wt]);break;case"p":wt>Vt&&(a=[Vt,wt])}rr(a),Ut(_r),X(mn),xa!==0&&X(xa+" J"),Qn!==0&&X(Qn+" j"),gt.publish("addPage",{pageNumber:xe})},Ot=function(R){R>0&&R<=xe&&(ve.splice(R,1),Se.splice(R,1),xe--,H>xe&&(H=xe),this.setPage(H))},lr=function(R){R>0&&R<=xe&&(H=R)},Dr=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ve.length-1},br=function(R,je,ut){var wt,Vt=void 0;return ut=ut||{},R=R!==void 0?R:Ae[Ue].fontName,je=je!==void 0?je:Ae[Ue].fontStyle,wt=R.toLowerCase(),We[wt]!==void 0&&We[wt][je]!==void 0?Vt=We[wt][je]:We[R]!==void 0&&We[R][je]!==void 0?Vt=We[R][je]:ut.disableWarning===!1&&hs.warn("Unable to look up font label for font '"+R+"', '"+je+"'. Refer to getFontList() for available fonts."),Vt||ut.noFallback||(Vt=We.times[je])==null&&(Vt=We.times.normal),Vt},nr=h.__private__.putInfo=function(){var R=Ve(),je=function(wt){return wt};for(var ut in d!==null&&(je=zr.encryptor(R,0)),X("<<"),X("/Producer ("+Dt(je("jsPDF "+rn.version))+")"),ie)ie.hasOwnProperty(ut)&&ie[ut]&&X("/"+ut.substr(0,1).toUpperCase()+ut.substr(1)+" ("+Dt(je(ie[ut]))+")");X("/CreationDate ("+Dt(je(ce))+")"),X(">>"),X("endobj")},ir=h.__private__.putCatalog=function(R){var je=(R=R||{}).rootDictionaryObjId||Z;switch(Ve(),X("<<"),X("/Type /Catalog"),X("/Pages "+je+" 0 R"),it||(it="fullwidth"),it){case"fullwidth":X("/OpenAction [3 0 R /FitH null]");break;case"fullheight":X("/OpenAction [3 0 R /FitV null]");break;case"fullpage":X("/OpenAction [3 0 R /Fit]");break;case"original":X("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ut=""+it;ut.substr(ut.length-1)==="%"&&(it=parseInt(it)/100),typeof it=="number"&&X("/OpenAction [3 0 R /XYZ null null "+T(it)+"]")}switch($t||($t="continuous"),$t){case"continuous":X("/PageLayout /OneColumn");break;case"single":X("/PageLayout /SinglePage");break;case"two":case"twoleft":X("/PageLayout /TwoColumnLeft");break;case"tworight":X("/PageLayout /TwoColumnRight")}Mt&&X("/PageMode /"+Mt),gt.publish("putCatalog"),X(">>"),X("endobj")},Nr=h.__private__.putTrailer=function(){X("trailer"),X("<<"),X("/Size "+(W+1)),X("/Root "+W+" 0 R"),X("/Info "+(W-1)+" 0 R"),d!==null&&X("/Encrypt "+zr.oid+" 0 R"),X("/ID [ <"+de+"> <"+de+"> ]"),X(">>")},Pr=h.__private__.putHeader=function(){X("%PDF-"+m),X("%")},xr=h.__private__.putXRef=function(){var R="0000000000";X("xref"),X("0 "+(W+1)),X("0000000000 65535 f ");for(var je=1;je<=W;je++)typeof Y[je]=="function"?X((R+Y[je]()).slice(-10)+" 00000 n "):Y[je]!==void 0?X((R+Y[je]).slice(-10)+" 00000 n "):X("0000000000 00000 n ")},$r=h.__private__.buildDocument=function(){var R;W=0,Q=0,D=[],Y=[],ee=[],Z=qe(),re=qe(),ae(D),gt.publish("buildDocument"),Pr(),lt(),function(){gt.publish("putAdditionalObjects");for(var ut=0;ut<ee.length;ut++){var wt=ee[ut];G(wt.objId,!0),X(wt.content),X("endobj")}gt.publish("postPutAdditionalObjects")}(),R=[],function(){for(var ut in Ae)Ae.hasOwnProperty(ut)&&(f===!1||f===!0&&A.hasOwnProperty(ut))&&dt(Ae[ut])}(),function(){var ut;for(ut in Pe)Pe.hasOwnProperty(ut)&&nt(Pe[ut])}(),function(){for(var ut in Nt)Nt.hasOwnProperty(ut)&&Pt(Nt[ut])}(),function(ut){var wt;for(wt in _t)_t.hasOwnProperty(wt)&&(_t[wt]instanceof L0?he(_t[wt]):_t[wt]instanceof _p&&ze(_t[wt],ut))}(R),gt.publish("putResources"),R.forEach(ne),ne({resourcesOid:re,objectOid:Number.MAX_SAFE_INTEGER}),gt.publish("postPutResources"),d!==null&&(zr.oid=Ve(),X("<<"),X("/Filter /Standard"),X("/V "+zr.v),X("/R "+zr.r),X("/U <"+zr.toHexString(zr.U)+">"),X("/O <"+zr.toHexString(zr.O)+">"),X("/P "+zr.P),X(">>"),X("endobj")),nr(),ir();var je=Q;return xr(),Nr(),X("startxref"),X(""+je),X("%%EOF"),ae(ve[H]),D.join(`
`)},cr=h.__private__.getBlob=function(R){return new Blob([le(R)],{type:"application/pdf"})},Zr=h.output=h.__private__.output=(te=function(R,je){switch(typeof(je=je||{})=="string"?je={filename:je}:je.filename=je.filename||"generated.pdf",R){case void 0:return $r();case"save":h.save(je.filename);break;case"arraybuffer":return le($r());case"blob":return cr($r());case"bloburi":case"bloburl":if(Mn.URL!==void 0&&typeof Mn.URL.createObjectURL=="function")return Mn.URL&&Mn.URL.createObjectURL(cr($r()))||void 0;hs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ut="",wt=$r();try{ut=bV(wt)}catch{ut=bV(unescape(encodeURIComponent(wt)))}return"data:application/pdf;filename="+je.filename+";base64,"+ut;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Mn)==="[object Window]"){var Vt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ar=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';je.pdfObjectUrl&&(Vt=je.pdfObjectUrl,Ar="");var wr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Vt+'"'+Ar+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(je)+");<\/script></body></html>",nn=Mn.open();return nn!==null&&nn.document.write(wr),nn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Mn)==="[object Window]"){var un='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(je.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+je.filename+'" width="500px" height="400px" /></body></html>',Tn=Mn.open();if(Tn!==null){Tn.document.write(un);var Vn=this;Tn.document.documentElement.querySelector("#pdfViewer").onload=function(){Tn.document.title=je.filename,Tn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Vn.output("bloburl"))}}return Tn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Mn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var da='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",je)+'"></iframe></body></html>',ka=Mn.open();if(ka!==null&&(ka.document.write(da),ka.document.title=je.filename),ka||typeof safari>"u")return ka;break;case"datauri":case"dataurl":return Mn.document.location.href=this.output("datauristring",je);default:return null}},te.foo=function(){try{return te.apply(this,arguments)}catch(ut){var R=ut.stack||"";~R.indexOf(" at ")&&(R=R.split(" at ")[1]);var je="Error in function "+R.split(`
`)[0].split("<")[0]+": "+ut.message;if(!Mn.console)throw new Error(je);Mn.console.error(je,ut),Mn.alert&&alert(je)}},te.foo.bar=te,te.foo),Wr=function(R){return Array.isArray(Et)===!0&&Et.indexOf(R)>-1};switch(n){case"pt":Ne=1;break;case"mm":Ne=72/25.4;break;case"cm":Ne=72/2.54;break;case"in":Ne=72;break;case"px":Ne=Wr("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ne=12;break;case"ex":Ne=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Ne=n}var zr=null;Re(),me();var gn=h.__private__.getPageInfo=h.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Se[R].objId,pageNumber:R,pageContext:Se[R]}},Nn=h.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var je in Se)if(Se[je].objId===R)break;return gn(je)},Sn=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Se[H].objId,pageNumber:H,pageContext:Se[H]}};h.addPage=function(){return zt.apply(this,arguments),this},h.setPage=function(){return lr.apply(this,arguments),ae.call(this,ve[H]),this},h.insertPage=function(R){return this.addPage(),this.movePage(H,R),this},h.movePage=function(R,je){var ut,wt;if(R>je){ut=ve[R],wt=Se[R];for(var Vt=R;Vt>je;Vt--)ve[Vt]=ve[Vt-1],Se[Vt]=Se[Vt-1];ve[je]=ut,Se[je]=wt,this.setPage(je)}else if(R<je){ut=ve[R],wt=Se[R];for(var Ar=R;Ar<je;Ar++)ve[Ar]=ve[Ar+1],Se[Ar]=Se[Ar+1];ve[je]=ut,Se[je]=wt,this.setPage(je)}return this},h.deletePage=function(){return Ot.apply(this,arguments),this},h.__private__.text=h.text=function(R,je,ut,wt,Vt){var Ar,wr,nn,un,Tn,Vn,da,ka,Ys,Va=(wt=wt||{}).scope||this;if(typeof R=="number"&&typeof je=="number"&&(typeof ut=="string"||Array.isArray(ut))){var pi=ut;ut=je,je=R,R=pi}if(arguments[3]instanceof Me==0?(nn=arguments[4],un=arguments[5],es(da=arguments[3])==="object"&&da!==null||(typeof nn=="string"&&(un=nn,nn=null),typeof da=="string"&&(un=da,da=null),typeof da=="number"&&(nn=da,da=null),wt={flags:da,angle:nn,align:un})):(E("The transform parameter of text() with a Matrix value"),Ys=Vt),isNaN(je)||isNaN(ut)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return Va;var Js,gi="",Zs=typeof wt.lineHeightFactor=="number"?wt.lineHeightFactor:or,Uc=Va.internal.scaleFactor;function Wu(Ma){return Ma=Ma.split("	").join(Array(wt.TabLen||9).join(" ")),Dt(Ma,da)}function Xu(Ma){for(var ds,Bi=Ma.concat(),ho=[],bh=Bi.length;bh--;)typeof(ds=Bi.shift())=="string"?ho.push(ds):Array.isArray(Ma)&&(ds.length===1||ds[1]===void 0&&ds[2]===void 0)?ho.push(ds[0]):ho.push([ds[0],ds[1],ds[2]]);return ho}function C(Ma,ds){var Bi;if(typeof Ma=="string")Bi=ds(Ma)[0];else if(Array.isArray(Ma)){for(var ho,bh,U1=Ma.concat(),Wg=[],xN=U1.length;xN--;)typeof(ho=U1.shift())=="string"?Wg.push(ds(ho)[0]):Array.isArray(ho)&&typeof ho[0]=="string"&&(bh=ds(ho[0],ho[1],ho[2]),Wg.push([bh[0],bh[1],bh[2]]));Bi=Wg}return Bi}var J=!1,ge=!0;if(typeof R=="string")J=!0;else if(Array.isArray(R)){var et=R.concat();wr=[];for(var Gt,tr=et.length;tr--;)(typeof(Gt=et.shift())!="string"||Array.isArray(Gt)&&typeof Gt[0]!="string")&&(ge=!1);J=ge}if(J===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var Rr=Xe/Va.internal.scaleFactor,ma=Rr*(Zs-1);switch(wt.baseline){case"bottom":ut-=ma;break;case"top":ut+=Rr-ma;break;case"hanging":ut+=Rr-2*ma;break;case"middle":ut+=Rr/2-ma}if((Vn=wt.maxWidth||0)>0&&(typeof R=="string"?R=Va.splitTextToSize(R,Vn):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(Ma,ds){return Ma.concat(Va.splitTextToSize(ds,Vn))},[]))),Ar={text:R,x:je,y:ut,options:wt,mutex:{pdfEscape:Dt,activeFontKey:Ue,fonts:Ae,activeFontSize:Xe}},gt.publish("preProcessText",Ar),R=Ar.text,nn=(wt=Ar.options).angle,Ys instanceof Me==0&&nn&&typeof nn=="number"){nn*=Math.PI/180,wt.rotationDirection===0&&(nn=-nn),w===b&&(nn=-nn);var ei=Math.cos(nn),ra=Math.sin(nn);Ys=new Me(ei,ra,-ra,ei,0,0)}else nn&&nn instanceof Me&&(Ys=nn);w!==b||Ys||(Ys=U),(Tn=wt.charSpace||Ji)!==void 0&&(gi+=S(O(Tn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ka=wt.horizontalScale)!==void 0&&(gi+=S(100*ka)+` Tz
`),wt.lang;var Sa=-1,gs=wt.renderingMode!==void 0?wt.renderingMode:wt.stroke,hu=Va.internal.getCurrentPageInfo().pageContext;switch(gs){case 0:case!1:case"fill":Sa=0;break;case 1:case!0:case"stroke":Sa=1;break;case 2:case"fillThenStroke":Sa=2;break;case 3:case"invisible":Sa=3;break;case 4:case"fillAndAddForClipping":Sa=4;break;case 5:case"strokeAndAddPathForClipping":Sa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Sa=6;break;case 7:case"addToPathForClipping":Sa=7}var Dl=hu.usedRenderingMode!==void 0?hu.usedRenderingMode:-1;Sa!==-1?gi+=Sa+` Tr
`:Dl!==-1&&(gi+=`0 Tr
`),Sa!==-1&&(hu.usedRenderingMode=Sa),un=wt.align||"left";var cl,$d=Xe*Zs,k1=Va.internal.pageSize.getWidth(),F1=Ae[Ue];Tn=wt.charSpace||Ji,Vn=wt.maxWidth||0,da=Object.assign({autoencode:!0,noBOM:!0},wt.flags);var qA=[],Gm=function(Ma){return Va.getStringUnitWidth(Ma,{font:F1,charSpace:Tn,fontSize:Xe,doKerning:!1})*Xe/Uc};if(Object.prototype.toString.call(R)==="[object Array]"){var Au;wr=Xu(R),un!=="left"&&(cl=wr.map(Gm));var mu,zA=0;if(un==="right"){je-=cl[0],R=[],tr=wr.length;for(var yh=0;yh<tr;yh++)yh===0?(mu=yr(je),Au=jr(ut)):(mu=O(zA-cl[yh]),Au=-$d),R.push([wr[yh],mu,Au]),zA=cl[yh]}else if(un==="center"){je-=cl[0]/2,R=[],tr=wr.length;for(var WA=0;WA<tr;WA++)WA===0?(mu=yr(je),Au=jr(ut)):(mu=O((zA-cl[WA])/2),Au=-$d),R.push([wr[WA],mu,Au]),zA=cl[WA]}else if(un==="left"){R=[],tr=wr.length;for(var O1=0;O1<tr;O1++)R.push(wr[O1])}else if(un==="justify"&&F1.encoding==="Identity-H"){R=[],tr=wr.length,Vn=Vn!==0?Vn:k1;for(var zg=0,Pi=0;Pi<tr;Pi++)if(Au=Pi===0?jr(ut):-$d,mu=Pi===0?yr(je):zg,Pi<tr-1){var gN=O((Vn-cl[Pi])/(wr[Pi].split(" ").length-1)),Tf=wr[Pi].split(" ");R.push([Tf[0]+" ",mu,Au]),zg=0;for(var kf=1;kf<Tf.length;kf++){var D1=(Gm(Tf[kf-1]+" "+Tf[kf])-Gm(Tf[kf]))*Uc+gN;kf==Tf.length-1?R.push([Tf[kf],D1,0]):R.push([Tf[kf]+" ",D1,0]),zg-=D1}}else R.push([wr[Pi],mu,Au]);R.push(["",zg,0])}else{if(un!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],tr=wr.length,Vn=Vn!==0?Vn:k1,Pi=0;Pi<tr;Pi++){Au=Pi===0?jr(ut):-$d,mu=Pi===0?yr(je):0;var R1=wr[Pi].split(" ").length-1,M1=R1>0?(Vn-cl[Pi])/R1:0;Pi<tr-1?qA.push(S(O(M1))):qA.push(0),R.push([wr[Pi],mu,Au])}}}(typeof wt.R2L=="boolean"?wt.R2L:jt)===!0&&(R=C(R,function(Ma,ds,Bi){return[Ma.split("").reverse().join(""),ds,Bi]})),Ar={text:R,x:je,y:ut,options:wt,mutex:{pdfEscape:Dt,activeFontKey:Ue,fonts:Ae,activeFontSize:Xe}},gt.publish("postProcessText",Ar),R=Ar.text,Js=Ar.mutex.isHex||!1;var L1=Ae[Ue].encoding;L1!=="WinAnsiEncoding"&&L1!=="StandardEncoding"||(R=C(R,function(Ma,ds,Bi){return[Wu(Ma),ds,Bi]})),wr=Xu(R),R=[];for(var XA,YA,JA,Km=Array.isArray(wr[0])?1:0,ZA="",qm=function(Ma,ds,Bi){var ho="";return Bi instanceof Me?(Bi=typeof wt.angle=="number"?_e(Bi,new Me(1,0,0,1,Ma,ds)):_e(new Me(1,0,0,1,Ma,ds),Bi),w===b&&(Bi=_e(new Me(1,0,0,-1,0,0),Bi)),ho=Bi.join(" ")+` Tm
`):ho=S(Ma)+" "+S(ds)+` Td
`,ho},Yu=0;Yu<wr.length;Yu++){switch(ZA="",Km){case 1:JA=(Js?"<":"(")+wr[Yu][0]+(Js?">":")"),XA=parseFloat(wr[Yu][1]),YA=parseFloat(wr[Yu][2]);break;case 0:JA=(Js?"<":"(")+wr[Yu]+(Js?">":")"),XA=yr(je),YA=jr(ut)}qA!==void 0&&qA[Yu]!==void 0&&(ZA=qA[Yu]+` Tw
`),Yu===0?R.push(ZA+qm(XA,YA,Ys)+JA):Km===0?R.push(ZA+JA):Km===1&&R.push(ZA+qm(XA,YA,Ys)+JA)}R=Km===0?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var Ff=`BT
/`;return Ff+=Ue+" "+Xe+` Tf
`,Ff+=S(Xe*Zs)+` TL
`,Ff+=ga+`
`,Ff+=gi,Ff+=R,X(Ff+="ET"),A[Ue]=!0,Va};var fe=h.__private__.clip=h.clip=function(R){return X(R==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return fe("evenodd")},h.__private__.discardPath=h.discardPath=function(){return X("n"),this};var tt=h.__private__.isValidStyle=function(R){var je=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(je=!0),je};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(R){return tt(R)&&(u=R),this};var vt=h.__private__.getStyle=h.getStyle=function(R){var je=u;switch(R){case"D":case"S":je="S";break;case"F":je="f";break;case"FD":case"DF":je="B";break;case"f":case"f*":case"B":case"B*":je=R}return je},mt=h.close=function(){return X("h"),this};h.stroke=function(){return X("S"),this},h.fill=function(R){return Oe("f",R),this},h.fillEvenOdd=function(R){return Oe("f*",R),this},h.fillStroke=function(R){return Oe("B",R),this},h.fillStrokeEvenOdd=function(R){return Oe("B*",R),this};var Oe=function(R,je){es(je)==="object"?Ct(je,R):X(R)},At=function(R){R===null||w===b&&R===void 0||(R=vt(R),X(R))};function It(R,je,ut,wt,Vt){var Ar=new _p(je||this.boundingBox,ut||this.xStep,wt||this.yStep,this.gState,Vt||this.matrix);Ar.stream=this.stream;var wr=R+"$$"+this.cloneIndex+++"$$";return ye(wr,Ar),Ar}var Ct=function(R,je){var ut=pe[R.key],wt=_t[ut];if(wt instanceof L0)X("q"),X(bt(je)),wt.gState&&h.setGState(wt.gState),X(R.matrix.toString()+" cm"),X("/"+ut+" sh"),X("Q");else if(wt instanceof _p){var Vt=new Me(1,0,0,-1,0,fo());R.matrix&&(Vt=Vt.multiply(R.matrix||U),ut=It.call(wt,R.key,R.boundingBox,R.xStep,R.yStep,Vt).id),X("q"),X("/Pattern cs"),X("/"+ut+" scn"),wt.gState&&h.setGState(wt.gState),X(je),X("Q")}},bt=function(R){switch(R){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},St=h.moveTo=function(R,je){return X(S(O(R))+" "+S(z(je))+" m"),this},Jt=h.lineTo=function(R,je){return X(S(O(R))+" "+S(z(je))+" l"),this},Qt=h.curveTo=function(R,je,ut,wt,Vt,Ar){return X([S(O(R)),S(z(je)),S(O(ut)),S(z(wt)),S(O(Vt)),S(z(Ar)),"c"].join(" ")),this};h.__private__.line=h.line=function(R,je,ut,wt,Vt){if(isNaN(R)||isNaN(je)||isNaN(ut)||isNaN(wt)||!tt(Vt))throw new Error("Invalid arguments passed to jsPDF.line");return w===y?this.lines([[ut-R,wt-je]],R,je,[1,1],Vt||"S"):this.lines([[ut-R,wt-je]],R,je,[1,1]).stroke()},h.__private__.lines=h.lines=function(R,je,ut,wt,Vt,Ar){var wr,nn,un,Tn,Vn,da,ka,Ys,Va,pi,Js,gi;if(typeof R=="number"&&(gi=ut,ut=je,je=R,R=gi),wt=wt||[1,1],Ar=Ar||!1,isNaN(je)||isNaN(ut)||!Array.isArray(R)||!Array.isArray(wt)||!tt(Vt)||typeof Ar!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(St(je,ut),wr=wt[0],nn=wt[1],Tn=R.length,pi=je,Js=ut,un=0;un<Tn;un++)(Vn=R[un]).length===2?(pi=Vn[0]*wr+pi,Js=Vn[1]*nn+Js,Jt(pi,Js)):(da=Vn[0]*wr+pi,ka=Vn[1]*nn+Js,Ys=Vn[2]*wr+pi,Va=Vn[3]*nn+Js,pi=Vn[4]*wr+pi,Js=Vn[5]*nn+Js,Qt(da,ka,Ys,Va,pi,Js));return Ar&&mt(),At(Vt),this},h.path=function(R){for(var je=0;je<R.length;je++){var ut=R[je],wt=ut.c;switch(ut.op){case"m":St(wt[0],wt[1]);break;case"l":Jt(wt[0],wt[1]);break;case"c":Qt.apply(this,wt);break;case"h":mt()}}return this},h.__private__.rect=h.rect=function(R,je,ut,wt,Vt){if(isNaN(R)||isNaN(je)||isNaN(ut)||isNaN(wt)||!tt(Vt))throw new Error("Invalid arguments passed to jsPDF.rect");return w===y&&(wt=-wt),X([S(O(R)),S(z(je)),S(O(ut)),S(O(wt)),"re"].join(" ")),At(Vt),this},h.__private__.triangle=h.triangle=function(R,je,ut,wt,Vt,Ar,wr){if(isNaN(R)||isNaN(je)||isNaN(ut)||isNaN(wt)||isNaN(Vt)||isNaN(Ar)||!tt(wr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ut-R,wt-je],[Vt-ut,Ar-wt],[R-Vt,je-Ar]],R,je,[1,1],wr,!0),this},h.__private__.roundedRect=h.roundedRect=function(R,je,ut,wt,Vt,Ar,wr){if(isNaN(R)||isNaN(je)||isNaN(ut)||isNaN(wt)||isNaN(Vt)||isNaN(Ar)||!tt(wr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var nn=4/3*(Math.SQRT2-1);return Vt=Math.min(Vt,.5*ut),Ar=Math.min(Ar,.5*wt),this.lines([[ut-2*Vt,0],[Vt*nn,0,Vt,Ar-Ar*nn,Vt,Ar],[0,wt-2*Ar],[0,Ar*nn,-Vt*nn,Ar,-Vt,Ar],[2*Vt-ut,0],[-Vt*nn,0,-Vt,-Ar*nn,-Vt,-Ar],[0,2*Ar-wt],[0,-Ar*nn,Vt*nn,-Ar,Vt,-Ar]],R+Vt,je,[1,1],wr,!0),this},h.__private__.ellipse=h.ellipse=function(R,je,ut,wt,Vt){if(isNaN(R)||isNaN(je)||isNaN(ut)||isNaN(wt)||!tt(Vt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ar=4/3*(Math.SQRT2-1)*ut,wr=4/3*(Math.SQRT2-1)*wt;return St(R+ut,je),Qt(R+ut,je-wr,R+Ar,je-wt,R,je-wt),Qt(R-Ar,je-wt,R-ut,je-wr,R-ut,je),Qt(R-ut,je+wr,R-Ar,je+wt,R,je+wt),Qt(R+Ar,je+wt,R+ut,je+wr,R+ut,je),At(Vt),this},h.__private__.circle=h.circle=function(R,je,ut,wt){if(isNaN(R)||isNaN(je)||isNaN(ut)||!tt(wt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,je,ut,ut,wt)},h.setFont=function(R,je,ut){return ut&&(je=_(je,ut)),Ue=br(R,je,{disableWarning:!1}),this};var ar=h.__private__.getFont=h.getFont=function(){return Ae[br.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var R,je,ut={};for(R in We)if(We.hasOwnProperty(R))for(je in ut[R]=[],We[R])We[R].hasOwnProperty(je)&&ut[R].push(je);return ut},h.addFont=function(R,je,ut,wt,Vt){var Ar=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ar.indexOf(arguments[3])!==-1?Vt=arguments[3]:arguments[3]&&Ar.indexOf(arguments[3])==-1&&(ut=_(ut,wt)),pt.call(this,R,je,ut,Vt=Vt||"Identity-H")};var or,_r=t.lineWidth||.200025,Cr=h.__private__.getLineWidth=h.getLineWidth=function(){return _r},Ut=h.__private__.setLineWidth=h.setLineWidth=function(R){return _r=R,X(S(O(R))+" w"),this};h.__private__.setLineDash=rn.API.setLineDash=rn.API.setLineDashPattern=function(R,je){if(R=R||[],je=je||0,isNaN(je)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(ut){return S(O(ut))}).join(" "),je=S(O(je)),X("["+R+"] "+je+" d"),this};var tn=h.__private__.getLineHeight=h.getLineHeight=function(){return Xe*or};h.__private__.getLineHeight=h.getLineHeight=function(){return Xe*or};var Gr=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(or=R),this},Ir=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return or};Gr(t.lineHeight);var yr=h.__private__.getHorizontalCoordinate=function(R){return O(R)},jr=h.__private__.getVerticalCoordinate=function(R){return w===b?R:Se[H].mediaBox.topRightY-Se[H].mediaBox.bottomLeftY-O(R)},Bn=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(R){return S(yr(R))},yn=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(R){return S(jr(R))},mn=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return we(mn)},h.__private__.setStrokeColor=h.setDrawColor=function(R,je,ut,wt){return mn=Fe({ch1:R,ch2:je,ch3:ut,ch4:wt,pdfColorType:"draw",precision:2}),X(mn),this};var ua=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return we(ua)},h.__private__.setFillColor=h.setFillColor=function(R,je,ut,wt){return ua=Fe({ch1:R,ch2:je,ch3:ut,ch4:wt,pdfColorType:"fill",precision:2}),X(ua),this};var ga=t.textColor||"0 g",Yi=h.__private__.getTextColor=h.getTextColor=function(){return we(ga)};h.__private__.setTextColor=h.setTextColor=function(R,je,ut,wt){return ga=Fe({ch1:R,ch2:je,ch3:ut,ch4:wt,pdfColorType:"text",precision:3}),this};var Ji=t.charSpace,Fl=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Ji||0)};h.__private__.setCharSpace=h.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ji=R,this};var xa=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(R){var je=h.CapJoinStyles[R];if(je===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xa=je,X(je+" J"),this};var Qn=0;h.__private__.setLineJoin=h.setLineJoin=function(R){var je=h.CapJoinStyles[R];if(je===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qn=je,X(je+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return X(S(O(R))+" M"),this},h.GState=I2,h.setGState=function(R){(R=typeof R=="string"?Pe[Ee[R]]:du(null,R)).equals(Ze)||(X("/"+R.id+" gs"),Ze=R)};var du=function(R,je){if(!R||!Ee[R]){var ut=!1;for(var wt in Pe)if(Pe.hasOwnProperty(wt)&&Pe[wt].equals(je)){ut=!0;break}if(ut)je=Pe[wt];else{var Vt="GS"+(Object.keys(Pe).length+1).toString(10);Pe[Vt]=je,je.id=Vt}return R&&(Ee[R]=je.id),gt.publish("addGState",je),je}};h.addGState=function(R,je){return du(R,je),this},h.saveGraphicsState=function(){return X("q"),ct.push({key:Ue,size:Xe,color:ga}),this},h.restoreGraphicsState=function(){X("Q");var R=ct.pop();return Ue=R.key,Xe=R.size,ga=R.color,Ze=null,this},h.setCurrentTransformationMatrix=function(R){return X(R.toString()+" cm"),this},h.comment=function(R){return X("#"+R),this};var Ol=function(R,je){var ut=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ut},set:function(Ar){isNaN(Ar)||(ut=parseFloat(Ar))}});var wt=je||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return wt},set:function(Ar){isNaN(Ar)||(wt=parseFloat(Ar))}});var Vt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Vt},set:function(Ar){Vt=Ar.toString()}}),this},Zi=function(R,je,ut,wt){Ol.call(this,R,je),this.type="rect";var Vt=ut||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Vt},set:function(wr){isNaN(wr)||(Vt=parseFloat(wr))}});var Ar=wt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ar},set:function(wr){isNaN(wr)||(Ar=parseFloat(wr))}}),this},Rc=function(){this.page=xe,this.currentPage=H,this.pages=ve.slice(0),this.pagesContext=Se.slice(0),this.x=be,this.y=Ce,this.matrix=Le,this.width=ol(H),this.height=KA(H),this.outputDestination=Ye,this.id="",this.objectNumber=-1};Rc.prototype.restore=function(){xe=this.page,H=this.currentPage,Se=this.pagesContext,ve=this.pages,be=this.x,Ce=this.y,Le=this.matrix,fu(H,this.width),ll(H,this.height),Ye=this.outputDestination};var Mc=function(R,je,ut,wt,Vt){Lt.push(new Rc),xe=H=0,ve=[],be=R,Ce=je,Le=Vt,rr([ut,wt])};for(var dc in h.beginFormObject=function(R,je,ut,wt,Vt){return Mc(R,je,ut,wt,Vt),this},h.endFormObject=function(R){return function(je){if(Tt[je])Lt.pop().restore();else{var ut=new Rc,wt="Xo"+(Object.keys(Nt).length+1).toString(10);ut.id=wt,Tt[je]=wt,Nt[wt]=ut,gt.publish("addFormObject",ut),Lt.pop().restore()}}(R),this},h.doFormObject=function(R,je){var ut=Nt[Tt[R]];return X("q"),X(je.toString()+" cm"),X("/"+ut.id+" Do"),X("Q"),this},h.getFormObject=function(R){var je=Nt[Tt[R]];return{x:je.x,y:je.y,width:je.width,height:je.height,matrix:je.matrix}},h.save=function(R,je){return R=R||"generated.pdf",(je=je||{}).returnPromise=je.returnPromise||!1,je.returnPromise===!1?(cp(cr($r()),R),typeof cp.unload=="function"&&Mn.setTimeout&&setTimeout(cp.unload,911),this):new Promise(function(ut,wt){try{var Vt=cp(cr($r()),R);typeof cp.unload=="function"&&Mn.setTimeout&&setTimeout(cp.unload,911),ut(Vt)}catch(Ar){wt(Ar.message)}})},rn.API)rn.API.hasOwnProperty(dc)&&(dc==="events"&&rn.API.events.length?function(R,je){var ut,wt,Vt;for(Vt=je.length-1;Vt!==-1;Vt--)ut=je[Vt][0],wt=je[Vt][1],R.subscribe.apply(R,[ut].concat(typeof wt=="function"?[wt]:wt))}(gt,rn.API.events):h[dc]=rn.API[dc]);function ol(R){return Se[R].mediaBox.topRightX-Se[R].mediaBox.bottomLeftX}function fu(R,je){Se[R].mediaBox.topRightX=je+Se[R].mediaBox.bottomLeftX}function KA(R){return Se[R].mediaBox.topRightY-Se[R].mediaBox.bottomLeftY}function ll(R,je){Se[R].mediaBox.topRightY=je+Se[R].mediaBox.bottomLeftY}var Lc=h.getPageWidth=function(R){return ol(R=R||H)/Ne},Bf=h.setPageWidth=function(R,je){fu(R,je*Ne)},fo=h.getPageHeight=function(R){return KA(R=R||H)/Ne},zu=h.setPageHeight=function(R,je){ll(R,je*Ne)};return h.internal={pdfEscape:Dt,getStyle:vt,getFont:ar,getFontSize:xt,getCharSpace:Fl,getTextColor:Yi,getLineHeight:tn,getLineHeightFactor:Ir,getLineWidth:Cr,write:De,getHorizontalCoordinate:yr,getVerticalCoordinate:jr,getCoordinateString:Bn,getVerticalCoordinateString:yn,collections:{},newObject:Ve,newAdditionalObject:V,newObjectDeferred:qe,newObjectDeferredBegin:G,getFilters:st,putStream:Be,events:gt,scaleFactor:Ne,pageSize:{getWidth:function(){return Lc(H)},setWidth:function(R){Bf(H,R)},getHeight:function(){return fo(H)},setHeight:function(R){zu(H,R)}},encryptionOptions:d,encryption:zr,getEncryptor:function(R){return d!==null?zr.encryptor(R,0):function(je){return je}},output:Zr,getNumberOfPages:Dr,get pages(){return ve},out:X,f2:T,f3:P,getPageInfo:gn,getPageInfoByObjId:Nn,getCurrentPageInfo:Sn,getPDFVersion:p,Point:Ol,Rectangle:Zi,Matrix:Me,hasHotfix:Wr},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Lc(H)},set:function(R){Bf(H,R)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return fo(H)},set:function(R){zu(H,R)},enumerable:!0,configurable:!0}),(function(R){for(var je=0,ut=$e.length;je<ut;je++){var wt=pt.call(this,R[je][0],R[je][1],R[je][2],$e[je][3],!0);f===!1&&(A[wt]=!0);var Vt=R[je][0].split("-");He({id:wt,fontName:Vt[0],fontStyle:Vt[1]||""})}gt.publish("addFonts",{fonts:Ae,dictionary:We})}).call(h,$e),Ue="F1",zt(a,r),gt.publish("initialized"),h}Bx.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Bx.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Bx.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Bx.prototype.processOwnerPassword=function(t,e){return Qk(Uk(e).substr(0,5),t)},Bx.prototype.encryptor=function(t,e){var r=Uk(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Qk(r,n)}},I2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||es(t)!==es(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},rn.API={events:[]},rn.version="3.0.4";var wi=rn.API,K6=1,Dg=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ux=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Hn=function(t){return t.toFixed(2)},f0=function(t){return t.toFixed(5)};wi.__acroform__={};var lu=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},_V=function(t){return t*K6},Vf=function(t){var e=new Bre,r=ln.internal.getHeight(t)||0,n=ln.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Hn(n)),Number(Hn(r))],e},Uje=wi.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Qje=wi.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Vje=wi.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Hi=wi.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Vje(t,e-1)},$i=wi.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Uje(t,e-1)},Gi=wi.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Qje(t,e-1)},Hje=wi.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number(Hn(c.lowerLeft_X)),Number(Hn(c.lowerLeft_Y)),Number(Hn(c.upperRight_X)),Number(Hn(c.upperRight_Y))]},$je=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Vk(t,r),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+Hn(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Vf(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Vk=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(T){return T.split(`
`)}):a.map(function(T){return[T]});var s=r,o=ln.internal.getHeight(t)||0;o=o<0?-o:o;var l=ln.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(T,P,O){if(T+1<a.length){var z=P+" "+a[T+1][0];return OC(z,t,O).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,d,f=OC("3",t,s).height,A=t.multiline?o-s:(o-f)/2,h=A+=2,m=0,p=0,x=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+OC(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var v="",y=0,b=0;b<a.length;b++)if(a.hasOwnProperty(b)){var w=!1;if(a[b].length!==1&&x!==a[b].length-1){if((f+2)*(y+2)+2>o)continue e;v+=a[b][x],w=!0,p=b,b--}else{v=(v+=a[b][x]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var j=parseInt(b),I=c(j,v,s),_=b>=a.length-1;if(I&&!_){v+=" ",x=0;continue}if(I||_){if(_)p=j;else if(t.multiline&&(f+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(y+2)+2>o)continue e;p=j}}for(var S="",E=m;E<=p;E++){var B=a[E];if(t.multiline){if(E===p){S+=B[x]+" ",x=(x+1)%B.length;continue}if(E===m){S+=B[B.length-1]+" ";continue}}S+=B[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,d=OC(S,t,s).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}e+=Hn(u)+" "+Hn(h)+` Td
`,e+="("+Dg(S)+`) Tj
`,e+=-Hn(u)+` 0 Td
`,h=-(s+2),d=0,m=w?p:p+1,y++,v=""}break}return n.text=e,n.fontSize=s,n},OC=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},Gje={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Kje=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},qje=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(If.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Gje)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");K6=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Tre,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&Kje(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=Hje(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ln.createDefaultAppearanceStream(l),es(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=$je(l);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var A in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(A)){var h=l.appearanceStreamContent[A];if(f+="/"+A+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(p,x){for(var v in p)if(p.hasOwnProperty(v)){var y=v,b=p[v];x.internal.newObjectDeferredBegin(b.objId,!0),es(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(a.internal.acroformPlugin.xForms,a)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Pre=wi.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var a="[",s=0;s<t.length;s++)switch(s!==0&&(a+=" "),es(t[s])){case"boolean":case"number":case"object":a+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),a+="("+Dg(n(t[s].toString()))+")"):a+=t[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},h5=function(t,e,r){var n=function(a){return a};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Dg(n(t))+")"},Jf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Jf.prototype.toString=function(){return this.objId+" 0 R"},Jf.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Jf.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],a=this[n];a&&(Array.isArray(a)?t.push({key:n,value:Pre(a,this.objId,this.scope)}):a instanceof Jf?(a.scope=this.scope,t.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:n,value:a}))}return t};var Bre=function(){Jf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};lu(Bre,Jf);var Tre=function(){Jf.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Dg(r(t))+")"}},set:function(r){t=r}})};lu(Tre,Jf);var If=function t(){Jf.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Hi(e,3)},set:function(v){v?this.F=$i(e,3):this.F=Gi(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof kS)return;s="FieldObject"+t.FieldNum++}var v=function(y){return y};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Dg(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/K6:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof kS||this instanceof fm))return h5(f,this.objId,this.scope)},set:function(v){v=v.toString(),f=v}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Co==0?h5(A,this.objId,this.scope):A},set:function(v){v=v.toString(),A=this instanceof Co==0?v.substr(0,1)==="("?ux(v.substr(1,v.length-2)):ux(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Co==1?ux(A.substr(1,A.length-1)):A},set:function(v){v=v.toString(),A=this instanceof Co==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Co==0?h5(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof Co==0?v.substr(0,1)==="("?ux(v.substr(1,v.length-2)):ux(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Co==1?ux(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof Co==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(v){v=!!v,p=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(v){m=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,1)},set:function(v){v?this.Ff=$i(this.Ff,1):this.Ff=Gi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,2)},set:function(v){v?this.Ff=$i(this.Ff,2):this.Ff=Gi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,3)},set:function(v){v?this.Ff=$i(this.Ff,3):this.Ff=Gi(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');x=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(x){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};lu(If,Jf);var Dp=function(){If.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Pre(e,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,18)},set:function(r){r?this.Ff=$i(this.Ff,18):this.Ff=Gi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=$i(this.Ff,19):this.Ff=Gi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,20)},set:function(r){r?(this.Ff=$i(this.Ff,20),e.sort()):this.Ff=Gi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,22)},set:function(r){r?this.Ff=$i(this.Ff,22):this.Ff=Gi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,23)},set:function(r){r?this.Ff=$i(this.Ff,23):this.Ff=Gi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,27)},set:function(r){r?this.Ff=$i(this.Ff,27):this.Ff=Gi(this.Ff,27)}}),this.hasAppearanceStream=!1};lu(Dp,If);var Rp=function(){Dp.call(this),this.fontName="helvetica",this.combo=!1};lu(Rp,Dp);var Mp=function(){Rp.call(this),this.combo=!0};lu(Mp,Rp);var Eb=function(){Mp.call(this),this.edit=!0};lu(Eb,Mp);var Co=function(){If.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,15)},set:function(r){r?this.Ff=$i(this.Ff,15):this.Ff=Gi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,16)},set:function(r){r?this.Ff=$i(this.Ff,16):this.Ff=Gi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,17)},set:function(r){r?this.Ff=$i(this.Ff,17):this.Ff=Gi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,26)},set:function(r){r?this.Ff=$i(this.Ff,26):this.Ff=Gi(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+Dg(r(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){es(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};lu(Co,If);var Sb=function(){Co.call(this),this.pushButton=!0};lu(Sb,Co);var Lp=function(){Co.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};lu(Lp,Co);var kS=function(){var t,e;If.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+Dg(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){es(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ln.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};lu(kS,If),Lp.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Lp.prototype.createOption=function(t){var e=new kS;return e.Parent=this,e.optionName=t,this.Kids.push(e),zje.call(this.scope,e),e};var Ib=function(){Co.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ln.CheckBox.createAppearanceStream()};lu(Ib,Co);var fm=function(){If.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,13)},set:function(e){e?this.Ff=$i(this.Ff,13):this.Ff=Gi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,21)},set:function(e){e?this.Ff=$i(this.Ff,21):this.Ff=Gi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,23)},set:function(e){e?this.Ff=$i(this.Ff,23):this.Ff=Gi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,24)},set:function(e){e?this.Ff=$i(this.Ff,24):this.Ff=Gi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,25)},set:function(e){e?this.Ff=$i(this.Ff,25):this.Ff=Gi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,26)},set:function(e){e?this.Ff=$i(this.Ff,26):this.Ff=Gi(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};lu(fm,If);var jb=function(){fm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Hi(this.Ff,14)},set:function(t){t?this.Ff=$i(this.Ff,14):this.Ff=Gi(this.Ff,14)}}),this.password=!0};lu(jb,fm);var ln={CheckBox:{createAppearanceStream:function(){return{N:{On:ln.CheckBox.YesNormal},D:{On:ln.CheckBox.YesPushDown,Off:ln.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=Vk(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Hn(ln.internal.getWidth(t))+" "+Hn(ln.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Hn(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Vf(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),a=[],s=ln.internal.getHeight(t),o=ln.internal.getWidth(t),l=Vk(t,t.caption);return a.push("1 g"),a.push("0 0 "+Hn(o)+" "+Hn(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Hn(o-1)+" "+Hn(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Hn(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Hn(ln.internal.getWidth(t))+" "+Hn(ln.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:ln.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=ln.RadioButton.Circle.YesNormal,e.D[t]=ln.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=ln.internal.getWidth(t)<=ln.internal.getHeight(t)?ln.internal.getWidth(t)/4:ln.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=ln.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+f0(ln.internal.getWidth(t)/2)+" "+f0(ln.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=ln.internal.getWidth(t)<=ln.internal.getHeight(t)?ln.internal.getWidth(t)/4:ln.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*ln.internal.Bezier_C).toFixed(5)),o=Number((n*ln.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+f0(ln.internal.getWidth(t)/2)+" "+f0(ln.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+f0(ln.internal.getWidth(t)/2)+" "+f0(ln.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=ln.internal.getWidth(t)<=ln.internal.getHeight(t)?ln.internal.getWidth(t)/4:ln.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*ln.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+f0(ln.internal.getWidth(t)/2)+" "+f0(ln.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:ln.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=ln.RadioButton.Cross.YesNormal,e.D[t]=ln.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Vf(t);e.scope=t.scope;var r=[],n=ln.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Hn(ln.internal.getWidth(t)-2)+" "+Hn(ln.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Hn(n.x1.x)+" "+Hn(n.x1.y)+" m"),r.push(Hn(n.x2.x)+" "+Hn(n.x2.y)+" l"),r.push(Hn(n.x4.x)+" "+Hn(n.x4.y)+" m"),r.push(Hn(n.x3.x)+" "+Hn(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=ln.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Hn(ln.internal.getWidth(t))+" "+Hn(ln.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Hn(ln.internal.getWidth(t)-2)+" "+Hn(ln.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Hn(r.x1.x)+" "+Hn(r.x1.y)+" m"),n.push(Hn(r.x2.x)+" "+Hn(r.x2.y)+" l"),n.push(Hn(r.x4.x)+" "+Hn(r.x4.y)+" m"),n.push(Hn(r.x3.x)+" "+Hn(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Vf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Hn(ln.internal.getWidth(t))+" "+Hn(ln.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};ln.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=ln.internal.getWidth(t),r=ln.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},ln.internal.getWidth=function(t){var e=0;return es(t)==="object"&&(e=_V(t.Rect[2])),e},ln.internal.getHeight=function(t){var e=0;return es(t)==="object"&&(e=_V(t.Rect[3])),e};var zje=wi.addField=function(t){if(qje(this,t),!(t instanceof If))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};wi.AcroFormChoiceField=Dp,wi.AcroFormListBox=Rp,wi.AcroFormComboBox=Mp,wi.AcroFormEditBox=Eb,wi.AcroFormButton=Co,wi.AcroFormPushButton=Sb,wi.AcroFormRadioButton=Lp,wi.AcroFormCheckBox=Ib,wi.AcroFormTextField=fm,wi.AcroFormPasswordField=jb,wi.AcroFormAppearance=ln,wi.AcroForm={ChoiceField:Dp,ListBox:Rp,ComboBox:Mp,EditBox:Eb,Button:Co,PushButton:Sb,RadioButton:Lp,CheckBox:Ib,TextField:fm,PasswordField:jb,Appearance:ln},rn.AcroForm={ChoiceField:Dp,ListBox:Rp,ComboBox:Mp,EditBox:Eb,Button:Co,PushButton:Sb,RadioButton:Lp,CheckBox:Ib,TextField:fm,PasswordField:jb,Appearance:ln};var Wje=rn.AcroForm;function kre(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(T,P){var O,z,ce,de,ue,me=r;if((P=P||r)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(I(T))for(ue in n)for(ce=n[ue],O=0;O<ce.length;O+=1){for(de=!0,z=0;z<ce[O].length;z+=1)if(ce[O][z]!==void 0&&ce[O][z]!==T[z]){de=!1;break}if(de===!0){me=ue;break}}else for(ue in n)for(ce=n[ue],O=0;O<ce.length;O+=1){for(de=!0,z=0;z<ce[O].length;z+=1)if(ce[O][z]!==void 0&&ce[O][z]!==T.charCodeAt(z)){de=!1;break}if(de===!0){me=ue;break}}return me===r&&P!==r&&(me=P),me},s=function T(P){for(var O=this.internal.write,z=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var de=[];if(de.push({key:"Type",value:"/XObject"}),de.push({key:"Subtype",value:"/Image"}),de.push({key:"Width",value:P.width}),de.push({key:"Height",value:P.height}),P.colorSpace===v.INDEXED?de.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(de.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===v.DEVICE_CMYK&&de.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),de.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&de.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var ue="",me=0,se=P.transparency.length;me<se;me++)ue+=P.transparency[me]+" "+P.transparency[me]+" ";de.push({key:"Mask",value:"["+ue+"]"})}P.sMask!==void 0&&de.push({key:"SMask",value:P.objectId+1+" 0 R"});var ke=P.filter!==void 0?["/"+P.filter]:void 0;if(z({data:P.data,additionalKeyValues:de,alreadyAppliedFilters:ke,objectId:P.objectId}),O("endobj"),"sMask"in P&&P.sMask!==void 0){var Re,F=(Re=P.sMaskBitsPerComponent)!==null&&Re!==void 0?Re:P.bitsPerComponent,H={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:F,data:P.sMask};"filter"in P&&(H.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(F," /Columns ").concat(P.width),H.filter=P.filter),T.call(this,H)}if(P.colorSpace===v.INDEXED){var K=this.internal.newObject();z({data:S(new Uint8Array(P.palette)),objectId:K}),O("endobj")}},o=function(){var T=this.internal.collections[e+"images"];for(var P in T)s.call(this,T[P])},l=function(){var T,P=this.internal.collections[e+"images"],O=this.internal.write;for(var z in P)O("/I"+(T=P[z]).index,T.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var T=this.internal.collections[e+"images"];return c.call(this),T},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(T){return typeof t["process"+T.toUpperCase()]=="function"},A=function(T){return es(T)==="object"&&T.nodeType===1},h=function(T,P){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var O=""+T.getAttribute("src");if(O.indexOf("data:image/")===0)return pE(unescape(O).split("base64,").pop());var z=t.loadFile(O,!0);if(z!==void 0)return z}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var ce;switch(P){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return pE(T.toDataURL(ce,1).split("base64,").pop())}},m=function(T){var P=this.internal.collections[e+"images"];if(P){for(var O in P)if(T===P[O].alias)return P[O]}},p=function(T,P,O){return T||P||(T=-96,P=-96),T<0&&(T=-1*O.width*72/T/this.internal.scaleFactor),P<0&&(P=-1*O.height*72/P/this.internal.scaleFactor),T===0&&(T=P*O.width/O.height),P===0&&(P=T*O.height/O.width),[T,P]},x=function(T,P,O,z,ce,de){var ue=p.call(this,O,z,ce),me=this.internal.getCoordinateString,se=this.internal.getVerticalCoordinateString,ke=u.call(this);if(O=ue[0],z=ue[1],ke[ce.index]=ce,de){de*=Math.PI/180;var Re=Math.cos(de),F=Math.sin(de),H=function(L){return L.toFixed(4)},K=[H(Re),H(F),H(-1*F),H(Re),0,0,"cm"]}this.internal.write("q"),de?(this.internal.write([1,"0","0",1,me(T),se(P+z),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([me(O),"0","0",me(z),"0","0","cm"].join(" "))):this.internal.write([me(O),"0","0",me(z),me(T),se(P+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(T){var P,O,z=0;if(typeof T=="string")for(O=T.length,P=0;P<O;P++)z=(z<<5)-z+T.charCodeAt(P),z|=0;else if(I(T))for(O=T.byteLength/2,P=0;P<O;P++)z=(z<<5)-z+T[P],z|=0;return z},w=t.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var P=!0;return T.length===0&&(P=!1),T.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(P=!1),P},j=t.__addimage__.extractImageFromDataUrl=function(T){if(T==null||!(T=T.trim()).startsWith("data:"))return null;var P=T.indexOf(",");return P<0?null:T.substring(0,P).trim().endsWith("base64")?T.substring(P+1):null};t.__addimage__.isArrayBuffer=function(T){return T instanceof ArrayBuffer};var I=t.__addimage__.isArrayBufferView=function(T){return T instanceof Int8Array||T instanceof Uint8Array||T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array},_=t.__addimage__.binaryStringToUint8Array=function(T){for(var P=T.length,O=new Uint8Array(P),z=0;z<P;z++)O[z]=T.charCodeAt(z);return O},S=t.__addimage__.arrayBufferToBinaryString=function(T){for(var P="",O=I(T)?T:new Uint8Array(T),z=0;z<O.length;z+=8192)P+=String.fromCharCode.apply(null,O.subarray(z,z+8192));return P};t.addImage=function(){var T,P,O,z,ce,de,ue,me,se;if(typeof arguments[1]=="number"?(P=r,O=arguments[1],z=arguments[2],ce=arguments[3],de=arguments[4],ue=arguments[5],me=arguments[6],se=arguments[7]):(P=arguments[1],O=arguments[2],z=arguments[3],ce=arguments[4],de=arguments[5],ue=arguments[6],me=arguments[7],se=arguments[8]),es(T=arguments[0])==="object"&&!A(T)&&"imageData"in T){var ke=T;T=ke.imageData,P=ke.format||P||r,O=ke.x||O||0,z=ke.y||z||0,ce=ke.w||ke.width||ce,de=ke.h||ke.height||de,ue=ke.alias||ue,me=ke.compression||me,se=ke.rotation||ke.angle||se}var Re=this.internal.getFilters();if(me===void 0&&Re.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(O)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var F=E.call(this,T,P,ue,me);return x.call(this,O,z,ce,de,F,se),this};var E=function(T,P,O,z){var ce,de,ue;if(typeof T=="string"&&a(T)===r){T=unescape(T);var me=B(T,!1);(me!==""||(me=t.loadFile(T,!0))!==void 0)&&(T=me)}if(A(T)&&(T=h(T,P)),P=a(T,P),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((ue=O)==null||ue.length===0)&&(O=function(se){return typeof se=="string"||I(se)?b(se):I(se.data)?b(se.data):null}(T)),(ce=m.call(this,O))||(T instanceof Uint8Array||P==="RGBA"||(de=T,T=_(T)),ce=this["process"+P.toUpperCase()](T,d.call(this),O,function(se){return se&&typeof se=="string"&&(se=se.toUpperCase()),se in t.image_compression?se:y.NONE}(z),de)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},B=t.__addimage__.convertBase64ToBinaryString=function(T,P){P=typeof P!="boolean"||P;var O,z="";if(typeof T=="string"){var ce;O=(ce=j(T))!==null&&ce!==void 0?ce:T;try{z=pE(O)}catch(de){if(P)throw w(O)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+de.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return z};t.getImageProperties=function(T){var P,O,z="";if(A(T)&&(T=h(T)),typeof T=="string"&&a(T)===r&&((z=B(T,!1))===""&&(z=t.loadFile(T)||""),T=z),O=a(T),!f(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(T instanceof Uint8Array||(T=_(T)),!(P=this["process"+O.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=O,P}})(rn.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};rn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var A=0;A<u.length;A++){n=u[A];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(p.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",s+=" /Popup "+x.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(v(y))+") >>",p.content=s;var b=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(s+=" /Open true"),s+=" >>",x.content=s,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var j=this.annotations._nameMap[n.options.name];n.options.pageNumber=j.page,n.options.top=j.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var I=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:o,type:"link"})},t.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(rn.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&a.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(p){var x=0,v=r,y="",b=0;for(x=0;x<p.length;x+=1)v[p.charCodeAt(x)]!==void 0?(b++,typeof(v=v[p.charCodeAt(x)])=="number"&&(y+=String.fromCharCode(v),v=r,b=0),x===p.length-1&&(v=r,y+=p.charAt(x-(b-1)),x-=b-1,b=0)):(v=r,y+=p.charAt(x-b),x-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(p,x,v){return o(p)?s(p)===!1?-1:!u(p)||!o(x)&&!o(v)||!o(v)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:d(p)&&o(x)&&!l(x)&&o(v)&&u(v)?3:l(p)||!o(v)?1:2:-1},h=function(p){var x=0,v=0,y=0,b="",w="",j="",I=(p=p||"").split("\\s+"),_=[];for(x=0;x<I.length;x+=1){for(_.push(""),v=0;v<I[x].length;v+=1)b=I[x][v],w=I[x][v-1],j=I[x][v+1],o(b)?(y=A(b,w,j),_[x]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):_[x]+=b;_[x]=f(_[x])}return _.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(x)){var y=0;for(v=[],y=0;y<x.length;y+=1)Array.isArray(x[y])?v.push([h(x[y][0]),x[y][1],x[y][2]]):v.push([h(x[y])]);p=v}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(rn.API),rn.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(rn.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),A=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,w){return b.concat(x.splitTextToSize(w,v))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:f})*d)&&(h=p);return h!==0&&(m=c.length),{w:h/=A,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&A&&(this.printHeaderRow(c.lineNumber,!0),c.y+=A[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,f,A){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,p,x,v=[],y=[],b=[],w={},j={},I=[],_=[],S=(A=A||{}).autoSize||!1,E=A.printHeaders!==!1,B=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,T=A.margins||Object.assign({width:this.getPageWidth()},e),P=typeof A.padding=="number"?A.padding:3,O=A.headerBackgroundColor||"#c8c8c8",z=A.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=O,this.internal.__cell__.headerTextColor=z,this.setFontSize(B),f==null)y=v=Object.keys(d[0]),b=v.map(function(){return"left"});else if(Array.isArray(f)&&es(f[0])==="object")for(v=f.map(function(ke){return ke.name}),y=f.map(function(ke){return ke.prompt||ke.name||""}),b=f.map(function(ke){return ke.align||"left"}),h=0;h<f.length;h+=1)j[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(y=v=f,b=v.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<v.length;h+=1){for(w[x=v[h]]=d.map(function(ke){return ke[x]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=w[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)I.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);j[x]=Math.max.apply(null,I)+P+P,I=[]}if(E){var ce={};for(h=0;h<v.length;h+=1)ce[v[h]]={},ce[v[h]].text=y[h],ce[v[h]].align=b[h];var de=l.call(this,ce,j);_=v.map(function(ke){return new s(c,u,j[ke],de,ce[ke].text,void 0,ce[ke].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var ue=f.reduce(function(ke,Re){return ke[Re.name]=Re.align,ke},{});for(h=0;h<d.length;h+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:h,data:d[h]},this);var me=l.call(this,d[h],j);for(p=0;p<v.length;p+=1){var se=d[h][v[p]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:h,col:p,data:se},this),o.call(this,new s(c,u,j[v[p]],me,se,h+2,ue[v[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/A+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,A.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}}(rn.API);var Fre={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ore=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Hk=kre(Ore),Dre=[100,200,300,400,500,600,700,800,900],Xje=kre(Dre);function A5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Fre[s=s||"normal"]?s:"normal"}(t.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),a=function(s){return typeof Hk[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,r,n].join(" ")}}}function EV(t,e,r,n){var a;for(a=r;a>=0&&a<e.length;a+=n)if(t[e[a]])return t[e[a]];for(a=r;a>=0&&a<e.length;a-=n)if(t[e[a]])return t[e[a]]}var Yje={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},SV={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function IV(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function jV(t){return t.trimLeft()}function Jje(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function Zje(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var DC,PV,BV,dx,RC,TV,kV,FV,m5=["times"];function OV(t,e,r,n,a){var s=4,o=RV;switch(a){case rn.API.image_compression.FAST:s=1,o=DV;break;case rn.API.image_compression.MEDIUM:s=6,o=MV;break;case rn.API.image_compression.SLOW:s=9,o=LV}t=function(c,u,d,f){for(var A,h=c.length/u,m=new Uint8Array(c.length+h),p=[ePe,DV,RV,MV,LV],x=0;x<h;x+=1){var v=x*u,y=c.subarray(v,v+u);if(f)m.set(f(y,d,A),v+x);else{for(var b=p.length,w=[],j=0;j<b;j+=1)w[j]=p[j](y,d,A);var I=rPe(w.concat());m.set(w[I],v+x)}A=y}return m}(t,e,Math.ceil(r*n/8),o);var l=Dk(t,{level:s});return rn.API.__addimage__.arrayBufferToBinaryString(l)}function ePe(t){var e=Array.apply([],t);return e.unshift(0),e}function DV(t,e){var r=t.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=t[a-e]||0;n[a+1]=t[a]-s+256&255}return n}function RV(t,e,r){var n=t.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=t[s]-o+256&255}return a}function MV(t,e,r){var n=t.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=t[s-e]||0,l=r&&r[s]||0;a[s+1]=t[s]+256-(o+l>>>1)&255}return a}function LV(t,e,r){var n=t.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=tPe(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);a[s+1]=t[s]-o+256&255}return a}function tPe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),a=Math.abs(t-r),s=Math.abs(t+e-r-r);return n<=a&&n<=s?t:a<=s?e:r}function rPe(t){var e=t.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function p5(t,e,r){var n=e*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return Rre(t,a)>>s&o}function UV(t,e,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var A=f>>8&255;u.setUint8(d,A)}})(t,s,Rre(t,s)&~(l<<o)&65535|c)}function Rre(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function nPe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,a=t[e++],s=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,d=[],f=0,A=null,h=0,m=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((T=t[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];f=t[e++]|t[e++]<<8,A=t[e++],1&p||(A=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((T=t[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++],j=w>>6&1,I=1<<1+(7&w),_=l,S=c,E=!1;w>>7&&(E=!0,_=e,S=I,e+=3*I);var B=e;for(e++;;){var T;if(!((T=t[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}d.push({x,y:v,width:y,height:b,has_local_palette:E,palette_offset:_,palette_size:S,data_offset:B,data_length:e-B,transparent_index:A,interlaced:!!j,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,O){var z=this.frameInfo(P),ce=z.width*z.height,de=new Uint8Array(ce);QV(t,z.data_offset,de,ce);var ue=z.palette_offset,me=z.transparent_index;me===null&&(me=256);var se=z.width,ke=r-se,Re=se,F=4*(z.y*r+z.x),H=4*((z.y+z.height)*r+z.x),K=F,L=4*ke;z.interlaced===!0&&(L+=4*r*7);for(var W=8,Y=0,D=de.length;Y<D;++Y){var Q=de[Y];if(Re===0&&(Re=se,(K+=L)>=H&&(L=4*ke+4*r*(W-1),K=F+(se+ke)*(W<<1),W>>=1)),Q===me)K+=4;else{var ee=t[ue+3*Q],ve=t[ue+3*Q+1],M=t[ue+3*Q+2];O[K++]=M,O[K++]=ve,O[K++]=ee,O[K++]=255}--Re}},this.decodeAndBlitFrameRGBA=function(P,O){var z=this.frameInfo(P),ce=z.width*z.height,de=new Uint8Array(ce);QV(t,z.data_offset,de,ce);var ue=z.palette_offset,me=z.transparent_index;me===null&&(me=256);var se=z.width,ke=r-se,Re=se,F=4*(z.y*r+z.x),H=4*((z.y+z.height)*r+z.x),K=F,L=4*ke;z.interlaced===!0&&(L+=4*r*7);for(var W=8,Y=0,D=de.length;Y<D;++Y){var Q=de[Y];if(Re===0&&(Re=se,(K+=L)>=H&&(L=4*ke+4*r*(W-1),K=F+(se+ke)*(W<<1),W>>=1)),Q===me)K+=4;else{var ee=t[ue+3*Q],ve=t[ue+3*Q+1],M=t[ue+3*Q+2];O[K++]=ee,O[K++]=ve,O[K++]=M,O[K++]=255}--Re}}}function QV(t,e,r,n){for(var a=t[e++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,d=0,f=0,A=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;d<16&&h!==0;)f|=t[e++]<<d,d+=8,h===1?h=t[e++]:--h;if(d<c)break;var x=f&u;if(f>>=c,d-=c,x!==s){if(x===o)break;for(var v=x<l?x:p,y=0,b=v;b>s;)b=m[b]>>8,++y;var w=b;if(A+y+(v!==x?1:0)>n)return void hs.log("Warning, gif stream longer than expected.");r[A++]=w;var j=A+=y;for(v!==x&&(r[A++]=w),b=v;y--;)b=m[b],r[--j]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|w,l>=u+1&&c<12&&(++c,u=u<<1|1)),p=x}else l=o+1,u=(1<<(c=a+1))-1,p=null}return A!==n&&hs.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function g5(t){var e,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),A=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,v=7,y=new Array(64),b=new Array(64),w=new Array(64),j=new Array(256),I=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function de(F,H){for(var K=0,L=0,W=new Array,Y=1;Y<=16;Y++){for(var D=1;D<=F[Y];D++)W[H[L]]=[],W[H[L]][0]=K,W[H[L]][1]=Y,L++,K++;K*=2}return W}function ue(F){for(var H=F[0],K=F[1]-1;K>=0;)H&1<<K&&(x|=1<<v),K--,--v<0&&(x==255?(me(255),me(0)):me(x),v=7,x=0)}function me(F){p.push(F)}function se(F){me(F>>8&255),me(255&F)}function ke(F,H,K,L,W){for(var Y,D=W[0],Q=W[240],ee=function(Xe,it){var xt,jt,Mt,Ft,$t,kt,Ge,ie,Ue,Ne,be=0;for(Ue=0;Ue<8;++Ue){xt=Xe[be],jt=Xe[be+1],Mt=Xe[be+2],Ft=Xe[be+3],$t=Xe[be+4],kt=Xe[be+5],Ge=Xe[be+6];var Ce=xt+(ie=Xe[be+7]),Le=xt-ie,Ae=jt+Ge,We=jt-Ge,ct=Mt+kt,_t=Mt-kt,pe=Ft+$t,Pe=Ft-$t,Ee=Ce+pe,Ze=Ce-pe,xe=Ae+ct,Se=Ae-ct;Xe[be]=Ee+xe,Xe[be+4]=Ee-xe;var gt=.707106781*(Se+Ze);Xe[be+2]=Ze+gt,Xe[be+6]=Ze-gt;var Et=.382683433*((Ee=Pe+_t)-(Se=We+Le)),Nt=.5411961*Ee+Et,Tt=1.306562965*Se+Et,Lt=.707106781*(xe=_t+We),Me=Le+Lt,_e=Le-Lt;Xe[be+5]=_e+Nt,Xe[be+3]=_e-Nt,Xe[be+1]=Me+Tt,Xe[be+7]=Me-Tt,be+=8}for(be=0,Ue=0;Ue<8;++Ue){xt=Xe[be],jt=Xe[be+8],Mt=Xe[be+16],Ft=Xe[be+24],$t=Xe[be+32],kt=Xe[be+40],Ge=Xe[be+48];var U=xt+(ie=Xe[be+56]),ye=xt-ie,te=jt+Ge,Ve=jt-Ge,qe=Mt+kt,G=Mt-kt,V=Ft+$t,Z=Ft-$t,re=U+V,we=U-V,Fe=te+qe,st=te-qe;Xe[be]=re+Fe,Xe[be+32]=re-Fe;var Be=.707106781*(st+we);Xe[be+16]=we+Be,Xe[be+48]=we-Be;var at=.382683433*((re=Z+G)-(st=Ve+ye)),lt=.5411961*re+at,dt=1.306562965*st+at,Pt=.707106781*(Fe=G+Ve),he=ye+Pt,ze=ye-Pt;Xe[be+40]=ze+lt,Xe[be+24]=ze-lt,Xe[be+8]=he+dt,Xe[be+56]=he-dt,be++}for(Ue=0;Ue<64;++Ue)Ne=Xe[Ue]*it[Ue],h[Ue]=Ne>0?Ne+.5|0:Ne-.5|0;return h}(F,H),ve=0;ve<64;++ve)m[_[ve]]=ee[ve];var M=m[0]-K;K=m[0],M==0?ue(L[0]):(ue(L[A[Y=32767+M]]),ue(f[Y]));for(var Ye=63;Ye>0&&m[Ye]==0;)Ye--;if(Ye==0)return ue(D),K;for(var ae,X=1;X<=Ye;){for(var De=X;m[X]==0&&X<=Ye;)++X;var le=X-De;if(le>=16){ae=le>>4;for(var $e=1;$e<=ae;++$e)ue(Q);le&=15}Y=32767+m[X],ue(W[(le<<4)+A[Y]]),ue(f[Y]),X++}return Ye!=63&&ue(D),K}function Re(F){F=Math.min(Math.max(F,1),100),s!=F&&(function(H){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var W=o((K[L]*H+50)/100);W=Math.min(Math.max(W,1),255),l[_[L]]=W}for(var Y=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],D=0;D<64;D++){var Q=o((Y[D]*H+50)/100);Q=Math.min(Math.max(Q,1),255),c[_[D]]=Q}for(var ee=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ve=0,M=0;M<8;M++)for(var Ye=0;Ye<8;Ye++)u[ve]=1/(l[_[ve]]*ee[M]*ee[Ye]*8),d[ve]=1/(c[_[ve]]*ee[M]*ee[Ye]*8),ve++}(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),s=F)}this.encode=function(F,H){H&&Re(H),p=new Array,x=0,v=7,se(65496),se(65504),se(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),se(1),se(1),me(0),me(0),function(){se(65499),se(132),me(0);for(var jt=0;jt<64;jt++)me(l[jt]);me(1);for(var Mt=0;Mt<64;Mt++)me(c[Mt])}(),function(jt,Mt){se(65472),se(17),me(8),se(Mt),se(jt),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)}(F.width,F.height),function(){se(65476),se(418),me(0);for(var jt=0;jt<16;jt++)me(S[jt+1]);for(var Mt=0;Mt<=11;Mt++)me(E[Mt]);me(16);for(var Ft=0;Ft<16;Ft++)me(B[Ft+1]);for(var $t=0;$t<=161;$t++)me(T[$t]);me(1);for(var kt=0;kt<16;kt++)me(P[kt+1]);for(var Ge=0;Ge<=11;Ge++)me(O[Ge]);me(17);for(var ie=0;ie<16;ie++)me(z[ie+1]);for(var Ue=0;Ue<=161;Ue++)me(ce[Ue])}(),se(65498),se(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var K=0,L=0,W=0;x=0,v=7,this.encode.displayName="_encode_";for(var Y,D,Q,ee,ve,M,Ye,ae,X,De=F.data,le=F.width,$e=F.height,Xe=4*le,it=0;it<$e;){for(Y=0;Y<Xe;){for(ve=Xe*it+Y,Ye=-1,ae=0,X=0;X<64;X++)M=ve+(ae=X>>3)*Xe+(Ye=4*(7&X)),it+ae>=$e&&(M-=Xe*(it+1+ae-$e)),Y+Ye>=Xe&&(M-=Y+Ye-Xe+4),D=De[M++],Q=De[M++],ee=De[M++],y[X]=(I[D]+I[Q+256|0]+I[ee+512|0]>>16)-128,b[X]=(I[D+768|0]+I[Q+1024|0]+I[ee+1280|0]>>16)-128,w[X]=(I[D+1280|0]+I[Q+1536|0]+I[ee+1792|0]>>16)-128;K=ke(y,u,K,e,n),L=ke(b,d,L,r,a),W=ke(w,d,W,r,a),Y+=32}it+=8}if(v>=0){var xt=[];xt[1]=v+1,xt[0]=(1<<v+1)-1,ue(xt)}return se(65497),new Uint8Array(p)},t=t||50,function(){for(var F=String.fromCharCode,H=0;H<256;H++)j[H]=F(H)}(),e=de(S,E),r=de(P,O),n=de(B,T),a=de(z,ce),function(){for(var F=1,H=2,K=1;K<=15;K++){for(var L=F;L<H;L++)A[32767+L]=K,f[32767+L]=[],f[32767+L][1]=K,f[32767+L][0]=L;for(var W=-(H-1);W<=-F;W++)A[32767+W]=K,f[32767+W]=[],f[32767+W][1]=K,f[32767+W][0]=H-1+W;F<<=1,H<<=1}}(),function(){for(var F=0;F<256;F++)I[F]=19595*F,I[F+256|0]=38470*F,I[F+512|0]=7471*F+32768,I[F+768|0]=-11059*F,I[F+1024|0]=-21709*F,I[F+1280|0]=32768*F+8421375,I[F+1536|0]=-27439*F,I[F+1792|0]=-5329*F}(),Re(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Wd(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function VV(t){function e(E){if(!E)throw Error("assert :P")}function r(E,B,T){for(var P=0;4>P;P++)if(E[B+P]!=T.charCodeAt(P))return!0;return!1}function n(E,B,T,P,O){for(var z=0;z<O;z++)E[B+z]=T[P+z]}function a(E,B,T,P){for(var O=0;O<P;O++)E[B+O]=T}function s(E){return new Int32Array(E)}function o(E,B){for(var T=[],P=0;P<E;P++)T.push(new B);return T}function l(E,B){var T=[];return function P(O,z,ce){for(var de=ce[z],ue=0;ue<de&&(O.push(ce.length>z+1?[]:new B),!(ce.length<z+1));ue++)P(O[ue],z+1,ce)}(T,0,E),T}var c=function(){var E=this;function B(N,k){for(var q=1<<k-1>>>0;N&q;)q>>>=1;return q?(N&q-1)+q:N}function T(N,k,q,oe,Te){e(!(oe%q));do N[k+(oe-=q)]=Te;while(0<oe)}function P(N,k,q,oe,Te){if(e(2328>=Te),512>=Te)var Qe=s(512);else if((Qe=s(Te))==null)return 0;return function(Ke,Je,rt,ft,Bt,Xt){var ht,Rt,Kt=Je,fr=1<<rt,Wt=s(16),pr=s(16);for(e(Bt!=0),e(ft!=null),e(Ke!=null),e(0<rt),Rt=0;Rt<Bt;++Rt){if(15<ft[Rt])return 0;++Wt[ft[Rt]]}if(Wt[0]==Bt)return 0;for(pr[1]=0,ht=1;15>ht;++ht){if(Wt[ht]>1<<ht)return 0;pr[ht+1]=pr[ht]+Wt[ht]}for(Rt=0;Rt<Bt;++Rt)ht=ft[Rt],0<ft[Rt]&&(Xt[pr[ht]++]=Rt);if(pr[15]==1)return(ft=new O).g=0,ft.value=Xt[0],T(Ke,Kt,1,fr,ft),fr;var gr,Tr=-1,Sr=fr-1,xn=0,on=1,Wn=1,fn=1<<rt;for(Rt=0,ht=1,Bt=2;ht<=rt;++ht,Bt<<=1){if(on+=Wn<<=1,0>(Wn-=Wt[ht]))return 0;for(;0<Wt[ht];--Wt[ht])(ft=new O).g=ht,ft.value=Xt[Rt++],T(Ke,Kt+xn,Bt,fn,ft),xn=B(xn,ht)}for(ht=rt+1,Bt=2;15>=ht;++ht,Bt<<=1){if(on+=Wn<<=1,0>(Wn-=Wt[ht]))return 0;for(;0<Wt[ht];--Wt[ht]){if(ft=new O,(xn&Sr)!=Tr){for(Kt+=fn,gr=1<<(Tr=ht)-rt;15>Tr&&!(0>=(gr-=Wt[Tr]));)++Tr,gr<<=1;fr+=fn=1<<(gr=Tr-rt),Ke[Je+(Tr=xn&Sr)].g=gr+rt,Ke[Je+Tr].value=Kt-Je-Tr}ft.g=ht-rt,ft.value=Xt[Rt++],T(Ke,Kt+(xn>>rt),Bt,fn,ft),xn=B(xn,ht)}}return on!=2*pr[15]-1?0:fr}(N,k,q,oe,Te,Qe)}function O(){this.value=this.g=0}function z(){this.value=this.g=0}function ce(){this.G=o(5,O),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Gm,z)}function de(N,k,q,oe){e(N!=null),e(k!=null),e(2147483648>oe),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=k,N.pa=q,N.Jd=k,N.Yc=q+oe,N.Zc=4<=oe?q+oe-4+1:q,D(N)}function ue(N,k){for(var q=0;0<k--;)q|=ee(N,128)<<k;return q}function me(N,k){var q=ue(N,k);return Q(N)?-q:q}function se(N,k,q,oe){var Te,Qe=0;for(e(N!=null),e(k!=null),e(4294967288>oe),N.Sb=oe,N.Ra=0,N.u=0,N.h=0,4<oe&&(oe=4),Te=0;Te<oe;++Te)Qe+=k[q+Te]<<8*Te;N.Ra=Qe,N.bb=oe,N.oa=k,N.pa=q}function ke(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<zA-8>>>0,++N.bb,N.u-=8;L(N)&&(N.h=1,N.u=0)}function Re(N,k){if(e(0<=k),!N.h&&k<=mu){var q=K(N)&Au[k];return N.u+=k,ke(N),q}return N.h=1,N.u=0}function F(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function K(N){return N.Ra>>>(N.u&zA-1)>>>0}function L(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>zA}function W(N,k){N.u=k,N.h=L(N)}function Y(N){N.u>=yh&&(e(N.u>=yh),ke(N))}function D(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function Q(N){return ue(N,1)}function ee(N,k){var q=N.Ca;0>N.b&&D(N);var oe=N.b,Te=q*k>>>8,Qe=(N.I>>>oe>Te)+0;for(Qe?(q-=Te,N.I-=Te+1<<oe>>>0):q=Te+1,oe=q,Te=0;256<=oe;)Te+=8,oe>>=8;return oe=7^Te+WA[oe],N.b-=oe,N.Ca=(q<<oe)-1,Qe}function ve(N,k,q){N[k+0]=q>>24&255,N[k+1]=q>>16&255,N[k+2]=q>>8&255,N[k+3]=255&q}function M(N,k){return N[k+0]|N[k+1]<<8}function Ye(N,k){return M(N,k)|N[k+2]<<16}function ae(N,k){return M(N,k)|M(N,k+2)<<16}function X(N,k){var q=1<<k;return e(N!=null),e(0<k),N.X=s(q),N.X==null?0:(N.Mb=32-k,N.Xa=k,1)}function De(N,k){e(N!=null),e(k!=null),e(N.Xa==k.Xa),n(k.X,0,N.X,0,1<<k.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function $e(N,k,q,oe){e(q!=null),e(oe!=null);var Te=q[0],Qe=oe[0];return Te==0&&(Te=(N*Qe+k/2)/k),Qe==0&&(Qe=(k*Te+N/2)/N),0>=Te||0>=Qe?0:(q[0]=Te,oe[0]=Qe,1)}function Xe(N,k){return N+(1<<k)-1>>>k}function it(N,k){return((4278255360&N)+(4278255360&k)>>>0&4278255360)+((16711935&N)+(16711935&k)>>>0&16711935)>>>0}function xt(N,k){E[k]=function(q,oe,Te,Qe,Ke,Je,rt){var ft;for(ft=0;ft<Ke;++ft){var Bt=E[N](Je[rt+ft-1],Te,Qe+ft);Je[rt+ft]=it(q[oe+ft],Bt)}}}function jt(){this.ud=this.hd=this.jd=0}function Mt(N,k){return((4278124286&(N^k))>>>1)+(N&k)>>>0}function Ft(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function $t(N,k){return Ft(N+(N-k+.5>>1))}function kt(N,k,q){return Math.abs(k-q)-Math.abs(N-q)}function Ge(N,k,q,oe,Te,Qe,Ke){for(oe=Qe[Ke-1],q=0;q<Te;++q)Qe[Ke+q]=oe=it(N[k+q],oe)}function ie(N,k,q,oe,Te){var Qe;for(Qe=0;Qe<q;++Qe){var Ke=N[k+Qe],Je=Ke>>8&255,rt=16711935&(rt=(rt=16711935&Ke)+((Je<<16)+Je));oe[Te+Qe]=(4278255360&Ke)+rt>>>0}}function Ue(N,k){k.jd=255&N,k.hd=N>>8&255,k.ud=N>>16&255}function Ne(N,k,q,oe,Te,Qe){var Ke;for(Ke=0;Ke<oe;++Ke){var Je=k[q+Ke],rt=Je>>>8,ft=Je,Bt=255&(Bt=(Bt=Je>>>16)+((N.jd<<24>>24)*(rt<<24>>24)>>>5));ft=255&(ft=(ft+=(N.hd<<24>>24)*(rt<<24>>24)>>>5)+((N.ud<<24>>24)*(Bt<<24>>24)>>>5)),Te[Qe+Ke]=(4278255360&Je)+(Bt<<16)+ft}}function be(N,k,q,oe,Te){E[k]=function(Qe,Ke,Je,rt,ft,Bt,Xt,ht,Rt){for(rt=Xt;rt<ht;++rt)for(Xt=0;Xt<Rt;++Xt)ft[Bt++]=Te(Je[oe(Qe[Ke++])])},E[N]=function(Qe,Ke,Je,rt,ft,Bt,Xt){var ht=8>>Qe.b,Rt=Qe.Ea,Kt=Qe.K[0],fr=Qe.w;if(8>ht)for(Qe=(1<<Qe.b)-1,fr=(1<<ht)-1;Ke<Je;++Ke){var Wt,pr=0;for(Wt=0;Wt<Rt;++Wt)Wt&Qe||(pr=oe(rt[ft++])),Bt[Xt++]=Te(Kt[pr&fr]),pr>>=ht}else E["VP8LMapColor"+q](rt,ft,Kt,fr,Bt,Xt,Ke,Je,Rt)}}function Ce(N,k,q,oe,Te){for(q=k+q;k<q;){var Qe=N[k++];oe[Te++]=Qe>>16&255,oe[Te++]=Qe>>8&255,oe[Te++]=255&Qe}}function Le(N,k,q,oe,Te){for(q=k+q;k<q;){var Qe=N[k++];oe[Te++]=Qe>>16&255,oe[Te++]=Qe>>8&255,oe[Te++]=255&Qe,oe[Te++]=Qe>>24&255}}function Ae(N,k,q,oe,Te){for(q=k+q;k<q;){var Qe=(Ke=N[k++])>>16&240|Ke>>12&15,Ke=240&Ke|Ke>>28&15;oe[Te++]=Qe,oe[Te++]=Ke}}function We(N,k,q,oe,Te){for(q=k+q;k<q;){var Qe=(Ke=N[k++])>>16&248|Ke>>13&7,Ke=Ke>>5&224|Ke>>3&31;oe[Te++]=Qe,oe[Te++]=Ke}}function ct(N,k,q,oe,Te){for(q=k+q;k<q;){var Qe=N[k++];oe[Te++]=255&Qe,oe[Te++]=Qe>>8&255,oe[Te++]=Qe>>16&255}}function _t(N,k,q,oe,Te,Qe){if(Qe==0)for(q=k+q;k<q;)ve(oe,((Qe=N[k++])[0]>>24|Qe[1]>>8&65280|Qe[2]<<8&16711680|Qe[3]<<24)>>>0),Te+=32;else n(oe,Te,N,k,q)}function pe(N,k){E[k][0]=E[N+"0"],E[k][1]=E[N+"1"],E[k][2]=E[N+"2"],E[k][3]=E[N+"3"],E[k][4]=E[N+"4"],E[k][5]=E[N+"5"],E[k][6]=E[N+"6"],E[k][7]=E[N+"7"],E[k][8]=E[N+"8"],E[k][9]=E[N+"9"],E[k][10]=E[N+"10"],E[k][11]=E[N+"11"],E[k][12]=E[N+"12"],E[k][13]=E[N+"13"],E[k][14]=E[N+"0"],E[k][15]=E[N+"0"]}function Pe(N){return N==P3||N==B3||N==CN||N==T3}function Ee(){this.eb=[],this.size=this.A=this.fb=0}function Ze(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function xe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ee,this.f.kb=new Ze,this.sd=null}function Se(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function gt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Et(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function Nt(N,k){var q=N.T,oe=k.ba.f.RGBA,Te=oe.eb,Qe=oe.fb+N.ka*oe.A,Ke=Zu[k.ba.S],Je=N.y,rt=N.O,ft=N.f,Bt=N.N,Xt=N.ea,ht=N.W,Rt=k.cc,Kt=k.dc,fr=k.Mc,Wt=k.Nc,pr=N.ka,gr=N.ka+N.T,Tr=N.U,Sr=Tr+1>>1;for(pr==0?Ke(Je,rt,null,null,ft,Bt,Xt,ht,ft,Bt,Xt,ht,Te,Qe,null,null,Tr):(Ke(k.ec,k.fc,Je,rt,Rt,Kt,fr,Wt,ft,Bt,Xt,ht,Te,Qe-oe.A,Te,Qe,Tr),++q);pr+2<gr;pr+=2)Rt=ft,Kt=Bt,fr=Xt,Wt=ht,Bt+=N.Rc,ht+=N.Rc,Qe+=2*oe.A,Ke(Je,(rt+=2*N.fa)-N.fa,Je,rt,Rt,Kt,fr,Wt,ft,Bt,Xt,ht,Te,Qe-oe.A,Te,Qe,Tr);return rt+=N.fa,N.j+gr<N.o?(n(k.ec,k.fc,Je,rt,Tr),n(k.cc,k.dc,ft,Bt,Sr),n(k.Mc,k.Nc,Xt,ht,Sr),q--):1&gr||Ke(Je,rt,null,null,ft,Bt,Xt,ht,ft,Bt,Xt,ht,Te,Qe+oe.A,null,null,Tr),q}function Tt(N,k,q){var oe=N.F,Te=[N.J];if(oe!=null){var Qe=N.U,Ke=k.ba.S,Je=Ke==NN||Ke==CN;k=k.ba.f.RGBA;var rt=[0],ft=N.ka;rt[0]=N.T,N.Kb&&(ft==0?--rt[0]:(--ft,Te[0]-=N.width),N.j+N.ka+N.T==N.o&&(rt[0]=N.o-N.j-ft));var Bt=k.eb;ft=k.fb+ft*k.A,N=W8(oe,Te[0],N.width,Qe,rt,Bt,ft+(Je?0:3),k.A),e(q==rt),N&&Pe(Ke)&&Q1(Bt,ft,Je,Qe,rt,k.A)}return 0}function Lt(N){var k=N.ma,q=k.ba.S,oe=11>q,Te=q==bN||q==wN||q==NN||q==j3||q==12||Pe(q);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!k1(k.Oa,N,Te?11:12))return 0;if(Te&&Pe(q)&&Xu(),N.da)alert("todo:use_scaling");else{if(oe){if(k.Ib=Et,N.Kb){if(q=N.U+1>>1,k.memory=s(N.U+2*q),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+N.U,k.Mc=k.cc,k.Nc=k.dc+q,k.Ib=Nt,Xu()}}else alert("todo:EmitYUV");Te&&(k.Jb=Tt,oe&&Uc())}if(oe&&!dL){for(N=0;256>N;++N)Sde[N]=89858*(N-128)+EN>>_N,Pde[N]=-22014*(N-128)+EN,jde[N]=-45773*(N-128),Ide[N]=113618*(N-128)+EN>>_N;for(N=H1;N<O3;++N)k=76283*(N-16)+EN>>_N,Bde[N-H1]=nr(k,255),Tde[N-H1]=nr(k+8>>4,15);dL=1}return 1}function Me(N){var k=N.ma,q=N.U,oe=N.T;return e(!(1&N.ka)),0>=q||0>=oe?0:(q=k.Ib(N,k),k.Jb!=null&&k.Jb(N,k,q),k.Dc+=q,1)}function _e(N){N.ma.memory=null}function U(N,k,q,oe){return Re(N,8)!=47?0:(k[0]=Re(N,14)+1,q[0]=Re(N,14)+1,oe[0]=Re(N,1),Re(N,3)!=0?0:!N.h)}function ye(N,k){if(4>N)return N+1;var q=N-2>>1;return(2+(1&N)<<q)+Re(k,q)+1}function te(N,k){return 120<k?k-120:1<=(q=((q=hde[k-1])>>4)*N+(8-(15&q)))?q:1;var q}function Ve(N,k,q){var oe=K(q),Te=N[k+=255&oe].g-8;return 0<Te&&(W(q,q.u+8),oe=K(q),k+=N[k].value,k+=oe&(1<<Te)-1),W(q,q.u+N[k].g),N[k].value}function qe(N,k,q){return q.g+=N.g,q.value+=N.value<<k>>>0,e(8>=q.g),N.g}function G(N,k,q){var oe=N.xc;return e((k=oe==0?0:N.vc[N.md*(q>>oe)+(k>>oe)])<N.Wb),N.Ya[k]}function V(N,k,q,oe){var Te=N.ab,Qe=N.c*k,Ke=N.C;k=Ke+k;var Je=q,rt=oe;for(oe=N.Ta,q=N.Ua;0<Te--;){var ft=N.gc[Te],Bt=Ke,Xt=k,ht=Je,Rt=rt,Kt=(rt=oe,Je=q,ft.Ea);switch(e(Bt<Xt),e(Xt<=ft.nc),ft.hc){case 2:Pi(ht,Rt,(Xt-Bt)*Kt,rt,Je);break;case 0:var fr=Bt,Wt=Xt,pr=rt,gr=Je,Tr=(fn=ft).Ea;fr==0&&(O1(ht,Rt,null,null,1,pr,gr),Ge(ht,Rt+1,0,0,Tr-1,pr,gr+1),Rt+=Tr,gr+=Tr,++fr);for(var Sr=1<<fn.b,xn=Sr-1,on=Xe(Tr,fn.b),Wn=fn.K,fn=fn.w+(fr>>fn.b)*on;fr<Wt;){var pa=Wn,Ao=fn,Xn=1;for(zg(ht,Rt,pr,gr-Tr,1,pr,gr);Xn<Tr;){var hn=(Xn&~xn)+Sr;hn>Tr&&(hn=Tr),(0,R1[pa[Ao++]>>8&15])(ht,Rt+ +Xn,pr,gr+Xn-Tr,hn-Xn,pr,gr+Xn),Xn=hn}Rt+=Tr,gr+=Tr,++fr&xn||(fn+=on)}Xt!=ft.nc&&n(rt,Je-Kt,rt,Je+(Xt-Bt-1)*Kt,Kt);break;case 1:for(Kt=ht,Wt=Rt,Tr=(ht=ft.Ea)-(gr=ht&~(pr=(Rt=1<<ft.b)-1)),fr=Xe(ht,ft.b),Sr=ft.K,ft=ft.w+(Bt>>ft.b)*fr;Bt<Xt;){for(xn=Sr,on=ft,Wn=new jt,fn=Wt+gr,pa=Wt+ht;Wt<fn;)Ue(xn[on++],Wn),M1(Wn,Kt,Wt,Rt,rt,Je),Wt+=Rt,Je+=Rt;Wt<pa&&(Ue(xn[on++],Wn),M1(Wn,Kt,Wt,Tr,rt,Je),Wt+=Tr,Je+=Tr),++Bt&pr||(ft+=fr)}break;case 3:if(ht==rt&&Rt==Je&&0<ft.b){for(Wt=rt,ht=Kt=Je+(Xt-Bt)*Kt-(gr=(Xt-Bt)*Xe(ft.Ea,ft.b)),Rt=rt,pr=Je,fr=[],gr=(Tr=gr)-1;0<=gr;--gr)fr[gr]=Rt[pr+gr];for(gr=Tr-1;0<=gr;--gr)Wt[ht+gr]=fr[gr];gN(ft,Bt,Xt,rt,Kt,rt,Je)}else gN(ft,Bt,Xt,ht,Rt,rt,Je)}Je=oe,rt=q}rt!=q&&n(oe,q,Je,rt,Qe)}function Z(N,k){var q=N.V,oe=N.Ba+N.c*N.C,Te=k-N.C;if(e(k<=N.l.o),e(16>=Te),0<Te){var Qe=N.l,Ke=N.Ta,Je=N.Ua,rt=Qe.width;if(V(N,Te,q,oe),Te=Je=[Je],e((q=N.C)<(oe=k)),e(Qe.v<Qe.va),oe>Qe.o&&(oe=Qe.o),q<Qe.j){var ft=Qe.j-q;q=Qe.j,Te[0]+=ft*rt}if(q>=oe?q=0:(Te[0]+=4*Qe.v,Qe.ka=q-Qe.j,Qe.U=Qe.va-Qe.v,Qe.T=oe-q,q=1),q){if(Je=Je[0],11>(q=N.ca).S){var Bt=q.f.RGBA,Xt=(oe=q.S,Te=Qe.U,Qe=Qe.T,ft=Bt.eb,Bt.A),ht=Qe;for(Bt=Bt.fb+N.Ma*Bt.A;0<ht--;){var Rt=Ke,Kt=Je,fr=Te,Wt=ft,pr=Bt;switch(oe){case yN:L1(Rt,Kt,fr,Wt,pr);break;case bN:XA(Rt,Kt,fr,Wt,pr);break;case P3:XA(Rt,Kt,fr,Wt,pr),Q1(Wt,pr,0,fr,1,0);break;case rL:Km(Rt,Kt,fr,Wt,pr);break;case wN:_t(Rt,Kt,fr,Wt,pr,1);break;case B3:_t(Rt,Kt,fr,Wt,pr,1),Q1(Wt,pr,0,fr,1,0);break;case NN:_t(Rt,Kt,fr,Wt,pr,0);break;case CN:_t(Rt,Kt,fr,Wt,pr,0),Q1(Wt,pr,1,fr,1,0);break;case j3:YA(Rt,Kt,fr,Wt,pr);break;case T3:YA(Rt,Kt,fr,Wt,pr),z8(Wt,pr,fr,1,0);break;case nL:JA(Rt,Kt,fr,Wt,pr);break;default:e(0)}Je+=rt,Bt+=Xt}N.Ma+=Qe}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=q.height)}}N.C=k,e(N.C<=N.i)}function re(N){var k;if(0<N.ua)return 0;for(k=0;k<N.Wb;++k){var q=N.Ya[k].G,oe=N.Ya[k].H;if(0<q[1][oe[1]+0].g||0<q[2][oe[2]+0].g||0<q[3][oe[3]+0].g)return 0}return 1}function we(N,k,q,oe,Te,Qe){if(N.Z!=0){var Ke=N.qd,Je=N.rd;for(e(t0[N.Z]!=null);k<q;++k)t0[N.Z](Ke,Je,oe,Te,oe,Te,Qe),Ke=oe,Je=Te,Te+=Qe;N.qd=Ke,N.rd=Je}}function Fe(N,k){var q=N.l.ma,oe=q.Z==0||q.Z==1?N.l.j:N.C;if(oe=N.C<oe?oe:N.C,e(k<=N.l.o),k>oe){var Te=N.l.width,Qe=q.ca,Ke=q.tb+Te*oe,Je=N.V,rt=N.Ba+N.c*oe,ft=N.gc;e(N.ab==1),e(ft[0].hc==3),kf(ft[0],oe,k,Je,rt,Qe,Ke),we(q,oe,k,Qe,Ke,Te)}N.C=N.Ma=k}function st(N,k,q,oe,Te,Qe,Ke){var Je=N.$/oe,rt=N.$%oe,ft=N.m,Bt=N.s,Xt=q+N.$,ht=Xt;Te=q+oe*Te;var Rt=q+oe*Qe,Kt=280+Bt.ua,fr=N.Pb?Je:16777216,Wt=0<Bt.ua?Bt.Wa:null,pr=Bt.wc,gr=Xt<Rt?G(Bt,rt,Je):null;e(N.C<Qe),e(Rt<=Te);var Tr=!1;e:for(;;){for(;Tr||Xt<Rt;){var Sr=0;if(Je>=fr){var xn=Xt-q;e((fr=N).Pb),fr.wd=fr.m,fr.xd=xn,0<fr.s.ua&&De(fr.s.Wa,fr.s.vb),fr=Je+mde}if(rt&pr||(gr=G(Bt,rt,Je)),e(gr!=null),gr.Qb&&(k[Xt]=gr.qb,Tr=!0),!Tr)if(Y(ft),gr.jc){Sr=ft,xn=k;var on=Xt,Wn=gr.pd[K(Sr)&Gm-1];e(gr.jc),256>Wn.g?(W(Sr,Sr.u+Wn.g),xn[on]=Wn.value,Sr=0):(W(Sr,Sr.u+Wn.g-256),e(256<=Wn.value),Sr=Wn.value),Sr==0&&(Tr=!0)}else Sr=Ve(gr.G[0],gr.H[0],ft);if(ft.h)break;if(Tr||256>Sr){if(!Tr)if(gr.nd)k[Xt]=(gr.qb|Sr<<8)>>>0;else{if(Y(ft),Tr=Ve(gr.G[1],gr.H[1],ft),Y(ft),xn=Ve(gr.G[2],gr.H[2],ft),on=Ve(gr.G[3],gr.H[3],ft),ft.h)break;k[Xt]=(on<<24|Tr<<16|Sr<<8|xn)>>>0}if(Tr=!1,++Xt,++rt>=oe&&(rt=0,++Je,Ke!=null&&Je<=Qe&&!(Je%16)&&Ke(N,Je),Wt!=null))for(;ht<Xt;)Sr=k[ht++],Wt.X[(506832829*Sr&4294967295)>>>Wt.Mb]=Sr}else if(280>Sr){if(Sr=ye(Sr-256,ft),xn=Ve(gr.G[4],gr.H[4],ft),Y(ft),xn=te(oe,xn=ye(xn,ft)),ft.h)break;if(Xt-q<xn||Te-Xt<Sr)break e;for(on=0;on<Sr;++on)k[Xt+on]=k[Xt+on-xn];for(Xt+=Sr,rt+=Sr;rt>=oe;)rt-=oe,++Je,Ke!=null&&Je<=Qe&&!(Je%16)&&Ke(N,Je);if(e(Xt<=Te),rt&pr&&(gr=G(Bt,rt,Je)),Wt!=null)for(;ht<Xt;)Sr=k[ht++],Wt.X[(506832829*Sr&4294967295)>>>Wt.Mb]=Sr}else{if(!(Sr<Kt))break e;for(Tr=Sr-280,e(Wt!=null);ht<Xt;)Sr=k[ht++],Wt.X[(506832829*Sr&4294967295)>>>Wt.Mb]=Sr;Sr=Xt,e(!(Tr>>>(xn=Wt).Xa)),k[Sr]=xn.X[Tr],Tr=!0}Tr||e(ft.h==L(ft))}if(N.Pb&&ft.h&&Xt<Te)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&De(N.s.vb,N.s.Wa);else{if(ft.h)break e;Ke!=null&&Ke(N,Je>Qe?Qe:Je),N.a=0,N.$=Xt-q}return 1}return N.a=3,0}function Be(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var k=N.Wa;k!=null&&(k.X=null),N.vb=null,e(N!=null)}function at(){var N=new Tn;return N==null?null:(N.a=0,N.xb=iL,pe("Predictor","VP8LPredictors"),pe("Predictor","VP8LPredictors_C"),pe("PredictorAdd","VP8LPredictorsAdd"),pe("PredictorAdd","VP8LPredictorsAdd_C"),Pi=ie,M1=Ne,L1=Ce,XA=Le,YA=Ae,JA=We,Km=ct,E.VP8LMapColor32b=Tf,E.VP8LMapColor8b=D1,N)}function lt(N,k,q,oe,Te){var Qe=1,Ke=[N],Je=[k],rt=oe.m,ft=oe.s,Bt=null,Xt=0;e:for(;;){if(q)for(;Qe&&Re(rt,1);){var ht=Ke,Rt=Je,Kt=oe,fr=1,Wt=Kt.m,pr=Kt.gc[Kt.ab],gr=Re(Wt,2);if(Kt.Oc&1<<gr)Qe=0;else{switch(Kt.Oc|=1<<gr,pr.hc=gr,pr.Ea=ht[0],pr.nc=Rt[0],pr.K=[null],++Kt.ab,e(4>=Kt.ab),gr){case 0:case 1:pr.b=Re(Wt,3)+2,fr=lt(Xe(pr.Ea,pr.b),Xe(pr.nc,pr.b),0,Kt,pr.K),pr.K=pr.K[0];break;case 3:var Tr,Sr=Re(Wt,8)+1,xn=16<Sr?0:4<Sr?1:2<Sr?2:3;if(ht[0]=Xe(pr.Ea,xn),pr.b=xn,Tr=fr=lt(Sr,1,0,Kt,pr.K)){var on,Wn=Sr,fn=pr,pa=1<<(8>>fn.b),Ao=s(pa);if(Ao==null)Tr=0;else{var Xn=fn.K[0],hn=fn.w;for(Ao[0]=fn.K[0][0],on=1;on<1*Wn;++on)Ao[on]=it(Xn[hn+on],Ao[on-1]);for(;on<4*pa;++on)Ao[on]=0;fn.K[0]=null,fn.K[0]=Ao,Tr=1}}fr=Tr;break;case 2:break;default:e(0)}Qe=fr}}if(Ke=Ke[0],Je=Je[0],Qe&&Re(rt,1)&&!(Qe=1<=(Xt=Re(rt,4))&&11>=Xt)){oe.a=3;break e}var qr;if(qr=Qe)t:{var Ti,$n,va,_s=oe,ul=Ke,fc=Je,xi=Xt,Rl=q,hc=_s.m,mo=_s.s,wa=[null],Ha=1,vi=0,$a=Ade[xi];r:for(;;){if(Rl&&Re(hc,1)){var dl=Re(hc,3)+2,Kd=Xe(ul,dl),ki=Xe(fc,dl),Qc=Kd*ki;if(!lt(Kd,ki,0,_s,wa))break r;for(wa=wa[0],mo.xc=dl,Ti=0;Ti<Qc;++Ti){var fs=wa[Ti]>>8&65535;wa[Ti]=fs,fs>=Ha&&(Ha=fs+1)}}if(hc.h)break r;for($n=0;5>$n;++$n){var po=aL[$n];!$n&&0<xi&&(po+=1<<xi),vi<po&&(vi=po)}var gu=o(Ha*$a,O),Ac=Ha,xu=o(Ac,ce);if(xu==null)var vu=null;else e(65536>=Ac),vu=xu;var Vc=s(vi);if(vu==null||Vc==null||gu==null){_s.a=1;break r}var yu=gu;for(Ti=va=0;Ti<Ha;++Ti){var xs=vu[Ti],bu=xs.G,qd=xs.H,zm=0,Nh=1,fl=0;for($n=0;5>$n;++$n){po=aL[$n],bu[$n]=yu,qd[$n]=va,!$n&&0<xi&&(po+=1<<xi);a:{var IN,D3=po,jN=_s,$1=Vc,Ode=yu,Dde=va,R3=0,r0=jN.m,Rde=Re(r0,1);if(a($1,0,0,D3),Rde){var Mde=Re(r0,1)+1,Lde=Re(r0,1),AL=Re(r0,Lde==0?1:8);$1[AL]=1,Mde==2&&($1[AL=Re(r0,8)]=1);var PN=1}else{var mL=s(19),pL=Re(r0,4)+4;if(19<pL){jN.a=3;var BN=0;break a}for(IN=0;IN<pL;++IN)mL[fde[IN]]=Re(r0,3);var M3=void 0,G1=void 0,gL=jN,Ude=mL,TN=D3,xL=$1,L3=0,n0=gL.m,vL=8,yL=o(128,O);n:for(;P(yL,0,7,Ude,19);){if(Re(n0,1)){var Qde=2+2*Re(n0,3);if((M3=2+Re(n0,Qde))>TN)break n}else M3=TN;for(G1=0;G1<TN&&M3--;){Y(n0);var bL=yL[0+(127&K(n0))];W(n0,n0.u+bL.g);var Xg=bL.value;if(16>Xg)xL[G1++]=Xg,Xg!=0&&(vL=Xg);else{var Vde=Xg==16,wL=Xg-16,Hde=ude[wL],NL=Re(n0,cde[wL])+Hde;if(G1+NL>TN)break n;for(var $de=Vde?vL:0;0<NL--;)xL[G1++]=$de}}L3=1;break n}L3||(gL.a=3),PN=L3}(PN=PN&&!r0.h)&&(R3=P(Ode,Dde,8,$1,D3)),PN&&R3!=0?BN=R3:(jN.a=3,BN=0)}if(BN==0)break r;if(Nh&&dde[$n]==1&&(Nh=yu[va].g==0),zm+=yu[va].g,va+=BN,3>=$n){var K1,U3=Vc[0];for(K1=1;K1<po;++K1)Vc[K1]>U3&&(U3=Vc[K1]);fl+=U3}}if(xs.nd=Nh,xs.Qb=0,Nh&&(xs.qb=(bu[3][qd[3]+0].value<<24|bu[1][qd[1]+0].value<<16|bu[2][qd[2]+0].value)>>>0,zm==0&&256>bu[0][qd[0]+0].value&&(xs.Qb=1,xs.qb+=bu[0][qd[0]+0].value<<8)),xs.jc=!xs.Qb&&6>fl,xs.jc){var kN,Ch=xs;for(kN=0;kN<Gm;++kN){var a0=kN,s0=Ch.pd[a0],FN=Ch.G[0][Ch.H[0]+a0];256<=FN.value?(s0.g=FN.g+256,s0.value=FN.value):(s0.g=0,s0.value=0,a0>>=qe(FN,8,s0),a0>>=qe(Ch.G[1][Ch.H[1]+a0],16,s0),a0>>=qe(Ch.G[2][Ch.H[2]+a0],0,s0),qe(Ch.G[3][Ch.H[3]+a0],24,s0))}}}mo.vc=wa,mo.Wb=Ha,mo.Ya=vu,mo.yc=gu,qr=1;break t}qr=0}if(!(Qe=qr)){oe.a=3;break e}if(0<Xt){if(ft.ua=1<<Xt,!X(ft.Wa,Xt)){oe.a=1,Qe=0;break e}}else ft.ua=0;var Q3=oe,CL=Ke,Gde=Je,V3=Q3.s,H3=V3.xc;if(Q3.c=CL,Q3.i=Gde,V3.md=Xe(CL,H3),V3.wc=H3==0?-1:(1<<H3)-1,q){oe.xb=wde;break e}if((Bt=s(Ke*Je))==null){oe.a=1,Qe=0;break e}Qe=(Qe=st(oe,Bt,0,Ke,Je,Je,null))&&!rt.h;break e}return Qe?(Te!=null?Te[0]=Bt:(e(Bt==null),e(q)),oe.$=0,q||Be(ft)):Be(ft),Qe}function dt(N,k){var q=N.c*N.i,oe=q+k+16*k;return e(N.c<=k),N.V=s(oe),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+q+k,1)}function Pt(N,k){var q=N.C,oe=k-q,Te=N.V,Qe=N.Ba+N.c*q;for(e(k<=N.l.o);0<oe;){var Ke=16<oe?16:oe,Je=N.l.ma,rt=N.l.width,ft=rt*Ke,Bt=Je.ca,Xt=Je.tb+rt*q,ht=N.Ta,Rt=N.Ua;V(N,Ke,Te,Qe),X8(ht,Rt,Bt,Xt,ft),we(Je,q,q+Ke,Bt,Xt,rt),oe-=Ke,Te+=Ke*N.c,q+=Ke}e(q==k),N.C=N.Ma=k}function he(){this.ub=this.yd=this.td=this.Rb=0}function ze(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function ne(){this.Yb=function(){var N=[];return function k(q,oe,Te){for(var Qe=Te[oe],Ke=0;Ke<Qe&&(q.push(Te.length>oe+1?[]:0),!(Te.length<oe+1));Ke++)k(q[Ke],oe+1,Te)}(N,0,[3,11]),N}()}function He(){this.jb=s(3),this.Wc=l([4,8],ne),this.Xc=l([4,17],ne)}function pt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Dt(){this.ld=this.La=this.dd=this.tc=0}function rr(){this.Na=this.la=0}function zt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ot(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function lr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Dt),this.Y=0,this.ya=Array(new Ot),this.aa=0,this.l=new ir}function Dr(){this.y=s(16),this.f=s(8),this.ea=s(8)}function br(){this.cb=this.a=0,this.sc="",this.m=new F,this.Od=new he,this.Kc=new ze,this.ed=new pt,this.Qa=new nt,this.Ic=this.$c=this.Aa=0,this.D=new lr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,F),this.ia=0,this.pb=o(4,zt),this.Pa=new He,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Dr),this.Hd=0,this.rb=Array(new rr),this.sb=0,this.wa=Array(new Dt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ot),this.L=this.aa=0,this.gd=l([4,2],Dt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function nr(N,k){return 0>N?0:N>k?k:N}function ir(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Nr(){var N=new br;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,V1||(V1=cr)),N}function Pr(N,k,q){return N.a==0&&(N.a=k,N.sc=q,N.cb=0),0}function xr(N,k,q){return 3<=q&&N[k+0]==157&&N[k+1]==1&&N[k+2]==42}function $r(N,k){if(N==null)return 0;if(N.a=0,N.sc="OK",k==null)return Pr(N,2,"null VP8Io passed to VP8GetHeaders()");var q=k.data,oe=k.w,Te=k.ha;if(4>Te)return Pr(N,7,"Truncated header.");var Qe=q[oe+0]|q[oe+1]<<8|q[oe+2]<<16,Ke=N.Od;if(Ke.Rb=!(1&Qe),Ke.td=Qe>>1&7,Ke.yd=Qe>>4&1,Ke.ub=Qe>>5,3<Ke.td)return Pr(N,3,"Incorrect keyframe parameters.");if(!Ke.yd)return Pr(N,4,"Frame not displayable.");oe+=3,Te-=3;var Je=N.Kc;if(Ke.Rb){if(7>Te)return Pr(N,7,"cannot parse picture header");if(!xr(q,oe,Te))return Pr(N,3,"Bad code word");Je.c=16383&(q[oe+4]<<8|q[oe+3]),Je.Td=q[oe+4]>>6,Je.i=16383&(q[oe+6]<<8|q[oe+5]),Je.Ud=q[oe+6]>>6,oe+=7,Te-=7,N.za=Je.c+15>>4,N.Ub=Je.i+15>>4,k.width=Je.c,k.height=Je.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,a((Qe=N.Pa).jb,0,255,Qe.jb.length),e((Qe=N.Qa)!=null),Qe.Cb=0,Qe.Bb=0,Qe.Fb=1,a(Qe.Zb,0,0,Qe.Zb.length),a(Qe.Lb,0,0,Qe.Lb)}if(Ke.ub>Te)return Pr(N,7,"bad partition length");de(Qe=N.m,q,oe,Ke.ub),oe+=Ke.ub,Te-=Ke.ub,Ke.Rb&&(Je.Ld=Q(Qe),Je.Kd=Q(Qe)),Je=N.Qa;var rt,ft=N.Pa;if(e(Qe!=null),e(Je!=null),Je.Cb=Q(Qe),Je.Cb){if(Je.Bb=Q(Qe),Q(Qe)){for(Je.Fb=Q(Qe),rt=0;4>rt;++rt)Je.Zb[rt]=Q(Qe)?me(Qe,7):0;for(rt=0;4>rt;++rt)Je.Lb[rt]=Q(Qe)?me(Qe,6):0}if(Je.Bb)for(rt=0;3>rt;++rt)ft.jb[rt]=Q(Qe)?ue(Qe,8):255}else Je.Bb=0;if(Qe.Ka)return Pr(N,3,"cannot parse segment header");if((Je=N.ed).zd=Q(Qe),Je.Tb=ue(Qe,6),Je.wb=ue(Qe,3),Je.Pc=Q(Qe),Je.Pc&&Q(Qe)){for(ft=0;4>ft;++ft)Q(Qe)&&(Je.vd[ft]=me(Qe,6));for(ft=0;4>ft;++ft)Q(Qe)&&(Je.od[ft]=me(Qe,6))}if(N.L=Je.Tb==0?0:Je.zd?1:2,Qe.Ka)return Pr(N,3,"cannot parse filter header");var Bt=Te;if(Te=rt=oe,oe=rt+Bt,Je=Bt,N.Xb=(1<<ue(N.m,2))-1,Bt<3*(ft=N.Xb))q=7;else{for(rt+=3*ft,Je-=3*ft,Bt=0;Bt<ft;++Bt){var Xt=q[Te+0]|q[Te+1]<<8|q[Te+2]<<16;Xt>Je&&(Xt=Je),de(N.Jc[+Bt],q,rt,Xt),rt+=Xt,Je-=Xt,Te+=3}de(N.Jc[+ft],q,rt,Je),q=rt<oe?0:5}if(q!=0)return Pr(N,q,"cannot parse partitions");for(q=ue(rt=N.m,7),Te=Q(rt)?me(rt,4):0,oe=Q(rt)?me(rt,4):0,Je=Q(rt)?me(rt,4):0,ft=Q(rt)?me(rt,4):0,rt=Q(rt)?me(rt,4):0,Bt=N.Qa,Xt=0;4>Xt;++Xt){if(Bt.Cb){var ht=Bt.Zb[Xt];Bt.Fb||(ht+=q)}else{if(0<Xt){N.pb[Xt]=N.pb[0];continue}ht=q}var Rt=N.pb[Xt];Rt.Sc[0]=k3[nr(ht+Te,127)],Rt.Sc[1]=F3[nr(ht+0,127)],Rt.Eb[0]=2*k3[nr(ht+oe,127)],Rt.Eb[1]=101581*F3[nr(ht+Je,127)]>>16,8>Rt.Eb[1]&&(Rt.Eb[1]=8),Rt.Qc[0]=k3[nr(ht+ft,117)],Rt.Qc[1]=F3[nr(ht+rt,127)],Rt.lc=ht+rt}if(!Ke.Rb)return Pr(N,4,"Not a key frame.");for(Q(Qe),Ke=N.Pa,q=0;4>q;++q){for(Te=0;8>Te;++Te)for(oe=0;3>oe;++oe)for(Je=0;11>Je;++Je)ft=ee(Qe,yde[q][Te][oe][Je])?ue(Qe,8):xde[q][Te][oe][Je],Ke.Wc[q][Te].Yb[oe][Je]=ft;for(Te=0;17>Te;++Te)Ke.Xc[q][Te]=Ke.Wc[q][bde[Te]]}return N.kc=Q(Qe),N.kc&&(N.Bd=ue(Qe,8)),N.cb=1}function cr(N,k,q,oe,Te,Qe,Ke){var Je=k[Te].Yb[q];for(q=0;16>Te;++Te){if(!ee(N,Je[q+0]))return Te;for(;!ee(N,Je[q+1]);)if(Je=k[++Te].Yb[0],q=0,Te==16)return 16;var rt=k[Te+1].Yb;if(ee(N,Je[q+2])){var ft=N,Bt=0;if(ee(ft,(ht=Je)[(Xt=q)+3]))if(ee(ft,ht[Xt+6])){for(Je=0,Xt=2*(Bt=ee(ft,ht[Xt+8]))+(ht=ee(ft,ht[Xt+9+Bt])),Bt=0,ht=pde[Xt];ht[Je];++Je)Bt+=Bt+ee(ft,ht[Je]);Bt+=3+(8<<Xt)}else ee(ft,ht[Xt+7])?(Bt=7+2*ee(ft,165),Bt+=ee(ft,145)):Bt=5+ee(ft,159);else Bt=ee(ft,ht[Xt+4])?3+ee(ft,ht[Xt+5]):2;Je=rt[2]}else Bt=1,Je=rt[1];rt=Ke+gde[Te],0>(ft=N).b&&D(ft);var Xt,ht=ft.b,Rt=(Xt=ft.Ca>>1)-(ft.I>>ht)>>31;--ft.b,ft.Ca+=Rt,ft.Ca|=1,ft.I-=(Xt+1&Rt)<<ht,Qe[rt]=((Bt^Rt)-Rt)*oe[(0<Te)+0]}return 16}function Zr(N){var k=N.rb[N.sb-1];k.la=0,k.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function Wr(N,k,q,oe,Te){Te=N[k+q+32*oe]+(Te>>3),N[k+q+32*oe]=-256&Te?0>Te?0:255:Te}function zr(N,k,q,oe,Te,Qe){Wr(N,k,0,q,oe+Te),Wr(N,k,1,q,oe+Qe),Wr(N,k,2,q,oe-Qe),Wr(N,k,3,q,oe-Te)}function gn(N){return(20091*N>>16)+N}function Nn(N,k,q,oe){var Te,Qe=0,Ke=s(16);for(Te=0;4>Te;++Te){var Je=N[k+0]+N[k+8],rt=N[k+0]-N[k+8],ft=(35468*N[k+4]>>16)-gn(N[k+12]),Bt=gn(N[k+4])+(35468*N[k+12]>>16);Ke[Qe+0]=Je+Bt,Ke[Qe+1]=rt+ft,Ke[Qe+2]=rt-ft,Ke[Qe+3]=Je-Bt,Qe+=4,k++}for(Te=Qe=0;4>Te;++Te)Je=(N=Ke[Qe+0]+4)+Ke[Qe+8],rt=N-Ke[Qe+8],ft=(35468*Ke[Qe+4]>>16)-gn(Ke[Qe+12]),Wr(q,oe,0,0,Je+(Bt=gn(Ke[Qe+4])+(35468*Ke[Qe+12]>>16))),Wr(q,oe,1,0,rt+ft),Wr(q,oe,2,0,rt-ft),Wr(q,oe,3,0,Je-Bt),Qe++,oe+=32}function Sn(N,k,q,oe){var Te=N[k+0]+4,Qe=35468*N[k+4]>>16,Ke=gn(N[k+4]),Je=35468*N[k+1]>>16;zr(q,oe,0,Te+Ke,N=gn(N[k+1]),Je),zr(q,oe,1,Te+Qe,N,Je),zr(q,oe,2,Te-Qe,N,Je),zr(q,oe,3,Te-Ke,N,Je)}function fe(N,k,q,oe,Te){Nn(N,k,q,oe),Te&&Nn(N,k+16,q,oe+4)}function tt(N,k,q,oe){qm(N,k+0,q,oe,1),qm(N,k+32,q,oe+128,1)}function vt(N,k,q,oe){var Te;for(N=N[k+0]+4,Te=0;4>Te;++Te)for(k=0;4>k;++k)Wr(q,oe,k,Te,N)}function mt(N,k,q,oe){N[k+0]&&Ma(N,k+0,q,oe),N[k+16]&&Ma(N,k+16,q,oe+4),N[k+32]&&Ma(N,k+32,q,oe+128),N[k+48]&&Ma(N,k+48,q,oe+128+4)}function Oe(N,k,q,oe){var Te,Qe=s(16);for(Te=0;4>Te;++Te){var Ke=N[k+0+Te]+N[k+12+Te],Je=N[k+4+Te]+N[k+8+Te],rt=N[k+4+Te]-N[k+8+Te],ft=N[k+0+Te]-N[k+12+Te];Qe[0+Te]=Ke+Je,Qe[8+Te]=Ke-Je,Qe[4+Te]=ft+rt,Qe[12+Te]=ft-rt}for(Te=0;4>Te;++Te)Ke=(N=Qe[0+4*Te]+3)+Qe[3+4*Te],Je=Qe[1+4*Te]+Qe[2+4*Te],rt=Qe[1+4*Te]-Qe[2+4*Te],ft=N-Qe[3+4*Te],q[oe+0]=Ke+Je>>3,q[oe+16]=ft+rt>>3,q[oe+32]=Ke-Je>>3,q[oe+48]=ft-rt>>3,oe+=64}function At(N,k,q){var oe,Te=k-32,Qe=pu,Ke=255-N[Te-1];for(oe=0;oe<q;++oe){var Je,rt=Qe,ft=Ke+N[k-1];for(Je=0;Je<q;++Je)N[k+Je]=rt[ft+N[Te+Je]];k+=32}}function It(N,k){At(N,k,4)}function Ct(N,k){At(N,k,8)}function bt(N,k){At(N,k,16)}function St(N,k){var q;for(q=0;16>q;++q)n(N,k+32*q,N,k-32,16)}function Jt(N,k){var q;for(q=16;0<q;--q)a(N,k,N[k-1],16),k+=32}function Qt(N,k,q){var oe;for(oe=0;16>oe;++oe)a(k,q+32*oe,N,16)}function ar(N,k){var q,oe=16;for(q=0;16>q;++q)oe+=N[k-1+32*q]+N[k+q-32];Qt(oe>>5,N,k)}function or(N,k){var q,oe=8;for(q=0;16>q;++q)oe+=N[k-1+32*q];Qt(oe>>4,N,k)}function _r(N,k){var q,oe=8;for(q=0;16>q;++q)oe+=N[k+q-32];Qt(oe>>4,N,k)}function Cr(N,k){Qt(128,N,k)}function Ut(N,k,q){return N+2*k+q+2>>2}function tn(N,k){var q,oe=k-32;for(oe=new Uint8Array([Ut(N[oe-1],N[oe+0],N[oe+1]),Ut(N[oe+0],N[oe+1],N[oe+2]),Ut(N[oe+1],N[oe+2],N[oe+3]),Ut(N[oe+2],N[oe+3],N[oe+4])]),q=0;4>q;++q)n(N,k+32*q,oe,0,oe.length)}function Gr(N,k){var q=N[k-1],oe=N[k-1+32],Te=N[k-1+64],Qe=N[k-1+96];ve(N,k+0,16843009*Ut(N[k-1-32],q,oe)),ve(N,k+32,16843009*Ut(q,oe,Te)),ve(N,k+64,16843009*Ut(oe,Te,Qe)),ve(N,k+96,16843009*Ut(Te,Qe,Qe))}function Ir(N,k){var q,oe=4;for(q=0;4>q;++q)oe+=N[k+q-32]+N[k-1+32*q];for(oe>>=3,q=0;4>q;++q)a(N,k+32*q,oe,4)}function yr(N,k){var q=N[k-1+0],oe=N[k-1+32],Te=N[k-1+64],Qe=N[k-1-32],Ke=N[k+0-32],Je=N[k+1-32],rt=N[k+2-32],ft=N[k+3-32];N[k+0+96]=Ut(oe,Te,N[k-1+96]),N[k+1+96]=N[k+0+64]=Ut(q,oe,Te),N[k+2+96]=N[k+1+64]=N[k+0+32]=Ut(Qe,q,oe),N[k+3+96]=N[k+2+64]=N[k+1+32]=N[k+0+0]=Ut(Ke,Qe,q),N[k+3+64]=N[k+2+32]=N[k+1+0]=Ut(Je,Ke,Qe),N[k+3+32]=N[k+2+0]=Ut(rt,Je,Ke),N[k+3+0]=Ut(ft,rt,Je)}function jr(N,k){var q=N[k+1-32],oe=N[k+2-32],Te=N[k+3-32],Qe=N[k+4-32],Ke=N[k+5-32],Je=N[k+6-32],rt=N[k+7-32];N[k+0+0]=Ut(N[k+0-32],q,oe),N[k+1+0]=N[k+0+32]=Ut(q,oe,Te),N[k+2+0]=N[k+1+32]=N[k+0+64]=Ut(oe,Te,Qe),N[k+3+0]=N[k+2+32]=N[k+1+64]=N[k+0+96]=Ut(Te,Qe,Ke),N[k+3+32]=N[k+2+64]=N[k+1+96]=Ut(Qe,Ke,Je),N[k+3+64]=N[k+2+96]=Ut(Ke,Je,rt),N[k+3+96]=Ut(Je,rt,rt)}function Bn(N,k){var q=N[k-1+0],oe=N[k-1+32],Te=N[k-1+64],Qe=N[k-1-32],Ke=N[k+0-32],Je=N[k+1-32],rt=N[k+2-32],ft=N[k+3-32];N[k+0+0]=N[k+1+64]=Qe+Ke+1>>1,N[k+1+0]=N[k+2+64]=Ke+Je+1>>1,N[k+2+0]=N[k+3+64]=Je+rt+1>>1,N[k+3+0]=rt+ft+1>>1,N[k+0+96]=Ut(Te,oe,q),N[k+0+64]=Ut(oe,q,Qe),N[k+0+32]=N[k+1+96]=Ut(q,Qe,Ke),N[k+1+32]=N[k+2+96]=Ut(Qe,Ke,Je),N[k+2+32]=N[k+3+96]=Ut(Ke,Je,rt),N[k+3+32]=Ut(Je,rt,ft)}function yn(N,k){var q=N[k+0-32],oe=N[k+1-32],Te=N[k+2-32],Qe=N[k+3-32],Ke=N[k+4-32],Je=N[k+5-32],rt=N[k+6-32],ft=N[k+7-32];N[k+0+0]=q+oe+1>>1,N[k+1+0]=N[k+0+64]=oe+Te+1>>1,N[k+2+0]=N[k+1+64]=Te+Qe+1>>1,N[k+3+0]=N[k+2+64]=Qe+Ke+1>>1,N[k+0+32]=Ut(q,oe,Te),N[k+1+32]=N[k+0+96]=Ut(oe,Te,Qe),N[k+2+32]=N[k+1+96]=Ut(Te,Qe,Ke),N[k+3+32]=N[k+2+96]=Ut(Qe,Ke,Je),N[k+3+64]=Ut(Ke,Je,rt),N[k+3+96]=Ut(Je,rt,ft)}function mn(N,k){var q=N[k-1+0],oe=N[k-1+32],Te=N[k-1+64],Qe=N[k-1+96];N[k+0+0]=q+oe+1>>1,N[k+2+0]=N[k+0+32]=oe+Te+1>>1,N[k+2+32]=N[k+0+64]=Te+Qe+1>>1,N[k+1+0]=Ut(q,oe,Te),N[k+3+0]=N[k+1+32]=Ut(oe,Te,Qe),N[k+3+32]=N[k+1+64]=Ut(Te,Qe,Qe),N[k+3+64]=N[k+2+64]=N[k+0+96]=N[k+1+96]=N[k+2+96]=N[k+3+96]=Qe}function ua(N,k){var q=N[k-1+0],oe=N[k-1+32],Te=N[k-1+64],Qe=N[k-1+96],Ke=N[k-1-32],Je=N[k+0-32],rt=N[k+1-32],ft=N[k+2-32];N[k+0+0]=N[k+2+32]=q+Ke+1>>1,N[k+0+32]=N[k+2+64]=oe+q+1>>1,N[k+0+64]=N[k+2+96]=Te+oe+1>>1,N[k+0+96]=Qe+Te+1>>1,N[k+3+0]=Ut(Je,rt,ft),N[k+2+0]=Ut(Ke,Je,rt),N[k+1+0]=N[k+3+32]=Ut(q,Ke,Je),N[k+1+32]=N[k+3+64]=Ut(oe,q,Ke),N[k+1+64]=N[k+3+96]=Ut(Te,oe,q),N[k+1+96]=Ut(Qe,Te,oe)}function ga(N,k){var q;for(q=0;8>q;++q)n(N,k+32*q,N,k-32,8)}function Yi(N,k){var q;for(q=0;8>q;++q)a(N,k,N[k-1],8),k+=32}function Ji(N,k,q){var oe;for(oe=0;8>oe;++oe)a(k,q+32*oe,N,8)}function Fl(N,k){var q,oe=8;for(q=0;8>q;++q)oe+=N[k+q-32]+N[k-1+32*q];Ji(oe>>4,N,k)}function xa(N,k){var q,oe=4;for(q=0;8>q;++q)oe+=N[k+q-32];Ji(oe>>3,N,k)}function Qn(N,k){var q,oe=4;for(q=0;8>q;++q)oe+=N[k-1+32*q];Ji(oe>>3,N,k)}function du(N,k){Ji(128,N,k)}function Ol(N,k,q){var oe=N[k-q],Te=N[k+0],Qe=3*(Te-oe)+I3[1020+N[k-2*q]-N[k+q]],Ke=vN[112+(Qe+4>>3)];N[k-q]=pu[255+oe+vN[112+(Qe+3>>3)]],N[k+0]=pu[255+Te-Ke]}function Zi(N,k,q,oe){var Te=N[k+0],Qe=N[k+q];return Ju[255+N[k-2*q]-N[k-q]]>oe||Ju[255+Qe-Te]>oe}function Rc(N,k,q,oe){return 4*Ju[255+N[k-q]-N[k+0]]+Ju[255+N[k-2*q]-N[k+q]]<=oe}function Mc(N,k,q,oe,Te){var Qe=N[k-3*q],Ke=N[k-2*q],Je=N[k-q],rt=N[k+0],ft=N[k+q],Bt=N[k+2*q],Xt=N[k+3*q];return 4*Ju[255+Je-rt]+Ju[255+Ke-ft]>oe?0:Ju[255+N[k-4*q]-Qe]<=Te&&Ju[255+Qe-Ke]<=Te&&Ju[255+Ke-Je]<=Te&&Ju[255+Xt-Bt]<=Te&&Ju[255+Bt-ft]<=Te&&Ju[255+ft-rt]<=Te}function dc(N,k,q,oe){var Te=2*oe+1;for(oe=0;16>oe;++oe)Rc(N,k+oe,q,Te)&&Ol(N,k+oe,q)}function ol(N,k,q,oe){var Te=2*oe+1;for(oe=0;16>oe;++oe)Rc(N,k+oe*q,1,Te)&&Ol(N,k+oe*q,1)}function fu(N,k,q,oe){var Te;for(Te=3;0<Te;--Te)dc(N,k+=4*q,q,oe)}function KA(N,k,q,oe){var Te;for(Te=3;0<Te;--Te)ol(N,k+=4,q,oe)}function ll(N,k,q,oe,Te,Qe,Ke,Je){for(Qe=2*Qe+1;0<Te--;){if(Mc(N,k,q,Qe,Ke))if(Zi(N,k,q,Je))Ol(N,k,q);else{var rt=N,ft=k,Bt=q,Xt=rt[ft-2*Bt],ht=rt[ft-Bt],Rt=rt[ft+0],Kt=rt[ft+Bt],fr=rt[ft+2*Bt],Wt=27*(gr=I3[1020+3*(Rt-ht)+I3[1020+Xt-Kt]])+63>>7,pr=18*gr+63>>7,gr=9*gr+63>>7;rt[ft-3*Bt]=pu[255+rt[ft-3*Bt]+gr],rt[ft-2*Bt]=pu[255+Xt+pr],rt[ft-Bt]=pu[255+ht+Wt],rt[ft+0]=pu[255+Rt-Wt],rt[ft+Bt]=pu[255+Kt-pr],rt[ft+2*Bt]=pu[255+fr-gr]}k+=oe}}function Lc(N,k,q,oe,Te,Qe,Ke,Je){for(Qe=2*Qe+1;0<Te--;){if(Mc(N,k,q,Qe,Ke))if(Zi(N,k,q,Je))Ol(N,k,q);else{var rt=N,ft=k,Bt=q,Xt=rt[ft-Bt],ht=rt[ft+0],Rt=rt[ft+Bt],Kt=vN[112+(4+(fr=3*(ht-Xt))>>3)],fr=vN[112+(fr+3>>3)],Wt=Kt+1>>1;rt[ft-2*Bt]=pu[255+rt[ft-2*Bt]+Wt],rt[ft-Bt]=pu[255+Xt+fr],rt[ft+0]=pu[255+ht-Kt],rt[ft+Bt]=pu[255+Rt-Wt]}k+=oe}}function Bf(N,k,q,oe,Te,Qe){ll(N,k,q,1,16,oe,Te,Qe)}function fo(N,k,q,oe,Te,Qe){ll(N,k,1,q,16,oe,Te,Qe)}function zu(N,k,q,oe,Te,Qe){var Ke;for(Ke=3;0<Ke;--Ke)Lc(N,k+=4*q,q,1,16,oe,Te,Qe)}function R(N,k,q,oe,Te,Qe){var Ke;for(Ke=3;0<Ke;--Ke)Lc(N,k+=4,1,q,16,oe,Te,Qe)}function je(N,k,q,oe,Te,Qe,Ke,Je){ll(N,k,Te,1,8,Qe,Ke,Je),ll(q,oe,Te,1,8,Qe,Ke,Je)}function ut(N,k,q,oe,Te,Qe,Ke,Je){ll(N,k,1,Te,8,Qe,Ke,Je),ll(q,oe,1,Te,8,Qe,Ke,Je)}function wt(N,k,q,oe,Te,Qe,Ke,Je){Lc(N,k+4*Te,Te,1,8,Qe,Ke,Je),Lc(q,oe+4*Te,Te,1,8,Qe,Ke,Je)}function Vt(N,k,q,oe,Te,Qe,Ke,Je){Lc(N,k+4,1,Te,8,Qe,Ke,Je),Lc(q,oe+4,1,Te,8,Qe,Ke,Je)}function Ar(){this.ba=new xe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new gt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function wr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function nn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function un(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new O}function Tn(){this.xb=this.a=0,this.l=new ir,this.ca=new xe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new un,this.ab=0,this.gc=o(4,nn),this.Oc=0}function Vn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ir,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function da(N,k,q,oe,Te,Qe,Ke){for(N=N==null?0:N[k+0],k=0;k<Ke;++k)Te[Qe+k]=N+q[oe+k]&255,N=Te[Qe+k]}function ka(N,k,q,oe,Te,Qe,Ke){var Je;if(N==null)da(null,null,q,oe,Te,Qe,Ke);else for(Je=0;Je<Ke;++Je)Te[Qe+Je]=N[k+Je]+q[oe+Je]&255}function Ys(N,k,q,oe,Te,Qe,Ke){if(N==null)da(null,null,q,oe,Te,Qe,Ke);else{var Je,rt=N[k+0],ft=rt,Bt=rt;for(Je=0;Je<Ke;++Je)ft=Bt+(rt=N[k+Je])-ft,Bt=q[oe+Je]+(-256&ft?0>ft?0:255:ft)&255,ft=rt,Te[Qe+Je]=Bt}}function Va(N,k,q,oe){var Te=k.width,Qe=k.o;if(e(N!=null&&k!=null),0>q||0>=oe||q+oe>Qe)return null;if(!N.Cc){if(N.ga==null){var Ke;if(N.ga=new Vn,(Ke=N.ga==null)||(Ke=k.width*k.o,e(N.Gb.length==0),N.Gb=s(Ke),N.Uc=0,N.Gb==null?Ke=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Ke=1),Ke=!Ke),!Ke){Ke=N.ga;var Je=N.Fa,rt=N.P,ft=N.qc,Bt=N.mb,Xt=N.nb,ht=rt+1,Rt=ft-1,Kt=Ke.l;if(e(Je!=null&&Bt!=null&&k!=null),t0[0]=null,t0[1]=da,t0[2]=ka,t0[3]=Ys,Ke.ca=Bt,Ke.tb=Xt,Ke.c=k.width,Ke.i=k.height,e(0<Ke.c&&0<Ke.i),1>=ft)k=0;else if(Ke.$a=3&Je[rt+0],Ke.Z=Je[rt+0]>>2&3,Ke.Lc=Je[rt+0]>>4&3,rt=Je[rt+0]>>6&3,0>Ke.$a||1<Ke.$a||4<=Ke.Z||1<Ke.Lc||rt)k=0;else if(Kt.put=Me,Kt.ac=Lt,Kt.bc=_e,Kt.ma=Ke,Kt.width=k.width,Kt.height=k.height,Kt.Da=k.Da,Kt.v=k.v,Kt.va=k.va,Kt.j=k.j,Kt.o=k.o,Ke.$a)e:{e(Ke.$a==1),k=at();t:for(;;){if(k==null){k=0;break e}if(e(Ke!=null),Ke.mc=k,k.c=Ke.c,k.i=Ke.i,k.l=Ke.l,k.l.ma=Ke,k.l.width=Ke.c,k.l.height=Ke.i,k.a=0,se(k.m,Je,ht,Rt),!lt(Ke.c,Ke.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&re(k.s)?(Ke.ic=1,Je=k.c*k.i,k.Ta=null,k.Ua=0,k.V=s(Je),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(Ke.ic=0,k=dt(k,Ke.c)),!k))break t;k=1;break e}Ke.mc=null,k=0}else k=Rt>=Ke.c*Ke.i;Ke=!k}if(Ke)return null;N.ga.Lc!=1?N.Ga=0:oe=Qe-q}e(N.ga!=null),e(q+oe<=Qe);e:{if(k=(Je=N.ga).c,Qe=Je.l.o,Je.$a==0){if(ht=N.rc,Rt=N.Vc,Kt=N.Fa,rt=N.P+1+q*k,ft=N.mb,Bt=N.nb+q*k,e(rt<=N.P+N.qc),Je.Z!=0)for(e(t0[Je.Z]!=null),Ke=0;Ke<oe;++Ke)t0[Je.Z](ht,Rt,Kt,rt,ft,Bt,k),ht=ft,Rt=Bt,Bt+=k,rt+=k;else for(Ke=0;Ke<oe;++Ke)n(ft,Bt,Kt,rt,k),ht=ft,Rt=Bt,Bt+=k,rt+=k;N.rc=ht,N.Vc=Rt}else{if(e(Je.mc!=null),k=q+oe,e((Ke=Je.mc)!=null),e(k<=Ke.i),Ke.C>=k)k=1;else if(Je.ic||Uc(),Je.ic){Je=Ke.V,ht=Ke.Ba,Rt=Ke.c;var fr=Ke.i,Wt=(Kt=1,rt=Ke.$/Rt,ft=Ke.$%Rt,Bt=Ke.m,Xt=Ke.s,Ke.$),pr=Rt*fr,gr=Rt*k,Tr=Xt.wc,Sr=Wt<gr?G(Xt,ft,rt):null;e(Wt<=pr),e(k<=fr),e(re(Xt));t:for(;;){for(;!Bt.h&&Wt<gr;){if(ft&Tr||(Sr=G(Xt,ft,rt)),e(Sr!=null),Y(Bt),256>(fr=Ve(Sr.G[0],Sr.H[0],Bt)))Je[ht+Wt]=fr,++Wt,++ft>=Rt&&(ft=0,++rt<=k&&!(rt%16)&&Fe(Ke,rt));else{if(!(280>fr)){Kt=0;break t}fr=ye(fr-256,Bt);var xn,on=Ve(Sr.G[4],Sr.H[4],Bt);if(Y(Bt),!(Wt>=(on=te(Rt,on=ye(on,Bt)))&&pr-Wt>=fr)){Kt=0;break t}for(xn=0;xn<fr;++xn)Je[ht+Wt+xn]=Je[ht+Wt+xn-on];for(Wt+=fr,ft+=fr;ft>=Rt;)ft-=Rt,++rt<=k&&!(rt%16)&&Fe(Ke,rt);Wt<gr&&ft&Tr&&(Sr=G(Xt,ft,rt))}e(Bt.h==L(Bt))}Fe(Ke,rt>k?k:rt);break t}!Kt||Bt.h&&Wt<pr?(Kt=0,Ke.a=Bt.h?5:3):Ke.$=Wt,k=Kt}else k=st(Ke,Ke.V,Ke.Ba,Ke.c,Ke.i,k,Pt);if(!k){oe=0;break e}}q+oe>=Qe&&(N.Cc=1),oe=1}if(!oe)return null;if(N.Cc&&((oe=N.ga)!=null&&(oe.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+q*Te}function pi(N,k,q,oe,Te,Qe){for(;0<Te--;){var Ke,Je=N,rt=k+(q?1:0),ft=N,Bt=k+(q?0:3);for(Ke=0;Ke<oe;++Ke){var Xt=ft[Bt+4*Ke];Xt!=255&&(Xt*=32897,Je[rt+4*Ke+0]=Je[rt+4*Ke+0]*Xt>>23,Je[rt+4*Ke+1]=Je[rt+4*Ke+1]*Xt>>23,Je[rt+4*Ke+2]=Je[rt+4*Ke+2]*Xt>>23)}k+=Qe}}function Js(N,k,q,oe,Te){for(;0<oe--;){var Qe;for(Qe=0;Qe<q;++Qe){var Ke=N[k+2*Qe+0],Je=15&(ft=N[k+2*Qe+1]),rt=4369*Je,ft=(240&ft|ft>>4)*rt>>16;N[k+2*Qe+0]=(240&Ke|Ke>>4)*rt>>16&240|(15&Ke|Ke<<4)*rt>>16>>4&15,N[k+2*Qe+1]=240&ft|Je}k+=Te}}function gi(N,k,q,oe,Te,Qe,Ke,Je){var rt,ft,Bt=255;for(ft=0;ft<Te;++ft){for(rt=0;rt<oe;++rt){var Xt=N[k+rt];Qe[Ke+4*rt]=Xt,Bt&=Xt}k+=q,Ke+=Je}return Bt!=255}function Zs(N,k,q,oe,Te){var Qe;for(Qe=0;Qe<Te;++Qe)q[oe+Qe]=N[k+Qe]>>8}function Uc(){Q1=pi,z8=Js,W8=gi,X8=Zs}function Wu(N,k,q){E[N]=function(oe,Te,Qe,Ke,Je,rt,ft,Bt,Xt,ht,Rt,Kt,fr,Wt,pr,gr,Tr){var Sr,xn=Tr-1>>1,on=Je[rt+0]|ft[Bt+0]<<16,Wn=Xt[ht+0]|Rt[Kt+0]<<16;e(oe!=null);var fn=3*on+Wn+131074>>2;for(k(oe[Te+0],255&fn,fn>>16,fr,Wt),Qe!=null&&(fn=3*Wn+on+131074>>2,k(Qe[Ke+0],255&fn,fn>>16,pr,gr)),Sr=1;Sr<=xn;++Sr){var pa=Je[rt+Sr]|ft[Bt+Sr]<<16,Ao=Xt[ht+Sr]|Rt[Kt+Sr]<<16,Xn=on+pa+Wn+Ao+524296,hn=Xn+2*(pa+Wn)>>3;fn=hn+on>>1,on=(Xn=Xn+2*(on+Ao)>>3)+pa>>1,k(oe[Te+2*Sr-1],255&fn,fn>>16,fr,Wt+(2*Sr-1)*q),k(oe[Te+2*Sr-0],255&on,on>>16,fr,Wt+(2*Sr-0)*q),Qe!=null&&(fn=Xn+Wn>>1,on=hn+Ao>>1,k(Qe[Ke+2*Sr-1],255&fn,fn>>16,pr,gr+(2*Sr-1)*q),k(Qe[Ke+2*Sr+0],255&on,on>>16,pr,gr+(2*Sr+0)*q)),on=pa,Wn=Ao}1&Tr||(fn=3*on+Wn+131074>>2,k(oe[Te+Tr-1],255&fn,fn>>16,fr,Wt+(Tr-1)*q),Qe!=null&&(fn=3*Wn+on+131074>>2,k(Qe[Ke+Tr-1],255&fn,fn>>16,pr,gr+(Tr-1)*q)))}}function Xu(){Zu[yN]=Nde,Zu[bN]=oL,Zu[rL]=Cde,Zu[wN]=lL,Zu[NN]=cL,Zu[j3]=uL,Zu[nL]=_de,Zu[P3]=oL,Zu[B3]=lL,Zu[CN]=cL,Zu[T3]=uL}function C(N){return N&-16384?0>N?0:255:N>>Ede}function J(N,k){return C((19077*N>>8)+(26149*k>>8)-14234)}function ge(N,k,q){return C((19077*N>>8)-(6419*k>>8)-(13320*q>>8)+8708)}function et(N,k){return C((19077*N>>8)+(33050*k>>8)-17685)}function Gt(N,k,q,oe,Te){oe[Te+0]=J(N,q),oe[Te+1]=ge(N,k,q),oe[Te+2]=et(N,k)}function tr(N,k,q,oe,Te){oe[Te+0]=et(N,k),oe[Te+1]=ge(N,k,q),oe[Te+2]=J(N,q)}function Rr(N,k,q,oe,Te){var Qe=ge(N,k,q);k=Qe<<3&224|et(N,k)>>3,oe[Te+0]=248&J(N,q)|Qe>>5,oe[Te+1]=k}function ma(N,k,q,oe,Te){var Qe=240&et(N,k)|15;oe[Te+0]=240&J(N,q)|ge(N,k,q)>>4,oe[Te+1]=Qe}function ei(N,k,q,oe,Te){oe[Te+0]=255,Gt(N,k,q,oe,Te+1)}function ra(N,k,q,oe,Te){tr(N,k,q,oe,Te),oe[Te+3]=255}function Sa(N,k,q,oe,Te){Gt(N,k,q,oe,Te),oe[Te+3]=255}function gs(N,k,q){E[N]=function(oe,Te,Qe,Ke,Je,rt,ft,Bt,Xt){for(var ht=Bt+(-2&Xt)*q;Bt!=ht;)k(oe[Te+0],Qe[Ke+0],Je[rt+0],ft,Bt),k(oe[Te+1],Qe[Ke+0],Je[rt+0],ft,Bt+q),Te+=2,++Ke,++rt,Bt+=2*q;1&Xt&&k(oe[Te+0],Qe[Ke+0],Je[rt+0],ft,Bt)}}function hu(N,k,q){return q==0?N==0?k==0?6:5:k==0?4:0:q}function Dl(N,k,q,oe,Te){switch(N>>>30){case 3:qm(k,q,oe,Te,0);break;case 2:Yu(k,q,oe,Te);break;case 1:Ma(k,q,oe,Te)}}function cl(N,k){var q,oe,Te=k.M,Qe=k.Nb,Ke=N.oc,Je=N.pc+40,rt=N.oc,ft=N.pc+584,Bt=N.oc,Xt=N.pc+600;for(q=0;16>q;++q)Ke[Je+32*q-1]=129;for(q=0;8>q;++q)rt[ft+32*q-1]=129,Bt[Xt+32*q-1]=129;for(0<Te?Ke[Je-1-32]=rt[ft-1-32]=Bt[Xt-1-32]=129:(a(Ke,Je-32-1,127,21),a(rt,ft-32-1,127,9),a(Bt,Xt-32-1,127,9)),oe=0;oe<N.za;++oe){var ht=k.ya[k.aa+oe];if(0<oe){for(q=-1;16>q;++q)n(Ke,Je+32*q-4,Ke,Je+32*q+12,4);for(q=-1;8>q;++q)n(rt,ft+32*q-4,rt,ft+32*q+4,4),n(Bt,Xt+32*q-4,Bt,Xt+32*q+4,4)}var Rt=N.Gd,Kt=N.Hd+oe,fr=ht.ad,Wt=ht.Hc;if(0<Te&&(n(Ke,Je-32,Rt[Kt].y,0,16),n(rt,ft-32,Rt[Kt].f,0,8),n(Bt,Xt-32,Rt[Kt].ea,0,8)),ht.Za){var pr=Ke,gr=Je-32+16;for(0<Te&&(oe>=N.za-1?a(pr,gr,Rt[Kt].y[15],4):n(pr,gr,Rt[Kt+1].y,0,4)),q=0;4>q;q++)pr[gr+128+q]=pr[gr+256+q]=pr[gr+384+q]=pr[gr+0+q];for(q=0;16>q;++q,Wt<<=2)pr=Ke,gr=Je+fL[q],Gd[ht.Ob[q]](pr,gr),Dl(Wt,fr,16*+q,pr,gr)}else if(pr=hu(oe,Te,ht.Ob[0]),e0[pr](Ke,Je),Wt!=0)for(q=0;16>q;++q,Wt<<=2)Dl(Wt,fr,16*+q,Ke,Je+fL[q]);for(q=ht.Gc,pr=hu(oe,Te,ht.Dd),wh[pr](rt,ft),wh[pr](Bt,Xt),Wt=fr,pr=rt,gr=ft,255&(ht=0|q)&&(170&ht?Ff(Wt,256,pr,gr):ds(Wt,256,pr,gr)),ht=Bt,Wt=Xt,255&(q>>=8)&&(170&q?Ff(fr,320,ht,Wt):ds(fr,320,ht,Wt)),Te<N.Ub-1&&(n(Rt[Kt].y,0,Ke,Je+480,16),n(Rt[Kt].f,0,rt,ft+224,8),n(Rt[Kt].ea,0,Bt,Xt+224,8)),q=8*Qe*N.B,Rt=N.sa,Kt=N.ta+16*oe+16*Qe*N.R,fr=N.qa,ht=N.ra+8*oe+q,Wt=N.Ha,pr=N.Ia+8*oe+q,q=0;16>q;++q)n(Rt,Kt+q*N.R,Ke,Je+32*q,16);for(q=0;8>q;++q)n(fr,ht+q*N.B,rt,ft+32*q,8),n(Wt,pr+q*N.B,Bt,Xt+32*q,8)}}function $d(N,k,q,oe,Te,Qe,Ke,Je,rt){var ft=[0],Bt=[0],Xt=0,ht=rt!=null?rt.kd:0,Rt=rt??new wr;if(N==null||12>q)return 7;Rt.data=N,Rt.w=k,Rt.ha=q,k=[k],q=[q],Rt.gb=[Rt.gb];e:{var Kt=k,fr=q,Wt=Rt.gb;if(e(N!=null),e(fr!=null),e(Wt!=null),Wt[0]=0,12<=fr[0]&&!r(N,Kt[0],"RIFF")){if(r(N,Kt[0]+8,"WEBP")){Wt=3;break e}var pr=ae(N,Kt[0]+4);if(12>pr||4294967286<pr){Wt=3;break e}if(ht&&pr>fr[0]-8){Wt=7;break e}Wt[0]=pr,Kt[0]+=12,fr[0]-=12}Wt=0}if(Wt!=0)return Wt;for(pr=0<Rt.gb[0],q=q[0];;){e:{var gr=N;fr=k,Wt=q;var Tr=ft,Sr=Bt,xn=Kt=[0];if((fn=Xt=[Xt])[0]=0,8>Wt[0])Wt=7;else{if(!r(gr,fr[0],"VP8X")){if(ae(gr,fr[0]+4)!=10){Wt=3;break e}if(18>Wt[0]){Wt=7;break e}var on=ae(gr,fr[0]+8),Wn=1+Ye(gr,fr[0]+12);if(2147483648<=Wn*(gr=1+Ye(gr,fr[0]+15))){Wt=3;break e}xn!=null&&(xn[0]=on),Tr!=null&&(Tr[0]=Wn),Sr!=null&&(Sr[0]=gr),fr[0]+=18,Wt[0]-=18,fn[0]=1}Wt=0}}if(Xt=Xt[0],Kt=Kt[0],Wt!=0)return Wt;if(fr=!!(2&Kt),!pr&&Xt)return 3;if(Qe!=null&&(Qe[0]=!!(16&Kt)),Ke!=null&&(Ke[0]=fr),Je!=null&&(Je[0]=0),Ke=ft[0],Kt=Bt[0],Xt&&fr&&rt==null){Wt=0;break}if(4>q){Wt=7;break}if(pr&&Xt||!pr&&!Xt&&!r(N,k[0],"ALPH")){q=[q],Rt.na=[Rt.na],Rt.P=[Rt.P],Rt.Sa=[Rt.Sa];e:{on=N,Wt=k,pr=q;var fn=Rt.gb;Tr=Rt.na,Sr=Rt.P,xn=Rt.Sa,Wn=22,e(on!=null),e(pr!=null),gr=Wt[0];var pa=pr[0];for(e(Tr!=null),e(xn!=null),Tr[0]=null,Sr[0]=null,xn[0]=0;;){if(Wt[0]=gr,pr[0]=pa,8>pa){Wt=7;break e}var Ao=ae(on,gr+4);if(4294967286<Ao){Wt=3;break e}var Xn=8+Ao+1&-2;if(Wn+=Xn,0<fn&&Wn>fn){Wt=3;break e}if(!r(on,gr,"VP8 ")||!r(on,gr,"VP8L")){Wt=0;break e}if(pa[0]<Xn){Wt=7;break e}r(on,gr,"ALPH")||(Tr[0]=on,Sr[0]=gr+8,xn[0]=Ao),gr+=Xn,pa-=Xn}}if(q=q[0],Rt.na=Rt.na[0],Rt.P=Rt.P[0],Rt.Sa=Rt.Sa[0],Wt!=0)break}q=[q],Rt.Ja=[Rt.Ja],Rt.xa=[Rt.xa];e:if(fn=N,Wt=k,pr=q,Tr=Rt.gb[0],Sr=Rt.Ja,xn=Rt.xa,on=Wt[0],gr=!r(fn,on,"VP8 "),Wn=!r(fn,on,"VP8L"),e(fn!=null),e(pr!=null),e(Sr!=null),e(xn!=null),8>pr[0])Wt=7;else{if(gr||Wn){if(fn=ae(fn,on+4),12<=Tr&&fn>Tr-12){Wt=3;break e}if(ht&&fn>pr[0]-8){Wt=7;break e}Sr[0]=fn,Wt[0]+=8,pr[0]-=8,xn[0]=Wn}else xn[0]=5<=pr[0]&&fn[on+0]==47&&!(fn[on+4]>>5),Sr[0]=pr[0];Wt=0}if(q=q[0],Rt.Ja=Rt.Ja[0],Rt.xa=Rt.xa[0],k=k[0],Wt!=0)break;if(4294967286<Rt.Ja)return 3;if(Je==null||fr||(Je[0]=Rt.xa?2:1),Ke=[Ke],Kt=[Kt],Rt.xa){if(5>q){Wt=7;break}Je=Ke,ht=Kt,fr=Qe,N==null||5>q?N=0:5<=q&&N[k+0]==47&&!(N[k+4]>>5)?(pr=[0],fn=[0],Tr=[0],se(Sr=new H,N,k,q),U(Sr,pr,fn,Tr)?(Je!=null&&(Je[0]=pr[0]),ht!=null&&(ht[0]=fn[0]),fr!=null&&(fr[0]=Tr[0]),N=1):N=0):N=0}else{if(10>q){Wt=7;break}Je=Kt,N==null||10>q||!xr(N,k+3,q-3)?N=0:(ht=N[k+0]|N[k+1]<<8|N[k+2]<<16,fr=16383&(N[k+7]<<8|N[k+6]),N=16383&(N[k+9]<<8|N[k+8]),1&ht||3<(ht>>1&7)||!(ht>>4&1)||ht>>5>=Rt.Ja||!fr||!N?N=0:(Ke&&(Ke[0]=fr),Je&&(Je[0]=N),N=1))}if(!N||(Ke=Ke[0],Kt=Kt[0],Xt&&(ft[0]!=Ke||Bt[0]!=Kt)))return 3;rt!=null&&(rt[0]=Rt,rt.offset=k-rt.w,e(4294967286>k-rt.w),e(rt.offset==rt.ha-q));break}return Wt==0||Wt==7&&Xt&&rt==null?(Qe!=null&&(Qe[0]|=Rt.na!=null&&0<Rt.na.length),oe!=null&&(oe[0]=Ke),Te!=null&&(Te[0]=Kt),0):Wt}function k1(N,k,q){var oe=k.width,Te=k.height,Qe=0,Ke=0,Je=oe,rt=Te;if(k.Da=N!=null&&0<N.Da,k.Da&&(Je=N.cd,rt=N.bd,Qe=N.v,Ke=N.j,11>q||(Qe&=-2,Ke&=-2),0>Qe||0>Ke||0>=Je||0>=rt||Qe+Je>oe||Ke+rt>Te))return 0;if(k.v=Qe,k.j=Ke,k.va=Qe+Je,k.o=Ke+rt,k.U=Je,k.T=rt,k.da=N!=null&&0<N.da,k.da){if(!$e(Je,rt,q=[N.ib],Qe=[N.hb]))return 0;k.ib=q[0],k.hb=Qe[0]}return k.ob=N!=null&&N.ob,k.Kb=N==null||!N.Sd,k.da&&(k.ob=k.ib<3*oe/4&&k.hb<3*Te/4,k.Kb=0),1}function F1(N){if(N==null)return 2;if(11>N.S){var k=N.f.RGBA;k.fb+=(N.height-1)*k.A,k.A=-k.A}else k=N.f.kb,N=N.height,k.O+=(N-1)*k.fa,k.fa=-k.fa,k.N+=(N-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(N-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(N-1)*k.lb,k.lb=-k.lb);return 0}function qA(N,k,q,oe){if(oe==null||0>=N||0>=k)return 2;if(q!=null){if(q.Da){var Te=q.cd,Qe=q.bd,Ke=-2&q.v,Je=-2&q.j;if(0>Ke||0>Je||0>=Te||0>=Qe||Ke+Te>N||Je+Qe>k)return 2;N=Te,k=Qe}if(q.da){if(!$e(N,k,Te=[q.ib],Qe=[q.hb]))return 2;N=Te[0],k=Qe[0]}}oe.width=N,oe.height=k;e:{var rt=oe.width,ft=oe.height;if(N=oe.S,0>=rt||0>=ft||!(N>=yN&&13>N))N=2;else{if(0>=oe.Rd&&oe.sd==null){Ke=Qe=Te=k=0;var Bt=(Je=rt*hL[N])*ft;if(11>N||(Qe=(ft+1)/2*(k=(rt+1)/2),N==12&&(Ke=(Te=rt)*ft)),(ft=s(Bt+2*Qe+Ke))==null){N=1;break e}oe.sd=ft,11>N?((rt=oe.f.RGBA).eb=ft,rt.fb=0,rt.A=Je,rt.size=Bt):((rt=oe.f.kb).y=ft,rt.O=0,rt.fa=Je,rt.Fd=Bt,rt.f=ft,rt.N=0+Bt,rt.Ab=k,rt.Cd=Qe,rt.ea=ft,rt.W=0+Bt+Qe,rt.Db=k,rt.Ed=Qe,N==12&&(rt.F=ft,rt.J=0+Bt+2*Qe),rt.Tc=Ke,rt.lb=Te)}if(k=1,Te=oe.S,Qe=oe.width,Ke=oe.height,Te>=yN&&13>Te)if(11>Te)N=oe.f.RGBA,k&=(Je=Math.abs(N.A))*(Ke-1)+Qe<=N.size,k&=Je>=Qe*hL[Te],k&=N.eb!=null;else{N=oe.f.kb,Je=(Qe+1)/2,Bt=(Ke+1)/2,rt=Math.abs(N.fa),ft=Math.abs(N.Ab);var Xt=Math.abs(N.Db),ht=Math.abs(N.lb),Rt=ht*(Ke-1)+Qe;k&=rt*(Ke-1)+Qe<=N.Fd,k&=ft*(Bt-1)+Je<=N.Cd,k=(k&=Xt*(Bt-1)+Je<=N.Ed)&rt>=Qe&ft>=Je&Xt>=Je,k&=N.y!=null,k&=N.f!=null,k&=N.ea!=null,Te==12&&(k&=ht>=Qe,k&=Rt<=N.Tc,k&=N.F!=null)}else k=0;N=k?0:2}}return N!=0||q!=null&&q.fd&&(N=F1(oe)),N}var Gm=64,Au=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],mu=24,zA=32,yh=8,WA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];xt("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(N){return N},E.Predictor2=function(N,k,q){return k[q+0]},E.Predictor3=function(N,k,q){return k[q+1]},E.Predictor4=function(N,k,q){return k[q-1]},E.Predictor5=function(N,k,q){return Mt(Mt(N,k[q+1]),k[q+0])},E.Predictor6=function(N,k,q){return Mt(N,k[q-1])},E.Predictor7=function(N,k,q){return Mt(N,k[q+0])},E.Predictor8=function(N,k,q){return Mt(k[q-1],k[q+0])},E.Predictor9=function(N,k,q){return Mt(k[q+0],k[q+1])},E.Predictor10=function(N,k,q){return Mt(Mt(N,k[q-1]),Mt(k[q+0],k[q+1]))},E.Predictor11=function(N,k,q){var oe=k[q+0];return 0>=kt(oe>>24&255,N>>24&255,(k=k[q-1])>>24&255)+kt(oe>>16&255,N>>16&255,k>>16&255)+kt(oe>>8&255,N>>8&255,k>>8&255)+kt(255&oe,255&N,255&k)?oe:N},E.Predictor12=function(N,k,q){var oe=k[q+0];return(Ft((N>>24&255)+(oe>>24&255)-((k=k[q-1])>>24&255))<<24|Ft((N>>16&255)+(oe>>16&255)-(k>>16&255))<<16|Ft((N>>8&255)+(oe>>8&255)-(k>>8&255))<<8|Ft((255&N)+(255&oe)-(255&k)))>>>0},E.Predictor13=function(N,k,q){var oe=k[q-1];return($t((N=Mt(N,k[q+0]))>>24&255,oe>>24&255)<<24|$t(N>>16&255,oe>>16&255)<<16|$t(N>>8&255,oe>>8&255)<<8|$t(255&N,255&oe))>>>0};var O1=E.PredictorAdd0;E.PredictorAdd1=Ge,xt("Predictor2","PredictorAdd2"),xt("Predictor3","PredictorAdd3"),xt("Predictor4","PredictorAdd4"),xt("Predictor5","PredictorAdd5"),xt("Predictor6","PredictorAdd6"),xt("Predictor7","PredictorAdd7"),xt("Predictor8","PredictorAdd8"),xt("Predictor9","PredictorAdd9"),xt("Predictor10","PredictorAdd10"),xt("Predictor11","PredictorAdd11"),xt("Predictor12","PredictorAdd12"),xt("Predictor13","PredictorAdd13");var zg=E.PredictorAdd2;be("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),be("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Pi,gN=E.ColorIndexInverseTransform,Tf=E.MapARGB,kf=E.VP8LColorIndexInverseTransformAlpha,D1=E.MapAlpha,R1=E.VP8LPredictorsAdd=[];R1.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var M1,L1,XA,YA,JA,Km,ZA,qm,Yu,Ff,Ma,ds,Bi,ho,bh,U1,Wg,xN,V8,H8,$8,G8,K8,q8,Q1,z8,W8,X8,Y8=s(511),J8=s(2041),Z8=s(225),eL=s(767),tL=0,I3=J8,vN=Z8,pu=eL,Ju=Y8,yN=0,bN=1,rL=2,wN=3,NN=4,j3=5,nL=6,P3=7,B3=8,CN=9,T3=10,cde=[2,3,7],ude=[3,3,11],aL=[280,256,256,256,40],dde=[0,1,1,1,0],fde=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],hde=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ade=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],mde=8,k3=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],F3=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],V1=null,pde=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],gde=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],sL=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],xde=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],vde=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],yde=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],bde=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],e0=[],Gd=[],wh=[],wde=1,iL=2,t0=[],Zu=[];Wu("UpsampleRgbLinePair",Gt,3),Wu("UpsampleBgrLinePair",tr,3),Wu("UpsampleRgbaLinePair",Sa,4),Wu("UpsampleBgraLinePair",ra,4),Wu("UpsampleArgbLinePair",ei,4),Wu("UpsampleRgba4444LinePair",ma,2),Wu("UpsampleRgb565LinePair",Rr,2);var Nde=E.UpsampleRgbLinePair,Cde=E.UpsampleBgrLinePair,oL=E.UpsampleRgbaLinePair,lL=E.UpsampleBgraLinePair,cL=E.UpsampleArgbLinePair,uL=E.UpsampleRgba4444LinePair,_de=E.UpsampleRgb565LinePair,_N=16,EN=1<<_N-1,H1=-227,O3=482,Ede=6,dL=0,Sde=s(256),Ide=s(256),jde=s(256),Pde=s(256),Bde=s(O3-H1),Tde=s(O3-H1);gs("YuvToRgbRow",Gt,3),gs("YuvToBgrRow",tr,3),gs("YuvToRgbaRow",Sa,4),gs("YuvToBgraRow",ra,4),gs("YuvToArgbRow",ei,4),gs("YuvToRgba4444Row",ma,2),gs("YuvToRgb565Row",Rr,2);var fL=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],SN=[0,2,8],kde=[8,7,6,4,4,2,2,2,1,1,1,1],Fde=1;this.WebPDecodeRGBA=function(N,k,q,oe,Te){var Qe=bN,Ke=new Ar,Je=new xe;Ke.ba=Je,Je.S=Qe,Je.width=[Je.width],Je.height=[Je.height];var rt=Je.width,ft=Je.height,Bt=new Se;if(Bt==null||N==null)var Xt=2;else e(Bt!=null),Xt=$d(N,k,q,Bt.width,Bt.height,Bt.Pd,Bt.Qd,Bt.format,null);if(Xt!=0?rt=0:(rt!=null&&(rt[0]=Bt.width[0]),ft!=null&&(ft[0]=Bt.height[0]),rt=1),rt){Je.width=Je.width[0],Je.height=Je.height[0],oe!=null&&(oe[0]=Je.width),Te!=null&&(Te[0]=Je.height);e:{if(oe=new ir,(Te=new wr).data=N,Te.w=k,Te.ha=q,Te.kd=1,k=[0],e(Te!=null),((N=$d(Te.data,Te.w,Te.ha,null,null,null,k,null,Te))==0||N==7)&&k[0]&&(N=4),(k=N)==0){if(e(Ke!=null),oe.data=Te.data,oe.w=Te.w+Te.offset,oe.ha=Te.ha-Te.offset,oe.put=Me,oe.ac=Lt,oe.bc=_e,oe.ma=Ke,Te.xa){if((N=at())==null){Ke=1;break e}if(function(ht,Rt){var Kt=[0],fr=[0],Wt=[0];t:for(;;){if(ht==null)return 0;if(Rt==null)return ht.a=2,0;if(ht.l=Rt,ht.a=0,se(ht.m,Rt.data,Rt.w,Rt.ha),!U(ht.m,Kt,fr,Wt)){ht.a=3;break t}if(ht.xb=iL,Rt.width=Kt[0],Rt.height=fr[0],!lt(Kt[0],fr[0],1,ht,null))break t;return 1}return e(ht.a!=0),0}(N,oe)){if(oe=(k=qA(oe.width,oe.height,Ke.Oa,Ke.ba))==0){t:{oe=N;r:for(;;){if(oe==null){oe=0;break t}if(e(oe.s.yc!=null),e(oe.s.Ya!=null),e(0<oe.s.Wb),e((q=oe.l)!=null),e((Te=q.ma)!=null),oe.xb!=0){if(oe.ca=Te.ba,oe.tb=Te.tb,e(oe.ca!=null),!k1(Te.Oa,q,wN)){oe.a=2;break r}if(!dt(oe,q.width)||q.da)break r;if((q.da||Pe(oe.ca.S))&&Uc(),11>oe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),oe.ca.f.kb.F!=null&&Uc()),oe.Pb&&0<oe.s.ua&&oe.s.vb.X==null&&!X(oe.s.vb,oe.s.Wa.Xa)){oe.a=1;break r}oe.xb=0}if(!st(oe,oe.V,oe.Ba,oe.c,oe.i,q.o,Z))break r;Te.Dc=oe.Ma,oe=1;break t}e(oe.a!=0),oe=0}oe=!oe}oe&&(k=N.a)}else k=N.a}else{if((N=new Nr)==null){Ke=1;break e}if(N.Fa=Te.na,N.P=Te.P,N.qc=Te.Sa,$r(N,oe)){if((k=qA(oe.width,oe.height,Ke.Oa,Ke.ba))==0){if(N.Aa=0,q=Ke.Oa,e((Te=N)!=null),q!=null){if(0<(rt=0>(rt=q.Md)?0:100<rt?255:255*rt/100)){for(ft=Bt=0;4>ft;++ft)12>(Xt=Te.pb[ft]).lc&&(Xt.ia=rt*kde[0>Xt.lc?0:Xt.lc]>>3),Bt|=Xt.ia;Bt&&(alert("todo:VP8InitRandom"),Te.ia=1)}Te.Ga=q.Id,100<Te.Ga?Te.Ga=100:0>Te.Ga&&(Te.Ga=0)}(function(ht,Rt){if(ht==null)return 0;if(Rt==null)return Pr(ht,2,"NULL VP8Io parameter in VP8Decode().");if(!ht.cb&&!$r(ht,Rt))return 0;if(e(ht.cb),Rt.ac==null||Rt.ac(Rt)){Rt.ob&&(ht.L=0);var Kt=SN[ht.L];if(ht.L==2?(ht.yb=0,ht.zb=0):(ht.yb=Rt.v-Kt>>4,ht.zb=Rt.j-Kt>>4,0>ht.yb&&(ht.yb=0),0>ht.zb&&(ht.zb=0)),ht.Va=Rt.o+15+Kt>>4,ht.Hb=Rt.va+15+Kt>>4,ht.Hb>ht.za&&(ht.Hb=ht.za),ht.Va>ht.Ub&&(ht.Va=ht.Ub),0<ht.L){var fr=ht.ed;for(Kt=0;4>Kt;++Kt){var Wt;if(ht.Qa.Cb){var pr=ht.Qa.Lb[Kt];ht.Qa.Fb||(pr+=fr.Tb)}else pr=fr.Tb;for(Wt=0;1>=Wt;++Wt){var gr=ht.gd[Kt][Wt],Tr=pr;if(fr.Pc&&(Tr+=fr.vd[0],Wt&&(Tr+=fr.od[0])),0<(Tr=0>Tr?0:63<Tr?63:Tr)){var Sr=Tr;0<fr.wb&&(Sr=4<fr.wb?Sr>>2:Sr>>1)>9-fr.wb&&(Sr=9-fr.wb),1>Sr&&(Sr=1),gr.dd=Sr,gr.tc=2*Tr+Sr,gr.ld=40<=Tr?2:15<=Tr?1:0}else gr.tc=0;gr.La=Wt}}}Kt=0}else Pr(ht,6,"Frame setup failed"),Kt=ht.a;if(Kt=Kt==0){if(Kt){ht.$c=0,0<ht.Aa||(ht.Ic=Fde);t:{Kt=ht.Ic,fr=4*(Sr=ht.za);var xn=32*Sr,on=Sr+1,Wn=0<ht.L?Sr*(0<ht.Aa?2:1):0,fn=(ht.Aa==2?2:1)*Sr;if((gr=fr+832+(Wt=3*(16*Kt+SN[ht.L])/2*xn)+(pr=ht.Fa!=null&&0<ht.Fa.length?ht.Kc.c*ht.Kc.i:0))!=gr)Kt=0;else{if(gr>ht.Vb){if(ht.Vb=0,ht.Ec=s(gr),ht.Fc=0,ht.Ec==null){Kt=Pr(ht,1,"no memory during frame initialization.");break t}ht.Vb=gr}gr=ht.Ec,Tr=ht.Fc,ht.Ac=gr,ht.Bc=Tr,Tr+=fr,ht.Gd=o(xn,Dr),ht.Hd=0,ht.rb=o(on+1,rr),ht.sb=1,ht.wa=Wn?o(Wn,Dt):null,ht.Y=0,ht.D.Nb=0,ht.D.wa=ht.wa,ht.D.Y=ht.Y,0<ht.Aa&&(ht.D.Y+=Sr),e(!0),ht.oc=gr,ht.pc=Tr,Tr+=832,ht.ya=o(fn,Ot),ht.aa=0,ht.D.ya=ht.ya,ht.D.aa=ht.aa,ht.Aa==2&&(ht.D.aa+=Sr),ht.R=16*Sr,ht.B=8*Sr,Sr=(xn=SN[ht.L])*ht.R,xn=xn/2*ht.B,ht.sa=gr,ht.ta=Tr+Sr,ht.qa=ht.sa,ht.ra=ht.ta+16*Kt*ht.R+xn,ht.Ha=ht.qa,ht.Ia=ht.ra+8*Kt*ht.B+xn,ht.$c=0,Tr+=Wt,ht.mb=pr?gr:null,ht.nb=pr?Tr:null,e(Tr+pr<=ht.Fc+ht.Vb),Zr(ht),a(ht.Ac,ht.Bc,0,fr),Kt=1}}if(Kt){if(Rt.ka=0,Rt.y=ht.sa,Rt.O=ht.ta,Rt.f=ht.qa,Rt.N=ht.ra,Rt.ea=ht.Ha,Rt.Vd=ht.Ia,Rt.fa=ht.R,Rt.Rc=ht.B,Rt.F=null,Rt.J=0,!tL){for(Kt=-255;255>=Kt;++Kt)Y8[255+Kt]=0>Kt?-Kt:Kt;for(Kt=-1020;1020>=Kt;++Kt)J8[1020+Kt]=-128>Kt?-128:127<Kt?127:Kt;for(Kt=-112;112>=Kt;++Kt)Z8[112+Kt]=-16>Kt?-16:15<Kt?15:Kt;for(Kt=-255;510>=Kt;++Kt)eL[255+Kt]=0>Kt?0:255<Kt?255:Kt;tL=1}ZA=Oe,qm=fe,Ff=tt,Ma=vt,ds=mt,Yu=Sn,Bi=Bf,ho=fo,bh=je,U1=ut,Wg=zu,xN=R,V8=wt,H8=Vt,$8=dc,G8=ol,K8=fu,q8=KA,Gd[0]=Ir,Gd[1]=It,Gd[2]=tn,Gd[3]=Gr,Gd[4]=yr,Gd[5]=Bn,Gd[6]=jr,Gd[7]=yn,Gd[8]=ua,Gd[9]=mn,e0[0]=ar,e0[1]=bt,e0[2]=St,e0[3]=Jt,e0[4]=or,e0[5]=_r,e0[6]=Cr,wh[0]=Fl,wh[1]=Ct,wh[2]=ga,wh[3]=Yi,wh[4]=Qn,wh[5]=xa,wh[6]=du,Kt=1}else Kt=0}Kt&&(Kt=function(pa,Ao){for(pa.M=0;pa.M<pa.Va;++pa.M){var Xn,hn=pa.Jc[pa.M&pa.Xb],qr=pa.m,Ti=pa;for(Xn=0;Xn<Ti.za;++Xn){var $n=qr,va=Ti,_s=va.Ac,ul=va.Bc+4*Xn,fc=va.zc,xi=va.ya[va.aa+Xn];if(va.Qa.Bb?xi.$b=ee($n,va.Pa.jb[0])?2+ee($n,va.Pa.jb[2]):ee($n,va.Pa.jb[1]):xi.$b=0,va.kc&&(xi.Ad=ee($n,va.Bd)),xi.Za=!ee($n,145)+0,xi.Za){var Rl=xi.Ob,hc=0;for(va=0;4>va;++va){var mo,wa=fc[0+va];for(mo=0;4>mo;++mo){wa=vde[_s[ul+mo]][wa];for(var Ha=sL[ee($n,wa[0])];0<Ha;)Ha=sL[2*Ha+ee($n,wa[Ha])];wa=-Ha,_s[ul+mo]=wa}n(Rl,hc,_s,ul,4),hc+=4,fc[0+va]=wa}}else wa=ee($n,156)?ee($n,128)?1:3:ee($n,163)?2:0,xi.Ob[0]=wa,a(_s,ul,wa,4),a(fc,0,wa,4);xi.Dd=ee($n,142)?ee($n,114)?ee($n,183)?1:3:2:0}if(Ti.m.Ka)return Pr(pa,7,"Premature end-of-partition0 encountered.");for(;pa.ja<pa.za;++pa.ja){if(Ti=hn,$n=(qr=pa).rb[qr.sb-1],_s=qr.rb[qr.sb+qr.ja],Xn=qr.ya[qr.aa+qr.ja],ul=qr.kc?Xn.Ad:0)$n.la=_s.la=0,Xn.Za||($n.Na=_s.Na=0),Xn.Hc=0,Xn.Gc=0,Xn.ia=0;else{var vi,$a;if($n=_s,_s=Ti,ul=qr.Pa.Xc,fc=qr.ya[qr.aa+qr.ja],xi=qr.pb[fc.$b],va=fc.ad,Rl=0,hc=qr.rb[qr.sb-1],wa=mo=0,a(va,Rl,0,384),fc.Za)var dl=0,Kd=ul[3];else{Ha=s(16);var ki=$n.Na+hc.Na;if(ki=V1(_s,ul[1],ki,xi.Eb,0,Ha,0),$n.Na=hc.Na=(0<ki)+0,1<ki)ZA(Ha,0,va,Rl);else{var Qc=Ha[0]+3>>3;for(Ha=0;256>Ha;Ha+=16)va[Rl+Ha]=Qc}dl=1,Kd=ul[0]}var fs=15&$n.la,po=15&hc.la;for(Ha=0;4>Ha;++Ha){var gu=1&po;for(Qc=$a=0;4>Qc;++Qc)fs=fs>>1|(gu=(ki=V1(_s,Kd,ki=gu+(1&fs),xi.Sc,dl,va,Rl))>dl)<<7,$a=$a<<2|(3<ki?3:1<ki?2:va[Rl+0]!=0),Rl+=16;fs>>=4,po=po>>1|gu<<7,mo=(mo<<8|$a)>>>0}for(Kd=fs,dl=po>>4,vi=0;4>vi;vi+=2){for($a=0,fs=$n.la>>4+vi,po=hc.la>>4+vi,Ha=0;2>Ha;++Ha){for(gu=1&po,Qc=0;2>Qc;++Qc)ki=gu+(1&fs),fs=fs>>1|(gu=0<(ki=V1(_s,ul[2],ki,xi.Qc,0,va,Rl)))<<3,$a=$a<<2|(3<ki?3:1<ki?2:va[Rl+0]!=0),Rl+=16;fs>>=2,po=po>>1|gu<<5}wa|=$a<<4*vi,Kd|=fs<<4<<vi,dl|=(240&po)<<vi}$n.la=Kd,hc.la=dl,fc.Hc=mo,fc.Gc=wa,fc.ia=43690&wa?0:xi.ia,ul=!(mo|wa)}if(0<qr.L&&(qr.wa[qr.Y+qr.ja]=qr.gd[Xn.$b][Xn.Za],qr.wa[qr.Y+qr.ja].La|=!ul),Ti.Ka)return Pr(pa,7,"Premature end-of-file encountered.")}if(Zr(pa),qr=Ao,Ti=1,Xn=(hn=pa).D,$n=0<hn.L&&hn.M>=hn.zb&&hn.M<=hn.Va,hn.Aa==0)t:{if(Xn.M=hn.M,Xn.uc=$n,cl(hn,Xn),Ti=1,Xn=($a=hn.D).Nb,$n=(wa=SN[hn.L])*hn.R,_s=wa/2*hn.B,Ha=16*Xn*hn.R,Qc=8*Xn*hn.B,ul=hn.sa,fc=hn.ta-$n+Ha,xi=hn.qa,va=hn.ra-_s+Qc,Rl=hn.Ha,hc=hn.Ia-_s+Qc,po=(fs=$a.M)==0,mo=fs>=hn.Va-1,hn.Aa==2&&cl(hn,$a),$a.uc)for(gu=(ki=hn).D.M,e(ki.D.uc),$a=ki.yb;$a<ki.Hb;++$a){dl=$a,Kd=gu;var Ac=(xu=(fl=ki).D).Nb;vi=fl.R;var xu=xu.wa[xu.Y+dl],vu=fl.sa,Vc=fl.ta+16*Ac*vi+16*dl,yu=xu.dd,xs=xu.tc;if(xs!=0)if(e(3<=xs),fl.L==1)0<dl&&G8(vu,Vc,vi,xs+4),xu.La&&q8(vu,Vc,vi,xs),0<Kd&&$8(vu,Vc,vi,xs+4),xu.La&&K8(vu,Vc,vi,xs);else{var bu=fl.B,qd=fl.qa,zm=fl.ra+8*Ac*bu+8*dl,Nh=fl.Ha,fl=fl.Ia+8*Ac*bu+8*dl;Ac=xu.ld,0<dl&&(ho(vu,Vc,vi,xs+4,yu,Ac),U1(qd,zm,Nh,fl,bu,xs+4,yu,Ac)),xu.La&&(xN(vu,Vc,vi,xs,yu,Ac),H8(qd,zm,Nh,fl,bu,xs,yu,Ac)),0<Kd&&(Bi(vu,Vc,vi,xs+4,yu,Ac),bh(qd,zm,Nh,fl,bu,xs+4,yu,Ac)),xu.La&&(Wg(vu,Vc,vi,xs,yu,Ac),V8(qd,zm,Nh,fl,bu,xs,yu,Ac))}}if(hn.ia&&alert("todo:DitherRow"),qr.put!=null){if($a=16*fs,fs=16*(fs+1),po?(qr.y=hn.sa,qr.O=hn.ta+Ha,qr.f=hn.qa,qr.N=hn.ra+Qc,qr.ea=hn.Ha,qr.W=hn.Ia+Qc):($a-=wa,qr.y=ul,qr.O=fc,qr.f=xi,qr.N=va,qr.ea=Rl,qr.W=hc),mo||(fs-=wa),fs>qr.o&&(fs=qr.o),qr.F=null,qr.J=null,hn.Fa!=null&&0<hn.Fa.length&&$a<fs&&(qr.J=Va(hn,qr,$a,fs-$a),qr.F=hn.mb,qr.F==null&&qr.F.length==0)){Ti=Pr(hn,3,"Could not decode alpha data.");break t}$a<qr.j&&(wa=qr.j-$a,$a=qr.j,e(!(1&wa)),qr.O+=hn.R*wa,qr.N+=hn.B*(wa>>1),qr.W+=hn.B*(wa>>1),qr.F!=null&&(qr.J+=qr.width*wa)),$a<fs&&(qr.O+=qr.v,qr.N+=qr.v>>1,qr.W+=qr.v>>1,qr.F!=null&&(qr.J+=qr.v),qr.ka=$a-qr.j,qr.U=qr.va-qr.v,qr.T=fs-$a,Ti=qr.put(qr))}Xn+1!=hn.Ic||mo||(n(hn.sa,hn.ta-$n,ul,fc+16*hn.R,$n),n(hn.qa,hn.ra-_s,xi,va+8*hn.B,_s),n(hn.Ha,hn.Ia-_s,Rl,hc+8*hn.B,_s))}if(!Ti)return Pr(pa,6,"Output aborted.")}return 1}(ht,Rt)),Rt.bc!=null&&Rt.bc(Rt),Kt&=1}return Kt?(ht.cb=0,Kt):0})(N,oe)||(k=N.a)}}else k=N.a}k==0&&Ke.Oa!=null&&Ke.Oa.fd&&(k=F1(Ke.ba))}Ke=k}Qe=Ke!=0?null:11>Qe?Je.f.RGBA.eb:Je.f.kb.y}else Qe=null;return Qe};var hL=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(E,B){for(var T="",P=0;P<4;P++)T+=String.fromCharCode(E[B++]);return T}function d(E,B){return E[B+0]|E[B+1]<<8}function f(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16)>>>0}function A(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16|E[B+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,v=t,y=function(E,B){var T={},P=0,O=!1,z=0,ce=0;if(T.frames=[],!function(F,H){for(var K=0;K<4;K++)if(F[H+K]!="RIFF".charCodeAt(K))return!0;return!1}(E,B)){for(A(E,B+=4),B+=8;B<E.length;){var de=u(E,B),ue=A(E,B+=4);B+=4;var me=ue+(1&ue);switch(de){case"VP8 ":case"VP8L":T.frames[P]===void 0&&(T.frames[P]={}),(Re=T.frames[P]).src_off=O?ce:B-8,Re.src_size=z+ue+8,P++,O&&(O=!1,z=0,ce=0);break;case"VP8X":(Re=T.header={}).feature_flags=E[B];var se=B+4;Re.canvas_width=1+f(E,se),se+=3,Re.canvas_height=1+f(E,se),se+=3;break;case"ALPH":O=!0,z=me+8,ce=B-8;break;case"ANIM":(Re=T.header).bgcolor=A(E,B),se=B+4,Re.loop_count=d(E,se),se+=2;break;case"ANMF":var ke,Re;(Re=T.frames[P]={}).offset_x=2*f(E,B),B+=3,Re.offset_y=2*f(E,B),B+=3,Re.width=1+f(E,B),B+=3,Re.height=1+f(E,B),B+=3,Re.duration=f(E,B),B+=3,ke=E[B++],Re.dispose=1&ke,Re.blend=ke>>1&1}de!="ANMF"&&(B+=me)}return T}}(v,0);y.response=v,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,w=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var j=0;j<w.length&&w[j].blend!=0;j++);}var I=w[0],_=x.WebPDecodeRGBA(v,I.src_off,I.src_size,m,h);I.rgba=_,I.imgwidth=m[0],I.imgheight=h[0];for(var S=0;S<m[0]*h[0]*4;S++)p[S]=_[S];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,a,s,o,l,c,u,d=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new c,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new o,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new o,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=F;Object.defineProperty(this,"pdf",{get:function(){return H}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(X){K=!!X}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(X){L=!!X}});var W=0;Object.defineProperty(this,"posX",{get:function(){return W},set:function(X){isNaN(X)||(W=X)}});var Y=0;Object.defineProperty(this,"posY",{get:function(){return Y},set:function(X){isNaN(X)||(Y=X)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(X){var De;typeof X=="number"?De=[X,X,X,X]:((De=new Array(4))[0]=X[0],De[1]=X.length>=2?X[1]:De[0],De[2]=X.length>=3?X[2]:De[0],De[3]=X.length>=4?X[3]:De[1]),u.margin=De}});var D=!1;Object.defineProperty(this,"autoPaging",{get:function(){return D},set:function(X){D=X}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(X){Q=X}});var ee=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ee},set:function(X){ee=X}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(X){X instanceof d&&(u=X)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(X){u.path=X}});var ve=[];Object.defineProperty(this,"ctxStack",{get:function(){return ve},set:function(X){ve=X}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(X){var De;De=A(X),this.ctx.fillStyle=De.style,this.ctx.isFillTransparent=De.a===0,this.ctx.fillOpacity=De.a,this.pdf.setFillColor(De.r,De.g,De.b,{a:De.a}),this.pdf.setTextColor(De.r,De.g,De.b,{a:De.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(X){var De=A(X);this.ctx.strokeStyle=De.style,this.ctx.isStrokeTransparent=De.a===0,this.ctx.strokeOpacity=De.a,De.a===0?this.pdf.setDrawColor(255,255,255):(De.a,this.pdf.setDrawColor(De.r,De.g,De.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(X){["butt","round","square"].indexOf(X)!==-1&&(this.ctx.lineCap=X,this.pdf.setLineCap(X))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(X){isNaN(X)||(this.ctx.lineWidth=X,this.pdf.setLineWidth(X))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(X){["bevel","round","miter"].indexOf(X)!==-1&&(this.ctx.lineJoin=X,this.pdf.setLineJoin(X))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(X){isNaN(X)||(this.ctx.miterLimit=X,this.pdf.setMiterLimit(X))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(X){this.ctx.textBaseline=X}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(X){["right","end","center","left","start"].indexOf(X)!==-1&&(this.ctx.textAlign=X)}});var M=null,Ye=null,ae=null;Object.defineProperty(this,"fontFaces",{get:function(){return ae},set:function(X){M=null,Ye=null,ae=X}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(X){var De;if(this.ctx.font=X,(De=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(X))!==null){var le=De[1];De[2];var $e=De[3],Xe=De[4];De[5];var it=De[6],xt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Xe)[2];Xe=Math.floor(xt==="px"?parseFloat(Xe)*this.pdf.internal.scaleFactor:xt==="em"?parseFloat(Xe)*this.pdf.getFontSize():parseFloat(Xe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Xe);var jt=function(be){var Ce,Le,Ae=[],We=be.trim();if(We==="")return m5;if(We in SV)return[SV[We]];for(;We!=="";){switch(Le=null,Ce=(We=jV(We)).charAt(0)){case'"':case"'":Le=Jje(We.substring(1),Ce);break;default:Le=Zje(We)}if(Le===null||(Ae.push(Le[0]),(We=jV(Le[1]))!==""&&We.charAt(0)!==","))return m5;We=We.replace(/^,/,"")}return Ae}(it);if(this.fontFaces){var Mt=function(be,Ce){var Le=be.getFontList(),Ae=JSON.stringify(Le);if(M===null||Ye!==Ae){var We=function(ct){var _t=[];return Object.keys(ct).forEach(function(pe){ct[pe].forEach(function(Pe){var Ee=null;switch(Pe){case"bold":Ee={family:pe,weight:"bold"};break;case"italic":Ee={family:pe,style:"italic"};break;case"bolditalic":Ee={family:pe,weight:"bold",style:"italic"};break;case"":case"normal":Ee={family:pe}}Ee!==null&&(Ee.ref={name:pe,style:Pe},_t.push(Ee))})}),_t}(Le);M=function(ct){for(var _t={},pe=0;pe<ct.length;++pe){var Pe=A5(ct[pe]),Ee=Pe.family,Ze=Pe.stretch,xe=Pe.style,Se=Pe.weight;_t[Ee]=_t[Ee]||{},_t[Ee][Ze]=_t[Ee][Ze]||{},_t[Ee][Ze][xe]=_t[Ee][Ze][xe]||{},_t[Ee][Ze][xe][Se]=Pe}return _t}(We.concat(Ce)),Ye=Ae}return M}(this.pdf,this.fontFaces),Ft=jt.map(function(be){return{family:be,stretch:"normal",weight:$e,style:le}}),$t=function(be,Ce,Le){for(var Ae=(Le=Le||{}).defaultFontFamily||"times",We=Object.assign({},Yje,Le.genericFontFamilies||{}),ct=null,_t=null,pe=0;pe<Ce.length;++pe)if(We[(ct=A5(Ce[pe])).family]&&(ct.family=We[ct.family]),be.hasOwnProperty(ct.family)){_t=be[ct.family];break}if(!(_t=_t||be[Ae]))throw new Error("Could not find a font-family for the rule '"+IV(ct)+"' and default family '"+Ae+"'.");if(_t=function(Pe,Ee){if(Ee[Pe])return Ee[Pe];var Ze=Hk[Pe],xe=Ze<=Hk.normal?-1:1,Se=EV(Ee,Ore,Ze,xe);if(!Se)throw new Error("Could not find a matching font-stretch value for "+Pe);return Se}(ct.stretch,_t),_t=function(Pe,Ee){if(Ee[Pe])return Ee[Pe];for(var Ze=Fre[Pe],xe=0;xe<Ze.length;++xe)if(Ee[Ze[xe]])return Ee[Ze[xe]];throw new Error("Could not find a matching font-style for "+Pe)}(ct.style,_t),!(_t=function(Pe,Ee){if(Ee[Pe])return Ee[Pe];if(Pe===400&&Ee[500])return Ee[500];if(Pe===500&&Ee[400])return Ee[400];var Ze=Xje[Pe],xe=EV(Ee,Dre,Ze,Pe<400?-1:1);if(!xe)throw new Error("Could not find a matching font-weight for value "+Pe);return xe}(ct.weight,_t)))throw new Error("Failed to resolve a font for the rule '"+IV(ct)+"'.");return _t}(Mt,Ft);this.pdf.setFont($t.ref.name,$t.ref.style)}else{var kt="";($e==="bold"||parseInt($e,10)>=700||le==="bold")&&(kt="bold"),le==="italic"&&(kt+="italic"),kt.length===0&&(kt="normal");for(var Ge="",ie={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ue=0;Ue<jt.length;Ue++){if(this.pdf.internal.getFont(jt[Ue],kt,{noFallback:!0,disableWarning:!0})!==void 0){Ge=jt[Ue];break}if(kt==="bolditalic"&&this.pdf.internal.getFont(jt[Ue],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ge=jt[Ue],kt="bold";else if(this.pdf.internal.getFont(jt[Ue],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ge=jt[Ue],kt="normal";break}}if(Ge===""){for(var Ne=0;Ne<jt.length;Ne++)if(ie[jt[Ne]]){Ge=ie[jt[Ne]];break}}Ge=Ge===""?"Times":Ge,this.pdf.setFont(Ge,kt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(X){this.ctx.globalCompositeOperation=X}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(X){this.ctx.globalAlpha=X}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(X){this.ctx.lineDashOffset=X,Re.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(X){this.ctx.lineDash=X,Re.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(X){this.ctx.ignoreClearRect=!!X}})};f.prototype.setLineDash=function(F){this.lineDash=F},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){w.call(this,"fill",!1)},f.prototype.stroke=function(){w.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new o(F,H));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(F,H)},f.prototype.closePath=function(){var F=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&es(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){F=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(F.x,F.y)},f.prototype.lineTo=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new o(F,H));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},f.prototype.quadraticCurveTo=function(F,H,K,L){if(isNaN(K)||isNaN(L)||isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var W=this.ctx.transform.applyToPoint(new o(K,L)),Y=this.ctx.transform.applyToPoint(new o(F,H));this.path.push({type:"qct",x1:Y.x,y1:Y.y,x:W.x,y:W.y}),this.ctx.lastPoint=new o(W.x,W.y)},f.prototype.bezierCurveTo=function(F,H,K,L,W,Y){if(isNaN(W)||isNaN(Y)||isNaN(F)||isNaN(H)||isNaN(K)||isNaN(L))throw hs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var D=this.ctx.transform.applyToPoint(new o(W,Y)),Q=this.ctx.transform.applyToPoint(new o(F,H)),ee=this.ctx.transform.applyToPoint(new o(K,L));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:ee.x,y2:ee.y,x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},f.prototype.arc=function(F,H,K,L,W,Y){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(L)||isNaN(W))throw hs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Y=!!Y,!this.ctx.transform.isIdentity){var D=this.ctx.transform.applyToPoint(new o(F,H));F=D.x,H=D.y;var Q=this.ctx.transform.applyToPoint(new o(0,K)),ee=this.ctx.transform.applyToPoint(new o(0,0));K=Math.sqrt(Math.pow(Q.x-ee.x,2)+Math.pow(Q.y-ee.y,2))}Math.abs(W-L)>=2*Math.PI&&(L=0,W=2*Math.PI),this.path.push({type:"arc",x:F,y:H,radius:K,startAngle:L,endAngle:W,counterclockwise:Y})},f.prototype.arcTo=function(F,H,K,L,W){throw new Error("arcTo not implemented.")},f.prototype.rect=function(F,H,K,L){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(L))throw hs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,H),this.lineTo(F+K,H),this.lineTo(F+K,H+L),this.lineTo(F,H+L),this.lineTo(F,H),this.lineTo(F+K,H),this.lineTo(F,H)},f.prototype.fillRect=function(F,H,K,L){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(L))throw hs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var W={};this.lineCap!=="butt"&&(W.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(W.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,H,K,L),this.fill(),W.hasOwnProperty("lineCap")&&(this.lineCap=W.lineCap),W.hasOwnProperty("lineJoin")&&(this.lineJoin=W.lineJoin)}},f.prototype.strokeRect=function(F,H,K,L){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(L))throw hs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(F,H,K,L),this.stroke())},f.prototype.clearRect=function(F,H,K,L){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(L))throw hs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,H,K,L))},f.prototype.save=function(F){F=typeof F!="boolean"||F;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},f.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage(H),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(F){var H,K,L,W;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))H=0,K=0,L=0,W=0;else{var Y=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(Y!==null)H=parseInt(Y[1]),K=parseInt(Y[2]),L=parseInt(Y[3]),W=1;else if((Y=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)H=parseInt(Y[1]),K=parseInt(Y[2]),L=parseInt(Y[3]),W=parseFloat(Y[4]);else{if(W=1,typeof F=="string"&&F.charAt(0)!=="#"){var D=new Sre(F);F=D.ok?D.toHex():"#000000"}F.length===4?(H=F.substring(1,2),H+=H,K=F.substring(2,3),K+=K,L=F.substring(3,4),L+=L):(H=F.substring(1,3),K=F.substring(3,5),L=F.substring(5,7)),H=parseInt(H,16),K=parseInt(K,16),L=parseInt(L,16)}}return{r:H,g:K,b:L,a:W,style:F}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(F,H,K,L){if(isNaN(H)||isNaN(K)||typeof F!="string")throw hs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!h.call(this)){var W=me(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;P.call(this,{text:F,x:H,y:K,scale:Y,angle:W,align:this.textAlign,maxWidth:L})}},f.prototype.strokeText=function(F,H,K,L){if(isNaN(H)||isNaN(K)||typeof F!="string")throw hs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){L=isNaN(L)?void 0:L;var W=me(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;P.call(this,{text:F,x:H,y:K,scale:Y,renderingMode:"stroke",angle:W,align:this.textAlign,maxWidth:L})}},f.prototype.measureText=function(F){if(typeof F!="string")throw hs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,K=this.pdf.internal.scaleFactor,L=H.internal.getFontSize(),W=H.getStringUnitWidth(F)*L/H.internal.scaleFactor;return new function(Y){var D=(Y=Y||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this}({width:W*=Math.round(96*K/72*1e4)/1e4})},f.prototype.scale=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new c(F,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.rotate=function(F){if(isNaN(F))throw hs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new c(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.translate=function(F,H){if(isNaN(F)||isNaN(H))throw hs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new c(1,0,0,1,F,H);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.transform=function(F,H,K,L,W,Y){if(isNaN(F)||isNaN(H)||isNaN(K)||isNaN(L)||isNaN(W)||isNaN(Y))throw hs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var D=new c(F,H,K,L,W,Y);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.setTransform=function(F,H,K,L,W,Y){F=isNaN(F)?1:F,H=isNaN(H)?0:H,K=isNaN(K)?0:K,L=isNaN(L)?1:L,W=isNaN(W)?0:W,Y=isNaN(Y)?0:Y,this.ctx.transform=new c(F,H,K,L,W,Y)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(F,H,K,L,W,Y,D,Q,ee){var ve=this.pdf.getImageProperties(F),M=1,Ye=1,ae=1,X=1;L!==void 0&&Q!==void 0&&(ae=Q/L,X=ee/W,M=ve.width/L*Q/L,Ye=ve.height/W*ee/W),Y===void 0&&(Y=H,D=K,H=0,K=0),L!==void 0&&Q===void 0&&(Q=L,ee=W),L===void 0&&Q===void 0&&(Q=ve.width,ee=ve.height);var De=this.ctx.transform.decompose(),le=me(De.rotate.shx),$e=new c,Xe=($e=($e=($e=$e.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new l(Y-H*ae,D-K*X,L*M,W*Ye));if(this.autoPaging){for(var it,xt=x.call(this,Xe),jt=[],Mt=0;Mt<xt.length;Mt+=1)jt.indexOf(xt[Mt])===-1&&jt.push(xt[Mt]);b(jt);for(var Ft=jt[0],$t=jt[jt.length-1],kt=Ft;kt<$t+1;kt++){this.pdf.setPage(kt);var Ge=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ie=kt===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ne=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],be=kt===1?0:Ue+(kt-2)*Ne;if(this.ctx.clip_path.length!==0){var Ce=this.path;it=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(it,this.posX+this.margin[3],-be+ie+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=Ce}var Le=JSON.parse(JSON.stringify(Xe));Le=y([Le],this.posX+this.margin[3],-be+ie+this.ctx.prevPageLastElemOffset)[0];var Ae=(kt>Ft||kt<$t)&&p.call(this);Ae&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ge,Ne,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",Le.x,Le.y,Le.w,Le.h,null,null,le),Ae&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(F,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,le)};var x=function(F,H,K){var L=[];H=H||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var W=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":L.push(Math.floor((F.y+W)/K)+1);break;case"arc":L.push(Math.floor((F.y+W-F.radius)/K)+1),L.push(Math.floor((F.y+W+F.radius)/K)+1);break;case"qct":var Y=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);L.push(Math.floor((Y.y+W)/K)+1),L.push(Math.floor((Y.y+Y.h+W)/K)+1);break;case"bct":var D=ke(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);L.push(Math.floor((D.y+W)/K)+1),L.push(Math.floor((D.y+D.h+W)/K)+1);break;case"rect":L.push(Math.floor((F.y+W)/K)+1),L.push(Math.floor((F.y+F.h+W)/K)+1)}for(var Q=0;Q<L.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<L[Q];)v.call(this);return L},v=function(){var F=this.fillStyle,H=this.strokeStyle,K=this.font,L=this.lineCap,W=this.lineWidth,Y=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=H,this.font=K,this.lineCap=L,this.lineWidth=W,this.lineJoin=Y},y=function(F,H,K){for(var L=0;L<F.length;L++)switch(F[L].type){case"bct":F[L].x2+=H,F[L].y2+=K;case"qct":F[L].x1+=H,F[L].y1+=K;default:F[L].x+=H,F[L].y+=K}return F},b=function(F){return F.sort(function(H,K){return H-K})},w=function(F,H){var K=this.fillStyle,L=this.strokeStyle,W=this.lineCap,Y=this.lineWidth,D=Math.abs(Y*this.ctx.transform.scaleX),Q=this.lineJoin;if(this.autoPaging){for(var ee,ve,M=JSON.parse(JSON.stringify(this.path)),Ye=JSON.parse(JSON.stringify(this.path)),ae=[],X=0;X<Ye.length;X++)if(Ye[X].x!==void 0)for(var De=x.call(this,Ye[X]),le=0;le<De.length;le+=1)ae.indexOf(De[le])===-1&&ae.push(De[le]);for(var $e=0;$e<ae.length;$e++)for(;this.pdf.internal.getNumberOfPages()<ae[$e];)v.call(this);b(ae);for(var Xe=ae[0],it=ae[ae.length-1],xt=Xe;xt<it+1;xt++){this.pdf.setPage(xt),this.fillStyle=K,this.strokeStyle=L,this.lineCap=W,this.lineWidth=D,this.lineJoin=Q;var jt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Mt=xt===1?this.posY+this.margin[0]:this.margin[0],Ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],kt=xt===1?0:Ft+(xt-2)*$t;if(this.ctx.clip_path.length!==0){var Ge=this.path;ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ee,this.posX+this.margin[3],-kt+Mt+this.ctx.prevPageLastElemOffset),j.call(this,F,!0),this.path=Ge}if(ve=JSON.parse(JSON.stringify(M)),this.path=y(ve,this.posX+this.margin[3],-kt+Mt+this.ctx.prevPageLastElemOffset),H===!1||xt===0){var ie=(xt>Xe||xt<it)&&p.call(this);ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],jt,$t,null).clip().discardPath()),j.call(this,F,H),ie&&this.pdf.restoreGraphicsState()}this.lineWidth=Y}this.path=M}else this.lineWidth=D,j.call(this,F,H),this.lineWidth=Y},j=function(F,H){if((F!=="stroke"||H||!m.call(this))&&(F==="stroke"||H||!h.call(this))){for(var K,L,W=[],Y=this.path,D=0;D<Y.length;D++){var Q=Y[D];switch(Q.type){case"begin":W.push({begin:!0});break;case"close":W.push({close:!0});break;case"mt":W.push({start:Q,deltas:[],abs:[]});break;case"lt":var ee=W.length;if(Y[D-1]&&!isNaN(Y[D-1].x)&&(K=[Q.x-Y[D-1].x,Q.y-Y[D-1].y],ee>0)){for(;ee>=0;ee--)if(W[ee-1].close!==!0&&W[ee-1].begin!==!0){W[ee-1].deltas.push(K),W[ee-1].abs.push(Q);break}}break;case"bct":K=[Q.x1-Y[D-1].x,Q.y1-Y[D-1].y,Q.x2-Y[D-1].x,Q.y2-Y[D-1].y,Q.x-Y[D-1].x,Q.y-Y[D-1].y],W[W.length-1].deltas.push(K);break;case"qct":var ve=Y[D-1].x+2/3*(Q.x1-Y[D-1].x),M=Y[D-1].y+2/3*(Q.y1-Y[D-1].y),Ye=Q.x+2/3*(Q.x1-Q.x),ae=Q.y+2/3*(Q.y1-Q.y),X=Q.x,De=Q.y;K=[ve-Y[D-1].x,M-Y[D-1].y,Ye-Y[D-1].x,ae-Y[D-1].y,X-Y[D-1].x,De-Y[D-1].y],W[W.length-1].deltas.push(K);break;case"arc":W.push({deltas:[],abs:[],arc:!0}),Array.isArray(W[W.length-1].abs)&&W[W.length-1].abs.push(Q)}}L=H?null:F==="stroke"?"stroke":"fill";for(var le=!1,$e=0;$e<W.length;$e++)if(W[$e].arc)for(var Xe=W[$e].abs,it=0;it<Xe.length;it++){var xt=Xe[it];xt.type==="arc"?S.call(this,xt.x,xt.y,xt.radius,xt.startAngle,xt.endAngle,xt.counterclockwise,void 0,H,!le):O.call(this,xt.x,xt.y),le=!0}else if(W[$e].close===!0)this.pdf.internal.out("h"),le=!1;else if(W[$e].begin!==!0){var jt=W[$e].start.x,Mt=W[$e].start.y;z.call(this,W[$e].deltas,jt,Mt),le=!0}L&&E.call(this,L),H&&B.call(this)}},I=function(F){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-K;case"top":return F+H-K;case"hanging":return F+H-2*K;case"middle":return F+H/2-K;default:return F}},_=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function(H,K){this.colorStops.push([H,K])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(F,H,K,L,W,Y,D,Q,ee){for(var ve=de.call(this,K,L,W,Y),M=0;M<ve.length;M++){var Ye=ve[M];M===0&&(ee?T.call(this,Ye.x1+F,Ye.y1+H):O.call(this,Ye.x1+F,Ye.y1+H)),ce.call(this,F,H,Ye.x2,Ye.y2,Ye.x3,Ye.y3,Ye.x4,Ye.y4)}Q?B.call(this):E.call(this,D)},E=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(F,H){this.pdf.internal.out(r(F)+" "+n(H)+" m")},P=function(F){var H;switch(F.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var K,L,W,Y=this.pdf.getTextDimensions(F.text),D=I.call(this,F.y),Q=_.call(this,D)-Y.h,ee=this.ctx.transform.applyToPoint(new o(F.x,D));if(this.autoPaging){var ve=this.ctx.transform.decompose(),M=new c;M=(M=(M=M.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var Ye=this.ctx.transform.applyToRectangle(new l(F.x,D,Y.w,Y.h)),ae=M.applyToRectangle(new l(F.x,Q,Y.w,Y.h)),X=x.call(this,ae),De=[],le=0;le<X.length;le+=1)De.indexOf(X[le])===-1&&De.push(X[le]);b(De);for(var $e=De[0],Xe=De[De.length-1],it=$e;it<Xe+1;it++){this.pdf.setPage(it);var xt=it===1?this.posY+this.margin[0]:this.margin[0],jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mt=this.pdf.internal.pageSize.height-this.margin[2],Ft=Mt-this.margin[0],$t=this.pdf.internal.pageSize.width-this.margin[1],kt=$t-this.margin[3],Ge=it===1?0:jt+(it-2)*Ft;if(this.ctx.clip_path.length!==0){var ie=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(K,this.posX+this.margin[3],-1*Ge+xt),j.call(this,"fill",!0),this.path=ie}var Ue=y([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-Ge+xt+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(L=this.pdf.internal.getFontSize(),this.pdf.setFontSize(L*F.scale),W=this.lineWidth,this.lineWidth=W*F.scale);var Ne=this.autoPaging!=="text";if(Ne||Ue.y+Ue.h<=Mt){if(Ne||Ue.y>=xt&&Ue.x<=$t){var be=Ne?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||$t-Ue.x)[0],Ce=y([JSON.parse(JSON.stringify(Ye))],this.posX+this.margin[3],-Ge+xt+this.ctx.prevPageLastElemOffset)[0],Le=Ne&&(it>$e||it<Xe)&&p.call(this);Le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,Ft,null).clip().discardPath()),this.pdf.text(be,Ce.x,Ce.y,{angle:F.angle,align:H,renderingMode:F.renderingMode}),Le&&this.pdf.restoreGraphicsState()}}else Ue.y<Mt&&(this.ctx.prevPageLastElemOffset+=Mt-Ue.y);F.scale>=.01&&(this.pdf.setFontSize(L),this.lineWidth=W)}}else F.scale>=.01&&(L=this.pdf.internal.getFontSize(),this.pdf.setFontSize(L*F.scale),W=this.lineWidth,this.lineWidth=W*F.scale),this.pdf.text(F.text,ee.x+this.posX,ee.y+this.posY,{angle:F.angle,align:H,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(L),this.lineWidth=W)},O=function(F,H,K,L){K=K||0,L=L||0,this.pdf.internal.out(r(F+K)+" "+n(H+L)+" l")},z=function(F,H,K){return this.pdf.lines(F,H,K,null,null)},ce=function(F,H,K,L,W,Y,D,Q){this.pdf.internal.out([e(a(K+F)),e(s(L+H)),e(a(W+F)),e(s(Y+H)),e(a(D+F)),e(s(Q+H)),"c"].join(" "))},de=function(F,H,K,L){for(var W=2*Math.PI,Y=Math.PI/2;H>K;)H-=W;var D=Math.abs(K-H);D<W&&L&&(D=W-D);for(var Q=[],ee=L?-1:1,ve=H;D>1e-5;){var M=ve+ee*Math.min(D,Y);Q.push(ue.call(this,F,ve,M)),D-=Math.abs(M-ve),ve=M}return Q},ue=function(F,H,K){var L=(K-H)/2,W=F*Math.cos(L),Y=F*Math.sin(L),D=W,Q=-Y,ee=D*D+Q*Q,ve=ee+D*W+Q*Y,M=4/3*(Math.sqrt(2*ee*ve)-ve)/(D*Y-Q*W),Ye=D-M*Q,ae=Q+M*D,X=Ye,De=-ae,le=L+H,$e=Math.cos(le),Xe=Math.sin(le);return{x1:F*Math.cos(H),y1:F*Math.sin(H),x2:Ye*$e-ae*Xe,y2:Ye*Xe+ae*$e,x3:X*$e-De*Xe,y3:X*Xe+De*$e,x4:F*Math.cos(K),y4:F*Math.sin(K)}},me=function(F){return 180*F/Math.PI},se=function(F,H,K,L,W,Y){var D=F+.5*(K-F),Q=H+.5*(L-H),ee=W+.5*(K-W),ve=Y+.5*(L-Y),M=Math.min(F,W,D,ee),Ye=Math.max(F,W,D,ee),ae=Math.min(H,Y,Q,ve),X=Math.max(H,Y,Q,ve);return new l(M,ae,Ye-M,X-ae)},ke=function(F,H,K,L,W,Y,D,Q){var ee,ve,M,Ye,ae,X,De,le,$e,Xe,it,xt,jt,Mt,Ft=K-F,$t=L-H,kt=W-K,Ge=Y-L,ie=D-W,Ue=Q-Y;for(ve=0;ve<41;ve++)$e=(De=(M=F+(ee=ve/40)*Ft)+ee*((ae=K+ee*kt)-M))+ee*(ae+ee*(W+ee*ie-ae)-De),Xe=(le=(Ye=H+ee*$t)+ee*((X=L+ee*Ge)-Ye))+ee*(X+ee*(Y+ee*Ue-X)-le),ve==0?(it=$e,xt=Xe,jt=$e,Mt=Xe):(it=Math.min(it,$e),xt=Math.min(xt,Xe),jt=Math.max(jt,$e),Mt=Math.max(Mt,Xe));return new l(Math.round(it),Math.round(xt),Math.round(jt-it),Math.round(Mt-xt))},Re=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,H,K=(F=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:H}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(rn.API),function(t){var e=function(o){var l,c,u,d,f,A,h,m,p,x;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(A=(f=((f=((f=((f=(f-(x=f%85))/85)-(p=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(A+33,h+33,m+33,p+33,x+33)):c.push(122);return function(v,y){for(var b=y;b>0;b--)v.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,A=String,h="length",m=255,p="charCodeAt",x="slice",v="replace";for(o[x](-2),o=o[x](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[x](o[h]%5||5))[h];f>d;d+=5)c=52200625*(o[p](d)-33)+614125*(o[p](d+1)-33)+7225*(o[p](d+2)-33)+85*(o[p](d+3)-33)+(o[p](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var w=b;w>0;w--)y.pop()}(u,l[h]),A.fromCharCode.apply(A,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Dk(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(rn.API),function(t){t.loadFile=function(e,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,A=0,h=function(m){var p=m.length,x=[],v=String.fromCharCode;for(A=0;A<p;A+=1)x.push(v(255&m.charCodeAt(A)));return x.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(a,s,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(rn.API),function(t){function e(){return(Mn.html2canvas?Promise.resolve(Mn.html2canvas):iA(()=>Promise.resolve().then(()=>Q6),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Mn.DOMPurify?Promise.resolve(Mn.DOMPurify):iA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=es(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],p=m.src.find(function(x){return x.format==="truetype"});p&&u.addFont(p.url,m.ref.name,m.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,u.context2d.save(!0),c(this.prop.container,A)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||rn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(A){return u.updateProgress(null,d),A}).then(d,f).then(function(A){return u.updateProgress(1),A})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),A=u.call(f,l,c);return o.convert(A,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,rn.getPageSize=function(l,c,u){if(es(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,A=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(A))p=h[A][1]/f,x=h[A][0]/f;else try{p=u[1],x=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:f,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(A5):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(rn.API),rn.API.addJS=function(t){return BV=t,this.internal.events.subscribe("postPutResources",function(){DC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(DC+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),PV=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+BV+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){DC!==void 0&&PV!==void 0&&this.internal.out("/Names <</JavaScript "+DC+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var A=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(rn.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var A,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(f.charCodeAt(x+1))!==-1){A=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),p={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:A,numcomponents:f.charCodeAt(x+9)};break}h=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(rn.API),rn.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,s=Oje(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;a=u&&c===1?function(S){for(var E=S.width,B=S.height,T=S.data,P=S.palette,O=S.depth,z=!1,ce=[],de=[],ue=void 0,me=!1,se=0,ke=0;ke<P.length;ke++){var Re=OQ(P[ke],4),F=Re[0],H=Re[1],K=Re[2],L=Re[3];ce.push(F,H,K),L!=null&&(L===0?(se++,de.length<1&&de.push(ke)):L<255&&(me=!0))}if(me||se>1){z=!0,de=void 0;var W=E*B;ue=new Uint8Array(W);for(var Y=new DataView(T.buffer),D=0;D<W;D++){var Q=p5(Y,D,O),ee=OQ(P[Q],4)[3];ue[D]=ee}}else se===0&&(de=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:z?8:void 0,colorBytes:T,alphaBytes:ue,needSMask:z,palette:ce,mask:de}}(s):c===2||c===4?function(S){for(var E=S.data,B=S.width,T=S.height,P=S.channels,O=S.depth,z=P===2?"DeviceGray":"DeviceRGB",ce=P-1,de=B*T,ue=ce,me=de*ue,se=1*de,ke=Math.ceil(me*O/8),Re=Math.ceil(se*O/8),F=new Uint8Array(ke),H=new Uint8Array(Re),K=new DataView(E.buffer),L=new DataView(F.buffer),W=new DataView(H.buffer),Y=!1,D=0;D<de;D++){for(var Q=D*P,ee=0;ee<ue;ee++)UV(L,p5(K,Q+ee,O),D*ue+ee,O);var ve=p5(K,Q+ue,O);ve<(1<<O)-1&&(Y=!0),UV(W,ve,1*D,O)}return{colorSpace:z,colorsPerPixel:ce,sMaskBitsPerComponent:Y?O:void 0,colorBytes:F,alphaBytes:H,needSMask:Y}}(s):function(S){var E=S.data,B=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(T){for(var P=T.length,O=new Uint8Array(2*P),z=new DataView(O.buffer,O.byteOffset,O.byteLength),ce=0;ce<P;ce++)z.setUint16(2*ce,T[ce],!1);return O}(E):E,needSMask:!1}}(s);var f,A,h,m=a,p=m.colorSpace,x=m.colorsPerPixel,v=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,w=m.needSMask,j=m.palette,I=m.mask,_=null;return n!==rn.API.image_compression.NONE&&typeof Dk=="function"?(_=function(S){var E;switch(S){case rn.API.image_compression.FAST:E=11;break;case rn.API.image_compression.MEDIUM:E=13;break;case rn.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),f=this.decode.FLATE_DECODE,A="/Predictor ".concat(_," /Colors ").concat(x," /BitsPerComponent ").concat(d," /Columns ").concat(o),t=OV(y,Math.ceil(o*x*d/8),x,d,n),w&&(h=OV(b,Math.ceil(o*v/8),1,v,n))):(f=void 0,A=void 0,t=y,w&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:f,decodeParameters:A,transparency:I,palette:j,sMask:h,predictor:_,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:v,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,a){var s=new nPe(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new g5(100).encode(u,100);return t.processJPEG.call(this,d,r,n,a)},t.processGIF87A=t.processGIF89A}(rn.API),Wd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wd.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){hs.log("bit decode error:"+r)}},Wd.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Wd.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Wd.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Wd.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=t}},Wd.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},Wd.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Wd.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Wd.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,a){var s=new Wd(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new g5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(rn.API),VV.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,a){var s=new VV(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new g5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(rn.API),rn.API.processRGBA=function(t,e,r){for(var n=t.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],A=n[u+2],h=n[u+3];s[l++]=d,s[l++]=f,s[l++]=A,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},rn.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},dx=rn.API,RC=dx.getCharWidthsArray=function(t,e){var r,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=e.doKerning!==!1,A=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof a.metadata.widthOfString=="function"?x.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(A=f&&es(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,x.push((l[n]||p)/c+A)),m=n;return x},TV=dx.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return dx.processArabic&&(t=dx.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,a)/r:RC.apply(this,arguments).reduce(function(s,o){return s+o},0)},kV=function(t,e,r,n){for(var a=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<r;)l+=e[s],s++;a.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>n&&(a.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&a.push(t.slice(c,s)),a},FV=function(t,e,r){r||(r={});var n,a,s,o,l,c,u,d=[],f=[d],A=r.textIndent||0,h=0,m=0,p=t.split(" "),x=RC.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),y=[];p.map(function(w){(w=w.split(/\s*\n/)).length>1?y=y.concat(w.map(function(j,I){return(I&&j.length?`
`:"")+j})):y.push(w[0])}),p=y,c=TV.apply(this,[v,r])}for(s=0,o=p.length;s<o;s++){var b=0;if(n=p[s],c&&n[0]==`
`&&(n=n.substr(1),b=1),A+h+(m=(a=RC.apply(this,[n,r])).reduce(function(w,j){return w+j},0))>e||b){if(m>e){for(l=kV.apply(this,[n,a,e-(A+h),e]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(w,j){return w+j},0)}else d=[n];f.push(d),A=m+c,h=x}else d.push(n),A+=h+m,h=x}return u=c?function(w,j){return(j?v:"")+w.join(" ")}:function(w){return w.join(" ")},f.map(u)},dx.splitTextToSize=function(t,e,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),A="Unicode";return f.metadata[A]?{widths:f.metadata[A].widths||{0:1},kerning:f.metadata[A].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(FV.apply(this,[n[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=e[s],a[e[s]]=r[s];var o=function(A){return"0x"+parseInt(A,10).toString(16)},l=t.__fontmetrics__.compress=function(A){var h,m,p,x,v=["{"];for(var y in A){if(h=A[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+a[p.slice(-1)];else{if(es(h)!=="object")throw new Error("Don't know what to do with value type "+es(h)+".");p=l(h)}v.push(m+p)}return v.push("}"),v.join("")},c=t.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,v={},y=1,b=v,w=[],j="",I="",_=A.length-1,S=1;S<_;S+=1)(x=A[S])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(w.push([b,p]),b={},p=void 0):x=="}"?((m=w.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?y=-1:p===void 0?n.hasOwnProperty(x)?(j+=n[x],p=parseInt(j,16)*y,y=1,j=""):j+=x:n.hasOwnProperty(x)?(I+=n[x],b[p]=parseInt(I,16)*y,y=1,p=void 0,I=""):I+=x;return v},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(A){var h=A.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(rn.API),function(t){var e=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};t.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(pE(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(rn),rn.API.addSvgAsImage=function(t,e,r,n,a,s,o,l){if(isNaN(e)||isNaN(r))throw hs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw hs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Mn.canvg?Promise.resolve(Mn.canvg):iA(()=>import("./index.es-DwYbIF8k.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(u,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),e,r,n,a,o,l)})},rn.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,r);return this},rn.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function A(m,p){var x,v=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(es(t)==="object"){for(a in t)if(s=t[a],A(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&A(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(rn.API),function(t){var e=t.API,r=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,A=s.length;f<A;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,A;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,A=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<A;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,A=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<A.length;m++)h+=String.fromCharCode(A[m]);var p=u();d({data:h,addLength1:!0,objectId:p}),c("endobj");var x=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Tx(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Tx(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+Tx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,A="",h=0;h<f.length;h++)A+=String.fromCharCode(f[h]);var m=u();d({data:A,addLength1:!0,objectId:m}),c("endobj");var p=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Tx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Tx(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},A=f.pdfEscape,h=f.activeFontKey,m=f.fonts,p=h,x="",v=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),v=0;v<y.length;v+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[v].charCodeAt(0)]),o||y[v].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=y[v]:x+="";var w="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?w=A(x,p).split("").map(function(j){return j.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(w=r(x,m[p])),f.isHex=!0,{text:w,x:c,y:u,options:d,mutex:f}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(rn),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(rn.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,d,f=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var w=function(T){var P=T.charCodeAt(),O=P>>8,z=p[O];return z!==void 0?f[256*z+(255&P)]:O===252||O===253?"AL":v.test(O)?"L":O===8?"R":"N"},j=function(T){for(var P,O=0;O<T.length;O++){if((P=w(T.charAt(O)))==="L")return!1;if(P==="R")return!0}return!1},I=function(T,P,O,z){var ce,de,ue,me,se=P[z];switch(se){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(se="AN");break;case"AL":y=!0,se="R";break;case"WS":case"BN":se="N";break;case"CS":z<1||z+1>=P.length||(ce=O[z-1])!=="EN"&&ce!=="AN"||(de=P[z+1])!=="EN"&&de!=="AN"?se="N":y&&(de="AN"),se=de===ce?de:"N";break;case"ES":se=(ce=z>0?O[z-1]:"B")==="EN"&&z+1<P.length&&P[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&O[z-1]==="EN"){se="EN";break}if(y){se="N";break}for(ue=z+1,me=P.length;ue<me&&P[ue]==="ET";)ue++;se=ue<me&&P[ue]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(me=P.length,ue=z+1;ue<me&&P[ue]==="NSM";)ue++;if(ue<me){var ke=T[z],Re=ke>=1425&&ke<=2303||ke===64286;if(ce=P[ue],Re&&(ce==="R"||ce==="AL")){se="R";break}}}se=z<1||(ce=P[z-1])==="B"?"N":O[z-1];break;case"B":y=!1,a=!0,se=b;break;case"S":s=!0,se="N"}return se},_=function(T,P,O){var z=T.split("");return O&&S(z,O,{hiLevel:b}),z.reverse(),P&&P.reverse(),z.join("")},S=function(T,P,O){var z,ce,de,ue,me,se=-1,ke=T.length,Re=0,F=[],H=b?h:A,K=[];for(y=!1,a=!1,s=!1,ce=0;ce<ke;ce++)K[ce]=w(T[ce]);for(de=0;de<ke;de++){if(me=Re,F[de]=I(T,K,F,de),z=240&(Re=H[me][m[F[de]]]),Re&=15,P[de]=ue=H[Re][5],z>0)if(z===16){for(ce=se;ce<de;ce++)P[ce]=1;se=-1}else se=-1;if(H[Re][6])se===-1&&(se=de);else if(se>-1){for(ce=se;ce<de;ce++)P[ce]=ue;se=-1}K[de]==="B"&&(P[de]=0),O.hiLevel|=ue}s&&function(L,W,Y){for(var D=0;D<Y;D++)if(L[D]==="S"){W[D]=b;for(var Q=D-1;Q>=0&&L[Q]==="WS";Q--)W[Q]=b}}(K,P,ke)},E=function(T,P,O,z,ce){if(!(ce.hiLevel<T)){if(T===1&&b===1&&!a)return P.reverse(),void(O&&O.reverse());for(var de,ue,me,se,ke=P.length,Re=0;Re<ke;){if(z[Re]>=T){for(me=Re+1;me<ke&&z[me]>=T;)me++;for(se=Re,ue=me-1;se<ue;se++,ue--)de=P[se],P[se]=P[ue],P[ue]=de,O&&(de=O[se],O[se]=O[ue],O[ue]=de);Re=me}Re++}}},B=function(T,P,O){var z=T.split(""),ce={hiLevel:b};return O||(O=[]),S(z,O,ce),function(de,ue,me){if(me.hiLevel!==0&&d)for(var se,ke=0;ke<de.length;ke++)ue[ke]===1&&(se=x.indexOf(de[ke]))>=0&&(de[ke]=x[se+1])}(z,O,ce),E(2,z,P,O,ce),E(1,z,P,O,ce),z.join("")};return this.__bidiEngine__.doBidiReorder=function(T,P,O){if(function(ce,de){if(de)for(var ue=0;ue<ce.length;ue++)de[ue]=ue;l===void 0&&(l=j(ce)),u===void 0&&(u=j(ce))}(T,P),o||!c||u)if(o&&c&&l^u)b=l?1:0,T=_(T,P,O);else if(!o&&c&&u)b=l?1:0,T=B(T,P,O),T=_(T,P);else if(!o||l||c||u){if(o&&!c&&l^u)T=_(T,P),l?(b=0,T=B(T,P,O)):(b=1,T=B(T,P,O),T=_(T,P));else if(o&&l&&!c&&u)b=1,T=B(T,P,O),T=_(T,P);else if(!o&&!c&&l^u){var z=d;l?(b=1,T=B(T,P,O),b=0,d=!1,T=B(T,P,O),d=z):(b=0,T=B(T,P,O),T=_(T,P),b=1,d=!1,T=B(T,P,O),d=z,T=_(T,P))}}else b=0,T=B(T,P,O);else b=l?1:0,T=B(T,P,O);return T},this.__bidiEngine__.setOptions=function(T){T&&(o=T.isInputVisual,c=T.isOutputVisual,l=T.isInputRtl,u=T.isOutputRtl,d=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(rn),rn.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Em(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new xPe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new aPe(this.contents),this.head=new iPe(this),this.name=new dPe(this),this.cmap=new Mre(this),this.toUnicode={},this.hhea=new oPe(this),this.maxp=new fPe(this),this.hmtx=new hPe(this),this.post=new cPe(this),this.os2=new lPe(this),this.loca=new gPe(this),this.glyf=new APe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var a,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var jf,Em=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,a;for(a=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(e.charCodeAt(r)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,a,s,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)r=e[n],s.push(this.writeByte(r));return s},t}(),aPe=function(){var t;function e(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,a,s,o,l,c,u,d,f,A,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),d=16*h-f,(a=new Em).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(d),s=16*h,u=a.pos+s,l=null,m=[],r)for(A=r[p],a.writeString(p),a.writeInt(t(A)),a.writeInt(u),a.writeInt(A.length),m=m.concat(A),p==="head"&&(l=u),u+=A.length;u%4;)m.push(0),u++;return a.write(m),n=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(n),a.data},t=function(r){var n,a,s,o;for(r=Lre.call(r);r.length%4;)r.push(0);for(s=new Em(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),sPe={}.hasOwnProperty,ph=function(t,e){for(var r in e)sPe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};jf=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var iPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Em).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),HV=function(){function t(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),A=h/2,e.pos+=6,s=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),e.pos+=2,p=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),u=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),d=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),a=(this.length-e.pos+this.offset)/2,l=function(){var w,j;for(j=[],c=w=0;0<=a?w<a:w>a;c=0<=a?++w:--w)j.push(e.readUInt16());return j}(),c=v=0,b=s.length;v<b;c=++v)for(x=s[c],n=y=m=p[c];m<=x?y<=x:y>=x;n=m<=x?++y:--y)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(A-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=f}return t.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,_,S,E,B,T,P,O,z,ce,de,ue,me,se,ke,Re,F,H,K,L,W,Y,D,Q,ee,ve,M;switch(z=new Em,o=Object.keys(e).sort(function(Ye,ae){return Ye-ae}),r){case"macroman":for(p=0,x=function(){var Ye=[];for(m=0;m<256;++m)Ye.push(0);return Ye}(),y={0:0},s={},ce=0,se=o.length;ce<se;ce++)y[Q=e[a=o[ce]]]==null&&(y[Q]=++p),s[a]={old:e[a],new:y[e[a]]},x[a]=y[e[a]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(x),{charMap:s,subtable:z.data,maxGlyphID:p+1};case"unicode":for(P=[],f=[],b=0,y={},n={},v=u=null,de=0,ke=o.length;de<ke;de++)y[j=e[a=o[de]]]==null&&(y[j]=++b),n[a]={old:j,new:y[j]},l=y[j]-a,v!=null&&l===u||(v&&f.push(v),P.push(a),u=l),v=a;for(v&&f.push(v),f.push(65535),P.push(65535),B=2*(E=P.length),S=2*Math.pow(Math.log(E)/Math.LN2,2),A=Math.log(S/2)/Math.LN2,_=2*E-S,c=[],I=[],h=[],m=ue=0,Re=P.length;ue<Re;m=++ue){if(T=P[m],d=f[m],T===65535){c.push(0),I.push(0);break}if(T-(O=n[T].new)>=32768)for(c.push(0),I.push(2*(h.length+E-m)),a=me=T;T<=d?me<=d:me>=d;a=T<=d?++me:--me)h.push(n[a].new);else c.push(O-T),I.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*E+2*h.length),z.writeUInt16(0),z.writeUInt16(B),z.writeUInt16(S),z.writeUInt16(A),z.writeUInt16(_),Y=0,F=f.length;Y<F;Y++)a=f[Y],z.writeUInt16(a);for(z.writeUInt16(0),D=0,H=P.length;D<H;D++)a=P[D],z.writeUInt16(a);for(ee=0,K=c.length;ee<K;ee++)l=c[ee],z.writeUInt16(l);for(ve=0,L=I.length;ve<L;ve++)w=I[ve],z.writeUInt16(w);for(M=0,W=h.length;M<W;M++)p=h[M],z.writeUInt16(p);return{charMap:n,subtable:z.data,maxGlyphID:b+1}}},t}(),Mre=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new HV(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,a;return r==null&&(r="macroman"),n=HV.encode(e,r),(a=new Em).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},t}(),oPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),lPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),cPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)r=e.readByte(),a.push(this.names.push(e.readString(r)));return a;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),uPe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},dPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,a,s,o,l,c,u,d,f,A;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)a=n[s],e.pos=a.offset,u=e.readString(a.length),o=new uPe(u,a),c[A=a.nameID]==null&&(c[A]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),fPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),hPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,a,s,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)d.push(e.readInt16());return d}(),this.widths=(function(){var u,d,f,A;for(A=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],A.push(s.advance);return A}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),Lre=[].slice,APe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,a,s,o,l,c,u,d,f;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(e),(a=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new Em(r.read(a))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[e]=o===-1?new pPe(l,u,f,c,d):new mPe(l,o,u,f,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=e[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},t}(),mPe=function(){function t(e,r,n,a,s,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),pPe=function(){function t(e,r,n,a,s){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Em(Lre.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),gPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ph(t,jf),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},t}(),xPe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[r],e[r]=a[n];return e},t.prototype.glyphsFor=function(e){var r,n,a,s,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[s=e[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},t.prototype.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v;for(a in n=Mre.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},v=n.charMap)h[(c=v[a]).old]=c.new;for(m in A=n.maxGlyphID,o)m in h||(h[m]=A++);return d=function(y){var b,w;for(b in w={},y)w[y[b]]=b;return w}(h),f=Object.keys(d).sort(function(y,b){return y-b}),p=function(){var y,b,w;for(w=[],y=0,b=f.length;y<b;y++)l=f[y],w.push(d[l]);return w}(),s=this.font.glyf.encode(o,p,h),u=this.font.loca.encode(s.offsets,p),x={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();rn.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+r},e}();const $k=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:Wje,AcroFormAppearance:ln,AcroFormButton:Co,AcroFormCheckBox:Ib,AcroFormChoiceField:Dp,AcroFormComboBox:Mp,AcroFormEditBox:Eb,AcroFormListBox:Rp,AcroFormPasswordField:jb,AcroFormPushButton:Sb,AcroFormRadioButton:Lp,AcroFormTextField:fm,GState:I2,ShadingPattern:L0,TilingPattern:_p,default:rn,jsPDF:rn},Symbol.toStringTag,{value:"Module"}));async function $V(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:vr.now()};return Jn(yt(Ie,"inventory_batches"),e)}async function Ure(t,e){await Fn(Zt(Ie,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:vr.now()})}async function vPe(t,e){const r=sr(yt(Ie,"batch_allocations"),mr("saleDate",">=",t),mr("saleDate","<=",e)),n=await Ht(r),a={};return n.forEach(s=>{const o=s.data(),l=o.batchId;a[l]||(a[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),a[l].quantity+=Number(o.quantity||0),a[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(a)}async function Qre(t){const e=Zt(Ie,"salesV2",t),r=await zs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const u=String((c==null?void 0:c.batchId)||"").trim(),d=Number((c==null?void 0:c.qty)||0);u&&d&&a.push({batchId:u,qty:d})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),u=Number((l==null?void 0:l.qty)||0);c&&u&&a.push({batchId:c,qty:u})}if(a.length===0)return await Gs(Ie,async l=>{l.delete(e)}),{restored:0};const s=new Map;for(const l of a)s.set(l.batchId,Number((s.get(l.batchId)||0)+l.qty));let o=0;return await Gs(Ie,async l=>{const c=Array.from(s.entries()),u=c.map(([f])=>Zt(Ie,"inventory_batches",f)),d=await Promise.all(u.map(f=>l.get(f)));c.forEach(([f,A],h)=>{const m=d[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),v=Number((x+Number(A||0)).toFixed(3));l.update(u[h],{remaining:v}),o+=Number(A||0)}),l.delete(e)}),{restored:o}}var Vre={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},GV=Ui.createContext&&Ui.createContext(Vre),yPe=["attr","size","title"];function bPe(t,e){if(t==null)return{};var r=wPe(t,e),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)n=s[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function wPe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function FS(){return FS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},FS.apply(this,arguments)}function KV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function OS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KV(Object(r),!0).forEach(function(n){NPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NPe(t,e,r){return e=CPe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CPe(t){var e=_Pe(t,"string");return typeof e=="symbol"?e:e+""}function _Pe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hre(t){return t&&t.map((e,r)=>Ui.createElement(e.tag,OS({key:r},e.attr),Hre(e.child)))}function EPe(t){return e=>Ui.createElement(SPe,FS({attr:OS({},t.attr)},e),Hre(t.child))}function SPe(t){var e=r=>{var{attr:n,size:a,title:s}=t,o=bPe(t,yPe),l=a||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),Ui.createElement("svg",FS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:OS(OS({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&Ui.createElement("title",null,s),t.children)};return GV!==void 0?Ui.createElement(GV.Consumer,null,r=>e(r)):e(Vre)}function IPe(t){return EPe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Oc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(IPe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}function Dc(){const[t,e]=g.useState(0),r=g.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const Al=t=>Math.round((Number(t)||0)*100)/100,jh=t=>Math.round((Number(t)||0)*1e3)/1e3,ed=t=>Number(t??0).toFixed(2),Ph=t=>Number(t??0).toFixed(3),qV=(t,e)=>{var o;const r=t.date?String(t.date):"",n=(o=t.timestamp)!=null&&o.toDate?Mr(t.timestamp.toDate(),"yyyy-MM-dd"):"";let a=r||n;if(r&&n){const l=new Date(r+"T00:00:00").getTime(),c=new Date(n+"T00:00:00").getTime(),u=Math.abs(l-c)/(1e3*60*60*24);isFinite(u)&&u>30&&(a=n)}if(!a)return[];const s=t.type??"CONTADO";return Array.isArray(t.items)&&t.items.length>0?t.items.map((l,c)=>{const u=Number((l==null?void 0:l.qty)??0),d=Number((l==null?void 0:l.lineFinal)??0)||Math.max(0,Number((l==null?void 0:l.unitPrice)||0)*u-Number((l==null?void 0:l.discount)||0));return{id:`${e}#${c}`,productName:String((l==null?void 0:l.productName)??"(sin nombre)"),quantity:u,amount:Al(d),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String((l==null?void 0:l.measurement)??t.measurement??""),allocations:Array.isArray(l==null?void 0:l.allocations)?l.allocations:t.allocations,avgUnitCost:Number((l==null?void 0:l.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((l==null?void 0:l.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String(t.measurement??""),allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]};function jPe({role:t,roles:e}){const[r,n]=g.useState([]),[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),[m,p]=g.useState("ALL"),[x,v]=g.useState({}),[y,b]=g.useState(null),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState(""),[B,T]=g.useState(0),[P,O]=g.useState("0"),z=Mr(new Date,"yyyy-MM-dd"),[ce,de]=g.useState(z),[ue,me]=g.useState(z),[se,ke]=g.useState(!1),[Re,F]=g.useState(!1),[H,K]=g.useState(!1),[L,W]=g.useState(""),Y=g.useRef(null),{refreshKey:D,refresh:Q}=Dc(),ee=e&&e.length?e:t,ve=tbe(ee,"bills","cerrarVentas"),M=En(ee,"admin"),Ye=({title:xe,open:Se,onToggle:gt,right:Et})=>i.jsxs("button",{type:"button",onClick:gt,className:"w-full flex items-center justify-between gap-3 px-4 py-3 rounded-xl border bg-gray-50 hover:bg-gray-100 active:bg-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.jsx("span",{className:"font-semibold truncate",children:xe}),Et?i.jsx("span",{className:"text-xs text-gray-600",children:Et}):null]}),i.jsx("div",{className:"shrink-0 text-lg font-bold leading-none",children:Se?"":"+"})]});g.useEffect(()=>{if(!ce||!ue)return;u(!0);const xe=sr(yt(Ie,"salesV2"),mr("date",">=",ce),mr("date","<=",ue)),Se=jd(xe,gt=>{const Et=[];gt.forEach(Nt=>{const Tt=qV(Nt.data(),Nt.id);Et.push(...Tt)}),n(Et),u(!1)},gt=>{console.error("Error cargando ventas por periodo:",gt),n([]),u(!1)});return()=>Se()},[ce,ue,D]),g.useEffect(()=>{if(!ce||!ue)return;const xe=sr(yt(Ie,"salesV2"),mr("status","==","FLOTANTE"),mr("date",">=",ce),mr("date","<=",ue)),Se=jd(xe,gt=>{const Et=[];gt.forEach(Nt=>{const Tt=qV(Nt.data(),Nt.id);Et.push(...Tt)}),s(Et)});return()=>Se()},[ce,ue,D]),g.useEffect(()=>{(async()=>{try{const xe=await Ht(yt(Ie,"users")),Se={};xe.forEach(gt=>{const Et=gt.data(),Nt=String(Et.email||"").trim().toLowerCase(),Tt=String(Et.name||"").trim();Nt&&(Se[Nt]=Tt||Et.email||"")}),v(Se)}catch(xe){console.error("Error cargando usuarios:",xe),v({})}})()},[]);const ae=xe=>{const Se=String(xe||"").trim().toLowerCase();return x[Se]||xe||""};g.useEffect(()=>{(async()=>{const Se=sr(yt(Ie,"daily_closures"),mr("date","==",z)),gt=await Ht(Se);if(gt.empty)l(null);else{const Et=gt.docs[0];l({id:Et.id,...Et.data()})}})()},[z,D]);const X=Ui.useMemo(()=>{let xe=[];if(A==="FLOTANTE"){const gt=[...r,...a],Et=new Map;for(const Nt of gt)Nt.status==="FLOTANTE"&&Et.set(Nt.id,Nt);xe=Array.from(Et.values())}else if(A==="ALL"){const gt=[...r,...a],Et=new Map;for(const Nt of gt)Et.set(Nt.id,Nt);xe=Array.from(Et.values())}else xe=r.filter(gt=>gt.status==="PROCESADA");m!=="ALL"&&(xe=xe.filter(gt=>gt.type===m));const Se=L.trim().toLowerCase();if(Se){const gt=Nt=>String(Nt||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Et=gt(Se);xe=xe.filter(Nt=>gt(Nt.productName).includes(Et))}return xe},[A,r,a,L,m]),De=Al(X.reduce((xe,Se)=>xe+(Se.amount||0),0)),le=Al(X.reduce((xe,Se)=>xe+Number(Se.cogsAmount??0),0)),$e=xe=>String(xe||"").trim().toLowerCase()!=="lb",Xe=X.filter(xe=>xe.type==="CONTADO"),it=X.filter(xe=>xe.type==="CREDITO"),xt=jh(Xe.filter(xe=>$e(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),jt=jh(Xe.filter(xe=>!$e(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),Mt=jh(it.filter(xe=>$e(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),Ft=jh(it.filter(xe=>!$e(xe.measurement)).reduce((xe,Se)=>xe+(Se.quantity||0),0)),$t=Al(Xe.reduce((xe,Se)=>xe+(Se.amount||0),0)),kt=Al(it.reduce((xe,Se)=>xe+(Se.amount||0),0)),Ge=Al(Xe.reduce((xe,Se)=>xe+Number(Se.cogsAmount??0),0)),ie=Al(it.reduce((xe,Se)=>xe+Number(Se.cogsAmount??0),0)),Ue=Al($t-Ge),Ne=Al(kt-ie),be=jh(xt+Mt),Ce=jh(jt+Ft),Le=Al($t+kt),Ae={};X.forEach(xe=>{const Se=xe.productName||"(sin nombre)";Ae[Se]||(Ae[Se]={totalQuantity:0,totalAmount:0}),Ae[Se].totalQuantity=jh(Ae[Se].totalQuantity+(xe.quantity||0)),Ae[Se].totalAmount=Al(Ae[Se].totalAmount+(xe.amount||0))});const We=Object.entries(Ae).map(([xe,Se])=>({productName:xe,totalQuantity:Se.totalQuantity,totalAmount:Se.totalAmount})),ct=async()=>{try{const xe=X.filter(Me=>Me.status==="FLOTANTE"),Se=xe.length>0?xe:r.filter(Me=>Me.status!=="PROCESADA");if(Se.length===0){f("No hay ventas para procesar.");return}const gt={totalCharged:Al(Se.reduce((Me,_e)=>Me+(_e.amount||0),0)),totalSuggested:Al(Se.reduce((Me,_e)=>Me+(_e.amountSuggested||0),0)),totalUnits:jh(Se.reduce((Me,_e)=>Me+(_e.quantity||0),0)),totalCOGS:Al(Se.reduce((Me,_e)=>Me+Number(_e.cogsAmount??0),0))},Et=Al(gt.totalCharged-gt.totalSuggested),Nt=Al(gt.totalCharged-gt.totalCOGS),Tt=await Jn(yt(Ie,"daily_closures"),{date:z,createdAt:vr.now(),periodStart:ce,periodEnd:ue,totalCharged:gt.totalCharged,totalSuggested:gt.totalSuggested,totalDifference:Et,totalUnits:gt.totalUnits,totalCOGS:gt.totalCOGS,grossProfit:Nt,products:Se.map(Me=>({productName:Me.productName,quantity:Me.quantity,amount:Me.amount})),salesV2:Se.map(Me=>({id:Me.id,productName:Me.productName,quantity:Me.quantity,amount:Me.amount,amountSuggested:Me.amountSuggested,userEmail:Me.userEmail,clientName:Me.clientName,amountReceived:Me.amountReceived,change:Me.change,status:Me.status,cogsAmount:Me.cogsAmount??0,avgUnitCost:Me.avgUnitCost??null,allocations:Me.allocations??[],date:Me.date})),productSummary:Object.entries(Se.reduce((Me,_e)=>{const U=_e.productName||"(sin nombre)";return Me[U]||(Me[U]={totalQuantity:0,totalAmount:0}),Me[U].totalQuantity=jh(Me[U].totalQuantity+(_e.quantity||0)),Me[U].totalAmount=Al(Me[U].totalAmount+(_e.amount||0)),Me},{})).map(([Me,_e])=>({productName:Me,totalQuantity:_e.totalQuantity,totalAmount:_e.totalAmount}))}),Lt=tu(Ie);Se.forEach(Me=>{Lt.update(Zt(Ie,"salesV2",Me.id.split("#")[0]),{status:"PROCESADA",closureId:Tt.id,closureDate:z,date:Me.date})}),await Lt.commit(),f(` Cierre guardado. Ventas procesadas: ${Se.length}.`)}catch(xe){console.error(xe),f(" Error al guardar el cierre.")}},_t=async xe=>{if(!M){f(" No tienes permisos para revertir esta venta.");return}if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Fn(Zt(Ie,"salesV2",xe.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),f(" Venta revertida a FLOTANTE.")}catch(Se){console.error(Se),f(" No se pudo revertir la venta.")}},pe=xe=>{if(!M){f(" No tienes permisos para editar esta venta.");return}b(xe),j(xe.quantity),_(xe.amount),E(xe.clientName),T(xe.amountReceived),O(xe.change)},Pe=async()=>{if(!M){f(" No tienes permisos para guardar cambios.");return}if(y)try{await Fn(Zt(Ie,"salesV2",y.id.split("#")[0]),{quantity:w,amount:I,amountCharged:I,clientName:S,amountReceived:B,change:P}),b(null),f(" Venta actualizada.")}catch(xe){console.error(xe),f(" No se pudo actualizar la venta.")}},Ee=async xe=>{if(!M){f(" No tienes permisos para eliminar esta venta.");return}if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:Se}=await Qre(xe.split("#")[0]);f(` Venta eliminada. Stock restaurado: ${Number(Se).toFixed(2)}.`)}catch(Se){console.error(Se),f(" No se pudo eliminar la venta.")}},Ze=async()=>{if(Y.current){Y.current.classList.add("force-pdf-colors"),Y.current.classList.add("pdf-print-mode");try{const Se=(await Fg(Y.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),gt=new rn;gt.addImage(Se,"PNG",10,10,190,0),gt.save(`cierre_${z}.pdf`)}finally{Y.current.classList.remove("pdf-print-mode"),Y.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[i.jsxs("h2",{className:"text-2xl font-bold",children:["Cierre de Ventas - ",ce,"  ",ue]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(Oc,{onClick:Q})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx(Ye,{title:"Filtros",open:se,onToggle:()=>ke(xe=>!xe),right:i.jsxs("span",{className:"ml-1",children:[ce,"  ",ue,A!=="ALL"?`  ${A}`:"",m!=="ALL"?`  ${m==="CREDITO"?"Crdito":"Cash"}`:"",L.trim()?`  "${L.trim()}"`:""]})}),se&&i.jsx("div",{className:"mt-3 border rounded-xl p-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Periodo desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:ce,onChange:xe=>de(xe.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:ue,onChange:xe=>me(xe.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:A,onChange:xe=>h(xe.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Tipo Operacin"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:m,onChange:xe=>p(xe.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),i.jsx("option",{value:"CREDITO",children:"Crdito"}),i.jsx("option",{value:"CONTADO",children:"Cash"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-2 w-full",placeholder:"Buscar por producto...",value:L,onChange:xe=>W(xe.target.value)})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:Y,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[X.map(xe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${xe.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})}),i.jsx("td",{className:"border p-1",children:xe.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:xe.productName}),i.jsx("td",{className:"border p-1",children:Ph(xe.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ed(xe.amount)]}),i.jsx("td",{className:"border p-1",children:xe.date}),i.jsx("td",{className:"border p-1",children:ae(xe.userEmail)}),i.jsx("td",{className:"border p-1",children:xe.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:M?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>pe(xe),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Ee(xe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):xe.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:M?i.jsx("button",{onClick:()=>_t(xe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},xe.id)),X.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden mb-4",children:[i.jsx(Ye,{title:"Ventas",open:Re,onToggle:()=>F(xe=>!xe),right:i.jsxs("span",{className:"ml-1",children:[X.length,"  C$",ed(De)]})}),Re&&i.jsxs("div",{className:"mt-3 space-y-3",children:[X.map(xe=>i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:xe.productName}),i.jsx("div",{className:"text-xs text-gray-500",children:xe.date})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",ed(xe.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${xe.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cantidad"}),i.jsx("strong",{children:Ph(xe.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("strong",{children:xe.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:ae(xe.userEmail)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("strong",{className:"text-right break-all",children:xe.clientName||""})]}),i.jsx("div",{className:"pt-2",children:xe.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:M?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>pe(xe),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Ee(xe.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):xe.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:M?i.jsx("button",{onClick:()=>_t(xe.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},xe.id)),X.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Total libras Cash: ",i.jsx("strong",{children:Ph(jt)})]}),i.jsxs("div",{children:["Total Unidades cash: ",i.jsx("strong",{children:Ph(xt)})]}),i.jsxs("div",{children:["Total libras credito: ",i.jsx("strong",{children:Ph(Ft)})]}),i.jsxs("div",{children:["Total Unidades credito: ",i.jsx("strong",{children:Ph(Mt)})]}),i.jsxs("div",{children:["Total facturado Cash: ",i.jsxs("strong",{children:["C$",ed(Ge)]})]}),i.jsxs("div",{children:["Total facturado credito:"," ",i.jsxs("strong",{children:["C$",ed(ie)]})]}),i.jsxs("div",{children:["Total venta Cash: ",i.jsxs("strong",{children:["C$",ed($t)]})]}),i.jsxs("div",{children:["Total venta Credito: ",i.jsxs("strong",{children:["C$",ed(kt)]})]}),i.jsxs("div",{children:["Utilidad bruta Cash: ",i.jsxs("strong",{children:["C$",ed(Ue)]})]}),i.jsxs("div",{children:["Utilidad bruta credito:"," ",i.jsxs("strong",{children:["C$",ed(Ne)]})]}),i.jsxs("div",{children:["Total libras cash y credito: ",i.jsx("strong",{children:Ph(Ce)})]}),i.jsxs("div",{children:["Total unidades cash y credito:"," ",i.jsx("strong",{children:Ph(be)})]}),i.jsxs("div",{children:["Total ventas Cash y credito:"," ",i.jsxs("strong",{children:["C$",ed(Le)]})]}),i.jsxs("div",{children:["Total facturado a precio compra:"," ",i.jsxs("strong",{children:["C$",ed(le)]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx(Ye,{title:"Consolidado por producto",open:H,onToggle:()=>K(xe=>!xe),right:i.jsx("span",{className:"ml-1",children:We.length})}),H&&i.jsx("div",{className:"mt-3",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[We.map(xe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:xe.productName}),i.jsx("td",{className:"border p-1",children:Ph(xe.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ed(xe.totalAmount)]})]},xe.productName)),We.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[i.jsx("button",{disabled:!ve,onClick:ct,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:Ze,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),y&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[y.productName,"  ",ae(y.userEmail)]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:w,onChange:xe=>j(parseFloat(xe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:I,onChange:xe=>_(parseFloat(xe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:S,onChange:xe=>E(xe.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:xe=>T(parseFloat(xe.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:P,onChange:xe=>O(xe.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>b(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:Pe,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const td=t=>Number(t??0).toFixed(2),fx=t=>Number(t??0).toFixed(3);function PPe(){var y,b,w,j;const t=async I=>{if(!window.confirm(`Eliminar el cierre del ${I.date}?`))return;const _=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(_){const S=await Ht(sr(yt(Ie,"salesV2"),mr("closureId","==",I.id)));if(!S.empty){const E=tu(Ie);S.forEach(B=>{E.update(Zt(Ie,"salesV2",B.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await E.commit()}}await Kn(Zt(Ie,"daily_closures",I.id)),(u==null?void 0:u.id)===I.id&&d(null),await m(),A(` Cierre eliminado${_?" y ventas reabiertas.":"."}`)}catch(S){console.error(S),A(" No se pudo eliminar el cierre.")}},[e,r]=g.useState(Mr(Gee(new Date),"yyyy-MM-dd")),[n,a]=g.useState(Mr(new Date,"yyyy-MM-dd")),[s,o]=g.useState(!0),[l,c]=g.useState([]),[u,d]=g.useState(null),[f,A]=g.useState(""),h=g.useRef(null),m=async()=>{try{o(!0);const I=sr(yt(Ie,"daily_closures"),mr("date",">=",e),mr("date","<=",n)),_=await Ht(I),S=[];_.forEach(E=>S.push({id:E.id,...E.data()})),S.sort((E,B)=>E.date<B.date?1:E.date>B.date?-1:0),c(S)}catch(I){console.error(I),A(" Error cargando el historial.")}finally{o(!1)}};g.useEffect(()=>{m()},[]);const p=async I=>{I.preventDefault(),m()},x=g.useMemo(()=>{if(!u)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const I=Number(u.totalUnits??0),_=Number(u.totalSuggested??0),S=Number(u.totalCharged??0),E=Number(u.totalDifference??(isFinite(S-_)?S-_:0)),B=Number(u.totalCOGS??0),T=Number(u.grossProfit??(isFinite(S-B)?S-B:0));return{units:I,sug:_,chg:S,diff:E,cogs:B,profit:T}},[u]),v=async()=>{if(!h.current||!u)return;const I=h.current;I.classList.add("force-pdf-colors");try{const[{default:_},{jsPDF:S}]=await Promise.all([iA(()=>Promise.resolve().then(()=>Q6),void 0),iA(()=>Promise.resolve().then(()=>$k),void 0)]),B=(await _(I,{backgroundColor:"#ffffff",onclone:O=>{const z=O.defaultView;O.body.querySelectorAll("*").forEach(de=>{const ue=z.getComputedStyle(de);ue.color&&(de.style.color=ue.color),ue.backgroundColor&&ue.backgroundColor!=="rgba(0, 0, 0, 0)"&&(de.style.backgroundColor=ue.backgroundColor),ue.borderColor&&(de.style.borderColor=ue.borderColor)})}})).toDataURL("image/png"),{jsPDF:T}=await iA(async()=>{const{jsPDF:O}=await Promise.resolve().then(()=>$k);return{jsPDF:O}},void 0),P=new T;P.addImage(B,"PNG",10,10,190,0),P.save(`cierre_${u.date}.pdf`)}finally{I.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:I=>r(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:I=>a(I.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),s?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.date}),i.jsx("td",{className:"border p-1",children:fx(I.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.grossProfit??Number(I.totalCharged??0)-Number(I.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>d(I),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(I),children:"Eliminar"})]})})]},I.id))})]}),u&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",u.date]}),i.jsx("button",{onClick:()=>d(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:v,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:fx(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",td(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",td(x.profit)]})]})]}),(y=u.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:u.salesV2.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:fx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:I.date??""}),i.jsx("td",{className:"border p-1",children:I.userEmail??""})]},_))})]})]}):(b=u.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:u.sales.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:fx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amount)]}),i.jsx("td",{className:"border p-1",children:I.userEmail??""}),i.jsx("td",{className:"border p-1",children:I.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof I.change=="number"?td(I.change):I.change??"0"})]},_))})]})]}):(w=u.products)!=null&&w.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:u.products.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:fx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.amount)]})]},_))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(j=u.productSummary)!=null&&j.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:u.productSummary.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:fx(I.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(I.totalAmount)]})]},_))})]})]}):null]})]}),f&&i.jsx("p",{className:"mt-3 text-sm",children:f})]})}function BPe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(""),[o,l]=g.useState(!1),[c,u]=g.useState(["vendedor_pollo"]),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState([]),[x,v]=g.useState(!0),[y,b]=g.useState(null),[w,j]=g.useState(["vendedor_pollo"]),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,T]=g.useState(!1),[P,O]=g.useState([]),z=L=>!L||L==="vendedor"?"vendedor_pollo":L==="admin"||L==="supervisor_pollo"||L==="contador"||L==="vendedor_pollo"||L==="vendedor_ropa"||L==="vendedor_dulces"?L:"vendedor_pollo",ce=L=>L?Array.isArray(L)?L.map(W=>z(String(W))):[z(String(L))]:["vendedor_pollo"],de=async()=>{v(!0);const L=await Ht(yt(Ie,"users")),W=[];L.forEach(Y=>{const D=Y.data();W.push({id:Y.id,email:D.email??"",name:D.name??"",roles:ce(D.roles??D.role),sellerCandyId:D.sellerCandyId??""})}),p(W),v(!1)},ue=async()=>{try{const L=await Ht(yt(Ie,"sellers_candies")),W=[];L.forEach(Y=>{const D=Y.data();W.push({id:Y.id,name:D.name??"(sin nombre)",branchLabel:D.branch??"",commissionPercent:Number(D.commissionPercent??0)})}),O(W)}catch(L){console.error("Error cargando sellers_candies:",L)}};g.useEffect(()=>{de(),ue()},[]);const me=()=>{e(""),n(""),s(""),u(["vendedor_pollo"]),h("")},se=async L=>{if(L.preventDefault(),f(""),y){if(a&&a.length>0&&a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}}else if(a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}if(!t.trim()){f(" El nombre es obligatorio.");return}try{if(y){const M=Zt(Ie,"users",y),Ye=w.length?w:["vendedor_pollo"],ae=Ye.includes("vendedor_dulces")&&(I||A)||"";if(await Fn(M,{email:r,name:t.trim(),roles:Ye,role:Ye[0]||"vendedor_pollo",sellerCandyId:ae}),p(X=>X.map(De=>De.id===y?{...De,email:r,name:t.trim(),roles:Ye,sellerCandyId:ae}:De)),a&&a.length>=6)try{const X=QT(),De=S||r;await xge(X,De),f(` Usuario actualizado. Se envi correo de restablecimiento a ${De}`)}catch(X){console.error("Error sending password reset:",X),f(" Usuario actualizado. No se pudo enviar correo de restablecimiento.")}else f(" Usuario actualizado correctamente.");Re();return}const W=ID(),Y=SD(W.options,"Secondary"),D=QT(Y),Q=await vge(D,r,a),ee=c.length?c:["vendedor_pollo"],ve=ee.includes("vendedor_dulces")&&A||"";await Eee(Zt(yt(Ie,"users"),Q.user.uid),{email:r,name:t.trim(),roles:ee,role:ee[0]||"vendedor_pollo",sellerCandyId:ve}),await DD(D),await dpe(Y),p(M=>[{id:Q.user.uid,email:r,name:t.trim(),roles:ee,sellerCandyId:ve},...M]),f(" Usuario creado correctamente."),me(),T(!1)}catch(W){console.error(W),f(" Error al crear el usuario: "+W.message)}},ke=L=>{b(L.id),e(L.name||""),n(L.email||""),E(L.email||""),j(L.roles&&L.roles.length?L.roles:["vendedor_pollo"]),h(L.sellerCandyId||""),_(L.sellerCandyId||""),s(""),T(!0)},Re=()=>{b(null),j(["vendedor_pollo"]),_(""),E(""),me(),T(!1)},F=async L=>{confirm("Eliminar este usuario del listado?")&&(await Kn(Zt(Ie,"users",L)),p(Y=>Y.filter(D=>D.id!==L)))},H=L=>{const W=L==="admin"?"admin":L==="supervisor_pollo"?"supervisor_pollo":L==="vendedor_ropa"?"vendedor_ropa":L==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",Y=W==="admin"?"bg-blue-100 text-blue-700":W==="supervisor_pollo"?"bg-amber-100 text-amber-700":W==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":W==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Y}`,children:W})},K=L=>`${L.name}  ${L.branchLabel||"Sin sucursal"}  ${L.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>T(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(L=>{const W=y===L.id,Y=(W?w:L.roles).includes("vendedor_dulces");return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:L.name||""}),i.jsx("td",{className:"p-2 border",children:L.email}),i.jsx("td",{className:"p-2 border",children:W?i.jsxs("div",{className:"space-y-2 text-left",children:[["supervisor_pollo","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(D=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:w.includes(D),onChange:()=>j(Q=>Q.includes(D)?Q.filter(ee=>ee!==D):[...Q,D])}),i.jsx("span",{className:"text-sm",children:D})]},D)),w.includes("vendedor_dulces")&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs mt-1",value:I,onChange:D=>_(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),P.map(D=>i.jsx("option",{value:D.id,children:K(D)},D.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex gap-2 justify-center",children:L.roles.map(D=>i.jsx("span",{children:H(D)},D))}),Y&&L.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>ke(L),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>F(L.id),children:"Eliminar"})]})})]},L.id)})})]})}),d&&i.jsx("p",{className:"text-sm mt-2",children:d}),B&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>T(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:y?"Editar usuario":"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Re,type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:se,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:L=>e(L.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:L=>n(L.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:a,onChange:L=>s(L.target.value),required:!y}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(L=>!L),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Roles"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["supervisor_pollo","contador","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(L=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:y?w.includes(L):c.includes(L),onChange:()=>{y?j(W=>W.includes(L)?W.filter(Y=>Y!==L):[...W,L]):u(W=>W.includes(L)?W.filter(Y=>Y!==L):[...W,L])}}),i.jsx("span",{className:"text-sm",children:L})]},L))})]}),(y?w.includes("vendedor_dulces"):c.includes("vendedor_dulces"))&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:A,onChange:L=>h(L.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),P.map(L=>i.jsx("option",{value:L.id,children:K(L)},L.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Re,children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:y?"Guardar cambios":"Crear usuario"})]})]}),d&&i.jsx("p",{className:"text-sm mt-2",children:d})]})]})]})}const zV=t=>`C$${(Number(t)||0).toFixed(2)}`;function TPe(){const[t,e]=g.useState(""),[r,n]=g.useState(0),[a,s]=g.useState(0),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState([]),[m,p]=g.useState(!0),[x,v]=g.useState(!1),[y,b]=g.useState(null),[w,j]=g.useState(""),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,T]=g.useState(0),[P,O]=g.useState(0),[z,ce]=g.useState(!1),de=async()=>{p(!0);const K=await Ht(yt(Ie,"products")),L=[];K.forEach(W=>{const Y=W.data();L.push({id:W.id,name:Y.name??"",price:Number(Y.price??0),providerPrice:Number(Y.providerPrice??0),category:Y.category??"",measurement:Y.measurement??"",active:Y.active!==!1})}),h(L),p(!1)};g.useEffect(()=>{de()},[]);const ue=async K=>{if(K.preventDefault(),l(""),!t||r<=0||!d){l(" Completa nombre, precio vlido y unidad de medida");return}try{const L={name:t,price:parseFloat(r.toFixed(2)),providerPrice:parseFloat((a||0).toFixed(2)),category:c,measurement:d,active:!0},W=await Jn(yt(Ie,"products"),L);h(Y=>[{id:W.id,...L},...Y]),l(" Producto registrado con exito."),e(""),n(0),s(0),f(""),u(""),ce(!1)}catch(L){l(" Error: "+L.message)}},me=K=>{b(K.id),j(K.name),_(K.category),E(K.measurement),T(K.price),O(K.providerPrice||0)},se=()=>{b(null),j(""),_(""),E(""),T(0)},ke=async()=>{if(!y)return;const K=Zt(Ie,"products",y);await Fn(K,{name:w,category:I,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((P||0).toFixed(2))}),h(L=>L.map(W=>W.id===y?{...W,name:w,category:I,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((P||0).toFixed(2))}:W)),se()},Re=async K=>{const L=Zt(Ie,"products",K.id),W=K.active===!1;await Fn(L,{active:W}),h(Y=>Y.map(D=>D.id===K.id?{...D,active:W}:D))},F=async K=>{const L=sr(yt(Ie,"inventory_batches"),mr("productId","==",K),gS(1));if(!(await Ht(L)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await Kn(Zt(Ie,"products",K)),h(D=>D.filter(Q=>Q.id!==K)))},H=x?A:A.filter(K=>K.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{l(""),ce(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),z&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>ce(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ce(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:c,onChange:K=>u(K.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:K=>e(K.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:d,onChange:K=>f(K.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio proveedor (ej: 40.00)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(a)?"":a,onChange:K=>s(parseFloat(K.target.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:K=>n(parseFloat(K.target.value)),onFocus:K=>K.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),o&&i.jsx("p",{className:"text-sm mt-2",children:o})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:K=>v(K.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):H.map(K=>{const L=y===K.id,W=K.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{className:"w-full border p-1 rounded",value:w,onChange:Y=>j(Y.target.value)}):K.name}),i.jsx("td",{className:"p-2 border",children:L?i.jsxs("select",{className:"w-full border p-1 rounded",value:I,onChange:Y=>_(Y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):K.category}),i.jsx("td",{className:"p-2 border",children:L?i.jsxs("select",{className:"w-full border p-1 rounded",value:S,onChange:Y=>E(Y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):K.measurement}),i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(P)?"":P,onChange:Y=>O(parseFloat(Y.target.value))}):zV(K.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(B)?"":B,onChange:Y=>T(parseFloat(Y.target.value))}):zV(K.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${W?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:W?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:L?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ke,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:se,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>me(K),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${W?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>Re(K),children:W?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>F(K.id),children:"Eliminar"})]})})]},K.id)})})]})})]})}const ml=[];for(let t=0;t<256;++t)ml.push((t+256).toString(16).slice(1));function kPe(t,e=0){return(ml[t[e+0]]+ml[t[e+1]]+ml[t[e+2]]+ml[t[e+3]]+"-"+ml[t[e+4]]+ml[t[e+5]]+"-"+ml[t[e+6]]+ml[t[e+7]]+"-"+ml[t[e+8]]+ml[t[e+9]]+"-"+ml[t[e+10]]+ml[t[e+11]]+ml[t[e+12]]+ml[t[e+13]]+ml[t[e+14]]+ml[t[e+15]]).toLowerCase()}let x5;const FPe=new Uint8Array(16);function OPe(){if(!x5){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");x5=crypto.getRandomValues.bind(crypto)}return x5(FPe)}const DPe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),WV={randomUUID:DPe};function RPe(t,e,r){var a;if(WV.randomUUID&&!t)return WV.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??OPe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,kPe(n)}async function MPe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const a=yt(t,"inventory_batches"),s=sr(a,mr("productName","==",e)),c=(await Ht(s)).docs.map(u=>({id:u.id,data:u.data()})).sort((u,d)=>{var p,x;const f=u.data.date??"",A=d.data.date??"";if(f!==A)return f<A?-1:1;const h=((p=u.data.createdAt)==null?void 0:p.seconds)??0,m=((x=d.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(u=>Zt(t,"inventory_batches",u.id));return Gs(t,async u=>{let d=Number(r);const f=[],A=await Promise.all(c.map(x=>u.get(x)));for(let x=0;x<c.length&&d>0;x++){const v=c[x],y=A[x];if(!y.exists())continue;const b=y.data(),w=Number(b.quantity??0),j=Number(b.remaining??w??0),I=Number(b.purchasePrice??0);if(j<=0)continue;const _=Math.min(j,d),S=Number((j-_).toFixed(3));u.update(v,{remaining:S}),f.push({batchId:v.id,qty:_,unitCost:I,lineCost:Number((_*I).toFixed(2))}),d=Number((d-_).toFixed(3))}if(d>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${d} unidades.`);const h=Number(f.reduce((x,v)=>x+v.lineCost,0).toFixed(2)),m=f.reduce((x,v)=>x+v.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:f,avgUnitCost:p,cogsAmount:h}})}const $re=3,LPe=.5*10**-$re;function As(t){const e=Number(t??0);return Number(e.toFixed($re))}function v5(t,e){return As((t??0)+(e??0))}function MC(t,e){return As(t)+LPe>=As(e)}async function UPe(t,e){const r=await Ht(yt(Ie,"inventory_batches")),n=t.trim().toLowerCase();let a=0;for(const s of r.docs){const o=s.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await Fn(Zt(Ie,"inventory_batches",s.id),{productId:e}),a++)}return a}const h0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function XV({user:t,role:e,roles:r}){r&&r.length;const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState(""),[u,d]=g.useState(Mr(new Date,"yyyy-MM-dd")),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState(0),[b,w]=g.useState(0),[j,I]=g.useState("0"),[_,S]=g.useState(""),[E,B]=g.useState(!1),[T,P]=g.useState({}),O=Ge=>Math.round(Ge*100)/100,z=Ge=>As(Ge).toFixed(3),[ce,de]=g.useState("CONTADO"),[ue,me]=g.useState([]),[se,ke]=g.useState(""),[Re,F]=g.useState(0),H=Ge=>{de(Ge),Ge==="CREDITO"?(A(""),w(0),I("0.00")):(ke(""),F(0))},K=Ge=>{const ie=Number(Ge.specialPrice||0);return ie>0?ie:Number(Ge.price||0)},L=async Ge=>{if(!Ge)return 0;const ie=sr(yt(Ie,"inventory_batches"),mr("productId","==",Ge)),Ue=await Ht(ie);let Ne=0;return Ue.forEach(be=>{const Ce=be.data();Ne=v5(Ne,Number(Ce.remaining||0))}),As(Ne)},W=async Ge=>{if(!Ge)return 0;const ie=await Ht(yt(Ie,"inventory_batches"));let Ue=0;return ie.forEach(Ne=>{const be=Ne.data();(be.productName||"").trim().toLowerCase()===Ge.trim().toLowerCase()&&(Ue=v5(Ue,Number(be.remaining||0)))}),As(Ue)};g.useEffect(()=>{(async()=>{const Ge=await Ht(yt(Ie,"products")),ie=[];Ge.forEach(Ue=>{const Ne=Ue.data();(Ne==null?void 0:Ne.active)!==!1&&ie.push({id:Ue.id,productName:Ne.name??Ne.productName??"(sin nombre)",price:Number(Ne.price??0),measurement:Ne.measurement??"(sin unidad)",category:Ne.category??"(sin categora)"})}),a(ie)})()},[]),g.useEffect(()=>{(async()=>{const Ge=await Ht(yt(Ie,"inventory_batches")),ie={};Ge.forEach(Ue=>{const Ne=Ue.data(),be=Ne.productId,Ce=Number(Ne.remaining||0);be&&(ie[be]=v5(ie[be]||0,Ce))}),Object.keys(ie).forEach(Ue=>ie[Ue]=As(ie[Ue])),P(ie)})()},[]),g.useEffect(()=>{(async()=>{const Ge=await Ht(yt(Ie,"users")),ie=[];Ge.forEach(Ue=>{const Ne=Ue.data();ie.push({id:Ue.id,email:Ne.email??"(sin email)",role:Ne.role??"USER"})}),o(ie)})()},[]);const Y=async()=>{if(!l)return;const Ge=n.find(Ue=>Ue.id===l);if(!Ge)return;if(p.some(Ue=>Ue.productId===Ge.id)){c("");return}const ie=await L(Ge.id);x(Ue=>[...Ue,{productId:Ge.id,productName:Ge.productName,measurement:Ge.measurement,price:Number(Ge.price||0),specialPrice:0,stock:ie,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},D=async Ge=>{if(!Ge)return;const ie=n.find(Ne=>Ne.id===Ge);if(!ie||p.some(Ne=>Ne.productId===ie.id))return;const Ue=await L(ie.id);x(Ne=>[...Ne,{productId:ie.id,productName:ie.productName,measurement:ie.measurement,price:Number(ie.price||0),specialPrice:0,stock:Ue,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},Q=Ge=>{x(ie=>ie.filter(Ue=>Ue.productId!==Ge))},ee=Ge=>{const ie=String(Ge||"").replace(",",".");if(ie==="")return"";const Ue=ie.split(".");return Ue.length===1?ie:`${Ue[0]}.${Ue.slice(1).join("")}`},ve=async(Ge,ie)=>{x(Ue=>Ue.map(Ne=>{if(Ne.productId!==Ge)return Ne;const be=(Ne.measurement||"").toLowerCase()!=="lb",Ce=ee(ie);if(Ce.trim()==="")return{...Ne,qty:0,qtyInput:""};if(!be&&Ce===".")return{...Ne,qty:0,qtyInput:"0."};const Le=Number(Ce),Ae=Number.isFinite(Le)?Le:0;let We=be?Math.max(0,Math.round(Ae)):As(Ae);const ct=be?Math.max(0,Math.floor(Number(Ne.stock||0))):As(Number(Ne.stock||0));if(We>ct){We=ct,S(` Cantidad limitada a existencias (${ct})`);const pe=be?String(We):We===0?"":String(We);return{...Ne,qty:We,qtyInput:pe}}const _t=be?String(We):Ce.endsWith(".")?Ce:String(We);return{...Ne,qty:We,qtyInput:_t}}))},M=(Ge,ie)=>{x(Ue=>Ue.map(Ne=>{if(Ne.productId!==Ge)return Ne;const be=ee(ie);if(be.trim()==="")return{...Ne,specialPrice:0,specialPriceInput:""};if(be===".")return{...Ne,specialPrice:0,specialPriceInput:"0."};const Ce=Number(be),Le=Number.isFinite(Ce)?Math.max(0,O(Ce)):0,Ae=be.endsWith(".")?be:String(Le);return{...Ne,specialPrice:Le,specialPriceInput:Ae}}))},Ye=(Ge,ie)=>{x(Ue=>Ue.map(Ne=>{if(Ne.productId!==Ge)return Ne;const be=ee(ie);if(be.trim()==="")return{...Ne,discount:0,discountInput:""};if(be===".")return{...Ne,discount:0,discountInput:"0."};const Ce=Number(be),Le=Number.isFinite(Ce)?Math.max(0,Math.floor(Ce)):0,Ae=be.endsWith(".")?be:String(Le);return{...Ne,discount:Le,discountInput:Ae}}))},ae=g.useMemo(()=>{let Ge=0;for(const ie of p){const Ue=K(ie),Ne=Number(Ue||0)*Number(ie.qty||0),be=Math.max(0,Ne-Math.max(0,Number(ie.discount||0)));Ge+=be}return O(Ge)},[p]);g.useEffect(()=>{y(ae)},[ae]),g.useEffect(()=>{const Ge=Number(b)||0,ie=Number(v)||0;I((Ge-ie).toFixed(2))},[b,v]);const X=Ge=>{Ge.key===","&&(Ge.preventDefault(),Ge.target.value+=".")},[De,le]=g.useState(!1);g.useEffect(()=>{var Ue;const Ge=window.matchMedia("(max-width: 900px)"),ie=()=>le(Ge.matches);return ie(),(Ue=Ge.addEventListener)==null||Ue.call(Ge,"change",ie),()=>{var Ne;return(Ne=Ge.removeEventListener)==null?void 0:Ne.call(Ge,"change",ie)}},[]),g.useEffect(()=>{(async()=>{try{const Ge=await Ht(yt(Ie,"customers_pollo")),ie=[];Ge.forEach(Ue=>{const Ne=Ue.data();ie.push({id:Ue.id,name:Ne.name??"",phone:Ne.phone??"",status:Ne.status??"ACTIVO",creditLimit:Number(Ne.creditLimit??0),vendorId:Ne.vendorId??"",vendorName:Ne.vendorName??"",balance:0})});for(const Ue of ie)try{const Ne=sr(yt(Ie,"ar_movements_pollo"),mr("customerId","==",Ue.id)),be=await Ht(Ne);let Ce=0;be.forEach(Ae=>{Ce+=Number(Ae.data().amount||0)});const Le=Number(Ue.initialDebt||0);Ue.balance=Ce+Le}catch{Ue.balance=0}ie.sort((Ue,Ne)=>(Ue.name||"").localeCompare(Ne.name||"")),me(ie)}catch(Ge){console.error("Error cargando customers_pollo:",Ge),me([])}})()},[]);const $e=g.useMemo(()=>ue.find(Ge=>Ge.id===se)||null,[ue,se]),Xe=Number(($e==null?void 0:$e.balance)||0),it=ce==="CREDITO"?Math.max(0,Number(Xe||0)+Math.max(0,Number(v||0))):0;g.useEffect(()=>{ce==="CREDITO"&&F(Ge=>Math.min(Math.max(0,Number(Ge||0)),it))},[ce,it]),g.useEffect(()=>{ce==="CREDITO"&&(w(Number(Re||0)),I("0.00"))},[ce,Re]);const xt=ce==="CREDITO"?Xe+Math.max(0,Number(v||0))-Math.max(0,Number(Re||0)):0,jt=async()=>{if(p.length===0)return"Agrega al menos un producto.";for(const Ge of p){if(!Ge.qty||Ge.qty<=0)return`Cantidad invlida para "${Ge.productName}".`;const ie=await L(Ge.productId);if(!MC(ie,Ge.qty)){const Ue=await W(Ge.productName);if(MC(Ue,0)&&!MC(ie,0)){const Ne=await UPe(Ge.productName,Ge.productId),be=await L(Ge.productId);if(!MC(be,Ge.qty))return`Stock insuficiente tras corregir ${Ne} lote(s) para "${Ge.productName}".`}else return`Stock insuficiente para "${Ge.productName}". Disponible: ${ie}`}}return null},Mt=async Ge=>{var Ue,Ne;Ge.preventDefault(),S("");const ie=await jt();if(ie){S(" "+ie);return}try{B(!0);const be=[];if(ce==="CONTADO"){if(!f.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!se)return"Selecciona un cliente (crdito).";if(Re<0)return"El pago inicial no puede ser negativo.";if(Re>v)return"El pago inicial no puede superar el total.";if(($e==null?void 0:$e.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede fiar."}for(const pe of p){const Pe=pe.qty,{allocations:Ee,avgUnitCost:Ze,cogsAmount:xe}=await MPe(Ie,pe.productName,Pe,!1),Se=K(pe),gt=Number(Se||0)*Number(Pe||0),Et=Math.max(0,Number(pe.discount||0)),Nt=Math.max(0,gt-Et);be.push({productId:pe.productId,productName:pe.productName,measurement:pe.measurement,unitPrice:Number(Se||0),regularPrice:Number(pe.price||0),specialPrice:Number(pe.specialPrice||0)>0?Number(pe.specialPrice):null,qty:Pe,discount:Et,lineTotal:O(gt),lineFinal:O(Nt),allocations:Ee,avgUnitCost:Ze,cogsAmount:xe})}const Ce=be.reduce((pe,Pe)=>pe+Pe.lineFinal,0),Le=be.reduce((pe,Pe)=>pe+Number(Pe.qty||0),0),Ae=Number(ce==="CREDITO"?Re||0:b||0),We=ce==="CREDITO"?"0.00":j,ct={id:RPe(),quantity:Le,amount:Ce,amountCharged:Ce,timestamp:vr.now(),date:u,userEmail:(t==null?void 0:t.email)??((Ue=s[0])==null?void 0:Ue.email)??"sin usuario",vendor:e??((Ne=s[0])==null?void 0:Ne.role)??"sin usuario",status:"FLOTANTE",items:be,itemsTotal:Ce,type:ce,amountReceived:Ae,change:We,customerId:ce==="CREDITO"?se:"",customerName:ce==="CREDITO"?($e==null?void 0:$e.name)||"":f.trim(),clientName:ce==="CONTADO"?f.trim():""};if(ce==="CONTADO"){if(!f.trim()){S(" Ingresa el nombre del cliente (contado).");return}}else{if(!se){S(" Selecciona un cliente (crdito).");return}if(Re<0){S(" El pago inicial no puede ser negativo.");return}if(Re>v){S(" El pago inicial no puede superar el total.");return}if(($e==null?void 0:$e.status)==="BLOQUEADO"){S(" El cliente est BLOQUEADO. No se puede fiar.");return}const pe=Number(($e==null?void 0:$e.creditLimit)||0);if(pe>0&&xt>pe){S(` Supera el lmite de crdito (C$ ${pe.toFixed(2)}).`);return}}const _t=await Jn(yt(Ie,"salesV2"),ct);if(ce==="CREDITO"&&se){const pe={customerId:se,date:u,createdAt:vr.now(),ref:{saleId:_t.id}};await Jn(yt(Ie,"ar_movements_pollo"),{...pe,type:"CARGO",amount:Number(Ce)||0}),Number(Re)>0&&await Jn(yt(Ie,"ar_movements_pollo"),{...pe,type:"ABONO",amount:-Number(Re)}),me(Pe=>Pe.map(Ee=>Ee.id===se?{...Ee,balance:Number(Ee.balance||0)+Number(Ce||0)-Number(Re||0)}:Ee))}S(" Venta registrada y asignada a inventario (FIFO)."),x([]),c(""),y(0),w(0),I("0"),A(""),d(Mr(new Date,"yyyy-MM-dd")),ke(""),F(0),de("CONTADO")}catch(be){console.error(be),S(` ${(be==null?void 0:be.message)||"Error al registrar la venta."}`)}finally{B(!1)}},Ft=g.useMemo(()=>new Set(p.map(Ge=>Ge.productId)),[p]),$t=g.useMemo(()=>n.filter(Ge=>(T[Ge.id]||0)>0),[n,T]),kt=g.useMemo(()=>{const Ge=String(h||"").trim().toLowerCase();return Ge?$t.filter(ie=>`${ie.productName||""}`.toLowerCase().includes(Ge)):$t},[$t,h]);return De?i.jsx("div",{className:"w-full max-w-lg mx-auto p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"font-bold text-lg text-blue-700",children:"Registrar venta (Pollo)"}),i.jsx("input",{type:"date",className:"text-sm text-gray-700 border rounded px-2 py-1",value:u,onChange:Ge=>d(Ge.target.value),"aria-label":"Fecha de la venta"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ce,onChange:Ge=>H(Ge.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),ce==="CONTADO"?i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:f,onChange:Ge=>A(Ge.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:se,onChange:Ge=>ke(Ge.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ue.map(Ge=>i.jsxs("option",{value:Ge.status==="ACTIVO"?Ge.id:"",disabled:Ge.status==="BLOQUEADO",children:[Ge.name,"  Saldo: ",h0(Ge.balance||0)]},Ge.id))]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:h0(Xe)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:h0(xt)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold",children:"Pago inicial"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",type:"number",step:"0.01",inputMode:"decimal",max:it,value:Re===0?"":Re,onChange:Ge=>{const ie=Math.max(0,Number(Ge.target.value||0)),Ue=Math.min(ie,it);F(Ue)},placeholder:"0.00"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",h0(it)]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 mb-2",placeholder:"Buscar producto por nombre...",value:h,onChange:Ge=>m(Ge.target.value)}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{className:"flex-1 border rounded px-1 py-2 text-sm",value:l,onChange:async Ge=>{const ie=Ge.target.value;c(ie),await D(ie)},children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),kt.map(Ge=>i.jsxs("option",{value:Ge.id,disabled:Ft.has(Ge.id),children:[Ge.productName," | C$ ",Ge.price," | Disp:"," ",z(T[Ge.id]||0)]},Ge.id))]})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Items"}),p.length===0?i.jsx("div",{className:"text-gray-500",children:"Agrega productos al carrito."}):i.jsx("div",{className:"space-y-2",children:p.map(Ge=>{const ie=K(Ge),Ue=Number(ie||0)*Number(Ge.qty||0),Ne=Math.max(0,Ue-Math.max(0,Number(Ge.discount||0))),be=(Ge.measurement||"").toLowerCase()!=="lb";return i.jsxs("div",{className:"border rounded p-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"font-semibold",children:Ge.productName}),i.jsxs("div",{className:"text-sm",children:["C$ ",O(ie).toFixed(2)]})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 items-center",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:be?"numeric":"decimal",step:be?1:.01,value:Ge.qtyInput??(Ge.qty===0?"":Ge.qty),onKeyDown:X,onChange:Ce=>ve(Ge.productId,Ce.target.value),placeholder:be?"Unid":"Libras",title:be?"Unidades":"Libras"}),i.jsx("input",{className:"border rounded px-1 py-1 text-right",inputMode:"numeric",value:Ge.discountInput??(Ge.discount===0?"":Ge.discount),onChange:Ce=>Ye(Ge.productId,Ce.target.value),placeholder:"Descuento",title:"Descuento (C$)"}),i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:"decimal",value:Ge.specialPriceInput??(Ge.specialPrice===0?"":Ge.specialPrice),onChange:Ce=>M(Ge.productId,Ce.target.value),placeholder:"Sugerido",title:"Precio sugerido (opcional)"})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Exist:"," ",As(Number(Ge.stock)-Number(Ge.qty||0)).toFixed(3)]}),i.jsxs("div",{className:"font-semibold",children:["C$ ",O(Ne).toFixed(2)]})]}),i.jsx("div",{className:"mt-2 text-right",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600",onClick:()=>Q(Ge.productId),children:"Quitar"})})]},Ge.productId)})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Monto total"}),i.jsxs("div",{className:"text-xl font-bold",children:["C$ ",v.toFixed(2)]})]}),ce==="CONTADO"&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-2",inputMode:"decimal",value:b===0?"":b,onChange:Ge=>w(Number(Ge.target.value||0)),placeholder:"Monto recibido"}),i.jsxs("div",{className:"border rounded px-2 py-2 bg-gray-100",children:["Cambio: C$ ",j]})]}),i.jsx("button",{onClick:Mt,disabled:p.length===0||E,className:"w-full bg-blue-600 text-white px-4 py-2 rounded",children:E?"Guardando...":"Guardar venta"}),_&&i.jsx("div",{className:`text-sm ${_.startsWith("")?"text-green-600":_.startsWith("")?"text-yellow-600":"text-red-600"}`,children:_})]})}):i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:Mt,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl
                 p-4 sm:p-6 md:p-8
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:Ge=>c(Ge.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),$t.map(Ge=>i.jsxs("option",{value:Ge.id,disabled:Ft.has(Ge.id),title:Ft.has(Ge.id)?"Ya est en la lista":`Disponible: ${z(T[Ge.id]||0)}`,children:[Ge.productName,"  ",Ge.measurement,"  C$ ",Ge.price," (disp:"," ",z(T[Ge.id]||0),")"]},Ge.id))]}),i.jsx("button",{type:"button",onClick:Y,disabled:!l||Ft.has(l),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:u,onChange:Ge=>d(Ge.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:ce,onChange:Ge=>H(Ge.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),ce==="CONTADO"?i.jsxs("div",{className:"md:col-span-2 space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:f,onChange:Ge=>A(Ge.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"md:col-span-2 space-y-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:se,onChange:Ge=>ke(Ge.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ue.map(Ge=>i.jsxs("option",{value:Ge.status==="ACTIVO"?Ge.id:"",disabled:Ge.status==="BLOQUEADO",children:[Ge.name,"  Saldo: ",h0(Ge.balance||0)]},Ge.id))]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:h0(Xe)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Pago inicial"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",h0(it)]}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:it,className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:Re===0?"":Re,onChange:Ge=>{const ie=Math.max(0,Number(Ge.target.value||0)),Ue=Math.min(ie,it);F(Ue)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:h0(xt)})]})]})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):p.map(Ge=>{const ie=K(Ge),Ue=Number(ie||0)*Number(Ge.qty||0),Ne=Math.max(0,Ue-Math.max(0,Number(Ge.discount||0))),be=(Ge.measurement||"").toLowerCase()!=="lb",Ce=As(Number(Ge.stock)-Number(Ge.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Ge.productName,"  ",Ge.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",O(Ge.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ge.specialPrice===0?"":Ge.specialPrice,onKeyDown:X,onChange:Le=>M(Ge.productId,Le.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",O(ie).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ce.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:be?1:.01,inputMode:be?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:Ge.qtyInput??(Ge.qty===0?"":Ge.qty),onKeyDown:X,onChange:Le=>ve(Ge.productId,Le.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:Ge.discount===0?"":Ge.discount,onChange:Le=>Ye(Ge.productId,Le.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",O(Ne).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>Q(Ge.productId),title:"Quitar",children:""})})]},Ge.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${v.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),ce==="CONTADO"&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:b===0?"":b,onChange:Ge=>w(Number(Ge.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${j}`,readOnly:!0})]})]})}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:p.length===0||E,children:E?"Guardando...":"Guardar venta"}),_&&i.jsx("p",{className:`text-sm mt-2 ${_.startsWith("")?"text-green-600":_.startsWith("")?"text-yellow-600":"text-red-600"}`,children:_})]}),E&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}function Gre(t,e,r,n,a){n=n||{};var s=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():s,u=l*c,d=/\r\n|\r|\n/g,f="",A=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof t=="string"?t.split(d):t,A=f.length||1),r+=l*(2-s),n.valign==="middle"?r-=A/2*u:n.valign==="bottom"&&(r-=A*u),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&A>=1){for(var m=0;m<f.length;m++)a.text(f[m],e-a.getStringUnitWidth(f[m])*h,r),r+=u;return a}e-=a.getStringUnitWidth(t)*h}return n.halign==="justify"?a.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(t,e,r),a}var YV={},Av=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:YV=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,a,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=t.unifyColor(e.textColor),d&&(a=this.jsPDFDocument).setTextColor.apply(a,d),d=t.unifyColor(e.lineColor),d&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,a,s){return this.jsPDFDocument.rect(e,r,n,a,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return YV||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Gk=function(t,e){return Gk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Gk(t,e)};function Kre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Gk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var qre=function(t){Kre(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function QPe(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function VPe(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function DS(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return a}function zre(t,e,r,n){var a=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:a,lineColor:s});var o=Wre(a,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,o)}function Wre(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function sP(t,e){var r,n,a,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(a=t.right)!==null&&a!==void 0?a:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function Xre(t,e){var r=sP(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function HPe(t,e,r,n,a){var s={},o=1.3333333333333333,l=y5(e,function(b){return a.getComputedStyle(b).backgroundColor});l!=null&&(s.fillColor=l);var c=y5(e,function(b){return a.getComputedStyle(b).color});c!=null&&(s.textColor=c);var u=GPe(n,r);u&&(s.cellPadding=u);var d="borderTopColor",f=o*r,A=n.borderTopWidth;if(n.borderBottomWidth===A&&n.borderRightWidth===A&&n.borderLeftWidth===A){var h=(parseFloat(A)||0)/f;h&&(s.lineWidth=h)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=y5(e,function(b){return a.getComputedStyle(b)[d]});m!=null&&(s.lineColor=m);var p=["left","right","center","justify"];p.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),p=["middle","bottom","top"],p.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(s.fontSize=x/o);var v=$Pe(n);v&&(s.fontStyle=v);var y=(n.fontFamily||"").toLowerCase();return t.indexOf(y)!==-1&&(s.font=y),s}function $Pe(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function y5(t,e){var r=Yre(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function Yre(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:Yre(t.parentElement,e):r}function GPe(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),a=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(l){return parseInt(l||"0")/n}),o=sP(s,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function Jre(t,e,r,n,a){var s,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),d=[],f=[],A=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:d,body:f,foot:A};for(var h=0;h<l.rows.length;h++){var m=l.rows[h],p=(o=(s=m==null?void 0:m.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),x=KPe(c,u,r,m,n,a);x&&(p==="thead"?d.push(x):p==="tfoot"?A.push(x):f.push(x))}return{head:d,body:f,foot:A}}function KPe(t,e,r,n,a,s){for(var o=new qre(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(a||u.display!=="none"){var d=void 0;s&&(d=HPe(t,c,e,u,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:qPe(c)})}}var f=r.getComputedStyle(n);if(o.length>0&&(a||f.display!=="none"))return o}function qPe(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function zPe(t,e,r){for(var n=0,a=[t,e,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Xh(t,e,r,n,a){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function Zre(t,e){var r=new Av(t),n=r.getDocumentOptions(),a=r.getGlobalOptions();zPe(a,n,e);var s=Xh({},a,n,e),o;typeof window<"u"&&(o=window);var l=WPe(a,n,e),c=XPe(a,n,e),u=YPe(r,s),d=ZPe(r,s,o);return{id:e.tableId,content:d,hooks:c,styles:l,settings:u}}function WPe(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=t[c],d=e[c],f=r[c];n.columnStyles=Xh({},u,d,f)}else{var A=[t,e,r],h=A.map(function(m){return m[c]||{}});n[c]=Xh({},h[0],h[1],h[2])}},s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];a(l)}return n}function XPe(t,e,r){for(var n=[t,e,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=n;s<o.length;s++){var l=o[s];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function YPe(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m=sP(e.margin,40/t.scaleFactor()),p=(r=JPe(t,e.startY))!==null&&r!==void 0?r:m.top,x;e.showFoot===!0?x="everyPage":e.showFoot===!1?x="never":x=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(a=e.showHead)!==null&&a!==void 0?a:"everyPage";var y=(s=e.useCss)!==null&&s!==void 0?s:!1,b=e.theme||(y?"plain":"striped"),w=!!e.horizontalPageBreak,j=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:y,theme:b,startY:p,margin:m,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:v,showFoot:x,tableLineWidth:(f=e.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(A=e.tableLineColor)!==null&&A!==void 0?A:200,horizontalPageBreak:w,horizontalPageBreakRepeat:j,horizontalPageBreakBehaviour:(h=e.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function JPe(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),a=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===a}return typeof e=="number"?e:(e==null||e===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function ZPe(t,e,r){var n=e.head||[],a=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=Jre(t,e.html,r,o,e.useCss)||{};n=l.head||n,a=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||e3e(n,a,s);return{columns:c,head:n,body:a,foot:s}}function e3e(t,e,r){var n=t[0]||e[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var u=void 0;Array.isArray(n)?u=a.length:u=s+(c>0?"_".concat(c):"");var d={dataKey:u};a.push(d)}}),a}var Kk=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),t3e=function(t){Kre(e,t);function e(r,n,a,s,o,l){var c=t.call(this,r,n,l)||this;return c.cell=a,c.row=s,c.column=o,c.section=s.section,c}return e}(Kk),r3e=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,a,s,o){for(var l=0,c=r;l<c.length;l++){var u=c[l],d=new t3e(e,this,n,a,s,o),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new Kk(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new Kk(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),ene=function(){function t(e,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof qre&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(a,s){var o=n.cells[s.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),u=c+l;return u>a?u:a},0)},t}(),tne=function(){function t(e,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(a=e.content)!==null&&a!==void 0?a:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/e*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=sP(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),n3e=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,a=e.allRows();n<a.length;n++){var s=a[n],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function a3e(t,e){s3e(t,e);var r=[],n=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=e.getWidth(t.pageSize().width)-n;a&&(a=qk(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=qk(r,a,function(s){return s.minWidth})),a=Math.abs(a),!e.settings.horizontalPageBreak&&a>.1/t.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),o3e(e),l3e(e,t),i3e(e)}function s3e(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,a=Xre(t,e);e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(t,d,u,s,c,null);var f=u.padding("horizontal");u.contentWidth=DS(u.text,u.styles,t)+f;var A=DS(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=A+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function qk(t,e,r){for(var n=e,a=t.reduce(function(h,m){return h+m.wrappedWidth},0),s=0;s<t.length;s++){var o=t[s],l=o.wrappedWidth/a,c=n*l,u=o.width+c,d=r(o),f=u<d?d:u;e-=f-o.width,o.width=f}if(e=Math.round(e*1e10)/1e10,e){var A=t.filter(function(h){return e<0?h.width>r(h):!0});A.length&&(e=qk(A,e,r))}return e}function i3e(t){for(var e={},r=1,n=t.allRows(),a=0;a<n.length;a++)for(var s=n[a],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=e[c.index];if(r>1)r--,delete s.cells[c.index];else if(u)u.cell.height+=s.height,r=u.cell.colSpan,delete s.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=s.cells[c.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var f=n.length-a,A=d.rowSpan>f?f:d.rowSpan;e[c.index]={cell:d,left:A,row:s}}}}}function o3e(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],a=null,s=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])s+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+s}else{var u=n.cells[c.index];if(!u)continue;if(o=u.colSpan,s=0,u.colSpan>1){a=u,s+=c.width;continue}u.width=c.width+s}}}function l3e(t,e){for(var r={count:0,height:0},n=0,a=t.allRows();n<a.length;n++){for(var s=a[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=JV(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=JV(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var A=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<A*u.rowSpan?r={height:A,count:u.rowSpan}:r&&r.count>0&&r.height>A&&(A=r.height),A>s.height&&(s.height=A)}}r.count--}}function JV(t,e,r,n,a){return t.map(function(s){return c3e(s,e,r,n,a)})}function c3e(t,e,r,n,a){var s=1e4*n.scaleFactor();if(e=Math.ceil(e*s)/s,e>=DS(t,r,n))return t;for(;e<DS(t+a,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+a}function rne(t,e){var r=new Av(t),n=u3e(e,r.scaleFactor()),a=new r3e(e,n);return a3e(r,a),r.applyStyles(r.userStyles),a}function u3e(t,e){var r=t.content,n=f3e(r.columns);if(r.head.length===0){var a=ZV(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=ZV(n,"foot");a&&r.foot.push(a)}var s=t.settings.theme,o=t.styles;return{columns:n,head:b5("head",r.head,n,o,s,e),body:b5("body",r.body,n,o,s,e),foot:b5("foot",r.foot,n,o,s,e)}}function b5(t,e,r,n,a,s){var o={},l=e.map(function(c,u){for(var d=0,f={},A=0,h=0,m=0,p=r;m<p.length;m++){var x=p[m];if(o[x.index]==null||o[x.index].left===0)if(h===0){var v=void 0;Array.isArray(c)?v=c[x.index-A-d]:v=c[x.dataKey];var y={};typeof v=="object"&&!Array.isArray(v)&&(y=(v==null?void 0:v.styles)||{});var b=h3e(t,x,u,a,n,s,y),w=new tne(v,b,t);f[x.dataKey]=w,f[x.index]=w,h=w.colSpan-1,o[x.index]={left:w.rowSpan-1,times:h}}else h--,A++;else o[x.index].left--,h=o[x.index].times,d++}return new ene(c,u,t,f)});return l}function ZV(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var a=d3e(e,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function d3e(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function f3e(t){return t.map(function(e,r){var n,a;return typeof e=="object"?a=(n=e.dataKey)!==null&&n!==void 0?n:r:a=r,new n3e(a,e,r)})}function h3e(t,e,r,n,a,s,o){var l=VPe(n),c;t==="head"?c=a.headStyles:t==="body"?c=a.bodyStyles:t==="foot"&&(c=a.footStyles);var u=Xh({},l.table,l[t],a.styles,c),d=a.columnStyles[e.dataKey]||a.columnStyles[e.index]||{},f=t==="body"?d:{},A=t==="body"&&r%2===0?Xh({},l.alternateRow,a.alternateRowStyles):{},h=QPe(s),m=Xh({},h,u,A,f);return Xh(m,o)}function A3e(t,e,r){var n;r===void 0&&(r={});var a=Xre(t,e),s=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(A){var h=e.columns.find(function(m){return m.dataKey===A||m.index===A});h&&!s.has(h.index)&&(s.set(h.index,!0),o.push(h.index),l.push(e.columns[h.index]),a-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<e.columns.length;){if(s.has(d)){d++;continue}var f=e.columns[d].wrappedWidth;if(u||a>=f)u=!1,o.push(d),l.push(e.columns[d]),a-=f;else break;d++}return{colIndexes:o,columns:l,lastIndex:d-1}}function m3e(t,e){for(var r=[],n=0;n<e.columns.length;n++){var a=A3e(t,e,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function nne(t,e){var r=e.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(A,h){return A+h.height},0);l+=u}var d=new Av(t);(r.pageBreak==="always"||r.startY!=null&&l>d.pageSize().height)&&(sne(d),s.y=a.top),e.callWillDrawPageHooks(d,s);var f=Xh({},s);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?p3e(d,e,f,s):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(A){return yA(d,e,A,s,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(A,h){var m=h===e.body.length-1;RS(d,e,A,m,f,s,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(A){return yA(d,e,A,s,e.columns)})),zre(d,e,f,s),e.callEndPageHooks(d,s),e.finalY=s.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function p3e(t,e,r,n){var a=m3e(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,d){t.applyStyles(t.userStyles),d>0?Pb(t,e,r,n,u.columns,!0):eH(t,e,n,u.columns),g3e(t,e,r,n,u.columns),w5(t,e,n,u.columns)});else for(var o=-1,l=a[0],c=function(){var u=o;if(l){t.applyStyles(t.userStyles);var d=l.columns;o>=0?Pb(t,e,r,n,d,!0):eH(t,e,n,d),u=tH(t,e,o+1,n,d),w5(t,e,n,d)}var f=u-o;a.slice(1).forEach(function(A){t.applyStyles(t.userStyles),Pb(t,e,r,n,A.columns,!0),tH(t,e,o+1,n,A.columns,f),w5(t,e,n,A.columns)}),o=u};o<e.body.length-1;)c()}function eH(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(s){return yA(t,e,s,r,n)})}function g3e(t,e,r,n,a){t.applyStyles(t.userStyles),e.body.forEach(function(s,o){var l=o===e.body.length-1;RS(t,e,s,l,r,n,a)})}function tH(t,e,r,n,a,s){t.applyStyles(t.userStyles),s=s??e.body.length;var o=Math.min(r+s,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,u){var d=r+u===e.body.length-1,f=ane(t,e,d,n);c.canEntireRowFit(f,a)&&(yA(t,e,c,n,a),l=r+u)}),l}function w5(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(s){return yA(t,e,s,r,n)})}function x3e(t,e,r){var n=r.getLineHeight(t.styles.fontSize),a=t.padding("vertical"),s=Math.floor((e-a)/n);return Math.max(0,s)}function v3e(t,e,r,n){var a={};t.spansMultiplePages=!0,t.height=0;for(var s=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new tne(u.raw,u.styles,u.section);d=Xh(d,u),d.text=[];var f=x3e(u,e,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var A=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(A,h),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),d.contentHeight=d.getContentHeight(A,h),d.contentHeight>s&&(s=d.contentHeight),a[c.index]=d}}var m=new ene(t.raw,-1,t.section,a,!0);m.height=s;for(var p=0,x=r.columns;p<x.length;p++){var c=x[p],d=m.cells[c.index];d&&(d.height=m.height);var u=t.cells[c.index];u&&(u.height=t.height)}return m}function y3e(t,e,r,n){var a=t.pageSize().height,s=n.settings.margin,o=s.top+s.bottom,l=a-o;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(n.columns),f=e.getMaxCellHeight(n.columns)>l;return f?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function RS(t,e,r,n,a,s,o){var l=ane(t,e,n,s);if(r.canEntireRowFit(l,o))yA(t,e,r,s,o);else if(y3e(t,r,l,e)){var c=v3e(r,l,e,t);yA(t,e,r,s,o),Pb(t,e,a,s,o),RS(t,e,c,n,a,s,o)}else Pb(t,e,a,s,o),RS(t,e,r,n,a,s,o)}function yA(t,e,r,n,a){n.x=e.settings.margin.left;for(var s=0,o=a;s<o.length;s++){var l=o[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}b3e(t,c,n);var d=c.getTextPos();Gre(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function b3e(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=Wre(n.lineWidth,n.fillColor);a&&t.rect(e.x,r.y,e.width,e.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),w3e(t,e,r,n.lineWidth))}function w3e(t,e,r,n){var a,s,o,l;n.top&&(a=r.x,s=r.y,o=r.x+e.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,o,l)),n.bottom&&(a=r.x,s=r.y+e.height,o=r.x+e.width,l=r.y+e.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,o,l)),n.left&&(a=r.x,s=r.y,o=r.x,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,s,o,l)),n.right&&(a=r.x+e.width,s=r.y,o=r.x+e.width,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,s,o,l));function c(u,d,f,A,h){t.getDocument().setLineWidth(u),t.getDocument().line(d,f,A,h,"S")}}function ane(t,e,r,n){var a=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-a}function Pb(t,e,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(l){return yA(t,e,l,n,a)}),e.callEndPageHooks(t,n);var o=e.settings.margin;zre(t,e,r,n),sne(t),e.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return yA(t,e,l,n,a)}),t.applyStyles(t.userStyles))}function sne(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function N3e(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],a=Zre(this,n),s=rne(this,a);return nne(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,a){Gre(e,r,n,a,this)},t.API.autoTableSetDefaults=function(e){return Av.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){Av.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Av(this),s=Jre(a,e,window,r,!1),o=s.head,l=s.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var N5;function U0(t,e){var r=Zre(t,e),n=rne(t,r);nne(t,n)}try{if(typeof window<"u"&&window){var rH=window,nH=rH.jsPDF||((N5=rH.jspdf)===null||N5===void 0?void 0:N5.jsPDF);nH&&N3e(nH)}}catch(t){console.error("Could not apply autoTable plugin",t)}const Ga=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function C5(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function C3e({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const[a,s]=g.useState([]),[o,l]=g.useState([]),[c,u]=g.useState(!0),[d,f]=g.useState(""),{refreshKey:A,refresh:h}=Dc(),m=e&&e.length?e:t,p=En(m,"admin"),x=p||En(m,"contador"),[v,y]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[b,w]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[j,I]=g.useState(""),[_,S]=g.useState(!1),[E,B]=g.useState(""),[T,P]=g.useState(Mr(new Date,"yyyy-MM-dd")),[O,z]=g.useState("lb"),[ce,de]=g.useState(""),[ue,me]=g.useState(0),[se,ke]=g.useState(NaN),[Re,F]=g.useState(0),[H,K]=g.useState([]),[L,W]=g.useState(null),[Y,D]=g.useState([]),[Q,ee]=g.useState(!1),[ve,M]=g.useState(null),[Ye,ae]=g.useState(!1),[X,De]=g.useState(null),[le,$e]=g.useState(null),Xe=_e=>$e(U=>U===_e?null:_e),[it,xt]=g.useState(!1),jt=()=>xt(_e=>!_e),[Mt,Ft]=g.useState("all"),[$t,kt]=g.useState({}),Ge=_e=>kt(U=>({...U,[_e]:!(U[_e]??!1)})),ie=(_e,U)=>{const ye=[];return _e>0&&ye.push(`${_e.toFixed(3)} lb`),U>0&&ye.push(`${U.toFixed(3)} un`),ye.length===0?"0":ye.join("  ")},Ue=_e=>{const U=(_e||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(U)||U==="lb"};g.useEffect(()=>{(async()=>{u(!0),f("");const _e=await Ht(yt(Ie,"products")),U=[];_e.forEach(qe=>{const G=qe.data();G.active===!0&&U.push({id:qe.id,name:G.name??G.productName??"(sin nombre)",category:G.category??"(sin categora)",measurement:G.measurement??"lb",price:Number(G.price??0),providerPrice:Object.prototype.hasOwnProperty.call(G,"providerPrice")?Number(G.providerPrice):void 0})}),s(U);const ye=sr(yt(Ie,"inventory_batches"),In("date","desc")),te=await Ht(ye),Ve=[];te.forEach(qe=>{const G=qe.data(),V=As(Number(G.quantity||0)),Z=Number(G.purchasePrice||0),re=Number(G.salePrice||0),we=Number((V*Z).toFixed(2)),Fe=Number((V*re).toFixed(2));Ve.push({id:qe.id,productId:G.productId,productName:G.productName,category:G.category,unit:G.unit,quantity:V,remaining:As(Number(G.remaining||0)),purchasePrice:Z,salePrice:re,invoiceTotal:G.invoiceTotal!=null?Number(G.invoiceTotal):we,expectedTotal:G.expectedTotal!=null?Number(G.expectedTotal):Fe,date:G.date,createdAt:G.createdAt,status:G.status,notes:G.notes,paidAmount:Number(G.paidAmount||0),paidAt:G.paidAt,batchGroupId:G.batchGroupId,orderName:G.orderName})}),l(Ve),u(!1)})()},[A]);const Ne=g.useMemo(()=>o.filter(_e=>!(v&&_e.date<v||b&&_e.date>b||j&&_e.productId!==j)),[o,v,b,j]),be=g.useMemo(()=>{if(!j)return"Todos";const _e=a.find(U=>U.id===j);return _e?`${_e.name}  ${_e.category}`:"Filtro activo"},[j,a]),Ce=g.useMemo(()=>{const _e=Ne.reduce((Z,re)=>Z+Number(re.invoiceTotal||0),0),U=Ne.reduce((Z,re)=>Z+Number(re.expectedTotal||0),0);let ye=0,te=0,Ve=0,qe=0;for(const Z of Ne)Ue(Z.unit)?(ye+=Z.quantity,te+=Z.remaining):(Ve+=Z.quantity,qe+=Z.remaining);const G=Ne.reduce((Z,re)=>Z+re.quantity,0),V=Ne.reduce((Z,re)=>Z+re.remaining,0);return{lbsIng:ye,lbsRem:te,udsIng:Ve,udsRem:qe,qty:G,rem:V,totalFacturado:_e,totalEsperado:U}},[Ne]),Le=g.useMemo(()=>{var ye,te;const _e=new Map;for(const Ve of Ne){const qe=Ve.batchGroupId&&String(Ve.batchGroupId).trim()||Ve.id;_e.has(qe)||_e.set(qe,[]),_e.get(qe).push(Ve)}const U=[];for(const[Ve,qe]of _e.entries()){const G=[...qe].sort((ze,nt)=>{var pt,Dt;const ne=((pt=ze.createdAt)==null?void 0:pt.seconds)??0;return(((Dt=nt.createdAt)==null?void 0:Dt.seconds)??0)-ne}),V=((ye=G[0])==null?void 0:ye.date)||"",Z=String(((te=G[0])==null?void 0:te.orderName)||"").trim()||`Pedido ${V||""}`.trim()||"Pedido",re=new Set(G.map(ze=>String(ze.category||"").trim()).filter(Boolean)),we=re.size===1?Array.from(re)[0].toUpperCase():"MIXTO",Fe=G.some(ze=>ze.status==="PENDIENTE")?"PENDIENTE":"PAGADO",st=As(G.reduce((ze,nt)=>ze+(Ue(nt.unit)?Number(nt.quantity||0):0),0)),Be=As(G.reduce((ze,nt)=>ze+(Ue(nt.unit)?Number(nt.remaining||0):0),0)),at=As(G.reduce((ze,nt)=>ze+(Ue(nt.unit)?0:Number(nt.quantity||0)),0)),lt=As(G.reduce((ze,nt)=>ze+(Ue(nt.unit)?0:Number(nt.remaining||0)),0)),dt=Number(G.reduce((ze,nt)=>ze+Number(nt.invoiceTotal||0),0).toFixed(2)),Pt=Number(G.reduce((ze,nt)=>ze+Number(nt.expectedTotal||0),0).toFixed(2)),he=Number((Pt-dt).toFixed(2));U.push({groupId:Ve,orderName:Z,date:V,typeLabel:we,status:Fe,lbsIn:st,lbsRem:Be,udsIn:at,udsRem:lt,totalFacturado:dt,totalEsperado:Pt,utilidadBruta:he,items:G})}return U.sort((Ve,qe)=>Ve.date===qe.date?Ve.groupId<qe.groupId?1:-1:Ve.date<qe.date?1:-1),U},[Ne]),Ae=g.useMemo(()=>Mt==="all"?Le:Le.filter(_e=>{const U=_e.lbsRem>0||_e.udsRem>0;return Mt==="with"?U:!U}),[Le,Mt]),We=g.useMemo(()=>{const _e=new Map;return Ae.forEach(U=>{const ye=U.typeLabel||"MIXTO";_e.has(ye)||_e.set(ye,[]),_e.get(ye).push(U)}),Array.from(_e.entries()).map(([U,ye])=>({type:U,items:ye}))},[Ae]),ct=g.useMemo(()=>{const _e=String(O||"").toLowerCase().trim();return a.filter(ye=>String(ye.measurement||"").toLowerCase().trim()===_e).sort((ye,te)=>ye.name.localeCompare(te.name,"es"))},[a,O]);g.useEffect(()=>{const _e=H.find(ye=>ye.productId===ce);if(_e){me(Number(_e.quantity||0)),ke(Number(_e.purchasePrice||0)),F(Number(_e.salePrice||0));return}const U=a.find(ye=>ye.id===ce);U?(me(0),F(Number(U.price||0)),U.providerPrice!=null&&Number.isFinite(Number(U.providerPrice))?ke(Number(U.providerPrice)):ke(NaN)):(me(0),F(0),ke(NaN))},[ce,a,A,H]);const _t=()=>{f("");const _e=a.find(V=>V.id===ce);if(!_e)return f("Selecciona un producto.");if(ue<=0||!Number.isFinite(se)||se<=0)return f("Completa libras a ingresar y precio proveedor.");const U=As(ue),ye=_e.measurement,te=Number((U*Number(se||0)).toFixed(2)),Ve=Number((U*Number(Re||0)).toFixed(2)),qe=Number((Ve-te).toFixed(2)),G=H.findIndex(V=>V.productId===_e.id);G>=0?K(V=>V.map((Z,re)=>re!==G?Z:{...Z,quantity:U,remaining:U,purchasePrice:Number(se||0),salePrice:Number(Re||0),invoiceTotal:te,expectedTotal:Ve,utilidadBruta:qe})):K(V=>[...V,{tempId:C5("IT"),productId:_e.id,productName:_e.name,category:_e.category,unit:ye,quantity:U,remaining:U,purchasePrice:Number(se||0),salePrice:Number(Re||0),invoiceTotal:te,expectedTotal:Ve,utilidadBruta:qe}]),de(""),me(0),ke(NaN),F(0)},pe=_e=>{K(U=>U.filter(ye=>ye.tempId!==_e))},Pe=(_e,U,ye)=>{K(te=>te.map(Ve=>{if(Ve.tempId!==_e)return Ve;const qe={...Ve};return U==="quantity"&&(qe.quantity=As(Math.max(0,ye)),L||(qe.remaining=qe.quantity)),U==="purchasePrice"&&(qe.purchasePrice=Math.max(0,Number(ye||0))),U==="salePrice"&&(qe.salePrice=Math.max(0,Number(ye||0))),qe.invoiceTotal=Number((qe.quantity*qe.purchasePrice).toFixed(2)),qe.expectedTotal=Number((qe.quantity*qe.salePrice).toFixed(2)),qe.utilidadBruta=Number((qe.expectedTotal-qe.invoiceTotal).toFixed(2)),qe}))},Ee=g.useMemo(()=>{const _e=As(H.reduce((qe,G)=>qe+(Ue(G.unit)?Number(G.quantity||0):0),0)),U=As(H.reduce((qe,G)=>qe+(Ue(G.unit)?Number(G.remaining||0):0),0)),ye=Number(H.reduce((qe,G)=>qe+Number(G.invoiceTotal||0),0).toFixed(2)),te=Number(H.reduce((qe,G)=>qe+Number(G.expectedTotal||0),0).toFixed(2)),Ve=Number((te-ye).toFixed(2));return{lbsIn:_e,lbsRem:U,totalFacturado:ye,totalEsperado:te,utilidadBruta:Ve}},[H]),Ze=()=>{W(null),D([]),B(""),P(Mr(new Date,"yyyy-MM-dd")),z("lb"),de(""),me(0),ke(NaN),F(0),K([])},xe=async()=>{if(f(""),!H.length)return f("Agrega al menos un producto al pedido.");const _e=T||Mr(new Date,"yyyy-MM-dd"),U=String(E||"").trim()||`Pedido ${_e}`,ye=L||C5("BATCH");try{if(!L){for(const G of H)await $V({productId:G.productId,productName:G.productName,category:G.category,unit:G.unit,quantity:As(G.quantity),purchasePrice:Number(G.purchasePrice||0),salePrice:Number(G.salePrice||0),invoiceTotal:Number(G.invoiceTotal||0),expectedTotal:Number(G.expectedTotal||0),date:_e,notes:"",batchGroupId:ye,orderName:U});f(" Pedido creado"),S(!1),Ze(),h();return}const te=Y,Ve=new Map;for(const G of te)Ve.set(G.productId,G);const qe=new Set(H.map(G=>G.productId));for(const G of H){const V=Ve.get(G.productId),Z=As(G.quantity);if(V){const re=As(V.quantity-V.remaining),we=Math.max(0,As(Z-re));await Fn(Zt(Ie,"inventory_batches",V.id),{date:_e,orderName:U,batchGroupId:ye,quantity:Z,purchasePrice:Number(G.purchasePrice||0),salePrice:Number(G.salePrice||0),invoiceTotal:Number(G.invoiceTotal||0),expectedTotal:Number(G.expectedTotal||0),remaining:we})}else await $V({productId:G.productId,productName:G.productName,category:G.category,unit:G.unit,quantity:Z,purchasePrice:Number(G.purchasePrice||0),salePrice:Number(G.salePrice||0),invoiceTotal:Number(G.invoiceTotal||0),expectedTotal:Number(G.expectedTotal||0),date:_e,notes:"",batchGroupId:ye,orderName:U})}for(const G of te)qe.has(G.productId)||await Kn(Zt(Ie,"inventory_batches",G.id));f(" Pedido actualizado"),S(!1),Ze(),h()}catch(te){console.error(te),f(" Error al guardar pedido")}},Se=_e=>{M(_e),ee(!0)},gt=_e=>{W(_e.groupId),D(_e.items),B(_e.orderName),P(_e.date||Mr(new Date,"yyyy-MM-dd"));const U=_e.items.map(ye=>{const te=Number(ye.invoiceTotal||0),Ve=Number(ye.expectedTotal||0);return{tempId:C5("IT"),productId:ye.productId,productName:ye.productName,category:ye.category,unit:ye.unit,quantity:As(ye.quantity),remaining:As(ye.remaining),purchasePrice:Number(ye.purchasePrice||0),salePrice:Number(ye.salePrice||0),invoiceTotal:te,expectedTotal:Ve,utilidadBruta:Number((Ve-te).toFixed(2))}});K(U),S(!0)},Et=async _e=>{if(confirm(`Eliminar el pedido "${_e.orderName}" del ${_e.date}?`))try{for(const ye of _e.items)await Kn(Zt(Ie,"inventory_batches",ye.id));f(" Pedido eliminado"),h()}catch(ye){console.error(ye),f(" Error al eliminar pedido")}},Nt=_e=>{De(_e),ae(!0)},Tt=async()=>{if(X)try{for(const _e of X.items){if(_e.status!=="PENDIENTE")continue;await Ure(_e.id),await Fn(Zt(Ie,"inventory_batches",_e.id),{remaining:0});const U={date:_e.date,productName:_e.productName,quantity:_e.quantity,amount:Number((_e.expectedTotal??_e.salePrice*_e.quantity).toFixed(2)),allocations:[{batchId:_e.id,qty:_e.quantity,unitCost:_e.purchasePrice,lineCost:Number((_e.purchasePrice*_e.quantity).toFixed(2))}],avgUnitCost:_e.purchasePrice,measurement:_e.unit,createdAt:vr.now(),autoGeneratedFromInventory:!0};await Jn(yt(Ie,"salesV2"),U)}f(" Pedido pagado y reflejado como venta"),h()}catch(_e){console.error(_e),f(" Error al pagar pedido")}finally{ae(!1),De(null)}},Lt=()=>{ae(!1),De(null)},Me=()=>{const _e=new rn({unit:"pt",format:"a4",orientation:"landscape"}),U="Inventario de Pollo",ye=`Rango: ${v||"(sin inicio)"} a ${b||"(sin fin)"}`,te=`Producto: ${be}`,Ve=V=>Number(V||0).toFixed(3);let qe=40;_e.setFontSize(16),_e.text(U,40,qe),qe+=16,_e.setFontSize(10),_e.text(ye,40,qe),qe+=12,_e.text(te,40,qe),qe+=14;const G=()=>{var V;qe=(V=_e.lastAutoTable)!=null&&V.finalY?_e.lastAutoTable.finalY+18:qe+18};U0(_e,{startY:qe,head:[["KPI","Valor"]],body:[["Libras ingresadas",Ve(Ce.lbsIng)],["Libras restantes",Ve(Ce.lbsRem)],["Unidades ingresadas",Ve(Ce.udsIng)],["Unidades restantes",Ve(Ce.udsRem)],["Total esperado",Ga(Ce.totalEsperado)],["Total facturado",Ga(Ce.totalFacturado)],["Ganancia sin gastos",Ga(Ce.totalEsperado-Ce.totalFacturado)],["Cantidad de lotes",Ne.length.toString()]],styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),G(),U0(_e,{startY:qe,head:[["Fecha","Pedido","Tipo","Lb In","Lb Rem","Ud In","Ud Rem","Facturado","Esperado","Utilidad","Estado"]],body:Le.map(V=>[V.date,V.orderName,V.typeLabel,Ve(V.lbsIn),Ve(V.lbsRem),Ve(V.udsIn),Ve(V.udsRem),Ga(V.totalFacturado),Ga(V.totalEsperado),Ga(V.utilidadBruta),V.status]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),G(),Le.forEach(V=>{_e.setFontSize(11),_e.text(`Pedido: ${V.orderName} (${V.date})  ${V.typeLabel}`,40,qe),qe+=12,U0(_e,{startY:qe,head:[["Producto","Unidad","Ingresado","Restante","Precio compra","Precio venta","Total facturado","Total esperado","Utilidad","Estado"]],body:V.items.map(Z=>[Z.productName,(Z.unit||"").toUpperCase(),Ve(Z.quantity),Ve(Z.remaining),Ga(Z.purchasePrice),Ga(Z.salePrice),Ga(Z.invoiceTotal||Z.purchasePrice*Z.quantity),Ga(Z.expectedTotal||Z.salePrice*Z.quantity),Ga((Z.expectedTotal||Z.salePrice*Z.quantity)-(Z.invoiceTotal||Z.purchasePrice*Z.quantity)),Z.status]),styles:{fontSize:8},headStyles:{fillColor:[230,230,230],textColor:[0,0,0]}}),G()}),_e.save(`inventario_pollo_${v||"sin_desde"}_a_${b||"sin_hasta"}.pdf`)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-gray-900 text-white hover:bg-black",type:"button",onClick:Me,disabled:c,children:"Exportar PDF"}),x&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{Ze(),S(!0)},children:"Crear Lote"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:_e=>y(_e.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:b,onChange:_e=>w(_e.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:j,onChange:_e=>I(_e.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),a.map(_e=>i.jsxs("option",{value:_e.id,children:[_e.name,"  ",_e.category]},_e.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{y(""),w(""),I("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(Oc,{onClick:()=>h(),loading:c})})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:[i.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:jt,role:"button","aria-expanded":it,children:[i.jsxs("div",{className:"flex gap-6 items-center",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Ce.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Ce.lbsRem.toFixed(3)]})]}),i.jsx("div",{className:"text-sm text-gray-500",children:it?"Cerrar":"Ver ms"})]}),it&&i.jsx("div",{className:"mt-3",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Ce.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Ce.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Ce.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Ce.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",Ce.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",Ce.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(Ce.totalEsperado-Ce.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",Ne.length.toLocaleString()]})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx("div",{className:"flex gap-2",children:[{key:"all",label:"Todos"},{key:"with",label:"Con disponibilidad"},{key:"without",label:"Sin disponibilidad"}].map(_e=>{const U=Mt===_e.key;return i.jsx("button",{type:"button",onClick:()=>Ft(_e.key),className:`flex-1 px-3 py-2 rounded-xl text-sm font-semibold shadow ${U?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:_e.label},_e.key)})}),c?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow",children:"Cargando"}):Ae.length===0?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow text-center",children:Mt==="with"?"Sin lotes con disponibilidad.":Mt==="without"?"Sin lotes sin disponibilidad.":"Sin lotes"}):We.map(({type:_e,items:U})=>{const ye=$t[_e]??!1;return i.jsxs("div",{className:"bg-white border rounded-2xl",children:[i.jsxs("button",{type:"button",onClick:()=>Ge(_e),className:"w-full px-4 py-3 flex items-center justify-between text-left",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:_e}),i.jsxs("div",{className:"text-xs text-gray-500",children:[U.length," ",U.length===1?"lote":"lotes"]})]}),i.jsx("span",{className:"text-xs text-gray-500",children:ye?"Cerrar":"Ver"})]}),ye&&i.jsx("div",{className:"space-y-3 px-2 pb-4",children:U.map(te=>{const Ve=le===te.groupId,qe=te.lbsRem>0||te.udsRem>0;return i.jsxs("div",{className:"bg-gray-50 border rounded-2xl",children:[i.jsxs("div",{className:"p-4 flex items-start justify-between gap-3 cursor-pointer",onClick:()=>Xe(te.groupId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"font-semibold text-lg",children:[te.date,i.jsxs("div",{className:"text-sm text-gray-500",children:["Producto: ",te.typeLabel]})]}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Nombre: ",te.orderName]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${te.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:te.status})})]}),i.jsxs("div",{className:"pb-4 p-4 flex items-start justify-between gap-1 cursor-pointer",children:[i.jsxs("div",{className:"px-2 py-1 rounded text-xs shrink-0 bg-green-100 font-semibold text-gray-700",children:["Ingresado: ",ie(te.lbsIn,te.udsIn)]}),i.jsxs("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${qe?"bg-green-100 font-semibold text-gray-700":"bg-red-100 font-semibold text-red-700"}`,children:["Disponible: ",ie(te.lbsRem,te.udsRem)]})]}),Ve&&i.jsxs("div",{className:"p-4 pt-0",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Tipo"}),i.jsx("div",{className:"font-semibold",children:te.typeLabel})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Utilidad bruta"}),i.jsx("div",{className:"font-semibold",children:Ga(te.utilidadBruta)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs ingresadas"}),i.jsx("div",{className:"font-semibold",children:te.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs restantes"}),i.jsx("div",{className:"font-semibold",children:te.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2 col-span-2",children:[i.jsxs("div",{className:"flex justify-between text-[11px] text-gray-500",children:[i.jsx("span",{children:"Total facturado"}),i.jsx("span",{children:"Total esperado"})]}),i.jsxs("div",{className:"flex justify-between font-semibold",children:[i.jsx("span",{children:Ga(te.totalFacturado)}),i.jsx("span",{children:Ga(te.totalEsperado)})]})]}),te.items.length>0&&i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 col-span-2 border border-gray-100",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-2",children:"Productos asociados"}),i.jsx("div",{className:"space-y-1",children:te.items.map(G=>i.jsxs("div",{className:"flex items-center text-xs justify-between gap-2",children:[i.jsx("div",{className:"font-semibold text-gray-800 truncate",children:G.productName}),i.jsxs("div",{className:"text-gray-600 text-right",children:[i.jsxs("div",{children:["Ingresado:"," ",G.quantity.toFixed(3)]}),i.jsxs("div",{children:["Restante:"," ",G.remaining.toFixed(3)]})]})]},G.id))})]})]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>Se(te),children:"Ver detalle"}),p?i.jsxs(i.Fragment,{children:[te.status==="PENDIENTE"&&i.jsx("button",{className:"px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm",onClick:()=>Nt(te),children:"Pagar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-yellow-600 hover:bg-yellow-700 text-white text-sm",onClick:()=>gt(te),children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm",onClick:()=>Et(te),children:"Borrar"})]}):null]})]})]},te.groupId)})})]},_e)})]}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Unidades ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Unidades restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:c?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):Le.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin lotes"})}):Le.map(_e=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>Se(_e),title:_e.orderName,children:_e.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:_e.orderName})]}),i.jsx("td",{className:"p-2 border",children:_e.typeLabel}),i.jsx("td",{className:"p-2 border",children:_e.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:_e.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:_e.udsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:_e.udsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ga(_e.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:Ga(_e.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:Ga(_e.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${_e.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:_e.status})}),i.jsx("td",{className:"p-2 border",children:p?i.jsxs("div",{className:"flex gap-2 justify-center",children:[_e.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>Nt(_e),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>gt(_e),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Et(_e),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},_e.groupId))})]})}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),_&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:L?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:E,onChange:_e=>B(_e.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:T,onChange:_e=>P(_e.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:O,onChange:_e=>{z(_e.target.value),de(""),me(0),ke(NaN),F(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ce,onChange:_e=>de(_e.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),ct.map(_e=>i.jsxs("option",{value:_e.id,children:[_e.name,"  ",_e.category,"  ",_e.measurement]},_e.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ue===0?"":ue,onChange:_e=>{const U=_e.target.value.replace(",","."),ye=parseFloat(U),te=Number.isFinite(ye)?parseFloat(ye.toFixed(3)):0;me(Math.max(0,te));const Ve=H.find(qe=>qe.productId===ce);Ve&&Pe(Ve.tempId,"quantity",te)},disabled:!ce})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Number.isNaN(se)?"":se,onChange:_e=>{const U=_e.target.value.replace(",",".");if(U==="")return ke(NaN);const ye=parseFloat(U),te=Number.isFinite(ye)?parseFloat(ye.toFixed(2)):NaN;ke(Number.isFinite(te)?Math.max(0,te):NaN);const Ve=H.find(qe=>qe.productId===ce);Ve&&Number.isFinite(te)&&Pe(Ve.tempId,"purchasePrice",te)},disabled:!ce})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Re===0?"":Re,onChange:_e=>{const U=_e.target.value.replace(",","."),ye=parseFloat(U),te=Number.isFinite(ye)?parseFloat(ye.toFixed(2)):0;F(Math.max(0,te));const Ve=H.find(qe=>qe.productId===ce);Ve&&Pe(Ve.tempId,"salePrice",te)},disabled:!ce})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:_t,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):H.map(_e=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[_e.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[_e.category,"  ",_e.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:_e.quantity,onChange:U=>{const ye=U.target.value.replace(",","."),te=parseFloat(ye),Ve=Number.isFinite(te)?parseFloat(te.toFixed(3)):0;Pe(_e.tempId,"quantity",Ve)}})}),i.jsx("td",{className:"p-2 border",children:Number(_e.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:_e.purchasePrice,onChange:U=>{const ye=U.target.value.replace(",","."),te=parseFloat(ye),Ve=Number.isFinite(te)?parseFloat(te.toFixed(2)):0;Pe(_e.tempId,"purchasePrice",Ve)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:_e.salePrice,onChange:U=>{const ye=U.target.value.replace(",","."),te=parseFloat(ye),Ve=Number.isFinite(te)?parseFloat(te.toFixed(2)):0;Pe(_e.tempId,"salePrice",Ve)}})}),i.jsx("td",{className:"p-2 border",children:Ga(_e.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:Ga(_e.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:Ga(_e.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>pe(_e.tempId),children:"Quitar"})})]},_e.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:Ee.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:Ee.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(Ee.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(Ee.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(Ee.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:xe,disabled:H.length===0,children:L?"Editar pedido":"Crear pedido"})]})]})]}),document.body),Q&&ve&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{ee(!1),M(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:ve.orderName})," "," ",ve.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ee(!1),M(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:ve.items.map(_e=>{const U=Number(_e.invoiceTotal||0),ye=Number(_e.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:_e.productName}),i.jsx("td",{className:"p-2 border",children:(_e.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:_e.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:_e.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ga(_e.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:Ga(_e.salePrice)}),i.jsx("td",{className:"p-2 border",children:Ga(U)}),i.jsx("td",{className:"p-2 border",children:Ga(ye)}),i.jsx("td",{className:"p-2 border",children:Ga(ye-U)}),i.jsx("td",{className:"p-2 border",children:_e.status})]},_e.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(ve.utilidadBruta)})]})]})]})]}),document.body),Ye&&X&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Lt}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:X.orderName})," "," ",X.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:Tt,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:Lt,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const Bh=t=>`C$${(Number(t)||0).toFixed(2)}`;function _3e(){const t=nwe(new Date),[e,r]=g.useState(Mr(t,"yyyy-MM")),[n,a]=g.useState([]),[s,o]=g.useState(!1),[l,c]=g.useState(""),u=g.useRef(null),d=g.useMemo(()=>{const[x,v]=e.split("-").map(w=>parseInt(w,10)),y=Mr(Ud(new Date(x,v-1,1)),"yyyy-MM-dd"),b=Mr(Ld(new Date(x,v-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),f=async()=>{o(!0);try{const x=await vPe(d.from,d.to),v=[];for(const y of x){const b=Zt(Ie,"inventory_batches",y.batchId),w=await zs(b);if(!w.exists())continue;const j=w.data();v.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:j.status??"PENDIENTE",purchasePrice:Number(j.purchasePrice||0),salePrice:Number(j.salePrice||0),supplier:j.supplier})}a(v)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};g.useEffect(()=>{f()},[e]);const A=async x=>{confirm("Marcar este lote como PAGADO?")&&(await Ure(x),a(y=>y.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=g.useMemo(()=>{const x=n.reduce((w,j)=>w+j.soldQty,0),v=n.reduce((w,j)=>w+j.soldAmount,0),y=n.reduce((w,j)=>w+j.soldQty*j.purchasePrice,0),b=v-y;return{q:x,amt:v,cogs:y,profit:b}},[n]),m=g.useMemo(()=>{const x=new Map;for(const v of n){const y=v.productName||"(sin nombre)";x.has(y)||x.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(y);b.qty+=v.soldQty,b.revenue+=v.soldAmount;const w=v.soldQty*v.purchasePrice;b.cogs+=w,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((v,y)=>v.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!u.current)return;const x=u.current;x.classList.add("force-pdf-colors");try{const[{default:v},{jsPDF:y}]=await Promise.all([iA(()=>Promise.resolve().then(()=>Q6),void 0),iA(()=>Promise.resolve().then(()=>$k),void 0)]),w=(await v(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),j=new y("p","mm","a4"),I=190,_=j.getImageProperties(w),S=I,E=_.height*S/_.width;j.addImage(w,"PNG",10,10,S,E),j.save(`liquidaciones_${e}.pdf`)}catch(v){console.error(v),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:f,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:u,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",Bh(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",Bh(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",Bh(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const v=x.soldQty*x.purchasePrice,y=x.soldAmount-v;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:Bh(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:Bh(v)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:Bh(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>A(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:Bh(x.revenue)}),i.jsx("td",{className:"p-2 border",children:Bh(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:Bh(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Yr=t=>`C$${Number(t??0).toFixed(2)}`,E3e=()=>Mr(new Date,"yyyy-MM-dd"),oa=t=>Number(t||0).toFixed(3);function S3e(){const[t,e]=g.useState(()=>{const te=new Date,Ve=new Date(te.getFullYear(),te.getMonth(),1);return Mr(Ve,"yyyy-MM-dd")}),[r,n]=g.useState(E3e()),[a,s]=g.useState(!0),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState(!1),[m,p]=g.useState(null),[x,v]=g.useState(0),[y,b]=g.useState(0),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState({}),[B,T]=g.useState({}),{refreshKey:P,refresh:O}=Dc(),[z,ce]=g.useState({}),[de,ue]=g.useState({}),[me,se]=g.useState(!1),ke=()=>se(te=>!te),[Re,F]=g.useState(!1),H=()=>F(te=>!te),[K,L]=g.useState(!1),[W,Y]=g.useState(!1),[D,Q]=g.useState(!1),[ee,ve]=g.useState(!1),[M,Ye]=g.useState(!1),[ae,X]=g.useState(!1),De=()=>L(te=>!te),le=()=>Y(te=>!te),$e=()=>Q(te=>!te),Xe=()=>ve(te=>!te),it=()=>Ye(te=>!te),xt=()=>X(te=>!te),[jt,Mt]=g.useState("");g.useEffect(()=>{(async()=>{s(!0);const Ve=sr(yt(Ie,"salesV2"),mr("date",">=",t),mr("date","<=",r)),qe=await Ht(Ve),G=[];qe.forEach(we=>{const Fe=we.data(),st=Fe.date??"";if(Array.isArray(Fe.items)&&Fe.items.length>0){Fe.items.forEach((Be,at)=>{const lt=String(Be.productName??"(sin nombre)"),dt=Number(Be.qty??0),Pt=Number(Be.lineFinal??0)||Math.max(0,Number(Be.unitPrice||0)*dt-Number(Be.discount||0));G.push({id:`${we.id}#${at}`,date:st,productName:lt,quantity:dt,amount:Pt,allocations:Array.isArray(Be.allocations)?Be.allocations:Fe.allocations,avgUnitCost:Number(Be.avgUnitCost??Fe.avgUnitCost??0),measurement:Be.measurement??Fe.measurement??"",type:Fe.type??"CONTADO"})});return}G.push({id:we.id,date:st,productName:Fe.productName??"(sin nombre)",quantity:Number(Fe.quantity??0),amount:Number(Fe.amount??Fe.amountCharged??0),allocations:Array.isArray(Fe.allocations)?Fe.allocations:[],avgUnitCost:Number(Fe.avgUnitCost??0),measurement:Fe.measurement??"",type:Fe.type??"CONTADO"})}),l(G);const V=sr(yt(Ie,"expenses"),mr("date",">=",t),mr("date","<=",r)),Z=await Ht(V),re=[];Z.forEach(we=>{const Fe=we.data();re.push({id:we.id,date:Fe.date??"",category:Fe.category??"(sin categora)",description:Fe.description??"",amount:Number(Fe.amount??0),status:Fe.status??"PAGADO",createdAt:Fe.createdAt})}),u(re),s(!1)})()},[t,r,P]),g.useMemo(()=>{const te=o.reduce((Z,re)=>Z+(re.amount||0),0);let Ve=0;o.forEach(Z=>{var re;(re=Z.allocations)!=null&&re.length?Ve+=Z.allocations.reduce((we,Fe)=>we+Number(Fe.lineCost||0),0):Z.avgUnitCost&&Z.quantity&&(Ve+=Number(Z.avgUnitCost)*Number(Z.quantity))});const qe=te-Ve,G=c.reduce((Z,re)=>Z+(re.amount||0),0),V=qe-G;return{revenue:te,cogsReal:Ve,grossProfit:qe,expensesSum:G,netProfit:V}},[o,c]);const Ft=g.useMemo(()=>jt?o.filter(te=>(te.productName||"")===jt):o,[o,jt]),$t=g.useMemo(()=>{const te=Ft.reduce((Z,re)=>Z+(re.amount||0),0);let Ve=0;Ft.forEach(Z=>{var re;(re=Z.allocations)!=null&&re.length?Ve+=Z.allocations.reduce((we,Fe)=>we+Number(Fe.lineCost||0),0):Z.avgUnitCost&&Z.quantity&&(Ve+=Number(Z.avgUnitCost)*Number(Z.quantity))});const qe=te-Ve,G=c.reduce((Z,re)=>Z+(re.amount||0),0),V=qe-G;return{revenue:te,cogsReal:Ve,grossProfit:qe,expensesSum:G,netProfit:V}},[Ft,c]),kt=g.useMemo(()=>{const te=Ft.filter(re=>re.type==="CONTADO"),Ve=te.reduce((re,we)=>re+(we.amount||0),0);let qe=0;te.forEach(re=>{var we;(we=re.allocations)!=null&&we.length?qe+=re.allocations.reduce((Fe,st)=>Fe+Number(st.lineCost||0),0):re.avgUnitCost&&re.quantity&&(qe+=Number(re.avgUnitCost)*Number(re.quantity))});const G=Ve-qe,V=c.reduce((re,we)=>re+(we.amount||0),0),Z=G-V;return{revenue:Ve,cogsReal:qe,grossProfit:G,expensesSum:V,netProfit:Z}},[Ft,c]),Ge=g.useMemo(()=>{const te=Ft.filter(V=>V.type==="CREDITO"),Ve=te.reduce((V,Z)=>V+(Z.amount||0),0);let qe=0;te.forEach(V=>{var Z;(Z=V.allocations)!=null&&Z.length?qe+=V.allocations.reduce((re,we)=>re+Number(we.lineCost||0),0):V.avgUnitCost&&V.quantity&&(qe+=Number(V.avgUnitCost)*Number(V.quantity))});const G=Ve-qe;return{revenue:Ve,cogsReal:qe,grossProfit:G}},[Ft]),ie=te=>String(te??"").toLowerCase().trim(),Ue=te=>Number(te.qty??te.quantity??0),Ne=te=>["lb","lbs","libra","libras"].includes(ie(te)),be=te=>["unidad","unidades","ud","uds","pieza","piezas"].includes(ie(te)),Ce=te=>te?typeof te=="string"?te:te!=null&&te.toDate?Mr(te.toDate(),"yyyy-MM-dd"):"":"";g.useEffect(()=>{(async()=>{h(!0);try{const Ve=await Ht(yt(Ie,"customers_pollo")),qe={};Ve.forEach(ir=>{const Nr=ir.data();qe[ir.id]=String(Nr.name??"(sin nombre)")});const G=await Ht(yt(Ie,"ar_movements_pollo")),V={},Z={},re={},we={},Fe={},st=new Set,Be={},at={},lt={},dt={};let Pt=0,he=0;const ze=ir=>{var Nr;return ir!=null&&ir.date?String(ir.date):(Nr=ir==null?void 0:ir.createdAt)!=null&&Nr.toDate?Mr(ir.createdAt.toDate(),"yyyy-MM-dd"):""};G.forEach(ir=>{var zr,gn,Nn;const Nr=ir.data(),Pr=String(Nr.customerId??"").trim();if(!Pr)return;const xr=Number(Nr.amount??0);V[Pr]=(V[Pr]||0)+xr;const $r=String(Nr.type??"").toUpperCase(),cr=String(Nr.debtStatus??Nr.creditStatus??Nr.cycleStatus??Nr.status??"").toUpperCase().trim(),Zr=["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"].includes(cr),Wr=Nr.createdAt??null;if($r==="ABONO"){Pt+=Math.abs(xr);const Sn=ze(Nr);Sn&&Sn>=t&&Sn<=r&&(he+=Math.abs(xr));const fe=(zr=Nr==null?void 0:Nr.ref)!=null&&zr.saleId?String(Nr.ref.saleId):"";fe?(Be[fe]=(Be[fe]||0)+Math.abs(xr),Sn&&Sn>=t&&Sn<=r&&(lt[fe]=(lt[fe]||0)+Math.abs(xr)),st.add(fe)):(at[Pr]=(at[Pr]||0)+Math.abs(xr),Sn&&Sn>=t&&Sn<=r&&(dt[Pr]=(dt[Pr]||0)+Math.abs(xr)));const tt=re[Pr],vt=!(tt!=null&&tt.ts)||(Wr!=null&&Wr.toDate&&((gn=tt.ts)!=null&&gn.toDate)?Wr.toDate()>tt.ts.toDate():!1);(!tt||vt)&&(re[Pr]={amount:Math.abs(xr),date:Nr.date??"",ts:Wr})}if($r==="CARGO"){const Sn=(Nn=Nr==null?void 0:Nr.ref)!=null&&Nn.saleId?String(Nr.ref.saleId):"";Sn&&(we[Pr]||(we[Pr]=new Set),we[Pr].add(Sn),Zr||(Fe[Pr]||(Fe[Pr]=new Set),Fe[Pr].add(Sn)),st.add(Sn)),Zr||(Z[Pr]=(Z[Pr]||0)+Math.abs(xr))}});const nt=new Map;await Promise.all(Array.from(st).map(async ir=>{const Nr=await zs(Zt(Ie,"salesV2",ir));Nr.exists()&&nt.set(ir,Nr.data())}));let ne=0,He=0;const pt=ir=>{const Nr=Number(ir.qty??ir.quantity??0);return Number(ir.lineFinal??0)||Math.max(0,Number(ir.unitPrice||0)*Nr-Number(ir.discount||0))},Dt=ir=>{if(Array.isArray(ir.items)&&ir.items.length>0){let $r=0,cr=0;return ir.items.forEach(Zr=>{const Wr=Number(Zr.qty??Zr.quantity??0);if($r+=pt(Zr),Array.isArray(Zr.allocations)&&Zr.allocations.length>0)cr+=Zr.allocations.reduce((zr,gn)=>zr+Number(gn.lineCost||0),0);else{const zr=Number(Zr.avgUnitCost??ir.avgUnitCost??0);cr+=zr*Wr}}),{total:$r,cogs:cr}}const Nr=Number(ir.quantity??0),Pr=Number(ir.amount??ir.amountCharged??0)||0;let xr=0;return Array.isArray(ir.allocations)&&ir.allocations.length>0?xr=ir.allocations.reduce(($r,cr)=>$r+Number(cr.lineCost||0),0):ir.avgUnitCost&&(xr=Number(ir.avgUnitCost)*Nr),{total:Pr,cogs:xr}},rr=new Map;nt.forEach((ir,Nr)=>{const{total:Pr,cogs:xr}=Dt(ir);rr.set(Nr,{total:Pr,cogs:xr,grossProfit:Pr-xr})});const zt={},Ot={},lr={},Dr={};Object.keys(Be).forEach(ir=>{const Nr=rr.get(ir);if(!(Nr!=null&&Nr.total))return;const Pr=Number(Be[ir]||0);Ot[ir]=Pr;const xr=Math.min(1,Pr/Nr.total),$r=Nr.grossProfit*xr;zt[ir]=$r,ne+=$r}),Object.keys(lt).forEach(ir=>{const Nr=rr.get(ir);if(!(Nr!=null&&Nr.total))return;const Pr=Number(lt[ir]||0);Dr[ir]=Pr;const xr=Math.min(1,Pr/Nr.total),$r=Nr.grossProfit*xr;lr[ir]=$r,He+=$r}),Object.keys(at).forEach(ir=>{const Nr=we[ir];if(!Nr||Nr.size===0)return;let Pr=0,xr=0,$r=0,cr=0;Nr.forEach(Nn=>{const Sn=rr.get(Nn);Sn&&(Pr+=Sn.total,xr+=Sn.grossProfit,Ot[Nn]&&($r+=Math.min(Sn.total,Ot[Nn])),cr+=zt[Nn]||0)});const Zr=Math.max(0,Pr-$r),Wr=Math.max(0,xr-cr);if(!Zr||!Wr)return;const zr=Number(at[ir]||0),gn=Math.min(1,zr/Zr);ne+=Wr*gn}),Object.keys(dt).forEach(ir=>{const Nr=we[ir];if(!Nr||Nr.size===0)return;let Pr=0,xr=0,$r=0,cr=0;Nr.forEach(Nn=>{const Sn=rr.get(Nn);Sn&&(Pr+=Sn.total,xr+=Sn.grossProfit,Dr[Nn]&&($r+=Math.min(Sn.total,Dr[Nn])),cr+=lr[Nn]||0)});const Zr=Math.max(0,Pr-$r),Wr=Math.max(0,xr-cr);if(!Zr||!Wr)return;const zr=Number(dt[ir]||0),gn=Math.min(1,zr/Zr);He+=Wr*gn});const br=[];Object.keys(V).forEach(ir=>{const Nr=Number(V[ir]||0);if(Nr<=0)return;const Pr=new Map;let xr=0,$r=0,cr="";(Fe[ir]||new Set).forEach(gn=>{const Nn=nt.get(gn);if(!Nn)return;const Sn=String(Nn.date??"");Sn&&(!cr||Sn>cr)&&(cr=Sn),(Array.isArray(Nn.items)&&Nn.items.length>0?Nn.items:[{productName:Nn.productName,qty:Nn.quantity,unitPrice:Nn.unitPrice,discount:Nn.discount,lineFinal:Nn.amount??Nn.amountCharged,measurement:Nn.measurement}]).forEach(tt=>{const vt=String(tt.productName??"(sin nombre)"),mt=Number(tt.qty??tt.quantity??0),Oe=String(tt.measurement??""),At=Number(tt.lineFinal??0)||Math.max(0,Number(tt.unitPrice||0)*mt-Number(tt.discount||0));Ne(Oe)?xr+=mt:$r+=mt;const It=`${vt}||${Oe}`,Ct=Pr.get(It)||{productName:vt,qty:0,amount:0,measurement:Oe};Ct.qty+=mt,Ct.amount+=At,Pr.set(It,Ct)})});const Wr=re[ir],zr=Number(Z[ir]||0);br.push({customerId:ir,name:qe[ir]||"(sin nombre)",balance:Nr,globalBalance:zr>0?zr:Nr,lbs:xr,units:$r,lastPaymentAmount:Number((Wr==null?void 0:Wr.amount)||0),lastSaleDate:cr||"",lastPaymentDate:Ce((Wr==null?void 0:Wr.ts)||(Wr==null?void 0:Wr.date)),products:Array.from(Pr.values()).sort((gn,Nn)=>gn.productName.localeCompare(Nn.productName))})});const nr=br.filter(ir=>ir.products.length);nr.sort((ir,Nr)=>Nr.balance-ir.balance),f(nr),v(Pt),b(he),j(ne),_(He)}catch(Ve){console.error("Error cargando saldos pendientes:",Ve),f([]),v(0),b(0),_(0)}finally{h(!1)}})()},[P,t,r]),g.useEffect(()=>{(async()=>{try{const Ve=await Ht(sr(yt(Ie,"inventory_batches"))),qe=yS(t,"yyyy-MM-dd",new Date),G=yS(r,"yyyy-MM-dd",new Date),V=Mr(Ud(qe),"yyyy-MM-dd"),Z=Mr(Ld(G),"yyyy-MM-dd"),re={};Ve.forEach(we=>{var Pt;const Fe=we.data(),st=String(Fe.productName??"(sin nombre)"),Be=Number(Fe.quantity??0),at=Number(Fe.remaining??0),lt=(Pt=Fe==null?void 0:Fe.date)!=null&&Pt.toDate?Mr(Fe.date.toDate(),"yyyy-MM-dd"):String((Fe==null?void 0:Fe.date)??(Fe==null?void 0:Fe.createdAt)??""),dt=lt&&lt>=V&&lt<=Z;re[st]||(re[st]={incomingQty:0,remainingQty:0}),dt&&(re[st].incomingQty+=Be),re[st].remainingQty+=at}),E(re)}catch(Ve){console.error("Error cargando inventario:",Ve),E({})}})()},[P,t,r]),g.useMemo(()=>o.reduce((te,Ve)=>Ne(Ve.measurement)?te+Ue(Ve):te,0),[o]),g.useMemo(()=>Ft.reduce((te,Ve)=>Ne(Ve.measurement)?te+Ue(Ve):te,0),[Ft]);const Le=g.useMemo(()=>Ft.filter(te=>te.type==="CONTADO"),[Ft]),Ae=g.useMemo(()=>Ft.filter(te=>te.type==="CREDITO"),[Ft]),We=g.useMemo(()=>Le.reduce((te,Ve)=>te+(Ve.amount||0),0),[Le]),ct=g.useMemo(()=>Ae.reduce((te,Ve)=>te+(Ve.amount||0),0),[Ae]),_t=g.useMemo(()=>d.reduce((te,Ve)=>te+Number(Ve.balance||0),0),[d]),pe=g.useMemo(()=>kt.revenue,[kt.revenue]),Pe=g.useMemo(()=>We,[We]),Ee=g.useMemo(()=>We+y,[We,y]),Ze=g.useMemo(()=>kt.grossProfit+I,[kt.grossProfit,I]),xe=g.useMemo(()=>kt.netProfit+I,[kt.netProfit,I]),Se=g.useMemo(()=>Le.reduce((te,Ve)=>Ne(Ve.measurement)?te+Ue(Ve):te,0),[Le]),gt=g.useMemo(()=>Ae.reduce((te,Ve)=>Ne(Ve.measurement)?te+Ue(Ve):te,0),[Ae]);g.useMemo(()=>o.reduce((te,Ve)=>be(Ve.measurement)?te+Ue(Ve):te,0),[o]),g.useMemo(()=>Ft.reduce((te,Ve)=>be(Ve.measurement)?te+Ue(Ve):te,0),[Ft]);const Et=g.useMemo(()=>Le.reduce((te,Ve)=>be(Ve.measurement)?te+Ue(Ve):te,0),[Le]),Nt=g.useMemo(()=>Ae.reduce((te,Ve)=>be(Ve.measurement)?te+Ue(Ve):te,0),[Ae]),Tt=g.useMemo(()=>Array.from(new Set(o.map(te=>te.productName||"(sin nombre)"))).sort(),[o]),Lt=g.useMemo(()=>{var Ve;const te=new Map;for(const qe of Ft){const G=qe.productName||"(sin nombre)";te.has(G)||te.set(G,{productName:G,units:0,revenue:0,cogs:0,profit:0,firstDate:qe.date||"",lastDate:qe.date||""});const V=te.get(G);V.units+=Number(qe.quantity||0),V.revenue+=Number(qe.amount||0),(!V.firstDate||qe.date<(V.firstDate||qe.date))&&(V.firstDate=qe.date),(!V.lastDate||qe.date>(V.lastDate||qe.date))&&(V.lastDate=qe.date);let Z=0;(Ve=qe.allocations)!=null&&Ve.length?Z=qe.allocations.reduce((re,we)=>re+Number(we.lineCost||0),0):qe.avgUnitCost&&(Z=Number(qe.avgUnitCost)*Number(qe.quantity||0)),V.cogs+=Z,V.profit=V.revenue-V.cogs}return Array.from(te.values()).sort((qe,G)=>qe.productName.localeCompare(G.productName))},[Ft]),Me=g.useMemo(()=>[...Lt].sort((te,Ve)=>Ve.units-te.units).slice(0,3).map((te,Ve)=>({idx:Ve+1,name:te.productName,units:te.units})),[Lt]),_e=te=>ce(Ve=>({...Ve,[te]:!Ve[te]})),U=te=>ue(Ve=>({...Ve,[te]:!Ve[te]})),ye=()=>{const te=new rn({unit:"pt",format:"a4"}),Ve="Dashboard Financiero",qe=`Rango: ${t} a ${r}`,G=jt?`Producto: ${jt}`:"Producto: Todos";te.setFontSize(16),te.text(Ve,40,40),te.setFontSize(10),te.text(qe,40,58),te.text(G,40,72);let V=90;const Z=()=>{var we;V=(we=te.lastAutoTable)!=null&&we.finalY?te.lastAutoTable.finalY+18:V+18},re=(we,Fe)=>{Fe.length&&(te.setFontSize(11),te.text(we,40,V),V+=12,U0(te,{startY:V,head:[["KPI","Valor"]],body:Fe,styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Z())};re("KPIs Generales",[["Ventas (rango)",Yr($t.revenue)],["Costo",Yr($t.cogsReal)],["Utilidad Bruta",Yr($t.grossProfit)],["Gastos",Yr($t.expensesSum)],["Utilidad Neta",Yr($t.netProfit)]]),re("KPIs Cash",[["Ventas Cash",Yr(pe)],["Costo Cash",Yr(kt.cogsReal)],["Utilidad Bruta Cash",Yr(kt.grossProfit)]]),re("KPIs Crdito",[["Ventas Crdito",Yr(Ge.revenue)],["Costo Crdito",Yr(Ge.cogsReal)],["Utilidad Bruta Crdito",Yr(Ge.grossProfit)]]),re("Fondos y Utilidades",[["CxC",Yr(_t)],["Recaudacin (Abonos)",Yr(x)],["Recaudacin a la fecha",Yr(y)],["Recolectado Cash + Abonos",Yr(Ee)],["Utilidad Neta Crdito (Caja)",Yr(I)],["Utilidad Bruta Cash + Crdito",Yr(Ze)],["Gastos",Yr(kt.expensesSum)],["Utilidad Neta Cash + Crdito",Yr(xe)]]),re("KPIs de Volumen y Ventas",[["Ventas Cash",Yr(Pe)],["Ventas Crdito",Yr(ct)],["Libras Cash",oa(Se)],["Libras Crdito",oa(gt)],["Libras Cash + Crdito",oa(Se+gt)],["Unidades Cash",oa(Et)],["Unidades Crdito",oa(Nt)],["Unidades Cash + Crdito",oa(Et+Nt)]]),Me.length>0&&(te.setFontSize(11),te.text("Top productos por unidades",40,V),V+=12,U0(te,{startY:V,head:[["#","Producto","Cantidad"]],body:Me.map(we=>[String(we.idx),we.name,oa(we.units)]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Z()),U0(te,{startY:V,head:[["Cliente","Libras","Unidades","Saldo Global","ltimo abono","Saldo pendiente","Fecha ult. abono"]],body:d.map(we=>[we.name,oa(we.lbs),oa(we.units),Yr(we.globalBalance),Yr(we.lastPaymentAmount),Yr(we.balance),we.lastPaymentDate||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]},didDrawPage:we=>{we.pageNumber>1&&(te.setFontSize(10),te.text(Ve,40,30))}}),Z(),U0(te,{startY:V,head:[["Producto","Ingresado","Disponibilidad","Fechas","Cantidad","Venta","Costo","Utilidad"]],body:Lt.map(we=>{var Fe,st;return[we.productName,oa(((Fe=S[we.productName])==null?void 0:Fe.incomingQty)||0),oa(((st=S[we.productName])==null?void 0:st.remainingQty)||0),we.firstDate&&we.lastDate?we.firstDate===we.lastDate?we.firstDate:`${we.firstDate}  ${we.lastDate}`:"",oa(we.units),Yr(we.revenue),Yr(we.cogs),Yr(we.profit)]}),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Z(),U0(te,{startY:V,head:[["Fecha","Categora","Descripcin","Monto","Estado"]],body:c.map(we=>[we.date,we.category,we.description||"",Yr(we.amount),we.status||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),te.save(`dashboard_${t}_a_${r}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Dashboard Financiero"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",onClick:ye,className:"px-3 py-2 rounded-lg text-sm bg-gray-900 text-white hover:bg-black",children:"Exportar PDF"}),i.jsx(Oc,{onClick:O,loading:a})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:te=>e(te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:te=>n(te.target.value)})]})]}),a?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:De,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Kpi Financiero"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Ventas: ",i.jsx("b",{children:Yr($t.revenue)}),"  Utilidad Neta:"," ",i.jsx("b",{children:Yr($t.netProfit)})]})]}),i.jsx("div",{className:"text-gray-500",children:K?"Cerrar":"Ver"})]}),K&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"flex gap-2 mb-2 items-center",children:i.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:jt,onChange:te=>Mt(te.target.value),children:[i.jsx("option",{value:"",children:"Todos los productos"}),Tt.map(te=>i.jsx("option",{value:te,children:te},te))]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:Xe,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Ventas cash - Credito"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Resumen"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:ee?"Cerrar":"Ver"})]}),ee&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"Ventas",subtitle:"Ventas cash",value:Yr(pe),valueClass:"text-[#1E4D2B]"}),i.jsx(ss,{title:"Costo",value:Yr(kt.cogsReal)}),i.jsx(ss,{title:"Utilidad Bruta Cash",value:Yr(kt.grossProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"Ventas Crdito",value:Yr(Ge.revenue)}),i.jsx(ss,{title:"Costo",value:Yr(Ge.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Crdito",value:Yr(Ge.grossProfit),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:it,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Fondos"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Liquidez"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:M?"Cerrar":"Ver"})]}),M&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"CxC",value:Yr(_t)}),i.jsx(ss,{title:"Recaudacin Global(Abonos)",value:Yr(x)}),i.jsx(ss,{title:"Recaudacin a la fecha",value:Yr(y)}),i.jsx(ss,{title:"Recolectado Cash + Abonos",value:Yr(Ee),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ss,{title:"Utilidad Neta Crdito (Caja)",value:Yr(I),valueClass:"text-[#BF5700]"}),i.jsx(ss,{title:"Utilidad Bruta Cash + Crdito",value:Yr(Ze),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ss,{title:"Gastos",value:Yr(kt.expensesSum),negative:!0}),i.jsx(ss,{title:"Utilidad Neta Cash + Crdito",value:Yr(xe),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:xt,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Detalles"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Mtricas adicionales"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:ae?"Cerrar":"Ver"})]}),ae&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Gl,{title:"Ventas Cash",value:Yr(Pe)}),i.jsx(Gl,{title:"Ventas Crdito",value:Yr(ct)}),i.jsx(Gl,{title:"Libras Cash",value:oa(Se)}),i.jsx(Gl,{title:"Libras Crdito",value:oa(gt)}),i.jsx(Gl,{title:"Unidades Cash",value:oa(Et)}),i.jsx(Gl,{title:"Unidades Crdito",value:oa(Nt)})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Gl,{title:"Libras Cash + Credito",value:oa(Se+gt)}),i.jsx(Gl,{title:"Unidades Cash + Credito",value:oa(Et+Nt)}),i.jsx(aH,{title:"Productos ms vendidos",items:Me.map(te=>({key:`${te.idx}`,label:`${te.idx}. ${te.name}`,value:`(${oa(te.units)})`}))})]})]})]})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Ventas Cash",value:Yr(pe),positive:!0}),i.jsx(ss,{title:"Costo",value:Yr(kt.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Cash",value:Yr(kt.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Ventas Crdito",value:Yr(Ge.revenue),positive:!0}),i.jsx(ss,{title:"Costo",value:Yr(Ge.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Crdito",value:Yr(Ge.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"CxC",value:Yr(_t),negative:!0}),i.jsx(ss,{title:"Recaudacin Global(Abonos)",value:Yr(x),positive:!0}),i.jsx(ss,{title:"Recaudacin a la fecha",value:Yr(y),positive:!0}),i.jsx(ss,{title:"Recolectado Cash + Abonos",value:Yr(Ee),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-4 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Utilidad Neta Crdito (Caja)",value:Yr(I),valueClass:"text-[#BF5700]"}),i.jsx(ss,{title:"Utilidad Bruta Cash + Crdito",value:Yr(Ze),positive:!0}),i.jsx(ss,{title:"Gastos",value:Yr(kt.expensesSum),negative:!0}),i.jsx(ss,{title:"Utilidad Neta Cash + Crdito",value:Yr(xe),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Gl,{title:"Ventas Cash",value:Yr(Pe)}),i.jsx(Gl,{title:"Ventas Crdito",value:Yr(ct)}),i.jsx(Gl,{title:"Libras Cash",value:oa(Se)}),i.jsx(Gl,{title:"Libras Crdito",value:oa(gt)}),i.jsx(Gl,{title:"Unidades Cash",value:oa(Et)}),i.jsx(Gl,{title:"Unidades Crdito",value:oa(Nt)})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Gl,{title:"Libras Cash + Credito",value:oa(Se+gt)}),i.jsx(Gl,{title:"Unidades Cash + Credito",value:oa(Et+Nt)}),i.jsx(aH,{title:"Productos ms vendidos",items:Me.map(te=>({key:`${te.idx}`,label:`${te.idx}. ${te.name}`,value:`(${oa(te.units)})`}))})]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:le,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Saldos pendientes"}),i.jsx("div",{className:"text-gray-500",children:W?"Cerrar":"Ver"})]}),W&&i.jsx("div",{className:"border rounded-2xl p-3 sm:p-4 bg-gray-50 mt-3",children:A?i.jsx("div",{className:"text-sm text-gray-600",children:"Cargando saldos"}):d.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"Sin saldos pendientes."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-white",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Libras"}),i.jsx("th",{className:"border p-2",children:"Unidades"}),i.jsx("th",{className:"border p-2",children:"Saldo Global"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:d.map(te=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1 text-left",children:te.name}),i.jsx("td",{className:"border p-1",children:oa(te.lbs)}),i.jsx("td",{className:"border p-1",children:oa(te.units)}),i.jsx("td",{className:"border p-1",children:Yr(te.globalBalance)}),i.jsx("td",{className:"border p-1",children:Yr(te.lastPaymentAmount)}),i.jsx("td",{className:"border p-1",children:Yr(te.balance)}),i.jsx("td",{className:"border p-1",children:te.lastPaymentDate||""}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",onClick:()=>p(te),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},te.customerId))})]})})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:$e,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Ventas y Gastos"}),i.jsx("div",{className:"text-gray-500",children:D?"Cerrar":"Ver"})]}),D&&i.jsxs("div",{className:"mt-3",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Ingresado Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Disponibilidad"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"}),i.jsx("th",{className:"border p-2",children:"Cantidad Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[Lt.map(te=>{var Ve,qe;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:te.productName}),i.jsx("td",{className:"border p-1",children:oa(((Ve=S[te.productName])==null?void 0:Ve.incomingQty)||0)}),i.jsx("td",{className:"border p-1",children:oa(((qe=S[te.productName])==null?void 0:qe.remainingQty)||0)}),i.jsx("td",{className:"border p-1",children:te.firstDate&&te.lastDate?te.firstDate===te.lastDate?te.firstDate:`${te.firstDate}  ${te.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:oa(te.units)}),i.jsx("td",{className:"border p-1",children:Yr(te.revenue)}),i.jsx("td",{className:"border p-1",children:Yr(te.cogs)}),i.jsx("td",{className:`border p-1 ${te.profit>=0?"text-green-700":"text-red-700"}`,children:Yr(te.profit)})]},te.productName)}),Lt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:ke,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Ventas por producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Lt.length," productos"]})]}),i.jsx("div",{className:"text-gray-500",children:me?"Cerrar":"Ver"})]}),me&&i.jsx("div",{className:"space-y-2 mt-3",children:Lt.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin datos en el rango seleccionado."}):Lt.map(te=>{var G,V,Z,re;const Ve=!!z[te.productName],qe=te.firstDate&&te.lastDate?te.firstDate===te.lastDate?te.firstDate:`${te.firstDate}  ${te.lastDate}`:"";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>_e(te.productName),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:te.productName}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Libras/Unidades"}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendidas: ",i.jsx("b",{children:oa(te.units)}),"  Disponible:"," ",i.jsx("b",{className:((G=S[te.productName])==null?void 0:G.remainingQty)>0?"text-green-700":"text-red-700",children:oa(((V=S[te.productName])==null?void 0:V.remainingQty)||0)})]})]}),i.jsx("div",{className:"text-gray-500 text-xs pt-0.10",children:Ve?"Cerrar":"Ver"})]}),Ve&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx(rd,{label:"Lb/Un Ingresadas",value:oa(((Z=S[te.productName])==null?void 0:Z.incomingQty)||0)}),i.jsx(rd,{label:"Lb/Un Disponibles",value:oa(((re=S[te.productName])==null?void 0:re.remainingQty)||0)}),i.jsx(rd,{label:"Fechas Venta",value:qe}),i.jsx(rd,{label:"Lb/Un Vendidas",value:oa(te.units)}),i.jsx(rd,{label:"Facturado al costo",value:Yr(te.cogs)}),i.jsx(rd,{label:"Monto Venta",value:Yr(te.revenue)}),i.jsx(rd,{label:"Utilidad bruta",value:Yr(te.profit),valueClass:te.profit>=0?"text-green-700 font-semibold":"text-red-700 font-semibold"})]})})]},te.productName)})})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(te=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:te.date}),i.jsx("td",{className:"border p-1",children:te.category}),i.jsx("td",{className:"border p-1",children:te.description}),i.jsx("td",{className:"border p-1",children:Yr(te.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${te.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:te.status})})]},te.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:H,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Gastos del periodo"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[c.length," registros"]})]}),i.jsx("div",{className:"text-gray-500",children:Re?"Cerrar":"Abrir"})]}),Re&&i.jsx("div",{className:"space-y-2 mt-3",children:c.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin gastos en el rango seleccionado."}):c.map(te=>{const Ve=!!de[te.id],qe=te.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>U(te.id),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:te.category}),i.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] ${qe}`,children:te.status})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[te.date,"  ",i.jsx("b",{children:Yr(te.amount)})]})]}),i.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:Ve?"Cerrar":"Ver"})]}),Ve&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsx(rd,{label:"Fecha",value:te.date}),i.jsx(rd,{label:"Categora",value:te.category}),i.jsx(rd,{label:"Descripcin",value:te.description||""}),i.jsx(rd,{label:"Monto",value:Yr(te.amount)}),i.jsx(rd,{label:"Estado",value:te.status||""})]})})]},te.id)})})]})]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:m.name}),i.jsx("button",{type:"button",onClick:()=>p(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras/Unidades"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"})]})}),i.jsx("tbody",{children:m.products.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin productos asociados."})}):m.products.map(te=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1",children:te.productName}),i.jsx("td",{className:"border p-1 text-center",children:oa(te.qty)}),i.jsx("td",{className:"border p-1 text-center",children:Yr(te.amount)}),i.jsx("td",{className:"border p-1 text-center",children:m.lastSaleDate||""})]},`${te.productName}-${te.measurement}`))})]})})]})})]})}function ss({title:t,value:e,positive:r,negative:n,valueClass:a,subtitle:s}){const o=a||(r?"text-[#568203]":n?"text-[#AB274F]":"");return i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),s?i.jsx("div",{className:"text-[11px] sm:text-[12px] text-gray-400",children:s}):null,i.jsx("div",{className:`text-[26px] sm:text-[30px] font-bold ${o}`,children:e})]})}function Gl({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[18px] sm:text-[20px] font-semibold",children:e})]})}function aH({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}function rd({label:t,value:e,valueClass:r}){return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:t}),i.jsx("div",{className:`text-sm mt-0.5 ${r||""}`,children:e})]})}const LC=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],hx=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function I3e(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[o,l]=g.useState(Mr(new Date,"yyyy-MM-dd")),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState("PENDIENTE"),[x,v]=g.useState(""),[y,b]=g.useState([]),[w,j]=g.useState(!0),[I,_]=g.useState(""),[S,E]=g.useState(null),[B,T]=g.useState(""),[P,O]=g.useState(""),[z,ce]=g.useState(""),[de,ue]=g.useState(0),[me,se]=g.useState("PENDIENTE"),[ke,Re]=g.useState(""),[F,H]=g.useState(!1),K=()=>H(le=>!le),[L,W]=g.useState(null),Y=le=>W($e=>$e===le?null:le);g.useEffect(()=>{(async()=>{j(!0),_("");try{const le=sr(yt(Ie,"expenses"),In("date","desc")),$e=await Ht(le),Xe=[];$e.forEach(it=>{const xt=it.data();Xe.push({id:it.id,date:xt.date||Mr(new Date,"yyyy-MM-dd"),category:xt.category||"",description:xt.description||"",amount:Number(xt.amount||0),status:xt.status||"PENDIENTE",notes:xt.notes||"",createdAt:xt.createdAt??vr.now()})}),b(Xe)}catch(le){console.error(le),_(" Error al cargar gastos")}finally{j(!1)}})()},[t]);const D=g.useMemo(()=>y.filter(le=>!(r&&le.date<r||a&&le.date>a)),[y,r,a]),Q=g.useMemo(()=>{const le=D.reduce((it,xt)=>it+(xt.amount||0),0),$e=D.filter(it=>it.status==="PAGADO").reduce((it,xt)=>it+(xt.amount||0),0),Xe=le-$e;return{total:le,pagado:$e,pendiente:Xe}},[D]),ee=()=>{l(Mr(new Date,"yyyy-MM-dd")),u(""),f(""),h(0),p("PENDIENTE"),v("")},ve=async le=>{if(le.preventDefault(),_(""),!c)return _("Selecciona una categora.");if(!d.trim())return _("Ingresa una descripcin.");if(!A||A<=0)return _("Ingresa un monto vlido.");try{const $e={date:o,category:c,description:d.trim(),amount:Number(Number(A||0).toFixed(2)),status:m,notes:x||"",createdAt:vr.now()},Xe=await Jn(yt(Ie,"expenses"),$e);b(it=>[{id:Xe.id,...$e},...it]),ee(),_(" Gasto registrado")}catch($e){console.error($e),_(" Error al guardar gasto")}},M=le=>{_(""),E(le.id),T(le.date),O(le.category||""),ce(le.description||""),ue(Number(le.amount||0)),se(le.status||"PENDIENTE"),Re(le.notes||"")},Ye=()=>{E(null),T(""),O(""),ce(""),ue(0),se("PENDIENTE"),Re("")},ae=async()=>{if(S){if(!P)return _("Selecciona una categora.");if(!z.trim())return _("Ingresa una descripcin.");if(!de||de<=0)return _("Ingresa un monto vlido.");try{const le={date:B,category:P,description:z.trim(),amount:Number(Number(de||0).toFixed(2)),status:me,notes:ke||""};await Fn(Zt(Ie,"expenses",S),le),b($e=>$e.map(Xe=>Xe.id===S?{...Xe,...le}:Xe)),Ye(),_(" Gasto actualizado")}catch(le){console.error(le),_(" Error al actualizar gasto")}}},X=async le=>{if(confirm(`Eliminar el gasto "${le.description}"?`))try{await Kn(Zt(Ie,"expenses",le.id)),b(Xe=>Xe.filter(it=>it.id!==le.id)),_(" Gasto borrado")}catch(Xe){console.error(Xe),_(" Error al borrar gasto")}},De=le=>le==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Gastos (Pollo)"}),i.jsx(Oc,{onClick:e,loading:w})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:le=>n(le.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:le=>s(le.target.value)})]})]}),i.jsxs("div",{className:"sm:ml-auto text-sm bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",hx(Q.total)]}),i.jsxs("div",{children:["Pagado: ",hx(Q.pagado)]}),i.jsxs("div",{children:["Pendiente: ",hx(Q.pendiente)]})]})]}),i.jsxs("div",{className:"md:hidden mb-4",children:[i.jsxs("button",{type:"button",onClick:K,className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white border rounded-2xl",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Crear gasto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha: ",o,"  Monto: ",A===0?"":hx(A)]})]}),i.jsx("div",{className:"text-gray-500",children:F?"":""})]}),F&&i.jsxs("form",{onSubmit:ve,className:"mt-3 bg-white p-4 rounded-2xl shadow-2xl border grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:le=>l(le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:le=>u(le.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(le=>i.jsx("option",{value:le,children:le},le))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:le=>f(le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:le=>{const $e=String(le.target.value||"").replace(",","."),Xe=parseFloat($e);h(Number.isFinite(Xe)?Math.max(0,Xe):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:le=>p(le.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:x,onChange:le=>v(le.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[x.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:ee,children:"Limpiar"})]})]})]}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("form",{onSubmit:ve,className:"bg-white p-4 rounded-2xl shadow-2xl border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:le=>l(le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:le=>u(le.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(le=>i.jsx("option",{value:le,children:le},le))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:le=>f(le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:le=>{const $e=String(le.target.value||"").replace(",","."),Xe=parseFloat($e);h(Number.isFinite(Xe)?Math.max(0,Xe):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:le=>p(le.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:x,onChange:le=>v(le.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[x.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:ee,children:"Limpiar"})]})]})}),i.jsx("div",{className:"block md:hidden space-y-3",children:w?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):D.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin gastos en el rango seleccionado."}):D.map(le=>{const $e=L===le.id,Xe=S===le.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full text-left px-3 py-3 flex items-start justify-between bg-white",onClick:()=>Y(le.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:le.description}),i.jsxs("div",{className:"text-xs text-gray-500",children:[le.category||"","  ",le.date]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold",children:hx(le.amount)}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${De(le.status)}`,children:le.status})]})]}),$e&&i.jsxs("div",{className:"p-3",children:[i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:le.notes?le.notes:""}),Xe?i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm",children:[i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:it=>T(it.target.value)}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:it=>O(it.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(it=>i.jsx("option",{value:it,children:it},it))]}),i.jsx("input",{className:"w-full border p-2 rounded",value:z,onChange:it=>ce(it.target.value)}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(de)?"":de,onChange:it=>{const xt=String(it.target.value||"").replace(",","."),jt=parseFloat(xt);ue(Number.isFinite(jt)?Math.max(0,jt):0)}}),i.jsxs("select",{className:"w-full border p-2 rounded",value:me,onChange:it=>se(it.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:ke,onChange:it=>Re(it.target.value),maxLength:500}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ae,children:"Guardar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Ye,children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>M(le),children:"Editar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>X(le),children:"Borrar"})]})]})]},le.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded-2xl shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):D.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):D.map(le=>{const $e=S===le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:$e?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:Xe=>T(Xe.target.value)}):le.date}),i.jsx("td",{className:"p-2 border",children:$e?i.jsxs("select",{className:"w-full border p-1 rounded",value:P,onChange:Xe=>O(Xe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),LC.map(Xe=>i.jsx("option",{value:Xe,children:Xe},Xe))]}):le.category||""}),i.jsx("td",{className:"p-2 border",children:$e?i.jsx("input",{className:"w-full border p-1 rounded",value:z,onChange:Xe=>ce(Xe.target.value)}):i.jsx("span",{title:le.description,children:le.description.length>45?le.description.slice(0,45)+"":le.description})}),i.jsx("td",{className:"p-2 border",children:$e?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(de)?"":de,onChange:Xe=>{const it=String(Xe.target.value||"").replace(",","."),xt=parseFloat(it);ue(Number.isFinite(xt)?Math.max(0,xt):0)}}):hx(le.amount)}),i.jsx("td",{className:"p-2 border",children:$e?i.jsxs("select",{className:"w-full border p-1 rounded",value:me,onChange:Xe=>se(Xe.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${De(le.status)}`,children:le.status})}),i.jsx("td",{className:"p-2 border",children:$e?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:ke,onChange:Xe=>Re(Xe.target.value),maxLength:500}):i.jsx("span",{title:le.notes||"",children:(le.notes||"").length>45?(le.notes||"").slice(0,45)+"":le.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:$e?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ae,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ye,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>M(le),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>X(le),children:"Borrar"})]})})})]},le.id)})})]})}),I&&i.jsx("p",{className:"mt-2 text-sm",children:I})]})}function MS(t){return(t||"").trim().toLowerCase()}async function ine(){const t=await Ht(yt(Ie,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),a=MS(n.name??n.productName);a&&e.set(a,r.id)}),e}async function j3e(t=!1){const e=await ine(),r=await Ht(yt(Ie,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const a of r.docs){n.checked++;const s=a.data(),o=MS(s.productName);if(!o){n.missingName++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"withoutMatch"});continue}if(s.productId===l){n.alreadyOk++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"alreadyOk"});continue}t||await Fn(Zt(Ie,"inventory_batches",a.id),{productId:l}),n.fixed++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function P3e(t,e=!1){const r=MS(t),a=(await ine()).get(r);if(!a)throw new Error(`No existe un producto activo con nombre "${t}".`);const s=await Ht(yt(Ie,"inventory_batches"));let o=0;for(const l of s.docs){const c=l.data();MS(c.productName)===r&&c.productId!==a&&(e||await Fn(Zt(Ie,"inventory_batches",l.id),{productId:a}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function B3e(){const[t,e]=g.useState(!1),[r,n]=g.useState(""),a=async()=>{try{e(!0),n("");const c=await j3e(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[s,o]=g.useState(""),l=async()=>{if(!s.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await P3e(s.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${s}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:s,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const Nu=t=>`C$${Number(t||0).toFixed(2)}`,Ax=t=>Number(t||0).toFixed(3),T3e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),_5=()=>{const t=new Date;return Mr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},UC=()=>Mr(new Date,"yyyy-MM-dd");function k3e({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState(_5()),[o,l]=g.useState(UC()),[c,u]=g.useState(""),d=g.useMemo(()=>{const Ne=new Map;return n.forEach(be=>Ne.set(be.productId,{id:be.productId,name:be.productName})),Array.from(Ne.values()).sort((be,Ce)=>be.name.localeCompare(Ce.name))},[n]),f=g.useMemo(()=>n.filter(Ne=>!(a&&Ne.date<a||o&&Ne.date>o||c&&Ne.productId!==c)),[n,a,o,c]),[A,h]=g.useState(UC()),[m,p]=g.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,v]=g.useState(""),[y,b]=g.useState([]);g.useEffect(()=>{b(Ne=>{const be=Ne.filter(Ce=>f.some(Le=>Le.id===Ce));return be.length===0&&f.length>0?f.map(Ce=>Ce.id):be})},[f]);const[w,j]=g.useState([]),[I,_]=g.useState([]),[S,E]=g.useState(!1),[B,T]=g.useState(_5()),[P,O]=g.useState(UC());g.useEffect(()=>{(async()=>{try{E(!0);const Ne=sr(yt(Ie,"expenses"),In("date","desc")),be=await Ht(Ne),Ce=[];be.forEach(Le=>{const Ae=Le.data();Ce.push({id:Le.id,date:Ae.date,description:Ae.description,amount:Number(Ae.amount||0)})}),j(Ce)}catch(Ne){console.error(Ne)}finally{E(!1)}})()},[]);const z=g.useMemo(()=>w.filter(Ne=>!(!Ne.date||B&&Ne.date<B||P&&Ne.date>P)),[w,B,P]),[ce,de]=g.useState([]),[ue,me]=g.useState(!1),[se,ke]=g.useState(""),[Re,F]=g.useState("DEBITO"),[H,K]=g.useState(""),L=()=>{const Ne=Number(H);!se.trim()||!isFinite(Ne)||Ne<=0||(de(be=>[...be,{id:`${Date.now()}_${be.length+1}`,description:se.trim(),type:Re,amount:Number(Ne.toFixed(2))}]),ke(""),K(""))},[W,Y]=g.useState(null),[D,Q]=g.useState(""),[ee,ve]=g.useState("DEBITO"),[M,Ye]=g.useState(""),ae=Ne=>{Y(Ne.id),Q(Ne.description),ve(Ne.type),Ye(Ne.amount.toFixed(2))},X=()=>{Y(null),Q(""),ve("DEBITO"),Ye("")},De=()=>{if(!W)return;const Ne=Number(M);!isFinite(Ne)||Ne<=0||(de(be=>be.map(Ce=>Ce.id===W?{...Ce,description:D.trim(),type:ee,amount:Number(Ne.toFixed(2))}:Ce)),X())},le=Ne=>{de(be=>be.filter(Ce=>Ce.id!==Ne)),W===Ne&&X()},$e=(Ne,be)=>{b(Ce=>be?[...new Set([...Ce,Ne])]:Ce.filter(Le=>Le!==Ne))},Xe=Ne=>{b(Ne?f.map(be=>be.id):[])},it=(Ne,be)=>{_(Ce=>be?[...new Set([...Ce,Ne])]:Ce.filter(Le=>Le!==Ne))},xt=g.useMemo(()=>f.filter(Ne=>y.includes(Ne.id)),[f,y]),jt=g.useMemo(()=>ce.filter(Ne=>Ne.type==="DEBITO").reduce((Ne,be)=>Ne+be.amount,0),[ce]),Mt=g.useMemo(()=>ce.filter(Ne=>Ne.type==="CREDITO").reduce((Ne,be)=>Ne+be.amount,0),[ce]),Ft=g.useMemo(()=>{let Ne=0,be=0,Ce=0,Le=0;for(const ct of xt){T3e(ct.unit)?Ne+=Number(ct.quantity||0):be+=Number(ct.quantity||0);const _t=ct.expectedTotal??Number((Number(ct.quantity||0)*Number(ct.salePrice||0)).toFixed(2)),pe=ct.invoiceTotal!==void 0&&ct.invoiceTotal!==null?Number(ct.invoiceTotal):Number((Number(ct.quantity||0)*Number(ct.purchasePrice||0)).toFixed(2));Ce+=Number(_t||0),Le+=Number(pe||0)}const Ae=z.filter(ct=>I.includes(ct.id)).reduce((ct,_t)=>ct+Number(_t.amount||0),0),We=Ce-Ae-jt+Mt;return{totalLbs:Ne,totalUnits:be,totalExpected:Number(Ce.toFixed(2)),totalInvoiced:Number(Le.toFixed(2)),totalGastos:Number(Ae.toFixed(2)),debits:Number(jt.toFixed(2)),credits:Number(Mt.toFixed(2)),finalAmount:Number(We.toFixed(2)),grossProfit:Number((Ce-Le).toFixed(2))}},[xt,z,I,jt,Mt]),[$t,kt]=g.useState(!1),[Ge,ie]=g.useState(""),Ue=async()=>{if(ie(""),xt.length===0){ie("Selecciona al menos 1 lote pagado.");return}try{kt(!0);const Ne={number:m.trim(),date:A,description:x.trim(),status:"PENDIENTE",createdAt:vr.now(),totalLbs:Number(Ax(Ft.totalLbs)),totalUnits:Number(Ax(Ft.totalUnits)),totalAmount:Ft.totalExpected,invoiceTotal:Ft.totalInvoiced,totalExpenses:Ft.totalGastos,totalDebits:Ft.debits,totalCredits:Ft.credits,finalAmount:Ft.finalAmount,batches:xt.map(be=>{var Ce;return{id:be.id,productId:be.productId,productName:be.productName,unit:be.unit,quantity:Number(Ax(be.quantity)),salePrice:Number(Number(be.salePrice||0).toFixed(2)),purchasePrice:Number(Number(be.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(be.quantity||0)*Number(be.salePrice||0)).toFixed(2)),invoiceTotal:be.invoiceTotal!==void 0&&be.invoiceTotal!==null?Number(be.invoiceTotal):Number((Number(be.quantity||0)*Number(be.purchasePrice||0)).toFixed(2)),batchDate:be.date,paidAt:(Ce=be.paidAt)!=null&&Ce.toDate?Mr(be.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:z.filter(be=>I.includes(be.id)).map(be=>({id:be.id,date:be.date||null,description:be.description||"",amount:Number(Number(be.amount||0).toFixed(2))})),adjustments:ce.map(be=>({id:be.id,description:be.description,type:be.type,amount:Number(be.amount.toFixed(2))}))};await Jn(yt(Ie,"invoices"),Ne),ie(" Factura creada."),r()}catch(Ne){console.error(Ne),ie(` Error al crear factura: ${(Ne==null?void 0:Ne.message)||"desconocido"}`)}finally{kt(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:A,onChange:Ne=>h(Ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:Ne=>p(Ne.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:Ne=>v(Ne.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Ne=>s(Ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:Ne=>l(Ne.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:Ne=>u(Ne.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),d.map(Ne=>i.jsx("option",{value:Ne.id,children:Ne.name},Ne.id))]})]}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{s(_5()),l(UC()),u("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:f.length>0&&y.length===f.length,onChange:Ne=>Xe(Ne.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),f.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha lote"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),i.jsx("tbody",{children:f.map(Ne=>{var We;const be=y.includes(Ne.id),Ce=Ne.expectedTotal??Number((Number(Ne.quantity||0)*Number(Ne.salePrice||0)).toFixed(2)),Le=Ne.invoiceTotal!==void 0&&Ne.invoiceTotal!==null?Number(Ne.invoiceTotal):Number((Number(Ne.quantity||0)*Number(Ne.purchasePrice||0)).toFixed(2)),Ae=Ce-Le;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:be,onChange:ct=>$e(Ne.id,ct.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Ne.date}),i.jsx("td",{className:"p-2 border",children:Ne.productName}),i.jsx("td",{className:"p-2 border",children:(Ne.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Ax(Ne.quantity)}),i.jsx("td",{className:"p-2 border",children:Nu(Ne.salePrice)}),i.jsx("td",{className:"p-2 border",children:Nu(Le)}),i.jsx("td",{className:"p-2 border",children:Nu(Ce)}),i.jsx("td",{className:"p-2 border",children:Nu(Ae)}),i.jsx("td",{className:"p-2 border",children:(We=Ne.paidAt)!=null&&We.toDate?Mr(Ne.paidAt.toDate(),"yyyy-MM-dd"):""})]},Ne.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),S&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:B,onChange:Ne=>T(Ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:P,onChange:Ne=>O(Ne.target.value)})]})]})]}),z.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:z.map(Ne=>{const be=I.includes(Ne.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:be,onChange:Ce=>it(Ne.id,Ce.target.checked)})}),i.jsx("td",{className:"p-2 border",children:Ne.date||""}),i.jsx("td",{className:"p-2 border",children:Ne.description||""}),i.jsx("td",{className:"p-2 border",children:Nu(Number(Ne.amount||0))})]},Ne.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>me(!0),children:"Crear Cargo"})]}),ce.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ce.map(Ne=>{const be=W===Ne.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:D,onChange:Ce=>Q(Ce.target.value)}):i.jsx("span",{title:Ne.description,children:Ne.description.length>60?`${Ne.description.slice(0,60)}`:Ne.description})}),i.jsx("td",{className:"p-2 border",children:be?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ee,onChange:Ce=>ve(Ce.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ne.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:Ne.type})}),i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:M,onChange:Ce=>Ye(Ce.target.value)}):Nu(Ne.amount)}),i.jsx("td",{className:"p-2 border",children:be?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:De,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:X,children:"Cancelar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>le(Ne.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>ae(Ne),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>le(Ne.id),children:"Eliminar"})]})})]},Ne.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:Ax(Ft.totalLbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:Ax(Ft.totalUnits)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:Nu(Ft.totalInvoiced)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:Nu(Ft.totalExpected)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:Nu(Ft.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Nu(Ft.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Nu(Ft.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Nu(Ft.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:Nu(Ft.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:$t,onClick:Ue,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:$t?"Creando":"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Ge&&i.jsx("span",{className:"text-sm ml-2",children:Ge})]}),$t&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),ue&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{type:"button",className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>me(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:se,onChange:Ne=>ke(Ne.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Re,onChange:Ne=>F(Ne.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:H,onChange:Ne=>K(Ne.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:L,children:"Agregar"})})]})]})})]})}const nd=t=>`C$ ${Number(t||0).toFixed(2)}`,Hc=t=>Number(t||0).toFixed(3),F3e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function O3e(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(!1),[o,l]=g.useState(null),[c,u]=g.useState(Mr(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[d,f]=g.useState(Mr(new Date,"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(!1),{refreshKey:x,refresh:v}=Dc(),[y,b]=g.useState(!1),w=()=>b(O=>!O),[j,I]=g.useState(null),_=O=>I(z=>z===O?null:O);g.useEffect(()=>{(async()=>{n(!0);const O=sr(yt(Ie,"inventory_batches"),mr("status","==","PAGADO"),In("date","desc")),z=await Ht(O),ce=[];z.forEach(de=>{const ue=de.data(),me=Number(ue.quantity||0),se=Number(ue.remaining||0),ke=Number(ue.purchasePrice||0),Re=Number(ue.salePrice||0),F=Number((me*ke).toFixed(2)),H=Number((me*Re).toFixed(2));ce.push({id:de.id,productId:ue.productId,productName:ue.productName,category:ue.category,unit:ue.unit,quantity:me,remaining:se,purchasePrice:ke,salePrice:Re,invoiceTotal:ue.invoiceTotal!=null?Number(ue.invoiceTotal):F,expectedTotal:ue.expectedTotal!=null?Number(ue.expectedTotal):H,date:ue.date,status:ue.status,paidAt:ue.paidAt})}),e(ce),n(!1)})()},[x]);const S=g.useMemo(()=>t.filter(O=>!(c&&O.date<c||d&&O.date>d||A&&O.productId!==A)),[t,c,d,A]),E=g.useMemo(()=>{let O=0,z=0,ce=0,de=0,ue=0,me=0;for(const se of S)F3e(se.unit)?(O+=se.quantity,z+=se.remaining):(ce+=se.quantity,de+=se.remaining),ue+=Number(se.expectedTotal||0),me+=Number(se.invoiceTotal||0);return{lbsIng:O,lbsRem:z,udsIng:ce,udsRem:de,totalEsperado:ue,totalFact:me,gross:ue-me}},[S]),B=O=>{l(O),s(!0)},T=async()=>{if(o)try{const O=Zt(Ie,"inventory_batches",o.id);await Fn(O,{status:"PENDIENTE",remaining:o.quantity});const z=yt(Ie,"salesV2"),ce=await Ht(sr(z,mr("batchId","==",o.id))),de=await Ht(sr(z,mr("productName","==",o.productName),mr("date","==",o.date))),ue=[...ce.docs,...de.docs];for(const me of ue)await Kn(Zt(Ie,"salesV2",me.id));s(!1),l(null),v()}catch(O){console.error("Error al marcar pendiente:",O)}},P=g.useMemo(()=>{const O=new Map;return t.forEach(z=>O.set(z.productId,{id:z.productId,name:z.productName})),Array.from(O.values()).sort((z,ce)=>z.name.localeCompare(ce.name))},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(Oc,{onClick:v,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:O=>u(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:O=>f(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:O=>h(O.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),P.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]})]}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"})]}),i.jsx("button",{type:"button",className:"sm:ml-auto px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"md:hidden",children:[i.jsxs("button",{type:"button",onClick:w,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Totales"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Libras: ",i.jsx("b",{children:Hc(E.lbsIng)}),"  Restantes:"," ",i.jsx("b",{children:Hc(E.lbsRem)})]})]}),i.jsx("div",{className:"text-gray-500",children:y?"":""})]}),y&&i.jsx("div",{className:"mt-3 bg-gray-50 p-3 rounded-2xl shadow-2xl border text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Hc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Hc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",nd(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Hc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Hc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",nd(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",nd(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"hidden md:block bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Hc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Hc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",nd(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Hc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Hc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",nd(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",nd(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:r?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):S.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin lotes pagados"}):S.map(O=>{var ce;const z=j===O.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>_(O.id),className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:O.productName}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[(O.category||"").toUpperCase(),"  ",O.date," "," ",(O.unit||"").toUpperCase()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-bold",children:nd(O.expectedTotal||0)}),i.jsx("div",{className:"text-[11px] text-gray-500",children:z?"Detalles":"Esperado"})]})]}),z&&i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ingresado"}),i.jsx("div",{className:"font-semibold",children:Hc(O.quantity)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:Hc(O.remaining)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Costo"}),i.jsx("div",{className:"font-semibold",children:nd(O.invoiceTotal||0)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Fecha pago"}),i.jsx("div",{className:"font-semibold",children:(ce=O.paidAt)!=null&&ce.toDate?Mr(O.paidAt.toDate(),"yyyy-MM-dd"):""})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(O),children:"Marcar PENDIENTE"})})]})]},O.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):S.map(O=>{var z;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:(O.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:O.productName}),i.jsx("td",{className:"p-2 border",children:(O.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Hc(O.quantity)}),i.jsx("td",{className:"p-2 border",children:Hc(O.remaining)}),i.jsx("td",{className:"p-2 border",children:nd(O.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:nd(O.salePrice)}),i.jsx("td",{className:"p-2 border",children:nd(O.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:nd(O.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(z=O.paidAt)!=null&&z.toDate?Mr(O.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(O),children:"Marcar PENDIENTE"})})]},O.id)})})]})}),m&&i.jsx(k3e,{paidBatches:t,onClose:()=>p(!1),onCreated:()=>p(!1)}),a&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-xl",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:T,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded-xl",children:"Confirmar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var LS={};LS.version="0.18.5";var one=1252,D3e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],q6={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},z6=function(t){D3e.indexOf(t)!=-1&&(one=q6[0]=t)};function R3e(){z6(1252)}var ff=function(t){z6(t)};function W6(){ff(1200),R3e()}function sH(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function M3e(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function lne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var zy=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?M3e(t.slice(2)):e==254&&r==255?lne(t.slice(2)):e==65279?t.slice(1):t},QC=function(e){return String.fromCharCode(e)},iH=function(e){return String.fromCharCode(e)},j2,W0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function P2(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,a=t.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),e+=W0.charAt(s)+W0.charAt(o)+W0.charAt(l)+W0.charAt(c);return e}function Hu(t){var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=W0.indexOf(t.charAt(u++)),o=W0.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),l=W0.indexOf(t.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=W0.indexOf(t.charAt(u++)),a=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var ea=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),DA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Sm(t){return ea?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function oH(t){return ea?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Pu=function(e){return ea?DA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function iP(t){if(typeof ArrayBuffer>"u")return Pu(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Um(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function L3e(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function X6(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return X6(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Jo=ea?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:DA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function U3e(t){for(var e=[],r=0,n=t.length+250,a=Sm(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Sm(65535),n=65530)}return e.push(a.slice(0,r)),Jo(e)}var Pc=/\u0000/g,Wy=/[\u0001-\u0006]/g;function mv(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function hf(t,e){var r=""+t;return r.length>=e?r:_i("0",e-r.length)+r}function Y6(t,e){var r=""+t;return r.length>=e?r:_i(" ",e-r.length)+r}function US(t,e){var r=""+t;return r.length>=e?r:r+_i(" ",e-r.length)}function Q3e(t,e){var r=""+Math.round(t);return r.length>=e?r:_i("0",e-r.length)+r}function V3e(t,e){var r=""+t;return r.length>=e?r:_i("0",e-r.length)+r}var lH=Math.pow(2,32);function mx(t,e){if(t>lH||t<-lH)return Q3e(t,e);var r=Math.round(t);return V3e(r,e)}function QS(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var cH=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],E5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function H3e(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var kn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},uH={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$3e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function VS(t,e,r){for(var n=t<0?-1:1,a=t*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<e&&(f=Math.floor(a),l=f*o+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=u,u=d;if(d>e&&(u>e?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var A=Math.floor(n*l/d);return[A,n*l-A*d,d]}function Ep(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),s=0,o=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=X3e(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var cne=new Date(1899,11,31,0,0,0),G3e=cne.getTime(),K3e=new Date(1900,2,1,0,0,0);function une(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=K3e&&(r+=24*60*60*1e3),(r-(G3e+(t.getTimezoneOffset()-cne.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function J6(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function q3e(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function z3e(t){var e=t<0?12:11,r=J6(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function W3e(t){var e=J6(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function B2(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=z3e(t):e===10?r=t.toFixed(10).substr(0,12):r=W3e(t),J6(q3e(r.toUpperCase()))}function fg(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):B2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Od(14,une(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function X3e(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Y3e(t,e,r,n){var a="",s=0,o=0,l=r.y,c,u=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return E5[r.m-1][1];case 5:return E5[r.m-1][0];default:return E5[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return cH[r.q][0];default:return cH[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?hf(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=hf(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?hf(c,u):"";return d}function X0(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var dne=/%/g;function J3e(t,e,r){var n=e.replace(dne,""),a=e.length-n.length;return oA(t,n,r*Math.pow(10,2*a))+_i("%",a)}function Z3e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return oA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function fne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var hne=/# (\?+)( ?)\/( ?)(\d+)/;function e4e(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?_i(" ",t[1].length+1+t[4].length):Y6(o,t[1].length)+t[2]+"/"+t[3]+hf(l,t[4].length))}function t4e(t,e,r){return r+(e===0?"":""+e)+_i(" ",t[1].length+2+t[4].length)}var Ane=/^#*0*\.([0#]+)/,mne=/\).*[0#]/,pne=/\(###\) ###\\?-####/;function wc(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function dH(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function fH(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function r4e(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function n4e(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function cd(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cd("n",n,r):"("+cd("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Z3e(t,e,r);if(e.indexOf("%")!==-1)return J3e(t,e,r);if(e.indexOf("E")!==-1)return fne(e,r);if(e.charCodeAt(0)===36)return"$"+cd(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+mx(c,e.length);if(e.match(/^[#?]+$/))return a=mx(r,0),a==="0"&&(a=""),a.length>e.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(hne))return e4e(s,c,u);if(e.match(/^#+0+$/))return u+mx(c,e.length-e.indexOf("0"));if(s=e.match(Ane))return a=dH(r,s[1].length).replace(/^([^\.]+)$/,"$1."+wc(s[1])).replace(/\.$/,"."+wc(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+_i("0",wc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+dH(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+X0(mx(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cd(t,e,-r):X0(""+(Math.floor(r)+r4e(r,s[1].length)))+"."+hf(fH(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return cd(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=mv(cd(t,e.replace(/[\\-]/g,""),r)),o=0,mv(mv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(pne))return a=cd(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=VS(c,Math.pow(10,o)-1,!1),a=""+u,d=oA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=US(l[2],o),d.length<s[4].length&&(d=wc(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=VS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Y6(l[1],o)+s[2]+"/"+s[3]+US(l[2],o):_i(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=mx(r,0),e.length<=a.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return wc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=fH(r,s[1].length),r<0?"-"+cd(t,e,-r):X0(n4e(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hf(0,3-m.length):"")+m})+"."+hf(o,s[1].length);switch(e){case"###,##0.00":return cd(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=X0(mx(c,0));return h!=="0"?u+h:"";case"###,###.00":return cd(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return cd(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function a4e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return oA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function s4e(t,e,r){var n=e.replace(dne,""),a=e.length-n.length;return oA(t,n,r*Math.pow(10,2*a))+_i("%",a)}function gne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Hf(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hf("n",n,r):"("+Hf("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return a4e(t,e,r);if(e.indexOf("%")!==-1)return s4e(t,e,r);if(e.indexOf("E")!==-1)return gne(e,r);if(e.charCodeAt(0)===36)return"$"+Hf(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+hf(c,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(hne))return t4e(s,c,u);if(e.match(/^#+0+$/))return u+hf(c,e.length-e.indexOf("0"));if(s=e.match(Ane))return a=(""+r).replace(/^([^\.]+)$/,"$1."+wc(s[1])).replace(/\.$/,"."+wc(s[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+_i("0",wc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+X0(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hf(t,e,-r):X0(""+r)+"."+_i("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Hf(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=mv(Hf(t,e.replace(/[\\-]/g,""),r)),o=0,mv(mv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(pne))return a=Hf(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=VS(c,Math.pow(10,o)-1,!1),a=""+u,d=oA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=US(l[2],o),d.length<s[4].length&&(d=wc(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=VS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Y6(l[1],o)+s[2]+"/"+s[3]+US(l[2],o):_i(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:wc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return wc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Hf(t,e,-r):X0(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hf(0,3-m.length):"")+m})+"."+hf(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=X0(""+c);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return Hf(t,e.slice(0,e.lastIndexOf(".")),r)+wc(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function oA(t,e,r){return(r|0)===r?Hf(t,e,r):cd(t,e,r)}function i4e(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var xne=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function x1(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":QS(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(xne))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function o4e(t,e,r,n){for(var a=[],s="",o=0,l="",c="t",u,d,f,A="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!QS(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=Ep(e,r,t.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Ep(e,r),u==null))return"";for(s=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=A),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=Ep(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",A="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,A="h"):t.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,A="h"):(p.t="t",++o),u==null&&p.t==="T")return"";a[a.length]=p,c=l;break;case"[":for(s=l;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(xne)){if(u==null&&(u=Ep(e,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",x1(t)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<t.length&&(l=t.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;t.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var x=0,v=0,y;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=A,c="h",x<1&&(x=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[o].v.match(/[Hh]/)&&(x=1),x<2&&a[o].v.match(/[Mm]/)&&(x=2),x<3&&a[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",w;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=Y3e(a[o].t.charCodeAt(0),a[o].v,u,v),a[o].t="t";break;case"n":case"?":for(w=o+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[o].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[o].v,o=w-1;break;case"G":a[o].t="t",a[o].v=fg(e,r);break}var j="",I,_;if(b.length>0){b.charCodeAt(0)==40?(I=e<0&&b.charCodeAt(0)===45?-e:e,_=oA("n",b,I)):(I=e<0&&n>1?-e:e,_=oA("n",b,I),I<0&&a[0]&&a[0].t=="t"&&(_=_.substr(1),a[0].v="-"+a[0].v)),w=_.length-1;var S=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){S=o;break}var E=a.length;if(S===a.length&&_.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(w>=a[o].v.length-1?(w-=a[o].v.length,a[o].v=_.substr(w+1,a[o].v.length)):w<0?a[o].v="":(a[o].v=_.substr(0,w+1),w=-1),a[o].t="t",E=o);w>=0&&E<a.length&&(a[E].v=_.substr(0,w+1)+a[E].v)}else if(S!==a.length&&_.indexOf("E")===-1){for(w=_.indexOf(".")-1,o=S;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")-1:a[o].v.length-1,j=a[o].v.substr(d+1);d>=0;--d)w>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(j=_.charAt(w--)+j);a[o].v=j,a[o].t="t",E=o}for(w>=0&&E<a.length&&(a[E].v=_.substr(0,w+1)+a[E].v),w=_.indexOf(".")+1,o=S;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==S)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")+1:0,j=a[o].v.substr(0,d);d<a[o].v.length;++d)w<_.length&&(j+=_.charAt(w++));a[o].v=j,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(I=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=oA(a[o].t,a[o].v,I),a[o].t="t");var B="";for(o=0;o!==a.length;++o)a[o]!=null&&(B+=a[o].v);return B}var hH=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function AH(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function l4e(t,e){var r=i4e(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(hH),l=r[1].match(hH);return AH(e,o)?[n,r[0]]:AH(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Od(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:kn)[t],n==null&&(n=r.table&&r.table[uH[t]]||kn[uH[t]]),n==null&&(n=$3e[t]||"General");break}if(QS(n,0))return fg(e,r);e instanceof Date&&(e=une(e,r.date1904));var a=l4e(n,e);if(QS(a[1]))return fg(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return o4e(a[1],e,r,a[0])}function lA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(kn[r]==null){e<0&&(e=r);continue}if(kn[r]==t){e=r;break}}e<0&&(e=391)}return kn[e]=t,e}function oP(t){for(var e=0;e!=392;++e)t[e]!==void 0&&lA(t[e],e)}function v1(){kn=H3e()}var c4e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vne=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function u4e(t){var e=typeof t=="number"?kn[t]:t;return e=e.replace(vne,"(\\d+)"),new RegExp("^"+e+"$")}function d4e(t,e,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(vne)||[]).forEach(function(f,A){var h=parseInt(r[A+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var f4e=function(){var t={};t.version="1.2.0";function e(){for(var _=0,S=new Array(256),E=0;E!=256;++E)_=E,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,S[E]=_;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(_){var S=0,E=0,B=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)T[B]=_[B];for(B=0;B!=256;++B)for(E=_[B],S=256+B;S<4096;S+=256)E=T[S]=E>>>8^_[E&255];var P=[];for(B=1;B!=16;++B)P[B-1]=typeof Int32Array<"u"?T.subarray(B*256,B*256+256):T.slice(B*256,B*256+256);return P}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],A=a[7],h=a[8],m=a[9],p=a[10],x=a[11],v=a[12],y=a[13],b=a[14];function w(_,S){for(var E=S^-1,B=0,T=_.length;B<T;)E=E>>>8^r[(E^_.charCodeAt(B++))&255];return~E}function j(_,S){for(var E=S^-1,B=_.length-15,T=0;T<B;)E=b[_[T++]^E&255]^y[_[T++]^E>>8&255]^v[_[T++]^E>>16&255]^x[_[T++]^E>>>24]^p[_[T++]]^m[_[T++]]^h[_[T++]]^A[_[T++]]^f[_[T++]]^d[_[T++]]^u[_[T++]]^c[_[T++]]^l[_[T++]]^o[_[T++]]^s[_[T++]]^r[_[T++]];for(B+=15;T<B;)E=E>>>8^r[(E^_[T++])&255];return~E}function I(_,S){for(var E=S^-1,B=0,T=_.length,P=0,O=0;B<T;)P=_.charCodeAt(B++),P<128?E=E>>>8^r[(E^P)&255]:P<2048?(E=E>>>8^r[(E^(192|P>>6&31))&255],E=E>>>8^r[(E^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,O=_.charCodeAt(B++)&1023,E=E>>>8^r[(E^(240|P>>8&7))&255],E=E>>>8^r[(E^(128|P>>2&63))&255],E=E>>>8^r[(E^(128|O>>6&15|(P&3)<<4))&255],E=E>>>8^r[(E^(128|O&63))&255]):(E=E>>>8^r[(E^(224|P>>12&15))&255],E=E>>>8^r[(E^(128|P>>6&63))&255],E=E>>>8^r[(E^(128|P&63))&255]);return~E}return t.table=r,t.bstr=w,t.buf=j,t.str=I,t}(),_n=function(){var e={};e.version="1.2.1";function r(G,V){for(var Z=G.split("/"),re=V.split("/"),we=0,Fe=0,st=Math.min(Z.length,re.length);we<st;++we){if(Fe=Z[we].length-re[we].length)return Fe;if(Z[we]!=re[we])return Z[we]<re[we]?-1:1}return Z.length-re.length}function n(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:n(G.slice(0,-1));var V=G.lastIndexOf("/");return V===-1?G:G.slice(0,V+1)}function a(G){if(G.charAt(G.length-1)=="/")return a(G.slice(0,-1));var V=G.lastIndexOf("/");return V===-1?G:G.slice(V+1)}function s(G,V){typeof V=="string"&&(V=new Date(V));var Z=V.getHours();Z=Z<<6|V.getMinutes(),Z=Z<<5|V.getSeconds()>>>1,G.write_shift(2,Z);var re=V.getFullYear()-1980;re=re<<4|V.getMonth()+1,re=re<<5|V.getDate(),G.write_shift(2,re)}function o(G){var V=G.read_shift(2)&65535,Z=G.read_shift(2)&65535,re=new Date,we=Z&31;Z>>>=5;var Fe=Z&15;Z>>>=4,re.setMilliseconds(0),re.setFullYear(Z+1980),re.setMonth(Fe-1),re.setDate(we);var st=V&31;V>>>=5;var Be=V&63;return V>>>=6,re.setHours(V),re.setMinutes(Be),re.setSeconds(st<<1),re}function l(G){_l(G,0);for(var V={},Z=0;G.l<=G.length-4;){var re=G.read_shift(2),we=G.read_shift(2),Fe=G.l+we,st={};switch(re){case 21589:Z=G.read_shift(1),Z&1&&(st.mtime=G.read_shift(4)),we>5&&(Z&2&&(st.atime=G.read_shift(4)),Z&4&&(st.ctime=G.read_shift(4))),st.mtime&&(st.mt=new Date(st.mtime*1e3));break}G.l=Fe,V[re]=st}return V}var c;function u(){return c||(c={})}function d(G,V){if(G[0]==80&&G[1]==75)return Ee(G,V);if((G[0]|32)==109&&(G[1]|32)==105)return Me(G,V);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var Z=3,re=512,we=0,Fe=0,st=0,Be=0,at=0,lt=[],dt=G.slice(0,512);_l(dt,0);var Pt=f(dt);switch(Z=Pt[0],Z){case 3:re=512;break;case 4:re=4096;break;case 0:if(Pt[1]==0)return Ee(G,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}re!==512&&(dt=G.slice(0,re),_l(dt,28));var he=G.slice(0,re);A(dt,Z);var ze=dt.read_shift(4,"i");if(Z===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);dt.l+=4,st=dt.read_shift(4,"i"),dt.l+=4,dt.chk("00100000","Mini Stream Cutoff Size: "),Be=dt.read_shift(4,"i"),we=dt.read_shift(4,"i"),at=dt.read_shift(4,"i"),Fe=dt.read_shift(4,"i");for(var nt=-1,ne=0;ne<109&&(nt=dt.read_shift(4,"i"),!(nt<0));++ne)lt[ne]=nt;var He=h(G,re);x(at,Fe,He,re,lt);var pt=y(He,st,lt,re);pt[st].name="!Directory",we>0&&Be!==O&&(pt[Be].name="!MiniFAT"),pt[lt[0]].name="!FAT",pt.fat_addrs=lt,pt.ssz=re;var Dt={},rr=[],zt=[],Ot=[];b(st,pt,He,rr,we,Dt,zt,Be),m(zt,Ot,rr),rr.shift();var lr={FileIndex:zt,FullPaths:Ot};return V&&V.raw&&(lr.raw={header:he,sectors:He}),lr}function f(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(z,"Header Signature: "),G.l+=16;var V=G.read_shift(2,"u");return[G.read_shift(2,"u"),V]}function A(G,V){var Z=9;switch(G.l+=2,Z=G.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function h(G,V){for(var Z=Math.ceil(G.length/V)-1,re=[],we=1;we<Z;++we)re[we-1]=G.slice(we*V,(we+1)*V);return re[Z-1]=G.slice(Z*V),re}function m(G,V,Z){for(var re=0,we=0,Fe=0,st=0,Be=0,at=Z.length,lt=[],dt=[];re<at;++re)lt[re]=dt[re]=re,V[re]=Z[re];for(;Be<dt.length;++Be)re=dt[Be],we=G[re].L,Fe=G[re].R,st=G[re].C,lt[re]===re&&(we!==-1&&lt[we]!==we&&(lt[re]=lt[we]),Fe!==-1&&lt[Fe]!==Fe&&(lt[re]=lt[Fe])),st!==-1&&(lt[st]=re),we!==-1&&re!=lt[re]&&(lt[we]=lt[re],dt.lastIndexOf(we)<Be&&dt.push(we)),Fe!==-1&&re!=lt[re]&&(lt[Fe]=lt[re],dt.lastIndexOf(Fe)<Be&&dt.push(Fe));for(re=1;re<at;++re)lt[re]===re&&(Fe!==-1&&lt[Fe]!==Fe?lt[re]=lt[Fe]:we!==-1&&lt[we]!==we&&(lt[re]=lt[we]));for(re=1;re<at;++re)if(G[re].type!==0){if(Be=re,Be!=lt[Be])do Be=lt[Be],V[re]=V[Be]+"/"+V[re];while(Be!==0&&lt[Be]!==-1&&Be!=lt[Be]);lt[re]=-1}for(V[0]+="/",re=1;re<at;++re)G[re].type!==2&&(V[re]+="/")}function p(G,V,Z){for(var re=G.start,we=G.size,Fe=[],st=re;Z&&we>0&&st>=0;)Fe.push(V.slice(st*P,st*P+P)),we-=P,st=vp(Z,st*4);return Fe.length===0?dr(0):Jo(Fe).slice(0,G.size)}function x(G,V,Z,re,we){var Fe=O;if(G===O){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var st=Z[G],Be=(re>>>2)-1;if(!st)return;for(var at=0;at<Be&&(Fe=vp(st,at*4))!==O;++at)we.push(Fe);x(vp(st,re-4),V-1,Z,re,we)}}function v(G,V,Z,re,we){var Fe=[],st=[];we||(we=[]);var Be=re-1,at=0,lt=0;for(at=V;at>=0;){we[at]=!0,Fe[Fe.length]=at,st.push(G[at]);var dt=Z[Math.floor(at*4/re)];if(lt=at*4&Be,re<4+lt)throw new Error("FAT boundary crossed: "+at+" 4 "+re);if(!G[dt])break;at=vp(G[dt],lt)}return{nodes:Fe,data:EH([st])}}function y(G,V,Z,re){var we=G.length,Fe=[],st=[],Be=[],at=[],lt=re-1,dt=0,Pt=0,he=0,ze=0;for(dt=0;dt<we;++dt)if(Be=[],he=dt+V,he>=we&&(he-=we),!st[he]){at=[];var nt=[];for(Pt=he;Pt>=0;){nt[Pt]=!0,st[Pt]=!0,Be[Be.length]=Pt,at.push(G[Pt]);var ne=Z[Math.floor(Pt*4/re)];if(ze=Pt*4&lt,re<4+ze)throw new Error("FAT boundary crossed: "+Pt+" 4 "+re);if(!G[ne]||(Pt=vp(G[ne],ze),nt[Pt]))break}Fe[he]={nodes:Be,data:EH([at])}}return Fe}function b(G,V,Z,re,we,Fe,st,Be){for(var at=0,lt=re.length?2:0,dt=V[G].data,Pt=0,he=0,ze;Pt<dt.length;Pt+=128){var nt=dt.slice(Pt,Pt+128);_l(nt,64),he=nt.read_shift(2),ze=sR(nt,0,he-lt),re.push(ze);var ne={name:ze,type:nt.read_shift(1),color:nt.read_shift(1),L:nt.read_shift(4,"i"),R:nt.read_shift(4,"i"),C:nt.read_shift(4,"i"),clsid:nt.read_shift(16),state:nt.read_shift(4,"i"),start:0,size:0},He=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);He!==0&&(ne.ct=w(nt,nt.l-8));var pt=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);pt!==0&&(ne.mt=w(nt,nt.l-8)),ne.start=nt.read_shift(4,"i"),ne.size=nt.read_shift(4,"i"),ne.size<0&&ne.start<0&&(ne.size=ne.type=0,ne.start=O,ne.name=""),ne.type===5?(at=ne.start,we>0&&at!==O&&(V[at].name="!StreamData")):ne.size>=4096?(ne.storage="fat",V[ne.start]===void 0&&(V[ne.start]=v(Z,ne.start,V.fat_addrs,V.ssz)),V[ne.start].name=ne.name,ne.content=V[ne.start].data.slice(0,ne.size)):(ne.storage="minifat",ne.size<0?ne.size=0:at!==O&&ne.start!==O&&V[at]&&(ne.content=p(ne,V[at].data,(V[Be]||{}).data))),ne.content&&_l(ne.content,0),Fe[ze]=ne,st.push(ne)}}function w(G,V){return new Date((ju(G,V+4)/1e7*Math.pow(2,32)+ju(G,V)/1e7-11644473600)*1e3)}function j(G,V){return u(),d(c.readFileSync(G),V)}function I(G,V){var Z=V&&V.type;switch(Z||ea&&Buffer.isBuffer(G)&&(Z="buffer"),Z||"base64"){case"file":return j(G,V);case"base64":return d(Pu(Hu(G)),V);case"binary":return d(Pu(G),V)}return d(G,V)}function _(G,V){var Z=V||{},re=Z.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=re+"/",G.FileIndex[0]={name:re,type:5}),Z.CLSID&&(G.FileIndex[0].clsid=Z.CLSID),S(G)}function S(G){var V="Sh33tJ5";if(!_n.find(G,"/"+V)){var Z=dr(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,G.FileIndex.push({name:V,type:2,content:Z,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+V),E(G)}}function E(G,V){_(G);for(var Z=!1,re=!1,we=G.FullPaths.length-1;we>=0;--we){var Fe=G.FileIndex[we];switch(Fe.type){case 0:re?Z=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:re=!0,isNaN(Fe.R*Fe.L*Fe.C)&&(Z=!0),Fe.R>-1&&Fe.L>-1&&Fe.R==Fe.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!V)){var st=new Date(1987,1,19),Be=0,at=Object.create?Object.create(null):{},lt=[];for(we=0;we<G.FullPaths.length;++we)at[G.FullPaths[we]]=!0,G.FileIndex[we].type!==0&&lt.push([G.FullPaths[we],G.FileIndex[we]]);for(we=0;we<lt.length;++we){var dt=n(lt[we][0]);re=at[dt],re||(lt.push([dt,{name:a(dt).replace("/",""),type:1,clsid:de,ct:st,mt:st,content:null}]),at[dt]=!0)}for(lt.sort(function(ze,nt){return r(ze[0],nt[0])}),G.FullPaths=[],G.FileIndex=[],we=0;we<lt.length;++we)G.FullPaths[we]=lt[we][0],G.FileIndex[we]=lt[we][1];for(we=0;we<lt.length;++we){var Pt=G.FileIndex[we],he=G.FullPaths[we];if(Pt.name=a(he).replace("/",""),Pt.L=Pt.R=Pt.C=-(Pt.color=1),Pt.size=Pt.content?Pt.content.length:0,Pt.start=0,Pt.clsid=Pt.clsid||de,we===0)Pt.C=lt.length>1?1:-1,Pt.size=0,Pt.type=5;else if(he.slice(-1)=="/"){for(Be=we+1;Be<lt.length&&n(G.FullPaths[Be])!=he;++Be);for(Pt.C=Be>=lt.length?-1:Be,Be=we+1;Be<lt.length&&n(G.FullPaths[Be])!=n(he);++Be);Pt.R=Be>=lt.length?-1:Be,Pt.type=1}else n(G.FullPaths[we+1]||"")==n(he)&&(Pt.R=we+1),Pt.type=2}}}function B(G,V){var Z=V||{};if(Z.fileType=="mad")return _e(G,Z);switch(E(G),Z.fileType){case"zip":return xe(G,Z)}var re=function(ze){for(var nt=0,ne=0,He=0;He<ze.FileIndex.length;++He){var pt=ze.FileIndex[He];if(pt.content){var Dt=pt.content.length;Dt>0&&(Dt<4096?nt+=Dt+63>>6:ne+=Dt+511>>9)}}for(var rr=ze.FullPaths.length+3>>2,zt=nt+7>>3,Ot=nt+127>>7,lr=zt+ne+rr+Ot,Dr=lr+127>>7,br=Dr<=109?0:Math.ceil((Dr-109)/127);lr+Dr+br+127>>7>Dr;)br=++Dr<=109?0:Math.ceil((Dr-109)/127);var nr=[1,br,Dr,Ot,rr,ne,nt,0];return ze.FileIndex[0].size=nt<<6,nr[7]=(ze.FileIndex[0].start=nr[0]+nr[1]+nr[2]+nr[3]+nr[4]+nr[5])+(nr[6]+7>>3),nr}(G),we=dr(re[7]<<9),Fe=0,st=0;{for(Fe=0;Fe<8;++Fe)we.write_shift(1,ce[Fe]);for(Fe=0;Fe<8;++Fe)we.write_shift(2,0);for(we.write_shift(2,62),we.write_shift(2,3),we.write_shift(2,65534),we.write_shift(2,9),we.write_shift(2,6),Fe=0;Fe<3;++Fe)we.write_shift(2,0);for(we.write_shift(4,0),we.write_shift(4,re[2]),we.write_shift(4,re[0]+re[1]+re[2]+re[3]-1),we.write_shift(4,0),we.write_shift(4,4096),we.write_shift(4,re[3]?re[0]+re[1]+re[2]-1:O),we.write_shift(4,re[3]),we.write_shift(-4,re[1]?re[0]-1:O),we.write_shift(4,re[1]),Fe=0;Fe<109;++Fe)we.write_shift(-4,Fe<re[2]?re[1]+Fe:-1)}if(re[1])for(st=0;st<re[1];++st){for(;Fe<236+st*127;++Fe)we.write_shift(-4,Fe<re[2]?re[1]+Fe:-1);we.write_shift(-4,st===re[1]-1?O:st+1)}var Be=function(ze){for(st+=ze;Fe<st-1;++Fe)we.write_shift(-4,Fe+1);ze&&(++Fe,we.write_shift(-4,O))};for(st=Fe=0,st+=re[1];Fe<st;++Fe)we.write_shift(-4,ue.DIFSECT);for(st+=re[2];Fe<st;++Fe)we.write_shift(-4,ue.FATSECT);Be(re[3]),Be(re[4]);for(var at=0,lt=0,dt=G.FileIndex[0];at<G.FileIndex.length;++at)dt=G.FileIndex[at],dt.content&&(lt=dt.content.length,!(lt<4096)&&(dt.start=st,Be(lt+511>>9)));for(Be(re[6]+7>>3);we.l&511;)we.write_shift(-4,ue.ENDOFCHAIN);for(st=Fe=0,at=0;at<G.FileIndex.length;++at)dt=G.FileIndex[at],dt.content&&(lt=dt.content.length,!(!lt||lt>=4096)&&(dt.start=st,Be(lt+63>>6)));for(;we.l&511;)we.write_shift(-4,ue.ENDOFCHAIN);for(Fe=0;Fe<re[4]<<2;++Fe){var Pt=G.FullPaths[Fe];if(!Pt||Pt.length===0){for(at=0;at<17;++at)we.write_shift(4,0);for(at=0;at<3;++at)we.write_shift(4,-1);for(at=0;at<12;++at)we.write_shift(4,0);continue}dt=G.FileIndex[Fe],Fe===0&&(dt.start=dt.size?dt.start-1:O);var he=Fe===0&&Z.root||dt.name;if(lt=2*(he.length+1),we.write_shift(64,he,"utf16le"),we.write_shift(2,lt),we.write_shift(1,dt.type),we.write_shift(1,dt.color),we.write_shift(-4,dt.L),we.write_shift(-4,dt.R),we.write_shift(-4,dt.C),dt.clsid)we.write_shift(16,dt.clsid,"hex");else for(at=0;at<4;++at)we.write_shift(4,0);we.write_shift(4,dt.state||0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,dt.start),we.write_shift(4,dt.size),we.write_shift(4,0)}for(Fe=1;Fe<G.FileIndex.length;++Fe)if(dt=G.FileIndex[Fe],dt.size>=4096)if(we.l=dt.start+1<<9,ea&&Buffer.isBuffer(dt.content))dt.content.copy(we,we.l,0,dt.size),we.l+=dt.size+511&-512;else{for(at=0;at<dt.size;++at)we.write_shift(1,dt.content[at]);for(;at&511;++at)we.write_shift(1,0)}for(Fe=1;Fe<G.FileIndex.length;++Fe)if(dt=G.FileIndex[Fe],dt.size>0&&dt.size<4096)if(ea&&Buffer.isBuffer(dt.content))dt.content.copy(we,we.l,0,dt.size),we.l+=dt.size+63&-64;else{for(at=0;at<dt.size;++at)we.write_shift(1,dt.content[at]);for(;at&63;++at)we.write_shift(1,0)}if(ea)we.l=we.length;else for(;we.l<we.length;)we.write_shift(1,0);return we}function T(G,V){var Z=G.FullPaths.map(function(at){return at.toUpperCase()}),re=Z.map(function(at){var lt=at.split("/");return lt[lt.length-(at.slice(-1)=="/"?2:1)]}),we=!1;V.charCodeAt(0)===47?(we=!0,V=Z[0].slice(0,-1)+V):we=V.indexOf("/")!==-1;var Fe=V.toUpperCase(),st=we===!0?Z.indexOf(Fe):re.indexOf(Fe);if(st!==-1)return G.FileIndex[st];var Be=!Fe.match(Wy);for(Fe=Fe.replace(Pc,""),Be&&(Fe=Fe.replace(Wy,"!")),st=0;st<Z.length;++st)if((Be?Z[st].replace(Wy,"!"):Z[st]).replace(Pc,"")==Fe||(Be?re[st].replace(Wy,"!"):re[st]).replace(Pc,"")==Fe)return G.FileIndex[st];return null}var P=64,O=-2,z="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(G,V,Z){u();var re=B(G,Z);c.writeFileSync(V,re)}function se(G){for(var V=new Array(G.length),Z=0;Z<G.length;++Z)V[Z]=String.fromCharCode(G[Z]);return V.join("")}function ke(G,V){var Z=B(G,V);switch(V&&V.type||"buffer"){case"file":return u(),c.writeFileSync(V.filename,Z),Z;case"binary":return typeof Z=="string"?Z:se(Z);case"base64":return P2(typeof Z=="string"?Z:se(Z));case"buffer":if(ea)return Buffer.isBuffer(Z)?Z:DA(Z);case"array":return typeof Z=="string"?Pu(Z):Z}return Z}var Re;function F(G){try{var V=G.InflateRaw,Z=new V;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)Re=G;else throw new Error("zlib does not expose bytesRead")}catch(re){console.error("cannot use native zlib: "+(re.message||re))}}function H(G,V){if(!Re)return pe(G,V);var Z=Re.InflateRaw,re=new Z,we=re._processChunk(G.slice(G.l),re._finishFlushFlag);return G.l+=re.bytesRead,we}function K(G){return Re?Re.deflateRawSync(G):Ne(G)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(G){var V=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(V>>16|V>>8|V)&255}for(var Q=typeof Uint8Array<"u",ee=Q?new Uint8Array(256):[],ve=0;ve<256;++ve)ee[ve]=D(ve);function M(G,V){var Z=ee[G&255];return V<=8?Z>>>8-V:(Z=Z<<8|ee[G>>8&255],V<=16?Z>>>16-V:(Z=Z<<8|ee[G>>16&255],Z>>>24-V))}function Ye(G,V){var Z=V&7,re=V>>>3;return(G[re]|(Z<=6?0:G[re+1]<<8))>>>Z&3}function ae(G,V){var Z=V&7,re=V>>>3;return(G[re]|(Z<=5?0:G[re+1]<<8))>>>Z&7}function X(G,V){var Z=V&7,re=V>>>3;return(G[re]|(Z<=4?0:G[re+1]<<8))>>>Z&15}function De(G,V){var Z=V&7,re=V>>>3;return(G[re]|(Z<=3?0:G[re+1]<<8))>>>Z&31}function le(G,V){var Z=V&7,re=V>>>3;return(G[re]|(Z<=1?0:G[re+1]<<8))>>>Z&127}function $e(G,V,Z){var re=V&7,we=V>>>3,Fe=(1<<Z)-1,st=G[we]>>>re;return Z<8-re||(st|=G[we+1]<<8-re,Z<16-re)||(st|=G[we+2]<<16-re,Z<24-re)||(st|=G[we+3]<<24-re),st&Fe}function Xe(G,V,Z){var re=V&7,we=V>>>3;return re<=5?G[we]|=(Z&7)<<re:(G[we]|=Z<<re&255,G[we+1]=(Z&7)>>8-re),V+3}function it(G,V,Z){var re=V&7,we=V>>>3;return Z=(Z&1)<<re,G[we]|=Z,V+1}function xt(G,V,Z){var re=V&7,we=V>>>3;return Z<<=re,G[we]|=Z&255,Z>>>=8,G[we+1]=Z,V+8}function jt(G,V,Z){var re=V&7,we=V>>>3;return Z<<=re,G[we]|=Z&255,Z>>>=8,G[we+1]=Z&255,G[we+2]=Z>>>8,V+16}function Mt(G,V){var Z=G.length,re=2*Z>V?2*Z:V+5,we=0;if(Z>=V)return G;if(ea){var Fe=oH(re);if(G.copy)G.copy(Fe);else for(;we<G.length;++we)Fe[we]=G[we];return Fe}else if(Q){var st=new Uint8Array(re);if(st.set)st.set(G);else for(;we<Z;++we)st[we]=G[we];return st}return G.length=re,G}function Ft(G){for(var V=new Array(G),Z=0;Z<G;++Z)V[Z]=0;return V}function $t(G,V,Z){var re=1,we=0,Fe=0,st=0,Be=0,at=G.length,lt=Q?new Uint16Array(32):Ft(32);for(Fe=0;Fe<32;++Fe)lt[Fe]=0;for(Fe=at;Fe<Z;++Fe)G[Fe]=0;at=G.length;var dt=Q?new Uint16Array(at):Ft(at);for(Fe=0;Fe<at;++Fe)lt[we=G[Fe]]++,re<we&&(re=we),dt[Fe]=0;for(lt[0]=0,Fe=1;Fe<=re;++Fe)lt[Fe+16]=Be=Be+lt[Fe-1]<<1;for(Fe=0;Fe<at;++Fe)Be=G[Fe],Be!=0&&(dt[Fe]=lt[Be+16]++);var Pt=0;for(Fe=0;Fe<at;++Fe)if(Pt=G[Fe],Pt!=0)for(Be=M(dt[Fe],re)>>re-Pt,st=(1<<re+4-Pt)-1;st>=0;--st)V[Be|st<<Pt]=Pt&15|Fe<<4;return re}var kt=Q?new Uint16Array(512):Ft(512),Ge=Q?new Uint16Array(32):Ft(32);if(!Q){for(var ie=0;ie<512;++ie)kt[ie]=0;for(ie=0;ie<32;++ie)Ge[ie]=0}(function(){for(var G=[],V=0;V<32;V++)G.push(5);$t(G,Ge,32);var Z=[];for(V=0;V<=143;V++)Z.push(8);for(;V<=255;V++)Z.push(9);for(;V<=279;V++)Z.push(7);for(;V<=287;V++)Z.push(8);$t(Z,kt,288)})();var Ue=function(){for(var V=Q?new Uint8Array(32768):[],Z=0,re=0;Z<Y.length-1;++Z)for(;re<Y[Z+1];++re)V[re]=Z;for(;re<32768;++re)V[re]=29;var we=Q?new Uint8Array(259):[];for(Z=0,re=0;Z<W.length-1;++Z)for(;re<W[Z+1];++re)we[re]=Z;function Fe(Be,at){for(var lt=0;lt<Be.length;){var dt=Math.min(65535,Be.length-lt),Pt=lt+dt==Be.length;for(at.write_shift(1,+Pt),at.write_shift(2,dt),at.write_shift(2,~dt&65535);dt-- >0;)at[at.l++]=Be[lt++]}return at.l}function st(Be,at){for(var lt=0,dt=0,Pt=Q?new Uint16Array(32768):[];dt<Be.length;){var he=Math.min(65535,Be.length-dt);if(he<10){for(lt=Xe(at,lt,+(dt+he==Be.length)),lt&7&&(lt+=8-(lt&7)),at.l=lt/8|0,at.write_shift(2,he),at.write_shift(2,~he&65535);he-- >0;)at[at.l++]=Be[dt++];lt=at.l*8;continue}lt=Xe(at,lt,+(dt+he==Be.length)+2);for(var ze=0;he-- >0;){var nt=Be[dt];ze=(ze<<5^nt)&32767;var ne=-1,He=0;if((ne=Pt[ze])&&(ne|=dt&-32768,ne>dt&&(ne-=32768),ne<dt))for(;Be[ne+He]==Be[dt+He]&&He<250;)++He;if(He>2){nt=we[He],nt<=22?lt=xt(at,lt,ee[nt+1]>>1)-1:(xt(at,lt,3),lt+=5,xt(at,lt,ee[nt-23]>>5),lt+=3);var pt=nt<8?0:nt-4>>2;pt>0&&(jt(at,lt,He-W[nt]),lt+=pt),nt=V[dt-ne],lt=xt(at,lt,ee[nt]>>3),lt-=3;var Dt=nt<4?0:nt-2>>1;Dt>0&&(jt(at,lt,dt-ne-Y[nt]),lt+=Dt);for(var rr=0;rr<He;++rr)Pt[ze]=dt&32767,ze=(ze<<5^Be[dt])&32767,++dt;he-=He-1}else nt<=143?nt=nt+48:lt=it(at,lt,1),lt=xt(at,lt,ee[nt]),Pt[ze]=dt&32767,++dt}lt=xt(at,lt,0)-1}return at.l=(lt+7)/8|0,at.l}return function(at,lt){return at.length<8?Fe(at,lt):st(at,lt)}}();function Ne(G){var V=dr(50+Math.floor(G.length*1.1)),Z=Ue(G,V);return V.slice(0,Z)}var be=Q?new Uint16Array(32768):Ft(32768),Ce=Q?new Uint16Array(32768):Ft(32768),Le=Q?new Uint16Array(128):Ft(128),Ae=1,We=1;function ct(G,V){var Z=De(G,V)+257;V+=5;var re=De(G,V)+1;V+=5;var we=X(G,V)+4;V+=4;for(var Fe=0,st=Q?new Uint8Array(19):Ft(19),Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],at=1,lt=Q?new Uint8Array(8):Ft(8),dt=Q?new Uint8Array(8):Ft(8),Pt=st.length,he=0;he<we;++he)st[L[he]]=Fe=ae(G,V),at<Fe&&(at=Fe),lt[Fe]++,V+=3;var ze=0;for(lt[0]=0,he=1;he<=at;++he)dt[he]=ze=ze+lt[he-1]<<1;for(he=0;he<Pt;++he)(ze=st[he])!=0&&(Be[he]=dt[ze]++);var nt=0;for(he=0;he<Pt;++he)if(nt=st[he],nt!=0){ze=ee[Be[he]]>>8-nt;for(var ne=(1<<7-nt)-1;ne>=0;--ne)Le[ze|ne<<nt]=nt&7|he<<3}var He=[];for(at=1;He.length<Z+re;)switch(ze=Le[le(G,V)],V+=ze&7,ze>>>=3){case 16:for(Fe=3+Ye(G,V),V+=2,ze=He[He.length-1];Fe-- >0;)He.push(ze);break;case 17:for(Fe=3+ae(G,V),V+=3;Fe-- >0;)He.push(0);break;case 18:for(Fe=11+le(G,V),V+=7;Fe-- >0;)He.push(0);break;default:He.push(ze),at<ze&&(at=ze);break}var pt=He.slice(0,Z),Dt=He.slice(Z);for(he=Z;he<286;++he)pt[he]=0;for(he=re;he<30;++he)Dt[he]=0;return Ae=$t(pt,be,286),We=$t(Dt,Ce,30),V}function _t(G,V){if(G[0]==3&&!(G[1]&3))return[Sm(V),2];for(var Z=0,re=0,we=oH(V||1<<18),Fe=0,st=we.length>>>0,Be=0,at=0;!(re&1);){if(re=ae(G,Z),Z+=3,re>>>1)re>>1==1?(Be=9,at=5):(Z=ct(G,Z),Be=Ae,at=We);else{Z&7&&(Z+=8-(Z&7));var lt=G[Z>>>3]|G[(Z>>>3)+1]<<8;if(Z+=32,lt>0)for(!V&&st<Fe+lt&&(we=Mt(we,Fe+lt),st=we.length);lt-- >0;)we[Fe++]=G[Z>>>3],Z+=8;continue}for(;;){!V&&st<Fe+32767&&(we=Mt(we,Fe+32767),st=we.length);var dt=$e(G,Z,Be),Pt=re>>>1==1?kt[dt]:be[dt];if(Z+=Pt&15,Pt>>>=4,!(Pt>>>8&255))we[Fe++]=Pt;else{if(Pt==256)break;Pt-=257;var he=Pt<8?0:Pt-4>>2;he>5&&(he=0);var ze=Fe+W[Pt];he>0&&(ze+=$e(G,Z,he),Z+=he),dt=$e(G,Z,at),Pt=re>>>1==1?Ge[dt]:Ce[dt],Z+=Pt&15,Pt>>>=4;var nt=Pt<4?0:Pt-2>>1,ne=Y[Pt];for(nt>0&&(ne+=$e(G,Z,nt),Z+=nt),!V&&st<ze&&(we=Mt(we,ze+100),st=we.length);Fe<ze;)we[Fe]=we[Fe-ne],++Fe}}}return V?[we,Z+7>>>3]:[we.slice(0,Fe),Z+7>>>3]}function pe(G,V){var Z=G.slice(G.l||0),re=_t(Z,V);return G.l+=re[1],re[0]}function Pe(G,V){if(G)typeof console<"u"&&console.error(V);else throw new Error(V)}function Ee(G,V){var Z=G;_l(Z,0);var re=[],we=[],Fe={FileIndex:re,FullPaths:we};_(Fe,{root:V.root});for(var st=Z.length-4;(Z[st]!=80||Z[st+1]!=75||Z[st+2]!=5||Z[st+3]!=6)&&st>=0;)--st;Z.l=st+4,Z.l+=4;var Be=Z.read_shift(2);Z.l+=6;var at=Z.read_shift(4);for(Z.l=at,st=0;st<Be;++st){Z.l+=20;var lt=Z.read_shift(4),dt=Z.read_shift(4),Pt=Z.read_shift(2),he=Z.read_shift(2),ze=Z.read_shift(2);Z.l+=8;var nt=Z.read_shift(4),ne=l(Z.slice(Z.l+Pt,Z.l+Pt+he));Z.l+=Pt+he+ze;var He=Z.l;Z.l=nt+4,Ze(Z,lt,dt,Fe,ne),Z.l=He}return Fe}function Ze(G,V,Z,re,we){G.l+=2;var Fe=G.read_shift(2),st=G.read_shift(2),Be=o(G);if(Fe&8257)throw new Error("Unsupported ZIP encryption");for(var at=G.read_shift(4),lt=G.read_shift(4),dt=G.read_shift(4),Pt=G.read_shift(2),he=G.read_shift(2),ze="",nt=0;nt<Pt;++nt)ze+=String.fromCharCode(G[G.l++]);if(he){var ne=l(G.slice(G.l,G.l+he));(ne[21589]||{}).mt&&(Be=ne[21589].mt),((we||{})[21589]||{}).mt&&(Be=we[21589].mt)}G.l+=he;var He=G.slice(G.l,G.l+lt);switch(st){case 8:He=H(G,dt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+st)}var pt=!1;Fe&8&&(at=G.read_shift(4),at==134695760&&(at=G.read_shift(4),pt=!0),lt=G.read_shift(4),dt=G.read_shift(4)),lt!=V&&Pe(pt,"Bad compressed size: "+V+" != "+lt),dt!=Z&&Pe(pt,"Bad uncompressed size: "+Z+" != "+dt),ye(re,ze,He,{unsafe:!0,mt:Be})}function xe(G,V){var Z=V||{},re=[],we=[],Fe=dr(1),st=Z.compression?8:0,Be=0,at=0,lt=0,dt=0,Pt=0,he=G.FullPaths[0],ze=he,nt=G.FileIndex[0],ne=[],He=0;for(at=1;at<G.FullPaths.length;++at)if(ze=G.FullPaths[at].slice(he.length),nt=G.FileIndex[at],!(!nt.size||!nt.content||ze=="Sh33tJ5")){var pt=dt,Dt=dr(ze.length);for(lt=0;lt<ze.length;++lt)Dt.write_shift(1,ze.charCodeAt(lt)&127);Dt=Dt.slice(0,Dt.l),ne[Pt]=f4e.buf(nt.content,0);var rr=nt.content;st==8&&(rr=K(rr)),Fe=dr(30),Fe.write_shift(4,67324752),Fe.write_shift(2,20),Fe.write_shift(2,Be),Fe.write_shift(2,st),nt.mt?s(Fe,nt.mt):Fe.write_shift(4,0),Fe.write_shift(-4,ne[Pt]),Fe.write_shift(4,rr.length),Fe.write_shift(4,nt.content.length),Fe.write_shift(2,Dt.length),Fe.write_shift(2,0),dt+=Fe.length,re.push(Fe),dt+=Dt.length,re.push(Dt),dt+=rr.length,re.push(rr),Fe=dr(46),Fe.write_shift(4,33639248),Fe.write_shift(2,0),Fe.write_shift(2,20),Fe.write_shift(2,Be),Fe.write_shift(2,st),Fe.write_shift(4,0),Fe.write_shift(-4,ne[Pt]),Fe.write_shift(4,rr.length),Fe.write_shift(4,nt.content.length),Fe.write_shift(2,Dt.length),Fe.write_shift(2,0),Fe.write_shift(2,0),Fe.write_shift(2,0),Fe.write_shift(2,0),Fe.write_shift(4,0),Fe.write_shift(4,pt),He+=Fe.l,we.push(Fe),He+=Dt.length,we.push(Dt),++Pt}return Fe=dr(22),Fe.write_shift(4,101010256),Fe.write_shift(2,0),Fe.write_shift(2,0),Fe.write_shift(2,Pt),Fe.write_shift(2,Pt),Fe.write_shift(4,He),Fe.write_shift(4,dt),Fe.write_shift(2,0),Jo([Jo(re),Jo(we),Fe])}var Se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gt(G,V){if(G.ctype)return G.ctype;var Z=G.name||"",re=Z.match(/\.([^\.]+)$/);return re&&Se[re[1]]||V&&(re=(Z=V).match(/[\.\\]([^\.\\])+$/),re&&Se[re[1]])?Se[re[1]]:"application/octet-stream"}function Et(G){for(var V=P2(G),Z=[],re=0;re<V.length;re+=76)Z.push(V.slice(re,re+76));return Z.join(`\r
`)+`\r
`}function Nt(G){var V=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(lt){var dt=lt.charCodeAt(0).toString(16).toUpperCase();return"="+(dt.length==1?"0"+dt:dt)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],re=V.split(`\r
`),we=0;we<re.length;++we){var Fe=re[we];if(Fe.length==0){Z.push("");continue}for(var st=0;st<Fe.length;){var Be=76,at=Fe.slice(st,st+Be);at.charAt(Be-1)=="="?Be--:at.charAt(Be-2)=="="?Be-=2:at.charAt(Be-3)=="="&&(Be-=3),at=Fe.slice(st,st+Be),st+=Be,st<Fe.length&&(at+="="),Z.push(at)}}return Z.join(`\r
`)}function Tt(G){for(var V=[],Z=0;Z<G.length;++Z){for(var re=G[Z];Z<=G.length&&re.charAt(re.length-1)=="=";)re=re.slice(0,re.length-1)+G[++Z];V.push(re)}for(var we=0;we<V.length;++we)V[we]=V[we].replace(/[=][0-9A-Fa-f]{2}/g,function(Fe){return String.fromCharCode(parseInt(Fe.slice(1),16))});return Pu(V.join(`\r
`))}function Lt(G,V,Z){for(var re="",we="",Fe="",st,Be=0;Be<10;++Be){var at=V[Be];if(!at||at.match(/^\s*$/))break;var lt=at.match(/^(.*?):\s*([^\s].*)$/);if(lt)switch(lt[1].toLowerCase()){case"content-location":re=lt[2].trim();break;case"content-type":Fe=lt[2].trim();break;case"content-transfer-encoding":we=lt[2].trim();break}}switch(++Be,we.toLowerCase()){case"base64":st=Pu(Hu(V.slice(Be).join("")));break;case"quoted-printable":st=Tt(V.slice(Be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+we)}var dt=ye(G,re.slice(Z.length),st,{unsafe:!0});Fe&&(dt.ctype=Fe)}function Me(G,V){if(se(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=V&&V.root||"",re=(ea&&Buffer.isBuffer(G)?G.toString("binary"):se(G)).split(`\r
`),we=0,Fe="";for(we=0;we<re.length;++we)if(Fe=re[we],!!/^Content-Location:/i.test(Fe)&&(Fe=Fe.slice(Fe.indexOf("file")),Z||(Z=Fe.slice(0,Fe.lastIndexOf("/")+1)),Fe.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),Fe.slice(0,Z.length)!=Z););var st=(re[1]||"").match(/boundary="(.*?)"/);if(!st)throw new Error("MAD cannot find boundary");var Be="--"+(st[1]||""),at=[],lt=[],dt={FileIndex:at,FullPaths:lt};_(dt);var Pt,he=0;for(we=0;we<re.length;++we){var ze=re[we];ze!==Be&&ze!==Be+"--"||(he++&&Lt(dt,re.slice(Pt,we),Z),Pt=we)}return dt}function _e(G,V){var Z=V||{},re=Z.boundary||"SheetJS";re="------="+re;for(var we=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+re.slice(2)+'"',"","",""],Fe=G.FullPaths[0],st=Fe,Be=G.FileIndex[0],at=1;at<G.FullPaths.length;++at)if(st=G.FullPaths[at].slice(Fe.length),Be=G.FileIndex[at],!(!Be.size||!Be.content||st=="Sh33tJ5")){st=st.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var lt=Be.content,dt=ea&&Buffer.isBuffer(lt)?lt.toString("binary"):se(lt),Pt=0,he=Math.min(1024,dt.length),ze=0,nt=0;nt<=he;++nt)(ze=dt.charCodeAt(nt))>=32&&ze<128&&++Pt;var ne=Pt>=he*4/5;we.push(re),we.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+st),we.push("Content-Transfer-Encoding: "+(ne?"quoted-printable":"base64")),we.push("Content-Type: "+gt(Be,st)),we.push(""),we.push(ne?Nt(dt):Et(dt))}return we.push(re+`--\r
`),we.join(`\r
`)}function U(G){var V={};return _(V,G),V}function ye(G,V,Z,re){var we=re&&re.unsafe;we||_(G);var Fe=!we&&_n.find(G,V);if(!Fe){var st=G.FullPaths[0];V.slice(0,st.length)==st?st=V:(st.slice(-1)!="/"&&(st+="/"),st=(st+V).replace("//","/")),Fe={name:a(V),type:2},G.FileIndex.push(Fe),G.FullPaths.push(st),we||_n.utils.cfb_gc(G)}return Fe.content=Z,Fe.size=Z?Z.length:0,re&&(re.CLSID&&(Fe.clsid=re.CLSID),re.mt&&(Fe.mt=re.mt),re.ct&&(Fe.ct=re.ct)),Fe}function te(G,V){_(G);var Z=_n.find(G,V);if(Z){for(var re=0;re<G.FileIndex.length;++re)if(G.FileIndex[re]==Z)return G.FileIndex.splice(re,1),G.FullPaths.splice(re,1),!0}return!1}function Ve(G,V,Z){_(G);var re=_n.find(G,V);if(re){for(var we=0;we<G.FileIndex.length;++we)if(G.FileIndex[we]==re)return G.FileIndex[we].name=a(Z),G.FullPaths[we]=Z,!0}return!1}function qe(G){E(G,!0)}return e.find=T,e.read=I,e.parse=d,e.write=ke,e.writeFile=me,e.utils={cfb_new:U,cfb_add:ye,cfb_del:te,cfb_mov:Ve,cfb_gc:qe,ReadShift:Bb,CheckField:Qne,prep_blob:_l,bconcat:Jo,use_zlib:F,_deflateRaw:Ne,_inflateRaw:pe,consts:ue},e}();function h4e(t){return typeof t=="string"?iP(t):Array.isArray(t)?L3e(t):t}function Rw(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=iP(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Zf(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([h4e(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Um(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function A4e(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ji(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function mH(t,e){for(var r=[],n=ji(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function lP(t){for(var e=[],r=ji(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function cP(t){for(var e=[],r=ji(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function m4e(t){for(var e=[],r=ji(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var HS=new Date(1899,11,30,0,0,0);function Oo(t,e){var r=t.getTime(),n=HS.getTime()+(t.getTimezoneOffset()-HS.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var yne=new Date,p4e=HS.getTime()+(yne.getTimezoneOffset()-HS.getTimezoneOffset())*6e4,pH=yne.getTimezoneOffset();function uP(t){var e=new Date;return e.setTime(t*24*60*60*1e3+p4e),e.getTimezoneOffset()!==pH&&e.setTime(e.getTime()+(e.getTimezoneOffset()-pH)*6e4),e}function g4e(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[s],10)}return e}var gH=new Date("2017-02-19T19:06:09.000Z"),bne=isNaN(gH.getFullYear())?new Date("2/19/17"):gH,x4e=bne.getFullYear()==2017;function Fs(t,e){var r=new Date(t);if(x4e)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(bne.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function hg(t,e){if(ea&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Zf(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Zf(lne(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Zf(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Zf(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function Os(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Os(t[r]));return e}function _i(t,e){for(var r="";r.length<e;)r+=t;return r}function gf(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var v4e=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lv(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&v4e.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var y4e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function wne(t){return t?t.content&&t.type?hg(t.content,!0):t.data?zy(t.data):t.asNodeBuffer&&ea?zy(t.asNodeBuffer().toString("binary")):t.asBinary?zy(t.asBinary()):t._data&&t._data.getContent?zy(hg(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Nne(t){if(!t)return null;if(t.data)return sH(t.data);if(t.asNodeBuffer&&ea)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?sH(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function b4e(t){return t&&t.name.slice(-4)===".bin"?Nne(t):wne(t)}function pd(t,e){for(var r=t.FullPaths||ji(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Z6(t,e){var r=pd(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ro(t,e,r){if(!r)return b4e(Z6(t,e));if(!e)return null;try{return ro(t,e)}catch{return null}}function Bu(t,e,r){if(!r)return wne(Z6(t,e));if(!e)return null;try{return Bu(t,e)}catch{return null}}function w4e(t,e,r){return Nne(Z6(t,e))}function xH(t){for(var e=t.FullPaths||ji(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Yn(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ea?n=DA(r):n=U3e(r),_n.utils.cfb_add(t,e,n)}_n.utils.cfb_add(t,e,r)}else t.file(e,r)}function eR(){return _n.utils.cfb_new()}function Cne(t,e){switch(e.type){case"base64":return _n.read(t,{type:"base64"});case"binary":return _n.read(t,{type:"binary"});case"buffer":case"array":return _n.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Xy(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Xi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,N4e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,vH=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,C4e=/<[^>]*>/g,cc=Xi.match(vH)?vH:C4e,_4e=/<\w*:/,E4e=/<(\/?)\w+:/;function Dn(t,e,r){for(var n={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(N4e),l=0,c="",u=0,d="",f="",A=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(A=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+A,f.length-A),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function gh(t){return t.replace(E4e,"<$1")}var _ne={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},tR=lP(_ne),_a=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(l,c){return _ne[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),rR=/[&<>'"]/g,S4e=/[\u0000-\u0008\u000b-\u001f]/g;function rs(t){var e=t+"";return e.replace(rR,function(r){return tR[r]}).replace(S4e,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function yH(t){return rs(t).replace(/ /g,"_x0020_")}var Ene=/[\u0000-\u001f]/g;function nR(t){var e=t+"";return e.replace(rR,function(r){return tR[r]}).replace(/\n/g,"<br/>").replace(Ene,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function I4e(t){var e=t+"";return e.replace(rR,function(r){return tR[r]}).replace(Ene,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var bH=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function j4e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ps(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function S5(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function wH(t){var e=Sm(2*t.length),r,n,a=1,s=0,o=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function NH(t){return DA(t,"binary").toString("utf8")}var VC="foo bar baz",cs=ea&&(NH(VC)==S5(VC)&&NH||wH(VC)==S5(VC)&&wH)||S5,Zf=ea?function(t){return DA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},T2=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Sne=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),P4e=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),B4e=/<\/?(?:vt:)?variant>/g,T4e=/<(?:vt:)([^>]*)>([\s\S]*)</;function CH(t,e){var r=Dn(t),n=t.match(P4e(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(B4e,"").match(T4e);o&&a.push({v:cs(o[2]),t:o[1]})}),a}var Ine=/(^\s|\s$|\n)/;function Sl(t,e){return"<"+t+(e.match(Ine)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function k2(t){return ji(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Qr(t,e,r){return"<"+t+(r!=null?k2(r):"")+(e!=null?(e.match(Ine)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function zk(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function k4e(t,e){switch(typeof t){case"string":var r=Qr("vt:lpwstr",rs(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Qr((t|0)==t?"vt:i4":"vt:r8",rs(String(t)));case"boolean":return Qr("vt:bool",t?"true":"false")}if(t instanceof Date)return Qr("vt:filetime",zk(t));throw new Error("Unable to serialize "+t)}function aR(t){if(ea&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return cs(Um(X6(t)));throw new Error("Bad input format: expected Buffer or string")}var F2=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Po={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Rg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Iu={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function F4e(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function O4e(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=n?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)t[r+l]=s&255;t[r+6]=(a&15)<<4|s&15,t[r+7]=a>>4|n}var _H=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,s=t[0][n].length;a<s;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},EH=ea?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:DA(e)})):_H(t)}:_H,SH=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Yh(t,a)));return n.join("").replace(Pc,"")},sR=ea?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Pc,""):SH(t,e,r)}:SH,IH=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},jne=ea?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):IH(t,e,r)}:IH,jH=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(kx(t,a)));return n.join("")},Mw=ea?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):jH(e,r,n)}:jH,Pne=function(t,e){var r=ju(t,e);return r>0?Mw(t,e+4,e+4+r-1):""},Bne=Pne,Tne=function(t,e){var r=ju(t,e);return r>0?Mw(t,e+4,e+4+r-1):""},kne=Tne,Fne=function(t,e){var r=2*ju(t,e);return r>0?Mw(t,e+4,e+4+r-1):""},One=Fne,Dne=function(e,r){var n=ju(e,r);return n>0?sR(e,r+4,r+4+n):""},Rne=Dne,Mne=function(t,e){var r=ju(t,e);return r>0?Mw(t,e+4,e+4+r):""},Lne=Mne,Une=function(t,e){return F4e(t,e)},$S=Une,iR=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ea&&(Bne=function(e,r){if(!Buffer.isBuffer(e))return Pne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},kne=function(e,r){if(!Buffer.isBuffer(e))return Tne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},One=function(e,r){if(!Buffer.isBuffer(e))return Fne(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Rne=function(e,r){if(!Buffer.isBuffer(e))return Dne(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Lne=function(e,r){if(!Buffer.isBuffer(e))return Mne(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},$S=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Une(e,r)},iR=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var kx=function(t,e){return t[e]},Yh=function(t,e){return t[e+1]*256+t[e]},D4e=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ju=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},vp=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},R4e=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Bb(t,e){var r="",n,a,s=[],o,l,c,u;switch(e){case"dbcs":if(u=this.l,ea&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Yh(this,u)),u+=2;t*=2;break;case"utf8":r=Mw(this,this.l,this.l+t);break;case"utf16le":t*=2,r=sR(this,this.l,this.l+t);break;case"wstr":return Bb.call(this,t,"dbcs");case"lpstr-ansi":r=Bne(this,this.l),t=4+ju(this,this.l);break;case"lpstr-cp":r=kne(this,this.l),t=4+ju(this,this.l);break;case"lpwstr":r=One(this,this.l),t=4+2*ju(this,this.l);break;case"lpp4":t=4+ju(this,this.l),r=Rne(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ju(this,this.l),r=Lne(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=kx(this,this.l+t++))!==0;)s.push(QC(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Yh(this,this.l+t))!==0;)s.push(QC(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=kx(this,u),this.l=u+1,l=Bb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(QC(Yh(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=kx(this,u),this.l=u+1,l=Bb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(QC(kx(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=kx(this,this.l),this.l++,n;case 2:return n=(e==="i"?D4e:Yh)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?vp:R4e)(this,this.l),this.l+=4,n):(a=ju(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=$S(this,this.l):a=$S([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=jne(this,this.l,t);break}}return this.l+=t,r}var M4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},L4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},U4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Q4e(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)U4e(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,M4e(this,e,this.l);break;case 8:if(n=8,r==="f"){O4e(this,e,this.l);break}case 16:break;case-4:n=4,L4e(this,e,this.l);break}return this.l+=n,this}function Qne(t,e){var r=jne(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function _l(t,e){t.l=e,t.read_shift=Bb,t.chk=Qne,t.write_shift=Q4e}function lc(t,e){t.l+=e}function dr(t){var e=Sm(t);return _l(e,0),e}function RA(t,e,r){if(t){var n,a,s;_l(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var u=U2[l]||U2[65535];for(n=t.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=t.read_shift(1))&127)<<7*a;c=t.l+s;var d=u.f&&u.f(t,s,r);if(t.l=c,e(d,u,l))return}}}function iu(){var t=[],e=ea?256:2048,r=function(u){var d=dr(u);return _l(d,0),d},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,e)))},o=function(){return a(),Jo(t)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:l,end:o,_bufs:t}}function Er(t,e,r,n){var a=+e,s;if(!isNaN(a)){n||(n=U2[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&iR(r)&&t.push(r)}}function Tb(t,e,r){var n=Os(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function PH(t,e,r){var n=Os(t);return n.s=Tb(n.s,e.s,r),n.e=Tb(n.e,e.s,r),n}function kb(t,e){if(t.cRel&&t.c<0)for(t=Os(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Os(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=On(t);return!t.cRel&&t.cRel!=null&&(r=$4e(r)),!t.rRel&&t.rRel!=null&&(r=V4e(r)),r}function I5(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+li(t.s.c)+":"+(t.e.cRel?"":"$")+li(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+zi(t.s.r)+":"+(t.e.rRel?"":"$")+zi(t.e.r):kb(t.s,e.biff)+":"+kb(t.e,e.biff)}function oR(t){return parseInt(H4e(t),10)-1}function zi(t){return""+(t+1)}function V4e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function H4e(t){return t.replace(/\$(\d+)$/,"$1")}function lR(t){for(var e=G4e(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function li(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function $4e(t){return t.replace(/^([A-Z])/,"$$$1")}function G4e(t){return t.replace(/^\$([A-Z])/,"$1")}function K4e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ci(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function On(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ou(t){var e=t.indexOf(":");return e==-1?{s:ci(t),e:ci(t)}:{s:ci(t.slice(0,e)),e:ci(t.slice(e+1))}}function zn(t,e){return typeof e>"u"||typeof e=="number"?zn(t.s,t.e):(typeof t!="string"&&(t=On(t)),typeof e!="string"&&(e=On(e)),t==e?t:t+":"+e)}function Ea(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=t.length;for(r=0;n<s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function BH(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Od(t.z,r?Oo(e):e)}catch{}try{return t.w=Od((t.XF||{}).numFmtId||(r?14:0),r?Oo(e):e)}catch{return""+e}}function bA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?MA[t.v]||t.v:e==null?BH(t,t.v):BH(t,e))}function Qm(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Vne(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,s=t||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ci(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ea(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var A=0;A!=e[f].length;++A)if(!(typeof e[f][A]>"u")){var h={v:e[f][A]},m=o+f,p=l+A;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),e[f][A]&&typeof e[f][A]=="object"&&!Array.isArray(e[f][A])&&!(e[f][A]instanceof Date))h=e[f][A];else if(Array.isArray(h.v)&&(h.f=e[f][A][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||kn[14],n.cellDates?(h.t="d",h.w=Od(h.z,Oo(h.v))):(h.t="n",h.v=Oo(h.v),h.w=Od(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var x=On({c:p,r:m});s[x]&&s[x].z&&(h.z=s[x].z),s[x]=h}}}return u.s.c<1e7&&(s["!ref"]=zn(u)),s}function y1(t,e){return Vne(null,t,e)}function q4e(t){return t.read_shift(4,"i")}function xf(t,e){return e||(e=dr(4)),e.write_shift(4,t),e}function sc(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Zo(t,e){var r=!1;return e==null&&(r=!0,e=dr(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function z4e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function W4e(t,e){return e||(e=dr(4)),e.write_shift(2,0),e.write_shift(2,0),e}function cR(t,e){var r=t.l,n=t.read_shift(1),a=sc(t),s=[],o={t:a,h:a};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)s.push(z4e(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function X4e(t,e){var r=!1;return e==null&&(r=!0,e=dr(15+4*t.t.length)),e.write_shift(1,0),Zo(t.t,e),r?e.slice(0,e.l):e}var Y4e=cR;function J4e(t,e){var r=!1;return e==null&&(r=!0,e=dr(23+4*t.t.length)),e.write_shift(1,1),Zo(t.t,e),e.write_shift(4,1),W4e({},e),r?e.slice(0,e.l):e}function Qd(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Mg(t,e){return e==null&&(e=dr(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Lg(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ug(t,e){return e==null&&(e=dr(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Z4e=sc,Hne=Zo;function uR(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function GS(t,e){var r=!1;return e==null&&(r=!0,e=dr(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var e5e=sc,Wk=uR,dR=GS;function fR(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?$S([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):vp(e,0)>>2;return r?a/100:a}function $ne(t,e){e==null&&(e=dr(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Gne(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function t5e(t,e){return e||(e=dr(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Qg=Gne,b1=t5e;function nc(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ag(t,e){return(e||dr(8)).write_shift(8,t,"f")}function r5e(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var u=Up[a];u&&(e.rgb=D2(u));break;case 2:e.rgb=D2([o,l,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function KS(t,e){if(e||(e=dr(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function n5e(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function a5e(t,e){e||(e=dr(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function Kne(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function s5e(t){return Kne(t,1)}function i5e(t){return Kne(t,2)}var hR=2,zc=3,HC=11,TH=12,qS=19,$C=64,o5e=65,l5e=71,c5e=4108,u5e=4126,Wo=80,qne=81,d5e=[Wo,qne],Xk={1:{n:"CodePage",t:hR},2:{n:"Category",t:Wo},3:{n:"PresentationFormat",t:Wo},4:{n:"ByteCount",t:zc},5:{n:"LineCount",t:zc},6:{n:"ParagraphCount",t:zc},7:{n:"SlideCount",t:zc},8:{n:"NoteCount",t:zc},9:{n:"HiddenCount",t:zc},10:{n:"MultimediaClipCount",t:zc},11:{n:"ScaleCrop",t:HC},12:{n:"HeadingPairs",t:c5e},13:{n:"TitlesOfParts",t:u5e},14:{n:"Manager",t:Wo},15:{n:"Company",t:Wo},16:{n:"LinksUpToDate",t:HC},17:{n:"CharacterCount",t:zc},19:{n:"SharedDoc",t:HC},22:{n:"HyperlinksChanged",t:HC},23:{n:"AppVersion",t:zc,p:"version"},24:{n:"DigSig",t:o5e},26:{n:"ContentType",t:Wo},27:{n:"ContentStatus",t:Wo},28:{n:"Language",t:Wo},29:{n:"Version",t:Wo},255:{},2147483648:{n:"Locale",t:qS},2147483651:{n:"Behavior",t:qS},1919054434:{}},Yk={1:{n:"CodePage",t:hR},2:{n:"Title",t:Wo},3:{n:"Subject",t:Wo},4:{n:"Author",t:Wo},5:{n:"Keywords",t:Wo},6:{n:"Comments",t:Wo},7:{n:"Template",t:Wo},8:{n:"LastAuthor",t:Wo},9:{n:"RevNumber",t:Wo},10:{n:"EditTime",t:$C},11:{n:"LastPrinted",t:$C},12:{n:"CreatedDate",t:$C},13:{n:"ModifiedDate",t:$C},14:{n:"PageCount",t:zc},15:{n:"WordCount",t:zc},16:{n:"CharCount",t:zc},17:{n:"Thumbnail",t:l5e},18:{n:"Application",t:Wo},19:{n:"DocSecurity",t:zc},255:{},2147483648:{n:"Locale",t:qS},2147483651:{n:"Behavior",t:qS},1919054434:{}},kH={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},f5e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function h5e(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var A5e=h5e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Up=Os(A5e),MA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zne={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jk={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},GC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function AR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function m5e(t){var e=AR();if(!t||!t.match)return e;var r={};if((t.match(cc)||[]).forEach(function(n){var a=Dn(n);switch(a[0].replace(_4e,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Jk[a.ContentType]]!==void 0&&e[Jk[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Po.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Wne(t,e){var r=m4e(Jk),n=[],a;n[n.length]=Xi,n[n.length]=Qr("Types",null,{xmlns:Po.CT,"xmlns:xsd":Po.xsd,"xmlns:xsi":Po.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Qr("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(a=t[c][0],n[n.length]=Qr("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:GC[c][e.bookType]||GC[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Qr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:GC[c][e.bookType]||GC[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Qr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ia={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function O2(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Fb(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(cc)||[]).forEach(function(a){var s=Dn(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Xy(s.Target,e);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function pv(t){var e=[Xi,Qr("Relationships",null,{xmlns:Po.RELS})];return ji(t["!id"]).forEach(function(r){e[e.length]=Qr("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ja(t,e,r,n,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[ia.HLINK,ia.XPATH,ia.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var p5e="application/vnd.oasis.opendocument.spreadsheet";function g5e(t,e){for(var r=aR(t),n,a;n=F2.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Dn(n[0],!1),a.path=="/"&&a.type!==p5e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function x5e(t){var e=[Xi];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function FH(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function v5e(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function y5e(t){var e=[Xi];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(FH(t[r][0],t[r][1])),e.push(v5e("",t[r][0]));return e.push(FH("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Xne(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+LS.version+"</meta:generator></office:meta></office:document-meta>"}var Pd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],b5e=function(){for(var t=new Array(Pd.length),e=0;e<Pd.length;++e){var r=Pd[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Yne(t){var e={};t=cs(t);for(var r=0;r<Pd.length;++r){var n=Pd[r],a=t.match(b5e[r]);a!=null&&a.length>0&&(e[n[1]]=_a(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Fs(e[n[1]]))}return e}function j5(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=rs(e),n[n.length]=r?Qr(t,e,r):Sl(t,e))}function Jne(t,e){var r=e||{},n=[Xi,Qr("cp:coreProperties",null,{"xmlns:cp":Po.CORE_PROPS,"xmlns:dc":Po.dc,"xmlns:dcterms":Po.dcterms,"xmlns:dcmitype":Po.dcmitype,"xmlns:xsi":Po.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&j5("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:zk(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&j5("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:zk(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Pd.length;++s){var o=Pd[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&j5(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Qp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Zne=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function eae(t,e,r,n){var a=[];if(typeof t=="string")a=CH(t,n);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(d){return{v:d}}));var o=typeof e=="string"?CH(e,n).map(function(d){return d.v}):e,l=0,c=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function w5e(t,e,r){var n={};return e||(e={}),t=cs(t),Qp.forEach(function(a){var s=(t.match(T2(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=_a(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&eae(n.HeadingPairs,n.TitlesOfParts,e,r),e}function tae(t){var e=[],r=Qr;return t||(t={}),t.Application="SheetJS",e[e.length]=Xi,e[e.length]=Qr("Properties",null,{xmlns:Po.EXT_PROPS,"xmlns:vt":Po.vt}),Qp.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=rs(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+rs(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var N5e=/<[^>]+>[^<]*/g;function C5e(t,e){var r={},n="",a=t.match(N5e);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=Dn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=_a(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=_a(d);break;case"bool":r[n]=Ps(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Fs(d);break;case"cy":case"error":r[n]=_a(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function rae(t){var e=[Xi,Qr("Properties",null,{xmlns:Po.CUST_PROPS,"xmlns:vt":Po.vt})];if(!t)return e.join("");var r=1;return ji(t).forEach(function(a){++r,e[e.length]=Qr("property",k4e(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rs(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Zk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},P5;function _5e(t,e,r){P5||(P5=lP(Zk)),e=P5[e]||e,t[e]=r}function E5e(t,e){var r=[];return ji(Zk).map(function(n){for(var a=0;a<Pd.length;++a)if(Pd[a][1]==n)return Pd[a];for(a=0;a<Qp.length;++a)if(Qp[a][1]==n)return Qp[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Sl(Zk[n[1]]||n[1],a))}}),Qr("DocumentProperties",r.join(""),{xmlns:Iu.o})}function S5e(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&ji(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Pd.length;++o)if(s==Pd[o][1])return;for(o=0;o<Qp.length;++o)if(s==Qp[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=t[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Qr(yH(s),l,{"dt:dt":c}))}}),e&&ji(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Qr(yH(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Iu.o+'">'+a.join("")+"</"+n+">"}function mR(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function I5e(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=dr(8);return o.write_shift(4,n),o.write_shift(4,a),o}function nae(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function aae(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function sae(t,e,r){return e===31?aae(t):nae(t,e,r)}function eF(t,e,r){return sae(t,e,r===!1?0:4)}function j5e(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return sae(t,e,0)}function P5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Pc,""),t.l-a&2&&(t.l+=2)}return r}function B5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Pc,"");return r}function T5e(t){var e=t.l,r=zS(t,qne);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=zS(t,zc);return[r,n]}function k5e(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(T5e(t));return r}function OH(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Pc,"").replace(Wy,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function iae(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function F5e(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function zS(t,e,r){var n=t.read_shift(2),a,s=r||{};if(t.l+=2,e!==TH&&n!==e&&d5e.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===TH?n:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return nae(t,n,4).replace(Pc,"");case 31:return aae(t);case 64:return mR(t);case 65:return iae(t);case 71:return F5e(t);case 80:return eF(t,n,!s.raw).replace(Pc,"");case 81:return j5e(t,n).replace(Pc,"");case 4108:return k5e(t);case 4126:case 4127:return n==4127?P5e(t):B5e(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function DH(t,e){var r=dr(4),n=dr(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=dr(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=I5e(e);break;case 31:case 80:for(n=dr(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Jo([r,n])}function RH(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=a;++o){var d=t.read_shift(4),f=t.read_shift(4);s[o]=[d,f+r]}s.sort(function(y,b){return y[1]-b[1]});var A={};for(o=0;o!=a;++o){if(t.l!==s[o][1]){var h=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(h=!1,t.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[s[o][0]];if(A[m.n]=zS(t,m.t,{raw:!0}),m.p==="version"&&(A[m.n]=String(A[m.n]>>16)+"."+("0000"+String(A[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(A[m.n]){case 0:A[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ff(l=A[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+A[m.n])}}else if(s[o][0]===1){if(l=A.CodePage=zS(t,hR),ff(l),c!==-1){var p=t.l;t.l=s[c][1],u=OH(t,l),t.l=p}}else if(s[o][0]===0){if(l===0){c=o,t.l=s[o+1][1];continue}u=OH(t,l)}else{var x=u[s[o][0]],v;switch(t[t.l]){case 65:t.l+=4,v=iae(t);break;case 30:t.l+=4,v=eF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=eF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=Ri(t,4);break;case 64:t.l+=4,v=Fs(mR(t));break;default:throw new Error("unparsed value: "+t[t.l])}A[x]=v}}return t.l=r+n,A}var oae=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function O5e(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function MH(t,e,r){var n=dr(8),a=[],s=[],o=8,l=0,c=dr(8),u=dr(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!e){u=dr(8),u.write_shift(4,0),a.unshift(u);var d=[dr(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=dr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Jo(d),s.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(oae.indexOf(t[l][0])>-1||Zne.indexOf(t[l][0])>-1)&&t[l][1]!=null){var A=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof A=="string"){var p=A.split(".");A=(+p[0]<<16)+(+p[1]||0)}c=DH(m.t,A)}else{var x=O5e(A);x==-1&&(x=31,A=String(A)),c=DH(x,A)}s.push(c),u=dr(8),u.write_shift(4,e?h:2+l),a.push(u),o+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Jo([n].concat(a).concat(s))}function LH(t,e,r){var n=t.content;if(!n)return{};_l(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==_n.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=RH(n,e),A={SystemIdentifier:u};for(var h in f)A[h]=f[h];if(A.FMTID=s,a===1)return A;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=RH(n,null)}catch{}for(h in m)A[h]=m[h];return A.FMTID=[s,o],A}function UH(t,e,r,n,a,s){var o=dr(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,_n.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var c=MH(t,r,n);if(l.push(c),a){var u=MH(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Jo(l)}function A0(t,e){return t.read_shift(e),null}function D5e(t,e){e||(e=dr(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function R5e(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Ri(t,e){return t.read_shift(e)===1}function Nc(t,e){return e||(e=dr(2)),e.write_shift(2,+!!t),e}function no(t){return t.read_shift(2,"u")}function gd(t,e){return e||(e=dr(2)),e.write_shift(2,t),e}function lae(t,e){return R5e(t,e,no)}function M5e(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function cae(t,e,r){return r||(r=dr(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Lw(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function L5e(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return a&&(t.l+=4*o),n&&(t.l+=l),c.t=d,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function U5e(t){var e=t.t||"",r=dr(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=dr(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return Jo(a)}function mg(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Uw(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):mg(t,n,r)}function Vg(t,e,r){if(r.biff>5)return Uw(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function uae(t,e,r){return r||(r=dr(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Q5e(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function V5e(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Pc,"");return n&&(t.l+=24),a}function H5e(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Pc,"");return r+o}function $5e(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return V5e(t);case"0303000000000000c000000000000046":return H5e(t);default:throw new Error("Unsupported Moniker "+r)}}function KC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Pc,""):"";return r}function QH(t,e){e||(e=dr(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function G5e(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var s,o,l,c,u="",d,f;a&16&&(s=KC(t,r-t.l)),a&128&&(o=KC(t,r-t.l)),(a&257)===257&&(l=KC(t,r-t.l)),(a&257)===1&&(c=$5e(t,r-t.l)),a&8&&(u=KC(t,r-t.l)),a&32&&(d=t.read_shift(16)),a&64&&(f=mR(t)),t.l=r;var A=o||l||c||"";A&&u&&(A+="#"+u),A||(A="#"+u),a&2&&A.charAt(0)=="/"&&A.charAt(1)!="/"&&(A="file://"+A);var h={Target:A};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function K5e(t){var e=dr(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),QH(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),s&8&&QH(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function dae(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function fae(t,e){var r=dae(t);return r[3]=0,r}function xh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function pg(t,e,r,n){return n||(n=dr(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function q5e(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function z5e(t,e,r){return e===0?"":Vg(t,e,r)}function W5e(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,s,o]}function hae(t){var e=t.read_shift(2),r=fR(t);return[e,r]}function X5e(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=Lw(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,a}function dP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function Aae(t,e){return e||(e=dr(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function mae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var Y5e=mae;function pae(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function J5e(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Z5e(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Kl(t){t.l+=2,t.l+=t.read_shift(2)}var eBe={0:Kl,4:Kl,5:Kl,6:Kl,7:Z5e,8:Kl,9:Kl,10:Kl,11:Kl,12:Kl,13:J5e,14:Kl,15:Kl,16:Kl,17:Kl,18:Kl,19:Kl,20:Kl,21:pae};function tBe(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(eBe[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function qC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function pR(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=dr(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function rBe(t,e){return e===0||t.read_shift(2),1200}function nBe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Vg(t,0,r);return t.read_shift(e+n-t.l),a}function aBe(t,e){var r=!e||e.biff==8,n=dr(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function sBe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function iBe(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Lw(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function oBe(t,e){var r=!e||e.biff>=8?2:1,n=dr(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function lBe(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0;o!=a&&t.l<r;++o)s.push(L5e(t));return s.Count=n,s.Unique=a,s}function cBe(t,e){var r=dr(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=U5e(t[a]);var s=Jo([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function uBe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function dBe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function fBe(t){var e=q5e(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function hBe(t){return t.read_shift(2),t.read_shift(4)}function VH(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function ABe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function mBe(){var t=dr(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function pBe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function gBe(t){var e=dr(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function xBe(){}function vBe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Lw(t,0,r),n}function yBe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,s=dr(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function bBe(t){var e=xh(t);return e.isst=t.read_shift(4),e}function wBe(t,e,r,n){var a=dr(10);return pg(t,e,n,a),a.write_shift(4,r),a}function NBe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=xh(t);r.biff==2&&t.l++;var s=Uw(t,n-t.l,r);return a.val=s,a}function CBe(t,e,r,n,a){var s=!a||a.biff==8,o=dr(8+ +s+(1+s)*r.length);return pg(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function _Be(t,e,r){var n=t.read_shift(2),a=Vg(t,0,r);return[n,a]}function EBe(t,e,r,n){var a=r&&r.biff==5;n||(n=dr(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var SBe=Vg;function HH(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,s=t.read_shift(a),o=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:l},e:{r:o,c}}}function IBe(t,e){var r=e.biff==8||!e.biff?4:2,n=dr(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function jBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=hae(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function PBe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(hae(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function BBe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function TBe(t,e,r,n){var a={},s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=f5e[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function kBe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=TBe(t,e,n.fStyle,r),n}function $H(t,e,r,n){var a=r&&r.biff==5;n||(n=dr(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function FBe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function OBe(t){var e=dr(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function GH(t,e,r){var n=xh(t);(r.biff==2||e==9)&&++t.l;var a=M5e(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function DBe(t,e,r,n,a,s){var o=dr(8);return pg(t,e,n,o),cae(r,s,o),o}function RBe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=xh(t),a=nc(t);return n.val=a,n}function MBe(t,e,r,n){var a=dr(14);return pg(t,e,n,a),Ag(r,a),a}var KH=z5e;function LBe(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=mg(t,s),l=[];n>t.l;)l.push(Uw(t));return[s,a,o,l]}function qH(t,e,r){var n=t.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=X5e(t,e-2,r)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var UBe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function zH(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=mg(t,o,r);a&32&&(u=UBe[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var f=n==t.l||l===0||!(d>0)?[]:tDe(t,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function gae(t,e,r){if(r.biff<8)return QBe(t,e,r);for(var n=[],a=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(W5e(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function QBe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Lw(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function VBe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),s=mg(t,n,r),o=mg(t,a,r);return[s,o]}function HBe(t,e,r){var n=mae(t);t.l++;var a=t.read_shift(1);return e-=8,[rDe(t,e,r),a,n]}function WH(t,e,r){var n=Y5e(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,ZOe(t,e,r)]}function $Be(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function GBe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=Vg(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},l,o,s]}}function KBe(t,e,r){return GBe(t,e,r)}function qBe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(dP(t));return r}function zBe(t){var e=dr(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Aae(t[r],e);return e}function WBe(t,e,r){if(r&&r.biff<8)return YBe(t,e,r);var n=pae(t),a=tBe(t,e-22,n[1]);return{cmo:n,ft:a}}var XBe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function YBe(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((XBe[n]||lc)(t,e,r)),{cmo:[a,n,s],ft:o}}function JBe(t,e,r){var n=t.l,a="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=Q5e(t,6,r);var l=t.read_shift(2);t.read_shift(2),no(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],f=mg(t,t.lens[u+1]-t.lens[u]-1);if(a+=f,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function ZBe(t,e){var r=dP(t);t.l+=16;var n=G5e(t,e-24);return[r,n]}function eTe(t){var e=dr(24),r=ci(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return Jo([e,K5e(t[1])])}function tTe(t,e){t.read_shift(2);var r=dP(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Pc,""),[r,n]}function rTe(t){var e=t[1].Tooltip,r=dr(10+2*(e.length+1));r.write_shift(2,2048);var n=ci(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function nTe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=kH[r]||r,r=t.read_shift(2),e[1]=kH[r]||r,e}function aTe(t){return t||(t=dr(4)),t.write_shift(2,1),t.write_shift(2,1),t}function sTe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(fae(t));return r}function iTe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(fae(t));return r}function oTe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function xae(t,e,r){if(!r.cellStyles)return lc(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function lTe(t,e){var r=dr(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function cTe(t,e){var r={};return e<32||(t.l+=16,r.header=nc(t),r.footer=nc(t),t.l+=2),r}function uTe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function dTe(t){for(var e=dr(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var fTe=xh,hTe=lae,ATe=Uw;function mTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function pTe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=xh(t);++t.l;var a=Vg(t,e-7,r);return n.t="str",n.val=a,n}function gTe(t){var e=xh(t);++t.l;var r=nc(t);return e.t="n",e.val=r,e}function xTe(t,e,r){var n=dr(15);return $w(n,t,e),n.write_shift(8,r,"f"),n}function vTe(t){var e=xh(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function yTe(t,e,r){var n=dr(9);return $w(n,t,e),n.write_shift(2,r),n}function bTe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function wTe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function NTe(t,e,r){var n=t.l+e,a=xh(t),s=t.read_shift(2),o=mg(t,s,r);return t.l=n,a.t="str",a.val=o,a}var CTe=[2,3,48,49,131,139,140,245],tF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=lP({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Sm(1);switch(c.type){case"base64":d=Pu(Hu(l));break;case"binary":d=Pu(l);break;case"buffer":case"array":d=l;break}_l(d,0);var f=d.read_shift(1),A=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,A=!0;break;case 49:h=!0,A=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=d.read_shift(2));var v=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=t[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var b=[],w={},j=Math.min(d.length,f==2?521:x-10-(h?264:0)),I=m?32:11;d.l<j&&d[d.l]!=13;)switch(w={},w.name=j2.utils.decode(y,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,w.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),f==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&b.push(w),f!=2&&(d.l+=m?13:14),w.type){case"B":(!h||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var _=0,S=0;for(u[0]=[],S=0;S!=b.length;++S)u[0][S]=b[S].name;for(;p-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++_]=[],S=0,S=0;S!=b.length;++S){var E=d.slice(d.l,d.l+b[S].len);d.l+=b[S].len,_l(E,0);var B=j2.utils.decode(y,E);switch(b[S].type){case"C":B.trim().length&&(u[_][S]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[_][S]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[_][S]=B;break;case"F":u[_][S]=parseFloat(B.trim());break;case"+":case"I":u[_][S]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[_][S]=!0;break;case"N":case"F":u[_][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!A)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[_][S]="##MEMO##"+(m?parseInt(B.trim(),10):E.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[_][S]=+B||0);break;case"@":u[_][S]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[_][S]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[_][S]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][S]=-E.read_shift(-8,"f");break;case"B":if(h&&b[S].len==8){u[_][S]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=y1(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{return Qm(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&ff(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=iu(),f=YS(l,{header:1,raw:!0,cellDates:!0}),A=f[0],h=f.slice(1),m=l["!cols"]||[],p=0,x=0,v=0,y=1;for(p=0;p<A.length;++p){if(((m[p]||{}).DBF||{}).name){A[p]=m[p].DBF.name,++v;continue}if(A[p]!=null){if(++v,typeof A[p]=="number"&&(A[p]=A[p].toString(10)),typeof A[p]!="string")throw new Error("DBF Invalid column name "+A[p]+" |"+typeof A[p]+"|");if(A.indexOf(A[p])!==p){for(x=0;x<1024;++x)if(A.indexOf(A[p]+"_"+x)==-1){A[p]+="_"+x;break}}}}var b=Ea(l["!ref"]),w=[],j=[],I=[];for(p=0;p<=b.e.c-b.s.c;++p){var _="",S="",E=0,B=[];for(x=0;x<h.length;++x)h[x][p]!=null&&B.push(h[x][p]);if(B.length==0||A[p]==null){w[p]="?";continue}for(x=0;x<B.length;++x){switch(typeof B[x]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=B[x]instanceof Date?"D":"C";break;default:S="C"}E=Math.max(E,String(B[x]).length),_=_&&_!=S?"C":S}E>250&&(E=250),S=((m[p]||{}).DBF||{}).type,S=="C"&&m[p].DBF.len>E&&(E=m[p].DBF.len),_=="B"&&S=="N"&&(_="N",I[p]=m[p].DBF.dec,E=m[p].DBF.len),j[p]=_=="C"||S=="N"?E:s[_]||0,y+=j[p],w[p]=_}var T=d.next(32);for(T.write_shift(4,318902576),T.write_shift(4,h.length),T.write_shift(2,296+32*v),T.write_shift(2,y),p=0;p<4;++p)T.write_shift(4,0);for(T.write_shift(4,0|(+e[one]||3)<<8),p=0,x=0;p<A.length;++p)if(A[p]!=null){var P=d.next(32),O=(A[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,O,"sbcs"),P.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),P.write_shift(4,x),P.write_shift(1,j[p]||s[w[p]]||0),P.write_shift(1,I[p]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),x+=j[p]||s[w[p]]||0}var z=d.next(264);for(z.write_shift(4,13),p=0;p<65;++p)z.write_shift(4,0);for(p=0;p<h.length;++p){var ce=d.next(y);for(ce.write_shift(1,0),x=0;x<A.length;++x)if(A[x]!=null)switch(w[x]){case"L":ce.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":ce.write_shift(8,h[p][x]||0,"f");break;case"N":var de="0";for(typeof h[p][x]=="number"&&(de=h[p][x].toFixed(I[x]||0)),v=0;v<j[x]-de.length;++v)ce.write_shift(1,32);ce.write_shift(1,de,"sbcs");break;case"D":h[p][x]?(ce.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(h[p][x]!=null?h[p][x]:"").slice(0,j[x]);for(ce.write_shift(1,ue,"sbcs"),v=0;v<j[x]-ue.length;++v)ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),vae=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ji(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(A,h){var m=t[h];return typeof m=="number"?iH(m):m},n=function(A,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?A:iH(p)};t["|"]=254;function a(A,h){switch(h.type){case"base64":return s(Hu(A),h);case"binary":return s(A,h);case"buffer":return s(ea&&Buffer.isBuffer(A)?A.toString("binary"):Um(A),h);case"array":return s(hg(A),h)}throw new Error("Unrecognized type "+h.type)}function s(A,h){var m=A.split(/[\n\r]+/),p=-1,x=-1,v=0,y=0,b=[],w=[],j=null,I={},_=[],S=[],E=[],B=0,T;for(+h.codepage>=0&&ff(+h.codepage);v!==m.length;++v){B=0;var P=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),O=P.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),z=O[0],ce;if(P.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&w.push(P.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,ue=!1,me=!1,se=!1,ke=-1,Re=-1;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"A":break;case"X":x=parseInt(O[y].slice(1))-1,ue=!0;break;case"Y":for(p=parseInt(O[y].slice(1))-1,ue||(x=0),T=b.length;T<=p;++T)b[T]=[];break;case"K":ce=O[y].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(gf(ce))?isNaN(Lv(ce).getDate())||(ce=Fs(ce)):(ce=gf(ce),j!==null&&x1(j)&&(ce=uP(ce))),de=!0;break;case"E":se=!0;var F=gv(O[y].slice(1),{r:p,c:x});b[p][x]=[b[p][x],F];break;case"S":me=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":ke=parseInt(O[y].slice(1))-1;break;case"C":Re=parseInt(O[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(de&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=ce:b[p][x]=ce,j=null),me){if(se)throw new Error("SYLK shared formula cannot have own formula");var H=ke>-1&&b[ke][Re];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=Rae(H[1],{r:p-ke,c:x-Re})}break;case"F":var K=0;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"X":x=parseInt(O[y].slice(1))-1,++K;break;case"Y":for(p=parseInt(O[y].slice(1))-1,T=b.length;T<=p;++T)b[T]=[];break;case"M":B=parseInt(O[y].slice(1))/20;break;case"F":break;case"G":break;case"P":j=w[parseInt(O[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=O[y].slice(1).split(" "),T=parseInt(E[0],10);T<=parseInt(E[1],10);++T)B=parseInt(E[2],10),S[T-1]=B===0?{hidden:!0}:{wch:B},Im(S[T-1]);break;case"C":x=parseInt(O[y].slice(1))-1,S[x]||(S[x]={});break;case"R":p=parseInt(O[y].slice(1))-1,_[p]||(_[p]={}),B>0?(_[p].hpt=B,_[p].hpx=Qv(B)):B===0&&(_[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}K<1&&(j=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return _.length>0&&(I["!rows"]=_),S.length>0&&(I["!cols"]=S),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,I]}function o(A,h){var m=a(A,h),p=m[0],x=m[1],v=y1(p,h);return ji(x).forEach(function(y){v[y]=x[y]}),v}function l(A,h){return Qm(o(A,h),h)}function c(A,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(A.t){case"n":x+=A.v||0,A.f&&!A.F&&(x+=";E"+wR(A.f,{r:m,c:p}));break;case"b":x+=A.v?"TRUE":"FALSE";break;case"e":x+=A.w||A.v;break;case"d":x+='"'+(A.w||A.v)+'"';break;case"s":x+='"'+A.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(A,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=R2(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=M2(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&A.push(x)})}function d(A,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*L2(m.hpx)+";"),x.length>2&&A.push(x+"R"+(p+1))})}function f(A,h){var m=["ID;PWXL;N;E"],p=[],x=Ea(A["!ref"]),v,y=Array.isArray(A),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),A["!cols"]&&u(m,A["!cols"]),A["!rows"]&&d(m,A["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var w=x.s.r;w<=x.e.r;++w)for(var j=x.s.c;j<=x.e.c;++j){var I=On({r:w,c:j});v=y?(A[w]||[])[j]:A[I],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,A,w,j))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),yae=function(){function t(s,o){switch(o.type){case"base64":return e(Hu(s),o);case"binary":return e(s,o);case"buffer":return e(ea&&Buffer.isBuffer(s)?s.toString("binary"):Um(s),o);case"array":return e(hg(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var A=l[d].trim().split(","),h=A[0],m=A[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(gf(m))?isNaN(Lv(m).getDate())?f[c][u]=m:f[c][u]=Fs(m):f[c][u]=gf(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return y1(t(s,o),o)}function n(s,o){return Qm(r(s,o),o)}var a=function(){var s=function(c,u,d,f,A){c.push(u),c.push(d+","+f),c.push('"'+A.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ea(c["!ref"]),f,A=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var p=On({r:h,c:m});if(f=A?(c[h]||[])[m]:c[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,x,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Od(f.z||kn[14],Oo(Fs(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),bae=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,A){for(var h=f.split(`
`),m=-1,p=-1,x=0,v=[];x!==h.length;++x){var y=h[x].trim().split(":");if(y[0]==="cell"){var b=ci(y[1]);if(v.length<=b.r)for(m=v.length;m<=b.r;++m)v[m]||(v[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":v[m][p]=t(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],w])}}}return A&&A.sheetRows&&(v=v.slice(0,A.sheetRows)),v}function n(f,A){return y1(r(f,A),A)}function a(f,A){return Qm(n(f,A),A)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var A=[],h=[],m,p="",x=ou(f["!ref"]),v=Array.isArray(f),y=x.s.r;y<=x.e.r;++y)for(var b=x.s.c;b<=x.e.c;++b)if(p=On({r:y,c:b}),m=v?(f[y]||[])[b]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var w=Oo(Fs(m.v));h[2]="vtc",h[3]="nd",h[4]=""+w,h[5]=m.w||Od(m.z||kn[14],w);break;case"e":continue}A.push(h.join(":"))}return A.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),A.push("valueformat:1:text-wiki"),A.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Uv=function(){function t(d,f,A,h,m){m.raw?f[A][h]=d:d===""||(d==="TRUE"?f[A][h]=!0:d==="FALSE"?f[A][h]=!1:isNaN(gf(d))?isNaN(Lv(d).getDate())?f[A][h]=d:f[A][h]=Fs(d):f[A][h]=gf(d))}function e(d,f){var A=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,x=Math.max(x,v);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,x).trim(),h,y,b,A),b=1;b<=(m[y].length-x)/10+1;++b)t(m[y].slice(x+(b-1)*10,x+b*10).trim(),h,y,b,A)}return A.sheetRows&&(h=h.slice(0,A.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},A=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?A=!A:!A&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function s(d,f){var A=f||{},h="",m=A.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):A&&A.FS?h=A.FS:h=a(d.slice(0,1024));var x=0,v=0,y=0,b=0,w=0,j=h.charCodeAt(0),I=!1,_=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=A.dateNF!=null?u4e(A.dateNF):null;function B(){var T=d.slice(b,w),P={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)P.t="z";else if(A.raw)P.t="s",P.v=T;else if(T.trim().length===0)P.t="s",P.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(P.t="s",P.v=T.slice(2,-1).replace(/""/g,'"')):LFe(T)?(P.t="n",P.f=T.slice(1)):(P.t="s",P.v=T);else if(T=="TRUE")P.t="b",P.v=!0;else if(T=="FALSE")P.t="b",P.v=!1;else if(!isNaN(y=gf(T)))P.t="n",A.cellText!==!1&&(P.w=T),P.v=y;else if(!isNaN(Lv(T).getDate())||E&&T.match(E)){P.z=A.dateNF||kn[14];var O=0;E&&T.match(E)&&(T=d4e(T,A.dateNF,T.match(E)||[]),O=1),A.cellDates?(P.t="d",P.v=Fs(T,O)):(P.t="n",P.v=Oo(Fs(T,O))),A.cellText!==!1&&(P.w=Od(P.z,P.v instanceof Date?Oo(P.v):P.v)),A.cellNF||delete P.z}else P.t="s",P.v=T;if(P.t=="z"||(A.dense?(m[x]||(m[x]=[]),m[x][v]=P):m[On({c:v,r:x})]=P),b=w+1,S=d.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<x&&(p.e.r=x),_==j)++v;else if(v=0,++x,A.sheetRows&&A.sheetRows<=x)return!0}e:for(;w<d.length;++w)switch(_=d.charCodeAt(w)){case 34:S===34&&(I=!I);break;case j:case 10:case 13:if(!I&&B())break e;break}return w-b>0&&B(),m["!ref"]=zn(p),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):y1(e(d,f),f)}function l(d,f){var A="",h=f.type=="string"?[0,0,0,0]:PR(d,f);switch(f.type){case"base64":A=Hu(d);break;case"binary":A=d;break;case"buffer":f.codepage==65001?A=d.toString("utf8"):f.codepage&&typeof j2<"u"||(A=ea&&Buffer.isBuffer(d)?d.toString("binary"):Um(d));break;case"array":A=hg(d);break;case"string":A=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?A=cs(A.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?A=cs(A):f.type=="binary"&&typeof j2<"u",A.slice(0,19)=="socialcalc:version:"?bae.to_sheet(f.type=="string"?A:cs(A),f):o(A,f)}function c(d,f){return Qm(l(d,f),f)}function u(d){for(var f=[],A=Ea(d["!ref"]),h,m=Array.isArray(d),p=A.s.r;p<=A.e.r;++p){for(var x=[],v=A.s.c;v<=A.e.c;++v){var y=On({r:p,c:v});if(h=m?(d[p]||[])[v]:d[y],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(bA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(v===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function _Te(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=vae.to_workbook(t,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Uv.to_workbook(t,e)}}var Vp=function(){function t(F,H,K){if(F){_l(F,F.l||0);for(var L=K.Enum||ke;F.l<F.length;){var W=F.read_shift(2),Y=L[W]||L[65535],D=F.read_shift(2),Q=F.l+D,ee=Y.f&&Y.f(F,D,K);if(F.l=Q,H(ee,Y,W))return}}}function e(F,H){switch(H.type){case"base64":return r(Pu(Hu(F)),H);case"binary":return r(Pu(F),H);case"buffer":case"array":return r(F,H)}throw"Unsupported type "+H.type}function r(F,H){if(!F)return F;var K=H||{},L=K.dense?[]:{},W="Sheet1",Y="",D=0,Q={},ee=[],ve=[],M={s:{r:0,c:0},e:{r:0,c:0}},Ye=K.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)K.Enum=ke,t(F,function(le,$e,Xe){switch(Xe){case 0:K.vers=le,le>=4096&&(K.qpro=!0);break;case 6:M=le;break;case 204:le&&(Y=le);break;case 222:Y=le;break;case 15:case 51:K.qpro||(le[1].v=le[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(le[2]&112)==112&&(le[2]&15)>1&&(le[2]&15)<15&&(le[1].z=K.dateNF||kn[14],K.cellDates&&(le[1].t="d",le[1].v=uP(le[1].v))),K.qpro&&le[3]>D&&(L["!ref"]=zn(M),Q[W]=L,ee.push(W),L=K.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},D=le[3],W=Y||"Sheet"+(D+1),Y="");var it=K.dense?(L[le[0].r]||[])[le[0].c]:L[On(le[0])];if(it){it.t=le[1].t,it.v=le[1].v,le[1].z!=null&&(it.z=le[1].z),le[1].f!=null&&(it.f=le[1].f);break}K.dense?(L[le[0].r]||(L[le[0].r]=[]),L[le[0].r][le[0].c]=le[1]):L[On(le[0])]=le[1];break}},K);else if(F[2]==26||F[2]==14)K.Enum=Re,F[2]==14&&(K.qpro=!0,F.l=0),t(F,function(le,$e,Xe){switch(Xe){case 204:W=le;break;case 22:le[1].v=le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(le[3]>D&&(L["!ref"]=zn(M),Q[W]=L,ee.push(W),L=K.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},D=le[3],W="Sheet"+(D+1)),Ye>0&&le[0].r>=Ye)break;K.dense?(L[le[0].r]||(L[le[0].r]=[]),L[le[0].r][le[0].c]=le[1]):L[On(le[0])]=le[1],M.e.c<le[0].c&&(M.e.c=le[0].c),M.e.r<le[0].r&&(M.e.r=le[0].r);break;case 27:le[14e3]&&(ve[le[14e3][0]]=le[14e3][1]);break;case 1537:ve[le[0]]=le[1],le[0]==D&&(W=le[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(L["!ref"]=zn(M),Q[Y||W]=L,ee.push(Y||W),!ve.length)return{SheetNames:ee,Sheets:Q};for(var ae={},X=[],De=0;De<ve.length;++De)Q[ee[De]]?(X.push(ve[De]||ee[De]),ae[ve[De]]=Q[ve[De]]||Q[ee[De]]):(X.push(ve[De]),ae[ve[De]]={"!ref":"A1"});return{SheetNames:X,Sheets:ae}}function n(F,H){var K=H||{};if(+K.codepage>=0&&ff(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var L=iu(),W=Ea(F["!ref"]),Y=Array.isArray(F),D=[];Vr(L,0,s(1030)),Vr(L,6,c(W));for(var Q=Math.min(W.e.r,8191),ee=W.s.r;ee<=Q;++ee)for(var ve=zi(ee),M=W.s.c;M<=W.e.c;++M){ee===W.s.r&&(D[M]=li(M));var Ye=D[M]+ve,ae=Y?(F[ee]||[])[M]:F[Ye];if(!(!ae||ae.t=="z"))if(ae.t=="n")(ae.v|0)==ae.v&&ae.v>=-32768&&ae.v<=32767?Vr(L,13,h(ee,M,ae.v)):Vr(L,14,p(ee,M,ae.v));else{var X=bA(ae);Vr(L,15,f(ee,M,X.slice(0,239)))}}return Vr(L,1),L.end()}function a(F,H){var K=H||{};if(+K.codepage>=0&&ff(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var L=iu();Vr(L,0,o(F));for(var W=0,Y=0;W<F.SheetNames.length;++W)(F.Sheets[F.SheetNames[W]]||{})["!ref"]&&Vr(L,27,se(F.SheetNames[W],Y++));var D=0;for(W=0;W<F.SheetNames.length;++W){var Q=F.Sheets[F.SheetNames[W]];if(!(!Q||!Q["!ref"])){for(var ee=Ea(Q["!ref"]),ve=Array.isArray(Q),M=[],Ye=Math.min(ee.e.r,8191),ae=ee.s.r;ae<=Ye;++ae)for(var X=zi(ae),De=ee.s.c;De<=ee.e.c;++De){ae===ee.s.r&&(M[De]=li(De));var le=M[De]+X,$e=ve?(Q[ae]||[])[De]:Q[le];if(!(!$e||$e.t=="z"))if($e.t=="n")Vr(L,23,B(ae,De,D,$e.v));else{var Xe=bA($e);Vr(L,22,_(ae,De,D,Xe.slice(0,239)))}}++D}}return Vr(L,1),L.end()}function s(F){var H=dr(2);return H.write_shift(2,F),H}function o(F){var H=dr(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var K=0,L=0,W=0,Y=0;Y<F.SheetNames.length;++Y){var D=F.SheetNames[Y],Q=F.Sheets[D];if(!(!Q||!Q["!ref"])){++W;var ee=ou(Q["!ref"]);K<ee.e.r&&(K=ee.e.r),L<ee.e.c&&(L=ee.e.c)}}return K>8191&&(K=8191),H.write_shift(2,K),H.write_shift(1,W),H.write_shift(1,L),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(F,H,K){var L={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&K.qpro?(L.s.c=F.read_shift(1),F.l++,L.s.r=F.read_shift(2),L.e.c=F.read_shift(1),F.l++,L.e.r=F.read_shift(2),L):(L.s.c=F.read_shift(2),L.s.r=F.read_shift(2),H==12&&K.qpro&&(F.l+=2),L.e.c=F.read_shift(2),L.e.r=F.read_shift(2),H==12&&K.qpro&&(F.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(F){var H=dr(8);return H.write_shift(2,F.s.c),H.write_shift(2,F.s.r),H.write_shift(2,F.e.c),H.write_shift(2,F.e.r),H}function u(F,H,K){var L=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(L[0].c=F.read_shift(1),L[3]=F.read_shift(1),L[0].r=F.read_shift(2),F.l+=2):(L[2]=F.read_shift(1),L[0].c=F.read_shift(2),L[0].r=F.read_shift(2)),L}function d(F,H,K){var L=F.l+H,W=u(F,H,K);if(W[1].t="s",K.vers==20768){F.l++;var Y=F.read_shift(1);return W[1].v=F.read_shift(Y,"utf8"),W}return K.qpro&&F.l++,W[1].v=F.read_shift(L-F.l,"cstr"),W}function f(F,H,K){var L=dr(7+K.length);L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,F),L.write_shift(1,39);for(var W=0;W<L.length;++W){var Y=K.charCodeAt(W);L.write_shift(1,Y>=128?95:Y)}return L.write_shift(1,0),L}function A(F,H,K){var L=u(F,H,K);return L[1].v=F.read_shift(2,"i"),L}function h(F,H,K){var L=dr(7);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,F),L.write_shift(2,K,"i"),L}function m(F,H,K){var L=u(F,H,K);return L[1].v=F.read_shift(8,"f"),L}function p(F,H,K){var L=dr(13);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,F),L.write_shift(8,K,"f"),L}function x(F,H,K){var L=F.l+H,W=u(F,H,K);if(W[1].v=F.read_shift(8,"f"),K.qpro)F.l=L;else{var Y=F.read_shift(2);w(F.slice(F.l,F.l+Y),W),F.l+=Y}return W}function v(F,H,K){var L=H&32768;return H&=-32769,H=(L?F:0)+(H>=8192?H-16384:H),(L?"":"$")+(K?li(H):zi(H))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(F,H){_l(F,0);for(var K=[],L=0,W="",Y="",D="",Q="";F.l<F.length;){var ee=F[F.l++];switch(ee){case 0:K.push(F.read_shift(8,"f"));break;case 1:Y=v(H[0].c,F.read_shift(2),!0),W=v(H[0].r,F.read_shift(2),!1),K.push(Y+W);break;case 2:{var ve=v(H[0].c,F.read_shift(2),!0),M=v(H[0].r,F.read_shift(2),!1);Y=v(H[0].c,F.read_shift(2),!0),W=v(H[0].r,F.read_shift(2),!1),K.push(ve+M+":"+Y+W)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(F.read_shift(2));break;case 6:{for(var Ye="";ee=F[F.l++];)Ye+=String.fromCharCode(ee);K.push('"'+Ye.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:Q=K.pop(),D=K.pop(),K.push(["AND","OR"][ee-20]+"("+D+","+Q+")");break;default:if(ee<32&&b[ee])Q=K.pop(),D=K.pop(),K.push(D+b[ee]+Q);else if(y[ee]){if(L=y[ee][1],L==69&&(L=F[F.l++]),L>K.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+K.join("|")+"|");return}var ae=K.slice(-L);K.length-=L,K.push(y[ee][0]+"("+ae.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}K.length==1?H[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function j(F){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=F.read_shift(2),H[3]=F[F.l++],H[0].c=F[F.l++],H}function I(F,H){var K=j(F);return K[1].t="s",K[1].v=F.read_shift(H-4,"cstr"),K}function _(F,H,K,L){var W=dr(6+L.length);W.write_shift(2,F),W.write_shift(1,K),W.write_shift(1,H),W.write_shift(1,39);for(var Y=0;Y<L.length;++Y){var D=L.charCodeAt(Y);W.write_shift(1,D>=128?95:D)}return W.write_shift(1,0),W}function S(F,H){var K=j(F);K[1].v=F.read_shift(2);var L=K[1].v>>1;if(K[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return K[1].v=L,K}function E(F,H){var K=j(F),L=F.read_shift(4),W=F.read_shift(4),Y=F.read_shift(2);if(Y==65535)return L===0&&W===3221225472?(K[1].t="e",K[1].v=15):L===0&&W===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var D=Y&32768;return Y=(Y&32767)-16446,K[1].v=(1-D*2)*(W*Math.pow(2,Y+32)+L*Math.pow(2,Y)),K}function B(F,H,K,L){var W=dr(14);if(W.write_shift(2,F),W.write_shift(1,K),W.write_shift(1,H),L==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var Y=0,D=0,Q=0,ee=0;return L<0&&(Y=1,L=-L),D=Math.log2(L)|0,L/=Math.pow(2,D-31),ee=L>>>0,ee&2147483648||(L/=2,++D,ee=L>>>0),L-=ee,ee|=2147483648,ee>>>=0,L*=Math.pow(2,32),Q=L>>>0,W.write_shift(4,Q),W.write_shift(4,ee),D+=16383+(Y?32768:0),W.write_shift(2,D),W}function T(F,H){var K=E(F);return F.l+=H-14,K}function P(F,H){var K=j(F),L=F.read_shift(4);return K[1].v=L>>6,K}function O(F,H){var K=j(F),L=F.read_shift(8,"f");return K[1].v=L,K}function z(F,H){var K=O(F);return F.l+=H-10,K}function ce(F,H){return F[F.l+H-1]==0?F.read_shift(H,"cstr"):""}function de(F,H){var K=F[F.l++];K>H-1&&(K=H-1);for(var L="";L.length<K;)L+=String.fromCharCode(F[F.l++]);return L}function ue(F,H,K){if(!(!K.qpro||H<21)){var L=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var W=F.read_shift(H-21,"cstr");return[L,W]}}function me(F,H){for(var K={},L=F.l+H;F.l<L;){var W=F.read_shift(2);if(W==14e3){for(K[W]=[0,""],K[W][0]=F.read_shift(2);F[F.l];)K[W][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return K}function se(F,H){var K=dr(5+F.length);K.write_shift(2,14e3),K.write_shift(2,H);for(var L=0;L<F.length;++L){var W=F.charCodeAt(L);K[K.l++]=W>127?95:W}return K[K.l++]=0,K}var ke={0:{n:"BOF",f:no},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},Re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function ETe(t){var e={},r=t.match(cc),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Dn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=q6[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var STe=function(){var t=T2("t"),e=T2("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:_a(o[1])},c=s.match(e);return c&&(l.s=ETe(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),ITe=function(){var e=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),jTe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,PTe=/<(?:\w+:)?r>/,BTe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function gR(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=_a(cs(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=cs(t),r&&(n.h=nR(n.t))):t.match(PTe)&&(n.r=cs(t),n.t=_a(cs((t.replace(BTe,"").match(jTe)||[]).join("").replace(cc,""))),r&&(n.h=ITe(STe(n.r)))),n):{t:""}}var TTe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kTe=/<(?:\w+:)?(?:si|sstItem)>/g,FTe=/<\/(?:\w+:)?(?:si|sstItem)>/;function OTe(t,e){var r=[],n="";if(!t)return r;var a=t.match(TTe);if(a){n=a[2].replace(kTe,"").split(FTe);for(var s=0;s!=n.length;++s){var o=gR(n[s].trim(),e);o!=null&&(r[r.length]=o)}a=Dn(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var DTe=/^\s|\s$|[\t\n\r]/;function wae(t,e){if(!e.bookSST)return"";var r=[Xi];r[r.length]=Qr("sst",null,{xmlns:Rg[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(DTe)&&(s+=' xml:space="preserve"'),s+=">"+rs(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function RTe(t){return[t.read_shift(4),t.read_shift(4)]}function MTe(t,e){var r=[],n=!1;return RA(t,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function LTe(t,e){return e||(e=dr(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var UTe=X4e;function QTe(t){var e=iu();Er(e,159,LTe(t));for(var r=0;r<t.length;++r)Er(e,19,UTe(t[r]));return Er(e,160),e.end()}function Nae(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function cA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function VTe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=cA(t,4),e.U=cA(t,4),e.W=cA(t,4),e}function HTe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function $Te(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(HTe(t));return e}function GTe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function KTe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=cA(t,4),e.U=cA(t,4),e.W=cA(t,4),e}function qTe(t){var e=KTe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Cae(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function _ae(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function zTe(t){var e=cA(t);switch(e.Minor){case 2:return[e.Minor,WTe(t)];case 3:return[e.Minor,XTe()];case 4:return[e.Minor,YTe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function WTe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Cae(t,r),a=_ae(t,t.length-t.l);return{t:"Std",h:n,v:a}}function XTe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function YTe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(cc,function(s){var o=Dn(s);switch(gh(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function JTe(t,e){var r={},n=r.EncryptionVersionInfo=cA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=Cae(t,a),e-=a,r.EncryptionVerifier=_ae(t,e),r}function ZTe(t){var e={},r=e.EncryptionVersionInfo=cA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function xR(t){var e=0,r,n=Nae(t),a=n.length+1,s,o,l,c,u;for(r=Sm(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=e&16384?1:0,c=e<<1&32767,u=l|c,e=u^o;return e^52811}var Eae=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=e[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=Nae(o),c=s(l),u=l.length,d=Sm(16),f=0;f!=16;++f)d[f]=0;var A,h,m;for((u&1)===1&&(A=c>>8,d[u]=a(t[0],A),--u,A=c&255,h=l[l.length-1],d[u]=a(h,A));u>0;)--u,A=c>>8,d[u]=a(l[u],A),--u,A=c&255,d[u]=a(l[u],A);for(u=15,m=15-l.length;m>0;)A=c>>8,d[u]=a(t[m],A),--u,--m,A=c&255,d[u]=a(l[u],A),--u,--m;return d}}(),eke=function(t,e,r,n,a){a||(a=e),n||(n=Eae(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},tke=function(t){var e=0,r=Eae(t);return function(n){var a=eke("",n,e,r);return e=a[1],a[0]}};function rke(t,e,r,n){var a={key:no(t),verificationBytes:no(t)};return r.password&&(a.verifier=xR(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=tke(r.password)),a}function nke(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=ZTe(t):n.Data=JTe(t,e),n}function ake(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?nke(t,e-2,n):rke(t,r.biff>=8?e:e-2,r,n),n}var Sae=function(){function t(a,s){switch(s.type){case"base64":return e(Hu(a),s);case"binary":return e(a,s);case"buffer":return e(ea&&Buffer.isBuffer(a)?a.toString("binary"):Um(a),s);case"array":return e(hg(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var A=/\\\w+\b/g,h=0,m,p=-1;m=A.exec(d);){switch(m[0]){case"\\cell":var x=d.slice(h,A.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var v={v:x,t:"s"};Array.isArray(l)?l[f][p]=v:l[On({r:f,c:p})]=v}break}h=A.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=zn(u),l}function r(a,s){return Qm(t(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=Ea(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=On({r:u,c:d});l=c?(a[u]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(bA(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function ske(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function D2(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function ike(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),s=Math.min(e,r,n),o=a-s;if(o===0)return[0,0,e];var l=0,c=0,u=a+s;switch(c=o/(u>1?2-u:u),a){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,u/2]}function oke(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function WS(t,e){if(e===0)return t;var r=ike(ske(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),D2(oke(r))}var Iae=6,lke=15,cke=1,rc=Iae;function R2(t){return Math.floor((t+Math.round(128/rc)/256)*rc)}function M2(t){return Math.floor((t-5)/rc*100+.5)/100}function XS(t){return Math.round((t*rc+5)/rc*256)/256}function B5(t){return XS(M2(R2(t)))}function vR(t){var e=Math.abs(t-B5(t)),r=rc;if(e>.005)for(rc=cke;rc<lke;++rc)Math.abs(t-B5(t))<=e&&(e=Math.abs(t-B5(t)),r=rc);rc=r}function Im(t){t.width?(t.wpx=R2(t.width),t.wch=M2(t.wpx),t.MDW=rc):t.wpx?(t.wch=M2(t.wpx),t.width=XS(t.wch),t.MDW=rc):typeof t.wch=="number"&&(t.width=XS(t.wch),t.wpx=R2(t.width),t.MDW=rc),t.customWidth&&delete t.customWidth}var uke=96,jae=uke;function L2(t){return t*96/jae}function Qv(t){return t*jae/96}var dke={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fke(t,e,r,n){e.Borders=[];var a={},s=!1;(t[0].match(cc)||[]).forEach(function(o){var l=Dn(o);switch(gh(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Ps(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Ps(l.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function hke(t,e,r,n){e.Fills=[];var a={},s=!1;(t[0].match(cc)||[]).forEach(function(o){var l=Dn(o);switch(gh(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function Ake(t,e,r,n){e.Fonts=[];var a={},s=!1;(t[0].match(cc)||[]).forEach(function(o){var l=Dn(o);switch(gh(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=cs(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Ps(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Ps(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Ps(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Ps(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Ps(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Ps(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Ps(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=q6[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Ps(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Up[a.color.index];a.color.index==81&&(c=Up[1]),c||(c=Up[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=WS(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function mke(t,e,r){e.NumberFmt=[];for(var n=ji(kn),a=0;a<n.length;++a)e.NumberFmt[n[a]]=kn[n[a]];var s=t[0].match(cc);if(s)for(a=0;a<s.length;++a){var o=Dn(s[a]);switch(gh(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=_a(cs(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}lA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function pke(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Qr("numFmt",null,{numFmtId:n,formatCode:rs(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Qr("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var zC=["numFmtId","fillId","fontId","borderId","xfId"],WC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function gke(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(cc)||[]).forEach(function(s){var o=Dn(s),l=0;switch(gh(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<zC.length;++l)n[zC[l]]&&(n[zC[l]]=parseInt(n[zC[l]],10));for(l=0;l<WC.length;++l)n[WC[l]]&&(n[WC[l]]=Ps(n[WC[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Ps(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function xke(t){var e=[];return e[e.length]=Qr("cellXfs",null),t.forEach(function(r){e[e.length]=Qr("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Qr("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var vke=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(e))&&mke(f,d,u),(f=l.match(a))&&Ake(f,d,c,u),(f=l.match(n))&&hke(f,d,c,u),(f=l.match(s))&&fke(f,d,c,u),(f=l.match(r))&&gke(f,d,u),d}}();function Pae(t,e){var r=[Xi,Qr("styleSheet",null,{xmlns:Rg[0],"xmlns:vt":Po.vt})],n;return t.SSF&&(n=pke(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=xke(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function yke(t,e){var r=t.read_shift(2),n=sc(t);return[r,n]}function bke(t,e,r){r||(r=dr(6+4*e.length)),r.write_shift(2,t),Zo(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function wke(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=n5e(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=r5e(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=sc(t),n}function Nke(t,e){e||(e=dr(25+4*32)),e.write_shift(2,t.sz*20),a5e(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),KS(t.color,e);var n=0;return n=2,e.write_shift(1,n),Zo(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Cke=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],T5,_ke=lc;function XH(t,e){e||(e=dr(4*3+8*7+16*1)),T5||(T5=lP(Cke));var r=T5[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(KS({auto:1},e),KS({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Eke(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function Bae(t,e,r){r||(r=dr(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function py(t,e){return e||(e=dr(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Ske=lc;function Ike(t,e){return e||(e=dr(51)),e.write_shift(1,0),py(null,e),py(null,e),py(null,e),py(null,e),py(null,e),e.length>e.l?e.slice(0,e.l):e}function jke(t,e){return e||(e=dr(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),GS(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Pke(t,e,r){var n=dr(2052);return n.write_shift(4,t),GS(e,n),GS(r,n),n.length>n.l?n.slice(0,n.l):n}function Bke(t,e,r){var n={};n.NumberFmt=[];for(var a in kn)n.NumberFmt[a]=kn[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return RA(t,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],lA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=WS(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Tke(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Er(t,615,xf(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Er(t,44,bke(a,e[a]))}),Er(t,616))}}function kke(t){var e=1;Er(t,611,xf(e)),Er(t,43,Nke({sz:12,color:{theme:1},name:"Calibri",family:2})),Er(t,612)}function Fke(t){var e=2;Er(t,603,xf(e)),Er(t,45,XH({patternType:"none"})),Er(t,45,XH({patternType:"gray125"})),Er(t,604)}function Oke(t){var e=1;Er(t,613,xf(e)),Er(t,46,Ike()),Er(t,614)}function Dke(t){var e=1;Er(t,626,xf(e)),Er(t,47,Bae({numFmtId:0},65535)),Er(t,627)}function Rke(t,e){Er(t,617,xf(e.length)),e.forEach(function(r){Er(t,47,Bae(r,0))}),Er(t,618)}function Mke(t){var e=1;Er(t,619,xf(e)),Er(t,48,jke({xfId:0,name:"Normal"})),Er(t,620)}function Lke(t){var e=0;Er(t,505,xf(e)),Er(t,506)}function Uke(t){var e=0;Er(t,508,Pke(e,"TableStyleMedium9","PivotStyleMedium4")),Er(t,509)}function Qke(t,e){var r=iu();return Er(r,278),Tke(r,t.SSF),kke(r),Fke(r),Oke(r),Dke(r),Rke(r,e.cellXfs),Mke(r),Lke(r),Uke(r),Er(r,279),r.end()}var Vke=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Hke(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(cc)||[]).forEach(function(a){var s=Dn(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Vke.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function $ke(){}function Gke(){}var Kke=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,qke=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,zke=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Wke(t,e,r){e.themeElements={};var n;[["clrScheme",Kke,Hke],["fontScheme",qke,$ke],["fmtScheme",zke,Gke]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var Xke=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Tae(t,e){(!t||t.length===0)&&(t=yR());var r,n={};if(!(r=t.match(Xke)))throw new Error("themeElements not found in theme");return Wke(r[0],n,e),n.raw=t,n}function yR(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xi];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Yke(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=Cne(s,{type:"array"})}catch{return}var l=Bu(o,"theme/theme/theme1.xml",!0);if(l)return Tae(l,r)}}function Jke(t){return t.read_shift(4)}function Zke(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=eFe(t,4);break;case 2:e.xclrValue=dae(t);break;case 3:e.xclrValue=Jke(t);break;case 4:t.l+=4;break}return t.l+=8,e}function eFe(t,e){return lc(t,e)}function tFe(t,e){return lc(t,e)}function rFe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Zke(t);break;case 6:n[1]=tFe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function nFe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(rFe(t,r-t.l));return{ixfe:n,ext:s}}function aFe(t,e){e.forEach(function(r){switch(r[0]){}})}function sFe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:sc(t)}}function iFe(t){var e=dr(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Zo(t.name,e),e.slice(0,e.l)}function oFe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function lFe(t){var e=dr(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function cFe(t,e){var r=dr(8+2*e.length);return r.write_shift(4,t),Zo(e,r),r.slice(0,r.l)}function uFe(t){return t.l+=4,t.read_shift(4)!=0}function dFe(t,e){var r=dr(8);return r.write_shift(4,t),r.write_shift(4,1),r}function fFe(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return RA(t,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function hFe(){var t=iu();return Er(t,332),Er(t,334,xf(1)),Er(t,335,iFe({name:"XLDAPR",version:12e4,flags:3496657072})),Er(t,336),Er(t,339,cFe(1,"XLDAPR")),Er(t,52),Er(t,35,xf(514)),Er(t,4096,xf(0)),Er(t,4097,gd(1)),Er(t,36),Er(t,53),Er(t,340),Er(t,337,dFe(1)),Er(t,51,lFe([[1,0]])),Er(t,338),Er(t,333),t.end()}function AFe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,s=2,o;return t.replace(cc,function(l){var c=Dn(l);switch(gh(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function kae(){var t=[Xi];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function mFe(t){var e=[];if(!t)return e;var r=1;return(t.match(cc)||[]).forEach(function(n){var a=Dn(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function pFe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=On(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function gFe(t,e,r){var n=[];return RA(t,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function xFe(t,e,r,n){if(!t)return t;var a=n||{},s=!1;RA(t,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function vFe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Wx=1024;function Fae(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Qr("xml",null,{"xmlns:v":Iu.v,"xmlns:o":Iu.o,"xmlns:x":Iu.x,"xmlns:mv":Iu.mv}).replace(/\/>/,">"),Qr("o:shapelayout",Qr("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Qr("v:shapetype",[Qr("v:stroke",null,{joinstyle:"miter"}),Qr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Wx<t*1e3;)Wx+=1e3;return e.forEach(function(s){var o=ci(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Qr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Qr("v:fill",c,l),d={on:"t",obscured:"t"};++Wx,a=a.concat(["<v:shape"+k2({id:"_x0000_s"+Wx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Qr("v:shadow",null,d),Qr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Sl("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Sl("x:AutoFill","False"),Sl("x:Row",String(o.r)),Sl("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function YH(t,e,r,n){var a=Array.isArray(t),s;e.forEach(function(o){var l=ci(o.ref);if(a?(t[l.r]||(t[l.r]=[]),s=t[l.r][l.c]):s=t[o.ref],!s){s={t:"z"},a?t[l.r][l.c]=s:t[o.ref]=s;var c=Ea(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=zn(c);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function yFe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Dn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=ci(c.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),A=!!f&&!!f[1]&&gR(f[1])||{r:"",t:"",h:""};u.r=A.r,A.r=="<t></t>"&&(A.t=A.h=""),u.t=(A.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=A.h),n.push(u)}}}}),n}function Oae(t){var e=[Xi,Qr("comments",null,{xmlns:Rg[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var s=rs(a.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(rs(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Sl("t",rs(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(Sl("t",rs(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function bFe(t,e){var r=[],n=!1,a={},s=0;return t.replace(cc,function(l,c){var u=Dn(l);switch(gh(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function wFe(t,e,r){var n=[Xi,Qr("ThreadedComments",null,{xmlns:Po.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Qr("threadedComment",Sl("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function NFe(t,e){var r=[],n=!1;return t.replace(cc,function(s){var o=Dn(s);switch(gh(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function CFe(t){var e=[Xi,Qr("personList",null,{xmlns:Po.TCMNT,"xmlns:x":Rg[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Qr("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function _Fe(t){var e={};e.iauthor=t.read_shift(4);var r=Qg(t);return e.rfx=r.s,e.ref=On(r.s),t.l+=16,e}function EFe(t,e){return e==null&&(e=dr(36)),e.write_shift(4,t[1].iauthor),b1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var SFe=sc;function IFe(t){return Zo(t.slice(0,54))}function jFe(t,e){var r=[],n=[],a={},s=!1;return RA(t,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function PFe(t){var e=iu(),r=[];return Er(e,628),Er(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Er(e,632,IFe(a.a)))})}),Er(e,631),Er(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:ci(n[0]),e:ci(n[0])};Er(e,635,EFe([s,a])),a.t&&a.t.length>0&&Er(e,637,J4e(a)),Er(e,636),delete a.iauthor})}),Er(e,634),Er(e,629),e.end()}var BFe="application/vnd.ms-office.vbaProject";function TFe(t){var e=_n.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_n.utils.cfb_add(e,a,t.FileIndex[n].content)}}),_n.write(e)}function kFe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&_n.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var Dae=["xlsb","xlsm","xlam","biff8","xla"];function FFe(){return{"!type":"dialog"}}function OFe(){return{"!type":"dialog"}}function DFe(){return{"!type":"macro"}}function RFe(){return{"!type":"macro"}}var gv=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=e.c:--d,c?u+=e.r:--u,a+(l?"":"$")+li(d)+(c?"":"$")+zi(u)}return function(a,s){return e=s,a.replace(t,r)}}(),bR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,wR=function(){return function(e,r){return e.replace(bR,function(n,a,s,o,l,c){var u=lR(o)-(s?0:r.c),d=oR(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",A=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+A})}}();function Rae(t,e){return t.replace(bR,function(r,n,a,s,o,l){return n+(a=="$"?a+s:li(lR(s)+e.c))+(o=="$"?o+l:zi(oR(l)+e.r))})}function MFe(t,e,r){var n=ou(e),a=n.s,s=ci(r),o={r:s.r-a.r,c:s.c-a.c};return Rae(t,o)}function LFe(t){return t.length!=1}function JH(t){return t.replace(/_xlfn\./g,"")}function eo(t){t.l+=1}function jm(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Mae(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Lae(t);r.biff==12&&(n=4)}var a=t.read_shift(n),s=t.read_shift(n),o=jm(t),l=jm(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Lae(t){var e=jm(t),r=jm(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function UFe(t,e,r){if(r.biff<8)return Lae(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),s=jm(t),o=jm(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Uae(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return QFe(t);var n=t.read_shift(r&&r.biff==12?4:2),a=jm(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function QFe(t){var e=jm(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function VFe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function HFe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $Fe(t);var a=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function $Fe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function GFe(t,e,r){var n=(t[t.l++]&96)>>5,a=Mae(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function KFe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Mae(t,s,r);return[n,a,o]}function qFe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function zFe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,a]}function WFe(t,e,r){var n=(t[t.l++]&96)>>5,a=UFe(t,e-1,r);return[n,a]}function XFe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ZH(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function YFe(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function JFe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function ZFe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function eOe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function tOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Qae(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function rOe(t){return t.read_shift(2),Qae(t)}function nOe(t){return t.read_shift(2),Qae(t)}function aOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=Uae(t,0,r);return[n,a]}function sOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=HFe(t,0,r);return[n,a]}function iOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Uae(t,0,r);return[n,a,s]}function oOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[uDe[a],$ae[a],n]}function lOe(t,e,r){var n=t[t.l++],a=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:cOe(t);return[a,(s[0]===0?$ae:cDe)[s[1]]]}function cOe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function uOe(t,e,r){t.l+=r&&r.biff==2?3:4}function dOe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function fOe(t){return t.l++,MA[t.read_shift(1)]}function hOe(t){return t.l++,t.read_shift(2)}function AOe(t){return t.l++,t.read_shift(1)!==0}function mOe(t){return t.l++,nc(t)}function pOe(t,e,r){return t.l++,Lw(t,e-1,r)}function gOe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ri(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=MA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=nc(t);break;case 2:r[1]=Vg(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function xOe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Qg:dP)(t));return a}function vOe(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=gOe(t,r.biff);return o}function yOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function bOe(t,e,r){if(r.biff==5)return wOe(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[n,a,s]}function wOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function NOe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function COe(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function _Oe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function EOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,a]}var SOe=lc,IOe=lc,jOe=lc;function Qw(t,e,r){return t.l+=2,[VFe(t)]}function NR(t){return t.l+=6,[]}var POe=Qw,BOe=NR,TOe=NR,kOe=Qw;function Vae(t){return t.l+=2,[no(t),t.read_shift(2)&1]}var FOe=Qw,OOe=Vae,DOe=NR,ROe=Qw,MOe=Qw,LOe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function UOe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),o=LOe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:s}}function QOe(t){return t.l+=2,[t.read_shift(4)]}function VOe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function HOe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $Oe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function GOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function KOe(t){return t.l+=4,[0,0]}var e$={1:{n:"PtgExp",f:dOe},2:{n:"PtgTbl",f:jOe},3:{n:"PtgAdd",f:eo},4:{n:"PtgSub",f:eo},5:{n:"PtgMul",f:eo},6:{n:"PtgDiv",f:eo},7:{n:"PtgPower",f:eo},8:{n:"PtgConcat",f:eo},9:{n:"PtgLt",f:eo},10:{n:"PtgLe",f:eo},11:{n:"PtgEq",f:eo},12:{n:"PtgGe",f:eo},13:{n:"PtgGt",f:eo},14:{n:"PtgNe",f:eo},15:{n:"PtgIsect",f:eo},16:{n:"PtgUnion",f:eo},17:{n:"PtgRange",f:eo},18:{n:"PtgUplus",f:eo},19:{n:"PtgUminus",f:eo},20:{n:"PtgPercent",f:eo},21:{n:"PtgParen",f:eo},22:{n:"PtgMissArg",f:eo},23:{n:"PtgStr",f:pOe},26:{n:"PtgSheet",f:VOe},27:{n:"PtgEndSheet",f:HOe},28:{n:"PtgErr",f:fOe},29:{n:"PtgBool",f:AOe},30:{n:"PtgInt",f:hOe},31:{n:"PtgNum",f:mOe},32:{n:"PtgArray",f:XFe},33:{n:"PtgFunc",f:oOe},34:{n:"PtgFuncVar",f:lOe},35:{n:"PtgName",f:yOe},36:{n:"PtgRef",f:aOe},37:{n:"PtgArea",f:GFe},38:{n:"PtgMemArea",f:NOe},39:{n:"PtgMemErr",f:SOe},40:{n:"PtgMemNoMem",f:IOe},41:{n:"PtgMemFunc",f:COe},42:{n:"PtgRefErr",f:_Oe},43:{n:"PtgAreaErr",f:qFe},44:{n:"PtgRefN",f:sOe},45:{n:"PtgAreaN",f:WFe},46:{n:"PtgMemAreaN",f:$Oe},47:{n:"PtgMemNoMemN",f:GOe},57:{n:"PtgNameX",f:bOe},58:{n:"PtgRef3d",f:iOe},59:{n:"PtgArea3d",f:KFe},60:{n:"PtgRefErr3d",f:EOe},61:{n:"PtgAreaErr3d",f:zFe},255:{}},qOe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zOe={1:{n:"PtgElfLel",f:Vae},2:{n:"PtgElfRw",f:ROe},3:{n:"PtgElfCol",f:POe},6:{n:"PtgElfRwV",f:MOe},7:{n:"PtgElfColV",f:kOe},10:{n:"PtgElfRadical",f:FOe},11:{n:"PtgElfRadicalS",f:DOe},13:{n:"PtgElfColS",f:BOe},15:{n:"PtgElfColSV",f:TOe},16:{n:"PtgElfRadicalLel",f:OOe},25:{n:"PtgList",f:UOe},29:{n:"PtgSxName",f:QOe},255:{}},WOe={0:{n:"PtgAttrNoop",f:KOe},1:{n:"PtgAttrSemi",f:tOe},2:{n:"PtgAttrIf",f:ZFe},4:{n:"PtgAttrChoose",f:YFe},8:{n:"PtgAttrGoto",f:JFe},16:{n:"PtgAttrSum",f:uOe},32:{n:"PtgAttrBaxcel",f:ZH},33:{n:"PtgAttrBaxcel",f:ZH},64:{n:"PtgAttrSpace",f:rOe},65:{n:"PtgAttrSpaceSemi",f:nOe},128:{n:"PtgAttrIfError",f:eOe},255:{}};function Vw(t,e,r,n){if(n.biff<8)return lc(t,e);for(var a=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=vOe(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=xOe(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&s.push(lc(t,e)),s}function Hw(t,e,r){for(var n=t.l+e,a,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],a=e$[s]||e$[qOe[s]],(s===24||s===25)&&(a=(s===24?zOe:WOe)[t[t.l+1]]),!a||!a.f?lc(t,e):o.push([a.n,a.f(t,e,r)]);return o}function XOe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var YOe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JOe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Hae(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function t$(t,e,r){var n=Hae(t,e,r);return n=="#REF"?n:JOe(n,r)}function ec(t,e,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,A=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",v=0,y=t[0].length;v<y;++v){var b=t[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=_i(" ",t[0][p][1][1]);break;case 1:x=_i("\r",t[0][p][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+x,p=-1}l.push(u+YOe[b[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Tb(b[1][1],o,a),l.push(kb(d,s));break;case"PtgRefN":d=r?Tb(b[1][1],r,a):b[1][1],l.push(kb(d,s));break;case"PtgRef3d":f=b[1][1],d=Tb(b[1][2],o,a),m=t$(n,f,a),l.push(m+"!"+kb(d,s));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],j=b[1][1];w||(w=0),w&=127;var I=w==0?[]:l.slice(-w);l.length-=w,j==="User"&&(j=I.shift()),l.push(j+"("+I.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=PH(b[1][1],r?{s:r}:o,a),l.push(I5(h,a));break;case"PtgArea":h=PH(b[1][1],o,a),l.push(I5(h,a));break;case"PtgArea3d":f=b[1][1],h=b[1][2],m=t$(n,f,a),l.push(m+"!"+I5(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":A=b[1][2];var _=(n.names||[])[A-1]||(n[0]||[])[A],S=_?_.Name:"SH33TJSNAME"+String(A);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var E=b[1][1];A=b[1][2];var B;if(a.biff<=5)E<0&&(E=-E),n[E]&&(B=n[E][A]);else{var T="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][A]&&n[E][A].itab>0&&(T=n.SheetNames[n[E][A].itab-1]+"!"):T=n.SheetNames[A-1]+"!"),n[E]&&n[E][A])T+=n[E][A].Name;else if(n[0]&&n[0][A])T+=n[0][A].Name;else{var P=(Hae(n,E,a)||"").split(";;");P[A-1]?T=P[A-1]:T+="SH33TJSERRX"}l.push(T);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var O="(",z=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:O=_i(" ",t[0][p][1][1])+O;break;case 3:O=_i("\r",t[0][p][1][1])+O;break;case 4:z=_i(" ",t[0][p][1][1])+z;break;case 5:z=_i("\r",t[0][p][1][1])+z;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(O+l.pop()+z);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var ce={c:r.c,r:r.r};if(n.sharedf[On(d)]){var de=n.sharedf[On(d)];l.push(ec(de,o,ce,n,a))}else{var ue=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(ec(u[1],o,ce,n,a)),ue=!0;break}ue||l.push(b[1])}break;case"PtgArray":l.push("{"+XOe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&me.indexOf(t[0][v][0])==-1){b=t[0][p];var se=!0;switch(b[1][0]){case 4:se=!1;case 0:x=_i(" ",b[1][1]);break;case 5:se=!1;case 1:x=_i("\r",b[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((se?x:"")+l.pop()+(se?"":x)),p=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function ZOe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],lc(t,e-2)];var l=Hw(t,o,r);return e!==o+a&&(s=Vw(t,e-o-a,l,r)),t.l=n,[l,s]}function eDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],lc(t,e-2)];var l=Hw(t,o,r);return e!==o+a&&(s=Vw(t,e-o-a,l,r)),t.l=n,[l,s]}function tDe(t,e,r,n){var a=t.l+e,s=Hw(t,n,r),o;return a!==t.l&&(o=Vw(t,a-t.l,s,r)),[s,o]}function rDe(t,e,r){var n=t.l+e,a,s=t.read_shift(2),o=Hw(t,s,r);return s==65535?[[],lc(t,e-2)]:(e!==s+2&&(a=Vw(t,n-s-2,o,r)),[o,a])}function nDe(t){var e;if(Yh(t,t.l+6)!==65535)return[nc(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function aDe(t){if(t==null){var e=dr(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ag(t);return Ag(0)}function k5(t,e,r){var n=t.l+e,a=xh(t);r.biff==2&&++t.l;var s=nDe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=eDe(t,n-t.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function sDe(t,e,r,n,a){var s=pg(e,r,a),o=aDe(t.v),l=dr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=dr(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var f=Jo([s,o,l,u]);return f}function fP(t,e,r){var n=t.read_shift(4),a=Hw(t,n,r),s=t.read_shift(4),o=s>0?Vw(t,s,a,r):null;return[a,o]}var iDe=fP,hP=fP,oDe=fP,lDe=fP,cDe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$ae={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},uDe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function r$(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function dDe(t){var e="of:="+t.replace(bR,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function F5(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function fDe(t){return t.replace(/\./,"!")}var Ob={},xv={},Db=typeof Map<"u";function CR(t,e,r){var n=0,a=t.length;if(r){if(Db?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Db?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Db?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function AP(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(rc=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=M2(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=XS(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Hp(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Vm(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){lA(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===n)return a;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Gae(t,e,r,n,a,s){try{n.cellNF&&(t.z=kn[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Fs(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(kn[e]==null&&lA(c4e[e]||"General",e),t.t==="e")t.w=t.w||MA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=B2(t.v);else if(t.t==="d"){var o=Oo(t.v);(o|0)===o?t.w=o.toString(10):t.w=B2(o)}else{if(t.v===void 0)return"";t.w=fg(t.v,xv)}else t.t==="d"?t.w=Od(e,Oo(t.v),xv):t.w=Od(e,t.v,xv)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=WS(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=WS(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function hDe(t,e,r){if(t&&t["!ref"]){var n=Ea(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function ADe(t,e){var r=Ea(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=zn(r))}var mDe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pDe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gDe=/<(?:\w:)?hyperlink [^>]*>/mg,xDe=/"(\w*:\w*)"/,vDe=/<(?:\w:)?col\b[^>]*[\/]?>/g,yDe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bDe=/<(?:\w:)?pageMargins[^>]*\/>/g,Kae=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wDe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,NDe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function CDe(t,e,r,n,a,s,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=t.match(pDe);f?(u=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):u=d=t;var A=u.match(Kae);A?_R(A[0],l,a,r):(A=u.match(wDe))&&EDe(A[0],A[1]||"",l,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(xDe);m&&ADe(l,m[1])}var p=u.match(NDe);p&&p[1]&&LDe(p[1],a);var x=[];if(e.cellStyles){var v=u.match(vDe);v&&FDe(x,v)}f&&VDe(f[1],l,e,c,s,o);var y=d.match(yDe);y&&(l["!autofilter"]=DDe(y[0]));var b=[],w=d.match(mDe);if(w)for(h=0;h!=w.length;++h)b[h]=Ea(w[h].slice(w[h].indexOf('"')+1));var j=d.match(gDe);j&&BDe(l,j,n);var I=d.match(bDe);if(I&&(l["!margins"]=TDe(Dn(I[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=zn(c)),e.sheetRows>0&&l["!ref"]){var _=Ea(l["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=zn(_))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function _De(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+zn(t[r])+'"/>';return e+"</mergeCells>"}function _R(t,e,r,n){var a=Dn(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=_a(cs(a.codeName)))}function EDe(t,e,r,n,a){_R(t.slice(0,t.indexOf(">")),r,n,a)}function SDe(t,e,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Zf(rs(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),l=(l||"")+Qr("outlinePr",null,u)}!s&&!l||(a[a.length]=Qr("sheetPr",l,o))}var IDe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],jDe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function PDe(t){var e={sheet:1};return IDe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),jDe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=xR(t.password).toString(16).toUpperCase()),Qr("sheetProtection",null,e)}function BDe(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var s=Dn(cs(e[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+_a(s.location))):(s.Target="#"+_a(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ea(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=On({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function TDe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function kDe(t){return Hp(t),Qr("pageMargins",null,t)}function FDe(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=Dn(e[n],!0);a.hidden&&(a.hidden=Ps(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,vR(a.width)),Im(a);s<=o;)t[s++]=Os(a)}}function ODe(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Qr("col",null,AP(a,n)));return r[r.length]="</cols>",r.join("")}function DDe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function RDe(t,e,r,n){var a=typeof t.ref=="string"?t.ref:zn(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=ou(a);o.s.r==o.e.r&&(o.e.r=ou(e["!ref"]).e.r,a=zn(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Qr("autoFilter",null,{ref:a})}var MDe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function LDe(t,e){e.Views||(e.Views=[{}]),(t.match(MDe)||[]).forEach(function(r,n){var a=Dn(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Ps(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function UDe(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Qr("sheetViews",Qr("sheetView",null,a),{})}function QDe(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=MA[t.v];break;case"d":n&&n.cellDates?a=Fs(t.v,-1).toISOString():(t=Os(t),t.t="n",a=""+(t.v=Oo(Fs(t.v)))),typeof t.z>"u"&&(t.z=kn[14]);break;default:a=t.v;break}var l=Sl("v",rs(a)),c={r:e},u=Vm(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Sl("v",""+CR(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=Qr("f",rs(t.f),d)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Qr("c",l,c)}var VDe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=T2("v"),o=T2("f");return function(c,u,d,f,A,h){for(var m=0,p="",x=[],v=[],y=0,b=0,w=0,j="",I,_,S=0,E=0,B,T,P=0,O=0,z=Array.isArray(h.CellXf),ce,de=[],ue=[],me=Array.isArray(u),se=[],ke={},Re=!1,F=!!d.sheetStubs,H=c.split(e),K=0,L=H.length;K!=L;++K){p=H[K].trim();var W=p.length;if(W!==0){var Y=0;e:for(m=0;m<W;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(_=Dn(p.slice(Y,m),!0),S=_.r!=null?parseInt(_.r,10):S+1,E=-1,d.sheetRows&&d.sheetRows<S)continue;ke={},Re=!1,_.ht&&(Re=!0,ke.hpt=parseFloat(_.ht),ke.hpx=Qv(ke.hpt)),_.hidden=="1"&&(Re=!0,ke.hidden=!0),_.outlineLevel!=null&&(Re=!0,ke.level=+_.outlineLevel),Re&&(se[S-1]=ke)}break;case"<":Y=m;break}if(Y>=m)break;if(_=Dn(p.slice(Y,m),!0),S=_.r!=null?parseInt(_.r,10):S+1,E=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(ke={},Re=!1,_.ht&&(Re=!0,ke.hpt=parseFloat(_.ht),ke.hpx=Qv(ke.hpt)),_.hidden=="1"&&(Re=!0,ke.hidden=!0),_.outlineLevel!=null&&(Re=!0,ke.level=+_.outlineLevel),Re&&(se[S-1]=ke)),x=p.slice(m).split(t);for(var D=0;D!=x.length&&x[D].trim().charAt(0)=="<";++D);for(x=x.slice(D),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(v=p.match(r),y=m,b=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,j=v[1],b=0;b!=j.length&&!((w=j.charCodeAt(b)-64)<1||w>26);++b)y=26*y+w;--y,E=y}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,_=Dn(p.slice(0,b),!0),_.r||(_.r=On({r:S-1,c:E})),j=p.slice(b),I={t:""},(v=j.match(s))!=null&&v[1]!==""&&(I.v=_a(v[1])),d.cellFormula){if((v=j.match(o))!=null&&v[1]!==""){if(I.f=_a(cs(v[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=JH(I.f)),v[0].indexOf('t="array"')>-1)I.F=(j.match(a)||[])[1],I.F.indexOf(":")>-1&&de.push([Ea(I.F),I.F]);else if(v[0].indexOf('t="shared"')>-1){T=Dn(v[0]);var Q=_a(cs(v[1]));d.xlfn||(Q=JH(Q)),ue[parseInt(T.si,10)]=[T,Q,_.r]}}else(v=j.match(/<f[^>]*\/>/))&&(T=Dn(v[0]),ue[T.si]&&(I.f=MFe(ue[T.si][1],ue[T.si][2],_.r)));var ee=ci(_.r);for(b=0;b<de.length;++b)ee.r>=de[b][0].s.r&&ee.r<=de[b][0].e.r&&ee.c>=de[b][0].s.c&&ee.c<=de[b][0].e.c&&(I.F=de[b][1])}if(_.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(F)I.t="z";else continue;else I.t=_.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),I.t){case"n":if(I.v==""||I.v==null){if(!F)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!F)continue;I.t="z"}else B=Ob[parseInt(I.v,10)],I.v=B.t,I.r=B.r,d.cellHTML&&(I.h=B.h);break;case"str":I.t="s",I.v=I.v!=null?cs(I.v):"",d.cellHTML&&(I.h=nR(I.v));break;case"inlineStr":v=j.match(n),I.t="s",v!=null&&(B=gR(v[1]))?(I.v=B.t,d.cellHTML&&(I.h=B.h)):I.v="";break;case"b":I.v=Ps(I.v);break;case"d":d.cellDates?I.v=Fs(I.v,1):(I.v=Oo(Fs(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=zne[I.v];break}if(P=O=0,ce=null,z&&_.s!==void 0&&(ce=h.CellXf[_.s],ce!=null&&(ce.numFmtId!=null&&(P=ce.numFmtId),d.cellStyles&&ce.fillId!=null&&(O=ce.fillId))),Gae(I,P,O,d,A,h),d.cellDates&&z&&I.t=="n"&&x1(kn[P])&&(I.t="d",I.v=uP(I.v)),_.cm&&d.xlmeta){var ve=(d.xlmeta.Cell||[])[+_.cm-1];ve&&ve.type=="XLDAPR"&&(I.D=!0)}if(me){var M=ci(_.r);u[M.r]||(u[M.r]=[]),u[M.r][M.c]=I}else u[_.r]=I}}}}se.length>0&&(u["!rows"]=se)}}();function HDe(t,e,r,n){var a=[],s=[],o=Ea(t["!ref"]),l="",c,u="",d=[],f=0,A=0,h=t["!rows"],m=Array.isArray(t),p={r:u},x,v=-1;for(A=o.s.c;A<=o.e.c;++A)d[A]=li(A);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=zi(f),A=o.s.c;A<=o.e.c;++A){c=d[A]+u;var y=m?(t[f]||[])[A]:t[c];y!==void 0&&(l=QDe(y,c,t,e))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(p={r:u},h&&h[f]&&(x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=L2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),a[a.length]=Qr("row",s.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=L2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level),a[a.length]=Qr("row","",p));return a.join("")}function qae(t,e,r,n){var a=[Xi,Qr("worksheet",null,{xmlns:Rg[0],"xmlns:r":Po.r})],s=r.SheetNames[t],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Ea(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=zn(d)}n||(n={}),c["!comments"]=[];var f=[];SDe(c,r,t,e,a),a[a.length]=Qr("dimension",null,{ref:u}),a[a.length]=UDe(c,e,t,r),e.sheetFormat&&(a[a.length]=Qr("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=ODe(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=HDe(c,e),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=PDe(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=RDe(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=_De(c["!merges"]));var A=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Ja(n,-1,rs(p[1].Target).replace(/#.*$/,""),ia.HLINK),h["r:id"]="rId"+m),(A=p[1].Target.indexOf("#"))>-1&&(h.location=rs(p[1].Target.slice(A+1))),p[1].Tooltip&&(h.tooltip=rs(p[1].Tooltip)),a[a.length]=Qr("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=kDe(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Sl("ignoredErrors",Qr("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Ja(n,-1,"../drawings/drawing"+(t+1)+".xml",ia.DRAW),a[a.length]=Qr("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Ja(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ia.VML),a[a.length]=Qr("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function $De(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function GDe(t,e,r){var n=dr(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;a.hpx?s=L2(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var f=-1,A=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[On(u)];m&&(f<0&&(f=h),A=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,A))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function KDe(t,e,r,n){var a=GDe(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Er(t,0,a)}var qDe=Qg,zDe=b1;function WDe(){}function XDe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Z4e(t),r}function YDe(t,e,r){r==null&&(r=dr(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return KS({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Hne(t,r),r.slice(0,r.l)}function JDe(t){var e=Qd(t);return[e]}function ZDe(t,e,r){return r==null&&(r=dr(8)),Mg(e,r)}function e6e(t){var e=Lg(t);return[e]}function t6e(t,e,r){return r==null&&(r=dr(4)),Ug(e,r)}function r6e(t){var e=Qd(t),r=t.read_shift(1);return[e,r,"b"]}function n6e(t,e,r){return r==null&&(r=dr(9)),Mg(e,r),r.write_shift(1,t.v?1:0),r}function a6e(t){var e=Lg(t),r=t.read_shift(1);return[e,r,"b"]}function s6e(t,e,r){return r==null&&(r=dr(5)),Ug(e,r),r.write_shift(1,t.v?1:0),r}function i6e(t){var e=Qd(t),r=t.read_shift(1);return[e,r,"e"]}function o6e(t,e,r){return r==null&&(r=dr(9)),Mg(e,r),r.write_shift(1,t.v),r}function l6e(t){var e=Lg(t),r=t.read_shift(1);return[e,r,"e"]}function c6e(t,e,r){return r==null&&(r=dr(8)),Ug(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function u6e(t){var e=Qd(t),r=t.read_shift(4);return[e,r,"s"]}function d6e(t,e,r){return r==null&&(r=dr(12)),Mg(e,r),r.write_shift(4,e.v),r}function f6e(t){var e=Lg(t),r=t.read_shift(4);return[e,r,"s"]}function h6e(t,e,r){return r==null&&(r=dr(8)),Ug(e,r),r.write_shift(4,e.v),r}function A6e(t){var e=Qd(t),r=nc(t);return[e,r,"n"]}function m6e(t,e,r){return r==null&&(r=dr(16)),Mg(e,r),Ag(t.v,r),r}function zae(t){var e=Lg(t),r=nc(t);return[e,r,"n"]}function p6e(t,e,r){return r==null&&(r=dr(12)),Ug(e,r),Ag(t.v,r),r}function g6e(t){var e=Qd(t),r=fR(t);return[e,r,"n"]}function x6e(t,e,r){return r==null&&(r=dr(12)),Mg(e,r),$ne(t.v,r),r}function v6e(t){var e=Lg(t),r=fR(t);return[e,r,"n"]}function y6e(t,e,r){return r==null&&(r=dr(8)),Ug(e,r),$ne(t.v,r),r}function b6e(t){var e=Qd(t),r=cR(t);return[e,r,"is"]}function w6e(t){var e=Qd(t),r=sc(t);return[e,r,"str"]}function N6e(t,e,r){return r==null&&(r=dr(12+4*t.v.length)),Mg(e,r),Zo(t.v,r),r.length>r.l?r.slice(0,r.l):r}function C6e(t){var e=Lg(t),r=sc(t);return[e,r,"str"]}function _6e(t,e,r){return r==null&&(r=dr(8+4*t.v.length)),Ug(e,r),Zo(t.v,r),r.length>r.l?r.slice(0,r.l):r}function E6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"b"];if(r.cellFormula){t.l+=2;var l=hP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}function S6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"e"];if(r.cellFormula){t.l+=2;var l=hP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}function I6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=nc(t),o=[a,s,"n"];if(r.cellFormula){t.l+=2;var l=hP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}function j6e(t,e,r){var n=t.l+e,a=Qd(t);a.r=r["!row"];var s=sc(t),o=[a,s,"str"];if(r.cellFormula){t.l+=2;var l=hP(t,n-t.l,r);o[3]=ec(l,null,a,r.supbooks,r)}else t.l=n;return o}var P6e=Qg,B6e=b1;function T6e(t,e){return e==null&&(e=dr(4)),e.write_shift(4,t),e}function k6e(t,e){var r=t.l+e,n=Qg(t),a=uR(t),s=sc(t),o=sc(t),l=sc(t);t.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function F6e(t,e){var r=dr(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));b1({s:ci(t[0]),e:ci(t[0])},r),dR("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return Zo(a||"",r),Zo(t[1].Tooltip||"",r),Zo("",r),r.slice(0,r.l)}function O6e(){}function D6e(t,e,r){var n=t.l+e,a=Gne(t),s=t.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=iDe(t,n-t.l,r);o[1]=l}else t.l=n;return o}function R6e(t,e,r){var n=t.l+e,a=Qg(t),s=[a];if(r.cellFormula){var o=lDe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function M6e(t,e,r){r==null&&(r=dr(18));var n=AP(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var Wae=["left","right","top","bottom","header","footer"];function L6e(t){var e={};return Wae.forEach(function(r){e[r]=nc(t)}),e}function U6e(t,e){return e==null&&(e=dr(6*8)),Hp(t),Wae.forEach(function(r){Ag(t[r],e)}),e}function Q6e(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function V6e(t,e,r){r==null&&(r=dr(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function H6e(t){var e=dr(24);return e.write_shift(4,4),e.write_shift(4,1),b1(t,e),e}function $6e(t,e){return e==null&&(e=dr(16*4+2)),e.write_shift(2,t.password?xR(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function G6e(){}function K6e(){}function q6e(t,e,r,n,a,s,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,A=!1,h,m,p,x,v,y,b,w,j,I=[];l.biff=12,l["!row"]=0;var _=0,S=!1,E=[],B={},T=l.supbooks||a.supbooks||[[]];if(T.sharedf=B,T.arrayf=E,T.SheetNames=a.SheetNames||a.Sheets.map(function(me){return me.name}),!l.supbooks&&(l.supbooks=T,a.Names))for(var P=0;P<a.Names.length;++P)T[0][P+1]=a.Names[P];var O=[],z=[],ce=!1;U2[16]={n:"BrtShortReal",f:zae};var de;if(RA(t,function(se,ke,Re){if(!A)switch(Re){case 148:u=se;break;case 0:h=se,l.sheetRows&&l.sheetRows<=h.r&&(A=!0),w=zi(x=h.r),l["!row"]=h.r,(se.hidden||se.hpt||se.level!=null)&&(se.hpt&&(se.hpx=Qv(se.hpt)),z[se.r]=se);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:se[2]},se[2]){case"n":m.v=se[1];break;case"s":b=Ob[se[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!se[1];break;case"e":m.v=se[1],l.cellText!==!1&&(m.w=MA[m.v]);break;case"str":m.t="s",m.v=se[1];break;case"is":m.t="s",m.v=se[1].t;break}if((p=o.CellXf[se[0].iStyleRef])&&Gae(m,p.numFmtId,null,l,s,o),v=se[0].c==-1?v+1:se[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[li(v)+w]=m,l.cellFormula){for(S=!1,_=0;_<E.length;++_){var F=E[_];h.r>=F[0].s.r&&h.r<=F[0].e.r&&v>=F[0].s.c&&v<=F[0].e.c&&(m.F=zn(F[0]),S=!0)}!S&&se.length>3&&(m.f=se[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),l.cellDates&&p&&m.t=="n"&&x1(kn[p.numFmtId])){var H=Ep(m.v);H&&(m.t="d",m.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}de&&(de.type=="XLDAPR"&&(m.D=!0),de=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},v=se[0].c==-1?v+1:se[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[li(v)+w]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),de&&(de.type=="XLDAPR"&&(m.D=!0),de=void 0);break;case 176:I.push(se);break;case 49:de=((l.xlmeta||{}).Cell||[])[se-1];break;case 494:var K=n["!id"][se.relId];for(K?(se.Target=K.Target,se.loc&&(se.Target+="#"+se.loc),se.Rel=K):se.relId==""&&(se.Target="#"+se.loc),x=se.rfx.s.r;x<=se.rfx.e.r;++x)for(v=se.rfx.s.c;v<=se.rfx.e.c;++v)l.dense?(c[x]||(c[x]=[]),c[x][v]||(c[x][v]={t:"z",v:void 0}),c[x][v].l=se):(y=On({c:v,r:x}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=se);break;case 426:if(!l.cellFormula)break;E.push(se),j=l.dense?c[x][v]:c[li(v)+w],j.f=ec(se[1],d,{r:h.r,c:v},T,l),j.F=zn(se[0]);break;case 427:if(!l.cellFormula)break;B[On(se[0].s)]=se[1],j=l.dense?c[x][v]:c[li(v)+w],j.f=ec(se[1],d,{r:h.r,c:v},T,l);break;case 60:if(!l.cellStyles)break;for(;se.e>=se.s;)O[se.e--]={width:se.w/256,hidden:!!(se.flags&1),level:se.level},ce||(ce=!0,vR(se.w/256)),Im(O[se.e+1]);break;case 161:c["!autofilter"]={ref:zn(se)};break;case 476:c["!margins"]=se;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),se.name&&(a.Sheets[r].CodeName=se.name),(se.above||se.left)&&(c["!outline"]={above:se.above,left:se.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),se.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ke.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+Re.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=zn(u||d)),l.sheetRows&&c["!ref"]){var ue=Ea(c["!ref"]);l.sheetRows<=+ue.e.r&&(ue.e.r=l.sheetRows-1,ue.e.r>d.e.r&&(ue.e.r=d.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>d.e.c&&(ue.e.c=d.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),c["!fullref"]=c["!ref"],c["!ref"]=zn(ue))}return I.length>0&&(c["!merges"]=I),O.length>0&&(c["!cols"]=O),z.length>0&&(c["!rows"]=z),c}function z6e(t,e,r,n,a,s,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Os(e),e.z=e.z||kn[14],e.v=Oo(Fs(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=Vm(a.cellXfs,e,a),e.l&&s["!links"].push([On(c),e.l]),e.c&&s["!comments"].push([On(c),e.c]),e.t){case"s":case"str":return a.bookSST?(l=CR(a.Strings,e.v,a.revStrings),c.t="s",c.v=l,o?Er(t,18,h6e(e,c)):Er(t,7,d6e(e,c))):(c.t="str",o?Er(t,17,_6e(e,c)):Er(t,6,N6e(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Er(t,13,y6e(e,c)):Er(t,2,x6e(e,c)):o?Er(t,16,p6e(e,c)):Er(t,5,m6e(e,c)),!0;case"b":return c.t="b",o?Er(t,15,s6e(e,c)):Er(t,4,n6e(e,c)),!0;case"e":return c.t="e",o?Er(t,14,c6e(e,c)):Er(t,3,o6e(e,c)),!0}return o?Er(t,12,t6e(e,c)):Er(t,1,ZDe(e,c)),!0}function W6e(t,e,r,n){var a=Ea(e["!ref"]||"A1"),s,o="",l=[];Er(t,145);var c=Array.isArray(e),u=a.e.r;e["!rows"]&&(u=Math.max(a.e.r,e["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=zi(d),KDe(t,e,a,d);var f=!1;if(d<=a.e.r)for(var A=a.s.c;A<=a.e.c;++A){d===a.s.r&&(l[A]=li(A)),s=l[A]+o;var h=c?(e[d]||[])[A]:e[s];if(!h){f=!1;continue}f=z6e(t,h,d,A,n,e,f)}}Er(t,146)}function X6e(t,e){!e||!e["!merges"]||(Er(t,177,T6e(e["!merges"].length)),e["!merges"].forEach(function(r){Er(t,176,B6e(r))}),Er(t,178))}function Y6e(t,e){!e||!e["!cols"]||(Er(t,390),e["!cols"].forEach(function(r,n){r&&Er(t,60,M6e(n,r))}),Er(t,391))}function J6e(t,e){!e||!e["!ref"]||(Er(t,648),Er(t,649,H6e(Ea(e["!ref"]))),Er(t,650))}function Z6e(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=Ja(r,-1,n[1].Target.replace(/#.*$/,""),ia.HLINK);Er(t,494,F6e(n,a))}}),delete e["!links"]}function eRe(t,e,r,n){if(e["!comments"].length>0){var a=Ja(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ia.VML);Er(t,551,dR("rId"+a)),e["!legacy"]=a}}function tRe(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:zn(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ou(s);l.s.r==l.e.r&&(l.e.r=ou(e["!ref"]).e.r,s=zn(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Er(t,161,b1(Ea(s))),Er(t,162)}}function rRe(t,e,r){Er(t,133),Er(t,137,V6e(e,r)),Er(t,138),Er(t,134)}function nRe(t,e){e["!protect"]&&Er(t,535,$6e(e["!protect"]))}function aRe(t,e,r,n){var a=iu(),s=r.SheetNames[t],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=Ea(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Er(a,129),(r.vbaraw||o["!outline"])&&Er(a,147,YDe(l,o["!outline"])),Er(a,148,zDe(c)),rRe(a,o,r.Workbook),Y6e(a,o),W6e(a,o,t,e),nRe(a,o),tRe(a,o,r,t),X6e(a,o),Z6e(a,o,n),o["!margins"]&&Er(a,476,U6e(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&J6e(a,o),eRe(a,o,t,n),Er(a,130),a.end()}function sRe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=_a((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function iRe(t,e,r,n,a,s){var o=s||{"!type":"chart"};if(!t)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var A=sRe(f);d.s.r=d.s.c=0,d.e.c=l,u=li(l),A[0].forEach(function(h,m){o[u+zi(m)]={t:"n",v:h,z:A[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=zn(d)),o}function oRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(Kae);return l&&_R(l[0],s,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function lRe(t,e){t.l+=10;var r=sc(t);return{name:r}}function cRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return RA(t,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ER=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],uRe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],dRe=[],fRe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function n$(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ps(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function a$(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ps(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Xae(t){a$(t.WBProps,ER),a$(t.CalcPr,fRe),n$(t.WBView,uRe),n$(t.Sheets,dRe),xv.date1904=Ps(t.WBProps.date1904)}function hRe(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ps(t.Workbook.WBProps.date1904)?"true":"false"}var ARe="][*?/\\".split("");function Yae(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return ARe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function mRe(t,e,r){t.forEach(function(n,a){Yae(n);for(var s=0;s<a;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function pRe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];mRe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)hDe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var gRe=/<\w+:workbook/;function xRe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(t.replace(cc,function(c,u){var d=Dn(c);switch(gh(d[0])){case"<?xml":break;case"<workbook":c.match(gRe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ER.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ps(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=cs(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=_a(cs(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=cs(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Ps(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=_a(cs(t.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Rg.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Xae(r),r}function Jae(t){var e=[Xi];e[e.length]=Qr("workbook",null,{xmlns:Rg[0],"xmlns:r":Po.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(ER.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Qr("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:rs(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Qr("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=Qr("definedName",rs(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function vRe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Wk(t),r.name=sc(t),r}function yRe(t,e){return e||(e=dr(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),dR(t.strRelID,e),Zo(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function bRe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?sc(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function wRe(t,e){e||(e=dr(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Hne(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function NRe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function CRe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=e5e(t),o=oDe(t,0,r),l=uR(t);t.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function _Re(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],U2[16]={n:"BrtFRTArchID$",f:NRe},RA(t,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=ec(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),Xae(r),r.Names=s,r.supbooks=o,r}function ERe(t,e){Er(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Er(t,156,yRe(a))}Er(t,144)}function SRe(t,e){e||(e=dr(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Zo("SheetJS",e),Zo(LS.version,e),Zo(LS.version,e),Zo("7262",e),e.length>e.l?e.slice(0,e.l):e}function IRe(t,e){e||(e=dr(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function jRe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Er(t,135),Er(t,158,IRe(a)),Er(t,136))}}function PRe(t,e){var r=iu();return Er(r,131),Er(r,128,SRe()),Er(r,153,wRe(t.Workbook&&t.Workbook.WBProps||null)),jRe(r,t),ERe(r,t),Er(r,132),r.end()}function BRe(t,e,r){return e.slice(-4)===".bin"?_Re(t,r):xRe(t,r)}function TRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?q6e(t,n,r,a,s,o,l):CDe(t,n,r,a,s,o,l)}function kRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?cRe(t,n,r,a,s):oRe(t,n,r,a,s)}function FRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?DFe():RFe()}function ORe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?FFe():OFe()}function DRe(t,e,r,n){return e.slice(-4)===".bin"?Bke(t,r,n):vke(t,r,n)}function RRe(t,e,r){return Tae(t,r)}function MRe(t,e,r){return e.slice(-4)===".bin"?MTe(t,r):OTe(t,r)}function LRe(t,e,r){return e.slice(-4)===".bin"?jFe(t,r):yFe(t,r)}function URe(t,e,r){return e.slice(-4)===".bin"?gFe(t):mFe(t)}function QRe(t,e,r,n){return r.slice(-4)===".bin"?xFe(t,e,r,n):void 0}function VRe(t,e,r){return e.slice(-4)===".bin"?fFe(t,e,r):AFe(t,e,r)}function HRe(t,e,r){return(e.slice(-4)===".bin"?PRe:Jae)(t)}function $Re(t,e,r,n,a){return(e.slice(-4)===".bin"?aRe:qae)(t,r,n,a)}function GRe(t,e,r){return(e.slice(-4)===".bin"?Qke:Pae)(t,r)}function KRe(t,e,r){return(e.slice(-4)===".bin"?QTe:wae)(t,r)}function qRe(t,e,r){return(e.slice(-4)===".bin"?PFe:Oae)(t)}function zRe(t){return(t.slice(-4)===".bin"?hFe:kae)()}var Zae=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ese=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Xd(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(Zae),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(ese),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function WRe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Zae),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(ese),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Rb;function XRe(t,e){var r=Rb[t]||_a(t);return r==="General"?fg(e):Od(r,e)}function YRe(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ps(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Fs(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[_a(e)]=a}function JRe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||MA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=B2(t.v):t.w=fg(t.v):t.w=XRe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Rb[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&x1(n)){var a=Ep(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function ZRe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=dke[n.Pattern]||n.Pattern)}t[e.ID]=e}function eMe(t,e,r,n,a,s,o,l,c,u){var d="General",f=n.StyleID,A={};u=u||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ps(t);break;case"String":n.t="s",n.r=bH(_a(t)),n.v=t.indexOf("<")>-1?_a(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Fs(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=_a(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=zne[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=bH(e||t));break}if(JRe(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=_a(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=gv(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=gv("RC:RC",a):n.ArrayRange&&(n.F=gv(n.ArrayRange,a),c.push([Ea(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(x){!A.patternType&&x.patternType&&(A.patternType=x.patternType)}),n.s=A),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function tMe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function O5(t,e){var r=e||{};v1();var n=zy(aR(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=cs(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Os(r);return o.type="string",Uv.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($e){a.indexOf("<"+$e)>=0&&(s=!0)}),s)return UMe(n,r);Rb={"General Number":"General","General Date":kn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kn[15],"Short Date":kn[14],"Long Time":kn[19],"Medium Time":kn[18],"Short Time":kn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kn[2],Standard:kn[4],Percent:kn[10],Scientific:kn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],A=r.dense?[]:{},h="",m={},p={},x=Xd('<Data ss:Type="String">'),v=0,y=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},I={},_="",S=0,E=[],B={},T={},P=0,O=[],z=[],ce={},de=[],ue,me=!1,se=[],ke=[],Re={},F=0,H=0,K={Sheets:[],WBProps:{date1904:!1}},L={};F2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";l=F2.exec(n);)switch(l[3]=(W=l[3]).toLowerCase()){case"data":if(W=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?eMe(n.slice(v,l.index),_,x,c[c.length-1][0]=="comment"?ce:m,{c:y,r:b},j,de[y],p,se,r):(_="",x=Xd(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(z.length>0&&(m.c=z),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(A[b]||(A[b]=[]),A[b][y]=m):A[li(y)+zi(b)]=m),m.HRef&&(m.l={Target:_a(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(F=y+(parseInt(m.MergeAcross,10)|0),H=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:y,r:b},e:{c:F,r:H}})),!r.sheetStubs)m.MergeAcross?y=F+1:++y;else if(m.MergeAcross||m.MergeDown){for(var Y=y;Y<=F;++Y)for(var D=b;D<=H;++D)(Y>y||D>b)&&(r.dense?(A[D]||(A[D]=[]),A[D][Y]={t:"z"}):A[li(Y)+zi(D)]={t:"z"});y=F+1}else++y;else m=WRe(l[0]),m.Index&&(y=+m.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),l[0].slice(-2)==="/>"&&++y,z=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),l[0].slice(-2)==="/>"&&(p=Xd(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=Xd(l[0]),p.Index&&(b=+p.Index-1),Re={},(p.AutoFitHeight=="0"||p.Height)&&(Re.hpx=parseInt(p.Height,10),Re.hpt=L2(Re.hpx),ke[b]=Re),p.Hidden=="1"&&(Re.hidden=!0,ke[b]=Re));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(A["!ref"]=zn(w),r.sheetRows&&r.sheetRows<=w.e.r&&(A["!fullref"]=A["!ref"],w.e.r=r.sheetRows-1,A["!ref"]=zn(w))),E.length&&(A["!merges"]=E),de.length>0&&(A["!cols"]=de),ke.length>0&&(A["!rows"]=ke),d[h]=A}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),u=Xd(l[0]),h=_a(u.Name),A=r.dense?[]:{},E=[],se=[],ke=[],L={name:h,Hidden:0},K.Sheets.push(L);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),de=[],me=!1}break;case"style":l[1]==="/"?ZRe(j,I,r):I=Xd(l[0]);break;case"numberformat":I.nf=_a(Xd(l[0]).Format||"General"),Rb[I.nf]&&(I.nf=Rb[I.nf]);for(var Q=0;Q!=392&&kn[Q]!=I.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(kn[Q]==null){lA(I.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ue=Xd(l[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!me&&ue.wpx>10){me=!0,rc=Iae;for(var ee=0;ee<de.length;++ee)de[ee]&&Im(de[ee])}me&&Im(ue),de[ue.Index-1||de.length]=ue;for(var ve=0;ve<+ue.Span;++ve)de[de.length]=Os(ue);break;case"namedrange":if(l[1]==="/")break;K.Names||(K.Names=[]);var M=Dn(l[0]),Ye={Name:M.Name,Ref:gv(M.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Ye.Sheet=K.Sheets.length-1),K.Names.push(Ye);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=Xd(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_5e(B,W,n.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));tMe(ce),z.push(ce)}else c.push([l[3],!1]),u=Xd(l[0]),ce={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ae=Xd(l[0]);A["!autofilter"]={ref:gv(ae.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return c$(n,r);var X=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(l[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:X=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(P,l.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else P=l.index+l[0].length;break;case"header":A["!margins"]||Hp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].header=+Dn(l[0]).Margin);break;case"footer":A["!margins"]||Hp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].footer=+Dn(l[0]).Margin);break;case"pagemargins":var De=Dn(l[0]);A["!margins"]||Hp(A["!margins"]={},"xlml"),isNaN(+De.Top)||(A["!margins"].top=+De.Top),isNaN(+De.Left)||(A["!margins"].left=+De.Left),isNaN(+De.Right)||(A["!margins"].right=+De.Right),isNaN(+De.Bottom)||(A["!margins"].bottom=+De.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:X=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:X=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:X=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:X=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1;break}if(X||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?YRe(T,W,O,n.slice(P,l.index)):(O=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var le={};return!r.bookSheets&&!r.bookProps&&(le.Sheets=d),le.SheetNames=f,le.Workbook=K,le.SSF=Os(kn),le.Props=B,le.Custprops=T,le}function rF(t,e){switch(IR(e=e||{}),e.type||"base64"){case"base64":return O5(Hu(t),e);case"binary":case"buffer":case"file":return O5(t,e);case"array":return O5(Um(t),e)}}function rMe(t,e){var r=[];return t.Props&&r.push(E5e(t.Props,e)),t.Custprops&&r.push(S5e(t.Props,t.Custprops)),r.join("")}function nMe(){return""}function aMe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(Qr("NumberFormat",null,{"ss:Format":rs(kn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Qr("Style",s.join(""),o))}),Qr("Styles",r.join(""))}function tse(t){return Qr("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+wR(t.Ref,{r:0,c:0})})}function sMe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(tse(a)))}return Qr("Names",r.join(""))}function iMe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(tse(l)))}return s.join("")}function oMe(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Qr("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Qr("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Qr("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Qr("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Sl("ProtectContents","True")),t["!protect"].objects&&a.push(Sl("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Sl("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Sl("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Sl("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Qr("WorksheetOptions",a.join(""),{xmlns:Iu.x})}function lMe(t){return t.map(function(e){var r=j4e(e.t||""),n=Qr("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Qr("Comment",n,{"ss:Author":e.a})}).join("")}function cMe(t,e,r,n,a,s,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+rs(wR(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=ci(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=rs(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=rs(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",A="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",A=String(t.v);break;case"b":f="Boolean",A=t.v?"1":"0";break;case"e":f="Error",A=MA[t.v];break;case"d":f="DateTime",A=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||kn[14]);break;case"s":f="String",A=I4e(t.v||"");break}var h=Vm(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?A:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=lMe(t.c)),Qr("Cell",p,l)}function uMe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Qv(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function dMe(t,e,r,n){if(!t["!ref"])return"";var a=Ea(t["!ref"]),s=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,v){Im(x);var y=!!x.width,b=AP(v,x),w={"ss:Index":v+1};y&&(w["ss:Width"]=R2(b.width)),x.hidden&&(w["ss:Hidden"]="1"),l.push(Qr("Column",null,w))});for(var c=Array.isArray(t),u=a.s.r;u<=a.e.r;++u){for(var d=[uMe(u,(t["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var A=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(A=!0);break}if(!A){var h={r:u,c:f},m=On(h),p=c?(t[u]||[])[f]:t[m];d.push(cMe(p,m,t,e,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function fMe(t,e,r){var n=[],a=r.SheetNames[t],s=r.Sheets[a],o=s?iMe(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?dMe(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(oMe(s,e,t,r)),n.join("")}function hMe(t,e){e||(e={}),t.SSF||(t.SSF=Os(kn)),t.SSF&&(v1(),oP(t.SSF),e.revssf=cP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Vm(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(rMe(t,e)),r.push(nMe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Qr("Worksheet",fMe(n,e,t),{"ss:Name":rs(t.SheetNames[n])}));return r[2]=aMe(t,e),r[3]=sMe(t),Xi+Qr("Workbook",r.join(""),{xmlns:Iu.ss,"xmlns:o":Iu.o,"xmlns:x":Iu.x,"xmlns:ss":Iu.ss,"xmlns:dt":Iu.dt,"xmlns:html":Iu.html})}function AMe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=s5e(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=i5e(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var mMe=[60,1084,2066,2165,2175];function pMe(t,e,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Yh(r,r.l),u=nF[c],d=0;u!=null&&mMe.indexOf(c)>-1;)s=Yh(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=nF[c=Yh(r,r.l)];var f=Jo(o);_l(f,0);var A=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(A),A+=o[h].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,a)}function Mf(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=kn[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||MA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=B2(t.v):t.w=fg(t.v):t.w=Od(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&x1(kn[n]||String(n))){var a=Ep(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function XC(t,e,r){return{v:t,ixfe:e,t:r}}function gMe(t,e){var r={opts:{}},n={},a=e.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,A="",h,m,p,x,v={},y=[],b,w,j=[],I=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},E=function(Ne){return Ne<8?Up[Ne]:Ne<64&&I[Ne-8]||Up[Ne]},B=function(Ne,be,Ce){var Le=be.XF.data;if(!(!Le||!Le.patternType||!Ce||!Ce.cellStyles)){be.s={},be.s.patternType=Le.patternType;var Ae;(Ae=D2(E(Le.icvFore)))&&(be.s.fgColor={rgb:Ae}),(Ae=D2(E(Le.icvBack)))&&(be.s.bgColor={rgb:Ae})}},T=function(Ne,be,Ce){if(!(Re>1)&&!(Ce.sheetRows&&Ne.r>=Ce.sheetRows)){if(Ce.cellStyles&&be.XF&&be.XF.data&&B(Ne,be,Ce),delete be.ixfe,delete be.XF,f=Ne,A=On(Ne),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ne.r<o.s.r&&(o.s.r=Ne.r),Ne.c<o.s.c&&(o.s.c=Ne.c),Ne.r+1>o.e.r&&(o.e.r=Ne.r+1),Ne.c+1>o.e.c&&(o.e.c=Ne.c+1),Ce.cellFormula&&be.f){for(var Le=0;Le<y.length;++Le)if(!(y[Le][0].s.c>Ne.c||y[Le][0].s.r>Ne.r)&&!(y[Le][0].e.c<Ne.c||y[Le][0].e.r<Ne.r)){be.F=zn(y[Le][0]),(y[Le][0].s.c!=Ne.c||y[Le][0].s.r!=Ne.r)&&delete be.f,be.f&&(be.f=""+ec(y[Le][1],o,Ne,se,P));break}}Ce.dense?(a[Ne.r]||(a[Ne.r]=[]),a[Ne.r][Ne.c]=be):a[A]=be}},P={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var O,z=[],ce=[],de=[],ue=[],me=!1,se=[];se.SheetNames=P.snames,se.sharedf=P.sharedf,se.arrayf=P.arrayf,se.names=[],se.XTI=[];var ke=0,Re=0,F=0,H=[],K=[],L;P.codepage=1200,ff(1200);for(var W=!1;t.l<t.length-1;){var Y=t.l,D=t.read_shift(2);if(D===0&&ke===10)break;var Q=t.l===t.length?0:t.read_shift(2),ee=nF[D];if(ee&&ee.f){if(e.bookSheets&&ke===133&&D!==133)break;if(ke=D,ee.r===2||ee.r==12){var ve=t.read_shift(2);if(Q-=2,!P.enc&&ve!==D&&((ve&255)<<8|ve>>8)!==D)throw new Error("rt mismatch: "+ve+"!="+D);ee.r==12&&(t.l+=10,Q-=10)}var M={};if(D===10?M=ee.f(t,Q,P):M=pMe(D,ee,t,Q,P),Re==0&&[9,521,1033,2057].indexOf(ke)===-1)continue;switch(D){case 34:r.opts.Date1904=_.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=M,!e.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=M;break;case 66:var Ye=Number(M);switch(Ye){case 21010:Ye=1200;break;case 32768:Ye=1e4;break;case 32769:Ye=1252;break}ff(P.codepage=Ye),W=!0;break;case 317:P.rrtabid=M;break;case 25:P.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:P.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(a["!type"]="dialog"),M.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),M.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:j.push(M);break;case 430:se.push([M]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(M);break;case 24:case 536:L={Name:M.Name,Ref:ec(M.rgce,o,null,se,P)},M.itab>0&&(L.Sheet=M.itab-1),se.names.push(L),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(K[M.itab-1]={ref:zn(M.rgce[0][0][1][2])});break;case 22:P.ExternCount=M;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(M),se.XTI=se.XTI.concat(M);break;case 2196:if(P.biff<8)break;L!=null&&(L.Comment=M[1]);break;case 18:a["!protect"]=M;break;case 19:M!==0&&P.WTF&&console.error("Password verifier: "+M);break;case 133:s[M.pos]=M,P.snames.push(M.name);break;case 10:{if(--Re)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=zn(o),e.sheetRows&&e.sheetRows<=o.e.r){var ae=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=zn(o),o.e.r=ae}o.e.r++,o.e.c++}z.length>0&&(a["!merges"]=z),ce.length>0&&(a["!objects"]=ce),de.length>0&&(a["!cols"]=de),ue.length>0&&(a["!rows"]=ue),_.Sheets.push(S)}u===""?d=a:n[u]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[D]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),P.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(P.biff=5,W=!0,ff(P.codepage=28591)),P.biff==8&&M.BIFFVer==0&&M.dt==16&&(P.biff=2),Re++)break;if(a=e.dense?[]:{},P.biff<8&&!W&&(W=!0,ff(P.codepage=e.codepage||1252)),P.biff<5||M.BIFFVer==0&&M.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:t.l-Q,name:u};s[X.pos]=X,P.snames.push(u)}else u=(s[Y]||{name:""}).name;M.dt==32&&(a["!type"]="chart"),M.dt==64&&(a["!type"]="macro"),z=[],ce=[],P.arrayf=y=[],de=[],ue=[],me=!1,S={Hidden:(s[Y]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[M.r]||[])[M.c]:a[On({c:M.c,r:M.r})])&&++M.c,b={ixfe:M.ixfe,XF:j[M.ixfe]||{},v:M.val,t:"n"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:M.c,r:M.r},b,e);break;case 5:case 517:b={ixfe:M.ixfe,XF:j[M.ixfe],v:M.val,t:M.t},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:M.c,r:M.r},b,e);break;case 638:b={ixfe:M.ixfe,XF:j[M.ixfe],v:M.rknum,t:"n"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:M.c,r:M.r},b,e);break;case 189:for(var De=M.c;De<=M.C;++De){var le=M.rkrec[De-M.c][0];b={ixfe:le,XF:j[le],v:M.rkrec[De-M.c][1],t:"n"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:De,r:M.r},b,e)}break;case 6:case 518:case 1030:{if(M.val=="String"){l=M;break}if(b=XC(M.val,M.cell.ixfe,M.tt),b.XF=j[b.ixfe],e.cellFormula){var $e=M.formula;if($e&&$e[0]&&$e[0][0]&&$e[0][0][0]=="PtgExp"){var Xe=$e[0][0][1][0],it=$e[0][0][1][1],xt=On({r:Xe,c:it});v[xt]?b.f=""+ec(M.formula,o,M.cell,se,P):b.F=((e.dense?(a[Xe]||[])[it]:a[xt])||{}).F}else b.f=""+ec(M.formula,o,M.cell,se,P)}F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T(M.cell,b,e),l=M}break;case 7:case 519:if(l)l.val=M,b=XC(M,l.cell.ixfe,"s"),b.XF=j[b.ixfe],e.cellFormula&&(b.f=""+ec(l.formula,o,l.cell,se,P)),F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(M);var jt=On(M[0].s);if(h=e.dense?(a[M[0].s.r]||[])[M[0].s.c]:a[jt],e.cellFormula&&h){if(!l||!jt||!h)break;h.f=""+ec(M[1],o,M[0],se,P),h.F=zn(M[0])}}break;case 1212:{if(!e.cellFormula)break;if(A){if(!l)break;v[On(l.cell)]=M[0],h=e.dense?(a[l.cell.r]||[])[l.cell.c]:a[On(l.cell)],(h||{}).f=""+ec(M[0],o,f,se,P)}}break;case 253:b=XC(c[M.isst].t,M.ixfe,"s"),c[M.isst].h&&(b.h=c[M.isst].h),b.XF=j[b.ixfe],F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:M.c,r:M.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:M.ixfe,XF:j[M.ixfe],t:"z"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:M.c,r:M.r},b,e));break;case 190:if(e.sheetStubs)for(var Mt=M.c;Mt<=M.C;++Mt){var Ft=M.ixfe[Mt-M.c];b={ixfe:Ft,XF:j[Ft],t:"z"},F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:Mt,r:M.r},b,e)}break;case 214:case 516:case 4:b=XC(M.val,M.ixfe,"s"),b.XF=j[b.ixfe],F>0&&(b.z=H[b.ixfe>>8&63]),Mf(b,e,r.opts.Date1904),T({c:M.c,r:M.r},b,e);break;case 0:case 512:Re===1&&(o=M);break;case 252:c=M;break;case 1054:if(P.biff==4){H[F++]=M[1];for(var $t=0;$t<F+163&&kn[$t]!=M[1];++$t);$t>=163&&lA(M[1],F+163)}else lA(M[1],M[0]);break;case 30:{H[F++]=M;for(var kt=0;kt<F+163&&kn[kt]!=M;++kt);kt>=163&&lA(M,F+163)}break;case 229:z=z.concat(M);break;case 93:ce[M.cmo[0]]=P.lastobj=M;break;case 438:P.lastobj.TxO=M;break;case 127:P.lastobj.ImData=M;break;case 440:for(x=M[0].s.r;x<=M[0].e.r;++x)for(p=M[0].s.c;p<=M[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&(h.l=M[1]);break;case 2048:for(x=M[0].s.r;x<=M[0].e.r;++x)for(p=M[0].s.c;p<=M[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&h.l&&(h.l.Tooltip=M[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=e.dense?(a[M[0].r]||[])[M[0].c]:a[On(M[0])];var Ge=ce[M[2]];h||(e.dense?(a[M[0].r]||(a[M[0].r]=[]),h=a[M[0].r][M[0].c]={t:"z"}):h=a[On(M[0])]={t:"z"},o.e.r=Math.max(o.e.r,M[0].r),o.s.r=Math.min(o.s.r,M[0].r),o.e.c=Math.max(o.e.c,M[0].c),o.s.c=Math.min(o.s.c,M[0].c)),h.c||(h.c=[]),m={a:M[1],t:Ge.TxO.t},h.c.push(m)}break;case 2173:aFe(j[M.ixfe],M.ext);break;case 125:{if(!P.cellStyles)break;for(;M.e>=M.s;)de[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},me||(me=!0,vR(M.w/256)),Im(de[M.e+1])}break;case 520:{var ie={};M.level!=null&&(ue[M.r]=ie,ie.level=M.level),M.hidden&&(ue[M.r]=ie,ie.hidden=!0),M.hpt&&(ue[M.r]=ie,ie.hpt=M.hpt,ie.hpx=Qv(M.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Hp(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[D]]=M;break;case 161:a["!margins"]||Hp(a["!margins"]={}),a["!margins"].header=M.header,a["!margins"].footer=M.footer;break;case 574:M.RTL&&(_.Views[0].RTL=!0);break;case 146:I=M;break;case 2198:O=M;break;case 140:w=M;break;case 442:u?S.CodeName=M||S.name:_.WBProps.CodeName=M||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+D.toString(16)),t.l+=Q}return r.SheetNames=ji(s).sort(function(Ue,Ne){return Number(Ue)-Number(Ne)}).map(function(Ue){return s[Ue].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&K.forEach(function(Ue,Ne){r.Sheets[r.SheetNames[Ne]]["!autofilter"]=Ue}),r.Strings=c,r.SSF=Os(kn),P.enc&&(r.Encryption=P.enc),O&&(r.Themes=O),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),se.names.length>0&&(_.Names=se.names),r.Workbook=_,r}var Mb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xMe(t,e,r){var n=_n.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=LH(n,Xk,Mb.DSI);for(var s in a)e[s]=a[s]}catch(u){if(r.WTF)throw u}var o=_n.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=LH(o,Yk,Mb.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(eae(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function vMe(t,e){var r=[],n=[],a=[],s=0,o,l=mH(Xk,"n"),c=mH(Yk,"n");if(t.Props)for(o=ji(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=ji(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)oae.indexOf(a[s][0])>-1||Zne.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&_n.utils.cfb_add(e,"/SummaryInformation",UH(n,Mb.SI,c,Yk)),(r.length||u.length)&&_n.utils.cfb_add(e,"/DocumentSummaryInformation",UH(r,Mb.DSI,l,Xk,u.length?u:null,Mb.UDI))}function rse(t,e){e||(e={}),IR(e),W6(),e.codepage&&z6(e.codepage);var r,n;if(t.FullPaths){if(_n.find(t,"/encryption"))throw new Error("File is password-protected");r=_n.find(t,"!CompObj"),n=_n.find(t,"/Workbook")||_n.find(t,"/Book")}else{switch(e.type){case"base64":t=Pu(Hu(t));break;case"binary":t=Pu(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}_l(t,0),n={content:t}}var a,s;if(r&&AMe(r),e.bookProps&&!e.bookSheets)a={};else{var o=ea?"buffer":"array";if(n&&n.content)a=gMe(n.content,e);else if((s=_n.find(t,"PerfectOffice_MAIN"))&&s.content)a=Vp.to_workbook(s.content,(e.type=o,e));else if((s=_n.find(t,"NativeContent_MAIN"))&&s.content)a=Vp.to_workbook(s.content,(e.type=o,e));else throw(s=_n.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&_n.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=TFe(t))}var l={};return t.FullPaths&&xMe(t,l,e),a.Props=a.Custprops=l,e.bookFiles&&(a.cfb=t),a}function yMe(t,e){var r=e||{},n=_n.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return _n.utils.cfb_add(n,a,nse(t,r)),r.biff==8&&(t.Props||t.Custprops)&&vMe(t,n),r.biff==8&&t.vbaraw&&kFe(n,_n.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var U2={0:{f:$De},1:{f:JDe},2:{f:g6e},3:{f:i6e},4:{f:r6e},5:{f:A6e},6:{f:w6e},7:{f:u6e},8:{f:j6e},9:{f:I6e},10:{f:E6e},11:{f:S6e},12:{f:e6e},13:{f:v6e},14:{f:l6e},15:{f:a6e},16:{f:zae},17:{f:C6e},18:{f:f6e},19:{f:cR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:CRe},40:{},42:{},43:{f:wke},44:{f:yke},45:{f:_ke},46:{f:Ske},47:{f:Eke},48:{},49:{f:q4e},50:{},51:{f:oFe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xae},62:{f:b6e},63:{f:pFe},64:{f:G6e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:lc,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Q6e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:XDe},148:{f:qDe,p:16},151:{f:O6e},152:{},153:{f:bRe},154:{},155:{},156:{f:vRe},157:{},158:{},159:{T:1,f:RTe},160:{T:-1},161:{T:1,f:Qg},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:P6e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:sFe},336:{T:-1},337:{f:uFe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wk},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gae},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:D6e},427:{f:R6e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:L6e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:WDe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:k6e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wk},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:SFe},633:{T:1},634:{T:-1},635:{T:1,f:_Fe},636:{T:-1},637:{f:Y4e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lRe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:K6e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nF={6:{f:k5},10:{f:A0},12:{f:no},13:{f:no},14:{f:Ri},15:{f:Ri},16:{f:nc},17:{f:Ri},18:{f:Ri},19:{f:no},20:{f:KH},21:{f:KH},23:{f:gae},24:{f:zH},25:{f:Ri},26:{},27:{},28:{f:KBe},29:{},34:{f:Ri},35:{f:qH},38:{f:nc},39:{f:nc},40:{f:nc},41:{f:nc},42:{f:Ri},43:{f:Ri},47:{f:ake},49:{f:vBe},51:{f:no},60:{},61:{f:ABe},64:{f:Ri},65:{f:xBe},66:{f:no},77:{},80:{},81:{},82:{},85:{f:no},89:{},90:{},91:{},92:{f:nBe},93:{f:WBe},94:{},95:{f:Ri},96:{},97:{},99:{f:Ri},125:{f:xae},128:{f:FBe},129:{f:sBe},130:{f:no},131:{f:Ri},132:{f:Ri},133:{f:iBe},134:{},140:{f:nTe},141:{f:no},144:{},146:{f:iTe},151:{},152:{},153:{},154:{},155:{},156:{f:no},157:{},158:{},160:{f:hTe},161:{f:cTe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:PBe},190:{f:BBe},193:{f:A0},197:{},198:{},199:{},200:{},201:{},202:{f:Ri},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:no},220:{},221:{f:Ri},222:{},224:{f:kBe},225:{f:rBe},226:{f:A0},227:{},229:{f:qBe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:lBe},253:{f:bBe},255:{f:uBe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:lae},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ri},353:{f:A0},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:LBe},431:{f:Ri},432:{},433:{},434:{},437:{},438:{f:JBe},439:{f:Ri},440:{f:ZBe},441:{},442:{f:Uw},443:{},444:{f:no},445:{},446:{},448:{f:A0},449:{f:hBe,r:2},450:{f:A0},512:{f:HH},513:{f:fTe},515:{f:RBe},516:{f:NBe},517:{f:GH},519:{f:ATe},520:{f:dBe},523:{},545:{f:WH},549:{f:VH},566:{},574:{f:pBe},638:{f:jBe},659:{},1048:{},1054:{f:_Be},1084:{},1212:{f:HBe},2048:{f:tTe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:A0},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:oTe,r:12},2173:{f:nFe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ri,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:VBe,r:12},2197:{},2198:{f:Yke,r:12},2199:{},2200:{},2201:{},2202:{f:$Be,r:12},2203:{f:A0},2204:{},2205:{},2206:{},2207:{},2211:{f:fBe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:no},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:uTe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:sTe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:HH},1:{},2:{f:vTe},3:{f:gTe},4:{f:pTe},5:{f:GH},7:{f:bTe},8:{},9:{f:qC},11:{},22:{f:no},30:{f:SBe},31:{},32:{},33:{f:WH},36:{},37:{f:VH},50:{f:wTe},62:{},52:{},67:{},68:{f:no},69:{},86:{},126:{},127:{f:mTe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:NTe},223:{},234:{},354:{},421:{},518:{f:k5},521:{f:qC},536:{f:zH},547:{f:qH},561:{},579:{},1030:{f:k5},1033:{f:qC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vr(t,e,r,n){var a=e;if(!isNaN(a)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&iR(r)&&t.push(r)}}function bMe(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Vr(t,e,r,a);var s=e;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<a;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function $w(t,e,r){return t||(t=dr(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function wMe(t,e,r,n){var a=dr(9);return $w(a,t,e),cae(r,n||"b",a),a}function NMe(t,e,r){var n=dr(8+2*r.length);return $w(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function CMe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Oo(Fs(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Vr(t,2,yTe(r,n,a)):Vr(t,3,xTe(r,n,a));return;case"b":case"e":Vr(t,5,wMe(r,n,e.v,e.t));return;case"s":case"str":Vr(t,4,NMe(r,n,(e.v||"").slice(0,255)));return}Vr(t,1,$w(null,r,n))}function _Me(t,e,r,n){var a=Array.isArray(e),s=Ea(e["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=zn(s)}for(var u=s.s.r;u<=s.e.r;++u){l=zi(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=li(d)),o=c[d]+l;var f=a?(e[u]||[])[d]:e[o];f&&CMe(t,f,u,d)}}}function EMe(t,e){for(var r=e||{},n=iu(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Vr(n,r.biff==4?1033:r.biff==3?521:9,pR(t,16,r)),_Me(n,t.Sheets[t.SheetNames[a]],a,r),Vr(n,10),n.end()}function SMe(t,e,r){Vr(t,49,yBe({sz:12,name:"Arial"},r))}function IMe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Vr(t,1054,EBe(a,e[a],r))})}function jMe(t,e){var r=dr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Vr(t,2151,r),r=dr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Aae(Ea(e["!ref"]||"A1"),r),r.write_shift(4,4),Vr(t,2152,r)}function PMe(t,e){for(var r=0;r<16;++r)Vr(t,224,$H({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Vr(t,224,$H(n,0,e))})}function BMe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Vr(t,440,eTe(n)),n[1].Tooltip&&Vr(t,2048,rTe(n))}delete e["!links"]}function TMe(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Vr(t,125,lTe(AP(a,n),a))})}}function kMe(t,e,r,n,a){var s=16+Vm(a.cellXfs,e,a);if(e.v==null&&!e.bf){Vr(t,513,pg(r,n,s));return}if(e.bf)Vr(t,6,sDe(e,r,n,a,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Oo(Fs(e.v)):e.v;Vr(t,515,MBe(r,n,o,s));break;case"b":case"e":Vr(t,517,DBe(r,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var l=CR(a.Strings,e.v,a.revStrings);Vr(t,253,wBe(r,n,l,s))}else Vr(t,516,CBe(r,n,(e.v||"").slice(0,255),s,a));break;default:Vr(t,513,pg(r,n,s))}}function FMe(t,e,r){var n=iu(),a=r.SheetNames[t],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,d,f="",A=[],h=Ea(s["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Vr(n,2057,pR(r,16,e)),Vr(n,13,gd(1)),Vr(n,12,gd(100)),Vr(n,15,Nc(!0)),Vr(n,17,Nc(!1)),Vr(n,16,Ag(.001)),Vr(n,95,Nc(!0)),Vr(n,42,Nc(!1)),Vr(n,43,Nc(!1)),Vr(n,130,gd(1)),Vr(n,128,OBe()),Vr(n,131,Nc(!1)),Vr(n,132,Nc(!1)),u&&TMe(n,s["!cols"]),Vr(n,512,IBe(h,e)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=zi(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(A[x]=li(x)),d=A[x]+f;var v=c?(s[p]||[])[x]:s[d];v&&(kMe(n,v,p,x,e),u&&v.l&&s["!links"].push([d,v.l]))}}var y=l.CodeName||l.name||a;return u&&Vr(n,574,gBe((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Vr(n,229,zBe(s["!merges"])),u&&BMe(n,s),Vr(n,442,uae(y)),u&&jMe(n,s),Vr(n,10),n.end()}function OMe(t,e,r){var n=iu(),a=(t||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Vr(n,2057,pR(t,5,r)),r.bookType=="xla"&&Vr(n,135),Vr(n,225,l?gd(1200):null),Vr(n,193,D5e(2)),c&&Vr(n,191),c&&Vr(n,192),Vr(n,226),Vr(n,92,aBe("SheetJS",r)),Vr(n,66,gd(l?1200:1252)),l&&Vr(n,353,gd(0)),l&&Vr(n,448),Vr(n,317,dTe(t.SheetNames.length)),l&&t.vbaraw&&Vr(n,211),l&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";Vr(n,442,uae(u))}Vr(n,156,gd(17)),Vr(n,25,Nc(!1)),Vr(n,18,Nc(!1)),Vr(n,19,gd(0)),l&&Vr(n,431,Nc(!1)),l&&Vr(n,444,gd(0)),Vr(n,61,mBe()),Vr(n,64,Nc(!1)),Vr(n,141,gd(0)),Vr(n,34,Nc(hRe(t)=="true")),Vr(n,14,Nc(!0)),l&&Vr(n,439,Nc(!1)),Vr(n,218,gd(0)),SMe(n,t,r),IMe(n,t.SSF,r),PMe(n,r),l&&Vr(n,352,Nc(!1));var d=n.end(),f=iu();l&&Vr(f,140,aTe()),l&&r.Strings&&bMe(f,252,cBe(r.Strings)),Vr(f,10);var A=f.end(),h=iu(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=d.length+m+A.length;for(p=0;p<t.SheetNames.length;++p){var v=s[p]||{};Vr(h,133,oBe({pos:x,hs:v.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return d.length&&b.push(d),y.length&&b.push(y),A.length&&b.push(A),Jo(b)}function DMe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Os(kn)),t&&t.SSF&&(v1(),oP(t.SSF),r.revssf=cP(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,jR(r),r.cellXfs=[],Vm(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=FMe(a,r,t);return n.unshift(OMe(t,n,r)),Jo(n)}function nse(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ou(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return DMe(t,e);case 4:case 3:case 2:return EMe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function s$(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=a.index,l=s&&s.index||t.length,c=y4e(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,A=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(x!="<td"&&x!="<th")){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var j=0;j<m.length;++j){var I=m[j];I.s.c==d&&I.s.r<u&&u<=I.e.r&&(d=I.e.c+1,j=-1)}var _=Dn(y.slice(0,y.indexOf(">")));A=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||A>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+A-1}});var S=_.t||_["data-t"]||"";if(!b.length){d+=A;continue}if(b=Sne(b),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!b.length){d+=A;continue}var E={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(gf(b))?isNaN(Lv(b).getDate())||(E={t:"d",v:Fs(b)},r.cellDates||(E={t:"n",v:Oo(E.v)}),E.z=r.dateNF||kn[14]):E={t:"n",v:gf(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=E):n[On({r:u,c:d})]=E,d+=A}}}}return n["!ref"]=zn(h),m.length&&(n["!merges"]=m),n}function RMe(t,e,r,n){for(var a=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=On({r,c:o}),f=n.dense?(t[r]||[])[o]:t[d],A=f&&f.v!=null&&(f.h||nR(f.w||(bA(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?A='<span contenteditable="true">'+A+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(A='<a href="'+f.l.Target+'">'+A+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(Qr("td",A,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var MMe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',LMe="</body></html>";function UMe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Qm(s$(r[0],e),e);var n=TR();return r.forEach(function(a,s){kR(n,s$(a,e),"Sheet"+(s+1))}),n}function QMe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ase(t,e){var r=e||{},n=r.header!=null?r.header:MMe,a=r.footer!=null?r.footer:LMe,s=[n],o=ou(t["!ref"]);r.dense=Array.isArray(t),s.push(QMe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(RMe(t,o,l,r));return s.push("</table>"+a),s.join("")}function sse(t,e,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?ci(n.origin):n.origin;a=o.r,s=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var d=ou(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],A=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,v=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var w=l[m];if(i$(w)){if(n.display)continue;h[p]={hidden:!0}}var j=w.children;for(x=v=0;x<j.length;++x){var I=j[x];if(!(n.display&&i$(I))){var _=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):Sne(I.innerHTML),S=I.getAttribute("data-z")||I.getAttribute("z");for(A=0;A<f.length;++A){var E=f[A];E.s.c==v+s&&E.s.r<p+a&&p+a<=E.e.r&&(v=E.e.c+1-s,A=-1)}b=+I.getAttribute("colspan")||1,((y=+I.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+s},e:{r:p+a+(y||1)-1,c:v+s+(b||1)-1}});var B={t:"s",v:_},T=I.getAttribute("data-t")||I.getAttribute("t")||"";_!=null&&(_.length==0?B.t=T||"z":n.raw||_.trim().length==0||T=="s"||(_==="TRUE"?B={t:"b",v:!0}:_==="FALSE"?B={t:"b",v:!1}:isNaN(gf(_))?isNaN(Lv(_).getDate())||(B={t:"d",v:Fs(_)},n.cellDates||(B={t:"n",v:Oo(B.v)}),B.z=n.dateNF||kn[14]):B={t:"n",v:gf(_)})),B.z===void 0&&S!=null&&(B.z=S);var P="",O=I.getElementsByTagName("A");if(O&&O.length)for(var z=0;z<O.length&&!(O[z].hasAttribute("href")&&(P=O[z].getAttribute("href"),P.charAt(0)!="#"));++z);P&&P.charAt(0)!="#"&&(B.l={Target:P}),n.dense?(t[p+a]||(t[p+a]=[]),t[p+a][v+s]=B):t[On({c:v+s,r:p+a})]=B,u.e.c<v+s&&(u.e.c=v+s),v+=b}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),t["!ref"]=zn(u),p>=c&&(t["!fullref"]=zn((u.e.r=l.length-m+p-1+a,u))),t}function ise(t,e){var r=e||{},n=r.dense?[]:{};return sse(n,t,e)}function VMe(t,e){return Qm(ise(t,e),e)}function i$(t){var e="",r=HMe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function HMe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $Me(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=_a(e.replace(/<[^>]*>/g,""));return[r]}var o$={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ose(t,e){var r=e||{},n=aR(t),a=[],s,o,l={name:""},c="",u=0,d,f,A={},h=[],m=r.dense?[]:{},p,x,v={value:""},y="",b=0,w=[],j=-1,I=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,E={},B=[],T={},P=0,O=0,z=[],ce=1,de=1,ue=[],me={Names:[]},se={},ke=["",""],Re=[],F={},H="",K=0,L=!1,W=!1,Y=0;for(F2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=F2.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?m["!ref"]=zn(_):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(m["!fullref"]=m["!ref"],_.e.r=r.sheetRows-1,m["!ref"]=zn(_)),B.length&&(m["!merges"]=B),z.length&&(m["!rows"]=z),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),A[d.name]=m,W=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Dn(p[0],!1),j=I=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,m=r.dense?[]:{},B=[],z=[],W=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){j+=ce,ce=1;break}if(f=Dn(p[0],!1),f.?j=f.-1:j==-1&&(j=0),ce=+f["number-rows-repeated"]||1,ce<10)for(Y=0;Y<ce;++Y)S>0&&(z[j+Y]={level:S});I=-1;break;case"covered-table-cell":p[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(m[j]||(m[j]=[]),m[j][I]={t:"z"}):m[On({r:j,c:I})]={t:"z"}),y="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++I,v=Dn(p[0],!1),de=parseInt(v["number-columns-repeated"]||"1",10),x={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(x.f=r$(_a(v.formula))),(v.||v["value-type"])=="string"&&(x.t="s",x.v=_a(v["string-value"]||""),r.dense?(m[j]||(m[j]=[]),m[j][I]=x):m[On({r:j,c:I})]=x),I+=de-1;else if(p[1]!=="/"){++I,y="",b=0,w=[],de=1;var D=ce?j+ce-1:j;if(I>_.e.c&&(_.e.c=I),I<_.s.c&&(_.s.c=I),j<_.s.r&&(_.s.r=j),D>_.e.r&&(_.e.r=D),v=Dn(p[0],!1),Re=[],F={},x={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=_a(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(P=parseInt(v["number-matrix-rows-spanned"],10)||0,O=parseInt(v["number-matrix-columns-spanned"],10)||0,T={s:{r:j,c:I},e:{r:j+P-1,c:I+O-1}},x.F=zn(T),ue.push([T,x.F])),v.formula)x.f=r$(v.formula);else for(Y=0;Y<ue.length;++Y)j>=ue[Y][0].s.r&&j<=ue[Y][0].e.r&&I>=ue[Y][0].s.c&&I<=ue[Y][0].e.c&&(x.F=ue[Y][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(P=parseInt(v["number-rows-spanned"],10)||0,O=parseInt(v["number-columns-spanned"],10)||0,T={s:{r:j,c:I},e:{r:j+P-1,c:I+O-1}},B.push(T)),v["number-columns-repeated"]&&(de=parseInt(v["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Ps(v["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(v.value);break;case"percentage":x.t="n",x.v=parseFloat(v.value);break;case"currency":x.t="n",x.v=parseFloat(v.value);break;case"date":x.t="d",x.v=Fs(v["date-value"]),r.cellDates||(x.t="n",x.v=Oo(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=g4e(v["time-value"])/86400,r.cellDates&&(x.t="d",x.v=uP(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(v.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",v["string-value"]!=null&&(y=_a(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(L=!1,x.t==="s"&&(x.v=y||"",w.length&&(x.R=w),L=b==0),se.Target&&(x.l=se),Re.length>0&&(x.c=Re,Re=[]),y&&r.cellText!==!1&&(x.w=y),L&&(x.t="z",delete x.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var Q=0;Q<ce;++Q){if(de=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[j+Q]||(m[j+Q]=[]),m[j+Q][I]=Q==0?x:Os(x);--de>0;)m[j+Q][I+de]=Os(x);else for(m[On({r:j+Q,c:I})]=x;--de>0;)m[On({r:j+Q,c:I+de})]=Os(x);_.e.c<=I&&(_.e.c=I)}de=parseInt(v["number-columns-repeated"]||"1",10),I+=de-1,de=0,x={},y="",w=[]}se={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;F.t=y,w.length&&(F.R=w),F.a=H,Re.push(F)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);H="",K=0,y="",b=0,w=[];break;case"creator":p[1]==="/"?H=n.slice(K,p.index):K=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Dn(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=o$[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=o$[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=Dn(p[0],!1),ke=F5(o["cell-range-address"]);var ee={Name:o.name,Ref:ke[0]+"!"+ke[1]};W&&(ee.Sheet=h.length),me.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var ve=$Me(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+ve[0]}else Dn(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ke=F5(Dn(p[0])["target-range-address"]),A[ke[0]]["!autofilter"]={ref:ke[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(se=Dn(p[0],!1),!se.href)break;se.Target=_a(se.href),delete se.href,se.Target.charAt(0)=="#"&&se.Target.indexOf(".")>-1?(ke=F5(se.Target.slice(1)),se.Target="#"+ke[0]+"!"+ke[1]):se.Target.match(/^\.\.[\\\/]/)&&(se.Target=se.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var M={Sheets:A,SheetNames:h,Workbook:me};return r.bookSheets&&delete M.Sheets,M}function l$(t,e){e=e||{},pd(t,"META-INF/manifest.xml")&&g5e(ro(t,"META-INF/manifest.xml"),e);var r=Bu(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ose(cs(r),e);return pd(t,"meta.xml")&&(n.Props=Yne(ro(t,"meta.xml"))),n}function c$(t,e){return ose(t,e)}var GMe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+k2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xi+e}}(),u$=function(){var t=function(s){return rs(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+rs(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=ou(s["!ref"]||"A1"),A=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(u=0;u<f.s.r;++u)p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(e);for(;d<=f.e.c;++d){var v=!1,y={},b="";for(h=0;h!=A.length;++h)if(!(A[h].s.c>d)&&!(A[h].s.r>u)&&!(A[h].e.c<d)&&!(A[h].e.r<u)){(A[h].s.c!=d||A[h].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=A[h].e.c-A[h].s.c+1,y["table:number-rows-spanned"]=A[h].e.r-A[h].s.r+1;break}if(v){c.push(r);continue}var w=On({r:u,c:d}),j=m?(s[u]||[])[d]:s[w];if(j&&j.f&&(y["table:formula"]=rs(dDe(j.f)),j.F&&j.F.slice(0,w.length)==w)){var I=ou(j.F);y["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,y["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!j){c.push(e);continue}switch(j.t){case"b":b=j.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=j.v?"true":"false";break;case"n":b=j.w||String(j.v||0),y["office:value-type"]="float",y["office:value"]=j.v||0;break;case"s":case"str":b=j.v==null?"":j.v,y["office:value-type"]="string";break;case"d":b=j.w||Fs(j.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Fs(j.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var _=t(b);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+fDe(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),_=Qr("text:a",_,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+Qr("table:table-cell",Qr("text:p",_,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Im(f),f.ods=l;var A=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+A+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Xi],u=k2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=k2({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Xne().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function lse(t,e){if(e.bookType=="fods")return u$(t,e);var r=eR(),n="",a=[],s=[];return n="mimetype",Yn(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Yn(r,n,u$(t,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Yn(r,n,GMe(t,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Yn(r,n,Xi+Xne()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Yn(r,n,y5e(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Yn(r,n,x5e(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function gg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function aF(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):cs(Um(t))}function KMe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Pu(Zf(t))}function qMe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Pm(t){var e=t.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function d$(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function zMe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function WMe(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=r>=0?0:128}function Q2(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Wa(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Si(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ia(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=Q2(t,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Q2(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};e[a]==null?e[a]=[u]:e[a].push(u)}return e}function pl(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Wa(n*8+a.type)),a.type==2&&e.push(Wa(a.data.length)),e.push(a.data))})}),Pm(e)}function SR(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ud(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=Q2(t,n),s=Ia(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:Si(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Ia(l.data),u=Si(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=Si(s[3][0].data)>>>0>0),r.push(o)}return r}function px(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Wa(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Wa(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Wa(o.data.length)}],n[2].push({data:pl(o.meta),type:2})});var s=pl(n);e.push(Wa(s.length)),e.push(s),a.forEach(function(o){return e.push(o)})}),Pm(e)}function XMe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Q2(e,r),a=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Pm(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=Pm(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function dd(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(XMe(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Pm(e)}function gx(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var s=Wa(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Pm(e)}function YMe(t,e,r,n){var a=gg(t),s=a.getUint32(4,!0),o=(n>1?12:8)+d$(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=d$(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function JMe(t,e,r){var n=gg(t),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=zMe(t,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return f}function D5(t,e){var r=new Uint8Array(32),n=gg(r),a=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,WMe(r,a,t.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,a)}function R5(t,e){var r=new Uint8Array(32),n=gg(r),a=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,a)}function ZMe(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return YMe(t,e,r,t[0]);case 5:return JMe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Jl(t){var e=Ia(t);return Q2(e[1][0].data)}function f$(t,e){var r=Ia(e.data),n=Si(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=Ia(o.data),c=Si(l[1][0].data)>>>0;switch(n){case 1:s[c]=aF(l[3][0].data);break;case 8:{var u=t[Jl(l[9][0].data)][0],d=Ia(u.data),f=t[Jl(d[1][0].data)][0],A=Si(f.meta[1][0].data);if(A!=2001)throw new Error("2000 unexpected reference to ".concat(A));var h=Ia(f.data);s[c]=h[3].map(function(m){return aF(m.data)}).join("")}break}}),s}function e8e(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=Ia(t),v=Si(x[1][0].data)>>>0,y=Si(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Si(x[8][0].data)>0||!1,w,j;if((s=(a=x[7])==null?void 0:a[0])!=null&&s.data&&e!=0)w=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=x[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=x[4])==null?void 0:d[0])!=null&&f.data&&e!=1)w=(h=(A=x[4])==null?void 0:A[0])==null?void 0:h.data,j=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var I=b?4:1,_=gg(w),S=[],E=0;E<w.length/2;++E){var B=_.getUint16(E*2,!0);B<65535&&S.push([E,B])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var T=[];for(E=0;E<S.length-1;++E)T[S[E][0]]=j.subarray(S[E][1]*I,S[E+1][1]*I);return S.length>=1&&(T[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*I)),{R:v,cells:T}}function t8e(t,e){var r,n=Ia(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Si(n[7][0].data)>>>0>0?1:0:-1,s=SR(n[5],function(o){return e8e(o,a)});return{nrows:Si(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function r8e(t,e,r){var n,a=Ia(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Si(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Si(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=zn(s);var o=Ia(a[4][0].data),l=f$(t,t[Jl(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?f$(t,t[Jl(o[17][0].data)][0]):[],u=Ia(o[3][0].data),d=0;u[1].forEach(function(f){var A=Ia(f.data),h=t[Jl(A[2][0].data)][0],m=Si(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=t8e(t,h);p.data.forEach(function(x,v){x.forEach(function(y,b){var w=On({r:d+v,c:b}),j=ZMe(y,l,c);j&&(r[w]=j)})}),d+=p.nrows})}function n8e(t,e){var r=Ia(e.data),n={"!ref":"A1"},a=t[Jl(r[2][0].data)],s=Si(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return r8e(t,a[0],n),n}function a8e(t,e){var r,n=Ia(e.data),a={name:(r=n[1])!=null&&r[0]?aF(n[1][0].data):"",sheets:[]},s=SR(n[2],Jl);return s.forEach(function(o){t[o].forEach(function(l){var c=Si(l.meta[1][0].data);c==6e3&&a.sheets.push(n8e(t,l))})}),a}function s8e(t,e){var r=TR(),n=Ia(e.data),a=SR(n[1],Jl);if(a.forEach(function(s){t[s].forEach(function(o){var l=Si(o.meta[1][0].data);if(l==2){var c=a8e(t,o);c.sheets.forEach(function(u,d){kR(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function M5(t){var e,r,n,a,s={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=dd(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=ud(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Si(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Si(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return s8e(s,l)}function i8e(t,e,r){var n,a,s,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&Si(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=gg(t[7][0].data),d=0,f=[],A=gg(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),A.setUint16(p*2,h,!0);var x,v;switch(typeof e[p]){case"string":x=D5({t:"s",v:e[p]},r),v=R5({t:"s",v:e[p]},r);break;case"number":x=D5({t:"n",v:e[p]},r),v=R5({t:"n",v:e[p]},r);break;case"boolean":x=D5({t:"b",v:e[p]},r),v=R5({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(x),d+=x.length,m.push(v),h+=v.length,++c}for(t[2][0].data=Wa(c);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535,!0);return t[6][0].data=Pm(f),t[3][0].data=Pm(m),c}function o8e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ou(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(zn(n)));var s=YS(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(K){typeof K=="string"&&o.push(K)})});var l={},c=[],u=_n.read(e.numbers,{type:"base64"});u.FileIndex.map(function(H,K){return[H,u.FullPaths[K]]}).forEach(function(H){var K=H[0],L=H[1];if(K.type==2&&K.name.match(/\.iwa/)){var W=K.content,Y=dd(W),D=ud(Y);D.forEach(function(Q){c.push(Q.id),l[Q.id]={deps:[],location:L,type:Si(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(H,K){return H-K});var d=c.filter(function(H){return H>1}).map(function(H){return[H,Wa(H)]});u.FileIndex.map(function(H,K){return[H,u.FullPaths[K]]}).forEach(function(H){var K=H[0];if(H[1],!!K.name.match(/\.iwa/)){var L=ud(dd(K.content));L.forEach(function(W){W.messages.forEach(function(Y){d.forEach(function(D){W.messages.some(function(Q){return Si(Q.meta[1][0].data)!=11006&&qMe(Q.data,D[1])})&&l[D[0]].deps.push(W.id)})})})}});for(var f=_n.find(u,l[1].location),A=ud(dd(f.content)),h,m=0;m<A.length;++m){var p=A[m];p.id==1&&(h=p)}var x=Jl(Ia(h.messages[0].data)[1][0].data);for(f=_n.find(u,l[x].location),A=ud(dd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=Jl(Ia(h.messages[0].data)[2][0].data),f=_n.find(u,l[x].location),A=ud(dd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=Jl(Ia(h.messages[0].data)[2][0].data),f=_n.find(u,l[x].location),A=ud(dd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);var v=Ia(h.messages[0].data);{v[6][0].data=Wa(n.e.r+1),v[7][0].data=Wa(n.e.c+1);var y=Jl(v[46][0].data),b=_n.find(u,l[y].location),w=ud(dd(b.content));{for(var j=0;j<w.length&&w[j].id!=y;++j);if(w[j].id!=y)throw"Bad ColumnRowUIDMapArchive";var I=Ia(w[j].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var _=0;_<=n.e.c;++_){var S=[];S[1]=S[2]=[{type:0,data:Wa(_+420690)}],I[1].push({type:2,data:pl(S)}),I[2].push({type:0,data:Wa(_)}),I[3].push({type:0,data:Wa(_)})}I[4]=[],I[5]=[],I[6]=[];for(var E=0;E<=n.e.r;++E)S=[],S[1]=S[2]=[{type:0,data:Wa(E+726270)}],I[4].push({type:2,data:pl(S)}),I[5].push({type:0,data:Wa(E)}),I[6].push({type:0,data:Wa(E)});w[j].messages[0].data=pl(I)}b.content=gx(px(w)),b.size=b.content.length,delete v[46];var B=Ia(v[4][0].data);{B[7][0].data=Wa(n.e.r+1);var T=Ia(B[1][0].data),P=Jl(T[2][0].data);b=_n.find(u,l[P].location),w=ud(dd(b.content));{if(w[0].id!=P)throw"Bad HeaderStorageBucket";var O=Ia(w[0].messages[0].data);for(E=0;E<s.length;++E){var z=Ia(O[2][0].data);z[1][0].data=Wa(E),z[4][0].data=Wa(s[E].length),O[2][E]={type:O[2][0].type,data:pl(z)}}w[0].messages[0].data=pl(O)}b.content=gx(px(w)),b.size=b.content.length;var ce=Jl(B[2][0].data);b=_n.find(u,l[ce].location),w=ud(dd(b.content));{if(w[0].id!=ce)throw"Bad HeaderStorageBucket";for(O=Ia(w[0].messages[0].data),_=0;_<=n.e.c;++_)z=Ia(O[2][0].data),z[1][0].data=Wa(_),z[4][0].data=Wa(n.e.r+1),O[2][_]={type:O[2][0].type,data:pl(z)};w[0].messages[0].data=pl(O)}b.content=gx(px(w)),b.size=b.content.length;var de=Jl(B[4][0].data);(function(){for(var H=_n.find(u,l[de].location),K=ud(dd(H.content)),L,W=0;W<K.length;++W){var Y=K[W];Y.id==de&&(L=Y)}var D=Ia(L.messages[0].data);{D[3]=[];var Q=[];o.forEach(function(M,Ye){Q[1]=[{type:0,data:Wa(Ye)}],Q[2]=[{type:0,data:Wa(1)}],Q[3]=[{type:2,data:KMe(M)}],D[3].push({type:2,data:pl(Q)})})}L.messages[0].data=pl(D);var ee=px(K),ve=gx(ee);H.content=ve,H.size=H.content.length})();var ue=Ia(B[3][0].data);{var me=ue[1][0];delete ue[2];var se=Ia(me.data);{var ke=Jl(se[2][0].data);(function(){for(var H=_n.find(u,l[ke].location),K=ud(dd(H.content)),L,W=0;W<K.length;++W){var Y=K[W];Y.id==ke&&(L=Y)}var D=Ia(L.messages[0].data);{delete D[6],delete ue[7];var Q=new Uint8Array(D[5][0].data);D[5]=[];for(var ee=0,ve=0;ve<=n.e.r;++ve){var M=Ia(Q);ee+=i8e(M,s[ve],o),M[1][0].data=Wa(ve),D[5].push({data:pl(M),type:2})}D[1]=[{type:0,data:Wa(n.e.c+1)}],D[2]=[{type:0,data:Wa(n.e.r+1)}],D[3]=[{type:0,data:Wa(ee)}],D[4]=[{type:0,data:Wa(n.e.r+1)}]}L.messages[0].data=pl(D);var Ye=px(K),ae=gx(Ye);H.content=ae,H.size=H.content.length})()}me.data=pl(se)}B[3][0].data=pl(ue)}v[4][0].data=pl(B)}h.messages[0].data=pl(v);var Re=px(A),F=gx(Re);return f.content=F,f.size=f.content.length,u}function cse(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function IR(t){cse([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function jR(t){cse([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function l8e(t){return ia.WS.indexOf(t)>-1?"sheet":t==ia.CS?"chart":t==ia.DS?"dialog":t==ia.MS?"macro":t&&t.length?t:"sheet"}function c8e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,l8e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function u8e(t,e,r,n,a,s,o,l,c,u,d,f){try{s[n]=Fb(Bu(t,r,!0),e);var A=ro(t,e),h;switch(l){case"sheet":h=TRe(A,e,a,c,s[n],u,d,f);break;case"chart":if(h=kRe(A,e,a,c,s[n],u,d,f),!h||!h["!drawel"])break;var m=Xy(h["!drawel"].Target,e),p=O2(m),x=vFe(Bu(t,m,!0),Fb(Bu(t,p,!0),m)),v=Xy(x,m),y=O2(v);h=iRe(Bu(t,v,!0),v,c,Fb(Bu(t,y,!0),v),u,h);break;case"macro":h=FRe(A,e,a,c,s[n],u,d,f);break;case"dialog":h=ORe(A,e,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];s&&s[n]&&ji(s[n]).forEach(function(w){var j="";if(s[n][w].Type==ia.CMNT){j=Xy(s[n][w].Target,e);var I=LRe(ro(t,j,!0),j,c);if(!I||!I.length)return;YH(h,I,!1)}s[n][w].Type==ia.TCMNT&&(j=Xy(s[n][w].Target,e),b=b.concat(bFe(ro(t,j,!0),c)))}),b&&b.length&&YH(h,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function ad(t){return t.charAt(0)=="/"?t.slice(1):t}function d8e(t,e){if(v1(),e=e||{},IR(e),pd(t,"META-INF/manifest.xml")||pd(t,"objectdata.xml"))return l$(t,e);if(pd(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof M5<"u"){if(t.FileIndex)return M5(t);var r=_n.utils.cfb_new();return xH(t).forEach(function(z){Yn(r,z,w4e(t,z))}),M5(r)}throw new Error("Unsupported NUMBERS file")}if(!pd(t,"[Content_Types].xml"))throw pd(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):pd(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=xH(t),a=m5e(Bu(t,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",ro(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!ro(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(Ob=[],a.sst)try{Ob=MRe(ro(t,ad(a.sst)),a.sst,e)}catch(z){if(e.WTF)throw z}e.cellStyles&&a.themes.length&&(c=RRe(Bu(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(u=DRe(ro(t,ad(a.style)),a.style,c,e))}a.links.map(function(z){try{var ce=Fb(Bu(t,O2(ad(z))),z);return QRe(ro(t,ad(z)),ce,z,e)}catch{}});var d=BRe(ro(t,ad(a.workbooks[0])),a.workbooks[0],e),f={},A="";a.coreprops.length&&(A=ro(t,ad(a.coreprops[0]),!0),A&&(f=Yne(A)),a.extprops.length!==0&&(A=ro(t,ad(a.extprops[0]),!0),A&&w5e(A,f,e)));var h={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(A=Bu(t,ad(a.custprops[0]),!0),A&&(h=C5e(A,e)));var m={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(ce){return ce.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),e.bookProps&&(m.Props=f,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&a.calcchain&&(p=URe(ro(t,ad(a.calcchain)),a.calcchain));var x=0,v={},y,b;{var w=d.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var j=0;j!=w.length;++j)f.SheetNames[j]=w[j].name}var I=s?"bin":"xml",_=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,_+1)+"_rels/"+a.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");pd(t,S)||(S="xl/_rels/workbook."+I+".rels");var E=Fb(Bu(t,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=VRe(ro(t,ad(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=NFe(ro(t,ad(a.people[0])),e)),E&&(E=c8e(E,d.Sheets));var B=ro(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var T="sheet";if(E&&E[x]?(y="xl/"+E[x][1].replace(/[\/]?xl\//,""),pd(t,y)||(y=E[x][1]),pd(t,y)||(y=S.replace(/_rels\/.*$/,"")+E[x][1]),T=E[x][2]):(y="xl/worksheets/sheet"+(x+1-B)+"."+I,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,O=0;O!=e.sheets.length;++O)typeof e.sheets[O]=="number"&&e.sheets[O]==x&&(P=1),typeof e.sheets[O]=="string"&&e.sheets[O].toLowerCase()==f.SheetNames[x].toLowerCase()&&(P=1);if(!P)continue e}}u8e(t,y,b,f.SheetNames[x],x,v,o,T,e,d,c,u)}return m={Directory:a,Workbook:d,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Ob,Styles:u,Themes:c,SSF:Os(kn)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(z,ce){z=z.replace(/^Root Entry[\/]/,""),m.keys.push(z),m.files[z]=t.FileIndex[ce]}))),e&&e.bookVBA&&(a.vba.length>0?m.vbaraw=ro(t,ad(a.vba[0]),!0):a.defaults&&a.defaults.bin===BFe&&(m.vbaraw=ro(t,"xl/vbaProject.bin",!0))),m}function f8e(t,e){var r=e||{},n="Workbook",a=_n.find(t,n);try{if(n="/!DataSpaces/Version",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(VTe(a.content),n="/!DataSpaces/DataSpaceMap",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=$Te(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=GTe(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);qTe(a.content)}catch{}if(n="/EncryptionInfo",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=zTe(a.content);if(n="/EncryptedPackage",a=_n.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function h8e(t,e){return e.bookType=="ods"?lse(t,e):e.bookType=="numbers"?o8e(t,e):e.bookType=="xlsb"?A8e(t,e):m8e(t,e)}function A8e(t,e){Wx=1024,t&&!t.SSF&&(t.SSF=Os(kn)),t&&t.SSF&&(v1(),oP(t.SSF),e.revssf=cP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Db?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Dae.indexOf(e.bookType)>-1,a=AR();jR(e=e||{});var s=eR(),o="",l=0;if(e.cellXfs=[],Vm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Yn(s,o,Jne(t.Props,e)),a.coreprops.push(o),Ja(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Yn(s,o,tae(t.Props)),a.extprops.push(o),Ja(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&ji(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Yn(s,o,rae(t.Custprops)),a.custprops.push(o),Ja(e.rels,4,o,ia.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],A=(f||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Yn(s,o,$Re(l-1,o,e,t,d)),a.sheets.push(o),Ja(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Yn(s,p,qRe(h,p)),a.comments.push(p),Ja(d,-1,"../comments"+l+"."+r,ia.CMNT),m=!0),f["!legacy"]&&m&&Yn(s,"xl/drawings/vmlDrawing"+l+".vml",Fae(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Yn(s,O2(o),pv(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Yn(s,o,KRe(e.Strings,o,e)),a.strs.push(o),Ja(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Yn(s,o,HRe(t,o)),a.workbooks.push(o),Ja(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Yn(s,o,yR(t.Themes,e)),a.themes.push(o),Ja(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Yn(s,o,GRe(t,o,e)),a.styles.push(o),Ja(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Yn(s,o,t.vbaraw),a.vba.push(o),Ja(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Yn(s,o,zRe(o)),a.metadata.push(o),Ja(e.wbrels,-1,"metadata."+r,ia.XLMETA),Yn(s,"[Content_Types].xml",Wne(a,e)),Yn(s,"_rels/.rels",pv(e.rels)),Yn(s,"xl/_rels/workbook."+r+".rels",pv(e.wbrels)),delete e.revssf,delete e.ssf,s}function m8e(t,e){Wx=1024,t&&!t.SSF&&(t.SSF=Os(kn)),t&&t.SSF&&(v1(),oP(t.SSF),e.revssf=cP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Db?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Dae.indexOf(e.bookType)>-1,a=AR();jR(e=e||{});var s=eR(),o="",l=0;if(e.cellXfs=[],Vm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Yn(s,o,Jne(t.Props,e)),a.coreprops.push(o),Ja(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Yn(s,o,tae(t.Props)),a.extprops.push(o),Ja(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&ji(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Yn(s,o,rae(t.Custprops)),a.custprops.push(o),Ja(e.rels,4,o,ia.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},A=t.Sheets[t.SheetNames[l-1]],h=(A||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Yn(s,o,qae(l-1,e,t,f)),a.sheets.push(o),Ja(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(A){var m=A["!comments"],p=!1,x="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+l+"."+r,Yn(s,x,wFe(m,d,e)),a.threadedcomments.push(x),Ja(f,-1,"../threadedComments/threadedComment"+l+"."+r,ia.TCMNT)),x="xl/comments"+l+"."+r,Yn(s,x,Oae(m)),a.comments.push(x),Ja(f,-1,"../comments"+l+"."+r,ia.CMNT),p=!0}A["!legacy"]&&p&&Yn(s,"xl/drawings/vmlDrawing"+l+".vml",Fae(l,A["!comments"])),delete A["!comments"],delete A["!legacy"]}f["!id"].rId1&&Yn(s,O2(o),pv(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Yn(s,o,wae(e.Strings,e)),a.strs.push(o),Ja(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Yn(s,o,Jae(t)),a.workbooks.push(o),Ja(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Yn(s,o,yR(t.Themes,e)),a.themes.push(o),Ja(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Yn(s,o,Pae(t,e)),a.styles.push(o),Ja(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Yn(s,o,t.vbaraw),a.vba.push(o),Ja(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Yn(s,o,kae()),a.metadata.push(o),Ja(e.wbrels,-1,"metadata."+r,ia.XLMETA),d.length>1&&(o="xl/persons/person.xml",Yn(s,o,CFe(d)),a.people.push(o),Ja(e.wbrels,-1,"persons/person.xml",ia.PEOPLE)),Yn(s,"[Content_Types].xml",Wne(a,e)),Yn(s,"_rels/.rels",pv(e.rels)),Yn(s,"xl/_rels/workbook."+r+".rels",pv(e.wbrels)),delete e.revssf,delete e.ssf,s}function PR(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Hu(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function p8e(t,e){return _n.find(t,"EncryptedPackage")?f8e(t,e):rse(t,e)}function g8e(t,e){var r,n=t,a=e||{};return a.type||(a.type=ea&&Buffer.isBuffer(t)?"buffer":"base64"),r=Cne(n,a),d8e(r,a)}function use(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return rF(t.slice(r),e);default:break e}return Uv.to_workbook(t,e)}function x8e(t,e){var r="",n=PR(t,e);switch(e.type){case"base64":r=Hu(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=hg(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=cs(r)),e.type="binary",use(r,e)}function v8e(t,e){var r=t;return e.type=="base64"&&(r=Hu(r)),r=j2.utils.decode(1200,r.slice(2),"str"),e.type="binary",use(r,e)}function y8e(t){return t.match(/[^\x00-\x7F]/)?Zf(t):t}function L5(t,e,r,n){return n?(r.type="string",Uv.to_workbook(t,r)):Uv.to_workbook(e,r)}function Vv(t,e){W6();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Vv(new Uint8Array(t),(r=Os(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xv={},r.dateNF&&(xv.dateNF=r.dateNF),r.type||(r.type=ea&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ea?"buffer":"binary",n=A4e(t),typeof Uint8Array<"u"&&!ea&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=y8e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Os(r),r.type="array",Vv(X6(n),r)}switch((a=PR(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return p8e(_n.read(n,r),r);break;case 9:if(a[1]<=8)return rse(n,r);break;case 60:return rF(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return _Te(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return yae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?g8e(n,r):L5(t,n,r,s);case 239:return a[3]===60?rF(n,r):L5(t,n,r,s);case 255:if(a[1]===254)return v8e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Vp.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Vp.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return tF.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Sae.to_workbook(n,r);break;case 10:case 13:case 32:return x8e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return CTe.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?tF.to_workbook(n,r):L5(t,n,r,s)}function dse(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Rw(e.file,_n.write(t,{type:ea?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return _n.write(t,e)}function b8e(t,e){var r=Os(e||{}),n=h8e(t,r);return w8e(n,r)}function w8e(t,e){var r={},n=ea?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?_n.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(iP(a))}return e.password&&typeof encrypt_agile<"u"?dse(encrypt_agile(a,e.password),e):e.type==="file"?Rw(e.file,a):e.type=="string"?cs(a):a}function N8e(t,e){var r=e||{},n=yMe(t,r);return dse(n,r)}function $f(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return P2(Zf(n));case"binary":return Zf(n);case"string":return t;case"file":return Rw(e.file,n,"utf8");case"buffer":return ea?DA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$f(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function C8e(t,e){switch(e.type){case"base64":return P2(t);case"binary":return t;case"string":return t;case"file":return Rw(e.file,t,"binary");case"buffer":return ea?DA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function YC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?P2(r):e.type=="string"?cs(r):r;case"file":return Rw(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function mP(t,e){W6(),pRe(t);var r=Os(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=mP(t,r);return r.type="array",iP(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $f(hMe(t,r),r);case"slk":case"sylk":return $f(vae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return $f(ase(t.Sheets[t.SheetNames[a]],r),r);case"txt":return C8e(fse(t.Sheets[t.SheetNames[a]],r),r);case"csv":return $f(BR(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return $f(yae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return YC(tF.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return $f(Uv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return $f(Sae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return $f(bae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return $f(lse(t,r),r);case"wk1":return YC(Vp.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return YC(Vp.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),YC(nse(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),N8e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return b8e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function _8e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function V2(t,e,r){var n={};return n.type="file",n.file=e,_8e(n),mP(t,n)}function E8e(t,e,r,n,a,s,o,l){var c=zi(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,A=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(A,"__rowNum__",{value:r,enumerable:!1})}catch{A.__rowNum__=r}else A.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(A[s[h]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)A[s[h]]=null;else if(u!==void 0)A[s[h]]=u;else if(d&&p===null)A[s[h]]=null;else continue;else A[s[h]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:bA(m,p,l);p!=null&&(f=!1)}}return{row:A,isempty:f}}function YS(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ea(d);break;case"number":c=Ea(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=zi(c.s.r),A=[],h=[],m=0,p=0,x=Array.isArray(t),v=c.s.r,y=0,b={};x&&!t[v]&&(t[v]=[]);var w=u.skipHidden&&t["!cols"]||[],j=u.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(A[y]=li(y),r=x?t[v][y]:t[A[y]+f],n){case 1:s[y]=y-c.s.c;break;case 2:s[y]=A[y];break;case 3:s[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=bA(r,null,u),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}s[y]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(j[v]||{}).hidden){var I=E8e(t,c,v,A,n,s,x,u);(I.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=I.row)}return h.length=m,h}var h$=/"/g;function S8e(t,e,r,n,a,s,o,l){for(var c=!0,u=[],d="",f=zi(r),A=e.s.c;A<=e.e.c;++A)if(n[A]){var h=l.dense?(t[r]||[])[A]:t[n[A]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:bA(h,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||p===34||l.forceQuotes){d='"'+d.replace(h$,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(h$,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function BR(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Ea(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(t);for(var A=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(A[m]||{}).hidden||(f[m]=li(m));for(var p=0,x=a.s.r;x<=a.e.r;++x)(h[x]||{}).hidden||(d=S8e(t,a,x,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function fse(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=BR(t,e);return r}function I8e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Ea(t["!ref"]),s="",o=[],l,c=[],u=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=li(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=zi(d),l=a.s.c;l<=a.e.c;++l)if(e=o[l]+s,r=u?(t[d]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function hse(t,e,r){var n=r||{},a=+!n.skipHeader,s=t||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ci(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+e.length-1+a}};if(s["!ref"]){var f=Ea(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+e.length-1+a)}else o==-1&&(o=0,d.e.r=e.length-1+a);var A=n.header||[],h=0;e.forEach(function(p,x){ji(p).forEach(function(v){(h=A.indexOf(v))==-1&&(A[h=A.length]=v);var y=p[v],b="z",w="",j=On({c:l+h,r:o+x+a});u=H2(s,j),y&&typeof y=="object"&&!(y instanceof Date)?s[j]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=Oo(y)),w=n.dateNF||kn[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,w&&(u.z=w)):s[j]=u={t:b,v:y},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,l+A.length-1);var m=zi(o);if(a)for(h=0;h<A.length;++h)s[li(h+l)+m]={t:"s",v:A[h]};return s["!ref"]=zn(d),s}function j8e(t,e){return hse(null,t,e)}function H2(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ci(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?H2(t,On(e)):H2(t,On({r:e,c:r||0}))}function P8e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function TR(){return{SheetNames:[],Sheets:{}}}function kR(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(Yae(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function B8e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=P8e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function T8e(t,e){return t.z=e,t}function Ase(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function k8e(t,e,r){return Ase(t,"#"+e,r)}function F8e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function O8e(t,e,r,n){for(var a=typeof e!="string"?e:Ea(e),s=typeof e=="string"?e:zn(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=H2(t,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return t}var Qa={encode_col:li,encode_row:zi,encode_cell:On,encode_range:zn,decode_col:lR,decode_row:oR,split_cell:K4e,decode_cell:ci,decode_range:ou,format_cell:bA,sheet_add_aoa:Vne,sheet_add_json:hse,sheet_add_dom:sse,aoa_to_sheet:y1,json_to_sheet:j8e,table_to_sheet:ise,table_to_book:VMe,sheet_to_csv:BR,sheet_to_txt:fse,sheet_to_json:YS,sheet_to_html:ase,sheet_to_formulae:I8e,sheet_to_row_object_array:YS,sheet_get_cell:H2,book_new:TR,book_append_sheet:kR,book_set_sheet_visibility:B8e,cell_set_number_format:T8e,cell_set_hyperlink:Ase,cell_set_internal_link:k8e,cell_add_comment:F8e,sheet_set_array_formula:O8e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const pP="pollo_cash_audits";async function D8e(t){return(await Jn(yt(Ie,pP),{...t,createdAt:t.createdAt??vr.now()})).id}async function R8e(t){const e=yt(Ie,pP),r=(()=>{if(t!=null&&t.createdFrom&&(t!=null&&t.createdTo)){const s=vr.fromDate(t.createdFrom),o=vr.fromDate(t.createdTo);return sr(e,mr("createdAt",">=",s),mr("createdAt","<=",o),In("createdAt","desc"))}return sr(e,In("createdAt","desc"))})();return(await Ht(r)).docs.map(s=>{const o=s.data();return{id:s.id,createdAt:o.createdAt,createdByUid:o.createdByUid||"",createdByName:o.createdByName||"",contadorUid:o.contadorUid||"",contadorName:o.contadorName||"",entregadoPor:o.entregadoPor||"",recibidoPor:o.recibidoPor||"",rangeFrom:o.rangeFrom||"",rangeTo:o.rangeTo||"",ventasCash:Number(o.ventasCash||0),abonos:Number(o.abonos||0),ingresosExtra:Number(o.ingresosExtra||0),debitos:Number(o.debitos||0),subTotal:Number(o.subTotal||0),totalEntregado:Number(o.totalEntregado||0),comment:o.comment||""}})}async function M8e(t){await Kn(Zt(Ie,pP,t))}async function L8e(t,e){await Fn(Zt(Ie,pP,t),e)}const yi=t=>`C$ ${(Number(t)||0).toFixed(2)}`,JC=t=>Number(t||0).toFixed(3),Di=t=>{const e=Number(String(t??"").replace(/,/g,"."));return isNaN(e)?0:Math.round(e*100)/100},JS=t=>{const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},Ym=()=>{const t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},U8e=()=>{const t=new Date;return JS(new Date(t.getFullYear(),t.getMonth(),1))},Q8e=()=>{const t=new Date;return JS(new Date(t.getFullYear(),t.getMonth()+1,0))},V8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),H8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),mse=t=>String(t??"").toLowerCase().trim(),ZC=t=>Number(t.qty??t.quantity??0),A$=t=>["lb","lbs","libra","libras"].includes(mse(t)),m$=t=>["unidad","unidades","ud","uds","pieza","piezas"].includes(mse(t));function $8e(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(!1),[o,l]=g.useState(!1),[c,u]=g.useState(null),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(""),[I,_]=g.useState(Ym()),[S,E]=g.useState(Ym()),[B,T]=g.useState(0),[P,O]=g.useState(0),[z,ce]=g.useState(0),[de,ue]=g.useState(0),[me,se]=g.useState(""),[ke,Re]=g.useState([]),[F,H]=g.useState(0),[K,L]=g.useState(!1),W=g.useMemo(()=>Di(B+P+z),[B,P,z]),Y=g.useMemo(()=>Di(W-de),[W,de]),[D,Q]=g.useState([]),[ee,ve]=g.useState(!1),[M,Ye]=g.useState(U8e()),[ae,X]=g.useState(Q8e()),[De,le]=g.useState([]),[$e,Xe]=g.useState(0),[it,xt]=g.useState(!1);async function jt(){var pe;const Ae=(await Ht(sr(yt(Ie,"users")))).docs.map(Pe=>{const Ee=Pe.data();return{uid:Pe.id,name:Ee.displayName||Ee.name||Ee.email||Pe.id,role:Ee.role,roles:Ee.roles}}).filter(Pe=>Pe.role==="contador"||Array.isArray(Pe.roles)&&Pe.roles.includes("contador"));h(Ae);const We=((pe=Ec.currentUser)==null?void 0:pe.uid)||"",_t=Ae.find(Pe=>Pe.uid===We)||Ae[0];_t&&(p(_t.uid),v(_t.name))}async function Mt(){ve(!0);try{const Ce=M&&ae?{createdFrom:V8e(new Date(M)),createdTo:H8e(new Date(ae))}:void 0,Le=await R8e(Ce);Q(Le)}finally{ve(!1)}}g.useEffect(()=>{jt(),Mt()},[]),g.useEffect(()=>{Mt()},[M,ae]),g.useEffect(()=>{(async()=>{if(!(!M||!ae)){xt(!0);try{const Le=sr(yt(Ie,"salesV2"),mr("date",">=",M),mr("date","<=",ae)),Ae=await Ht(Le),We=[];Ae.forEach(Pe=>{const Ee=Pe.data(),Ze=Ee.date??"";if(Array.isArray(Ee.items)&&Ee.items.length>0){Ee.items.forEach((xe,Se)=>{const gt=String(xe.productName??"(sin nombre)"),Et=Number(xe.qty??0),Nt=Number(xe.lineFinal??0)||Math.max(0,Number(xe.unitPrice||0)*Et-Number(xe.discount||0));We.push({id:`${Pe.id}#${Se}`,date:Ze,productName:gt,quantity:Et,amount:Nt,measurement:xe.measurement??Ee.measurement??"",type:Ee.type??"CONTADO"})});return}We.push({id:Pe.id,date:Ze,productName:Ee.productName??"(sin nombre)",quantity:Number(Ee.quantity??0),amount:Number(Ee.amount??Ee.amountCharged??0),measurement:Ee.measurement??"",type:Ee.type??"CONTADO"})}),le(We);const ct=await Ht(yt(Ie,"ar_movements_pollo"));let _t=0;const pe=Pe=>{var Ee;return Pe!=null&&Pe.date?String(Pe.date):(Ee=Pe==null?void 0:Pe.createdAt)!=null&&Ee.toDate?JS(Pe.createdAt.toDate()):""};ct.forEach(Pe=>{const Ee=Pe.data();if(String(Ee.type??"").toUpperCase()!=="ABONO")return;const xe=Math.abs(Number(Ee.amount??0)),Se=pe(Ee);Se&&Se>=M&&Se<=ae&&(_t+=xe)}),Xe(_t)}catch(Le){console.error("Error cargando KPIs del periodo:",Le),le([]),Xe(0)}finally{xt(!1)}}})()},[M,ae]),g.useEffect(()=>{(async()=>{if(!(!I||!S)){L(!0);try{const Le=sr(yt(Ie,"salesV2"),mr("date",">=",I),mr("date","<=",S)),Ae=await Ht(Le),We=[];Ae.forEach(Pe=>{const Ee=Pe.data(),Ze=Ee.date??"";if(Array.isArray(Ee.items)&&Ee.items.length>0){Ee.items.forEach((xe,Se)=>{const gt=String(xe.productName??"(sin nombre)"),Et=Number(xe.qty??0),Nt=Number(xe.lineFinal??0)||Math.max(0,Number(xe.unitPrice||0)*Et-Number(xe.discount||0));We.push({id:`${Pe.id}#${Se}`,date:Ze,productName:gt,quantity:Et,amount:Nt,measurement:xe.measurement??Ee.measurement??"",type:Ee.type??"CONTADO"})});return}We.push({id:Pe.id,date:Ze,productName:Ee.productName??"(sin nombre)",quantity:Number(Ee.quantity??0),amount:Number(Ee.amount??Ee.amountCharged??0),measurement:Ee.measurement??"",type:Ee.type??"CONTADO"})}),Re(We);const ct=await Ht(yt(Ie,"ar_movements_pollo"));let _t=0;const pe=Pe=>{var Ee;return Pe!=null&&Pe.date?String(Pe.date):(Ee=Pe==null?void 0:Pe.createdAt)!=null&&Ee.toDate?JS(Pe.createdAt.toDate()):""};ct.forEach(Pe=>{const Ee=Pe.data();if(String(Ee.type??"").toUpperCase()!=="ABONO")return;const xe=Math.abs(Number(Ee.amount??0)),Se=pe(Ee);Se&&Se>=I&&Se<=S&&(_t+=xe)}),H(_t)}catch(Le){console.error("Error cargando KPI de modal:",Le),Re([]),H(0)}finally{L(!1)}}})()},[I,S]);const Ft=g.useMemo(()=>{const Ce=D.reduce((We,ct)=>We+(Number(ct.totalEntregado)||0),0),Le=D.reduce((We,ct)=>We+(Number(ct.debitos)||0),0),Ae=D.reduce((We,ct)=>We+(Number(ct.subTotal)||0),0);return{sumTotal:Di(Ce),sumDeb:Di(Le),sumSub:Di(Ae)}},[D]),$t=g.useMemo(()=>{const Ce=De.filter(Ee=>Ee.type==="CONTADO"),Le=De.filter(Ee=>Ee.type==="CREDITO"),Ae=Ce.reduce((Ee,Ze)=>Ee+(Ze.amount||0),0),We=Ae+$e,ct=Ce.reduce((Ee,Ze)=>A$(Ze.measurement)?Ee+ZC(Ze):Ee,0),_t=Ce.reduce((Ee,Ze)=>m$(Ze.measurement)?Ee+ZC(Ze):Ee,0),pe=Le.reduce((Ee,Ze)=>A$(Ze.measurement)?Ee+ZC(Ze):Ee,0),Pe=Le.reduce((Ee,Ze)=>m$(Ze.measurement)?Ee+ZC(Ze):Ee,0);return{ventasCash:Di(Ae),recaudado:Di(We),lbsCash:JC(ct),unitsCash:JC(_t),lbsCredit:JC(pe),unitsCredit:JC(Pe)}},[De,$e]),kt=g.useMemo(()=>{const Ae=ke.filter(We=>We.type==="CONTADO").reduce((We,ct)=>We+(ct.amount||0),0)+F;return{recaudado:Di(Ae)}},[ke,F]);function Ge(){b(""),j(""),_(Ym()),E(Ym()),T(0),O(0),ce(0),ue(0),se(""),s(!1),l(!1),u(null)}function ie(Ce){u(Ce.id),e(!0),s(!0),l(!0),p(Ce.contadorUid||""),v(Ce.contadorName||""),b(Ce.recibidoPor||""),j(Ce.entregadoPor||""),_(Ce.rangeFrom||Ym()),E(Ce.rangeTo||Ym()),T(Number(Ce.ventasCash||0)),O(Number(Ce.abonos||0)),ce(Number(Ce.ingresosExtra||0)),ue(Number(Ce.debitos||0)),se(Ce.comment||"")}async function Ue(){var Ce,Le,Ae;if(!m)return alert("Seleccione Contador.");if(!y.trim())return alert("Recibido por es obligatorio.");if(!I||!S)return alert("Seleccione el rango arqueado.");if(new Date(I)>new Date(S))return alert("Rango invlido: Desde no puede ser mayor que Hasta.");n(!0);try{if(c)await L8e(c,{contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:I,rangeTo:S,ventasCash:Di(B),abonos:Di(P),ingresosExtra:Di(z),debitos:Di(de),subTotal:Di(W),totalEntregado:Di(Y),comment:me.trim()});else{const We=((Ce=Ec.currentUser)==null?void 0:Ce.uid)||"",ct=((Le=Ec.currentUser)==null?void 0:Le.displayName)||((Ae=Ec.currentUser)==null?void 0:Ae.email)||We;await D8e({createdAt:vr.now(),createdByUid:We,createdByName:ct,contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:I,rangeTo:S,ventasCash:Di(B),abonos:Di(P),ingresosExtra:Di(z),debitos:Di(de),subTotal:Di(W),totalEntregado:Di(Y),comment:me.trim()})}e(!1),Ge(),await Mt()}finally{n(!1)}}async function Ne(Ce){var Ae;if(window.confirm(`Eliminar el arqueo creado el ${(Ae=Ce.createdAt)!=null&&Ae.toDate?Ce.createdAt.toDate().toLocaleString():""}?`)){n(!0);try{await M8e(Ce.id),await Mt()}finally{n(!1)}}}function be(){const Ce=D.map(We=>{var ct;return{"Fecha de creacin":(ct=We.createdAt)!=null&&ct.toDate?We.createdAt.toDate().toLocaleString():"","Rango arqueado":`${We.rangeFrom} a ${We.rangeTo}`,"Arqueado por (Contador)":We.contadorName,"Recibido por":We.recibidoPor,"Entregado por":We.entregadoPor,"Ventas cash":We.ventasCash,Abonos:We.abonos,"Ingresos extra":We.ingresosExtra,"Sub total":We.subTotal,Dbitos:We.debitos,"Monto entregado":We.totalEntregado,Comentario:We.comment||""}}),Le=Qa.json_to_sheet(Ce),Ae=Qa.book_new();Qa.book_append_sheet(Ae,Le,"Arqueos"),V2(Ae,`arqueos_pollo_${Ym()}.xlsx`)}return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Arqueo fsico y entregas (Pollo)"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Registro de arqueos, dbitos por gasto/reabastecimiento y monto entregado."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{Ge(),e(!0)},className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo arqueo"}),i.jsx("button",{onClick:be,className:"px-3 py-2 rounded bg-emerald-600 text-white text-sm hover:bg-emerald-700",children:"Exportar Excel"})]})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Filtro por fecha (creacin)"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:M,onChange:Ce=>Ye(Ce.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:ae,onChange:Ce=>X(Ce.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]})]}),i.jsx("button",{onClick:()=>{Ye(""),X("")},className:"mt-2 text-xs text-blue-600 hover:underline",children:"Limpiar filtro"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-xl font-semibold",children:yi(Ft.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Ft.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Ft.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]})]}),i.jsxs("div",{className:"mt-3 hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi($t.ventasCash)}),it&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi($t.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.unitsCredit})]})]}),i.jsx("div",{className:"mt-3 md:hidden",children:i.jsx(U5,{title:"KPIs",open:d,onToggle:()=>f(Ce=>!Ce),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Ft.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Ft.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(Ft.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi($t.ventasCash)}),it&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:yi($t.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:$t.unitsCredit})]})]})]})})}),i.jsx("div",{className:"mt-4 block md:hidden space-y-3",children:ee?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):D.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"No hay arqueos en este rango."}):D.map(Ce=>{var Le;return i.jsxs("div",{className:"bg-white border rounded-2xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha de creacin"}),i.jsx("div",{className:"font-semibold text-sm",children:(Le=Ce.createdAt)!=null&&Le.toDate?Ce.createdAt.toDate().toLocaleString():""}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Rango arqueado"}),i.jsxs("div",{className:"text-sm",children:[Ce.rangeFrom," a ",Ce.rangeTo]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto entregado"}),i.jsx("div",{className:"font-semibold",children:yi(Ce.totalEntregado)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-gray-600",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Contador:"})," ",Ce.contadorName]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Recibido:"})," ",Ce.recibidoPor]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Sub total:"})," ",yi(Ce.subTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Dbitos:"})," ",yi(Ce.debitos)]})]}),i.jsxs("div",{className:"mt-3 flex justify-end",children:[i.jsx("button",{type:"button",onClick:()=>ie(Ce),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>Ne(Ce),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},Ce.id)})}),i.jsxs("div",{className:"mt-4 bg-white rounded shadow overflow-hidden hidden md:block",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Arqueos guardados"}),i.jsx("div",{className:"text-xs text-gray-500",children:ee?"Cargando...":`${D.length} registro(s)`})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 text-gray-600",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left px-3 py-2",children:"Fecha de creacin"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Rango arqueado"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Arqueado por"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Recibido por"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Sub total"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Dbitos"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Monto entregado"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[!ee&&D.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-3 py-6 text-center text-gray-500",children:"No hay arqueos en este rango."})}),D.map(Ce=>{var Le;return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-3 py-2",children:(Le=Ce.createdAt)!=null&&Le.toDate?Ce.createdAt.toDate().toLocaleString():""}),i.jsxs("td",{className:"px-3 py-2",children:[Ce.rangeFrom," a ",Ce.rangeTo]}),i.jsx("td",{className:"px-3 py-2",children:Ce.contadorName}),i.jsx("td",{className:"px-3 py-2",children:Ce.recibidoPor}),i.jsx("td",{className:"px-3 py-2 text-right font-medium",children:yi(Ce.subTotal)}),i.jsx("td",{className:"px-3 py-2 text-right",children:yi(Ce.debitos)}),i.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:yi(Ce.totalEntregado)}),i.jsxs("td",{className:"px-3 py-2 text-right",children:[i.jsx("button",{type:"button",onClick:()=>ie(Ce),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>Ne(Ce),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},Ce.id)})]})]})})]}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-3xl rounded shadow-lg overflow-hidden",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:c?"Editar arqueo":"Nuevo arqueo"}),i.jsx("button",{onClick:()=>{e(!1),Ge()},className:"text-sm px-2 py-1 rounded hover:bg-gray-100",children:""})]}),i.jsxs("div",{className:"p-3 md:p-4 space-y-3 text-sm",children:[i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx(U5,{title:"Datos colaboradores",open:a,onToggle:()=>s(Ce=>!Ce),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:Ce=>{const Le=Ce.target.value,Ae=A.find(We=>We.uid===Le);p(Le),v((Ae==null?void 0:Ae.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(Ce=>i.jsx("option",{value:Ce.uid,children:Ce.name},Ce.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:Ce=>b(Ce.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:Ce=>j(Ce.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:I,onChange:Ce=>_(Ce.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:Ce=>E(Ce.target.value),className:"w-full border rounded px-2 py-2"})]})]})]})}),i.jsxs(U5,{title:"Inputs y KPIs",open:o,onToggle:()=>l(Ce=>!Ce),children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:yi(kt.recaudado)}),K&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsx(m0,{label:"Ventas cash",value:B,onChange:T}),i.jsx(m0,{label:"Abonos",value:P,onChange:O}),i.jsx(m0,{label:"Ingresos extra oficiales",value:z,onChange:ce}),i.jsx(m0,{label:"Dbitos (gasto o reabastecimiento)",value:de,onChange:ue})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[i.jsx(e_,{title:"Sub total (ventas + abonos + ingresos)",value:yi(W)}),i.jsx(e_,{title:"Total (sub total - dbitos)",value:yi(Y)})]})]})]}),i.jsxs("div",{className:"hidden md:block space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:Ce=>{const Le=Ce.target.value,Ae=A.find(We=>We.uid===Le);p(Le),v((Ae==null?void 0:Ae.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(Ce=>i.jsx("option",{value:Ce.uid,children:Ce.name},Ce.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:Ce=>b(Ce.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:Ce=>j(Ce.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:I,onChange:Ce=>_(Ce.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:Ce=>E(Ce.target.value),className:"w-full border rounded px-2 py-2"})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:yi(kt.recaudado)}),K&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(m0,{label:"Ventas cash",value:B,onChange:T}),i.jsx(m0,{label:"Abonos",value:P,onChange:O}),i.jsx(m0,{label:"Ingresos extra oficiales",value:z,onChange:ce}),i.jsx(m0,{label:"Dbitos (gasto o reabastecimiento)",value:de,onChange:ue})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(e_,{title:"Sub total (ventas + abonos + ingresos)",value:yi(W)}),i.jsx(e_,{title:"Total (sub total - dbitos)",value:yi(Y)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Comentario / Nota"}),i.jsx("textarea",{value:me,onChange:Ce=>se(Ce.target.value),className:"w-full border rounded px-2 py-2 min-h-[90px]",placeholder:"Opcional..."})]})]}),i.jsxs("div",{className:"p-3 border-t flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>{e(!1),Ge()},className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",disabled:r,children:"Cancelar"}),i.jsx("button",{onClick:Ue,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-60",disabled:r,children:r?"Guardando...":c?"Guardar cambios":"Guardar arqueo"})]})]})})]})}function e_({title:t,value:e}){return i.jsxs("div",{className:"bg-gray-50 border rounded p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-semibold",children:e})]})}function m0({label:t,value:e,onChange:r}){return i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:t}),i.jsx("input",{inputMode:"decimal",value:String(e),onChange:n=>r(Di(n.target.value)),className:"w-full border rounded px-2 py-2",placeholder:"0.00"})]})}function U5({title:t,open:e,onToggle:r,children:n}){return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold text-sm",children:t}),i.jsx("button",{type:"button",onClick:r,className:"text-xs px-3 py-1.5 rounded border hover:bg-gray-50",children:e?"Cerrar":"Ver"})]}),e&&i.jsx("div",{className:"px-3 pb-3 pt-1",children:n})]})}const Qo=t=>`C$ ${(Number(t)||0).toFixed(2)}`,G8e=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function t_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function K8e(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function q8e(t){const e="ROP",r=t_(t.subcat).slice(0,3)||"GEN",n=K8e(t.gender),a=t_(t.color).slice(0,3)||"COL",s=t_(t.size)||"TLL",o=t_(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${a}-${s}-${o}-${l}`}const gy=/^[A-Za-z0-9._-]{0,32}$/;function z8e(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(Mr(new Date,"yyyy-MM-dd")),[y,b]=g.useState(0),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState(0),[B,T]=g.useState(0),[P,O]=g.useState(""),[z,ce]=g.useState(""),[de,ue]=g.useState(""),[me,se]=g.useState(""),[ke,Re]=g.useState(""),[F,H]=g.useState(""),[K,L]=g.useState(""),[W,Y]=g.useState(!1),[D,Q]=g.useState(""),[ee,ve]=g.useState("Camisa"),[M,Ye]=g.useState(null),[ae,X]=g.useState(""),[De,le]=g.useState(0),[$e,Xe]=g.useState(0),[it,xt]=g.useState(0),[jt,Mt]=g.useState(0),[Ft,$t]=g.useState(0),[kt,Ge]=g.useState(""),[ie,Ue]=g.useState(""),[Ne,be]=g.useState(""),[Ce,Le]=g.useState(""),[Ae,We]=g.useState(""),[ct,_t]=g.useState(""),[pe,Pe]=g.useState(""),[Ee,Ze]=g.useState(null),[xe,Se]=g.useState({x:0,y:0}),[gt,Et]=g.useState(!1);g.useEffect(()=>{const V=()=>Ze(null),Z=re=>re.key==="Escape"&&Ze(null);return document.addEventListener("click",V),document.addEventListener("keydown",Z),()=>{document.removeEventListener("click",V),document.removeEventListener("keydown",Z)}},[]);const Nt=(V,Z,re=192,we=160)=>{let st=V;V+re+8>window.innerWidth&&(st=V-re),st=Math.max(8,Math.min(st,window.innerWidth-re-8));let Be=Z;return Z+we+8>window.innerHeight&&(Be=window.innerHeight-we-8),Be=Math.max(8,Math.min(Be,window.innerHeight-we-8)),{x:st,y:Be}},Tt=(V,Z)=>{V.stopPropagation();const re=V.currentTarget.getBoundingClientRect(),we=re.right,Fe=re.bottom,st=Nt(we,Fe);Se(st),Ze(Be=>Be===Z?null:Z)};g.useEffect(()=>{const V=()=>Ze(null),Z=re=>{re.key==="Escape"&&Ze(null)};return document.addEventListener("click",V),document.addEventListener("keydown",Z),()=>{document.removeEventListener("click",V),document.removeEventListener("keydown",Z)}},[]),g.useEffect(()=>{if(!Ee)return;const V=()=>Ze(null);return window.addEventListener("scroll",V,!0),window.addEventListener("resize",V),()=>{window.removeEventListener("scroll",V,!0),window.removeEventListener("resize",V)}},[Ee]),g.useEffect(()=>{(async()=>{const V=await Ht(yt(Ie,"products_clothes")),Z=[];V.forEach(st=>{const Be=st.data();Z.push({id:st.id,name:Be.name??"(sin nombre)",category:Be.category??"(sin categora)",measurement:Be.measurement??"unidad",price:Number(Be.price??0),sku:Be.sku||"",size:Be.size||"",color:Be.color||"",gender:Be.gender||"",brand:Be.brand||""})}),e(Z);const re=sr(yt(Ie,"inventory_clothes_batches"),In("date","desc")),we=await Ht(re),Fe=[];we.forEach(st=>{const Be=st.data();Fe.push({id:st.id,productId:Be.productId,productName:Be.productName,category:Be.category,unit:Be.unit,quantity:Number(Be.quantity||0),remaining:Number(Be.remaining??Be.quantity??0),purchasePrice:Number(Be.purchasePrice||0),salePrice:Number(Be.salePrice||0),invoiceTotal:Number(Be.invoiceTotal??Number(Be.quantity||0)*Number(Be.purchasePrice||0)),expectedTotal:Number(Be.expectedTotal??Number(Be.quantity||0)*Number(Be.salePrice||0)),date:Be.date,createdAt:Be.createdAt,status:Be.status,notes:Be.notes||"",sku:Be.sku||"",size:Be.size||"",color:Be.color||"",gender:Be.gender||"",brand:Be.brand||"",clientCode:Be.clientCode||""})}),n(Fe),s(!1)})()},[]),g.useEffect(()=>{const V=t.find(Z=>Z.id===m);V&&(_(Number(V.price||0)),V.sku&&ce(V.sku),V.size&&ue(Z=>Z||V.size),V.color&&se(Z=>Z||V.color),V.gender&&Re(Z=>Z||V.gender),V.brand&&H(Z=>Z||V.brand))},[m,t]),g.useEffect(()=>{E(Math.floor(y*w*100)/100)},[y,w]),g.useEffect(()=>{T(Math.floor(y*I*100)/100)},[y,I]),g.useEffect(()=>{const V=t.find(we=>we.id===m);if(V!=null&&V.sku){ce(V.sku);return}const Z=W&&ee?ee:(V==null?void 0:V.category)||"";if(!Z&&!ke&&!me&&!de&&!F){ce("");return}const re=q8e({subcat:Z,gender:ke||"",color:me||"",size:de||"",brand:F||""});ce(re)},[W,ee,m,ke,me,de,F,t]);const Lt=g.useMemo(()=>r.filter(V=>!(c&&V.date<c||d&&V.date>d||A&&V.productId!==A)),[r,c,d,A]),Me=g.useMemo(()=>{const V=Lt.reduce((Fe,st)=>Fe+(st.invoiceTotal||0),0),Z=Lt.reduce((Fe,st)=>Fe+(st.expectedTotal||0),0),re=Lt.reduce((Fe,st)=>Fe+st.quantity,0),we=Lt.reduce((Fe,st)=>Fe+st.remaining,0);return{udsIng:re,udsRem:we,totalFacturado:V,totalEsperado:Z}},[Lt]),_e=async V=>{V.preventDefault(),l("");const Z=!!m&&!W,re=t.find(Be=>Be.id===m),we=Z?(re==null?void 0:re.name)||"":D||"",Fe=Z?(re==null?void 0:re.category)||"":ee||"General",st=Z&&(re==null?void 0:re.measurement)||"unidad";if(!we||y<=0||w<=0){l("Completa nombre/cantidad/costo.");return}if(K&&!gy.test(K)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const Be=await Jn(yt(Ie,"inventory_clothes_batches"),{productId:Z?re.id:"",productName:we,category:Fe,unit:st,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:B,date:x,createdAt:vr.now(),status:"PENDIENTE",notes:P||"",sku:z||"",size:de||"",color:me||"",gender:ke||"",brand:F||"",clientCode:K||""});n(at=>[{id:Be.id,productId:Z?re.id:"",productName:we,category:Fe,unit:st,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:B,date:x,createdAt:vr.now(),status:"PENDIENTE",notes:P||"",sku:z||"",size:de||"",color:me||"",gender:ke||"",brand:F||"",clientCode:K||""},...at]),l(" Lote de ropa creado"),p(""),v(Mr(new Date,"yyyy-MM-dd")),b(0),j(0),_(0),E(0),T(0),O(""),ce(""),ue(""),se(""),Re(""),H(""),L(""),Y(!1),Q(""),ve("Camisa")}catch(Be){console.error(Be),l(" Error al crear lote")}},U=async V=>{confirm(`Marcar PAGADO el lote del ${V.date} (${V.productName})?`)&&(await Fn(Zt(Ie,"inventory_clothes_batches",V.id),{status:"PAGADO"}),n(re=>re.map(we=>we.id===V.id?{...we,status:"PAGADO"}:we)))},ye=V=>{Ye(V.id),X(V.date),le(V.quantity),Xe(V.purchasePrice),xt(V.salePrice),Mt(Number((V.quantity*V.purchasePrice).toFixed(2))),$t(Number((V.quantity*V.salePrice).toFixed(2))),Ge(V.notes||""),Ue(V.sku||""),be(V.size||""),Le(V.color||""),We(V.gender||""),_t(V.brand||""),Pe(V.clientCode||"")},te=()=>{Ye(null),X(""),le(0),Xe(0),xt(0),Mt(0),$t(0),Ge(""),Ue(""),be(""),Le(""),We(""),_t(""),Pe("")};g.useEffect(()=>{M&&Mt(Math.floor(De*$e*100)/100)},[M,De,$e]),g.useEffect(()=>{M&&$t(Math.floor(De*it*100)/100)},[M,De,it]);const Ve=async()=>{if(!M)return;const V=r.find(Fe=>Fe.id===M);if(!V)return;const Z=Math.max(0,V.quantity-V.remaining),re=Math.max(0,De-Z);if(pe&&!gy.test(pe)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const we=Zt(Ie,"inventory_clothes_batches",M);await Fn(we,{date:ae,quantity:De,purchasePrice:$e,salePrice:it,invoiceTotal:jt,expectedTotal:Ft,notes:kt,remaining:re,sku:ie,size:Ne,color:Ce,gender:Ae||"",brand:ct||"",clientCode:pe||""}),n(Fe=>Fe.map(st=>st.id===M?{...st,date:ae,quantity:De,purchasePrice:$e,salePrice:it,invoiceTotal:jt,expectedTotal:Ft,notes:kt,remaining:re,sku:ie,size:Ne,color:Ce,gender:Ae||"",brand:ct||"",clientCode:pe||""}:st)),te(),l(" Lote actualizado")},qe=async V=>{confirm(`Eliminar el lote del ${V.date} (${V.productName})?`)&&(await Kn(Zt(Ie,"inventory_clothes_batches",V.id)),n(re=>re.filter(we=>we.id!==V.id)),l(" Lote eliminado"))},G=()=>{const V=(c?`Desde ${c}`:"Desde inicio")+"  "+(d?`Hasta ${d}`:"Hasta hoy"),Z=st=>(st||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),re=Lt.map(st=>`
      <tr>
        <td>${st.date}</td>
        <td>${(st.category||"").toUpperCase()}</td>
        <td>${Z(st.productName)}</td>
        <td>${Z(st.sku||"")}</td>
        <td>${Z(st.size||"")}</td>
        <td>${Z(st.color||"")}</td>
        <td>${Z(st.clientCode||"")}</td>
        <td>${Z(st.gender||"")}</td>
        <td>${(st.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${st.quantity.toFixed(0)}</td>
        <td style="text-align:right">${st.remaining.toFixed(0)}</td>
        <td style="text-align:right">${Qo(st.purchasePrice)}</td>
        <td style="text-align:right">${Qo(st.salePrice)}</td>
        <td style="text-align:right">${Qo(st.invoiceTotal||0)}</td>
        <td style="text-align:right">${Qo(st.expectedTotal||0)}</td>
        <td>${Z((st.notes||"").slice(0,120))}</td>
        <td>${st.status}</td>
      </tr>`).join(""),we=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${V}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${Me.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${Me.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${Qo(Me.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${Qo(Me.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${Qo(Number((Me.totalEsperado-Me.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${re||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,Fe=window.open("","_blank");Fe&&(Fe.document.open(),Fe.document.write(we),Fe.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Et(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:V=>u(V.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:V=>f(V.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:V=>h(V.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(V=>i.jsxs("option",{value:V.id,children:[V.name,"  ",V.category]},V.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:G,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Me.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Me.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Qo(Me.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Qo(Me.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Qo(Number((Me.totalEsperado-Me.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):Lt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):Lt.map(V=>{const Z=M===V.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:Z?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:ae,onChange:re=>X(re.target.value)}):V.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(V.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:V.productName,children:V.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:Z?i.jsx("input",{className:"w-full border p-1 rounded",value:ie,onChange:re=>Ue(re.target.value)}):i.jsx("span",{className:"block truncate",title:V.sku||"",children:V.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:Z?i.jsx("input",{className:"w-full border p-1 rounded",value:Ne,onChange:re=>be(re.target.value)}):V.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:Z?i.jsx("input",{className:"w-full border p-1 rounded",value:Ce,onChange:re=>Le(re.target.value)}):V.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:Z?i.jsx("input",{className:"w-full border p-1 rounded",value:pe,onChange:re=>{const we=re.target.value;gy.test(we)&&Pe(we)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:V.clientCode||"",children:V.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:Z?i.jsx("select",{className:"w-full border p-1 rounded",value:Ae,onChange:re=>We(re.target.value),children:G8e.map(re=>i.jsx("option",{value:re,children:re||""},re))}):V.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(V.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:Z?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(De)?"":De,onChange:re=>le(Math.max(0,parseInt(re.target.value||"0",10)))}):V.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:Z?V.remaining:V.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:Z?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN($e)?"":$e,onChange:re=>Xe(Math.max(0,parseFloat(re.target.value||"0")))}):Qo(V.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:Z?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(it)?"":it,onChange:re=>xt(Math.max(0,parseFloat(re.target.value||"0")))}):Qo(V.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Qo(Z?jt:V.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Qo(Z?Ft:V.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:Z?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:kt,onChange:re=>Ge(re.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:V.notes||"",children:V.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${V.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:V.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:Z?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ve,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:te,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:re=>Tt(re,V.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},V.id)})})]})})}),Ee&&Mu.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>Ze(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:xe.x,top:xe.y},onClick:V=>V.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const V=Lt.find(Z=>Z.id===Ee);return(V==null?void 0:V.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{Ze(null),U(V)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const V=Lt.find(Z=>Z.id===Ee);V&&(Ze(null),ye(V))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const V=Lt.find(Z=>Z.id===Ee);V&&(Ze(null),qe(V))},children:" Borrar"})]})})]}),document.body),gt&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Et(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Et(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:_e,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:V=>p(V.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(V=>i.jsxs("option",{value:V.id,children:[V.name,"  ",V.category,"  ",V.sku?`SKU: ${V.sku}`:""]},V.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:V=>v(V.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:V=>b(Math.max(0,parseInt(V.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:V=>j(Math.max(0,parseFloat(V.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:I===0?"":I,onChange:V=>_(Math.max(0,parseFloat(V.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:z,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:de,readOnly:!0,onChange:V=>ue(V.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:me,readOnly:!0,onChange:V=>se(V.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ke,readOnly:!0,onChange:V=>Re(V.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:F,onChange:V=>H(V.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:K,onChange:V=>{const Z=V.target.value;gy.test(Z)&&L(Z)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!gy.test(K)&&K.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:P,onChange:V=>O(V.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[P.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Qo(S),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Qo(B),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Et(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const W8e=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],X8e=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],Y8e=["XS","S","M","L","XL","2XL"],J8e=["2","4","6","8","10","12","14"],Z8e=["26","28","30","32","34","36","38"],eLe=["Shein","Usado","Otro"],tLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function r_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function rLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function nLe(t){const e="ROP",r=r_(t.subcat).slice(0,3)||"GEN",n=rLe(t.gender),a=r_(t.color).slice(0,3)||"COL",s=r_(t.size)||"TLL",o=r_(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${a}-${s}-${o}`}const aLe=/^[A-Za-z0-9._-]{0,32}$/;function sLe(){const[t,e]=g.useState(""),[r,n]=g.useState("Camisa"),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState("Shein"),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState("0"),[I,_]=g.useState(""),[S,E]=g.useState(""),B=g.useMemo(()=>{const L=Number(w||0),W=Number(y||0);return Math.floor(L*W*100)/100},[w,y]),[T,P]=g.useState([]),[O,z]=g.useState(!0),[ce,de]=g.useState(""),{refreshKey:ue,refresh:me}=Dc(),[se,ke]=g.useState(!1),Re=g.useMemo(()=>r.toLowerCase()==="jean"?Z8e:d==="NINO"||d==="NINA"?J8e:Y8e,[r,d]);g.useEffect(()=>{p(nLe({subcat:r,gender:d,color:o,size:a,brand:c}))},[r,d,o,a,c]),g.useEffect(()=>{(async()=>{z(!0);const L=sr(yt(Ie,"products_clothes"),In("createdAt","desc")),W=await Ht(L),Y=[];W.forEach(D=>{const Q=D.data();Y.push({id:D.id,name:Q.name??"(sin nombre)",category:Q.category??"",measurement:Q.measurement??"unidad",sku:Q.sku??"",size:Q.size||"",color:Q.color||"",brand:Q.brand||"",gender:Q.gender||"",clientCode:Q.clientCode||"",notes:Q.notes||"",createdAt:Q.createdAt??vr.now()})}),P(Y),z(!1)})()},[ue]);const F=()=>{e(""),n("Camisa"),s(""),l(""),u("Shein"),f(""),h(""),v(""),b(""),j("0"),_(""),E("")},H=async L=>{if(L.preventDefault(),de(""),!t.trim()){de("Ingresa el nombre del producto.");return}if(A&&!aLe.test(A)){de("Cdigo del cliente invlido");return}const W=Number(w||0),Y=Number(y||0);if(W<0){de("La cantidad de piezas debe ser 0 o mayor.");return}if(Y<0){de("El precio de venta no puede ser negativo.");return}try{const D=await Jn(yt(Ie,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:vr.now(),price:Y||0});if(P(Q=>[{id:D.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:vr.now()},...Q]),W>0){const Q=new Date().toISOString().slice(0,10),ee=I||Q;await Jn(yt(Ie,"inventory_clothes_batches"),{productId:D.id,productName:t.trim(),category:r,unit:"unidad",quantity:W,remaining:W,purchasePrice:0,salePrice:Y||0,invoiceTotal:0,expectedTotal:B||0,date:ee,createdAt:vr.now(),status:"PENDIENTE",notes:S||"",sku:m||"",size:a||"",color:o||"",gender:d||"",brand:c||"",clientCode:A||""})}de(W>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),F()}catch(D){console.error(D),de(" Error al crear producto")}},K=async L=>{confirm(`Eliminar el producto "${L.name}"?`)&&(await Kn(Zt(Ie,"products_clothes",L.id)),P(Y=>Y.filter(D=>D.id!==L.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Oc,{onClick:me,loading:O}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{ke(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),se&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:L=>e(L.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:L=>n(L.target.value),children:W8e.map(L=>i.jsx("option",{value:L,children:L},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:d,onChange:L=>f(L.target.value),children:tLe.map(L=>i.jsx("option",{value:L,children:L||""},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:L=>s(L.target.value),children:[i.jsx("option",{value:"",children:""}),Re.map(L=>i.jsx("option",{value:L,children:L},L))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:L=>l(L.target.value),children:[i.jsx("option",{value:"",children:""}),X8e.map(L=>i.jsx("option",{value:L,children:L},L))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:L=>u(L.target.value),children:eLe.map(L=>i.jsx("option",{value:L,children:L},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:L=>h(L.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:L=>b(L.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:w,onChange:L=>j(L.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:I,onChange:L=>_(L.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(B)?"":B.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:F,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>ke(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:O?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):T.map(L=>{var W;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(W=L.createdAt)!=null&&W.toDate?L.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:L.category}),i.jsx("td",{className:"p-2 border",children:L.name}),i.jsx("td",{className:"p-2 border",children:L.sku}),i.jsx("td",{className:"p-2 border",children:L.size||""}),i.jsx("td",{className:"p-2 border",children:L.color||""}),i.jsx("td",{className:"p-2 border",children:L.brand||""}),i.jsx("td",{className:"p-2 border",children:L.gender||""}),i.jsx("td",{className:"p-2 border",children:L.clientCode||""}),i.jsx("td",{className:"p-2 border",children:L.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>K(L),children:"Borrar"})})]},L.id)})})]})}),ce&&i.jsx("p",{className:"mt-2 text-sm",children:ce})]})}async function iLe(t){const{productId:e,quantity:r,saleDate:n,saleId:a}=t,s=Math.max(0,Math.floor(Number(r||0)));if(!e||s<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=sr(yt(Ie,"inventory_clothes_batches"),mr("productId","==",e)),u=(await Ht(o)).docs.map(f=>({id:f.id,data:f.data()})).sort((f,A)=>{var v,y;const h=String(f.data.date||""),m=String(A.data.date||"");if(h!==m)return h<m?-1:1;const p=((v=f.data.createdAt)==null?void 0:v.seconds)??0,x=((y=A.data.createdAt)==null?void 0:y.seconds)??0;return p-x}).map(f=>Zt(Ie,"inventory_clothes_batches",f.id)),d=[];return await Gs(Ie,async f=>{const A=await Promise.all(u.map(m=>f.get(m)));let h=s;for(let m=0;m<u.length&&h>0;m++){const p=u[m],x=A[m];if(!x.exists())continue;const v=x.data(),y=Math.max(0,Math.floor(Number(v.quantity||0))),b=Number.isFinite(Number(v.remaining))?Math.max(0,Math.floor(Number(v.remaining||0))):y;if(b<=0)continue;const w=Math.min(b,h),j=Math.max(0,b-w);f.update(p,{remaining:j}),d.push({batchId:p.id,qty:w,batchDate:String(v.date||""),productName:String(v.productName||"")}),h-=w}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(a)for(const m of d)await Jn(yt(Ie,"batch_clothes_allocations"),{saleId:a,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:vr.now()})}),{allocations:d}}async function sF(t){const e=Zt(Ie,"sales_clothes",t),r=await zs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const u=n.allocationsByItem[c],d=String((u==null?void 0:u.productId)||c||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];l[d]=f.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}for(const c of n.items){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),f=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))})):l[u]||[];a.push({productId:u,productName:String((c==null?void 0:c.productName)||""),qty:d,allocations:f.length?f:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),u=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),d=Array.isArray(n.allocations)?n.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):[];c&&u>0&&a.push({productId:c,productName:String(l.productName||n.productName||""),qty:u,allocations:d.length?d:void 0})}return a.length===0?(await Gs(Ie,async l=>{l.delete(e)}),{restored:0}):a.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await Gs(Ie,async c=>{const u=[];for(const f of a)for(const A of f.allocations||[])u.push({ref:Zt(Ie,"inventory_clothes_batches",A.batchId),addBack:Math.max(0,Math.floor(Number(A.qty||0)))});const d=await Promise.all(u.map(f=>c.get(f.ref)));for(let f=0;f<u.length;f++){const A=d[f];if(!A.exists())continue;const h=A.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(u[f].ref,{remaining:m+u[f].addBack})}c.delete(e)}),{restored:a.reduce((c,u)=>c+(u.allocations||[]).reduce((d,f)=>d+f.qty,0),0)}):(await Gs(Ie,async l=>{const c={};for(const h of a){if(!h.productId||h.qty<=0)continue;const m=sr(yt(Ie,"inventory_clothes_batches"),mr("productId","==",h.productId)),x=(await Ht(m)).docs.map(v=>{const y=v.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),w=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:v.id,date:String(y.date||""),quantity:b,remaining:w}}).sort((v,y)=>v.date.localeCompare(y.date));c[h.productId]=x}const u=[];for(const h of a){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)u.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const v=Math.max(0,x.quantity-x.remaining);if(v<=0)continue;const y=Math.min(v,p);u.push({id:x.id,addBack:y}),p-=y}for(const x of m){if(p<=0)break;const v=Math.min(p,h.qty);u.push({id:x.id,addBack:v}),p-=v}}const d={};for(const h of u)d[h.id]=(d[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const f=Object.keys(d).map(h=>Zt(Ie,"inventory_clothes_batches",h)),A=await Promise.all(f.map(h=>l.get(h)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),v=Math.max(0,Math.floor(Number(d[f[h].id]||0)));l.update(f[h],{remaining:x+v})}l.delete(e)}),{restored:a.reduce((l,c)=>l+c.qty,0)})}const p$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Th=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function n_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function g$(t){const e=sr(yt(Ie,"ar_movements"),mr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Kn(Zt(Ie,"ar_movements",n.id))))}function oLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async Me=>{e(!0),n(!0),s(Me),l([]);try{const U=(await Ht(sr(yt(Ie,"sales_clothes"),mr("__name__","==",Me)))).docs[0],ye=U==null?void 0:U.data(),Ve=(Array.isArray(ye==null?void 0:ye.items)?ye.items:ye!=null&&ye.item?[ye.item]:[]).map(qe=>({productName:String(qe.productName||""),qty:Number(qe.qty||0),unitPrice:Number(qe.unitPrice||0),discount:Number(qe.discount||0),total:Number(qe.total||0)}));l(Ve)}catch(_e){console.error(_e)}finally{n(!1)}},[u,d]=g.useState(""),[f,A]=g.useState("+505 "),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState("ACTIVO"),[b,w]=g.useState(0),[j,I]=g.useState([]),[_,S]=g.useState(!0),[E,B]=g.useState(""),[T,P]=g.useState(null),[O,z]=g.useState(""),[ce,de]=g.useState("+505 "),[ue,me]=g.useState(""),[se,ke]=g.useState(""),[Re,F]=g.useState("ACTIVO"),[H,K]=g.useState(0),[L,W]=g.useState(!1),[Y,D]=g.useState(null),[Q,ee]=g.useState(!1),[ve,M]=g.useState([]),[Ye,ae]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[X,De]=g.useState(!1),[le,$e]=g.useState(0),[Xe,it]=g.useState(new Date().toISOString().slice(0,10)),[xt,jt]=g.useState(""),[Mt,Ft]=g.useState(!1),[$t,kt]=g.useState(null),[Ge,ie]=g.useState(""),[Ue,Ne]=g.useState(0),[be,Ce]=g.useState(""),[Le,Ae]=g.useState(!1);g.useEffect(()=>{(async()=>{const Me=sr(yt(Ie,"customers_clothes"),In("createdAt","desc")),_e=await Ht(Me),U=[];_e.forEach(ye=>{const te=ye.data();U.push({id:ye.id,name:te.name??"",phone:te.phone??"+505 ",place:te.place??"",notes:te.notes??"",status:te.status??"ACTIVO",creditLimit:Number(te.creditLimit??0),createdAt:te.createdAt??vr.now(),balance:0})});for(const ye of U)try{const te=sr(yt(Ie,"ar_movements"),mr("customerId","==",ye.id)),Ve=await Ht(te);let qe=0;Ve.forEach(G=>qe+=Number(G.data().amount||0)),ye.balance=qe}catch{ye.balance=0}I(U),S(!1)})()},[]);const We=()=>{d(""),A("+505 "),m(""),x(""),y("ACTIVO"),w(0)},ct=async Me=>{if(Me.preventDefault(),B(""),!u.trim()){B("Ingresa el nombre.");return}const _e=n_(f);if(_e.length<6){B("Telfono incompleto.");return}try{const U=await Jn(yt(Ie,"customers_clothes"),{name:u.trim(),phone:_e,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:vr.now()});I(ye=>[{id:U.id,name:u.trim(),phone:_e,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:vr.now(),balance:0},...ye]),We(),Ae(!1),B(" Cliente creado")}catch(U){console.error(U),B(" Error al crear cliente")}},_t=Me=>{P(Me.id),z(Me.name),de(Me.phone||"+505 "),me(Me.place||""),ke(Me.notes||""),F(Me.status||"ACTIVO"),K(Number(Me.creditLimit||0))},pe=()=>{P(null),z(""),de("+505 "),me(""),ke(""),F("ACTIVO"),K(0)},Pe=async()=>{if(!T)return;const Me=n_(ce);if(!O.trim()){B("Ingresa el nombre.");return}try{await Fn(Zt(Ie,"customers_clothes",T),{name:O.trim(),phone:Me,place:ue||"",notes:se||"",status:Re,creditLimit:Number(H||0)}),I(_e=>_e.map(U=>U.id===T?{...U,name:O.trim(),phone:Me,place:ue||"",notes:se||"",status:Re,creditLimit:Number(H||0)}:U)),pe(),B(" Cliente actualizado")}catch(_e){console.error(_e),B(" Error al actualizar")}},Ee=async Me=>{if(confirm(`Eliminar al cliente "${Me.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{S(!0);const U=sr(yt(Ie,"sales_clothes"),mr("customerId","==",Me.id)),ye=await Ht(U);for(const qe of ye.docs){const G=qe.id;try{await sF(G)}catch(V){console.warn("restoreSaleAndDeleteClothes error",V);try{await Kn(Zt(Ie,"sales_clothes",G))}catch{}}await g$(G)}const te=sr(yt(Ie,"ar_movements"),mr("customerId","==",Me.id)),Ve=await Ht(te);await Promise.all(Ve.docs.map(qe=>Kn(Zt(Ie,"ar_movements",qe.id)))),await Kn(Zt(Ie,"customers_clothes",Me.id)),I(qe=>qe.filter(G=>G.id!==Me.id)),B(" Cliente eliminado y prendas devueltas al inventario")}catch(U){console.error(U),B(" No se pudo eliminar el cliente.")}finally{S(!1)}},Ze=async Me=>{D(Me),M([]),ae({saldoActual:0,totalAbonado:0,totalCargos:0}),W(!0),De(!1),$e(0),it(new Date().toISOString().slice(0,10)),jt(""),kt(null),ee(!0);try{const _e=sr(yt(Ie,"ar_movements"),mr("customerId","==",Me.id)),U=await Ht(_e),ye=[];U.forEach(te=>{var qe,G;const Ve=te.data();ye.push({id:te.id,date:Ve.date??((G=(qe=Ve.createdAt)==null?void 0:qe.toDate)!=null&&G.call(qe)?Ve.createdAt.toDate().toISOString().slice(0,10):""),type:Ve.type??"CARGO",amount:Number(Ve.amount||0),ref:Ve.ref||{},comment:Ve.comment||"",createdAt:Ve.createdAt})}),ye.sort((te,Ve)=>{var V,Z;if(te.date!==Ve.date)return te.date.localeCompare(Ve.date);const qe=((V=te.createdAt)==null?void 0:V.seconds)||0,G=((Z=Ve.createdAt)==null?void 0:Z.seconds)||0;return qe-G}),M(ye),xe(ye)}catch(_e){console.error(_e),B(" No se pudo cargar el estado de cuenta")}finally{ee(!1)}},xe=Me=>{const _e=Me.reduce((te,Ve)=>te+(Number(Ve.amount)||0),0),U=Me.filter(te=>Number(te.amount)<0).reduce((te,Ve)=>te+Math.abs(Number(Ve.amount)||0),0),ye=Me.filter(te=>Number(te.amount)>0).reduce((te,Ve)=>te+Number(Ve.amount)||0,0);ae({saldoActual:_e,totalAbonado:U,totalCargos:ye})},Se=async()=>{if(!Y)return;B("");const Me=Number(le||0);if(!(Me>0)){B("Ingresa un monto de abono mayor a 0.");return}const _e=parseFloat(Me.toFixed(2));if(!Xe){B("Selecciona la fecha del abono.");return}try{Ft(!0);const U={customerId:Y.id,type:"ABONO",amount:-_e,date:Xe,comment:xt||"",createdAt:vr.now()},te={id:(await Jn(yt(Ie,"ar_movements"),U)).id,date:Xe,type:"ABONO",amount:-_e,comment:xt||"",createdAt:vr.now()},Ve=[...ve,te].sort((qe,G)=>{var re,we;if(qe.date!==G.date)return qe.date.localeCompare(G.date);const V=((re=qe.createdAt)==null?void 0:re.seconds)||0,Z=((we=G.createdAt)==null?void 0:we.seconds)||0;return V-Z});M(Ve),xe(Ve),I(qe=>qe.map(G=>G.id===Y.id?{...G,balance:(G.balance||0)-_e}:G)),D(qe=>qe&&{...qe,balance:(qe.balance||0)-_e}),$e(0),jt(""),it(new Date().toISOString().slice(0,10)),De(!1),B(" Abono registrado")}catch(U){console.error(U),B(" Error al registrar el abono")}finally{Ft(!1)}},gt=Me=>{kt(Me.id),ie(Me.date||new Date().toISOString().slice(0,10)),Ne(Math.abs(Number(Me.amount||0))),Ce(Me.comment||"")},Et=()=>{kt(null),ie(""),Ne(0),Ce("")},Nt=async()=>{if(!$t)return;const Me=ve.findIndex(te=>te.id===$t);if(Me===-1)return;const _e=ve[Me],U=Number(Ue||0);if(!(U>0)){B("El monto debe ser mayor a 0.");return}const ye=_e.type==="ABONO"?-parseFloat(U.toFixed(2)):+parseFloat(U.toFixed(2));try{await Fn(Zt(Ie,"ar_movements",$t),{date:Ge,amount:ye,comment:be||""});const te=[...ve];te[Me]={..._e,date:Ge,amount:ye,comment:be||""},te.sort((qe,G)=>{var re,we;if(qe.date!==G.date)return qe.date.localeCompare(G.date);const V=((re=qe.createdAt)==null?void 0:re.seconds)||0,Z=((we=G.createdAt)==null?void 0:we.seconds)||0;return V-Z}),M(te),xe(te);const Ve=te.reduce((qe,G)=>qe+(Number(G.amount)||0),0);I(qe=>qe.map(G=>G.id===(Y==null?void 0:Y.id)?{...G,balance:Ve}:G)),D(qe=>qe&&{...qe,balance:Ve}),Et(),B(" Movimiento actualizado")}catch(te){console.error(te),B(" Error al actualizar movimiento")}},Tt=async Me=>{var U,ye;if(confirm(`Eliminar este movimiento (${Me.type==="ABONO"?"Abono":"Compra"}) del ${Me.date}?${Me.type==="CARGO"&&((U=Me.ref)!=null&&U.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(S(!0),Me.type==="CARGO"&&((ye=Me.ref)!=null&&ye.saleId)){try{await sF(Me.ref.saleId)}catch(qe){console.warn("restoreSaleAndDeleteClothes error",qe),S(!1),B(" No se pudo devolver inventario de la venta.");return}await g$(Me.ref.saleId)}else await Kn(Zt(Ie,"ar_movements",Me.id));const te=ve.filter(qe=>{var G,V;return Me.type==="CARGO"&&((G=Me.ref)!=null&&G.saleId)?((V=qe.ref)==null?void 0:V.saleId)!==Me.ref.saleId:qe.id!==Me.id});M(te),xe(te);const Ve=te.reduce((qe,G)=>qe+(Number(G.amount)||0),0);I(qe=>qe.map(G=>G.id===(Y==null?void 0:Y.id)?{...G,balance:Ve}:G)),D(qe=>qe&&{...qe,balance:Ve}),B(" Movimiento eliminado")}catch(te){console.error(te),B(" Error al eliminar movimiento")}finally{S(!1)}},Lt=g.useMemo(()=>[...j].sort((Me,_e)=>{var U,ye;return Me.status!==_e.status?Me.status==="BLOQUEADO"?1:-1:(((U=_e.createdAt)==null?void 0:U.seconds)||0)-(((ye=Me.createdAt)==null?void 0:ye.seconds)||0)}),[j]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Ae(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:_?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Lt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):Lt.map(Me=>{var U;const _e=T===Me.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(U=Me.createdAt)!=null&&U.toDate?Me.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:_e?i.jsx("input",{className:"w-full border p-1 rounded",value:O,onChange:ye=>z(ye.target.value)}):Me.name}),i.jsx("td",{className:"p-2 border",children:_e?i.jsx("input",{className:"w-full border p-1 rounded",value:ce,onChange:ye=>de(n_(ye.target.value))}):Me.phone}),i.jsx("td",{className:"p-2 border",children:_e?i.jsxs("select",{className:"w-full border p-1 rounded",value:ue,onChange:ye=>me(ye.target.value),children:[i.jsx("option",{value:"",children:""}),p$.map(ye=>i.jsx("option",{value:ye,children:ye},ye))]}):Me.place||""}),i.jsx("td",{className:"p-2 border",children:_e?i.jsxs("select",{className:"w-full border p-1 rounded",value:Re,onChange:ye=>F(ye.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Me.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Me.status})}),i.jsx("td",{className:"p-2 border",children:_e?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(H)?"":H,onChange:ye=>K(Math.max(0,Number(ye.target.value||0)))}):Th(Me.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Th(Me.balance||0)}),i.jsx("td",{className:"p-2 border",children:_e?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:se,onChange:ye=>ke(ye.target.value),maxLength:500}):i.jsx("span",{title:Me.notes||"",children:(Me.notes||"").length>40?(Me.notes||"").slice(0,40)+"":Me.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:_e?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Pe,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:pe,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>_t(Me),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Ee(Me),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Ze(Me),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},Me.id)})})]})}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),Le&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ae(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ae(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ct,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:u,onChange:Me=>d(Me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:Me=>A(n_(Me.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Me=>m(Me.target.value),children:[i.jsx("option",{value:"",children:""}),p$.map(Me=>i.jsx("option",{value:Me,children:Me},Me))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:Me=>y(Me.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:Me=>w(Math.max(0,Number(Me.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:Me=>x(Me.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ae(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),L&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(Y==null?void 0:Y.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{$e(0),it(new Date().toISOString().slice(0,10)),jt(""),De(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>W(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Th(Ye.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Th(Ye.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Th(Ye.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Q?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):ve.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):ve.map(Me=>{var U,ye;const _e=$t===Me.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:_e?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Ge,onChange:te=>ie(te.target.value)}):Me.date||""}),i.jsx("td",{className:"p-2 border",children:Me.amount>=0?(U=Me.ref)!=null&&U.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(Me.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(ye=Me.ref)!=null&&ye.saleId?`Venta #${Me.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:_e?i.jsx("input",{className:"w-full border p-1 rounded",value:be,onChange:te=>Ce(te.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Me.comment||"",children:(Me.comment||"").length>40?(Me.comment||"").slice(0,40)+"":Me.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:_e?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ue)?"":Ue,onChange:te=>{const Ve=Number(te.target.value||0),qe=Number.isFinite(Ve)?Math.max(0,parseFloat(Ve.toFixed(2))):0;Ne(qe)},placeholder:"0.00",title:Me.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Th(Me.amount)}),i.jsx("td",{className:"p-2 border",children:_e?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Nt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Et,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>gt(Me),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Tt(Me),children:"Borrar"})]})})]},Me.id)})})]})})]})}),X&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(Y==null?void 0:Y.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Xe,onChange:Me=>it(Me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:le===0?"":le,onChange:Me=>{const _e=Number(Me.target.value||0),U=Number.isFinite(_e)?Math.max(0,parseFloat(_e.toFixed(2))):0;$e(U)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:xt,onChange:Me=>jt(Me.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[xt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>De(!1),disabled:Mt,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Se,disabled:Mt,children:Mt?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((Me,_e)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Me.productName}),i.jsx("td",{className:"p-2 border text-right",children:Me.qty}),i.jsx("td",{className:"p-2 border text-right",children:Th(Me.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Th(Me.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Th(Me.total)})]},_e))})]})})]})})]})}const xx=t=>`C$ ${(Number(t)||0).toFixed(2)}`,lLe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function cLe(t){if(!t)return 0;const e=sr(yt(Ie,"inventory_clothes_batches"),mr("productId","==",t)),r=await Ht(e);let n="0000-00-00",a=-1,s=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),u=Number(l.salePrice||0),d=l.createdAt,f=((d==null?void 0:d.seconds)??0)*1e3+((d==null?void 0:d.nanoseconds)??0)/1e6;c>n?(n=c,a=f,s=u):c===n&&f>a&&(a=f,s=u)}),Number(s||0)}async function x$(t){if(!t)return 0;const e=sr(yt(Ie,"inventory_clothes_batches"),mr("productId","==",t)),r=await Ht(e);let n=0;return r.forEach(a=>n+=Number(a.data().remaining||0)),n}function v$(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function uLe({role:t="",roles:e}={role:""}){const r=e&&e.length?e:t;En(r,"admin"),En(r,"vendedor_ropa");const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState({}),[u,d]=g.useState("CONTADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(new Date().toISOString().slice(0,10)),[v,y]=g.useState(""),[b,w]=g.useState([]),j=g.useMemo(()=>b.reduce((le,$e)=>le+($e.qty||0),0),[b]),I=g.useMemo(()=>{const le=b.reduce(($e,Xe)=>{const it=Math.max(0,(Number(Xe.unitPrice)||0)*(Xe.qty||0)-(Number(Xe.discount)||0));return $e+it},0);return Math.floor(le*100)/100},[b]),[_,S]=g.useState(0),[E,B]=g.useState(""),[T,P]=g.useState(!1),[O,z]=g.useState(!1),[ce,de]=g.useState(""),[ue,me]=g.useState("+505 "),[se,ke]=g.useState(""),[Re,F]=g.useState(""),[H,K]=g.useState("ACTIVO"),[L,W]=g.useState(0),Y=()=>{de(""),me("+505 "),ke(""),F(""),K("ACTIVO"),W(0)};g.useEffect(()=>{(async()=>{const le=sr(yt(Ie,"customers_clothes"),In("createdAt","desc")),$e=await Ht(le),Xe=[];$e.forEach(kt=>{const Ge=kt.data();Xe.push({id:kt.id,name:Ge.name??"",phone:Ge.phone??"+505 ",place:Ge.place??"",status:Ge.status??"ACTIVO",creditLimit:Number(Ge.creditLimit??0),balance:0})});for(const kt of Xe)try{const Ge=sr(yt(Ie,"ar_movements"),mr("customerId","==",kt.id)),ie=await Ht(Ge);let Ue=0;ie.forEach(Ne=>Ue+=Number(Ne.data().amount||0)),kt.balance=Ue}catch{kt.balance=0}a(Xe);const it=sr(yt(Ie,"products_clothes"),In("createdAt","desc")),xt=await Ht(it),jt=[];xt.forEach(kt=>{const Ge=kt.data();jt.push({id:kt.id,name:Ge.name??"(sin nombre)",sku:Ge.sku??""})}),o(jt);const Mt=sr(yt(Ie,"inventory_clothes_batches"),mr("remaining",">",0)),Ft=await Ht(Mt),$t={};Ft.forEach(kt=>{const Ge=kt.data(),ie=Ge.productId||"",Ue=Number(Ge.remaining||0);ie&&($t[ie]=($t[ie]||0)+Ue)}),c($t)})()},[]);const D=g.useMemo(()=>n.find(le=>le.id===f),[n,f]),Q=(D==null?void 0:D.balance)||0,ee=u==="CREDITO"?Q+Math.max(0,Number(I||0))-Math.max(0,Number(_||0)):0,ve=async le=>{if(!le)return;if(b.some(jt=>jt.productId===le)){y("");return}const $e=s.find(jt=>jt.id===le);if(!$e){y("");return}let Xe=await cLe(le);Xe||(Xe=Number(($e==null?void 0:$e.price)||0));const it=await x$(le),xt={productId:le,productName:$e.name||"",sku:$e.sku||"",unitPrice:Number(Xe)||0,available:Number(it)||0,qty:0,discount:0};w(jt=>[...jt,xt]),y("")},M=(le,$e)=>{w(Xe=>Xe.map(it=>{if(it.productId!==le)return it;if($e==="")return{...it,qty:0};const xt=Math.max(0,Math.floor(Number($e)));return{...it,qty:xt}}))},Ye=(le,$e)=>{w(Xe=>Xe.map(it=>{if(it.productId!==le)return it;if($e==="")return{...it,discount:0};const xt=Math.max(0,Math.floor(Number($e)));return{...it,discount:xt}}))},ae=le=>w($e=>$e.filter(Xe=>Xe.productId!==le)),X=async()=>{if(!p)return"Selecciona la fecha.";if(b.length===0)return"Agrega al menos un producto.";const le=b.filter($e=>($e.qty||0)>0);if(le.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(I>0))return"El total debe ser mayor a cero.";if(u==="CONTADO"){if(!h.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!f)return"Selecciona un cliente (crdito).";if(_<0)return"El pago inicial no puede ser negativo.";if(_>I)return"El pago inicial no puede superar el total.";if((D==null?void 0:D.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const $e of le){const Xe=await x$($e.productId);if($e.qty>Xe)return`Inventario insuficiente para "${$e.productName}". Disponible: ${Xe} unidades.`;const it=(Number($e.unitPrice)||0)*($e.qty||0),xt=Number($e.discount)||0;if(!Number.isInteger(xt)||xt<0)return`El descuento en "${$e.productName}" debe ser entero y  0.`;if(xt>it)return`El descuento en "${$e.productName}" no puede exceder C$ ${it.toFixed(2)}.`}return null},De=async le=>{le.preventDefault(),B("");const $e=await X();if($e){B(" "+$e);return}try{P(!0);const Xe=b.filter(Mt=>(Mt.qty||0)>0).map(Mt=>{const Ft=(Number(Mt.unitPrice)||0)*(Mt.qty||0),$t=Math.max(0,Math.floor(Number(Mt.discount)||0)),kt=Math.max(0,Ft-$t);return{productId:Mt.productId,productName:Mt.productName,sku:Mt.sku||"",qty:Mt.qty,unitPrice:Number(Mt.unitPrice)||0,discount:$t,total:Math.floor(kt*100)/100}}),it={type:u,date:p,createdAt:vr.now(),itemsTotal:Number(I)||0,total:Number(I)||0,quantity:Number(j)||0,items:Xe};u==="CONTADO"?it.customerName=h.trim():(it.customerId=f,it.downPayment=Number(_)||0);const xt=await Jn(yt(Ie,"sales_clothes"),it);if(u==="CREDITO"&&f){const Mt={customerId:f,date:p,createdAt:vr.now(),ref:{saleId:xt.id}};await Jn(yt(Ie,"ar_movements"),{...Mt,type:"CARGO",amount:Number(I)||0}),Number(_)>0&&await Jn(yt(Ie,"ar_movements"),{...Mt,type:"ABONO",amount:-Number(_)})}const jt={};for(const Mt of Xe)if(Mt.qty>0){const{allocations:Ft}=await iLe({productId:Mt.productId,quantity:Mt.qty,saleDate:p,saleId:xt.id});jt[Mt.productId]={productId:Mt.productId,allocations:Ft}}await Fn(Zt(Ie,"sales_clothes",xt.id),{allocationsByItem:jt}),d("CONTADO"),A(""),m(""),x(new Date().toISOString().slice(0,10)),w([]),S(0),u==="CREDITO"&&f&&a(Mt=>Mt.map(Ft=>Ft.id===f?{...Ft,balance:(Ft.balance||0)+(Number(I)||0)-(Number(_)||0)}:Ft)),B(" Venta registrada"),(async()=>{const Mt=sr(yt(Ie,"inventory_clothes_batches"),mr("remaining",">",0)),Ft=await Ht(Mt),$t={};Ft.forEach(kt=>{const Ge=kt.data(),ie=Ge.productId||"",Ue=Number(Ge.remaining||0);ie&&($t[ie]=($t[ie]||0)+Ue)}),c($t)})()}catch(Xe){console.error(Xe),B(" Error al guardar la venta")}finally{P(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:De,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:u,onChange:le=>d(le.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),u==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:h,onChange:le=>m(le.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:f,onChange:le=>A(le.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),n.map(le=>i.jsxs("option",{value:le.status==="ACTIVO"?le.id:"",disabled:le.status==="BLOQUEADO",children:[le.name," | ",le.phone," | Saldo: ",xx(le.balance||0)]},le.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>z(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:xx(Q)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:_===0?"":_,onChange:le=>S(Math.max(0,Number(le.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:xx(ee)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:p,onChange:le=>x(le.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:async le=>{const $e=le.target.value;y($e),await ve($e)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),s.map(le=>{const $e=b.some(xt=>xt.productId===le.id),Xe=l[le.id]||0,it=$e||Xe<=0;return i.jsxs("option",{value:it?"":le.id,disabled:it,children:[le.name," ",le.sku?` ${le.sku}`:""," ",Xe>0?`(disp: ${Xe})`:"(sin stock)",$e?" (seleccionado)":""]},le.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),b.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):b.map(le=>{const $e=Math.max(0,(le.available||0)-(le.qty||0)),Xe=(Number(le.unitPrice)||0)*(le.qty||0),it=Math.max(0,Xe-(Number(le.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[le.productName,le.sku?`  ${le.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:xx(le.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:$e}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(le.qty)||le.qty===0?"":le.qty,onChange:xt=>M(le.productId,xt.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(le.discount)||le.discount===0?"":le.discount,onChange:xt=>Ye(le.productId,xt.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:xx(it)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>ae(le.productId),title:"Quitar producto",children:""})})]},le.productId)})]}),b.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:j})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:xx(I)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:T,children:T?"Guardando...":"Registrar venta"})})]}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ce,onChange:le=>de(le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ue,onChange:le=>me(v$(le.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:se,onChange:le=>ke(le.target.value),children:[i.jsx("option",{value:"",children:""}),lLe.map(le=>i.jsx("option",{value:le,children:le},le))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:H,onChange:le=>K(le.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:L===0?"":L,onChange:le=>W(Math.max(0,Number(le.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Re,onChange:le=>F(le.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Y(),z(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(B(""),!ce.trim()){B("Ingresa el nombre del nuevo cliente.");return}const le=v$(ue);try{const $e=await Jn(yt(Ie,"customers_clothes"),{name:ce.trim(),phone:le,place:se||"",notes:Re||"",status:H,creditLimit:Number(L||0),createdAt:vr.now()}),Xe={id:$e.id,name:ce.trim(),phone:le,place:se||"",status:H,creditLimit:Number(L||0),balance:0};a(it=>[Xe,...it]),A($e.id),Y(),z(!1),B(" Cliente creado")}catch($e){console.error($e),B(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),T&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const go=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function gE(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Mr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function dLe(t,e){const r=gE(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},a=Number(t.quantity??n.qty??0),s=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??s??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:a,unitPrice:Number(n.unitPrice??(s&&a?s/a:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function fLe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}function hLe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,T]=g.useState([]),[P,O]=g.useState(!1),[z,ce]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});g.useEffect(()=>{(async()=>{b(!0),j("");try{const F=await Ht(yt(Ie,"sales_clothes")),H=[],K=[];F.forEach(ae=>{const X=ae.data(),De=dLe(X,ae.id);De&&(De.date<=a&&H.push(De),De.date>=r&&De.date<=a&&K.push(De))}),u(H),l(K);const L=await Ht(yt(Ie,"inventory_clothes_batches")),W=[];L.forEach(ae=>{const X=ae.data(),De=gE(X);!De||De>a||W.push({id:ae.id,productId:X.productId,productName:X.productName||"",date:De,quantity:Number(X.quantity||0),remaining:Number(X.remaining||0),purchasePrice:Number(X.purchasePrice||0)})}),f(W);const Y=await Ht(yt(Ie,"expenses_clothes")),D=[];Y.forEach(ae=>{const X=ae.data(),De=gE(X);De&&De>=r&&De<=a&&D.push({id:ae.id,date:De,category:X.category||"",description:X.description||"",amount:Number(X.amount||0),status:X.status||""})}),h(D);const Q=await Ht(yt(Ie,"ar_movements")),ee=[],ve={};Q.forEach(ae=>{const X=ae.data(),De=gE(X);if(!De)return;const le=X.customerId,$e=Number(X.amount||0);le&&(ve[le]=(ve[le]||0)+$e),X.type==="ABONO"&&De>=r&&De<=a&&ee.push({id:ae.id,customerId:le,type:"ABONO",amount:$e,date:De})}),p(ee);const M=await Ht(yt(Ie,"customers_clothes")),Ye=[];M.forEach(ae=>{const X=ae.data();Ye.push({id:ae.id,name:X.name||"",balance:ve[ae.id]||0})}),v(Ye)}catch(F){console.error(F),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const de=g.useMemo(()=>{try{return fLe(d,c,r,a)}catch(F){return console.error(F),0}},[d,c,r,a]),ue=g.useMemo(()=>{const F=o.reduce((ve,M)=>ve+(M.total||0),0),H=A.reduce((ve,M)=>ve+(M.amount||0),0),K=F-de,L=K-H,W=m.reduce((ve,M)=>ve+Math.abs(M.amount||0),0),Y=x.filter(ve=>(ve.balance||0)>0),D=Y.reduce((ve,M)=>ve+(M.balance||0),0);let Q=0,ee=0;for(const ve of o){const M=(ve.items||[]).reduce((Ye,ae)=>Ye+(Number(ae.qty)||0),0);ve.type==="CONTADO"?Q+=M:ee+=M}return{ventasTotales:F,costoMercaderia:de,gastosPeriodo:H,gananciaAntes:K,gananciaDespues:L,abonosRecibidos:W,saldosPendientes:D,clientesConSaldo:Y.length,prendasCash:Q,prendasCredito:ee}},[o,A,m,x,de]),me=g.useMemo(()=>{const F={};for(const H of o){if(H.type!=="CREDITO"||!H.customerId)continue;const K=(H.items||[]).reduce((L,W)=>L+(Number(W.qty)||0),0);F[H.customerId]=(F[H.customerId]||0)+K}return x.filter(H=>(H.balance||0)>0).map(H=>({customerId:H.id,name:H.name,prendasCredito:F[H.id]||0,saldo:H.balance||0})).sort((H,K)=>K.saldo-H.saldo)},[x,o]),se=g.useMemo(()=>{const F={};return x.forEach(H=>F[H.id]=H.name),F},[x]),ke=g.useMemo(()=>[...o].sort((F,H)=>H.date.localeCompare(F.date)).map(F=>{var L;const H=(F.items||[]).reduce((W,Y)=>W+(Number(Y.qty)||0),0);let K="Cash";return F.type==="CREDITO"&&F.customerId?K=se[F.customerId]||"":F.type==="CONTADO"&&(K=((L=F.customerName)==null?void 0:L.trim())||"Cash"),{id:F.id,date:F.date,type:F.type==="CREDITO"?"Crdito":"Cash",customer:K,piezas:H,total:Number(F.total||0)}}),[o,se]),Re=async F=>{_(!0),E({id:F.customerId,name:F.name}),T([]),O(!0),ce({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const H=[];let K=0,L=0,W=0;for(const ee of o)if(!(ee.type!=="CREDITO"||ee.customerId!==F.customerId))for(const ve of ee.items||[]){const M=Number(ve.qty||0),Ye=Number(ve.unitPrice||0),ae=M*Ye,X=Math.max(0,Number(ve.discount||0)),De=Math.max(0,ae-X);H.push({saleId:ee.id,date:ee.date,productName:ve.productName,sku:ve.sku||"",qty:M,unitPrice:Ye,lineTotal:ae,discount:X,lineFinal:De}),K+=ae,L+=X,W+=De}let Y=0;for(const ee of m)ee.customerId===F.customerId&&(Y+=Math.abs(ee.amount||0));const D=x.find(ee=>ee.id===F.customerId),Q=(D==null?void 0:D.balance)||0;T(H),ce({totalBruto:K,totalDescuento:L,totalFiado:W,saldoActual:Q,abonadoPeriodo:Y})}catch(H){console.error(H),j(" No se pudo cargar el detalle del cliente.")}finally{O(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(Oc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:F=>n(F.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:F=>s(F.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:go(ue.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:go(ue.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:go(ue.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:ue.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ue.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:ue.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):me.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):me.map(F=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Re({customerId:F.customerId,name:F.name}),title:"Ver piezas fiadas del periodo",children:F.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:go(F.saldo)})]},F.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):ke.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):ke.map(F=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.date}),i.jsx("td",{className:"p-2 border",children:F.customer}),i.jsx("td",{className:"p-2 border",children:F.type}),i.jsx("td",{className:"p-2 border",children:F.piezas}),i.jsx("td",{className:"p-2 border",children:go(F.total)})]},F.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((F,H)=>F.date.localeCompare(H.date)).map(F=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.date}),i.jsx("td",{className:"p-2 border",children:F.category||""}),i.jsx("td",{className:"p-2 border",children:F.description?i.jsx("span",{title:F.description,children:F.description.length>40?F.description.slice(0,40)+"":F.description}):""}),i.jsx("td",{className:"p-2 border",children:go(F.amount)}),i.jsx("td",{className:"p-2 border",children:F.status||""})]},F.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(S==null?void 0:S.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>_(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:go(z.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):B.sort((F,H)=>F.date.localeCompare(H.date)).map((F,H)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:F.date}),i.jsx("td",{className:"p-2 border",children:F.productName}),i.jsx("td",{className:"p-2 border",children:F.sku||""}),i.jsx("td",{className:"p-2 border",children:F.qty}),i.jsx("td",{className:"p-2 border",children:go(F.unitPrice)}),i.jsx("td",{className:"p-2 border",children:go(F.lineTotal)}),i.jsx("td",{className:"p-2 border",children:go(F.discount)}),i.jsx("td",{className:"p-2 border",children:go(F.lineFinal)})]},`${F.saleId}-${H}`))})]})})]})})]})}const y$=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],a_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function ALe(){const[t,e]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Mr(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState(null),[S,E]=g.useState(""),[B,T]=g.useState(""),[P,O]=g.useState(""),[z,ce]=g.useState(0),[de,ue]=g.useState("PENDIENTE"),[me,se]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(yt(Ie,"expenses_clothes"),In("date","desc")),Q=await Ht(D),ee=[];Q.forEach(ve=>{const M=ve.data();ee.push({id:ve.id,date:M.date||Mr(new Date,"yyyy-MM-dd"),category:M.category||"",description:M.description||"",amount:Number(M.amount||0),status:M.status||"PENDIENTE",notes:M.notes||"",createdAt:M.createdAt??vr.now()})}),v(ee)}catch(D){console.error(D),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const ke=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Re=g.useMemo(()=>{const D=ke.reduce((ve,M)=>ve+(M.amount||0),0),Q=ke.filter(ve=>ve.status==="PAGADO").reduce((ve,M)=>ve+(M.amount||0),0),ee=D-Q;return{total:D,pagado:Q,pendiente:ee}},[ke]),F=()=>{s(Mr(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const Q=await Jn(yt(Ie,"expenses_clothes"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:vr.now()});v(ee=>[{id:Q.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:vr.now()},...ee]),F(),j(" Gasto registrado")}catch(Q){console.error(Q),j(" Error al guardar gasto")}},K=D=>{_(D.id),E(D.date),T(D.category||""),O(D.description||""),ce(Number(D.amount||0)),ue(D.status||"PENDIENTE"),se(D.notes||"")},L=()=>{_(null),E(""),T(""),O(""),ce(0),ue("PENDIENTE"),se("")},W=async()=>{if(I){if(!B){j("Selecciona una categora.");return}if(!P.trim()){j("Ingresa una descripcin.");return}if(!z||z<=0){j("Ingresa un monto vlido.");return}try{await Fn(Zt(Ie,"expenses_clothes",I),{date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:de,notes:me||""}),v(D=>D.map(Q=>Q.id===I?{...Q,date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:de,notes:me||""}:Q)),L(),j(" Gasto actualizado")}catch(D){console.error(D),j(" Error al actualizar gasto")}}},Y=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await Kn(Zt(Ie,"expenses_clothes",D.id)),v(ee=>ee.filter(ve=>ve.id!==D.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",a_(Re.total)]}),i.jsxs("div",{children:["Pagado: ",a_(Re.pagado)]}),i.jsxs("div",{children:["Pendiente: ",a_(Re.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),y$.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):ke.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):ke.slice().sort((D,Q)=>D.date.localeCompare(Q.date)).map(D=>{const Q=I===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:ee=>E(ee.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:ee=>T(ee.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),y$.map(ee=>i.jsx("option",{value:ee,children:ee},ee))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:ee=>O(ee.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(z)?"":z,onChange:ee=>ce(Math.max(0,Number(ee.target.value||0)))}):a_(D.amount)}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:de,onChange:ee=>ue(ee.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:me,onChange:ee=>se(ee.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:W,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:L,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>K(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Y(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const Yd=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function mLe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Mr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function pLe(t,e){const r=mLe(t);if(!r)return null;const n=t.item||{},a=Number((n==null?void 0:n.qty)??t.quantity??0)||0,s=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(a>0?s/a:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||a||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:a,unitPrice:o,total:a*o}}}async function gLe(t,e){if(e<=0)return;const r=sr(yt(Ie,"inventory_clothes_batches"),mr("productId","==",t)),n=await Ht(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,s);s-=l,await Fn(Zt(Ie,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}s>0&&console.warn("consumeFIFO: falt inventario",s)}async function xLe(t,e){if(e<=0)return;const r=sr(yt(Ie,"inventory_clothes_batches"),mr("productId","==",t)),n=await Ht(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,s);s-=c,await Fn(Zt(Ie,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}s>0&&console.warn("restoreFIFO: no se devolvi todo",s)}async function pse(t){const e=sr(yt(Ie,"ar_movements"),mr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Kn(Zt(Ie,"ar_movements",n.id))))}async function vLe(t,e,r){if(await pse(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:vr.now(),ref:{saleId:t.id}},{addDoc:a}=await iA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>Wye);return{addDoc:o}},void 0);await a(yt(Ie,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const s=Math.max(0,Number(r??t.downPayment??0));s>0&&await a(yt(Ie,"ar_movements"),{...n,type:"ABONO",amount:-s})}function yLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async ae=>{e(!0),n(!0),s(ae),l([]);try{const De=(await Ht(sr(yt(Ie,"sales_clothes"),mr("__name__","==",ae)))).docs[0],le=De==null?void 0:De.data(),Xe=(Array.isArray(le==null?void 0:le.items)?le.items:le!=null&&le.item?[le.item]:[]).map(it=>({productName:String(it.productName||""),qty:Number(it.qty||0),unitPrice:Number(it.unitPrice||0),discount:Number(it.discount||0),total:Number(it.total||0)}));l(Xe)}catch(X){console.error(X)}finally{n(!1)}},[u,d]=g.useState(Mr(new Date,"yyyy-MM-01")),[f,A]=g.useState(Mr(new Date,"yyyy-MM-dd")),[h,m]=g.useState([]),[p,x]=g.useState([]),[v,y]=g.useState(!0),[b,w]=g.useState(""),[j,I]=g.useState(""),[_,S]=g.useState(""),[E,B]=g.useState(null),[T,P]=g.useState(!1),[O,z]=g.useState(null),[ce,de]=g.useState(0),ue=15,[me,se]=g.useState(1),ke=g.useMemo(()=>{const ae={};return h.forEach(X=>ae[X.id]=X.name),ae},[h]);g.useEffect(()=>{(async()=>{y(!0),w("");try{const ae=await Ht(yt(Ie,"customers_clothes")),X=[];ae.forEach($e=>X.push({id:$e.id,name:$e.data().name||""})),m(X);const De=await Ht(sr(yt(Ie,"sales_clothes"),In("createdAt","desc"))),le=[];De.forEach($e=>{const Xe=pLe($e.data(),$e.id);Xe&&Xe.date>=u&&Xe.date<=f&&le.push(Xe)}),x(le.sort(($e,Xe)=>Xe.date.localeCompare($e.date))),se(1)}catch(ae){console.error(ae),w(" Error cargando transacciones.")}finally{y(!1)}})()},[u,f]);const Re=g.useMemo(()=>p.filter(ae=>!(j&&ae.customerId!==j||_&&ae.type!==_)),[p,j,_]),F=g.useMemo(()=>{let ae=0,X=0,De=0,le=0;for(const $e of Re)$e.type==="CONTADO"?(ae+=$e.item.qty,De+=$e.total):(X+=$e.item.qty,le+=$e.total);return{piezasCash:ae,piezasCredito:X,montoCash:De,montoCredito:le}},[Re]),H=Math.max(1,Math.ceil(Re.length/ue)),K=g.useMemo(()=>{const ae=(me-1)*ue;return Re.slice(ae,ae+ue)},[Re,me]),L=ae=>{B(null),z(ae),de(ae.item.qty||0),P(!0)},W=async ae=>{if(B(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await sF(ae.id),await pse(ae.id),x(X=>X.filter(De=>De.id!==ae.id)),w(" Venta eliminada")}catch(X){console.error(X),w(" No se pudo eliminar la venta.")}finally{y(!1)}},Y=async()=>{if(!O)return;const ae=Number(O.item.qty||0),X=Math.max(1,Math.floor(Number(ce)||0));if(X===ae){P(!1);return}const De=Number(O.item.unitPrice||0),le=Number((De*X).toFixed(2));try{y(!0);const $e=X-ae;$e>0?await gLe(O.item.productId,$e):$e<0&&await xLe(O.item.productId,-$e);const Xe=Zt(Ie,"sales_clothes",O.id);await Fn(Xe,{quantity:X,total:le,itemsTotal:le,"item.qty":X,"item.total":le,updatedAt:vr.now()});const it=Math.min(Number(O.downPayment||0),le);await vLe(O,le,it),x(xt=>xt.map(jt=>jt.id===O.id?{...jt,quantity:X,total:le,item:{...jt.item,qty:X,total:le},downPayment:it}:jt)),w(" Venta actualizada"),P(!1)}catch($e){console.error($e),w(" No se pudo actualizar la venta.")}finally{y(!1)}},D=()=>{const ae=`Reporte de transacciones (Ropa)  ${u} a ${f}`,X=Xe=>(Xe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),De=Re.map(Xe=>{const it=Xe.customerName||(Xe.customerId?ke[Xe.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Xe.date}</td>
          <td>${X(it)}</td>
          <td>${Xe.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Xe.item.qty}</td>
          <td style="text-align:right">${Yd(Xe.total)}</td>
        </tr>`}).join(""),le=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${X(ae)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${X(ae)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${F.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${F.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${Yd(F.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Yd(F.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${De||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,$e=window.open("","_blank");$e&&($e.document.open(),$e.document.write(le),$e.document.close())},Q=()=>se(1),ee=()=>se(ae=>Math.max(1,ae-1)),ve=()=>se(ae=>Math.min(H,ae+1)),M=()=>se(H),Ye=()=>{const ae=[];if(H<=7)for(let De=1;De<=H;De++)ae.push(De);else{const De=Math.max(1,me-2),le=Math.min(H,me+2);ae.push(1),De>2&&ae.push(-1);for(let $e=De;$e<=le;$e++)$e!==1&&$e!==H&&ae.push($e);le<H-1&&ae.push(-2),ae.push(H)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Q,disabled:me===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ee,disabled:me===1,children:" Anterior"}),ae.map((De,le)=>typeof De=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${De===me?"bg-blue-600 text-white":""}`,onClick:()=>se(De),children:De},le):i.jsx("span",{className:"px-2",children:""},le)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ve,disabled:me===H,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:M,disabled:me===H,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",me," de ",H,"  ",Re.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:ae=>{d(ae.target.value),se(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:ae=>{A(ae.target.value),se(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:j,onChange:ae=>{I(ae.target.value),se(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(ae=>i.jsx("option",{value:ae.id,children:ae.name},ae.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:_,onChange:ae=>{S(ae.target.value),se(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:F.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:F.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Yd(F.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Yd(F.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:v?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):K.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):K.map(ae=>{const X=ae.customerName||(ae.customerId?ke[ae.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ae.date}),i.jsx("td",{className:"p-2 border",children:X}),i.jsx("td",{className:"p-2 border",children:ae.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(ae.id),children:ae.item.qty})}),i.jsx("td",{className:"p-2 border",children:Yd(ae.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>B(De=>De===ae.id?null:ae.id),title:"Acciones",children:""}),E===ae.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>L(ae),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>W(ae),children:"Eliminar"})]})]})]},ae.id)})})]}),Ye()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),T&&O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[O.item.productName," ",O.item.sku?` ${O.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:ce,onChange:ae=>de(Math.max(1,Math.floor(Number(ae.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:Yd(O.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:Yd(Number(O.item.unitPrice)*Number(ce||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{P(!1),z(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Y,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((ae,X)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ae.productName}),i.jsx("td",{className:"p-2 border text-right",children:ae.qty}),i.jsx("td",{className:"p-2 border text-right",children:Yd(ae.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Yd(ae.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Yd(ae.total)})]},X))})]})})]})})]})}const b$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],$c=t=>`C$ ${(Number(t)||0).toFixed(2)}`,p0=t=>Math.round((Number(t)||0)*100)/100,bLe=new Set(["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"]),xy=t=>{const e=String(t||"").trim().toUpperCase();return bLe.has(e)?"PAGADA":"PENDIENTE"};function s_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function w$(t){const e=sr(yt(Ie,"ar_movements_pollo"),mr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Kn(Zt(Ie,"ar_movements_pollo",n.id))))}function wLe({role:t="",roles:e,sellerPolloId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=En(a,"vendedor_pollo"),l=En(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(!1),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,T]=g.useState([]),P=async fe=>{var tt;j(!0),_(!0),E(fe),T([]);try{const vt=await zs(Zt(Ie,"salesV2",fe));let mt=null;if(vt.exists()?mt=vt.data():mt=(tt=(await Ht(sr(yt(Ie,"salesV2"),mr("name","==",fe)))).docs[0])==null?void 0:tt.data(),!mt){T([]);return}let Oe=[];if(Array.isArray(mt.items)&&mt.items.length>0)Oe=mt.items;else if(mt.items&&typeof mt.items=="object")try{Oe=Object.values(mt.items)}catch{Oe=[]}else mt.item?Oe=[mt.item]:Array.isArray(mt.products)&&mt.products.length>0?Oe=mt.products:Array.isArray(mt.lines)&&mt.lines.length>0?Oe=mt.lines:Array.isArray(mt.detalles)&&mt.detalles.length>0?Oe=mt.detalles:(mt.productName||mt.product)&&(Oe=[{productName:mt.productName||mt.product||"",qty:mt.qty??mt.quantity??mt.lbs??0,unitPrice:mt.unitPrice??mt.price??0,discount:mt.discount??0,total:mt.total??mt.amount??0}]);const At=Qt=>{if(Qt==null)return NaN;if(typeof Qt=="number")return Qt;let ar=String(Qt).trim();if(!ar)return NaN;if(ar=ar.replace(/[^0-9.,-]/g,""),!ar)return NaN;ar.indexOf(".")>-1&&ar.indexOf(",")>-1?ar=ar.replace(/,/g,""):ar.indexOf(",")>-1&&ar.indexOf(".")===-1&&(ar=ar.replace(/,/g,"."));const or=Number(ar);return Number.isNaN(or)?NaN:or},It=new Set;for(const Qt of Oe)if(Array.isArray(Qt==null?void 0:Qt.allocations))for(const ar of Qt.allocations){const or=String((ar==null?void 0:ar.batchId)||"").trim();or&&It.add(or)}else if(Qt!=null&&Qt.allocations&&typeof Qt.allocations=="object")try{for(const ar of Object.values(Qt.allocations)){const or=String((ar==null?void 0:ar.batchId)||"").trim();or&&It.add(or)}}catch{}if(Array.isArray(mt==null?void 0:mt.allocations))for(const Qt of mt.allocations){const ar=String((Qt==null?void 0:Qt.batchId)||"").trim();ar&&It.add(ar)}const Ct={};It.size>0&&await Promise.all(Array.from(It).map(async Qt=>{try{const ar=await zs(Zt(Ie,"inventory_batches",Qt));if(ar.exists()){const or=ar.data();Ct[Qt]=Number(or.salePrice??or.sale_price??or.price??0)}}catch{}}));const bt=new Set;for(const Qt of Oe){const ar=String(Qt.productId||"").trim();ar&&bt.add(ar)}const St={};bt.size>0&&await Promise.all(Array.from(bt).map(async Qt=>{try{const ar=await zs(Zt(Ie,"products",Qt));if(ar.exists()){const or=ar.data();St[Qt]=Number(or.salePrice??or.price??0)}}catch{}}));const Jt=Oe.map(Qt=>{const ar=String(Qt.productName||Qt.product||Qt.name||"(sin nombre)"),or=Number(Qt.qty??Qt.quantity??Qt.lbs??Qt.weight??0)||0,_r=At(Qt.total??Qt.lineFinal??Qt.amount??Qt.monto??Qt.line_total)||0;let Cr=0;const Ut=[Qt.unitPrice,Qt.unitPricePackage,Qt.salePrice,Qt.sale_price,Qt.price,Qt.unit_price,Qt.pricePerUnit,Qt.price_per_unit];for(const Ir of Ut){const yr=At(Ir);if(!Number.isNaN(yr)&&yr!==0){Cr=yr;break}}if(!Cr){const Ir=(mt==null?void 0:mt.salePrice)??(mt==null?void 0:mt.sale_price)??(mt==null?void 0:mt.unitPrice)??(mt==null?void 0:mt.unit_price)??(mt==null?void 0:mt.price)??(mt==null?void 0:mt.pricePerUnit),yr=At(Ir);!Number.isNaN(yr)&&yr!==0&&(Cr=yr)}if(!Cr){const Ir=Array.isArray(Qt.allocations)?Qt.allocations[0]:Qt.allocations&&typeof Qt.allocations=="object"?Object.values(Qt.allocations)[0]:null,yr=Ir?String(Ir.batchId||"").trim():"";yr&&Ct[yr]&&(Cr=Ct[yr]||0)}!Cr&&Qt.productId&&(Cr=St[String(Qt.productId)]||0),(!Cr||Cr===0)&&_r>0&&or>0&&(Cr=_r/or);const tn=At(Qt.discount??Qt.desc??0)||0;let Gr=_r;return(!Gr||Gr===0)&&(Gr=Number(Cr*or||0)),Gr=Number(Gr)||0,{productName:ar,qty:or,unitPrice:Cr,discount:tn,total:Gr}});T(Jt)}catch(vt){console.error(vt)}finally{_(!1)}},[O,z]=g.useState(""),[ce,de]=g.useState("+505 "),[ue,me]=g.useState(""),[se,ke]=g.useState(""),[Re,F]=g.useState("ACTIVO"),[H,K]=g.useState(0),[L,W]=g.useState(""),[Y,D]=g.useState(0),[Q,ee]=g.useState([]),[ve,M]=g.useState(!0),[Ye,ae]=g.useState(""),[X,De]=g.useState(null),[le,$e]=g.useState(""),[Xe,it]=g.useState("+505 "),[xt,jt]=g.useState(""),[Mt,Ft]=g.useState(""),[$t,kt]=g.useState("ACTIVO"),[Ge,ie]=g.useState(0),[Ue,Ne]=g.useState(""),[be,Ce]=g.useState(!1),[Le,Ae]=g.useState(null),[We,ct]=g.useState(!1),[_t,pe]=g.useState([]),[Pe,Ee]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[Ze,xe]=g.useState(!1),[Se,gt]=g.useState(0),[Et,Nt]=g.useState(new Date().toISOString().slice(0,10)),[Tt,Lt]=g.useState(""),[Me,_e]=g.useState(!1),[U,ye]=g.useState(null),[te,Ve]=g.useState(""),[qe,G]=g.useState(0),[V,Z]=g.useState(""),[re,we]=g.useState(null),[Fe,st]=g.useState(!1),[Be,at]=g.useState(null),[lt,dt]=g.useState(!1),[Pt,he]=g.useState(!1),[ze,nt]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(M(!0),o&&!s){ee([]),ae(" Este usuario no tiene vendedor asociado (sellerPolloId vaco).");return}const fe=await Ht(yt(Ie,"sellers_candies")),tt=[];fe.forEach(At=>{const It=At.data();tt.push({id:At.id,name:String(It.name||"")})}),u(tt);const vt=o?sr(yt(Ie,"customers_pollo"),mr("vendorId","==",s),In("createdAt","desc")):sr(yt(Ie,"customers_pollo"),In("createdAt","desc")),mt=await Ht(vt),Oe=[];mt.forEach(At=>{const It=At.data();Oe.push({id:At.id,name:It.name??"",phone:It.phone??"+505 ",place:It.place??"",notes:It.notes??"",status:It.status??"ACTIVO",creditLimit:Number(It.creditLimit??0),createdAt:It.createdAt??vr.now(),balance:0,vendorId:It.vendorId||"",vendorName:It.vendorName||"",initialDebt:Number(It.initialDebt||0),lastAbonoDate:"",lastAbonoAmount:0})});for(const At of Oe)try{const It=sr(yt(Ie,"ar_movements_pollo"),mr("customerId","==",At.id)),Ct=await Ht(It);let bt=0,St=null,Jt=!1;Ct.forEach(_r=>{var tn,Gr,Ir;const Cr=_r.data(),Ut=Number(Cr.amount||0);if(bt+=Ut,Ut>0&&xy(Cr.debtStatus??Cr.creditStatus??Cr.cycleStatus??Cr.status)==="PENDIENTE"&&(Jt=!0),Ut<0){const yr=Cr.date??((Gr=(tn=Cr.createdAt)==null?void 0:tn.toDate)!=null&&Gr.call(tn)?Cr.createdAt.toDate().toISOString().slice(0,10):""),jr=(Ir=Cr.createdAt)!=null&&Ir.seconds?Number(Cr.createdAt.seconds):0;(!St||jr>=St.ts)&&(St={date:yr,amount:Math.abs(Ut),ts:jr})}});const Qt=Number(At.initialDebt||0),ar=p0(Qt+bt);At.balance=ar,(Jt||ar>0)&&St?(At.lastAbonoDate=St.date,At.lastAbonoAmount=St.amount):(At.lastAbonoDate="",At.lastAbonoAmount=0)}catch{At.balance=Number(At.initialDebt||0),At.lastAbonoDate="",At.lastAbonoAmount=0}ee(Oe)}catch(fe){console.error(fe),ae(" Error cargando clientes.")}finally{M(!1)}})()},[o,s]);const ne=()=>{z(""),de("+505 "),me(""),ke(""),F("ACTIVO"),K(0),W(""),D(0)},He=async fe=>{var Oe;if(fe.preventDefault(),ae(""),!O.trim()){ae("Ingresa el nombre.");return}const tt=s_(ce);if(tt.length<6){ae("Telfono incompleto.");return}const vt=o?s:String(L||""),mt=vt&&((Oe=c.find(At=>At.id===vt))==null?void 0:Oe.name)||"";try{const At=Number(Y||0),It=await Jn(yt(Ie,"customers_pollo"),{name:O.trim(),phone:tt,place:ue||"",notes:se||"",status:Re,creditLimit:Number(H||0),vendorId:vt,vendorName:mt,initialDebt:At,createdAt:vr.now()});ee(Ct=>[{id:It.id,name:O.trim(),phone:tt,place:ue||"",notes:se||"",status:Re,creditLimit:Number(H||0),vendorId:vt,vendorName:mt,initialDebt:At,createdAt:vr.now(),balance:At,lastAbonoDate:"",lastAbonoAmount:0},...Ct]),ne(),st(!1),ae(" Cliente creado")}catch(At){console.error(At),ae(" Error al crear cliente")}},pt=fe=>{if(o){ae(" No permitido: vendedores no editan clientes desde el listado.");return}De(fe.id),$e(fe.name),it(fe.phone||"+505 "),jt(fe.place||""),Ft(fe.notes||""),kt(fe.status||"ACTIVO"),ie(Number(fe.creditLimit||0)),Ne(String(fe.vendorId||""))},Dt=()=>{De(null),$e(""),it("+505 "),jt(""),Ft(""),kt("ACTIVO"),ie(0),Ne("")},rr=async()=>{var It;if(o){ae(" No permitido.");return}if(!X)return;const fe=s_(Xe);if(!le.trim()){ae("Ingresa el nombre.");return}const tt=Q.find(Ct=>Ct.id===X),vt=String((tt==null?void 0:tt.vendorId)||""),mt=o?s:String(Ue||"");if(o&&vt&&vt!==s){ae(" Este cliente pertenece a otro vendedor.");return}if(l&&vt&&mt&&vt!==mt){ae(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const Oe=o?s:String(Ue||""),At=Oe&&((It=c.find(Ct=>Ct.id===Oe))==null?void 0:It.name)||"";try{await Fn(Zt(Ie,"customers_pollo",X),{name:le.trim(),phone:fe,place:xt||"",notes:Mt||"",status:$t,creditLimit:Number(Ge||0),vendorId:Oe,vendorName:At}),ee(Ct=>Ct.map(bt=>bt.id===X?{...bt,name:le.trim(),phone:fe,place:xt||"",notes:Mt||"",status:$t,creditLimit:Number(Ge||0),vendorId:Oe,vendorName:At}:bt)),Dt(),ae(" Cliente actualizado")}catch(Ct){console.error(Ct),ae(" Error al actualizar")}},zt=async fe=>{if(confirm(`Eliminar al cliente "${fe.name}"?
Se borrarn todas sus ventas y movimientos.`))try{M(!0);const vt=sr(yt(Ie,"salesV2"),mr("customerId","==",fe.id)),mt=await Ht(vt);for(const It of mt.docs){const Ct=It.id;try{await Kn(Zt(Ie,"salesV2",Ct))}catch(bt){console.warn("delete sale error",bt)}await w$(Ct)}const Oe=sr(yt(Ie,"ar_movements_pollo"),mr("customerId","==",fe.id)),At=await Ht(Oe);await Promise.all(At.docs.map(It=>Kn(Zt(Ie,"ar_movements_pollo",It.id)))),await Kn(Zt(Ie,"customers_pollo",fe.id)),ee(It=>It.filter(Ct=>Ct.id!==fe.id)),ae(" Cliente eliminado y registros borrados")}catch(vt){console.error(vt),ae(" No se pudo eliminar el cliente.")}finally{M(!1)}},Ot=(fe,tt)=>{const vt=fe.reduce((It,Ct)=>It+(Number(Ct.amount)||0),0),mt=fe.filter(It=>Number(It.amount)<0).reduce((It,Ct)=>It+Math.abs(Number(Ct.amount)||0),0),Oe=fe.filter(It=>Number(It.amount)>0).reduce((It,Ct)=>It+(Number(Ct.amount)||0),0),At=Number(tt||0)+vt;Ee({saldoActual:At,totalAbonado:mt,totalCargos:Number(tt||0)+Oe,saldoRestante:At})},lr=async fe=>{Ae(fe),pe([]),Ee({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),Ce(!0),dt(!1),he(!1),nt(null),xe(!1),gt(0),Nt(new Date().toISOString().slice(0,10)),Lt(""),ye(null),ct(!0);try{const tt=sr(yt(Ie,"ar_movements_pollo"),mr("customerId","==",fe.id)),vt=await Ht(tt),mt=[];vt.forEach(Oe=>{var bt,St;const At=Oe.data(),It=At.date??((St=(bt=At.createdAt)==null?void 0:bt.toDate)!=null&&St.call(bt)?At.createdAt.toDate().toISOString().slice(0,10):""),Ct=Number(At.amount||0);mt.push({id:Oe.id,date:It,type:At.type??(Ct<0?"ABONO":"CARGO"),amount:Ct,ref:At.ref||{},comment:At.comment||"",createdAt:At.createdAt,debtStatus:xy(At.debtStatus??At.creditStatus??At.cycleStatus??At.status)})}),mt.sort((Oe,At)=>{var bt,St;if(Oe.date!==At.date)return Oe.date.localeCompare(At.date);const It=((bt=Oe.createdAt)==null?void 0:bt.seconds)||0,Ct=((St=At.createdAt)==null?void 0:St.seconds)||0;return It-Ct}),pe(mt),Ot(mt,Number(fe.initialDebt||0))}catch(tt){console.error(tt),ae(" No se pudo cargar el estado de cuenta")}finally{ct(!1)}},Dr=(fe,tt)=>p0(tt||0)>0?!0:fe.some(vt=>vt.type==="CARGO"&&xy(vt.debtStatus)==="PENDIENTE"),br=fe=>{const tt=fe.filter(vt=>Number(vt.amount)<0).map(vt=>{var mt;return{date:vt.date,amount:Math.abs(Number(vt.amount||0)),ts:((mt=vt.createdAt)==null?void 0:mt.seconds)||0}}).sort((vt,mt)=>(vt.ts||0)-(mt.ts||0));return tt.length?tt[tt.length-1]:null},nr=async()=>{if(!Le)return;ae("");const fe=Number(Se||0);if(!(fe>0)){ae("Ingresa un monto de abono mayor a 0.");return}const tt=parseFloat(fe.toFixed(2));if(!Et){ae("Selecciona la fecha del abono.");return}try{_e(!0);const vt={customerId:Le.id,type:"ABONO",amount:-tt,date:Et,comment:Tt||"",createdAt:vr.now()},Oe={id:(await Jn(yt(Ie,"ar_movements_pollo"),vt)).id,date:Et,type:"ABONO",amount:-tt,comment:Tt||"",createdAt:vr.now()},At=[..._t,Oe].sort((St,Jt)=>{var or,_r;if(St.date!==Jt.date)return St.date.localeCompare(Jt.date);const Qt=((or=St.createdAt)==null?void 0:or.seconds)||0,ar=((_r=Jt.createdAt)==null?void 0:_r.seconds)||0;return Qt-ar});pe(At),Ot(At,Number(Le.initialDebt||0));const It=At.reduce((St,Jt)=>St+(Number(Jt.amount)||0),0),Ct=p0(Number(Le.initialDebt||0)+It),bt=Dr(At,Ct);ee(St=>St.map(Jt=>{if(Jt.id!==Le.id)return Jt;const Qt=p0((Jt.balance||0)-tt);return{...Jt,balance:Qt,lastAbonoDate:bt?Et:"",lastAbonoAmount:bt?tt:0}})),Ae(St=>St&&{...St,balance:p0((St.balance||0)-tt),lastAbonoDate:bt?Et:"",lastAbonoAmount:bt?tt:0}),gt(0),Lt(""),Nt(new Date().toISOString().slice(0,10)),xe(!1),ae(" Abono registrado")}catch(vt){console.error(vt),ae(" Error al registrar el abono")}finally{_e(!1)}},ir=fe=>{ye(fe.id),Ve(fe.date||new Date().toISOString().slice(0,10)),G(Math.abs(Number(fe.amount||0))),Z(fe.comment||"")},Nr=()=>{ye(null),Ve(""),G(0),Z("")},Pr=async()=>{if(!U||!Le)return;const fe=_t.findIndex(Oe=>Oe.id===U);if(fe===-1)return;const tt=_t[fe],vt=Number(qe||0);if(!(vt>0)){ae("El monto debe ser mayor a 0.");return}const mt=tt.type==="ABONO"?-parseFloat(vt.toFixed(2)):+parseFloat(vt.toFixed(2));try{await Fn(Zt(Ie,"ar_movements_pollo",U),{date:te,amount:mt,comment:V||""});const Oe=[..._t];Oe[fe]={...tt,date:te,amount:mt,comment:V||""},Oe.sort((St,Jt)=>{var or,_r;if(St.date!==Jt.date)return St.date.localeCompare(Jt.date);const Qt=((or=St.createdAt)==null?void 0:or.seconds)||0,ar=((_r=Jt.createdAt)==null?void 0:_r.seconds)||0;return Qt-ar}),pe(Oe),Ot(Oe,Number(Le.initialDebt||0));const At=Oe.reduce((St,Jt)=>St+(Number(Jt.amount)||0),0),It=p0(Number(Le.initialDebt||0)+At),Ct=Dr(Oe,It),bt=Ct?br(Oe):null;ee(St=>St.map(Jt=>Jt.id===Le.id?{...Jt,balance:It,lastAbonoDate:Ct&&bt?bt.date:"",lastAbonoAmount:Ct&&bt?bt.amount:0}:Jt)),Ae(St=>St&&{...St,balance:It,lastAbonoDate:Ct&&bt?bt.date:"",lastAbonoAmount:Ct&&bt?bt.amount:0}),Nr(),ae(" Movimiento actualizado")}catch(Oe){console.error(Oe),ae(" Error al actualizar movimiento")}},xr=async fe=>{var vt,mt;if(confirm(`Eliminar este movimiento (${fe.type==="ABONO"?"Abono":"Compra"}) del ${fe.date}?${fe.type==="CARGO"&&((vt=fe.ref)!=null&&vt.saleId)?`
Se borrarn los registros de esa venta.`:""}`)&&Le)try{if(M(!0),fe.type==="CARGO"&&((mt=fe.ref)!=null&&mt.saleId)){try{await Kn(Zt(Ie,"salesV2",fe.ref.saleId))}catch(St){console.warn("delete sale error",St),M(!1),ae(" No se pudo borrar la venta asociada.");return}await w$(fe.ref.saleId)}else await Kn(Zt(Ie,"ar_movements_pollo",fe.id));const Oe=_t.filter(St=>{var Jt,Qt;return fe.type==="CARGO"&&((Jt=fe.ref)!=null&&Jt.saleId)?((Qt=St.ref)==null?void 0:Qt.saleId)!==fe.ref.saleId:St.id!==fe.id});pe(Oe),Ot(Oe,Number(Le.initialDebt||0));const At=Oe.reduce((St,Jt)=>St+(Number(Jt.amount)||0),0),It=p0(Number(Le.initialDebt||0)+At),Ct=Dr(Oe,It),bt=Ct?br(Oe):null;ee(St=>St.map(Jt=>Jt.id===Le.id?{...Jt,balance:It,lastAbonoDate:Ct&&bt?bt.date:"",lastAbonoAmount:Ct&&bt?bt.amount:0}:Jt)),Ae(St=>St&&{...St,balance:It,lastAbonoDate:Ct&&bt?bt.date:"",lastAbonoAmount:Ct&&bt?bt.amount:0}),nt(null),ae(" Movimiento eliminado")}catch(Oe){console.error(Oe),ae(" Error al eliminar movimiento")}finally{M(!1)}},$r=async fe=>{if(fe.type!=="CARGO")return;const tt=xy(fe.debtStatus)==="PAGADA"?"PENDIENTE":"PAGADA";try{we(fe.id),await Fn(Zt(Ie,"ar_movements_pollo",fe.id),{debtStatus:tt});const vt=_t.map(mt=>mt.id===fe.id?{...mt,debtStatus:tt}:mt);if(pe(vt),Le){Ot(vt,Number(Le.initialDebt||0));const mt=vt.reduce((Ct,bt)=>Ct+(Number(bt.amount)||0),0),Oe=p0(Number(Le.initialDebt||0)+mt),At=Dr(vt,Oe),It=At?br(vt):null;ee(Ct=>Ct.map(bt=>bt.id===Le.id?{...bt,balance:Oe,lastAbonoDate:At&&It?It.date:"",lastAbonoAmount:At&&It?It.amount:0}:bt)),Ae(Ct=>Ct&&{...Ct,balance:Oe,lastAbonoDate:At&&It?It.date:"",lastAbonoAmount:At&&It?It.amount:0})}ae(tt==="PAGADA"?" Compra marcada como pagada":" Compra marcada como pendiente")}catch(vt){console.error(vt),ae(" No se pudo actualizar el estado de la compra")}finally{we(null)}},cr=g.useMemo(()=>[...Q].sort((fe,tt)=>{var vt,mt;return fe.status!==tt.status?fe.status==="BLOQUEADO"?1:-1:(((vt=tt.createdAt)==null?void 0:vt.seconds)||0)-(((mt=fe.createdAt)==null?void 0:mt.seconds)||0)}),[Q]),Zr=fe=>fe==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",Wr=g.useMemo(()=>{const fe=A.trim().toLowerCase(),tt=x.trim()===""?null:Number(x),vt=y.trim()===""?null:Number(y);return cr.filter(mt=>{const Oe=!fe||String(mt.name||"").toLowerCase().includes(fe),At=!m||mt.status===m,It=Number(mt.balance||0),Ct=tt===null||!Number.isNaN(tt)&&It>=tt,bt=vt===null||!Number.isNaN(vt)&&It<=vt;return Oe&&At&&Ct&&bt})},[cr,A,m,x,y]),zr=g.useMemo(()=>Wr.reduce((fe,tt)=>fe+Number(tt.balance||0),0),[Wr]),gn=g.useMemo(()=>Wr.filter(fe=>fe.status==="ACTIVO").length,[Wr]),Nn=Wr.length,Sn=()=>{h(""),p(""),v(""),b("")};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Pollo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{st(!0),o&&W(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Saldo pendiente"}),i.jsx("div",{className:"text-2xl font-semibold",children:$c(zr)}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Calculado sobre los clientes filtrados"})]}),i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Clientes activos"}),i.jsx("div",{className:"text-2xl font-semibold",children:gn}),i.jsxs("p",{className:"text-[11px] text-gray-500 mt-1",children:["De un total de ",Nn]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm p-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Filtrar cliente"}),i.jsx("input",{className:"w-full border rounded px-3 py-2",placeholder:"Nombre, telfono o nota",value:A,onChange:fe=>h(fe.target.value)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-gray-50 hover:bg-gray-100",onClick:()=>f(fe=>!fe),children:d?"Ocultar filtros":"Ms filtros"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-white hover:bg-gray-50",onClick:Sn,children:"Limpiar"})]})]}),d&&i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border rounded px-3 py-2",value:m,onChange:fe=>p(fe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"Activo"}),i.jsx("option",{value:"BLOQUEADO",children:"Bloqueado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mnimo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:x,onChange:fe=>v(fe.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mximo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:y,onChange:fe=>b(fe.target.value),placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ve?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Wr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Wr.map(fe=>{var vt;const tt=X===fe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(vt=fe.createdAt)!=null&&vt.toDate?fe.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:le,onChange:mt=>$e(mt.target.value)}):i.jsx("div",{className:"font-medium",children:fe.name})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:Xe,onChange:mt=>it(s_(mt.target.value))}):fe.phone}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ue,onChange:mt=>Ne(mt.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(mt=>i.jsx("option",{value:mt.id,children:mt.name},mt.id))]}):fe.vendorName||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:xt,onChange:mt=>jt(mt.target.value),children:[i.jsx("option",{value:"",children:""}),b$.map(mt=>i.jsx("option",{value:mt,children:mt},mt))]}):fe.place||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:$t,onChange:mt=>kt(mt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Zr(fe.status)}`,children:fe.status})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ge)?"":Ge,onChange:mt=>ie(Math.max(0,Number(mt.target.value||0)))}):$c(fe.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:$c(fe.balance||0)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Mt,onChange:mt=>Ft(mt.target.value),maxLength:500}):i.jsx("span",{title:fe.notes||"",children:(fe.notes||"").length>40?(fe.notes||"").slice(0,40)+"":fe.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:tt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:rr,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Dt,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>pt(fe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>zt(fe),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>lr(fe),children:"Estado de cuenta"})]})})})]},fe.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-2",children:ve?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Cargando"}):Wr.length===0?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Sin clientes"}):Wr.map(fe=>i.jsxs("div",{className:"border rounded-lg bg-white p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-base",children:fe.name}),i.jsx("div",{className:"text-xs text-gray-600",children:fe.phone||""}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:fe.vendorName||""})]})]}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Zr(fe.status)}`,children:fe.status})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:$c(fe.balance||0)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Lmite"}),i.jsx("div",{className:"font-semibold",children:$c(fe.creditLimit||0)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["ltimo abono:"," ",i.jsx("span",{className:"font-medium",children:fe.lastAbonoDate?`${fe.lastAbonoDate} (${$c(fe.lastAbonoAmount||0)})`:""})]}),fe.notes?i.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Nota:"})," ",(fe.notes||"").length>80?(fe.notes||"").slice(0,80)+"":fe.notes]}):null,i.jsxs("div",{className:"mt-3 flex gap-2 flex-wrap",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white text-sm",onClick:()=>lr(fe),children:"Estado de cuenta"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-yellow-600 text-white text-sm",onClick:()=>pt(fe),disabled:o,title:o?"Vendedor no edita":"Editar",children:"Editar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-red-600 text-white text-sm disabled:opacity-50",onClick:()=>zt(fe),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"})]})]},fe.id))})]}),Ye&&i.jsx("p",{className:"mt-2 text-sm",children:Ye}),Fe&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>st(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>st(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:He,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:O,onChange:fe=>z(fe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ce,onChange:fe=>de(s_(fe.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ue,onChange:fe=>me(fe.target.value),children:[i.jsx("option",{value:"",children:""}),b$.map(fe=>i.jsx("option",{value:fe,children:fe},fe))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Re,onChange:fe=>F(fe.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:L,onChange:fe=>W(fe.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(fe=>i.jsx("option",{value:fe.id,children:fe.name},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Y===0?"":Y,onChange:fe=>D(Math.max(0,Number(fe.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:fe=>K(Math.max(0,Number(fe.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:se,onChange:fe=>ke(fe.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[se.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>st(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),be&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[50]",style:{zIndex:50},children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ce(!1)}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-full max-w-5xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-3",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(Le==null?void 0:Le.name)||""]}),i.jsxs("div",{className:"flex gap-2 shrink-0",children:[i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{gt(0),Nt(new Date().toISOString().slice(0,10)),Lt(""),xe(!0)},children:"Abonar"}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ce(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(Number((Le==null?void 0:Le.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(Pe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(Pe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:$c(Pe.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Estado compra"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:We?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):_t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):_t.map(fe=>{var mt;const tt=U===fe.id,vt=xy(fe.debtStatus);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:te,onChange:Oe=>Ve(Oe.target.value)}):fe.date||""}),i.jsx("td",{className:"p-2 border",children:fe.amount>=0?(mt=fe.ref)!=null&&mt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",onClick:()=>P(fe.ref.saleId),children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:fe.type==="CARGO"?i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${vt==="PAGADA"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:vt==="PAGADA"?"Pagada":"Pendiente"}):""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:V,onChange:Oe=>Z(Oe.target.value)}):i.jsx("span",{title:fe.comment||"",children:(fe.comment||"").length>40?(fe.comment||"").slice(0,40)+"":fe.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(qe)?"":qe,onChange:Oe=>G(Number(Oe.target.value||0))}):$c(fe.amount)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Pr,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Nr,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>ir(fe),children:"Editar"}),fe.type==="CARGO"&&i.jsx("button",{type:"button",className:`px-2 py-1 rounded text-white ${vt==="PAGADA"?"bg-gray-600 hover:bg-gray-700":"bg-emerald-600 hover:bg-emerald-700"} disabled:opacity-50`,onClick:()=>$r(fe),disabled:re===fe.id,children:vt==="PAGADA"?"Marcar pendiente":"Marcar pagada"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>xr(fe),children:"Borrar"})]})})]},fe.id)})})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",style:{zIndex:60},children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," "]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((fe,tt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:fe.productName}),i.jsx("td",{className:"p-2 border text-right",children:fe.qty}),i.jsx("td",{className:"p-2 border text-right",children:$c(fe.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:$c(fe.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:$c(fe.total)})]},tt))})]})})]})})]}),document.body),Ze&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[90]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(Le==null?void 0:Le.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Et,onChange:fe=>Nt(fe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Se===0?"":Se,onChange:fe=>{const tt=Number(fe.target.value||0),vt=Number.isFinite(tt)?Math.max(0,parseFloat(tt.toFixed(2))):0;gt(vt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Tt,onChange:fe=>Lt(fe.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Tt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>xe(!1),disabled:Me,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:nr,disabled:Me,children:Me?"Guardando...":"Guardar abono"})]})]})})]})}function NLe(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function CLe(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var _Le=function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o])},t(r,n)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ELe=function(t){_Le(e,t);function e(r,n){var a=this.constructor,s=t.call(this,r,n)||this;return Object.defineProperty(s,"name",{value:a.name,enumerable:!1,configurable:!0}),NLe(s,a.prototype),CLe(s),s}return e}(Error),SLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cu=function(t){SLe(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind="Exception",e}(ELe),ILe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qi=function(t){ILe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArgumentException",e}(cu),jLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pn=function(t){jLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(cu),gse=function(){function t(e){if(this.binarizer=e,e===null)throw new Pn("Binarizer must be non-null.")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,a){var s=this.binarizer.getLuminanceSource().crop(e,r,n,a);return new t(this.binarizer.createBinarizer(s))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},t}(),PLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oo=function(t){PLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(cu),BLe=function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t}(),ws=function(){function t(){}return t.arraycopy=function(e,r,n,a,s){for(;s--;)n[a++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t}(),TLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),FR=function(t){TLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(cu),kLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),N$=function(t){kLe(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var a=t.call(this,n)||this;return a.index=r,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(FR),FLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bo=function(){function t(){}return t.fill=function(e,r){for(var n=0,a=e.length;n<a;n++)e[n]=r},t.fillWithin=function(e,r,n,a){t.rangeCheck(e.length,r,n);for(var s=r;s<n;s++)e[s]=a},t.rangeCheck=function(e,r,n){if(r>n)throw new Pn("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new N$(r);if(n>e)throw new N$(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var a=1;try{for(var s=FLe(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=31*a+l}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var a=n-r,s=new Int32Array(a);return ws.arraycopy(e,r,s,0,a),s},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var a=0,s=e.length-1;a<=s;){var o=s+a>>1,l=n(r,e[o]);if(l>0)a=o+1;else if(l<0)s=o-1;else return o}return-a-1},t.numberComparator=function(e,r){return e-r},t}(),sa=function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),el=function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);ws.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=~n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=~n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new Pn;if(r!==e){r--;for(var n=Math.floor(e/32),a=Math.floor(r/32),s=this.bits,o=n;o<=a;o++){var l=o>n?0:e&31,c=o<a?31:r&31,u=(2<<c)-(1<<l);s[o]|=u}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new Pn;if(r===e)return!0;r--;for(var a=Math.floor(e/32),s=Math.floor(r/32),o=this.bits,l=a;l<=s;l++){var c=l>a?0:e&31,u=l<s?31:r&31,d=(2<<u)-(1<<c)&4294967295;if((o[l]&d)!==(n?d:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new Pn("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new Pn("Sizes don't match");for(var r=this.bits,n=0,a=r.length;n<a;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,a){for(var s=0;s<a;s++){for(var o=0,l=0;l<8;l++)this.get(e)&&(o|=1<<7-l),e++;r[n+s]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits,s=0;s<n;s++){var o=a[s];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-s]=o}if(this.size!==n*32){for(var l=n*32-this.size,c=e[0]>>>l,s=1;s<n;s++){var u=e[s];c|=u<<32-l,e[s-1]=c,c=u>>>l}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+Bo.hashCode(this.bits)},t.prototype.toString=function(){for(var e="",r=0,n=this.size;r<n;r++)r&7||(e+=" "),e+=this.get(r)?"X":".";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t}(),iF;(function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",t[t.ASSUME_GS1=8]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(iF||(iF={}));const Ns=iF;var OLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hr=function(t){OLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(cu),DLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},qa;(function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"})(qa||(qa={}));var jo=function(){function t(e,r,n){for(var a,s,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];this.valueIdentifier=e,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,u=0,d=c.length;u!==d;u++){var f=c[u];t.VALUES_TO_ECI.set(f,this)}try{for(var A=DLe(o),h=A.next();!h.done;h=A.next()){var m=h.value;t.NAME_TO_ECI.set(m,this)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new Hr("incorect value");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new Hr("incorect value");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new Hr("incorect value");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(qa.Cp437,Int32Array.from([0,2]),"Cp437"),t.ISO8859_1=new t(qa.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),t.ISO8859_2=new t(qa.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),t.ISO8859_3=new t(qa.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),t.ISO8859_4=new t(qa.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),t.ISO8859_5=new t(qa.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),t.ISO8859_6=new t(qa.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),t.ISO8859_7=new t(qa.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),t.ISO8859_8=new t(qa.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),t.ISO8859_9=new t(qa.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),t.ISO8859_10=new t(qa.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),t.ISO8859_11=new t(qa.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),t.ISO8859_13=new t(qa.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),t.ISO8859_14=new t(qa.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),t.ISO8859_15=new t(qa.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),t.ISO8859_16=new t(qa.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),t.SJIS=new t(qa.SJIS,20,"SJIS","Shift_JIS"),t.Cp1250=new t(qa.Cp1250,21,"Cp1250","windows-1250"),t.Cp1251=new t(qa.Cp1251,22,"Cp1251","windows-1251"),t.Cp1252=new t(qa.Cp1252,23,"Cp1252","windows-1252"),t.Cp1256=new t(qa.Cp1256,24,"Cp1256","windows-1256"),t.UnicodeBigUnmarked=new t(qa.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),t.UTF8=new t(qa.UTF8,26,"UTF8","UTF-8"),t.ASCII=new t(qa.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),t.Big5=new t(qa.Big5,28,"Big5"),t.GB18030=new t(qa.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),t.EUC_KR=new t(qa.EUC_KR,30,"EUC_KR","EUC-KR"),t}(),RLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xE=function(t){RLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(cu),Bd=function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e==="ISO-8859-1"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},t.encodingName=function(e){return typeof e=="string"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof jo?e:jo.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var a="",s=0,o=e.length;s<o;s++){var l=e[s].toString(16);l.length<2&&(l="0"+l),a+="%"+l}return decodeURIComponent(a)}if(n.equals(jo.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new xE("Encoding "+this.encodingName(r)+" not supported by fallback.")},t.isDecodeFallbackSupported=function(e){return e.equals(jo.UTF8)||e.equals(jo.ISO8859_1)||e.equals(jo.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(""),a=[],s=0;s<n.length;s++)a.push(n[s].charCodeAt(0));return new Uint8Array(a)},t}(),ba=function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return Bd.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(Ns.CHARACTER_SET)!==void 0)return r.get(Ns.CHARACTER_SET).toString();for(var n=e.length,a=!0,s=!0,o=!0,l=0,c=0,u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,b=0;b<n&&(a||s||o);b++){var w=e[b]&255;o&&(l>0?w&128?l--:o=!1:w&128&&(w&64?(l++,w&32?(l++,w&16?(l++,w&8?o=!1:d++):u++):c++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&v++),s&&(f>0?w<64||w===127||w>252?s=!1:f--:w===128||w===160||w>239?s=!1:w>160&&w<224?(A++,m=0,h++,h>p&&(p=h)):w>127?(f++,h=0,m++,m>x&&(x=m)):(h=0,m=0))}return o&&l>0&&(o=!1),s&&f>0&&(s=!1),o&&(y||c+u+d>0)?t.UTF8:s&&(t.ASSUME_SHIFT_JIS||p>=3||x>=3)?t.SHIFT_JIS:a&&s?p===2&&A===2||v*10>=n?t.SHIFT_JIS:t.ISO88591:a?t.ISO88591:s?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=-1;function s(l,c,u,d,f,A){if(l==="%%")return"%";if(r[++a]!==void 0){l=d?parseInt(d.substr(1)):void 0;var h=f?parseInt(f.substr(1)):void 0,m;switch(A){case"s":m=r[a];break;case"c":m=r[a][0];break;case"f":m=parseFloat(r[a]).toFixed(l);break;case"p":m=parseFloat(r[a]).toPrecision(l);break;case"e":m=parseFloat(r[a]).toExponential(l);break;case"x":m=parseInt(r[a]).toString(h||16);break;case"d":m=parseFloat(parseInt(r[a],h||10).toPrecision(l)).toFixed(0);break}m=typeof m=="object"?JSON.stringify(m):(+m).toString(h);for(var p=parseInt(u),x=u&&u[0]+""=="0"?"0":" ";m.length<p;)m=c!==void 0?m+x:x+m;return m}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,s)},t.getBytes=function(e,r){return Bd.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=jo.SJIS.getName(),t.GB2312="GB2312",t.ISO88591=jo.ISO8859_1.getName(),t.EUC_JP="EUC_JP",t.UTF8=jo.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t}(),Zn=function(){function t(e){e===void 0&&(e=""),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=ba.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var a=r;r<r+n;a++)this.append(e[a]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=""},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t}(),lh=function(){function t(e,r,n,a){if(this.width=e,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=e),this.height=r,e<1||r<1)throw new Pn("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,a=new t(n,r),s=0;s<r;s++)for(var o=e[s],l=0;l<n;l++)o[l]&&a.set(l,s);return a},t.parseFromString=function(e,r,n){if(e===null)throw new Pn("stringRepresentation cannot be null");for(var a=new Array(e.length),s=0,o=0,l=-1,c=0,u=0;u<e.length;)if(e.charAt(u)===`
`||e.charAt(u)==="\r"){if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");o=s,c++}u++}else if(e.substring(u,u+r.length)===r)u+=r.length,a[s]=!0,s++;else if(e.substring(u,u+n.length)===n)u+=n.length,a[s]=!1,s++;else throw new Pn("illegal character encountered: "+e.substring(u));if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");c++}for(var d=new t(l,c),f=0;f<s;f++)a[f]&&d.set(Math.floor(f%l),Math.floor(f/l));return d},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new Pn("input matrix dimensions do not match");for(var r=new el(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,s=0,o=this.height;s<o;s++)for(var l=s*n,c=e.getRow(s,r).getBitArray(),u=0;u<n;u++)a[l+u]^=c[u]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,a){if(r<0||e<0)throw new Pn("Left and top must be nonnegative");if(a<1||n<1)throw new Pn("Height and width must be at least 1");var s=e+n,o=r+a;if(o>this.height||s>this.width)throw new Pn("The region must fit inside the matrix");for(var l=this.rowSize,c=this.bits,u=r;u<o;u++)for(var d=u*l,f=e;f<s;f++)c[d+Math.floor(f/32)]|=1<<(f&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new el(this.width):r.clear();for(var n=this.rowSize,a=this.bits,s=e*n,o=0;o<n;o++)r.setBulk(o*32,a[s+o]);return r},t.prototype.setRow=function(e,r){ws.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new el(e),a=new el(e),s=0,o=Math.floor((r+1)/2);s<o;s++)n=this.getRow(s,n),a=this.getRow(r-1-s,a),n.reverse(),a.reverse(),this.setRow(s,a),this.setRow(r-1-s,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,a=this.bits,s=e,o=r,l=-1,c=-1,u=0;u<r;u++)for(var d=0;d<n;d++){var f=a[u*n+d];if(f!==0){if(u<o&&(o=u),u>c&&(c=u),d*32<s){for(var A=0;!(f<<31-A&4294967295);)A++;d*32+A<s&&(s=d*32+A)}if(d*32+31>l){for(var A=31;!(f>>>A);)A--;d*32+A>l&&(l=d*32+A)}}}return l<s||c<o?null:Int32Array.from([s,o,l-s+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var a=n/e,s=n%e*32,o=r[n],l=0;!(o<<31-l&4294967295);)l++;return s+=l,Int32Array.from([s,a])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),s=Math.floor(n%e)*32,o=r[n],l=31;!(o>>>l);)l--;return s+=l,Int32Array.from([s,a])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Bo.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e="X "),r===void 0&&(r="  "),n===void 0&&(n=`
`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var a=new Zn,s=0,o=this.height;s<o;s++){for(var l=0,c=this.width;l<c;l++)a.append(this.get(l,s)?e:r);a.append(n)}return a.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t}(),MLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ur=function(t){MLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(cu),LLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ULe=function(t){LLe(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var a=this.getLuminanceSource(),s=a.getWidth();n==null||n.getSize()<s?n=new el(s):n.clear(),this.initArrays(s);for(var o=a.getRow(r,this.luminances),l=this.buckets,c=0;c<s;c++)l[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(l);if(s<3)for(var c=0;c<s;c++)(o[c]&255)<u&&n.set(c);else for(var d=o[0]&255,f=o[1]&255,c=1;c<s-1;c++){var A=o[c+1]&255;(f*4-d-A)/2<u&&n.set(c),d=f,f=A}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight(),s=new lh(n,a);this.initArrays(n);for(var o=this.buckets,l=1;l<5;l++)for(var c=Math.floor(a*l/5),u=r.getRow(c,this.luminances),d=Math.floor(n*4/5),f=Math.floor(n/5);f<d;f++){var A=u[f]&255;o[A>>e.LUMINANCE_SHIFT]++}for(var h=e.estimateBlackPoint(o),m=r.getMatrix(),l=0;l<a;l++)for(var p=l*n,f=0;f<n;f++){var A=m[p+f]&255;A<h&&s.set(f,l)}return s},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(r){for(var n=r.length,a=0,s=0,o=0,l=0;l<n;l++)r[l]>o&&(s=l,o=r[l]),r[l]>a&&(a=r[l]);for(var c=0,u=0,l=0;l<n;l++){var d=l-s,f=r[l]*d*d;f>u&&(c=l,u=f)}if(s>c){var A=s;s=c,c=A}if(c-s<=n/16)throw new ur;for(var h=c-1,m=-1,l=c-1;l>s;l--){var p=l-s,f=p*p*(c-l)*(a-r[l]);f>m&&(h=l,m=f)}return h<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(BLe),QLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xse=function(t){QLe(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var s=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var l=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&l++;var c=e.calculateBlackPoints(s,o,l,n,a),u=new lh(n,a);e.calculateThresholdForBlock(s,o,l,n,a,c,u),this.matrix=u}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,a,s,o,l,c){for(var u=o-e.BLOCK_SIZE,d=s-e.BLOCK_SIZE,f=0;f<a;f++){var A=f<<e.BLOCK_SIZE_POWER;A>u&&(A=u);for(var h=e.cap(f,2,a-3),m=0;m<n;m++){var p=m<<e.BLOCK_SIZE_POWER;p>d&&(p=d);for(var x=e.cap(m,2,n-3),v=0,y=-2;y<=2;y++){var b=l[h+y];v+=b[x-2]+b[x-1]+b[x]+b[x+1]+b[x+2]}var w=v/25;e.thresholdBlock(r,p,A,w,s,c)}}},e.cap=function(r,n,a){return r<n?n:r>a?a:r},e.thresholdBlock=function(r,n,a,s,o,l){for(var c=0,u=a*o+n;c<e.BLOCK_SIZE;c++,u+=o)for(var d=0;d<e.BLOCK_SIZE;d++)(r[u+d]&255)<=s&&l.set(n+d,a+c)},e.calculateBlackPoints=function(r,n,a,s,o){for(var l=o-e.BLOCK_SIZE,c=s-e.BLOCK_SIZE,u=new Array(a),d=0;d<a;d++){u[d]=new Int32Array(n);var f=d<<e.BLOCK_SIZE_POWER;f>l&&(f=l);for(var A=0;A<n;A++){var h=A<<e.BLOCK_SIZE_POWER;h>c&&(h=c);for(var m=0,p=255,x=0,v=0,y=f*s+h;v<e.BLOCK_SIZE;v++,y+=s){for(var b=0;b<e.BLOCK_SIZE;b++){var w=r[y+b]&255;m+=w,w<p&&(p=w),w>x&&(x=w)}if(x-p>e.MIN_DYNAMIC_RANGE)for(v++,y+=s;v<e.BLOCK_SIZE;v++,y+=s)for(var b=0;b<e.BLOCK_SIZE;b++)m+=r[y+b]&255}var j=m>>e.BLOCK_SIZE_POWER*2;if(x-p<=e.MIN_DYNAMIC_RANGE&&(j=p/2,d>0&&A>0)){var I=(u[d-1][A]+2*u[d][A-1]+u[d-1][A-1])/4;p<I&&(j=I)}u[d][A]=j}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(ULe),Gw=function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,a){throw new xE("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new xE("This luminance source does not support rotation by 90 degrees.")},t.prototype.rotateCounterClockwise45=function(){throw new xE("This luminance source does not support rotation by 45 degrees.")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new Zn,n=0;n<this.height;n++){for(var a=this.getRow(n,e),s=0;s<this.width;s++){var o=a[s]&255,l=void 0;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",r.append(l)}r.append(`
`)}return r.toString()},t}(),VLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),gP=function(t){VLe(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var a=this.delegate.getRow(r,n),s=this.getWidth(),o=0;o<s;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),s=0;s<n;s++)a[s]=255-(r[s]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,a,s){return new e(this.delegate.crop(r,n,a,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Gw),HLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$Le=function(t){HLe(e,t);function e(r,n){n===void 0&&(n=!1);var a=t.call(this,r.width,r.height)||this;return a.canvas=r,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(r,n),a}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var a=r.getContext("2d").getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height,n)},e.toGrayscaleBuffer=function(r,n,a,s){s===void 0&&(s=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!s)for(var l=0,c=0,u=r.length;l<u;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=d}else for(var l=0,c=0,p=r.length;l<p;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=255-d}return o},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement(),a=n.getContext("2d"),s=r*e.DEGREE_TO_RADIANS,o=this.canvas.width,l=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(s))*o+Math.abs(Math.sin(s))*l),u=Math.ceil(Math.abs(Math.sin(s))*o+Math.abs(Math.cos(s))*l);return n.width=c,n.height=u,a.translate(c/2,u/2),a.rotate(s),a.drawImage(this.canvas,o/-2,l/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new gP(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(Gw),GLe=function(){function t(e,r,n){this.deviceId=e,this.label=r,this.kind="videoinput",this.groupId=n||void 0}return t.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},t}(),mc=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},pc=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},KLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},w1=function(){function t(e,r,n){r===void 0&&(r=500),this.reader=e,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(t.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),t.prototype.listVideoInputDevices=function(){return mc(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return pc(this,function(h){switch(h.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=KLe(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device "+(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.prototype.getVideoInputDevices=function(){return mc(this,void 0,void 0,function(){var e;return pc(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=r.sent(),[2,e.map(function(n){return new GLe(n.deviceId,n.label)})]}})})},t.prototype.findDeviceById=function(e){return mc(this,void 0,void 0,function(){var r;return pc(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2,null]}})})},t.prototype.decodeFromInputVideoDevice=function(e,r){return mc(this,void 0,void 0,function(){return pc(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return mc(this,void 0,void 0,function(){var n,a;return pc(this,function(s){switch(s.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return mc(this,void 0,void 0,function(){var n;return pc(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return mc(this,void 0,void 0,function(){var n,a;return pc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return n=s.sent(),[4,this.decodeOnce(n)];case 2:return a=s.sent(),[2,a]}})})},t.prototype.decodeFromInputVideoDeviceContinuously=function(e,r,n){return mc(this,void 0,void 0,function(){return pc(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,r,n)];case 1:return[2,a.sent()]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return mc(this,void 0,void 0,function(){var a,s;return pc(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return mc(this,void 0,void 0,function(){var a;return pc(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=s.sent(),[4,this.decodeFromStream(a,r,n)];case 2:return[2,s.sent()]}})})},t.prototype.decodeFromStream=function(e,r,n){return mc(this,void 0,void 0,function(){var a;return pc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return a=s.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,s.sent()]}})})},t.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},t.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},t.prototype.attachStreamToVideo=function(e,r){return mc(this,void 0,void 0,function(){var n;return pc(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(r),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},t.prototype.playVideoOnLoadAsync=function(e){var r=this;return new Promise(function(n,a){return r.playVideoOnLoad(e,function(){return n()})})},t.prototype.playVideoOnLoad=function(e,r){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",r),this.tryPlayVideo(e)},t.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},t.prototype.tryPlayVideo=function(e){return mc(this,void 0,void 0,function(){return pc(this,function(r){switch(r.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.play()];case 2:return r.sent(),[3,4];case 3:return r.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},t.prototype.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Qi("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Qi("element with id '"+e+"' must be an "+r+" element");return n},t.prototype.decodeFromImage=function(e,r){if(!e&&!r)throw new Qi("either imageElement with a src set or an url must be provided");return r&&!e?this.decodeFromImageUrl(r):this.decodeFromImageElement(e)},t.prototype.decodeFromVideo=function(e,r){if(!e&&!r)throw new Qi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(e)},t.prototype.decodeFromVideoContinuously=function(e,r,n){if(e===void 0&&r===void 0)throw new Qi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(e,n)},t.prototype.decodeFromImageElement=function(e){if(!e)throw new Qi("An image element must be provided.");this.reset();var r=this.prepareImageElement(e);this.imageElement=r;var n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n},t.prototype.decodeFromVideoElement=function(e){var r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(r)},t.prototype.decodeFromVideoElementContinuously=function(e,r){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,r)},t.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new Qi("A video element must be provided.");this.reset();var r=this.prepareVideoElement(e);return this.videoElement=r,r},t.prototype.decodeFromImageUrl=function(e){if(!e)throw new Qi("An URL must be provided.");this.reset();var r=this.prepareImageElement();this.imageElement=r;var n=this._decodeOnLoadImage(r);return r.src=e,n},t.prototype.decodeFromVideoUrl=function(e){if(!e)throw new Qi("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=e,n},t.prototype.decodeFromVideoUrlContinuously=function(e,r){if(!e)throw new Qi("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=e,a},t.prototype._decodeOnLoadImage=function(e){var r=this;return new Promise(function(n,a){r.imageLoadedListener=function(){return r.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",r.imageLoadedListener)})},t.prototype._decodeOnLoadVideo=function(e){return mc(this,void 0,void 0,function(){return pc(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return r.sent(),[4,this.decodeOnce(e)];case 2:return[2,r.sent()]}})})},t.prototype._decodeOnLoadVideoContinuously=function(e,r){return mc(this,void 0,void 0,function(){return pc(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,r),[2]}})})},t.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.prototype.prepareImageElement=function(e){var r;return typeof e>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(r=e),r},t.prototype.prepareVideoElement=function(e){var r;return!e&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(r=e),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.prototype.decodeOnce=function(e,r,n){var a=this;r===void 0&&(r=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var s=function(o,l){if(a._stopAsyncDecode){l(new ur("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var c=a.decode(e);o(c)}catch(A){var u=r&&A instanceof ur,d=A instanceof oo||A instanceof Hr,f=d&&n;if(u||f)return setTimeout(s,a._timeBetweenDecodingAttempts,o,l);l(A)}};return new Promise(function(o,l){return s(o,l)})},t.prototype.decodeContinuously=function(e,r){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var s=n.decode(e);r(s,null),setTimeout(a,n.timeBetweenScansMillis)}catch(c){r(null,c);var o=c instanceof oo||c instanceof Hr,l=c instanceof ur;(o||l)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},t.prototype.decode=function(e){var r=this.createBinaryBitmap(e);return this.decodeBitmap(r)},t.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var r=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),r=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new $Le(n,r),s=new xse(a);return new gse(s)},t.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var r=this.getCaptureCanvas(e),n=void 0;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},t.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var r=this.createCaptureCanvas(e);this.captureCanvas=r}return this.captureCanvas},t.prototype.drawFrameOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.drawImageOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},t.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var r=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r},t.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},t.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},t.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},t.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},t.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},t.prototype.addVideoSource=function(e,r){try{e.srcObject=r}catch{e.src=URL.createObjectURL(r)}},t.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},t}(),uc=function(){function t(e,r,n,a,s,o){n===void 0&&(n=r==null?0:8*r.length),o===void 0&&(o=ws.currentTimeMillis()),this.text=e,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=s,this.timestamp=o,this.text=e,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=s,this.resultMetadata=null,o==null?this.timestamp=ws.currentTimeMillis():this.timestamp=o}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(e,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,r)},t.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},t.prototype.addResultPoints=function(e){var r=this.resultPoints;if(r===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(r.length+e.length);ws.arraycopy(r,0,n,0,r.length),ws.arraycopy(e,0,n,r.length,e.length),this.resultPoints=n}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}(),oF;(function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(oF||(oF={}));const jn=oF;var lF;(function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(lF||(lF={}));const jl=lF;var xP=function(){function t(e,r,n,a,s,o){s===void 0&&(s=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(e){this.numBits=e},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(e){this.erasures=e},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(e){this.other=e},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t}(),Yy=function(){function t(){}return t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.addOrSubtract=function(e,r){return e^r},t}(),hm=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),ws.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var r=this.coefficients,n;if(e===1){n=0;for(var a=0,s=r.length;a!==s;a++){var o=r[a];n=Yy.addOrSubtract(n,o)}return n}n=r[0];for(var l=r.length,c=this.field,a=1;a<l;a++)n=Yy.addOrSubtract(c.multiply(e,n),r[a]);return n},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ws.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=Yy.addOrSubtract(r[l-o],n[l]);return new t(this.field,s)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=this.field,c=0;c<n;c++)for(var u=r[c],d=0;d<s;d++)o[c+d]=Yy.addOrSubtract(o[c+d],l.multiply(u,a[d]));return new t(l,o)},t.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var r=this.coefficients.length,n=this.field,a=new Int32Array(r),s=this.coefficients,o=0;o<r;o++)a[o]=n.multiply(s[o],e);return new t(n,a)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,s=new Int32Array(a+e),o=this.field,l=0;l<a;l++)s[l]=o.multiply(n[l],r);return new t(o,s)},t.prototype.divide=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new Pn("Divide by 0");for(var r=this.field,n=r.getZero(),a=this,s=e.getCoefficient(e.getDegree()),o=r.inverse(s);a.getDegree()>=e.getDegree()&&!a.isZero();){var l=a.getDegree()-e.getDegree(),c=r.multiply(a.getCoefficient(a.getDegree()),o),u=e.multiplyByMonomial(l,c),d=r.buildMonomial(l,c);n=n.addOrSubtract(d),a=a.addOrSubtract(u)}return[n,a]},t.prototype.toString=function(){for(var e="",r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),r===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}r!==0&&(r===1?e+="x":(e+="x^",e+=r))}}return e},t}(),qLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vse=function(t){qLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(cu),zLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jc=function(t){zLe(e,t);function e(r,n,a){var s=t.call(this)||this;s.primitive=r,s.size=n,s.generatorBase=a;for(var o=new Int32Array(n),l=1,c=0;c<n;c++)o[c]=l,l*=2,l>=n&&(l^=r,l&=n-1);s.expTable=o;for(var u=new Int32Array(n),c=0;c<n-1;c++)u[o[c]]=c;return s.logTable=u,s.zero=new hm(s,Int32Array.from([0])),s.one=new hm(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new hm(this,a)},e.prototype.inverse=function(r){if(r===0)throw new vse;return this.expTable[this.size-this.logTable[r]-1]},e.prototype.multiply=function(r,n){return r===0||n===0?0:this.expTable[(this.logTable[r]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+sa.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(r){return r===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(Yy),WLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),i_=function(t){WLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(cu),XLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kw=function(t){XLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(cu),vP=function(){function t(e){this.field=e}return t.prototype.decode=function(e,r){for(var n=this.field,a=new hm(n,e),s=new Int32Array(r),o=!0,l=0;l<r;l++){var c=a.evaluateAt(n.exp(l+n.getGeneratorBase()));s[s.length-1-l]=c,c!==0&&(o=!1)}if(!o)for(var u=new hm(n,s),d=this.runEuclideanAlgorithm(n.buildMonomial(r,1),u,r),f=d[0],A=d[1],h=this.findErrorLocations(f),m=this.findErrorMagnitudes(A,h),l=0;l<h.length;l++){var p=e.length-1-n.log(h[l]);if(p<0)throw new i_("Bad error location");e[p]=Jc.addOrSubtract(e[p],m[l])}},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=this.field,o=e,l=r,c=s.getZero(),u=s.getOne();l.getDegree()>=(n/2|0);){var d=o,f=c;if(o=l,c=u,o.isZero())throw new i_("r_{i-1} was zero");l=d;for(var A=s.getZero(),h=o.getCoefficient(o.getDegree()),m=s.inverse(h);l.getDegree()>=o.getDegree()&&!l.isZero();){var p=l.getDegree()-o.getDegree(),x=s.multiply(l.getCoefficient(l.getDegree()),m);A=A.addOrSubtract(s.buildMonomial(p,x)),l=l.addOrSubtract(o.multiplyByMonomial(p,x))}if(u=A.multiply(c).addOrSubtract(f),l.getDegree()>=o.getDegree())throw new Kw("Division algorithm failed to reduce polynomial?")}var v=u.getCoefficient(0);if(v===0)throw new i_("sigmaTilde(0) was zero");var y=s.inverse(v),b=u.multiplyScalar(y),w=l.multiplyScalar(y);return[b,w]},t.prototype.findErrorLocations=function(e){var r=e.getDegree();if(r===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(r),a=0,s=this.field,o=1;o<s.getSize()&&a<r;o++)e.evaluateAt(o)===0&&(n[a]=s.inverse(o),a++);if(a!==r)throw new i_("Error locator degree does not match number of roots");return n},t.prototype.findErrorMagnitudes=function(e,r){for(var n=r.length,a=new Int32Array(n),s=this.field,o=0;o<n;o++){for(var l=s.inverse(r[o]),c=1,u=0;u<n;u++)if(o!==u){var d=s.multiply(r[u],l),f=d&1?d&-2:d|1;c=s.multiply(c,f)}a[o]=s.multiply(e.evaluateAt(l),s.inverse(c)),s.getGeneratorBase()!==0&&(a[o]=s.multiply(a[o],l))}return a},t}(),gl;(function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"})(gl||(gl={}));var C$=function(){function t(){}return t.prototype.decode=function(e){this.ddata=e;var r=e.getBits(),n=this.extractBits(r),a=this.correctBits(n),s=t.convertBoolArrayToByteArray(a),o=t.getEncodedData(a),l=new xP(s,o,null,null);return l.setNumBits(a.length),l},t.highLevelDecode=function(e){return this.getEncodedData(e)},t.getEncodedData=function(e){for(var r=e.length,n=gl.UPPER,a=gl.UPPER,s="",o=0;o<r;)if(a===gl.BINARY){if(r-o<5)break;var l=t.readCode(e,o,5);if(o+=5,l===0){if(r-o<11)break;l=t.readCode(e,o,11)+31,o+=11}for(var c=0;c<l;c++){if(r-o<8){o=r;break}var u=t.readCode(e,o,8);s+=ba.castAsNonUtf8Char(u),o+=8}a=n}else{var d=a===gl.DIGIT?4:5;if(r-o<d)break;var u=t.readCode(e,o,d);o+=d;var f=t.getCharacter(a,u);f.startsWith("CTRL_")?(n=a,a=t.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(s+=f,a=n)}return s},t.getTable=function(e){switch(e){case"L":return gl.LOWER;case"P":return gl.PUNCT;case"M":return gl.MIXED;case"D":return gl.DIGIT;case"B":return gl.BINARY;case"U":default:return gl.UPPER}},t.getCharacter=function(e,r){switch(e){case gl.UPPER:return t.UPPER_TABLE[r];case gl.LOWER:return t.LOWER_TABLE[r];case gl.MIXED:return t.MIXED_TABLE[r];case gl.PUNCT:return t.PUNCT_TABLE[r];case gl.DIGIT:return t.DIGIT_TABLE[r];default:throw new Kw("Bad table")}},t.prototype.correctBits=function(e){var r,n;this.ddata.getNbLayers()<=2?(n=6,r=Jc.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=Jc.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=Jc.AZTEC_DATA_10):(n=12,r=Jc.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),s=e.length/n;if(s<a)throw new Hr;for(var o=e.length%n,l=new Int32Array(s),c=0;c<s;c++,o+=n)l[c]=t.readCode(e,o,n);try{var u=new vP(r);u.decode(l,s-a)}catch(x){throw new Hr(x)}for(var d=(1<<n)-1,f=0,c=0;c<a;c++){var A=l[c];if(A===0||A===d)throw new Hr;(A===1||A===d-1)&&f++}for(var h=new Array(a*n-f),m=0,c=0;c<a;c++){var A=l[c];if(A===1||A===d-1)h.fill(A>1,m,m+n-1),m+=n-1;else for(var p=n-1;p>=0;--p)h[m++]=(A&1<<p)!==0}return h},t.prototype.extractBits=function(e){var r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,s=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,r));if(r)for(var l=0;l<s.length;l++)s[l]=l;else for(var c=a+1+2*sa.truncDivision(sa.truncDivision(a,2)-1,15),u=a/2,d=sa.truncDivision(c,2),l=0;l<u;l++){var f=l+sa.truncDivision(l,15);s[u-l-1]=d-f-1,s[u+l]=d+f+1}for(var l=0,A=0;l<n;l++){for(var h=(n-l)*4+(r?9:12),m=l*2,p=a-1-m,x=0;x<h;x++)for(var v=x*2,y=0;y<2;y++)o[A+v+y]=e.get(s[m+y],s[m+x]),o[A+2*h+v+y]=e.get(s[m+x],s[p-y]),o[A+4*h+v+y]=e.get(s[p-y],s[p-x]),o[A+6*h+v+y]=e.get(s[p-x],s[m+y]);A+=h*8}return o},t.readCode=function(e,r,n){for(var a=0,s=r;s<r+n;s++)a<<=1,e[s]&&(a|=1);return a},t.readByte=function(e,r){var n=e.length-r;return n>=8?t.readCode(e,r,8):t.readCode(e,r,n)<<8-n},t.convertBoolArrayToByteArray=function(e){for(var r=new Uint8Array((e.length+7)/8),n=0;n<r.length;n++)r[n]=t.readByte(e,8*n);return r},t.prototype.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],t.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],t}(),ja=function(){function t(){}return t.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},t.distance=function(e,r,n,a){var s=e-n,o=r-a;return Math.sqrt(s*s+o*o)},t.sum=function(e){for(var r=0,n=0,a=e.length;n!==a;n++){var s=e[n];r+=s}return r},t}(),cF=function(){function t(){}return t.floatToIntBits=function(e){return e},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),dn=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*cF.floatToIntBits(this.x)+cF.floatToIntBits(this.y)},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.orderBestPatterns=function(e){var r=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),s,o,l;if(n>=r&&n>=a?(o=e[0],s=e[1],l=e[2]):a>=n&&a>=r?(o=e[1],s=e[0],l=e[2]):(o=e[2],s=e[0],l=e[1]),this.crossProductZ(s,o,l)<0){var c=s;s=l,l=c}e[0]=s,e[1]=o,e[2]=l},t.distance=function(e,r){return ja.distance(e.x,e.y,r.x,r.y)},t.crossProductZ=function(e,r,n){var a=r.x,s=r.y;return(n.x-a)*(e.y-s)-(n.y-s)*(e.x-a)},t}(),OR=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),YLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),JLe=function(t){YLe(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n)||this;return l.compact=a,l.nbDatablocks=s,l.nbLayers=o,l}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(OR),uF=function(){function t(e,r,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),r==null&&(r=t.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var s=r/2|0;if(this.leftInit=n-s,this.rightInit=n+s,this.upInit=a-s,this.downInit=a+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ur}return t.prototype.detect=function(){for(var e=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,s=!1,o=!0,l=!1,c=!1,u=!1,d=!1,f=!1,A=this.width,h=this.height;o;){o=!1;for(var m=!0;(m||!c)&&r<A;)m=this.containsBlackPoint(n,a,r,!1),m?(r++,o=!0,c=!0):c||r++;if(r>=A){s=!0;break}for(var p=!0;(p||!u)&&a<h;)p=this.containsBlackPoint(e,r,a,!0),p?(a++,o=!0,u=!0):u||a++;if(a>=h){s=!0;break}for(var x=!0;(x||!d)&&e>=0;)x=this.containsBlackPoint(n,a,e,!1),x?(e--,o=!0,d=!0):d||e--;if(e<0){s=!0;break}for(var v=!0;(v||!f)&&n>=0;)v=this.containsBlackPoint(e,r,n,!0),v?(n--,o=!0,f=!0):f||n--;if(n<0){s=!0;break}o&&(l=!0)}if(!s&&l){for(var y=r-e,b=null,w=1;b===null&&w<y;w++)b=this.getBlackPointOnSegment(e,a-w,e+w,a);if(b==null)throw new ur;for(var j=null,w=1;j===null&&w<y;w++)j=this.getBlackPointOnSegment(e,n+w,e+w,n);if(j==null)throw new ur;for(var I=null,w=1;I===null&&w<y;w++)I=this.getBlackPointOnSegment(r,n+w,r-w,n);if(I==null)throw new ur;for(var _=null,w=1;_===null&&w<y;w++)_=this.getBlackPointOnSegment(r,a-w,r-w,a);if(_==null)throw new ur;return this.centerEdges(_,b,I,j)}else throw new ur},t.prototype.getBlackPointOnSegment=function(e,r,n,a){for(var s=ja.round(ja.distance(e,r,n,a)),o=(n-e)/s,l=(a-r)/s,c=this.image,u=0;u<s;u++){var d=ja.round(e+u*o),f=ja.round(r+u*l);if(c.get(d,f))return new dn(d,f)}return null},t.prototype.centerEdges=function(e,r,n,a){var s=e.getX(),o=e.getY(),l=r.getX(),c=r.getY(),u=n.getX(),d=n.getY(),f=a.getX(),A=a.getY(),h=t.CORR;return s<this.width/2?[new dn(f-h,A+h),new dn(l+h,c+h),new dn(u-h,d-h),new dn(s+h,o-h)]:[new dn(f+h,A+h),new dn(l+h,c-h),new dn(u-h,d+h),new dn(s-h,o-h)]},t.prototype.containsBlackPoint=function(e,r,n,a){var s=this.image;if(a){for(var o=e;o<=r;o++)if(s.get(o,n))return!0}else for(var l=e;l<=r;l++)if(s.get(n,l))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t}(),_$=function(){function t(){}return t.checkAndNudgePoints=function(e,r){for(var n=e.getWidth(),a=e.getHeight(),s=!0,o=0;o<r.length&&s;o+=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new ur;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}s=!0;for(var o=r.length-2;o>=0&&s;o-=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new ur;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}},t}(),yse=function(){function t(e,r,n,a,s,o,l,c,u){this.a11=e,this.a21=r,this.a31=n,this.a12=a,this.a22=s,this.a32=o,this.a13=l,this.a23=c,this.a33=u}return t.quadrilateralToQuadrilateral=function(e,r,n,a,s,o,l,c,u,d,f,A,h,m,p,x){var v=t.quadrilateralToSquare(e,r,n,a,s,o,l,c),y=t.squareToQuadrilateral(u,d,f,A,h,m,p,x);return y.times(v)},t.prototype.transformPoints=function(e){for(var r=e.length,n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=0;A<r;A+=2){var h=e[A],m=e[A+1],p=s*h+c*m+f;e[A]=(n*h+o*m+u)/p,e[A+1]=(a*h+l*m+d)/p}},t.prototype.transformPointsWithValues=function(e,r){for(var n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=e.length,h=0;h<A;h++){var m=e[h],p=r[h],x=s*m+c*p+f;e[h]=(n*m+o*p+u)/x,r[h]=(a*m+l*p+d)/x}},t.squareToQuadrilateral=function(e,r,n,a,s,o,l,c){var u=e-n+s-l,d=r-a+o-c;if(u===0&&d===0)return new t(n-e,s-n,e,a-r,o-a,r,0,0,1);var f=n-s,A=l-s,h=a-o,m=c-o,p=f*m-A*h,x=(u*m-A*d)/p,v=(f*d-u*h)/p;return new t(n-e+x*n,l-e+v*l,e,a-r+x*a,c-r+v*c,r,x,v,1)},t.quadrilateralToSquare=function(e,r,n,a,s,o,l,c){return t.squareToQuadrilateral(e,r,n,a,s,o,l,c).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t}(),ZLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),eUe=function(t){ZLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sampleGrid=function(r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w){var j=yse.quadrilateralToQuadrilateral(s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w);return this.sampleGridWithTransform(r,n,a,j)},e.prototype.sampleGridWithTransform=function(r,n,a,s){if(n<=0||a<=0)throw new ur;for(var o=new lh(n,a),l=new Float32Array(2*n),c=0;c<a;c++){for(var u=l.length,d=c+.5,f=0;f<u;f+=2)l[f]=f/2+.5,l[f+1]=d;s.transformPoints(l),_$.checkAndNudgePoints(r,l);try{for(var f=0;f<u;f+=2)r.get(Math.floor(l[f]),Math.floor(l[f+1]))&&o.set(f/2,c)}catch{throw new ur}}return o},e}(_$),DR=function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new eUe,t}(),Gc=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.toResultPoint=function(){return new dn(this.getX(),this.getY())},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t}(),tUe=function(){function t(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return t.prototype.detect=function(){return this.detectMirror(!1)},t.prototype.detectMirror=function(e){var r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var s=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new JLe(s,o,this.compact,this.nbDataBlocks,this.nbLayers)},t.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new ur;var r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],r),this.sampleLine(e[1],e[2],r),this.sampleLine(e[2],e[3],r),this.sampleLine(e[3],e[0],r)]);this.shift=this.getRotation(n,r);for(var a=0,s=0;s<4;s++){var o=n[(this.shift+s)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var l=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)},t.prototype.getRotation=function(e,r){var n=0;e.forEach(function(s,o,l){var c=(s>>r-2<<1)+(s&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(sa.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new ur},t.prototype.getCorrectedParameterData=function(e,r){var n,a;r?(n=7,a=2):(n=10,a=4);for(var s=n-a,o=new Int32Array(n),l=n-1;l>=0;--l)o[l]=e&15,e>>=4;try{var c=new vP(Jc.AZTEC_PARAM);c.decode(o,s)}catch{throw new ur}for(var u=0,l=0;l<a;l++)u=(u<<4)+o[l];return u},t.prototype.getBullsEyeCorners=function(e){var r=e,n=e,a=e,s=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var l=this.getFirstDifferent(r,o,1,-1),c=this.getFirstDifferent(n,o,1,1),u=this.getFirstDifferent(a,o,-1,1),d=this.getFirstDifferent(s,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(d,l)*this.nbCenterLayers/(this.distancePoint(s,r)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(l,c,u,d))break}r=l,n=c,a=u,s=d,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ur;this.compact=this.nbCenterLayers===5;var A=new dn(r.getX()+.5,r.getY()-.5),h=new dn(n.getX()+.5,n.getY()+.5),m=new dn(a.getX()-.5,a.getY()+.5),p=new dn(s.getX()-.5,s.getY()-.5);return this.expandSquare([A,h,m,p],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},t.prototype.getMatrixCenter=function(){var e,r,n,a;try{var s=new uF(this.image).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{var o=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new Gc(o+7,l-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Gc(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Gc(o-7,l+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Gc(o-7,l-7),!1,-1,-1).toResultPoint()}var c=ja.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=ja.round((e.getY()+a.getY()+r.getY()+n.getY())/4);try{var s=new uF(this.image,15,c,u).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{e=this.getFirstDifferent(new Gc(c+7,u-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Gc(c+7,u+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Gc(c-7,u+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Gc(c-7,u-7),!1,-1,-1).toResultPoint()}return c=ja.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=ja.round((e.getY()+a.getY()+r.getY()+n.getY())/4),new Gc(c,u)},t.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},t.prototype.sampleGrid=function(e,r,n,a,s){var o=DR.getInstance(),l=this.getDimension(),c=l/2-this.nbCenterLayers,u=l/2+this.nbCenterLayers;return o.sampleGrid(e,l,l,c,c,u,c,u,u,c,u,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),s.getX(),s.getY())},t.prototype.sampleLine=function(e,r,n){for(var a=0,s=this.distanceResultPoint(e,r),o=s/n,l=e.getX(),c=e.getY(),u=o*(r.getX()-e.getX())/s,d=o*(r.getY()-e.getY())/s,f=0;f<n;f++)this.image.get(ja.round(l+f*u),ja.round(c+f*d))&&(a|=1<<n-f-1);return a},t.prototype.isWhiteOrBlackRectangle=function(e,r,n,a){var s=3;e=new Gc(e.getX()-s,e.getY()+s),r=new Gc(r.getX()-s,r.getY()-s),n=new Gc(n.getX()+s,n.getY()-s),a=new Gc(a.getX()+s,a.getY()+s);var o=this.getColor(a,e);if(o===0)return!1;var l=this.getColor(e,r);return l!==o||(l=this.getColor(r,n),l!==o)?!1:(l=this.getColor(n,a),l===o)},t.prototype.getColor=function(e,r){for(var n=this.distancePoint(e,r),a=(r.getX()-e.getX())/n,s=(r.getY()-e.getY())/n,o=0,l=e.getX(),c=e.getY(),u=this.image.get(e.getX(),e.getY()),d=Math.ceil(n),f=0;f<d;f++)l+=a,c+=s,this.image.get(ja.round(l),ja.round(c))!==u&&o++;var A=o/n;return A>.1&&A<.9?0:A<=.1===u?1:-1},t.prototype.getFirstDifferent=function(e,r,n,a){for(var s=e.getX()+n,o=e.getY()+a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n,o+=a;for(s-=n,o-=a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n;for(s-=n;this.isValid(s,o)&&this.image.get(s,o)===r;)o+=a;return o-=a,new Gc(s,o)},t.prototype.expandSquare=function(e,r,n){var a=n/(2*r),s=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),l=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,u=new dn(l+a*s,c+a*o),d=new dn(l-a*s,c-a*o);s=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),l=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var f=new dn(l+a*s,c+a*o),A=new dn(l-a*s,c-a*o),h=[u,f,d,A];return h},t.prototype.isValid=function(e,r){return e>=0&&e<this.image.getWidth()&&r>0&&r<this.image.getHeight()},t.prototype.isValidPoint=function(e){var r=ja.round(e.getX()),n=ja.round(e.getY());return this.isValid(r,n)},t.prototype.distancePoint=function(e,r){return ja.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.distanceResultPoint=function(e,r){return ja.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(sa.truncDivision(this.nbLayers-4,8)+1)+15},t}(),ZS=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=null,a=new tUe(e.getBlackMatrix()),s=null,o=null;try{var l=a.detectMirror(!1);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new C$().decode(l)}catch(f){n=f}if(o==null)try{var l=a.detectMirror(!0);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new C$().decode(l)}catch(f){throw n??f}var c=new uc(o.getText(),o.getRawBytes(),o.getNumBits(),s,jn.AZTEC,ws.currentTimeMillis()),u=o.getByteSegments();u!=null&&c.putMetadata(jl.BYTE_SEGMENTS,u);var d=o.getECLevel();return d!=null&&c.putMetadata(jl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reportFoundResultPoints=function(e,r){if(e!=null){var n=e.get(Ns.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach(function(a,s,o){n.foundPossibleResultPoint(a)})}},t.prototype.reset=function(){},t}(),rUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){rUe(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new ZS,r)||this}return e})(w1);var ko=function(){function t(){}return t.prototype.decode=function(e,r){try{return this.doDecode(e,r)}catch{var n=r&&r.get(Ns.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),s=this.doDecode(a,r),o=s.getResultMetadata(),l=270;o!==null&&o.get(jl.ORIENTATION)===!0&&(l=l+o.get(jl.ORIENTATION)%360),s.putMetadata(jl.ORIENTATION,l);var c=s.getResultPoints();if(c!==null)for(var u=a.getHeight(),d=0;d<c.length;d++)c[d]=new dn(u-c[d].getY()-1,c[d].getX());return s}else throw new ur}},t.prototype.reset=function(){},t.prototype.doDecode=function(e,r){var n=e.getWidth(),a=e.getHeight(),s=new el(n),o=r&&r.get(Ns.TRY_HARDER)===!0,l=Math.max(1,a>>(o?8:5)),c;o?c=a:c=15;for(var u=Math.trunc(a/2),d=0;d<c;d++){var f=Math.trunc((d+1)/2),A=(d&1)===0,h=u+l*(A?f:-f);if(h<0||h>=a)break;try{s=e.getBlackRow(h,s)}catch{continue}for(var m=function(y){if(y===1&&(s.reverse(),r&&r.get(Ns.NEED_RESULT_POINT_CALLBACK)===!0)){var b=new Map;r.forEach(function(I,_){return b.set(_,I)}),b.delete(Ns.NEED_RESULT_POINT_CALLBACK),r=b}try{var w=p.decodeRow(h,s,r);if(y===1){w.putMetadata(jl.ORIENTATION,180);var j=w.getResultPoints();j!==null&&(j[0]=new dn(n-j[0].getX()-1,j[0].getY()),j[1]=new dn(n-j[1].getX()-1,j[1].getY()))}return{value:w}}catch{}},p=this,x=0;x<2;x++){var v=m(x);if(typeof v=="object")return v.value}}throw new ur},t.recordPattern=function(e,r,n){for(var a=n.length,s=0;s<a;s++)n[s]=0;var o=e.getSize();if(r>=o)throw new ur;for(var l=!e.get(r),c=0,u=r;u<o;){if(e.get(u)!==l)n[c]++;else{if(++c===a)break;n[c]=1,l=!l}u++}if(!(c===a||c===a-1&&u===o))throw new ur},t.recordPatternInReverse=function(e,r,n){for(var a=n.length,s=e.get(r);r>0&&a>=0;)e.get(--r)!==s&&(a--,s=!s);if(a>=0)throw new ur;t.recordPattern(e,r+1,n)},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return Number.POSITIVE_INFINITY;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return Number.POSITIVE_INFINITY;u+=h}return u/s},t}(),nUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),E$=function(t){nUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.findStartPattern=function(r){for(var n=r.getSize(),a=r.getNextSet(0),s=0,o=Int32Array.from([0,0,0,0,0,0]),l=a,c=!1,u=6,d=a;d<n;d++)if(r.get(d)!==c)o[s]++;else{if(s===u-1){for(var f=e.MAX_AVG_VARIANCE,A=-1,h=e.CODE_START_A;h<=e.CODE_START_C;h++){var m=ko.patternMatchVariance(o,e.CODE_PATTERNS[h],e.MAX_INDIVIDUAL_VARIANCE);m<f&&(f=m,A=h)}if(A>=0&&r.isRange(Math.max(0,l-(d-l)/2),l,!1))return Int32Array.from([l,d,A]);l+=o[0]+o[1],o=o.slice(2,o.length),o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,c=!c}throw new ur},e.decodeCode=function(r,n,a){ko.recordPattern(r,a,n);for(var s=e.MAX_AVG_VARIANCE,o=-1,l=0;l<e.CODE_PATTERNS.length;l++){var c=e.CODE_PATTERNS[l],u=this.patternMatchVariance(n,c,e.MAX_INDIVIDUAL_VARIANCE);u<s&&(s=u,o=l)}if(o>=0)return o;throw new ur},e.prototype.decodeRow=function(r,n,a){var s=a&&a.get(Ns.ASSUME_GS1)===!0,o=e.findStartPattern(n),l=o[2],c=0,u=new Uint8Array(20);u[c++]=l;var d;switch(l){case e.CODE_START_A:d=e.CODE_CODE_A;break;case e.CODE_START_B:d=e.CODE_CODE_B;break;case e.CODE_START_C:d=e.CODE_CODE_C;break;default:throw new Hr}for(var f=!1,A=!1,h="",m=o[0],p=o[1],x=Int32Array.from([0,0,0,0,0,0]),v=0,y=0,b=l,w=0,j=!0,I=!1,_=!1;!f;){var S=A;switch(A=!1,v=y,y=e.decodeCode(n,x,p),u[c++]=y,y!==e.CODE_STOP&&(j=!0),y!==e.CODE_STOP&&(w++,b+=w*y),m=p,p+=x.reduce(function(ue,me){return ue+me},0),y){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new Hr}switch(d){case e.CODE_CODE_A:if(y<64)_===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),_=!1;else if(y<96)_===I?h+=String.fromCharCode(y-64):h+=String.fromCharCode(y+64),_=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!I&&_?(I=!0,_=!1):I&&_?(I=!1,_=!1):_=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_B;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(y<96)_===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),_=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!I&&_?(I=!0,_=!1):I&&_?(I=!1,_=!1):_=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_A;break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(y<100)y<10&&(h+="0"),h+=y;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}S&&(d=d===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var E=p-m;if(p=n.getNextUnset(p),!n.isRange(p,Math.min(n.getSize(),p+(p-m)/2),!1))throw new ur;if(b-=w*v,b%103!==v)throw new oo;var B=h.length;if(B===0)throw new ur;B>0&&j&&(d===e.CODE_CODE_C?h=h.substring(0,B-2):h=h.substring(0,B-1));for(var T=(o[1]+o[0])/2,P=m+E/2,O=u.length,z=new Uint8Array(O),ce=0;ce<O;ce++)z[ce]=u[ce];var de=[new dn(T,r),new dn(P,r)];return new uc(h,z,0,de,jn.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(ko),aUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Q5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},S$=function(t){aUe(e,t);function e(r,n){r===void 0&&(r=!1),n===void 0&&(n=!1);var a=t.call(this)||this;return a.usingCheckDigit=r,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.counters;u.fill(0),this.decodeRowResult="";var d=e.findAsteriskPattern(n,u),f=n.getNextSet(d[1]),A=n.getSize(),h,m;do{e.recordPattern(n,f,u);var p=e.toNarrowWidePattern(u);if(p<0)throw new ur;h=e.patternToChar(p),this.decodeRowResult+=h,m=f;try{for(var x=(s=void 0,Q5(u)),v=x.next();!v.done;v=x.next()){var y=v.value;f+=y}}catch(O){s={error:O}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}f=n.getNextSet(f)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=Q5(u),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(O){l={error:O}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}var I=f-m-b;if(f!==A&&I*2<b)throw new ur;if(this.usingCheckDigit){for(var _=this.decodeRowResult.length-1,S=0,E=0;E<_;E++)S+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(E));if(this.decodeRowResult.charAt(_)!==e.ALPHABET_STRING.charAt(S%43))throw new oo;this.decodeRowResult=this.decodeRowResult.substring(0,_)}if(this.decodeRowResult.length===0)throw new ur;var B;this.extendedMode?B=e.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;var T=(d[1]+d[0])/2,P=m+b/2;return new uc(B,null,0,[new dn(T,r),new dn(P,r)],jn.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(r,n){for(var a=r.getSize(),s=r.getNextSet(0),o=0,l=s,c=!1,u=n.length,d=s;d<a;d++)if(r.get(d)!==c)n[o]++;else{if(o===u-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&r.isRange(Math.max(0,l-Math.floor((d-l)/2)),l,!1))return[l,d];l+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,c=!c}throw new ur},e.toNarrowWidePattern=function(r){var n,a,s=r.length,o=0,l;do{var c=2147483647;try{for(var u=(n=void 0,Q5(r)),d=u.next();!d.done;d=u.next()){var f=d.value;f<c&&f>o&&(c=f)}}catch(p){n={error:p}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o=c,l=0;for(var A=0,h=0,m=0;m<s;m++){var f=r[m];f>o&&(h|=1<<s-1-m,l++,A+=f)}if(l===3){for(var m=0;m<s&&l>0;m++){var f=r[m];if(f>o&&(l--,f*2>=A))return-1}return h}}while(l>3);return-1},e.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);if(r===e.ASTERISK_ENCODING)return"*";throw new ur},e.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o==="+"||o==="$"||o==="%"||o==="/"){var l=r.charAt(s+1),c="\0";switch(o){case"+":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Hr;break;case"$":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Hr;break;case"%":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l==="X"||l==="Y"||l==="Z")c="";else throw new Hr;break;case"/":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Hr;break}a+=c,s++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(ko),sUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),V5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},I$=function(t){sUe(e,t);function e(){var r=t.call(this)||this;return r.decodeRowResult="",r.counters=new Int32Array(6),r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.findAsteriskPattern(n),d=n.getNextSet(u[1]),f=n.getSize(),A=this.counters;A.fill(0),this.decodeRowResult="";var h,m;do{e.recordPattern(n,d,A);var p=this.toPattern(A);if(p<0)throw new ur;h=this.patternToChar(p),this.decodeRowResult+=h,m=d;try{for(var x=(s=void 0,V5(A)),v=x.next();!v.done;v=x.next()){var y=v.value;d+=y}}catch(E){s={error:E}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}d=n.getNextSet(d)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=V5(A),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(E){l={error:E}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}if(d===f||!n.get(d))throw new ur;if(this.decodeRowResult.length<2)throw new ur;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var I=this.decodeExtended(this.decodeRowResult),_=(u[1]+u[0])/2,S=m+b/2;return new uc(I,null,0,[new dn(_,r),new dn(S,r)],jn.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(r){var n=r.getSize(),a=r.getNextSet(0);this.counters.fill(0);for(var s=this.counters,o=a,l=!1,c=s.length,u=0,d=a;d<n;d++)if(r.get(d)!==l)s[u]++;else{if(u===c-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([o,d]);o+=s[0]+s[1],s.copyWithin(0,2,2+u-1),s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,l=!l}throw new ur},e.prototype.toPattern=function(r){var n,a,s=0;try{for(var o=V5(r),l=o.next();!l.done;l=o.next()){var c=l.value;s+=c}}catch(m){n={error:m}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var u=0,d=r.length,f=0;f<d;f++){var A=Math.round(r[f]*9/s);if(A<1||A>4)return-1;if(f&1)u<<=A;else for(var h=0;h<A;h++)u=u<<1|1}return u},e.prototype.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);throw new ur},e.prototype.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o>="a"&&o<="d"){if(s>=n-1)throw new Hr;var l=r.charAt(s+1),c="\0";switch(o){case"d":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Hr;break;case"a":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Hr;break;case"b":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l>="X"&&l<="Z")c="";else throw new Hr;break;case"c":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Hr;break}a+=c,s++}else a+=o}return a},e.prototype.checkChecksums=function(r){var n=r.length;this.checkOneChecksum(r,n-2,20),this.checkOneChecksum(r,n-1,15)},e.prototype.checkOneChecksum=function(r,n,a){for(var s=1,o=0,l=n-1;l>=0;l--)o+=s*e.ALPHABET_STRING.indexOf(r.charAt(l)),++s>a&&(s=1);if(r.charAt(n)!==e.ALPHABET_STRING[o%47])throw new oo},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(ko),iUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},j$=function(t){iUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return e.prototype.decodeRow=function(r,n,a){var s,o,l=this.decodeStart(n),c=this.decodeEnd(n),u=new Zn;e.decodeMiddle(n,l[1],c[0],u);var d=u.toString(),f=null;a!=null&&(f=a.get(Ns.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var A=d.length,h=!1,m=0;try{for(var p=oUe(f),x=p.next();!x.done;x=p.next()){var v=x.value;if(A===v){h=!0;break}v>m&&(m=v)}}catch(w){s={error:w}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}if(!h&&A>m&&(h=!0),!h)throw new Hr;var y=[new dn(l[1],r),new dn(c[0],r)],b=new uc(d,null,0,y,jn.ITF,new Date().getTime());return b},e.decodeMiddle=function(r,n,a,s){var o=new Int32Array(10),l=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),l.fill(0),c.fill(0);n<a;){ko.recordPattern(r,n,o);for(var u=0;u<5;u++){var d=2*u;l[u]=o[d],c[u]=o[d+1]}var f=e.decodeDigit(l);s.append(f.toString()),f=this.decodeDigit(c),s.append(f.toString()),o.forEach(function(A){n+=A})}},e.prototype.decodeStart=function(r){var n=e.skipWhiteSpace(r),a=e.findGuardPattern(r,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a},e.prototype.validateQuietZone=function(r,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var s=n-1;a>0&&s>=0&&!r.get(s);s--)a--;if(a!==0)throw new ur},e.skipWhiteSpace=function(r){var n=r.getSize(),a=r.getNextSet(0);if(a===n)throw new ur;return a},e.prototype.decodeEnd=function(r){r.reverse();try{var n=e.skipWhiteSpace(r),a=void 0;try{a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof ur&&(a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);var s=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-s,a}finally{r.reverse()}},e.findGuardPattern=function(r,n,a){var s=a.length,o=new Int32Array(s),l=r.getSize(),c=!1,u=0,d=n;o.fill(0);for(var f=n;f<l;f++)if(r.get(f)!==c)o[u]++;else{if(u===s-1){if(ko.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[d,f];d+=o[0]+o[1],ws.arraycopy(o,2,o,0,u-1),o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,c=!c}throw new ur},e.decodeDigit=function(r){for(var n=e.MAX_AVG_VARIANCE,a=-1,s=e.PATTERNS.length,o=0;o<s;o++){var l=e.PATTERNS[o],c=ko.patternMatchVariance(r,l,e.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,a=o):c===n&&(a=-1)}if(a>=0)return a%10;throw new ur},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(ko),lUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hv=function(t){lUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.decodeRowStringBuffer="",r}return e.findStartGuardPattern=function(r){for(var n=!1,a,s=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(r,s,!1,this.START_END_PATTERN,o);var l=a[0];s=a[1];var c=l-(s-l);c>=0&&(n=r.isRange(c,l,!1))}return a},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Hr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Hr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(r,n,a,s){return this.findGuardPattern(r,n,a,s,new Int32Array(s.length))},e.findGuardPattern=function(r,n,a,s,o){var l=r.getSize();n=a?r.getNextUnset(n):r.getNextSet(n);for(var c=0,u=n,d=s.length,f=a,A=n;A<l;A++)if(r.get(A)!==f)o[c]++;else{if(c===d-1){if(ko.patternMatchVariance(o,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([u,A]);u+=o[0]+o[1];for(var h=o.slice(2,o.length),m=0;m<c-1;m++)o[m]=h[m];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,f=!f}throw new ur},e.decodeDigit=function(r,n,a,s){this.recordPattern(r,a,n);for(var o=this.MAX_AVG_VARIANCE,l=-1,c=s.length,u=0;u<c;u++){var d=s[u],f=ko.patternMatchVariance(n,d,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,l=u)}if(l>=0)return l;throw new ur},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(ko),cUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},uUe=function(){function t(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new dn((n[0]+n[1])/2,e),new dn(s,e)],u=new uc(o,null,0,c,jn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<5&&c<l;d++){var f=Hv.decodeDigit(e,o,c,Hv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,cUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<4-d),d!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==5)throw new ur;var p=this.determineCheckDigit(u);if(t.extensionChecksum(n.toString())!==p)throw new ur;return c},t.extensionChecksum=function(e){for(var r=e.length,n=0,a=r-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=r-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},t.prototype.determineCheckDigit=function(e){for(var r=0;r<10;r++)if(e===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new ur},t.parseExtensionString=function(e){if(e.length!==5)return null;var r=t.parseExtension5String(e);return r==null?null:new Map([[jl.SUGGESTED_PRICE,r]])},t.parseExtension5String=function(e){var r;switch(e.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),s=n%100,o=s<10?"0"+s:s.toString();return r+a+"."+o},t}(),dUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fUe=function(){function t(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new dn((n[0]+n[1])/2,e),new dn(s,e)],u=new uc(o,null,0,c,jn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<2&&c<l;d++){var f=Hv.decodeDigit(e,o,c,Hv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,dUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<1-d),d!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==2)throw new ur;if(parseInt(n.toString())%4!==u)throw new ur;return c},t.parseExtensionString=function(e){return e.length!==2?null:new Map([[jl.ISSUE_NUMBER,parseInt(e)]])},t}(),hUe=function(){function t(){}return t.decodeRow=function(e,r,n){var a=Hv.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new uUe;return s.decodeRow(e,r,a)}catch{var o=new fUe;return o.decodeRow(e,r,a)}},t.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),t}(),AUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_o=function(t){AUe(e,t);function e(){var r=t.call(this)||this;r.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(l){return Int32Array.from(l)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],s=new Int32Array(a.length),o=0;o<a.length;o++)s[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=s}return r}return e.prototype.decodeRow=function(r,n,a){var s=e.findStartGuardPattern(n),o=a==null?null:a.get(Ns.NEED_RESULT_POINT_CALLBACK);if(o!=null){var l=new dn((s[0]+s[1])/2,r);o.foundPossibleResultPoint(l)}var c=this.decodeMiddle(n,s,this.decodeRowStringBuffer),u=c.rowOffset,d=c.resultString;if(o!=null){var f=new dn(u,r);o.foundPossibleResultPoint(f)}var A=e.decodeEnd(n,u);if(o!=null){var h=new dn((A[0]+A[1])/2,r);o.foundPossibleResultPoint(h)}var m=A[1],p=m+(m-A[0]);if(p>=n.getSize()||!n.isRange(m,p,!1))throw new ur;var x=d.toString();if(x.length<8)throw new Hr;if(!e.checkChecksum(x))throw new oo;var v=(s[1]+s[0])/2,y=(A[1]+A[0])/2,b=this.getBarcodeFormat(),w=[new dn(v,r),new dn(y,r)],j=new uc(x,null,0,w,b,new Date().getTime()),I=0;try{var _=hUe.decodeRow(r,n,A[1]);j.putMetadata(jl.UPC_EAN_EXTENSION,_.getText()),j.putAllMetadata(_.getResultMetadata()),j.addResultPoints(_.getResultPoints()),I=_.getText().length}catch{}var S=a==null?null:a.get(Ns.ALLOWED_EAN_EXTENSIONS);if(S!=null){var E=!1;for(var B in S)if(I.toString()===B){E=!0;break}if(!E)throw new ur}return b===jn.EAN_13||jn.UPC_A,j},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Hr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Hr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(Hv),mUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),P$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dF=function(t){mUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0,h=0;h<6&&f<d;h++){var m=_o.decodeDigit(r,u,f,_o.L_AND_G_PATTERNS);a+=String.fromCharCode(48+m%10);try{for(var p=(s=void 0,P$(u)),x=p.next();!x.done;x=p.next()){var v=x.value;f+=v}}catch(j){s={error:j}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}m>=10&&(A|=1<<5-h)}a=e.determineFirstDigit(a,A);var y=_o.findGuardPattern(r,f,!0,_o.MIDDLE_PATTERN,new Int32Array(_o.MIDDLE_PATTERN.length).fill(0));f=y[1];for(var h=0;h<6&&f<d;h++){var m=_o.decodeDigit(r,u,f,_o.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var b=(l=void 0,P$(u)),w=b.next();!w.done;w=b.next()){var v=w.value;f+=v}}catch(_){l={error:_}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return jn.EAN_13},e.determineFirstDigit=function(r,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new ur},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(_o),pUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),B$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},T$=function(t){pUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0;A<4&&f<d;A++){var h=_o.decodeDigit(r,u,f,_o.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var m=(s=void 0,B$(u)),p=m.next();!p.done;p=m.next()){var x=p.value;f+=x}}catch(w){s={error:w}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(s)throw s.error}}}var v=_o.findGuardPattern(r,f,!0,_o.MIDDLE_PATTERN,new Int32Array(_o.MIDDLE_PATTERN.length).fill(0));f=v[1];for(var A=0;A<4&&f<d;A++){var h=_o.decodeDigit(r,u,f,_o.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var y=(l=void 0,B$(u)),b=y.next();!b.done;b=y.next()){var x=b.value;f+=x}}catch(I){l={error:I}}finally{try{b&&!b.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return jn.EAN_8},e}(_o),gUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),k$=function(t){gUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.ean13Reader=new dF,r}return e.prototype.getBarcodeFormat=function(){return jn.UPC_A},e.prototype.decode=function(r,n){return this.maybeReturnResult(this.ean13Reader.decode(r))},e.prototype.decodeRow=function(r,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,n,a))},e.prototype.decodeMiddle=function(r,n,a){return this.ean13Reader.decodeMiddle(r,n,a)},e.prototype.maybeReturnResult=function(r){var n=r.getText();if(n.charAt(0)==="0"){var a=new uc(n.substring(1),null,null,r.getResultPoints(),jn.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new ur},e.prototype.reset=function(){this.ean13Reader.reset()},e}(_o),xUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},F$=function(t){xUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=new Int32Array(4),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l=this.decodeMiddleCounters.map(function(x){return x});l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=r.getSize(),u=n[1],d=0,f=0;f<6&&u<c;f++){var A=e.decodeDigit(r,l,u,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);try{for(var h=(s=void 0,vUe(l)),m=h.next();!m.done;m=h.next()){var p=m.value;u+=p}}catch(x){s={error:x}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(s)throw s.error}}A>=10&&(d|=1<<5-f)}return e.determineNumSysAndCheckDigit(new Zn(a),d),u},e.prototype.decodeEnd=function(r,n){return e.findGuardPatternWithoutCounters(r,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(r){return _o.checkChecksum(e.convertUPCEtoUPCA(r))},e.determineNumSysAndCheckDigit=function(r,n){for(var a=0;a<=1;a++)for(var s=0;s<10;s++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][s]){r.insert(0,"0"+a),r.append("0"+s);return}throw ur.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return jn.UPC_E},e.convertUPCEtoUPCA=function(r){var n=r.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new Zn;a.append(r.charAt(0));var s=n[5];switch(s){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(s),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(s);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(_o),yUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),O$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H5=function(t){yUe(e,t);function e(r){var n=t.call(this)||this,a=r==null?null:r.get(Ns.POSSIBLE_FORMATS),s=[];return a!=null&&(a.indexOf(jn.EAN_13)>-1&&s.push(new dF),a.indexOf(jn.UPC_A)>-1&&s.push(new k$),a.indexOf(jn.EAN_8)>-1&&s.push(new T$),a.indexOf(jn.UPC_E)>-1&&s.push(new F$)),s.length===0&&(s.push(new dF),s.push(new k$),s.push(new T$),s.push(new F$)),n.readers=s,n}return e.prototype.decodeRow=function(r,n,a){var s,o;try{for(var l=O$(this.readers),c=l.next();!c.done;c=l.next()){var u=c.value;try{var d=u.decodeRow(r,n,a),f=d.getBarcodeFormat()===jn.EAN_13&&d.getText().charAt(0)==="0",A=a==null?null:a.get(Ns.POSSIBLE_FORMATS),h=A==null||A.includes(jn.UPC_A);if(f&&h){var m=d.getRawBytes(),p=new uc(d.getText().substring(1),m,m?m.length:null,d.getResultPoints(),jn.UPC_A);return p.putAllMetadata(d.getResultMetadata()),p}return d}catch{}}}catch(x){s={error:x}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}throw new ur},e.prototype.reset=function(){var r,n;try{for(var a=O$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;o.reset()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}(ko),bUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wUe=function(t){bUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},r}return e.prototype.decodeRow=function(r,n,a){var s=this.getValidRowData(n);if(!s)throw new ur;var o=this.codaBarDecodeRow(s.row);if(!o)throw new ur;return new uc(o,null,0,[new dn(s.left,r),new dn(s.right,r)],jn.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(r){var n=r.toArray(),a=n.indexOf(!0);if(a===-1)return null;var s=n.lastIndexOf(!0);if(s<=a)return null;n=n.slice(a,s+1);for(var o=[],l=n[0],c=1,u=1;u<n.length;u++)n[u]===l?c++:(l=n[u],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:s}},e.prototype.codaBarDecodeRow=function(r){for(var n=[],a=Math.ceil(r.reduce(function(c,u){return(c+u)/2},0));r.length>0;){var s=r.splice(0,8).splice(0,7),o=s.map(function(c){return c<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var l=n.join("");return this.validCodaBarString(l)?l:null},e.prototype.validCodaBarString=function(r){var n=/^[A-D].{1,}[A-D]$/;return n.test(r)},e}(ko),NUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),CUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},up=function(t){NUe(e,t);function e(){var r=t.call(this)||this;return r.decodeFinderCounters=new Int32Array(4),r.dataCharacterCounters=new Int32Array(8),r.oddRoundingErrors=new Array(4),r.evenRoundingErrors=new Array(4),r.oddCounts=new Array(r.dataCharacterCounters.length/2),r.evenCounts=new Array(r.dataCharacterCounters.length/2),r}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(r,n){for(var a=0;a<n.length;a++)if(ko.patternMatchVariance(r,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new ur},e.count=function(r){return ja.sum(new Int32Array(r))},e.increment=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]>s&&(s=n[o],a=o);r[a]++},e.decrement=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]<s&&(s=n[o],a=o);r[a]--},e.isFinderPattern=function(r){var n,a,s=r[0]+r[1],o=s+r[2]+r[3],l=s/o;if(l>=e.MIN_FINDER_PATTERN_RATIO&&l<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;try{for(var d=CUe(r),f=d.next();!f.done;f=d.next()){var A=f.value;A>u&&(u=A),A<c&&(c=A)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return u<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(ko),eI=function(){function t(e,r){this.value=e,this.checksumPortion=r}return t.prototype.getValue=function(){return this.value},t.prototype.getChecksumPortion=function(){return this.checksumPortion},t.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value&&this.checksumPortion===r.checksumPortion},t.prototype.hashCode=function(){return this.value^this.checksumPortion},t}(),bse=function(){function t(e,r,n,a,s){this.value=e,this.startEnd=r,this.value=e,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new dn(n,s)),this.resultPoints.push(new dn(a,s))}return t.prototype.getValue=function(){return this.value},t.prototype.getStartEnd=function(){return this.startEnd},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.hashCode=function(){return this.value},t}(),_Ue=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xx=function(){function t(){}return t.getRSSvalue=function(e,r,n){var a,s,o=0;try{for(var l=_Ue(e),c=l.next();!c.done;c=l.next()){var u=c.value;o+=u}}catch(y){a={error:y}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}for(var d=0,f=0,A=e.length,h=0;h<A-1;h++){var m=void 0;for(m=1,f|=1<<h;m<e[h];m++,f&=~(1<<h)){var p=t.combins(o-m-1,A-h-2);if(n&&f===0&&o-m-(A-h-1)>=A-h-1&&(p-=t.combins(o-m-(A-h),A-h-2)),A-h-1>1){for(var x=0,v=o-m-(A-h-2);v>r;v--)x+=t.combins(o-m-v-1,A-h-3);p-=x*(A-1-h)}else o-m>r&&p--;d+=p}o-=m}return d},t.combins=function(e,r){var n,a;e-r>r?(a=r,n=e-r):(a=e-r,n=r);for(var s=1,o=1,l=e;l>n;l--)s*=l,o<=a&&(s/=o,o++);for(;o<=a;)s/=o,o++;return s},t}(),EUe=function(){function t(){}return t.buildBitArray=function(e){var r=e.length*2-1;e[e.length-1].getRightChar()==null&&(r-=1);for(var n=12*r,a=new el(n),s=0,o=e[0],l=o.getRightChar().getValue(),c=11;c>=0;--c)l&1<<c&&a.set(s),s++;for(var c=1;c<e.length;++c){for(var u=e[c],d=u.getLeftChar().getValue(),f=11;f>=0;--f)d&1<<f&&a.set(s),s++;if(u.getRightChar()!==null)for(var A=u.getRightChar().getValue(),f=11;f>=0;--f)A&1<<f&&a.set(s),s++}return a},t}(),Jm=function(){function t(e,r){r?this.decodedInformation=null:(this.finished=e,this.decodedInformation=r)}return t.prototype.getDecodedInformation=function(){return this.decodedInformation},t.prototype.isFinished=function(){return this.finished},t}(),RR=function(){function t(e){this.newPosition=e}return t.prototype.getNewPosition=function(){return this.newPosition},t}(),SUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jd=function(t){SUe(e,t);function e(r,n){var a=t.call(this,r)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(RR),IUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zm=function(t){IUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return a?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=n,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(RR),jUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vx=function(t){jUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;if(n<0||n>10||a<0||a>10)throw new Hr;return s.firstDigit=n,s.secondDigit=a,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(RR),o_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},PUe=function(){function t(){}return t.parseFieldsInGeneralPurpose=function(e){var r,n,a,s,o,l,c,u;if(!e)return null;if(e.length<2)throw new ur;var d=e.substring(0,2);try{for(var f=o_(t.TWO_DIGIT_DATA_LENGTH),A=f.next();!A.done;A=f.next()){var h=A.value;if(h[0]===d)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(2,h[2],e):t.processFixedAI(2,h[1],e)}}catch(I){r={error:I}}finally{try{A&&!A.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}if(e.length<3)throw new ur;var m=e.substring(0,3);try{for(var p=o_(t.THREE_DIGIT_DATA_LENGTH),x=p.next();!x.done;x=p.next()){var h=x.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(3,h[2],e):t.processFixedAI(3,h[1],e)}}catch(I){a={error:I}}finally{try{x&&!x.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}try{for(var v=o_(t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),y=v.next();!y.done;y=v.next()){var h=y.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){o={error:I}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(o)throw o.error}}if(e.length<4)throw new ur;var b=e.substring(0,4);try{for(var w=o_(t.FOUR_DIGIT_DATA_LENGTH),j=w.next();!j.done;j=w.next()){var h=j.value;if(h[0]===b)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){c={error:I}}finally{try{j&&!j.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}throw new ur},t.processFixedAI=function(e,r,n){if(n.length<e)throw new ur;var a=n.substring(0,e);if(n.length<e+r)throw new ur;var s=n.substring(e,e+r),o=n.substring(e+r),l="("+a+")"+s,c=t.parseFieldsInGeneralPurpose(o);return c==null?l:l+c},t.processVariableAI=function(e,r,n){var a=n.substring(0,e),s;n.length<e+r?s=n.length:s=e+r;var o=n.substring(e,s),l=n.substring(s),c="("+a+")"+o,u=t.parseFieldsInGeneralPurpose(l);return u==null?c:c+u},t.VARIABLE_LENGTH=[],t.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",t.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",t.VARIABLE_LENGTH,20],["22",t.VARIABLE_LENGTH,29],["30",t.VARIABLE_LENGTH,8],["37",t.VARIABLE_LENGTH,8],["90",t.VARIABLE_LENGTH,30],["91",t.VARIABLE_LENGTH,30],["92",t.VARIABLE_LENGTH,30],["93",t.VARIABLE_LENGTH,30],["94",t.VARIABLE_LENGTH,30],["95",t.VARIABLE_LENGTH,30],["96",t.VARIABLE_LENGTH,30],["97",t.VARIABLE_LENGTH,3],["98",t.VARIABLE_LENGTH,30],["99",t.VARIABLE_LENGTH,30]],t.THREE_DIGIT_DATA_LENGTH=[["240",t.VARIABLE_LENGTH,30],["241",t.VARIABLE_LENGTH,30],["242",t.VARIABLE_LENGTH,6],["250",t.VARIABLE_LENGTH,30],["251",t.VARIABLE_LENGTH,30],["253",t.VARIABLE_LENGTH,17],["254",t.VARIABLE_LENGTH,20],["400",t.VARIABLE_LENGTH,30],["401",t.VARIABLE_LENGTH,30],["402",17],["403",t.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",t.VARIABLE_LENGTH,20],["421",t.VARIABLE_LENGTH,15],["422",3],["423",t.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",t.VARIABLE_LENGTH,15],["391",t.VARIABLE_LENGTH,18],["392",t.VARIABLE_LENGTH,15],["393",t.VARIABLE_LENGTH,18],["703",t.VARIABLE_LENGTH,30]],t.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",t.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",t.VARIABLE_LENGTH,20],["8003",t.VARIABLE_LENGTH,30],["8004",t.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",t.VARIABLE_LENGTH,30],["8008",t.VARIABLE_LENGTH,12],["8018",18],["8020",t.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",t.VARIABLE_LENGTH,70],["8200",t.VARIABLE_LENGTH,70]],t}(),vE=function(){function t(e){this.buffer=new Zn,this.information=e}return t.prototype.decodeAllCodes=function(e,r){var n=r,a=null;do{var s=this.decodeGeneralPurposeField(n,a),o=PUe.parseFieldsInGeneralPurpose(s.getNewString());if(o!=null&&e.append(o),s.isRemaining()?a=""+s.getRemainingValue():a=null,n===s.getNewPosition())break;n=s.getNewPosition()}while(!0);return e.toString()},t.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var r=e;r<e+3;++r)if(this.information.get(r))return!0;return this.information.get(e+3)},t.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var r=this.extractNumericValueFromBitArray(e,4);return r===0?new vx(this.information.getSize(),vx.FNC1,vx.FNC1):new vx(this.information.getSize(),r-1,vx.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,s=(n-8)%11;return new vx(e+7,a,s)},t.prototype.extractNumericValueFromBitArray=function(e,r){return t.extractNumericValueFromBitArray(this.information,e,r)},t.extractNumericValueFromBitArray=function(e,r,n){for(var a=0,s=0;s<n;++s)e.get(r+s)&&(a|=1<<n-s-1);return a},t.prototype.decodeGeneralPurposeField=function(e,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new Zm(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Zm(this.current.getPosition(),this.buffer.toString())},t.prototype.parseBlocks=function(){var e,r;do{var n=this.current.getPosition();this.current.isAlpha()?(r=this.parseAlphaBlock(),e=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),e=r.isFinished()):(r=this.parseNumericBlock(),e=r.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return r.getDecodedInformation()},t.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var r=void 0;return e.isSecondDigitFNC1()?r=new Zm(this.current.getPosition(),this.buffer.toString()):r=new Zm(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Jm(!0,r)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var r=new Zm(this.current.getPosition(),this.buffer.toString());return new Jm(!0,r)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Jm(!1)},t.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new Zm(this.current.getPosition(),this.buffer.toString());return new Jm(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Jm(!1)},t.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new Zm(this.current.getPosition(),this.buffer.toString());return new Jm(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Jm(!1)},t.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},t.prototype.decodeIsoIec646=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new Jd(e+5,Jd.FNC1);if(r>=5&&r<15)return new Jd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new Jd(e+7,""+(n+1));if(n>=90&&n<116)return new Jd(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),s;switch(a){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new Hr}return new Jd(e+8,s)},t.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},t.prototype.decodeAlphanumeric=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new Jd(e+5,Jd.FNC1);if(r>=5&&r<15)return new Jd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new Jd(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new Kw("Decoding invalid alphanumeric value: "+n)}return new Jd(e+6,a)},t.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<5&&r+e<this.information.getSize();++r)if(r===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+r))return!1;return!0},t.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var r=e;r<e+3;++r)if(this.information.get(r))return!1;return!0},t.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<4&&r+e<this.information.getSize();++r)if(this.information.get(e+r))return!1;return!0},t}(),wse=function(){function t(e){this.information=e,this.generalDecoder=new vE(e)}return t.prototype.getInformation=function(){return this.information},t.prototype.getGeneralDecoder=function(){return this.generalDecoder},t}(),BUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),of=function(t){BUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedGtin=function(r,n){r.append("(01)");var a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(r,n,a){for(var s=0;s<4;++s){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*s,10);o/100===0&&r.append("0"),o/10===0&&r.append("0"),r.append(o)}e.appendCheckDigit(r,a)},e.appendCheckDigit=function(r,n){for(var a=0,s=0;s<13;s++){var o=r.charAt(s+n).charCodeAt(0)-48;a+=s&1?o:3*o}a=10-a%10,a===10&&(a=0),r.append(a)},e.GTIN_SIZE=40,e}(wse),TUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),kUe=function(t){TUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new Zn;r.append("(01)");var n=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(of),FUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),OUe=function(t){FUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new Zn;return this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(wse),DUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yE=function(t){DUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedWeight=function(r,n,a){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(r,s);for(var o=this.checkWeight(s),l=1e5,c=0;c<5;++c)o/l===0&&r.append("0"),l/=10;r.append(o)},e}(of),RUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Nse=function(t){RUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+yE.GTIN_SIZE+e.WEIGHT_SIZE)throw new ur;var r=new Zn;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+yE.GTIN_SIZE,e.WEIGHT_SIZE),r.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(yE),MUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),LUe=function(t){MUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){r.append("(3103)")},e.prototype.checkWeight=function(r){return r},e}(Nse),UUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),QUe=function(t){UUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){n<1e4?r.append("(3202)"):r.append("(3203)")},e.prototype.checkWeight=function(r){return r<1e4?r:r-1e4},e}(Nse),VUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),HUe=function(t){VUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+of.GTIN_SIZE)throw new ur;var r=new Zn;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+of.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(392"),r.append(n),r.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+of.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(of),$Ue=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),GUe=function(t){$Ue(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+of.GTIN_SIZE)throw new ur;var r=new Zn;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+of.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(393"),r.append(n),r.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+of.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&r.append("0"),a/10===0&&r.append("0"),r.append(a);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+of.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return r.append(s.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(of),KUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),g0=function(t){KUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.dateCode=a,s.firstAIdigits=n,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new ur;var r=new Zn;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(r,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),r.toString()},e.prototype.encodeCompressedDate=function(r,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){r.append("("),r.append(this.dateCode),r.append(")");var s=a%32;a/=32;var o=a%12+1;a/=12;var l=a;l/10===0&&r.append("0"),r.append(l),o/10===0&&r.append("0"),r.append(o),s/10===0&&r.append("0"),r.append(s)}},e.prototype.addWeightCode=function(r,n){r.append("("),r.append(this.firstAIdigits),r.append(n/1e5),r.append(")")},e.prototype.checkWeight=function(r){return r%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(yE);function qUe(t){try{if(t.get(1))return new kUe(t);if(!t.get(2))return new OUe(t);var e=vE.extractNumericValueFromBitArray(t,1,4);switch(e){case 4:return new LUe(t);case 5:return new QUe(t)}var r=vE.extractNumericValueFromBitArray(t,1,5);switch(r){case 12:return new HUe(t);case 13:return new GUe(t)}var n=vE.extractNumericValueFromBitArray(t,1,7);switch(n){case 56:return new g0(t,"310","11");case 57:return new g0(t,"320","11");case 58:return new g0(t,"310","13");case 59:return new g0(t,"320","13");case 60:return new g0(t,"310","15");case 61:return new g0(t,"320","15");case 62:return new g0(t,"310","17");case 63:return new g0(t,"320","17")}}catch(a){throw console.log(a),new Kw("unknown decoder: "+t)}}var D$=function(){function t(e,r,n,a){this.leftchar=e,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}return t.prototype.mayBeLast=function(){return this.maybeLast},t.prototype.getLeftChar=function(){return this.leftchar},t.prototype.getRightChar=function(){return this.rightchar},t.prototype.getFinderPattern=function(){return this.finderpattern},t.prototype.mustBeLast=function(){return this.rightchar==null},t.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},t.equals=function(e,r){return e instanceof t?t.equalsOrNull(e.leftchar,r.leftchar)&&t.equalsOrNull(e.rightchar,r.rightchar)&&t.equalsOrNull(e.finderpattern,r.finderpattern):!1},t.equalsOrNull=function(e,r){return e===null?r===null:t.equals(e,r)},t.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},t}(),zUe=function(){function t(e,r,n){this.pairs=e,this.rowNumber=r,this.wasReversed=n}return t.prototype.getPairs=function(){return this.pairs},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.isReversed=function(){return this.wasReversed},t.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},t.prototype.toString=function(){return"{ "+this.pairs+" }"},t.prototype.equals=function(e,r){return e instanceof t?this.checkEqualitity(e,r)&&e.wasReversed===r.wasReversed:!1},t.prototype.checkEqualitity=function(e,r){if(!(!e||!r)){var n;return e.forEach(function(a,s){r.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},t}(),WUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),x0=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},XUe=function(t){WUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.pairs=new Array(e.MAX_PAIRS),r.rows=new Array,r.startEnd=[2],r}return e.prototype.decodeRow=function(r,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(r,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(r,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(r,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,r))}catch(l){if(l instanceof ur){if(!this.pairs.length)throw new ur;a=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(r,!1),s){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new ur},e.prototype.checkRowsBoolean=function(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return r&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(r,n){for(var a,s,o=n;o<this.rows.length;o++){var l=this.rows[o];this.pairs.length=0;try{for(var c=(a=void 0,x0(r)),u=c.next();!u.done;u=c.next()){var d=u.value;this.pairs.push(d.getPairs())}}catch(A){a={error:A}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}if(this.pairs.push(l.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(r);f.push(l);try{return this.checkRows(f,o+1)}catch(A){console.log(A)}}}throw new ur},e.isValidSequence=function(r){var n,a;try{for(var s=x0(e.FINDER_PATTERN_SEQUENCES),o=s.next();!o.done;o=s.next()){var l=o.value;if(!(r.length>l.length)){for(var c=!0,u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!==l[u]){c=!1;break}if(c)return!0}}}catch(d){n={error:d}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(r,n){for(var a=0,s=!1,o=!1;a<this.rows.length;){var l=this.rows[a];if(l.getRowNumber()>r){o=l.isEquivalent(this.pairs);break}s=l.isEquivalent(this.pairs),a++}o||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new zUe(this.pairs,r,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(r,n){var a,s,o,l,c,u;try{for(var d=x0(n),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.getPairs().length!==r.length){var h=!0;try{for(var m=(o=void 0,x0(A.getPairs())),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,x0(r)),b=y.next();!b.done;b=y.next()){var w=b.value;if(D$.equals(x,w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}v||(h=!1)}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}}}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}},e.isPartialRow=function(r,n){var a,s,o,l,c,u;try{for(var d=x0(n),f=d.next();!f.done;f=d.next()){var A=f.value,h=!0;try{for(var m=(o=void 0,x0(r)),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,x0(A.getPairs())),b=y.next();!b.done;b=y.next()){var w=b.value;if(x.equals(w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}if(!v){h=!1;break}}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}if(h)return!0}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(r){var n=EUe.buildBitArray(r),a=qUe(n),s=a.parseInformation(),o=r[0].getFinderPattern().getResultPoints(),l=r[r.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],l[0],l[1]];return new uc(s,null,null,c,jn.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var r=this.pairs.get(0),n=r.getLeftChar(),a=r.getRightChar();if(a===null)return!1;for(var s=a.getChecksumPortion(),o=2,l=1;l<this.pairs.size();++l){var c=this.pairs.get(l);s+=c.getLeftChar().getChecksumPortion(),o++;var u=c.getRightChar();u!=null&&(s+=u.getChecksumPortion(),o++)}s%=211;var d=211*(o-4)+s;return d===n.getValue()},e.getNextSecondBar=function(r,n){var a;return r.get(n)?(a=r.getNextUnset(n),a=r.getNextSet(a)):(a=r.getNextSet(n),a=r.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(r,n,a){var s=n.length%2===0;this.startFromEven&&(s=!s);var o,l=!0,c=-1;do this.findNextPair(r,n,c),o=this.parseFoundFinderPattern(r,a,s),o===null?c=e.getNextSecondBar(r,this.startEnd[0]):l=!1;while(l);var u=this.decodeDataCharacter(r,o,s,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new ur;var d;try{d=this.decodeDataCharacter(r,o,s,!1)}catch(f){d=null,console.log(f)}return new D$(u,d,o,!0)},e.prototype.isEmptyPair=function(r){return r.length===0},e.prototype.findNextPair=function(r,n,a){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var o=r.getSize(),l;if(a>=0)l=a;else if(this.isEmptyPair(n))l=0;else{var c=n[n.length-1];l=c.getFinderPattern().getStartEnd()[1]}var u=n.length%2!==0;this.startFromEven&&(u=!u);for(var d=!1;l<o&&(d=!r.get(l),!!d);)l++;for(var f=0,A=l,h=l;h<o;h++)if(r.get(h)!==d)s[f]++;else{if(f===3){if(u&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=A,this.startEnd[1]=h;return}u&&e.reverseCounters(s),A+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,f--}else f++;s[f]=1,d=!d}throw new ur},e.reverseCounters=function(r){for(var n=r.length,a=0;a<n/2;++a){var s=r[a];r[a]=r[n-a-1],r[n-a-1]=s}},e.prototype.parseFoundFinderPattern=function(r,n,a){var s,o,l;if(a){for(var c=this.startEnd[0]-1;c>=0&&!r.get(c);)c--;c++,s=this.startEnd[0]-c,o=c,l=this.startEnd[1]}else o=this.startEnd[0],l=r.getNextUnset(this.startEnd[1]+1),s=l-this.startEnd[1];var u=this.getDecodeFinderCounters();ws.arraycopy(u,0,u,1,u.length-1),u[0]=s;var d;try{d=this.parseFinderValue(u,e.FINDER_PATTERNS)}catch{return null}return new bse(d,[o,l],o,l,n)},e.prototype.decodeDataCharacter=function(r,n,a,s){for(var o=this.getDataCharacterCounters(),l=0;l<o.length;l++)o[l]=0;if(s)e.recordPatternInReverse(r,n.getStartEnd()[0],o);else{e.recordPattern(r,n.getStartEnd()[1],o);for(var c=0,u=o.length-1;c<u;c++,u--){var d=o[c];o[c]=o[u],o[u]=d}}var f=17,A=ja.sum(new Int32Array(o))/f,h=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(A-h)/h>.3)throw new ur;for(var m=this.getOddCounts(),p=this.getEvenCounts(),x=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var y=1*o[c]/A,b=y+.5;if(b<1){if(y<.3)throw new ur;b=1}else if(b>8){if(y>8.7)throw new ur;b=8}var w=c/2;c&1?(p[w]=b,v[w]=y-b):(m[w]=b,x[w]=y-b)}this.adjustOddEvenCounts(f);for(var j=4*n.getValue()+(a?0:2)+(s?0:1)-1,I=0,_=0,c=m.length-1;c>=0;c--){if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c];_+=m[c]*S}I+=m[c]}for(var E=0,c=p.length-1;c>=0;c--)if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c+1];E+=p[c]*S}var B=_+E;if(I&1||I>13||I<4)throw new ur;var T=(13-I)/2,P=e.SYMBOL_WIDEST[T],O=9-P,z=Xx.getRSSvalue(m,P,!0),ce=Xx.getRSSvalue(p,O,!1),de=e.EVEN_TOTAL_SUBSET[T],ue=e.GSUM[T],me=z*de+ce+ue;return new eI(me,B)},e.isNotA1left=function(r,n,a){return!(r.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(r){var n=ja.sum(new Int32Array(this.getOddCounts())),a=ja.sum(new Int32Array(this.getEvenCounts())),s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);var l=!1,c=!1;a>13?c=!0:a<4&&(l=!0);var u=n+a-r,d=(n&1)===1,f=(a&1)===0;if(u===1)if(d){if(f)throw new ur;o=!0}else{if(!f)throw new ur;c=!0}else if(u===-1)if(d){if(f)throw new ur;s=!0}else{if(!f)throw new ur;l=!0}else if(u===0){if(d){if(!f)throw new ur;n<a?(s=!0,c=!0):(o=!0,l=!0)}else if(f)throw new ur}else throw new ur;if(s){if(o)throw new ur;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new ur;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(up),YUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),JUe=function(t){YUe(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.count=0,s.finderPattern=a,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(eI),ZUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},R$=function(t){ZUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.possibleLeftPairs=[],r.possibleRightPairs=[],r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.decodePair(n,!1,r,a);e.addOrTally(this.possibleLeftPairs,u),n.reverse();var d=this.decodePair(n,!0,r,a);e.addOrTally(this.possibleRightPairs,d),n.reverse();try{for(var f=$5(this.possibleLeftPairs),A=f.next();!A.done;A=f.next()){var h=A.value;if(h.getCount()>1)try{for(var m=(l=void 0,$5(this.possibleRightPairs)),p=m.next();!p.done;p=m.next()){var x=p.value;if(x.getCount()>1&&e.checkChecksum(h,x))return e.constructResult(h,x)}}catch(v){l={error:v}}finally{try{p&&!p.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}}}catch(v){s={error:v}}finally{try{A&&!A.done&&(o=f.return)&&o.call(f)}finally{if(s)throw s.error}}throw new ur},e.addOrTally=function(r,n){var a,s;if(n!=null){var o=!1;try{for(var l=$5(r),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.getValue()===n.getValue()){u.incrementCount(),o=!0;break}}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}o||r.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(r,n){for(var a=4537077*r.getValue()+n.getValue(),s=new String(a).toString(),o=new Zn,l=13-s.length;l>0;l--)o.append("0");o.append(s);for(var c=0,l=0;l<13;l++){var u=o.charAt(l).charCodeAt(0)-48;c+=l&1?u:3*u}c=10-c%10,c===10&&(c=0),o.append(c.toString());var d=r.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new uc(o.toString(),null,0,[d[0],d[1],f[0],f[1]],jn.RSS_14,new Date().getTime())},e.checkChecksum=function(r,n){var a=(r.getChecksumPortion()+16*n.getChecksumPortion())%79,s=9*r.getFinderPattern().getValue()+n.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,a===s},e.prototype.decodePair=function(r,n,a,s){try{var o=this.findFinderPattern(r,n),l=this.parseFoundFinderPattern(r,a,n,o),c=s==null?null:s.get(Ns.NEED_RESULT_POINT_CALLBACK);if(c!=null){var u=(o[0]+o[1])/2;n&&(u=r.getSize()-1-u),c.foundPossibleResultPoint(new dn(u,a))}var d=this.decodeDataCharacter(r,l,!0),f=this.decodeDataCharacter(r,l,!1);return new JUe(1597*d.getValue()+f.getValue(),d.getChecksumPortion()+4*f.getChecksumPortion(),l)}catch{return null}},e.prototype.decodeDataCharacter=function(r,n,a){for(var s=this.getDataCharacterCounters(),o=0;o<s.length;o++)s[o]=0;if(a)ko.recordPatternInReverse(r,n.getStartEnd()[0],s);else{ko.recordPattern(r,n.getStartEnd()[1]+1,s);for(var l=0,c=s.length-1;l<c;l++,c--){var u=s[l];s[l]=s[c],s[c]=u}}for(var d=a?16:15,f=ja.sum(new Int32Array(s))/d,A=this.getOddCounts(),h=this.getEvenCounts(),m=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors(),l=0;l<s.length;l++){var x=s[l]/f,v=Math.floor(x+.5);v<1?v=1:v>8&&(v=8);var y=Math.floor(l/2);l&1?(h[y]=v,p[y]=x-v):(A[y]=v,m[y]=x-v)}this.adjustOddEvenCounts(a,d);for(var b=0,w=0,l=A.length-1;l>=0;l--)w*=9,w+=A[l],b+=A[l];for(var j=0,I=0,l=h.length-1;l>=0;l--)j*=9,j+=h[l],I+=h[l];var _=w+3*j;if(a){if(b&1||b>12||b<4)throw new ur;var S=(12-b)/2,E=e.OUTSIDE_ODD_WIDEST[S],B=9-E,T=Xx.getRSSvalue(A,E,!1),P=Xx.getRSSvalue(h,B,!0),O=e.OUTSIDE_EVEN_TOTAL_SUBSET[S],z=e.OUTSIDE_GSUM[S];return new eI(T*O+P+z,_)}else{if(I&1||I>10||I<4)throw new ur;var S=(10-I)/2,E=e.INSIDE_ODD_WIDEST[S],B=9-E,T=Xx.getRSSvalue(A,E,!0),P=Xx.getRSSvalue(h,B,!1),ce=e.INSIDE_ODD_TOTAL_SUBSET[S],z=e.INSIDE_GSUM[S];return new eI(P*ce+T+z,_)}},e.prototype.findFinderPattern=function(r,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var s=r.getSize(),o=!1,l=0;l<s&&(o=!r.get(l),n!==o);)l++;for(var c=0,u=l,d=l;d<s;d++)if(r.get(d)!==o)a[c]++;else{if(c===3){if(up.isFinderPattern(a))return[u,d];u+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,o=!o}throw new ur},e.prototype.parseFoundFinderPattern=function(r,n,a,s){for(var o=r.get(s[0]),l=s[0]-1;l>=0&&o!==r.get(l);)l--;l++;var c=s[0]-l,u=this.getDecodeFinderCounters(),d=new Int32Array(u.length);ws.arraycopy(u,0,d,1,u.length-1),d[0]=c;var f=this.parseFinderValue(d,e.FINDER_PATTERNS),A=l,h=s[1];return a&&(A=r.getSize()-1-A,h=r.getSize()-1-h),new bse(f,[l,s[1]],A,h,n)},e.prototype.adjustOddEvenCounts=function(r,n){var a=ja.sum(new Int32Array(this.getOddCounts())),s=ja.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1,c=!1,u=!1;r?(a>12?l=!0:a<4&&(o=!0),s>12?u=!0:s<4&&(c=!0)):(a>11?l=!0:a<5&&(o=!0),s>10?u=!0:s<4&&(c=!0));var d=a+s-n,f=(a&1)===(r?1:0),A=(s&1)===1;if(d===1)if(f){if(A)throw new ur;l=!0}else{if(!A)throw new ur;u=!0}else if(d===-1)if(f){if(A)throw new ur;o=!0}else{if(!A)throw new ur;c=!0}else if(d===0){if(f){if(!A)throw new ur;a<s?(o=!0,u=!0):(l=!0,c=!0)}else if(A)throw new ur}else throw new ur;if(o){if(l)throw new ur;up.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&up.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(u)throw new ur;up.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&up.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(up),e7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yx=function(t){e7e(e,t);function e(r){var n=t.call(this)||this;n.readers=[];var a=r?r.get(Ns.POSSIBLE_FORMATS):null,s=r&&r.get(Ns.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=r&&r.get(Ns.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(jn.EAN_13)||a.includes(jn.UPC_A)||a.includes(jn.EAN_8)||a.includes(jn.UPC_E))&&n.readers.push(new H5(r)),a.includes(jn.CODE_39)&&n.readers.push(new S$(s,o)),a.includes(jn.CODE_93)&&n.readers.push(new I$),a.includes(jn.CODE_128)&&n.readers.push(new E$),a.includes(jn.ITF)&&n.readers.push(new j$),a.includes(jn.CODABAR)&&n.readers.push(new wUe),a.includes(jn.RSS_14)&&n.readers.push(new R$),a.includes(jn.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new XUe))),n.readers.length===0&&(n.readers.push(new H5(r)),n.readers.push(new S$),n.readers.push(new I$),n.readers.push(new H5(r)),n.readers.push(new E$),n.readers.push(new j$),n.readers.push(new R$)),n}return e.prototype.decodeRow=function(r,n,a){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(r,n,a)}catch{}throw new ur},e.prototype.reset=function(){this.readers.forEach(function(r){return r.reset()})},e}(ko),t7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){t7e(e,t);function e(r,n){return r===void 0&&(r=500),t.call(this,new Yx(n),r,n)||this}return e})(w1);var M$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},La=function(){function t(e,r,n){this.ecCodewords=e,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}return t.prototype.getECCodewords=function(){return this.ecCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),Fa=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),r7e=function(){function t(e,r,n,a,s,o){var l,c;this.versionNumber=e,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=s,this.ecBlocks=o;var u=0,d=o.getECCodewords(),f=o.getECBlocks();try{for(var A=M$(f),h=A.next();!h.done;h=A.next()){var m=h.value;u+=m.getCount()*(m.getDataCodewords()+d)}}catch(p){l={error:p}}finally{try{h&&!h.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}this.totalCodewords=u}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},t.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},t.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},t.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t.getVersionForDimensions=function(e,r){var n,a;if(e&1||r&1)throw new Hr;try{for(var s=M$(t.VERSIONS),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.symbolSizeRows===e&&l.symbolSizeColumns===r)return l}}catch(c){n={error:c}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}throw new Hr},t.prototype.toString=function(){return""+this.versionNumber},t.buildVersions=function(){return[new t(1,10,10,8,8,new La(5,new Fa(1,3))),new t(2,12,12,10,10,new La(7,new Fa(1,5))),new t(3,14,14,12,12,new La(10,new Fa(1,8))),new t(4,16,16,14,14,new La(12,new Fa(1,12))),new t(5,18,18,16,16,new La(14,new Fa(1,18))),new t(6,20,20,18,18,new La(18,new Fa(1,22))),new t(7,22,22,20,20,new La(20,new Fa(1,30))),new t(8,24,24,22,22,new La(24,new Fa(1,36))),new t(9,26,26,24,24,new La(28,new Fa(1,44))),new t(10,32,32,14,14,new La(36,new Fa(1,62))),new t(11,36,36,16,16,new La(42,new Fa(1,86))),new t(12,40,40,18,18,new La(48,new Fa(1,114))),new t(13,44,44,20,20,new La(56,new Fa(1,144))),new t(14,48,48,22,22,new La(68,new Fa(1,174))),new t(15,52,52,24,24,new La(42,new Fa(2,102))),new t(16,64,64,14,14,new La(56,new Fa(2,140))),new t(17,72,72,16,16,new La(36,new Fa(4,92))),new t(18,80,80,18,18,new La(48,new Fa(4,114))),new t(19,88,88,20,20,new La(56,new Fa(4,144))),new t(20,96,96,22,22,new La(68,new Fa(4,174))),new t(21,104,104,24,24,new La(56,new Fa(6,136))),new t(22,120,120,18,18,new La(68,new Fa(6,175))),new t(23,132,132,20,20,new La(62,new Fa(8,163))),new t(24,144,144,22,22,new La(62,new Fa(8,156),new Fa(2,155))),new t(25,8,18,6,16,new La(7,new Fa(1,5))),new t(26,8,32,6,14,new La(11,new Fa(1,10))),new t(27,12,26,10,24,new La(14,new Fa(1,16))),new t(28,12,36,10,16,new La(18,new Fa(1,22))),new t(29,16,36,14,16,new La(24,new Fa(1,32))),new t(30,16,48,14,22,new La(28,new Fa(1,49)))]},t.VERSIONS=t.buildVersions(),t}(),n7e=function(){function t(e){var r=e.getHeight();if(r<8||r>144||r&1)throw new Hr;this.version=t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new lh(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return t.prototype.getVersion=function(){return this.version},t.readVersion=function(e){var r=e.getHeight(),n=e.getWidth();return r7e.getVersionForDimensions(r,n)},t.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),r=0,n=4,a=0,s=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),l=!1,c=!1,u=!1,d=!1;do if(n===s&&a===0&&!l)e[r++]=this.readCorner1(s,o)&255,n-=2,a+=2,l=!0;else if(n===s-2&&a===0&&o&3&&!c)e[r++]=this.readCorner2(s,o)&255,n-=2,a+=2,c=!0;else if(n===s+4&&a===2&&!(o&7)&&!u)e[r++]=this.readCorner3(s,o)&255,n-=2,a+=2,u=!0;else if(n===s-2&&a===0&&(o&7)===4&&!d)e[r++]=this.readCorner4(s,o)&255,n-=2,a+=2,d=!0;else{do n<s&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n+=2,a-=2;while(n<s&&a>=0);n+=3,a+=1}while(n<s||a<o);if(r!==this.version.getTotalCodewords())throw new Hr;return e},t.prototype.readModule=function(e,r,n,a){return e<0&&(e+=n,r+=4-(n+4&7)),r<0&&(r+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(r,e),this.mappingBitMatrix.get(r,e)},t.prototype.readUtah=function(e,r,n,a){var s=0;return this.readModule(e-2,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-2,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r,n,a)&&(s|=1),s<<=1,this.readModule(e,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e,r,n,a)&&(s|=1),s},t.prototype.readCorner1=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,1,e,r)&&(n|=1),n<<=1,this.readModule(e-1,2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.readCorner2=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-4,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner3=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-3,e,r)&&(n|=1),n<<=1,this.readModule(1,r-2,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner4=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.extractDataRegion=function(e){var r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==r)throw new Pn("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),o=r/a|0,l=n/s|0,c=o*a,u=l*s,d=new lh(u,c),f=0;f<o;++f)for(var A=f*a,h=0;h<l;++h)for(var m=h*s,p=0;p<a;++p)for(var x=f*(a+2)+1+p,v=A+p,y=0;y<s;++y){var b=h*(s+2)+1+y;if(e.get(b,x)){var w=m+y;d.set(w,v)}}return d},t}(),L$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r){var n,a,s,o,l=r.getECBlocks(),c=0,u=l.getECBlocks();try{for(var d=L$(u),f=d.next();!f.done;f=d.next()){var A=f.value;c+=A.getCount()}}catch(z){n={error:z}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}var h=new Array(c),m=0;try{for(var p=L$(u),x=p.next();!x.done;x=p.next())for(var A=x.value,v=0;v<A.getCount();v++){var y=A.getDataCodewords(),b=l.getECCodewords()+y;h[m++]=new t(y,new Uint8Array(b))}}catch(z){s={error:z}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}for(var w=h[0].codewords.length,j=w-l.getECCodewords(),I=j-1,_=0,v=0;v<I;v++)for(var S=0;S<m;S++)h[S].codewords[v]=e[_++];for(var E=r.getVersionNumber()===24,B=E?8:m,S=0;S<B;S++)h[S].codewords[j-1]=e[_++];for(var T=h[0].codewords.length,v=j;v<T;v++)for(var S=0;S<m;S++){var P=E?(S+8)%m:S,O=E&&P>7?v-1:v;h[P].codewords[O]=e[_++]}if(_!==e.length)throw new Pn;return h},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),Cse=function(){function t(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new Pn(""+e);var r=0,n=this.bitOffset,a=this.byteOffset,s=this.bytes;if(n>0){var o=8-n,l=e<o?e:o,c=o-l,u=255>>8-l<<c;r=(s[a]&u)>>c,e-=l,n+=l,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)r=r<<8|s[a]&255,a++,e-=8;if(e>0){var c=8-e,u=255>>c<<c;r=r<<e|(s[a]&u)>>c,n+=e}}return this.bitOffset=n,this.byteOffset=a,r},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t}(),yo;(function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"})(yo||(yo={}));var s7e=function(){function t(){}return t.decode=function(e){var r=new Cse(e),n=new Zn,a=new Zn,s=new Array,o=yo.ASCII_ENCODE;do if(o===yo.ASCII_ENCODE)o=this.decodeAsciiSegment(r,n,a);else{switch(o){case yo.C40_ENCODE:this.decodeC40Segment(r,n);break;case yo.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case yo.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case yo.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case yo.BASE256_ENCODE:this.decodeBase256Segment(r,n,s);break;default:throw new Hr}o=yo.ASCII_ENCODE}while(o!==yo.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new xP(e,n.toString(),s.length===0?null:s,null)},t.decodeAsciiSegment=function(e,r,n){var a=!1;do{var s=e.readBits(8);if(s===0)throw new Hr;if(s<=128)return a&&(s+=128),r.append(String.fromCharCode(s-1)),yo.ASCII_ENCODE;if(s===129)return yo.PAD_ENCODE;if(s<=229){var o=s-130;o<10&&r.append("0"),r.append(""+o)}else switch(s){case 230:return yo.C40_ENCODE;case 231:return yo.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return yo.ANSIX12_ENCODE;case 239:return yo.TEXT_ENCODE;case 240:return yo.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new Hr;break}}while(e.available()>0);return yo.ASCII_ENCODE},t.decodeC40Segment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var u=this.C40_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new Hr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var u=this.C40_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Hr}s=0;break;case 3:n?(r.append(String.fromCharCode(c+224)),n=!1):r.append(String.fromCharCode(c+96)),s=0;break;default:throw new Hr}}}while(e.available()>0)},t.decodeTextSegment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var u=this.TEXT_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new Hr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var u=this.TEXT_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Hr}s=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var u=this.TEXT_SHIFT3_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u),s=0}else throw new Hr;break;default:throw new Hr}}}while(e.available()>0)},t.decodeAnsiX12Segment=function(e,r){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var s=0;s<3;s++){var o=n[s];switch(o){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(o<14)r.append(String.fromCharCode(o+44));else if(o<40)r.append(String.fromCharCode(o+51));else throw new Hr;break}}}while(e.available()>0)},t.parseTwoBytes=function(e,r,n){var a=(e<<8)+r-1,s=Math.floor(a/1600);n[0]=s,a-=s*1600,s=Math.floor(a/40),n[1]=s,n[2]=a-s*40},t.decodeEdifactSegment=function(e,r){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}a&32||(a|=64),r.append(String.fromCharCode(a))}}while(e.available()>0)},t.decodeBase256Segment=function(e,r,n){var a=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),a++),o;if(s===0?o=e.available()/8|0:s<250?o=s:o=250*(s-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new Hr;for(var l=new Uint8Array(o),c=0;c<o;c++){if(e.available()<8)throw new Hr;l[c]=this.unrandomize255State(e.readBits(8),a++)}n.push(l);try{r.append(Bd.decode(l,ba.ISO88591))}catch(u){throw new Kw("Platform does not support required encoding: "+u.message)}},t.unrandomize255State=function(e,r){var n=149*r%255+1,a=e-n;return a>=0?a:a+256},t.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],t.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.TEXT_SHIFT2_SET_CHARS=t.C40_SHIFT2_SET_CHARS,t.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],t}(),i7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o7e=function(){function t(){this.rsDecoder=new vP(Jc.DATA_MATRIX_FIELD_256)}return t.prototype.decode=function(e){var r,n,a=new n7e(e),s=a.getVersion(),o=a.readCodewords(),l=a7e.getDataBlocks(o,s),c=0;try{for(var u=i7e(l),d=u.next();!d.done;d=u.next()){var f=d.value;c+=f.getNumDataCodewords()}}catch(b){r={error:b}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}for(var A=new Uint8Array(c),h=l.length,m=0;m<h;m++){var p=l[m],x=p.getCodewords(),v=p.getNumDataCodewords();this.correctErrors(x,v);for(var y=0;y<v;y++)A[y*h+m]=x[y]}return s7e.decode(A)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new oo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),l7e=function(){function t(e){this.image=e,this.rectangleDetector=new uF(this.image)}return t.prototype.detect=function(){var e=this.rectangleDetector.detect(),r=this.detectSolid1(e);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new ur;r=this.shiftToModuleCenter(r);var n=r[0],a=r[1],s=r[2],o=r[3],l=this.transitionsBetween(n,o)+1,c=this.transitionsBetween(s,o)+1;(l&1)===1&&(l+=1),(c&1)===1&&(c+=1),4*l<7*c&&4*c<7*l&&(l=c=Math.max(l,c));var u=t.sampleGrid(this.image,n,a,s,o,l,c);return new OR(u,[n,a,s,o])},t.shiftPoint=function(e,r,n){var a=(r.getX()-e.getX())/(n+1),s=(r.getY()-e.getY())/(n+1);return new dn(e.getX()+a,e.getY()+s)},t.moveAway=function(e,r,n){var a=e.getX(),s=e.getY();return a<r?a-=1:a+=1,s<n?s-=1:s+=1,new dn(a,s)},t.prototype.detectSolid1=function(e){var r=e[0],n=e[1],a=e[3],s=e[2],o=this.transitionsBetween(r,n),l=this.transitionsBetween(n,a),c=this.transitionsBetween(a,s),u=this.transitionsBetween(s,r),d=o,f=[s,r,n,a];return d>l&&(d=l,f[0]=r,f[1]=n,f[2]=a,f[3]=s),d>c&&(d=c,f[0]=n,f[1]=a,f[2]=s,f[3]=r),d>u&&(f[0]=a,f[1]=s,f[2]=r,f[3]=n),f},t.prototype.detectSolid2=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=t.shiftPoint(n,a,(o+1)*4),c=t.shiftPoint(a,n,(o+1)*4),u=this.transitionsBetween(l,r),d=this.transitionsBetween(c,s);return u<d?(e[0]=r,e[1]=n,e[2]=a,e[3]=s):(e[0]=n,e[1]=a,e[2]=s,e[3]=r),e},t.prototype.correctTopRight=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=this.transitionsBetween(n,s),c=t.shiftPoint(r,n,(l+1)*4),u=t.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(c,s),l=this.transitionsBetween(u,s);var d=new dn(s.getX()+(a.getX()-n.getX())/(o+1),s.getY()+(a.getY()-n.getY())/(o+1)),f=new dn(s.getX()+(r.getX()-n.getX())/(l+1),s.getY()+(r.getY()-n.getY())/(l+1));if(!this.isValid(d))return this.isValid(f)?f:null;if(!this.isValid(f))return d;var A=this.transitionsBetween(c,d)+this.transitionsBetween(u,d),h=this.transitionsBetween(c,f)+this.transitionsBetween(u,f);return A>h?d:f},t.prototype.shiftToModuleCenter=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s)+1,l=this.transitionsBetween(a,s)+1,c=t.shiftPoint(r,n,l*4),u=t.shiftPoint(a,n,o*4);o=this.transitionsBetween(c,s)+1,l=this.transitionsBetween(u,s)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);var d=(r.getX()+n.getX()+a.getX()+s.getX())/4,f=(r.getY()+n.getY()+a.getY()+s.getY())/4;r=t.moveAway(r,d,f),n=t.moveAway(n,d,f),a=t.moveAway(a,d,f),s=t.moveAway(s,d,f);var A,h;return c=t.shiftPoint(r,n,l*4),c=t.shiftPoint(c,s,o*4),A=t.shiftPoint(n,r,l*4),A=t.shiftPoint(A,a,o*4),u=t.shiftPoint(a,s,l*4),u=t.shiftPoint(u,n,o*4),h=t.shiftPoint(s,a,l*4),h=t.shiftPoint(h,r,o*4),[c,A,u,h]},t.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},t.sampleGrid=function(e,r,n,a,s,o,l){var c=DR.getInstance();return c.sampleGrid(e,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,r.getX(),r.getY(),s.getX(),s.getY(),a.getX(),a.getY(),n.getX(),n.getY())},t.prototype.transitionsBetween=function(e,r){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),s=Math.trunc(r.getX()),o=Math.trunc(r.getY()),l=Math.abs(o-a)>Math.abs(s-n);if(l){var c=n;n=a,a=c,c=s,s=o,o=c}for(var u=Math.abs(s-n),d=Math.abs(o-a),f=-u/2,A=a<o?1:-1,h=n<s?1:-1,m=0,p=this.image.get(l?a:n,l?n:a),x=n,v=a;x!==s;x+=h){var y=this.image.get(l?v:x,l?x:v);if(y!==p&&(m++,p=y),f+=d,f>0){if(v===o)break;v+=A,f-=u}}return m},t}(),tI=function(){function t(){this.decoder=new o7e}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n,a;if(r!=null&&r.has(Ns.PURE_BARCODE)){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(s),a=t.NO_POINTS}else{var o=new l7e(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var l=n.getRawBytes(),c=new uc(n.getText(),l,8*l.length,a,jn.DATA_MATRIX,ws.currentTimeMillis()),u=n.getByteSegments();u!=null&&c.putMetadata(jl.BYTE_SEGMENTS,u);var d=n.getECLevel();return d!=null&&c.putMetadata(jl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r==null||n==null)throw new ur;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0],u=(c-l+1)/a,d=(o-s+1)/a;if(u<=0||d<=0)throw new ur;var f=a/2;s+=f,l+=f;for(var A=new lh(u,d),h=0;h<d;h++)for(var m=s+h*a,p=0;p<u;p++)e.get(l+p*a,m)&&A.set(p,h);return A},t.moduleSize=function(e,r){for(var n=r.getWidth(),a=e[0],s=e[1];a<n&&r.get(a,s);)a++;if(a===n)throw new ur;var o=a-e[0];if(o===0)throw new ur;return o},t.NO_POINTS=[],t}(),c7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){c7e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new tI,r)||this}return e})(w1);var Jx;(function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"})(Jx||(Jx={}));var u7e=function(){function t(e,r,n){this.value=e,this.stringValue=r,this.bits=n,t.FOR_BITS.set(n,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new Qi(e+"not available")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new Pn;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t(Jx.L,"L",1),t.M=new t(Jx.M,"M",0),t.Q=new t(Jx.Q,"Q",3),t.H=new t(Jx.H,"H",2),t}(),d7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_se=function(){function t(e){this.errorCorrectionLevel=u7e.forBits(e>>3&3),this.dataMask=e&7}return t.numBitsDiffering=function(e,r){return sa.bitCount(e^r)},t.decodeFormatInformation=function(e,r){var n=t.doDecodeFormatInformation(e,r);return n!==null?n:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,r^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,r){var n,a,s=Number.MAX_SAFE_INTEGER,o=0;try{for(var l=d7e(t.FORMAT_INFO_DECODE_LOOKUP),c=l.next();!c.done;c=l.next()){var u=c.value,d=u[0];if(d===e||d===r)return new t(u[1]);var f=t.numBitsDiffering(e,d);f<s&&(o=u[1],s=f),e!==r&&(f=t.numBitsDiffering(r,d),f<s&&(o=u[1],s=f))}}catch(A){n={error:A}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s<=3?new t(o):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t}(),f7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},qt=function(){function t(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=r}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var e,r,n=0,a=this.ecBlocks;try{for(var s=f7e(a),o=s.next();!o.done;o=s.next()){var l=o.value;n+=l.getCount()}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),ot=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),h7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$p=function(){function t(e,r){for(var n,a,s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=r,this.ecBlocks=s;var l=0,c=s[0].getECCodewordsPerBlock(),u=s[0].getECBlocks();try{for(var d=h7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;l+=A.getCount()*(A.getDataCodewords()+c)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this.totalCodewords=l}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},t.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new Hr;try{return this.getVersionForNumber((e-17)/4)}catch{throw new Hr}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new Pn;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var r=Number.MAX_SAFE_INTEGER,n=0,a=0;a<t.VERSION_DECODE_INFO.length;a++){var s=t.VERSION_DECODE_INFO[a];if(s===e)return t.getVersionForNumber(a+7);var o=_se.numBitsDiffering(e,s);o<r&&(n=a+7,r=o)}return r<=3?t.getVersionForNumber(n):null},t.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),r=new lh(e);r.setRegion(0,0,9,9),r.setRegion(e-8,0,8,9),r.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var s=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||r.setRegion(this.alignmentPatternCenters[o]-2,s,5,5);return r.setRegion(6,9,1,e-17),r.setRegion(9,6,e-17,1),this.versionNumber>6&&(r.setRegion(e-11,0,3,6),r.setRegion(0,e-11,6,3)),r},t.prototype.toString=function(){return""+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new qt(7,new ot(1,19)),new qt(10,new ot(1,16)),new qt(13,new ot(1,13)),new qt(17,new ot(1,9))),new t(2,Int32Array.from([6,18]),new qt(10,new ot(1,34)),new qt(16,new ot(1,28)),new qt(22,new ot(1,22)),new qt(28,new ot(1,16))),new t(3,Int32Array.from([6,22]),new qt(15,new ot(1,55)),new qt(26,new ot(1,44)),new qt(18,new ot(2,17)),new qt(22,new ot(2,13))),new t(4,Int32Array.from([6,26]),new qt(20,new ot(1,80)),new qt(18,new ot(2,32)),new qt(26,new ot(2,24)),new qt(16,new ot(4,9))),new t(5,Int32Array.from([6,30]),new qt(26,new ot(1,108)),new qt(24,new ot(2,43)),new qt(18,new ot(2,15),new ot(2,16)),new qt(22,new ot(2,11),new ot(2,12))),new t(6,Int32Array.from([6,34]),new qt(18,new ot(2,68)),new qt(16,new ot(4,27)),new qt(24,new ot(4,19)),new qt(28,new ot(4,15))),new t(7,Int32Array.from([6,22,38]),new qt(20,new ot(2,78)),new qt(18,new ot(4,31)),new qt(18,new ot(2,14),new ot(4,15)),new qt(26,new ot(4,13),new ot(1,14))),new t(8,Int32Array.from([6,24,42]),new qt(24,new ot(2,97)),new qt(22,new ot(2,38),new ot(2,39)),new qt(22,new ot(4,18),new ot(2,19)),new qt(26,new ot(4,14),new ot(2,15))),new t(9,Int32Array.from([6,26,46]),new qt(30,new ot(2,116)),new qt(22,new ot(3,36),new ot(2,37)),new qt(20,new ot(4,16),new ot(4,17)),new qt(24,new ot(4,12),new ot(4,13))),new t(10,Int32Array.from([6,28,50]),new qt(18,new ot(2,68),new ot(2,69)),new qt(26,new ot(4,43),new ot(1,44)),new qt(24,new ot(6,19),new ot(2,20)),new qt(28,new ot(6,15),new ot(2,16))),new t(11,Int32Array.from([6,30,54]),new qt(20,new ot(4,81)),new qt(30,new ot(1,50),new ot(4,51)),new qt(28,new ot(4,22),new ot(4,23)),new qt(24,new ot(3,12),new ot(8,13))),new t(12,Int32Array.from([6,32,58]),new qt(24,new ot(2,92),new ot(2,93)),new qt(22,new ot(6,36),new ot(2,37)),new qt(26,new ot(4,20),new ot(6,21)),new qt(28,new ot(7,14),new ot(4,15))),new t(13,Int32Array.from([6,34,62]),new qt(26,new ot(4,107)),new qt(22,new ot(8,37),new ot(1,38)),new qt(24,new ot(8,20),new ot(4,21)),new qt(22,new ot(12,11),new ot(4,12))),new t(14,Int32Array.from([6,26,46,66]),new qt(30,new ot(3,115),new ot(1,116)),new qt(24,new ot(4,40),new ot(5,41)),new qt(20,new ot(11,16),new ot(5,17)),new qt(24,new ot(11,12),new ot(5,13))),new t(15,Int32Array.from([6,26,48,70]),new qt(22,new ot(5,87),new ot(1,88)),new qt(24,new ot(5,41),new ot(5,42)),new qt(30,new ot(5,24),new ot(7,25)),new qt(24,new ot(11,12),new ot(7,13))),new t(16,Int32Array.from([6,26,50,74]),new qt(24,new ot(5,98),new ot(1,99)),new qt(28,new ot(7,45),new ot(3,46)),new qt(24,new ot(15,19),new ot(2,20)),new qt(30,new ot(3,15),new ot(13,16))),new t(17,Int32Array.from([6,30,54,78]),new qt(28,new ot(1,107),new ot(5,108)),new qt(28,new ot(10,46),new ot(1,47)),new qt(28,new ot(1,22),new ot(15,23)),new qt(28,new ot(2,14),new ot(17,15))),new t(18,Int32Array.from([6,30,56,82]),new qt(30,new ot(5,120),new ot(1,121)),new qt(26,new ot(9,43),new ot(4,44)),new qt(28,new ot(17,22),new ot(1,23)),new qt(28,new ot(2,14),new ot(19,15))),new t(19,Int32Array.from([6,30,58,86]),new qt(28,new ot(3,113),new ot(4,114)),new qt(26,new ot(3,44),new ot(11,45)),new qt(26,new ot(17,21),new ot(4,22)),new qt(26,new ot(9,13),new ot(16,14))),new t(20,Int32Array.from([6,34,62,90]),new qt(28,new ot(3,107),new ot(5,108)),new qt(26,new ot(3,41),new ot(13,42)),new qt(30,new ot(15,24),new ot(5,25)),new qt(28,new ot(15,15),new ot(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new qt(28,new ot(4,116),new ot(4,117)),new qt(26,new ot(17,42)),new qt(28,new ot(17,22),new ot(6,23)),new qt(30,new ot(19,16),new ot(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new qt(28,new ot(2,111),new ot(7,112)),new qt(28,new ot(17,46)),new qt(30,new ot(7,24),new ot(16,25)),new qt(24,new ot(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new qt(30,new ot(4,121),new ot(5,122)),new qt(28,new ot(4,47),new ot(14,48)),new qt(30,new ot(11,24),new ot(14,25)),new qt(30,new ot(16,15),new ot(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new qt(30,new ot(6,117),new ot(4,118)),new qt(28,new ot(6,45),new ot(14,46)),new qt(30,new ot(11,24),new ot(16,25)),new qt(30,new ot(30,16),new ot(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new qt(26,new ot(8,106),new ot(4,107)),new qt(28,new ot(8,47),new ot(13,48)),new qt(30,new ot(7,24),new ot(22,25)),new qt(30,new ot(22,15),new ot(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new qt(28,new ot(10,114),new ot(2,115)),new qt(28,new ot(19,46),new ot(4,47)),new qt(28,new ot(28,22),new ot(6,23)),new qt(30,new ot(33,16),new ot(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new qt(30,new ot(8,122),new ot(4,123)),new qt(28,new ot(22,45),new ot(3,46)),new qt(30,new ot(8,23),new ot(26,24)),new qt(30,new ot(12,15),new ot(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new qt(30,new ot(3,117),new ot(10,118)),new qt(28,new ot(3,45),new ot(23,46)),new qt(30,new ot(4,24),new ot(31,25)),new qt(30,new ot(11,15),new ot(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new qt(30,new ot(7,116),new ot(7,117)),new qt(28,new ot(21,45),new ot(7,46)),new qt(30,new ot(1,23),new ot(37,24)),new qt(30,new ot(19,15),new ot(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new qt(30,new ot(5,115),new ot(10,116)),new qt(28,new ot(19,47),new ot(10,48)),new qt(30,new ot(15,24),new ot(25,25)),new qt(30,new ot(23,15),new ot(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new qt(30,new ot(13,115),new ot(3,116)),new qt(28,new ot(2,46),new ot(29,47)),new qt(30,new ot(42,24),new ot(1,25)),new qt(30,new ot(23,15),new ot(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new qt(30,new ot(17,115)),new qt(28,new ot(10,46),new ot(23,47)),new qt(30,new ot(10,24),new ot(35,25)),new qt(30,new ot(19,15),new ot(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new qt(30,new ot(17,115),new ot(1,116)),new qt(28,new ot(14,46),new ot(21,47)),new qt(30,new ot(29,24),new ot(19,25)),new qt(30,new ot(11,15),new ot(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new qt(30,new ot(13,115),new ot(6,116)),new qt(28,new ot(14,46),new ot(23,47)),new qt(30,new ot(44,24),new ot(7,25)),new qt(30,new ot(59,16),new ot(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new qt(30,new ot(12,121),new ot(7,122)),new qt(28,new ot(12,47),new ot(26,48)),new qt(30,new ot(39,24),new ot(14,25)),new qt(30,new ot(22,15),new ot(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new qt(30,new ot(6,121),new ot(14,122)),new qt(28,new ot(6,47),new ot(34,48)),new qt(30,new ot(46,24),new ot(10,25)),new qt(30,new ot(2,15),new ot(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new qt(30,new ot(17,122),new ot(4,123)),new qt(28,new ot(29,46),new ot(14,47)),new qt(30,new ot(49,24),new ot(10,25)),new qt(30,new ot(24,15),new ot(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new qt(30,new ot(4,122),new ot(18,123)),new qt(28,new ot(13,46),new ot(32,47)),new qt(30,new ot(48,24),new ot(14,25)),new qt(30,new ot(42,15),new ot(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new qt(30,new ot(20,117),new ot(4,118)),new qt(28,new ot(40,47),new ot(7,48)),new qt(30,new ot(43,24),new ot(22,25)),new qt(30,new ot(10,15),new ot(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new qt(30,new ot(19,118),new ot(6,119)),new qt(28,new ot(18,47),new ot(31,48)),new qt(30,new ot(34,24),new ot(34,25)),new qt(30,new ot(20,15),new ot(61,16)))],t}(),$o;(function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"})($o||($o={}));var U$=function(){function t(e,r){this.value=e,this.isMasked=r}return t.prototype.unmaskBitMatrix=function(e,r){for(var n=0;n<r;n++)for(var a=0;a<r;a++)this.isMasked(n,a)&&e.flip(a,n)},t.values=new Map([[$o.DATA_MASK_000,new t($o.DATA_MASK_000,function(e,r){return(e+r&1)===0})],[$o.DATA_MASK_001,new t($o.DATA_MASK_001,function(e,r){return(e&1)===0})],[$o.DATA_MASK_010,new t($o.DATA_MASK_010,function(e,r){return r%3===0})],[$o.DATA_MASK_011,new t($o.DATA_MASK_011,function(e,r){return(e+r)%3===0})],[$o.DATA_MASK_100,new t($o.DATA_MASK_100,function(e,r){return(Math.floor(e/2)+Math.floor(r/3)&1)===0})],[$o.DATA_MASK_101,new t($o.DATA_MASK_101,function(e,r){return e*r%6===0})],[$o.DATA_MASK_110,new t($o.DATA_MASK_110,function(e,r){return e*r%6<3})],[$o.DATA_MASK_111,new t($o.DATA_MASK_111,function(e,r){return(e+r+e*r%3&1)===0})]]),t}(),A7e=function(){function t(e){var r=e.getHeight();if(r<21||(r&3)!==1)throw new Hr;this.bitMatrix=e}return t.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,r=0;r<6;r++)e=this.copyBit(r,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),s=0,o=a-7,n=a-1;n>=o;n--)s=this.copyBit(8,n,s);for(var r=a-8;r<a;r++)s=this.copyBit(r,8,s);if(this.parsedFormatInfo=_se.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Hr},t.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),r=Math.floor((e-17)/4);if(r<=6)return $p.getVersionForNumber(r);for(var n=0,a=e-11,s=5;s>=0;s--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,s,n);var l=$p.decodeVersionInformation(n);if(l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;n=0;for(var o=5;o>=0;o--)for(var s=e-9;s>=a;s--)n=this.copyBit(o,s,n);if(l=$p.decodeVersionInformation(n),l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;throw new Hr},t.prototype.copyBit=function(e,r,n){var a=this.isMirror?this.bitMatrix.get(r,e):this.bitMatrix.get(e,r);return a?n<<1|1:n<<1},t.prototype.readCodewords=function(){var e=this.readFormatInformation(),r=this.readVersion(),n=U$.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var s=r.buildFunctionPattern(),o=!0,l=new Uint8Array(r.getTotalCodewords()),c=0,u=0,d=0,f=a-1;f>0;f-=2){f===6&&f--;for(var A=0;A<a;A++)for(var h=o?a-1-A:A,m=0;m<2;m++)s.get(f-m,h)||(d++,u<<=1,this.bitMatrix.get(f-m,h)&&(u|=1),d===8&&(l[c++]=u,d=0,u=0));o=!o}if(c!==r.getTotalCodewords())throw new Hr;return l},t.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=U$.values.get(this.parsedFormatInfo.getDataMask()),r=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},t.prototype.mirror=function(){for(var e=this.bitMatrix,r=0,n=e.getWidth();r<n;r++)for(var a=r+1,s=e.getHeight();a<s;a++)e.get(r,a)!==e.get(a,r)&&(e.flip(a,r),e.flip(r,a))},t}(),Q$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r,n){var a,s,o,l;if(e.length!==r.getTotalCodewords())throw new Pn;var c=r.getECBlocksForLevel(n),u=0,d=c.getECBlocks();try{for(var f=Q$(d),A=f.next();!A.done;A=f.next()){var h=A.value;u+=h.getCount()}}catch(O){a={error:O}}finally{try{A&&!A.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}var m=new Array(u),p=0;try{for(var x=Q$(d),v=x.next();!v.done;v=x.next())for(var h=v.value,y=0;y<h.getCount();y++){var b=h.getDataCodewords(),w=c.getECCodewordsPerBlock()+b;m[p++]=new t(b,new Uint8Array(w))}}catch(O){o={error:O}}finally{try{v&&!v.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}for(var j=m[0].codewords.length,I=m.length-1;I>=0;){var _=m[I].codewords.length;if(_===j)break;I--}I++;for(var S=j-c.getECCodewordsPerBlock(),E=0,y=0;y<S;y++)for(var B=0;B<p;B++)m[B].codewords[y]=e[E++];for(var B=I;B<p;B++)m[B].codewords[S]=e[E++];for(var T=m[0].codewords.length,y=S;y<T;y++)for(var B=0;B<p;B++){var P=B<I?y:y+1;m[B].codewords[P]=e[E++]}return m},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),hd;(function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"})(hd||(hd={}));var Is=function(){function t(e,r,n,a){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,t.FOR_BITS.set(a,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var r=t.FOR_BITS.get(e);if(r===void 0)throw new Pn;return r},t.prototype.getCharacterCountBits=function(e){var r=e.getVersionNumber(),n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(hd.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(hd.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(hd.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(hd.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),t.BYTE=new t(hd.BYTE,"BYTE",Int32Array.from([8,16,16]),4),t.ECI=new t(hd.ECI,"ECI",Int32Array.from([0,0,0]),7),t.KANJI=new t(hd.KANJI,"KANJI",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(hd.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(hd.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),t.HANZI=new t(hd.HANZI,"HANZI",Int32Array.from([8,10,12]),13),t}(),p7e=function(){function t(){}return t.decode=function(e,r,n,a){var s=new Cse(e),o=new Zn,l=new Array,c=-1,u=-1;try{var d=null,f=!1,A=void 0;do{if(s.available()<4)A=Is.TERMINATOR;else{var h=s.readBits(4);A=Is.forBits(h)}switch(A){case Is.TERMINATOR:break;case Is.FNC1_FIRST_POSITION:case Is.FNC1_SECOND_POSITION:f=!0;break;case Is.STRUCTURED_APPEND:if(s.available()<16)throw new Hr;c=s.readBits(8),u=s.readBits(8);break;case Is.ECI:var m=t.parseECIValue(s);if(d=jo.getCharacterSetECIByValue(m),d===null)throw new Hr;break;case Is.HANZI:var p=s.readBits(4),x=s.readBits(A.getCharacterCountBits(r));p===t.GB2312_SUBSET&&t.decodeHanziSegment(s,o,x);break;default:var v=s.readBits(A.getCharacterCountBits(r));switch(A){case Is.NUMERIC:t.decodeNumericSegment(s,o,v);break;case Is.ALPHANUMERIC:t.decodeAlphanumericSegment(s,o,v,f);break;case Is.BYTE:t.decodeByteSegment(s,o,v,d,l,a);break;case Is.KANJI:t.decodeKanjiSegment(s,o,v);break;default:throw new Hr}break}}while(A!==Is.TERMINATOR)}catch{throw new Hr}return new xP(e,o.toString(),l.length===0?null:l,n===null?null:n.toString(),c,u)},t.decodeHanziSegment=function(e,r,n){if(n*13>e.available())throw new Hr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,a[s]=l>>8&255,a[s+1]=l&255,s+=2,n--}try{r.append(Bd.decode(a,ba.GB2312))}catch(c){throw new Hr(c)}},t.decodeKanjiSegment=function(e,r,n){if(n*13>e.available())throw new Hr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,a[s]=l>>8,a[s+1]=l,s+=2,n--}try{r.append(Bd.decode(a,ba.SHIFT_JIS))}catch(c){throw new Hr(c)}},t.decodeByteSegment=function(e,r,n,a,s,o){if(8*n>e.available())throw new Hr;for(var l=new Uint8Array(n),c=0;c<n;c++)l[c]=e.readBits(8);var u;a===null?u=ba.guessEncoding(l,o):u=a.getName();try{r.append(Bd.decode(l,u))}catch(d){throw new Hr(d)}s.push(l)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new Hr;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,r,n,a){for(var s=r.length();n>1;){if(e.available()<11)throw new Hr;var o=e.readBits(11);r.append(t.toAlphaNumericChar(Math.floor(o/45))),r.append(t.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new Hr;r.append(t.toAlphaNumericChar(e.readBits(6)))}if(a)for(var l=s;l<r.length();l++)r.charAt(l)==="%"&&(l<r.length()-1&&r.charAt(l+1)==="%"?r.deleteCharAt(l+1):r.setCharAt(l,""))},t.decodeNumericSegment=function(e,r,n){for(;n>=3;){if(e.available()<10)throw new Hr;var a=e.readBits(10);if(a>=1e3)throw new Hr;r.append(t.toAlphaNumericChar(Math.floor(a/100))),r.append(t.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(t.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new Hr;var s=e.readBits(7);if(s>=100)throw new Hr;r.append(t.toAlphaNumericChar(Math.floor(s/10))),r.append(t.toAlphaNumericChar(s%10))}else if(n===1){if(e.available()<4)throw new Hr;var o=e.readBits(4);if(o>=10)throw new Hr;r.append(t.toAlphaNumericChar(o))}},t.parseECIValue=function(e){var r=e.readBits(8);if(!(r&128))return r&127;if((r&192)===128){var n=e.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){var a=e.readBits(16);return(r&31)<<16&4294967295|a}throw new Hr},t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.GB2312_SUBSET=1,t}(),Ese=function(){function t(e){this.mirrored=e}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var r=e[0];e[0]=e[2],e[2]=r}},t}(),V$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},g7e=function(){function t(){this.rsDecoder=new vP(Jc.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(e,r){return this.decodeBitMatrix(lh.parseFromBooleanArray(e),r)},t.prototype.decodeBitMatrix=function(e,r){var n=new A7e(e),a=null;try{return this.decodeBitMatrixParser(n,r)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var s=this.decodeBitMatrixParser(n,r);return s.setOther(new Ese(!0)),s}catch(o){throw a!==null?a:o}},t.prototype.decodeBitMatrixParser=function(e,r){var n,a,s,o,l=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),u=e.readCodewords(),d=m7e.getDataBlocks(u,l,c),f=0;try{for(var A=V$(d),h=A.next();!h.done;h=A.next()){var m=h.value;f+=m.getNumDataCodewords()}}catch(I){n={error:I}}finally{try{h&&!h.done&&(a=A.return)&&a.call(A)}finally{if(n)throw n.error}}var p=new Uint8Array(f),x=0;try{for(var v=V$(d),y=v.next();!y.done;y=v.next()){var m=y.value,b=m.getCodewords(),w=m.getNumDataCodewords();this.correctErrors(b,w);for(var j=0;j<w;j++)p[x++]=b[j]}}catch(I){s={error:I}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(s)throw s.error}}return p7e.decode(p,l,c,r)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new oo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),x7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),v7e=function(t){x7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.estimatedModuleSize=a,s}return e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=(this.getX()+n)/2,o=(this.getY()+r)/2,l=(this.estimatedModuleSize+a)/2;return new e(s,o,l)},e}(dn),y7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},b7e=function(){function t(e,r,n,a,s,o,l){this.image=e,this.startX=r,this.startY=n,this.width=a,this.height=s,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var e=this.startX,r=this.height,n=this.width,a=e+n,s=this.startY+r/2,o=new Int32Array(3),l=this.image,c=0;c<r;c++){var u=s+(c&1?-Math.floor((c+1)/2):Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var d=e;d<a&&!l.get(d,u);)d++;for(var f=0;d<a;){if(l.get(d,u))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,d);if(A!==null)return A}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;d++}if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,a);if(A!==null)return A}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ur},t.centerFromEnd=function(e,r){return r-e[2]-e[1]/2},t.prototype.foundPatternCross=function(e){for(var r=this.moduleSize,n=r/2,a=0;a<3;a++)if(Math.abs(r-e[a])>=n)return!1;return!0},t.prototype.crossCheckVertical=function(e,r,n,a){var s=this.image,o=s.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;for(var c=e;c>=0&&s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&!s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c)&&l[1]<=n;)l[1]++,c++;if(c===o||l[1]>n)return NaN;for(;c<o&&!s.get(r,c)&&l[2]<=n;)l[2]++,c++;if(l[2]>n)return NaN;var u=l[0]+l[1]+l[2];return 5*Math.abs(u-a)>=2*a?NaN:this.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n){var a,s,o=e[0]+e[1]+e[2],l=t.centerFromEnd(e,n),c=this.crossCheckVertical(r,l,2*e[1],o);if(!isNaN(c)){var u=(e[0]+e[1]+e[2])/3;try{for(var d=y7e(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.aboutEquals(u,c,l))return A.combineEstimate(c,l,u)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}var h=new v7e(l,c,u);this.possibleCenters.push(h),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(h)}return null},t}(),w7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),N7e=function(t){w7e(e,t);function e(r,n,a,s){var o=t.call(this,r,n)||this;return o.estimatedModuleSize=a,o.count=s,s===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=this.count+1,o=(this.count*this.getX()+n)/s,l=(this.count*this.getY()+r)/s,c=(this.count*this.estimatedModuleSize+a)/s;return new e(o,l,c,s)},e}(dn),C7e=function(){function t(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t}(),vy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_7e=function(){function t(e,r){this.image=e,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var r=e!=null&&e.get(Ns.TRY_HARDER)!==void 0,n=e!=null&&e.get(Ns.PURE_BARCODE)!==void 0,a=this.image,s=a.getHeight(),o=a.getWidth(),l=Math.floor(3*s/(4*t.MAX_MODULES));(l<t.MIN_SKIP||r)&&(l=t.MIN_SKIP);for(var c=!1,u=new Int32Array(5),d=l-1;d<s&&!c;d+=l){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;for(var f=0,A=0;A<o;A++)if(a.get(A,d))(f&1)===1&&f++,u[f]++;else if(f&1)u[f]++;else if(f===4)if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,A,n);if(h===!0)if(l=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var m=this.findRowSkip();m>u[2]&&(d+=m-u[2]-l,A=o-1)}else{u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;continue}f=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;else u[++f]++;if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,o,n);h===!0&&(l=u[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var p=this.selectBestPatterns();return dn.orderBestPatterns(p),new C7e(p)},t.centerFromEnd=function(e,r){return r-e[4]-e[3]-e[2]/2},t.foundPatternCross=function(e){for(var r=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;r+=a}if(r<7)return!1;var s=r/7,o=s/2;return Math.abs(s-e[0])<o&&Math.abs(s-e[1])<o&&Math.abs(3*s-e[2])<3*o&&Math.abs(s-e[3])<o&&Math.abs(s-e[4])<o},t.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},t.prototype.crossCheckDiagonal=function(e,r,n,a){for(var s=this.getCrossCheckStateCount(),o=0,l=this.image;e>=o&&r>=o&&l.get(r-o,e-o);)s[2]++,o++;if(e<o||r<o)return!1;for(;e>=o&&r>=o&&!l.get(r-o,e-o)&&s[1]<=n;)s[1]++,o++;if(e<o||r<o||s[1]>n)return!1;for(;e>=o&&r>=o&&l.get(r-o,e-o)&&s[0]<=n;)s[0]++,o++;if(s[0]>n)return!1;var c=l.getHeight(),u=l.getWidth();for(o=1;e+o<c&&r+o<u&&l.get(r+o,e+o);)s[2]++,o++;if(e+o>=c||r+o>=u)return!1;for(;e+o<c&&r+o<u&&!l.get(r+o,e+o)&&s[3]<n;)s[3]++,o++;if(e+o>=c||r+o>=u||s[3]>=n)return!1;for(;e+o<c&&r+o<u&&l.get(r+o,e+o)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return!1;var d=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(d-a)<2*a&&t.foundPatternCross(s)},t.prototype.crossCheckVertical=function(e,r,n,a){for(var s=this.image,o=s.getHeight(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(r,c);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(r,c)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(r,c)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=2*a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.crossCheckHorizontal=function(e,r,n,a){for(var s=this.image,o=s.getWidth(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(c,r);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(c,r)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(c,r)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(c,r);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(c,r)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(c,r)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n,a){var s=e[0]+e[1]+e[2]+e[3]+e[4],o=t.centerFromEnd(e,n),l=this.crossCheckVertical(r,Math.floor(o),e[2],s);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),e[2],s),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),e[2],s)))){for(var c=s/7,u=!1,d=this.possibleCenters,f=0,A=d.length;f<A;f++){var h=d[f];if(h.aboutEquals(c,l,o)){d[f]=h.combineEstimate(l,o,c),u=!0;break}}if(!u){var m=new N7e(o,l,c);d.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return!0}return!1},t.prototype.findRowSkip=function(){var e,r,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var s=vy(this.possibleCenters),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.getCount()>=t.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,r,n,a,s=0,o=0,l=this.possibleCenters.length;try{for(var c=vy(this.possibleCenters),u=c.next();!u.done;u=c.next()){var d=u.value;d.getCount()>=t.CENTER_QUORUM&&(s++,o+=d.getEstimatedModuleSize())}}catch(p){e={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(s<3)return!1;var f=o/l,A=0;try{for(var h=vy(this.possibleCenters),m=h.next();!m.done;m=h.next()){var d=m.value;A+=Math.abs(d.getEstimatedModuleSize()-f)}}catch(p){n={error:p}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return A<=.05*o},t.prototype.selectBestPatterns=function(){var e,r,n,a,s=this.possibleCenters.length;if(s<3)throw new ur;var o=this.possibleCenters,l;if(s>3){var c=0,u=0;try{for(var d=vy(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value,h=A.getEstimatedModuleSize();c+=h,u+=h*h}}catch(j){e={error:j}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}l=c/s;var m=Math.sqrt(u/s-l*l);o.sort(function(j,I){var _=Math.abs(I.getEstimatedModuleSize()-l),S=Math.abs(j.getEstimatedModuleSize()-l);return _<S?-1:_>S?1:0});for(var p=Math.max(.2*l,m),x=0;x<o.length&&o.length>3;x++){var v=o[x];Math.abs(v.getEstimatedModuleSize()-l)>p&&(o.splice(x,1),x--)}}if(o.length>3){var c=0;try{for(var y=vy(o),b=y.next();!b.done;b=y.next()){var w=b.value;c+=w.getEstimatedModuleSize()}}catch(I){n={error:I}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}l=c/o.length,o.sort(function(I,_){if(_.getCount()===I.getCount()){var S=Math.abs(_.getEstimatedModuleSize()-l),E=Math.abs(I.getEstimatedModuleSize()-l);return S<E?1:S>E?-1:0}else return _.getCount()-I.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t}(),E7e=function(){function t(e){this.image=e}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(Ns.NEED_RESULT_POINT_CALLBACK);var r=new _7e(this.image,this.resultPointCallback),n=r.find(e);return this.processFinderPatternInfo(n)},t.prototype.processFinderPatternInfo=function(e){var r=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),s=this.calculateModuleSize(r,n,a);if(s<1)throw new ur("No pattern found in proccess finder.");var o=t.computeDimension(r,n,a,s),l=$p.getProvisionalVersionForDimension(o),c=l.getDimensionForVersion()-7,u=null;if(l.getAlignmentPatternCenters().length>0)for(var d=n.getX()-r.getX()+a.getX(),f=n.getY()-r.getY()+a.getY(),A=1-3/c,h=Math.floor(r.getX()+A*(d-r.getX())),m=Math.floor(r.getY()+A*(f-r.getY())),p=4;p<=16;p<<=1)try{u=this.findAlignmentInRegion(s,h,m,p);break}catch(b){if(!(b instanceof ur))throw b}var x=t.createTransform(r,n,a,u,o),v=t.sampleGrid(this.image,x,o),y;return u===null?y=[a,r,n]:y=[a,r,n,u],new OR(v,y)},t.createTransform=function(e,r,n,a,s){var o=s-3.5,l,c,u,d;return a!==null?(l=a.getX(),c=a.getY(),u=o-3,d=u):(l=r.getX()-e.getX()+n.getX(),c=r.getY()-e.getY()+n.getY(),u=o,d=o),yse.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,d,3.5,o,e.getX(),e.getY(),r.getX(),r.getY(),l,c,n.getX(),n.getY())},t.sampleGrid=function(e,r,n){var a=DR.getInstance();return a.sampleGridWithTransform(e,n,n,r)},t.computeDimension=function(e,r,n,a){var s=ja.round(dn.distance(e,r)/a),o=ja.round(dn.distance(e,n)/a),l=Math.floor((s+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new ur("Dimensions could be not found.")}return l},t.prototype.calculateModuleSize=function(e,r,n){return(this.calculateModuleSizeOneWay(e,r)+this.calculateModuleSizeOneWay(e,n))/2},t.prototype.calculateModuleSizeOneWay=function(e,r){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,r,n,a){var s=this.sizeOfBlackWhiteBlackRun(e,r,n,a),o=1,l=e-(n-e);l<0?(o=e/(e-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(l-e),l=this.image.getWidth()-1);var c=Math.floor(r-(a-r)*o);return o=1,c<0?(o=r/(r-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-r)/(c-r),c=this.image.getHeight()-1),l=Math.floor(e+(l-e)*o),s+=this.sizeOfBlackWhiteBlackRun(e,r,l,c),s-1},t.prototype.sizeOfBlackWhiteBlackRun=function(e,r,n,a){var s=Math.abs(a-r)>Math.abs(n-e);if(s){var o=e;e=r,r=o,o=n,n=a,a=o}for(var l=Math.abs(n-e),c=Math.abs(a-r),u=-l/2,d=e<n?1:-1,f=r<a?1:-1,A=0,h=n+d,m=e,p=r;m!==h;m+=d){var x=s?p:m,v=s?m:p;if(A===1===this.image.get(x,v)){if(A===2)return ja.distance(m,p,e,r);A++}if(u+=c,u>0){if(p===a)break;p+=f,u-=l}}return A===2?ja.distance(n+d,a,e,r):NaN},t.prototype.findAlignmentInRegion=function(e,r,n,a){var s=Math.floor(a*e),o=Math.max(0,r-s),l=Math.min(this.image.getWidth()-1,r+s);if(l-o<e*3)throw new ur("Alignment top exceeds estimated module size.");var c=Math.max(0,n-s),u=Math.min(this.image.getHeight()-1,n+s);if(u-c<e*3)throw new ur("Alignment bottom exceeds estimated module size.");var d=new b7e(this.image,o,c,l-o,u-c,e,this.resultPointCallback);return d.find()},t}(),rI=function(){function t(){this.decoder=new g7e}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,r){var n,a;if(r!=null&&r.get(Ns.PURE_BARCODE)!==void 0){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(s,r),a=t.NO_POINTS}else{var o=new E7e(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(o.getBits(),r),a=o.getPoints()}n.getOther()instanceof Ese&&n.getOther().applyMirroredCorrection(a);var l=new uc(n.getText(),n.getRawBytes(),void 0,a,jn.QR_CODE,void 0),c=n.getByteSegments();c!==null&&l.putMetadata(jl.BYTE_SEGMENTS,c);var u=n.getECLevel();return u!==null&&l.putMetadata(jl.ERROR_CORRECTION_LEVEL,u),n.hasStructuredAppend()&&(l.putMetadata(jl.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),l.putMetadata(jl.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),l},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r===null||n===null)throw new ur;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0];if(l>=c||s>=o)throw new ur;if(o-s!==c-l&&(c=l+(o-s),c>=e.getWidth()))throw new ur;var u=Math.round((c-l+1)/a),d=Math.round((o-s+1)/a);if(u<=0||d<=0)throw new ur;if(d!==u)throw new ur;var f=Math.floor(a/2);s+=f,l+=f;var A=l+Math.floor((u-1)*a)-c;if(A>0){if(A>f)throw new ur;l-=A}var h=s+Math.floor((d-1)*a)-o;if(h>0){if(h>f)throw new ur;s-=h}for(var m=new lh(u,d),p=0;p<d;p++)for(var x=s+Math.floor(p*a),v=0;v<u;v++)e.get(l+Math.floor(v*a),x)&&m.set(v,p);return m},t.moduleSize=function(e,r){for(var n=r.getHeight(),a=r.getWidth(),s=e[0],o=e[1],l=!0,c=0;s<a&&o<n;){if(l!==r.get(s,o)){if(++c===5)break;l=!l}s++,o++}if(s===a||o===n)throw new ur;return(s-e[0])/7},t.NO_POINTS=new Array,t}(),S7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Na=function(){function t(){}return t.prototype.PDF417Common=function(){},t.getBitCountSum=function(e){return ja.sum(e)},t.toIntArray=function(e){var r,n;if(e==null||!e.length)return t.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),s=0;try{for(var o=S7e(e),l=o.next();!l.done;l=o.next()){var c=l.value;a[s++]=c}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},t.getCodeword=function(e){var r=Bo.binarySearch(t.SYMBOL_TABLE,e&262143);return r<0?-1:(t.CODEWORD_TABLE[r]-1)%t.NUMBER_OF_CODEWORDS},t.NUMBER_OF_CODEWORDS=929,t.MAX_CODEWORDS_IN_BARCODE=t.NUMBER_OF_CODEWORDS-1,t.MIN_ROWS_IN_BARCODE=3,t.MAX_ROWS_IN_BARCODE=90,t.MODULES_IN_CODEWORD=17,t.MODULES_IN_STOP_PATTERN=18,t.BARS_IN_MODULE=8,t.EMPTY_INT_ARRAY=new Int32Array([]),t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),t}(),I7e=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),j7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P7e=function(){function t(){}return t.detectMultiple=function(e,r,n){var a=e.getBlackMatrix(),s=t.detect(n,a);return s.length||(a=a.clone(),a.rotate180(),s=t.detect(n,a)),new I7e(a,s)},t.detect=function(e,r){for(var n,a,s=new Array,o=0,l=0,c=!1;o<r.getHeight();){var u=t.findVertices(r,o,l);if(u[0]==null&&u[3]==null){if(!c)break;c=!1,l=0;try{for(var d=(n=void 0,j7e(s)),f=d.next();!f.done;f=d.next()){var A=f.value;A[1]!=null&&(o=Math.trunc(Math.max(o,A[1].getY()))),A[3]!=null&&(o=Math.max(o,Math.trunc(A[3].getY())))}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o+=t.ROW_STEP;continue}if(c=!0,s.push(u),!e)break;u[2]!=null?(l=Math.trunc(u[2].getX()),o=Math.trunc(u[2].getY())):(l=Math.trunc(u[4].getX()),o=Math.trunc(u[4].getY()))}return s},t.findVertices=function(e,r,n){var a=e.getHeight(),s=e.getWidth(),o=new Array(8);return t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.START_PATTERN),t.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY())),t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.STOP_PATTERN),t.INDEXES_STOP_PATTERN),o},t.copyToResult=function(e,r,n){for(var a=0;a<n.length;a++)e[n[a]]=r[a]},t.findRowsWithPattern=function(e,r,n,a,s,o){for(var l=new Array(4),c=!1,u=new Int32Array(o.length);a<r;a+=t.ROW_STEP){var d=t.findGuardPattern(e,s,a,n,!1,o,u);if(d!=null){for(;a>0;){var f=t.findGuardPattern(e,s,--a,n,!1,o,u);if(f!=null)d=f;else{a++;break}}l[0]=new dn(d[0],a),l[1]=new dn(d[1],a),c=!0;break}}var A=a+1;if(c){for(var h=0,f=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);A<r;A++){var d=t.findGuardPattern(e,f[0],A,n,!1,o,u);if(d!=null&&Math.abs(f[0]-d[0])<t.MAX_PATTERN_DRIFT&&Math.abs(f[1]-d[1])<t.MAX_PATTERN_DRIFT)f=d,h=0;else{if(h>t.SKIPPED_ROW_COUNT_MAX)break;h++}}A-=h+1,l[2]=new dn(f[0],A),l[3]=new dn(f[1],A)}return A-a<t.BARCODE_MIN_HEIGHT&&Bo.fill(l,null),l},t.findGuardPattern=function(e,r,n,a,s,o,l){Bo.fillWithin(l,0,l.length,0);for(var c=r,u=0;e.get(c,n)&&c>0&&u++<t.MAX_PIXEL_DRIFT;)c--;for(var d=c,f=0,A=o.length,h=s;d<a;d++){var m=e.get(d,n);if(m!==h)l[f]++;else{if(f===A-1){if(t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return new Int32Array([c,d]);c+=l[0]+l[1],ws.arraycopy(l,2,l,0,f-1),l[f-1]=0,l[f]=0,f--}else f++;l[f]=1,h=!h}}return f===A-1&&t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE?new Int32Array([c,d-1]):null},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return 1/0;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return 1/0;u+=h}return u/s},t.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),t.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),t.MAX_AVG_VARIANCE=.42,t.MAX_INDIVIDUAL_VARIANCE=.8,t.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),t.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),t.MAX_PIXEL_DRIFT=3,t.MAX_PATTERN_DRIFT=5,t.SKIPPED_ROW_COUNT_MAX=25,t.ROW_STEP=5,t.BARCODE_MIN_HEIGHT=10,t}(),B7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Sp=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),ws.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){var r,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var s=B7e(this.coefficients),o=s.next();!o.done;o=s.next()){var l=o.value;a=this.field.add(a,l)}}catch(f){r={error:f}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}for(var c=this.coefficients[0],u=this.coefficients.length,d=1;d<u;d++)c=this.field.add(this.field.multiply(e,c),this.coefficients[d]);return c},t.prototype.add=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ws.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=this.field.add(r[l-o],n[l]);return new t(this.field,s)},t.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},t.prototype.multiply=function(e){return e instanceof t?this.multiplyOther(e):this.multiplyScalar(e)},t.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new t(this.field,new Int32Array([0]));for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=0;l<n;l++)for(var c=r[l],u=0;u<s;u++)o[l+u]=this.field.add(o[l+u],this.field.multiply(c,a[u]));return new t(this.field,o)},t.prototype.negative=function(){for(var e=this.coefficients.length,r=new Int32Array(e),n=0;n<e;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new t(this.field,r)},t.prototype.multiplyScalar=function(e){if(e===0)return new t(this.field,new Int32Array([0]));if(e===1)return this;for(var r=this.coefficients.length,n=new Int32Array(r),a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new t(this.field,n)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return new t(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),s=0;s<n;s++)a[s]=this.field.multiply(this.coefficients[s],r);return new t(this.field,a)},t.prototype.toString=function(){for(var e=new Zn,r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(r===0||n!==1)&&e.append(n),r!==0&&(r===1?e.append("x"):(e.append("x^"),e.append(r))))}return e.toString()},t}(),T7e=function(){function t(){}return t.prototype.add=function(e,r){return(e+r)%this.modulus},t.prototype.subtract=function(e,r){return(this.modulus+e-r)%this.modulus},t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.prototype.inverse=function(e){if(e===0)throw new vse;return this.expTable[this.modulus-this.logTable[e]-1]},t.prototype.multiply=function(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.modulus-1)]},t.prototype.getSize=function(){return this.modulus},t.prototype.equals=function(e){return e===this},t}(),k7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),F7e=function(t){k7e(e,t);function e(r,n){var a=t.call(this)||this;a.modulus=r,a.expTable=new Int32Array(r),a.logTable=new Int32Array(r);for(var s=1,o=0;o<r;o++)a.expTable[o]=s,s=s*n%r;for(var o=0;o<r-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new Sp(a,new Int32Array([0])),a.one=new Sp(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new Sp(this,a)},e.PDF417_GF=new e(Na.NUMBER_OF_CODEWORDS,3),e}(T7e),O7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},D7e=function(){function t(){this.field=F7e.PDF417_GF}return t.prototype.decode=function(e,r,n){for(var a,s,o=new Sp(this.field,e),l=new Int32Array(r),c=!1,u=r;u>0;u--){var d=o.evaluateAt(this.field.exp(u));l[r-u]=d,d!==0&&(c=!0)}if(!c)return 0;var f=this.field.getOne();if(n!=null)try{for(var A=O7e(n),h=A.next();!h.done;h=A.next()){var m=h.value,p=this.field.exp(e.length-1-m),x=new Sp(this.field,new Int32Array([this.field.subtract(0,p),1]));f=f.multiply(x)}}catch(S){a={error:S}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}for(var v=new Sp(this.field,l),y=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),v,r),b=y[0],w=y[1],j=this.findErrorLocations(b),I=this.findErrorMagnitudes(w,b,j),u=0;u<j.length;u++){var _=e.length-1-this.field.log(j[u]);if(_<0)throw oo.getChecksumInstance();e[_]=this.field.subtract(e[_],I[u])}return j.length},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=e,o=r,l=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(n/2);){var u=s,d=l;if(s=o,l=c,s.isZero())throw oo.getChecksumInstance();o=u;for(var f=this.field.getZero(),A=s.getCoefficient(s.getDegree()),h=this.field.inverse(A);o.getDegree()>=s.getDegree()&&!o.isZero();){var m=o.getDegree()-s.getDegree(),p=this.field.multiply(o.getCoefficient(o.getDegree()),h);f=f.add(this.field.buildMonomial(m,p)),o=o.subtract(s.multiplyByMonomial(m,p))}c=f.multiply(l).subtract(d).negative()}var x=c.getCoefficient(0);if(x===0)throw oo.getChecksumInstance();var v=this.field.inverse(x),y=c.multiply(v),b=o.multiply(v);return[y,b]},t.prototype.findErrorLocations=function(e){for(var r=e.getDegree(),n=new Int32Array(r),a=0,s=1;s<this.field.getSize()&&a<r;s++)e.evaluateAt(s)===0&&(n[a]=this.field.inverse(s),a++);if(a!==r)throw oo.getChecksumInstance();return n},t.prototype.findErrorMagnitudes=function(e,r,n){for(var a=r.getDegree(),s=new Int32Array(a),o=1;o<=a;o++)s[a-o]=this.field.multiply(o,r.getCoefficient(o));for(var l=new Sp(this.field,s),c=n.length,u=new Int32Array(c),o=0;o<c;o++){var d=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(d)),A=this.field.inverse(l.evaluateAt(d));u[o]=this.field.multiply(f,A)}return u},t}(),fF=function(){function t(e,r,n,a,s){e instanceof t?this.constructor_2(e):this.constructor_1(e,r,n,a,s)}return t.prototype.constructor_1=function(e,r,n,a,s){var o=r==null||n==null,l=a==null||s==null;if(o&&l)throw new ur;o?(r=new dn(0,a.getY()),n=new dn(0,s.getY())):l&&(a=new dn(e.getWidth()-1,r.getY()),s=new dn(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=s,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),s.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))},t.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},t.merge=function(e,r){return e==null?r:r==null?e:new t(e.image,e.topLeft,e.bottomLeft,r.topRight,r.bottomRight)},t.prototype.addMissingRows=function(e,r,n){var a=this.topLeft,s=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(e>0){var c=n?this.topLeft:this.topRight,u=Math.trunc(c.getY()-e);u<0&&(u=0);var d=new dn(c.getX(),u);n?a=d:o=d}if(r>0){var f=n?this.bottomLeft:this.bottomRight,A=Math.trunc(f.getY()+r);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);var h=new dn(f.getX(),A);n?s=h:l=h}return new t(this.image,a,s,o,l)},t.prototype.getMinX=function(){return this.minX},t.prototype.getMaxX=function(){return this.maxX},t.prototype.getMinY=function(){return this.minY},t.prototype.getMaxY=function(){return this.maxY},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getBottomRight=function(){return this.bottomRight},t}(),R7e=function(){function t(e,r,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}return t.prototype.getColumnCount=function(){return this.columnCount},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},t.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},t}(),MR=function(){function t(){this.buffer=""}return t.form=function(e,r){var n=-1;function a(o,l,c,u,d,f){if(o==="%%")return"%";if(r[++n]!==void 0){o=u?parseInt(u.substr(1)):void 0;var A=d?parseInt(d.substr(1)):void 0,h;switch(f){case"s":h=r[n];break;case"c":h=r[n][0];break;case"f":h=parseFloat(r[n]).toFixed(o);break;case"p":h=parseFloat(r[n]).toPrecision(o);break;case"e":h=parseFloat(r[n]).toExponential(o);break;case"x":h=parseInt(r[n]).toString(A||16);break;case"d":h=parseFloat(parseInt(r[n],A||10).toPrecision(o)).toFixed(0);break}h=typeof h=="object"?JSON.stringify(h):(+h).toString(A);for(var m=parseInt(c),p=c&&c[0]+""=="0"?"0":" ";h.length<m;)h=l!==void 0?h+p:p+h;return h}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,a)},t.prototype.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.buffer+=t.form(e,r)},t.prototype.toString=function(){return this.buffer},t}(),M7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Sse=function(){function t(e){this.boundingBox=new fF(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return t.prototype.getCodewordNearby=function(e){var r=this.getCodeword(e);if(r!=null)return r;for(var n=1;n<t.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null},t.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},t.prototype.setCodeword=function(e,r){this.codewords[this.imageRowToCodewordIndex(e)]=r},t.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.getCodewords=function(){return this.codewords},t.prototype.toString=function(){var e,r,n=new MR,a=0;try{for(var s=M7e(this.codewords),o=s.next();!o.done;o=s.next()){var l=o.value;if(l==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n.toString()},t.MAX_NEARBY_DISTANCE=5,t}(),L7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},U7e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,s=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s},Jy=function(){function t(){this.values=new Map}return t.prototype.setValue=function(e){e=Math.trunc(e);var r=this.values.get(e);r==null&&(r=0),r++,this.values.set(e,r)},t.prototype.getValue=function(){var e,r,n=-1,a=new Array,s=function(f,A){var h={getKey:function(){return f},getValue:function(){return A}};h.getValue()>n?(n=h.getValue(),a=[],a.push(h.getKey())):h.getValue()===n&&a.push(h.getKey())};try{for(var o=L7e(this.values.entries()),l=o.next();!l.done;l=o.next()){var c=U7e(l.value,2),u=c[0],d=c[1];s(u,d)}}catch(f){e={error:f}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return Na.toIntArray(a)},t.prototype.getConfidence=function(e){return this.values.get(e)},t}(),Q7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H$=function(t){Q7e(e,t);function e(r,n){var a=t.call(this,r)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var r,n;try{for(var a=G5(this.getCodewords()),s=a.next();!s.done;s=a.next()){var o=s.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(r){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,r);for(var a=this.getBoundingBox(),s=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=-1,d=1,f=0,A=l;A<c;A++)if(n[A]!=null){var h=n[A],m=h.getRowNumber()-u;if(m===0)f++;else if(m===1)d=Math.max(d,f),f=1,u=h.getRowNumber();else if(m<0||h.getRowNumber()>=r.getRowCount()||m>A)n[A]=null;else{var p=void 0;d>2?p=(d-2)*m:p=m;for(var x=p>=A,v=1;v<=p&&!x;v++)x=n[A-v]!=null;x?n[A]=null:(u=h.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var r,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var s=new Int32Array(a.getRowCount());try{for(var o=G5(this.getCodewords()),l=o.next();!l.done;l=o.next()){var c=l.value;if(c!=null){var u=c.getRowNumber();if(u>=s.length)continue;s[u]++}}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(r){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),s=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.getCodewords(),u=-1,d=o;d<l;d++)if(c[d]!=null){var f=c[d];f.setRowNumberAsRowIndicatorColumn();var A=f.getRowNumber()-u;A===0||(A===1?u=f.getRowNumber():f.getRowNumber()>=r.getRowCount()?c[d]=null:u=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var r,n,a=this.getCodewords(),s=new Jy,o=new Jy,l=new Jy,c=new Jy;try{for(var u=G5(a),d=u.next();!d.done;d=u.next()){var f=d.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var A=f.getValue()%30,h=f.getRowNumber();switch(this._isLeft||(h+=2),h%3){case 0:o.setValue(A*3+1);break;case 1:c.setValue(A/3),l.setValue(A%3);break;case 2:s.setValue(A+1);break}}}}catch(p){r={error:p}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}if(s.getValue().length===0||o.getValue().length===0||l.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<Na.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>Na.MAX_ROWS_IN_BARCODE)return null;var m=new R7e(s.getValue()[0],o.getValue()[0],l.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(a,m),m},e.prototype.removeIncorrectCodewords=function(r,n){for(var a=0;a<r.length;a++){var s=r[a];if(r[a]!=null){var o=s.getValue()%30,l=s.getRowNumber();if(l>n.getRowCount()){r[a]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(r[a]=null);break;case 2:o+1!==n.getColumnCount()&&(r[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+t.prototype.toString.call(this)},e}(Sse),V7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H7e=function(){function t(e,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return t.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=Na.MAX_CODEWORDS_IN_BARCODE,r;do r=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<r);return this.detectionResultColumns},t.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},t.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var r=1;r<this.barcodeColumnCount+1;r++)for(var n=this.detectionResultColumns[r].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n));return e},t.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},t.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&r[n]!=null&&e[n].getRowNumber()===r[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var s=this.detectionResultColumns[a].getCodewords()[n];s!=null&&(s.setRowNumber(e[n].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},t.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=this.barcodeColumnCount+1;o>0&&s<this.ADJUST_ROW_NUMBER_SKIP;o--){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,r=this.detectionResultColumns[0].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=1;o<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;o++){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.adjustRowNumberIfValid=function(e,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),r=0):++r),r},t.prototype.adjustRowNumbers=function(e,r,n){var a,s;if(this.detectionResultColumns[e-1]!=null){var o=n[r],l=this.detectionResultColumns[e-1].getCodewords(),c=l;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var u=new Array(14);u[2]=l[r],u[3]=c[r],r>0&&(u[0]=n[r-1],u[4]=l[r-1],u[5]=c[r-1]),r>1&&(u[8]=n[r-2],u[10]=l[r-2],u[11]=c[r-2]),r<n.length-1&&(u[1]=n[r+1],u[6]=l[r+1],u[7]=c[r+1]),r<n.length-2&&(u[9]=n[r+2],u[12]=l[r+2],u[13]=c[r+2]);try{for(var d=V7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;if(t.adjustRowNumber(o,A))return}}catch(h){a={error:h}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}}},t.adjustRowNumber=function(e,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===e.getBucket()?(e.setRowNumber(r.getRowNumber()),!0):!1},t.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},t.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},t.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},t.prototype.setBoundingBox=function(e){this.boundingBox=e},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.setDetectionResultColumn=function(e,r){this.detectionResultColumns[e]=r},t.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},t.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var r=new MR,n=0;n<e.getCodewords().length;n++){r.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}var s=this.detectionResultColumns[a].getCodewords()[n];if(s==null){r.format("    |   ");continue}r.format(" %3d|%3d",s.getRowNumber(),s.getValue())}r.format("%n")}return r.toString()},t}(),$7e=function(){function t(e,r,n,a){this.rowNumber=t.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return t.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},t.prototype.isValidRowNumber=function(e){return e!==t.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},t.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},t.prototype.getWidth=function(){return this.endX-this.startX},t.prototype.getStartX=function(){return this.startX},t.prototype.getEndX=function(){return this.endX},t.prototype.getBucket=function(){return this.bucket},t.prototype.getValue=function(){return this.value},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.setRowNumber=function(e){this.rowNumber=e},t.prototype.toString=function(){return this.rowNumber+"|"+this.value},t.BARCODE_ROW_UNKNOWN=-1,t}(),G7e=function(){function t(){}return t.initialize=function(){for(var e=0;e<Na.SYMBOL_TABLE.length;e++)for(var r=Na.SYMBOL_TABLE[e],n=r&1,a=0;a<Na.BARS_IN_MODULE;a++){for(var s=0;(r&1)===n;)s+=1,r>>=1;n=r&1,t.RATIOS_TABLE[e]||(t.RATIOS_TABLE[e]=new Array(Na.BARS_IN_MODULE)),t.RATIOS_TABLE[e][Na.BARS_IN_MODULE-a-1]=Math.fround(s/Na.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},t.getDecodedValue=function(e){var r=t.getDecodedCodewordValue(t.sampleBitCounts(e));return r!==-1?r:t.getClosestDecodedValue(e)},t.sampleBitCounts=function(e){for(var r=ja.sum(e),n=new Int32Array(Na.BARS_IN_MODULE),a=0,s=0,o=0;o<Na.MODULES_IN_CODEWORD;o++){var l=r/(2*Na.MODULES_IN_CODEWORD)+o*r/Na.MODULES_IN_CODEWORD;s+e[a]<=l&&(s+=e[a],a++),n[a]++}return n},t.getDecodedCodewordValue=function(e){var r=t.getBitValue(e);return Na.getCodeword(r)===-1?-1:r},t.getBitValue=function(e){for(var r=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)},t.getClosestDecodedValue=function(e){var r=ja.sum(e),n=new Array(Na.BARS_IN_MODULE);if(r>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/r);var s=cF.MAX_VALUE,o=-1;this.bSymbolTableReady||t.initialize();for(var l=0;l<t.RATIOS_TABLE.length;l++){for(var c=0,u=t.RATIOS_TABLE[l],d=0;d<Na.BARS_IN_MODULE;d++){var f=Math.fround(u[d]-n[d]);if(c+=Math.fround(f*f),c>=s)break}c<s&&(s=c,o=Na.SYMBOL_TABLE[l])}return o},t.bSymbolTableReady=!1,t.RATIOS_TABLE=new Array(Na.SYMBOL_TABLE.length).map(function(e){return new Array(Na.BARS_IN_MODULE)}),t}(),K7e=function(){function t(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return t.prototype.getSegmentIndex=function(){return this.segmentIndex},t.prototype.setSegmentIndex=function(e){this.segmentIndex=e},t.prototype.getFileId=function(){return this.fileId},t.prototype.setFileId=function(e){this.fileId=e},t.prototype.getOptionalData=function(){return this.optionalData},t.prototype.setOptionalData=function(e){this.optionalData=e},t.prototype.isLastSegment=function(){return this.lastSegment},t.prototype.setLastSegment=function(e){this.lastSegment=e},t.prototype.getSegmentCount=function(){return this.segmentCount},t.prototype.setSegmentCount=function(e){this.segmentCount=e},t.prototype.getSender=function(){return this.sender||null},t.prototype.setSender=function(e){this.sender=e},t.prototype.getAddressee=function(){return this.addressee||null},t.prototype.setAddressee=function(e){this.addressee=e},t.prototype.getFileName=function(){return this.fileName},t.prototype.setFileName=function(e){this.fileName=e},t.prototype.getFileSize=function(){return this.fileSize},t.prototype.setFileSize=function(e){this.fileSize=e},t.prototype.getChecksum=function(){return this.checksum},t.prototype.setChecksum=function(e){this.checksum=e},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(e){this.timestamp=e},t}(),$$=function(){function t(){}return t.parseLong=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t}(),q7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z7e=function(t){q7e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="NullPointerException",e}(cu),W7e=function(){function t(){}return t.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},t.prototype.writeBytesOffset=function(e,r,n){if(e==null)throw new z7e;if(r<0||r>e.length||n<0||r+n>e.length||r+n<0)throw new FR;if(n===0)return;for(var a=0;a<n;a++)this.write(e[r+a])},t.prototype.flush=function(){},t.prototype.close=function(){},t}(),X7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Y7e=function(t){X7e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(cu),J7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z7e=function(t){J7e(e,t);function e(r){r===void 0&&(r=32);var n=t.call(this)||this;if(n.count=0,r<0)throw new Pn("Negative initial size: "+r);return n.buf=new Uint8Array(r),n}return e.prototype.ensureCapacity=function(r){r-this.buf.length>0&&this.grow(r)},e.prototype.grow=function(r){var n=this.buf.length,a=n<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new Y7e;a=sa.MAX_VALUE}this.buf=Bo.copyOfUint8Array(this.buf,a)},e.prototype.write=function(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1},e.prototype.writeBytesOffset=function(r,n,a){if(n<0||n>r.length||a<0||n+a-r.length>0)throw new FR;this.ensureCapacity(this.count+a),ws.arraycopy(r,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(r){r.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return Bo.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(r){return new String(this.buf).toString()},e.prototype.toString_number=function(r){return new String(this.buf).toString()},e.prototype.close=function(){},e}(W7e),is;(function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(is||(is={}));function Ise(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var l_;function I0(t){if(typeof l_>"u"&&(l_=Ise()),l_===null)throw new Error("BigInt is not supported!");return l_(t)}function e9e(){var t=[];t[0]=I0(1);var e=I0(900);t[1]=e;for(var r=2;r<16;r++)t[r]=t[r-1]*e;return t}var t9e=function(){function t(){}return t.decode=function(e,r){var n=new Zn(""),a=jo.ISO8859_1;n.enableDecoding(a);for(var s=1,o=e[s++],l=new K7e;s<e[0];){switch(o){case t.TEXT_COMPACTION_MODE_LATCH:s=t.textCompaction(e,s,n);break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:s=t.byteCompaction(o,e,a,s,n);break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s++]);break;case t.NUMERIC_COMPACTION_MODE_LATCH:s=t.numericCompaction(e,s,n);break;case t.ECI_CHARSET:jo.getCharacterSetECIByValue(e[s++]);break;case t.ECI_GENERAL_PURPOSE:s+=2;break;case t.ECI_USER_DEFINED:s++;break;case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=t.decodeMacroBlock(e,s,l);break;case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:throw new Hr;default:s--,s=t.textCompaction(e,s,n);break}if(s<e.length)o=e[s++];else throw Hr.getFormatInstance()}if(n.length()===0)throw Hr.getFormatInstance();var c=new xP(null,n.toString(),null,r);return c.setOther(l),c},t.decodeMacroBlock=function(e,r,n){if(r+t.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw Hr.getFormatInstance();for(var a=new Int32Array(t.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<t.NUMBER_OF_SEQUENCE_CODEWORDS;s++,r++)a[s]=e[r];n.setSegmentIndex(sa.parseInt(t.decodeBase900toBase10(a,t.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new Zn;r=t.textCompaction(e,r,o),n.setFileId(o.toString());var l=-1;for(e[r]===t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=r+1);r<e[0];)switch(e[r]){case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,e[r]){case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new Zn;r=t.textCompaction(e,r+1,c),n.setFileName(c.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var u=new Zn;r=t.textCompaction(e,r+1,u),n.setSender(u.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var d=new Zn;r=t.textCompaction(e,r+1,d),n.setAddressee(d.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new Zn;r=t.numericCompaction(e,r+1,f),n.setSegmentCount(sa.parseInt(f.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var A=new Zn;r=t.numericCompaction(e,r+1,A),n.setTimestamp($$.parseLong(A.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var h=new Zn;r=t.numericCompaction(e,r+1,h),n.setChecksum(sa.parseInt(h.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var m=new Zn;r=t.numericCompaction(e,r+1,m),n.setFileSize($$.parseLong(m.toString()));break;default:throw Hr.getFormatInstance()}break;case t.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw Hr.getFormatInstance()}if(l!==-1){var p=r-l;n.isLastSegment()&&p--,n.setOptionalData(Bo.copyOfRange(e,l,l+p))}return r},t.textCompaction=function(e,r,n){for(var a=new Int32Array((e[0]-r)*2),s=new Int32Array((e[0]-r)*2),o=0,l=!1;r<e[0]&&!l;){var c=e[r++];if(c<t.TEXT_COMPACTION_MODE_LATCH)a[o]=c/30,a[o+1]=c%30,o+=2;else switch(c){case t.TEXT_COMPACTION_MODE_LATCH:a[o++]=t.TEXT_COMPACTION_MODE_LATCH;break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,l=!0;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[r++],s[o]=c,o++;break}}return t.decodeTextCompaction(a,s,o,n),r},t.decodeTextCompaction=function(e,r,n,a){for(var s=is.ALPHA,o=is.ALPHA,l=0;l<n;){var c=e[l],u="";switch(s){case is.ALPHA:if(c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.LL:s=is.LOWER;break;case t.ML:s=is.MIXED;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.LOWER:if(c<26)u=String.fromCharCode(97+c);else switch(c){case 26:u=" ";break;case t.AS:o=s,s=is.ALPHA_SHIFT;break;case t.ML:s=is.MIXED;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.MIXED:if(c<t.PL)u=t.MIXED_CHARS[c];else switch(c){case t.PL:s=is.PUNCT;break;case 26:u=" ";break;case t.LL:s=is.LOWER;break;case t.AL:s=is.ALPHA;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.PUNCT:if(c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=is.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.ALPHA_SHIFT:if(s=o,c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.PUNCT_SHIFT:if(s=o,c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=is.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break}u!==""&&a.append(u),l++}},t.byteCompaction=function(e,r,n,a,s){var o=new Z7e,l=0,c=0,u=!1;switch(e){case t.BYTE_COMPACTION_MODE_LATCH:for(var d=new Int32Array(6),f=r[a++];a<r[0]&&!u;)switch(d[l++]=f,c=900*c+f,f=r[a++],f){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break;default:if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(I0(c)>>I0(8*(5-A))));c=0,l=0}break}a===r[0]&&f<t.TEXT_COMPACTION_MODE_LATCH&&(d[l++]=f);for(var h=0;h<l;h++)o.write(d[h]);break;case t.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!u;){var m=r[a++];if(m<t.TEXT_COMPACTION_MODE_LATCH)l++,c=900*c+m;else switch(m){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break}if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(I0(c)>>I0(8*(5-A))));c=0,l=0}}break}return s.append(Bd.decode(o.toByteArray(),n)),a},t.numericCompaction=function(e,r,n){for(var a=0,s=!1,o=new Int32Array(t.MAX_NUMERIC_CODEWORDS);r<e[0]&&!s;){var l=e[r++];if(r===e[0]&&(s=!0),l<t.TEXT_COMPACTION_MODE_LATCH)o[a]=l,a++;else switch(l){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,s=!0;break}(a%t.MAX_NUMERIC_CODEWORDS===0||l===t.NUMERIC_COMPACTION_MODE_LATCH||s)&&a>0&&(n.append(t.decodeBase900toBase10(o,a)),a=0)}return r},t.decodeBase900toBase10=function(e,r){for(var n=I0(0),a=0;a<r;a++)n+=t.EXP900[r-a-1]*I0(e[a]);var s=n.toString();if(s.charAt(0)!=="1")throw new Hr;return s.substring(1)},t.TEXT_COMPACTION_MODE_LATCH=900,t.BYTE_COMPACTION_MODE_LATCH=901,t.NUMERIC_COMPACTION_MODE_LATCH=902,t.BYTE_COMPACTION_MODE_LATCH_6=924,t.ECI_USER_DEFINED=925,t.ECI_GENERAL_PURPOSE=926,t.ECI_CHARSET=927,t.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,t.MACRO_PDF417_TERMINATOR=922,t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,t.MAX_NUMERIC_CODEWORDS=15,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,t.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,t.PL=25,t.LL=27,t.AS=27,t.ML=28,t.AL=28,t.PS=29,t.PAL=29,t.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,t.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",t.EXP900=Ise()?e9e():[],t.NUMBER_OF_SEQUENCE_CODEWORDS=2,t}(),yy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r9e=function(){function t(){}return t.decode=function(e,r,n,a,s,o,l){for(var c=new fF(e,r,n,a,s),u=null,d=null,f,A=!0;;A=!1){if(r!=null&&(u=t.getRowIndicatorColumn(e,c,r,!0,o,l)),a!=null&&(d=t.getRowIndicatorColumn(e,c,a,!1,o,l)),f=t.merge(u,d),f==null)throw ur.getNotFoundInstance();var h=f.getBoundingBox();if(A&&h!=null&&(h.getMinY()<c.getMinY()||h.getMaxY()>c.getMaxY()))c=h;else break}f.setBoundingBox(c);var m=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,u),f.setDetectionResultColumn(m,d);for(var p=u!=null,x=1;x<=m;x++){var v=p?x:m-x;if(f.getDetectionResultColumn(v)===void 0){var y=void 0;v===0||v===m?y=new H$(c,v===0):y=new Sse(c),f.setDetectionResultColumn(v,y);for(var b=-1,w=b,j=c.getMinY();j<=c.getMaxY();j++){if(b=t.getStartColumn(f,v,j,p),b<0||b>c.getMaxX()){if(w===-1)continue;b=w}var I=t.detectCodeword(e,c.getMinX(),c.getMaxX(),p,b,j,o,l);I!=null&&(y.setCodeword(j,I),w=b,o=Math.min(o,I.getWidth()),l=Math.max(l,I.getWidth()))}}}return t.createDecoderResult(f)},t.merge=function(e,r){if(e==null&&r==null)return null;var n=t.getBarcodeMetadata(e,r);if(n==null)return null;var a=fF.merge(t.adjustBoundingBox(e),t.adjustBoundingBox(r));return new H7e(n,a)},t.adjustBoundingBox=function(e){var r,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var s=t.getMax(a),o=0;try{for(var l=yy(a),c=l.next();!c.done;c=l.next()){var u=c.value;if(o+=s-u,u>0)break}}catch(h){r={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}for(var d=e.getCodewords(),f=0;o>0&&d[f]==null;f++)o--;for(var A=0,f=a.length-1;f>=0&&(A+=s-a[f],!(a[f]>0));f--);for(var f=d.length-1;A>0&&d[f]==null;f--)A--;return e.getBoundingBox().addMissingRows(o,A,e.isLeft())},t.getMax=function(e){var r,n,a=-1;try{for(var s=yy(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=Math.max(a,l)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.getBarcodeMetadata=function(e,r){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();var a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},t.getRowIndicatorColumn=function(e,r,n,a,s,o){for(var l=new H$(r,a),c=0;c<2;c++)for(var u=c===0?1:-1,d=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=r.getMaxY()&&f>=r.getMinY();f+=u){var A=t.detectCodeword(e,0,e.getWidth(),a,d,f,s,o);A!=null&&(l.setCodeword(f,A),a?d=A.getStartX():d=A.getEndX())}return l},t.adjustCodewordCount=function(e,r){var n=r[0][1],a=n.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-t.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(s<1||s>Na.MAX_CODEWORDS_IN_BARCODE)throw ur.getNotFoundInstance();n.setValue(s)}else a[0]!==s&&n.setValue(s)},t.createDecoderResult=function(e){var r=t.createBarcodeMatrix(e);t.adjustCodewordCount(e,r);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],o=new Array,l=0;l<e.getBarcodeRowCount();l++)for(var c=0;c<e.getBarcodeColumnCount();c++){var u=r[l][c+1].getValue(),d=l*e.getBarcodeColumnCount()+c;u.length===0?n.push(d):u.length===1?a[d]=u[0]:(o.push(d),s.push(u))}for(var f=new Array(s.length),A=0;A<f.length;A++)f[A]=s[A];return t.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,Na.toIntArray(n),Na.toIntArray(o),f)},t.createDecoderResultFromAmbiguousValues=function(e,r,n,a,s){for(var o=new Int32Array(a.length),l=100;l-- >0;){for(var c=0;c<o.length;c++)r[a[c]]=s[c][o[c]];try{return t.decodeCodewords(r,e,n)}catch(d){var u=d instanceof oo;if(!u)throw d}if(o.length===0)throw oo.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<s[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw oo.getChecksumInstance()}throw oo.getChecksumInstance()},t.createBarcodeMatrix=function(e){for(var r,n,a,s,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]=new Jy;var u=0;try{for(var d=yy(e.getDetectionResultColumns()),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)try{for(var h=(a=void 0,yy(A.getCodewords())),m=h.next();!m.done;m=h.next()){var p=m.value;if(p!=null){var x=p.getRowNumber();if(x>=0){if(x>=o.length)continue;o[x][u].setValue(p.getValue())}}}}catch(v){a={error:v}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}u++}}catch(v){r={error:v}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return o},t.isValidBarcodeColumn=function(e,r){return r>=0&&r<=e.getBarcodeColumnCount()+1},t.getStartColumn=function(e,r,n,a){var s,o,l=a?1:-1,c=null;if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodeword(n)),c!=null)return a?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(r).getCodewordNearby(n),c!=null)return a?c.getStartX():c.getEndX();if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodewordNearby(n)),c!=null)return a?c.getEndX():c.getStartX();for(var u=0;t.isValidBarcodeColumn(e,r-l);){r-=l;try{for(var d=(s=void 0,yy(e.getDetectionResultColumn(r).getCodewords())),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)return(a?A.getEndX():A.getStartX())+l*u*(A.getEndX()-A.getStartX())}}catch(h){s={error:h}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(s)throw s.error}}u++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},t.detectCodeword=function(e,r,n,a,s,o,l,c){s=t.adjustCodewordStartColumn(e,r,n,a,s,o);var u=t.getModuleBitCount(e,r,n,a,s,o);if(u==null)return null;var d,f=ja.sum(u);if(a)d=s+f;else{for(var A=0;A<u.length/2;A++){var h=u[A];u[A]=u[u.length-1-A],u[u.length-1-A]=h}d=s,s=d-f}if(!t.checkCodewordSkew(f,l,c))return null;var m=G7e.getDecodedValue(u),p=Na.getCodeword(m);return p===-1?null:new $7e(s,d,t.getCodewordBucketNumber(m),p)},t.getModuleBitCount=function(e,r,n,a,s,o){for(var l=s,c=new Int32Array(8),u=0,d=a?1:-1,f=a;(a?l<n:l>=r)&&u<c.length;)e.get(l,o)===f?(c[u]++,l+=d):(u++,f=!f);return u===c.length||l===(a?n:r)&&u===c.length-1?c:null},t.getNumberOfECCodeWords=function(e){return 2<<e},t.adjustCodewordStartColumn=function(e,r,n,a,s,o){for(var l=s,c=a?-1:1,u=0;u<2;u++){for(;(a?l>=r:l<n)&&a===e.get(l,o);){if(Math.abs(s-l)>t.CODEWORD_SKEW_SIZE)return s;l+=c}c=-c,a=!a}return l},t.checkCodewordSkew=function(e,r,n){return r-t.CODEWORD_SKEW_SIZE<=e&&e<=n+t.CODEWORD_SKEW_SIZE},t.decodeCodewords=function(e,r,n){if(e.length===0)throw Hr.getFormatInstance();var a=1<<r+1,s=t.correctErrors(e,n,a);t.verifyCodewordCount(e,a);var o=t9e.decode(e,""+r);return o.setErrorsCorrected(s),o.setErasures(n.length),o},t.correctErrors=function(e,r,n){if(r!=null&&r.length>n/2+t.MAX_ERRORS||n<0||n>t.MAX_EC_CODEWORDS)throw oo.getChecksumInstance();return t.errorCorrection.decode(e,n,r)},t.verifyCodewordCount=function(e,r){if(e.length<4)throw Hr.getFormatInstance();var n=e[0];if(n>e.length)throw Hr.getFormatInstance();if(n===0)if(r<e.length)e[0]=e.length-r;else throw Hr.getFormatInstance()},t.getBitCountForCodeword=function(e){for(var r=new Int32Array(8),n=0,a=r.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)r[a]++,e>>=1;return r},t.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},t.getCodewordBucketNumber_number=function(e){return t.getCodewordBucketNumber(t.getBitCountForCodeword(e))},t.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},t.toString=function(e){for(var r=new MR,n=0;n<e.length;n++){r.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var s=e[n][a];s.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}r.format("%n")}return r.toString()},t.CODEWORD_SKEW_SIZE=2,t.MAX_ERRORS=3,t.MAX_EC_CODEWORDS=512,t.errorCorrection=new D7e,t}(),n9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},nI=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=t.decode(e,r,!1);if(n==null||n.length===0||n[0]==null)throw ur.getNotFoundInstance();return n[0]},t.prototype.decodeMultiple=function(e,r){r===void 0&&(r=null);try{return t.decode(e,r,!0)}catch(n){throw n instanceof Hr||n instanceof oo?ur.getNotFoundInstance():n}},t.decode=function(e,r,n){var a,s,o=new Array,l=P7e.detectMultiple(e,r,n);try{for(var c=n9e(l.getPoints()),u=c.next();!u.done;u=c.next()){var d=u.value,f=r9e.decode(l.getBits(),d[4],d[5],d[6],d[7],t.getMinCodewordWidth(d),t.getMaxCodewordWidth(d)),A=new uc(f.getText(),f.getRawBytes(),void 0,d,jn.PDF_417);A.putMetadata(jl.ERROR_CORRECTION_LEVEL,f.getECLevel());var h=f.getOther();h!=null&&A.putMetadata(jl.PDF417_EXTRA_METADATA,h),o.push(A)}}catch(m){a={error:m}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return o.map(function(m){return m})},t.getMaxWidth=function(e,r){return e==null||r==null?0:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMinWidth=function(e,r){return e==null||r==null?sa.MAX_VALUE:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(t.getMaxWidth(e[0],e[4]),t.getMaxWidth(e[6],e[2])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN),Math.max(t.getMaxWidth(e[1],e[5]),t.getMaxWidth(e[7],e[3])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN)))},t.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(t.getMinWidth(e[0],e[4]),t.getMinWidth(e[6],e[2])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN),Math.min(t.getMinWidth(e[1],e[5]),t.getMinWidth(e[7],e[3])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN)))},t.prototype.reset=function(){},t}(),a9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G$=function(t){a9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReaderException",e}(cu),K$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},jse=function(){function t(){}return t.prototype.decode=function(e,r){return this.setHints(r),this.decodeInternal(e)},t.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},t.prototype.setHints=function(e){this.hints=e;var r=e!=null&&e.get(Ns.TRY_HARDER)!==void 0,n=e==null?null:e.get(Ns.POSSIBLE_FORMATS),a=new Array;if(n!=null){var s=n.some(function(o){return o===jn.UPC_A||o===jn.UPC_E||o===jn.EAN_13||o===jn.EAN_8||o===jn.CODABAR||o===jn.CODE_39||o===jn.CODE_93||o===jn.CODE_128||o===jn.ITF||o===jn.RSS_14||o===jn.RSS_EXPANDED});s&&!r&&a.push(new Yx(e)),n.includes(jn.QR_CODE)&&a.push(new rI),n.includes(jn.DATA_MATRIX)&&a.push(new tI),n.includes(jn.AZTEC)&&a.push(new ZS),n.includes(jn.PDF_417)&&a.push(new nI),s&&r&&a.push(new Yx(e))}a.length===0&&(r||a.push(new Yx(e)),a.push(new rI),a.push(new tI),a.push(new ZS),a.push(new nI),r&&a.push(new Yx(e))),this.readers=a},t.prototype.reset=function(){var e,r;if(this.readers!==null)try{for(var n=K$(this.readers),a=n.next();!a.done;a=n.next()){var s=a.value;s.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.decodeInternal=function(e){var r,n;if(this.readers===null)throw new G$("No readers where selected, nothing can be read.");try{for(var a=K$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;try{return o.decode(e,this.hints)}catch(l){if(l instanceof G$)continue}}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new ur("No MultiFormat Readers were able to detect the code.")},t}(),s9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){s9e(e,t);function e(r,n){r===void 0&&(r=null),n===void 0&&(n=500);var a=this,s=new jse;return s.setHints(r),a=t.call(this,s,n)||this,a}return e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e})(w1);var i9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){i9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new nI,r)||this}return e})(w1);var o9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){o9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new rI,r)||this}return e})(w1);var hF;(function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",t[t.MIN_SIZE=4]="MIN_SIZE",t[t.MAX_SIZE=5]="MAX_SIZE",t[t.MARGIN=6]="MARGIN",t[t.PDF417_COMPACT=7]="PDF417_COMPACT",t[t.PDF417_COMPACTION=8]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=10]="AZTEC_LAYERS",t[t.QR_VERSION=11]="QR_VERSION",t[t.GS1_FORMAT=12]="GS1_FORMAT",t[t.FORCE_C40=13]="FORCE_C40"})(hF||(hF={}));const c_=hF;var Pse=function(){function t(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new hm(e,Int32Array.from([1])))}return t.prototype.buildGenerator=function(e){var r=this.cachedGenerators;if(e>=r.length)for(var n=r[r.length-1],a=this.field,s=r.length;s<=e;s++){var o=n.multiply(new hm(a,Int32Array.from([1,a.exp(s-1+a.getGeneratorBase())])));r.push(o),n=o}return r[e]},t.prototype.encode=function(e,r){if(r===0)throw new Pn("No error correction bytes");var n=e.length-r;if(n<=0)throw new Pn("No data bytes provided");var a=this.buildGenerator(r),s=new Int32Array(n);ws.arraycopy(e,0,s,0,n);var o=new hm(this.field,s);o=o.multiplyByMonomial(r,1);for(var l=o.divide(a)[1],c=l.getCoefficients(),u=r-c.length,d=0;d<u;d++)e[n+d]=0;ws.arraycopy(c,0,e,n+u,c.length)},t}(),Zy=function(){function t(){}return t.applyMaskPenaltyRule1=function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)},t.applyMaskPenaltyRule2=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s-1;o++)for(var l=n[o],c=0;c<a-1;c++){var u=l[c];u===l[c+1]&&u===n[o+1][c]&&u===n[o+1][c+1]&&r++}return t.N2*r},t.applyMaskPenaltyRule3=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=0;l<a;l++){var c=n[o];l+6<a&&c[l]===1&&c[l+1]===0&&c[l+2]===1&&c[l+3]===1&&c[l+4]===1&&c[l+5]===0&&c[l+6]===1&&(t.isWhiteHorizontal(c,l-4,l)||t.isWhiteHorizontal(c,l+7,l+11))&&r++,o+6<s&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(t.isWhiteVertical(n,l,o-4,o)||t.isWhiteVertical(n,l,o+7,o+11))&&r++}return r*t.N3},t.isWhiteHorizontal=function(e,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(var a=r;a<n;a++)if(e[a]===1)return!1;return!0},t.isWhiteVertical=function(e,r,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var s=n;s<a;s++)if(e[s][r]===1)return!1;return!0},t.applyMaskPenaltyRule4=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=n[o],c=0;c<a;c++)l[c]===1&&r++;var u=e.getHeight()*e.getWidth(),d=Math.floor(Math.abs(r*2-u)*10/u);return d*t.N4},t.getDataMaskBit=function(e,r,n){var a,s;switch(e){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:s=n*r,a=(s&1)+s%3;break;case 6:s=n*r,a=(s&1)+s%3&1;break;case 7:s=n*r,a=s%3+(n+r&1)&1;break;default:throw new Pn("Invalid mask pattern: "+e)}return a===0},t.applyMaskPenaltyRule1Internal=function(e,r){for(var n=0,a=r?e.getHeight():e.getWidth(),s=r?e.getWidth():e.getHeight(),o=e.getArray(),l=0;l<a;l++){for(var c=0,u=-1,d=0;d<s;d++){var f=r?o[l][d]:o[d][l];f===u?c++:(c>=5&&(n+=t.N1+(c-5)),c=1,u=f)}c>=5&&(n+=t.N1+(c-5))}return n},t.N1=3,t.N2=3,t.N3=40,t.N4=10,t}(),l9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c9e=function(){function t(e,r){this.width=e,this.height=r;for(var n=new Array(r),a=0;a!==r;a++)n[a]=new Uint8Array(e);this.bytes=n}return t.prototype.getHeight=function(){return this.height},t.prototype.getWidth=function(){return this.width},t.prototype.get=function(e,r){return this.bytes[r][e]},t.prototype.getArray=function(){return this.bytes},t.prototype.setNumber=function(e,r,n){this.bytes[r][e]=n},t.prototype.setBoolean=function(e,r,n){this.bytes[r][e]=n?1:0},t.prototype.clear=function(e){var r,n;try{for(var a=l9e(this.bytes),s=a.next();!s.done;s=a.next()){var o=s.value;Bo.fill(o,e)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;if(this.width!==r.width||this.height!==r.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var s=this.bytes[n],o=r.bytes[n],l=0,c=this.width;l<c;++l)if(s[l]!==o[l])return!1;return!0},t.prototype.toString=function(){for(var e=new Zn,r=0,n=this.height;r<n;++r){for(var a=this.bytes[r],s=0,o=this.width;s<o;++s)switch(a[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},t}(),AF=function(){function t(){this.maskPattern=-1}return t.prototype.getMode=function(){return this.mode},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getVersion=function(){return this.version},t.prototype.getMaskPattern=function(){return this.maskPattern},t.prototype.getMatrix=function(){return this.matrix},t.prototype.toString=function(){var e=new Zn;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},t.prototype.setMode=function(e){this.mode=e},t.prototype.setECLevel=function(e){this.ecLevel=e},t.prototype.setVersion=function(e){this.version=e},t.prototype.setMaskPattern=function(e){this.maskPattern=e},t.prototype.setMatrix=function(e){this.matrix=e},t.isValidMaskPattern=function(e){return e>=0&&e<t.NUM_MASK_PATTERNS},t.NUM_MASK_PATTERNS=8,t}(),u9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ss=function(t){u9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="WriterException",e}(cu),q$=function(){function t(){}return t.clearMatrix=function(e){e.clear(255)},t.buildMatrix=function(e,r,n,a,s){t.clearMatrix(s),t.embedBasicPatterns(n,s),t.embedTypeInfo(r,a,s),t.maybeEmbedVersionInfo(n,s),t.embedDataBits(e,a,s)},t.embedBasicPatterns=function(e,r){t.embedPositionDetectionPatternsAndSeparators(r),t.embedDarkDotAtLeftBottomCorner(r),t.maybeEmbedPositionAdjustmentPatterns(e,r),t.embedTimingPatterns(r)},t.embedTypeInfo=function(e,r,n){var a=new el;t.makeTypeInfoBits(e,r,a);for(var s=0,o=a.getSize();s<o;++s){var l=a.get(a.getSize()-1-s),c=t.TYPE_INFO_COORDINATES[s],u=c[0],d=c[1];if(n.setBoolean(u,d,l),s<8){var f=n.getWidth()-s-1,A=8;n.setBoolean(f,A,l)}else{var f=8,A=n.getHeight()-7+(s-8);n.setBoolean(f,A,l)}}},t.maybeEmbedVersionInfo=function(e,r){if(!(e.getVersionNumber()<7)){var n=new el;t.makeVersionInfoBits(e,n);for(var a=6*3-1,s=0;s<6;++s)for(var o=0;o<3;++o){var l=n.get(a);a--,r.setBoolean(s,r.getHeight()-11+o,l),r.setBoolean(r.getHeight()-11+o,s,l)}}},t.embedDataBits=function(e,r,n){for(var a=0,s=-1,o=n.getWidth()-1,l=n.getHeight()-1;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(var c=0;c<2;++c){var u=o-c;if(t.isEmpty(n.get(u,l))){var d=void 0;a<e.getSize()?(d=e.get(a),++a):d=!1,r!==255&&Zy.getDataMaskBit(r,u,l)&&(d=!d),n.setBoolean(u,l,d)}}l+=s}s=-s,l+=s,o-=2}if(a!==e.getSize())throw new Ss("Not all bits consumed: "+a+"/"+e.getSize())},t.findMSBSet=function(e){return 32-sa.numberOfLeadingZeros(e)},t.calculateBCHCode=function(e,r){if(r===0)throw new Pn("0 polynomial");var n=t.findMSBSet(r);for(e<<=n-1;t.findMSBSet(e)>=n;)e^=r<<t.findMSBSet(e)-n;return e},t.makeTypeInfoBits=function(e,r,n){if(!AF.isValidMaskPattern(r))throw new Ss("Invalid mask pattern");var a=e.getBits()<<3|r;n.appendBits(a,5);var s=t.calculateBCHCode(a,t.TYPE_INFO_POLY);n.appendBits(s,10);var o=new el;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new Ss("should not happen but we got: "+n.getSize())},t.makeVersionInfoBits=function(e,r){r.appendBits(e.getVersionNumber(),6);var n=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new Ss("should not happen but we got: "+r.getSize())},t.isEmpty=function(e){return e===255},t.embedTimingPatterns=function(e){for(var r=8;r<e.getWidth()-8;++r){var n=(r+1)%2;t.isEmpty(e.get(r,6))&&e.setNumber(r,6,n),t.isEmpty(e.get(6,r))&&e.setNumber(6,r,n)}},t.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new Ss;e.setNumber(8,e.getHeight()-8,1)},t.embedHorizontalSeparationPattern=function(e,r,n){for(var a=0;a<8;++a){if(!t.isEmpty(n.get(e+a,r)))throw new Ss;n.setNumber(e+a,r,0)}},t.embedVerticalSeparationPattern=function(e,r,n){for(var a=0;a<7;++a){if(!t.isEmpty(n.get(e,r+a)))throw new Ss;n.setNumber(e,r+a,0)}},t.embedPositionAdjustmentPattern=function(e,r,n){for(var a=0;a<5;++a)for(var s=t.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPattern=function(e,r,n){for(var a=0;a<7;++a)for(var s=t.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPatternsAndSeparators=function(e){var r=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-r,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-r,e);var n=8;t.embedHorizontalSeparationPattern(0,n-1,e),t.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;t.embedVerticalSeparationPattern(a,0,e),t.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),t.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},t.maybeEmbedPositionAdjustmentPatterns=function(e,r){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],s=0,o=a.length;s!==o;s++){var l=a[s];if(l>=0)for(var c=0;c!==o;c++){var u=a[c];u>=0&&t.isEmpty(r.get(u,l))&&t.embedPositionAdjustmentPattern(u-2,l-2,r)}}},t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),t.VERSION_INFO_POLY=7973,t.TYPE_INFO_POLY=1335,t.TYPE_INFO_MASK_PATTERN=21522,t}(),d9e=function(){function t(e,r){this.dataBytes=e,this.errorCorrectionBytes=r}return t.prototype.getDataBytes=function(){return this.dataBytes},t.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},t}(),z$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.calculateMaskPenalty=function(e){return Zy.applyMaskPenaltyRule1(e)+Zy.applyMaskPenaltyRule2(e)+Zy.applyMaskPenaltyRule3(e)+Zy.applyMaskPenaltyRule4(e)},t.encode=function(e,r,n){n===void 0&&(n=null);var a=t.DEFAULT_BYTE_MODE_ENCODING,s=n!==null&&n.get(c_.CHARACTER_SET)!==void 0;s&&(a=n.get(c_.CHARACTER_SET).toString());var o=this.chooseMode(e,a),l=new el;if(o===Is.BYTE&&(s||t.DEFAULT_BYTE_MODE_ENCODING!==a)){var c=jo.getCharacterSetECIByName(a);c!==void 0&&this.appendECI(c,l)}this.appendModeInfo(o,l);var u=new el;this.appendBytes(e,o,u,a);var d;if(n!==null&&n.get(c_.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(c_.QR_VERSION).toString(),10);d=$p.getVersionForNumber(f);var A=this.calculateBitsNeeded(o,l,u,d);if(!this.willFit(A,d,r))throw new Ss("Data too big for requested version")}else d=this.recommendVersion(r,o,l,u);var h=new el;h.appendBitArray(l);var m=o===Is.BYTE?u.getSizeInBytes():e.length;this.appendLengthInfo(m,d,o,h),h.appendBitArray(u);var p=d.getECBlocksForLevel(r),x=d.getTotalCodewords()-p.getTotalECCodewords();this.terminateBits(x,h);var v=this.interleaveWithECBytes(h,d.getTotalCodewords(),x,p.getNumBlocks()),y=new AF;y.setECLevel(r),y.setMode(o),y.setVersion(d);var b=d.getDimensionForVersion(),w=new c9e(b,b),j=this.chooseMaskPattern(v,r,d,w);return y.setMaskPattern(j),q$.buildMatrix(v,r,d,j,w),y.setMatrix(w),y},t.recommendVersion=function(e,r,n,a){var s=this.calculateBitsNeeded(r,n,a,$p.getVersionForNumber(1)),o=this.chooseVersion(s,e),l=this.calculateBitsNeeded(r,n,a,o);return this.chooseVersion(l,e)},t.calculateBitsNeeded=function(e,r,n,a){return r.getSize()+e.getCharacterCountBits(a)+n.getSize()},t.getAlphanumericCode=function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1},t.chooseMode=function(e,r){if(r===void 0&&(r=null),jo.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(e))return Is.KANJI;for(var n=!1,a=!1,s=0,o=e.length;s<o;++s){var l=e.charAt(s);if(t.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)a=!0;else return Is.BYTE}return a?Is.ALPHANUMERIC:n?Is.NUMERIC:Is.BYTE},t.isOnlyDoubleByteKanji=function(e){var r;try{r=Bd.encode(e,jo.SJIS)}catch{return!1}var n=r.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var s=r[a]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},t.chooseMaskPattern=function(e,r,n,a){for(var s=Number.MAX_SAFE_INTEGER,o=-1,l=0;l<AF.NUM_MASK_PATTERNS;l++){q$.buildMatrix(e,r,n,l,a);var c=this.calculateMaskPenalty(a);c<s&&(s=c,o=l)}return o},t.chooseVersion=function(e,r){for(var n=1;n<=40;n++){var a=$p.getVersionForNumber(n);if(t.willFit(e,a,r))return a}throw new Ss("Data too big")},t.willFit=function(e,r,n){var a=r.getTotalCodewords(),s=r.getECBlocksForLevel(n),o=s.getTotalECCodewords(),l=a-o,c=(e+7)/8;return l>=c},t.terminateBits=function(e,r){var n=e*8;if(r.getSize()>n)throw new Ss("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(var a=0;a<4&&r.getSize()<n;++a)r.appendBit(!1);var s=r.getSize()&7;if(s>0)for(var a=s;a<8;a++)r.appendBit(!1);for(var o=e-r.getSizeInBytes(),a=0;a<o;++a)r.appendBits(a&1?17:236,8);if(r.getSize()!==n)throw new Ss("Bits size does not equal capacity")},t.getNumDataBytesAndNumECBytesForBlockID=function(e,r,n,a,s,o){if(a>=n)throw new Ss("Block ID too large");var l=e%n,c=n-l,u=Math.floor(e/n),d=u+1,f=Math.floor(r/n),A=f+1,h=u-f,m=d-A;if(h!==m)throw new Ss("EC bytes mismatch");if(n!==c+l)throw new Ss("RS blocks mismatch");if(e!==(f+h)*c+(A+m)*l)throw new Ss("Total bytes mismatch");a<c?(s[0]=f,o[0]=h):(s[0]=A,o[0]=m)},t.interleaveWithECBytes=function(e,r,n,a){var s,o,l,c;if(e.getSizeInBytes()!==n)throw new Ss("Number of bits and data bytes does not match");for(var u=0,d=0,f=0,A=new Array,h=0;h<a;++h){var m=new Int32Array(1),p=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(r,n,a,h,m,p);var x=m[0],v=new Uint8Array(x);e.toBytes(8*u,v,0,x);var y=t.generateECBytes(v,p[0]);A.push(new d9e(v,y)),d=Math.max(d,x),f=Math.max(f,y.length),u+=m[0]}if(n!==u)throw new Ss("Data bytes does not match offset");for(var b=new el,h=0;h<d;++h)try{for(var w=(s=void 0,z$(A)),j=w.next();!j.done;j=w.next()){var I=j.value,v=I.getDataBytes();h<v.length&&b.appendBits(v[h],8)}}catch(B){s={error:B}}finally{try{j&&!j.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}for(var h=0;h<f;++h)try{for(var _=(l=void 0,z$(A)),S=_.next();!S.done;S=_.next()){var I=S.value,y=I.getErrorCorrectionBytes();h<y.length&&b.appendBits(y[h],8)}}catch(B){l={error:B}}finally{try{S&&!S.done&&(c=_.return)&&c.call(_)}finally{if(l)throw l.error}}if(r!==b.getSizeInBytes())throw new Ss("Interleaving error: "+r+" and "+b.getSizeInBytes()+" differ.");return b},t.generateECBytes=function(e,r){for(var n=e.length,a=new Int32Array(n+r),s=0;s<n;s++)a[s]=e[s]&255;new Pse(Jc.QR_CODE_FIELD_256).encode(a,r);for(var o=new Uint8Array(r),s=0;s<r;s++)o[s]=a[n+s];return o},t.appendModeInfo=function(e,r){r.appendBits(e.getBits(),4)},t.appendLengthInfo=function(e,r,n,a){var s=n.getCharacterCountBits(r);if(e>=1<<s)throw new Ss(e+" is bigger than "+((1<<s)-1));a.appendBits(e,s)},t.appendBytes=function(e,r,n,a){switch(r){case Is.NUMERIC:t.appendNumericBytes(e,n);break;case Is.ALPHANUMERIC:t.appendAlphanumericBytes(e,n);break;case Is.BYTE:t.append8BitBytes(e,n,a);break;case Is.KANJI:t.appendKanjiBytes(e,n);break;default:throw new Ss("Invalid mode: "+r)}},t.getDigit=function(e){return e.charCodeAt(0)-48},t.isDigit=function(e){var r=t.getDigit(e);return r>=0&&r<=9},t.appendNumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getDigit(e.charAt(a));if(a+2<n){var o=t.getDigit(e.charAt(a+1)),l=t.getDigit(e.charAt(a+2));r.appendBits(s*100+o*10+l,10),a+=3}else if(a+1<n){var o=t.getDigit(e.charAt(a+1));r.appendBits(s*10+o,7),a+=2}else r.appendBits(s,4),a++}},t.appendAlphanumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getAlphanumericCode(e.charCodeAt(a));if(s===-1)throw new Ss;if(a+1<n){var o=t.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new Ss;r.appendBits(s*45+o,11),a+=2}else r.appendBits(s,6),a++}},t.append8BitBytes=function(e,r,n){var a;try{a=Bd.encode(e,n)}catch(c){throw new Ss(c)}for(var s=0,o=a.length;s!==o;s++){var l=a[s];r.appendBits(l,8)}},t.appendKanjiBytes=function(e,r){var n;try{n=Bd.encode(e,jo.SJIS)}catch(f){throw new Ss(f)}for(var a=n.length,s=0;s<a;s+=2){var o=n[s]&255,l=n[s+1]&255,c=o<<8&4294967295|l,u=-1;if(c>=33088&&c<=40956?u=c-33088:c>=57408&&c<=60351&&(u=c-49472),u===-1)throw new Ss("Invalid byte sequence");var d=(u>>8)*192+(u&255);r.appendBits(d,13)}},t.appendECI=function(e,r){r.appendBits(Is.ECI.getBits(),4),r.appendBits(e.getValue(),8)},t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),t.DEFAULT_BYTE_MODE_ENCODING=jo.UTF8.getName(),t})();var f9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){f9e(e,t);function e(r,n,a,s,o,l,c,u){var d=t.call(this,l,c)||this;if(d.yuvData=r,d.dataWidth=n,d.dataHeight=a,d.left=s,d.top=o,s+l>n||o+c>a)throw new Pn("Crop rectangle does not fit within image data.");return u&&d.reverseHorizontal(l,c),d}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ws.arraycopy(this.yuvData,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ws.arraycopy(this.yuvData,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ws.arraycopy(this.yuvData,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+n,a,s,!1)},e.prototype.renderThumbnail=function(){for(var r=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*n),s=this.yuvData,o=this.top*this.dataWidth+this.left,l=0;l<n;l++){for(var c=l*r,u=0;u<r;u++){var d=s[o+u*e.THUMBNAIL_SCALE_FACTOR]&255;a[c+u]=4278190080|d*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(r,n){for(var a=this.yuvData,s=0,o=this.top*this.dataWidth+this.left;s<n;s++,o+=this.dataWidth)for(var l=o+r/2,c=o,u=o+r-1;c<l;c++,u--){var d=a[c];a[c]=a[u],a[u]=d}},e.prototype.invert=function(){return new gP(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Gw);var h9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){h9e(e,t);function e(r,n,a,s,o,l,c){var u=t.call(this,n,a)||this;if(u.dataWidth=s,u.dataHeight=o,u.left=l,u.top=c,r.BYTES_PER_ELEMENT===4){for(var d=n*a,f=new Uint8ClampedArray(d),A=0;A<d;A++){var h=r[A],m=h>>16&255,p=h>>7&510,x=h&255;f[A]=(m+p+x)/4&255}u.luminances=f}else u.luminances=r;if(s===void 0&&(u.dataWidth=n),o===void 0&&(u.dataHeight=a),l===void 0&&(u.left=0),c===void 0&&(u.top=0),u.left+n>u.dataWidth||u.top+a>u.dataHeight)throw new Pn("Crop rectangle does not fit within image data.");return u}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ws.arraycopy(this.luminances,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ws.arraycopy(this.luminances,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ws.arraycopy(this.luminances,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.luminances,a,s,this.dataWidth,this.dataHeight,this.left+r,this.top+n)},e.prototype.invert=function(){return new gP(this)},e})(Gw);var A9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),m9e=function(t){A9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.forName=function(r){return this.getCharacterSetECIByName(r)},e}(jo),p9e=function(){function t(){}return t.ISO_8859_1=jo.ISO8859_1,t}(),mF,g9e=301,x9e=function(t,e){for(var r=1,n=0;n<255;n++)e[n]=r,t[r]=n,r*=2,r>=256&&(r^=g9e);return{LOG:t,ALOG:e}};mF=x9e([],[]),mF.LOG;mF.ALOG;var W$;(function(t){t[t.FORCE_NONE=0]="FORCE_NONE",t[t.FORCE_SQUARE=1]="FORCE_SQUARE",t[t.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(W$||(W$={}));var X$=129,Bse=230,v9e=231,y9e=235,b9e=236,w9e=237,N9e=238,C9e=239,_9e=240,K5=254,E9e=254,Y$="[)>05",J$="[)>06",Z$="",Xa=0,xl=1,xc=2,bo=3,qo=4,Wl=5,S9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Xa},t.prototype.encode=function(e){var r=lf.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(r>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case Wl:e.writeCodeword(v9e),e.signalEncoderChange(Wl);return;case xl:e.writeCodeword(Bse),e.signalEncoderChange(xl);return;case bo:e.writeCodeword(N9e),e.signalEncoderChange(bo);break;case xc:e.writeCodeword(C9e),e.signalEncoderChange(xc);break;case qo:e.writeCodeword(_9e),e.signalEncoderChange(qo);break;default:throw new Error("Illegal mode: "+a)}else lf.isExtendedASCII(n)?(e.writeCodeword(y9e),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},t.prototype.encodeASCIIDigits=function(e,r){if(lf.isDigit(e)&&lf.isDigit(r)){var n=(e-48)*10+(r-48);return n+130}throw new Error("not digits: "+e+r)},t}(),I9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Wl},t.prototype.encode=function(e){var r=new Zn;for(r.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();r.append(n),e.pos++;var a=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}var s=r.length()-1,o=1,l=e.getCodewordCount()+s+o;e.updateSymbolInfo(l);var c=e.getSymbolInfo().getDataCapacity()-l>0;if(e.hasMoreCharacters()||c)if(s<=249)r.setCharAt(0,ba.getCharAt(s));else if(s<=1555)r.setCharAt(0,ba.getCharAt(Math.floor(s/250)+249)),r.insert(1,ba.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var u=0,n=r.length();u<n;u++)e.writeCodeword(this.randomize255State(r.charAt(u).charCodeAt(0),e.getCodewordCount()+1))},t.prototype.randomize255State=function(e,r){var n=149*r%255+1,a=e+n;return a<=255?a:a-256},t}(),LR=function(){function t(){}return t.prototype.getEncodingMode=function(){return xl},t.prototype.encodeMaximal=function(e){for(var r=new Zn,n=0,a=e.pos,s=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,r),r.length()%3===0&&(a=e.pos,s=r.length())}if(s!==r.length()){var l=Math.floor(r.length()/3*2),c=Math.floor(e.getCodewordCount()+l+1);e.updateSymbolInfo(c);var u=e.getSymbolInfo().getDataCapacity()-c,d=Math.floor(r.length()%3);(d===2&&u!==2||d===1&&(n>3||u!==1))&&(e.pos=a)}r.length()>0&&e.writeCodeword(Bse),this.handleEOD(e,r)},t.prototype.encode=function(e){for(var r=new Zn;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,r),s=Math.floor(r.length()/3)*2,o=e.getCodewordCount()+s;e.updateSymbolInfo(o);var l=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var c=new Zn;for(r.length()%3===2&&l!==2&&(a=this.backtrackOneCharacter(e,r,c,a));r.length()%3===1&&(a>3||l!==1);)a=this.backtrackOneCharacter(e,r,c,a);break}var u=r.length();if(u%3===0){var d=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(d!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}}this.handleEOD(e,r)},t.prototype.backtrackOneCharacter=function(e,r,n,a){var s=r.length(),o=r.toString().substring(0,s-a);r.setLengthToZero(),r.append(o),e.pos--;var l=e.getCurrentChar();return a=this.encodeChar(l,n),e.resetSymbolInfo(),a},t.prototype.writeNextTriplet=function(e,r){e.writeCodewords(this.encodeToCodewords(r.toString()));var n=r.toString().substring(3);r.setLengthToZero(),r.append(n)},t.prototype.handleEOD=function(e,r){var n=Math.floor(r.length()/3*2),a=r.length()%3,s=e.getCodewordCount()+n;e.updateSymbolInfo(s);var o=e.getSymbolInfo().getDataCapacity()-s;if(a===2){for(r.append("\0");r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(K5)}else if(o===1&&a===1){for(;r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(K5),e.pos--}else if(a===0){for(;r.length()>=3;)this.writeNextTriplet(e,r);(o>0||e.hasMoreCharacters())&&e.writeCodeword(K5)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(Xa)},t.prototype.encodeChar=function(e,r){if(e===32)return r.append(3),1;if(e>=48&&e<=57)return r.append(e-48+4),1;if(e>=65&&e<=90)return r.append(e-65+14),1;if(e<32)return r.append(0),r.append(e),2;if(e<=47)return r.append(1),r.append(e-33),2;if(e<=64)return r.append(1),r.append(e-58+15),2;if(e<=95)return r.append(1),r.append(e-91+22),2;if(e<=127)return r.append(2),r.append(e-96),2;r.append("1");var n=2;return n+=this.encodeChar(e-128,r),n},t.prototype.encodeToCodewords=function(e){var r=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=r/256,a=r%256,s=new Zn;return s.append(n),s.append(a),s.toString()},t}(),j9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return qo},t.prototype.encode=function(e){for(var r=new Zn;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,r),e.pos++;var a=r.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(r.toString()));var s=r.toString().substring(4);r.setLengthToZero(),r.append(s);var o=lf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}}r.append(ba.getCharAt(31)),this.handleEOD(e,r)},t.prototype.handleEOD=function(e,r){try{var n=r.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,l=this.encodeToCodewords(r.toString()),c=!e.hasMoreCharacters(),u=c&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(u=!1,e.updateSymbolInfo(e.getCodewordCount()+l.length))}u?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(l)}finally{e.signalEncoderChange(Xa)}},t.prototype.encodeChar=function(e,r){e>=32&&e<=63?r.append(e):e>=64&&e<=94?r.append(ba.getCharAt(e-64)):lf.illegalCharacter(ba.getCharAt(e))},t.prototype.encodeToCodewords=function(e){var r=e.length;if(r===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=r>=2?e.charAt(1).charCodeAt(0):0,s=r>=3?e.charAt(2).charCodeAt(0):0,o=r>=4?e.charAt(3).charCodeAt(0):0,l=(n<<18)+(a<<12)+(s<<6)+o,c=l>>16&255,u=l>>8&255,d=l&255,f=new Zn;return f.append(c),r>=2&&f.append(u),r>=3&&f.append(d),f.toString()},t}(),P9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),B9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Da=function(){function t(e,r,n,a,s,o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=r,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=s,this.dataRegions=o,this.rsBlockData=l,this.rsBlockError=c}return t.lookup=function(e,r,n,a,s){var o,l;r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!0);try{for(var c=B9e(k9e),u=c.next();!u.done;u=c.next()){var d=u.value;if(!(r===1&&d.rectangular)&&!(r===2&&!d.rectangular)&&!(n!=null&&(d.getSymbolWidth()<n.getWidth()||d.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(d.getSymbolWidth()>a.getWidth()||d.getSymbolHeight()>a.getHeight()))&&e<=d.dataCapacity)return d}}catch(f){o={error:f}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},t.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},t.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},t.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},t.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},t.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},t.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},t.prototype.getDataCapacity=function(){return this.dataCapacity},t.prototype.getErrorCodewords=function(){return this.errorCodewords},t.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},t.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},t}(),T9e=function(t){P9e(e,t);function e(){return t.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(r){return r<=8?156:155},e}(Da),k9e=[new Da(!1,3,5,8,8,1),new Da(!1,5,7,10,10,1),new Da(!0,5,7,16,6,1),new Da(!1,8,10,12,12,1),new Da(!0,10,11,14,6,2),new Da(!1,12,12,14,14,1),new Da(!0,16,14,24,10,1),new Da(!1,18,14,16,16,1),new Da(!1,22,18,18,18,1),new Da(!0,22,18,16,10,2),new Da(!1,30,20,20,20,1),new Da(!0,32,24,16,14,2),new Da(!1,36,24,22,22,1),new Da(!1,44,28,24,24,1),new Da(!0,49,28,22,14,2),new Da(!1,62,36,14,14,4),new Da(!1,86,42,16,16,4),new Da(!1,114,48,18,18,4),new Da(!1,144,56,20,20,4),new Da(!1,174,68,22,22,4),new Da(!1,204,84,24,24,4,102,42),new Da(!1,280,112,14,14,16,140,56),new Da(!1,368,144,16,16,16,92,36),new Da(!1,456,192,18,18,16,114,48),new Da(!1,576,224,20,20,16,144,56),new Da(!1,696,272,22,22,16,174,68),new Da(!1,816,336,24,24,16,136,56),new Da(!1,1050,408,18,18,36,175,68),new Da(!1,1304,496,20,20,36,163,62),new T9e],F9e=function(){function t(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var r=e.split("").map(function(l){return l.charCodeAt(0)}),n=new Zn,a=0,s=r.length;a<s;a++){var o=String.fromCharCode(r[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new Zn,this.newEncoding=-1}return t.prototype.setSymbolShape=function(e){this.shape=e},t.prototype.setSizeConstraints=function(e,r){this.minSize=e,this.maxSize=r},t.prototype.getMessage=function(){return this.msg},t.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},t.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCodewords=function(){return this.codewords},t.prototype.writeCodewords=function(e){this.codewords.append(e)},t.prototype.writeCodeword=function(e){this.codewords.append(e)},t.prototype.getCodewordCount=function(){return this.codewords.length()},t.prototype.getNewEncoding=function(){return this.newEncoding},t.prototype.signalEncoderChange=function(e){this.newEncoding=e},t.prototype.resetEncoderSignal=function(){this.newEncoding=-1},t.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},t.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},t.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},t.prototype.getSymbolInfo=function(){return this.symbolInfo},t.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=Da.lookup(e,this.shape,this.minSize,this.maxSize,!0))},t.prototype.resetSymbolInfo=function(){this.symbolInfo=null},t}(),O9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),D9e=function(t){O9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return bo},e.prototype.encode=function(r){for(var n=new Zn;r.hasMoreCharacters();){var a=r.getCurrentChar();r.pos++,this.encodeChar(a,n);var s=n.length();if(s%3===0){this.writeNextTriplet(r,n);var o=lf.lookAheadTest(r.getMessage(),r.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){r.signalEncoderChange(Xa);break}}}this.handleEOD(r,n)},e.prototype.encodeChar=function(r,n){switch(r){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:r>=48&&r<=57?n.append(r-48+4):r>=65&&r<=90?n.append(r-65+14):lf.illegalCharacter(ba.getCharAt(r));break}return 1},e.prototype.handleEOD=function(r,n){r.updateSymbolInfo();var a=r.getSymbolInfo().getDataCapacity()-r.getCodewordCount(),s=n.length();r.pos-=s,(r.getRemainingCharacters()>1||a>1||r.getRemainingCharacters()!==a)&&r.writeCodeword(E9e),r.getNewEncoding()<0&&r.signalEncoderChange(Xa)},e}(LR),R9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),M9e=function(t){R9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return xc},e.prototype.encodeChar=function(r,n){if(r===32)return n.append(3),1;if(r>=48&&r<=57)return n.append(r-48+4),1;if(r>=97&&r<=122)return n.append(r-97+14),1;if(r<32)return n.append(0),n.append(r),2;if(r<=47)return n.append(1),n.append(r-33),2;if(r<=64)return n.append(1),n.append(r-58+15),2;if(r>=91&&r<=95)return n.append(1),n.append(r-91+22),2;if(r===96)return n.append(2),n.append(0),2;if(r<=90)return n.append(2),n.append(r-65+1),2;if(r<=127)return n.append(2),n.append(r-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(r-128,n),a},e}(LR),lf=function(){function t(){}return t.randomize253State=function(e){var r=149*e%253+1,n=X$+r;return n<=254?n:n-254},t.encodeHighLevel=function(e,r,n,a,s){r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!1);var o=new LR,l=[new S9e,o,new M9e,new D9e,new j9e,new I9e],c=new F9e(e);c.setSymbolShape(r),c.setSizeConstraints(n,a),e.startsWith(Y$)&&e.endsWith(Z$)?(c.writeCodeword(b9e),c.setSkipAtEnd(2),c.pos+=Y$.length):e.startsWith(J$)&&e.endsWith(Z$)&&(c.writeCodeword(w9e),c.setSkipAtEnd(2),c.pos+=J$.length);var u=Xa;for(s&&(o.encodeMaximal(c),u=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)l[u].encode(c),c.getNewEncoding()>=0&&(u=c.getNewEncoding(),c.resetEncoderSignal());var d=c.getCodewordCount();c.updateSymbolInfo();var f=c.getSymbolInfo().getDataCapacity();d<f&&u!==Xa&&u!==Wl&&u!==qo&&c.writeCodeword("");var A=c.getCodewords();for(A.length()<f&&A.append(X$);A.length()<f;)A.append(this.randomize253State(A.length()+1));return c.getCodewords().toString()},t.lookAheadTest=function(e,r,n){var a=this.lookAheadTestIntern(e,r,n);if(n===bo&&a===bo){for(var s=Math.min(r+3,e.length),o=r;o<s;o++)if(!this.isNativeX12(e.charCodeAt(o)))return Xa}else if(n===qo&&a===qo){for(var s=Math.min(r+4,e.length),o=r;o<s;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return Xa}return a},t.lookAheadTestIntern=function(e,r,n){if(r>=e.length)return n;var a;n===Xa?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var s=0,o=new Uint8Array(6),l=[];;){if(r+s===e.length){Bo.fill(o,0),Bo.fill(l,0);var c=this.findMinimums(a,l,sa.MAX_VALUE,o),u=this.getMinimumCount(o);if(l[Xa]===c)return Xa;if(u===1){if(o[Wl]>0)return Wl;if(o[qo]>0)return qo;if(o[xc]>0)return xc;if(o[bo]>0)return bo}return xl}var d=e.charCodeAt(r+s);if(s++,this.isDigit(d)?a[Xa]+=.5:this.isExtendedASCII(d)?(a[Xa]=Math.ceil(a[Xa]),a[Xa]+=2):(a[Xa]=Math.ceil(a[Xa]),a[Xa]++),this.isNativeC40(d)?a[xl]+=2/3:this.isExtendedASCII(d)?a[xl]+=8/3:a[xl]+=4/3,this.isNativeText(d)?a[xc]+=2/3:this.isExtendedASCII(d)?a[xc]+=8/3:a[xc]+=4/3,this.isNativeX12(d)?a[bo]+=2/3:this.isExtendedASCII(d)?a[bo]+=13/3:a[bo]+=10/3,this.isNativeEDIFACT(d)?a[qo]+=3/4:this.isExtendedASCII(d)?a[qo]+=17/4:a[qo]+=13/4,this.isSpecialB256(d)?a[Wl]+=4:a[Wl]++,s>=4){if(Bo.fill(o,0),Bo.fill(l,0),this.findMinimums(a,l,sa.MAX_VALUE,o),l[Xa]<this.min(l[Wl],l[xl],l[xc],l[bo],l[qo]))return Xa;if(l[Wl]<l[Xa]||l[Wl]+1<this.min(l[xl],l[xc],l[bo],l[qo]))return Wl;if(l[qo]+1<this.min(l[Wl],l[xl],l[xc],l[bo],l[Xa]))return qo;if(l[xc]+1<this.min(l[Wl],l[xl],l[qo],l[bo],l[Xa]))return xc;if(l[bo]+1<this.min(l[Wl],l[xl],l[qo],l[xc],l[Xa]))return bo;if(l[xl]+1<this.min(l[Xa],l[Wl],l[qo],l[xc])){if(l[xl]<l[bo])return xl;if(l[xl]===l[bo]){for(var f=r+s+1;f<e.length;){var A=e.charCodeAt(f);if(this.isX12TermSep(A))return bo;if(!this.isNativeX12(A))break;f++}return xl}}}}},t.min=function(e,r,n,a,s){var o=Math.min(e,Math.min(r,Math.min(n,a)));return s===void 0?o:Math.min(o,s)},t.findMinimums=function(e,r,n,a){for(var s=0;s<6;s++){var o=r[s]=Math.ceil(e[s]);n>o&&(n=o,Bo.fill(a,0)),n===o&&(a[s]=a[s]+1)}return n},t.getMinimumCount=function(e){for(var r=0,n=0;n<6;n++)r+=e[n];return r||0},t.isDigit=function(e){return e>=48&&e<=57},t.isExtendedASCII=function(e){return e>=128&&e<=255},t.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},t.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},t.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},t.isX12TermSep=function(e){return e===13||e===42||e===62},t.isNativeEDIFACT=function(e){return e>=32&&e<=94},t.isSpecialB256=function(e){return!1},t.determineConsecutiveDigitCount=function(e,r){r===void 0&&(r=0);for(var n=e.length,a=r;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-r},t.illegalCharacter=function(e){var r=sa.toHexString(e.charCodeAt(0));throw r="0000".substring(0,4-r.length)+r,new Error("Illegal character: "+e+" (0x"+r+")")},t}(),q5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},eG=function(){function t(e){this.charset=e,this.name=e.name}return t.prototype.canEncode=function(e){try{return Bd.encode(e,this.charset)!=null}catch{return!1}},t}(),L9e=function(){function t(e,r,n){var a,s,o,l,c,u;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(E){return new eG(m9e.forName(E))}),this.encoders=[];var d=[];d.push(new eG(p9e.ISO_8859_1));for(var f=r!=null&&r.name.startsWith("UTF"),A=0;A<e.length;A++){var h=!1;try{for(var m=(a=void 0,q5(d)),p=m.next();!p.done;p=m.next()){var x=p.value,v=e.charAt(A),y=v.charCodeAt(0);if(y===n||x.canEncode(v)){h=!0;break}}}catch(E){a={error:E}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!h)try{for(var b=(o=void 0,q5(this.ENCODERS)),w=b.next();!w.done;w=b.next()){var x=w.value;if(x.canEncode(e.charAt(A))){d.push(x),h=!0;break}}}catch(E){o={error:E}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(o)throw o.error}}h||(f=!0)}if(d.length===1&&!f)this.encoders=[d[0]];else{this.encoders=[];var j=0;try{for(var I=q5(d),_=I.next();!_.done;_=I.next()){var x=_.value;this.encoders[j++]=x}}catch(E){c={error:E}}finally{try{_&&!_.done&&(u=I.return)&&u.call(I)}finally{if(c)throw c.error}}}var S=-1;if(r!=null){for(var A=0;A<this.encoders.length;A++)if(this.encoders[A]!=null&&r.name===this.encoders[A].name){S=A;break}}this.priorityEncoderIndex=S}return t.prototype.length=function(){return this.encoders.length},t.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},t.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},t.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},t.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},t.prototype.canEncode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return!0},t.prototype.encode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return Bd.encode(ba.getCharAt(e),this.encoders[r].name)},t}(),U9e=3,Q9e=function(){function t(e,r,n){this.fnc1=n;var a=new L9e(e,r,n);if(a.length()===1)for(var s=0;s<this.bytes.length;s++){var o=e.charAt(s).charCodeAt(0);this.bytes[s]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(e,r){if(e+r-1>=this.bytes.length)return!1;for(var n=0;n<r;n++)if(this.isECI(e+n))return!1;return!0},t.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},t.prototype.subSequence=function(e,r){if(e<0||e>r||r>this.length())throw new Error(""+e);for(var n=new Zn,a=e;a<r;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},t.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},t.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},t.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},t.prototype.addEdge=function(e,r,n){(e[r][n.encoderIndex]==null||e[r][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[r][n.encoderIndex]=n)},t.prototype.addEdges=function(e,r,n,a,s,o){var l=e.charAt(a).charCodeAt(0),c=0,u=r.length();r.getPriorityEncoderIndex()>=0&&(l===o||r.canEncode(l,r.getPriorityEncoderIndex()))&&(c=r.getPriorityEncoderIndex(),u=c+1);for(var d=c;d<u;d++)(l===o||r.canEncode(l,d))&&this.addEdge(n,a+1,new tG(l,r,d,s,o))},t.prototype.encodeMinimally=function(e,r,n){var a=e.length,s=new tG[a+1][r.length()];this.addEdges(e,r,s,0,null,n);for(var o=1;o<=a;o++){for(var l=0;l<r.length();l++)s[o][l]!=null&&o<a&&this.addEdges(e,r,s,o,s[o][l],n);for(var l=0;l<r.length();l++)s[o-1][l]=null}for(var c=-1,u=sa.MAX_VALUE,l=0;l<r.length();l++)if(s[a][l]!=null){var d=s[a][l];d.cachedTotalSize<u&&(u=d.cachedTotalSize,c=l)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],A=s[a][c];A!=null;){if(A.isFNC1())f.unshift(1e3);else for(var h=r.encode(A.c,A.encoderIndex),o=h.length-1;o>=0;o--)f.unshift(h[o]&255);var m=A.previous===null?0:A.previous.encoderIndex;m!==A.encoderIndex&&f.unshift(256+r.getECIValue(A.encoderIndex)),A=A.previous}for(var p=[],o=0;o<p.length;o++)p[o]=f[o];return p},t}(),tG=function(){function t(e,r,n,a,s){this.c=e,this.encoderSet=r,this.encoderIndex=n,this.previous=a,this.fnc1=s,this.c=e===s?1e3:e;var o=this.isFNC1()?1:r.encode(e,n).length,l=a===null?0:a.encoderIndex;l!==n&&(o+=U9e),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return this.c===1e3},t}(),V9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var rG;(function(t){t[t.ASCII=0]="ASCII",t[t.C40=1]="C40",t[t.TEXT=2]="TEXT",t[t.X12=3]="X12",t[t.EDF=4]="EDF",t[t.B256=5]="B256"})(rG||(rG={}));(function(t){V9e(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n,a)||this;return l.shape=s,l.macroId=o,l}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(Q9e);var H9e=function(){function t(){}return t.prototype.isCompact=function(){return this.compact},t.prototype.setCompact=function(e){this.compact=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getLayers=function(){return this.layers},t.prototype.setLayers=function(e){this.layers=e},t.prototype.getCodeWords=function(){return this.codeWords},t.prototype.setCodeWords=function(e){this.codeWords=e},t.prototype.getMatrix=function(){return this.matrix},t.prototype.setMatrix=function(e){this.matrix=e},t}(),nG=function(){function t(){}return t.singletonList=function(e){return[e]},t.min=function(e,r){return e.sort(r)[0]},t}(),$9e=function(){function t(e){this.previous=e}return t.prototype.getPrevious=function(){return this.previous},t}(),G9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),UR=function(t){G9e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.value=n,s.bitCount=a,s}return e.prototype.appendTo=function(r,n){r.appendBits(this.value,this.bitCount)},e.prototype.add=function(r,n){return new e(this,r,n)},e.prototype.addBinaryShift=function(r,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,r,n)},e.prototype.toString=function(){var r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+sa.toBinaryString(r|1<<this.bitCount).substring(1)+">"},e}($9e),K9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),q9e=function(t){K9e(e,t);function e(r,n,a){var s=t.call(this,r,0,0)||this;return s.binaryShiftStart=n,s.binaryShiftByteCount=a,s}return e.prototype.appendTo=function(r,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(r,n){return new e(this,r,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(UR);function z9e(t,e,r){return new q9e(t,e,r)}function by(t,e,r){return new UR(t,e,r)}var W9e=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Am=0,aI=1,_d=2,Tse=3,eh=4,X9e=new UR(null,0,0),z5=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],Y9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function J9e(t){var e,r;try{for(var n=Y9e(t),a=n.next();!a.done;a=n.next()){var s=a.value;Bo.fill(s,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return t[Am][eh]=0,t[aI][eh]=0,t[aI][Am]=28,t[Tse][eh]=0,t[_d][eh]=0,t[_d][Am]=15,t}var kse=J9e(Bo.createInt32Array(6,6)),Z9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},eQe=function(){function t(e,r,n,a){this.token=e,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}return t.prototype.getMode=function(){return this.mode},t.prototype.getToken=function(){return this.token},t.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},t.prototype.getBitCount=function(){return this.bitCount},t.prototype.latchAndAppend=function(e,r){var n=this.bitCount,a=this.token;if(e!==this.mode){var s=z5[this.mode][e];a=by(a,s&65535,s>>16),n+=s>>16}var o=e===_d?4:5;return a=by(a,r,o),new t(a,e,0,n+o)},t.prototype.shiftAndAppend=function(e,r){var n=this.token,a=this.mode===_d?4:5;return n=by(n,kse[this.mode][e],a),n=by(n,r,5),new t(n,this.mode,0,this.bitCount+a+5)},t.prototype.addBinaryShiftChar=function(e){var r=this.token,n=this.mode,a=this.bitCount;if(this.mode===eh||this.mode===_d){var s=z5[n][Am];r=by(r,s&65535,s>>16),a+=s>>16,n=Am}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new t(r,n,this.binaryShiftByteCount+1,a+o);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(e+1)),l},t.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var r=this.token;return r=z9e(r,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new t(r,this.mode,0,this.bitCount)},t.prototype.isBetterThanOrEqualTo=function(e){var r=this.bitCount+(z5[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?r+=t.calculateBinaryShiftCost(e)-t.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(r+=10),r<=e.bitCount},t.prototype.toBitArray=function(e){for(var r,n,a=[],s=this.endBinaryShift(e.length).token;s!==null;s=s.getPrevious())a.unshift(s);var o=new el;try{for(var l=Z9e(a),c=l.next();!c.done;c=l.next()){var u=c.value;u.appendTo(o,e)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t.prototype.toString=function(){return ba.format("%s bits=%d bytes=%d",W9e[this.mode],this.bitCount,this.binaryShiftByteCount)},t.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},t.INITIAL_STATE=new t(X9e,Am,0,0),t}();function tQe(t){var e=ba.getCharCode(" "),r=ba.getCharCode("."),n=ba.getCharCode(",");t[Am][e]=1;for(var a=ba.getCharCode("Z"),s=ba.getCharCode("A"),o=s;o<=a;o++)t[Am][o]=o-s+2;t[aI][e]=1;for(var l=ba.getCharCode("z"),c=ba.getCharCode("a"),o=c;o<=l;o++)t[aI][o]=o-c+2;t[_d][e]=1;for(var u=ba.getCharCode("9"),d=ba.getCharCode("0"),o=d;o<=u;o++)t[_d][o]=o-d+2;t[_d][n]=12,t[_d][r]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],A=0;A<f.length;A++)t[Tse][ba.getCharCode(f[A])]=A;for(var h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],A=0;A<h.length;A++)ba.getCharCode(h[A])>0&&(t[eh][ba.getCharCode(h[A])]=A);return t}var W5=tQe(Bo.createInt32Array(5,256)),u_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rQe=function(){function t(e){this.text=e}return t.prototype.encode=function(){for(var e=ba.getCharCode(" "),r=ba.getCharCode(`
`),n=nG.singletonList(eQe.INITIAL_STATE),a=0;a<this.text.length;a++){var s=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case ba.getCharCode("\r"):s=o===r?2:0;break;case ba.getCharCode("."):s=o===e?3:0;break;case ba.getCharCode(","):s=o===e?4:0;break;case ba.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=t.updateStateListForPair(n,a,s),a++):n=this.updateStateListForChar(n,a)}var l=nG.min(n,function(c,u){return c.getBitCount()-u.getBitCount()});return l.toBitArray(this.text)},t.prototype.updateStateListForChar=function(e,r){var n,a,s=[];try{for(var o=u_(e),l=o.next();!l.done;l=o.next()){var c=l.value;this.updateStateForChar(c,r,s)}}catch(u){n={error:u}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return t.simplifyStates(s)},t.prototype.updateStateForChar=function(e,r,n){for(var a=this.text[r]&255,s=W5[e.getMode()][a]>0,o=null,l=0;l<=eh;l++){var c=W5[l][a];if(c>0){if(o==null&&(o=e.endBinaryShift(r)),!s||l===e.getMode()||l===_d){var u=o.latchAndAppend(l,c);n.push(u)}if(!s&&kse[e.getMode()][l]>=0){var d=o.shiftAndAppend(l,c);n.push(d)}}}if(e.getBinaryShiftByteCount()>0||W5[e.getMode()][a]===0){var f=e.addBinaryShiftChar(r);n.push(f)}},t.updateStateListForPair=function(e,r,n){var a,s,o=[];try{for(var l=u_(e),c=l.next();!c.done;c=l.next()){var u=c.value;this.updateStateForPair(u,r,n,o)}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}return this.simplifyStates(o)},t.updateStateForPair=function(e,r,n,a){var s=e.endBinaryShift(r);if(a.push(s.latchAndAppend(eh,n)),e.getMode()!==eh&&a.push(s.shiftAndAppend(eh,n)),n===3||n===4){var o=s.latchAndAppend(_d,16-n).latchAndAppend(_d,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var l=e.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(l)}},t.simplifyStates=function(e){var r,n,a,s,o=[];try{for(var l=u_(e),c=l.next();!c.done;c=l.next()){var u=c.value,d=!0,f=function(x){if(x.isBetterThanOrEqualTo(u))return d=!1,"break";u.isBetterThanOrEqualTo(x)&&(o=o.filter(function(v){return v!==x}))};try{for(var A=(a=void 0,u_(o)),h=A.next();!h.done;h=A.next()){var m=h.value,p=f(m);if(p==="break")break}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}d&&o.push(u)}}catch(x){r={error:x}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t}(),nQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.encodeBytes=function(e){return t.encode(e,t.DEFAULT_EC_PERCENT,t.DEFAULT_AZTEC_LAYERS)},t.encode=function(e,r,n){var a=new rQe(e).encode(),s=sa.truncDivision(a.getSize()*r,100)+11,o=a.getSize()+s,l,c,u,d,f;if(n!==t.DEFAULT_AZTEC_LAYERS){if(l=n<0,c=Math.abs(n),c>(l?t.MAX_NB_BITS_COMPACT:t.MAX_NB_BITS))throw new Pn(ba.format("Illegal value %s for layers",n));u=t.totalBitsInLayer(c,l),d=t.WORD_SIZE[c];var A=u-u%d;if(f=t.stuffBits(a,d),f.getSize()+s>A)throw new Pn("Data to large for user specified layer");if(l&&f.getSize()>d*64)throw new Pn("Data to large for user specified layer")}else{d=0,f=null;for(var h=0;;h++){if(h>t.MAX_NB_BITS)throw new Pn("Data too large for an Aztec code");if(l=h<=3,c=l?h+1:h,u=t.totalBitsInLayer(c,l),!(o>u)){(f==null||d!==t.WORD_SIZE[c])&&(d=t.WORD_SIZE[c],f=t.stuffBits(a,d));var A=u-u%d;if(!(l&&f.getSize()>d*64)&&f.getSize()+s<=A)break}}}var m=t.generateCheckWords(f,u,d),p=f.getSize()/d,x=t.generateModeMessage(l,c,p),v=(l?11:14)+c*4,y=new Int32Array(v),b;if(l){b=v;for(var h=0;h<y.length;h++)y[h]=h}else{b=v+1+2*sa.truncDivision(sa.truncDivision(v,2)-1,15);for(var w=sa.truncDivision(v,2),j=sa.truncDivision(b,2),h=0;h<w;h++){var I=h+sa.truncDivision(h,15);y[w-h-1]=j-I-1,y[w+h]=j+I+1}}for(var _=new lh(b),h=0,S=0;h<c;h++){for(var E=(c-h)*4+(l?9:12),B=0;B<E;B++)for(var T=B*2,P=0;P<2;P++)m.get(S+T+P)&&_.set(y[h*2+P],y[h*2+B]),m.get(S+E*2+T+P)&&_.set(y[h*2+B],y[v-1-h*2-P]),m.get(S+E*4+T+P)&&_.set(y[v-1-h*2-P],y[v-1-h*2-B]),m.get(S+E*6+T+P)&&_.set(y[v-1-h*2-B],y[h*2+P]);S+=E*8}if(t.drawModeMessage(_,l,b,x),l)t.drawBullsEye(_,sa.truncDivision(b,2),5);else{t.drawBullsEye(_,sa.truncDivision(b,2),7);for(var h=0,B=0;h<sa.truncDivision(v,2)-1;h+=15,B+=16)for(var P=sa.truncDivision(b,2)&1;P<b;P+=2)_.set(sa.truncDivision(b,2)-B,P),_.set(sa.truncDivision(b,2)+B,P),_.set(P,sa.truncDivision(b,2)-B),_.set(P,sa.truncDivision(b,2)+B)}var O=new H9e;return O.setCompact(l),O.setSize(b),O.setLayers(c),O.setCodeWords(p),O.setMatrix(_),O},t.drawBullsEye=function(e,r,n){for(var a=0;a<n;a+=2)for(var s=r-a;s<=r+a;s++)e.set(s,r-a),e.set(s,r+a),e.set(r-a,s),e.set(r+a,s);e.set(r-n,r-n),e.set(r-n+1,r-n),e.set(r-n,r-n+1),e.set(r+n,r-n),e.set(r+n,r-n+1),e.set(r+n,r+n-1)},t.generateModeMessage=function(e,r,n){var a=new el;return e?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=t.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=t.generateCheckWords(a,40,4)),a},t.drawModeMessage=function(e,r,n,a){var s=sa.truncDivision(n,2);if(r)for(var o=0;o<7;o++){var l=s-3+o;a.get(o)&&e.set(l,s-5),a.get(o+7)&&e.set(s+5,l),a.get(20-o)&&e.set(l,s+5),a.get(27-o)&&e.set(s-5,l)}else for(var o=0;o<10;o++){var l=s-5+o+sa.truncDivision(o,5);a.get(o)&&e.set(l,s-7),a.get(o+10)&&e.set(s+7,l),a.get(29-o)&&e.set(l,s+7),a.get(39-o)&&e.set(s-7,l)}},t.generateCheckWords=function(e,r,n){var a,s,o=e.getSize()/n,l=new Pse(t.getGF(n)),c=sa.truncDivision(r,n),u=t.bitsToWords(e,n,c);l.encode(u,c-o);var d=r%n,f=new el;f.appendBits(0,d);try{for(var A=nQe(Array.from(u)),h=A.next();!h.done;h=A.next()){var m=h.value;f.appendBits(m,n)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}return f},t.bitsToWords=function(e,r,n){var a=new Int32Array(n),s,o;for(s=0,o=e.getSize()/r;s<o;s++){for(var l=0,c=0;c<r;c++)l|=e.get(s*r+c)?1<<r-c-1:0;a[s]=l}return a},t.getGF=function(e){switch(e){case 4:return Jc.AZTEC_PARAM;case 6:return Jc.AZTEC_DATA_6;case 8:return Jc.AZTEC_DATA_8;case 10:return Jc.AZTEC_DATA_10;case 12:return Jc.AZTEC_DATA_12;default:throw new Pn("Unsupported word size "+e)}},t.stuffBits=function(e,r){for(var n=new el,a=e.getSize(),s=(1<<r)-2,o=0;o<a;o+=r){for(var l=0,c=0;c<r;c++)(o+c>=a||e.get(o+c))&&(l|=1<<r-1-c);(l&s)===s?(n.appendBits(l&s,r),o--):l&s?n.appendBits(l,r):(n.appendBits(l|1,r),o--)}return n},t.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.DEFAULT_EC_PERCENT=33,t.DEFAULT_AZTEC_LAYERS=0,t.MAX_NB_BITS=32,t.MAX_NB_BITS_COMPACT=4,t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),t})();var aQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sQe=function(t){aQe(e,t);function e(r){var n=t.call(this,r.width,r.height)||this;return n.canvas=r,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(r),n}return e.makeBufferFromCanvasImageData=function(r){var n;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height)},e.toGrayscaleBuffer=function(r,n,a){for(var s=new Uint8ClampedArray(n*a),o=0,l=0,c=r.length;o<c;o+=4,l++){var u=void 0,d=r[o+3];if(d===0)u=255;else{var f=r[o],A=r[o+1],h=r[o+2];u=306*f+601*A+117*h+512>>10}s[l]=u}return s},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new gP(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=r*e.DEGREE_TO_RADIANS,s=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(a))*s+Math.abs(Math.sin(a))*o),c=Math.ceil(Math.abs(Math.sin(a))*s+Math.abs(Math.cos(a))*o);n.width=l,n.height=c;var u=n.getContext("2d");if(!u)throw new Error("Could not create a Canvas Context element.");return u.translate(l/2,c/2),u.rotate(a),u.drawImage(this.canvas,s/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(Gw);function Fse(){return typeof navigator<"u"}function iQe(){return Fse()&&!!navigator.mediaDevices}function oQe(){return!!(iQe()&&navigator.mediaDevices.enumerateDevices)}var Zx=function(){return Zx=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Zx.apply(this,arguments)},ti=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},ri=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},X5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},lQe={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},N1=function(){function t(e,r,n){r===void 0&&(r=new Map),n===void 0&&(n={}),this.reader=e,this.hints=r,this.options=Zx(Zx({},lQe),n)}return Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(Ns.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),t.addVideoSource=function(e,r){try{e.srcObject=r}catch{console.error("got interrupted by new loading request")}},t.mediaStreamSetTorch=function(e,r){return ti(this,void 0,void 0,function(){return ri(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:r?"flash":"off",torch:!!r}]})];case 1:return n.sent(),[2]}})})},t.mediaStreamIsTorchCompatible=function(e){var r,n,a=e.getVideoTracks();try{for(var s=X5(a),o=s.next();!o.done;o=s.next()){var l=o.value;if(t.mediaStreamIsTorchCompatibleTrack(l))return!0}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},t.mediaStreamIsTorchCompatibleTrack=function(e){try{var r=e.getCapabilities();return"torch"in r}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},t.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},t.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Qi("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Qi("element with id '".concat(e,"' must be an ").concat(r," element"));return n},t.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return t.getMediaElement(e,"video");if(!e&&typeof document<"u"){var r=document.createElement("video");return r.width=200,r.height=200,r}throw new Error("Couldn't get videoElement from videoSource!")},t.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return t.getMediaElement(e,"img");if(typeof e>"u"){var r=document.createElement("img");return r.width=200,r.height=200,r}throw new Error("Couldn't get imageElement from imageSource!")},t.prepareVideoElement=function(e){var r=t.createVideoElement(e);return r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.createBinaryBitmapFromCanvas=function(e){var r=new sQe(e),n=new xse(r);return new gse(n)},t.drawImageOnCanvas=function(e,r){e.drawImage(r,0,0)},t.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},t.createCaptureCanvas=function(e){if(!e)throw new Qi("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var r=document.createElement("canvas"),n=t.getMediaElementDimensions(e),a=n.width,s=n.height;return r.style.width=a+"px",r.style.height=s+"px",r.width=a,r.height=s,r},t.tryPlayVideo=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:if(e!=null&&e.ended)return console.error("Trying to play video that has ended."),[2,!1];if(t.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return r=n.sent(),console.warn("It was not possible to play the video.",r),[2,!1];case 4:return[2]}})})},t.createCanvasFromMediaElement=function(e){var r=t.createCaptureCanvas(e),n=r.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return t.drawImageOnCanvas(n,e),r},t.createBinaryBitmapFromMediaElem=function(e){var r=t.createCanvasFromMediaElement(e);return t.createBinaryBitmapFromCanvas(r)},t.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},t.listVideoInputDevices=function(){return ti(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return ri(this,function(h){switch(h.label){case 0:if(!Fse())throw new Error("Can't enumerate devices, navigator is not present.");if(!oQe())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=X5(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device ".concat(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.findDeviceById=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:return[4,t.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2]}})})},t.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},t.releaseAllStreams=function(){t.streamTracker.length!==0&&t.streamTracker.forEach(function(e){e.getTracks().forEach(function(r){return r.stop()})}),t.streamTracker=[]},t.playVideoOnLoadAsync=function(e,r){return ti(this,void 0,void 0,function(){var n;return ri(this,function(a){switch(a.label){case 0:return[4,t.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(s,o){var l=setTimeout(function(){t.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",c))},r),c=function(){t.tryPlayVideo(e).then(function(u){clearTimeout(l),e.removeEventListener("canplay",c),s(u)})};e.addEventListener("canplay",c)})]}})})},t.attachStreamToVideo=function(e,r,n){return n===void 0&&(n=5e3),ti(this,void 0,void 0,function(){var a;return ri(this,function(s){switch(s.label){case 0:return a=t.prepareVideoElement(r),t.addVideoSource(a,e),[4,t.playVideoOnLoadAsync(a,n)];case 1:return s.sent(),[2,a]}})})},t._waitImageLoad=function(e){return new Promise(function(r,n){var a=1e4,s=setTimeout(function(){t.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(s),e.removeEventListener("load",o),r()};e.addEventListener("load",o)})},t.checkCallbackFnOrThrow=function(e){if(!e)throw new Qi("`callbackFn` is a required parameter, you cannot capture results without it.")},t.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(r){return r.stop()}),e=void 0},t.prototype.decode=function(e){var r=t.createCanvasFromMediaElement(e);return this.decodeFromCanvas(r)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},t.prototype.decodeFromCanvas=function(e){var r=t.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(r)},t.prototype.decodeFromImageElement=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:if(!e)throw new Qi("An image element must be provided.");return r=t.prepareImageElement(e),[4,this._decodeOnLoadImage(r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeFromImageUrl=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:if(!e)throw new Qi("An URL must be provided.");r=t.prepareImageElement(),r.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(r)];case 2:return[2,n.sent()];case 3:return t.destroyImageElement(r),[7];case 4:return[2]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return ti(this,void 0,void 0,function(){var a,s;return ri(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,r,n)];case 3:return[2,o.sent()];case 4:throw s=o.sent(),t.disposeMediaStream(a),s;case 5:return[2]}})})},t.prototype.decodeFromStream=function(e,r,n){return ti(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A,h=this;return ri(this,function(m){switch(m.label){case 0:return t.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,t.attachStreamToVideo(e,r,a)];case 1:return s=m.sent(),o=function(){t.disposeMediaStream(e),t.cleanVideoSource(s)},l=this.scan(s,n,o),c=e.getVideoTracks(),u=Zx(Zx({},l),{stop:function(){l.stop()},streamVideoConstraintsApply:function(p,x){return ti(this,void 0,void 0,function(){var v,y,b,w,j,I,_;return ri(this,function(S){switch(S.label){case 0:v=x?c.filter(x):c,S.label=1;case 1:S.trys.push([1,6,7,8]),y=X5(v),b=y.next(),S.label=2;case 2:return b.done?[3,5]:(w=b.value,[4,w.applyConstraints(p)]);case 3:S.sent(),S.label=4;case 4:return b=y.next(),[3,2];case 5:return[3,8];case 6:return j=S.sent(),I={error:j},[3,8];case 7:try{b&&!b.done&&(_=y.return)&&_.call(y)}finally{if(I)throw I.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(p){return c.find(p).getConstraints()},streamVideoSettingsGet:function(p){return c.find(p).getSettings()},streamVideoCapabilitiesGet:function(p){return c.find(p).getCapabilities()}}),d=t.mediaStreamIsTorchCompatible(e),d&&(f=c==null?void 0:c.find(function(p){return t.mediaStreamIsTorchCompatibleTrack(p)}),A=function(p){return ti(h,void 0,void 0,function(){return ri(this,function(x){switch(x.label){case 0:return[4,t.mediaStreamSetTorch(f,p)];case 1:return x.sent(),[2]}})})},u.switchTorch=A,u.stop=function(){return ti(h,void 0,void 0,function(){return ri(this,function(p){switch(p.label){case 0:return l.stop(),[4,A(!1)];case 1:return p.sent(),[2]}})})}),[2,u]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return ti(this,void 0,void 0,function(){var a,s;return ri(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromVideoElement=function(e,r){return ti(this,void 0,void 0,function(){var n,a;return ri(this,function(s){switch(s.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Qi("A video element must be provided.");return n=t.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,a)];case 1:return s.sent(),[2,this.scan(n,r)]}})})},t.prototype.decodeFromVideoUrl=function(e,r){return ti(this,void 0,void 0,function(){var n,a,s,o;return ri(this,function(l){switch(l.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Qi("An URL must be provided.");return n=t.prepareVideoElement(),n.src=e,a=function(){t.cleanVideoSource(n)},s=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,s)];case 1:return l.sent(),o=this.scan(n,r,a),[2,o]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return ti(this,void 0,void 0,function(){var n;return ri(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return ti(this,void 0,void 0,function(){var n,a,s;return ri(this,function(o){switch(o.label){case 0:return n=!!r,[4,t.attachStreamToVideo(e,r)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return s=o.sent(),[2,s];case 4:return n||t.cleanVideoSource(a),[7];case 5:return[2]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return ti(this,void 0,void 0,function(){var n,a;return ri(this,function(s){switch(s.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromVideoElement=function(e){return ti(this,void 0,void 0,function(){var r,n;return ri(this,function(a){switch(a.label){case 0:if(!e)throw new Qi("A video element must be provided.");return r=t.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(r,n)];case 1:return a.sent(),[4,this.scanOneResult(r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromVideoUrl=function(e){return ti(this,void 0,void 0,function(){var r,n;return ri(this,function(a){switch(a.label){case 0:if(!e)throw new Qi("An URL must be provided.");r=t.prepareVideoElement(),r.src=e,n=this.decodeOnceFromVideoElement(r),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return t.cleanVideoSource(r),[7];case 4:return[2]}})})},t.prototype.scanOneResult=function(e,r,n,a){var s=this;return r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,l){s.scan(e,function(c,u,d){if(c){o(c),d.stop();return}if(u){if(u instanceof ur&&r||u instanceof oo&&n||u instanceof Hr&&a)return;d.stop(),l(u)}})})},t.prototype.scan=function(e,r,n){var a=this;t.checkCallbackFnOrThrow(r);var s=t.createCaptureCanvas(e),o;try{o=s.getContext("2d",{willReadFrequently:!0})}catch{o=s.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var l=function(){o=void 0,s=void 0},c=!1,u,d=function(){c=!0,clearTimeout(u),l(),n&&n()},f={stop:d},A=function(){if(!c)try{t.drawImageOnCanvas(o,e);var h=a.decodeFromCanvas(s);r(h,void 0,f),u=setTimeout(A,a.options.delayBetweenScanSuccess)}catch(v){r(void 0,v,f);var m=v instanceof oo,p=v instanceof Hr,x=v instanceof ur;if(m||p||x){u=setTimeout(A,a.options.delayBetweenScanAttempts);return}l(),n&&n(v)}};return A(),f},t.prototype._decodeOnLoadImage=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:return r=t.isImageLoaded(e),r?[3,2]:[4,t._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},t.prototype.getUserMedia=function(e){return ti(this,void 0,void 0,function(){var r;return ri(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=n.sent(),t.streamTracker.push(r),[2,r]}})})},t.streamTracker=[],t}(),cQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){cQe(e,t);function e(r,n){return t.call(this,new ZS,r,n)||this}return e})(N1);var uQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){uQe(e,t);function e(r,n){return t.call(this,new Yx(r),r,n)||this}return e})(N1);var dQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){dQe(e,t);function e(r,n){return t.call(this,new tI,r,n)||this}return e})(N1);var fQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$2=function(t){fQe(e,t);function e(r,n){var a=this,s=new jse;return s.setHints(r),a=t.call(this,s,r,n)||this,a.reader=s,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(r){this.hints.set(Ns.POSSIBLE_FORMATS,r),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e.prototype.setHints=function(r){this.hints=r,this.reader.setHints(this.hints)},e}(N1),hQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){hQe(e,t);function e(r,n){return t.call(this,new nI,r,n)||this}return e})(N1);var AQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){AQe(e,t);function e(r,n){return t.call(this,new rI,r,n)||this}return e})(N1);const Y5=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function os(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Rh(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function v0(t,e=1){const r=Math.floor(Rh(t,e));return r>0?r:e}function mQe(t){return Object.values(t||{}).every(r=>os(r)==="")}function ep(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(os(a),a));for(const a of e){const s=n.get(os(a));if(s!=null)return t[s]}}function pQe({open:t,code:e,onClose:r}){return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-lg border p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"font-bold text-lg",children:"Cdigo de barras"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Valor"}),i.jsx("div",{className:"text-xl font-mono font-semibold break-all",children:e})]}),i.jsx("div",{className:"mt-3 flex gap-2 justify-end",children:i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>{var n;try{(n=navigator.clipboard)==null||n.writeText(e)}catch{}},children:"Copiar"})})]})}):null}function gQe({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new $2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function xQe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState(1),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(null),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,T]=g.useState(0),[P,O]=g.useState(1),[z,ce]=g.useState(""),[de,ue]=g.useState(""),[me,se]=g.useState(""),[ke,Re]=g.useState(""),[F,H]=g.useState(""),[K,L]=g.useState(!1),[W,Y]=g.useState(""),[D,Q]=g.useState(!1),[ee,ve]=g.useState("create"),[M,Ye]=g.useState(!1),[ae,X]=g.useState(""),[De,le]=g.useState([]),[$e,Xe]=g.useState([]),[it,xt]=g.useState(!1),[jt,Mt]=g.useState(!1);g.useEffect(()=>{var lt;const Be=window.matchMedia("(max-width: 900px)"),at=()=>Mt(Be.matches);return at(),(lt=Be.addEventListener)==null||lt.call(Be,"change",at),()=>{var dt;return(dt=Be.removeEventListener)==null?void 0:dt.call(Be,"change",at)}},[]);const[Ft,$t]=g.useState(!0),[kt,Ge]=g.useState(!0);g.useEffect(()=>{jt?($t(!1),Ge(!1)):($t(!0),Ge(!0))},[jt]);const[ie,Ue]=g.useState(null),[Ne,be]=g.useState({}),Ce=g.useRef(!1),Le=g.useRef(null);g.useEffect(()=>{n(!0),s("");const Be=yt(Ie,"products_candies"),at=sr(Be,In("name","asc")),lt=jd(at,dt=>{const Pt=[],he={};dt.forEach(ne=>{const He=ne.data(),pt=String(He.barcode||"").trim()||void 0;pt&&(he[ne.id]=pt),Pt.push({id:ne.id,name:He.name||"",category:He.category||"",providerPrice:Number(He.providerPrice||0),unitsPerPackage:Number(He.unitsPerPackage||1),barcode:pt,packaging:String(He.packaging||He.empaque||"").trim()||void 0,createdAt:He.createdAt})});const ze=Ae.current||{};let nt=!1;for(const ne of Object.keys(he))if((he[ne]||"")!==(ze[ne]||"")){nt=!0;break}l(Pt),Ae.current=he,n(!1),!We.current&&nt&&(s(" Catlogo actualizado."),setTimeout(()=>s(""),3e3)),We.current=!1},dt=>{console.error(dt),s(" Error sincronizando catlogo de dulces."),n(!1)});return()=>lt()},[t]);const Ae=g.useRef({}),We=g.useRef(!0),ct=g.useMemo(()=>{const Be=os(me),at=String(ke||"").trim(),lt=String(F||"").trim().toLowerCase();return lt?o.filter(dt=>String(dt.packaging||"").trim().toLowerCase()===lt):!Be&&!at?o:o.filter(dt=>{const Pt=`${dt.category} ${dt.name}`.toLowerCase(),he=Be?Pt.includes(Be):!0,ze=String(dt.barcode||""),nt=at?ze.includes(at):!0;return he&&nt})},[o,me,ke,F]),_t=7,[pe,Pe]=g.useState(1),Ee=g.useMemo(()=>{const Be={};return ct.forEach(at=>{const lt=String(at.category||"(sin categora)").trim()||"(sin categora)";Be[lt]||(Be[lt]=[]),Be[lt].push(at)}),Object.entries(Be).map(([at,lt])=>({category:at,rows:lt.sort((dt,Pt)=>dt.name.localeCompare(Pt.name,"es"))})).sort((at,lt)=>at.category.localeCompare(lt.category,"es"))},[ct]),Ze=Math.max(1,Math.ceil((jt?Ee.length:ct.length)/_t)),xe=g.useMemo(()=>{const Be=(pe-1)*_t;return ct.slice(Be,Be+_t)},[ct,pe]),Se=g.useMemo(()=>{const Be=(pe-1)*_t;return Ee.slice(Be,Be+_t)},[Ee,pe]);g.useEffect(()=>{Pe(1)},[me,ke,F]),g.useEffect(()=>{Pe(Be=>Math.min(Be,Ze))},[Ze]);const gt=()=>Pe(1),Et=()=>Pe(Be=>Math.max(1,Be-1)),Nt=()=>Pe(Be=>Math.min(Ze,Be+1)),Tt=()=>Pe(Ze),Lt=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:gt,disabled:pe===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Et,disabled:pe===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",pe," de ",Ze]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Nt,disabled:pe===Ze,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Tt,disabled:pe===Ze,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[ct.length," producto(s)"]})]}),Me=Be=>{be(at=>({...at,[Be]:!at[Be]}))},_e=g.useMemo(()=>{const Be=new Set;return o.forEach(at=>{const lt=String(at.category||"").trim();lt&&Be.add(lt)}),Array.from(Be).sort((at,lt)=>at.localeCompare(lt,"es"))},[o]),U=()=>{u(""),f(""),h(0),p(1),v(""),b("")},ye=async Be=>{if(Be.preventDefault(),Ce.current||r)return;s("");const at=String(c||"").trim(),lt=String(d||"").trim(),dt=Math.max(0,Rh(A,0)),Pt=v0(m,1),he=String(x||"").trim();if(!at)return s(" La categora es requerida.");if(!lt)return s(" El nombre del producto es requerido.");if(dt<=0)return s(" El precio proveedor debe ser > 0.");if(Pt<=0)return s(" Und x paquete debe ser > 0.");const ze=`${os(at)}::${os(lt)}`,nt=Date.now();if(Le.current&&Le.current.key===ze&&nt-Le.current.ts<4e3){s(" Ya se est creando este producto.");return}if(o.some(He=>os(He.category)===os(at)&&os(He.name)===os(lt)))return s(" Ya existe un producto con esa categora y nombre.");if(he&&o.some(pt=>String(pt.barcode||"")===he))return s(" Ya existe un producto con ese cdigo de barras.");Ce.current=!0,Le.current={key:ze,ts:nt};try{if(n(!0),!(await Ht(sr(yt(Ie,"products_candies"),mr("category","==",at),mr("name","==",lt),gS(1)))).empty){s(" Ya existe un producto con esa categora y nombre.");return}if(he&&!(await Ht(sr(yt(Ie,"products_candies"),mr("barcode","==",he),gS(1)))).empty){s(" Ya existe un producto con ese cdigo de barras.");return}const pt={category:at,name:lt,providerPrice:dt,unitsPerPackage:Pt,createdAt:vr.now()};he&&(pt.barcode=he);const Dt=String(y||"").trim();Dt&&(pt.packaging=Dt),await Jn(yt(Ie,"products_candies"),pt),s(" Producto creado."),U()}catch(He){console.error(He),s(" Error creando producto.")}finally{n(!1),Ce.current=!1}},te=Be=>{j(Be.id),_(Be.category),E(Be.name),T(Be.providerPrice),O(Be.unitsPerPackage||1),ce(String(Be.barcode||"")),ue(String(Be.packaging||"")),s("")},Ve=()=>{j(null),_(""),E(""),T(0),O(1),ce(""),ue("")},qe=async()=>{if(!w)return;s("");const Be=String(I||"").trim(),at=String(S||"").trim(),lt=Math.max(0,Rh(B,0)),dt=v0(P,1),Pt=String(z||"").trim(),he=String(de||"").trim();if(!Be)return s(" La categora es requerida.");if(!at)return s(" El nombre del producto es requerido.");if(lt<=0)return s(" El precio proveedor debe ser > 0.");if(dt<=0)return s(" Und x paquete debe ser > 0.");if(o.some(nt=>nt.id!==w&&os(nt.category)===os(Be)&&os(nt.name)===os(at)))return s(" Ya existe otro producto con esa categora y nombre.");if(Pt&&o.some(ne=>ne.id!==w&&String(ne.barcode||"")===Pt))return s(" Ya existe otro producto con ese cdigo de barras.");try{n(!0);const nt={category:Be,name:at,providerPrice:lt,unitsPerPackage:dt,updatedAt:vr.now()};nt.barcode=Pt||"",nt.packaging=he||"",await Fn(Zt(Ie,"products_candies",w),nt),l(ne=>ne.map(He=>He.id===w?{...He,category:Be,name:at,providerPrice:lt,unitsPerPackage:dt,barcode:Pt||void 0,packaging:he||void 0}:He).sort((He,pt)=>He.name.localeCompare(pt.name,"es"))),jt&&s(" Producto guardado."),Ve()}catch(nt){console.error(nt),s(" Error actualizando producto.")}finally{n(!1)}},G=async Be=>{if(confirm(`Eliminar "${Be.name}" (${Be.category}) del catlogo?`))try{n(!0),await Kn(Zt(Ie,"products_candies",Be.id)),l(lt=>lt.filter(dt=>dt.id!==Be.id)),s(" Producto eliminado.")}catch(lt){console.error(lt),s(" Error eliminando producto.")}finally{n(!1)}},V=()=>{const Be=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24,Empaque:"Tarro",Codigo:"7445074183182"}],at=Qa.json_to_sheet(Be),lt=Qa.book_new();Qa.book_append_sheet(lt,at,"Productos");const dt=mP(lt,{type:"array",bookType:"xlsx"}),Pt=new Blob([dt],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),he=URL.createObjectURL(Pt),ze=document.createElement("a");ze.href=he,ze.download="template_productos_dulces.xlsx",document.body.appendChild(ze),ze.click(),ze.remove(),URL.revokeObjectURL(he)},Z=Be=>{const at=[],lt=[];Be.forEach((Pt,he)=>{if(!Pt||typeof Pt!="object"||mQe(Pt))return;const ze=String(ep(Pt,["Id","ID","productId","docId"])??"").trim(),nt=String(ep(Pt,["Categoria","Categora","Category","cat","category"])??"").trim(),ne=String(ep(Pt,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),He=ep(Pt,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),pt=ep(Pt,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),Dt=ep(Pt,["Codigo","Cdigo","Barcode","barcode","EAN","UPC","Code"]),rr=String(Dt??"").trim(),zt=ep(Pt,["Empaque","Packaging","PackagingType","Pack","Formato"]),Ot=String(zt??"").trim(),lr=Math.max(0,Rh(He,0)),Dr=v0(pt,1),br=he+2;nt||lt.push(`Fila ${br}: falta Categoria.`),ne||lt.push(`Fila ${br}: falta Producto/Nombre.`),lr<=0&&lt.push(`Fila ${br}: PrecioProveedor debe ser > 0.`),Dr<=0&&lt.push(`Fila ${br}: UnidadesPorPaquete debe ser > 0.`),nt&&ne&&lr>0&&Dr>0&&at.push({id:ze||void 0,category:nt,name:ne,providerPrice:lr,unitsPerPackage:Dr,barcode:rr||void 0,packaging:Ot||void 0,_raw:Pt})});const dt=new Map;for(const Pt of at){const he=Pt.id?`id::${Pt.id}`:`${os(Pt.category)}::${os(Pt.name)}`;dt.set(he,Pt)}return{rows:Array.from(dt.values()),errors:lt}},re=async Be=>{if(s(""),Xe([]),le([]),X((Be==null?void 0:Be.name)||""),!Be)return;const at=Be.name.toLowerCase(),lt=at.endsWith(".xlsx")||at.endsWith(".xls"),dt=at.endsWith(".csv");if(!lt&&!dt){Xe(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{xt(!0);const Pt=new FileReader,he=await new Promise((rr,zt)=>{Pt.onerror=()=>zt(new Error("No se pudo leer el archivo.")),Pt.onload=()=>rr(Pt.result),Pt.readAsArrayBuffer(Be)}),ze=Vv(new Uint8Array(he),{type:"array"}),nt=ze.SheetNames[0],ne=ze.Sheets[nt],He=Qa.sheet_to_json(ne,{defval:""}),{rows:pt,errors:Dt}=Z(He);le(pt),Xe(Dt),pt.length===0&&Dt.length===0&&Xe(["No se encontraron filas vlidas para importar."])}catch(Pt){console.error(Pt),Xe(["Error leyendo el archivo. Revis que no est corrupto."])}finally{xt(!1)}},we=(Be,at)=>{le(lt=>{const dt=[...lt],Pt=dt[Be];return Pt?(dt[Be]={...Pt,...at},dt):lt})},Fe=async()=>{if(s(""),$e.length>0){s(" Correg los errores antes de importar.");return}if(De.length===0){s(" No hay filas para importar.");return}try{xt(!0);const Be={},at={},lt={};o.forEach(ze=>{Be[ze.id]=ze,at[`${os(ze.category)}::${os(ze.name)}`]=ze;const nt=String(ze.barcode||"").trim();nt&&(lt[nt]=ze)});const dt=tu(Ie);let Pt=0,he=0;for(const ze of De){const nt=String(ze.category||"").trim(),ne=String(ze.name||"").trim(),He=Math.max(0,Rh(ze.providerPrice,0)),pt=v0(ze.unitsPerPackage,1),Dt=String(ze.barcode||"").trim();if(!nt||!ne||He<=0||pt<=0)continue;let rr;if(ze.id&&Be[ze.id])rr=Be[ze.id];else{const zt=`${os(nt)}::${os(ne)}`;rr=at[zt]}if(!rr&&Dt&&lt[Dt]&&(rr=lt[Dt]),rr){const zt={category:nt,name:ne,providerPrice:He,unitsPerPackage:pt,updatedAt:vr.now()};ze.barcode!=null&&(zt.barcode=Dt||""),ze.packaging!=null&&(zt.packaging=String(ze.packaging||"")||""),dt.update(Zt(Ie,"products_candies",rr.id),zt),he+=1}else{const zt=Zt(yt(Ie,"products_candies")),Ot={category:nt,name:ne,providerPrice:He,unitsPerPackage:pt,createdAt:vr.now()};Dt&&(Ot.barcode=Dt),ze.packaging&&(Ot.packaging=ze.packaging),dt.set(zt,Ot),Pt+=1}}await dt.commit(),s(` Importacin lista. Creados: ${Pt}, Actualizados: ${he}`),Ye(!1),le([]),Xe([]),X(""),e()}catch(Be){console.error(Be),s(" Error importando productos a Firestore.")}finally{xt(!1)}},st=g.useMemo(()=>{const Be=new Set(o.map(he=>he.id)),at=new Set(o.map(he=>`${os(he.category)}::${os(he.name)}`)),lt=new Set(o.map(he=>String(he.barcode||"").trim()).filter(Boolean));let dt=0,Pt=0;for(const he of De){if(he.id&&Be.has(he.id)){dt+=1;continue}const ze=`${os(he.category)}::${os(he.name)}`;if(at.has(ze)){dt+=1;continue}const nt=String(he.barcode||"").trim();if(nt&&lt.has(nt)){dt+=1;continue}Pt+=1}return{willCreate:Pt,willUpdate:dt,total:De.length}},[De,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catalogo"}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Oc,{onClick:e,loading:r||it}),!jt&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Ye(!0),le([]),Xe([]),X("")},children:"Importar"})]})})]}),jt&&i.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-900 text-white",onClick:()=>$t(Be=>!Be),children:Ft?"Ocultar creacin":"Crear producto"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Ye(!0),le([]),Xe([]),X("")},children:"Importar"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-200",onClick:()=>Ge(Be=>!Be),children:kt?"Ocultar filtros":"Mostrar filtros"}),kt&&i.jsxs("div",{className:"bg-white p-3 rounded shadow-sm border",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:F,onChange:Be=>H(Be.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),Ft&&i.jsxs("form",{onSubmit:ye,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:Be=>u(Be.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:d,onChange:Be=>f(Be.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:y,onChange:Be=>b(Be.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(A)?"":A,onChange:Be=>h(Math.max(0,Rh(Be.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:Be=>p(v0(Be.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo (opcional)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"w-full border rounded px-2 py-1",value:x,onChange:Be=>v(Be.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white hover:bg-black whitespace-nowrap",onClick:()=>{ve("create"),Q(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"md:col-span-6 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:U,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),kt&&i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:me,onChange:Be=>se(Be.target.value),placeholder:"Buscar por categora o producto"}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:F,onChange:Be=>H(Be.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:ke,onChange:Be=>Re(Be.target.value),placeholder:"Ej: 7445074183182"}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("search"),Q(!0),Ge(!0)},children:"Escanear producto"})}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{se(""),Re("")},children:"Limpiar filtros"})})]}),i.jsxs("div",{className:"w-full md:w-auto text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:ct.length})]})]}),jt?i.jsxs("div",{className:"space-y-2",children:[r?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Cargando"}):ct.length===0?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Sin productos."}):i.jsx("div",{className:"space-y-3",children:Se.map(Be=>{const at=!!Ne[Be.category];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Me(Be.category),"aria-expanded":at,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:Be.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Be.rows.length," producto(s)"]})]}),i.jsx("span",{className:`transition-transform ${at?"rotate-180":""}`,children:""})]}),at&&i.jsx("div",{className:"border-t p-2 space-y-2",children:Be.rows.map(lt=>{const dt=w===lt.id,Pt=ie===lt.id,he=!!String(lt.barcode||"").trim();return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Ue(ze=>ze===lt.id?null:lt.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:lt.name}),i.jsx("div",{className:"text-xs text-gray-600 truncate",children:lt.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("div",{className:"font-bold tabular-nums",children:Y5(lt.providerPrice)})]})]}),Pt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Categora"}),dt?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:ze=>_(ze.target.value)}):i.jsx("div",{className:"font-semibold",children:lt.category})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Und x paquete"}),dt?i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:P,onChange:ze=>O(v0(ze.target.value,1))}):i.jsx("div",{className:"font-semibold text-right tabular-nums",children:lt.unitsPerPackage})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Empaque"}),dt?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:de,onChange:ze=>ue(ze.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"font-semibold",children:lt.packaging||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),dt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:ze=>T(Math.max(0,Rh(ze.target.value,0)))}):i.jsx("div",{className:"font-semibold tabular-nums",children:Y5(lt.providerPrice)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Cdigo"}),dt?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-1",value:z,onChange:ze=>ce(ze.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("edit"),Q(!0)},children:"Escanear"})]}):he?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{Y(String(lt.barcode||"").trim()),L(!0)},children:"Ver cdigo"}):i.jsx("div",{className:"text-gray-600",children:"No"})]})]}),i.jsx("div",{className:"pt-2 flex gap-2",children:dt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-blue-600 text-white",onClick:qe,type:"button",children:"Guardar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("edit"),Q(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-200",onClick:Ve,type:"button",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400",onClick:()=>te(lt),type:"button",children:"Editar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:()=>G(lt),type:"button",children:"Borrar"})]})})]})})]},lt.id)})})]},Be.category)})}),!r&&ct.length>0&&Lt()]}):i.jsxs("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1050px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):ct.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin productos."})}):xe.map(Be=>{const at=w===Be.id,lt=!!String(Be.barcode||"").trim();return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:at?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:dt=>_(dt.target.value)}):Be.category}),i.jsx("td",{className:"p-2 border",children:at?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:S,onChange:dt=>E(dt.target.value)}):Be.name}),i.jsx("td",{className:"p-2 border",children:at?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:de,onChange:dt=>ue(dt.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):Be.packaging||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:at?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:dt=>T(Math.max(0,Rh(dt.target.value,0)))}):Y5(Be.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:at?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:P,onChange:dt=>O(v0(dt.target.value,1))}):Be.unitsPerPackage}),i.jsx("td",{className:"p-2 border text-center",children:at?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:z,onChange:dt=>ce(dt.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-800 text-white hover:bg-black",onClick:()=>{ve("edit"),Q(!0)},children:"Escanear"})]}):lt?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{Y(String(Be.barcode||"").trim()),L(!0)},children:"S"}):i.jsx("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-600",children:"No"})}),i.jsx("td",{className:"p-2 border",children:at?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:qe,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ve,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>te(Be),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>G(Be),type:"button",children:"Borrar"})]})})]},Be.id)})})]}),!r&&ct.length>0&&Lt()]}),a?jt&&a===" Producto guardado."?i.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[i.jsx("div",{className:"flex-1 text-sm",children:a}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white",onClick:()=>{s(""),Ve(),Q(!1)},children:"Aceptar"})]}):i.jsx("p",{className:"mt-2 text-sm",children:a}):null,i.jsx(pQe,{open:K,code:W,onClose:()=>L(!1)}),i.jsx(gQe,{open:D,onClose:()=>Q(!1),onDetected:async Be=>{const at=String(Be||"").trim();if(at){if(ee==="edit"&&w){if(o.some(dt=>dt.id!==w&&String(dt.barcode||"")===at)){s(" Ya existe otro producto con ese cdigo de barras."),ce(at),Q(!1);return}try{await Fn(Zt(Ie,"products_candies",w),{barcode:at}),l(dt=>dt.map(Pt=>Pt.id===w?{...Pt,barcode:at}:Pt)),ce(at),jt&&s(" Producto guardado.")}catch(dt){console.error(dt),s(" Error guardando cdigo de barras.")}finally{Q(!1)}return}if(ee==="search"){Re(at),Q(!1);return}ee==="create"?v(Be):ce(Be)}}}),M&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ye(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete, Empaque (opcional), Codigo (opcional)."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:V,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:Be=>{var at;return re(((at=Be.target.files)==null?void 0:at[0])||null)}}),ae&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:ae})]}),it&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),$e.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:$e.slice(0,50).map((Be,at)=>i.jsx("li",{children:Be},at))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",st.total," filas (Crear:"," ",st.willCreate," / Actualizar:"," ",st.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:Fe,disabled:it||De.length===0||$e.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1250px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Codigo (opcional)"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:De.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):De.slice(0,300).map((Be,at)=>{const lt=Be.id?o.some(ze=>ze.id===Be.id):!1,dt=o.some(ze=>`${os(ze.category)}::${os(ze.name)}`==`${os(Be.category)}::${os(Be.name)}`),Pt=Be.barcode?o.some(ze=>String(ze.barcode||"")===Be.barcode):!1,he=lt||dt||Pt;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Be.id||"",onChange:ze=>we(at,{id:ze.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Be.category,onChange:ze=>we(at,{category:ze.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:Be.name,onChange:ze=>we(at,{name:ze.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(Be.providerPrice)?"":Be.providerPrice,onChange:ze=>we(at,{providerPrice:Math.max(0,Rh(ze.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:Be.unitsPerPackage,onChange:ze=>we(at,{unitsPerPackage:v0(ze.target.value,1)})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Be.packaging||"",onChange:ze=>we(at,{packaging:ze.target.value.trim()||void 0}),placeholder:"Tarro, Bolsa..."})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Be.barcode||"",onChange:ze=>we(at,{barcode:ze.target.value.trim()||void 0}),placeholder:"EAN/UPC (opcional)"})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${he?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:he?"ACTUALIZA":"CREA"})})]},`${Be.id||""}-${at}`)})})]}),i.jsx("datalist",{id:"categories-list",children:_e.map(Be=>i.jsx("option",{value:Be},Be))})]}),De.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",De.length," filas (el import importa todas)."]})]})]})})]})}function Ose(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),a=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):a>0?Math.floor(a*e):0}function J5(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Ose(t)}const Dse=t=>Math.max(0,Math.floor(Number(t??0)));function vQe(t){return Dse(t.packages??t.totalPackages??t.packs??t.packagesInitial??t.initialPackages??0)}function yQe(t){return Dse(t.remainingPackages??t.remainingPacks??t.packsRemaining??t.packagesRemaining??t.remaining_packages??0)}async function pF(t){const e=String(t||"").trim();if(!e)return{created:0,skipped:0,updated:0,totalItems:0};let r=Zt(Ie,"candy_main_orders",e),n=await zs(r);if(!n.exists()){const p=sr(yt(Ie,"candy_main_orders"),mr("orderId","==",e)),x=await Ht(p);if(x.empty)throw new Error("Orden maestra no existe");r=x.docs[0].ref,n=x.docs[0]}const a=n.data(),s=r.id,o=Array.isArray(a.items)?a.items:[];if(!o.length)return{created:0,skipped:0,updated:0,totalItems:0};const l=await Ht(sr(yt(Ie,"inventory_candies"),mr("orderId","==",s))),c=new Set,u=new Map;l.forEach(p=>{const x=p.data(),v=String(x.productId||"").trim();if(v&&c.add(v),!v)return;const y=u.get(v)||[];y.push({ref:p.ref,data:x}),u.set(v,y)});const d=tu(Ie);let f=0,A=0,h=0;const m=String(a.date||"");for(const p of o){const x=String(p.id||p.productId||"").trim();if(!x)continue;const v=u.get(x)||[];if(v.length>0){if(v.length===1&&v.every(T=>{const P=Math.max(0,Math.floor(Number(T.data.remainingPackages||0))),O=Math.max(0,Math.floor(Number(T.data.remaining||0))),z=Math.max(0,Math.floor(Number(T.data.totalUnits||0)));return P<=0&&O<=0&&z<=0})){const T=v[0].ref,P=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),O=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),z=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let ce=Math.max(0,Math.floor(O||0)),de=Math.max(0,Math.floor(z||0));ce<=0&&de>0&&(ce=de),de<=0&&(de=ce);const ue=ce*P,me=de*P;d.update(T,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:ue,remaining:me,packages:ce,remainingPackages:de,unitsPerPackage:P,totalUnits:ue,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,status:"PENDIENTE",orderId:s,updatedAt:vr.now()}),h+=1;continue}A+=1;continue}const y=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),b=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),w=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let j=Math.max(0,Math.floor(b||0)),I=Math.max(0,Math.floor(w||0));j<=0&&I>0&&(j=I),I<=0&&(I=j);const _=j*y,S=I*y,E=Zt(yt(Ie,"inventory_candies"));d.set(E,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:_,remaining:S,packages:j,remainingPackages:I,unitsPerPackage:y,totalUnits:_,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,createdAt:vr.now(),status:"PENDIENTE",orderId:s}),f+=1}return(f>0||h>0)&&await d.commit(),{created:f,skipped:A,updated:h,totalItems:o.length}}async function bQe(t){const e=Zt(Ie,"candy_main_orders",t);if((await zs(e)).exists())return e;const n=sr(yt(Ie,"candy_main_orders"),mr("orderId","==",t)),a=await Ht(n);return a.empty?null:Zt(Ie,"candy_main_orders",a.docs[0].id)}async function Z5(t){if(!t)return;const e=await bQe(t);if(!e)return;const r=sr(yt(Ie,"inventory_candies"),mr("orderId","==",t)),n=await Ht(r),a=new Map;n.forEach(l=>{const c=l.data(),u=String(c.productId||"");if(!u)return;const d=vQe(c),f=yQe(c),A=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),v=h*d,y=m*d,b=p*d,w=x*d,j=y-v,I=b-v,_=w-v;a.has(u)||a.set(u,{productId:u,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:A,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const S=a.get(u);S.packages+=d,S.remainingPackages+=f,S.subtotal+=v,S.totalRivas+=y,S.totalSanJorge+=b,S.totalIsla+=w,S.gainRivas+=j,S.gainSanJorge+=I,S.gainIsla+=_,S.providerPrice=h,S.unitPriceRivas=m||S.unitPriceRivas,S.unitPriceSanJorge=p||S.unitPriceSanJorge,S.unitPriceIsla=x||S.unitPriceIsla,S.unitsPerPackage=A||S.unitsPerPackage,S.name=String(c.productName||S.name),S.category=String(c.category||S.category)});const s=Array.from(a.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=s.reduce((l,c)=>l+Number(c.packages||0),0);await Fn(e,{totalPackages:o,items:s})}function wQe(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const a=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const s of a){const o=String(s.inventorySellerId||""),l=Math.max(0,Math.floor(Number(s.units??s.qty??s.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const a=e[n],s=Array.isArray(a==null?void 0:a.allocations)?a.allocations:[];for(const o of s){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function G2(t){const e=t.split("#")[0],r=Zt(Ie,"sales_candies",e),n=await zs(r);if(!n.exists())throw new Error("La venta no existe.");const a=n.data(),s=wQe(a);if(s&&s.allocations.length>0){let u=0;return await Gs(Ie,async d=>{const f={};for(const p of s.allocations){const x=p.inventorySellerId,v=Math.max(0,Math.floor(Number(p.units||0)));!x||v<=0||(f[x]=(f[x]||0)+v,u+=v)}const h=Object.keys(f).map(p=>Zt(Ie,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>d.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=Number(v.remainingUnits??v.remaining??0),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);d.update(h[p],{remainingUnits:w,remainingPackages:I})}d.delete(r)}),{restored:u}}const o=[];if(Array.isArray(a.items)&&a.items.length>0){const u={};if(a.allocationsByItem&&typeof a.allocationsByItem=="object")for(const d of Object.keys(a.allocationsByItem)){const f=a.allocationsByItem[d],A=String((f==null?void 0:f.productId)||d||"");if(!A)continue;const h=Array.isArray(f==null?void 0:f.allocations)?f.allocations:[];u[A]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(a.allocationsByItem))for(const d of a.allocationsByItem){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];u[f]=A.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const d of a.items){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Math.max(0,Math.floor(Number((d==null?void 0:d.qty)||(d==null?void 0:d.quantity)||0))),h=Array.isArray(d==null?void 0:d.allocations)?d.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):u[f]||[];o.push({productId:f,productName:String((d==null?void 0:d.productName)||""),qty:A,allocations:h.length?h:void 0})}}else{const u=a.item||{},d=String(u.productId||a.productId||""),f=Math.max(0,Math.floor(Number(u.qty??a.quantity??0))),A=Array.isArray(a.allocations)?a.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];d&&f>0&&o.push({productId:d,productName:String(u.productName||a.productName||""),qty:f,allocations:A.length?A:void 0})}if(o.length===0)return await Gs(Ie,async u=>{u.delete(r)}),{restored:0};if(o.every(u=>Array.isArray(u.allocations)&&u.allocations.length>0)){let u=0;return await Gs(Ie,async d=>{const f=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));u+=p,f.push({ref:Zt(Ie,"inventory_candies",m.batchId),addBack:p})}const A=await Promise.all(f.map(h=>d.get(h.ref)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=J5(p),v=Math.max(0,Math.floor(Number(f[h].addBack||0))),y=x+v,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),w=Math.floor(y/b);d.update(f[h].ref,{remaining:y,remainingPackages:w,packages:w})}d.delete(r)}),{restored:u}}let c=0;return await Gs(Ie,async u=>{const d={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=sr(yt(Ie,"inventory_candies"),mr("productId","==",p.productId)),y=(await Ht(x)).docs.map(b=>{const w=b.data(),j=Ose(w),I=J5(w);return{id:b.id,date:String(w.date||""),baseUnits:j,remaining:I}}).sort((b,w)=>b.date.localeCompare(w.date));d[p.productId]=y}const f=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,f.push({id:y.batchId,addBack:b})}continue}const x=d[p.productId]||[];let v=p.qty;for(const y of x){if(v<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const w=Math.min(b,v);f.push({id:y.id,addBack:w}),c+=w,v-=w}for(const y of x){if(v<=0)break;const b=Math.min(v,p.qty);f.push({id:y.id,addBack:b}),c+=b,v-=b}}const A={};for(const p of f)A[p.id]=(A[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(A).map(p=>Zt(Ie,"inventory_candies",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=J5(v),b=Math.max(0,Math.floor(Number(A[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);u.update(h[p],{remaining:w,remainingPackages:I,packages:I})}u.delete(r)}),{restored:c}}async function NQe(t){return G2(t)}const gc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function eB(t){return isFinite(t)?Math.round(t):0}function Zd(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function tB(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function CQe(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const a=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-a}function _Qe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,j]=g.useState(0),[I,_]=g.useState(!1),[S,E]=g.useState(""),[B,T]=g.useState(""),[P,O]=g.useState([]);g.useEffect(()=>{(async()=>{try{s(!0);const W=await Ht(yt(Ie,"products_candies")),Y=[];W.forEach(ve=>{const M=ve.data();Y.push({id:ve.id,name:M.name??"(sin nombre)",category:M.category??"(sin categora)"})}),e(Y);const D=sr(yt(Ie,"inventory_candies"),In("date","desc")),Q=await Ht(D),ee=[];Q.forEach(ve=>{const M=ve.data(),Ye=Number(M.unitsPerPackage||0),ae=Number(M.totalUnits??M.quantity??(M.packages||0)*(M.unitsPerPackage||0)),X=Number(M.remaining??M.totalUnits??ae??0);ee.push({id:ve.id,productId:M.productId,productName:M.productName,category:M.category,measurement:M.measurement??"unidad",packages:Number(M.packages||0),unitsPerPackage:Ye,totalUnits:ae,remaining:X,remainingPackages:typeof M.remainingPackages=="number"?Number(M.remainingPackages):void 0,providerPrice:Number(M.providerPrice||0),subtotal:Number(M.subtotal||0),totalRivas:Number(M.totalRivas||0),totalSanJorge:Number(M.totalSanJorge||0),totalIsla:Number(M.totalIsla||0),gainRivas:Number(M.gainRivas||0),gainSanJorge:Number(M.gainSanJorge||0),gainIsla:Number(M.gainIsla||0),unitPriceRivas:Number(M.unitPriceRivas||0),unitPriceSanJorge:Number(M.unitPriceSanJorge||0),unitPriceIsla:Number(M.unitPriceIsla||0),date:M.date,createdAt:M.createdAt,status:M.status??"PENDIENTE",orderId:M.orderId??null})}),n(ee)}catch(W){console.error(W),l(" Error cargando inventario.")}finally{s(!1)}})()},[]);const z=g.useMemo(()=>r.filter(W=>!(c&&W.date<c||d&&W.date>d||A&&W.productId!==A||m&&String(W.category||"")!==m)),[r,c,d,A,m]),ce=g.useMemo(()=>{const W=new Set;for(const Y of t)Y.category&&W.add(Y.category);return Array.from(W).sort((Y,D)=>Y.localeCompare(D))},[t]),de=g.useMemo(()=>{const W=z.reduce((M,Ye)=>M+Zd(Ye),0),Y=z.reduce((M,Ye)=>M+tB(Ye),0),D=z.reduce((M,Ye)=>{const ae=Zd(Ye);return M+Number(Ye.providerPrice||0)*ae},0),Q=z.reduce((M,Ye)=>{const ae=Zd(Ye);return M+Number(Ye.unitPriceRivas||0)*ae},0),ee=z.reduce((M,Ye)=>{const ae=Zd(Ye);return M+Number(Ye.unitPriceSanJorge||0)*ae},0),ve=z.reduce((M,Ye)=>{const ae=Zd(Ye);return M+Number(Ye.unitPriceIsla||0)*ae},0);return{totalPaquetes:W,totalPaquetesRestantes:Y,totalSubtotal:D,totalRivas:Q,totalSJ:ee,totalIsla:ve}},[z]),ue=g.useMemo(()=>{let W=0,Y=0;for(const D of z)D.status==="PENDIENTE"&&(W+=1),D.status==="PAGADO"&&(Y+=1);return{totalLotes:z.length,pendientes:W,pagados:Y}},[z]),me=g.useMemo(()=>{const W=new Map;for(const D of z){const Q=String(D.productId||"");Q&&(W.has(Q)||W.set(Q,{batches:[]}),W.get(Q).batches.push(D))}const Y=[];for(const[D,Q]of W.entries()){const ee=[...Q.batches].sort(CQe),ve=ee[0],M=ee.reduce((Ft,$t)=>Ft+Zd($t),0),Ye=ee.reduce((Ft,$t)=>Ft+tB($t),0),ae=Number((ve==null?void 0:ve.providerPrice)||0),X=Number((ve==null?void 0:ve.unitPriceRivas)||0),De=Number((ve==null?void 0:ve.unitPriceIsla)||0),le=ee.reduce((Ft,$t)=>{const kt=Zd($t);return Ft+Number($t.providerPrice||0)*kt},0),$e=ee.reduce((Ft,$t)=>{const kt=Zd($t);return Ft+Number($t.unitPriceRivas||0)*kt},0),Xe=ee.reduce((Ft,$t)=>{const kt=Zd($t);return Ft+Number($t.unitPriceIsla||0)*kt},0),it=$e-le,xt=Xe-le;let jt="",Mt;for(const Ft of ee)(!jt||String(Ft.date||"")>jt)&&(jt=String(Ft.date||""),Mt=Ft.createdAt);Y.push({productId:D,productName:(ve==null?void 0:ve.productName)||"",category:(ve==null?void 0:ve.category)||"",totalPackages:M,remainingPackages:Ye,providerPrice:ae,unitPriceRivas:X,unitPriceIsla:De,subtotal:le,totalRivas:$e,totalIsla:Xe,gainRivas:it,gainIsla:xt,lastDate:jt,lastCreatedAt:Mt,batchCount:ee.length})}return Y.sort((D,Q)=>String(Q.lastDate).localeCompare(String(D.lastDate))),Y},[z]),se=W=>{v(W.id),b(W.date),j(W.providerPrice),l("")},ke=()=>{v(null),b(""),j(0)},Re=async()=>{if(!x)return;const W=r.find(Xe=>Xe.id===x);if(!W)return;if(w<0){l("El precio proveedor no puede ser negativo.");return}const Y=Zd(W),D=w*Y,Q=Y>0?D/.8:0,ee=Y>0?D/.85:0,ve=Y>0?D/.7:0,M=Q-D,Ye=ee-D,ae=ve-D,X=Y>0?eB(Q/Y):0,De=Y>0?eB(ee/Y):0,le=Y>0?eB(ve/Y):0,$e=Zt(Ie,"inventory_candies",x);await Fn($e,{date:y,providerPrice:w,subtotal:D,totalRivas:Q,totalSanJorge:ee,totalIsla:ve,gainRivas:M,gainSanJorge:Ye,gainIsla:ae,unitPriceRivas:X,unitPriceSanJorge:De,unitPriceIsla:le}),n(Xe=>Xe.map(it=>it.id===x?{...it,date:y,providerPrice:w,subtotal:D,totalRivas:Q,totalSanJorge:ee,totalIsla:ve,gainRivas:M,gainSanJorge:Ye,gainIsla:ae,unitPriceRivas:X,unitPriceSanJorge:De,unitPriceIsla:le}:it)),W.orderId&&await Z5(String(W.orderId)),l(" Lote de dulces actualizado"),ke()},F=async W=>{confirm(`Marcar PAGADO el lote del ${W.date} (${W.productName})?`)&&(await Fn(Zt(Ie,"inventory_candies",W.id),{status:"PAGADO"}),n(D=>D.map(Q=>Q.id===W.id?{...Q,status:"PAGADO"}:Q)),l(" Lote marcado como pagado"))},H=async W=>{confirm(`Eliminar el lote del ${W.date} (${W.productName})?`)&&(await Kn(Zt(Ie,"inventory_candies",W.id)),n(D=>D.filter(Q=>Q.id!==W.id)),W.orderId&&await Z5(String(W.orderId)),l(" Lote eliminado"))},K=async(W,Y)=>{try{s(!0),l("");const D=sr(yt(Ie,"inventory_candies"),mr("productId","==",W),In("date","desc")),Q=await Ht(D),ee=[];Q.forEach(ve=>{const M=ve.data(),Ye=Number(M.unitsPerPackage||0),ae=Number(M.totalUnits??M.quantity??(M.packages||0)*(M.unitsPerPackage||0)),X=Number(M.remaining??M.totalUnits??ae??0);ee.push({id:ve.id,productId:M.productId,productName:M.productName,category:M.category,measurement:M.measurement??"unidad",packages:Number(M.packages||0),unitsPerPackage:Ye,totalUnits:ae,remaining:X,remainingPackages:typeof M.remainingPackages=="number"?Number(M.remainingPackages):void 0,providerPrice:Number(M.providerPrice||0),subtotal:Number(M.subtotal||0),totalRivas:Number(M.totalRivas||0),totalSanJorge:Number(M.totalSanJorge||0),totalIsla:Number(M.totalIsla||0),gainRivas:Number(M.gainRivas||0),gainSanJorge:Number(M.gainSanJorge||0),gainIsla:Number(M.gainIsla||0),unitPriceRivas:Number(M.unitPriceRivas||0),unitPriceSanJorge:Number(M.unitPriceSanJorge||0),unitPriceIsla:Number(M.unitPriceIsla||0),date:M.date,createdAt:M.createdAt,status:M.status??"PENDIENTE",orderId:M.orderId??null})}),E(W),T(Y),O(ee),_(!0)}catch(D){console.error(D),l(" Error abriendo detalle del producto.")}finally{s(!1)}},L=async(W,Y)=>{const D=r.filter(ee=>ee.productId===W);if(confirm(`Eliminar COMPLETAMENTE "${Y}"?
Esto eliminar ${D.length} lote(s) de este producto.`))try{s(!0),l("");const ee=Array.from(new Set(D.map(ve=>ve.orderId?String(ve.orderId):"").filter(Boolean)));for(const ve of D)await Kn(Zt(Ie,"inventory_candies",ve.id));n(ve=>ve.filter(M=>M.productId!==W)),l(" Producto eliminado (todos sus lotes).");for(const ve of ee)await Z5(ve);I&&S===W&&(_(!1),O([]),E(""),T(""))}catch(ee){console.error(ee),l(" Error eliminando lotes del producto.")}finally{s(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:W=>u(W.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:W=>f(W.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:W=>p(W.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),ce.map(W=>i.jsx("option",{value:W,children:W},W))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:W=>h(W.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(W=>i.jsxs("option",{value:W.id,children:[W.name,"  ",W.category]},W.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",ue.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",ue.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",ue.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",de.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",de.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",gc(de.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",gc(de.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",gc(de.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",gc(de.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):me.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):me.map(W=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:W.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:W.productName,children:W.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",W.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:W.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:W.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:gc(W.gainIsla)}),i.jsx("td",{className:"p-2 border",children:W.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>K(W.productId,W.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>L(W.productId,W.productName),children:"Borrar"})]})})]},W.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",B||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",S]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{_(!1),O([]),E(""),T(""),ke()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:P.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):P.map(W=>{const Y=x===W.id,D=Zd(W),Q=tB(W);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:Y?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:ee=>b(ee.target.value)}):W.date}),i.jsx("td",{className:"p-2 border align-top",children:W.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:W.productName,children:W.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",W.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:D}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Q}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:W.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Y?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(w)?"":w,onChange:ee=>j(Math.max(0,parseFloat(ee.target.value||"0")))}):gc(W.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:gc(W.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:gc(W.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:W.orderId?String(W.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${W.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:W.status})}),i.jsx("td",{className:"p-2 border align-top",children:Y?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Re,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ke,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[W.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>F(W),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>se(W),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>H(W),children:"Borrar"})]})})]},W.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>L(S,B),children:"Borrar producto (todos los lotes)"})})]})})]})}const rB=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Vo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function wy(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function aG(t){const e=sr(yt(Ie,"ar_movements"),mr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Kn(Zt(Ie,"ar_movements",n.id))))}function EQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=En(a,"vendedor_dulces"),l=En(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(!1),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,T]=g.useState([]),P=async Oe=>{var At;j(!0),_(!0),E(Oe),T([]);try{const It=await zs(Zt(Ie,"sales_candies",Oe));let Ct=null;It.exists()?Ct=It.data():Ct=(At=(await Ht(sr(yt(Ie,"sales_candies"),mr("name","==",Oe)))).docs[0])==null?void 0:At.data();let bt=[];if(Array.isArray(Ct==null?void 0:Ct.items))bt=Ct.items;else if(Ct!=null&&Ct.items&&typeof Ct.items=="object")try{bt=Object.values(Ct.items)}catch{bt=[]}else Ct!=null&&Ct.item&&(bt=[Ct.item]);const St=bt.map(Jt=>({productName:String(Jt.productName||""),qty:Number(Jt.packages??Jt.qty??Jt.quantity??0),unitPrice:Number(Jt.unitPricePackage??Jt.unitPrice??Jt.price??0),discount:Number(Jt.discount||0),total:Number(Jt.total??Jt.lineFinal??Jt.amount??0)}));T(St)}catch(It){console.error(It)}finally{_(!1)}},[O,z]=g.useState(""),[ce,de]=g.useState("+505 "),[ue,me]=g.useState(""),[se,ke]=g.useState(""),[Re,F]=g.useState("ACTIVO"),[H,K]=g.useState(0),[L,W]=g.useState(""),[Y,D]=g.useState(0),[Q,ee]=g.useState([]),[ve,M]=g.useState(!0),[Ye,ae]=g.useState(""),X=10,[De,le]=g.useState(1),[$e,Xe]=g.useState(null),[it,xt]=g.useState(""),[jt,Mt]=g.useState("+505 "),[Ft,$t]=g.useState(""),[kt,Ge]=g.useState(""),[ie,Ue]=g.useState("ACTIVO"),[Ne,be]=g.useState(0),[Ce,Le]=g.useState(""),[Ae,We]=g.useState(!1),[ct,_t]=g.useState(null),[pe,Pe]=g.useState(!1),[Ee,Ze]=g.useState([]),[xe,Se]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[gt,Et]=g.useState(!1),[Nt,Tt]=g.useState(0),[Lt,Me]=g.useState(new Date().toISOString().slice(0,10)),[_e,U]=g.useState(""),[ye,te]=g.useState(!1),[Ve,qe]=g.useState(null),[G,V]=g.useState(""),[Z,re]=g.useState(0),[we,Fe]=g.useState(""),[st,Be]=g.useState(!1),[at,lt]=g.useState(null),[dt,Pt]=g.useState(!1),[he,ze]=g.useState(!1),[nt,ne]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(M(!0),o&&!s){ee([]),ae(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const Oe=await Ht(yt(Ie,"sellers_candies")),At=[];Oe.forEach(St=>{const Jt=St.data(),Qt=String(Jt.status||"ACTIVO");Qt==="ACTIVO"&&At.push({id:St.id,name:String(Jt.name||""),status:Qt})}),u(At);const It=o?sr(yt(Ie,"customers_candies"),mr("vendorId","==",s),In("createdAt","desc")):sr(yt(Ie,"customers_candies"),In("createdAt","desc")),Ct=await Ht(It),bt=[];Ct.forEach(St=>{const Jt=St.data();bt.push({id:St.id,name:Jt.name??"",phone:Jt.phone??"+505 ",place:Jt.place??"",notes:Jt.notes??"",status:Jt.status??"ACTIVO",creditLimit:Number(Jt.creditLimit??0),createdAt:Jt.createdAt??vr.now(),balance:0,sellerId:Jt.sellerId||"",vendorId:Jt.vendorId||"",vendorName:Jt.vendorName||"",initialDebt:Number(Jt.initialDebt||0),initialDebtDate:String(Jt.initialDebtDate||"").trim(),lastAbonoDate:"",lastAbonoAmount:0})});for(const St of bt)try{const Jt=sr(yt(Ie,"ar_movements"),mr("customerId","==",St.id)),Qt=await Ht(Jt);let ar=0,or=null;const _r=[];Qt.forEach(tn=>{var jr,Bn,yn;const Gr=tn.data(),Ir=Number(Gr.amount||0);ar+=Ir;const yr=Gr.date??((Bn=(jr=Gr.createdAt)==null?void 0:jr.toDate)!=null&&Bn.call(jr)?Gr.createdAt.toDate().toISOString().slice(0,10):"");if(_r.push({id:tn.id,date:yr,type:Gr.type??(Ir<0?"ABONO":"CARGO"),amount:Ir,ref:Gr.ref||{},comment:Gr.comment||"",createdAt:Gr.createdAt}),Ir<0){const mn=(yn=Gr.createdAt)!=null&&yn.seconds?Number(Gr.createdAt.seconds):0;(!or||mn>=or.ts)&&(or={date:yr,amount:Math.abs(Ir),ts:mn})}});const Cr=Number(St.initialDebt||0),Ut=lr(Cr,String(St.initialDebtDate||""),_r);St.balance=Ut+ar,or?(St.lastAbonoDate=or==null?void 0:or.date,St.lastAbonoAmount=or==null?void 0:or.amount):(St.lastAbonoDate="",St.lastAbonoAmount=0)}catch{St.balance=Number(St.initialDebt||0),St.lastAbonoDate="",St.lastAbonoAmount=0}ee(bt)}catch(Oe){console.error(Oe),ae(" Error cargando clientes.")}finally{M(!1)}})()},[o,s]);const He=()=>{z(""),de("+505 "),me(""),ke(""),F("ACTIVO"),K(0),W(""),D(0)},pt=async Oe=>{var bt;if(Oe.preventDefault(),ae(""),!O.trim()){ae("Ingresa el nombre.");return}const At=wy(ce);if(At.length<6){ae("Telfono incompleto.");return}const It=o?s:String(L||"").trim(),Ct=It&&((bt=c.find(St=>St.id===It))==null?void 0:bt.name)||"";try{const St=Number(Y||0),Jt=await Jn(yt(Ie,"customers_candies"),{name:O.trim(),phone:At,place:ue||"",notes:se||"",status:Re,creditLimit:Number(H||0),vendorId:It,vendorName:Ct,initialDebt:St,createdAt:vr.now()});ee(Qt=>[{id:Jt.id,name:O.trim(),phone:At,place:ue||"",notes:se||"",status:Re,creditLimit:Number(H||0),vendorId:It,vendorName:Ct,initialDebt:St,createdAt:vr.now(),balance:St,lastAbonoDate:"",lastAbonoAmount:0},...Qt]),He(),Be(!1),ae(" Cliente creado")}catch(St){console.error(St),ae(" Error al crear cliente")}},Dt=Oe=>{if(o){ae(" No permitido: vendedores no editan clientes desde el listado.");return}Xe(Oe.id),xt(Oe.name),Mt(Oe.phone||"+505 "),$t(Oe.place||""),Ge(Oe.notes||""),Ue(Oe.status||"ACTIVO"),be(Number(Oe.creditLimit||0)),Le(String(Oe.vendorId||""))},rr=()=>{Xe(null),xt(""),Mt("+505 "),$t(""),Ge(""),Ue("ACTIVO"),be(0),Le("")},zt=async()=>{var Jt;if(o){ae(" No permitido.");return}if(!$e)return;const Oe=wy(jt);if(!it.trim()){ae("Ingresa el nombre.");return}const At=Q.find(Qt=>Qt.id===$e),It=String((At==null?void 0:At.vendorId)||""),Ct=o?s:String(Ce||"");if(o&&It&&It!==s){ae(" Este cliente pertenece a otro vendedor.");return}if(l&&It&&Ct&&It!==Ct){ae(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const bt=o?s:String(Ce||""),St=bt&&((Jt=c.find(Qt=>Qt.id===bt))==null?void 0:Jt.name)||"";try{await Fn(Zt(Ie,"customers_candies",$e),{name:it.trim(),phone:Oe,place:Ft||"",notes:kt||"",status:ie,creditLimit:Number(Ne||0),vendorId:bt,vendorName:St}),ee(Qt=>Qt.map(ar=>ar.id===$e?{...ar,name:it.trim(),phone:Oe,place:Ft||"",notes:kt||"",status:ie,creditLimit:Number(Ne||0),vendorId:bt,vendorName:St}:ar)),rr(),ae(" Cliente actualizado")}catch(Qt){console.error(Qt),ae(" Error al actualizar")}},Ot=async Oe=>{if(confirm(`Eliminar al cliente "${Oe.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{M(!0);const It=sr(yt(Ie,"sales_candies"),mr("customerId","==",Oe.id)),Ct=await Ht(It);for(const Jt of Ct.docs){const Qt=Jt.id;try{await G2(Qt)}catch(ar){console.warn("restoreSaleAndDeleteCandy error",ar);try{await Kn(Zt(Ie,"sales_candies",Qt))}catch{}}await aG(Qt)}const bt=sr(yt(Ie,"ar_movements"),mr("customerId","==",Oe.id)),St=await Ht(bt);await Promise.all(St.docs.map(Jt=>Kn(Zt(Ie,"ar_movements",Jt.id)))),await Kn(Zt(Ie,"customers_candies",Oe.id)),ee(Jt=>Jt.filter(Qt=>Qt.id!==Oe.id)),ae(" Cliente eliminado y dulces devueltos al inventario")}catch(It){console.error(It),ae(" No se pudo eliminar el cliente.")}finally{M(!1)}},lr=(Oe,At,It)=>{const Ct=Number(Oe||0);if(!Ct)return 0;const bt=String(At||"").trim();return bt&&It.some(Jt=>{var Cr;const Qt=Number(Jt.amount||0);if(!(Qt>0))return!1;const ar=Math.abs(Qt-Ct)<.01,or=String(Jt.date||"").trim()===bt,_r=!!((Cr=Jt.ref)!=null&&Cr.saleId);return ar&&or&&_r})?0:Ct},Dr=(Oe,At,It)=>{const Ct=Oe.reduce((ar,or)=>ar+(Number(or.amount)||0),0),bt=Oe.filter(ar=>Number(ar.amount)<0).reduce((ar,or)=>ar+Math.abs(Number(or.amount)||0),0),St=Oe.filter(ar=>Number(ar.amount)>0).reduce((ar,or)=>ar+(Number(or.amount)||0),0),Jt=lr(At,It,Oe),Qt=Number(Jt||0)+Ct;Se({saldoActual:Qt,totalAbonado:bt,totalCargos:Number(Jt||0)+St,saldoRestante:Qt})},br=async Oe=>{_t(Oe),Ze([]),Se({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),We(!0),Pt(!1),ze(!1),ne(null),Et(!1),Tt(0),Me(new Date().toISOString().slice(0,10)),U(""),qe(null),Pe(!0);try{const At=sr(yt(Ie,"ar_movements"),mr("customerId","==",Oe.id)),It=await Ht(At),Ct=[];It.forEach(bt=>{var ar,or;const St=bt.data(),Jt=St.date??((or=(ar=St.createdAt)==null?void 0:ar.toDate)!=null&&or.call(ar)?St.createdAt.toDate().toISOString().slice(0,10):""),Qt=Number(St.amount||0);Ct.push({id:bt.id,date:Jt,type:St.type??(Qt<0?"ABONO":"CARGO"),amount:Qt,ref:St.ref||{},comment:St.comment||"",createdAt:St.createdAt})}),Ct.sort((bt,St)=>{var ar,or;if(bt.date!==St.date)return bt.date.localeCompare(St.date);const Jt=((ar=bt.createdAt)==null?void 0:ar.seconds)||0,Qt=((or=St.createdAt)==null?void 0:or.seconds)||0;return Jt-Qt}),Ze(Ct),Dr(Ct,Number(Oe.initialDebt||0),String(Oe.initialDebtDate||""))}catch(At){console.error(At),ae(" No se pudo cargar el estado de cuenta")}finally{Pe(!1)}},nr=Oe=>{const At=Oe.filter(It=>Number(It.amount)<0).map(It=>{var Ct;return{date:It.date,amount:Math.abs(Number(It.amount||0)),ts:((Ct=It.createdAt)==null?void 0:Ct.seconds)||0}}).sort((It,Ct)=>(It.ts||0)-(Ct.ts||0));return At.length?At[At.length-1]:null},ir=g.useMemo(()=>lr(Number((ct==null?void 0:ct.initialDebt)||0),String((ct==null?void 0:ct.initialDebtDate)||""),Ee),[ct==null?void 0:ct.initialDebt,ct==null?void 0:ct.initialDebtDate,Ee]),Nr=async()=>{if(!ct)return;ae("");const Oe=Number(Nt||0);if(!(Oe>0)){ae("Ingresa un monto de abono mayor a 0.");return}const At=parseFloat(Oe.toFixed(2));if(!Lt){ae("Selecciona la fecha del abono.");return}try{te(!0);const It={customerId:ct.id,type:"ABONO",amount:-At,date:Lt,comment:_e||"",createdAt:vr.now()},bt={id:(await Jn(yt(Ie,"ar_movements"),It)).id,date:Lt,type:"ABONO",amount:-At,comment:_e||"",createdAt:vr.now()},St=[...Ee,bt].sort((or,_r)=>{var tn,Gr;if(or.date!==_r.date)return or.date.localeCompare(_r.date);const Cr=((tn=or.createdAt)==null?void 0:tn.seconds)||0,Ut=((Gr=_r.createdAt)==null?void 0:Gr.seconds)||0;return Cr-Ut});Ze(St),Dr(St,Number(ct.initialDebt||0),String(ct.initialDebtDate||""));const Jt=St.reduce((or,_r)=>or+(Number(_r.amount)||0),0),Qt=lr(Number(ct.initialDebt||0),String(ct.initialDebtDate||""),St),ar=Number(Qt||0)+Jt;ee(or=>or.map(_r=>_r.id!==ct.id?_r:{..._r,balance:ar,lastAbonoDate:Lt,lastAbonoAmount:At})),_t(or=>or&&{...or,balance:ar,lastAbonoDate:Lt,lastAbonoAmount:At}),Tt(0),U(""),Me(new Date().toISOString().slice(0,10)),Et(!1),ae(" Abono registrado")}catch(It){console.error(It),ae(" Error al registrar el abono")}finally{te(!1)}},Pr=Oe=>{qe(Oe.id),V(Oe.date||new Date().toISOString().slice(0,10)),re(Math.abs(Number(Oe.amount||0))),Fe(Oe.comment||"")},xr=()=>{qe(null),V(""),re(0),Fe("")},$r=async()=>{if(!Ve||!ct)return;const Oe=Ee.findIndex(bt=>bt.id===Ve);if(Oe===-1)return;const At=Ee[Oe],It=Number(Z||0);if(!(It>0)){ae("El monto debe ser mayor a 0.");return}const Ct=At.type==="ABONO"?-parseFloat(It.toFixed(2)):+parseFloat(It.toFixed(2));try{await Fn(Zt(Ie,"ar_movements",Ve),{date:G,amount:Ct,comment:we||""});const bt=[...Ee];bt[Oe]={...At,date:G,amount:Ct,comment:we||""},bt.sort((or,_r)=>{var tn,Gr;if(or.date!==_r.date)return or.date.localeCompare(_r.date);const Cr=((tn=or.createdAt)==null?void 0:tn.seconds)||0,Ut=((Gr=_r.createdAt)==null?void 0:Gr.seconds)||0;return Cr-Ut}),Ze(bt),Dr(bt,Number(ct.initialDebt||0),String(ct.initialDebtDate||""));const St=bt.reduce((or,_r)=>or+(Number(_r.amount)||0),0),Jt=lr(Number(ct.initialDebt||0),String(ct.initialDebtDate||""),bt),Qt=Number(Jt||0)+St,ar=nr(bt);ee(or=>or.map(_r=>_r.id===ct.id?{..._r,balance:Qt,lastAbonoDate:(ar==null?void 0:ar.date)||"",lastAbonoAmount:(ar==null?void 0:ar.amount)||0}:_r)),_t(or=>or&&{...or,balance:Qt,lastAbonoDate:(ar==null?void 0:ar.date)||"",lastAbonoAmount:(ar==null?void 0:ar.amount)||0}),xr(),ae(" Movimiento actualizado")}catch(bt){console.error(bt),ae(" Error al actualizar movimiento")}},cr=async Oe=>{var It,Ct;if(confirm(`Eliminar este movimiento (${Oe.type==="ABONO"?"Abono":"Compra"}) del ${Oe.date}?${Oe.type==="CARGO"&&((It=Oe.ref)!=null&&It.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`)&&ct)try{if(M(!0),Oe.type==="CARGO"&&((Ct=Oe.ref)!=null&&Ct.saleId)){try{await G2(Oe.ref.saleId)}catch(or){console.warn("restoreSaleAndDeleteCandy error",or),M(!1),ae(" No se pudo devolver inventario de la venta.");return}await aG(Oe.ref.saleId)}else await Kn(Zt(Ie,"ar_movements",Oe.id));const bt=Ee.filter(or=>{var _r,Cr;return Oe.type==="CARGO"&&((_r=Oe.ref)!=null&&_r.saleId)?((Cr=or.ref)==null?void 0:Cr.saleId)!==Oe.ref.saleId:or.id!==Oe.id});Ze(bt),Dr(bt,Number(ct.initialDebt||0),String(ct.initialDebtDate||""));const St=bt.reduce((or,_r)=>or+(Number(_r.amount)||0),0),Jt=lr(Number(ct.initialDebt||0),String(ct.initialDebtDate||""),bt),Qt=Number(Jt||0)+St,ar=nr(bt);ee(or=>or.map(_r=>_r.id===ct.id?{..._r,balance:Qt,lastAbonoDate:(ar==null?void 0:ar.date)||"",lastAbonoAmount:(ar==null?void 0:ar.amount)||0}:_r)),_t(or=>or&&{...or,balance:Qt,lastAbonoDate:(ar==null?void 0:ar.date)||"",lastAbonoAmount:(ar==null?void 0:ar.amount)||0}),ne(null),ae(" Movimiento eliminado")}catch(bt){console.error(bt),ae(" Error al eliminar movimiento")}finally{M(!1)}},Zr=g.useMemo(()=>[...Q].sort((Oe,At)=>{var It,Ct;return Oe.status!==At.status?Oe.status==="BLOQUEADO"?1:-1:(((It=At.createdAt)==null?void 0:It.seconds)||0)-(((Ct=Oe.createdAt)==null?void 0:Ct.seconds)||0)}),[Q]),Wr=Oe=>Oe==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",zr=g.useMemo(()=>{const Oe=A.trim().toLowerCase(),At=x.trim()===""?null:Number(x),It=y.trim()===""?null:Number(y);return Zr.filter(Ct=>{const bt=!Oe||String(Ct.name||"").toLowerCase().includes(Oe),St=!m||Ct.status===m,Jt=Number(Ct.balance||0),Qt=At===null||!Number.isNaN(At)&&Jt>=At,ar=It===null||!Number.isNaN(It)&&Jt<=It;return bt&&St&&Qt&&ar})},[Zr,A,m,x,y]),gn=Math.max(1,Math.ceil(zr.length/X)),Nn=g.useMemo(()=>{const Oe=(De-1)*X;return zr.slice(Oe,Oe+X)},[zr,De]);g.useEffect(()=>{le(1)},[A,m,x,y]);const Sn=()=>le(1),fe=()=>le(Oe=>Math.max(1,Oe-1)),tt=()=>le(Oe=>Math.min(gn,Oe+1)),vt=()=>le(gn),mt=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Sn,disabled:De===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:fe,disabled:De===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",De," de ",gn]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:tt,disabled:De===gn,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:vt,disabled:De===gn,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[zr.length," cliente(s)"]})]});return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Be(!0),o&&W(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border w-full md:w-auto",onClick:()=>f(Oe=>!Oe),children:d?"Ocultar filtros":"Mostrar filtros"}),d&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl p-3 grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:Oe=>h(Oe.target.value),placeholder:"Buscar por nombre"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:Oe=>p(Oe.target.value||""),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mn."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:x,onChange:Oe=>v(Oe.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mx."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:y,onChange:Oe=>b(Oe.target.value),placeholder:""})]})]}),i.jsx("div",{className:"md:col-span-4 flex flex-wrap gap-2 justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border",onClick:()=>{h(""),p(""),v(""),b("")},children:"Limpiar"})})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ve?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Nn.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Nn.map(Oe=>{var It;const At=$e===Oe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(It=Oe.createdAt)!=null&&It.toDate?Oe.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:At?i.jsx("input",{className:"w-full border p-1 rounded",value:it,onChange:Ct=>xt(Ct.target.value)}):i.jsx("div",{className:"font-medium",children:Oe.name})}),i.jsx("td",{className:"p-2 border",children:At?i.jsx("input",{className:"w-full border p-1 rounded",value:jt,onChange:Ct=>Mt(wy(Ct.target.value))}):Oe.phone}),i.jsx("td",{className:"p-2 border",children:At?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ce,onChange:Ct=>Le(Ct.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Ct=>i.jsx("option",{value:Ct.id,children:Ct.name},Ct.id))]}):Oe.vendorName||""}),i.jsx("td",{className:"p-2 border",children:At?i.jsxs("select",{className:"w-full border p-1 rounded",value:Ft,onChange:Ct=>$t(Ct.target.value),children:[i.jsx("option",{value:"",children:""}),rB.map(Ct=>i.jsx("option",{value:Ct,children:Ct},Ct))]}):Oe.place||""}),i.jsx("td",{className:"p-2 border",children:At?i.jsxs("select",{className:"w-full border p-1 rounded",value:ie,onChange:Ct=>Ue(Ct.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Wr(Oe.status)}`,children:Oe.status})}),i.jsx("td",{className:"p-2 border",children:At?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ne)?"":Ne,onChange:Ct=>be(Math.max(0,Number(Ct.target.value||0)))}):Vo(Oe.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Vo(Oe.balance||0)}),i.jsx("td",{className:"p-2 border",children:At?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:kt,onChange:Ct=>Ge(Ct.target.value),maxLength:500}):i.jsx("span",{title:Oe.notes||"",children:(Oe.notes||"").length>40?(Oe.notes||"").slice(0,40)+"":Oe.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:At?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:zt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:rr,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Dt(Oe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Ot(Oe),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>br(Oe),children:"Estado de cuenta"})]})})})]},Oe.id)})})]}),mt()]}),i.jsxs("div",{className:"md:hidden",children:[ve?i.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):Nn.length===0?i.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):i.jsx("div",{className:"space-y-2",children:Nn.map(Oe=>{const At=at===Oe.id,It=$e===Oe.id,Ct=i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${Wr(Oe.status)}`,children:Oe.status});return i.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{ae(""),!It&&lt(bt=>bt===Oe.id?null:Oe.id)},children:[i.jsx("div",{className:"min-w-0 flex-1",children:i.jsx("div",{className:"truncate font-semibold",children:Oe.name})}),i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Pendiente"}),i.jsx("div",{className:"font-semibold leading-4",children:Vo(Oe.balance||0)})]}),Ct]})]}),At&&i.jsxs("div",{className:"px-3 pb-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"ltimo abono"}),i.jsx("div",{className:"font-medium",children:Oe.lastAbonoDate?Oe.lastAbonoDate:""}),i.jsx("div",{className:"text-[12px] text-gray-700",children:Oe.lastAbonoAmount?Vo(Oe.lastAbonoAmount):""})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo pendiente"}),i.jsx("div",{className:"text-lg font-bold",children:Vo(Oe.balance||0)})]})]}),It?i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:it,onChange:bt=>xt(bt.target.value)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:jt,onChange:bt=>Mt(wy(bt.target.value))})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:ie,onChange:bt=>Ue(bt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:Ft,onChange:bt=>$t(bt.target.value),children:[i.jsx("option",{value:"",children:""}),rB.map(bt=>i.jsx("option",{value:bt,children:bt},bt))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:o?s:Ce,onChange:bt=>Le(bt.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(bt=>i.jsx("option",{value:bt.id,children:bt.name},bt.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lmite"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(Ne)?"":Ne,onChange:bt=>be(Math.max(0,Number(bt.target.value||0)))})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded-xl min-h-24 resize-y",value:kt,onChange:bt=>Ge(bt.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:zt,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:()=>{rr(),lt(null)},type:"button",children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Dt(Oe),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Ot(Oe),disabled:!l,title:l?"Borrar":"Solo admin",type:"button",children:"Borrar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>br(Oe),type:"button",children:"Estado"})]})]})]},Oe.id)})}),mt()]})]}),Ye&&i.jsx("p",{className:"mt-2 text-sm",children:Ye}),st&&Mu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Be(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Be(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:pt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:O,onChange:Oe=>z(Oe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ce,onChange:Oe=>de(wy(Oe.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ue,onChange:Oe=>me(Oe.target.value),children:[i.jsx("option",{value:"",children:""}),rB.map(Oe=>i.jsx("option",{value:Oe,children:Oe},Oe))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Re,onChange:Oe=>F(Oe.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:L,onChange:Oe=>W(Oe.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Oe=>i.jsx("option",{value:Oe.id,children:Oe.name},Oe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Y===0?"":Y,onChange:Oe=>D(Math.max(0,Number(Oe.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:Oe=>K(Math.max(0,Number(Oe.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:se,onChange:Oe=>ke(Oe.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[se.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Be(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),Ae&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4 max-h-[92vh] overflow-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(ct==null?void 0:ct.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Tt(0),Me(new Date().toISOString().slice(0,10)),U(""),Et(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>We(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(Number(ir||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(xe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Vo(xe.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:pe?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):Ee.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):Ee.map(Oe=>{var It,Ct;const At=Ve===Oe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:At?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:G,onChange:bt=>V(bt.target.value)}):Oe.date||""}),i.jsx("td",{className:"p-2 border",children:Oe.amount>=0?(It=Oe.ref)!=null&&It.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>P(Oe.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Ct=Oe.ref)!=null&&Ct.saleId?`Venta #${Oe.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:At?i.jsx("input",{className:"w-full border p-1 rounded",value:we,onChange:bt=>Fe(bt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Oe.comment||"",children:(Oe.comment||"").length>40?(Oe.comment||"").slice(0,40)+"":Oe.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:At?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Z)?"":Z,onChange:bt=>{const St=Number(bt.target.value||0),Jt=Number.isFinite(St)?Math.max(0,parseFloat(St.toFixed(2))):0;re(Jt)},placeholder:"0.00"}):Vo(Oe.amount)}),i.jsx("td",{className:"p-2 border",children:At?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:$r,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:xr,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Pr(Oe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>cr(Oe),children:"Borrar"})]})})]},Oe.id)})})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Pt(Oe=>!Oe),children:[i.jsx("div",{className:"font-semibold",children:"Estado de cuenta"}),i.jsx("div",{className:"text-sm text-gray-500",children:dt?"Ocultar":"Ver"})]}),dt&&i.jsxs("div",{className:"px-3 pb-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Deuda inicial"}),i.jsx("div",{className:"font-bold",children:Vo(Number(ir||0))})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo actual"}),i.jsx("div",{className:"font-bold",children:Vo(xe.saldoActual)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Total abonado"}),i.jsx("div",{className:"font-bold",children:Vo(xe.totalAbonado)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo restante"}),i.jsx("div",{className:"font-bold",children:Vo(xe.saldoRestante)})]})]})]}),i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>ze(Oe=>!Oe),children:[i.jsx("div",{className:"font-semibold",children:"Movimientos"}),i.jsx("div",{className:"text-sm text-gray-500",children:he?"Ocultar":"Ver"})]}),he&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:pe?i.jsx("div",{className:"text-center text-sm p-3",children:"Cargando"}):Ee.length===0?i.jsx("div",{className:"text-center text-sm p-3",children:"Sin movimientos"}):Ee.map(Oe=>{var St,Jt;const At=nt===Oe.id,It=Ve===Oe.id,Ct=Oe.amount>=0?"CARGO":"ABONO",bt=Oe.amount>=0?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700";return i.jsxs("div",{className:"border rounded-2xl overflow-hidden bg-white",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{It||ne(Qt=>Qt===Oe.id?null:Oe.id)},children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Fecha"}),i.jsx("div",{className:"font-semibold",children:Oe.date||""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${bt}`,children:Ct}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Monto"}),i.jsx("div",{className:"font-semibold",children:Vo(Oe.amount)})]})]})]}),At&&i.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Referencia"}),i.jsx("div",{className:"font-medium",children:(St=Oe.ref)!=null&&St.saleId?`Venta #${Oe.ref.saleId}`:""}),((Jt=Oe.ref)==null?void 0:Jt.saleId)&&i.jsx("button",{type:"button",className:"mt-2 text-xs underline text-blue-600",onClick:()=>P(Oe.ref.saleId),children:"Ver productos de la venta"})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),It?i.jsx("input",{className:"w-full border p-2 rounded-xl",value:we,onChange:Qt=>Fe(Qt.target.value),placeholder:"Comentario"}):i.jsx("div",{className:"font-medium",children:(Oe.comment||"").trim()||""})]}),It&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded-xl",value:G,onChange:Qt=>V(Qt.target.value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(Z)?"":Z,onChange:Qt=>{const ar=Number(Qt.target.value||0),or=Number.isFinite(ar)?Math.max(0,parseFloat(ar.toFixed(2))):0;re(or)}})]})]}),It?i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:$r,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:xr,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Pr(Oe),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700",onClick:()=>cr(Oe),type:"button",children:"Borrar"})]})]})]},Oe.id)})})]})]}),gt&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(ct==null?void 0:ct.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Lt,onChange:Oe=>Me(Oe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Nt===0?"":Nt,onChange:Oe=>{const At=Number(Oe.target.value||0),It=Number.isFinite(At)?Math.max(0,parseFloat(At.toFixed(2))):0;Tt(It)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:_e,onChange:Oe=>U(Oe.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[_e.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Et(!1),disabled:ye,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Nr,disabled:ye,children:ye?"Guardando...":"Guardar abono"})]})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",S?` #${S}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((Oe,At)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Oe.productName}),i.jsx("td",{className:"p-2 border text-right",children:Oe.qty}),i.jsx("td",{className:"p-2 border text-right",children:Vo(Oe.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Vo(Oe.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Vo(Oe.total)})]},At))})]})})]})})]})}const Kc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,SQe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas","Pull","Tilgue","Balge","Santa Cruz","Moyogalpa","Santo Domingo","San Jos del Sur","San Fernando","Merida","La Paloma","San Lorenzo","San Carlos","San Miguel"];function IQe(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function jQe(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function PQe(t){const{saleId:e,date:r,customerName:n,branch:a,items:s,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:u}=t,d=new rn;let f=12;if(d.setFontSize(16),d.text("Multiservicios Ortiz",10,f),f+=6,d.setFontSize(12),d.text("Recibo de venta certificada",10,f),f+=8,d.setFontSize(12),d.text(`Fecha: ${r}`,10,f),f+=5,d.text(`Cliente: ${n||"Cliente Mostrador"}`,10,f),f+=5,d.text(`Sucursal: ${IQe(a)}`,10,f),f+=5,d.text(`Autorizado: ${e}`,10,f),f+=5,l&&(d.text(`Vendedor: ${l}`,10,f),f+=5),typeof c=="number"){const A=Number(u||0).toFixed(2),h=c.toFixed(2);d.text(`Comisin vendedor: ${h}%  C$ ${A}`,10,f),f+=8}else f+=3;d.setFontSize(12),d.text("Producto",10,f),d.text("Paquetes",110,f,{align:"right"}),d.text("Precio.",150,f,{align:"right"}),d.text("Subtotal",190,f,{align:"right"}),f+=4,d.line(10,f,190,f),f+=4,s.forEach(A=>{f>270&&(d.addPage(),f=12);const h=(A.productName||"").length>50?A.productName.slice(0,47)+"...":A.productName;d.text(h,10,f),d.text(String(A.qty),110,f,{align:"right"}),d.text(`C$ ${Number(A.unitPrice||0).toFixed(2)}`,150,f,{align:"right"}),d.text(`C$ ${Number(A.total||0).toFixed(2)}`,190,f,{align:"right"}),f+=5}),f+=4,d.line(10,f,190,f),f+=6,d.setFontSize(13),d.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,f,{align:"right"}),f+=6,d.setFontSize(9),d.text("Gracias por su compra.",10,f),d.save(`venta_dulces_${e}.pdf`)}async function sG(t,e){if(!t||!e)return 0;const r=sr(yt(Ie,"inventory_candies_sellers"),mr("sellerId","==",e),mr("productId","==",t)),n=await Ht(r);let a=0;return n.forEach(s=>{const o=s.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(a+=l)}),a}const iG=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function BQe(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:a,saleId:s}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=sr(yt(Ie,"inventory_candies_sellers"),mr("sellerId","==",r),mr("productId","==",e),mr("remainingUnits",">",0),In("date","asc"),In("createdAt","asc")),u=await Ht(c);for(const d of u.docs){if(o<=0)break;const f=d.data(),A=Number(f.remainingUnits||0);if(A<=0)continue;const h=Math.min(A,o),m=A-h,p=Math.max(1,Math.floor(Number(f.unitsPerPackage||1))),x=Math.floor(m/p);await Fn(d.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:d.id,productId:e,units:h,saleDate:a,saleId:s}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function oG(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function TQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t;En(a,"admin"),En(a,"vendedor_dulces");const[s,o]=g.useState([]),[l,c]=g.useState([]),[u,d]=g.useState([]),[f,A]=g.useState({}),[h,m]=g.useState("CONTADO"),[p,x]=g.useState("RIVAS"),[v,y]=g.useState(""),[b,w]=g.useState(""),[j,I]=g.useState(iG()),[_,S]=g.useState(""),[E,B]=g.useState(!1),[T,P]=g.useState(""),[O,z]=g.useState([]),[ce,de]=g.useState(!0),[ue,me]=g.useState(!1),se=g.useMemo(()=>O.reduce((U,ye)=>U+(ye.qtyPackages||0),0),[O]),ke=g.useMemo(()=>O.reduce((U,ye)=>U+(ye.qtyPackages||0)*(ye.unitsPerPackage||1),0),[O]),Re=g.useMemo(()=>{const U=O.reduce((ye,te)=>{const Ve=(Number(te.pricePerPackage)||0)*(te.qtyPackages||0),qe=Number(te.discount)||0,G=Math.max(0,Ve-qe);return ye+G},0);return Math.floor(U*100)/100},[O]),[F,H]=g.useState(0),[K,L]=g.useState(""),[W,Y]=g.useState(!1),[D,Q]=g.useState(!1),[ee,ve]=g.useState(""),[M,Ye]=g.useState("+505 "),[ae,X]=g.useState(""),[De,le]=g.useState(""),[$e,Xe]=g.useState("ACTIVO"),[it,xt]=g.useState(0),[jt,Mt]=g.useState(""),Ft=()=>{ve(""),Ye("+505 "),X(""),le(""),Xe("ACTIVO"),xt(0)},[$t,kt]=g.useState(!1),Ge=async U=>{const ye=String(U||"").trim();if(!ye)return;const te=Tt.find(V=>String(V.barcode||"")===ye),Ve=Tt.find(V=>String(V.sku||"")===ye),qe=Tt.find(V=>String(V.id||"")===ye),G=te||Ve||qe||null;G?(await Ze(G.id),L(" Producto agregado desde escner."),setTimeout(()=>L(""),2500)):(L(" Cdigo no corresponde a ningn producto disponible."),setTimeout(()=>L(""),2500))};function ie({open:U,onClose:ye,onDetected:te}){const Ve=g.useRef(null),qe=g.useRef(null),[G,V]=g.useState(""),Z=g.useRef("");return g.useEffect(()=>{if(!U)return;let re=!1;const we=new $2,Fe=()=>{var Be,at,lt;try{(Be=qe.current)==null||Be.stop()}catch{}qe.current=null;try{const dt=(at=Ve.current)==null?void 0:at.srcObject;try{(lt=dt==null?void 0:dt.getTracks)==null||lt.call(dt).forEach(Pt=>Pt.stop())}catch{}}catch{}try{Ve.current&&(Ve.current.srcObject=null)}catch{}};return(async()=>{V("");try{if(!Ve.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(lt=>lt.stop())}catch{}const Be=await we.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},Ve.current,at=>{if(!re&&at){const lt=String(at.getText()||"").trim().replace(/\s+/g,"");if(!lt||lt===Z.current)return;Z.current=lt,Fe(),te(lt),ye()}});qe.current=Be}catch(Be){const at=String((Be==null?void 0:Be.message)||""),lt=String((Be==null?void 0:Be.name)||"");at.toLowerCase().includes("permission")||lt==="NotAllowedError"?V("Permiso de cmara denegado."):lt==="NotFoundError"||at.toLowerCase().includes("notfound")?V("No se encontr cmara en este dispositivo."):at.toLowerCase().includes("secure")||at.toLowerCase().includes("https")?V("La cmara requiere HTTPS (sitio seguro)."):V(at||"No se pudo iniciar el escner.")}})(),()=>{var Be;re=!0;try{(Be=qe.current)==null||Be.stop()}catch{}qe.current=null}},[U,ye,te]),U?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ye,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:Ve,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),G&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:G}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}const Ue=g.useMemo(()=>s.find(U=>U.id===v),[s,v]),Ne=g.useMemo(()=>E&&_?s.filter(U=>(U.vendorId??U.sellerId??"")===_):s,[s,E,_]),be=(Ue==null?void 0:Ue.balance)||0,Ce=h==="CREDITO"?be+Math.max(0,Number(Re||0))-Math.max(0,Number(F||0)):0,Le=g.useMemo(()=>{if(h!=="CREDITO")return 0;const U=Math.max(0,Number(be||0))+Math.max(0,Number(Re||0));return Math.floor(U*100)/100},[h,be,Re]),Ae=U=>{const ye=Math.max(0,Number(U||0));return Math.min(ye,Le)},We=g.useMemo(()=>u.find(U=>U.id===_)||null,[u,_]),ct=(We==null?void 0:We.commissionPercent)||0,_t=g.useMemo(()=>{const U=O.reduce((ye,te)=>ye+Number(te.margenVendedor||0),0);return Number(U.toFixed(2))},[O]);g.useEffect(()=>{(async()=>{const U=sr(yt(Ie,"customers_candies"),In("createdAt","desc")),ye=await Ht(U),te=[];ye.forEach(V=>{const Z=V.data();te.push({id:V.id,name:Z.name??"",phone:Z.phone??"+505 ",place:Z.place??"",status:Z.status??"ACTIVO",creditLimit:Number(Z.creditLimit??0),balance:0,sellerId:Z.sellerId??Z.vendorId??"",vendorId:Z.vendorId??Z.sellerId??""})});for(const V of te)try{const Z=sr(yt(Ie,"ar_movements"),mr("customerId","==",V.id)),re=await Ht(Z);let we=0;re.forEach(st=>we+=Number(st.data().amount||0));const Fe=Number(V.initialDebt||0);V.balance=we+Fe}catch{V.balance=0}o(te);const Ve=sr(yt(Ie,"products_candies"),In("createdAt","desc")),qe=await Ht(Ve),G=[];qe.forEach(V=>{const Z=V.data();G.push({id:V.id,name:Z.name??"(sin nombre)",sku:Z.sku??"",unitsPerPackage:Number(Z.unitsPerPackage??1),barcode:String(Z.barcode||""),priceRivas:Number(Z.unitPriceRivas??0),priceSanJorge:Number(Z.unitPriceSanJorge??0),priceIsla:Number(Z.unitPriceIsla??0),providerPrice:Number(Z.providerPrice??0),providerPricePerUnit:Number(Z.providerPricePerUnit??0)})}),c(G);try{const V=await Ht(yt(Ie,"sellers_candies")),Z=[];V.forEach(re=>{const we=re.data(),Fe=we.branch||"Rivas",st=jQe(Fe);Z.push({id:re.id,name:we.name??"(sin nombre)",branch:st,branchLabel:Fe,commissionPercent:Number(we.commissionPercent??0)})}),d(Z)}catch(V){console.error("Error cargando vendedores:",V)}A({})})()},[]),g.useEffect(()=>{var ye,te;const U=e&&e.length?e:t;if(U&&((ye=U.includes)!=null&&ye.call(U,"vendedor_dulces"))&&r){S(r),B(!0);try{localStorage.setItem("pos_vendorId",r),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(U&&((te=U.includes)!=null&&te.call(U,"admin"))){B(!1);return}try{const Ve=localStorage.getItem("pos_vendorId")||"",qe=localStorage.getItem("pos_role")||"";Ve&&S(Ve),qe.toUpperCase()==="VENDEDOR"&&B(!0)}catch{}},[t,r]);const pe=async U=>{if(!U){A({});return}const ye=sr(yt(Ie,"inventory_candies_sellers"),mr("sellerId","==",U)),te=await Ht(ye),Ve={};te.forEach(qe=>{const G=qe.data(),V=G.productId||"";if(!V)return;const Z=Number(G.remainingUnits??G.remaining??G.totalUnits??0);Z<=0||(Ve[V]=(Ve[V]||0)+Z)}),A(Ve),z(qe=>{const G=[];for(const V of qe){const Z=Ve[V.productId]??0;Z>0&&G.push({...V,availableUnits:Z})}return G})};g.useEffect(()=>{if(!_){A({});return}const U=u.find(ye=>ye.id===_);U&&x(U.branch),pe(_)},[_,u]),g.useEffect(()=>{z(U=>U.map(ye=>{const te=l.find(qe=>qe.id===ye.productId);if(!te)return ye;const Ve=p==="RIVAS"?te.priceRivas:p==="SAN_JORGE"?te.priceSanJorge:te.priceIsla;return{...ye,pricePerPackage:Number(Ve)||0}}))},[p,l]);async function Pe(U){const{productId:ye,vendorId:te,branch:Ve}=U;if(!ye||!te)return 0;const qe=sr(yt(Ie,"inventory_candies_sellers"),mr("sellerId","==",te),mr("productId","==",ye)),G=await Ht(qe);if(G.empty)return 0;const V=G.docs[0].data(),Z=Number(V.unitPriceVendor??0);if(Z>0)return Z;const re=Number(Ve==="RIVAS"?V.unitPriceRivas??0:Ve==="SAN_JORGE"?V.unitPriceSanJorge??0:V.unitPriceIsla??0);return Number(re||0)}const Ee=U=>{const ye=Number(ct||0),te=Number(U||0)*ye/100;return Math.max(0,Number(te.toFixed(2)))},Ze=async U=>{var Fe;if(!U)return;if(!_){L("Selecciona primero el vendedor para usar su inventario."),P("");return}if(O.some(st=>st.productId===U)){P("");return}const ye=l.find(st=>st.id===U);if(!ye){P("");return}const te=await sG(U,_),Ve=((Fe=u.find(st=>st.id===_))==null?void 0:Fe.branch)??p,qe=await Pe({productId:U,vendorId:_,branch:Ve}),V=await(async st=>{const{productId:Be,vendorId:at}=st;if(!Be||!at)return 0;try{const lt=sr(yt(Ie,"inventory_candies_sellers"),mr("sellerId","==",at),mr("productId","==",Be)),dt=await Ht(lt);if(dt.empty)return 0;const Pt=dt.docs[0].data();return Number(Pt.providerPrice??0)}catch{return 0}})({productId:U,vendorId:_}),Z=(()=>{const st=Number(ye.providerPrice||0);if(st>0)return st;const Be=Number(ye.providerPricePerUnit||0);return Be>0?Be*Number(ye.unitsPerPackage||1):0})(),re=Number(V||0)>0?Number(V||0):Number(Z||0),we={productId:U,productName:ye.name||"",sku:ye.sku||"",unitsPerPackage:ye.unitsPerPackage||1,pricePerPackage:Number(qe)||0,availableUnits:Number(te)||0,qtyPackages:0,discount:0,providerPricePerPackage:Number(re)||0,margenVendedor:0,uBruta:0};z(st=>[...st,we]),P("")},xe=(U,ye)=>{z(te=>te.map(Ve=>{if(Ve.productId!==U)return Ve;if(ye==="")return{...Ve,qtyPackages:0};const qe=Math.max(0,Math.floor(Number(ye))),G=f[U]??Ve.availableUnits??0,V=Math.max(1,Number(Ve.unitsPerPackage||1)),Z=Math.floor(G/V);let re=qe;qe>Z&&(re=Z,L(` Solo hay ${Z} paquetes disponibles.`),setTimeout(()=>L(""),2500));const we=Number(Ve.pricePerPackage||0)*re,Fe=Number(Ve.providerPricePerPackage||0)*re,st=we-Fe,Be=Ee(st);return{...Ve,qtyPackages:re,margenVendedor:Be,uBruta:st}}))},Se=(U,ye)=>{z(te=>te.map(Ve=>{if(Ve.productId!==U)return Ve;if(ye==="")return{...Ve,discount:0};const qe=Math.max(0,Math.floor(Number(ye))),G=Ve.qtyPackages||0,V=Number(Ve.pricePerPackage||0)*G,Z=Number(Ve.providerPricePerPackage||0)*G,re=V-Z,we=Ee(re);return{...Ve,discount:qe,margenVendedor:we,uBruta:re}}))},gt=U=>z(ye=>ye.filter(te=>te.productId!==U)),Et=async()=>{if(!j)return"Selecciona la fecha.";if(!_)return"Selecciona el vendedor para esta venta.";if(O.length===0)return"Agrega al menos un producto.";const U=O.filter(ye=>(ye.qtyPackages||0)>0);if(U.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(Re>0))return"El total debe ser mayor a cero.";if(h==="CONTADO"){if(!b.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!v)return"Selecciona un cliente (crdito).";if(F<0)return"El pago inicial no puede ser negativo.";if(F>Le)return"El pago inicial no puede superar el saldo a deber (saldo actual + venta).";if((Ue==null?void 0:Ue.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const ye of U){const te=ye.unitsPerPackage||1,Ve=(ye.qtyPackages||0)*te,qe=await sG(ye.productId,_),G=Math.floor(qe/te);if(Ve>qe)return`Inventario insuficiente en el pedido del vendedor para "${ye.productName}". Disponible: ${G} paquetes.`;const V=(Number(ye.pricePerPackage)||0)*(ye.qtyPackages||0),Z=Number(ye.discount)||0;if(!Number.isInteger(Z)||Z<0)return`El descuento en "${ye.productName}" debe ser entero y  0.`;if(Z>V)return`El descuento en "${ye.productName}" no puede exceder C$ ${V.toFixed(2)}.`}return null},Nt=async U=>{U.preventDefault(),L("");const ye=await Et();if(ye){L(" "+ye);return}try{Y(!0);const te=O.filter(Z=>(Z.qtyPackages||0)>0).map(Z=>{const re=Z.unitsPerPackage||1,we=Z.qtyPackages||0,Fe=we*re,st=(Number(Z.pricePerPackage)||0)*(we||0),Be=Math.max(0,Math.floor(Number(Z.discount)||0)),at=Math.max(0,st-Be),lt=Number(Z.providerPricePerPackage||0),dt=lt*we,Pt=st-dt,he=Ee(Pt);return{productId:Z.productId,productName:Z.productName,sku:Z.sku||"",qty:Fe,packages:we,unitsPerPackage:re,branch:p,unitPricePackage:Number(Z.pricePerPackage)||0,discount:Be,total:Math.floor(at*100)/100,providerPricePerPackage:lt,margenVendedor:he,uBruta:Pt}}),Ve={type:h,branch:p,date:j,createdAt:vr.now(),itemsTotal:Number(Re)||0,total:Number(Re)||0,quantity:Number(ke)||0,packagesTotal:Number(se)||0,items:te,vendorId:_},qe=u.find(Z=>Z.id===_);qe&&(Ve.vendorName=qe.name,Ve.vendorBranch=qe.branch,Ve.vendorBranchLabel=qe.branchLabel,Ve.vendorCommissionPercent=qe.commissionPercent||0,Ve.vendorCommissionAmount=_t||0),h==="CONTADO"?Ve.customerName=b.trim():(Ve.customerId=v,Ve.downPayment=Number(F)||0);const G=await Jn(yt(Ie,"sales_candies"),Ve);if(h==="CONTADO"){const Z=(b||"").trim();if(Z)try{await Jn(yt(Ie,"cash_customers"),{name:Z,date:j,branch:p,vendorId:_,createdAt:vr.now()})}catch(re){console.warn("No se pudo guardar cash_customer:",re)}}if(h==="CREDITO"&&v){const Z={customerId:v,date:j,createdAt:vr.now(),ref:{saleId:G.id}};await Jn(yt(Ie,"ar_movements"),{...Z,type:"CARGO",amount:Number(Re)||0}),Number(F)>0&&await Jn(yt(Ie,"ar_movements"),{...Z,type:"ABONO",amount:-Number(F)})}const V={};for(const Z of te)if(Z.qty>0){const{allocations:re}=await BQe({productId:Z.productId,vendorId:_,quantityUnits:Z.qty,saleDate:j,saleId:G.id});V[Z.productId]={productId:Z.productId,vendorId:_,allocations:re}}await Fn(Zt(Ie,"sales_candies",G.id),{allocationsByItem:V});try{const Z=h==="CONTADO"?b.trim()||"Cliente Mostrador":(Ue==null?void 0:Ue.name)||"Cliente crdito";PQe({saleId:G.id,date:j,customerName:Z,branch:p,items:te.map(re=>({productName:re.productName,qty:re.packages,unitPrice:re.unitPricePackage,total:re.total})),total:Number(Re)||0,vendorName:qe==null?void 0:qe.name,vendorCommissionPercent:(qe==null?void 0:qe.commissionPercent)||0,vendorCommissionAmount:_t})}catch(Z){console.error("Error generando voucher PDF:",Z)}m("CONTADO"),y(""),w(""),I(iG()),z([]),H(0),h==="CREDITO"&&v&&o(Z=>Z.map(re=>re.id===v?{...re,balance:(re.balance||0)+(Number(Re)||0)-(Number(F)||0)}:re)),L(" Venta de dulces registrada"),_?await pe(_):A({})}catch(te){console.error(te),L(" Error al guardar la venta de dulces")}finally{Y(!1)}},Tt=g.useMemo(()=>l.filter(U=>{const ye=f[U.id]||0,te=Math.max(1,Number(U.unitsPerPackage||1));return Math.floor(ye/te)>0}).sort((U,ye)=>(U.name||"").localeCompare(ye.name||"")),[l,f]),[Lt,Me]=g.useState(""),_e=g.useMemo(()=>{const U=String(Lt||"").trim().toLowerCase();return U?Tt.filter(ye=>`${ye.name||""} ${ye.sku||""}`.toLowerCase().includes(U)||String(ye.id||"").includes(U)):Tt},[Lt,Tt]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),i.jsxs("form",{onSubmit:Nt,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6",children:[i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:U=>m(U.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:b,onChange:U=>w(U.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:v,onChange:U=>y(U.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),Ne.map(U=>i.jsxs("option",{value:U.status==="ACTIVO"?U.id:"",disabled:U.status==="BLOQUEADO",children:[U.name," | ",U.phone," | Saldo: ",Kc(U.balance||0)]},U.id))]}),i.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>Q(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Kc(be)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:Le,className:"w-full border p-2 rounded",value:F===0?"":F,onChange:U=>{const ye=Ae(U.target.value);H(ye)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Kc(Ce)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:U=>I(U.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_,onChange:U=>{S(U.target.value),z([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(U=>i.jsxs("option",{value:U.id,children:[U.name,"  ",U.branchLabel,"  ",U.commissionPercent.toFixed(2),"%"," comisin"]},U.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:p==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:p==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:p==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:_?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Lt,onChange:U=>Me(U.target.value),disabled:!_}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>kt(!0),disabled:!_,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:T,onChange:async U=>{const ye=U.target.value;P(ye),await Ze(ye)},disabled:!_,children:[i.jsx("option",{value:"",children:_?"Selecciona un producto":"Selecciona un vendedor primero"}),_e.map(U=>{const ye=O.some(G=>G.productId===U.id),te=f[U.id]||0,Ve=Math.max(1,Number(U.unitsPerPackage||1)),qe=Math.floor(te/Ve);return qe<=0?null:i.jsxs("option",{value:ye?"":U.id,disabled:ye,children:[U.name," ",U.sku?` ${U.sku}`:""," (disp: ",qe," ","paq.)",ye?" ":""]},U.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),O.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):O.map(U=>{const ye=f[U.productId]??U.availableUnits??0,te=U.unitsPerPackage?Math.floor(ye/U.unitsPerPackage):0,Ve=Math.max(0,te-(U.qtyPackages||0)),qe=(Number(U.pricePerPackage)||0)*(U.qtyPackages||0),G=Math.max(0,qe-(Number(U.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[U.productName,U.sku?`  ${U.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Kc(U.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[Ve," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(U.qtyPackages)||U.qtyPackages===0?"":U.qtyPackages,onChange:V=>xe(U.productId,V.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(U.discount)||U.discount===0?"":U.discount,onChange:V=>Se(U.productId,V.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1 text-right",children:Kc(G)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>gt(U.productId),title:"Quitar producto",children:""})})]},U.productId)})]})}),O.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:se})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Kc(Re)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Kc(_t)," ",ct?`(${ct.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:W,children:W?"Guardando...":"Registrar venta"})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>de(U=>!U),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Datos de venta",i.jsx("span",{className:"text-lg",children:ce?"":"+"})]}),ce&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:U=>I(U.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:U=>m(U.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (Cash)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mario Bergoglio",value:b,onChange:U=>w(U.target.value)})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:U=>y(U.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),Ne.map(U=>i.jsxs("option",{value:U.status==="ACTIVO"?U.id:"",disabled:U.status==="BLOQUEADO",children:[U.name," | Saldo: ",Kc(U.balance||0)]},U.id))]}),i.jsx("button",{type:"button",className:"w-full px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>Q(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:Kc(be)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:Kc(Ce)})]})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:Le,className:"w-full border p-2 rounded",value:F===0?"":F,onChange:U=>{const ye=Ae(U.target.value);H(ye)},placeholder:"0.00"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_,onChange:U=>{S(U.target.value),z([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(U=>i.jsxs("option",{value:U.id,children:[U.name,"  "," ",U.commissionPercent.toFixed(2),"%"]},U.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor Logueado en esta app."})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>me(U=>!U),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Agrega Productos",i.jsx("span",{className:"text-lg",children:ue?"":"+"})]}),ue&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Productos"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:_?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Lt,onChange:U=>Me(U.target.value),disabled:!_}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>kt(!0),disabled:!_,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:T,onChange:async U=>{const ye=U.target.value;P(ye),await Ze(ye)},disabled:!_,children:[i.jsx("option",{value:"",children:_?"Selecciona un producto":"Selecciona un vendedor primero"}),_e.map(U=>{const ye=O.some(G=>G.productId===U.id),te=f[U.id]||0,Ve=Math.max(1,Number(U.unitsPerPackage||1)),qe=Math.floor(te/Ve);return qe<=0?null:i.jsxs("option",{value:ye?"":U.id,disabled:ye,children:[U.name," ",U.sku?` ${U.sku}`:""," (disp:"," ",qe," paq.)",ye?" ":""]},U.id)})]})]}),O.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay productos agregados."}):i.jsx("div",{className:"space-y-2",children:O.map(U=>{const ye=f[U.productId]??U.availableUnits??0,te=U.unitsPerPackage?Math.floor(ye/U.unitsPerPackage):0,Ve=Math.max(0,te-(U.qtyPackages||0)),qe=(Number(U.pricePerPackage)||0)*(U.qtyPackages||0),G=Math.max(0,qe-(Number(U.discount)||0));return i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50 space-y-2",children:[i.jsxs("div",{className:"font-semibold leading-tight",children:[U.productName,U.sku?`  ${U.sku}`:""]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio x Paquete"}),i.jsx("div",{className:"font-bold",children:Kc(U.pricePerPackage)})]}),i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencias"}),i.jsxs("div",{className:"font-bold",children:[Ve," paq."]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cantidad Paquetes"}),i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(U.qtyPackages)||U.qtyPackages===0?"":U.qtyPackages,onChange:V=>xe(U.productId,V.target.value),inputMode:"numeric",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Descuento"}),i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(U.discount)||U.discount===0?"":U.discount,onChange:V=>Se(U.productId,V.target.value),inputMode:"numeric",placeholder:"0"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"font-regular text-gray-600",children:["Total ",Kc(G)]}),i.jsxs("div",{className:"font-regular text-gray-600",children:["Comision ",Kc(U.margenVendedor||0)]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg bg-red-100 hover:bg-red-200",onClick:()=>gt(U.productId),children:"Quitar"})]})]},U.productId)})}),O.length>0&&i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:se})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-semibold",children:Kc(Re)})]})]})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl hover:bg-blue-700 disabled:opacity-60",disabled:W,children:W?"Guardando...":"Registrar venta"})]})]}),K&&i.jsx("p",{className:"mt-2 text-sm",children:K}),D&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ee,onChange:U=>ve(U.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:M,onChange:U=>Ye(oG(U.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:U=>X(U.target.value),children:[i.jsx("option",{value:"",children:""}),SQe.map(U=>i.jsx("option",{value:U,children:U},U))]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:jt,onChange:U=>Mt(U.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.filter(U=>(U.status??"ACTIVO")==="ACTIVO").map(U=>i.jsxs("option",{value:U.id,children:[U.name,"  ",U.branchLabel]},U.id))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:De,onChange:U=>le(U.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Ft(),Q(!1)},children:"Cancelar"}),i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var te;const U=E?_||r:jt;if(!U){L("Selecciona el vendedor para asociar este cliente.");return}if(L(""),!ee.trim()){L("Ingresa el nombre del nuevo cliente.");return}const ye=oG(M);try{const Ve=await Jn(yt(Ie,"customers_candies"),{name:ee.trim(),phone:ye,place:ae||"",notes:De||"",status:$e,creditLimit:Number(it||0),createdAt:vr.now(),sellerId:U,vendorId:U,vendorName:((te=u.find(G=>G.id===U))==null?void 0:te.name)||""}),qe={id:Ve.id,name:ee.trim(),phone:ye,place:ae||"",status:$e,creditLimit:Number(it||0),balance:0,sellerId:U};o(G=>[qe,...G]),y(Ve.id),Ft(),Q(!1),L(" Cliente creado")}catch(Ve){console.error(Ve),L(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),i.jsx(ie,{open:$t,onClose:()=>kt(!1),onDetected:Ge}),W&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const lG=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],d_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function kQe(){const[t,e]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Mr(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState(null),[S,E]=g.useState(""),[B,T]=g.useState(""),[P,O]=g.useState(""),[z,ce]=g.useState(0),[de,ue]=g.useState("PENDIENTE"),[me,se]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(yt(Ie,"expenses_candies"),In("date","desc")),Q=await Ht(D),ee=[];Q.forEach(ve=>{const M=ve.data();ee.push({id:ve.id,date:M.date||Mr(new Date,"yyyy-MM-dd"),category:M.category||"",description:M.description||"",amount:Number(M.amount||0),status:M.status||"PENDIENTE",notes:M.notes||"",createdAt:M.createdAt??vr.now()})}),v(ee)}catch(D){console.error(D),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const ke=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Re=g.useMemo(()=>{const D=ke.reduce((ve,M)=>ve+(M.amount||0),0),Q=ke.filter(ve=>ve.status==="PAGADO").reduce((ve,M)=>ve+(M.amount||0),0),ee=D-Q;return{total:D,pagado:Q,pendiente:ee}},[ke]),F=()=>{s(Mr(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const Q=await Jn(yt(Ie,"expenses_candies"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:vr.now()});v(ee=>[{id:Q.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:vr.now()},...ee]),F(),j(" Gasto registrado")}catch(Q){console.error(Q),j(" Error al guardar gasto")}},K=D=>{_(D.id),E(D.date),T(D.category||""),O(D.description||""),ce(Number(D.amount||0)),ue(D.status||"PENDIENTE"),se(D.notes||"")},L=()=>{_(null),E(""),T(""),O(""),ce(0),ue("PENDIENTE"),se("")},W=async()=>{if(I){if(!B){j("Selecciona una categora.");return}if(!P.trim()){j("Ingresa una descripcin.");return}if(!z||z<=0){j("Ingresa un monto vlido.");return}try{await Fn(Zt(Ie,"expenses_candies",I),{date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:de,notes:me||""}),v(D=>D.map(Q=>Q.id===I?{...Q,date:S,category:B,description:P.trim(),amount:Number(z.toFixed(2)),status:de,notes:me||""}:Q)),L(),j(" Gasto actualizado")}catch(D){console.error(D),j(" Error al actualizar gasto")}}},Y=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await Kn(Zt(Ie,"expenses_candies",D.id)),v(ee=>ee.filter(ve=>ve.id!==D.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",d_(Re.total)]}),i.jsxs("div",{children:["Pagado: ",d_(Re.pagado)]}),i.jsxs("div",{children:["Pendiente: ",d_(Re.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),lG.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):ke.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):ke.slice().sort((D,Q)=>D.date.localeCompare(Q.date)).map(D=>{const Q=I===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:ee=>E(ee.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:ee=>T(ee.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),lG.map(ee=>i.jsx("option",{value:ee,children:ee},ee))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:ee=>O(ee.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(z)?"":z,onChange:ee=>ce(Math.max(0,Number(ee.target.value||0)))}):d_(D.amount)}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:de,onChange:ee=>ue(ee.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:me,onChange:ee=>se(ee.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:W,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:L,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>K(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Y(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const xo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function FQe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Mr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function OQe(t,e){var s,o,l;const r=FQe(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((c,u)=>c+(Number(u.packages??u.qty??u.quantity??0)||0),0),a=Number(t.total??t.itemsTotal??0)||0):(n=Number(t.packagesTotal??t.quantity??((s=t.item)==null?void 0:s.packages)??((o=t.item)==null?void 0:o.qty)??0)||0,a=Number(t.total??((l=t.item)==null?void 0:l.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}async function DQe(t){const e=(t||"").trim();if(!e)return;const r=sr(yt(Ie,"ar_movements"),mr("ref.saleId","==",e)),n=await Ht(r);await Promise.all(n.docs.map(a=>Kn(Zt(Ie,"ar_movements",a.id))))}function RQe({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=En(n,"vendedor_dulces"),s=En(n,"admin"),o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async ie=>{c(!0),d(!0),A(ie),m([]);try{const Ue=await zs(Zt(Ie,"sales_candies",ie)),Ne=Ue.exists()?Ue.data():null;if(!Ne){m([]);return}const Ce=(Array.isArray(Ne==null?void 0:Ne.items)?Ne.items:Ne!=null&&Ne.item?[Ne.item]:[]).map(Le=>({productName:String(Le.productName||""),qty:Number(Le.packages??Le.qty??Le.quantity??0),unitPrice:Number(Le.unitPricePackage??Le.unitPrice??0),discount:Number(Le.discount||0),total:Number(Le.total??Le.lineFinal??0)}));m(Ce)}catch(Ue){console.error(Ue)}finally{d(!1)}},[x,v]=g.useState(Mr(new Date,"yyyy-MM-01")),[y,b]=g.useState(Mr(new Date,"yyyy-MM-dd")),[w,j]=g.useState([]),[I,_]=g.useState([]),[S,E]=g.useState([]),[B,T]=g.useState(!0),[P,O]=g.useState(""),[z,ce]=g.useState(""),[de,ue]=g.useState(""),[me,se]=g.useState(null),ke=15,[Re,F]=g.useState(1),[H,K]=g.useState(!1),[L,W]=g.useState(!1),[Y,D]=g.useState(!1),[Q,ee]=g.useState(!1),ve=g.useMemo(()=>{const ie={};return w.forEach(Ue=>ie[Ue.id]=Ue.name),ie},[w]),M=g.useMemo(()=>{const ie={};return S.forEach(Ue=>{ie[Ue.id]=Ue}),ie},[S]),Ye=ie=>{const Ue=Number(ie.vendorCommissionAmount||0);if(Ue>0)return Ue;if(!ie.vendorId)return 0;const Ne=M[ie.vendorId];if(!Ne||!Ne.commissionPercent)return 0;const be=(Number(ie.total)||0)*(Number(Ne.commissionPercent)||0)/100;return Number(be.toFixed(2))};g.useEffect(()=>{(async()=>{T(!0),O("");try{const ie=await Ht(yt(Ie,"customers_candies")),Ue=[];ie.forEach(Ae=>Ue.push({id:Ae.id,name:Ae.data().name||""})),j(Ue);const Ne=await Ht(yt(Ie,"sellers_candies")),be=[];Ne.forEach(Ae=>{const We=Ae.data();be.push({id:Ae.id,name:We.name||"",commissionPercent:Number(We.commissionPercent||0)})}),E(be);const Ce=await Ht(sr(yt(Ie,"sales_candies"),In("createdAt","desc"))),Le=[];Ce.forEach(Ae=>{const We=OQe(Ae.data(),Ae.id);We&&We.date>=x&&We.date<=y&&Le.push(We)}),_(Le.sort((Ae,We)=>We.date.localeCompare(Ae.date))),F(1)}catch(ie){console.error(ie),O(" Error cargando transacciones.")}finally{T(!1)}})()},[x,y]);const ae=g.useMemo(()=>I.filter(ie=>!(a&&(!e||!ie.vendorId||ie.vendorId!==e)||z&&ie.customerId!==z||de&&ie.type!==de)),[I,z,de,a,e]),X=g.useMemo(()=>{let ie=0,Ue=0,Ne=0,be=0,Ce=0,Le=0;for(const Ae of ae)Ae.type==="CONTADO"?(ie+=Ae.quantity,Ne+=Ae.total,Ce+=Ye(Ae)):(Ue+=Ae.quantity,be+=Ae.total,Le+=Ye(Ae));return{packsCash:ie,packsCredito:Ue,montoCash:Ne,montoCredito:be,comisionCash:Ce,comisionCredito:Le}},[ae]),De=Math.max(1,Math.ceil(ae.length/ke)),le=g.useMemo(()=>{const ie=(Re-1)*ke;return ae.slice(ie,ie+ke)},[ae,Re]),$e=g.useMemo(()=>le.filter(ie=>ie.type==="CONTADO"),[le]),Xe=g.useMemo(()=>le.filter(ie=>ie.type==="CREDITO"),[le]),it=g.useMemo(()=>f&&I.find(ie=>ie.id===f)||null,[f,I]),xt=async ie=>{if(s&&(se(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{T(!0);const Ue=ie.id.split("#")[0];await G2(Ue),await DQe(Ue),_(Ne=>Ne.filter(be=>be.id!==ie.id)),O(" Venta eliminada y saldo del cliente ajustado")}catch(Ue){console.error(Ue),O(" No se pudo eliminar la venta.")}finally{T(!1)}},jt=()=>{const ie=`Ventas del dia  ${x} a ${y}`,Ue=Le=>(Le||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Ne=ae.map(Le=>{const Ae=Le.customerName||(Le.customerId?ve[Le.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Le.date}</td>
          <td>${Ue(Ae)}</td>
          <td>${Le.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Le.quantity}</td>
          <td style="text-align:right">${xo(Le.total)}</td>
        </tr>`}).join(""),be=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Ue(ie)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Ue(ie)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${X.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${X.packsCredito}</div>
        <div><b>Monto Cash:</b> ${xo(X.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${xo(X.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${Ne||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Ce=window.open("","_blank");Ce&&(Ce.document.open(),Ce.document.write(be),Ce.document.close())},Mt=()=>F(1),Ft=()=>F(ie=>Math.max(1,ie-1)),$t=()=>F(ie=>Math.min(De,ie+1)),kt=()=>F(De),Ge=()=>{const ie=[];if(De<=7)for(let Ne=1;Ne<=De;Ne++)ie.push(Ne);else{const Ne=Math.max(1,Re-2),be=Math.min(De,Re+2);ie.push(1),Ne>2&&ie.push(-1);for(let Ce=Ne;Ce<=be;Ce++)Ce!==1&&Ce!==De&&ie.push(Ce);be<De-1&&ie.push(-2),ie.push(De)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Mt,disabled:Re===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ft,disabled:Re===1,children:" Anterior"}),ie.map((Ne,be)=>typeof Ne=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${Ne===Re?"bg-blue-600 text-white":""}`,onClick:()=>F(Ne),children:Ne},be):i.jsx("span",{className:"px-2",children:""},be)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:$t,disabled:Re===De,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:kt,disabled:Re===De,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Re," de ",De,"  ",ae.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>K(ie=>!ie),"aria-expanded":H,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${H?"rotate-180":""}`,children:""})]}),H&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:ie=>{v(ie.target.value),F(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:ie=>{b(ie.target.value),F(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:z,onChange:ie=>{ce(ie.target.value),F(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(ie=>i.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:de,onChange:ie=>{ue(ie.target.value),F(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:jt,children:"Exportar PDF"})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>W(ie=>!ie),"aria-expanded":L,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${L?"rotate-180":""}`,children:""})]}),L&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:X.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:X.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(X.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(X.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(X.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(X.comisionCredito)})]})]})})]}),i.jsxs("div",{className:"block md:hidden space-y-3",children:[B?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):le.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(ie=>!ie),"aria-expanded":Y,children:[i.jsx("span",{children:"Cash"}),i.jsx("span",{className:`transition-transform ${Y?"rotate-180":""}`,children:""})]}),Y&&i.jsx("div",{className:"p-3 border-t space-y-3",children:$e.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):$e.map(ie=>{const Ue=ie.customerName||(ie.customerId?ve[ie.customerId]:"")||"Nombre cliente",Ne=Ye(ie);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Ue}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ie.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-green-50 border-green-200 text-green-700",children:"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:be=>{be.preventDefault(),p(ie.id)},title:"Ver detalle",children:ie.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",xo(ie.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Ue})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ie.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ie.id),title:"Ver detalle",children:ie.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:xo(ie.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:Ne>0?xo(Ne):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ie.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>se(be=>be===ie.id?null:ie.id),children:" Acciones"}),me===ie.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>xt(ie),children:"Eliminar"})]})]})})]})},ie.id)})})]}),i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>ee(ie=>!ie),"aria-expanded":Q,children:[i.jsx("span",{children:"Crdito"}),i.jsx("span",{className:`transition-transform ${Q?"rotate-180":""}`,children:""})]}),Q&&i.jsx("div",{className:"p-3 border-t space-y-3",children:Xe.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):Xe.map(ie=>{const Ue=ie.customerName||(ie.customerId?ve[ie.customerId]:"")||"Nombre cliente",Ne=Ye(ie);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Ue}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ie.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-yellow-50 border-yellow-200 text-yellow-700",children:"Crdito"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:be=>{be.preventDefault(),p(ie.id)},title:"Ver detalle",children:ie.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",xo(ie.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Ue})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ie.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Crdito"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ie.id),title:"Ver detalle",children:ie.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:xo(ie.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:Ne>0?xo(Ne):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ie.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>se(be=>be===ie.id?null:ie.id),children:" Acciones"}),me===ie.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>xt(ie),children:"Eliminar"})]})]})})]})},ie.id)})})]})]}),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:Ge()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):le.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):le.map(ie=>{const Ue=ie.customerName||(ie.customerId?ve[ie.customerId]:"")||"Nombre cliente",Ne=Ye(ie);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ie.date}),i.jsx("td",{className:"p-2 border",children:Ue}),i.jsx("td",{className:"p-2 border",children:ie.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(ie.id),children:ie.quantity})}),i.jsx("td",{className:"p-2 border",children:xo(ie.total)}),i.jsx("td",{className:"p-2 border",children:Ne>0?xo(Ne):""}),i.jsx("td",{className:"p-2 border",children:ie.vendorName||""}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>se(be=>be===ie.id?null:ie.id),title:"Acciones",children:""}),me===ie.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>xt(ie),children:"Eliminar"})})]})]},ie.id)})})]}),Ge()]}),P&&i.jsx("p",{className:"mt-2 text-sm",children:P}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",f?` #${f}`:""]}),it&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:Ye(it)>0?xo(Ye(it)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((ie,Ue)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ie.productName}),i.jsx("td",{className:"p-2 border text-right",children:ie.qty}),i.jsx("td",{className:"p-2 border text-right",children:xo(ie.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:xo(ie.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:xo(ie.total)})]},Ue))})]})})]})})]})}const vn=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function eb(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Mr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function MQe(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/a:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}});if(t!=null&&t.item){const n=t.item,a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/a:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0),uBruta:Number((t==null?void 0:t.uBruta)??(t==null?void 0:t.grossProfit)??0)}]:[]}function LQe(t,e){const r=eb(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,a=t.vendorName||t.sellerName||void 0,s=MQe(t);let o=Number(t.total??t.itemsTotal??0)||s.reduce((l,c)=>{const u=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),d=Math.max(0,Number(c.discount||0)),f=Math.max(0,u-d);return l+f},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:s,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:a,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}function UQe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}async function QQe(t){const e=sr(yt(Ie,"ar_movements"),mr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Kn(Zt(Ie,"ar_movements",n.id))))}function VQe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,_]=g.useState([]),[S,E]=g.useState({}),[B,T]=g.useState({}),[P,O]=g.useState(!1),[z,ce]=g.useState(null),[de,ue]=g.useState([]),[me,se]=g.useState(!1),[ke,Re]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[F,H]=g.useState(!1),[K,L]=g.useState(""),[W,Y]=g.useState([]),[D,Q]=g.useState(!1),[ee,ve]=g.useState("CASH"),[M,Ye]=g.useState(1),ae=10,[X,De]=g.useState(!1),[le,$e]=g.useState(null);g.useEffect(()=>{(async()=>{try{const Ae=await Ht(yt(Ie,"sellers_candies")),We=[];Ae.forEach(ct=>{const _t=ct.data();We.push({id:ct.id,name:_t.name||"",commissionPercent:Number(_t.commissionPercent||0)})}),_(We)}catch(Ae){console.error("Error cargando sellers_candies",Ae)}})()},[]);const Xe=g.useMemo(()=>{const Ae={};return I.forEach(We=>{Ae[We.id]=We}),Ae},[I]);g.useEffect(()=>{(async()=>{b(!0),j("");try{const Ae=await Ht(yt(Ie,"sales_candies")),We=[],ct=[];Ae.forEach(Me=>{const _e=Me.data(),U=LQe(_e,Me.id);U&&(U.date<=a&&We.push(U),U.date>=r&&U.date<=a&&ct.push(U))}),u(We),l(ct);const _t=await Ht(yt(Ie,"inventory_candies")),pe=[];_t.forEach(Me=>{const _e=Me.data(),U=eb(_e);if(!U||U>a)return;const ye=Math.max(1,Math.floor(Number(_e.unitsPerPackage||1))),te=Number(_e.totalUnits??_e.quantity??0),Ve=Number(_e.packages??0),qe=Number(_e.remaining??0),G=Number(_e.remainingPackages??0),V=Ve>0?Ve:te>0?Math.floor(te/ye):0,Z=G>0?G:qe>0?Math.floor(qe/ye):0;pe.push({id:Me.id,productId:_e.productId,productName:_e.productName||"",date:U,quantity:Number(V||0),remaining:Number(Z||0),purchasePrice:Number(_e.providerPrice||_e.purchasePrice||0),unitsPerPackage:ye})}),f(pe);const Pe=await Ht(yt(Ie,"expenses_candies")),Ee=[];Pe.forEach(Me=>{const _e=Me.data(),U=eb(_e);U&&U>=r&&U<=a&&Ee.push({id:Me.id,date:U,category:_e.category||"",description:_e.description||"",amount:Number(_e.amount||0),status:_e.status||""})}),h(Ee);const Ze=await Ht(yt(Ie,"ar_movements")),xe=[],Se={};Ze.forEach(Me=>{const _e=Me.data(),U=eb(_e);if(!U)return;const ye=_e.customerId,te=Number(_e.amount||0);ye&&(Se[ye]=(Se[ye]||0)+te),_e.type==="ABONO"&&U>=r&&U<=a&&xe.push({id:Me.id,customerId:ye,type:"ABONO",amount:te,date:U})}),p(xe);const gt=await Ht(yt(Ie,"customers_candies")),Et=[];gt.forEach(Me=>{const _e=Me.data();Et.push({id:Me.id,name:_e.name||"",balance:Se[Me.id]||0})}),v(Et);const Nt=await Ht(yt(Ie,"inventory_candies_sellers")),Tt={},Lt={};Nt.forEach(Me=>{const _e=Me.data(),U=eb(_e);if(!U||U<r||U>a)return;const ye=_e.sellerId||_e.vendorId||"NO_VENDOR",te=_e.productName||"",Ve=_e.sku||"",qe=Math.max(1,Math.floor(Number(_e.unitsPerPackage||1))),G=Number(_e.totalUnits??0),V=Number(_e.packages??0),Z=Number(_e.remainingUnits??_e.remaining??0),re=Number(_e.remainingPackages??0),we=V>0?V:G>0?Math.floor(G/qe):0,Fe=re>0?re:Z>0?Math.floor(Z/qe):0,st=Number(_e.totalVendor??0),Be=Number(_e.uVendor??0),at=Number(_e.subtotal??0),lt=Number(_e.uBruta??0),dt=we,Pt=dt>0?st/dt:0,he=dt>0?Be/dt:0,ze=dt>0?at/dt:0,nt=dt>0?lt>0?lt/dt:Pt-ze:0;if(Tt[ye]||(Tt[ye]={associated:[],remaining:[]}),we>0){const ne=we,He=ne*Pt,pt=ne*ze,Dt=He,rr=ne*he,zt=ne*nt;Tt[ye].associated.push({saleId:Me.id,date:U,productId:_e.productId||_e.id||"",productName:te,sku:Ve,qty:ne,unitPrice:Pt,costTotal:pt,lineTotal:He,discount:0,lineFinal:Dt,grossProfit:zt,vendorCommissionAmount:rr,type:"ASSOCIATED"}),Lt[ye]=(Lt[ye]||0)+ne}if(Fe>0){const ne=Fe,He=ne*Pt,pt=ne*ze,Dt=He,rr=ne*he,zt=ne*nt;Tt[ye].remaining.push({saleId:Me.id,date:U,productId:_e.productId||_e.id||"",productName:te,sku:Ve,qty:ne,unitPrice:Pt,costTotal:pt,lineTotal:He,discount:0,lineFinal:Dt,grossProfit:zt,vendorCommissionAmount:rr,type:"REMAINING"})}}),E(Tt),T(Lt)}catch(Ae){console.error(Ae),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const it=g.useCallback((Ae,We)=>{const ct=Number(We.vendorCommissionAmount||0)||0;if(ct>0)return ct;const _t=Number(Ae.vendorCommissionAmount||0)||0;if(_t<=0)return 0;const pe=Number(We.qty||0),Pe=Number(We.unitPrice||0),Ee=pe*Pe,Ze=Math.max(0,Number(We.discount||0)),xe=Math.max(0,Ee-Ze);return!xe||!Ae.total?0:_t*xe/Ae.total},[]),xt=g.useMemo(()=>{try{return UQe(d,c,r,a)}catch(Ae){return console.error(Ae),0}},[d,c,r,a]),jt=g.useMemo(()=>{const Ae=o.reduce((Nt,Tt)=>Nt+(Tt.total||0),0),We=A.reduce((Nt,Tt)=>Nt+(Tt.amount||0),0),ct=Ae-xt,_t=ct-We;let pe=0;for(const Nt of o)for(const Tt of Nt.items||[]){const Lt=Number(Tt.uBruta||0);Number.isFinite(Lt)&&(pe+=Lt)}const Pe=m.reduce((Nt,Tt)=>Nt+Math.abs(Tt.amount||0),0),Ee=x.filter(Nt=>(Nt.balance||0)>0),Ze=Ee.reduce((Nt,Tt)=>Nt+(Tt.balance||0),0);let xe=0,Se=0,gt=0,Et=0;for(const Nt of o){const Tt=(Nt.items||[]).reduce((Me,_e)=>Me+(Number(_e.qty)||0),0),Lt=(Nt.items||[]).reduce((Me,_e)=>Me+it(Nt,_e),0);Nt.type==="CONTADO"?(xe+=Tt,gt+=Lt):(Se+=Tt,Et+=Lt)}return{ventasTotales:Ae,costoMercaderia:xt,gastosPeriodo:We,gananciaAntes:ct,utilidadBrutaOrdenes:pe,gananciaDespues:_t,abonosRecibidos:Pe,saldosPendientes:Ze,clientesConSaldo:Ee.length,paquetesCash:xe,paquetesCredito:Se,comisionCash:gt,comisionCredito:Et}},[o,A,m,x,xt,it,S]),Mt=g.useMemo(()=>{const Ae={},We={};for(const ct of o)if(!(ct.type!=="CREDITO"||!ct.customerId))for(const _t of ct.items||[]){const pe=Number(_t.qty||0),Pe=Number(_t.unitPrice||0),Ee=pe*Pe,Ze=Math.max(0,Number(_t.discount||0)),xe=Math.max(0,Ee-Ze);Ae[ct.customerId]=(Ae[ct.customerId]||0)+pe,We[ct.customerId]=(We[ct.customerId]||0)+xe}return x.filter(ct=>(ct.balance||0)>0).map(ct=>({customerId:ct.id,name:ct.name,paquetesAsociados:Ae[ct.id]||0,saldoTotal:We[ct.id]||0,saldoPendiente:ct.balance||0})).sort((ct,_t)=>_t.saldoPendiente-ct.saldoPendiente)},[x,o]),Ft=g.useMemo(()=>{const Ae={};return x.forEach(We=>Ae[We.id]=We.name),Ae},[x]),$t=g.useMemo(()=>[...o].sort((Ae,We)=>We.date.localeCompare(Ae.date)).map(Ae=>{var pe;const We=(Ae.items||[]).reduce((Pe,Ee)=>Pe+(Number(Ee.qty)||0),0);let ct="Cash";Ae.type==="CREDITO"&&Ae.customerId?ct=Ft[Ae.customerId]||"":Ae.type==="CONTADO"&&(ct=((pe=Ae.customerName)==null?void 0:pe.trim())||"Cash");const _t=We>0?Ae.total/We:0;return{id:Ae.id,date:Ae.date,type:Ae.type==="CREDITO"?"Crdito":"Cash",customer:ct,paquetes:We,total:Number(Ae.total||0),avgPrice:_t}}),[o,Ft]),kt=g.useMemo(()=>{var We,ct;const Ae=new Map;for(const _t of o){const pe=_t.vendorId||"NO_VENDOR",Pe=_t.vendorName||((We=Xe[pe])==null?void 0:We.name)||"Sin vendedor";Ae.has(pe)||Ae.set(pe,{vendorId:pe,vendorName:Pe,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const Ee=Ae.get(pe);for(const Ze of _t.items||[]){const xe=Number(Ze.qty||0),Se=Number(Ze.unitPrice||0),gt=xe*Se,Et=Math.max(0,Number(Ze.discount||0)),Nt=Math.max(0,gt-Et),Tt=it(_t,Ze);_t.type==="CONTADO"?(Ee.paquetesVendidos+=xe,Ee.totalVendido+=Nt,Ee.comisionCash+=Tt):(Ee.paquetesFiados+=xe,Ee.totalFiado+=Nt,Ee.comisionCredito+=Tt)}}for(const[_t,pe]of Object.entries(B)){const Pe=Ae.get(_t),Ee=(Pe==null?void 0:Pe.vendorName)||((ct=Xe[_t])==null?void 0:ct.name)||"Sin vendedor",Ze=Pe||{vendorId:_t,vendorName:Ee,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};Ze.paquetesAsociados=pe,Ze.paquetesRestantes=Math.max(pe-Ze.paquetesVendidos-Ze.paquetesFiados,0),Ae.set(_t,Ze)}return Array.from(Ae.values()).sort((_t,pe)=>pe.totalVendido+pe.totalFiado-(_t.totalVendido+_t.totalFiado))},[o,B,Xe,it]),Ge=async Ae=>{O(!0),ce({id:Ae.customerId,name:Ae.name}),ue([]),se(!0),Re({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const We=[];let ct=0,_t=0,pe=0;for(const xe of o)if(!(xe.type!=="CREDITO"||xe.customerId!==Ae.customerId))for(const Se of xe.items||[]){const gt=Number(Se.qty||0),Et=Number(Se.unitPrice||0),Nt=gt*Et,Tt=Math.max(0,Number(Se.discount||0)),Lt=Math.max(0,Nt-Tt);We.push({saleId:xe.id,date:xe.date,productName:Se.productName,sku:Se.sku||"",qty:gt,unitPrice:Et,lineTotal:Nt,discount:Tt,lineFinal:Lt}),ct+=Nt,_t+=Tt,pe+=Lt}let Pe=0;for(const xe of m)xe.customerId===Ae.customerId&&(Pe+=Math.abs(xe.amount||0));const Ee=x.find(xe=>xe.id===Ae.customerId),Ze=(Ee==null?void 0:Ee.balance)||0;ue(We),Re({totalBruto:ct,totalDescuento:_t,totalFiado:pe,saldoActual:Ze,abonadoPeriodo:Pe})}catch(We){console.error(We),j(" No se pudo cargar el detalle del cliente.")}finally{se(!1)}},ie=(Ae,We,ct)=>{H(!0),ve(ct),Ye(1);let _t="";ct==="ASSOCIATED"?_t=`Paquetes asociados  ${We}`:ct==="REMAINING"?_t=`Paquetes restantes  ${We}`:ct==="CASH"?_t=`Paquetes vendidos (Cash)  ${We}`:_t=`Paquetes fiados (Crdito)  ${We}`,L(_t),Y([]),Q(!0);try{if(ct==="ASSOCIATED"||ct==="REMAINING"){const Pe=S[Ae],Ee=ct==="ASSOCIATED"?(Pe==null?void 0:Pe.associated)||[]:(Pe==null?void 0:Pe.remaining)||[];Y([...Ee].sort((Ze,xe)=>(xe.qty||0)-(Ze.qty||0))),Q(!1);return}const pe=[];for(const Pe of o)if(((Pe.vendorId||"NO_VENDOR")===Ae||!Pe.vendorId&&Ae==="NO_VENDOR")&&!(ct==="CASH"&&Pe.type!=="CONTADO")&&!(ct==="CREDIT"&&Pe.type!=="CREDITO"))for(const Ze of Pe.items||[]){const xe=Number(Ze.qty||0),Se=Number(Ze.unitPrice||0),gt=xe*Se,Et=Math.max(0,Number(Ze.discount||0)),Nt=Math.max(0,gt-Et),Tt=it(Pe,Ze);pe.push({saleId:Pe.id,date:Pe.date,productName:Ze.productName,sku:Ze.sku||"",qty:xe,unitPrice:Se,lineTotal:gt,discount:Et,lineFinal:Nt,vendorCommissionAmount:Tt,type:ct})}Y(pe.sort((Pe,Ee)=>Pe.date.localeCompare(Ee.date)))}catch(pe){console.error(pe),j(" No se pudo cargar el detalle del vendedor.")}finally{Q(!1)}},Ue=g.useMemo(()=>ee!=="ASSOCIATED"&&ee!=="REMAINING"?1:Math.max(1,Math.ceil(W.length/ae)),[ee,W.length]),Ne=g.useMemo(()=>{if(ee!=="ASSOCIATED"&&ee!=="REMAINING")return W;const Ae=(M-1)*ae;return W.slice(Ae,Ae+ae)},[ee,M,W]),be=ee==="ASSOCIATED"||ee==="REMAINING"?10:8;g.useEffect(()=>{ee!=="ASSOCIATED"&&ee!=="REMAINING"||M>Ue&&Ye(Ue)},[ee,M,Ue]);const Ce=Ae=>{const We=o.find(ct=>ct.id===Ae)||null;$e(We),De(!0)},Le=async Ae=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await G2(Ae),await QQe(Ae),l(We=>We.filter(ct=>ct.id!==Ae)),u(We=>We.filter(ct=>ct.id!==Ae)),De(!1),$e(null)}catch(We){console.error(We),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(Oc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Ae=>n(Ae.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Ae=>s(Ae.target.value)})]})]}),i.jsx("div",{className:"md:hidden mb-4",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",open:!0,children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"KPIs"}),i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:vn(jt.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:vn(jt.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.comisionCredito)})]})]})})]})}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:vn(jt.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:vn(jt.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(jt.comisionCredito)})]})]}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Consolidado clientes y vendedores"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border",children:"Saldo total"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Mt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Mt.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ge({customerId:Ae.customerId,name:Ae.name}),title:"Ver paquetes fiados del periodo",children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:vn(Ae.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:vn(Ae.saldoPendiente)})]},Ae.customerId))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):kt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):kt.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"ASSOCIATED"),children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"REMAINING"),children:Ae.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"CASH"),children:Ae.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"CREDIT"),children:Ae.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.comisionCredito)})]},Ae.vendorId))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Mt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Mt.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ge({customerId:Ae.customerId,name:Ae.name}),title:"Ver paquetes fiados del periodo",children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:vn(Ae.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:vn(Ae.saldoPendiente)})]},Ae.customerId))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):kt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):kt.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"ASSOCIATED"),children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"REMAINING"),children:Ae.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"CASH"),children:Ae.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ie(Ae.vendorId,Ae.vendorName,"CREDIT"),children:Ae.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.comisionCredito)})]},Ae.vendorId))})]})}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Transacciones y gastos"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):$t.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):$t.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ce(Ae.id),children:Ae.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>Le(Ae.id),children:"Eliminar"})})]},Ae.id))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((Ae,We)=>Ae.date.localeCompare(We.date)).map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.category||""}),i.jsx("td",{className:"p-2 border",children:Ae.description?i.jsx("span",{title:Ae.description,children:Ae.description.length>40?Ae.description.slice(0,40)+"":Ae.description}):""}),i.jsx("td",{className:"p-2 border",children:vn(Ae.amount)}),i.jsx("td",{className:"p-2 border",children:Ae.status||""})]},Ae.id))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):$t.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):$t.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ce(Ae.id),children:Ae.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:vn(Ae.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>Le(Ae.id),children:"Eliminar"})})]},Ae.id))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((Ae,We)=>Ae.date.localeCompare(We.date)).map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.category||""}),i.jsx("td",{className:"p-2 border",children:Ae.description?i.jsx("span",{title:Ae.description,children:Ae.description.length>40?Ae.description.slice(0,40)+"":Ae.description}):""}),i.jsx("td",{className:"p-2 border",children:vn(Ae.amount)}),i.jsx("td",{className:"p-2 border",children:Ae.status||""})]},Ae.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(z==null?void 0:z.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>O(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(ke.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(ke.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(ke.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(ke.abonadoPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:vn(ke.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:me?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):de.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):de.sort((Ae,We)=>Ae.date.localeCompare(We.date)).map((Ae,We)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.productName}),i.jsx("td",{className:"p-2 border",children:Ae.qty}),i.jsx("td",{className:"p-2 border",children:vn(Ae.unitPrice)}),i.jsx("td",{className:"p-2 border",children:vn(Ae.lineTotal)}),i.jsx("td",{className:"p-2 border",children:vn(Ae.discount)}),i.jsx("td",{className:"p-2 border",children:vn(Ae.lineFinal)})]},`${Ae.saleId}-${We}`))})]})})]})}),F&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:K}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>H(!1),children:"Cerrar"})]}),(ee==="ASSOCIATED"||ee==="REMAINING")&&!D&&i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2 text-sm",children:[i.jsxs("div",{className:"text-gray-600",children:["Pgina ",M," de ",Ue]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Ye(Ae=>Math.max(1,Ae-1)),disabled:M<=1,children:"Anterior"}),i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Ye(Ae=>Math.min(Ue,Ae+1)),disabled:M>=Ue,children:"Siguiente"})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha Orden"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),ee==="ASSOCIATED"||ee==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Costo"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]}):i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),ee==="ASSOCIATED"||ee==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Utilidad vendedor"})]}):i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:D?i.jsx("tr",{children:i.jsx("td",{colSpan:be,className:"p-4 text-center",children:"Cargando"})}):W.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:be,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):Ne.map((Ae,We)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.productName}),i.jsx("td",{className:"p-2 border",children:Ae.qty}),i.jsx("td",{className:"p-2 border",children:vn(Ae.unitPrice)}),ee==="ASSOCIATED"||ee==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:vn(Ae.costTotal??0)}),i.jsx("td",{className:"p-2 border",children:vn(Ae.lineTotal)})]}):i.jsx("td",{className:"p-2 border",children:vn(Ae.lineTotal)}),i.jsx("td",{className:"p-2 border",children:vn(Ae.discount)}),i.jsx("td",{className:"p-2 border",children:vn(Ae.lineFinal)}),ee==="ASSOCIATED"||ee==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:vn(Ae.grossProfit||0)}),i.jsx("td",{className:"p-2 border",children:vn(Ae.vendorCommissionAmount)})]}):i.jsx("td",{className:"p-2 border",children:vn(Ae.vendorCommissionAmount)})]},`${Ae.saleId}-${We}`))})]})})]})}),X&&le&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",le.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>De(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(le.items||[]).map((Ae,We)=>{const ct=Number(Ae.qty||0),_t=Number(Ae.unitPrice||0),pe=ct*_t,Pe=it(le,Ae);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.productName}),i.jsx("td",{className:"p-2 border",children:ct}),i.jsx("td",{className:"p-2 border",children:vn(_t)}),i.jsx("td",{className:"p-2 border",children:vn(pe)}),i.jsx("td",{className:"p-2 border",children:vn(Pe)})]},We)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),vn(le.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>Le(le.id),children:"Eliminar venta"})]})]})})]})}const cG=["Rivas","Isla Ometepe","San Jorge"];function HQe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState("0"),[m,p]=g.useState("Rivas"),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,j]=g.useState("0"),[I,_]=g.useState("Rivas");g.useEffect(()=>{(async()=>{s(!0),l("");try{const z=sr(yt(Ie,"sellers_candies"),In("name","asc")),ce=await Ht(z),de=[];ce.forEach(ue=>{const me=ue.data();de.push({id:ue.id,name:me.name||"",commissionPercent:Number(me.commissionPercent||0),branch:me.branch||"Rivas",createdAt:me.createdAt||vr.now()})}),n(de)}catch(z){console.error(z),l(" Error cargando vendedores.")}finally{s(!1)}})()},[t]);const S=()=>{f(""),h("0"),p("Rivas")},E=async z=>{z.preventDefault(),l("");const ce=d.trim();if(!ce){l("Ingresa el nombre y apellido del vendedor.");return}const de=Number(A||0);if(de<0){l("El margen no puede ser negativo.");return}try{const ue={name:ce,commissionPercent:de,branch:m,createdAt:vr.now()},me=await Jn(yt(Ie,"sellers_candies"),ue);n(se=>[{id:me.id,...ue},...se]),l(" Vendedor creado correctamente."),S(),u(!1)}catch(ue){console.error(ue),l(" Error al crear el vendedor.")}},B=z=>{v(z.id),b(z.name),j(z.commissionPercent.toString()),_(z.branch)},T=()=>{v(null),b(""),j("0"),_("Rivas")},P=async()=>{if(!x)return;l("");const z=y.trim();if(!z){l("El nombre y apellido no pueden estar vacos.");return}const ce=Number(w||0);if(ce<0){l("El margen no puede ser negativo.");return}try{await Fn(Zt(Ie,"sellers_candies",x),{name:z,commissionPercent:ce,branch:I}),n(de=>de.map(ue=>ue.id===x?{...ue,name:z,commissionPercent:ce,branch:I}:ue)),l(" Vendedor actualizado."),T()}catch(de){console.error(de),l(" Error al actualizar el vendedor.")}},O=async z=>{if(window.confirm(`Eliminar al vendedor "${z.name}"? Esta accin no se puede deshacer.`))try{await Kn(Zt(Ie,"sellers_candies",z.id)),n(de=>de.filter(ue=>ue.id!==z.id)),l(" Vendedor eliminado.")}catch(de){console.error(de),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Oc,{onClick:e,loading:a}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>u(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:z=>f(z.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Margen del vendedor (% sobre U Aproximada)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:A,onChange:z=>h(z.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje YA NO es comisin sobre venta. Se aplica as: U. Vendedor = U. Aproximada  (margen/100). U. Inversionista = U. Aproximada  U. Vendedor."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:z=>p(z.target.value),children:cG.map(z=>i.jsx("option",{value:z,children:z},z))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{S(),u(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Margen (% U Aproximada)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(z=>{const ce=x===z.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:ce?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:de=>b(de.target.value)}):z.name}),i.jsx("td",{className:"p-2 border",children:ce?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:w,onChange:de=>j(de.target.value)}):`${z.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:ce?i.jsx("select",{className:"border p-1 rounded text-xs",value:I,onChange:de=>_(de.target.value),children:cG.map(de=>i.jsx("option",{value:de,children:de},de))}):z.branch}),i.jsx("td",{className:"p-2 border",children:ce?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:P,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:T,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>B(z),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>O(z),children:"Borrar"})]})})]},z.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const la=t=>Math.max(0,Math.floor(Number(t||0)));function K2(t){return Math.max(1,la(t.unitsPerPackage||1))}function uG(t){const e=Number(t.remaining);if(Number.isFinite(e)&&e>0)return Math.floor(e);const r=Number(t.remainingPackages??t.remainingPacks??t.packagesRemaining??0);if(Number.isFinite(r)&&r>0){const l=K2(t);return Math.floor(r*l)}const n=K2(t),a=Number(t.totalUnits||0),s=Number(t.quantity||0),o=Number(t.packages||0);return a>0?Math.floor(a):s>0?Math.floor(s):o>0?Math.floor(o*n):0}async function $Qe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);const n=!!t.deleteVendorAfter;if(!e||r<=0)return{restoredPackages:0,mode:"noop"};const a=sr(yt(Ie,"inventory_transfers_candies"),mr("toVendorRowId","==",e)),s=await Ht(a);if(s.empty)return{restoredPackages:0,mode:"noop"};const o=s.docs.map(f=>({id:f.id,...f.data()})).filter(f=>String(f.fromVendorRowId||"").trim()!=="").sort((f,A)=>{var p,x;const h=Number(((p=f.createdAt)==null?void 0:p.seconds)??0);return Number(((x=A.createdAt)==null?void 0:x.seconds)??0)-h});if(!o.length)return{restoredPackages:0,mode:"noop"};const l=[];let c=r;for(const f of o){if(c<=0)break;const A=la(f.packagesMoved||0);if(A<=0)continue;const h=Math.min(c,A);h<=0||(l.push({fromVendorRowId:String(f.fromVendorRowId),packs:h}),c-=h)}if(!l.length)return{restoredPackages:0,mode:"noop"};const u=Zt(Ie,"inventory_candies_sellers",e),d=l.map(f=>Zt(Ie,"inventory_candies_sellers",f.fromVendorRowId));return await Gs(Ie,async f=>{const A=await Promise.all(d.map(h=>f.get(h)));for(let h=0;h<l.length;h++){const m=d[h],p=A[h];if(!p.exists())continue;const x=p.data(),v=la(l[h].packs||0);if(v<=0)continue;const y=Math.max(1,la(x.unitsPerPackage||1)),b=v*y,w=Number(x.remainingPackages||0),j=Number(x.packages||0);f.update(m,{packages:Math.max(0,j+v),remainingPackages:Math.max(0,w+v),...y>0?{remainingUnits:Number(x.remainingUnits||0)+b}:{},transferDelta:Number(x.transferDelta||0)+v,updatedAt:vr.now()})}n&&f.delete(u)}),{restoredPackages:r-c,mode:"transfer"}}async function gF(t){const{orderId:e,productId:r}=t;let n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=sr(yt(Ie,"inventory_candies"),mr("orderId","==",e),mr("productId","==",r),In("createdAt","asc")),s=await Ht(a);if(s.empty)return;const o=s.docs.map(l=>l.ref);await Gs(Ie,async l=>{const c=await Promise.all(o.map(u=>l.get(u)));for(let u=0;u<o.length&&n>0;u++){const d=c[u];if(!d.exists())continue;const f=d.data(),A=K2(f),h=n*A,p=la(f.remaining??0)+h,x=Math.floor(p/A);l.update(o[u],{remaining:p,remainingPackages:x,packages:x,updatedAt:vr.now()}),n=0}})}async function xF(t){const{orderId:e,productId:r}=t,n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=Zt(Ie,"candy_main_orders",e);await Gs(Ie,async s=>{const o=await s.get(a);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let u=!1;const d=c.map(f=>String((f==null?void 0:f.id)||"")!==String(r)?f:(u=!0,{...f,remainingPackages:la(f.remainingPackages)+n}));u&&s.update(a,{items:d,updatedAt:vr.now()})})}function vF(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),a=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),s=la((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,la((r==null?void 0:r.unitsPerPackage)||1));!n||!a||s<=0||e.push({batchId:n,masterOrderId:a,units:s,unitsPerPackage:o})}return e}function q2(t,e){const r=la(t),n=Math.max(1,la(e));return Math.floor(r/n)}async function dG(t){const e=String(t.productId||"");let r=la(t.packagesToAllocate);if(!e||r<=0)return{allocations:[]};const n=sr(yt(Ie,"inventory_candies"),mr("productId","==",e)),a=await Ht(n);if(a.empty)throw new Error("No hay inventario para este producto.");const o=a.docs.map(c=>({id:c.id,data:c.data()})).sort((c,u)=>{var m,p;const d=String(c.data.date||""),f=String(u.data.date||"");if(d!==f)return d<f?-1:1;const A=((m=c.data.createdAt)==null?void 0:m.seconds)??0,h=((p=u.data.createdAt)==null?void 0:p.seconds)??0;return A-h}).map(c=>Zt(Ie,"inventory_candies",c.id)),l=[];return await Gs(Ie,async c=>{const u=await Promise.all(o.map(y=>c.get(y))),d=[];let f=r;for(let y=0;y<o.length&&f>0;y++){const b=o[y],w=u[y];if(!w.exists())continue;const j=w.data(),I=K2(j),_=uG(j);if(_<=0)continue;const S=Math.floor(_/I);if(S<=0)continue;const E=Math.min(S,f),B=E*I,T=Math.max(0,_-B),P=Math.floor(T/I),O=String(j.orderId||"");if(!O)throw new Error("Lote sin orderId (orden maestra).");l.push({batchId:b.id,masterOrderId:O,units:B,unitsPerPackage:I}),d.push({ref:b,newRemUnits:T,newRemPacks:P}),f-=E}if(f>0)throw new Error(`Inventario insuficiente. Faltan ${f} paquetes.`);const A={};for(const y of l){const b=q2(y.units,y.unitsPerPackage);A[y.masterOrderId]=(A[y.masterOrderId]||0)+b}const h=new Map;for(let y=0;y<d.length;y++){const b=d[y];h.set(b.ref.id,b.newRemUnits)}const m={};for(let y=0;y<o.length;y++){const b=o[y],w=u[y];if(!w.exists())continue;const j=w.data(),I=String(j.orderId||""),_=String(j.productId||"");if(!I||!_)continue;const S=K2(j),E=h.get(b.id),B=typeof E=="number"?E:uG(j),T=Math.floor(B/S);m[I]||(m[I]={}),m[I][_]=(m[I][_]||0)+Math.max(0,T)}const p=Object.keys(A),x=p.map(y=>Zt(Ie,"candy_main_orders",y)),v=await Promise.all(x.map(y=>c.get(y)));for(let y=0;y<d.length;y++){const b=d[y];c.update(b.ref,{remaining:b.newRemUnits,remainingPackages:b.newRemPacks,packages:b.newRemPacks,updatedAt:vr.now()})}for(let y=0;y<x.length;y++){const b=v[y];if(!b.exists())throw new Error("Orden maestra no existe.");const w=b.data(),j=Array.isArray(w.items)?w.items:[],I=p[y];if(la(A[I]||0)<=0)continue;let S=!1;const E=j.map(B=>{var P;if(String((B==null?void 0:B.id)||"")!==e)return B;S=!0;const T=((P=m[I])==null?void 0:P[e])??la(B.remainingPackages||0);return{...B,remainingPackages:Math.max(0,la(T||0))}});S&&c.update(x[y],{items:E,updatedAt:vr.now()})}}),{allocations:l}}async function GQe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);if(!e)throw new Error("vendorInventoryId requerido");if(r<=0)return{restoredPackages:0,mode:"noop"};const n=Zt(Ie,"inventory_candies_sellers",e),a=await zs(n);if(!a.exists())throw new Error("No existe la orden del vendedor");const s=a.data(),o=String(s.productId||"");if(!o)throw new Error("La orden del vendedor no tiene productId");if(!vF(s.masterAllocations||s.allocations||s.allocationsByBatch).length){const u=String(s.orderId||"");if(!u)throw new Error("La orden del vendedor no tiene orderId");return await gF({orderId:u,productId:o,packagesToReturn:r}),await xF({orderId:u,productId:o,packagesToReturn:r}),{restoredPackages:r,mode:"legacy"}}let c=0;return await Gs(Ie,async u=>{const d=await u.get(n);if(!d.exists())throw new Error("No existe la orden del vendedor");const f=d.data(),A=String(f.productId||"");if(!A)throw new Error("Doc vendedor sin productId");let h=vF(f.masterAllocations||f.allocations||f.allocationsByBatch);if(!h.length)throw new Error("No hay masterAllocations guardadas en este doc (no se puede restaurar blindado).");const m=[];let p=r;for(let E=h.length-1;E>=0&&p>0;E--){const B=h[E],T=Math.max(1,la(B.unitsPerPackage||1)),P=q2(B.units,T);if(P<=0)continue;const O=Math.min(P,p),z=O*T;m.push({batchId:B.batchId,masterOrderId:B.masterOrderId,units:z,unitsPerPackage:T}),p-=O}const x=r-p;if(x<=0)return;c=x;const v=m.map(E=>Zt(Ie,"inventory_candies",E.batchId)),y={};for(const E of m){const B=q2(E.units,E.unitsPerPackage);B>0&&(y[E.masterOrderId]=(y[E.masterOrderId]||0)+B)}const w=Object.keys(y).map(E=>Zt(Ie,"candy_main_orders",E)),[j,I]=await Promise.all([Promise.all(v.map(E=>u.get(E))),Promise.all(w.map(E=>u.get(E)))]);for(let E=0;E<m.length;E++){const B=m[E],T=j[E];if(!T.exists())continue;const P=T.data(),O=Math.max(1,la(B.unitsPerPackage||P.unitsPerPackage||1)),z=la(B.units),de=la(P.remaining??0)+z,ue=Math.floor(de/O);u.update(v[E],{remaining:de,remainingPackages:ue,packages:ue,updatedAt:vr.now()})}for(let E=0;E<w.length;E++){const B=I[E];if(!B.exists())continue;const T=w[E].id,P=la(y[T]||0);if(P<=0)continue;const O=B.data(),z=Array.isArray(O.items)?O.items:[];let ce=!1;const de=z.map(ue=>String((ue==null?void 0:ue.id)||"")!==String(A)?ue:(ce=!0,{...ue,remainingPackages:la(ue.remainingPackages)+P}));ce&&u.update(w[E],{items:de,updatedAt:vr.now()})}const _=new Map;for(const E of m){const B=`${E.batchId}__${E.masterOrderId}__${E.unitsPerPackage}`;_.set(B,(_.get(B)||0)+la(E.units))}const S=[];for(const E of h){const B=Math.max(1,la(E.unitsPerPackage||1)),T=`${E.batchId}__${E.masterOrderId}__${B}`,P=la(_.get(T)||0);if(P<=0){S.push(E);continue}const z=la(E.units)-P;z>0&&S.push({...E,units:z,unitsPerPackage:B}),_.delete(T)}u.update(n,{masterAllocations:S,updatedAt:vr.now()})}),{restoredPackages:c,mode:"blind"}}async function fG(t){if(!t)throw new Error("vendorInventoryId requerido");const e=Zt(Ie,"inventory_candies_sellers",t),r=await zs(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),a=String(n.productId||""),s=la(n.remainingPackages||n.packages||0),o=la(n.packages||n.remainingPackages||0),l=vF(n.masterAllocations||n.allocations||n.allocationsByBatch),c=await $Qe({vendorInventoryId:t,packagesToReturn:s,deleteVendorAfter:!1});if(!l.length){const d=String(n.orderId||"");if(!d)throw new Error("La orden del vendedor no tiene orderId");if(!a)throw new Error("La orden del vendedor no tiene productId");if(c.restoredPackages>0){const f=Math.max(0,s-c.restoredPackages);return f<=0?(await Gs(Ie,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages,mode:"transfer"}):(await gF({orderId:d,productId:a,packagesToReturn:f}),await xF({orderId:d,productId:a,packagesToReturn:f}),await Gs(Ie,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages+f,mode:"transfer+legacy"})}return o<=0?(await Gs(Ie,async f=>{f.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await gF({orderId:d,productId:a,packagesToReturn:o}),await xF({orderId:d,productId:a,packagesToReturn:o}),await Gs(Ie,async f=>{f.delete(e)}),{restoredPackages:o,mode:"legacy"})}let u=0;return await Gs(Ie,async d=>{const f={};for(const y of l){const b=Math.max(1,la(y.unitsPerPackage||1)),w=la(y.units),j=q2(w,b);j>0&&(f[y.masterOrderId]=(f[y.masterOrderId]||0)+j)}const A=l.map(y=>Zt(Ie,"inventory_candies",y.batchId)),m=Object.keys(f).map(y=>Zt(Ie,"candy_main_orders",y)),[p,x]=await Promise.all([Promise.all(A.map(y=>d.get(y))),Promise.all(m.map(y=>d.get(y)))]);let v=0;for(let y=0;y<l.length;y++){const b=l[y],w=p[y];if(!w.exists())continue;const j=w.data(),I=Math.max(1,la(b.unitsPerPackage||j.unitsPerPackage||1)),_=la(b.units),E=la(j.remaining??0)+_,B=Math.floor(E/I);d.update(A[y],{remaining:E,remainingPackages:B,packages:B,updatedAt:vr.now()});const T=q2(_,I);T>0&&(v+=T)}for(let y=0;y<m.length;y++){const b=x[y];if(!b.exists())continue;const w=m[y].id,j=la(f[w]||0);if(j<=0)continue;const I=b.data(),_=Array.isArray(I.items)?I.items:[];let S=!1;const E=_.map(B=>String((B==null?void 0:B.id)||"")!==String(a)?B:(S=!0,{...B,remainingPackages:la(B.remainingPackages)+j}));S&&d.update(m[y],{items:E,updatedAt:vr.now()})}d.delete(e),u=v}),{restoredPackages:u,mode:"blind"}}const nB=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Rse=(t,e)=>`${t}__${e}`,KQe=t=>t?typeof t=="string"?t:t!=null&&t.seconds?new Date(t.seconds*1e3).toISOString().slice(0,10):t!=null&&t.toDate?t.toDate().toISOString().slice(0,10):"":"",qQe=t=>{const e=t.sellerId||"",r=KQe(t.date);return e&&r?Rse(e,r):t.orderId?t.orderId:t.id},hG=(t,e=!1)=>{if(!t)return null;const r=new Date(t);return Number.isNaN(r.getTime())?null:(e?r.setHours(23,59,59,999):r.setHours(0,0,0,0),r)},zQe=t=>{var e,r;if((e=t.createdAt)!=null&&e.toDate)return t.createdAt.toDate();if((r=t.createdAt)!=null&&r.seconds)return new Date(t.createdAt.seconds*1e3);if(t.date){const n=new Date(t.date);if(!Number.isNaN(n.getTime()))return n}return null},AG=t=>{const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"},yF=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},mG=(t,e)=>{const r=yF(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}},pG=(t,e)=>e?e==="RIVAS"?t.unitPriceRivas||0:e==="SAN_JORGE"?t.unitPriceSanJorge||0:t.unitPriceIsla||0:t.unitPriceIsla||0,gG=(t,e)=>e?e==="RIVAS"?t.grossProfitPerPackRivas||0:e==="SAN_JORGE"?t.grossProfitPerPackSanJorge||0:t.grossProfitPerPackIsla||0:t.grossProfitPerPackIsla||0,xG=(t,e)=>e?e==="RIVAS"?t.uApproxPerPackRivas||0:e==="SAN_JORGE"?t.uApproxPerPackSanJorge||0:t.uApproxPerPackIsla||0:t.uApproxPerPackIsla||0;function WQe({open:t,onClose:e,orders:r,rows:n,setRows:a,isAdmin:s,currentUserEmail:o,currentUserName:l,sellerCandyId:c,sellers:u,products:d,transferAgg:f,setTransferAgg:A,setTransferRowDeltas:h}){const[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState(""),[w,j]=g.useState(""),[I,_]=g.useState(""),[S,E]=g.useState(""),[B,T]=g.useState("0"),[P,O]=g.useState(""),[z,ce]=g.useState(!1),[de,ue]=g.useState(""),[me,se]=g.useState(!1),[ke,Re]=g.useState(""),[F,H]=g.useState(()=>new Date().toISOString().slice(0,10)),[K,L]=g.useState(""),[W,Y]=g.useState(()=>{const ie=new Date;return new Date(ie.getFullYear(),ie.getMonth(),1).toISOString().slice(0,10)}),[D,Q]=g.useState(()=>new Date().toISOString().slice(0,10)),ee=g.useMemo(()=>{const ie={};return u.forEach(Ue=>{ie[Ue.id]=Ue}),ie},[u]),ve=g.useMemo(()=>{const ie={};return d.forEach(Ue=>{ie[Ue.id]=Ue}),ie},[d]),M=ke&&ee[ke]||null,Ye=g.useMemo(()=>r.map(ie=>ie.orderKey),[r]),ae=g.useMemo(()=>{const ie={};return r.forEach(Ue=>ie[Ue.orderKey]=Ue),ie},[r]),X=n,De=g.useMemo(()=>{const ie={};return X.forEach(Ue=>{const Ne=qQe(Ue),be=new Set;Ne&&be.add(Ne),Ue.orderId&&be.add(String(Ue.orderId)),be.add(Ue.id),be.forEach(Ce=>{ie[Ce]||(ie[Ce]=[]),ie[Ce].push(Ue)})}),ie},[X]),le=g.useMemo(()=>y?De[y]||[]:[],[De,y]),$e=g.useMemo(()=>le.filter(ie=>{const Ue=ie.remainingPackages??ie.remaining??ie.packages??0;return Number(Ue||0)>0}),[le]),Xe=g.useMemo(()=>{const ie=K.trim().toLowerCase();return ie?$e.filter(Ue=>`${Ue.category||""} ${Ue.productName||""}`.toLowerCase().trim().includes(ie)):$e},[$e,K]),it=g.useMemo(()=>w&&X.find(ie=>ie.id===w)||null,[X,w]),xt=g.useMemo(()=>{if(it!=null&&it.sellerId)return it.sellerId;const ie=ae[y];return(ie==null?void 0:ie.sellerId)||""},[it,ae,y]),jt=g.useMemo(()=>I?De[I]||[]:[],[De,I]),Mt=g.useMemo(()=>it?jt.filter(ie=>ie.productId===it.productId):[],[jt,it]),Ft=async()=>{try{p(!0);let ie=[];if(!s&&c){const Ue=sr(yt(Ie,"inventory_transfers_candies"),mr("fromSellerId","==",c),In("createdAt","desc")),Ne=sr(yt(Ie,"inventory_transfers_candies"),mr("toSellerId","==",c),In("createdAt","desc")),[be,Ce]=await Promise.all([Ht(Ue),Ht(Ne)]),Le=new Set,Ae=We=>{We.forEach(ct=>{if(Le.has(ct.id))return;Le.add(ct.id);const _t=ct.data();ie.push({id:ct.id,..._t})})};Ae(be),Ae(Ce),ie.sort((We,ct)=>{var Pe,Ee;const _t=((Pe=We.createdAt)==null?void 0:Pe.seconds)||0;return(((Ee=ct.createdAt)==null?void 0:Ee.seconds)||0)-_t})}else{const Ue=sr(yt(Ie,"inventory_transfers_candies"),In("createdAt","desc"));(await Ht(Ue)).forEach(be=>{const Ce=be.data();ie.push({id:be.id,...Ce})})}v(ie)}catch{ue(" Error cargando traslados.")}finally{p(!1)}};g.useEffect(()=>{t&&Ft()},[t]);const $t=g.useMemo(()=>{const ie=hG(W),Ue=hG(D,!0);return x.filter(Ne=>{const be=zQe(Ne);return be?!(ie&&be<ie||Ue&&be>Ue):!0})},[x,W,D]);g.useEffect(()=>{L("")},[y]),g.useEffect(()=>{if(me){if(!ke){const ie=ae[y];ie!=null&&ie.sellerId&&Re(ie.sellerId)}F||H(new Date().toISOString().slice(0,10))}},[me,ke,F,ae,y]);const kt=()=>{b(""),j(""),_(""),E(""),T("0"),O(""),se(!1),Re(""),H(new Date().toISOString().slice(0,10))},Ge=async()=>{if(!s){ue("No tienes permiso para hacer traslados.");return}ue("");const ie=Number(B||0);if(!(ie>0)){ue("La cantidad de paquetes debe ser mayor a 0.");return}if(!P.trim()){ue("Debes escribir el motivo de la movida.");return}if(!y||!w){ue("Selecciona el pedido origen y el producto.");return}const Ue=me;if(!Ue&&!I){ue("Selecciona el pedido destino.");return}if(Ue){if(!ke){ue("Selecciona el vendedor de la nueva orden.");return}if(!F){ue("Selecciona la fecha de la nueva orden.");return}}const Ne=!Ue&&I&&ae[I]||null;if(!Ue&&!Ne){ue("Selecciona un pedido destino vlido.");return}const be=Ne?ee[Ne.sellerId]||{id:Ne.sellerId||"",name:Ne.sellerName||"",email:Ne.sellerEmail||"",branch:Ne.branch,branchLabel:Ne.branchLabel,commissionPercent:Ne.vendorMarginPercent??Ne.commissionPercent??0}:null,Ce=n.find(xe=>xe.id===w)||null,Le=!Ue&&S&&n.find(xe=>xe.id===S)||null;if(!Ce){ue("No se encontr la fila origen/destino.");return}if(!Ue&&Le&&w===S){ue("Origen y destino no pueden ser el mismo.");return}if(!Ue&&Le&&Ce.productId!==Le.productId){ue("El producto destino no coincide con el producto origen.");return}if(Number(Ce.remainingPackages||0)<ie){ue("El origen no tiene suficientes paquetes disponibles.");return}const Ae=Ue?M:null;if(Ue&&!Ae){ue("Selecciona un vendedor destino vlido.");return}const We=ve[Ce.productId]||null,ct=Ue?AG((Ae==null?void 0:Ae.branch)||(Ae==null?void 0:Ae.branchLabel)):void 0,_t=!Ue&&!S&&!!Ne,pe=Ue||_t;let Pe=null,Ee=null,Ze="";if(Ue&&Ae){const xe=yF(Ae.commissionPercent??0),Se=ct,gt=Number((We==null?void 0:We.unitsPerPackage)??Ce.unitsPerPackage??0),Et=gt>0?gt*ie:0;We?pG(We,Se):Number(Ce.unitPriceRivas||Ce.unitPriceIsla||0);const Tt=(We?gG(We,Se):Number(Ce.grossProfit||0)/Math.max(1,Ce.packages||1))*ie,Lt=We?Number(We.logisticAllocatedPerPack||0)*ie:Number(Ce.logisticAllocated||0),_e=(We?xG(We,Se):Number(Ce.uAproximada||0)/Math.max(1,Ce.packages||1))*ie,U=mG(Tt,xe),ye=Number(Tt||0)-Number(Lt||0)-Number(U.uVendor||0),te=((We==null?void 0:We.unitPriceRivas)||Ce.unitPriceRivas||0)*ie,Ve=((We==null?void 0:We.unitPriceSanJorge)||Ce.unitPriceSanJorge||0)*ie,qe=((We==null?void 0:We.unitPriceIsla)||Ce.unitPriceIsla||0)*ie;Ze=Rse(Ae.id,F),Pe={sellerId:Ae.id,sellerName:Ae.name,sellerEmail:Ae.email||"",branch:Se||"",branchLabel:Ae.branchLabel||"",productId:Ce.productId,productName:Ce.productName,category:Ce.category,orderId:Ze,date:F,packages:ie,unitsPerPackage:gt,totalUnits:Et,remainingPackages:ie,remainingUnits:Et,totalRivas:te,totalSanJorge:Ve,totalIsla:qe,unitPriceRivas:(We==null?void 0:We.unitPriceRivas)||Ce.unitPriceRivas||0,unitPriceSanJorge:(We==null?void 0:We.unitPriceSanJorge)||Ce.unitPriceSanJorge||0,unitPriceIsla:(We==null?void 0:We.unitPriceIsla)||Ce.unitPriceIsla||0,grossProfit:Tt,logisticAllocated:Lt,vendorMarginPercent:U.vendorMarginPercent,uVendor:U.uVendor,uInvestor:U.uInvestor,uAproximada:_e,uNeta:ye,providerPrice:Ce.providerPrice,transferDelta:0}}if(_t&&Ne){const xe=yF((be==null?void 0:be.commissionPercent)??Ne.vendorMarginPercent??0),Se=AG((be==null?void 0:be.branch)||(be==null?void 0:be.branchLabel)||Ne.branch||Ne.branchLabel),gt=Number((We==null?void 0:We.unitsPerPackage)??Ce.unitsPerPackage??0),Et=gt>0?gt*ie:0;We?pG(We,Se):Number(Ce.unitPriceRivas||Ce.unitPriceIsla||0);const Tt=(We?gG(We,Se):Number(Ce.grossProfit||0)/Math.max(1,Ce.packages||1))*ie,Lt=We?Number(We.logisticAllocatedPerPack||0)*ie:Number(Ce.logisticAllocated||0),_e=(We?xG(We,Se):Number(Ce.uAproximada||0)/Math.max(1,Ce.packages||1))*ie,U=mG(Tt,xe),ye=Number(Tt||0)-Number(Lt||0)-Number(U.uVendor||0),te=((We==null?void 0:We.unitPriceRivas)||Ce.unitPriceRivas||0)*ie,Ve=((We==null?void 0:We.unitPriceSanJorge)||Ce.unitPriceSanJorge||0)*ie,qe=((We==null?void 0:We.unitPriceIsla)||Ce.unitPriceIsla||0)*ie;Ee={sellerId:Ne.sellerId,sellerName:(be==null?void 0:be.name)||Ne.sellerName||"",sellerEmail:(be==null?void 0:be.email)||Ne.sellerEmail||"",branch:Se||Ne.branch||"",branchLabel:(be==null?void 0:be.branchLabel)||Ne.branchLabel||"",productId:Ce.productId,productName:Ce.productName,category:Ce.category,orderId:Ne.orderKey||I,date:Ne.date||new Date().toISOString().slice(0,10),packages:ie,unitsPerPackage:gt,totalUnits:Et,remainingPackages:ie,remainingUnits:Et,totalRivas:te,totalSanJorge:Ve,totalIsla:qe,unitPriceRivas:(We==null?void 0:We.unitPriceRivas)||Ce.unitPriceRivas||0,unitPriceSanJorge:(We==null?void 0:We.unitPriceSanJorge)||Ce.unitPriceSanJorge||0,unitPriceIsla:(We==null?void 0:We.unitPriceIsla)||Ce.unitPriceIsla||0,grossProfit:Tt,logisticAllocated:Lt,vendorMarginPercent:U.vendorMarginPercent,uVendor:U.uVendor,uInvestor:U.uInvestor,uAproximada:_e,uNeta:ye,providerPrice:Ce.providerPrice,transferDelta:0}}try{ce(!0);const xe=Zt(Ie,"inventory_candies_sellers",Ce.id),Se=Ue||_t?Zt(yt(Ie,"inventory_candies_sellers")):Zt(Ie,"inventory_candies_sellers",Le.id),gt=vr.now(),Et=new Date().toISOString().slice(0,10);let Nt=null;await Gs(Ie,async Tt=>{const Lt=await Tt.get(xe);if(!Lt.exists())throw new Error("Orden origen no existe.");const Me=Lt.data(),_e=Number(Me.remainingPackages||0);if(_e<ie)throw new Error("Origen no tiene suficientes paquetes.");let U=null;if(!Ue&&!_t){const V=await Tt.get(Se);if(!V.exists())throw new Error("Orden destino no existe.");U=V.data()}const ye=Number(Me.unitsPerPackage||Ce.unitsPerPackage||0),te=ye>0?ie*ye:0,Ve=Number(Me.transferDelta||0);Tt.update(xe,{packages:Math.max(0,Number(Me.packages||0)-ie),remainingPackages:_e-ie,...ye>0?{remainingUnits:Number(Me.remainingUnits||0)-te}:{},updatedAt:gt,transferDelta:Ve-ie});let qe=null;if(Ue){const V={...Pe,createdAt:gt,updatedAt:gt,remainingPackages:ie,remainingUnits:Number((Pe==null?void 0:Pe.unitsPerPackage)||0)>0?ie*Number((Pe==null?void 0:Pe.unitsPerPackage)||0):Pe==null?void 0:Pe.remainingUnits,transferDelta:0};Tt.set(Se,V),qe=V,Nt={id:Se.id,...V}}else if(_t&&Ee){const V={...Ee,createdAt:gt,updatedAt:gt,remainingPackages:ie,remainingUnits:Number(Ee.unitsPerPackage||0)>0?ie*Number(Ee.unitsPerPackage||0):Ee.remainingUnits,transferDelta:0};Tt.set(Se,V),qe=V,Nt={id:Se.id,...V}}else{const V=U,Z=Number(V.unitsPerPackage||Ce.unitsPerPackage||0),re=Z>0?ie*Z:0,we=Number(V.transferDelta||0);Tt.update(Se,{packages:Math.max(0,Number(V.packages||0)+ie),remainingPackages:Number(V.remainingPackages||0)+ie,...Z>0?{remainingUnits:Number(V.remainingUnits||0)+re}:{},updatedAt:gt,transferDelta:we+ie}),qe={...V,remainingPackages:Number(V.remainingPackages||0)+ie,remainingUnits:Z>0?Number(V.remainingUnits||0)+re:V.remainingUnits,sellerId:V.sellerId,sellerName:V.sellerName,orderId:V.orderId||(Le==null?void 0:Le.id)||"",transferDelta:we+ie}}const G=Zt(yt(Ie,"inventory_transfers_candies"));Tt.set(G,{createdAt:gt,date:Et,createdByEmail:(o||"").trim(),createdByName:String(l||"").trim(),productId:String(Me.productId||""),productName:String(Me.productName||""),packagesMoved:ie,providerPrice:Number(Me.providerPrice||0),unitPriceRivas:Number(Me.unitPriceRivas||0),unitPriceIsla:Number(Me.unitPriceIsla||0),fromSellerId:String(Me.sellerId||""),fromSellerName:String(Me.sellerName||""),fromOrderKey:String(Me.orderId||Ce.id||""),fromOrderLabel:String(Me.orderId||Ce.id||""),toSellerId:Ue?(Ae==null?void 0:Ae.id)||"":String((qe==null?void 0:qe.sellerId)||""),toSellerName:Ue?(Ae==null?void 0:Ae.name)||"":String((qe==null?void 0:qe.sellerName)||""),toOrderKey:Ue?Ze:String((qe==null?void 0:qe.orderId)||I||""),toOrderLabel:Ue?Ze:String((qe==null?void 0:qe.orderId)||I||""),fromVendorRowId:Ce.id,toVendorRowId:Ue||_t?Se.id:Le.id,comment:P.trim(),destRowWasNew:pe})}),a(Tt=>{const Lt=Tt.reduce((Me,_e)=>{if(_e.id===Ce.id){const U=Number(_e.unitsPerPackage||0),ye=U>0?ie*U:0;return Me.push({..._e,packages:Math.max(0,Number(_e.packages||0)-ie),remainingPackages:Number(_e.remainingPackages||0)-ie,remainingUnits:U>0?Number(_e.remainingUnits||0)-ye:_e.remainingUnits,transferDelta:Number(_e.transferDelta||0)-ie}),Me}if(!Ue&&Le&&_e.id===Le.id){const U=Number(_e.unitsPerPackage||0),ye=U>0?ie*U:0;return Me.push({..._e,packages:Math.max(0,Number(_e.packages||0)+ie),remainingPackages:Number(_e.remainingPackages||0)+ie,remainingUnits:U>0?Number(_e.remainingUnits||0)+ye:_e.remainingUnits,transferDelta:Number(_e.transferDelta||0)+ie}),Me}return Me.push(_e),Me},[]);return Nt?[...Lt,Nt]:Lt}),await Ft(),A(Tt=>{const Lt={...Tt},Me=y,_e=Ue?Ze:I;return Me&&(Lt[Me]=Lt[Me]||{out:0,in:0},Lt[Me].out+=ie),_e&&(Lt[_e]=Lt[_e]||{out:0,in:0},Lt[_e].in+=ie),Lt}),h(Tt=>{const Lt={...Tt};if(Ce.id&&(Lt[Ce.id]=(Lt[Ce.id]||0)-ie),!pe){const Me=_t||Ue?Nt==null?void 0:Nt.id:Le==null?void 0:Le.id;Me&&(Lt[Me]=(Lt[Me]||0)+ie)}return Lt}),kt(),ue(" Traslado realizado.")}catch(xe){ue((xe==null?void 0:xe.message)||" Error realizando el traslado.")}finally{ce(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[z&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{e(),kt()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:y,onChange:ie=>{b(ie.target.value),j(""),_(""),E(""),T("0")},disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ye.map(ie=>{const Ue=ae[ie];return i.jsxs("option",{value:ie,children:["Vendedor: ",(Ue==null?void 0:Ue.sellerName)||"","  Existencias:"," ",(Ue==null?void 0:Ue.totalRemainingPackages)||"0"," Paquetes - Fecha Orden:"," ",(Ue==null?void 0:Ue.date)||""]},ie)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsx("input",{type:"text",className:"mt-1 mb-2 w-full border p-2 rounded text-sm",placeholder:"Buscar producto...",value:K,onChange:ie=>L(ie.target.value),disabled:!s||!y}),i.jsxs("select",{className:"w-full border p-2 rounded",value:w,onChange:ie=>{j(ie.target.value),_(""),E(""),T("0")},disabled:!s||!y,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xe.map(ie=>i.jsxs("option",{value:ie.id,children:[ie.productName,"  Existencias:"," ",Number(ie.remainingPackages??ie.packages??0)," Paquetes - Precio Costo: $",ie.providerPrice]},ie.id))]})]}),!me&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:I,onChange:ie=>{_(ie.target.value),E("")},disabled:!s||!w,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ye.filter(ie=>ie!==y).map(ie=>{const Ue=ae[ie];return i.jsxs("option",{value:ie,children:["Vendedor: ",(Ue==null?void 0:Ue.sellerName)||"","  Existencias:"," ",(Ue==null?void 0:Ue.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Ue==null?void 0:Ue.date)||""]},ie)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:S,onChange:ie=>E(ie.target.value),disabled:!s||!I||!it,children:[i.jsx("option",{value:"",children:"Selecciona"}),Mt.map(ie=>i.jsxs("option",{value:ie.id,children:["Tipo: ",ie.category," - ",ie.productName,"  Existencias:"," ",Number(ie.remainingPackages??ie.packages??0),"Paquetes - Precio Costo: $",ie.providerPrice]},ie.id))]}),I&&it&&Mt.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. Si dejas este campo vaco se crear automticamente al moverlo."}),I&&i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este campo es opcional; salo solo si el pedido ya tiene el producto y quieres sumar a esa fila."})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:me,onChange:ie=>{const Ue=ie.target.checked;se(Ue),Ue&&(_(""),E(""))},disabled:!s}),i.jsx("span",{className:"text-sm font-semibold",children:"Crear nueva orden destino (independiente)"})]}),me&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor destino (nueva orden)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ke,onChange:ie=>Re(ie.target.value),disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),u.map(ie=>i.jsxs("option",{value:ie.id,disabled:ie.id===xt,children:[ie.name,ie.id===xt?" (origen)":""]},ie.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de la nueva orden"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:F,onChange:ie=>H(ie.target.value),disabled:!s}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esta orden ser independiente. Asegrate de usar una fecha que no tenga otro pedido activo para el mismo vendedor."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:B,onChange:ie=>T(ie.target.value),disabled:!s||!w||!me&&!I})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:P,onChange:ie=>O(ie.target.value),disabled:!s,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:kt,disabled:!s||z,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:Ge,disabled:!s||z||!w||!me&&!I||Number(B||0)<=0||!P.trim(),children:"Hacer traslado"})]}),de&&i.jsx("div",{className:"text-sm text-red-600 mt-2",children:de})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:W,onChange:ie=>Y(ie.target.value)}),i.jsx("span",{className:"text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:D,onChange:ie=>Q(ie.target.value)}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ft,disabled:m,type:"button",children:m?"Cargando...":"Recargar"})]})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Desde vendedor"}),i.jsx("th",{className:"p-2 border",children:"Desde orden"}),i.jsx("th",{className:"p-2 border",children:"Hacia vendedor"}),i.jsx("th",{className:"p-2 border",children:"Hacia orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):$t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin traslados"})}):$t.map(ie=>{var Ce,Le;const Ue=((Le=(Ce=ie.createdAt)==null?void 0:Ce.toDate)==null?void 0:Le.call(Ce))||(ie.createdAt?new Date(ie.createdAt.seconds*1e3):null),Ne=Ue?`${Ue.toISOString().slice(0,10)} ${Ue.toISOString().slice(11,19)}`:ie.date||"",be=(ie.createdByName||"").trim()||(ie.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Ne}),i.jsx("td",{className:"p-2 border",children:be}),i.jsx("td",{className:"p-2 border text-left",children:ie.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(ie.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:nB(ie.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:nB(ie.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:nB(ie.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:ie.fromSellerName||""}),i.jsx("td",{className:"p-2 border",children:ie.fromOrderLabel||ie.fromOrderKey||""}),i.jsx("td",{className:"p-2 border",children:ie.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:ie.toOrderLabel||ie.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:ie.comment||""})]},ie.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}):null}const ni=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function vG(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const bi=t=>Math.max(0,Math.floor(Number(t||0))),rf=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},sd=(t,e)=>{const r=rf(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}};function XQe({role:t="",sellerCandyId:e="",currentUserEmail:r,roles:n}){const{refreshKey:a,refresh:s}=Dc(),o=n&&n.length?n:t,l=!o||En(o,"admin"),c=En(o,"vendedor_dulces"),u=(r||"").trim().toLowerCase(),d=!l&&c,[f,A]=g.useState(!0),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState([]),[b,w]=g.useState({}),[j,I]=g.useState([]),_=g.useRef({});g.useEffect(()=>{const fe={};j.forEach(tt=>{fe[tt.id]=tt}),_.current=fe},[j]);const[S,E]=g.useState(!1),[B,T]=g.useState(null),[P,O]=g.useState(""),[z,ce]=g.useState(""),[de,ue]=g.useState(""),[me,se]=g.useState(""),[ke,Re]=g.useState("0"),[F,H]=g.useState([]),[K,L]=g.useState(""),[W,Y]=g.useState(""),[D,Q]=g.useState(!1),[ee,ve]=g.useState(!1),[M,Ye]=g.useState(!1),ae=20,[X,De]=g.useState(1),le=20,[$e,Xe]=g.useState(1),[it,xt]=g.useState({}),[jt,Mt]=g.useState(!1),[Ft,$t]=g.useState({}),[kt,Ge]=g.useState({}),[ie,Ue]=g.useState(!1),[Ne,be]=g.useState({}),[Ce,Le]=g.useState({}),Ae=g.useMemo(()=>p.find(fe=>fe.id===P)||null,[P,p]);Ae==null||Ae.branch,g.useEffect(()=>{!S||!P||!F.length||H(fe=>fe.map(tt=>{const vt=v.find(Cr=>Cr.id===tt.productId)||null,mt=p.find(Cr=>Cr.id===P)||null,Oe=mt==null?void 0:mt.branch,At=bi(tt.packages),It=vt?Se(vt,Oe):Number(tt.pricePerPackage||0),bt=(vt?gt(vt,Oe):0)*At,St=vt?vt.logisticAllocatedPerPack*At:Number(tt.logisticAllocated||0),Qt=(vt?Et(vt,Oe):0)*At,ar=Nt(P),or=tt.vendorMarginPercent!=null&&String(tt.vendorMarginPercent).trim()!==""?rf(tt.vendorMarginPercent):ar,_r=sd(bt,or);return{...tt,pricePerPackage:It,totalExpected:It*At,grossProfit:bt,logisticAllocated:St,vendorMarginPercent:_r.vendorMarginPercent,uAproximada:Qt,uVendor:_r.uVendor,uInvestor:_r.uInvestor,totalRivas:((vt==null?void 0:vt.unitPriceRivas)||tt.unitPriceRivas||0)*At,totalSanJorge:((vt==null?void 0:vt.unitPriceSanJorge)||tt.unitPriceSanJorge||0)*At,totalIsla:((vt==null?void 0:vt.unitPriceIsla)||tt.unitPriceIsla||0)*At,unitPriceRivas:(vt==null?void 0:vt.unitPriceRivas)||tt.unitPriceRivas||0,unitPriceSanJorge:(vt==null?void 0:vt.unitPriceSanJorge)||tt.unitPriceSanJorge||0,unitPriceIsla:(vt==null?void 0:vt.unitPriceIsla)||tt.unitPriceIsla||0}}))},[S,P,F.length,v,p]);const We=g.useMemo(()=>!c||!u?null:p.find(fe=>(fe.email||"").trim().toLowerCase()===u)||null,[c,u,p]);g.useMemo(()=>new Set(F.map(fe=>fe.productId)),[F]);const ct=g.useMemo(()=>v.filter(fe=>(b[fe.id]??0)>1).sort((fe,tt)=>`${fe.category} ${fe.name}`.localeCompare(`${tt.category} ${tt.name}`)),[v,b]),_t=g.useMemo(()=>{const fe=K.trim().toLowerCase();return fe?ct.filter(tt=>`${tt.category??""} ${tt.name??""}`.toLowerCase().includes(fe)):ct},[ct,K]),pe=g.useMemo(()=>v.find(fe=>fe.id===me)||null,[me,v]),Pe=g.useMemo(()=>c&&We?j.filter(fe=>fe.sellerId===We.id):j,[j,c,We]),Ee=async()=>{try{const fe=yt(Ie,"inventory_transfers_candies"),tt=(bt,St,Jt,Qt)=>{St&&(bt[St]=bt[St]||{out:0,in:0},bt[St][Jt]+=Qt)},vt=(bt,St,Jt)=>{const Qt=String(St||"");Qt&&(bt[Qt]=(bt[Qt]||0)+Jt)},mt={},Oe={},At=_.current,It=bt=>{var Cr,Ut;if(bt.destRowWasNew!=null)return!!bt.destRowWasNew;const St=String(bt.toVendorRowId||"");if(!St)return!1;const Jt=At[St];if(!Jt)return!1;const Qt=Number(((Cr=Jt.createdAt)==null?void 0:Cr.seconds)??0),ar=Number(((Ut=bt.createdAt)==null?void 0:Ut.seconds)??0),or=Qt>0&&ar>0&&Math.abs(Qt-ar)<=1,_r=Math.max(0,Number(Jt.packages||0))===Math.max(0,Number(bt.packagesMoved||0));return or&&_r},Ct=bt=>{const St=bt.data(),Jt=Number(St.packagesMoved||0);Jt>0&&(tt(mt,String(St.fromOrderKey||""),"out",Jt),tt(mt,String(St.toOrderKey||""),"in",Jt),vt(Oe,St.fromVendorRowId,-Jt),It(St)||vt(Oe,St.toVendorRowId,Jt))};if(!c)(await Ht(fe)).forEach(Ct);else{const bt=sr(fe,mr("fromSellerId","==",e)),St=sr(fe,mr("toSellerId","==",e)),[Jt,Qt]=await Promise.all([Ht(bt),Ht(St)]),ar=new Set,or=_r=>{_r.forEach(Cr=>{ar.has(Cr.id)||(ar.add(Cr.id),Ct(Cr))})};or(Jt.docs),or(Qt.docs)}$t(mt),Ge(Oe)}catch(fe){console.error(fe),$t({}),Ge({})}};g.useEffect(()=>{(async()=>{A(!0),m("");try{const fe=await Ht(sr(yt(Ie,"sellers_candies"),In("name","asc"))),tt=[];fe.forEach(Cr=>{const Ut=Cr.data(),tn=Ut.branch||Ut.branchLabel||Ut.route||Ut.sucursal||Ut.location||"";tt.push({id:Cr.id,name:Ut.name||"",email:Ut.email||"",commissionPercent:Number(Ut.commissionPercent||0),branch:vG(tn),branchLabel:tn})}),x(tt);const vt=await Ht(sr(yt(Ie,"candy_main_orders"),In("createdAt","desc"))),mt={},Oe={},At=(Cr,Ut)=>`${Cr}#${String(Ut).padStart(10,"0")}`;vt.forEach(Cr=>{var yr;const Ut=Cr.data(),tn=Number(((yr=Ut.createdAt)==null?void 0:yr.seconds)??0),Gr=String(Ut.date||""),Ir=Array.isArray(Ut.items)?Ut.items:[];for(const jr of Ir){const Bn=String(jr.id||jr.productId||"");if(!Bn)continue;const yn=bi(jr.remainingPackages??jr.remainingPacks??0);yn>0&&(mt[Bn]=(mt[Bn]||0)+yn);const mn=Math.max(1,bi(jr.packages??0)),ua=Number(jr.providerPrice??jr.provider_price??jr.priceProvider??jr.costProvider??0),ga=Number(jr.unitPriceRivas||0),Yi=Number(jr.unitPriceSanJorge||0),Ji=Number(jr.unitPriceIsla||0),Fl=Number(jr.gainRivas??jr.grossProfitRivas??jr.grossProfit??0),xa=Number(jr.gainSanJorge??jr.grossProfitSanJorge??jr.grossProfit??0),Qn=Number(jr.gainIsla??jr.grossProfitIsla??jr.grossProfit??0),du=Number(jr.logisticAllocated??jr.prorrateo??jr.prorrateoLogistico??jr.gastos??0),Zi=Number(jr.uAproximada??jr.uApprox??jr.netProfit??jr.vendorProfit??jr.gainVendor??0)/mn,Rc=du/mn,Mc={id:Bn,name:String(jr.name||jr.productName||""),category:String(jr.category||""),unitsPerPackage:bi(jr.unitsPerPackage??0),providerPrice:ua,unitPriceRivas:ga,unitPriceSanJorge:Yi,unitPriceIsla:Ji,grossProfitPerPackRivas:Fl/mn,grossProfitPerPackSanJorge:xa/mn,grossProfitPerPackIsla:Qn/mn,uApproxPerPackRivas:Zi,uApproxPerPackSanJorge:Zi,uApproxPerPackIsla:Zi,logisticAllocatedPerPack:Rc,masterOrderId:Cr.id,key:At(Gr,tn)},dc=Oe[Bn];(!dc||Mc.key>dc.key)&&(Oe[Bn]=Mc)}});const It=await Ht(sr(yt(Ie,"inventory_candies"),In("createdAt","desc"))),Ct=Cr=>{const Ut=Math.max(1,bi(Cr.unitsPerPackage||1)),tn=Number(Cr.remaining??0);if(Number.isFinite(tn)&&tn>0)return Math.floor(tn/Ut);const Gr=Number(Cr.remainingPackages??0);return Number.isFinite(Gr)&&Gr>0?Math.floor(Gr):0},bt={};It.forEach(Cr=>{const Ut=Cr.data(),tn=String(Ut.productId||"");if(!tn)return;const Gr=Ct(Ut);Gr<=0||(bt[tn]=(bt[tn]||0)+Gr)});const St={};(Object.keys(bt).length?Object.keys(bt):Object.keys(mt)).forEach(Cr=>{const Ut=Object.keys(bt).length?bt[Cr]:mt[Cr];St[Cr]=Math.max(0,bi(Ut))}),w(St);const Qt=await Ht(c?sr(yt(Ie,"inventory_candies_sellers"),mr("sellerId","==",e),In("createdAt","desc")):sr(yt(Ie,"inventory_candies_sellers"),In("createdAt","desc"))),ar=Object.keys(Oe).map(Cr=>{const Ut=Oe[Cr];return{id:Ut.id,name:Ut.name,category:Ut.category,unitsPerPackage:Ut.unitsPerPackage,providerPrice:Ut.providerPrice,unitPriceRivas:Ut.unitPriceRivas,unitPriceSanJorge:Ut.unitPriceSanJorge,unitPriceIsla:Ut.unitPriceIsla,grossProfitPerPackRivas:Ut.grossProfitPerPackRivas,grossProfitPerPackSanJorge:Ut.grossProfitPerPackSanJorge,grossProfitPerPackIsla:Ut.grossProfitPerPackIsla,uApproxPerPackRivas:Ut.uApproxPerPackRivas,uApproxPerPackSanJorge:Ut.uApproxPerPackSanJorge,uApproxPerPackIsla:Ut.uApproxPerPackIsla,logisticAllocatedPerPack:Ut.logisticAllocatedPerPack,existingPacks:St[Ut.id]??0,masterOrderId:Ut.masterOrderId}}).sort((Cr,Ut)=>`${Cr.category} ${Cr.name}`.localeCompare(`${Ut.category} ${Ut.name}`));y(ar);const or=[];Qt.forEach(Cr=>{const Ut=Cr.data(),tn=Object.prototype.hasOwnProperty.call(Ut,"transferDelta"),Gr=tt.find(ua=>ua.id===Ut.sellerId)||null,Ir=rf(Ut.vendorMarginPercent??Ut.vendorMargin??Ut.commissionPercent??(Gr==null?void 0:Gr.commissionPercent)??0),yr=Number(Ut.uAproximada??Ut.uApprox??Ut.netProfit??Ut.uAprox??Ut.uApproxTotal??0),jr=Ut.uVendor??Ut.vendorProfit??Ut.gainVendor??0,Bn=Ut.uVendor!=null,yn=sd(Number(Ut.grossProfit??Ut.gainVendor??0),Ir),mn=Bn?{uAproximada:Number(yr||0),vendorMarginPercent:Ir,uVendor:Number(jr||0),uInvestor:Number(yr||0)-Number(jr||0)}:{uAproximada:Number(yr||0),vendorMarginPercent:yn.vendorMarginPercent,uVendor:yn.uVendor,uInvestor:yn.uInvestor};or.push({id:Cr.id,sellerId:Ut.sellerId,sellerName:Ut.sellerName||"",orderName:Ut.orderName||"",productId:Ut.productId,productName:Ut.productName||"",category:Ut.category||"",orderId:Ut.orderId||null,packages:Number(Ut.packages||0),unitsPerPackage:Number(Ut.unitsPerPackage||0),totalUnits:Number(Ut.totalUnits||0),remainingPackages:Number(Ut.remainingPackages||0),remainingUnits:Number(Ut.remainingUnits||0),totalRivas:Number(Ut.totalRivas||0),totalSanJorge:Number(Ut.totalSanJorge||0),totalIsla:Number(Ut.totalIsla||0),unitPriceRivas:Number(Ut.unitPriceRivas||0),unitPriceSanJorge:Number(Ut.unitPriceSanJorge||0),unitPriceIsla:Number(Ut.unitPriceIsla||0),grossProfit:Number(Ut.grossProfit??Ut.gainVendor??0),logisticAllocated:Number(Ut.logisticAllocated??Ut.gastos??Ut.gasto??0),vendorMarginPercent:mn.vendorMarginPercent,uAproximada:mn.uAproximada,uVendor:mn.uVendor,uInvestor:mn.uInvestor,vendorProfit:Number(Ut.vendorProfit??mn.uVendor??0),transferDelta:tn&&typeof Ut.transferDelta=="number"?Number(Ut.transferDelta||0):void 0,subtotal:Number(Ut.subtotal||0),providerPrice:Number(Ut.providerPrice||0),date:Ut.date||"",createdAt:Ut.createdAt||vr.now()})});const _r={};or.forEach(Cr=>{_r[Cr.id]=Cr}),_.current=_r,I(or),await Ee()}catch(fe){console.error(fe),m(" Error cargando datos de vendedores / pedidos.")}finally{A(!1)}})()},[a,t,e]);const Ze=(fe,tt)=>`${fe}__${tt}`,xe=fe=>fe.orderId||Ze(fe.sellerId,fe.date),Se=(fe,tt)=>tt?tt==="RIVAS"?fe.unitPriceRivas||0:tt==="SAN_JORGE"?fe.unitPriceSanJorge||0:fe.unitPriceIsla||0:fe.unitPriceIsla||fe.unitPriceRivas||fe.unitPriceSanJorge||0,gt=(fe,tt)=>tt?tt==="RIVAS"?fe.grossProfitPerPackRivas||0:tt==="SAN_JORGE"?fe.grossProfitPerPackSanJorge||0:fe.grossProfitPerPackIsla||0:fe.grossProfitPerPackIsla||fe.grossProfitPerPackRivas||fe.grossProfitPerPackSanJorge||0,Et=(fe,tt)=>tt?tt==="RIVAS"?fe.uApproxPerPackRivas||0:tt==="SAN_JORGE"?fe.uApproxPerPackSanJorge||0:fe.uApproxPerPackIsla||0:fe.uApproxPerPackIsla||fe.uApproxPerPackRivas||fe.uApproxPerPackSanJorge||0,Nt=fe=>{const tt=p.find(vt=>vt.id===fe)||null;return rf((tt==null?void 0:tt.commissionPercent)??0)},Tt=fe=>{const tt=kt[fe.id];return typeof tt=="number"&&Number.isFinite(tt)?tt:typeof fe.transferDelta=="number"?Number(fe.transferDelta||0):0},Lt=fe=>{const tt=Math.max(0,Number(fe.packages||0)),vt=Tt(fe);return Math.max(0,tt+vt)},Me=fe=>{const tt=Math.max(1,bi(fe.unitsPerPackage||1)),vt=Number(fe.remaining??0);if(Number.isFinite(vt)&&vt>0)return Math.floor(vt/tt);const mt=Number(fe.remainingPackages??0);return Number.isFinite(mt)&&mt>0?Math.floor(mt):0},_e=async(fe,tt)=>{const vt=String(fe||"").trim();if(!vt)return{byId:0,byName:0};const mt=await Ht(sr(yt(Ie,"inventory_candies"),mr("productId","==",vt)));let Oe=0;mt.forEach(bt=>{Oe+=Me(bt.data())});const At=Math.max(0,Oe);let It=0;const Ct=String(tt||"").trim();return At===0&&Ct&&((await Ht(sr(yt(Ie,"inventory_candies"),mr("productName","==",Ct)))).forEach(St=>{It+=Me(St.data())}),It=Math.max(0,It)),{byId:At,byName:It}},U=g.useMemo(()=>{const fe=new Map;for(const vt of Pe){const mt=xe(vt),Oe=fe.get(mt)||{orderKey:mt,sellerId:vt.sellerId,sellerName:vt.sellerName,orderName:vt.orderName||"",date:vt.date,totalPackages:0,totalActivePackages:0,totalRemainingPackages:0,totalExpected:0,totalExpectedActive:0,grossProfit:0,grossProfitActive:0,vendorProfit:0,vendorProfitActive:0,gastos:0,gastosActive:0,transferredOut:0,transferredIn:0},At=Math.max(0,Number(vt.packages||0)),It=Math.max(0,Number(vt.remainingPackages||0)),Ct=Lt(vt),bt=At>0?Ct/At:1;Oe.totalPackages+=At,Oe.totalRemainingPackages+=It,Oe.totalActivePackages+=Ct;const St=p.find(yn=>yn.id===vt.sellerId)||null,Jt=St==null?void 0:St.branch,Qt=v.find(yn=>yn.id===String(vt.productId))||null,ar=Qt?Se(Qt,Jt):Number(Jt==="RIVAS"?vt.unitPriceRivas||0:Jt==="SAN_JORGE"?vt.unitPriceSanJorge||0:vt.unitPriceIsla||0),or=ar*At,_r=ar*Ct;Oe.totalExpected+=Number(or||0),Oe.totalExpectedActive+=Number(_r||0);const Cr=Qt?gt(Qt,Jt):At>0?Number(vt.grossProfit||0)/At:0,Ut=Cr*At,tn=Cr*Ct;Oe.grossProfit+=Number(Ut||0),Oe.grossProfitActive+=Number(tn||0);const Gr=typeof(Qt==null?void 0:Qt.logisticAllocatedPerPack)=="number"?Number(Qt.logisticAllocatedPerPack||0):(()=>{const yn=Number(vt.logisticAllocated??vt.gastos??vt.gasto??0),mn=At>0?At:Ct||1;return mn>0?yn/mn:0})(),Ir=Gr*At,yr=Gr*Ct;Oe.gastos=(Oe.gastos||0)+Number(Ir||0),Oe.gastosActive=(Oe.gastosActive||0)+Number(yr||0);const jr=Nt(vt.sellerId),Bn=sd(Ut,jr);Oe.vendorProfit+=Number(Bn.uVendor||0),Oe.vendorProfitActive+=Number(Bn.uVendor||0)*bt,fe.set(mt,Oe)}const tt=[];for(const vt of fe.values()){const mt=Ft[vt.orderKey]||{out:0,in:0};vt.transferredOut=mt.out||0,vt.transferredIn=mt.in||0,Number.isFinite(vt.totalExpectedActive)||(vt.totalExpectedActive=vt.totalExpected),Number.isFinite(vt.grossProfitActive)||(vt.grossProfitActive=vt.grossProfit),Number.isFinite(vt.vendorProfitActive)||(vt.vendorProfitActive=vt.vendorProfit),Number.isFinite(vt.gastosActive||0)||(vt.gastosActive=vt.gastos),tt.push(vt)}return tt.sort((vt,mt)=>(mt.date||"").localeCompare(vt.date||"")),tt},[Pe,p,Ft,v,kt]),ye=g.useMemo(()=>Math.max(1,Math.ceil(U.length/ae)),[U.length]);g.useEffect(()=>{X>ye&&De(ye)},[ye]);const te=g.useMemo(()=>{const fe=(X-1)*ae;return U.slice(fe,fe+ae)},[U,X]),Ve=()=>De(fe=>Math.max(1,fe-1)),qe=()=>De(fe=>Math.min(ye,fe+1)),G=g.useMemo(()=>{const fe=W.trim().toLowerCase();return fe?F.filter(tt=>{const vt=String(tt.productName||"").toLowerCase(),mt=String(tt.category||"").toLowerCase();return vt.includes(fe)||mt.includes(fe)}):F},[F,W]),V=g.useMemo(()=>Math.max(1,Math.ceil(G.length/le)),[G.length]);g.useEffect(()=>{$e>V&&Xe(V)},[V]);const Z=g.useMemo(()=>{const fe=($e-1)*le;return G.slice(fe,fe+le)},[G,$e]),re=g.useMemo(()=>{const fe=new Map;for(const tt of Z){const vt=(tt.category||"Sin categora").trim()||"Sin categora",mt=fe.get(vt)||[];mt.push(tt),fe.set(vt,mt)}return Array.from(fe.entries())},[Z]),we=fe=>{xt(tt=>({...tt,[fe]:!tt[fe]}))},Fe=()=>Xe(fe=>Math.max(1,fe-1)),st=()=>Xe(fe=>Math.min(V,fe+1)),Be=fe=>{be(tt=>({...tt,[fe]:!0}))},at=fe=>{be(tt=>({...tt,[fe]:!1}))},lt=fe=>{Le(tt=>({...tt,[fe]:!0}))},dt=fe=>{Le(tt=>({...tt,[fe]:!1}))},Pt=fe=>{const tt=Math.max(0,Number(fe.packages||0)),vt=Number(fe.transferDelta||0);return Math.max(0,tt+vt)},he=fe=>{const tt=Math.max(0,Number(fe.packages||0)),vt=Pt(fe);return tt===0?vt>0?1:0:vt/tt},ze=(fe,tt)=>Number(tt||0)*he(fe),nt=fe=>Number(fe.logisticAllocated??fe.logisticAllocated??fe.gastos??fe.gasto??0),ne=fe=>{const tt=ze(fe,Number(fe.totalExpected||0)),vt=ze(fe,Number(fe.grossProfit||0)),mt=ze(fe,nt(fe)),Oe=ze(fe,Number(fe.uVendor||0)),At=vt-mt-Oe;return{totalExpected:tt,grossProfit:vt,gastos:mt,uVendor:Oe,uNeta:At}},He=g.useMemo(()=>F.reduce((fe,tt)=>{const vt=Math.max(0,Number(tt.packages||0)),mt=Pt(tt),Oe=ne(tt);return fe.totalPackages+=vt,fe.totalActivePackages+=mt,fe.totalExpected+=Oe.totalExpected,fe.grossProfit+=Oe.grossProfit,fe.gastosTotal+=Oe.gastos,fe.uVendor+=Oe.uVendor,fe},{totalPackages:0,totalActivePackages:0,totalExpected:0,grossProfit:0,gastosTotal:0,uVendor:0}),[F]),pt=g.useMemo(()=>He.grossProfit-He.gastosTotal-He.uVendor,[He.grossProfit,He.gastosTotal,He.uVendor]),Dt=()=>{T(null),O(""),ce(""),ue(""),se(""),Re("0"),H([]),L(""),Xe(1),be({}),Le({})},rr=()=>{m(""),Dt(),c&&We&&O(We.id);const fe=new Date,tt=fe.getFullYear(),vt=String(fe.getMonth()+1).padStart(2,"0"),mt=String(fe.getDate()).padStart(2,"0");ce(`${tt}-${vt}-${mt}`),ue(""),E(!0)},zt=()=>{E(!1)},Ot=fe=>{m(""),Dt(),T(fe);const[tt,vt]=fe.split("__");O(tt||""),ce(vt||"");const mt=Pe.filter(bt=>xe(bt)===fe),Oe=mt[0]||null;ue((Oe==null?void 0:Oe.orderName)||"");const At=p.find(bt=>bt.id===tt)||null,It=At==null?void 0:At.branch,Ct=mt.map(bt=>{const St=v.find(Bn=>Bn.id===String(bt.productId))||null,Jt=Number(bt.unitPriceRivas||(St==null?void 0:St.unitPriceRivas)||0),Qt=Number(bt.unitPriceSanJorge||(St==null?void 0:St.unitPriceSanJorge)||0),ar=Number(bt.unitPriceIsla||(St==null?void 0:St.unitPriceIsla)||0),or=Number(bt.packages||0),_r=It==="RIVAS"?Jt:It==="SAN_JORGE"?Qt:ar,Cr=Number(bt.totalRivas||0),Ut=Number(bt.totalSanJorge||0),tn=Number(bt.totalIsla||0),Gr=It==="RIVAS"?Cr:It==="SAN_JORGE"?Ut:tn,Ir=rf(bt.vendorMarginPercent??Nt(tt)),yr=sd(Number(bt.grossProfit||0),Ir),jr=Number(bt.logisticAllocated??bt.gastos??0)||(St?St.logisticAllocatedPerPack*or:0);return{id:bt.id,productId:String(bt.productId||""),productName:bt.productName||(St==null?void 0:St.name)||"",category:bt.category||(St==null?void 0:St.category)||"",unitsPerPackage:Number(bt.unitsPerPackage||(St==null?void 0:St.unitsPerPackage)||0),packages:or,totalExpected:Gr,pricePerPackage:_r,grossProfit:Number(bt.grossProfit||0),logisticAllocated:jr,vendorMarginPercent:yr.vendorMarginPercent,uAproximada:Number(bt.uAproximada||0),uVendor:Number(bt.uVendor??yr.uVendor??0),uInvestor:Number(bt.uInvestor??yr.uInvestor??0),totalRivas:Cr,totalSanJorge:Ut,totalIsla:tn,unitPriceRivas:Jt,unitPriceSanJorge:Qt,unitPriceIsla:ar,providerPrice:Number(bt.providerPrice||0),remainingPackages:Number(bt.remainingPackages||0),transferDelta:Tt(bt)}});H(Ct),E(!0)},lr=()=>{if(m(""),!P)return m(" Seleccion un vendedor.");if(!z)return m(" Seleccion una fecha.");if(!me)return m(" Seleccion un producto.");const fe=bi(ke);if(fe<=0)return m(" Paquetes debe ser > 0.");const tt=v.find(_r=>_r.id===me);if(!tt)return m(" Producto no encontrado.");if(F.some(_r=>_r.productId===tt.id))return m(" Ese producto ya est agregado al pedido.");const vt=p.find(_r=>_r.id===P)||null,mt=vt==null?void 0:vt.branch,Oe=Se(tt,mt),At=gt(tt,mt),Ct=Et(tt,mt)*fe,bt=Oe*fe,St=At*fe,Jt=tt.logisticAllocatedPerPack*fe,Qt=Nt(P),ar=sd(St,Qt),or={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:tt.id,productName:tt.name,category:tt.category,unitsPerPackage:tt.unitsPerPackage,packages:fe,totalExpected:bt,pricePerPackage:Oe,grossProfit:St,logisticAllocated:Jt,providerPrice:tt.providerPrice,vendorMarginPercent:ar.vendorMarginPercent,uAproximada:Ct,uVendor:ar.uVendor,uInvestor:ar.uInvestor,totalRivas:(tt.unitPriceRivas||0)*fe,totalSanJorge:(tt.unitPriceSanJorge||0)*fe,totalIsla:(tt.unitPriceIsla||0)*fe,unitPriceRivas:tt.unitPriceRivas||0,unitPriceSanJorge:tt.unitPriceSanJorge||0,unitPriceIsla:tt.unitPriceIsla||0,remainingPackages:fe,transferDelta:0};H(_r=>[or,..._r]),se(""),Re("0"),Xe(1)},Dr=fe=>{H(tt=>tt.filter(vt=>vt.id!==fe))},br=(fe,tt)=>{const vt=Math.max(0,bi(tt));H(mt=>mt.map(Oe=>{if(Oe.id!==fe)return Oe;const At=v.find(tn=>tn.id===Oe.productId),It=p.find(tn=>tn.id===P)||null,Ct=It==null?void 0:It.branch,bt=At?Se(At,Ct):Oe.pricePerPackage||0,Jt=(At?gt(At,Ct):0)*vt,Qt=At?At.logisticAllocatedPerPack*vt:Oe.logisticAllocated||0,or=(At?Et(At,Ct):0)*vt,_r=Oe.vendorMarginPercent!=null?Oe.vendorMarginPercent:Nt(P),Cr=sd(Jt,_r),Ut=String(Oe.id||"").startsWith("tmp_")||Number(Oe.remainingPackages||0)===Number(Oe.packages||0);return{...Oe,packages:vt,pricePerPackage:bt,totalExpected:bt*vt,grossProfit:Jt,logisticAllocated:Qt,providerPrice:(At==null?void 0:At.providerPrice)??Oe.providerPrice??Number(Oe.providerPrice||0),vendorMarginPercent:Cr.vendorMarginPercent,uAproximada:or,uVendor:Cr.uVendor,uInvestor:Cr.uInvestor,totalRivas:((At==null?void 0:At.unitPriceRivas)||Oe.unitPriceRivas||0)*vt,totalSanJorge:((At==null?void 0:At.unitPriceSanJorge)||Oe.unitPriceSanJorge||0)*vt,totalIsla:((At==null?void 0:At.unitPriceIsla)||Oe.unitPriceIsla||0)*vt,remainingPackages:Ut?vt:Oe.remainingPackages}}))},nr=(fe,tt)=>{const vt=rf(tt);H(mt=>mt.map(Oe=>{if(Oe.id!==fe)return Oe;const At=v.find(or=>or.id===Oe.productId),It=p.find(or=>or.id===P)||null,Ct=It==null?void 0:It.branch,bt=bi(Oe.packages),Jt=(At?Et(At,Ct):0)*bt,Qt=Number(Oe.grossProfit||0),ar=sd(Qt,vt);return{...Oe,vendorMarginPercent:ar.vendorMarginPercent,uAproximada:Jt,uVendor:ar.uVendor,uInvestor:ar.uInvestor}}))},ir=async()=>{if(l&&!ee)try{ve(!0),m("");const fe=j;if(!fe.length){m(" No hay documentos para actualizar.");return}const tt=Ct=>v.find(bt=>bt.id===Ct)||null,vt=Ct=>{const bt=p.find(St=>St.id===Ct)||null;return bt==null?void 0:bt.branch},mt=(Ct,bt)=>Math.abs(Number(Ct||0)-Number(bt||0))>.01;let Oe=tu(Ie),At=0,It=0;for(const Ct of fe){const bt=vt(Ct.sellerId)||"ISLA",St=Math.max(1,Number(Ct.unitsPerPackage||0)||1),Jt=Number(Ct.totalUnits||0),Qt=Number(Ct.remainingUnits||0),or=Math.max(0,Jt-Qt)/St,_r=Number(Ct.remainingPackages||0),Cr=Math.max(0,_r+or),Ut=tt(String(Ct.productId||"")),tn=Ut&&Cr>0?gt(Ut,bt)*Cr:Number(Ct.grossProfit||0),Gr=Ut&&Cr>0?Ut.logisticAllocatedPerPack*Cr:Number(Ct.logisticAllocated||0),Ir=Ut?Et(Ut,bt):0,yr=Cr>0?Ir*Cr:0,jr=Ct.vendorMarginPercent!=null?rf(Ct.vendorMarginPercent):Nt(Ct.sellerId),Bn=sd(tn,jr),yn=Bn.uVendor,mn=Bn.uInvestor,ua=tn-Gr-yn;if(!(mt(Ct.packages,Cr)||Ct.uVendor==null||Ct.uNeta==null||Ct.uAproximada==null||Ct.uInvestor==null||Ct.logisticAllocated==null||mt(Ct.uVendor,yn)||mt(Ct.uNeta,ua)||mt(Ct.uAproximada,yr)||mt(Ct.uInvestor,mn)||mt(Ct.logisticAllocated,Gr)))continue;const Yi=Zt(Ie,"inventory_candies_sellers",Ct.id);Oe.update(Yi,{packages:Cr,vendorMarginPercent:jr,grossProfit:tn,logisticAllocated:Gr,uAproximada:yr,uVendor:yn,uInvestor:mn,uNeta:ua,vendorProfit:yn,updatedAt:vr.now()}),At+=1,It+=1,At>=400&&(await Oe.commit(),Oe=tu(Ie),At=0)}At>0&&await Oe.commit(),m(` Actualizados ${It} documentos.`),s()}catch(fe){console.error(fe),m(" Error actualizando documentos.")}finally{ve(!1)}},Nr=(fe,tt,vt="Hoja1")=>{const mt=Qa.book_new(),Oe=Qa.aoa_to_sheet(tt);Qa.book_append_sheet(mt,Oe,vt),V2(mt,fe)},Pr=()=>{if(!l){m(" Solo admin puede exportar Excel.");return}const fe=["Vendedor","Sucursal","Fecha","Producto ID","Producto","Categora","Paquetes","Paquetes restantes","Precio paquete","Precio proveedor","Total esperado","U. Bruta","U. Vendedor","U. Neta","P. Rivas","P. San Jorge","P. Isla","Total Rivas","Total San Jorge","Total Isla","Unidades x paquete","vendorMarginPercent","uVendor"],tt=p.find(At=>At.id===P)||null,vt=(tt==null?void 0:tt.branch)||vG(tt==null?void 0:tt.branchLabel)||"",mt=[fe,...F.map(At=>{const{totalExpected:It,grossProfit:Ct,uVendor:bt,uNeta:St}=ne(At);return[(tt==null?void 0:tt.name)||"",String(vt),z||"",At.productId,At.productName,At.category,Number(At.packages||0),Number(At.remainingPackages||0),Number(At.pricePerPackage||0),Number(At.providerPrice||0),Number(It||0),Number(Ct||0),Number(bt||0),Number(St||0),Number(At.unitPriceRivas||0),Number(At.unitPriceSanJorge||0),Number(At.unitPriceIsla||0),Number(At.totalRivas||0),Number(At.totalSanJorge||0),Number(At.totalIsla||0),Number(At.unitsPerPackage||0),Number(At.vendorMarginPercent||0),Number(At.uVendor||0)]})],Oe=`vendor_order_items_${((tt==null?void 0:tt.name)||"vendedor").replace(/\s+/g,"_")}_${z||"sin_fecha"}.xlsx`;Nr(Oe,mt,"Productos")},xr=()=>{const fe=["productId","productName","category","Existentes","Paquetes","vendorMarginPercent","uNeta"],tt=v.map(mt=>({id:mt.id,name:mt.name,category:mt.category,existentes:Number(mt.existingPacks||0)})).filter(mt=>mt.existentes>0).sort((mt,Oe)=>`${mt.category} ${mt.name}`.localeCompare(`${Oe.category} ${Oe.name}`)),vt=[fe,...tt.map(mt=>[mt.id,mt.name,mt.category,mt.existentes,"","",""])];Nr("plantilla_orden_vendedor.xlsx",vt,"Plantilla")},$r=async fe=>{try{m("");const tt=await fe.arrayBuffer(),vt=Vv(tt,{type:"array"}),mt=vt.SheetNames||[],Oe=vt.Sheets.Plantilla||vt.Sheets.Productos||vt.Sheets[mt[0]];if(!Oe)return m(" Archivo sin hojas.");const At=Qa.sheet_to_json(Oe,{header:1,defval:""});if(!At.length)return m(" Archivo vaco.");const It=(At[0]||[]).map(_r=>String(_r||"").trim().toLowerCase()),Ct=It.findIndex(_r=>_r==="productid"||_r==="producto id"||_r==="id"),bt=It.findIndex(_r=>_r==="paquetes"||_r==="packages"),St=It.findIndex(_r=>_r==="vendormarginpercent"||_r==="vendor_margin_percent"||_r==="marginvendorpercent"||_r==="margen"||_r==="margen vendedor"||_r==="margen_del_vendedor");if(Ct<0||bt<0)return m(" Plantilla invlida: debe tener columnas productId y Paquetes.");if(!P)return m(" Seleccion un vendedor antes de importar.");if(!z)return m(" Seleccion una fecha antes de importar.");const Jt=p.find(_r=>_r.id===P)||null,Qt=Jt==null?void 0:Jt.branch,ar=Nt(P),or=[];for(let _r=1;_r<At.length;_r++){const Cr=At[_r]||[],Ut=String(Cr[Ct]||"").trim();if(!Ut)continue;const tn=bi(Cr[bt]);if(tn<=0)continue;const Gr=v.find(Qn=>Qn.id===Ut);if(!Gr)continue;const Ir=St>=0?rf(Cr[St]):0,yr=St>=0&&String(Cr[St]??"").trim()!==""?Ir:ar,jr=Se(Gr,Qt),Bn=gt(Gr,Qt),yn=jr*tn,mn=Bn*tn,ua=Gr.logisticAllocatedPerPack*tn,Yi=Et(Gr,Qt)*tn,Ji=sd(mn,yr),Fl=F.find(Qn=>Qn.productId===Ut);if(Fl){const Qn=St>=0&&String(Cr[St]??"").trim()!==""?yr:Fl.vendorMarginPercent,du=sd(mn,Qn);H(Ol=>Ol.map(Zi=>Zi.id===Fl.id?{...Zi,packages:tn,pricePerPackage:jr,totalExpected:yn,grossProfit:mn,logisticAllocated:ua,vendorMarginPercent:du.vendorMarginPercent,uAproximada:Yi,uVendor:du.uVendor,uInvestor:du.uInvestor,totalRivas:(Gr.unitPriceRivas||0)*tn,totalSanJorge:(Gr.unitPriceSanJorge||0)*tn,totalIsla:(Gr.unitPriceIsla||0)*tn}:Zi));continue}const xa={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:Gr.id,productName:Gr.name,category:Gr.category,unitsPerPackage:Gr.unitsPerPackage,packages:tn,pricePerPackage:jr,totalExpected:yn,grossProfit:mn,logisticAllocated:ua,providerPrice:Gr.providerPrice,vendorMarginPercent:Ji.vendorMarginPercent,uAproximada:Yi,uVendor:Ji.uVendor,uInvestor:Ji.uInvestor,totalRivas:(Gr.unitPriceRivas||0)*tn,totalSanJorge:(Gr.unitPriceSanJorge||0)*tn,totalIsla:(Gr.unitPriceIsla||0)*tn,unitPriceRivas:Gr.unitPriceRivas||0,unitPriceSanJorge:Gr.unitPriceSanJorge||0,unitPriceIsla:Gr.unitPriceIsla||0,remainingPackages:tn};or.push(xa)}if(!or.length)return m(" No se encontraron filas con Paquetes > 0.");H(_r=>[...or,..._r]),Xe(1),m(` Importados ${or.length} productos desde plantilla.`)}catch(tt){console.error(tt),m(" Error importando Excel.")}},cr=async()=>{var fe;try{if(m(""),d)return m(" Solo lectura.");if(!P)return m(" Seleccion un vendedor.");if(!z)return m(" Seleccion una fecha.");if(!F.length)return m(" Agreg al menos 1 producto.");const tt=p.find(Ir=>Ir.id===P)||null;if(!tt)return m(" Vendedor invlido.");const vt=tt.branch,mt=B?Pe.filter(Ir=>xe(Ir)===B):[],Oe=String(((fe=mt[0])==null?void 0:fe.orderName)||"").trim(),At=String(de||"").trim(),It=B?Oe!==At:At!=="",Ct=Ir=>String(Ir??"").trim(),bt=new Map;mt.forEach(Ir=>bt.set(Ct(Ir.productId),Ir));const St=Ir=>bt.get(Ct(Ir))||null,Jt=Ir=>{const yr=St(Ir.productId),jr=bi(Ir.packages),Bn=yr?bi(yr.packages):0,yn=!yr||jr!==Bn,mn=rf(yr?yr.vendorMarginPercent:Ir.vendorMarginPercent),ua=rf(Ir.vendorMarginPercent);return{prev:yr,newPacks:jr,oldPacks:Bn,packsChanged:yn,marginChanged:yr?mn!==ua:!0}},Qt=B?F.filter(Ir=>{const yr=Jt(Ir);return!yr.prev||yr.packsChanged||yr.marginChanged}):F;for(const Ir of Qt){const yr=bi(Ir.packages),jr=B?St(Ir.productId):null,Bn=jr?bi(jr.packages):0,yn=yr-Bn;if(yn>0){let mn=b[Ir.productId]??0;const ua=v.find(ga=>ga.id===Ir.productId)||null;if(yn>mn&&(ua!=null&&ua.masterOrderId))try{await pF(ua.masterOrderId);const ga=await _e(Ir.productId,Ir.productName);mn=ga.byId,w(Yi=>({...Yi,[Ir.productId]:ga.byId}))}catch{}if(yn>mn){const ga=await _e(Ir.productId,Ir.productName);return ga.byId===0&&ga.byName>0?m(` "${Ir.productName}" no tiene inventario por ID (${Ir.productId}). Pero existe por nombre: ${ga.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`):m(` "${Ir.productName}" excede existencias de orden maestra. Existentes: ${ga.byId} (faltan ${yn})`)}}}Q(!0);const ar=vr.now(),or=Ze(P,z),_r=Nt(P),Cr=new Set(F.map(Ir=>String(Ir.id||""))),Ut=B?mt.filter(Ir=>!Cr.has(String(Ir.id||""))):[];if(B&&Qt.length===0&&!Ut.length&&!It)return Q(!1),m(" No hay cambios para guardar.");if(B&&Qt.length===0&&!Ut.length&&It){const Ir=tu(Ie);mt.forEach(yr=>{Ir.update(Zt(Ie,"inventory_candies_sellers",yr.id),{orderName:At,updatedAt:vr.now()})}),await Ir.commit(),I(yr=>yr.map(jr=>xe(jr)===B?{...jr,orderName:At}:jr)),m(" Pedido guardado."),E(!1),Dt(),s();return}if(B){const Ir=[];for(const yr of Ut)await fG(yr.id),Ir.push(yr.id);Ir.length&&I(yr=>yr.filter(jr=>!Ir.includes(jr.id)));for(const yr of F){const jr=St(yr.productId);if(!jr)continue;const Bn=bi(yr.packages),yn=bi(jr.packages),mn=Bn-yn;if(mn<0){const ua=Math.abs(mn),ga=bi(jr.remainingPackages);if(ua>ga)return m(` No pods bajar "${yr.productName}" en ${ua} porque solo quedan ${ga} paquetes restantes.`);await GQe({vendorInventoryId:jr.id,packagesToReturn:ua})}}}const tn=new Map;let Gr="";for(const Ir of Qt){const yr=Jt(Ir),jr=yr.newPacks-yr.oldPacks;if(yr.packsChanged&&jr>0)try{const{allocations:Bn}=await dG({productId:Ir.productId,packagesToAllocate:jr});tn.set(Ir.productId,Bn||[])}catch{const yn=v.find(mn=>mn.id===Ir.productId)||null;if(yn!=null&&yn.masterOrderId)try{await pF(yn.masterOrderId);const{allocations:mn}=await dG({productId:Ir.productId,packagesToAllocate:jr});tn.set(Ir.productId,mn||[]);continue}catch{const ua=await _e(Ir.productId,Ir.productName);ua.byId===0&&ua.byName>0?Gr=` "${Ir.productName}" no tiene inventario por ID (${Ir.productId}). Pero existe por nombre: ${ua.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Gr=` No hay paquetes disponibles en orden maestra para "${Ir.productName}". Disponibles: ${ua.byId}.`;break}{const mn=await _e(Ir.productId,Ir.productName);mn.byId===0&&mn.byName>0?Gr=` "${Ir.productName}" no tiene inventario por ID (${Ir.productId}). Pero existe por nombre: ${mn.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Gr=` No hay paquetes disponibles en orden maestra para "${Ir.productName}". Disponibles: ${mn.byId}.`}break}}if(Gr)return Q(!1),m(Gr);if(await Gs(Ie,async Ir=>{for(const yr of Qt){const jr=Jt(yr),Bn=jr.prev;if(B&&Bn&&!jr.packsChanged){const R=yr.vendorMarginPercent!=null?yr.vendorMarginPercent:_r,je=Number(Bn.grossProfit??yr.grossProfit??0),ut=Number(Bn.logisticAllocated??yr.logisticAllocated??0),wt=sd(je,R),Vt=Number(je||0)-Number(ut||0)-Number(wt.uVendor||0),Ar=Zt(Ie,"inventory_candies_sellers",yr.id);Ir.update(Ar,{vendorMarginPercent:wt.vendorMarginPercent,uVendor:wt.uVendor,uInvestor:wt.uInvestor,uNeta:Vt,vendorProfit:wt.uVendor});continue}const yn=bi(yr.packages),mn=bi(yr.unitsPerPackage),ua=yn*mn,ga=Bn?bi(Bn.packages):0,Yi=Bn?bi(Bn.remainingPackages):0,Ji=yn-ga,Fl=Bn?Math.max(0,Yi+Ji):yn,xa=Fl*mn,Qn=v.find(R=>R.id===yr.productId),du=Qn?Se(Qn,vt):Number(yr.pricePerPackage||0),Zi=(Qn?gt(Qn,vt):0)*yn,Rc=Qn?Qn.logisticAllocatedPerPack*yn:yr.logisticAllocated||0,dc=(Qn?Et(Qn,vt):0)*yn,ol=yr.vendorMarginPercent!=null?yr.vendorMarginPercent:_r,fu=sd(Zi,ol),KA=Number(Zi||0)-Number(Rc||0)-Number(fu.uVendor||0),ll=((Qn==null?void 0:Qn.unitPriceRivas)||yr.unitPriceRivas||0)*yn,Lc=((Qn==null?void 0:Qn.unitPriceSanJorge)||yr.unitPriceSanJorge||0)*yn,Bf=((Qn==null?void 0:Qn.unitPriceIsla)||yr.unitPriceIsla||0)*yn,fo={sellerId:tt.id,sellerName:tt.name,sellerEmail:tt.email||"",branch:tt.branch||"",branchLabel:tt.branchLabel||"",orderName:String(de||"").trim(),productId:yr.productId,productName:yr.productName,category:yr.category,orderId:or,date:z,createdAt:ar,packages:yn,unitsPerPackage:mn,totalUnits:ua,remainingPackages:Fl,remainingUnits:xa,totalRivas:ll,totalSanJorge:Lc,totalIsla:Bf,unitPriceRivas:(Qn==null?void 0:Qn.unitPriceRivas)||yr.unitPriceRivas||0,unitPriceSanJorge:(Qn==null?void 0:Qn.unitPriceSanJorge)||yr.unitPriceSanJorge||0,unitPriceIsla:(Qn==null?void 0:Qn.unitPriceIsla)||yr.unitPriceIsla||0,grossProfit:Zi,logisticAllocated:Rc,vendorMarginPercent:fu.vendorMarginPercent,uVendor:fu.uVendor,uNeta:KA,uAproximada:dc,uInvestor:fu.uInvestor,providerPrice:Number(yr.providerPrice??(Qn==null?void 0:Qn.providerPrice)??0),vendorProfit:fu.uVendor,transferDelta:Bn?Number(Bn.transferDelta||0):0},zu=tn.get(yr.productId)||[];if(B)if(String(yr.id||"").startsWith("tmp_")){const R=Zt(yt(Ie,"inventory_candies_sellers"));fo.masterAllocations=zu,Ir.set(R,fo)}else{const R=Zt(Ie,"inventory_candies_sellers",yr.id);zu.length>0&&(fo.masterAllocations=Pee(...zu)),Ir.set(R,fo,{merge:!0})}else{const R=Zt(yt(Ie,"inventory_candies_sellers"));fo.masterAllocations=zu,Ir.set(R,fo)}}}),B&&It){const Ir=new Set(Ut.map(jr=>jr.id)),yr=tu(Ie);mt.forEach(jr=>{Ir.has(jr.id)||yr.update(Zt(Ie,"inventory_candies_sellers",jr.id),{orderName:At,updatedAt:vr.now()})}),await yr.commit(),I(jr=>jr.map(Bn=>xe(Bn)===B?{...Bn,orderName:At}:Bn))}m(" Pedido guardado."),E(!1),Dt(),s()}catch(tt){console.error(tt),m(" Error guardando el pedido.")}finally{Q(!1)}},Zr=async fe=>{try{if(m(""),!l)return m(" Solo admin.");Q(!0);const tt=Pe.filter(vt=>xe(vt)===fe);for(const vt of tt)await fG(vt.id);m(" Pedido eliminado."),s()}catch(tt){console.error(tt),m(" Error eliminando pedido.")}finally{Q(!1)}},Wr=Ui.useRef(null),zr=()=>{var fe;if(d)return m(" Solo lectura.");if(!P)return m(" Seleccion un vendedor.");if(!z)return m(" Seleccion una fecha.");(fe=Wr.current)==null||fe.click()},gn=async fe=>{var vt;const tt=(vt=fe.target.files)==null?void 0:vt[0];fe.target.value="",tt&&await $r(tt)},Nn=!l,Sn=l?12:9;return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-3 mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-lg md:text-2xl font-semibold",children:"rdenes de Vendedor (Dulces)"}),i.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Pedidos agrupados por vendedor + fecha. U. Bruta viene de la orden maestra. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(Oc,{onClick:s}),l&&i.jsx("button",{onClick:()=>Ue(!0),className:"px-3 py-2 rounded bg-amber-600 text-white text-sm hover:bg-amber-700",children:"Traslados"}),!d&&i.jsx("button",{onClick:rr,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo pedido"})]})]}),h&&!S&&i.jsx("div",{className:"mb-3 p-2 rounded border text-sm bg-white",children:h}),f?i.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"hidden md:block bg-white border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:U.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:()=>{if(!S){m(" Abr un pedido para exportar productos asociados.");return}Pr()},children:"Exportar asociados"}),l&&i.jsx(i.Fragment,{children:i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:ir,disabled:ee,children:ee?"Actualizando campos...":"Actualizar campos calculados"})})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Nombre"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Asociados"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Salida"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Entrada"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[te.map(fe=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:fe.orderName||""}),i.jsx("td",{className:"p-2 border-b",children:fe.date}),i.jsx("td",{className:"p-2 border-b",children:fe.sellerName}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.totalPackages}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.totalRemainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(fe.totalExpectedActive??fe.totalExpected)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(fe.grossProfitActive??fe.grossProfit)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni((fe.gastosActive??fe.gastos)||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(fe.vendorProfitActive??fe.vendorProfit)}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.transferredOut}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.transferredIn}),i.jsx("td",{className:"p-2 border-b",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded bg-gray-900 text-white text-xs hover:bg-black",onClick:()=>Ot(fe.orderKey),children:"Ver / Editar"}),l&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este pedido completo?")&&Zr(fe.orderKey)},children:"Eliminar"})]})})]},fe.orderKey)),!te.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:Sn,children:"No hay pedidos."})})]})]})}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina ",X," / ",ye]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Ve,disabled:X<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:qe,disabled:X>=ye,children:""})]})]})]}),i.jsxs("div",{className:"md:hidden space-y-2",children:[i.jsxs("div",{className:"bg-white border rounded p-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:U.length})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:[X,"/",ye]})]}),te.map(fe=>i.jsxs("div",{className:"bg-white border rounded",role:"button",tabIndex:0,onClick:()=>Ot(fe.orderKey),onKeyDown:tt=>{(tt.key==="Enter"||tt.key===" ")&&(tt.preventDefault(),Ot(fe.orderKey))},children:[i.jsxs("div",{className:"p-2 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:fe.sellerName}),i.jsxs("div",{className:"text-xs text-gray-600",children:[fe.orderName||"","  ",fe.date]})]}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm text-red-600",onClick:tt=>{tt.stopPropagation(),confirm("Eliminar este pedido completo?")&&Zr(fe.orderKey)},children:"Eliminar"})]}),i.jsx("div",{className:"px-2 pb-2",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Asociados"}),i.jsx("div",{className:"font-semibold",children:fe.totalPackages})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Restantes"}),i.jsx("div",{className:"font-semibold",children:fe.totalRemainingPackages})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:ni(fe.totalExpectedActive??fe.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:ni(fe.vendorProfitActive??fe.vendorProfit)})]})]})})]},fe.orderKey)),!te.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 bg-white border rounded",children:"No hay pedidos."}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:Ve,disabled:X<=1,children:""}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:qe,disabled:X>=ye,children:""})]})]})]}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3 md:p-6",children:i.jsxs("div",{className:"bg-white w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded shadow relative",children:[D&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"text-sm font-semibold",children:"Guardando"})}),i.jsxs("div",{className:"p-3 md:p-5 border-b flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-semibold",children:B?"Editar pedido":"Nuevo pedido"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Nombre: ",de||""]}),i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta viene de Orden Maestra. U. Vendedor e Inversionista se calculan aqu. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:zt,children:"Cerrar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:cr,children:"Guardar"})]})]}),i.jsxs("div",{className:"p-3 md:p-5 space-y-3",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Ye(fe=>!fe),children:[i.jsx("span",{children:"Filtros y KPIs"}),i.jsx("span",{children:M?"":"+"})]}),i.jsxs("div",{className:`${M?"block":"hidden"} md:block space-y-3`,children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[i.jsxs("div",{className:"md:col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Nombre"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:de,onChange:fe=>ue(fe.target.value),placeholder:"Nombre de la orden",disabled:d})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:P,onChange:fe=>O(fe.target.value),disabled:Nn,children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),p.map(fe=>i.jsxs("option",{value:fe.id,children:[fe.name," ",fe.branch?`(${fe.branch})`:""]},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",value:z,onChange:fe=>ce(fe.target.value)})]}),i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:xr,children:"Plantilla"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:zr,children:"Importar Excel"}),i.jsx("input",{ref:Wr,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:gn})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. asociados"}),i.jsx("div",{className:"text-lg font-semibold",children:He.totalPackages})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(He.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(He.grossProfit)})]})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(He.uVendor)})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"text-lg font-semibold",children:ni(pt)})]})]})]}),i.jsxs("div",{className:"border rounded p-3 space-y-2",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Mt(fe=>!fe),children:[i.jsx("span",{children:"Agregar producto"}),i.jsx("span",{children:jt?"":"+"})]}),i.jsxs("div",{className:`${jt?"block":"hidden"} md:block space-y-2`,children:[i.jsx("div",{className:"text-sm font-semibold hidden md:block",children:"Agregar producto"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-2",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:K,onChange:fe=>L(fe.target.value),placeholder:"Buscar por categora o nombre"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:me,onChange:fe=>se(fe.target.value),children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),_t.map(fe=>i.jsxs("option",{value:fe.id,children:[fe.category," - ",fe.name," (exist:"," ",b[fe.id]??0,")"]},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:ke,onChange:fe=>Re(fe.target.value),inputMode:"numeric"})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{className:"w-full px-3 py-2 rounded bg-gray-900 text-white text-sm hover:bg-black",onClick:lr,disabled:!pe,children:"Agregar"})})]})]})]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm font-semibold",children:["Productos asociados (",F.length,")"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Buscar producto",value:W,onChange:fe=>{Y(fe.target.value),Xe(1)}}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Pr,disabled:!F.length,children:"Exportar Excel"})]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Categora"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Producto"}),i.jsxs("th",{className:"text-right p-2 border-b",children:["P. Asociados"," "]}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Precio prov."}),i.jsx("th",{className:"text-right p-2 border-b",children:"Precio/paq"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"})]}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Neta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Margen (%)"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Z.map(fe=>{const{totalExpected:tt,grossProfit:vt,gastos:mt,uVendor:Oe,uNeta:At}=ne(fe);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:fe.category}),i.jsx("td",{className:"p-2 border-b",children:fe.productName}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsx("span",{children:fe.packages}):Ne[fe.id]?i.jsx("input",{className:"w-20 border rounded p-1 text-right",value:String(fe.packages),onChange:It=>br(fe.id,It.target.value),onBlur:()=>at(fe.id),onKeyDown:It=>{(It.key==="Enter"||It.key==="Escape")&&at(fe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:fe.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Be(fe.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.remainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(fe.providerPrice||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(fe.pricePerPackage)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(tt)}),l&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border-b text-right",children:ni(vt)}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(mt)})]}),i.jsx("td",{className:"p-2 border-b text-right",children:ni(Oe)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ni(At)}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsxs("span",{children:[Number(fe.vendorMarginPercent??Nt(P)).toFixed(3),"%"]}):Ce[fe.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-20 border rounded p-1 text-right",value:String(fe.vendorMarginPercent??Nt(P)),onChange:It=>nr(fe.id,It.target.value),onBlur:()=>dt(fe.id),onKeyDown:It=>{(It.key==="Enter"||It.key==="Escape")&&dt(fe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{children:[Number(fe.vendorMarginPercent??Nt(P)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>lt(fe.id),"aria-label":"Editar margen",children:""})]})}),i.jsx("td",{className:"p-2 border-b",children:!d&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este producto?")&&Dr(fe.id)},children:""})})]},fe.id)}),!Z.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:l?13:9,children:"No hay productos asociados."})})]})]})}),i.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[re.map(([fe,tt])=>{const vt=!!it[fe];return i.jsxs("div",{className:"border rounded",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-2 flex items-center justify-between text-sm",onClick:()=>we(fe),children:[i.jsx("span",{className:"font-semibold",children:fe}),i.jsxs("span",{className:"text-xs text-gray-600",children:[tt.length," ",tt.length===1?"producto":"productos"]})]}),vt&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:tt.map(mt=>{const{totalExpected:Oe,grossProfit:At,gastos:It,uVendor:Ct,uNeta:bt}=ne(mt);return i.jsxs("div",{className:"border rounded p-2 text-xs space-y-2",children:[i.jsx("div",{className:"font-semibold text-sm",children:mt.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes"}),d?i.jsx("div",{className:"font-semibold",children:mt.packages}):Ne[mt.id]?i.jsx("input",{className:"w-full border rounded p-1 text-right",value:String(mt.packages),onChange:St=>br(mt.id,St.target.value),onBlur:()=>at(mt.id),onKeyDown:St=>{(St.key==="Enter"||St.key==="Escape")&&at(mt.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:mt.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Be(mt.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:mt.remainingPackages})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Precio/paq"}),i.jsx("div",{className:"font-semibold",children:ni(mt.pricePerPackage)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:ni(Oe)})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"font-semibold",children:ni(At)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Gastos"}),i.jsx("div",{className:"font-semibold",children:ni(It)})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:ni(Ct)})]}),l&&i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"font-semibold",children:ni(bt)})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-gray-600",children:"Margen (%)"}),d?i.jsxs("div",{className:"font-semibold",children:[Number(mt.vendorMarginPercent??Nt(P)).toFixed(3),"%"]}):Ce[mt.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-full border rounded p-1 text-right",value:String(mt.vendorMarginPercent??Nt(P)),onChange:St=>nr(mt.id,St.target.value),onBlur:()=>dt(mt.id),onKeyDown:St=>{(St.key==="Enter"||St.key==="Escape")&&dt(mt.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{className:"font-semibold",children:[Number(mt.vendorMarginPercent??Nt(P)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>lt(mt.id),"aria-label":"Editar margen",children:""})]})]}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>{confirm("Eliminar este producto?")&&Dr(mt.id)},children:""})]})]},mt.id)})})]},fe)}),!Z.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 text-center",children:"No hay productos asociados."})]}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina items ",$e," / ",V]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Fe,disabled:$e<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:st,disabled:$e>=V,children:""})]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center md:justify-between",children:[i.jsx("div",{className:"text-xs text-gray-600",children:B?i.jsxs(i.Fragment,{children:["Editando: ",i.jsx("b",{children:B})]}):i.jsx(i.Fragment,{children:"Nuevo pedido (an no guardado)"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:zt,children:"Cancelar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:cr,children:"Guardar pedido"})]})]}),h&&i.jsx("div",{className:"text-sm text-gray-700",children:h})]})]})}),i.jsx(WQe,{open:ie,onClose:()=>Ue(!1),orders:U,rows:j,setRows:I,isAdmin:l,currentUserEmail:r||"",currentUserName:"",sellerCandyId:e,sellers:p,products:v,transferAgg:Ft,setTransferAgg:$t,setTransferRowDeltas:Ge})]})}const na=t=>Math.max(0,Math.floor(Number(t)||0)),Lb=t=>Math.round(t||0);function Mse(t){const e=Math.max(1,na(t.unitsPerPackage||1)),r=na(t.totalUnits||0),n=na(t.quantity||0),a=na(t.packages||0);return r>0?r:n>0?n:a>0?a*e:0}function YQe(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Mse(t)}function yG(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,na(t.unitsPerPackage||1)),n=YQe(t);return Math.max(0,Math.floor(n/r))}function JQe(t){const e=Math.max(1,na(t.unitsPerPackage||1)),r=Mse(t);return Math.max(0,Math.floor(r/e))}function Ub(t){return String(t??"").trim().toLowerCase().replace(/\s+/g," ")}function Lf(t){const e=String(t??"").trim();if(!e)return 0;const r=e.replace(/,/g,"."),n=Number(r);return Number.isFinite(n)?n:0}function kh(t,e){const r={};Object.keys(t||{}).forEach(n=>r[Ub(n)]=t[n]);for(const n of e){const a=r[Ub(n)];if(a!=null&&String(a).trim()!=="")return a}}function tp(t,e,r){const n=t*e,a=Math.min(Math.max(r.marginR,0),99.9)/100,s=Math.min(Math.max(r.marginSJ,0),99.9)/100,o=Math.min(Math.max(r.marginIsla,0),99.9)/100,l=e>0&&a<1?n/(1-a):n,c=e>0&&s<1?n/(1-s):n,u=e>0&&o<1?n/(1-o):n,d=l-n,f=c-n,A=u-n,h=e>0?Lb(l/e):0,m=e>0?Lb(c/e):0,p=e>0?Lb(u/e):0;return{subtotal:n,totalRivas:l,totalSanJorge:c,totalIsla:u,gainRivas:d,gainSanJorge:f,gainIsla:A,unitPriceRivas:h,unitPriceSanJorge:m,unitPriceIsla:p}}function ZQe(t){return Number(t.gainRivas||0)}function eVe(t){return Number(t.gainIsla||0)}function aB(t,e,r){const n=ZQe(t),a=eVe(t),s=Number(t.subtotal||0),o=e>0&&r>0?e*s/r:0;return{...t,grossProfit:n,grossProfitIsla:a,logisticAllocated:o}}function tVe(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(""),[a,s]=g.useState(!0),[o,l]=g.useState(!1),[c,u]=g.useState(!1),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState({}),[w,j]=g.useState(!1),[I,_]=g.useState(null),[S,E]=g.useState(""),[B,T]=g.useState(""),[P,O]=g.useState("20"),[z,ce]=g.useState("15"),[de,ue]=g.useState("30"),[me,se]=g.useState("0"),[ke,Re]=g.useState([]),[F,H]=g.useState({}),[K,L]=g.useState({}),[W,Y]=g.useState({}),[D,Q]=g.useState({}),ee=ne=>H(He=>({...He,[ne]:!0})),ve=ne=>H(He=>({...He,[ne]:!1})),M=ne=>L(He=>({...He,[ne]:!0})),Ye=ne=>L(He=>({...He,[ne]:!1})),ae=ne=>Y(He=>({...He,[ne]:!0})),X=ne=>Y(He=>({...He,[ne]:!1})),De=ne=>Q(He=>({...He,[ne]:!0})),le=ne=>Q(He=>({...He,[ne]:!1})),$e=g.useRef(new Set),[Xe,it]=g.useState(""),[xt,jt]=g.useState(""),[Mt,Ft]=g.useState(""),[$t,kt]=g.useState("1"),[Ge,ie]=g.useState("0"),[Ue,Ne]=g.useState("DATOS"),[be,Ce]=g.useState(""),[Le,Ae]=g.useState(1),We=15,ct=g.useMemo(()=>Math.max(1,Math.ceil(x.length/We)),[x.length]);g.useEffect(()=>Ae(1),[x.length]);const _t=g.useMemo(()=>{const ne=(Le-1)*We;return x.slice(ne,ne+We)},[x,Le]),pe=g.useMemo(()=>{const ne=new Set;for(const He of A){const pt=String(He.category||"").trim();pt&&ne.add(pt)}return Array.from(ne).sort((He,pt)=>He.localeCompare(pt,"es"))},[A]);g.useEffect(()=>{!Xe&&pe.length>0&&it(pe[0])},[pe]);const Pe=async()=>{p(!0);try{const ne=await Ht(sr(yt(Ie,"products_candies"),In("createdAt","desc"))),He=[];ne.forEach(pt=>{const Dt=pt.data();He.push({id:pt.id,name:String(Dt.name??"").trim(),category:String(Dt.category??"").trim()||"Caramelo",providerPrice:Number(Dt.providerPrice??0),unitsPerPackage:Number(Dt.unitsPerPackage??1)})}),h(He)}catch(ne){console.error(ne),n(" Error cargando catlogo de dulces.")}finally{p(!1)}};g.useEffect(()=>{Pe()},[t]);const Ee=g.useMemo(()=>(Xe.trim().length>0?A.filter(He=>He.category===Xe):A).sort((He,pt)=>He.name.localeCompare(pt.name,"es")),[A,Xe]);g.useEffect(()=>{if(!xt){Ft(""),kt("1");return}const ne=A.find(He=>He.id===xt);ne&&(Ft(String(ne.providerPrice??0)),kt(String(ne.unitsPerPackage??1)))},[xt,A]);const Ze=()=>{_(null),E(""),T(""),Re([]),H({}),L({}),Y({}),Q({}),$e.current=new Set,it(pe[0]||""),jt(""),Ft(""),ie("0"),kt("1"),O("20"),ce("15"),ue("30"),se("0"),Ne("DATOS"),Ce("")},xe=()=>{if(n(""),!xt){n("Selecciona un producto del catlogo.");return}const ne=A.find(br=>br.id===xt);if(!ne){n("Producto de catlogo no encontrado (refresca).");return}if(I&&!$e.current.has(ne.id)){n(" En edicin no se pueden agregar productos nuevos. Solo ajustar los existentes.");return}const He=Number(ne.providerPrice||0),pt=na(Ge||0),Dt=na(ne.unitsPerPackage||0);if(He<0){n("El precio proveedor no puede ser negativo.");return}if(pt<=0){n("Los paquetes deben ser mayor que 0.");return}if(Dt<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const rr=Number(P||0),zt=Number(z||0),Ot=Number(de||0),lr=tp(He,pt,{marginR:rr,marginSJ:zt,marginIsla:Ot});if(ke.find(br=>br.id===ne.id))Re(br=>br.map(nr=>{if(nr.id!==ne.id)return nr;const ir=na(nr.packages||0)+pt,Nr=tp(He,ir,{marginR:Number(nr.marginRivas??rr),marginSJ:Number(nr.marginSanJorge??zt),marginIsla:Number(nr.marginIsla??Ot)}),xr=na(nr.remainingPackages??nr.packages)+pt;return{...nr,providerPrice:He,unitsPerPackage:Dt,packages:ir,remainingPackages:xr,...Nr}}));else{const br={id:ne.id,name:ne.name,category:ne.category,providerPrice:He,packages:pt,unitsPerPackage:Dt,marginRivas:rr,marginSanJorge:zt,marginIsla:Ot,subtotal:lr.subtotal,totalRivas:lr.totalRivas,totalSanJorge:lr.totalSanJorge,totalIsla:lr.totalIsla,gainRivas:lr.gainRivas,gainSanJorge:lr.gainSanJorge,gainIsla:lr.gainIsla,unitPriceRivas:lr.unitPriceRivas,unitPriceSanJorge:lr.unitPriceSanJorge,unitPriceIsla:lr.unitPriceIsla,remainingPackages:pt};Re(nr=>[...nr,br])}jt(""),ie("0"),Ne("ITEMS")},Se=ne=>{Re(He=>He.filter(pt=>pt.id!==ne))},gt=(ne,He,pt)=>{Re(Dt=>Dt.map(rr=>{if(rr.id!==ne)return rr;let zt={...rr};if(He==="packages"&&(zt.packages=na(pt||0)),He==="unitsPerPackage"&&(zt.unitsPerPackage=na(pt||0)),He==="marginRivas"&&(zt.marginRivas=Number(pt||0)),He==="marginIsla"&&(zt.marginIsla=Number(pt||0)),He==="marginSanJorge"&&(zt.marginSanJorge=Number(pt||0)),He==="packages"||He==="marginRivas"||He==="marginIsla"||He==="marginSanJorge"){const Ot=tp(zt.providerPrice,zt.packages,{marginR:Number(zt.marginRivas||0),marginSJ:Number(zt.marginSanJorge||0),marginIsla:Number(zt.marginIsla||0)});zt={...zt,...Ot}}return(zt.remainingPackages===void 0||zt.remainingPackages===null)&&(zt.remainingPackages=zt.packages),zt}))},Et=g.useMemo(()=>{const ne=ke.reduce((zt,Ot)=>zt+na(Ot.packages),0),He=ke.reduce((zt,Ot)=>zt+Number(Ot.subtotal||0),0),pt=ke.reduce((zt,Ot)=>zt+Number(Ot.totalRivas||0),0),Dt=ke.reduce((zt,Ot)=>zt+Number(Ot.totalSanJorge||0),0),rr=ke.reduce((zt,Ot)=>zt+Number(Ot.totalIsla||0),0);return{totalPackages:ne,subtotal:He,totalRivas:pt,totalSanJorge:Dt,totalIsla:rr}},[ke]),Nt=g.useMemo(()=>{const ne=Math.max(0,Lf(me||0)),He=Number(Et.subtotal||0),pt=ke.map(Ot=>aB(Ot,ne,He)),Dt=pt.reduce((Ot,lr)=>Ot+Number(lr.grossProfit||0),0),rr=pt.reduce((Ot,lr)=>Ot+Number(lr.grossProfitIsla||0),0),zt=pt.reduce((Ot,lr)=>Ot+Number(lr.logisticAllocated||0),0);return{items:pt,logisticsTotal:ne,grossTotal:Dt,grossIslaTotal:rr,logisticAllocatedTotal:zt}},[ke,me,Et.subtotal]),Tt=g.useMemo(()=>{const ne=String(be||"").trim().toLowerCase();return ne?Nt.items.filter(He=>{const pt=String(He.name||"").toLowerCase(),Dt=String(He.category||"").toLowerCase();return pt.includes(ne)||Dt.includes(ne)}):Nt.items},[Nt.items,be]),[Lt,Me]=g.useState(1),_e=15,U=g.useMemo(()=>Math.max(1,Math.ceil(Tt.length/_e)),[Tt.length]);g.useEffect(()=>Me(1),[Tt.length]);const ye=g.useMemo(()=>{const ne=(Lt-1)*_e;return Tt.slice(ne,ne+_e)},[Tt,Lt]),[te,Ve]=g.useState({});g.useEffect(()=>Ve({}),[Tt.length]);const[qe,G]=g.useState({});g.useEffect(()=>{const ne={};for(const He of x)He&&He.id&&(ne[He.id]=!1);G(ne)},[x]);const V=g.useMemo(()=>({totalPackages:Et.totalPackages,subtotalCosto:Et.subtotal,esperadoRivas:Et.totalRivas,esperadoIsla:Et.totalIsla,gastosLogisticos:Nt.logisticsTotal,utilidadBrutaRivas:Nt.grossTotal,utilidadBrutaIsla:Nt.grossIslaTotal}),[Et,Nt]),Z=()=>{if(n(""),!A.length){n(" No hay catlogo cargado para generar plantilla.");return}const ne=Number(P||0),He=Number(de||0),pt=A.slice().sort((Dr,br)=>Dr.name.localeCompare(br.name,"es")).map(Dr=>({Producto:Dr.name,Paquetes:"","Margen rivas":ne,"Margen Isla":He,"P. unidad Rivas":"","P. unidad Isla":""})),Dt=[{Campo:"Gastos logisticos",Valor:Lf(me||0)}],rr=Qa.book_new(),zt=Qa.json_to_sheet(pt),Ot=Qa.json_to_sheet(Dt);Qa.book_append_sheet(rr,zt,"Productos"),Qa.book_append_sheet(rr,Ot,"Config");const lr=B&&String(B).trim()||new Date().toISOString().slice(0,10);V2(rr,`plantilla_orden_maestra_${lr}.xlsx`)},re=()=>{if(n(""),!Nt.items.length){n(" No hay items para exportar.");return}const ne=Nt.items.slice().sort((zt,Ot)=>zt.name.localeCompare(Ot.name,"es")).map(zt=>({Categora:zt.category,Producto:zt.name,Paquetes:na(zt.packages),"Paquetes restantes":na(zt.remainingPackages??zt.packages),"Und x Paquete":na(zt.unitsPerPackage),"Precio proveedor":Number(zt.providerPrice||0),Facturado:Number(zt.subtotal||0),"Esperado Rivas":Number(zt.totalRivas||0),"Esperado Isla":Number(zt.totalIsla||0),"MV Rivas":Number(zt.marginRivas||0),"MV Isla":Number(zt.marginIsla||0),"Utilidad Bruta":Number(zt.grossProfit||0),"Utilidad Bruta Isla":Number(zt.grossProfitIsla||0),"Prorrateo logistico":Number(zt.logisticAllocated||0),"Precio Rivas":Number(zt.unitPriceRivas||0),"Precio Isla":Number(zt.unitPriceIsla||0)})),He=[{KPI:"Paquetes totales",Valor:V.totalPackages},{KPI:"Subtotal costo",Valor:V.subtotalCosto},{KPI:"Esperado Rivas",Valor:V.esperadoRivas},{KPI:"Esperado Isla",Valor:V.esperadoIsla},{KPI:"Gastos logsticos",Valor:V.gastosLogisticos},{KPI:"Utilidad Bruta Rivas",Valor:V.utilidadBrutaRivas},{KPI:"Utilidad Bruta Isla",Valor:V.utilidadBrutaIsla}],pt=Qa.book_new();Qa.book_append_sheet(pt,Qa.json_to_sheet(ne),"Productos"),Qa.book_append_sheet(pt,Qa.json_to_sheet(He),"Resumen");const Dt=B&&String(B).trim()||new Date().toISOString().slice(0,10),rr=S&&String(S).trim()||`Orden_${Dt}`;V2(pt,`orden_maestra_${rr.replace(/[^\w\-]+/g,"_")}_${Dt}.xlsx`)},we=g.useRef(null),[Fe,st]=g.useState(!1),Be=()=>{var ne;if(!A.length){n(" Catlogo no cargado todava. Esper y prob de nuevo.");return}(ne=we.current)==null||ne.click()},at=async ne=>{var pt;const He=(pt=ne.target.files)==null?void 0:pt[0];if(He){ne.target.value="",st(!0),n("");try{const Dt=await He.arrayBuffer(),rr=Vv(Dt,{type:"array"}),zt=rr.SheetNames||[],Ot=rr.Sheets.Productos||rr.Sheets.Plantilla||rr.Sheets[zt[0]];if(!Ot){n(" No se encontr hoja de Productos/Plantilla.");return}const lr=Qa.sheet_to_json(Ot,{defval:""});if(!lr.length){n(" El Excel viene vaco.");return}let Dr=0;const br=rr.Sheets.Config;if(br){const xr=Qa.sheet_to_json(br,{defval:""}),$r=new Map;for(const cr of xr){const Zr=Ub(kh(cr,["Campo","Key","Nombre"])??""),Wr=kh(cr,["Valor","Value"]);Zr&&$r.set(Zr,Wr)}$r.has("gastos logisticos")&&(Dr=Math.max(0,Lf($r.get("gastos logisticos"))))}else for(const xr of lr){const $r=kh(xr,["Gastos","Gasto","Gastos logisticos","Logistica"]),cr=Lf($r);if(cr>0){Dr=cr;break}}se(String(Dr||0));const nr=new Map;for(const xr of A)nr.set(Ub(xr.name),xr);const ir=[],Nr=new Map;for(let xr=0;xr<lr.length;xr++){const $r=lr[xr],cr=kh($r,["Producto","Product","Nombre","Name"]),Zr=kh($r,["Paquetes","Packages"]),Wr=kh($r,["Margen rivas","Margen Rivas","MV Rivas"]),zr=kh($r,["Margen Isla","Margen isla","MV Isla"]),gn=kh($r,["P. unidad Rivas","P unidad Rivas","Precio Rivas"]),Nn=kh($r,["P. unidad Isla","P unidad Isla","Precio Isla"]),Sn=Ub(cr);if(!Sn)continue;const fe=nr.get(Sn);if(!fe){ir.push(`Fila ${xr+2}: Producto no existe en catlogo: "${String(cr).trim()}".`);continue}if(I&&!$e.current.has(fe.id)){ir.push(`Fila ${xr+2}: No se permiten productos nuevos en edicin ("${fe.name}").`);continue}const tt=Math.floor(Lf(Zr));if(tt<=0){ir.push(`Fila ${xr+2}: "Paquetes" invlido para "${fe.name}".`);continue}const vt=String(Wr??"").trim()!==""?Lf(Wr):Number(P||0),mt=String(zr??"").trim()!==""?Lf(zr):Number(de||0),Oe=Math.floor(Lf(gn)),At=Math.floor(Lf(Nn)),It=Nr.get(fe.id);It?Nr.set(fe.id,{packages:It.packages+tt,mR:vt,mI:mt,puR:Oe>0?Oe:It.puR,puI:At>0?At:It.puI}):Nr.set(fe.id,{packages:tt,mR:vt,mI:mt,puR:Oe>0?Oe:void 0,puI:At>0?At:void 0})}const Pr=[];Nr.forEach((xr,$r)=>{const cr=A.find(At=>At.id===$r);if(!cr)return;const Zr=Number(cr.providerPrice||0),Wr=Math.max(1,na(cr.unitsPerPackage||1)),zr=Math.max(1,na(xr.packages)),gn=Zr*zr,Nn=Number(xr.puR||0),Sn=Number(xr.puI||0),fe=Nn>0||Sn>0;let tt=xr.mR,vt=xr.mI;const mt=Number(z||0);let Oe;if(fe){const At=tp(Zr,zr,{marginR:tt,marginSJ:mt,marginIsla:vt}),It=Nn>0?Nn*zr:At.totalRivas,Ct=Sn>0?Sn*zr:At.totalIsla,bt=St=>{if(!Number.isFinite(St)||St<=0)return 0;const Jt=(1-gn/St)*100;return Math.min(Math.max(Jt,0),99.9)};Nn>0&&(tt=bt(It)),Sn>0&&(vt=bt(Ct)),Oe={subtotal:gn,totalRivas:It,totalSanJorge:At.totalSanJorge,totalIsla:Ct,gainRivas:It-gn,gainSanJorge:At.gainSanJorge,gainIsla:Ct-gn,unitPriceRivas:zr>0?Lb(It/zr):0,unitPriceSanJorge:At.unitPriceSanJorge,unitPriceIsla:zr>0?Lb(Ct/zr):0}}else Oe=tp(Zr,zr,{marginR:tt,marginSJ:mt,marginIsla:vt});Pr.push({id:cr.id,name:cr.name,category:cr.category,providerPrice:Zr,packages:zr,unitsPerPackage:Wr,marginRivas:tt,marginSanJorge:mt,marginIsla:vt,subtotal:Oe.subtotal,totalRivas:Oe.totalRivas,totalSanJorge:Oe.totalSanJorge,totalIsla:Oe.totalIsla,gainRivas:Oe.gainRivas,gainSanJorge:Oe.gainSanJorge,gainIsla:Oe.gainIsla,unitPriceRivas:Oe.unitPriceRivas,unitPriceSanJorge:Oe.unitPriceSanJorge,unitPriceIsla:Oe.unitPriceIsla,remainingPackages:zr})}),Re(xr=>{const $r=new Map;xr.forEach(cr=>$r.set(cr.id,cr));for(const cr of Pr){const Zr=$r.get(cr.id);if(!Zr)$r.set(cr.id,cr);else{const Wr=na(Zr.packages)+na(cr.packages),zr=tp(Zr.providerPrice,Wr,{marginR:cr.marginRivas,marginSJ:Number(Zr.marginSanJorge||0),marginIsla:cr.marginIsla});$r.set(cr.id,{...Zr,packages:Wr,marginRivas:cr.marginRivas,marginIsla:cr.marginIsla,remainingPackages:na(Zr.remainingPackages??Zr.packages)+na(cr.packages),...zr})}}return Array.from($r.values()).sort((cr,Zr)=>cr.name.localeCompare(Zr.name,"es"))}),Ne("ITEMS"),ir.length?(n(` Importado con detalles. Errores: ${ir.length}.`),console.warn("Errores import:",ir)):n(` Importacin lista: ${Pr.length} productos agregados.`)}catch(Dt){console.error(Dt),n(" Error importando Excel. Revis hojas: Productos + Config (o Plantilla).")}finally{st(!1)}}};g.useEffect(()=>{(async()=>{s(!0);try{const ne=sr(yt(Ie,"candy_main_orders"),In("createdAt","desc")),He=await Ht(ne),pt=[];He.forEach(zt=>{const Ot=zt.data();pt.push({id:zt.id,name:Ot.name??"",date:Ot.date??"",totalPackages:Number(Ot.totalPackages??0),subtotal:Number(Ot.subtotal??0),totalRivas:Number(Ot.totalRivas??0),totalSanJorge:Number(Ot.totalSanJorge??0),totalIsla:Number(Ot.totalIsla??0),marginRivas:Number(Ot.marginRivas??20),marginSanJorge:Number(Ot.marginSanJorge??15),marginIsla:Number(Ot.marginIsla??30),logisticsCost:Number(Ot.logisticsCost??0),createdAt:Ot.createdAt??vr.now()})}),v(pt);const Dt=await Ht(yt(Ie,"inventory_candies")),rr={};Dt.forEach(zt=>{const Ot=zt.data(),lr=Ot.orderId;if(!lr)return;const Dr=JQe(Ot),br=yG(Ot);rr[lr]||(rr[lr]={orderId:lr,totalPackages:0,remainingPackages:0}),rr[lr].totalPackages+=Dr,rr[lr].remainingPackages+=br}),b(rr)}catch(ne){console.error(ne),n(" Error cargando pedidos generales.")}finally{s(!1)}})()},[t]);const lt=ne=>{var He;return ne.date?ne.date:(He=ne.createdAt)!=null&&He.toDate?ne.createdAt.toDate().toISOString().slice(0,10):""},dt=async ne=>{if(ne.preventDefault(),n(""),l(!0),!ke.length){n("Agrega al menos un producto a la orden.");return}try{const He=new Date().toISOString().slice(0,10),pt=B||He,Dt=Number(P||0),rr=Number(z||0),zt=Number(de||0),Ot=Math.max(0,Lf(me||0));for(const xr of ke){if(!String(xr.name||"").trim()){n("Hay un producto sin nombre en el pedido.");return}if(Number(xr.providerPrice||0)<0){n(`El precio proveedor no puede ser negativo (producto: ${xr.name}).`);return}if(na(xr.packages)<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${xr.name}).`);return}if(na(xr.unitsPerPackage)<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${xr.name}).`);return}}if(I){const xr=$e.current;if(ke.some(cr=>!xr.has(cr.id))){n(" No se permiten productos nuevos en edicin. Elimin los nuevos para guardar.");return}}const lr=Number(Et.subtotal||0),Dr=ke.map(xr=>aB(xr,Ot,lr)),br={totalPackages:Et.totalPackages,subtotal:Et.subtotal,totalRivas:Et.totalRivas,totalSanJorge:Et.totalSanJorge,totalIsla:Et.totalIsla},nr={name:S||`Pedido ${pt}`,date:pt,totalPackages:br.totalPackages,subtotal:br.subtotal,totalRivas:br.totalRivas,totalSanJorge:br.totalSanJorge,totalIsla:br.totalIsla,marginRivas:Dt,marginSanJorge:rr,marginIsla:zt,logisticsCost:Ot,uBrutaGlobal:Nt.grossTotal,items:Dr};if(I){await Fn(Zt(Ie,"candy_main_orders",I),{...nr});for(const cr of Dr){const Zr=await Ht(sr(yt(Ie,"inventory_candies"),mr("orderId","==",I),mr("productId","==",cr.id))),Wr=Math.max(1,na(cr.unitsPerPackage||1)),zr=na(cr.packages)*Wr;if(Zr.empty)await Jn(yt(Ie,"inventory_candies"),{productId:cr.id,productName:cr.name,category:cr.category,measurement:"unidad",quantity:zr,remaining:zr,packages:na(cr.packages),remainingPackages:na(cr.packages),unitsPerPackage:Wr,totalUnits:zr,providerPrice:cr.providerPrice,subtotal:cr.subtotal,totalRivas:cr.totalRivas,totalSanJorge:cr.totalSanJorge,totalIsla:cr.totalIsla,gainRivas:cr.gainRivas,gainSanJorge:cr.gainSanJorge,gainIsla:cr.gainIsla,unitPriceRivas:cr.unitPriceRivas,unitPriceSanJorge:cr.unitPriceSanJorge,unitPriceIsla:cr.unitPriceIsla,date:pt,createdAt:vr.now(),status:"PENDIENTE",orderId:I});else for(const gn of Zr.docs){const Nn=gn.data(),Sn=na(Nn.totalUnits??0),fe=na(Nn.remaining??Sn),tt=zr-Sn,vt=Math.max(0,fe+tt),mt=Math.max(0,Math.floor(vt/Wr));await Fn(Zt(Ie,"inventory_candies",gn.id),{productName:cr.name,category:cr.category,unitsPerPackage:Wr,totalUnits:zr,quantity:zr,remaining:vt,packages:na(cr.packages),remainingPackages:mt,providerPrice:cr.providerPrice,subtotal:cr.subtotal,totalRivas:cr.totalRivas,totalSanJorge:cr.totalSanJorge,totalIsla:cr.totalIsla,gainRivas:cr.gainRivas,gainSanJorge:cr.gainSanJorge,gainIsla:cr.gainIsla,unitPriceRivas:cr.unitPriceRivas,unitPriceSanJorge:cr.unitPriceSanJorge,unitPriceIsla:cr.unitPriceIsla,date:pt})}}const xr=await Ht(sr(yt(Ie,"inventory_candies"),mr("orderId","==",I))),$r=new Set(Dr.map(cr=>cr.id));for(const cr of xr.docs){const Zr=cr.data(),Wr=String(Zr.productId||"");Wr&&!$r.has(Wr)&&await Kn(Zt(Ie,"inventory_candies",cr.id))}v(cr=>cr.map(Zr=>Zr.id===I?{...Zr,name:nr.name,date:nr.date,totalPackages:nr.totalPackages,subtotal:nr.subtotal,totalRivas:nr.totalRivas,totalSanJorge:nr.totalSanJorge,totalIsla:nr.totalIsla,marginRivas:nr.marginRivas,marginSanJorge:nr.marginSanJorge,marginIsla:nr.marginIsla,logisticsCost:nr.logisticsCost}:Zr)),n(" Orden maestra actualizada (pedido + inventario)."),Ze(),j(!1),e();return}const Nr=(await Jn(yt(Ie,"candy_main_orders"),{...nr,createdAt:vr.now()})).id,Pr=tu(Ie);for(const xr of Dr){const $r=Math.max(1,na(xr.unitsPerPackage||1)),cr=na(xr.packages)*$r,Zr=Zt(yt(Ie,"inventory_candies"));Pr.set(Zr,{productId:xr.id,productName:xr.name,category:xr.category,measurement:"unidad",quantity:cr,remaining:cr,packages:na(xr.packages),remainingPackages:na(xr.packages),unitsPerPackage:$r,totalUnits:cr,providerPrice:xr.providerPrice,subtotal:xr.subtotal,totalRivas:xr.totalRivas,totalSanJorge:xr.totalSanJorge,totalIsla:xr.totalIsla,gainRivas:xr.gainRivas,gainSanJorge:xr.gainSanJorge,gainIsla:xr.gainIsla,unitPriceRivas:xr.unitPriceRivas,unitPriceSanJorge:xr.unitPriceSanJorge,unitPriceIsla:xr.unitPriceIsla,date:pt,createdAt:vr.now(),status:"PENDIENTE",orderId:Nr})}await Pr.commit(),n(" Orden maestra creada y registrada en inventario."),Ze(),j(!1),e()}catch(He){console.error(He),n(" Error al guardar orden maestra.")}finally{l(!1)}},Pt=async ne=>{try{s(!0),n(""),_(ne.id),E(ne.name),T(ne.date),O(String(ne.marginRivas??20)),ce(String(ne.marginSanJorge??15)),ue(String(ne.marginIsla??30));const He=Number(ne.logisticsCost??0);se(String(He||0)),Ne("DATOS");const pt=Zt(Ie,"candy_main_orders",ne.id),Dt=await zs(pt);if(!Dt.exists()){n(" No se encontr la orden.");return}const rr=Dt.data(),zt=Array.isArray(rr.items)?rr.items:[];$e.current=new Set(zt.map(br=>String(br.id||"")));const Ot=await Ht(sr(yt(Ie,"inventory_candies"),mr("orderId","==",ne.id))),lr={};Ot.forEach(br=>{const nr=br.data(),ir=String(nr.productId||"");if(!ir)return;const Nr=yG(nr);lr[ir]=(lr[ir]||0)+Nr});const Dr=zt.map(br=>{const nr=A.find(Zr=>Zr.id===br.id),ir=Number((nr==null?void 0:nr.providerPrice)??br.providerPrice??0),Nr=Math.max(1,na((nr==null?void 0:nr.unitsPerPackage)??br.unitsPerPackage??1)),Pr=Number(br.marginRivas??0),xr=Number(br.marginSanJorge??Number(z||0)),$r=Number(br.marginIsla??0),cr=tp(ir,na(br.packages||0),{marginR:Pr,marginSJ:xr,marginIsla:$r});return{...br,name:String((nr==null?void 0:nr.name)??br.name??"").trim(),category:String((nr==null?void 0:nr.category)??br.category??"Caramelo").trim(),providerPrice:ir,unitsPerPackage:Nr,remainingPackages:lr[br.id]??br.remainingPackages??br.packages??0,...cr}});Re(Dr),j(!0)}catch(He){console.error(He),n(" Error al abrir orden maestra.")}finally{s(!1)}},he=async ne=>{if(confirm(`Eliminar la orden "${ne.name}" y todo su inventario asociado?`)){n("");try{const pt=await Ht(sr(yt(Ie,"inventory_candies"),mr("orderId","==",ne.id)));for(const Dt of pt.docs)await Kn(Zt(Ie,"inventory_candies",Dt.id));await Kn(Zt(Ie,"candy_main_orders",ne.id)),v(Dt=>Dt.filter(rr=>rr.id!==ne.id)),n(" Orden maestra eliminada."),e()}catch(pt){console.error(pt),n(" Error al eliminar orden maestra.")}}},ze=async()=>{if(!c)try{u(!0),n("");const ne=await Ht(yt(Ie,"candy_main_orders"));let He=tu(Ie),pt=0,Dt=0;const rr=(zt,Ot)=>Math.abs(Number(zt||0)-Number(Ot||0))>.01;ne.forEach(zt=>{const Ot=zt.data(),lr=Array.isArray(Ot.items)?Ot.items:[];if(!lr.length)return;const Dr=lr.reduce((xr,$r)=>xr+Number($r.subtotal||0),0);let br=Number(Ot.logisticsCost??Ot.gastosLogisticos??Ot.gastos??0);if(Number.isFinite(br)||(br=0),!br){const xr=lr.reduce(($r,cr)=>$r+Number(cr.logisticAllocated??0),0);br=Number(xr||0)}const nr=lr.map(xr=>aB(xr,br,Dr)),ir=nr.reduce((xr,$r)=>xr+Number($r.grossProfit||0),0);if(!(rr(Ot.logisticsCost,br)||rr(Ot.uBrutaGlobal,ir)||nr.some((xr,$r)=>{const cr=lr[$r]||{};return rr(cr.logisticAllocated,xr.logisticAllocated)||rr(cr.grossProfit,xr.grossProfit)||rr(cr.grossProfitIsla,xr.grossProfitIsla)})))return;const Pr=Zt(Ie,"candy_main_orders",zt.id);He.update(Pr,{logisticsCost:br,uBrutaGlobal:ir,items:nr,updatedAt:vr.now()}),pt+=1,Dt+=1,pt>=400&&(He.commit(),He=tu(Ie),pt=0)}),pt>0&&await He.commit(),n(` Ordenes maestras actualizadas: ${Dt}`),e()}catch(ne){console.error(ne),n(" Error actualizando prorrateo de rdenes maestras.")}finally{u(!1)}},nt=async()=>{if(I&&!d)try{f(!0),n("");const ne=await pF(I);ne.created>0||ne.updated>0?n(` Inventario listo: ${ne.created} creados, ${ne.updated} reparados (de ${ne.totalItems}).`):ne.totalItems>0?n(" No haba inventario faltante para crear o reparar."):n(" La orden no tiene items para crear inventario."),e()}catch(ne){console.error(ne),n(" Error creando inventario faltante.")}finally{f(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"})}),i.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[i.jsx("div",{}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Oc,{onClick:e,loading:a||m}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-gray-200 text-gray-800 px-2 md:px-3 py-2 rounded-2xl hover:bg-gray-300 disabled:opacity-60",onClick:ze,disabled:c,children:c?"Actualizando prorrateo...":"Actualizar prorrateo"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-2 md:px-3 py-2 rounded-2xl hover:bg-indigo-700 w-full md:w-auto max-w-[220px] justify-center",onClick:()=>{Ze(),j(!0)},children:[i.jsx("span",{className:"items-center gap-4 inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nueva Orden"]})]})]}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]}),w&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"relative bg-white p-4 md:p-6 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[o&&i.jsx("div",{className:"absolute inset-0 bg-white/70 z-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white border rounded-xl px-4 py-3 shadow flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-semibold",children:"Guardando orden"})]})}),i.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-3 border-b",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h3",{className:"text-lg md:text-xl font-bold",children:I?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[I&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",disabled:o||d,onClick:nt,children:d?"Creando inventario...":"Crear inventario faltante"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:o,onClick:()=>{Ze(),j(!1)},children:"Cerrar"})]})]}),i.jsx("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-1 gap-2",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold",children:"Gastos logsticos (orden)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:me,onChange:ne=>se(ne.target.value),placeholder:"0",min:0})]})}),i.jsx("div",{className:"md:hidden mt-3",children:i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[i.jsx("button",{type:"button",onClick:()=>Ne("DATOS"),className:`px-2 py-2 rounded text-xs font-semibold border ${Ue==="DATOS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Datos"}),i.jsx("button",{type:"button",onClick:()=>Ne("AGREGAR"),className:`px-2 py-2 rounded text-xs font-semibold border ${Ue==="AGREGAR"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Agregar"}),i.jsxs("button",{type:"button",onClick:()=>Ne("ITEMS"),className:`px-2 py-2 rounded text-xs font-semibold border ${Ue==="ITEMS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:["Items (",ke.length,")"]}),i.jsx("button",{type:"button",onClick:()=>Ne("TOTALES"),className:`px-2 py-2 rounded text-xs font-semibold border ${Ue==="TOTALES"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Totales"})]})})]}),i.jsxs("form",{onSubmit:dt,className:"space-y-4 pt-4",children:[i.jsx("input",{ref:we,type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:at}),i.jsx("div",{className:`${Ue==="DATOS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:S,onChange:ne=>E(ne.target.value),placeholder:"Ej: Pedido enero 19"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:ne=>T(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:P,onChange:ne=>O(ne.target.value)})]}),i.jsx("input",{type:"hidden",value:z,readOnly:!0}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:de,onChange:ne=>ue(ne.target.value)})]})]})}),i.jsx("div",{className:`${Ue==="AGREGAR"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:Xe,onChange:ne=>{it(ne.target.value),jt("")},disabled:m,children:pe.length===0?i.jsx("option",{value:"",children:m?"Cargando...":"No hay categoras en catlogo"}):pe.map(ne=>i.jsx("option",{value:ne,children:ne},ne))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:xt,onChange:ne=>jt(ne.target.value),children:[i.jsx("option",{value:"",children:m?"Cargando catlogo...":"Selecciona producto"}),Ee.map(ne=>i.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:Mt,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:Ge,onChange:ne=>ie(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:$t,readOnly:!0})]})]}),i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-end gap-2 mt-3",children:i.jsx("button",{type:"button",onClick:xe,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto"})})]})}),i.jsxs("div",{className:"hidden md:flex items-center justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:Z,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",title:"Descarga plantilla (Productos + Config)",children:"Descargar plantilla"}),i.jsx("button",{type:"button",onClick:Be,disabled:Fe,className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",title:"Importa desde Excel (Productos + Config)",children:Fe?"Importando...":"Importar Excel"}),i.jsx("button",{type:"button",onClick:re,className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",title:"Exporta la orden actual (Productos + Resumen)",children:"Exportar Excel"})]}),i.jsx("div",{className:`${Ue==="ITEMS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"mb-2 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Items:"," ",i.jsx("span",{className:"font-semibold",children:ke.length}),be.trim()?i.jsxs(i.Fragment,{children:[" "," Mostrando"," ",i.jsx("span",{className:"font-semibold",children:Tt.length})]}):null]}),i.jsx("input",{value:be,onChange:ne=>Ce(ne.target.value),placeholder:"Buscar producto o categora",className:"w-full md:w-80 border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsx("div",{className:"overflow-x-auto border rounded pb-5",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2",children:"Categora"}),i.jsx("th",{className:"text-left p-2",children:"Producto"}),i.jsx("th",{className:"text-right p-2",children:"Paquetes"}),i.jsx("th",{className:"text-right p-2",children:"Restantes"}),i.jsx("th",{className:"text-right p-2",children:"Und x Paq"}),i.jsx("th",{className:"text-right p-2",children:"Precio prov"}),i.jsx("th",{className:"text-right p-2",children:"Facturado"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Isla"}),i.jsx("th",{className:"text-right p-2",children:"MV Rivas"}),i.jsx("th",{className:"text-right p-2",children:"MV Isla"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Rivas"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Isla"}),i.jsx("th",{className:"text-right p-2",children:"Prorrateo"}),i.jsx("th",{className:"text-right p-2",children:"Precio Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Precio Isla"}),i.jsx("th",{className:"text-center p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[ye.map(ne=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:ne.category}),i.jsx("td",{className:"p-2 font-semibold",children:ne.name}),i.jsx("td",{className:"p-2 text-right",children:F[ne.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:ne.packages,onChange:He=>gt(ne.id,"packages",He.target.value),onBlur:()=>ve(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&ve(ne.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:ne.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ee(ne.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("span",{className:"inline-block min-w-[60px] text-right",children:na(ne.remainingPackages??ne.packages)})}),i.jsx("td",{className:"p-2 text-right",children:K[ne.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:ne.unitsPerPackage,onChange:He=>gt(ne.id,"unitsPerPackage",He.target.value),onBlur:()=>Ye(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&Ye(ne.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:ne.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>M(ne.id),"aria-label":"Editar unidades por paquete",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:W[ne.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(ne.marginRivas??0),onChange:He=>gt(ne.id,"marginRivas",He.target.value),onBlur:()=>X(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&X(ne.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(ne.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ae(ne.id),"aria-label":"Editar margen Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:D[ne.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(ne.marginIsla??0),onChange:He=>gt(ne.id,"marginIsla",He.target.value),onBlur:()=>le(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&le(ne.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(ne.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>De(ne.id),"aria-label":"Editar margen Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.grossProfit||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.grossProfitIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.logisticAllocated||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 text-right",children:Number(ne.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Se(ne.id),children:"Quitar"})})]},ne.id)),Tt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center text-gray-500",children:"No hay productos en la orden."})})]})]})}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando"," ",Math.min((Lt-1)*_e+1,Tt.length),"-",Math.min(Lt*_e,Tt.length)," ","de ",Tt.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:Lt<=1,onClick:()=>Me(ne=>Math.max(1,ne-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[Lt," / ",U]}),i.jsx("button",{type:"button",disabled:Lt>=U,onClick:()=>Me(ne=>Math.min(U,ne+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]}),i.jsx("div",{className:"md:hidden space-y-3",children:Tt.length===0?i.jsx("div",{className:"p-4 border rounded bg-gray-50 text-gray-600",children:"No hay productos en esta orden."}):Tt.map(ne=>i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-base leading-tight truncate",children:ne.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:ne.category})]}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Se(ne.id),children:"Quitar"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),F[ne.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:ne.packages,onChange:He=>gt(ne.id,"packages",He.target.value),onBlur:()=>ve(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&ve(ne.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:ne.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ee(ne.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes restantes"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:ne.remainingPackages??ne.packages,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Und x Paquete"}),K[ne.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:ne.unitsPerPackage,onChange:He=>gt(ne.id,"unitsPerPackage",He.target.value),onBlur:()=>Ye(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&Ye(ne.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:ne.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>M(ne.id),"aria-label":"Editar unidades por paquete",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Number(ne.providerPrice||0).toFixed(2),readOnly:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Rivas (%)"}),W[ne.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:ne.marginRivas??0,onChange:He=>gt(ne.id,"marginRivas",He.target.value),onBlur:()=>X(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&X(ne.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(ne.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ae(ne.id),"aria-label":"Editar margen Rivas",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Isla (%)"}),D[ne.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:ne.marginIsla??0,onChange:He=>gt(ne.id,"marginIsla",He.target.value),onBlur:()=>le(ne.id),onKeyDown:He=>{(He.key==="Enter"||He.key==="Escape")&&le(ne.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(ne.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>De(ne.id),"aria-label":"Editar margen Isla",children:""})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Facturado"}),i.jsx("div",{className:"font-semibold",children:Number(ne.subtotal||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(ne.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(ne.totalIsla||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prorrateo logstico"}),i.jsx("div",{className:"font-semibold",children:Number(ne.logisticAllocated||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(ne.grossProfit||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Isla"}),i.jsx("div",{className:"font-semibold",children:Number(ne.grossProfitIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Rivas (paq)"}),i.jsx("div",{className:"font-semibold",children:ne.unitPriceRivas})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Isla (paq)"}),i.jsx("div",{className:"font-semibold",children:ne.unitPriceIsla})]})]})]},ne.id))})]})}),i.jsxs("div",{className:`${Ue==="TOTALES"?"block":"hidden"} md:block`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"text-lg font-semibold",children:V.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (facturado)"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(V.subtotalCosto||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado (Rivas / Isla)"}),i.jsxs("div",{className:"text-sm font-semibold",children:["Rivas: ",Number(V.esperadoRivas||0).toFixed(2),i.jsx("br",{}),"Isla: ",Number(V.esperadoIsla||0).toFixed(2)]})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos logsticos"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(V.gastosLogisticos||0).toFixed(2)})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Rivas"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(V.utilidadBrutaRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Isla"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(V.utilidadBrutaIsla||0).toFixed(2)})]})]}),i.jsx("div",{className:"mt-3 border rounded p-3 bg-white",children:i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:re,disabled:!Nt.items.length,title:"Exporta la orden actual (productos + resumen)",children:"Exportar orden a Excel"})})})]})]}),i.jsxs("div",{className:"sticky bottom-0 bg-white pt-3 mt-4 border-t",children:[i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:Ze,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{Ze(),j(!1)},className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:o||ke.length===0,children:o?"Guardando...":"Guardar orden"})]}),i.jsx("div",{className:"md:hidden mt-2",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>{Ne(Ue==="DATOS"&&!I?"AGREGAR":Ue==="DATOS"||Ue==="AGREGAR"?"ITEMS":Ue==="ITEMS"?"TOTALES":"DATOS")},children:"Siguiente"})})]})]})]})}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"md:hidden space-y-3",children:a?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Cargando"}):x.length===0?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Sin ordenes maestras."}):x.map(ne=>{const He=y[ne.id],pt=lt(ne),Dt=ne.totalPackages>0?(ne.subtotal/ne.totalPackages).toFixed(2):"0.00",rr=Number(ne.logisticsCost||0),zt=Number(ne.totalRivas||0)-Number(ne.subtotal||0);return i.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-xs text-gray-500",children:pt}),i.jsx("div",{className:"font-semibold text-base leading-tight",children:ne.name})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-xs",onClick:()=>Pt(ne),children:"Ver"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>he(ne),children:"Borrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:ne.totalPackages})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:He?He.remainingPackages:0})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Proveedor"}),i.jsx("div",{className:"font-semibold",children:Dt})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),i.jsx("div",{className:"font-semibold",children:Number(ne.subtotal||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(ne.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(ne.totalIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Gastos log."}),i.jsx("div",{className:"font-semibold",children:rr.toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta (est)"}),i.jsx("div",{className:"font-semibold",children:zt.toFixed(2)})]})]})]},ne.id)})}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Esperado Rivas"}),i.jsx("th",{className:"p-2 border",children:"Esperado Isla"}),i.jsx("th",{className:"p-2 border",children:"Gastos log."}),i.jsx("th",{className:"p-2 border",children:"U. Bruta (est)"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin ordenes maestras."})}):_t.map(ne=>{const He=y[ne.id],pt=lt(ne),Dt=ne.totalPackages>0?(ne.subtotal/ne.totalPackages).toFixed(2):"0.00",rr=Number(ne.logisticsCost||0),zt=Number(ne.totalRivas||0)-Number(ne.subtotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:pt}),i.jsx("td",{className:"p-2 border text-left",children:ne.name}),i.jsx("td",{className:"p-2 border",children:ne.totalPackages}),i.jsx("td",{className:"p-2 border",children:He?He.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:Dt}),i.jsx("td",{className:"p-2 border",children:Number(ne.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(ne.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(ne.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:rr.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:zt.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>Pt(ne),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>he(ne),children:"Borrar"})]})})]},ne.id)})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",Math.min((Le-1)*We+1,x.length),"-",Math.min(Le*We,x.length)," de ",x.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:Le<=1,onClick:()=>Ae(ne=>Math.max(1,ne-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[Le," / ",ct]}),i.jsx("button",{type:"button",disabled:Le>=ct,onClick:()=>Ae(ne=>Math.min(ct,ne+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]})]})]})}const y0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function sB(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),a=r*e,s=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),u=a*(1+o/100),d=a*(1+l/100),f=a*(1+c/100),A=u-a,h=d-a,m=f-a,p=u/s,x=d/s,v=f/s;return{...t,subtotal:Number(a.toFixed(2)),totalRivas:Number(u.toFixed(2)),totalSanJorge:Number(d.toFixed(2)),totalIsla:Number(f.toFixed(2)),gainRivas:Number(A.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(v.toFixed(2))}}function bG(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function qc(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function iB(t){const{margin:e,gain:r,subtotal:n,orderMargin:a}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const s=Number(n||0),o=Number(r);return Number.isFinite(o)&&s>0?o/s*100:Number(a||0)}function rVe(){var L,W,Y;const[t,e]=g.useState([]),[r,n]=g.useState({}),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Mr(Ud(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Mr(Ld(new Date),"yyyy-MM-dd")),[A,h]=g.useState(!1),[m,p]=g.useState(!1),[x,v]=g.useState(null),[y,b]=g.useState([]),[w,j]=g.useState(0),[I,_]=g.useState(0),[S,E]=g.useState(0),[B,T]=g.useState(""),[P,O]=g.useState(""),[z,ce]=g.useState(0),[de,ue]=g.useState(0),[me,se]=g.useState(1);g.useEffect(()=>{(async()=>{try{s(!0),l("");const D=sr(yt(Ie,"candy_main_orders"),In("createdAt","desc")),Q=await Ht(D),ee=[];Q.forEach(Ye=>{const ae=Ye.data();ee.push({id:Ye.id,name:ae.name??"",date:ae.date??"",totalPackages:Number(ae.totalPackages??0),subtotal:Number(ae.subtotal??0),totalRivas:Number(ae.totalRivas??0),totalSanJorge:Number(ae.totalSanJorge??0),totalIsla:Number(ae.totalIsla??0),marginRivas:Number(ae.marginRivas??0),marginSanJorge:Number(ae.marginSanJorge??0),marginIsla:Number(ae.marginIsla??0),createdAt:ae.createdAt??vr.now()})}),e(ee);const ve=await Ht(sr(yt(Ie,"inventory_candies"))),M={};ve.forEach(Ye=>{const ae=Ye.data(),X=ae.orderId;if(!X)return;const De=Number(ae.unitsPerPackage||1)||1,le=Number(ae.totalUnits??(ae.packages||0)*De),$e=Math.round(le/De),Xe=Number(ae.remaining??ae.totalUnits??le),it=Number(ae.remainingPackages??NaN),xt=Number.isFinite(it)?Math.round(it):Math.round(Xe/De);M[X]||(M[X]={orderId:X,totalPackages:0,remainingPackages:0}),M[X].totalPackages+=$e,M[X].remainingPackages+=xt}),n(M)}catch(D){console.error(D),l(" Error cargando inventario de pedidos.")}finally{s(!1)}})()},[]);const ke=g.useMemo(()=>t.filter(D=>{var ee;const Q=D.date||((ee=D.createdAt)!=null&&ee.toDate?D.createdAt.toDate().toISOString().slice(0,10):"");return!(!Q||c&&Q<c||d&&Q>d)}),[t,c,d]),Re=g.useMemo(()=>{let D=0,Q=0,ee=0,ve=0,M=0,Ye=0;for(const ae of ke){D+=ae.totalPackages,Q+=ae.subtotal,ee+=ae.totalRivas,ve+=ae.totalSanJorge,M+=ae.totalIsla;const X=r[ae.id];X&&(Ye+=X.remainingPackages)}return{totalPaquetes:D,totalSubtotal:Q,totalRivas:ee,totalSJ:ve,totalIsla:M,totalPaquetesRestantes:Ye,totalPedidos:ke.length}},[ke,r]),F=async(D,Q,ee)=>{if(!x)return;const ve=Number(ee||0),M=y.map(X=>X.id!==D?X:sB({...X,[Q]:ve}));b(M);const Ye=M.find(X=>X.id===D);if(!Ye)return;const ae=bG(M);try{await Fn(Zt(Ie,"products_candies",D),{marginRivas:Ye.marginRivas,marginSanJorge:Ye.marginSanJorge,marginIsla:Ye.marginIsla,subtotal:Ye.subtotal,totalRivas:Ye.totalRivas,totalSanJorge:Ye.totalSanJorge,totalIsla:Ye.totalIsla,unitPriceRivas:Ye.unitPriceRivas,unitPriceSanJorge:Ye.unitPriceSanJorge,unitPriceIsla:Ye.unitPriceIsla,gainRivas:Ye.gainRivas,gainSanJorge:Ye.gainSanJorge,gainIsla:Ye.gainIsla}),await Fn(Zt(Ie,"candy_main_orders",x.id),{totalPackages:ae.totalPackages,subtotal:Number(ae.subtotal.toFixed(2)),totalRivas:Number(ae.totalRivas.toFixed(2)),totalSanJorge:Number(ae.totalSanJorge.toFixed(2)),totalIsla:Number(ae.totalIsla.toFixed(2))}),v(X=>X&&{...X,totalPackages:ae.totalPackages,subtotal:Number(ae.subtotal.toFixed(2)),totalRivas:Number(ae.totalRivas.toFixed(2)),totalSanJorge:Number(ae.totalSanJorge.toFixed(2)),totalIsla:Number(ae.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(X){console.error(X),l(" Error actualizando mrgenes del producto.")}},H=async()=>{if(x)try{l("");const D=Number.isFinite(w)&&w!==0?w:x.marginRivas||0,Q=Number.isFinite(I)&&I!==0?I:x.marginSanJorge||0,ee=Number.isFinite(S)&&S!==0?S:x.marginIsla||0,ve=sB({id:"tmp",name:B.trim(),category:P.trim(),providerPrice:Number(z||0),packages:Number(de||0),unitsPerPackage:Number(me||1),marginRivas:Number(D||0),marginSanJorge:Number(Q||0),marginIsla:Number(ee||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(de||0)}),M=await Jn(yt(Ie,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:ve.name,category:ve.category,providerPrice:ve.providerPrice,packages:ve.packages,unitsPerPackage:ve.unitsPerPackage,marginRivas:ve.marginRivas,marginSanJorge:ve.marginSanJorge,marginIsla:ve.marginIsla,gainRivas:ve.gainRivas,gainSanJorge:ve.gainSanJorge,gainIsla:ve.gainIsla,subtotal:ve.subtotal,totalRivas:ve.totalRivas,totalSanJorge:ve.totalSanJorge,totalIsla:ve.totalIsla,unitPriceRivas:ve.unitPriceRivas,unitPriceSanJorge:ve.unitPriceSanJorge,unitPriceIsla:ve.unitPriceIsla,createdAt:vr.now()}),ae=[{...ve,id:M.id},...y];b(ae);const X=bG(ae);await Fn(Zt(Ie,"candy_main_orders",x.id),{totalPackages:X.totalPackages,subtotal:Number(X.subtotal.toFixed(2)),totalRivas:Number(X.totalRivas.toFixed(2)),totalSanJorge:Number(X.totalSanJorge.toFixed(2)),totalIsla:Number(X.totalIsla.toFixed(2))}),v(De=>De&&{...De,totalPackages:X.totalPackages,subtotal:Number(X.subtotal.toFixed(2)),totalRivas:Number(X.totalRivas.toFixed(2)),totalSanJorge:Number(X.totalSanJorge.toFixed(2)),totalIsla:Number(X.totalIsla.toFixed(2))}),j(0),_(0),E(0),T(""),O(""),ce(0),ue(0),se(1),l(" Producto agregado con mrgenes por sucursal.")}catch(D){console.error(D),l(" Error agregando producto al pedido.")}},K=async D=>{try{v(D),b([]),h(!0),p(!0),l("");const Q=await Ht(sr(yt(Ie,"inventory_candies"),mr("orderId","==",D.id))),ee={};Q.forEach(Ye=>{const ae=Ye.data(),X=ae.productId;if(!X)return;const De=Number(ae.unitsPerPackage||1)||1,le=Number(ae.remaining??ae.totalUnits??0),$e=Number(ae.remainingPackages??NaN),Xe=Number.isFinite($e)?Math.round($e):Math.round(le/De);ee[X]=(ee[X]||0)+Xe});const ve=await Ht(sr(yt(Ie,"products_candies"),mr("orderId","==",D.id))),M=[];ve.forEach(Ye=>{const ae=Ye.data(),X=qc(ae.providerPrice,0),De=qc(ae.packages,0),le=ae.subtotal??X*De,$e=iB({margin:ae.marginRivas,gain:ae.gainRivas,subtotal:le,orderMargin:D.marginRivas||0}),Xe=iB({margin:ae.marginSanJorge,gain:ae.gainSanJorge,subtotal:le,orderMargin:D.marginSanJorge||0}),it=iB({margin:ae.marginIsla,gain:ae.gainIsla,subtotal:le,orderMargin:D.marginIsla||0}),xt=sB({id:Ye.id,name:ae.name??"",category:ae.category??"",providerPrice:X,packages:De,unitsPerPackage:qc(ae.unitsPerPackage,1),marginRivas:Number($e||0),marginSanJorge:Number(Xe||0),marginIsla:Number(it||0),subtotal:qc(ae.subtotal,0),totalRivas:qc(ae.totalRivas,0),totalSanJorge:qc(ae.totalSanJorge,0),totalIsla:qc(ae.totalIsla,0),gainRivas:qc(ae.gainRivas,0),gainSanJorge:qc(ae.gainSanJorge,0),gainIsla:qc(ae.gainIsla,0),unitPriceRivas:qc(ae.unitPriceRivas,0),unitPriceSanJorge:qc(ae.unitPriceSanJorge,0),unitPriceIsla:qc(ae.unitPriceIsla,0),remainingPackages:ee[Ye.id]??qc(ae.packages,0)});M.push(xt)}),b(M)}catch(Q){console.error(Q),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:D=>f(D.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:Re.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Re.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Re.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",y0(Re.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",y0(Re.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",y0(Re.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",y0(Re.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):ke.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):ke.map(D=>{var ae;const Q=D.totalPackages>0?Math.round(D.totalRivas/D.totalPackages):0,ee=D.totalPackages>0?Math.round(D.totalSanJorge/D.totalPackages):0,ve=D.totalPackages>0?Math.round(D.totalIsla/D.totalPackages):0,M=D.date||((ae=D.createdAt)!=null&&ae.toDate?D.createdAt.toDate().toISOString().slice(0,10):""),Ye=r[D.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:M}),i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.totalPackages}),i.jsx("td",{className:"p-2 border",children:Ye?Ye.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Q}),i.jsx("td",{className:"p-2 border",children:ee}),i.jsx("td",{className:"p-2 border",children:ve}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>K(D),children:"Ver pedido"})})]},D.id)})})]})}),A&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),v(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((L=x.createdAt)!=null&&L.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((W=r[x.id])==null?void 0:W.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((Y=r[x.id])==null?void 0:Y.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:y0(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:y0(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:y0(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:y0(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:w,onChange:D=>j(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:I,onChange:D=>_(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:S,onChange:D=>E(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:B,onChange:D=>T(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:P,onChange:D=>O(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:z,onChange:D=>ce(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:de,onChange:D=>ue(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:me,onChange:D=>se(Number(D.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:H,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(D=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.category}),i.jsx("td",{className:"p-2 border",children:D.packages}),i.jsx("td",{className:"p-2 border",children:D.remainingPackages??D.packages}),i.jsx("td",{className:"p-2 border",children:D.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:D.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginRivas??0,onChange:Q=>F(D.id,"marginRivas",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginSanJorge??0,onChange:Q=>F(D.id,"marginSanJorge",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginIsla??0,onChange:Q=>F(D.id,"marginIsla",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:D.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:D.unitPriceIsla})]},D.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!A&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const za=t=>Math.round((Number(t)||0)*100)/100,rp=t=>Math.round((Number(t)||0)*1e3)/1e3,ai=t=>Number(t??0).toFixed(2),Uf=t=>Number(t??0).toFixed(3),wG=t=>String(t??"").trim().toLowerCase();async function nVe(t){if(!t)return;const e=sr(yt(Ie,"ar_movements"),mr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Kn(Zt(Ie,"ar_movements",n.id))))}const aVe=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?Mr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,u=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),v=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(v||0)>0&&(y=za(c*Number(v||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:za(v),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:s,vendorId:o,vendorCommissionAmount:y,processedDate:u||""}});const d=Number(t.packagesTotal??t.quantity??0),f=Number(t.amount??t.amountCharged??t.total??0)||0;let A=0;return A=za(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:d,amount:f,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:s,vendorId:o,vendorCommissionAmount:A,processedDate:u||""}]};function sVe({role:t,currentUserEmail:e,sellerCandyId:r,roles:n}){const[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),m=Mr(new Date,"yyyy-MM-dd"),[p,x]=g.useState(m),[v,y]=g.useState(m),[b,w]=g.useState("ALL"),[j,I]=g.useState(null),[_,S]=g.useState(0),[E,B]=g.useState(0),[T,P]=g.useState(""),[O,z]=g.useState(0),[ce,de]=g.useState("0"),[ue,me]=g.useState(!1),[se,ke]=g.useState(!1),[Re,F]=g.useState(!1),[H,K]=g.useState(!1),[L,W]=g.useState(!1),[Y,D]=g.useState(!1),Q=g.useRef(null),ee=n&&n.length?n:t,ve=!ee||En(ee,"admin"),M=En(ee,"vendedor_dulces"),Ye=(e||"").trim().toLowerCase(),[ae,X]=g.useState([]),[De,le]=g.useState({}),[$e,Xe]=g.useState({});g.useEffect(()=>{if(!p||!v)return;u(!0);const U=sr(yt(Ie,"sales_candies"),mr("date",">=",p),mr("date","<=",v),In("date","asc")),ye=jd(U,te=>{const Ve=[];te.forEach(qe=>{const G=aVe(qe.data(),qe.id);Ve.push(...G)}),s(Ve),u(!1)},te=>{console.error("Error cargando ventas por periodo:",te),s([]),u(!1)});return()=>ye()},[p,v]),g.useEffect(()=>{(async()=>{const ye=sr(yt(Ie,"daily_closures_candies"),mr("date","==",m)),te=await Ht(ye);if(te.empty)l(null);else{const Ve=te.docs[0];l({id:Ve.id,...Ve.data()})}})()},[m]),g.useEffect(()=>{(async()=>{try{const ye=await Ht(yt(Ie,"sellers_candies")),te=[];ye.forEach(Ve=>{const qe=Ve.data();te.push({id:Ve.id,name:qe.name||"",commissionPercent:Number(qe.commissionPercent||0)})}),X(te)}catch(ye){console.error("Error cargando sellers_candies",ye)}})()},[]),g.useEffect(()=>{(async()=>{try{const ye=await Ht(yt(Ie,"products_candies")),te={};ye.forEach(Ve=>{const qe=Ve.data(),G=wG(qe==null?void 0:qe.name);if(!G)return;const V=String((qe==null?void 0:qe.category)||"").trim();te[G]=V||"(sin categora)"}),le(te)}catch(ye){console.error("Error cargando products_candies",ye)}})()},[]);const it=U=>za(Number(U.vendorCommissionAmount??0)||0),xt=Ui.useMemo(()=>{let U=[...a];return A==="FLOTANTE"&&(U=U.filter(ye=>ye.status==="FLOTANTE")),A==="PROCESADA"&&(U=U.filter(ye=>ye.status==="PROCESADA")),ve&&b!=="ALL"&&(U=U.filter(ye=>(ye.vendorId||"")===b)),M&&(r?U=U.filter(ye=>(ye.vendorId||"")===r):Ye?U=U.filter(ye=>(ye.sellerEmail||"").toLowerCase()===Ye):U=[]),U},[A,a,ve,b,M,r,Ye]),jt=Ui.useMemo(()=>xt.filter(U=>U.type!=="CREDITO"),[xt]),Mt=Ui.useMemo(()=>xt.filter(U=>U.type==="CREDITO"),[xt]),Ft=Ui.useMemo(()=>xt.filter(U=>U.status==="FLOTANTE").length,[xt]),$t=Ui.useMemo(()=>xt.filter(U=>U.status==="PROCESADA").length,[xt]),kt=Ui.useMemo(()=>xt.filter(U=>U.type==="CREDITO").length,[xt]),Ge=Ui.useMemo(()=>xt.filter(U=>U.type!=="CREDITO").length,[xt]),ie=rp(xt.reduce((U,ye)=>U+(ye.quantity||0),0)),Ue=za(xt.reduce((U,ye)=>U+Number(ye.cogsAmount??0),0)),Ne=za(xt.reduce((U,ye)=>U+(ye.amount||0),0)),be=za(Ne-Ue);let Ce=0,Le=0,Ae=0,We=0,ct=0,_t=0,pe=0;xt.forEach(U=>{const ye=Number(U.amount||0),te=Number(U.amountReceived||0),Ve=it(U);ct+=Ve,U.type==="CREDITO"?(Ce+=U.quantity||0,Ae+=ye-te,pe+=Ve):(Le+=U.quantity||0,We+=ye,_t+=Ve)}),Ae=za(Ae),We=za(We),ct=za(ct),_t=za(_t),pe=za(pe);const Pe=Ui.useMemo(()=>{const U={};for(const ye of xt){const te=(ye.vendorId||"").trim();if(!te||ye.type==="CREDITO")continue;const Ve=it(ye);if(!U[te]){const qe=ae.find(G=>G.id===te);U[te]={vendorId:te,name:(qe==null?void 0:qe.name)||ye.userEmail||"(sin vendedor)",total:0}}U[te].total=za(U[te].total+Ve)}return Object.values(U).filter(ye=>ye.total>0).sort((ye,te)=>te.total-ye.total)},[xt,ae]),Ee=Ui.useMemo(()=>{const U={};for(const ye of xt){const te=(ye.vendorId||"").trim();if(!te||ye.type!=="CREDITO")continue;const Ve=it(ye);if(!U[te]){const qe=ae.find(G=>G.id===te);U[te]={vendorId:te,name:(qe==null?void 0:qe.name)||ye.userEmail||"(sin vendedor)",total:0}}U[te].total=za(U[te].total+Ve)}return Object.values(U).filter(ye=>ye.total>0).sort((ye,te)=>te.total-ye.total)},[xt,ae]),Ze={};xt.forEach(U=>{const ye=U.productName||"(sin nombre)";Ze[ye]||(Ze[ye]={totalQuantity:0,totalAmount:0,totalCommission:0}),Ze[ye].totalQuantity=rp(Ze[ye].totalQuantity+(U.quantity||0)),Ze[ye].totalAmount=za(Ze[ye].totalAmount+(U.amount||0)),Ze[ye].totalCommission=za(Ze[ye].totalCommission+it(U))});const xe=Object.entries(Ze).map(([U,ye])=>({productName:U,category:De[wG(U)]||"(sin categora)",totalQuantity:ye.totalQuantity,totalAmount:ye.totalAmount,totalCommission:ye.totalCommission})),Se=Ui.useMemo(()=>{const U={};for(const ye of xe){const te=ye.category||"(sin categora)";U[te]||(U[te]={category:te,rows:[],totalQuantity:0,totalAmount:0,totalCommission:0}),U[te].rows.push(ye),U[te].totalQuantity=rp(U[te].totalQuantity+(ye.totalQuantity||0)),U[te].totalAmount=za(U[te].totalAmount+(ye.totalAmount||0)),U[te].totalCommission=za(U[te].totalCommission+(ye.totalCommission||0))}return Object.values(U).map(ye=>({...ye,rows:[...ye.rows].sort((te,Ve)=>Ve.totalAmount-te.totalAmount)})).sort((ye,te)=>te.totalAmount-ye.totalAmount)},[xe]),gt=U=>{Xe(ye=>({...ye,[U]:!ye[U]}))},Et=async()=>{if(ve)try{const U=xt.filter(re=>re.status==="FLOTANTE");if(U.length===0){f("No hay ventas flotantes para procesar en este perodo.");return}const ye={totalCharged:za(U.reduce((re,we)=>re+(we.amount||0),0)),totalSuggested:za(U.reduce((re,we)=>re+(we.amountSuggested||0),0)),totalUnits:rp(U.reduce((re,we)=>re+(we.quantity||0),0)),totalCOGS:za(U.reduce((re,we)=>re+Number(we.cogsAmount??0),0))},te=za(ye.totalCharged-ye.totalSuggested),Ve=za(ye.totalCharged-ye.totalCOGS),qe=U.reduce((re,we)=>{const Fe=Number(we.quantity||0),st=Number(we.amount||0),Be=Number(we.vendorCommissionAmount||0);return we.type==="CREDITO"?(re.packsCredit+=Fe,re.amountCredit+=st,re.comCredit+=Be):(re.packsCash+=Fe,re.amountCash+=st,re.comCash+=Be),re},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),G={totalPacksCash:rp(qe.packsCash),totalPacksCredit:rp(qe.packsCredit),totalAmountCash:za(qe.amountCash),totalAmountCredit:za(qe.amountCredit),totalCommissionCash:za(qe.comCash),totalCommissionCredit:za(qe.comCredit)},V=await Jn(yt(Ie,"daily_closures_candies"),{date:m,createdAt:vr.now(),periodStart:p,periodEnd:v,totalCharged:ye.totalCharged,totalSuggested:ye.totalSuggested,totalDifference:te,totalUnits:ye.totalUnits,totalCOGS:ye.totalCOGS,grossProfit:Ve,...G,products:U.map(re=>({productName:re.productName,quantity:re.quantity,amount:re.amount})),sales:U.map(re=>({id:re.id,productName:re.productName,quantity:re.quantity,amount:re.amount,amountSuggested:re.amountSuggested,userEmail:re.userEmail,clientName:re.clientName,amountReceived:re.amountReceived,change:re.change,status:re.status,cogsAmount:re.cogsAmount??0,avgUnitCost:re.avgUnitCost??null,allocations:re.allocations??[],date:re.date,type:re.type??"CONTADO",vendorId:re.vendorId??"",vendorCommissionAmount:Number(re.vendorCommissionAmount??0)||0,processedDate:m})),productSummary:Object.entries(U.reduce((re,we)=>{const Fe=we.productName||"(sin nombre)";return re[Fe]||(re[Fe]={totalQuantity:0,totalAmount:0}),re[Fe].totalQuantity=rp(re[Fe].totalQuantity+(we.quantity||0)),re[Fe].totalAmount=za(re[Fe].totalAmount+(we.amount||0)),re},{})).map(([re,we])=>({productName:re,totalQuantity:we.totalQuantity,totalAmount:we.totalAmount}))}),Z=tu(Ie);U.forEach(re=>{Z.update(Zt(Ie,"sales_candies",re.id.split("#")[0]),{status:"PROCESADA",closureId:V.id,closureDate:m,processedDate:m,processedAt:vr.now()})}),await Z.commit(),f(` Cierre guardado. Ventas procesadas: ${U.length}. (Proceso: ${m})`)}catch(U){console.error(U),f(" Error al guardar el cierre de dulces.")}},Nt=async U=>{if(ve&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Fn(Zt(Ie,"sales_candies",U.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),f(" Venta revertida a FLOTANTE.")}catch(ye){console.error(ye),f(" No se pudo revertir la venta.")}},Tt=U=>{ve&&(I(U),S(U.quantity),B(U.amount),P(U.clientName),z(U.amountReceived),de(U.change))},Lt=async()=>{if(!(!j||!ve))try{await Fn(Zt(Ie,"sales_candies",j.id.split("#")[0]),{packagesTotal:_,amount:E,amountCharged:E,clientName:T,amountReceived:O,change:ce}),I(null),f(" Venta de dulces actualizada.")}catch(U){console.error(U),f(" No se pudo actualizar la venta de dulces.")}},Me=async U=>{if(ve&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const ye=U.split("#")[0],{restored:te}=await NQe(ye);await nVe(ye),f(` Venta eliminada. Stock restaurado (unidades internas): ${Number(te).toFixed(2)}. Estado de cuenta ajustado.`)}catch(ye){console.error(ye),f(" No se pudo eliminar la venta de dulces.")}},_e=async()=>{if(Q.current){Q.current.classList.add("force-pdf-colors"),Q.current.classList.add("pdf-print-mode");try{const ye=(await Fg(Q.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),te=new rn;te.addImage(ye,"PNG",10,10,190,0),te.save(`cierre_dulces_${p}_a_${v}_proc_${m}.pdf`)}finally{Q.current.classList.remove("pdf-print-mode"),Q.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
        .pdf-print-mode .collapsible-content { display: block !important; }
      `}),i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",m]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>me(U=>!U),"aria-expanded":ue,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${ue?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${ue?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:p,onChange:U=>x(U.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:U=>y(U.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:U=>h(U.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),ve&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:U=>w(U.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),ae.map(U=>i.jsx("option",{value:U.id,children:U.name||U.id},U.id))]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>ke(U=>!U),"aria-expanded":se,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${se?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${se?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:Ft}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:$t}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:kt}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Ge}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ai(_t)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",ai(pe)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>F(U=>!U),"aria-expanded":Re,children:[i.jsx("span",{children:"KPIs por vendedor"}),i.jsx("span",{className:`transition-transform ${Re?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Re?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),Pe.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Pe.map(U=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:U.name}),i.jsxs("strong",{className:"ml-2",children:["C$",ai(U.total)]})]},U.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),Ee.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Ee.map(U=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:U.name}),i.jsxs("strong",{className:"ml-2",children:["C$",ai(U.total)]})]},U.vendorId))})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:Q,children:[i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>K(U=>!U),"aria-expanded":H,children:[i.jsx("span",{children:"Transacciones Cash"}),i.jsx("span",{className:`transition-transform ${H?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${H?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[jt.map(U=>{const ye=it(U),te=(U.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${U.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:U.status})}),i.jsx("td",{className:"border p-1",children:U.productName}),i.jsx("td",{className:"border p-1",children:"Cash"}),i.jsx("td",{className:"border p-1",children:Uf(U.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ai(U.amount)]}),i.jsx("td",{className:"border p-1",children:ye>0?`C$${ai(ye)}`:""}),i.jsx("td",{className:"border p-1",children:U.date}),i.jsx("td",{className:"border p-1",children:te||""}),i.jsx("td",{className:"border p-1",children:U.userEmail}),i.jsx("td",{className:"border p-1",children:U.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:ve?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Tt(U),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Me(U.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):U.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:ve?i.jsx("button",{onClick:()=>Nt(U.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},U.id)}),jt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas cash para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[jt.map(U=>{const ye=it(U),te=(U.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:U.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Cash  ",U.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",ai(U.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${U.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:U.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Uf(U.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:ye>0?`C$${ai(ye)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:te||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:U.userEmail})]}),i.jsx("div",{className:"pt-2",children:U.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:ve?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Tt(U),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Me(U.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):U.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:ve?i.jsx("button",{onClick:()=>Nt(U.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},U.id)}),jt.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas cash para mostrar."})]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>W(U=>!U),"aria-expanded":L,children:[i.jsx("span",{children:"Transacciones Crdito"}),i.jsx("span",{className:`transition-transform ${L?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${L?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Mt.map(U=>{const ye=it(U),te=(U.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${U.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:U.status})}),i.jsx("td",{className:"border p-1",children:U.productName}),i.jsx("td",{className:"border p-1",children:"Crdito"}),i.jsx("td",{className:"border p-1",children:Uf(U.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ai(U.amount)]}),i.jsx("td",{className:"border p-1",children:ye>0?`C$${ai(ye)}`:""}),i.jsx("td",{className:"border p-1",children:U.date}),i.jsx("td",{className:"border p-1",children:te||""}),i.jsx("td",{className:"border p-1",children:U.userEmail}),i.jsx("td",{className:"border p-1",children:U.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:ve?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Tt(U),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Me(U.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):U.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:ve?i.jsx("button",{onClick:()=>Nt(U.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},U.id)}),Mt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas crdito para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Mt.map(U=>{const ye=it(U),te=(U.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:U.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Crdito  ",U.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",ai(U.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${U.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:U.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Uf(U.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:ye>0?`C$${ai(ye)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:te||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:U.userEmail})]}),i.jsx("div",{className:"pt-2",children:U.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:ve?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Tt(U),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Me(U.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):U.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:ve?i.jsx("button",{onClick:()=>Nt(U.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},U.id)}),Mt.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas crdito para mostrar."})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:Uf(Ce)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:Uf(Le)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",ai(Ae)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",ai(We)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",ai(ct)]})]})]}),(Ue>0||be!==Ne)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",ai(Ue)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",ai(be)]})]}),i.jsxs("div",{children:["Total paquetes (visibles):"," ",i.jsx("strong",{children:Uf(ie)})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(U=>!U),"aria-expanded":Y,children:[i.jsx("span",{children:"Consolidado por producto"}),i.jsx("span",{className:`transition-transform ${Y?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Y?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"space-y-3",children:[Se.map(U=>{const ye=!!$e[U.category];return i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>gt(U.category),"aria-expanded":ye,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"truncate",children:U.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Uf(U.totalQuantity)," paquetes  C$",ai(U.totalAmount),"  Comisin"," ",U.totalCommission>0?`C$${ai(U.totalCommission)}`:""]})]}),i.jsx("span",{className:`transition-transform ${ye?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${ye?"block":"hidden"} border-t p-3`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsx("tbody",{children:U.rows.map(te=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:te.productName}),i.jsx("td",{className:"border p-1",children:Uf(te.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",ai(te.totalAmount)]}),i.jsx("td",{className:"border p-1",children:te.totalCommission>0?`C$${ai(te.totalCommission)}`:""})]},te.productName))})]})}),i.jsx("div",{className:"pdf-mobile md:hidden space-y-2",children:U.rows.map(te=>i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[i.jsx("div",{className:"font-semibold",children:te.productName}),i.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),i.jsx("strong",{children:Uf(te.totalQuantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total dinero"}),i.jsxs("strong",{children:["C$",ai(te.totalAmount)]})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:te.totalCommission>0?`C$${ai(te.totalCommission)}`:""})]})]})]},te.productName))})]})]},U.category)}),Se.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[ve&&i.jsx("button",{onClick:Et,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),i.jsx("button",{onClick:_e,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),j&&ve&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[j.productName,"  ",j.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:_,onChange:U=>S(parseFloat(U.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:E,onChange:U=>B(parseFloat(U.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:T,onChange:U=>P(U.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:O,onChange:U=>z(parseFloat(U.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:ce,onChange:U=>de(U.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>I(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:Lt,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Fh=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Cu=t=>Math.round((Number(t)||0)*100)/100;function iVe(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function oVe(t){return t.toISOString().slice(0,10)}function lVe(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function cVe(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return oVe(r)}function uVe(){const[t,e]=g.useState(lVe()),[r,n]=g.useState(cVe()),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState({}),[d,f]=g.useState({}),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState({}),[y,b]=g.useState(!1),[w,j]=g.useState(null),[I,_]=g.useState(null),S=g.useMemo(()=>w&&A.find(de=>de.vendorId===w)||null,[w,A]),E=g.useMemo(()=>{var de;return!w||!I?[]:((de=x[w])==null?void 0:de[I])||[]},[w,I,x]),B=g.useMemo(()=>Cu(A.reduce((de,ue)=>de+(ue.totalSoldMoney||0),0)),[A]),T=g.useMemo(()=>Cu(A.reduce((de,ue)=>de+(ue.totalCreditMoney||0),0)),[A]);g.useEffect(()=>{(async()=>{try{const de=await Ht(yt(Ie,"sellers_candies")),ue={};de.forEach(ke=>{const Re=ke.data(),F=Re.branch||"Rivas";let H="RIVAS";F==="San Jorge"?H="SAN_JORGE":F==="Isla Ometepe"&&(H="ISLA"),ue[ke.id]={id:ke.id,name:Re.name??"(sin nombre)",branch:H,branchLabel:F,commissionPercent:Number(Re.commissionPercent??0)}});const me=await Ht(yt(Ie,"products_candies")),se={};me.forEach(ke=>{const Re=ke.data();se[ke.id]={id:ke.id,name:Re.name??"(sin nombre)"}}),u(ue),f(se)}catch(de){console.error(de),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const P=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}s(!0),l("");try{const de={},ue={},me=sr(yt(Ie,"inventory_candies_sellers"),mr("date",">=",t),mr("date","<=",r)),se=await Ht(me),ke={},Re={},F={},H={};se.forEach(le=>{var Ze,xe;const $e=le.data(),Xe=$e.sellerId||"";if(!Xe)return;const it=$e.productId||"",xt=$e.productName||((Ze=d[it])==null?void 0:Ze.name)||"(sin nombre)",jt=Math.max(1,Math.floor(Number($e.unitsPerPackage||1))),Mt=Number($e.totalUnits??0),Ft=Number($e.packages??0),$t=Number($e.remainingUnits??$e.remaining??0),kt=Number($e.remainingPackages??0),Ge=Ft>0?Ft:Mt>0?Math.floor(Mt/jt):0,ie=kt>0?kt:$t>0?Math.floor($t/jt):0;ke[Xe]=(ke[Xe]||0)+Ge,Re[Xe]=(Re[Xe]||0)+ie;const Ue=$e.orderId||$e.vendorOrderId||$e.orderNumber||$e.order||le.id;F[Xe]||(F[Xe]=new Set),F[Xe].add(Ue);const Ne=((xe=c[Xe])==null?void 0:xe.name)||$e.sellerName||"(sin vendedor)",be=String($e.date||""),Ce=Number($e.totalVendor??0),Le=Number($e.gainVendor??0),Ae=Ft>0?Ft:Mt>0?Math.floor(Mt/jt):0,We=Ae>0?Ce/Ae:0,ct=Ae>0?Le/Ae:0,_t=Cu(Ge*We),pe=Cu(Ge*ct),Pe=Cu(ie*We),Ee=Cu(ie*ct);H[Xe]||(H[Xe]={ordered:[],remaining:[]}),Ge>0&&H[Xe].ordered.push({date:be,vendorName:Ne,productName:xt,packages:Ge,totalMoney:_t,vendorCommission:pe}),ie>0&&H[Xe].remaining.push({date:be,vendorName:Ne,productName:xt,packages:ie,totalMoney:Pe,vendorCommission:Ee})});const K={};Object.keys(F).forEach(le=>{K[le]=F[le].size});const L=sr(yt(Ie,"sales_candies"),mr("date",">=",t),mr("date","<=",r)),W=await Ht(L),Y={},D={},Q={},ee={},ve={},M={};W.forEach(le=>{const $e=le.data(),Xe=$e.date||"",it=$e.vendorId||$e.sellerId||"";if(!it)return;const xt=c[it],jt=$e.vendorName||(xt==null?void 0:xt.name)||"(sin vendedor)",Mt=Number($e.vendorCommissionPercent??(xt==null?void 0:xt.commissionPercent)??0)||0,Ft=Array.isArray($e.items)?$e.items:[];if(!Ft.length)return;const $t=String($e.type||"").toUpperCase()==="CREDITO";ve[it]||(ve[it]={sold:[],credit:[]}),Ft.forEach(kt=>{var _t;const Ge=kt.productName||((_t=d[kt.productId||""])==null?void 0:_t.name)||"(sin nombre)",ie=kt.packages??kt.qty??kt.quantity??0,Ue=Number(ie||0);if(Ue<=0)return;const Ne=Number(kt.unitPricePackage??kt.unitPrice??0)||0,be=Math.max(0,Number(kt.discount||0)),Ce=Ue*Ne,Le=Cu(Math.max(0,Ce-be));if(Le<=0)return;console.log("DBG",{isCredit:$t,vendorId:it,commissionPercent:Mt,lineFinal:Le,storedItemCommission:Number(kt.vendorCommissionAmount??0)});let Ae=0;const We=Number(kt.vendorCommissionAmount??0);We?Ae=Cu(We):Mt>0&&(Ae=Cu(Le*Mt/100)),$t?(D[it]=(D[it]||0)+Ue,ee[it]=(ee[it]||0)+Le):(Y[it]=(Y[it]||0)+Ue,Q[it]=(Q[it]||0)+Le),$t?ue[it]=(ue[it]||0)+Ae:de[it]=(de[it]||0)+Ae,$t?ve[it].credit.push({date:Xe,vendorName:jt,productName:Ge,packages:Ue,totalMoney:Le,vendorCommission:0}):ve[it].sold.push({date:Xe,vendorName:jt,productName:Ge,packages:Ue,totalMoney:Le,vendorCommission:Ae});const ct=Ge;M[ct]||(M[ct]={productName:Ge,packages:0,totalMoney:0}),M[ct].packages+=Ue,M[ct].totalMoney+=Le})});const Ye=new Set([...Object.keys(ke),...Object.keys(Re),...Object.keys(Y),...Object.keys(D)]),ae=[],X={};Ye.forEach(le=>{var ie,Ue,Ne,be;const $e=c[le],Xe=($e==null?void 0:$e.name)||"(sin vendedor)",it=$e?$e.branchLabel||iVe($e.branch):"",xt=ke[le]||0,jt=Re[le]||0,Mt=Y[le]||0,Ft=D[le]||0,$t=Cu(Q[le]||0),kt=Cu(ee[le]||0),Ge=K[le]||0;ae.push({vendorId:le,vendorName:Xe,branchLabel:it,orderedPackages:xt,remainingPackages:jt,soldPackages:Mt,creditPackages:Ft,totalSoldMoney:$t,totalCreditMoney:kt,ordersCreated:Ge,commissionCash:Cu(de[le]||0),commissionCredit:0}),X[le]={ordered:(((ie=H[le])==null?void 0:ie.ordered)||[]).sort((Ce,Le)=>Ce.date.localeCompare(Le.date)),remaining:(((Ue=H[le])==null?void 0:Ue.remaining)||[]).sort((Ce,Le)=>Ce.date.localeCompare(Le.date)),sold:(((Ne=ve[le])==null?void 0:Ne.sold)||[]).sort((Ce,Le)=>Ce.date.localeCompare(Le.date)),credit:(((be=ve[le])==null?void 0:be.credit)||[]).sort((Ce,Le)=>Ce.date.localeCompare(Le.date))}}),ae.sort((le,$e)=>le.vendorName.localeCompare($e.vendorName,"es")),h(ae),v(X);const De=Object.values(M).map(le=>({productName:le.productName,packages:le.packages,totalMoney:Cu(le.totalMoney)})).sort((le,$e)=>$e.packages-le.packages).slice(0,10);p(De),ae.length||l("Sin datos para el rango seleccionado.")}catch(de){console.error(de),l(" Error cargando consolidado de vendedores.")}finally{s(!1)}};g.useEffect(()=>{Object.keys(c).length&&P()},[c]);const O=(de,ue)=>{j(de),_(ue),b(!0)},z=()=>{b(!1),j(null),_(null)},ce=()=>{if(!A.length){l("No hay datos para exportar.");return}const de=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],ue=A.map(F=>[F.vendorName,F.branchLabel,F.orderedPackages.toString(),F.remainingPackages.toString(),F.soldPackages.toString(),F.creditPackages.toString(),F.totalSoldMoney.toFixed(2),F.commissionCash.toFixed(2),F.totalCreditMoney.toFixed(2),F.commissionCredit.toFixed(2),F.ordersCreated.toString()]),me=[de,...ue].map(F=>F.map(H=>`"${String(H).replace(/"/g,'""')}"`).join(",")).join(`
`),se=new Blob([me],{type:"text/csv;charset=utf-8;"}),ke=URL.createObjectURL(se),Re=document.createElement("a");Re.href=ke,Re.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Re.click(),URL.revokeObjectURL(ke)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:de=>e(de.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:de=>n(de.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:P,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:a,children:a?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:ce,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Fh(B)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Fh(T)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:A.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[A.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:de.vendorName}),i.jsx("td",{className:"border p-1",children:de.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(de.vendorId,"ordered"),children:de.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(de.vendorId,"remaining"),children:de.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(de.vendorId,"sold"),children:de.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>O(de.vendorId,"credit"),children:de.creditPackages})}),i.jsx("td",{className:"border p-1",children:Fh(de.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Fh(de.commissionCash)}),i.jsx("td",{className:"border p-1",children:Fh(de.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Fh(de.commissionCredit)}),i.jsx("td",{className:"border p-1",children:de.ordersCreated})]},de.vendorId)),A.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((de,ue)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ue+1}),i.jsx("td",{className:"border p-1",children:de.productName}),i.jsx("td",{className:"border p-1",children:de.packages}),i.jsx("td",{className:"border p-1",children:Fh(de.totalMoney)})]},de.productName)),m.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&I&&w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",I==="ordered"?"Paquetes ordenados":I==="remaining"?"Paquetes restantes":I==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[S==null?void 0:S.vendorName,"  ",S==null?void 0:S.branchLabel]})]}),i.jsx("button",{onClick:z,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[E.map((de,ue)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:de.date}),i.jsx("td",{className:"border p-1",children:de.productName}),i.jsx("td",{className:"border p-1",children:de.packages}),i.jsx("td",{className:"border p-1",children:Fh(de.totalMoney)}),i.jsx("td",{className:"border p-1",children:de.vendorName}),i.jsx("td",{className:"border p-1",children:Fh(de.vendorCommission)})]},ue)),E.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const ql=t=>`C$${Number(t||0).toFixed(2)}`,f_=t=>Number(t||0).toFixed(3),oB=()=>{const t=new Date;return Mr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},h_=()=>Mr(new Date,"yyyy-MM-dd");function dVe({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState([]),o=g.useMemo(()=>{const pe={};return a.forEach(Pe=>{Pe.email&&(pe[Pe.email.trim().toLowerCase()]=Pe)}),pe},[a]);g.useEffect(()=>{(async()=>{try{const pe=sr(yt(Ie,"sellers_candies"),In("name","asc")),Pe=await Ht(pe),Ee=[];Pe.forEach(Ze=>{const xe=Ze.data();Ee.push({id:Ze.id,name:xe.name||"",email:xe.email||"",commissionPercent:Number(xe.commissionPercent||0)})}),s(Ee)}catch(pe){console.error(pe)}})()},[]);const[l,c]=g.useState(oB()),[u,d]=g.useState(h_()),[f,A]=g.useState(""),[h,m]=g.useState(""),p=g.useMemo(()=>{const pe=new Map;return n.forEach(Pe=>{const Ee=Pe.productId||Pe.productName;pe.set(Ee,{key:Ee,name:Pe.productName})}),Array.from(pe.values()).sort((Pe,Ee)=>Pe.name.localeCompare(Ee.name))},[n]),x=g.useMemo(()=>{const pe=new Map;return n.forEach(Pe=>{const Ee=(Pe.sellerEmail||"").trim().toLowerCase();if(!Ee)return;const Ze=o[Ee],xe=(Ze==null?void 0:Ze.name)||Pe.vendorName||Ee;pe.set(Ee,{email:Ee,label:xe})}),Array.from(pe.values()).sort((Pe,Ee)=>Pe.label.localeCompare(Ee.label))},[n,o]),v=g.useMemo(()=>n.filter(pe=>!(l&&pe.date<l||u&&pe.date>u||f&&(pe.productId||pe.productName)!==f||h&&(pe.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,u,f,h]),[y,b]=g.useState(h_()),[w,j]=g.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[I,_]=g.useState(""),[S,E]=g.useState("0"),[B,T]=g.useState(()=>v.map(pe=>pe.id));g.useEffect(()=>{T(pe=>pe.filter(Pe=>v.some(Ee=>Ee.id===Pe)))},[v]);const[P,O]=g.useState([]),[z,ce]=g.useState([]),[de,ue]=g.useState(!1),[me,se]=g.useState(oB()),[ke,Re]=g.useState(h_());g.useEffect(()=>{(async()=>{try{ue(!0);const pe=sr(yt(Ie,"expensesCandies"),In("date","desc")),Pe=await Ht(pe),Ee=[];Pe.forEach(Ze=>{const xe=Ze.data();Ee.push({id:Ze.id,date:xe.date,description:xe.description,amount:Number(xe.amount||0)})}),O(Ee)}catch(pe){console.error(pe)}finally{ue(!1)}})()},[]);const F=g.useMemo(()=>P.filter(pe=>!(!pe.date||me&&pe.date<me||ke&&pe.date>ke)),[P,me,ke]),[H,K]=g.useState([]),[L,W]=g.useState(!1),[Y,D]=g.useState(""),[Q,ee]=g.useState("DEBITO"),[ve,M]=g.useState(""),Ye=()=>{const pe=Number(ve);!Y.trim()||!isFinite(pe)||pe<=0||(K(Pe=>[...Pe,{id:`${Date.now()}_${Pe.length+1}`,description:Y.trim(),type:Q,amount:Number(pe.toFixed(2))}]),D(""),M(""))},[ae,X]=g.useState(null),[De,le]=g.useState(""),[$e,Xe]=g.useState("DEBITO"),[it,xt]=g.useState(""),jt=pe=>{X(pe.id),le(pe.description),Xe(pe.type),xt(pe.amount.toFixed(2))},Mt=()=>{X(null),le(""),Xe("DEBITO"),xt("")},Ft=()=>{if(!ae)return;const pe=Number(it);!isFinite(pe)||pe<=0||(K(Pe=>Pe.map(Ee=>Ee.id===ae?{...Ee,description:De.trim(),type:$e,amount:Number(pe.toFixed(2))}:Ee)),Mt())},$t=pe=>{K(Pe=>Pe.filter(Ee=>Ee.id!==pe)),ae===pe&&Mt()},kt=(pe,Pe)=>{T(Ee=>Pe?[...new Set([...Ee,pe])]:Ee.filter(Ze=>Ze!==pe))},Ge=pe=>{T(pe?v.map(Pe=>Pe.id):[])},ie=(pe,Pe)=>{ce(Ee=>Pe?[...new Set([...Ee,pe])]:Ee.filter(Ze=>Ze!==pe))},Ue=g.useMemo(()=>v.filter(pe=>B.includes(pe.id)),[v,B]),Ne=g.useMemo(()=>H.filter(pe=>pe.type==="DEBITO").reduce((pe,Pe)=>pe+Pe.amount,0),[H]),be=g.useMemo(()=>H.filter(pe=>pe.type==="CREDITO").reduce((pe,Pe)=>pe+Pe.amount,0),[H]),Ce=g.useMemo(()=>{let pe=0,Pe=0,Ee=0,Ze=0;for(const Tt of Ue){const Lt=Number(Tt.packages||0),Me=Number(Tt.cogsAmount||0),_e=Number(Tt.amount||0);pe+=Lt,Pe+=Me,Ee+=_e;const U=(Tt.sellerEmail||"").trim().toLowerCase(),ye=o[U],te=Number((ye==null?void 0:ye.commissionPercent)||0),Ve=_e*te/100;Ze+=Ve}const xe=F.filter(Tt=>z.includes(Tt.id)).reduce((Tt,Lt)=>Tt+Number(Lt.amount||0),0),Se=Ee-Pe,gt=Ee-xe-Ne+be-Ze,Et=Number(S||0),Nt=Ee*Et/100;return{totalPackages:Number(f_(pe)),totalProvider:Number(Pe.toFixed(2)),totalSale:Number(Ee.toFixed(2)),totalGastos:Number(xe.toFixed(2)),debits:Number(Ne.toFixed(2)),credits:Number(be.toFixed(2)),grossProfit:Number(Se.toFixed(2)),finalAmount:Number(gt.toFixed(2)),totalCommissionVendors:Number(Ze.toFixed(2)),branchProfit:Number(Nt.toFixed(2)),branchFactor:Et}},[Ue,F,z,Ne,be,o,S]),[Le,Ae]=g.useState(!1),[We,ct]=g.useState(""),_t=async()=>{if(ct(""),Ue.length===0){ct("Selecciona al menos 1 transaccin procesada.");return}try{Ae(!0);const pe={number:w.trim(),date:y,description:I.trim(),status:"PENDIENTE",createdAt:vr.now(),totalPackages:Ce.totalPackages,totalProvider:Ce.totalProvider,totalSale:Ce.totalSale,totalExpenses:Ce.totalGastos,totalDebits:Ce.debits,totalCredits:Ce.credits,grossProfit:Ce.grossProfit,totalCommissionVendors:Ce.totalCommissionVendors,branchFactorPercent:Ce.branchFactor,branchProfit:Ce.branchProfit,finalAmount:Ce.finalAmount,transactions:Ue.map(Pe=>{const Ee=Number(Pe.packages||0)||1,Ze=Number(Pe.cogsAmount||0),xe=Number(Pe.amount||0),Se=Ze/Ee,gt=xe/Ee,Et=(Pe.sellerEmail||"").trim().toLowerCase(),Nt=o[Et],Tt=Number((Nt==null?void 0:Nt.commissionPercent)||0),Lt=xe*Tt/100;return{id:Pe.id,date:Pe.date,productId:Pe.productId||null,productName:Pe.productName,vendorName:Pe.vendorName,sellerEmail:Pe.sellerEmail||null,packages:Number(f_(Pe.packages)),providerPricePack:Number(Se.toFixed(4)),salePricePack:Number(gt.toFixed(4)),totalProvider:Number(Ze.toFixed(2)),totalSale:Number(xe.toFixed(2)),commissionPercent:Tt,commissionAmount:Number(Lt.toFixed(2))}}),expenses:F.filter(Pe=>z.includes(Pe.id)).map(Pe=>({id:Pe.id,date:Pe.date||null,description:Pe.description||"",amount:Number(Number(Pe.amount||0).toFixed(2))})),adjustments:H.map(Pe=>({id:Pe.id,description:Pe.description,type:Pe.type,amount:Number(Pe.amount.toFixed(2))}))};await Jn(yt(Ie,"invoicesCandies"),pe),ct(" Factura de dulces creada."),r()}catch(pe){console.error(pe),ct(` Error al crear factura: ${(pe==null?void 0:pe.message)||"desconocido"}`)}finally{Ae(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:pe=>b(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:w,onChange:pe=>j(pe.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:pe=>E(pe.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:I,onChange:pe=>_(pe.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:pe=>c(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:pe=>d(pe.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:f,onChange:pe=>A(pe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(pe=>i.jsx("option",{value:pe.key,children:pe.name},pe.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:pe=>m(pe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(pe=>i.jsx("option",{value:pe.email,children:pe.label},pe.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(oB()),d(h_()),A(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.length>0&&B.length===v.length,onChange:pe=>Ge(pe.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),v.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:v.map(pe=>{const Pe=B.includes(pe.id),Ee=Number(pe.packages||0)||1,Ze=Number(pe.cogsAmount||0),xe=Number(pe.amount||0),Se=Ze/Ee,gt=xe/Ee,Et=(pe.sellerEmail||"").trim().toLowerCase(),Nt=o[Et],Tt=Number((Nt==null?void 0:Nt.commissionPercent)||0),Lt=xe*Tt/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:Pe,onChange:Me=>kt(pe.id,Me.target.checked)})}),i.jsx("td",{className:"p-2 border",children:pe.date}),i.jsx("td",{className:"p-2 border",children:(Nt==null?void 0:Nt.name)||pe.vendorName}),i.jsx("td",{className:"p-2 border",children:pe.productName}),i.jsx("td",{className:"p-2 border",children:f_(pe.packages)}),i.jsx("td",{className:"p-2 border",children:ql(Se)}),i.jsx("td",{className:"p-2 border",children:ql(gt)}),i.jsx("td",{className:"p-2 border",children:ql(Ze)}),i.jsx("td",{className:"p-2 border",children:ql(xe)}),i.jsx("td",{className:"p-2 border",children:Tt>0?`${ql(Lt)} (${Tt.toFixed(2)}%)`:""})]},pe.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),de&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:me,onChange:pe=>se(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:ke,onChange:pe=>Re(pe.target.value)})]})]})]}),F.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:F.map(pe=>{const Pe=z.includes(pe.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:Pe,onChange:Ee=>ie(pe.id,Ee.target.checked)})}),i.jsx("td",{className:"p-2 border",children:pe.date||""}),i.jsx("td",{className:"p-2 border",children:pe.description||""}),i.jsx("td",{className:"p-2 border",children:ql(Number(pe.amount||0))})]},pe.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>W(!0),children:"Crear Cargo"})]}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.map(pe=>{const Pe=ae===pe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Pe?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:De,onChange:Ee=>le(Ee.target.value)}):i.jsx("span",{title:pe.description,children:pe.description.length>60?`${pe.description.slice(0,60)}`:pe.description})}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:$e,onChange:Ee=>Xe(Ee.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${pe.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:pe.type})}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:it,onChange:Ee=>xt(Ee.target.value)}):ql(pe.amount)}),i.jsx("td",{className:"p-2 border",children:Pe?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Ft,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Mt,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>$t(pe.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>jt(pe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>$t(pe.id),children:"Eliminar"})]})})]},pe.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:f_(Ce.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:ql(Ce.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:ql(Ce.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:ql(Ce.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:ql(Ce.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:ql(Ce.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:ql(Ce.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:ql(Ce.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:ql(Ce.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:ql(Ce.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:Le,onClick:_t,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:Le?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),We&&i.jsx("span",{className:"text-sm ml-2",children:We})]}),Le&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),L&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>W(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:Y,onChange:pe=>D(pe.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Q,onChange:pe=>ee(pe.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:ve,onChange:pe=>M(pe.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Ye,children:"Agregar"})})]})]})})]})}const Ka=t=>`C$ ${Number(t??0).toFixed(2)}`,A_=t=>Number(t??0).toFixed(3);function lB(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),a=Number(t.totalSale??0),s=Number(t.totalCommissionVendors??0);if(e.length>0&&(a===0||r===0)){r=0,n=0,a=0,s=0;for(const v of e){const y=Number(v.packages??0);r+=y,n+=Number(v.totalProvider??y*(v.providerPricePack??0)),a+=Number(v.totalSale??y*(v.salePricePack??0));const b=v.commissionAmount??Number(v.totalSale??0)*Number(v.commissionPercent??0)/100;s+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((v,y)=>v+Number(y.amount||0),0),u=l.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),d=l.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):u,A=t.totalCredits!==void 0?Number(t.totalCredits):d,h=a-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):a-s-c-f+A;return{totalPackages:r,totalProvider:n,totalSale:a,commissionTotal:s,expenses:c,debits:f,credits:A,grossProfit:h,branchProfit:p,finalAmount:x}}function NG(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function fVe(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),u=async()=>{n(!0);const h=sr(yt(Ie,"invoicesCandies"),In("date","desc")),m=await Ht(h),p=[];m.forEach(x=>{const v=x.data();p.push({id:x.id,date:v.date,number:v.number,description:v.description,status:v.status||"PENDIENTE",totalPackages:v.totalPackages||0,totalProvider:v.totalProvider||0,totalSale:v.totalSale||0,totalExpenses:v.totalExpenses||0,totalDebits:v.totalDebits||0,totalCredits:v.totalCredits||0,totalCommissionVendors:v.totalCommissionVendors||0,finalAmount:v.finalAmount||0,branchFactorPercent:v.branchFactorPercent||0,branchProfit:v.branchProfit||0,transactions:(v.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(v.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(v.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};g.useEffect(()=>{u()},[]);const d=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await Fn(Zt(Ie,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(a==null?void 0:a.id)===h.id&&s({...h,status:m})},f=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await Kn(Zt(Ie,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(a==null?void 0:a.id)===h.id&&s(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},A=async()=>{if(!o.current||!a)return;const h=o.current,m=await Fg(h,{backgroundColor:"#ffffff",onclone:b=>{const w=b.body;w.style.background="#ffffff",w.querySelectorAll("*").forEach(j=>{const I=b.defaultView.getComputedStyle(j);I.boxShadow&&I.boxShadow!=="none"&&(j.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new rn("p","mm","a4"),v=x.internal.pageSize.getWidth(),y=m.height*v/m.width;x.addImage(p,"PNG",0,0,v,y),x.save(`factura_candy_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(dVe,{onClose:()=>c(!1),onCreated:()=>{c(!1),u()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=lB(h),p=NG(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:A_(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>d(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>f(h),children:"Eliminar"})]})})]},h.id)})})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=lB(a),m=NG(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",A_(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Ka(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Ka(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Ka(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Ka(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Ka(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Ka(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Ka(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(a.transactions||[]).length>0?(a.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:A_(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Ka(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=lB(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:A_(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:Ka(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:Ka(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:Ka(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:Ka(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:Ka(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Ka(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Ka(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Ka(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Ka(h.finalAmount)})]})})]})})()]})]})}const Ms=t=>Math.round((Number(t)||0)*100)/100,b0=t=>Math.round((Number(t)||0)*1e3)/1e3,vo=t=>Number(t??0).toFixed(2),Oh=t=>Number(t??0).toFixed(3),hVe=(t,e)=>{var A;const r=t.date??((A=t.timestamp)!=null&&A.toDate?Mr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((h,m)=>{const p=Number((h==null?void 0:h.packages)??(h==null?void 0:h.qty)??(h==null?void 0:h.quantity)??0),x=Number((h==null?void 0:h.lineFinal)??0)||Math.max(0,Number((h==null?void 0:h.unitPricePackage)||(h==null?void 0:h.unitPrice)||0)*p-Number((h==null?void 0:h.discount)||0));let v=0;return c>0&&l>0&&Number(x||0)>0&&(v=Ms(c*Number(x||0)/l)),{id:`${e}#${m}`,productName:String((h==null?void 0:h.productName)??"(sin nombre)"),quantity:p,amount:Ms(x),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:v}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0,f=Ms(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:String((t==null?void 0:t.productName)??"(sin nombre)"),quantity:u,amount:Ms(d),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:f}]};function AVe({role:t,roles:e,currentUserEmail:r,sellerCandyId:n}){const a=e&&e.length?e:t,s=!a||En(a,"admin"),o="daily_closures_candies",l="sales_candies",c="sellers_candies",[u,d]=g.useState(Mr(Gee(new Date),"yyyy-MM-dd")),[f,A]=g.useState(Mr(new Date,"yyyy-MM-dd")),[h,m]=g.useState(!0),[p,x]=g.useState([]),[v,y]=g.useState(null),[b,w]=g.useState(""),[j,I]=g.useState([]),[_,S]=g.useState("ALL"),[E,B]=g.useState({}),T=g.useRef(null);if(!s)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const P=async()=>{try{const Y=await Ht(yt(Ie,c)),D=[];Y.forEach(Q=>{const ee=Q.data();D.push({id:Q.id,name:ee.name||"",commissionPercent:Number(ee.commissionPercent||0)})}),I(D)}catch(Y){console.error("Error cargando sellers_candies",Y)}},O=async()=>{const Y=performance.now();try{m(!0);const D=sr(yt(Ie,o),mr("date",">=",u),mr("date","<=",f)),Q=await Ht(D),ee=performance.now();console.log(" getDocs ms:",(ee-Y).toFixed(1),"docs:",Q.size);const ve=[];Q.forEach(X=>ve.push({id:X.id,...X.data()}));const M=performance.now();console.log(" parse+set ms:",(M-ee).toFixed(1),"rows:",ve.length),ve.sort((X,De)=>X.date<De.date?1:X.date>De.date?-1:0),x(ve),y(null);const Ye=new Set;ve.forEach(X=>{(X.sales||[]).forEach(De=>{const le=String((De==null?void 0:De.id)??"").split("#")[0].trim();le&&Ye.add(le)})});const ae=Array.from(Ye).filter(X=>!E[X]);if(ae.length>0){const X={};for(const De of ae)try{const le=await zs(Zt(Ie,l,De));if(le.exists()){const $e=le.data();X[De]=hVe($e,De)}else X[De]=[]}catch(le){console.error("Error leyendo sale",De,le),X[De]=[]}B(De=>({...De,...X}))}}catch(D){console.error(D),w(" Error cargando liquidaciones.")}finally{m(!1)}};g.useEffect(()=>{P()},[]),g.useEffect(()=>{O()},[]);const z=async Y=>{Y.preventDefault(),await O()},ce=g.useMemo(()=>{const Y={};return j.forEach(D=>Y[D.id]=D.name||D.id),Y},[j]),de=Y=>{const D=[];return(Y.sales||[]).forEach(Q=>{const ee=String((Q==null?void 0:Q.id)??"").trim();if(!ee)return;const ve=ee.split("#")[0],Ye=(E[ve]||[]).find(ae=>ae.id===ee);Ye?D.push(Ye):D.push({id:ee,productName:String((Q==null?void 0:Q.productName)??"(sin nombre)"),quantity:Number((Q==null?void 0:Q.quantity)??0),amount:Ms(Number((Q==null?void 0:Q.amount)??0)),date:String((Q==null?void 0:Q.date)??""),type:"CONTADO",vendorId:"",userEmail:String((Q==null?void 0:Q.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),D},ue=Y=>_==="ALL"?Y:Y.filter(D=>(D.vendorId||"")===_),me=g.useMemo(()=>p.map(Y=>{const D=ue(de(Y));let Q=0,ee=0,ve=0,M=0,Ye=0,ae=0;for(const X of D){const De=Number(X.quantity||0),le=Number(X.amount||0),$e=Number(X.vendorCommissionAmount||0);X.type==="CREDITO"?(ee+=De,M+=le,ae+=$e):(Q+=De,ve+=le,Ye+=$e)}return{...Y,_sales:D,_packsCash:b0(Q),_packsCredit:b0(ee),_amountCash:Ms(ve),_amountCredit:Ms(M),_comCash:Ms(Ye),_comCredit:Ms(ae)}}),[p,E,_]),se=g.useMemo(()=>{let Y=0,D=0,Q=0,ee=0,ve=0,M=0;for(const Ye of me)Y+=Number(Ye._packsCash||0),D+=Number(Ye._packsCredit||0),Q+=Number(Ye._amountCash||0),ee+=Number(Ye._amountCredit||0),ve+=Number(Ye._comCash||0),M+=Number(Ye._comCredit||0);return{packsCash:b0(Y),packsCredit:b0(D),totalSales:Ms(Q+ee),amountCash:Ms(Q),amountCredit:Ms(ee),comCash:Ms(ve),comCredit:Ms(M)}},[me]),ke=g.useMemo(()=>{const Y={},D={};for(const Q of me){const ee=Q._sales||[];for(const ve of ee){const M=(ve.vendorId||"").trim();if(!M)continue;const Ye=ce[M]||ve.userEmail||M,ae=Ms(Number(ve.vendorCommissionAmount||0));ve.type==="CREDITO"?(D[M]||(D[M]={vendorId:M,name:Ye,total:0}),D[M].total=Ms(D[M].total+ae)):(Y[M]||(Y[M]={vendorId:M,name:Ye,total:0}),Y[M].total=Ms(Y[M].total+ae))}}return{cashRows:Object.values(Y).filter(Q=>Q.total>0).sort((Q,ee)=>ee.total-Q.total),creditRows:Object.values(D).filter(Q=>Q.total>0).sort((Q,ee)=>ee.total-Q.total)}},[me,ce]),Re=g.useMemo(()=>j.map(Y=>({id:Y.id,label:Y.name||Y.id})).sort((Y,D)=>Y.label.localeCompare(D.label)),[j]),F=g.useMemo(()=>v&&me.find(Y=>Y.id===v.id)||null,[v,me]),H=g.useMemo(()=>F?F._sales||[]:[],[F]),K=g.useMemo(()=>{let Y=0,D=0,Q=0,ee=0;for(const ve of H)ve.type==="CREDITO"?(D+=Number(ve.quantity||0),ee+=Number(ve.amount||0)):(Y+=Number(ve.quantity||0),Q+=Number(ve.amount||0));return{packsCash:b0(Y),packsCredit:b0(D),amountCash:Ms(Q),amountCredit:Ms(ee)}},[H]),L=g.useMemo(()=>{const Y={};for(const D of H){const Q=D.productName||"(sin nombre)";Y[Q]||(Y[Q]={productName:Q,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const ee=Number(D.quantity||0),ve=Number(D.amount||0),M=Number(D.vendorCommissionAmount||0);D.type==="CREDITO"?(Y[Q].packsCredit=b0(Y[Q].packsCredit+ee),Y[Q].amountCredit=Ms(Y[Q].amountCredit+ve),Y[Q].comCredit=Ms(Y[Q].comCredit+M)):(Y[Q].packsCash=b0(Y[Q].packsCash+ee),Y[Q].amountCash=Ms(Y[Q].amountCash+ve),Y[Q].comCash=Ms(Y[Q].comCash+M))}return Object.values(Y)},[H]),W=async()=>{if(!T.current||!F)return;const Y=T.current;Y.classList.add("force-pdf-colors");try{const Q=(await Fg(Y,{backgroundColor:"#ffffff"})).toDataURL("image/png"),ee=new rn;ee.addImage(Q,"PNG",10,10,190,0),ee.save(`liquidacion_${F.date}.pdf`)}finally{Y.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:z,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:Y=>d(Y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:Y=>A(Y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:_,onChange:Y=>S(Y.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),Re.map(Y=>i.jsx("option",{value:Y.id,children:Y.label},Y.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Oh(se.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Oh(se.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(se.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(se.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(se.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(se.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",vo(se.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),ke.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ke.cashRows.map(Y=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Y.name}),i.jsxs("strong",{className:"ml-2",children:["C$",vo(Y.total)]})]},Y.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),ke.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ke.creditRows.map(Y=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Y.name}),i.jsxs("strong",{className:"ml-2",children:["C$",vo(Y.total)]})]},Y.vendorId))})]})]}),h?i.jsx("p",{children:"Cargando..."}):me.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:me.map(Y=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Y.date}),i.jsx("td",{className:"border p-1",children:Oh(Y._packsCash)}),i.jsx("td",{className:"border p-1",children:Oh(Y._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>y(Y),children:"Ver detalle"})})})]},Y.id))})]}),F&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",F.date]}),i.jsx("button",{onClick:()=>y(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:W,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:T,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",vo(K.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",vo(K.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Oh(K.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Oh(K.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:H.map((Y,D)=>{const Q=Y.vendorId&&ce[Y.vendorId]?ce[Y.vendorId]:Y.userEmail,ee=Ms(Number(Y.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Q}),i.jsx("td",{className:"border p-1",children:Y.productName}),i.jsx("td",{className:"border p-1",children:Y.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Oh(Y.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y.amount)]}),i.jsx("td",{className:"border p-1",children:ee>0?`C$${vo(ee)}`:""}),i.jsx("td",{className:"border p-1",children:Y.date||""})]},D)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),L.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:L.map((Y,D)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Y.productName}),i.jsx("td",{className:"border p-1",children:Oh(Y.packsCash)}),i.jsx("td",{className:"border p-1",children:Oh(Y.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",vo(Y.comCredit)]})]},D))})]})]})]}),b&&i.jsx("p",{className:"mt-3 text-sm",children:b})]})}const Kr=t=>Math.round((Number(t)||0)*100)/100,hl=t=>Math.round((Number(t)||0)*1e3)/1e3,Lr=t=>Number(t??0).toFixed(2),si=t=>Number(t??0).toFixed(3),sI=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},Or=t=>{const e=Number(t);return Number.isFinite(e)?e:0},mVe=t=>Math.max(0,Math.min(1,t));function CG({title:t,series:e,valuePrefix:r="C$"}){const u=e.map(b=>Number(b.value||0)),d=u.length?Math.min(...u):0,f=u.length?Math.max(...u):0,A=f-d||1,h=840,m=204,p=e.map((b,w)=>{const j=44+(e.length<=1?h/2:w/(e.length-1)*h),I=18+(1-(Number(b.value||0)-d)/A)*m;return{x:j,y:I,...b}}),x=p.map((b,w)=>`${w===0?"M":"L"} ${b.x.toFixed(2)} ${b.y.toFixed(2)}`).join(" "),v=p[p.length-1],y=v?v.value:0;return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base",children:t}),i.jsxs("div",{className:"text-xs text-gray-600 whitespace-nowrap",children:["ltimo: ",i.jsx("strong",{children:r+Lr(y)})]})]}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("svg",{viewBox:"0 0 900 260",className:"min-w-[720px] w-full h-auto",role:"img","aria-label":t,children:[[0,1,2,3].map(b=>{const w=18+b/3*m;return i.jsx("line",{x1:44,y1:w,x2:884,y2:w,stroke:"#e5e7eb",strokeWidth:"1"},b)}),i.jsxs("text",{x:8,y:28,fontSize:"12",fill:"#6b7280",children:[r,Lr(f)]}),i.jsxs("text",{x:8,y:18+m,fontSize:"12",fill:"#6b7280",children:[r,Lr(d)]}),i.jsx("path",{d:x,fill:"none",stroke:"#111827",strokeWidth:"2.5"}),p.map((b,w)=>i.jsx("circle",{cx:b.x,cy:b.y,r:"3.5",fill:"#111827"},w)),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("text",{x:44,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"start",children:e[0].label}),i.jsx("text",{x:884,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"end",children:e[e.length-1].label})]})]})})]})}function pVe({title:t,items:e}){const r=e.reduce((f,A)=>f+Number(A.value||0),0),n=240,a=86,s=120,o=120,l=r>0?r:1;let c=0;const u=["#111827","#374151","#6b7280","#9ca3af"],d=e.map((f,A)=>{const h=Math.max(0,Number(f.value||0)),m=c/l,p=h/l;c+=h;const x=m+p,v=m*Math.PI*2-Math.PI/2,y=x*Math.PI*2-Math.PI/2,b=s+a*Math.cos(v),w=o+a*Math.sin(v),j=s+a*Math.cos(y),I=o+a*Math.sin(y),_=p>.5?1:0;return{d:[`M ${s} ${o}`,`L ${b.toFixed(2)} ${w.toFixed(2)}`,`A ${a} ${a} 0 ${_} 1 ${j.toFixed(2)} ${I.toFixed(2)}`,"Z"].join(" "),fill:u[A%u.length],...f,frac:p}});return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base mb-2",children:t}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("div",{className:"w-full md:w-auto overflow-x-auto",children:i.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"min-w-[240px] w-[260px] h-auto",role:"img","aria-label":t,children:[d.map((f,A)=>i.jsx("path",{d:f.d,fill:f.fill},A)),i.jsx("circle",{cx:s,cy:o,r:"48",fill:"#ffffff"}),i.jsx("text",{x:s,y:o-4,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:"Total"}),i.jsxs("text",{x:s,y:o+16,textAnchor:"middle",fontSize:"14",fill:"#111827",fontWeight:"700",children:["C$",Lr(r)]})]})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.map((f,A)=>{const h=Number(f.value||0),m=mVe(h/(r||1))*100;return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"text-sm font-semibold truncate",children:f.label}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Lr(h)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[m.toFixed(1),"%"]}),i.jsx("div",{className:"h-2 bg-white border rounded-full mt-2 overflow-hidden",children:i.jsx("div",{className:"h-full",style:{width:`${m}%`,background:u[A%u.length]}})})]},f.label)})}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Distribucin basada en ventas del perodo con los filtros actuales."})]})]})]})}const gVe=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?Mr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),a=t.status??"FLOTANTE",s=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),u=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",d=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,f=Number(t.vendorCommissionAmount??0)||0,A=sI(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((v,y)=>{const b=Number((v==null?void 0:v.packages)??0)||0,w=Number((v==null?void 0:v.total)??0)||Math.max(0,Number((v==null?void 0:v.unitPricePackage)||0)*b-Number((v==null?void 0:v.discount)||0)),j=sI(v==null?void 0:v.branch)||A;let I=0;return f>0&&d>0&&w>0&&(I=Kr(f*w/d)),{id:`${e}#${y}`,docId:e,productId:String((v==null?void 0:v.productId)??""),productName:String((v==null?void 0:v.productName)??"(sin nombre)"),date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:j||"",packages:b,amount:Kr(w),commission:Kr(I)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=Kr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:A||"",packages:h,amount:Kr(m),commission:Kr(p)}]};function xVe({role:t,roles:e}){var Pt;const r=e&&e.length?e:t,n=!r||En(r,"admin"),a=Mr(new Date,"yyyy-MM-dd"),[s,o]=g.useState(a),[l,c]=g.useState(a),[u,d]=g.useState("TODAS"),[f,A]=g.useState("AMBAS"),[h,m]=g.useState("ALL"),[p,x]=g.useState("ALL"),[v,y]=g.useState(""),[b,w]=g.useState(""),[j,I]=g.useState(""),[_,S]=g.useState(""),[E,B]=g.useState("DIA"),[T,P]=g.useState(!0),[O,z]=g.useState(""),[ce,de]=g.useState([]),[ue,me]=g.useState([]),[se,ke]=g.useState([]),[Re,F]=g.useState({}),[H,K]=g.useState([]),[L,W]=g.useState([]),[Y,D]=g.useState([]),[Q,ee]=g.useState([]),[ve,M]=g.useState([]),[Ye,ae]=g.useState([]),[X,De]=g.useState(""),[le,$e]=g.useState(""),[Xe,it]=g.useState(null),xt=g.useRef(null),[jt,Mt]=g.useState([]),[Ft,$t]=g.useState("DETALLE"),[kt,Ge]=g.useState(!1),[ie,Ue]=g.useState(!1),[Ne,be]=g.useState(!1),[Ce,Le]=g.useState(!1),[Ae,We]=g.useState(!1),[ct,_t]=g.useState(!1),pe=g.useMemo(()=>{const he={};return L.forEach(ze=>he[ze.id]=String(ze.name||"").trim()),he},[L]),Pe=g.useMemo(()=>{const he={};return ue.forEach(ze=>he[ze.id]=ze),he},[ue]),Ee=he=>{const ze=he.customerId?pe[he.customerId]:"";return(he.customerName||ze||"").trim()||(he.customerId?pe[he.customerId]||he.customerId:"")||""};g.useEffect(()=>{if(!n)return;(async()=>{try{const ze=await Ht(yt(Ie,"inventory_candies")),nt=[];ze.forEach(ne=>nt.push({id:ne.id,...ne.data()})),Mt(nt)}catch(ze){console.error("inventory_candies all error:",ze),Mt([])}})()},[n]),g.useEffect(()=>{(async()=>{try{const ze=await Ht(yt(Ie,"sellers_candies")),nt=[];ze.forEach(He=>{const pt=He.data();nt.push({id:He.id,name:String(pt.name||"").trim(),commissionPercent:Number(pt.commissionPercent||0),branch:pt.branch||""})});const ne=new Map;nt.forEach(He=>ne.set(He.id,He)),me(Array.from(ne.values()).sort((He,pt)=>He.name.localeCompare(pt.name)))}catch(ze){console.error(ze)}})()},[]),g.useEffect(()=>{if(!n||!s||!l)return;P(!0),z("");const he=sr(yt(Ie,"sales_candies"),mr("date",">=",s),mr("date","<=",l),In("date","asc")),ze=jd(he,nt=>{const ne=[];nt.forEach(He=>ne.push(...gVe(He.data(),He.id))),de(ne),P(!1)},nt=>{console.error("sales_candies periodo error:",nt),de([]),P(!1),z(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>ze()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const ze=sr(yt(Ie,"candy_main_orders"),mr("date",">=",s),mr("date","<=",l)),nt=await Ht(ze),ne=[];nt.forEach(He=>ne.push({id:He.id,...He.data()})),ke(ne)}catch(ze){console.error("candy_main_orders error:",ze),ke([])}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const ze=await Ht(sr(yt(Ie,"candy_main_orders"),In("createdAt","desc"))),nt={},ne=(He,pt)=>`${He}#${String(pt).padStart(10,"0")}`;ze.forEach(He=>{var lr;const pt=He.data(),Dt=Number(((lr=pt.createdAt)==null?void 0:lr.seconds)??0),rr=String(pt.date||""),zt=ne(rr,Dt),Ot=Array.isArray(pt.items)?pt.items:[];for(const Dr of Ot){const br=String(Dr.id||Dr.productId||"");if(!br)continue;const nr={unitPriceRivas:Number(Dr.unitPriceRivas||0),unitPriceSanJorge:Number(Dr.unitPriceSanJorge||0),unitPriceIsla:Number(Dr.unitPriceIsla||0),key:zt},ir=nt[br];(!ir||nr.key>ir.key)&&(nt[br]=nr)}}),F(nt)}catch(ze){console.error("candy_main_orders catalog error:",ze),F({})}})()},[n]),g.useEffect(()=>{if(!n)return;const he=sr(yt(Ie,"inventory_candies_sellers"),mr("date",">=",s),mr("date","<=",l)),ze=jd(he,nt=>{const ne=[];nt.forEach(He=>ne.push({id:He.id,...He.data()})),K(ne)},nt=>{console.error("inventory_candies_sellers error:",nt),K([])});return()=>ze()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const ze=sr(yt(Ie,"expenses_candies"),mr("date",">=",s),mr("date","<=",l),In("date","asc")),nt=await Ht(ze),ne=[];nt.forEach(He=>ne.push({id:He.id,...He.data()})),ee(ne)}catch(ze){console.warn("expenses_candies sin ndice, usando fallback:",ze);try{const nt=await Ht(yt(Ie,"expenses_candies")),ne=[];nt.forEach(He=>ne.push({id:He.id,...He.data()})),ee(ne.filter(He=>String(He.date||"")>=s&&String(He.date||"")<=l))}catch(nt){console.error(nt),ee([])}}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const ze=await Ht(yt(Ie,"inventory_candies")),nt=[];ze.forEach(ne=>nt.push({id:ne.id,...ne.data()})),M(nt)}catch(ze){console.error("inventory_candies global error:",ze),M([])}})()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const ze=await Ht(yt(Ie,"inventory_candies_sellers")),nt=[];ze.forEach(ne=>nt.push({id:ne.id,...ne.data()})),ae(nt)}catch(ze){console.error("inventory_candies_sellers global error:",ze),ae([])}})()},[n]),g.useEffect(()=>{if(!n)return;const he=sr(yt(Ie,"customers_candies")),ze=jd(he,nt=>{const ne=[];nt.forEach(He=>{var pt,Dt,rr;return ne.push({id:He.id,name:String(((pt=He.data())==null?void 0:pt.name)||"").trim(),initialDebt:Number(((Dt=He.data())==null?void 0:Dt.initialDebt)||0),initialDebtDate:String(((rr=He.data())==null?void 0:rr.initialDebtDate)||"").trim()})}),W(ne)},nt=>{console.error("customers_candies snapshot error:",nt),W([])});return()=>ze()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const ze=sr(yt(Ie,"ar_movements"),mr("date","<=",l),In("date","asc")),nt=await Ht(ze),ne=[];nt.forEach(He=>ne.push({id:He.id,...He.data()})),D(ne)}catch(ze){console.warn("ar_movements sin ndice, usando fallback:",ze);try{const nt=await Ht(yt(Ie,"ar_movements")),ne=[];nt.forEach(He=>ne.push({id:He.id,...He.data()})),D(ne.filter(He=>String(He.date||"")<=l))}catch(nt){console.error(nt),D([])}}})()},[n,l]);const Ze=g.useMemo(()=>{let he=[...ce];if(u!=="TODAS"&&(he=he.filter(ne=>ne.status===u)),f==="CASH"&&(he=he.filter(ne=>ne.type==="CONTADO")),f==="CREDITO"&&(he=he.filter(ne=>ne.type==="CREDITO")),h!=="ALL"&&(he=he.filter(ne=>(ne.vendorId||"")===h)),p!=="ALL"&&(he=he.filter(ne=>ne.branch===p)),v.trim()){const ne=v.trim().toLowerCase();he=he.filter(He=>(He.productName||"").toLowerCase().includes(ne))}if(b.trim()){const ne=b.trim().toLowerCase();he=he.filter(He=>(Ee(He)||"").toLowerCase().includes(ne))}const ze=j.trim()?Number(j):null,nt=_.trim()?Number(_):null;return ze!==null&&!Number.isNaN(ze)&&(he=he.filter(ne=>(ne.amount||0)>=ze)),nt!==null&&!Number.isNaN(nt)&&(he=he.filter(ne=>(ne.amount||0)<=nt)),he},[ce,u,f,h,p,v,b,j,_,pe]),xe=g.useMemo(()=>{let he=0,ze=0,nt=0,ne=0,He=0,pt=0;for(const rr of Ze){const zt=Or(rr.packages),Ot=Or(rr.amount),lr=Or(rr.commission);rr.type==="CREDITO"?(ze+=zt,ne+=Ot,pt+=lr):(he+=zt,nt+=Ot,He+=lr)}const Dt=Kr(nt+ne);return{packsCash:hl(he),packsCredit:hl(ze),salesCash:Kr(nt),salesCredit:Kr(ne),salesTotal:Dt,commCash:Kr(He),commCredit:Kr(pt),commTotal:Kr(He+pt)}},[Ze]),Se=g.useMemo(()=>{let he=0,ze=0,nt=0,ne=0,He=0,pt=0;for(const Dt of se){const rr=Array.isArray(Dt.items)?Dt.items:[];for(const zt of rr)he+=Or(zt.totalRivas),ze+=Or(zt.totalSanJorge),nt+=Or(zt.totalIsla),ne+=Or(zt.gainRivas),He+=Or(zt.gainSanJorge),pt+=Or(zt.gainIsla)}return{expectedRivas:Kr(he),expectedSanJorge:Kr(ze),expectedIsla:Kr(nt),grossRivas:Kr(ne),grossSanJorge:Kr(He),grossIsla:Kr(pt),grossTotal:Kr(ne+He+pt),expectedTotal:Kr(he+ze+nt)}},[se]),gt=g.useMemo(()=>{const he={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const ze of Ze){const nt=ze.branch;nt&&(he[nt].sales+=Or(ze.amount),he[nt].packages+=Or(ze.packages))}return{RIVAS:{sales:Kr(he.RIVAS.sales),packages:hl(he.RIVAS.packages)},SAN_JORGE:{sales:Kr(he.SAN_JORGE.sales),packages:hl(he.SAN_JORGE.packages)},ISLA:{sales:Kr(he.ISLA.sales),packages:hl(he.ISLA.packages)}}},[Ze]),Et=g.useMemo(()=>({RIVAS:Kr(gt.RIVAS.sales-Se.expectedRivas),SAN_JORGE:Kr(gt.SAN_JORGE.sales-Se.expectedSanJorge),ISLA:Kr(gt.ISLA.sales-Se.expectedIsla)}),[gt,Se]),Nt=g.useMemo(()=>{const he={},ze={};for(const He of Ze){const pt=(He.vendorId||"").trim();if(!pt)continue;const Dt=ue.find(Ot=>Ot.id===pt),rr=(Dt==null?void 0:Dt.name)||He.vendorName||"(sin vendedor)",zt=Or(He.commission);He.type==="CREDITO"?(ze[pt]||(ze[pt]={vendorId:pt,name:rr,total:0}),ze[pt].total=Kr(ze[pt].total+zt)):(he[pt]||(he[pt]={vendorId:pt,name:rr,total:0}),he[pt].total=Kr(he[pt].total+zt))}const nt=Object.values(he).sort((He,pt)=>pt.total-He.total),ne=Object.values(ze).sort((He,pt)=>pt.total-He.total);return{cashArr:nt,creditArr:ne}},[Ze,ue]),Tt=g.useMemo(()=>{const he=(nr,ir)=>nr.reduce((Nr,Pr)=>Nr+Number((Pr==null?void 0:Pr[ir])??0),0),ze=nr=>{const ir=Number(nr);return Number.isFinite(ir)?Math.floor(ir):0},nt=nr=>{const ir=Number((nr==null?void 0:nr.totalPackages)??0);if(ir>0)return ir;const Nr=Array.isArray(nr==null?void 0:nr.items)?nr.items:[];return he(Nr,"packages")};let ne=0,He=0;for(const nr of se){const ir=Array.isArray(nr.items)?nr.items:[];if(ir.length)for(const Nr of ir)ne+=Number((Nr==null?void 0:Nr.subtotal)??0);else ne+=Number(nr.subtotal??0);He+=nt(nr)}let pt=0,Dt=0,rr=0;const zt=nr=>{const ir=Number(nr==null?void 0:nr.remainingPackages);if(Number.isFinite(ir)&&ir>0)return Math.floor(ir);const Nr=Math.max(1,ze((nr==null?void 0:nr.unitsPerPackage)??1)),Pr=ze((nr==null?void 0:nr.remainingUnits)??(nr==null?void 0:nr.remaining)??0);return Pr>0?Math.max(0,Math.floor(Pr/Nr)):0};for(const nr of H)pt+=Number(nr.subtotal??0),Dt+=Number(nr.packages??0),rr+=zt(nr);const Ot=new Set(se.filter(nr=>String(nr.date||"")>=s&&String(nr.date||"")<=l).map(nr=>nr.id));let lr=0;for(const nr of jt){const ir=String(nr.orderId||"").trim();ir&&Ot.has(ir)&&(lr+=Number(nr.remainingPackages??0))}const Dr=ve.reduce((nr,ir)=>nr+Or(ir.remainingPackages),0),br=Ye.reduce((nr,ir)=>nr+Or(ir.remainingPackages),0);return{providerTotalMaster:Kr(ne),providerTotalVendor:Kr(pt),orderedPacksMaster:hl(He),remainingPacksMaster:hl(lr),orderedPacksVendor:hl(Dt),remainingPacksVendor:hl(rr),globalRemainingMaster:hl(Dr),globalRemainingVendor:hl(br)}},[se,H,jt,s,l,ve,Ye]),Lt=g.useMemo(()=>{const he={};let ze=0;for(const nt of Q){const ne=String(nt.date||"").trim();if(!ne)continue;const He=Math.max(0,Or(nt.amount));ze+=He,he[ne]=Kr((he[ne]||0)+He)}return{total:Kr(ze),byDay:he}},[Q]),Me=g.useMemo(()=>{let he=0;for(const ze of se){const nt=Array.isArray(ze.items)?ze.items:[];if(nt.length)for(const ne of nt)he+=Or(ne==null?void 0:ne.subtotal);else he+=Or(ze.subtotal)}return Kr(he)},[se]),_e=g.useMemo(()=>{var zt;const he=Ot=>{const lr=Math.max(1,Math.floor(Or(Ot.unitsPerPackage||1))),Dr=Or(Ot.totalUnits)>0?Or(Ot.totalUnits):Or(Ot.packages)*lr;let br=0;Or(Ot.remainingUnits)>0?br=Or(Ot.remainingUnits):Or(Ot.remainingPackages)>0?br=Or(Ot.remainingPackages)*lr:br=0;const nr=Math.max(0,Dr-br);return{orderedUnits:Dr,remainingUnits:br,soldUnits:nr,upp:lr}},ze=Ot=>{const lr=Pe[Ot];return sI(lr==null?void 0:lr.branch)||"ISLA"},nt=(Ot,lr)=>{var Dr,br,nr;return lr==="ISLA"?Or(((Dr=Re[String(Ot.productId||"")])==null?void 0:Dr.unitPriceIsla)??Ot.unitPriceIsla):lr==="RIVAS"?Or(((br=Re[String(Ot.productId||"")])==null?void 0:br.unitPriceRivas)??Ot.unitPriceRivas):lr==="SAN_JORGE"?Or(((nr=Re[String(Ot.productId||"")])==null?void 0:nr.unitPriceSanJorge)??Ot.unitPriceSanJorge):0},ne=(Ot,lr)=>{const Dr=Math.max(0,Math.floor(Or(Ot.packages))),br=nt(Ot,lr),nr=Kr(br*Dr);if(nr>0)return nr;const ir=Or(Ot.totalVendor)||(lr==="ISLA"?Or(Ot.totalIsla):lr==="RIVAS"?Or(Ot.totalRivas):lr==="SAN_JORGE"?Or(Ot.totalSanJorge):0);if(ir>0)return ir;const Nr=Or(Ot.unitPriceVendor);if(Nr>0){const{orderedUnits:Pr}=he(Ot);return Nr*Pr}return 0},He=(Ot,lr)=>{const Dr=nt(Ot,lr),{orderedUnits:br,upp:nr}=he(Ot);if(Dr>0&&nr>0)return Dr/nr;const ir=Or(Ot.unitPriceVendor);if(ir>0)return ir;const Nr=ne(Ot,lr);return Nr>0&&br>0?Nr/br:0},pt=new Map;for(const Ot of H){const lr=String(Ot.orderId||"").trim(),Dr=lr||`DOC:${Ot.id}`,br=String(Ot.sellerId||"").trim(),nr=String(Ot.sellerName||"").trim()||br&&((zt=Pe[br])==null?void 0:zt.name)||""||"(sin vendedor)",ir=String(Ot.date||"").trim(),Nr=br?ze(br):"",{orderedUnits:Pr,remainingUnits:xr,soldUnits:$r}=he(Ot),cr=ne(Ot,Nr),Zr=He(Ot,Nr),Wr=Zr>0?Zr*$r:Pr>0?cr*$r/Pr:0,zr=Kr(cr-Wr);pt.has(Dr)||pt.set(Dr,{orderKey:Dr,orderId:lr||Dr,date:ir,sellerId:br,sellerName:nr,branch:Nr,totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0,lines:[]});const gn=pt.get(Dr);gn.lines.push({...Ot,orderedUnits:Pr,soldUnits:$r,remainingUnits:xr,lineTotal:Kr(cr),lineSoldValue:Kr(Wr),lineRemainingValue:Kr(zr)}),gn.totalOrden+=cr,gn.vendido+=Wr,gn.restante+=zr,gn.comision+=Or(Ot.uVendor??Ot.vendorProfit??Ot.gainVendor)}for(const Ot of pt.values())Ot.comision=Kr(Ot.comision),Ot.totalEsperado=Kr(Ot.totalOrden-Ot.comision),Ot.totalOrden=Kr(Ot.totalOrden),Ot.vendido=Kr(Ot.vendido),Ot.restante=Kr(Ot.restante);const Dt=Array.from(pt.values()).sort((Ot,lr)=>Ot.date&&lr.date?Ot.date<lr.date?1:-1:lr.totalOrden-Ot.totalOrden),rr=Dt.reduce((Ot,lr)=>(Ot.totalOrden+=Or(lr.totalOrden),Ot.vendido+=Or(lr.vendido),Ot.restante+=Or(lr.restante),Ot.comision+=Or(lr.comision),Ot.totalEsperado+=Or(lr.totalEsperado),Ot),{totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0});return{global:{totalOrden:Kr(rr.totalOrden),vendido:Kr(rr.vendido),restante:Kr(rr.restante),comision:Kr(rr.comision),totalEsperado:Kr(rr.totalEsperado)},orders:Dt}},[H,Pe,Re]),U=g.useMemo(()=>{var ne,He,pt;let he=0,ze=0;for(const Dt of H){const rr=String(Dt.sellerId||"").trim(),zt=rr?Pe[rr]:void 0,Ot=sI(zt==null?void 0:zt.branch)||"ISLA",lr=Math.max(0,Math.floor(Or(Dt.packages)));if(!lr)continue;const Dr=Or(Ot==="ISLA"?((ne=Re[String(Dt.productId||"")])==null?void 0:ne.unitPriceIsla)??Dt.unitPriceIsla:Ot==="RIVAS"?((He=Re[String(Dt.productId||"")])==null?void 0:He.unitPriceRivas)??Dt.unitPriceRivas:((pt=Re[String(Dt.productId||"")])==null?void 0:pt.unitPriceSanJorge)??Dt.unitPriceSanJorge);let br=Kr(Dr*lr);br||(br=Or(Ot==="ISLA"?Dt.totalIsla:Ot==="RIVAS"?Dt.totalRivas:Dt.totalSanJorge)),br&&(he+=br,ze+=br)}const nt=Kr(Or(Se.expectedIsla)-ze);return{dispersedTotal:Kr(he),dispersedIsla:Kr(ze),totalExistenteIsla:nt}},[H,Pe,Se.expectedIsla,Re]),ye=g.useMemo(()=>({net:Kr(H.reduce((ze,nt)=>{const ne=nt.uNeta,He=Or(ne);if(He!==0||ne===0)return ze+He;const pt=Or(nt.grossProfit),Dt=Or(nt.logisticAllocated??nt.gastos??nt.gasto),rr=Or(nt.uVendor??nt.vendorProfit);return ze+(pt-Dt-rr)},0))}),[H]),te=g.useMemo(()=>{let he=0,ze=0,nt=0;for(const ne of Ze){if(ne.type!=="CREDITO")continue;const He=Or(ne.amount),pt=Or(ne.commission);he+=He,ze+=He-pt}for(const ne of Y){const He=String(ne.date||"").trim();if(!He||He<s||He>l)continue;const pt=Or(ne.amount);(ne.type||(pt<0?"ABONO":"CARGO"))==="ABONO"&&(nt+=Math.abs(pt))}return{cxc:Kr(he),recaudado:Kr(nt),utilidadBruta:Kr(ze)}},[Ze,Y,s,l]),Ve=g.useMemo(()=>{if(!le)return null;const he=_e.orders.find(ne=>ne.orderKey===le);if(!he)return null;const ze={};for(const ne of he.lines){const He=String(ne.productName||"(sin nombre)");ze[He]||(ze[He]={productName:He,asociados:0,vendidos:0,restantes:0});const pt=Math.max(0,Math.floor(Or(ne.packages))),Dt=Math.max(1,Math.floor(Or(ne.unitsPerPackage||1))),rr=Math.max(0,Math.floor(Or(ne.remainingPackages)||(Or(ne.remainingUnits)>0?Or(ne.remainingUnits)/Dt:0))),zt=Math.max(0,pt-rr);ze[He].asociados+=pt,ze[He].vendidos+=zt,ze[He].restantes+=rr}const nt=Object.values(ze).map(ne=>({...ne,asociados:Math.floor(ne.asociados),vendidos:Math.floor(ne.vendidos),restantes:Math.floor(ne.restantes)})).sort((ne,He)=>He.asociados-ne.asociados);return{...he,products:nt}},[le,_e.orders]),qe=g.useMemo(()=>{const he=ve.reduce((nt,ne)=>nt+Or(ne.remainingPackages),0),ze=Ye.reduce((nt,ne)=>nt+Or(ne.remainingPackages),0);return{masterRemainingPackages:hl(he),vendorRemainingPackages:hl(ze)}},[ve,Ye]),G=g.useMemo(()=>{const he=new Map,ze=ne=>E==="DIA"?{key:ne.date,label:ne.date}:E==="VENDEDOR"?{key:ne.vendorId||"",label:ne.vendorName||""}:E==="PRODUCTO"?{key:ne.productName||"",label:ne.productName||""}:{key:ne.branch||"",label:ne.branch||""};for(const ne of Ze){const{key:He,label:pt}=ze(ne);he.has(He)||he.set(He,{key:He,label:pt,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const Dt=he.get(He);Dt.rows.push(ne),ne.type==="CREDITO"?(Dt.packsCredit+=Or(ne.packages),Dt.salesCredit+=Or(ne.amount),Dt.commCredit+=Or(ne.commission)):(Dt.packsCash+=Or(ne.packages),Dt.salesCash+=Or(ne.amount),Dt.commCash+=Or(ne.commission))}const nt=Array.from(he.values()).map(ne=>({...ne,packsCash:hl(ne.packsCash),packsCredit:hl(ne.packsCredit),salesCash:Kr(ne.salesCash),salesCredit:Kr(ne.salesCredit),commCash:Kr(ne.commCash),commCredit:Kr(ne.commCredit)}));return E==="DIA"?nt.sort((ne,He)=>ne.key<He.key?1:-1):nt.sort((ne,He)=>He.salesCash+He.salesCredit-(ne.salesCash+ne.salesCredit)),nt},[Ze,E]),V=g.useMemo(()=>{if(!X)return[];const he=G.find(ze=>ze.key===X);return(he==null?void 0:he.rows)||[]},[X,G]),Z=g.useMemo(()=>{const he={};for(const ze of V){const nt=ze.productName||"(sin nombre)";he[nt]||(he[nt]={productName:nt,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),ze.type==="CREDITO"?(he[nt].packsCredit+=Or(ze.packages),he[nt].salesCredit+=Or(ze.amount),he[nt].commCredit+=Or(ze.commission)):(he[nt].packsCash+=Or(ze.packages),he[nt].salesCash+=Or(ze.amount),he[nt].commCash+=Or(ze.commission))}return Object.values(he).map(ze=>({...ze,packsCash:hl(ze.packsCash),packsCredit:hl(ze.packsCredit),salesCash:Kr(ze.salesCash),salesCredit:Kr(ze.salesCredit),commCash:Kr(ze.commCash),commCredit:Kr(ze.commCredit)})).sort((ze,nt)=>nt.salesCash+nt.salesCredit-(ze.salesCash+ze.salesCredit))},[V]),re=g.useMemo(()=>{const he={},ze=pt=>(pe[pt]||"").trim()||pt;for(const pt of L){const Dt=String(pt.id||"").trim();Dt&&(he[Dt]={customerId:Dt,name:ze(Dt),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:Or(pt.initialDebt),initialDebtDate:String(pt.initialDebtDate||"").trim(),movements:[]})}for(const pt of Y){const Dt=String(pt.customerId||"").trim();if(!Dt)continue;const rr=String(pt.date||"");rr&&rr>l||(he[Dt]||(he[Dt]={customerId:Dt,name:ze(Dt),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:0,initialDebtDate:"",movements:[]}),he[Dt].movements.push(pt))}const nt=(pt,Dt,rr)=>{const zt=Number(pt||0);if(!zt)return 0;const Ot=String(Dt||"").trim();return Ot&&rr.some(Dr=>{var Pr;const br=Number(Dr.amount||0);if(!(br>0))return!1;const nr=Math.abs(br-zt)<.01,ir=String(Dr.date||"").trim()===Ot,Nr=!!((Pr=Dr.ref)!=null&&Pr.saleId);return nr&&ir&&Nr})?0:zt},ne=Object.values(he).map(pt=>{const Dt=pt.movements.reduce((lr,Dr)=>lr+Or(Dr.amount),0),rr=nt(pt.initialDebt,pt.initialDebtDate,pt.movements);let zt="",Ot=0;for(const lr of pt.movements){const Dr=lr.type||(Or(lr.amount)<0?"ABONO":"CARGO"),br=String(lr.date||"");if(Dr==="ABONO"){const nr=Math.abs(Or(lr.amount));(!zt||br>zt)&&(zt=br,Ot=nr)}}return{customerId:pt.customerId,name:pt.name,balance:Kr(rr+Dt),lastPayment:zt,lastPaymentAmount:Kr(Ot)}}).filter(pt=>pt.balance>0).sort((pt,Dt)=>Dt.balance-pt.balance),He=Kr(ne.reduce((pt,Dt)=>pt+Dt.balance,0));return{count:ne.length,totalPending:He,list:ne.slice(0,20)}},[Y,pe,L,l]),we=g.useMemo(()=>{if(!Xe)return[];const he=Y.filter(nt=>(nt.customerId||"").trim()===Xe.customerId).filter(nt=>!nt.date||String(nt.date)<=l).map(nt=>({id:nt.id,date:String(nt.date||""),type:String(nt.type||""),amount:Kr(Or(nt.amount))})).sort((nt,ne)=>nt.date<ne.date?-1:nt.date>ne.date?1:0);let ze=0;return he.map(nt=>{const ne=nt.type==="ABONO"?-nt.amount:nt.amount;return ze=Kr(ze+ne),{...nt,running:ze}})},[Xe,Y,l]),Fe=g.useMemo(()=>Xe?ce.filter(he=>(he.customerId||"").trim()===Xe.customerId).filter(he=>!he.date||String(he.date)<=l).sort((he,ze)=>he.date<ze.date?-1:he.date>ze.date?1:0):[],[Xe,ce,l]),st=g.useMemo(()=>{const he=Kr(xe.salesTotal),ze=Kr(xe.commTotal),nt=Kr(Lt.total),ne=Kr(he-ze-nt),He=new Set;for(const lr of Ze)lr.date&&He.add(lr.date);const pt=Math.max(1,He.size),Dt=Kr(he/pt),rr=Kr(ze/pt),zt=Kr(nt/pt),Ot=Kr(ne/pt);return{ingreso:he,comision:ze,gastos:nt,gananciaNeta:ne,daysCount:pt,ingresoDia:Dt,comisionDia:rr,gastosDia:zt,netaDia:Ot}},[xe,Lt.total,Ze]),Be=g.useMemo(()=>{const he={};for(const He of Ze){const pt=He.date;pt&&(he[pt]||(he[pt]={date:pt,ingreso:0,comision:0}),he[pt].ingreso+=Or(He.amount),he[pt].comision+=Or(He.commission))}const ze=Object.keys(he).sort((He,pt)=>He<pt?-1:1),nt=ze.map(He=>({label:He.slice(5),value:Kr(he[He].ingreso)})),ne=ze.map(He=>{var Ot,lr;const pt=Or((Ot=he[He])==null?void 0:Ot.ingreso),Dt=Or((lr=he[He])==null?void 0:lr.comision),rr=Or(Lt.byDay[He]||0),zt=pt-Dt-rr;return{label:He.slice(5),value:Kr(zt)}});return{seriesIngreso:nt,seriesNeta:ne,datesCount:ze.length}},[Ze,Lt.byDay]),at=g.useMemo(()=>[{label:"Rivas",value:Or(gt.RIVAS.sales)},{label:"San Jorge",value:Or(gt.SAN_JORGE.sales)},{label:"Isla",value:Or(gt.ISLA.sales)}].map(he=>({...he,value:Kr(he.value)})),[gt]),lt=async()=>{if(xt.current){xt.current.classList.add("force-pdf-colors");try{const ze=(await Fg(xt.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),nt=new rn;nt.addImage(ze,"PNG",10,10,190,0),nt.save(`data_center_dulces_${s}_a_${l}.pdf`)}finally{xt.current.classList.remove("force-pdf-colors")}}},dt=()=>{const ze=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...Ze.map(pt=>[pt.date,pt.processedDate||"",pt.status,pt.type,pt.vendorId,`"${String(pt.vendorName||"").replace(/"/g,'""')}"`,pt.branch||"",`"${String(pt.productName||"").replace(/"/g,'""')}"`,si(pt.packages),Lr(pt.amount),Lr(pt.commission),pt.customerId||"",`"${String(Ee(pt)||"").replace(/"/g,'""')}"`].join(","))],nt=new Blob([ze.join(`
`)],{type:"text/csv;charset=utf-8;"}),ne=URL.createObjectURL(nt),He=document.createElement("a");He.href=ne,He.download=`data_center_dulces_${s}_a_${l}.csv`,He.click(),URL.revokeObjectURL(ne)};return n?i.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-0",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[i.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-end",children:[i.jsx("button",{onClick:lt,className:`
                inline-flex items-center justify-center gap-2
                w-full sm:w-auto
                px-3 py-2 text-sm font-semibold
                rounded-lg md:rounded-md
                bg-green-600 text-white hover:bg-green-700 transition-colors
              `,children:"Exportar PDF"}),i.jsx("button",{onClick:dt,className:`
                inline-flex items-center justify-center gap-2
                w-full sm:w-auto
                px-3 py-2 text-sm font-semibold
                rounded-lg md:rounded-md
                bg-gray-800 text-white hover:bg-black transition-colors
              `,children:"Exportar CSV"})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ge(he=>!he),"aria-expanded":kt,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${kt?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${kt?"block":"hidden"} border-t p-3 sm:p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:s,onChange:he=>o(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:l,onChange:he=>c(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:u,onChange:he=>d(he.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Tipo"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:f,onChange:he=>A(he.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:h,onChange:he=>m(he.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),ue.map(he=>i.jsx("option",{value:he.id,children:he.name||he.id},he.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Sucursal"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:p,onChange:he=>x(he.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:v,onChange:he=>y(he.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:b,onChange:he=>w(he.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto min"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:j,onChange:he=>I(he.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto max"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:_,onChange:he=>S(he.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:E,onChange:he=>{De(""),B(he.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})})]}),i.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{$e(""),$t("MACRO")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Ft==="MACRO"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Macro"}),i.jsx("button",{onClick:()=>{$e(""),$t("DETALLE")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Ft==="DETALLE"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Detalle"})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Gastos del perodo (expenses_candies):"," ",i.jsxs("strong",{children:["C$",Lr(Lt.total)]})]})]}),i.jsxs("div",{ref:xt,children:[Ft==="MACRO"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ue(he=>!he),"aria-expanded":ie,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${ie?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${ie?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ingreso (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(st.ingreso)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin vendedor (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Lr(st.comision)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Lr(xe.commCash),"  Crdito: C$",Lr(xe.commCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos (expenses_candies)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Lr(st.gastos)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se calcula automtico por fechas"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia neta (real)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(st.gananciaNeta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ingreso  Comisin  Gastos"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Promedio neto por da"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(st.netaDia)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Das con ventas: ",i.jsx("strong",{children:st.daysCount})]})]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[i.jsx(CG,{title:"Ventas por da (Ingreso)",series:Be.seriesIngreso,valuePrefix:"C$"}),i.jsx(CG,{title:"Ganancia neta por da (real)",series:Be.seriesNeta,valuePrefix:"C$"})]}),i.jsx("div",{className:"mb-6",children:i.jsx(pVe,{title:"Distribucin de ventas por sucursal",items:at})})]}),Ft==="DETALLE"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ue(he=>!he),"aria-expanded":ie,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${ie?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${ie?"block":"hidden"} border-t p-3`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(xe.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(xe.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(xe.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Lr(xe.salesCash),"  Crdito: C$",Lr(xe.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(xe.commTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Lr(xe.commCash),"  Crdito: C$",Lr(xe.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Aprox. (rdenes maestras)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(Se.grossIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Lr(Se.expectedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Lr(gt.ISLA.sales)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Lr(Et.ISLA)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado (precio proveedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(Me)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes maestras (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad neta (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(ye.net)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"U bruta  Gastos  U vendedor"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(Tt.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:si(Tt.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:si(qe.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(Tt.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:si(Tt.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:si(qe.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(Tt.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos dispersados (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(U.dispersedTotal)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes de vendedores (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Dispersado Isla (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(U.dispersedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Usado para Total existente"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total existente en productos (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(U.totalExistenteIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esperado Isla  Dispersado Isla"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"CxC (ventas crdito)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(te.cxc)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(xe.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Recaudacin (abonos)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(te.recaudado)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"abonos en ar_movements"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta crdito (ventas  comisin)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Lr(te.utilidadBruta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Paquetes vendidos al crdito"})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>be(he=>!he),"aria-expanded":Ne,children:[i.jsx("span",{children:"rdenes vendedores"}),i.jsx("span",{className:`transition-transform ${Ne?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${Ne?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-4 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Global)"}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Basado en ",i.jsx("strong",{children:"precio de venta"})," (por sucursal del vendedor)"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Lr(_e.global.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Lr(_e.global.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Lr(_e.global.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Lr(_e.global.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Lr(_e.global.totalEsperado)]})]})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Detalle por orden)"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Click/Tap en una orden para ver productos asociados/vendidos/restantes"})]}),_e.orders.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:_e.orders.map(he=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:he.orderId}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1 truncate",children:[he.sellerName," ",he.branch?` ${he.branch}`:""," ",he.date?` ${he.date}`:""]})]}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>$e(he.orderKey),children:"Ver"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.totalOrden)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendido"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.vendido)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restante"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.restante)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.comision)]})]})]})]},he.orderKey))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total orden"}),i.jsx("th",{className:"border p-2",children:"Vendido"}),i.jsx("th",{className:"border p-2",children:"Restante"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Total esperado"}),i.jsx("th",{className:"border p-2",children:"Accin"})]})}),i.jsx("tbody",{children:_e.orders.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:he.sellerName}),i.jsx("td",{className:"border p-2",children:he.branch||""}),i.jsx("td",{className:"border p-2",children:he.date||""}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.totalOrden)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.vendido)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.restante)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.comision)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.totalEsperado)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>$e(he.orderKey),children:"Ver detalle"})})]},he.orderKey))})]})}),Ve&&i.jsxs("div",{className:"mt-4 rounded-2xl border-2 border-gray-100 p-3 sm:p-4 shadow-lg bg-white",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h4",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle orden vendedor "," ",Ve.orderId]}),i.jsx("button",{onClick:()=>$e(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Lr(Ve.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Lr(Ve.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Lr(Ve.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Lr(Ve.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Lr(Ve.totalEsperado)]})]})]}),i.jsx("h5",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Productos asociados (Nombre - Asociados - Vendidos - Restantes)"}),i.jsx("div",{className:"md:hidden space-y-2",children:Ve.products.map(he=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:he.productName}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Asociados"}),i.jsx("div",{className:"font-bold",children:he.asociados})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendidos"}),i.jsx("div",{className:"font-bold",children:he.vendidos})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-bold",children:he.restantes})]})]})]},he.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Nombre producto"}),i.jsx("th",{className:"border p-2",children:"Asociados"}),i.jsx("th",{className:"border p-2",children:"Vendidos"}),i.jsx("th",{className:"border p-2",children:"Restantes"})]})}),i.jsxs("tbody",{children:[Ve.products.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:he.productName}),i.jsx("td",{className:"border p-2",children:he.asociados}),i.jsx("td",{className:"border p-2",children:he.vendidos}),i.jsx("td",{className:"border p-2",children:he.restantes})]},he.productName)),Ve.products.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-500",children:"Sin productos."})})]})]})})]})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Le(he=>!he),"aria-expanded":Ce,children:[i.jsx("span",{children:"Existencias"}),i.jsx("span",{className:`transition-transform ${Ce?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Ce?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(qe.masterRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (vendedores)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:si(qe.vendorRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>We(he=>!he),"aria-expanded":Ae,children:[i.jsx("span",{children:"Vendedores"}),i.jsx("span",{className:`transition-transform ${Ae?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Ae?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),Nt.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:Nt.cashArr.map(he=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:he.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Lr(he.total)]})]},he.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),Nt.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:Nt.creditArr.map(he=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:he.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Lr(he.total)]})]},he.vendorId))})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-6",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>_t(he=>!he),"aria-expanded":ct,children:[i.jsx("span",{children:"Saldos pendientes"}),i.jsx("span",{className:`transition-transform ${ct?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${ct?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:["Saldos pendientes (hasta ",l,")"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:re.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Lr(re.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),re.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:re.list.map(he=>i.jsxs("div",{className:"border rounded-xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:he.name}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Lr(he.balance)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["ltimo abono:"," ",i.jsxs("b",{children:["C$",Lr(he.lastPaymentAmount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha ult. abono:"," ",i.jsx("span",{className:"font-medium",children:he.lastPayment||""})]}),i.jsx("div",{className:"mt-2",children:i.jsx("button",{type:"button",onClick:()=>it(he),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},he.customerId))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:re.list.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:he.name}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.balance)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.lastPaymentAmount)]}),i.jsx("td",{className:"border p-2",children:he.lastPayment||""}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{type:"button",onClick:()=>it(he),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},he.customerId))})]})})]})]})]}),i.jsxs("div",{className:"mb-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold text-sm sm:text-base",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 sm:ml-auto",children:"Tap/Click en Ver detalle para drill-down"})]}),T?i.jsx("p",{className:"text-sm",children:"Cargando..."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2 mb-6",children:G.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."}):G.map(he=>i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:he.label}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>De(he.key),children:"Ver detalle"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"font-bold",children:si(he.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"font-bold",children:si(he.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.commCredit)]})]})]})]},he.key))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-6 shadow-2xl rounded-xl border",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[G.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:he.label}),i.jsx("td",{className:"border p-2",children:si(he.packsCash)}),i.jsx("td",{className:"border p-2",children:si(he.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.commCredit)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>De(he.key),children:"Ver detalle"})})]},he.key)),G.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]})})]}),X&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-3 sm:p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h2",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle "," ",((Pt=G.find(he=>he.key===X))==null?void 0:Pt.label)||X]}),i.jsx("button",{onClick:()=>De(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Lr(V.filter(he=>he.type==="CONTADO").reduce((he,ze)=>he+Or(ze.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Lr(V.filter(he=>he.type==="CREDITO").reduce((he,ze)=>he+Or(ze.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes cash:"," ",i.jsx("strong",{children:si(V.filter(he=>he.type==="CONTADO").reduce((he,ze)=>he+Or(ze.packages),0))})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes crdito:"," ",i.jsx("strong",{children:si(V.filter(he=>he.type==="CREDITO").reduce((he,ze)=>he+Or(ze.packages),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Ventas incluidas"}),i.jsx("div",{className:"md:hidden space-y-2 mb-4",children:V.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin detalle."}):V.map(he=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:he.productName}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Lr(he.amount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:he.vendorName})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Tipo"}),i.jsx("div",{className:"font-bold",children:he.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Sucursal"}),i.jsx("div",{className:"font-bold",children:he.branch||""})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-bold",children:si(he.packages)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.commission)]})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Fecha: ",he.date]})]},he.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[V.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2",children:he.vendorName}),i.jsx("td",{className:"border p-2",children:he.productName}),i.jsx("td",{className:"border p-2",children:he.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-2",children:he.branch||""}),i.jsx("td",{className:"border p-2",children:si(he.packages)}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.amount)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.commission)]}),i.jsx("td",{className:"border p-2",children:he.date})]},he.id)),V.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin detalle."})})]})]})}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Consolidado por producto"}),i.jsx("div",{className:"md:hidden space-y-2",children:Z.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin consolidado."}):Z.map(he=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:he.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq cash"}),i.jsx("div",{className:"font-bold",children:si(he.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq crdito"}),i.jsx("div",{className:"font-bold",children:si(he.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Lr(he.commCredit)]})]})]})]},he.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[Z.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:he.productName}),i.jsx("td",{className:"border p-2",children:si(he.packsCash)}),i.jsx("td",{className:"border p-2",children:si(he.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Lr(he.commCredit)]})]},he.productName)),Z.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Sin consolidado."})})]})]})})]})]})]}),O&&i.jsx("p",{className:"mt-3 text-sm",children:O})]}),Xe&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:Xe.name}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Saldo pendiente: ",i.jsxs("b",{children:["C$",Lr(Xe.balance)]})]})]}),i.jsx("button",{type:"button",onClick:()=>it(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Saldo"})]})}),i.jsx("tbody",{children:we.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin movimientos."})}):we.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:he.date||""}),i.jsx("td",{className:"border p-1",children:he.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Lr(he.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Lr(he.running)]})]},he.id))})]})}),i.jsx("div",{className:"mt-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:Fe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"border p-2 text-center text-gray-500",children:"Sin ventas asociadas."})}):Fe.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:he.date||""}),i.jsx("td",{className:"border p-1",children:he.productName||""}),i.jsx("td",{className:"border p-1",children:he.vendorName||""}),i.jsx("td",{className:"border p-1",children:he.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Lr(he.amount)]})]},he.id))})]})})]})})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 md:p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function Lse(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=Lse(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function as(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=Lse(t))&&(n&&(n+=" "),n+=e);return n}var vVe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function QR(t){if(typeof t!="string")return!1;var e=vVe;return e.includes(t)}var yVe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],bVe=new Set(yVe);function Use(t){return typeof t!="string"?!1:bVe.has(t)}function Qse(t){return typeof t=="string"&&t.startsWith("data-")}function ch(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Use(r)||Qse(r))&&(e[r]=t[r]);return e}function z2(t){if(t==null)return null;if(g.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return ch(e)}return typeof t=="object"&&!Array.isArray(t)?ch(t):null}function Dd(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Use(r)||Qse(r)||QR(r))&&(e[r]=t[r]);return e}var wVe=["children","width","height","viewBox","className","style","title","desc"];function bF(){return bF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bF.apply(null,arguments)}function NVe(t,e){if(t==null)return{};var r,n,a=CVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function CVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var VR=g.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:u}=t,d=NVe(t,wVe),f=s||{width:n,height:a,x:0,y:0},A=as("recharts-surface",o);return g.createElement("svg",bF({},Dd(d),{className:A,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),g.createElement("title",null,c),g.createElement("desc",null,u),r)}),_Ve=["children","className"];function wF(){return wF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wF.apply(null,arguments)}function EVe(t,e){if(t==null)return{};var r,n,a=SVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function SVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Bc=g.forwardRef((t,e)=>{var{children:r,className:n}=t,a=EVe(t,_Ve),s=as("recharts-layer",n);return g.createElement("g",wF({className:s},Dd(a),{ref:e}),r)}),Vse=g.createContext(null),IVe=()=>g.useContext(Vse);function vs(t){return function(){return t}}const Hse=Math.cos,iI=Math.sin,Pf=Math.sqrt,oI=Math.PI,yP=2*oI,NF=Math.PI,CF=2*NF,dp=1e-6,jVe=CF-dp;function $se(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function PVe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return $se;const r=10**e;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class BVe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?$se:PVe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,s,o){this._append`C${+e},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(e,r,n,a,s){if(e=+e,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-e,u=a-r,d=o-e,f=l-r,A=d*d+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(A>dp)if(!(Math.abs(f*c-u*d)>dp)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let h=n-o,m=a-l,p=c*c+u*u,x=h*h+m*m,v=Math.sqrt(p),y=Math.sqrt(A),b=s*Math.tan((NF-Math.acos((p+A-x)/(2*v*y)))/2),w=b/y,j=b/v;Math.abs(w-1)>dp&&this._append`L${e+w*d},${r+w*f}`,this._append`A${s},${s},0,0,${+(f*h>d*m)},${this._x1=e+j*c},${this._y1=r+j*u}`}}arc(e,r,n,a,s,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=e+l,d=r+c,f=1^o,A=o?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>dp||Math.abs(this._y1-d)>dp)&&this._append`L${u},${d}`,n&&(A<0&&(A=A%CF+CF),A>jVe?this._append`A${n},${n},0,1,${f},${e-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:A>dp&&this._append`A${n},${n},0,${+(A>=NF)},${f},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function HR(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new BVe(e)}function $R(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Gse(t){this._context=t}Gse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function bP(t){return new Gse(t)}function Kse(t){return t[0]}function qse(t){return t[1]}function zse(t,e){var r=vs(!0),n=null,a=bP,s=null,o=HR(l);t=typeof t=="function"?t:t===void 0?Kse:vs(t),e=typeof e=="function"?e:e===void 0?qse:vs(e);function l(c){var u,d=(c=$R(c)).length,f,A=!1,h;for(n==null&&(s=a(h=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===A&&((A=!A)?s.lineStart():s.lineEnd()),A&&s.point(+t(f,u,c),+e(f,u,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:vs(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:vs(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:vs(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function m_(t,e,r){var n=null,a=vs(!0),s=null,o=bP,l=null,c=HR(u);t=typeof t=="function"?t:t===void 0?Kse:vs(+t),e=typeof e=="function"?e:vs(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?qse:vs(+r);function u(f){var A,h,m,p=(f=$R(f)).length,x,v=!1,y,b=new Array(p),w=new Array(p);for(s==null&&(l=o(y=c())),A=0;A<=p;++A){if(!(A<p&&a(x=f[A],A,f))===v)if(v=!v)h=A,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=A-1;m>=h;--m)l.point(b[m],w[m]);l.lineEnd(),l.areaEnd()}v&&(b[A]=+t(x,A,f),w[A]=+e(x,A,f),l.point(n?+n(x,A,f):b[A],r?+r(x,A,f):w[A]))}if(y)return l=null,y+""||null}function d(){return zse().defined(a).curve(o).context(s)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:vs(+f),n=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:vs(+f),u):t},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:vs(+f),u):n},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:vs(+f),r=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:vs(+f),u):e},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:vs(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(t).y(e)},u.lineY1=function(){return d().x(t).y(r)},u.lineX1=function(){return d().x(n).y(e)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:vs(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class Wse{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function TVe(t){return new Wse(t,!0)}function kVe(t){return new Wse(t,!1)}const GR={draw(t,e){const r=Pf(e/oI);t.moveTo(r,0),t.arc(0,0,r,0,yP)}},FVe={draw(t,e){const r=Pf(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},Xse=Pf(1/3),OVe=Xse*2,DVe={draw(t,e){const r=Pf(e/OVe),n=r*Xse;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},RVe={draw(t,e){const r=Pf(e),n=-r/2;t.rect(n,n,r,r)}},MVe=.8908130915292852,Yse=iI(oI/10)/iI(7*oI/10),LVe=iI(yP/10)*Yse,UVe=-Hse(yP/10)*Yse,QVe={draw(t,e){const r=Pf(e*MVe),n=LVe*r,a=UVe*r;t.moveTo(0,-r),t.lineTo(n,a);for(let s=1;s<5;++s){const o=yP*s/5,l=Hse(o),c=iI(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*a,c*n+l*a)}t.closePath()}},cB=Pf(3),VVe={draw(t,e){const r=-Pf(e/(cB*3));t.moveTo(0,r*2),t.lineTo(-cB*r,-r),t.lineTo(cB*r,-r),t.closePath()}},id=-.5,od=Pf(3)/2,_F=1/Pf(12),HVe=(_F/2+1)*3,$Ve={draw(t,e){const r=Pf(e/HVe),n=r/2,a=r*_F,s=n,o=r*_F+r,l=-s,c=o;t.moveTo(n,a),t.lineTo(s,o),t.lineTo(l,c),t.lineTo(id*n-od*a,od*n+id*a),t.lineTo(id*s-od*o,od*s+id*o),t.lineTo(id*l-od*c,od*l+id*c),t.lineTo(id*n+od*a,id*a-od*n),t.lineTo(id*s+od*o,id*o-od*s),t.lineTo(id*l+od*c,id*c-od*l),t.closePath()}};function GVe(t,e){let r=null,n=HR(a);t=typeof t=="function"?t:vs(t||GR),e=typeof e=="function"?e:vs(e===void 0?64:+e);function a(){let s;if(r||(r=s=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:vs(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:vs(+s),a):e},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function lI(){}function cI(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function Jse(t){this._context=t}Jse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:cI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:cI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function KVe(t){return new Jse(t)}function Zse(t){this._context=t}Zse.prototype={areaStart:lI,areaEnd:lI,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:cI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function qVe(t){return new Zse(t)}function eie(t){this._context=t}eie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:cI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function zVe(t){return new eie(t)}function tie(t){this._context=t}tie.prototype={areaStart:lI,areaEnd:lI,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function WVe(t){return new tie(t)}function _G(t){return t<0?-1:1}function EG(t,e,r){var n=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(n||a<0&&-0),o=(r-t._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(_G(s)+_G(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function SG(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function uB(t,e,r){var n=t._x0,a=t._y0,s=t._x1,o=t._y1,l=(s-n)/3;t._context.bezierCurveTo(n+l,a+l*e,s-l,o-l*r,s,o)}function uI(t){this._context=t}uI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:uB(this,this._t0,SG(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,uB(this,SG(this,r=EG(this,t,e)),r);break;default:uB(this,this._t0,r=EG(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function rie(t){this._context=new nie(t)}(rie.prototype=Object.create(uI.prototype)).point=function(t,e){uI.prototype.point.call(this,e,t)};function nie(t){this._context=t}nie.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,s){this._context.bezierCurveTo(e,t,n,r,s,a)}};function XVe(t){return new uI(t)}function YVe(t){return new rie(t)}function aie(t){this._context=t}aie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=IG(t),a=IG(e),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function IG(t){var e,r=t.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function JVe(t){return new aie(t)}function wP(t,e){this._context=t,this._t=e}wP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function ZVe(t){return new wP(t,.5)}function eHe(t){return new wP(t,0)}function tHe(t){return new wP(t,1)}function xg(t,e){if((o=t.length)>1)for(var r=1,n,a,s=t[e[0]],o,l=s.length;r<o;++r)for(a=s,s=t[e[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function EF(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function rHe(t,e){return t[e]}function nHe(t){const e=[];return e.key=t,e}function aHe(){var t=vs([]),e=EF,r=xg,n=rHe;function a(s){var o=Array.from(t.apply(this,arguments),nHe),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=$R(e(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:vs(Array.from(s)),a):t},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:vs(+s),a):n},a.order=function(s){return arguments.length?(e=s==null?EF:typeof s=="function"?s:vs(Array.from(s)),a):e},a.offset=function(s){return arguments.length?(r=s??xg,a):r},a}function sHe(t,e){if((n=t.length)>0){for(var r,n,a=0,s=t[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<n;++r)t[r][a][1]/=o}xg(t,e)}}function iHe(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}xg(t,e)}}function oHe(t,e){if(!(!((o=t.length)>0)||!((s=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=t[e[l]],f=d[n][1]||0,A=d[n-1][1]||0,h=(f-A)/2,m=0;m<l;++m){var p=t[e[m]],x=p[n][1]||0,v=p[n-1][1]||0;h+=x-v}c+=f,u+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,xg(t,e)}}var NP={},sie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(sie);var KR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(KR);var CP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}t.toKey=e})(CP);var _P={},iie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(iie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iie,r=CP;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=e.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];u?f==="\\"&&l+1<o?(l++,c+=a[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}t.toPath=n})(_P);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sie,r=KR,n=CP,a=_P;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||e.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}t.get=s})(NP);var lHe=NP.get;const vg=jA(lHe);var cHe=4;function Y0(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cHe,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function Ni(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((a,s,o)=>{var l=r[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+Y0(l)+s:a+s},"")}var Pl=t=>t===0?0:t>0?1:-1,uh=t=>typeof t=="number"&&t!=+t,wA=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Cn=t=>(typeof t=="number"||t instanceof Number)&&!uh(t),dh=t=>Cn(t)||typeof t=="string",uHe=0,W2=t=>{var e=++uHe;return"".concat(t||"").concat(e)},ic=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Cn(e)&&typeof e!="string")return n;var s;if(wA(e)){if(r==null)return n;var o=e.indexOf("%");s=r*parseFloat(e.slice(0,o))/100}else s=+e;return uh(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},oie=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function Eo(t,e,r){return Cn(t)&&Cn(e)?Y0(t+r*(e-t)):e}function dHe(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):vg(n,e))===r)}var sl=t=>t===null||typeof t>"u",qw=t=>sl(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function fHe(t){return t!=null}function zw(){}var hHe=["type","size","sizeType"];function SF(){return SF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},SF.apply(null,arguments)}function jG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function PG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jG(Object(r),!0).forEach(function(n){AHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AHe(t,e,r){return(e=mHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mHe(t){var e=pHe(t,"string");return typeof e=="symbol"?e:e+""}function pHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gHe(t,e){if(t==null)return{};var r,n,a=xHe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function xHe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var lie={symbolCircle:GR,symbolCross:FVe,symbolDiamond:DVe,symbolSquare:RVe,symbolStar:QVe,symbolTriangle:VVe,symbolWye:$Ve},vHe=Math.PI/180,yHe=t=>{var e="symbol".concat(qw(t));return lie[e]||GR},bHe=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*vHe;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},wHe=(t,e)=>{lie["symbol".concat(qw(t))]=e},qR=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=gHe(t,hHe),s=PG(PG({},a),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var A=yHe(o),h=GVe().type(A).size(bHe(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=Dd(s);return Cn(u)&&Cn(d)&&Cn(r)?g.createElement("path",SF({},f,{className:as("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};qR.registerSymbol=wHe;var cie=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,NHe=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(g.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{QR(a)&&(n[a]=s=>r[a](r,s))}),n},CHe=(t,e,r)=>n=>(t(e,r,n),null),Ww=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var s=t[a];QR(a)&&typeof s=="function"&&(n||(n={}),n[a]=CHe(s,e,r))}),n};function BG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _He(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BG(Object(r),!0).forEach(function(n){EHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EHe(t,e,r){return(e=SHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SHe(t){var e=IHe(t,"string");return typeof e=="symbol"?e:e+""}function IHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kl(t,e){var r=_He({},t),n=e,a=Object.keys(e),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function dI(){return dI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dI.apply(null,arguments)}function TG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function jHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?TG(Object(r),!0).forEach(function(n){PHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PHe(t,e,r){return(e=BHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BHe(t){var e=THe(t,"string");return typeof e=="symbol"?e:e+""}function THe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ad=32,kHe={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function FHe(t){var{data:e,iconType:r,inactiveColor:n}=t,a=Ad/2,s=Ad/6,o=Ad/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return g.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:Ad,y2:a,className:"recharts-legend-icon"})}if(c==="line")return g.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Ad,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return g.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Ad/8,"h").concat(Ad,"v").concat(Ad*3/4,"h").concat(-Ad,"z"),className:"recharts-legend-icon"});if(g.isValidElement(e.legendIcon)){var d=jHe({},e);return delete d.legendIcon,g.cloneElement(e.legendIcon,d)}return g.createElement(qR,{fill:l,cx:a,cy:a,size:Ad,sizeType:"diameter",type:c})}function OHe(t){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=t,l={x:0,y:0,width:Ad,height:Ad},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((d,f)=>{var A=d.formatter||a,h=as({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,p=A?A(d.value,d,f):d.value;return g.createElement("li",dI({className:h,style:c,key:"legend-item-".concat(f)},Ww(t,d,f)),g.createElement(VR,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(p," legend icon")},g.createElement(FHe,{data:d,iconType:o,inactiveColor:s})),g.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},p))})}var DHe=t=>{var e=kl(t,kHe),{payload:r,layout:n,align:a}=e;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return g.createElement("ul",{className:"recharts-default-legend",style:s},g.createElement(OHe,dI({},e,{payload:r})))},uie={},die={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}t.uniqBy=e})(die);var zR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(zR);var fie={},EP={},hie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(hie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hie;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(EP);var Aie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(Aie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=EP,r=Aie;function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(fie);var mie={},pie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=NP;function r(n){return function(a){return e.get(a,n)}}t.property=r})(pie);var gie={},WR={},xie={},XR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(XR);var YR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(YR);var JR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(JR);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=XR,r=YR,n=JR;function a(d,f,A){return typeof A!="function"?a(d,f,()=>{}):s(d,f,function h(m,p,x,v,y,b){const w=A(m,p,x,v,y,b);return w!==void 0?!!w:s(m,p,h,b)},new Map)}function s(d,f,A,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,A,h);case"function":return Object.keys(f).length>0?s(d,{...f},A,h):n.eq(d,f);default:return e.isObject(d)?typeof f=="string"?f==="":!0:n.eq(d,f)}}function o(d,f,A,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,A,h);if(f instanceof Map)return l(d,f,A,h);if(f instanceof Set)return u(d,f,A,h);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let p=0;p<m.length;p++){const x=m[p];if(!r.isPrimitive(d)&&!(x in d)||f[x]===void 0&&d[x]!==void 0||f[x]===null&&d[x]!==null||!A(d[x],f[x],x,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(d,f,A,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,p]of f.entries()){const x=d.get(m);if(A(x,p,m,d,f,h)===!1)return!1}return!0}function c(d,f,A,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let p=0;p<f.length;p++){const x=f[p];let v=!1;for(let y=0;y<d.length;y++){if(m.has(y))continue;const b=d[y];let w=!1;if(A(b,x,p,d,f,h)&&(w=!0),w){m.add(y),v=!0;break}}if(!v)return!1}return!0}function u(d,f,A,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],A,h):!1}t.isMatchWith=a,t.isSetMatch=u})(xie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xie;function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(WR);var vie={},ZR={},yie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(yie);var eM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(eM);var tM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",A="[object ArrayBuffer]",h="[object Object]",m="[object Error]",p="[object DataView]",x="[object Uint8Array]",v="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",j="[object Int8Array]",I="[object Int16Array]",_="[object Int32Array]",S="[object BigInt64Array]",E="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=s,t.arrayBufferTag=A,t.arrayTag=d,t.bigInt64ArrayTag=S,t.bigUint64ArrayTag=w,t.booleanTag=a,t.dataViewTag=p,t.dateTag=l,t.errorTag=m,t.float32ArrayTag=E,t.float64ArrayTag=B,t.functionTag=f,t.int16ArrayTag=I,t.int32ArrayTag=_,t.int8ArrayTag=j,t.mapTag=c,t.numberTag=n,t.objectTag=h,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=y,t.uint32ArrayTag=b,t.uint8ArrayTag=x,t.uint8ClampedArrayTag=v})(tM);var bie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(bie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yie,r=eM,n=tM,a=YR,s=bie;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,A,h=new Map,m=void 0){const p=m==null?void 0:m(d,f,A,h);if(p!==void 0)return p;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const x=new Array(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return Object.hasOwn(d,"index")&&(x.index=d.index),Object.hasOwn(d,"input")&&(x.input=d.input),x}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const x=new RegExp(d.source,d.flags);return x.lastIndex=d.lastIndex,x}if(d instanceof Map){const x=new Map;h.set(d,x);for(const[v,y]of d)x.set(v,l(y,v,A,h,m));return x}if(d instanceof Set){const x=new Set;h.set(d,x);for(const v of d)x.add(l(v,void 0,A,h,m));return x}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const x=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return x}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const x=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,x),c(x,d,A,h,m),x}if(typeof File<"u"&&d instanceof File){const x=new File([d],d.name,{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(typeof Blob<"u"&&d instanceof Blob){const x=new Blob([d],{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Error){const x=new d.constructor;return h.set(d,x),x.message=d.message,x.name=d.name,x.stack=d.stack,x.cause=d.cause,c(x,d,A,h,m),x}if(d instanceof Boolean){const x=new Boolean(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Number){const x=new Number(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof String){const x=new String(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(typeof d=="object"&&u(d)){const x=Object.create(Object.getPrototypeOf(d));return h.set(d,x),c(x,d,A,h,m),x}return d}function c(d,f,A=d,h,m){const p=[...Object.keys(f),...e.getSymbols(f)];for(let x=0;x<p.length;x++){const v=p[x],y=Object.getOwnPropertyDescriptor(d,v);(y==null||y.writable)&&(d[v]=l(f[v],v,A,h,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(ZR);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ZR;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(vie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=WR,r=vie;function n(a){return a=r.cloneDeep(a),s=>e.isMatch(s,a)}t.matches=n})(gie);var wie={},Nie={},Cie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ZR,r=tM;function n(a,s){return e.cloneDeepWith(a,(o,l,c,u)=>{const d=s==null?void 0:s(o,l,c,u);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return e.copyProperties(f,a),f}case r.argumentsTag:{const f={};return e.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}t.cloneDeepWith=n})(Cie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cie;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(Nie);var _ie={},rM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(rM);var Eie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eM;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(Eie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=KR,r=rM,n=Eie,a=_P;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=s})(_ie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=WR,r=CP,n=Nie,a=NP,s=_ie;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:e.isMatch(d,c)}}t.matchesProperty=o})(wie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zR,r=pie,n=gie,a=wie;function s(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=s})(mie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=die,r=zR,n=fie,a=mie;function s(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),a.iteratee(l)):[]}t.uniqBy=s})(uie);var RHe=uie.uniqBy;const kG=jA(RHe);function Sie(t,e,r){return e===!0?kG(t,r):typeof e=="function"?kG(t,e):t}var Iie={exports:{}},jie={},Pie={exports:{}},Bie={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v=g;function MHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var LHe=typeof Object.is=="function"?Object.is:MHe,UHe=$v.useState,QHe=$v.useEffect,VHe=$v.useLayoutEffect,HHe=$v.useDebugValue;function $He(t,e){var r=e(),n=UHe({inst:{value:r,getSnapshot:e}}),a=n[0].inst,s=n[1];return VHe(function(){a.value=r,a.getSnapshot=e,dB(a)&&s({inst:a})},[t,r,e]),QHe(function(){return dB(a)&&s({inst:a}),t(function(){dB(a)&&s({inst:a})})},[t]),HHe(r),r}function dB(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!LHe(t,r)}catch{return!0}}function GHe(t,e){return e()}var KHe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?GHe:$He;Bie.useSyncExternalStore=$v.useSyncExternalStore!==void 0?$v.useSyncExternalStore:KHe;Pie.exports=Bie;var qHe=Pie.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SP=g,zHe=qHe;function WHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var XHe=typeof Object.is=="function"?Object.is:WHe,YHe=zHe.useSyncExternalStore,JHe=SP.useRef,ZHe=SP.useEffect,e$e=SP.useMemo,t$e=SP.useDebugValue;jie.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=JHe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=e$e(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,XHe(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=YHe(t,s[0],s[1]);return ZHe(function(){o.hasValue=!0,o.value=l},[l]),t$e(l),l};Iie.exports=jie;var r$e=Iie.exports,nM=g.createContext(null),n$e=t=>t,Cs=()=>{var t=g.useContext(nM);return t?t.store.dispatch:n$e},bE=()=>{},a$e=()=>bE,s$e=(t,e)=>t===e;function pn(t){var e=g.useContext(nM);return r$e.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:a$e,e?e.store.getState:bE,e?e.store.getState:bE,e?t:bE,s$e)}function i$e(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function o$e(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function l$e(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var FG=t=>Array.isArray(t)?t:[t];function c$e(t){const e=Array.isArray(t[0])?t[0]:t;return l$e(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function u$e(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var d$e=class{constructor(t){this.value=t}deref(){return this.value}},f$e=typeof WeakRef<"u"?WeakRef:d$e,h$e=0,OG=1;function p_(){return{s:h$e,v:void 0,o:null,p:null}}function Tie(t,e={}){let r=p_();const{resultEqualityCheck:n}=e;let a,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let A=0,h=c;A<h;A++){const m=arguments[A];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(m);x===void 0?(l=p_(),p.set(m,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(m);x===void 0?(l=p_(),p.set(m,l)):l=x}}const u=l;let d;if(l.s===OG)d=l.v;else if(d=t.apply(null,arguments),s++,n){const A=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;A!=null&&n(A,d)&&(d=A,s!==0&&s--),a=typeof d=="object"&&d!==null||typeof d=="function"?new f$e(d):d}return u.s=OG,u.v=d,d}return o.clearCache=()=>{r=p_(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function A$e(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let s=0,o=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),i$e(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:A=[],argsMemoize:h=Tie,argsMemoizeOptions:m=[]}=d,p=FG(A),x=FG(m),v=c$e(a),y=f(function(){return s++,u.apply(null,arguments)},...p),b=h(function(){o++;const j=u$e(v,arguments);return l=y.apply(null,j),l},...x);return Object.assign(b,{resultFunc:u,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var er=A$e(Tie),m$e=Object.assign((t,e=er)=>{o$e(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>m$e}),kie={},Fie={},Oie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=e(n),l=e(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};t.compareValues=r})(Oie);var Die={},aM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(aM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=aM,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||e.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}t.isKey=a})(Die);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Oie,r=Die,n=_P;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,m)=>{let p=h;for(let x=0;x<m.length&&p!=null;++x)p=p[m[x]];return p},d=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>d(m,h))})).slice().sort((h,m)=>{for(let p=0;p<f.length;p++){const x=e.compareValues(h.criteria[p],m.criteria[p],l[p]);if(x!==0)return x}return 0}).map(h=>h.original)}t.orderBy=a})(Fie);var Rie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):a.push(d)}};return o(r,0),a}t.flatten=e})(Rie);var sM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=rM,r=EP,n=XR,a=JR;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}t.isIterateeCall=s})(sM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Fie,r=Rie,n=sM;function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(s,r.flatten(o),["asc"])}t.sortBy=a})(kie);var p$e=kie.sortBy;const IP=jA(p$e);var Mie=t=>t.legend.settings,g$e=t=>t.legend.size,x$e=t=>t.legend.payload,v$e=er([x$e,Mie],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?IP(n,r):n});function y$e(){return pn(v$e)}var g_=1;function Lie(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=g.useState({height:0,left:0,top:0,width:0}),n=g.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-e.height)>g_||Math.abs(o.left-e.left)>g_||Math.abs(o.top-e.top)>g_||Math.abs(o.width-e.width)>g_)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function vl(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var b$e=typeof Symbol=="function"&&Symbol.observable||"@@observable",DG=b$e,fB=()=>Math.random().toString(36).substring(7).split("").join("."),w$e={INIT:`@@redux/INIT${fB()}`,REPLACE:`@@redux/REPLACE${fB()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${fB()}`},fI=w$e;function iM(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Uie(t,e,r){if(typeof t!="function")throw new Error(vl(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(vl(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(vl(1));return r(Uie)(t,e)}let n=t,a=e,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((x,v)=>{o.set(v,x)}))}function d(){if(c)throw new Error(vl(3));return a}function f(x){if(typeof x!="function")throw new Error(vl(4));if(c)throw new Error(vl(5));let v=!0;u();const y=l++;return o.set(y,x),function(){if(v){if(c)throw new Error(vl(6));v=!1,u(),o.delete(y),s=null}}}function A(x){if(!iM(x))throw new Error(vl(7));if(typeof x.type>"u")throw new Error(vl(8));if(typeof x.type!="string")throw new Error(vl(17));if(c)throw new Error(vl(9));try{c=!0,a=n(a,x)}finally{c=!1}return(s=o).forEach(y=>{y()}),x}function h(x){if(typeof x!="function")throw new Error(vl(10));n=x,A({type:fI.REPLACE})}function m(){const x=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(vl(11));function y(){const w=v;w.next&&w.next(d())}return y(),{unsubscribe:x(y)}},[DG](){return this}}}return A({type:fI.INIT}),{dispatch:A,subscribe:f,getState:d,replaceReducer:h,[DG]:m}}function N$e(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:fI.INIT})>"u")throw new Error(vl(12));if(typeof r(void 0,{type:fI.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(vl(13))})}function Qie(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let a;try{N$e(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],A=r[f],h=o[f],m=A(h,l);if(typeof m>"u")throw l&&l.type,new Error(vl(14));u[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?u:o}}function hI(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function C$e(...t){return e=>(r,n)=>{const a=e(r,n);let s=()=>{throw new Error(vl(15))};const o={getState:a.getState,dispatch:(c,...u)=>s(c,...u)},l=t.map(c=>c(o));return s=hI(...l)(a.dispatch),{...a,dispatch:s}}}function Vie(t){return iM(t)&&"type"in t&&typeof t.type=="string"}var Hie=Symbol.for("immer-nothing"),RG=Symbol.for("immer-draftable"),Tc=Symbol.for("immer-state");function cf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Du=Object,Gv=Du.getPrototypeOf,AI="constructor",jP="prototype",IF="configurable",mI="enumerable",wE="writable",X2="value",NA=t=>!!t&&!!t[Tc];function Cf(t){var e;return t?$ie(t)||BP(t)||!!t[RG]||!!((e=t[AI])!=null&&e[RG])||TP(t)||kP(t):!1}var _$e=Du[jP][AI].toString(),MG=new WeakMap;function $ie(t){if(!t||!oM(t))return!1;const e=Gv(t);if(e===null||e===Du[jP])return!0;const r=Du.hasOwnProperty.call(e,AI)&&e[AI];if(r===Object)return!0;if(!Fx(r))return!1;let n=MG.get(r);return n===void 0&&(n=Function.toString.call(r),MG.set(r,n)),n===_$e}function PP(t,e,r=!0){Xw(t)===0?(r?Reflect.ownKeys(t):Du.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function Xw(t){const e=t[Tc];return e?e.type_:BP(t)?1:TP(t)?2:kP(t)?3:0}var LG=(t,e,r=Xw(t))=>r===2?t.has(e):Du[jP].hasOwnProperty.call(t,e),jF=(t,e,r=Xw(t))=>r===2?t.get(e):t[e],pI=(t,e,r,n=Xw(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function E$e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var BP=Array.isArray,TP=t=>t instanceof Map,kP=t=>t instanceof Set,oM=t=>typeof t=="object",Fx=t=>typeof t=="function",hB=t=>typeof t=="boolean";function S$e(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Qh=t=>t.copy_||t.base_,lM=t=>t.modified_?t.copy_:t.base_;function PF(t,e){if(TP(t))return new Map(t);if(kP(t))return new Set(t);if(BP(t))return Array[jP].slice.call(t);const r=$ie(t);if(e===!0||e==="class_only"&&!r){const n=Du.getOwnPropertyDescriptors(t);delete n[Tc];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l[wE]===!1&&(l[wE]=!0,l[IF]=!0),(l.get||l.set)&&(n[o]={[IF]:!0,[wE]:!0,[mI]:l[mI],[X2]:t[o]})}return Du.create(Gv(t),n)}else{const n=Gv(t);if(n!==null&&r)return{...t};const a=Du.create(n);return Du.assign(a,t)}}function cM(t,e=!1){return FP(t)||NA(t)||!Cf(t)||(Xw(t)>1&&Du.defineProperties(t,{set:x_,add:x_,clear:x_,delete:x_}),Du.freeze(t),e&&PP(t,(r,n)=>{cM(n,!0)},!1)),t}function I$e(){cf(2)}var x_={[X2]:I$e};function FP(t){return t===null||!oM(t)?!0:Du.isFrozen(t)}var gI="MapSet",BF="Patches",UG="ArrayMethods",Gie={};function yg(t){const e=Gie[t];return e||cf(0,t),e}var QG=t=>!!Gie[t],Y2,Kie=()=>Y2,j$e=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:QG(gI)?yg(gI):void 0,arrayMethodsPlugin_:QG(UG)?yg(UG):void 0});function VG(t,e){e&&(t.patchPlugin_=yg(BF),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function TF(t){kF(t),t.drafts_.forEach(P$e),t.drafts_=null}function kF(t){t===Y2&&(Y2=t.parent_)}var HG=t=>Y2=j$e(Y2,t);function P$e(t){const e=t[Tc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function $G(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[Tc].modified_&&(TF(e),cf(4)),Cf(t)&&(t=GG(e,t));const{patchPlugin_:a}=e;a&&a.generateReplacementPatches_(r[Tc].base_,t,e)}else t=GG(e,r);return B$e(e,t,!0),TF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Hie?t:void 0}function GG(t,e){if(FP(e))return e;const r=e[Tc];if(!r)return xI(e,t.handledSet_,t);if(!OP(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);Wie(r,t)}return r.copy_}function B$e(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&cM(e,r)}function qie(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var OP=(t,e)=>t.scope_===e,T$e=[];function zie(t,e,r,n){const a=Qh(t),s=t.type_;if(n!==void 0&&jF(a,n,s)===e){pI(a,n,r,s);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;PP(a,(c,u)=>{if(NA(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=t.draftLocations_.get(e)??T$e;for(const l of o)pI(a,l,r,s)}function k$e(t,e,r){t.callbacks_.push(function(a){var l;const s=e;if(!s||!OP(s,a))return;(l=a.mapSetPlugin_)==null||l.fixSetContents(s);const o=lM(s);zie(t,s.draft_??s,o,r),Wie(s,a)})}function Wie(t,e){var n;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((n=t.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=e;if(a){const s=a.getPath(t);s&&a.generatePatches_(t,s,e)}qie(t)}}function F$e(t,e,r){const{scope_:n}=t;if(NA(r)){const a=r[Tc];OP(a,n)&&a.callbacks_.push(function(){NE(t);const o=lM(a);zie(t,r,o,e)})}else Cf(r)&&t.callbacks_.push(function(){const s=Qh(t);t.type_===3?s.has(r)&&xI(r,n.handledSet_,n):jF(s,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&xI(jF(t.copy_,e,t.type_),n.handledSet_,n)})}function xI(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||NA(t)||e.has(t)||!Cf(t)||FP(t)||(e.add(t),PP(t,(n,a)=>{if(NA(a)){const s=a[Tc];if(OP(s,r)){const o=lM(s);pI(t,n,o,t.type_),qie(s)}}else Cf(a)&&xI(a,e,r)})),t}function O$e(t,e){const r=BP(t),n={type_:r?1:0,scope_:e?e.scope_:Kie(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=vI;r&&(a=[n],s=J2);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,[l,n]}var vI={get(t,e){if(e===Tc)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r!=null&&r.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const a=Qh(t);if(!LG(a,e,t.type_))return D$e(t,a,e);const s=a[e];if(t.finalized_||!Cf(s)||n&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&S$e(e))return s;if(s===AB(t.base_,e)){NE(t);const o=t.type_===1?+e:e,l=OF(t.scope_,s,t,o);return t.copy_[o]=l}return s},has(t,e){return e in Qh(t)},ownKeys(t){return Reflect.ownKeys(Qh(t))},set(t,e,r){const n=Xie(Qh(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=AB(Qh(t),e),s=a==null?void 0:a[Tc];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(E$e(r,a)&&(r!==void 0||LG(t.base_,e,t.type_)))return!0;NE(t),FF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),F$e(t,e,r)),!0},deleteProperty(t,e){return NE(t),AB(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),FF(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Qh(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[wE]:!0,[IF]:t.type_!==1||e!=="length",[mI]:n[mI],[X2]:r[e]}},defineProperty(){cf(11)},getPrototypeOf(t){return Gv(t.base_)},setPrototypeOf(){cf(12)}},J2={};for(let t in vI){let e=vI[t];J2[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}}J2.deleteProperty=function(t,e){return J2.set.call(this,t,e,void 0)};J2.set=function(t,e,r){return vI.set.call(this,t[0],e,r,t[0])};function AB(t,e){const r=t[Tc];return(r?Qh(r):t)[e]}function D$e(t,e,r){var a;const n=Xie(e,r);return n?X2 in n?n[X2]:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Xie(t,e){if(!(e in t))return;let r=Gv(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Gv(r)}}function FF(t){t.modified_||(t.modified_=!0,t.parent_&&FF(t.parent_))}function NE(t){t.copy_||(t.assigned_=new Map,t.copy_=PF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var R$e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Fx(r)&&!Fx(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Fx(n)||cf(6),a!==void 0&&!Fx(a)&&cf(7);let s;if(Cf(r)){const o=HG(this),l=OF(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?TF(o):kF(o)}return VG(o,a),$G(s,o)}else if(!r||!oM(r)){if(s=n(r),s===void 0&&(s=r),s===Hie&&(s=void 0),this.autoFreeze_&&cM(s,!0),a){const o=[],l=[];yg(BF).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else cf(1,r)},this.produceWithPatches=(r,n)=>{if(Fx(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let a,s;return[this.produce(r,n,(l,c)=>{a=l,s=c}),a,s]},hB(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),hB(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),hB(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Cf(e)||cf(8),NA(e)&&(e=vf(e));const r=HG(this),n=OF(r,e,void 0);return n[Tc].isManual_=!0,kF(r),n}finishDraft(e,r){const n=e&&e[Tc];(!n||!n.isManual_)&&cf(9);const{scope_:a}=n;return VG(a,r),$G(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(r=r.slice(n+1));const a=yg(BF).applyPatches_;return NA(e)?a(e,r):this.produce(e,s=>a(s,r))}};function OF(t,e,r,n){const[a,s]=TP(e)?yg(gI).proxyMap_(e,r):kP(e)?yg(gI).proxySet_(e,r):O$e(e,r);return((r==null?void 0:r.scope_)??Kie()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?k$e(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),a}function vf(t){return NA(t)||cf(10,t),Yie(t)}function Yie(t){if(!Cf(t)||FP(t))return t;const e=t[Tc];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=PF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=PF(t,!0);return PP(r,(a,s)=>{pI(r,a,Yie(s))},n),e&&(e.finalized_=!1),r}var M$e=new R$e,Jie=M$e.produce;function Zie(t){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,t):a(s)}var L$e=Zie(),U$e=Zie,Q$e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?hI:hI.apply(null,arguments)};function Rd(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(Lu(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Vie(n)&&n.type===t,r}var eoe=class tb extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,tb.prototype)}static get[Symbol.species](){return tb}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new tb(...e[0].concat(this)):new tb(...e.concat(this))}};function KG(t){return Cf(t)?Jie(t,()=>{}):t}function v_(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function V$e(t){return typeof t=="boolean"}var H$e=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=e??{};let o=new eoe;return r&&(V$e(r)?o.push(L$e):o.push(U$e(r.extraArgument))),o},toe="RTK_autoBatch",Ls=()=>t=>({payload:t,meta:{[toe]:!0}}),qG=t=>e=>{setTimeout(e,t)},roe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,s=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:qG(10):t.type==="callback"?t.queueNotification:qG(t.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),A=n.subscribe(f);return l.add(d),()=>{A(),l.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[toe]),s=!a,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},$$e=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new eoe(t);return n&&a.push(roe(typeof n=="object"?n:void 0)),a};function G$e(t){const e=H$e(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(iM(r))l=Qie(r);else throw new Error(Lu(1));let c;typeof n=="function"?c=n(e):c=e();let u=hI;a&&(u=Q$e({trace:!1,...typeof a=="object"&&a}));const d=C$e(...c),f=$$e(d);let A=typeof o=="function"?o(f):f();const h=u(...A);return Uie(l,s,h)}function noe(t){const e={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Lu(28));if(l in e)throw new Error(Lu(29));return e[l]=o,a},addAsyncThunk(s,o){return o.pending&&(e[s.pending.type]=o.pending),o.rejected&&(e[s.rejected.type]=o.rejected),o.fulfilled&&(e[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return t(a),[e,r,n]}function K$e(t){return typeof t=="function"}function q$e(t,e){let[r,n,a]=noe(e),s;if(K$e(t))s=()=>KG(t());else{const l=KG(t);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(NA(d)){const h=f(d,c);return h===void 0?d:h}else{if(Cf(d))return Jie(d,A=>f(A,c));{const A=f(d,c);if(A===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return d},l)}return o.getInitialState=s,o}var z$e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",W$e=(t=21)=>{let e="",r=t;for(;r--;)e+=z$e[Math.random()*64|0];return e},X$e=Symbol.for("rtk-slice-createasyncthunk");function Y$e(t,e){return`${t}/${e}`}function J$e({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[X$e];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Lu(11));const l=(typeof a.reducers=="function"?a.reducers(eGe()):a.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,j){const I=typeof w=="string"?w:w.type;if(!I)throw new Error(Lu(12));if(I in u.sliceCaseReducersByType)throw new Error(Lu(13));return u.sliceCaseReducersByType[I]=j,d},addMatcher(w,j){return u.sliceMatchers.push({matcher:w,reducer:j}),d},exposeAction(w,j){return u.actionCreators[w]=j,d},exposeCaseReducer(w,j){return u.sliceCaseReducersByName[w]=j,d}};c.forEach(w=>{const j=l[w],I={reducerName:w,type:Y$e(s,w),createNotation:typeof a.reducers=="function"};rGe(j)?aGe(I,j,d,e):tGe(I,j,d)});function f(){const[w={},j=[],I=void 0]=typeof a.extraReducers=="function"?noe(a.extraReducers):[a.extraReducers],_={...w,...u.sliceCaseReducersByType};return q$e(a.initialState,S=>{for(let E in _)S.addCase(E,_[E]);for(let E of u.sliceMatchers)S.addMatcher(E.matcher,E.reducer);for(let E of j)S.addMatcher(E.matcher,E.reducer);I&&S.addDefaultCase(I)})}const A=w=>w,h=new Map,m=new WeakMap;let p;function x(w,j){return p||(p=f()),p(w,j)}function v(){return p||(p=f()),p.getInitialState()}function y(w,j=!1){function I(S){let E=S[w];return typeof E>"u"&&j&&(E=v_(m,I,v)),E}function _(S=A){const E=v_(h,j,()=>new WeakMap);return v_(E,S,()=>{const B={};for(const[T,P]of Object.entries(a.selectors??{}))B[T]=Z$e(P,S,()=>v_(m,S,v),j);return B})}return{reducerPath:w,getSelectors:_,get selectors(){return _(I)},selectSlice:I}}const b={name:s,reducer:x,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...y(o),injectInto(w,{reducerPath:j,...I}={}){const _=j??o;return w.inject({reducerPath:_,reducer:x},I),{...b,...y(_,!0)}}};return b}}function Z$e(t,e,r,n){function a(s,...o){let l=e(s);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return a.unwrapped=t,a}var uu=J$e();function eGe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function tGe({type:t,reducerName:e,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!nGe(n))throw new Error(Lu(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?Rd(t,o):Rd(t))}function rGe(t){return t._reducerDefinitionType==="asyncThunk"}function nGe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function aGe({type:t,reducerName:e},r,n,a){if(!a)throw new Error(Lu(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=a(t,s,d);n.exposeAction(e,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(e,{fulfilled:o||y_,pending:l||y_,rejected:c||y_,settled:u||y_})}function y_(){}var sGe="task",aoe="listener",soe="completed",uM="cancelled",iGe=`task-${uM}`,oGe=`task-${soe}`,DF=`${aoe}-${uM}`,lGe=`${aoe}-${soe}`,DP=class{constructor(t){Br(this,"name","TaskAbortError");Br(this,"message");this.code=t,this.message=`${sGe} ${uM} (reason: ${t})`}},dM=(t,e)=>{if(typeof t!="function")throw new TypeError(Lu(32))},yI=()=>{},ioe=(t,e=yI)=>(t.catch(e),t),ooe=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Gp=t=>{if(t.aborted)throw new DP(t.reason)};function loe(t,e){let r=yI;return new Promise((n,a)=>{const s=()=>a(new DP(t.reason));if(t.aborted){s();return}r=ooe(t,s),e.finally(()=>r()).then(n,a)}).finally(()=>{r=yI})}var cGe=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof DP?"cancelled":"rejected",error:r}}finally{e==null||e()}},bI=t=>e=>ioe(loe(t,e).then(r=>(Gp(t),r))),coe=t=>{const e=bI(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:vv}=Object,zG={},RP="listenerMiddleware",uGe=(t,e)=>{const r=n=>ooe(t,()=>n.abort(t.reason));return(n,a)=>{dM(n);const s=new AbortController;r(s);const o=cGe(async()=>{Gp(t),Gp(s.signal);const l=await n({pause:bI(s.signal),delay:coe(s.signal),signal:s.signal});return Gp(s.signal),l},()=>s.abort(oGe));return a!=null&&a.autoJoin&&e.push(o.catch(yI)),{result:bI(t)(o),cancel(){s.abort(iGe)}}}},dGe=(t,e)=>{const r=async(n,a)=>{Gp(e);let s=()=>{};const l=[new Promise((c,u)=>{let d=t({predicate:n,effect:(f,A)=>{A.unsubscribe(),c([f,A.getState(),A.getOriginalState()])}});s=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await loe(e,Promise.race(l));return Gp(e),c}finally{s()}};return(n,a)=>ioe(r(n,a))},uoe=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:s}=t;if(e)a=Rd(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Lu(21));return dM(s),{predicate:a,type:e,effect:s}},doe=vv(t=>{const{type:e,predicate:r,effect:n}=uoe(t);return{id:W$e(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Lu(22))}}},{withTypes:()=>doe}),WG=(t,e)=>{const{type:r,effect:n,predicate:a}=uoe(e);return Array.from(t.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},RF=t=>{t.pending.forEach(e=>{e.abort(DF)})},fGe=(t,e)=>()=>{for(const r of e.keys())RF(r);t.clear()},XG=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},foe=vv(Rd(`${RP}/add`),{withTypes:()=>foe}),hGe=Rd(`${RP}/removeAll`),hoe=vv(Rd(`${RP}/remove`),{withTypes:()=>hoe}),AGe=(...t)=>{console.error(`${RP}/error`,...t)},Yw=(t={})=>{const e=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=AGe}=t;dM(o);const l=h=>(h.unsubscribe=()=>e.delete(h.id),e.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&RF(h)}),c=h=>{const m=WG(e,h)??doe(h);return l(m)};vv(c,{withTypes:()=>c});const u=h=>{const m=WG(e,h);return m&&(m.unsubscribe(),h.cancelActive&&RF(m)),!!m};vv(u,{withTypes:()=>u});const d=async(h,m,p,x)=>{const v=new AbortController,y=dGe(c,v.signal),b=[];try{h.pending.add(v),n(h),await Promise.resolve(h.effect(m,vv({},p,{getOriginalState:x,condition:(w,j)=>y(w,j).then(Boolean),take:y,delay:coe(v.signal),pause:bI(v.signal),extra:s,signal:v.signal,fork:uGe(v.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{e.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((w,j,I)=>{w!==v&&(w.abort(DF),I.delete(w))})},cancel:()=>{v.abort(DF),h.pending.delete(v)},throwIfCancelled:()=>{Gp(v.signal)}})))}catch(w){w instanceof DP||XG(o,w,{raisedBy:"effect"})}finally{await Promise.all(b),v.abort(lGe),a(h),h.pending.delete(v)}},f=fGe(e,r);return{middleware:h=>m=>p=>{if(!Vie(p))return m(p);if(foe.match(p))return c(p.payload);if(hGe.match(p)){f();return}if(hoe.match(p))return u(p.payload);let x=h.getState();const v=()=>{if(x===zG)throw new Error(Lu(23));return x};let y;try{if(y=m(p),e.size>0){const b=h.getState(),w=Array.from(e.values());for(const j of w){let I=!1;try{I=j.predicate(p,b,x)}catch(_){I=!1,XG(o,_,{raisedBy:"predicate"})}I&&d(j,p,h,v)}}}finally{x=zG}return y},startListening:c,stopListening:u,clearListeners:f}};function Lu(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var mGe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Aoe=uu({name:"chartLayout",initialState:mGe,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,s;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(s=e.payload.left)!==null&&s!==void 0?s:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:pGe,setLayout:gGe,setChartSize:xGe,setScale:vGe}=Aoe.actions,yGe=Aoe.reducer;function moe(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Ai(t){return Number.isFinite(t)}function Bm(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function YG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ev(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YG(Object(r),!0).forEach(function(n){bGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bGe(t,e,r){return(e=wGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wGe(t){var e=NGe(t,"string");return typeof e=="symbol"?e:e+""}function NGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ks(t,e,r){return sl(t)||sl(e)?r:dh(e)?vg(t,e,r):typeof e=="function"?e(t):r}var CGe=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&Cn(t[s]))return ev(ev({},t),{},{[s]:t[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&Cn(t[o]))return ev(ev({},t),{},{[o]:t[o]+(a||0)})}return t},Hg=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",JG=1e-4,_Ge=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-JG,s=Math.max(n[0],n[1])+JG,o=t(e[0]),l=t(e[r-1]);(o<a||o>s||l<a||l>s)&&t.domain([e[0],e[r-1]])}},EGe=(t,e)=>{if(!e||e.length!==2||!Cn(e[0])||!Cn(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!Cn(t[0])||t[0]<r)&&(a[0]=r),(!Cn(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},SGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0,l=0;l<r;++l){var c=t[l],u=c==null?void 0:c[a];if(u!=null){var d=u[1],f=u[0],A=uh(d)?f:d;A>=0?(u[0]=s,u[1]=s+A,s=d):(u[0]=o,u[1]=o+A,o=d)}}}},IGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0;o<r;++o){var l=t[o],c=l==null?void 0:l[a];if(c!=null){var u=uh(c[1])?c[0]:c[1];u>=0?(c[0]=s,c[1]=s+u,s=c[1]):(c[0]=0,c[1]=0)}}}},jGe={sign:SGe,expand:sHe,none:xg,silhouette:iHe,wiggle:oHe,positive:IGe},PGe=(t,e,r)=>{var n,a=(n=jGe[r])!==null&&n!==void 0?n:xg,s=aHe().keys(e).value((l,c)=>Number(ks(l,c,0))).order(EF).offset(a),o=s(t);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=ks(t[d],e[c],0);Array.isArray(f)&&f.length===2&&Cn(f[0])&&Cn(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function BGe(t){return t==null?void 0:String(t)}var ZG=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:s,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=ks(s,e.dataKey,e.scale.domain()[o]);return sl(l)?null:e.scale(l)-a/2+n},TGe=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},kGe=t=>{var e=t.flat(2).filter(Cn);return[Math.min(...e),Math.max(...e)]},FGe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],OGe=(t,e,r)=>{if(t!=null)return FGe(Object.keys(t).reduce((n,a)=>{var s=t[a];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=moe(u,e,r),f=kGe(d);return!Ai(f[0])||!Ai(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},eK=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,tK=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,wI=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=IP(e,d=>d.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],u=a[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function rK(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:s}=t;return ev(ev({},e),{},{dataKey:r,payload:n,value:a,name:s})}function MP(t,e){if(t)return String(t);if(typeof e=="string")return e}var DGe=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},RGe=(t,e)=>e==="centric"?t.angle:t.radius,LA=t=>t.layout.width,UA=t=>t.layout.height,MGe=t=>t.layout.scale,poe=t=>t.layout.margin,LP=er(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),UP=er(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),goe="data-recharts-item-index",xoe="data-recharts-item-id",Jw=60;function nK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function b_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nK(Object(r),!0).forEach(function(n){LGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LGe(t,e,r){return(e=UGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UGe(t){var e=QGe(t,"string");return typeof e=="symbol"?e:e+""}function QGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VGe=t=>t.brush.height;function HGe(t){var e=UP(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Jw;return r+a}return r},0)}function $Ge(t){var e=UP(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Jw;return r+a}return r},0)}function GGe(t){var e=LP(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function KGe(t){var e=LP(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ro=er([LA,UA,poe,VGe,HGe,$Ge,GGe,KGe,Mie,g$e],(t,e,r,n,a,s,o,l,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},A=b_(b_({},f),d),h=A.bottom;A.bottom+=n,A=CGe(A,c,u);var m=t-A.left-A.right,p=e-A.top-A.bottom;return b_(b_({brushBottom:h},A),{},{width:Math.max(m,0),height:Math.max(p,0)})}),qGe=er(Ro,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),fM=er(LA,UA,(t,e)=>({x:0,y:0,width:t,height:e})),zGe=g.createContext(null),qu=()=>g.useContext(zGe)!=null,QP=t=>t.brush,VP=er([QP,Ro,poe],(t,e,r)=>({height:t.height,x:Cn(t.x)?t.x:e.left,y:Cn(t.y)?t.y:e.top+e.height+e.brushBottom-((r==null?void 0:r.bottom)||0),width:Cn(t.width)?t.width:e.width})),voe={},yoe={},boe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),p()};let A=null;const h=()=>{A!=null&&clearTimeout(A),A=setTimeout(()=>{A=null,f()},n)},m=()=>{A!==null&&(clearTimeout(A),A=null)},p=()=>{m(),o=void 0,l=null},x=()=>{d()},v=function(...y){if(a!=null&&a.aborted)return;o=this,l=y;const b=A==null;h(),c&&b&&d()};return v.schedule=h,v.cancel=p,v.flush=x,a==null||a.addEventListener("abort",p,{once:!0}),v}t.debounce=e})(boe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=boe;function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const A=e.debounce(function(...p){d=n.apply(this,p),f=null},a,{edges:u}),h=function(...p){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,p),f=Date.now(),A.cancel(),A.schedule(),d):(A.apply(this,p),d)},m=()=>(A.flush(),d);return h.cancel=A.cancel,h.flush=m,h}t.debounce=r})(yoe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=yoe;function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return e.debounce(n,a,{leading:o,maxWait:a,trailing:l})}t.throttle=r})(voe);var WGe=voe.throttle;const XGe=jA(WGe);var aK=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},woe=(t,e,r)=>{var{width:n="100%",height:a="100%",aspect:s,maxHeight:o}=r,l=wA(n)?t:Number(n),c=wA(a)?e:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},YGe={width:0,height:0,overflow:"visible"},JGe={width:0,overflowX:"visible"},ZGe={height:0,overflowY:"visible"},eKe={},tKe=t=>{var{width:e,height:r}=t,n=wA(e),a=wA(r);return n&&a?YGe:n?JGe:a?ZGe:eKe};function rKe(t){var{width:e,height:r,aspect:n}=t,a=e,s=r;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=n&&n>0?void 0:"100%":s===void 0&&(s=n&&n>0?void 0:"100%"),{width:a,height:s}}function MF(){return MF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},MF.apply(null,arguments)}function sK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function iK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sK(Object(r),!0).forEach(function(n){nKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nKe(t,e,r){return(e=aKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aKe(t){var e=sKe(t,"string");return typeof e=="symbol"?e:e+""}function sKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Noe=g.createContext({width:-1,height:-1});function iKe(t){return Bm(t.width)&&Bm(t.height)}function Coe(t){var{children:e,width:r,height:n}=t,a=g.useMemo(()=>({width:r,height:n}),[r,n]);return iKe(a)?g.createElement(Noe.Provider,{value:a},e):null}var hM=()=>g.useContext(Noe),oKe=g.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:f,className:A,onResize:h,style:m={}}=t,p=g.useRef(null),x=g.useRef();x.current=h,g.useImperativeHandle(e,()=>p.current);var[v,y]=g.useState({containerWidth:n.width,containerHeight:n.height}),b=g.useCallback((S,E)=>{y(B=>{var T=Math.round(S),P=Math.round(E);return B.containerWidth===T&&B.containerHeight===P?B:{containerWidth:T,containerHeight:P}})},[]);g.useEffect(()=>{if(p.current==null||typeof ResizeObserver>"u")return zw;var S=P=>{var O,{width:z,height:ce}=P[0].contentRect;b(z,ce),(O=x.current)===null||O===void 0||O.call(x,z,ce)};d>0&&(S=XGe(S,d,{trailing:!0,leading:!1}));var E=new ResizeObserver(S),{width:B,height:T}=p.current.getBoundingClientRect();return b(B,T),E.observe(p.current),()=>{E.disconnect()}},[b,d]);var{containerWidth:w,containerHeight:j}=v;aK(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:I,calculatedHeight:_}=woe(w,j,{width:a,height:s,aspect:r,maxHeight:c});return aK(I!=null&&I>0||_!=null&&_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,_,a,s,o,l,r),g.createElement("div",{id:f?"".concat(f):void 0,className:as("recharts-responsive-container",A),style:iK(iK({},m),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:p},g.createElement("div",{style:tKe({width:a,height:s})},g.createElement(Coe,{width:I,height:_},u)))}),oK=g.forwardRef((t,e)=>{var r=hM();if(Bm(r.width)&&Bm(r.height))return t.children;var{width:n,height:a}=rKe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:s,calculatedHeight:o}=woe(void 0,void 0,{width:n,height:a,aspect:t.aspect,maxHeight:t.maxHeight});return Cn(s)&&Cn(o)?g.createElement(Coe,{width:s,height:o},t.children):g.createElement(oKe,MF({},t,{width:n,height:a,ref:e}))});function _oe(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var HP=()=>{var t,e=qu(),r=pn(qGe),n=pn(VP),a=(t=pn(QP))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},lKe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},cKe=()=>{var t;return(t=pn(Ro))!==null&&t!==void 0?t:lKe},Eoe=()=>pn(LA),Soe=()=>pn(UA),uKe=()=>pn(t=>t.layout.margin),Ta=t=>t.layout.layoutType,Zw=()=>pn(Ta),dKe=()=>{var t=Zw();return t!==void 0},$P=t=>{var e=Cs(),r=qu(),{width:n,height:a}=t,s=hM(),o=n,l=a;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:a),g.useEffect(()=>{!r&&Bm(o)&&Bm(l)&&e(xGe({width:o,height:l}))},[e,r,o,l]),null},Ioe=Symbol.for("immer-nothing"),lK=Symbol.for("immer-draftable"),$u=Symbol.for("immer-state");function uf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Z2=Object.getPrototypeOf;function Kv(t){return!!t&&!!t[$u]}function bg(t){var e;return t?joe(t)||Array.isArray(t)||!!t[lK]||!!((e=t.constructor)!=null&&e[lK])||eN(t)||KP(t):!1}var fKe=Object.prototype.constructor.toString(),cK=new WeakMap;function joe(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=cK.get(r);return n===void 0&&(n=Function.toString.call(r),cK.set(r,n)),n===fKe}function NI(t,e,r=!0){GP(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function GP(t){const e=t[$u];return e?e.type_:Array.isArray(t)?1:eN(t)?2:KP(t)?3:0}function LF(t,e){return GP(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Poe(t,e,r){const n=GP(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function hKe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function eN(t){return t instanceof Map}function KP(t){return t instanceof Set}function fp(t){return t.copy_||t.base_}function UF(t,e){if(eN(t))return new Map(t);if(KP(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=joe(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[$u];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(Z2(t),n)}else{const n=Z2(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function AM(t,e=!1){return qP(t)||Kv(t)||!bg(t)||(GP(t)>1&&Object.defineProperties(t,{set:w_,add:w_,clear:w_,delete:w_}),Object.freeze(t),e&&Object.values(t).forEach(r=>AM(r,!0))),t}function AKe(){uf(2)}var w_={value:AKe};function qP(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var mKe={};function wg(t){const e=mKe[t];return e||uf(0,t),e}var ew;function Boe(){return ew}function pKe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function uK(t,e){e&&(wg("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function QF(t){VF(t),t.drafts_.forEach(gKe),t.drafts_=null}function VF(t){t===ew&&(ew=t.parent_)}function dK(t){return ew=pKe(ew,t)}function gKe(t){const e=t[$u];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function fK(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[$u].modified_&&(QF(e),uf(4)),bg(t)&&(t=CI(e,t),e.parent_||_I(e,t)),e.patches_&&wg("Patches").generateReplacementPatches_(r[$u].base_,t,e.patches_,e.inversePatches_)):t=CI(e,r,[]),QF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Ioe?t:void 0}function CI(t,e,r){if(qP(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[$u];if(!a)return NI(e,(s,o)=>hK(t,a,e,s,o,r),n),e;if(a.scope_!==t)return e;if(!a.modified_)return _I(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),NI(o,(c,u)=>hK(t,a,s,c,u,r,l),n),_I(t,s,!1),r&&t.patches_&&wg("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function hK(t,e,r,n,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=qP(a);if(!(l&&!o)){if(Kv(a)){const c=s&&e&&e.type_!==3&&!LF(e.assigned_,n)?s.concat(n):void 0,u=CI(t,a,c);if(Poe(r,n,u),Kv(u))t.canAutoFreeze_=!1;else return}else o&&r.add(a);if(bg(a)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===a&&l)return;CI(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(eN(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&_I(t,a)}}}function _I(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&AM(e,r)}function xKe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:Boe(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=mM;r&&(a=[n],s=tw);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var mM={get(t,e){if(e===$u)return t;const r=fp(t);if(!LF(r,e))return vKe(t,r,e);const n=r[e];return t.finalized_||!bg(n)?n:n===mB(t.base_,e)?(pB(t),t.copy_[e]=$F(n,t)):n},has(t,e){return e in fp(t)},ownKeys(t){return Reflect.ownKeys(fp(t))},set(t,e,r){const n=Toe(fp(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=mB(fp(t),e),s=a==null?void 0:a[$u];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(hKe(r,a)&&(r!==void 0||LF(t.base_,e)))return!0;pB(t),HF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return mB(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,pB(t),HF(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=fp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){uf(11)},getPrototypeOf(t){return Z2(t.base_)},setPrototypeOf(){uf(12)}},tw={};NI(mM,(t,e)=>{tw[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});tw.deleteProperty=function(t,e){return tw.set.call(this,t,e,void 0)};tw.set=function(t,e,r){return mM.set.call(this,t[0],e,r,t[0])};function mB(t,e){const r=t[$u];return(r?fp(r):t)[e]}function vKe(t,e,r){var a;const n=Toe(e,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Toe(t,e){if(!(e in t))return;let r=Z2(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Z2(r)}}function HF(t){t.modified_||(t.modified_=!0,t.parent_&&HF(t.parent_))}function pB(t){t.copy_||(t.copy_=UF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var yKe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&uf(6),n!==void 0&&typeof n!="function"&&uf(7);let a;if(bg(e)){const s=dK(this),o=$F(e,void 0);let l=!0;try{a=r(o),l=!1}finally{l?QF(s):VF(s)}return uK(s,n),fK(a,s)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===Ioe&&(a=void 0),this.autoFreeze_&&AM(a,!0),n){const s=[],o=[];wg("Patches").generateReplacementPatches_(e,a,s,o),n(s,o)}return a}else uf(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,a;return[this.produce(e,r,(o,l)=>{n=o,a=l}),n,a]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){bg(t)||uf(8),Kv(t)&&(t=bKe(t));const e=dK(this),r=$F(t,void 0);return r[$u].isManual_=!0,VF(e),r}finishDraft(t,e){const r=t&&t[$u];(!r||!r.isManual_)&&uf(9);const{scope_:n}=r;return uK(n,e),fK(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=wg("Patches").applyPatches_;return Kv(t)?n(t,e):this.produce(t,a=>n(a,e))}};function $F(t,e){const r=eN(t)?wg("MapSet").proxyMap_(t,e):KP(t)?wg("MapSet").proxySet_(t,e):xKe(t,e);return(e?e.scope_:Boe()).drafts_.push(r),r}function bKe(t){return Kv(t)||uf(10,t),koe(t)}function koe(t){if(!bg(t)||qP(t))return t;const e=t[$u];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=UF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=UF(t,!0);return NI(r,(a,s)=>{Poe(r,a,koe(s))},n),e&&(e.finalized_=!1),r}var wKe=new yKe;wKe.produce;var NKe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Foe=uu({name:"legend",initialState:NKe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:Ls()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,a=vf(t).payload.indexOf(r);a>-1&&(t.payload[a]=n)},prepare:Ls()},removeLegendPayload:{reducer(t,e){var r=vf(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:Ls()}}}),{setLegendSize:AK,setLegendSettings:CKe,addLegendPayload:Ooe,replaceLegendPayload:Doe,removeLegendPayload:Roe}=Foe.actions,_Ke=Foe.reducer,EKe=["contextPayload"];function GF(){return GF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},GF.apply(null,arguments)}function mK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mK(Object(r),!0).forEach(function(n){SKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SKe(t,e,r){return(e=IKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IKe(t){var e=jKe(t,"string");return typeof e=="symbol"?e:e+""}function jKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PKe(t,e){if(t==null)return{};var r,n,a=BKe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function BKe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function TKe(t){return t.value}function kKe(t){var{contextPayload:e}=t,r=PKe(t,EKe),n=Sie(e,t.payloadUniqBy,TKe),a=qv(qv({},r),{},{payload:n});return g.isValidElement(t.content)?g.cloneElement(t.content,a):typeof t.content=="function"?g.createElement(t.content,a):g.createElement(DHe,a)}function FKe(t,e,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=e,u,d;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?d={top:((a||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),qv(qv({},u),d)}function OKe(t){var e=Cs();return g.useEffect(()=>{e(CKe(t))},[e,t]),null}function DKe(t){var e=Cs();return g.useEffect(()=>(e(AK(t)),()=>{e(AK({width:0,height:0}))}),[e,t]),null}function RKe(t,e,r,n){return t==="vertical"&&Cn(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var MKe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function KF(t){var e=kl(t,MKe),r=y$e(),n=IVe(),a=uKe(),{width:s,height:o,wrapperStyle:l,portal:c}=e,[u,d]=Lie([r]),f=Eoe(),A=Soe();if(f==null||A==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=RKe(e.layout,o,s,h),p=c?l:qv(qv({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},FKe(l,e,a,f,A,u)),l),x=c??n;if(x==null||r==null)return null;var v=g.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},g.createElement(OKe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&g.createElement(DKe,{width:u.width,height:u.height}),g.createElement(kKe,GF({},e,m,{margin:a,chartWidth:f,chartHeight:A,contextPayload:r})));return Mu.createPortal(v,x)}KF.displayName="Legend";function qF(){return qF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qF.apply(null,arguments)}function pK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function gB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pK(Object(r),!0).forEach(function(n){LKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LKe(t,e,r){return(e=UKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UKe(t){var e=QKe(t,"string");return typeof e=="symbol"?e:e+""}function QKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VKe(t){return Array.isArray(t)&&dh(t[0])&&dh(t[1])?t.join(" ~ "):t}var HKe=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:A=!1}=t,h=()=>{if(s&&s.length){var j={padding:0,margin:0},I=(l?IP(s,l):s).map((_,S)=>{if(_.type==="none")return null;var E=_.formatter||o||VKe,{value:B,name:T}=_,P=B,O=T;if(E){var z=E(B,T,_,S,s);if(Array.isArray(z))[P,O]=z;else if(z!=null)P=z;else return null}var ce=gB({display:"block",paddingTop:4,paddingBottom:4,color:_.color||"#000"},n);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:ce},dh(O)?g.createElement("span",{className:"recharts-tooltip-item-name"},O):null,dh(O)?g.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,g.createElement("span",{className:"recharts-tooltip-item-value"},P),g.createElement("span",{className:"recharts-tooltip-item-unit"},_.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:j},I)}return null},m=gB({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=gB({margin:0},a),x=!sl(d),v=x?d:"",y=as("recharts-default-tooltip",c),b=as("recharts-tooltip-label",u);x&&f&&s!==void 0&&s!==null&&(v=f(d,s));var w=A?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",qF({className:y,style:m},w),g.createElement("p",{className:b,style:p},g.isValidElement(v)?v:"".concat(v)),h())},Ny="recharts-tooltip-wrapper",$Ke={visibility:"hidden"};function GKe(t){var{coordinate:e,translateX:r,translateY:n}=t;return as(Ny,{["".concat(Ny,"-right")]:Cn(r)&&e&&Cn(e.x)&&r>=e.x,["".concat(Ny,"-left")]:Cn(r)&&e&&Cn(e.x)&&r<e.x,["".concat(Ny,"-bottom")]:Cn(n)&&e&&Cn(e.y)&&n>=e.y,["".concat(Ny,"-top")]:Cn(n)&&e&&Cn(e.y)&&n<e.y})}function gK(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(s&&Cn(s[n]))return s[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(e[n])return o[n]?d:f;var A=c[n];if(A==null)return 0;if(o[n]){var h=d,m=A;return h<m?Math.max(f,A):Math.max(d,A)}if(u==null)return 0;var p=f+l,x=A+u;return p>x?Math.max(d,A):Math.max(f,A)}function KKe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function qKe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,u,d,f;return o.height>0&&o.width>0&&r?(d=gK({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=gK({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=KKe({translateX:d,translateY:f,useTranslate3d:l})):u=$Ke,{cssProperties:u,cssClasses:GKe({translateX:d,translateY:f,coordinate:r})}}function xK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function N_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xK(Object(r),!0).forEach(function(n){zF(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zF(t,e,r){return(e=zKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zKe(t){var e=WKe(t,"string");return typeof e=="symbol"?e:e+""}function WKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XKe extends g.PureComponent{constructor(){super(...arguments),zF(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),zF(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:A,viewBox:h,wrapperStyle:m,lastBoundingBox:p,innerRef:x,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=qKe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:p.height,width:p.width},useTranslate3d:A,viewBox:h}),w=v?{}:N_(N_({transition:c&&e?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),j=N_(N_({},w),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},m);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:j,ref:x},s)}}var Moe=()=>{var t;return(t=pn(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function WF(){return WF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WF.apply(null,arguments)}function vK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vK(Object(r),!0).forEach(function(n){YKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YKe(t,e,r){return(e=JKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JKe(t){var e=ZKe(t,"string");return typeof e=="symbol"?e:e+""}function ZKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bK={curveBasisClosed:qVe,curveBasisOpen:zVe,curveBasis:KVe,curveBumpX:TVe,curveBumpY:kVe,curveLinearClosed:WVe,curveLinear:bP,curveMonotoneX:XVe,curveMonotoneY:YVe,curveNatural:JVe,curveStep:ZVe,curveStepAfter:tHe,curveStepBefore:eHe},EI=t=>Ai(t.x)&&Ai(t.y),wK=t=>t.base!=null&&EI(t.base)&&EI(t),Cy=t=>t.x,_y=t=>t.y,eqe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(qw(t));return(r==="curveMonotone"||r==="curveBump")&&e?bK["".concat(r).concat(e==="vertical"?"Y":"X")]:bK[r]||bP},tqe=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=t,o=eqe(e,a),l=s?r.filter(EI):r,c;if(Array.isArray(n)){var u=r.map((h,m)=>yK(yK({},h),{},{base:n[m]}));a==="vertical"?c=m_().y(_y).x1(Cy).x0(h=>h.base.x):c=m_().x(Cy).y1(_y).y0(h=>h.base.y);var d=c.defined(wK).curve(o),f=s?u.filter(wK):u;return d(f)}a==="vertical"&&Cn(n)?c=m_().y(_y).x1(Cy).x0(n):Cn(n)?c=m_().x(Cy).y1(_y).y0(n):c=zse().x(Cy).y(_y);var A=c.defined(EI).curve(o);return A(l)},pM=t=>{var{className:e,points:r,path:n,pathRef:a}=t,s=Zw();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||s,connectNulls:t.connectNulls},l=r&&r.length?tqe(o):n;return g.createElement("path",WF({},ch(t),NHe(t),{className:as("recharts-curve",e),d:l===null?void 0:l,ref:a}))},rqe=["x","y","top","left","width","height","className"];function XF(){return XF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},XF.apply(null,arguments)}function NK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function nqe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NK(Object(r),!0).forEach(function(n){aqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aqe(t,e,r){return(e=sqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sqe(t){var e=iqe(t,"string");return typeof e=="symbol"?e:e+""}function iqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oqe(t,e){if(t==null)return{};var r,n,a=lqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function lqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var cqe=(t,e,r,n,a,s)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(s,",").concat(e,"h").concat(r),uqe=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=t,c=oqe(t,rqe),u=nqe({x:e,y:r,top:n,left:a,width:s,height:o},c);return!Cn(e)||!Cn(r)||!Cn(s)||!Cn(o)||!Cn(n)||!Cn(a)?null:g.createElement("path",XF({},Dd(u),{className:as("recharts-cross",l),d:cqe(e,r,s,o,n,a)}))};function dqe(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function CK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _K(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CK(Object(r),!0).forEach(function(n){fqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fqe(t,e,r){return(e=hqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hqe(t){var e=Aqe(t,"string");return typeof e=="symbol"?e:e+""}function Aqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mqe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),Loe=(t,e,r)=>t.map(n=>"".concat(mqe(n)," ").concat(e,"ms ").concat(r)).join(","),pqe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),rw=(t,e)=>Object.keys(e).reduce((r,n)=>_K(_K({},r),{},{[n]:t(n,e[n])}),{});function EK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function So(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EK(Object(r),!0).forEach(function(n){gqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gqe(t,e,r){return(e=xqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xqe(t){var e=vqe(t,"string");return typeof e=="symbol"?e:e+""}function vqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SI=(t,e,r)=>t+(e-t)*r,YF=t=>{var{from:e,to:r}=t;return e!==r},Uoe=(t,e,r)=>{var n=rw((a,s)=>{if(YF(s)){var[o,l]=t(s.from,s.to,s.velocity);return So(So({},s),{},{from:o,velocity:l})}return s},e);return r<1?rw((a,s)=>YF(s)&&n[a]!=null?So(So({},s),{},{velocity:SI(s.velocity,n[a].velocity,r),from:SI(s.from,n[a].from,r)}):s,e):Uoe(t,n,r-1)};function yqe(t,e,r,n,a,s){var o,l=n.reduce((A,h)=>So(So({},A),{},{[h]:{from:t[h],velocity:0,to:e[h]}}),{}),c=()=>rw((A,h)=>h.from,l),u=()=>!Object.values(l).filter(YF).length,d=null,f=A=>{o||(o=A);var h=A-o,m=h/r.dt;l=Uoe(r,l,m),a(So(So(So({},t),e),c())),o=A,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var A;(A=d)===null||A===void 0||A()})}function bqe(t,e,r,n,a,s,o){var l=null,c=a.reduce((f,A)=>{var h=t[A],m=e[A];return h==null||m==null?f:So(So({},f),{},{[A]:[h,m]})},{}),u,d=f=>{u||(u=f);var A=(f-u)/n,h=rw((p,x)=>SI(...x,r(A)),c);if(s(So(So(So({},t),e),h)),A<1)l=o.setTimeout(d);else{var m=rw((p,x)=>SI(...x,r(1)),c);s(So(So(So({},t),e),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const wqe=(t,e,r,n,a,s)=>{var o=pqe(t,e);return r==null?()=>(a(So(So({},t),e)),()=>{}):r.isStepper===!0?yqe(t,e,r,o,a,s):bqe(t,e,r,n,o,a,s)};var II=1e-4,Qoe=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],Voe=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),SK=(t,e)=>r=>{var n=Qoe(t,e);return Voe(n,r)},Nqe=(t,e)=>r=>{var n=Qoe(t,e),a=[...n.map((s,o)=>s*o).slice(1),0];return Voe(a,r)},Cqe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},_qe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=Cqe(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},Eqe=(t,e,r,n)=>{var a=SK(t,r),s=SK(e,n),o=Nqe(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,A=0;A<8;++A){var h=a(f)-d,m=o(f);if(Math.abs(h-d)<II||m<II)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},IK=function(){return Eqe(..._qe(...arguments))},Sqe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*a/1e3,A=c*a/1e3+o;return Math.abs(A-l)<II&&Math.abs(f)<II?[l,0]:[A,f]};return s.isStepper=!0,s.dt=a,s},Iqe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return IK(t);case"spring":return Sqe();default:if(t.split("(")[0]==="cubic-bezier")return IK(t)}return typeof t=="function"?t:null};function jqe(t){var e,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){a=t.setTimeout(s.bind(null,u),c);return}s(c),a=t.setTimeout(s.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class Pqe{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function Bqe(){return jqe(new Pqe)}var Tqe=g.createContext(Bqe);function kqe(t,e){var r=g.useContext(Tqe);return g.useMemo(()=>e??r(t),[t,e,r])}var Fqe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),zP={isSsr:Fqe()},Oqe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},jK={t:0},xB={t:1};function WP(t){var e=kl(t,Oqe),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,d=r==="auto"?!zP.isSsr:r,f=kqe(e.animationId,e.animationManager),[A,h]=g.useState(d?jK:xB),m=g.useRef(null);return g.useEffect(()=>{d||h(xB)},[d]),g.useEffect(()=>{if(!d||!n)return zw;var p=wqe(jK,xB,Iqe(s),a,h,f.getTimeoutController()),x=()=>{m.current=p()};return f.start([c,o,x,a,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,a,s,o,c,l,f]),u(A.t)}function XP(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=g.useRef(W2(e)),n=g.useRef(t);return n.current!==t&&(r.current=W2(e),n.current=t),r.current}var Dqe=["radius"],Rqe=["radius"],PK,BK,TK,kK,FK,OK,DK,RK,MK,LK;function UK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function QK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UK(Object(r),!0).forEach(function(n){Mqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mqe(t,e,r){return(e=Lqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lqe(t){var e=Uqe(t,"string");return typeof e=="symbol"?e:e+""}function Uqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jI(){return jI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jI.apply(null,arguments)}function VK(t,e){if(t==null)return{};var r,n,a=Qqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Qqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Qf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var HK=(t,e,r,n,a)=>{var s=Y0(r),o=Y0(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&a instanceof Array){for(var A=[0,0,0,0],h=0,m=4;h<m;h++)A[h]=a[h]>l?l:a[h];f=Ni(PK||(PK=Qf(["M",",",""])),t,e+c*A[0]),A[0]>0&&(f+=Ni(BK||(BK=Qf(["A ",",",",0,0,",",",",",""])),A[0],A[0],d,t+u*A[0],e)),f+=Ni(TK||(TK=Qf(["L ",",",""])),t+r-u*A[1],e),A[1]>0&&(f+=Ni(kK||(kK=Qf(["A ",",",",0,0,",`,
        `,",",""])),A[1],A[1],d,t+r,e+c*A[1])),f+=Ni(FK||(FK=Qf(["L ",",",""])),t+r,e+n-c*A[2]),A[2]>0&&(f+=Ni(OK||(OK=Qf(["A ",",",",0,0,",`,
        `,",",""])),A[2],A[2],d,t+r-u*A[2],e+n)),f+=Ni(DK||(DK=Qf(["L ",",",""])),t+u*A[3],e+n),A[3]>0&&(f+=Ni(RK||(RK=Qf(["A ",",",",0,0,",`,
        `,",",""])),A[3],A[3],d,t,e+n-c*A[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var p=Math.min(l,a);f=Ni(MK||(MK=Qf(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*p,p,p,d,t+u*p,e,t+r-u*p,e,p,p,d,t+r,e+c*p,t+r,e+n-c*p,p,p,d,t+r-u*p,e+n,t+u*p,e+n,p,p,d,t,e+n-c*p)}else f=Ni(LK||(LK=Qf(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return f},$K={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Hoe=t=>{var e=kl(t,$K),r=g.useRef(null),[n,a]=g.useState(-1);g.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ue=r.current.getTotalLength();ue&&a(ue)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=e,{animationEasing:f,animationDuration:A,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:p}=e,x=g.useRef(l),v=g.useRef(c),y=g.useRef(s),b=g.useRef(o),w=g.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),j=XP(w,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var I=as("recharts-rectangle",d);if(!p){var _=Dd(e),{radius:S}=_,E=VK(_,Dqe);return g.createElement("path",jI({},E,{x:Y0(s),y:Y0(o),width:Y0(l),height:Y0(c),radius:typeof u=="number"?u:void 0,className:I,d:HK(s,o,l,c,u)}))}var B=x.current,T=v.current,P=y.current,O=b.current,z="0px ".concat(n===-1?1:n,"px"),ce="".concat(n,"px 0px"),de=Loe(["strokeDasharray"],A,typeof f=="string"?f:$K.animationEasing);return g.createElement(WP,{animationId:j,key:j,canBegin:n>0,duration:A,easing:f,isActive:p,begin:h},ue=>{var me=Eo(B,l,ue),se=Eo(T,c,ue),ke=Eo(P,s,ue),Re=Eo(O,o,ue);r.current&&(x.current=me,v.current=se,y.current=ke,b.current=Re);var F;m?ue>0?F={transition:de,strokeDasharray:ce}:F={strokeDasharray:z}:F={strokeDasharray:ce};var H=Dd(e),{radius:K}=H,L=VK(H,Rqe);return g.createElement("path",jI({},L,{radius:typeof u=="number"?u:void 0,className:I,d:HK(ke,Re,me,se,u),ref:r,style:QK(QK({},F),e.style)}))})};function GK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function KK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GK(Object(r),!0).forEach(function(n){Vqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Vqe(t,e,r){return(e=Hqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hqe(t){var e=$qe(t,"string");return typeof e=="symbol"?e:e+""}function $qe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PI=Math.PI/180,Gqe=t=>t*180/Math.PI,lo=(t,e,r,n)=>({x:t+Math.cos(-PI*n)*r,y:e+Math.sin(-PI*n)*r}),$oe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Kqe=(t,e)=>{var{x:r,y:n}=t,{x:a,y:s}=e;return Math.sqrt((r-a)**2+(n-s)**2)},qqe=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:s}=e,o=Kqe({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:Gqe(c),angleInRadian:c}},zqe=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:e-s*360,endAngle:r-s*360}},Wqe=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return t+o*360},Xqe=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:a,angle:s}=qqe({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:u}=zqe(e),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?KK(KK({},e),{},{radius:a,angle:Wqe(d,e)}):null};function Goe(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:s}=t,o=lo(e,r,n,a),l=lo(e,r,n,s);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:a,endAngle:s}}var qK,zK,WK,XK,YK,JK,ZK;function JF(){return JF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},JF.apply(null,arguments)}function Ip(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Yqe=(t,e)=>{var r=Pl(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},C_=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,d=Math.asin(l/u)/PI,f=c?a:a+s*d,A=lo(e,r,u,f),h=lo(e,r,n,f),m=c?a-s*d:a,p=lo(e,r,u*Math.cos(d*PI),m);return{center:A,circleTangency:h,lineTangency:p,theta:d}},Koe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=t,l=Yqe(s,o),c=s+l,u=lo(e,r,a,s),d=lo(e,r,a,c),f=Ni(qK||(qK=Ip(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var A=lo(e,r,n,s),h=lo(e,r,n,c);f+=Ni(zK||(zK=Ip(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),A.x,A.y)}else f+=Ni(WK||(WK=Ip(["L ",","," Z"])),e,r);return f},Jqe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,d=Pl(u-c),{circleTangency:f,lineTangency:A,theta:h}=C_({cx:e,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:p,theta:x}=C_({cx:e,cy:r,radius:a,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),v=l?Math.abs(c-u):Math.abs(c-u)-h-x;if(v<0)return o?Ni(XK||(XK=Ip(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),A.x,A.y,s,s,s*2,s,s,-s*2):Koe({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var y=Ni(YK||(YK=Ip(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),A.x,A.y,s,s,+(d<0),f.x,f.y,a,a,+(v>180),+(d<0),m.x,m.y,s,s,+(d<0),p.x,p.y);if(n>0){var{circleTangency:b,lineTangency:w,theta:j}=C_({cx:e,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:I,lineTangency:_,theta:S}=C_({cx:e,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),E=l?Math.abs(c-u):Math.abs(c-u)-j-S;if(E<0&&s===0)return"".concat(y,"L").concat(e,",").concat(r,"Z");y+=Ni(JK||(JK=Ip(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),_.x,_.y,s,s,+(d<0),I.x,I.y,n,n,+(E>180),+(d>0),b.x,b.y,s,s,+(d<0),w.x,w.y)}else y+=Ni(ZK||(ZK=Ip(["L",",","Z"])),e,r);return y},Zqe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},qoe=t=>{var e=kl(t,Zqe),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=e;if(s<a||u===d)return null;var A=as("recharts-sector",f),h=s-a,m=ic(o,h,0,!0),p;return m>0&&Math.abs(u-d)<360?p=Jqe({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):p=Koe({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d}),g.createElement("path",JF({},Dd(e),{className:A,d:p}))};function eze(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(cie(e)){if(t==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:o,angle:l}=e,c=lo(n,a,s,l),u=lo(n,a,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Goe(e)}}var zoe={},Woe={},Xoe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=aM;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(Xoe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Xoe;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(Woe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sM,r=Woe;function n(a,s,o){o&&typeof o!="number"&&e.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=o;return c}t.range=n})(zoe);var tze=zoe.range;const Yoe=jA(tze);function mm(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function rze(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gM(t){let e,r,n;t.length!==2?(e=mm,r=(l,c)=>mm(t(l),c),n=(l,c)=>t(l)-c):(e=t===mm||t===rze?t:nze,r=t,n=t);function a(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function nze(){return 0}function Joe(t){return t===null?NaN:+t}function*aze(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const sze=gM(mm),tN=sze.right;gM(Joe).center;class eq extends Map{constructor(e,r=lze){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(tq(this,e))}has(e){return super.has(tq(this,e))}set(e,r){return super.set(ize(this,e),r)}delete(e){return super.delete(oze(this,e))}}function tq({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function ize({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function oze({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function lze(t){return t!==null&&typeof t=="object"?t.valueOf():t}function cze(t=mm){if(t===mm)return Zoe;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function Zoe(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const uze=Math.sqrt(50),dze=Math.sqrt(10),fze=Math.sqrt(2);function BI(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=uze?10:s>=dze?5:s>=fze?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?BI(t,e,r*2):[l,c,u]}function ZF(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,s,o]=n?BI(e,t,r):BI(t,e,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(a+u)/-o;else for(let u=0;u<l;++u)c[u]=(a+u)*o;return c}function eO(t,e,r){return e=+e,t=+t,r=+r,BI(t,e,r)[2]}function tO(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?eO(e,t,r):eO(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function rq(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function nq(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function ele(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?Zoe:cze(a);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),A=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(e-u*f/c+A)),m=Math.min(n,Math.floor(e+(c-u)*f/c+A));ele(t,e,h,m,a)}const s=t[e];let o=r,l=n;for(Ey(t,r,e),a(t[n],s)>0&&Ey(t,r,n);o<l;){for(Ey(t,o,l),++o,--l;a(t[o],s)<0;)++o;for(;a(t[l],s)>0;)--l}a(t[r],s)===0?Ey(t,r,l):(++l,Ey(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function Ey(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function hze(t,e,r){if(t=Float64Array.from(aze(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return nq(t);if(e>=1)return rq(t);var n,a=(n-1)*e,s=Math.floor(a),o=rq(ele(t,s).subarray(0,s+1)),l=nq(t.subarray(s+1));return o+(l-o)*(a-s)}}function Aze(t,e,r=Joe){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,s=Math.floor(a),o=+r(t[s],s,t),l=+r(t[s+1],s+1,t);return o+(l-o)*(a-s)}}function mze(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,s=new Array(a);++n<a;)s[n]=t+n*r;return s}function Vd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function QA(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const rO=Symbol("implicit");function xM(){var t=new eq,e=[],r=[],n=rO;function a(s){let o=t.get(s);if(o===void 0){if(n!==rO)return n;t.set(s,o=e.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new eq;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return xM(e,r).unknown(n)},Vd.apply(a,arguments),a}function vM(){var t=xM().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,s,o,l=!1,c=0,u=0,d=.5;delete t.unknown;function f(){var A=e().length,h=a<n,m=h?a:n,p=h?n:a;s=(p-m)/Math.max(1,A-c+u*2),l&&(s=Math.floor(s)),m+=(p-m-s*(A-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var x=mze(A).map(function(v){return m+s*v});return r(h?x.reverse():x)}return t.domain=function(A){return arguments.length?(e(A),f()):e()},t.range=function(A){return arguments.length?([n,a]=A,n=+n,a=+a,f()):[n,a]},t.rangeRound=function(A){return[n,a]=A,n=+n,a=+a,l=!0,f()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(A){return arguments.length?(l=!!A,f()):l},t.padding=function(A){return arguments.length?(c=Math.min(1,u=+A),f()):c},t.paddingInner=function(A){return arguments.length?(c=Math.min(1,A),f()):c},t.paddingOuter=function(A){return arguments.length?(u=+A,f()):u},t.align=function(A){return arguments.length?(d=Math.max(0,Math.min(1,A)),f()):d},t.copy=function(){return vM(e(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Vd.apply(f(),arguments)}function tle(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return tle(e())},t}function pze(){return tle(vM.apply(null,arguments).paddingInner(1))}function yM(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function rle(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function rN(){}var nw=.7,TI=1/nw,yv="\\s*([+-]?\\d+)\\s*",aw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ih="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gze=/^#([0-9a-f]{3,8})$/,xze=new RegExp(`^rgb\\(${yv},${yv},${yv}\\)$`),vze=new RegExp(`^rgb\\(${ih},${ih},${ih}\\)$`),yze=new RegExp(`^rgba\\(${yv},${yv},${yv},${aw}\\)$`),bze=new RegExp(`^rgba\\(${ih},${ih},${ih},${aw}\\)$`),wze=new RegExp(`^hsl\\(${aw},${ih},${ih}\\)$`),Nze=new RegExp(`^hsla\\(${aw},${ih},${ih},${aw}\\)$`),aq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yM(rN,sw,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:sq,formatHex:sq,formatHex8:Cze,formatHsl:_ze,formatRgb:iq,toString:iq});function sq(){return this.rgb().formatHex()}function Cze(){return this.rgb().formatHex8()}function _ze(){return nle(this).formatHsl()}function iq(){return this.rgb().formatRgb()}function sw(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=gze.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?oq(e):r===3?new ru(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?__(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?__(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=xze.exec(t))?new ru(e[1],e[2],e[3],1):(e=vze.exec(t))?new ru(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=yze.exec(t))?__(e[1],e[2],e[3],e[4]):(e=bze.exec(t))?__(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=wze.exec(t))?uq(e[1],e[2]/100,e[3]/100,1):(e=Nze.exec(t))?uq(e[1],e[2]/100,e[3]/100,e[4]):aq.hasOwnProperty(t)?oq(aq[t]):t==="transparent"?new ru(NaN,NaN,NaN,0):null}function oq(t){return new ru(t>>16&255,t>>8&255,t&255,1)}function __(t,e,r,n){return n<=0&&(t=e=r=NaN),new ru(t,e,r,n)}function Eze(t){return t instanceof rN||(t=sw(t)),t?(t=t.rgb(),new ru(t.r,t.g,t.b,t.opacity)):new ru}function nO(t,e,r,n){return arguments.length===1?Eze(t):new ru(t,e,r,n??1)}function ru(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}yM(ru,nO,rle(rN,{brighter(t){return t=t==null?TI:Math.pow(TI,t),new ru(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?nw:Math.pow(nw,t),new ru(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ru(Kp(this.r),Kp(this.g),Kp(this.b),kI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:lq,formatHex:lq,formatHex8:Sze,formatRgb:cq,toString:cq}));function lq(){return`#${jp(this.r)}${jp(this.g)}${jp(this.b)}`}function Sze(){return`#${jp(this.r)}${jp(this.g)}${jp(this.b)}${jp((isNaN(this.opacity)?1:this.opacity)*255)}`}function cq(){const t=kI(this.opacity);return`${t===1?"rgb(":"rgba("}${Kp(this.r)}, ${Kp(this.g)}, ${Kp(this.b)}${t===1?")":`, ${t})`}`}function kI(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Kp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function jp(t){return t=Kp(t),(t<16?"0":"")+t.toString(16)}function uq(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new df(t,e,r,n)}function nle(t){if(t instanceof df)return new df(t.h,t.s,t.l,t.opacity);if(t instanceof rN||(t=sw(t)),!t)return new df;if(t instanceof df)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(e===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new df(o,l,c,t.opacity)}function Ize(t,e,r,n){return arguments.length===1?nle(t):new df(t,e,r,n??1)}function df(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}yM(df,Ize,rle(rN,{brighter(t){return t=t==null?TI:Math.pow(TI,t),new df(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?nw:Math.pow(nw,t),new df(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new ru(vB(t>=240?t-240:t+120,a,n),vB(t,a,n),vB(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new df(dq(this.h),E_(this.s),E_(this.l),kI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=kI(this.opacity);return`${t===1?"hsl(":"hsla("}${dq(this.h)}, ${E_(this.s)*100}%, ${E_(this.l)*100}%${t===1?")":`, ${t})`}`}}));function dq(t){return t=(t||0)%360,t<0?t+360:t}function E_(t){return Math.max(0,Math.min(1,t||0))}function vB(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const bM=t=>()=>t;function jze(t,e){return function(r){return t+r*e}}function Pze(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Bze(t){return(t=+t)==1?ale:function(e,r){return r-e?Pze(e,r,t):bM(isNaN(e)?r:e)}}function ale(t,e){var r=e-t;return r?jze(t,r):bM(isNaN(t)?e:t)}const fq=function t(e){var r=Bze(e);function n(a,s){var o=r((a=nO(a)).r,(s=nO(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),u=ale(a.opacity,s.opacity);return function(d){return a.r=o(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=t,n}(1);function Tze(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=t[a]*(1-s)+e[a]*s;return n}}function kze(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Fze(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=C1(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function Oze(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function FI(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Dze(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=C1(t[a],e[a]):n[a]=e[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var aO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yB=new RegExp(aO.source,"g");function Rze(t){return function(){return t}}function Mze(t){return function(e){return t(e)+""}}function Lze(t,e){var r=aO.lastIndex=yB.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=aO.exec(t))&&(a=yB.exec(e));)(s=a.index)>r&&(s=e.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:FI(n,a)})),r=yB.lastIndex;return r<e.length&&(s=e.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?Mze(c[0].x):Rze(e):(e=c.length,function(u){for(var d=0,f;d<e;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function C1(t,e){var r=typeof e,n;return e==null||r==="boolean"?bM(e):(r==="number"?FI:r==="string"?(n=sw(e))?(e=n,fq):Lze:e instanceof sw?fq:e instanceof Date?Oze:kze(e)?Tze:Array.isArray(e)?Fze:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Dze:FI)(t,e)}function wM(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Uze(t,e){e===void 0&&(e=t,t=C1);for(var r=0,n=e.length-1,a=e[0],s=new Array(n<0?0:n);r<n;)s[r]=t(a,a=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function Qze(t){return function(){return t}}function OI(t){return+t}var hq=[0,1];function Sc(t){return t}function sO(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Qze(isNaN(e)?NaN:.5)}function Vze(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function Hze(t,e,r){var n=t[0],a=t[1],s=e[0],o=e[1];return a<n?(n=sO(a,n),s=r(o,s)):(n=sO(n,a),s=r(s,o)),function(l){return s(n(l))}}function $ze(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=sO(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(l){var c=tN(t,l,1,n)-1;return s[c](a[c](l))}}function nN(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function YP(){var t=hq,e=hq,r=C1,n,a,s,o=Sc,l,c,u;function d(){var A=Math.min(t.length,e.length);return o!==Sc&&(o=Vze(t[0],t[A-1])),l=A>2?$ze:Hze,c=u=null,f}function f(A){return A==null||isNaN(A=+A)?s:(c||(c=l(t.map(n),e,r)))(n(o(A)))}return f.invert=function(A){return o(a((u||(u=l(e,t.map(n),FI)))(A)))},f.domain=function(A){return arguments.length?(t=Array.from(A,OI),d()):t.slice()},f.range=function(A){return arguments.length?(e=Array.from(A),d()):e.slice()},f.rangeRound=function(A){return e=Array.from(A),r=wM,d()},f.clamp=function(A){return arguments.length?(o=A?!0:Sc,d()):o!==Sc},f.interpolate=function(A){return arguments.length?(r=A,d()):r},f.unknown=function(A){return arguments.length?(s=A,f):s},function(A,h){return n=A,a=h,d()}}function NM(){return YP()(Sc,Sc)}function Gze(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function DI(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function zv(t){return t=DI(Math.abs(t)),t?t[1]:NaN}function Kze(t,e){return function(r,n){for(var a=r.length,s=[],o=0,l=t[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return s.reverse().join(e)}}function qze(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var zze=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function iw(t){if(!(e=zze.exec(t)))throw new Error("invalid format: "+t);var e;return new CM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}iw.prototype=CM.prototype;function CM(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}CM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wze(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var RI;function Xze(t,e){var r=DI(t,e);if(!r)return RI=void 0,t.toPrecision(e);var n=r[0],a=r[1],s=a-(RI=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+DI(t,Math.max(0,e+s-1))[0]}function Aq(t,e){var r=DI(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const mq={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Gze,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Aq(t*100,e),r:Aq,s:Xze,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function pq(t){return t}var gq=Array.prototype.map,xq=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Yze(t){var e=t.grouping===void 0||t.thousands===void 0?pq:Kze(gq.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?pq:qze(gq.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f,A){f=iw(f);var h=f.fill,m=f.align,p=f.sign,x=f.symbol,v=f.zero,y=f.width,b=f.comma,w=f.precision,j=f.trim,I=f.type;I==="n"?(b=!0,I="g"):mq[I]||(w===void 0&&(w=12),j=!0,I="g"),(v||h==="0"&&m==="=")&&(v=!0,h="0",m="=");var _=(A&&A.prefix!==void 0?A.prefix:"")+(x==="$"?r:x==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():""),S=(x==="$"?n:/[%p]/.test(I)?o:"")+(A&&A.suffix!==void 0?A.suffix:""),E=mq[I],B=/[defgprs%]/.test(I);w=w===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function T(P){var O=_,z=S,ce,de,ue;if(I==="c")z=E(P)+z,P="";else{P=+P;var me=P<0||1/P<0;if(P=isNaN(P)?c:E(Math.abs(P),w),j&&(P=Wze(P)),me&&+P==0&&p!=="+"&&(me=!1),O=(me?p==="("?p:l:p==="-"||p==="("?"":p)+O,z=(I==="s"&&!isNaN(P)&&RI!==void 0?xq[8+RI/3]:"")+z+(me&&p==="("?")":""),B){for(ce=-1,de=P.length;++ce<de;)if(ue=P.charCodeAt(ce),48>ue||ue>57){z=(ue===46?a+P.slice(ce+1):P.slice(ce))+z,P=P.slice(0,ce);break}}}b&&!v&&(P=e(P,1/0));var se=O.length+P.length+z.length,ke=se<y?new Array(y-se+1).join(h):"";switch(b&&v&&(P=e(ke+P,ke.length?y-z.length:1/0),ke=""),m){case"<":P=O+P+z+ke;break;case"=":P=O+ke+P+z;break;case"^":P=ke.slice(0,se=ke.length>>1)+O+P+z+ke.slice(se);break;default:P=ke+O+P+z;break}return s(P)}return T.toString=function(){return f+""},T}function d(f,A){var h=Math.max(-8,Math.min(8,Math.floor(zv(A)/3)))*3,m=Math.pow(10,-h),p=u((f=iw(f),f.type="f",f),{suffix:xq[8+h/3]});return function(x){return p(m*x)}}return{format:u,formatPrefix:d}}var S_,_M,sle;Jze({thousands:",",grouping:[3],currency:["$",""]});function Jze(t){return S_=Yze(t),_M=S_.format,sle=S_.formatPrefix,S_}function Zze(t){return Math.max(0,-zv(Math.abs(t)))}function eWe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(zv(e)/3)))*3-zv(Math.abs(t)))}function tWe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,zv(e)-zv(t))+1}function ile(t,e,r,n){var a=tO(t,e,r),s;switch(n=iw(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(s=eWe(a,o))&&(n.precision=s),sle(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=tWe(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=Zze(a))&&(n.precision=s-(n.type==="%")*2);break}}return _M(n)}function Hm(t){var e=t.domain;return t.ticks=function(r){var n=e();return ZF(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return ile(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,s=n.length-1,o=n[a],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=a,a=s,s=u);d-- >0;){if(u=eO(o,l,r),u===c)return n[a]=o,n[s]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function ole(){var t=NM();return t.copy=function(){return nN(t,ole())},Vd.apply(t,arguments),Hm(t)}function lle(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,OI),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return lle(t).unknown(e)},t=arguments.length?Array.from(t,OI):[0,1],Hm(r)}function cle(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],s=t[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),t[r]=e.floor(a),t[n]=e.ceil(s),t}function vq(t){return Math.log(t)}function yq(t){return Math.exp(t)}function rWe(t){return-Math.log(-t)}function nWe(t){return-Math.exp(-t)}function aWe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function sWe(t){return t===10?aWe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function iWe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function bq(t){return(e,r)=>-t(-e,r)}function EM(t){const e=t(vq,yq),r=e.domain;let n=10,a,s;function o(){return a=iWe(n),s=sWe(n),r()[0]<0?(a=bq(a),s=bq(s),t(rWe,nWe)):t(vq,yq),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let A=a(u),h=a(d),m,p;const x=l==null?10:+l;let v=[];if(!(n%1)&&h-A<x){if(A=Math.floor(A),h=Math.ceil(h),u>0){for(;A<=h;++A)for(m=1;m<n;++m)if(p=A<0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}}else for(;A<=h;++A)for(m=n-1;m>=1;--m)if(p=A>0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}v.length*2<x&&(v=ZF(u,d,x))}else v=ZF(A,h,Math.min(h-A,x)).map(s);return f?v.reverse():v},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=iw(c)).precision==null&&(c.trim=!0),c=_M(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},e.nice=()=>r(cle(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),e}function ule(){const t=EM(YP()).domain([1,10]);return t.copy=()=>nN(t,ule()).base(t.base()),Vd.apply(t,arguments),t}function wq(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Nq(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function SM(t){var e=1,r=t(wq(e),Nq(e));return r.constant=function(n){return arguments.length?t(wq(e=+n),Nq(e)):e},Hm(r)}function dle(){var t=SM(YP());return t.copy=function(){return nN(t,dle()).constant(t.constant())},Vd.apply(t,arguments)}function Cq(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function oWe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function lWe(t){return t<0?-t*t:t*t}function IM(t){var e=t(Sc,Sc),r=1;function n(){return r===1?t(Sc,Sc):r===.5?t(oWe,lWe):t(Cq(r),Cq(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},Hm(e)}function jM(){var t=IM(YP());return t.copy=function(){return nN(t,jM()).exponent(t.exponent())},Vd.apply(t,arguments),t}function cWe(){return jM.apply(null,arguments).exponent(.5)}function _q(t){return Math.sign(t)*t*t}function uWe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function fle(){var t=NM(),e=[0,1],r=!1,n;function a(s){var o=uWe(t(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return t.invert(_q(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((e=Array.from(s,OI)).map(_q)),a):e.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return fle(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Vd.apply(a,arguments),Hm(a)}function hle(){var t=[],e=[],r=[],n;function a(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=Aze(t,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:e[tN(r,o)]}return s.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(mm),a()},s.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return hle().domain(t).range(e).unknown(n)},Vd.apply(s,arguments)}function Ale(){var t=0,e=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[tN(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return Ale().domain([t,e]).range(a).unknown(s)},Vd.apply(Hm(o),arguments)}function mle(){var t=[.5],e=[0,1],r,n=1;function a(s){return s!=null&&s<=s?e[tN(t,s,0,n)]:r}return a.domain=function(s){return arguments.length?(t=Array.from(s),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return mle().domain(t).range(e).unknown(r)},Vd.apply(a,arguments)}const bB=new Date,wB=new Date;function Mo(t,e,r,n){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),e(s,l),t(s);while(u<s&&s<o);return c},a.filter=s=>Mo(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!s(o););else for(;--l>=0;)for(;e(o,1),!s(o););}),r&&(a.count=(s,o)=>(bB.setTime(+s),wB.setTime(+o),t(bB),t(wB),Math.floor(r(bB,wB))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const MI=Mo(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);MI.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Mo(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):MI);MI.range;const Jh=1e3,Ed=Jh*60,Zh=Ed*60,CA=Zh*24,PM=CA*7,Eq=CA*30,NB=CA*365,Pp=Mo(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Jh)},(t,e)=>(e-t)/Jh,t=>t.getUTCSeconds());Pp.range;const BM=Mo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Jh)},(t,e)=>{t.setTime(+t+e*Ed)},(t,e)=>(e-t)/Ed,t=>t.getMinutes());BM.range;const TM=Mo(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Ed)},(t,e)=>(e-t)/Ed,t=>t.getUTCMinutes());TM.range;const kM=Mo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Jh-t.getMinutes()*Ed)},(t,e)=>{t.setTime(+t+e*Zh)},(t,e)=>(e-t)/Zh,t=>t.getHours());kM.range;const FM=Mo(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Zh)},(t,e)=>(e-t)/Zh,t=>t.getUTCHours());FM.range;const aN=Mo(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ed)/CA,t=>t.getDate()-1);aN.range;const JP=Mo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/CA,t=>t.getUTCDate()-1);JP.range;const ple=Mo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/CA,t=>Math.floor(t/CA));ple.range;function $g(t){return Mo(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Ed)/PM)}const ZP=$g(0),LI=$g(1),dWe=$g(2),fWe=$g(3),Wv=$g(4),hWe=$g(5),AWe=$g(6);ZP.range;LI.range;dWe.range;fWe.range;Wv.range;hWe.range;AWe.range;function Gg(t){return Mo(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/PM)}const e3=Gg(0),UI=Gg(1),mWe=Gg(2),pWe=Gg(3),Xv=Gg(4),gWe=Gg(5),xWe=Gg(6);e3.range;UI.range;mWe.range;pWe.range;Xv.range;gWe.range;xWe.range;const OM=Mo(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());OM.range;const DM=Mo(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());DM.range;const _A=Mo(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());_A.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mo(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});_A.range;const EA=Mo(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());EA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mo(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});EA.range;function gle(t,e,r,n,a,s){const o=[[Pp,1,Jh],[Pp,5,5*Jh],[Pp,15,15*Jh],[Pp,30,30*Jh],[s,1,Ed],[s,5,5*Ed],[s,15,15*Ed],[s,30,30*Ed],[a,1,Zh],[a,3,3*Zh],[a,6,6*Zh],[a,12,12*Zh],[n,1,CA],[n,2,2*CA],[r,1,PM],[e,1,Eq],[e,3,3*Eq],[t,1,NB]];function l(u,d,f){const A=d<u;A&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),m=h?h.range(u,+d+1):[];return A?m.reverse():m}function c(u,d,f){const A=Math.abs(d-u)/f,h=gM(([,,x])=>x).right(o,A);if(h===o.length)return t.every(tO(u/NB,d/NB,f));if(h===0)return MI.every(Math.max(tO(u,d,f),1));const[m,p]=o[A/o[h-1][2]<o[h][2]/A?h-1:h];return m.every(p)}return[l,c]}const[vWe,yWe]=gle(EA,DM,e3,ple,FM,TM),[bWe,wWe]=gle(_A,OM,ZP,aN,kM,BM);function CB(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function _B(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Sy(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function NWe(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,s=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=Iy(a),d=jy(a),f=Iy(s),A=jy(s),h=Iy(o),m=jy(o),p=Iy(l),x=jy(l),v=Iy(c),y=jy(c),b={a:ue,A:me,b:se,B:ke,c:null,d:Tq,e:Tq,f:KWe,g:rXe,G:aXe,H:HWe,I:$We,j:GWe,L:xle,m:qWe,M:zWe,p:Re,q:F,Q:Oq,s:Dq,S:WWe,u:XWe,U:YWe,V:JWe,w:ZWe,W:eXe,x:null,X:null,y:tXe,Y:nXe,Z:sXe,"%":Fq},w={a:H,A:K,b:L,B:W,c:null,d:kq,e:kq,f:cXe,g:vXe,G:bXe,H:iXe,I:oXe,j:lXe,L:yle,m:uXe,M:dXe,p:Y,q:D,Q:Oq,s:Dq,S:fXe,u:hXe,U:AXe,V:mXe,w:pXe,W:gXe,x:null,X:null,y:xXe,Y:yXe,Z:wXe,"%":Fq},j={a:B,A:T,b:P,B:O,c:z,d:Pq,e:Pq,f:LWe,g:jq,G:Iq,H:Bq,I:Bq,j:OWe,L:MWe,m:FWe,M:DWe,p:E,q:kWe,Q:QWe,s:VWe,S:RWe,u:IWe,U:jWe,V:PWe,w:SWe,W:BWe,x:ce,X:de,y:jq,Y:Iq,Z:TWe,"%":UWe};b.x=I(r,b),b.X=I(n,b),b.c=I(e,b),w.x=I(r,w),w.X=I(n,w),w.c=I(e,w);function I(Q,ee){return function(ve){var M=[],Ye=-1,ae=0,X=Q.length,De,le,$e;for(ve instanceof Date||(ve=new Date(+ve));++Ye<X;)Q.charCodeAt(Ye)===37&&(M.push(Q.slice(ae,Ye)),(le=Sq[De=Q.charAt(++Ye)])!=null?De=Q.charAt(++Ye):le=De==="e"?" ":"0",($e=ee[De])&&(De=$e(ve,le)),M.push(De),ae=Ye+1);return M.push(Q.slice(ae,Ye)),M.join("")}}function _(Q,ee){return function(ve){var M=Sy(1900,void 0,1),Ye=S(M,Q,ve+="",0),ae,X;if(Ye!=ve.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(ee&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(ae=_B(Sy(M.y,0,1)),X=ae.getUTCDay(),ae=X>4||X===0?UI.ceil(ae):UI(ae),ae=JP.offset(ae,(M.V-1)*7),M.y=ae.getUTCFullYear(),M.m=ae.getUTCMonth(),M.d=ae.getUTCDate()+(M.w+6)%7):(ae=CB(Sy(M.y,0,1)),X=ae.getDay(),ae=X>4||X===0?LI.ceil(ae):LI(ae),ae=aN.offset(ae,(M.V-1)*7),M.y=ae.getFullYear(),M.m=ae.getMonth(),M.d=ae.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),X="Z"in M?_B(Sy(M.y,0,1)).getUTCDay():CB(Sy(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(X+5)%7:M.w+M.U*7-(X+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,_B(M)):CB(M)}}function S(Q,ee,ve,M){for(var Ye=0,ae=ee.length,X=ve.length,De,le;Ye<ae;){if(M>=X)return-1;if(De=ee.charCodeAt(Ye++),De===37){if(De=ee.charAt(Ye++),le=j[De in Sq?ee.charAt(Ye++):De],!le||(M=le(Q,ve,M))<0)return-1}else if(De!=ve.charCodeAt(M++))return-1}return M}function E(Q,ee,ve){var M=u.exec(ee.slice(ve));return M?(Q.p=d.get(M[0].toLowerCase()),ve+M[0].length):-1}function B(Q,ee,ve){var M=h.exec(ee.slice(ve));return M?(Q.w=m.get(M[0].toLowerCase()),ve+M[0].length):-1}function T(Q,ee,ve){var M=f.exec(ee.slice(ve));return M?(Q.w=A.get(M[0].toLowerCase()),ve+M[0].length):-1}function P(Q,ee,ve){var M=v.exec(ee.slice(ve));return M?(Q.m=y.get(M[0].toLowerCase()),ve+M[0].length):-1}function O(Q,ee,ve){var M=p.exec(ee.slice(ve));return M?(Q.m=x.get(M[0].toLowerCase()),ve+M[0].length):-1}function z(Q,ee,ve){return S(Q,e,ee,ve)}function ce(Q,ee,ve){return S(Q,r,ee,ve)}function de(Q,ee,ve){return S(Q,n,ee,ve)}function ue(Q){return o[Q.getDay()]}function me(Q){return s[Q.getDay()]}function se(Q){return c[Q.getMonth()]}function ke(Q){return l[Q.getMonth()]}function Re(Q){return a[+(Q.getHours()>=12)]}function F(Q){return 1+~~(Q.getMonth()/3)}function H(Q){return o[Q.getUTCDay()]}function K(Q){return s[Q.getUTCDay()]}function L(Q){return c[Q.getUTCMonth()]}function W(Q){return l[Q.getUTCMonth()]}function Y(Q){return a[+(Q.getUTCHours()>=12)]}function D(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var ee=I(Q+="",b);return ee.toString=function(){return Q},ee},parse:function(Q){var ee=_(Q+="",!1);return ee.toString=function(){return Q},ee},utcFormat:function(Q){var ee=I(Q+="",w);return ee.toString=function(){return Q},ee},utcParse:function(Q){var ee=_(Q+="",!0);return ee.toString=function(){return Q},ee}}}var Sq={"-":"",_:" ",0:"0"},il=/^\s*\d+/,CWe=/^%/,_We=/[\\^$*+?|[\]().{}]/g;function Ba(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(e)+a:a)}function EWe(t){return t.replace(_We,"\\$&")}function Iy(t){return new RegExp("^(?:"+t.map(EWe).join("|")+")","i")}function jy(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function SWe(t,e,r){var n=il.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function IWe(t,e,r){var n=il.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function jWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function PWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function BWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function Iq(t,e,r){var n=il.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function jq(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function TWe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function kWe(t,e,r){var n=il.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function FWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Pq(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function OWe(t,e,r){var n=il.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Bq(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function DWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function RWe(t,e,r){var n=il.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function MWe(t,e,r){var n=il.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function LWe(t,e,r){var n=il.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function UWe(t,e,r){var n=CWe.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function QWe(t,e,r){var n=il.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function VWe(t,e,r){var n=il.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Tq(t,e){return Ba(t.getDate(),e,2)}function HWe(t,e){return Ba(t.getHours(),e,2)}function $We(t,e){return Ba(t.getHours()%12||12,e,2)}function GWe(t,e){return Ba(1+aN.count(_A(t),t),e,3)}function xle(t,e){return Ba(t.getMilliseconds(),e,3)}function KWe(t,e){return xle(t,e)+"000"}function qWe(t,e){return Ba(t.getMonth()+1,e,2)}function zWe(t,e){return Ba(t.getMinutes(),e,2)}function WWe(t,e){return Ba(t.getSeconds(),e,2)}function XWe(t){var e=t.getDay();return e===0?7:e}function YWe(t,e){return Ba(ZP.count(_A(t)-1,t),e,2)}function vle(t){var e=t.getDay();return e>=4||e===0?Wv(t):Wv.ceil(t)}function JWe(t,e){return t=vle(t),Ba(Wv.count(_A(t),t)+(_A(t).getDay()===4),e,2)}function ZWe(t){return t.getDay()}function eXe(t,e){return Ba(LI.count(_A(t)-1,t),e,2)}function tXe(t,e){return Ba(t.getFullYear()%100,e,2)}function rXe(t,e){return t=vle(t),Ba(t.getFullYear()%100,e,2)}function nXe(t,e){return Ba(t.getFullYear()%1e4,e,4)}function aXe(t,e){var r=t.getDay();return t=r>=4||r===0?Wv(t):Wv.ceil(t),Ba(t.getFullYear()%1e4,e,4)}function sXe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ba(e/60|0,"0",2)+Ba(e%60,"0",2)}function kq(t,e){return Ba(t.getUTCDate(),e,2)}function iXe(t,e){return Ba(t.getUTCHours(),e,2)}function oXe(t,e){return Ba(t.getUTCHours()%12||12,e,2)}function lXe(t,e){return Ba(1+JP.count(EA(t),t),e,3)}function yle(t,e){return Ba(t.getUTCMilliseconds(),e,3)}function cXe(t,e){return yle(t,e)+"000"}function uXe(t,e){return Ba(t.getUTCMonth()+1,e,2)}function dXe(t,e){return Ba(t.getUTCMinutes(),e,2)}function fXe(t,e){return Ba(t.getUTCSeconds(),e,2)}function hXe(t){var e=t.getUTCDay();return e===0?7:e}function AXe(t,e){return Ba(e3.count(EA(t)-1,t),e,2)}function ble(t){var e=t.getUTCDay();return e>=4||e===0?Xv(t):Xv.ceil(t)}function mXe(t,e){return t=ble(t),Ba(Xv.count(EA(t),t)+(EA(t).getUTCDay()===4),e,2)}function pXe(t){return t.getUTCDay()}function gXe(t,e){return Ba(UI.count(EA(t)-1,t),e,2)}function xXe(t,e){return Ba(t.getUTCFullYear()%100,e,2)}function vXe(t,e){return t=ble(t),Ba(t.getUTCFullYear()%100,e,2)}function yXe(t,e){return Ba(t.getUTCFullYear()%1e4,e,4)}function bXe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Xv(t):Xv.ceil(t),Ba(t.getUTCFullYear()%1e4,e,4)}function wXe(){return"+0000"}function Fq(){return"%"}function Oq(t){return+t}function Dq(t){return Math.floor(+t/1e3)}var yx,wle,Nle;NXe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function NXe(t){return yx=NWe(t),wle=yx.format,yx.parse,Nle=yx.utcFormat,yx.utcParse,yx}function CXe(t){return new Date(t)}function _Xe(t){return t instanceof Date?+t:+new Date(+t)}function RM(t,e,r,n,a,s,o,l,c,u){var d=NM(),f=d.invert,A=d.domain,h=u(".%L"),m=u(":%S"),p=u("%I:%M"),x=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),w=u("%Y");function j(I){return(c(I)<I?h:l(I)<I?m:o(I)<I?p:s(I)<I?x:n(I)<I?a(I)<I?v:y:r(I)<I?b:w)(I)}return d.invert=function(I){return new Date(f(I))},d.domain=function(I){return arguments.length?A(Array.from(I,_Xe)):A().map(CXe)},d.ticks=function(I){var _=A();return t(_[0],_[_.length-1],I??10)},d.tickFormat=function(I,_){return _==null?j:u(_)},d.nice=function(I){var _=A();return(!I||typeof I.range!="function")&&(I=e(_[0],_[_.length-1],I??10)),I?A(cle(_,I)):d},d.copy=function(){return nN(d,RM(t,e,r,n,a,s,o,l,c,u))},d}function EXe(){return Vd.apply(RM(bWe,wWe,_A,OM,ZP,aN,kM,BM,Pp,wle).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function SXe(){return Vd.apply(RM(vWe,yWe,EA,DM,e3,JP,FM,TM,Pp,Nle).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function t3(){var t=0,e=1,r,n,a,s,o=Sc,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,r=s(t=+t),n=s(e=+e),a=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(A){var h,m;return arguments.length?([h,m]=A,o=f(h,m),u):[o(0),o(1)]}}return u.range=d(C1),u.rangeRound=d(wM),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(t),n=f(e),a=r===n?0:1/(n-r),u}}function $m(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Cle(){var t=Hm(t3()(Sc));return t.copy=function(){return $m(t,Cle())},QA.apply(t,arguments)}function _le(){var t=EM(t3()).domain([1,10]);return t.copy=function(){return $m(t,_le()).base(t.base())},QA.apply(t,arguments)}function Ele(){var t=SM(t3());return t.copy=function(){return $m(t,Ele()).constant(t.constant())},QA.apply(t,arguments)}function MM(){var t=IM(t3());return t.copy=function(){return $m(t,MM()).exponent(t.exponent())},QA.apply(t,arguments)}function IXe(){return MM.apply(null,arguments).exponent(.5)}function Sle(){var t=[],e=Sc;function r(n){if(n!=null&&!isNaN(n=+n))return e((tN(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(mm),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>hze(t,s/n))},r.copy=function(){return Sle(e).domain(t)},QA.apply(r,arguments)}function r3(){var t=0,e=.5,r=1,n=1,a,s,o,l,c,u=Sc,d,f=!1,A;function h(p){return isNaN(p=+p)?A:(p=.5+((p=+d(p))-s)*(n*p<n*s?l:c),u(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([t,e,r]=p,a=d(t=+t),s=d(e=+e),o=d(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h):[t,e,r]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(u=p,h):u};function m(p){return function(x){var v,y,b;return arguments.length?([v,y,b]=x,u=Uze(p,[v,y,b]),h):[u(0),u(.5),u(1)]}}return h.range=m(C1),h.rangeRound=m(wM),h.unknown=function(p){return arguments.length?(A=p,h):A},function(p){return d=p,a=p(t),s=p(e),o=p(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h}}function Ile(){var t=Hm(r3()(Sc));return t.copy=function(){return $m(t,Ile())},QA.apply(t,arguments)}function jle(){var t=EM(r3()).domain([.1,1,10]);return t.copy=function(){return $m(t,jle()).base(t.base())},QA.apply(t,arguments)}function Ple(){var t=SM(r3());return t.copy=function(){return $m(t,Ple()).constant(t.constant())},QA.apply(t,arguments)}function LM(){var t=IM(r3());return t.copy=function(){return $m(t,LM()).exponent(t.exponent())},QA.apply(t,arguments)}function jXe(){return LM.apply(null,arguments).exponent(.5)}const rb=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:vM,scaleDiverging:Ile,scaleDivergingLog:jle,scaleDivergingPow:LM,scaleDivergingSqrt:jXe,scaleDivergingSymlog:Ple,scaleIdentity:lle,scaleImplicit:rO,scaleLinear:ole,scaleLog:ule,scaleOrdinal:xM,scalePoint:pze,scalePow:jM,scaleQuantile:hle,scaleQuantize:Ale,scaleRadial:fle,scaleSequential:Cle,scaleSequentialLog:_le,scaleSequentialPow:MM,scaleSequentialQuantile:Sle,scaleSequentialSqrt:IXe,scaleSequentialSymlog:Ele,scaleSqrt:cWe,scaleSymlog:dle,scaleThreshold:mle,scaleTime:EXe,scaleUtc:SXe,tickFormat:ile},Symbol.toStringTag,{value:"Module"}));var VA=t=>t.chartData,n3=er([VA],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),Ble=(t,e,r,n)=>n?n3(t):VA(t),PXe=(t,e,r)=>r?n3(t):VA(t);function Tm(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(Ai(e)&&Ai(r))return!0}return!1}function Rq(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function Tle(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,s;if(Ai(r))a=r;else if(typeof r=="function")return;if(Ai(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(Tm(o))return o}}function BXe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Tm(n))return Rq(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,s]=t,o,l;if(a==="auto")e!=null&&(o=Math.min(...e));else if(Cn(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e==null?void 0:e[0]))}catch{}else if(typeof a=="string"&&eK.test(a)){var c=eK.exec(a);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e==null?void 0:e[0];if(s==="auto")e!=null&&(l=Math.max(...e));else if(Cn(s))l=s;else if(typeof s=="function")try{e!=null&&(l=s(e==null?void 0:e[1]))}catch{}else if(typeof s=="string"&&tK.test(s)){var d=tK.exec(s);if(d==null||d[1]==null||e==null)l=void 0;else{var f=+d[1];l=e[1]+f}}else l=e==null?void 0:e[1];var A=[o,l];if(Tm(A))return e==null?A:Rq(A,e,r)}}}var _1=1e9,TXe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},QM,Ks=!0,Md="[DecimalError] ",qp=Md+"Invalid argument: ",UM=Md+"Exponent out of range: ",E1=Math.floor,hp=Math.pow,kXe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Tu,Xo=1e7,js=7,kle=9007199254740991,QI=E1(kle/js),sn={};sn.absoluteValue=sn.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};sn.comparedTo=sn.cmp=function(t){var e,r,n,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(n=s.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};sn.decimalPlaces=sn.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*js;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};sn.dividedBy=sn.div=function(t){return uA(this,new this.constructor(t))};sn.dividedToIntegerBy=sn.idiv=function(t){var e=this,r=e.constructor;return ms(uA(e,new r(t),0,1),r.precision)};sn.equals=sn.eq=function(t){return!this.cmp(t)};sn.exponent=function(){return co(this)};sn.greaterThan=sn.gt=function(t){return this.cmp(t)>0};sn.greaterThanOrEqualTo=sn.gte=function(t){return this.cmp(t)>=0};sn.isInteger=sn.isint=function(){return this.e>this.d.length-2};sn.isNegative=sn.isneg=function(){return this.s<0};sn.isPositive=sn.ispos=function(){return this.s>0};sn.isZero=function(){return this.s===0};sn.lessThan=sn.lt=function(t){return this.cmp(t)<0};sn.lessThanOrEqualTo=sn.lte=function(t){return this.cmp(t)<1};sn.logarithm=sn.log=function(t){var e,r=this,n=r.constructor,a=n.precision,s=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Tu))throw Error(Md+"NaN");if(r.s<1)throw Error(Md+(r.s?"NaN":"-Infinity"));return r.eq(Tu)?new n(0):(Ks=!1,e=uA(ow(r,s),ow(t,s),s),Ks=!0,ms(e,a))};sn.minus=sn.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Dle(e,t):Fle(e,(t.s=-t.s,t))};sn.modulo=sn.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(Md+"NaN");return r.s?(Ks=!1,e=uA(r,t,0,1).times(t),Ks=!0,r.minus(e)):ms(new n(r),a)};sn.naturalExponential=sn.exp=function(){return Ole(this)};sn.naturalLogarithm=sn.ln=function(){return ow(this)};sn.negated=sn.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};sn.plus=sn.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Fle(e,t):Dle(e,(t.s=-t.s,t))};sn.precision=sn.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(qp+t);if(e=co(a)+1,n=a.d.length-1,r=n*js+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};sn.squareRoot=sn.sqrt=function(){var t,e,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Md+"NaN")}for(t=co(l),Ks=!1,a=Math.sqrt(+l),a==0||a==1/0?(e=th(l.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=E1((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(uA(l,s,o+2)).times(.5),th(s.d).slice(0,o)===(e=th(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(ms(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(e!="9999")break;o+=4}return Ks=!0,ms(n,r)};sn.times=sn.mul=function(t){var e,r,n,a,s,o,l,c,u,d=this,f=d.constructor,A=d.d,h=(t=new f(t)).d;if(!d.s||!t.s)return new f(0);for(t.s*=d.s,r=d.e+t.e,c=A.length,u=h.length,c<u&&(s=A,A=h,h=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(e=0,a=c+n;a>n;)l=s[a]+h[n]*A[a-n-1]+e,s[a--]=l%Xo|0,e=l/Xo|0;s[a]=(s[a]+e)%Xo|0}for(;!s[--o];)s.pop();return e?++r:s.shift(),t.d=s,t.e=r,Ks?ms(t,f.precision):t};sn.toDecimalPlaces=sn.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(fh(t,0,_1),e===void 0?e=n.rounding:fh(e,0,8),ms(r,t+co(r)+1,e))};sn.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=Ng(n,!0):(fh(t,0,_1),e===void 0?e=a.rounding:fh(e,0,8),n=ms(new a(n),t+1,e),r=Ng(n,!0,t+1)),r};sn.toFixed=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?Ng(a):(fh(t,0,_1),e===void 0?e=s.rounding:fh(e,0,8),n=ms(new s(a),t+co(a)+1,e),r=Ng(n.abs(),!1,t+co(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};sn.toInteger=sn.toint=function(){var t=this,e=t.constructor;return ms(new e(t),co(t)+1,e.rounding)};sn.toNumber=function(){return+this};sn.toPower=sn.pow=function(t){var e,r,n,a,s,o,l=this,c=l.constructor,u=12,d=+(t=new c(t));if(!t.s)return new c(Tu);if(l=new c(l),!l.s){if(t.s<1)throw Error(Md+"Infinity");return l}if(l.eq(Tu))return l;if(n=c.precision,t.eq(Tu))return ms(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,s=l.s,o){if((r=d<0?-d:d)<=kle){for(a=new c(Tu),e=Math.ceil(n/js+4),Ks=!1;r%2&&(a=a.times(l),Lq(a.d,e)),r=E1(r/2),r!==0;)l=l.times(l),Lq(l.d,e);return Ks=!0,t.s<0?new c(Tu).div(a):ms(a,n)}}else if(s<0)throw Error(Md+"NaN");return s=s<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,Ks=!1,a=t.times(ow(l,n+u)),Ks=!0,a=Ole(a),a.s=s,a};sn.toPrecision=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?(r=co(a),n=Ng(a,r<=s.toExpNeg||r>=s.toExpPos)):(fh(t,1,_1),e===void 0?e=s.rounding:fh(e,0,8),a=ms(new s(a),t,e),r=co(a),n=Ng(a,t<=r||r<=s.toExpNeg,t)),n};sn.toSignificantDigits=sn.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(fh(t,1,_1),e===void 0?e=n.rounding:fh(e,0,8)),ms(new n(r),t,e)};sn.toString=sn.valueOf=sn.val=sn.toJSON=sn[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=co(t),r=t.constructor;return Ng(t,e<=r.toExpNeg||e>=r.toExpPos)};function Fle(t,e){var r,n,a,s,o,l,c,u,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),Ks?ms(e,f):e;if(c=t.d,u=e.d,o=t.e,a=e.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,a=o,l=c.length),o=Math.ceil(f/js),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Xo|0,c[s]%=Xo;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=a,Ks?ms(e,f):e}function fh(t,e,r){if(t!==~~t||t<e||t>r)throw Error(qp+t)}function th(t){var e,r,n,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,e=1;e<a;e++)n=t[e]+"",r=js-n.length,r&&(s+=j0(r)),s+=n;o=t[e],n=o+"",r=js-n.length,r&&(s+=j0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var uA=function(){function t(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%Xo|0,o=s/Xo|0;return o&&n.unshift(o),n}function e(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*Xo+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,_,S,E=n.constructor,B=n.s==a.s?1:-1,T=n.d,P=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(Md+"Division by zero");for(c=n.e-a.e,_=P.length,j=T.length,h=new E(B),m=h.d=[],u=0;P[u]==(T[u]||0);)++u;if(P[u]>(T[u]||0)&&--c,s==null?y=s=E.precision:o?y=s+(co(n)-co(a))+1:y=s,y<0)return new E(0);if(y=y/js+2|0,u=0,_==1)for(d=0,P=P[0],y++;(u<j||d)&&y--;u++)b=d*Xo+(T[u]||0),m[u]=b/P|0,d=b%P|0;else{for(d=Xo/(P[0]+1)|0,d>1&&(P=t(P,d),T=t(T,d),_=P.length,j=T.length),w=_,p=T.slice(0,_),x=p.length;x<_;)p[x++]=0;S=P.slice(),S.unshift(0),I=P[0],P[1]>=Xo/2&&++I;do d=0,l=e(P,p,_,x),l<0?(v=p[0],_!=x&&(v=v*Xo+(p[1]||0)),d=v/I|0,d>1?(d>=Xo&&(d=Xo-1),f=t(P,d),A=f.length,x=p.length,l=e(f,p,A,x),l==1&&(d--,r(f,_<A?S:P,A))):(d==0&&(l=d=1),f=P.slice()),A=f.length,A<x&&f.unshift(0),r(p,f,x),l==-1&&(x=p.length,l=e(P,p,_,x),l<1&&(d++,r(p,_<x?S:P,x))),x=p.length):l===0&&(d++,p=[0]),m[u++]=d,l&&p[0]?p[x++]=T[w]||0:(p=[T[w]],x=1);while((w++<j||p[0]!==void 0)&&y--)}return m[0]||m.shift(),h.e=c,ms(h,o?s+co(h)+1:s)}}();function Ole(t,e){var r,n,a,s,o,l,c=0,u=0,d=t.constructor,f=d.precision;if(co(t)>16)throw Error(UM+co(t));if(!t.s)return new d(Tu);for(Ks=!1,l=f,o=new d(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(hp(2,u))/Math.LN10*2+5|0,l+=n,r=a=s=new d(Tu),d.precision=l;;){if(a=ms(a.times(t),l),r=r.times(++c),o=s.plus(uA(a,r,l)),th(o.d).slice(0,l)===th(s.d).slice(0,l)){for(;u--;)s=ms(s.times(s),l);return d.precision=f,e==null?(Ks=!0,ms(s,f)):s}s=o}}function co(t){for(var e=t.e*js,r=t.d[0];r>=10;r/=10)e++;return e}function EB(t,e,r){if(e>t.LN10.sd())throw Ks=!0,r&&(t.precision=r),Error(Md+"LN10 precision limit exceeded");return ms(new t(t.LN10),e)}function j0(t){for(var e="";t--;)e+="0";return e}function ow(t,e){var r,n,a,s,o,l,c,u,d,f=1,A=10,h=t,m=h.d,p=h.constructor,x=p.precision;if(h.s<1)throw Error(Md+(h.s?"NaN":"-Infinity"));if(h.eq(Tu))return new p(0);if(e==null?(Ks=!1,u=x):u=e,h.eq(10))return e==null&&(Ks=!0),EB(p,u);if(u+=A,p.precision=u,r=th(m),n=r.charAt(0),s=co(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(t),r=th(h.d),n=r.charAt(0),f++;s=co(h),n>1?(h=new p("0."+r),s++):h=new p(n+"."+r.slice(1))}else return c=EB(p,u+2,x).times(s+""),h=ow(new p(n+"."+r.slice(1)),u-A).plus(c),p.precision=x,e==null?(Ks=!0,ms(h,x)):h;for(l=o=h=uA(h.minus(Tu),h.plus(Tu),u),d=ms(h.times(h),u),a=3;;){if(o=ms(o.times(d),u),c=l.plus(uA(o,new p(a),u)),th(c.d).slice(0,u)===th(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(EB(p,u+2,x).times(s+""))),l=uA(l,new p(f),u),p.precision=x,e==null?(Ks=!0,ms(l,x)):l;l=c,a+=2}}function Mq(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=E1(r/js),t.d=[],n=(r+1)%js,r<0&&(n+=js),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=js;n<a;)t.d.push(+e.slice(n,n+=js));e=e.slice(n),n=js-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),Ks&&(t.e>QI||t.e<-QI))throw Error(UM+r)}else t.s=0,t.e=0,t.d=[0];return t}function ms(t,e,r){var n,a,s,o,l,c,u,d,f=t.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=e-o,n<0)n+=js,a=e,u=f[d=0];else{if(d=Math.ceil((n+1)/js),s=f.length,d>=s)return t;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=js,a=n-js+o}if(r!==void 0&&(s=hp(10,o-a-1),l=u/s%10|0,c=e<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/hp(10,o-a):0:f[d-1])%10&1||r==(t.s<0?8:7))),e<1||!f[0])return c?(s=co(t),f.length=1,e=e-s-1,f[0]=hp(10,(js-e%js)%js),t.e=E1(-e/js)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=hp(10,js-n),f[d]=a>0?(u/hp(10,o-a)%hp(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Xo&&(f[0]=1,++t.e);break}else{if(f[d]+=s,f[d]!=Xo)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(Ks&&(t.e>QI||t.e<-QI))throw Error(UM+co(t));return t}function Dle(t,e){var r,n,a,s,o,l,c,u,d,f,A=t.constructor,h=A.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new A(t),Ks?ms(e,h):e;if(c=t.d,f=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(h/js),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}o=0}for(d&&(r=c,c=f,f=r,e.s=-e.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Xo-1;--c[s],c[a]+=Xo}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Ks?ms(e,h):e):new A(0)}function Ng(t,e,r){var n,a=co(t),s=th(t.d),o=s.length;return e?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+j0(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+j0(-a-1)+s,r&&(n=r-o)>0&&(s+=j0(n))):a>=o?(s+=j0(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+j0(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=j0(n))),t.s<0?"-"+s:s}function Lq(t,e){if(t.length>e)return t.length=e,!0}function Rle(t){var e,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(qp+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Mq(o,s.toString())}else if(typeof s!="string")throw Error(qp+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,kXe.test(s))Mq(o,s);else throw Error(qp+s)}if(a.prototype=sn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Rle,a.config=a.set=FXe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function FXe(t){if(!t||typeof t!="object")throw Error(Md+"Object expected");var e,r,n,a=["precision",1,_1,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(E1(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(qp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(qp+r+": "+n);return this}var QM=Rle(TXe);Tu=new QM(1);const Za=QM;var OXe=t=>t,Mle={},Lle=t=>t===Mle,Uq=t=>function e(){return arguments.length===0||arguments.length===1&&Lle(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},Ule=(t,e)=>t===1?e:Uq(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(o=>o!==Mle).length;return s>=t?e(...n):Ule(t-s,Uq(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=n.map(d=>Lle(d)?l.shift():d);return e(...u,...l)}))}),DXe=t=>Ule(t.length,t),iO=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},RXe=DXe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),MXe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return OXe;var a=r.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}};function Qle(t){var e;return t===0?e=1:e=Math.floor(new Za(t).abs().log(10).toNumber())+1,e}function Vle(t,e,r){for(var n=new Za(t),a=0,s=[];n.lt(e)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var Hle=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},$le=(t,e,r)=>{if(t.lte(0))return new Za(0);var n=Qle(t.toNumber()),a=new Za(10).pow(n),s=t.div(a),o=n!==1?.05:.1,l=new Za(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return e?new Za(c.toNumber()):new Za(Math.ceil(c.toNumber()))},LXe=(t,e,r)=>{var n=new Za(1),a=new Za(t);if(!a.isint()&&r){var s=Math.abs(t);s<1?(n=new Za(10).pow(Qle(t)-1),a=new Za(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new Za(Math.floor(t)))}else t===0?a=new Za(Math.floor((e-1)/2)):r||(a=new Za(Math.floor(t)));var o=Math.floor((e-1)/2),l=MXe(RXe(c=>a.add(new Za(c-o).mul(n)).toNumber()),iO);return l(0,e)},Gle=function(e,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new Za(0),tickMin:new Za(0),tickMax:new Za(0)};var o=$le(new Za(r).sub(e).div(n-1),a,s),l;e<=0&&r>=0?l=new Za(0):(l=new Za(e).add(r).div(2),l=l.sub(new Za(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new Za(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?Gle(e,r,n,a,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new Za(c).mul(o)),tickMax:l.add(new Za(u).mul(o))})},UXe=function(e){var[r,n]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=Hle([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...iO(0,a-1).map(()=>1/0)]:[...iO(0,a-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(l===c)return LXe(l,a,s);var{step:d,tickMin:f,tickMax:A}=Gle(l,c,o,s,0),h=Vle(f,A.add(new Za(.1).mul(d)),d);return r>n?h.reverse():h},QXe=function(e,r){var[n,a]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=Hle([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),u=$le(new Za(l).sub(o).div(c-1),s,0),d=[...Vle(new Za(o),new Za(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},Kle=t=>t.rootProps.maxBarSize,VXe=t=>t.rootProps.barGap,qle=t=>t.rootProps.barCategoryGap,HXe=t=>t.rootProps.barSize,sN=t=>t.rootProps.stackOffset,zle=t=>t.rootProps.reverseStackOrder,VM=t=>t.options.chartName,HM=t=>t.rootProps.syncId,Wle=t=>t.rootProps.syncMethod,$M=t=>t.options.eventEmitter,ac={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Vh={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Su={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},a3=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},$Xe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Vh.angleAxisId,includeHidden:!1,name:void 0,reversed:Vh.reversed,scale:Vh.scale,tick:Vh.tick,tickCount:void 0,ticks:void 0,type:Vh.type,unit:void 0},GXe={allowDataOverflow:Su.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Su.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Su.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Su.scale,tick:Su.tick,tickCount:Su.tickCount,ticks:void 0,type:Su.type,unit:void 0},KXe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Vh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Vh.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Vh.scale,tick:Vh.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},qXe={allowDataOverflow:Su.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Su.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Su.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Su.scale,tick:Su.tick,tickCount:Su.tickCount,ticks:void 0,type:"category",unit:void 0},GM=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?KXe:$Xe,KM=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?qXe:GXe,s3=t=>t.polarOptions,qM=er([LA,UA,Ro],$oe),Xle=er([s3,qM],(t,e)=>{if(t!=null)return ic(t.innerRadius,e,0)}),Yle=er([s3,qM],(t,e)=>{if(t!=null)return ic(t.outerRadius,e,e*.8)}),zXe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},Jle=er([s3],zXe);er([GM,Jle],a3);var Zle=er([qM,Xle,Yle],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});er([KM,Zle],a3);var ece=er([Ta,s3,Xle,Yle,LA,UA],(t,e,r,n,a,s)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:ic(o,a,a/2),cy:ic(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Xs=(t,e)=>e,iN=(t,e,r)=>r;function zM(t){return t==null?void 0:t.id}function tce(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=zM(l);u.forEach((f,A)=>{var h=s==null||a?A:String(ks(f,s,null)),m=ks(f,l.dataKey,0),p;o.has(h)?p=o.get(h):p={},Object.assign(p,{[d]:m}),o.set(h,p)})}}),Array.from(o.values())}function i3(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var o3=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function l3(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function WXe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Lo=t=>{var e=Ta(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},S1=t=>t.tooltip.settings.axisId;function Qq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function VI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qq(Object(r),!0).forEach(function(n){XXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XXe(t,e,r){return(e=YXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YXe(t){var e=JXe(t,"string");return typeof e=="symbol"?e:e+""}function JXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oO=[0,"auto"],Go={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},rce=(t,e)=>t.cartesianAxis.xAxis[e],HA=(t,e)=>{var r=rce(t,e);return r??Go},Ko={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:oO,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Jw},nce=(t,e)=>t.cartesianAxis.yAxis[e],$A=(t,e)=>{var r=nce(t,e);return r??Ko},ZXe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},WM=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??ZXe},mi=(t,e,r)=>{switch(e){case"xAxis":return HA(t,r);case"yAxis":return $A(t,r);case"zAxis":return WM(t,r);case"angleAxis":return GM(t,r);case"radiusAxis":return KM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},eYe=(t,e,r)=>{switch(e){case"xAxis":return HA(t,r);case"yAxis":return $A(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},oN=(t,e,r)=>{switch(e){case"xAxis":return HA(t,r);case"yAxis":return $A(t,r);case"angleAxis":return GM(t,r);case"radiusAxis":return KM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},ace=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function XM(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var YM=t=>t.graphicalItems.cartesianItems,tYe=er([Xs,iN],XM),JM=(t,e,r)=>t.filter(r).filter(n=>(e==null?void 0:e.includeHidden)===!0?!0:!n.hide),lN=er([YM,mi,tYe],JM,{memoizeOptions:{resultEqualityCheck:l3}}),sce=er([lN],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(i3)),ice=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),rYe=er([lN],ice),ZM=t=>t.map(e=>e.data).filter(Boolean).flat(1),nYe=er([lN],ZM,{memoizeOptions:{resultEqualityCheck:l3}}),e8=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},t8=er([nYe,Ble],e8),r8=(t,e,r)=>(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:ks(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:ks(a,n)}))):t.map(n=>({value:n})),c3=er([t8,mi,lN],r8);function oce(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function CE(t){if(dh(t)||t instanceof Date){var e=Number(t);if(Ai(e))return e}}function Vq(t){if(Array.isArray(t)){var e=[CE(t[0]),CE(t[1])];return Tm(e)?e:void 0}var r=CE(t);if(r!=null)return[r,r]}function SA(t){return t.map(CE).filter(fHe)}function aYe(t,e,r){return!r||typeof e!="number"||uh(e)?[]:r.length?SA(r.flatMap(n=>{var a=ks(t,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!Ai(s)||!Ai(o)))return[e-s,e+o]})):[]}var Uo=t=>{var e=Lo(t),r=S1(t);return oN(t,e,r)},cN=er([Uo],t=>t==null?void 0:t.dataKey),sYe=er([sce,Ble,Uo],tce),lce=(t,e,r,n)=>{var a={},s=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(zM);return[l,{stackedData:PGe(t,d,r),graphicalItems:u}]}))},lO=er([sYe,sce,sN,zle],lce),cce=(t,e,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=e;if(n==null&&r!=="zAxis"){var o=OGe(t,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},iYe=er([mi],t=>t.allowDataOverflow),n8=t=>{var e;if(t==null||!("domain"in t))return oO;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=SA(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:oO},a8=er([mi],n8),s8=er([a8,iYe],Tle),oYe=er([lO,VA,Xs,s8],cce,{memoizeOptions:{resultEqualityCheck:o3}}),u3=t=>t.errorBars,lYe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>oce(r,n)),HI=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},i8=(t,e,r,n,a)=>{var s,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(v=>oce(a,v)),A=ks(l,(d=e.dataKey)!==null&&d!==void 0?d:c.dataKey),h=aYe(l,A,f);if(h.length>=2){var m=Math.min(...h),p=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||p>o)&&(o=p)}var x=Vq(A);x!=null&&(s=s==null?x[0]:Math.min(s,x[0]),o=o==null?x[1]:Math.max(o,x[1]))})}),(e==null?void 0:e.dataKey)!=null&&t.forEach(l=>{var c=Vq(ks(l,e.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Ai(s)&&Ai(o))return[s,o]},cYe=er([t8,mi,rYe,u3,Xs],i8,{memoizeOptions:{resultEqualityCheck:o3}});function uYe(t){var{value:e}=t;if(dh(e)||e instanceof Date)return e}var dYe=(t,e,r)=>{var n=t.map(uYe).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&oie(n))?Yoe(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},uce=t=>t.referenceElements.dots,I1=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),fYe=er([uce,Xs,iN],I1),dce=t=>t.referenceElements.areas,hYe=er([dce,Xs,iN],I1),fce=t=>t.referenceElements.lines,AYe=er([fce,Xs,iN],I1),hce=(t,e)=>{if(t!=null){var r=SA(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},mYe=er(fYe,Xs,hce),Ace=(t,e)=>{if(t!=null){var r=SA(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},pYe=er([hYe,Xs],Ace);function gYe(t){var e;if(t.x!=null)return SA([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:SA(r)}function xYe(t){var e;if(t.y!=null)return SA([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:SA(r)}var mce=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?gYe(n):xYe(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},vYe=er([AYe,Xs],mce),yYe=er(mYe,vYe,pYe,(t,e,r)=>HI(t,r,e)),o8=(t,e,r,n,a,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?HI(n,s,a):HI(s,a);return BXe(e,u,t.allowDataOverflow)},bYe=er([mi,a8,s8,oYe,cYe,yYe,Ta,Xs],o8,{memoizeOptions:{resultEqualityCheck:o3}}),wYe=[0,1],l8=(t,e,r,n,a,s,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=Hg(e,s);if(u&&l==null){var d;return Yoe(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?dYe(n,t,u):a==="expand"?wYe:o}},c8=er([mi,Ta,t8,c3,sN,Xs,bYe],l8),pce=(t,e,r,n,a)=>{if(t!=null){var{scale:s,type:o}=t;if(s==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(qw(s));return l in rb?l:"point"}}},j1=er([mi,Ta,ace,VM,Xs],pce);function NYe(t){if(t!=null){if(t in rb)return rb[t]();var e="scale".concat(qw(t));if(e in rb)return rb[e]()}}function u8(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=NYe(e);if(a!=null){var s=a.domain(r).range(n);return _Ge(s),s}}}var d8=(t,e,r)=>{var n=n8(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Tm(t))return UXe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Tm(t))return QXe(t,e.tickCount,e.allowDecimals)}},f8=er([c8,oN,j1],d8),h8=(t,e,r,n)=>{if(n!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&Tm(e)&&Array.isArray(r)&&r.length>0){var a=e[0],s=r[0],o=e[1],l=r[r.length-1];return[Math.min(a,s),Math.max(o,l)]}return e},CYe=er([mi,c8,f8,Xs],h8),_Ye=er(c3,mi,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(SA(t.map(f=>f.value))).sort((f,A)=>f-A),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),gce=er(_Ye,Ta,qle,Ro,(t,e,r,n,a)=>a,(t,e,r,n,a)=>{if(!Ai(t))return 0;var s=e==="vertical"?n.height:n.width;if(a==="gap")return t*s/2;if(a==="no-gap"){var o=ic(r,t*s),l=t*s/2;return l-o-(l-o)/s*o}return 0}),EYe=(t,e,r)=>{var n=HA(t,e);return n==null||typeof n.padding!="string"?0:gce(t,"xAxis",e,r,n.padding)},SYe=(t,e,r)=>{var n=$A(t,e);return n==null||typeof n.padding!="string"?0:gce(t,"yAxis",e,r,n.padding)},IYe=er(HA,EYe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),jYe=er($A,SYe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),PYe=er([Ro,IYe,VP,QP,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[t.left+e.left,t.left+t.width-e.right]}),BYe=er([Ro,Ta,jYe,VP,QP,(t,e,r)=>r],(t,e,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),uN=(t,e,r,n)=>{var a;switch(e){case"xAxis":return PYe(t,r,n);case"yAxis":return BYe(t,r,n);case"zAxis":return(a=WM(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return Jle(t);case"radiusAxis":return Zle(t,r);default:return}},xce=er([mi,uN],a3),d3=er([mi,j1,CYe,xce],u8);er([lN,u3,Xs],lYe);function vce(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var f3=(t,e)=>e,h3=(t,e,r)=>r,TYe=er(LP,f3,h3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(vce)),kYe=er(UP,f3,h3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(vce)),yce=(t,e)=>({width:t.width,height:e.height}),FYe=(t,e)=>{var r=typeof e.width=="number"?e.width:Jw;return{width:r,height:t.height}},bce=er(Ro,HA,yce),OYe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},DYe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},RYe=er(UA,Ro,TYe,f3,h3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=yce(e,l);o==null&&(o=OYe(e,n,t));var u=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),MYe=er(LA,Ro,kYe,f3,h3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=FYe(e,l);o==null&&(o=DYe(e,n,t));var u=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),LYe=(t,e)=>{var r=HA(t,e);if(r!=null)return RYe(t,r.orientation,r.mirror)},UYe=er([Ro,HA,LYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),QYe=(t,e)=>{var r=$A(t,e);if(r!=null)return MYe(t,r.orientation,r.mirror)},VYe=er([Ro,$A,QYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),wce=er(Ro,$A,(t,e)=>{var r=typeof e.width=="number"?e.width:Jw;return{width:r,height:t.height}}),Hq=(t,e,r)=>{switch(e){case"xAxis":return bce(t,r).width;case"yAxis":return wce(t,r).height;default:return}},Nce=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=Hg(t,n),c=e.map(u=>u.value);if(o&&l&&s==="category"&&a&&oie(c))return c}},A8=er([Ta,c3,mi,Xs],Nce),Cce=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=Hg(t,n);if(o&&(a==="number"||s!=="auto"))return e.map(l=>l.value)}},m8=er([Ta,c3,oN,Xs],Cce);er([Ta,eYe,j1,d3,A8,m8,uN,f8,Xs],(t,e,r,n,a,s,o,l,c)=>{if(e!=null){var u=Hg(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var HYe=(t,e,r,n,a,s,o,l,c)=>{if(!(e==null||n==null)){var u=Hg(t,c),{type:d,ticks:f,tickCount:A}=e,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Pl(s[0]-s[1])*2*m:m;var p=f||a;if(p){var x=p.map((v,y)=>{var b=o?o.indexOf(v):v;return{index:y,coordinate:n(b)+m,value:v,offset:m}});return x.filter(v=>Ai(v.coordinate))}return u&&l?l.map((v,y)=>({coordinate:n(v)+m,value:v,index:y,offset:m})).filter(v=>Ai(v.coordinate)):n.ticks?n.ticks(A).map(v=>({coordinate:n(v)+m,value:v,offset:m})):n.domain().map((v,y)=>({coordinate:n(v)+m,value:o?o[v]:v,index:y,offset:m}))}},_ce=er([Ta,oN,j1,d3,f8,uN,A8,m8,Xs],HYe),$Ye=(t,e,r,n,a,s,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=Hg(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Pl(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},Yv=er([Ta,oN,d3,uN,A8,m8,Xs],$Ye),Jv=er(mi,d3,(t,e)=>{if(!(t==null||e==null))return VI(VI({},t),{},{scale:e})}),GYe=er([mi,j1,c8,xce],u8);er((t,e,r)=>WM(t,r),GYe,(t,e)=>{if(!(t==null||e==null))return VI(VI({},t),{},{scale:e})});var KYe=er([Ta,LP,UP],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Ece=t=>t.options.defaultTooltipEventType,Sce=t=>t.options.validateTooltipEventTypes;function Ice(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function p8(t,e){var r=Ece(t),n=Sce(t);return Ice(e,r,n)}function qYe(t){return pn(e=>p8(e,t))}var jce=(t,e)=>{var r,n=Number(e);if(!(uh(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},zYe=t=>t.tooltip.settings,Q0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},WYe={itemInteraction:{click:Q0,hover:Q0},axisInteraction:{click:Q0,hover:Q0},keyboardInteraction:Q0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Pce=uu({name:"tooltip",initialState:WYe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:Ls()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,a=vf(t).tooltipItemPayloads.indexOf(r);a>-1&&(t.tooltipItemPayloads[a]=n)},prepare:Ls()},removeTooltipEntrySettings:{reducer(t,e){var r=vf(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Ls()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:XYe,replaceTooltipEntrySettings:YYe,removeTooltipEntrySettings:JYe,setTooltipSettingsState:ZYe,setActiveMouseOverItemIndex:Bce,mouseLeaveItem:eJe,mouseLeaveChart:Tce,setActiveClickItemIndex:tJe,setMouseOverAxisIndex:kce,setMouseClickAxisIndex:rJe,setSyncInteraction:cO,setKeyboardInteraction:uO}=Pce.actions,nJe=Pce.reducer;function $q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function I_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$q(Object(r),!0).forEach(function(n){aJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$q(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aJe(t,e,r){return(e=sJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sJe(t){var e=iJe(t,"string");return typeof e=="symbol"?e:e+""}function iJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oJe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function lJe(t){return t.index!=null}var Fce=(t,e,r,n)=>{if(e==null)return Q0;var a=oJe(t,e,r);if(a==null)return Q0;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var s=t.settings.active===!0;if(lJe(a)){if(s)return I_(I_({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return I_(I_({},Q0),{},{coordinate:a.coordinate})};function cJe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function uJe(t,e){var r=cJe(t),n=e[0],a=e[1];if(r===void 0)return!1;var s=Math.min(n,a),o=Math.max(n,a);return r>=s&&r<=o}function dJe(t,e,r){if(r==null||e==null)return!0;var n=ks(t,e);return n==null||!Tm(r)?!0:uJe(n,r)}var g8=(t,e,r,n)=>{var a=t==null?void 0:t.index;if(a==null)return null;var s=Number(a);if(!Ai(s))return a;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(s,l)),u=e[c];return u==null||dJe(u,r,n)?String(c):null},Oce=(t,e,r,n,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,s);if(u!=null)return u;var d=a==null?void 0:a[Number(s)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:d.coordinate}}}},Dce=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=t.itemInteraction.hover.graphicalItemId:a=t.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=t.tooltipItemPayloads[0];return s!=null?[s]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},dN=t=>t.options.tooltipPayloadSearcher,P1=t=>t.tooltip;function Gq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Kq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gq(Object(r),!0).forEach(function(n){fJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fJe(t,e,r){return(e=hJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hJe(t){var e=AJe(t,"string");return typeof e=="symbol"?e:e+""}function AJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mJe(t,e){return t??e}var Rce=(t,e,r,n,a,s,o)=>{if(!(e==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return t.reduce((A,h)=>{var m,{dataDefinedOnItem:p,settings:x}=h,v=mJe(p,l),y=Array.isArray(v)?moe(v,u,d):v,b=(m=x==null?void 0:x.dataKey)!==null&&m!==void 0?m:n,w=x==null?void 0:x.nameKey,j;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?j=dHe(y,n,a):j=s(y,e,c,w),Array.isArray(j))j.forEach(_=>{var S=Kq(Kq({},x),{},{name:_.name,unit:_.unit,color:void 0,fill:void 0});A.push(rK({tooltipEntrySettings:S,dataKey:_.dataKey,payload:_.payload,value:ks(_.payload,_.dataKey),name:_.name}))});else{var I;A.push(rK({tooltipEntrySettings:x,dataKey:b,payload:j,value:ks(j,b),name:(I=ks(j,w))!==null&&I!==void 0?I:x==null?void 0:x.name}))}return A},f)}},x8=er([Uo,Ta,ace,VM,Lo],pce),pJe=er([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),gJe=er([Lo,S1],XM),B1=er([pJe,Uo,gJe],JM,{memoizeOptions:{resultEqualityCheck:l3}}),xJe=er([B1],t=>t.filter(i3)),vJe=er([B1],ZM,{memoizeOptions:{resultEqualityCheck:l3}}),T1=er([vJe,VA],e8),yJe=er([xJe,VA,Uo],tce),v8=er([T1,Uo,B1],r8),Mce=er([Uo],n8),bJe=er([Uo],t=>t.allowDataOverflow),Lce=er([Mce,bJe],Tle),wJe=er([B1],t=>t.filter(i3)),NJe=er([yJe,wJe,sN,zle],lce),CJe=er([NJe,VA,Lo,Lce],cce),_Je=er([B1],ice),EJe=er([T1,Uo,_Je,u3,Lo],i8,{memoizeOptions:{resultEqualityCheck:o3}}),SJe=er([uce,Lo,S1],I1),IJe=er([SJe,Lo],hce),jJe=er([dce,Lo,S1],I1),PJe=er([jJe,Lo],Ace),BJe=er([fce,Lo,S1],I1),TJe=er([BJe,Lo],mce),kJe=er([IJe,TJe,PJe],HI),FJe=er([Uo,Mce,Lce,CJe,EJe,kJe,Ta,Lo],o8),fN=er([Uo,Ta,T1,v8,sN,Lo,FJe],l8),OJe=er([fN,Uo,x8],d8),DJe=er([Uo,fN,OJe,Lo],h8),Uce=t=>{var e=Lo(t),r=S1(t),n=!1;return uN(t,e,r,n)},Qce=er([Uo,Uce],a3),Vce=er([Uo,x8,DJe,Qce],u8),RJe=er([Ta,v8,Uo,Lo],Nce),MJe=er([Ta,v8,Uo,Lo],Cce),LJe=(t,e,r,n,a,s,o,l)=>{if(e){var{type:c}=e,u=Hg(t,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Pl(a[0]-a[1])*2*f:f,u&&o?o.map((A,h)=>({coordinate:n(A)+f,value:A,index:h,offset:f})):n.domain().map((A,h)=>({coordinate:n(A)+f,value:s?s[A]:A,index:h,offset:f}))}}},GA=er([Ta,Uo,x8,Vce,Uce,RJe,MJe,Lo],LJe),y8=er([Ece,Sce,zYe],(t,e,r)=>Ice(r.shared,t,e)),Hce=t=>t.tooltip.settings.trigger,b8=t=>t.tooltip.settings.defaultIndex,hN=er([P1,y8,Hce,b8],Fce),Cg=er([hN,T1,cN,fN],g8),$ce=er([GA,Cg],jce),w8=er([hN],t=>{if(t)return t.dataKey}),UJe=er([hN],t=>{if(t)return t.graphicalItemId}),Gce=er([P1,y8,Hce,b8],Dce),QJe=er([LA,UA,Ta,Ro,GA,b8,Gce,dN],Oce),VJe=er([hN,QJe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),HJe=er([hN],t=>{var e;return(e=t==null?void 0:t.active)!==null&&e!==void 0?e:!1}),$Je=er([Gce,Cg,VA,cN,$ce,dN,y8],Rce);er([$Je],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function qq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qq(Object(r),!0).forEach(function(n){GJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function GJe(t,e,r){return(e=KJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KJe(t){var e=qJe(t,"string");return typeof e=="symbol"?e:e+""}function qJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zJe=()=>pn(Uo),WJe=()=>{var t=zJe(),e=pn(GA),r=pn(Vce);return wI(!t||!r?void 0:zq(zq({},t),{},{scale:r}),e)};function Wq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wq(Object(r),!0).forEach(function(n){XJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XJe(t,e,r){return(e=YJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YJe(t){var e=JJe(t,"string");return typeof e=="symbol"?e:e+""}function JJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZJe=(t,e,r,n)=>{var a=e.find(s=>s&&s.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},eZe=(t,e,r,n)=>{var a=e.find(u=>u&&u.index===r);if(a){if(t==="centric"){var s=a.coordinate,{radius:o}=n;return bx(bx(bx({},n),lo(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return bx(bx(bx({},n),lo(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function tZe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var Kce=(t,e,r,n,a)=>{var s,o=(s=e==null?void 0:e.length)!==null&&s!==void 0?s:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,A,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,p=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(A=r[l+1])===null||A===void 0?void 0:A.coordinate,x=void 0;if(!(h==null||m==null||p==null))if(Pl(m-h)!==Pl(p-m)){var v=[];if(Pl(p-m)===Pl(a[1]-a[0])){x=p;var y=m+a[1]-a[0];v[0]=Math.min(y,(y+h)/2),v[1]=Math.max(y,(y+h)/2)}else{x=h;var b=p+a[1]-a[0];v[0]=Math.min(m,(b+m)/2),v[1]=Math.max(m,(b+m)/2)}var w=[Math.min(m,(x+m)/2),Math.max(m,(x+m)/2)];if(t>w[0]&&t<=w[1]||t>=v[0]&&t<=v[1]){var j;return(j=r[l])===null||j===void 0?void 0:j.index}}else{var I=Math.min(h,p),_=Math.max(h,p);if(t>(I+m)/2&&t<=(_+m)/2){var S;return(S=r[l])===null||S===void 0?void 0:S.index}}}else if(e)for(var E=0;E<o;E++){var B=e[E];if(B!=null){var T=e[E+1],P=e[E-1];if(E===0&&T!=null&&t<=(B.coordinate+T.coordinate)/2||E===o-1&&P!=null&&t>(B.coordinate+P.coordinate)/2||E>0&&E<o-1&&P!=null&&T!=null&&t>(B.coordinate+P.coordinate)/2&&t<=(B.coordinate+T.coordinate)/2)return B.index}}return-1},rZe=()=>pn(VM),N8=(t,e)=>e,qce=(t,e,r)=>r,C8=(t,e,r,n)=>n,nZe=er(GA,t=>IP(t,e=>e.coordinate)),_8=er([P1,N8,qce,C8],Fce),E8=er([_8,T1,cN,fN],g8),aZe=(t,e,r)=>{if(e!=null){var n=P1(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},zce=er([P1,N8,qce,C8],Dce),$I=er([LA,UA,Ta,Ro,GA,C8,zce,dN],Oce),sZe=er([_8,$I],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),Wce=er([GA,E8],jce),iZe=er([zce,E8,VA,cN,Wce,dN,N8],Rce),oZe=er([_8,E8],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),lZe=(t,e,r,n,a,s,o)=>{if(!(!t||!r||!n||!a)&&tZe(t,o)){var l=DGe(t,e),c=Kce(l,s,a,r,n),u=ZJe(e,a,c,t);return{activeIndex:String(c),activeCoordinate:u}}},cZe=(t,e,r,n,a,s,o)=>{if(!(!t||!n||!a||!s||!r)){var l=Xqe(t,r);if(l){var c=RGe(l,e),u=Kce(c,o,s,n,a),d=eZe(e,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},uZe=(t,e,r,n,a,s,o,l)=>{if(!(!t||!e||!n||!a||!s))return e==="horizontal"||e==="vertical"?lZe(t,e,n,a,s,o,l):cZe(t,e,r,n,a,s,o)},dZe=er(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),fZe=er(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(ac)),r=Array.from(new Set(e));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:WXe}});function Xq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Yq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xq(Object(r),!0).forEach(function(n){hZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hZe(t,e,r){return(e=AZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AZe(t){var e=mZe(t,"string");return typeof e=="symbol"?e:e+""}function mZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pZe={},gZe={zIndexMap:Object.values(ac).reduce((t,e)=>Yq(Yq({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),pZe)},xZe=new Set(Object.values(ac));function vZe(t){return xZe.has(t)}var Xce=uu({name:"zIndex",initialState:gZe,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Ls()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!vZe(r)&&delete t.zIndexMap[r])},prepare:Ls()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:a}=e.payload;t.zIndexMap[r]?a?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Ls()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:Ls()}}}),{registerZIndexPortal:yZe,unregisterZIndexPortal:bZe,registerZIndexPortalElement:wZe,unregisterZIndexPortalElement:NZe}=Xce.actions,CZe=Xce.reducer;function vh(t){var{zIndex:e,children:r}=t,n=dKe(),a=n&&e!==void 0&&e!==0,s=qu(),o=Cs();g.useLayoutEffect(()=>a?(o(yZe({zIndex:e})),()=>{o(bZe({zIndex:e}))}):zw,[o,e,a]);var l=pn(c=>dZe(c,e,s));return a?l?Mu.createPortal(r,l):null:r}function dO(){return dO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dO.apply(null,arguments)}function Jq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function j_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jq(Object(r),!0).forEach(function(n){_Ze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _Ze(t,e,r){return(e=EZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EZe(t){var e=SZe(t,"string");return typeof e=="symbol"?e:e+""}function SZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IZe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return g.isValidElement(e)?g.cloneElement(e,n):g.createElement(r,n)}function jZe(t){var e,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=t,f=r,A=n,h=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,p,x;if(d==="ScatterChart")m=f,p=uqe,x=ac.cursorLine;else if(d==="BarChart")m=dqe(l,f,s,o),p=Hoe,x=ac.cursorRectangle;else if(l==="radial"&&cie(f)){var{cx:v,cy:y,radius:b,startAngle:w,endAngle:j}=Goe(f);m={cx:v,cy:y,startAngle:w,endAngle:j,innerRadius:b,outerRadius:b},p=qoe,x=ac.cursorLine}else m={points:eze(l,f,s)},p=pM,x=ac.cursorLine;var I=typeof c=="object"&&"className"in c?c.className:void 0,_=j_(j_(j_(j_({stroke:"#ccc",pointerEvents:"none"},s),m),z2(c)),{},{payload:A,payloadIndex:h,className:as("recharts-tooltip-cursor",I)});return g.createElement(vh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:x},g.createElement(IZe,{cursor:c,cursorComp:p,cursorProps:_}))}function PZe(t){var e=WJe(),r=cKe(),n=Zw(),a=rZe();return e==null||r==null||n==null||a==null?null:g.createElement(jZe,dO({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var Yce=g.createContext(null),BZe=()=>g.useContext(Yce),Jce={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,A){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||c,A),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var A=0,h=f.length,m=new Array(h);A<h;A++)m[A]=f[A].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,A,h,m){var p=r?r+u:u;if(!this._events[p])return!1;var x=this._events[p],v=arguments.length,y,b;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),v){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,d),!0;case 3:return x.fn.call(x.context,d,f),!0;case 4:return x.fn.call(x.context,d,f,A),!0;case 5:return x.fn.call(x.context,d,f,A,h),!0;case 6:return x.fn.call(x.context,d,f,A,h,m),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];x.fn.apply(x.context,y)}else{var w=x.length,j;for(b=0;b<w;b++)switch(x[b].once&&this.removeListener(u,x[b].fn,void 0,!0),v){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,d);break;case 3:x[b].fn.call(x[b].context,d,f);break;case 4:x[b].fn.call(x[b].context,d,f,A);break;default:if(!y)for(j=1,y=new Array(v-1);j<v;j++)y[j-1]=arguments[j];x[b].fn.apply(x[b].context,y)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,A){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===d&&(!A||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var p=0,x=[],v=m.length;p<v;p++)(m[p].fn!==d||A&&!m[p].once||f&&m[p].context!==f)&&x.push(m[p]);x.length?this._events[h]=x.length===1?x[0]:x:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(Jce);var TZe=Jce.exports;const kZe=jA(TZe);var lw=new kZe,fO="recharts.syncEvent.tooltip",Zq="recharts.syncEvent.brush";function Zce(t,e){if(e){var r=Number.parseInt(e,10);if(!uh(r))return t==null?void 0:t[r]}}var FZe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},eue=uu({name:"options",initialState:FZe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),OZe=eue.reducer,{createEventEmitter:DZe}=eue.actions;function RZe(t){return t.tooltip.syncInteraction}var MZe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},tue=uu({name:"chartData",initialState:MZe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:ez,setDataStartEndIndexes:LZe,setComputedData:Kit}=tue.actions,UZe=tue.reducer,QZe=["x","y"];function tz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tz(Object(r),!0).forEach(function(n){VZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function VZe(t,e,r){return(e=HZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HZe(t){var e=$Ze(t,"string");return typeof e=="symbol"?e:e+""}function $Ze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GZe(t,e){if(t==null)return{};var r,n,a=KZe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function KZe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function qZe(){var t=pn(HM),e=pn($M),r=Cs(),n=pn(Wle),a=pn(GA),s=Zw(),o=HP(),l=pn(c=>c.rootProps.className);g.useEffect(()=>{if(t==null)return zw;var c=(u,d,f)=>{if(e!==f&&t===u){if(n==="index"){var A;if(o&&d!==null&&d!==void 0&&(A=d.payload)!==null&&A!==void 0&&A.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:m,y:p}=h,x=GZe(h,QZe),{x:v,y,width:b,height:w}=d.payload.sourceViewBox,j=wx(wx({},x),{},{x:o.x+(b?(m-v)/b:0)*o.width,y:o.y+(w?(p-y)/w:0)*o.height});r(wx(wx({},d),{},{payload:wx(wx({},d.payload),{},{coordinate:j})}))}else r(d);return}if(a!=null){var I;if(typeof n=="function"){var _={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},S=n(a,_);I=a[S]}else n==="value"&&(I=a.find(de=>String(de.value)===d.payload.label));var{coordinate:E}=d.payload;if(I==null||d.payload.active===!1||E==null||o==null){r(cO({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:T}=E,P=Math.min(B,o.x+o.width),O=Math.min(T,o.y+o.height),z={x:s==="horizontal"?I.coordinate:P,y:s==="horizontal"?O:I.coordinate},ce=cO({active:d.payload.active,coordinate:z,dataKey:d.payload.dataKey,index:String(I.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(ce)}}};return lw.on(fO,c),()=>{lw.off(fO,c)}},[l,r,e,t,n,a,s,o])}function zZe(){var t=pn(HM),e=pn($M),r=Cs();g.useEffect(()=>{if(t==null)return zw;var n=(a,s,o)=>{e!==o&&t===a&&r(LZe(s))};return lw.on(Zq,n),()=>{lw.off(Zq,n)}},[r,e,t])}function WZe(){var t=Cs();g.useEffect(()=>{t(DZe())},[t]),qZe(),zZe()}function XZe(t,e,r,n,a,s){var o=pn(h=>aZe(h,t,e)),l=pn($M),c=pn(HM),u=pn(Wle),d=pn(RZe),f=d==null?void 0:d.active,A=HP();g.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=cO({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:A,graphicalItemId:void 0});lw.emit(fO,c,h,l)}},[f,r,o,a,n,l,c,u,s,A])}function rz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function nz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rz(Object(r),!0).forEach(function(n){YZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YZe(t,e,r){return(e=JZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JZe(t){var e=ZZe(t,"string");return typeof e=="symbol"?e:e+""}function ZZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eet(t){return t.dataKey}function tet(t,e){return g.isValidElement(t)?g.cloneElement(t,e):typeof t=="function"?g.createElement(t,e):g.createElement(HKe,e)}var az=[],ret={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function sz(t){var e,r,n=kl(t,ret),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:A,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:y,trigger:b,defaultIndex:w,portal:j,axisId:I}=n,_=Cs(),S=typeof w=="number"?String(w):w;g.useEffect(()=>{_(ZYe({shared:y,trigger:b,axisId:I,active:a,defaultIndex:S}))},[_,y,b,I,a,S]);var E=HP(),B=Moe(),T=qYe(y),{activeIndex:P,isActive:O}=(e=pn(Y=>oZe(Y,T,b,S)))!==null&&e!==void 0?e:{},z=pn(Y=>iZe(Y,T,b,S)),ce=pn(Y=>Wce(Y,T,b,S)),de=pn(Y=>sZe(Y,T,b,S)),ue=z,me=BZe(),se=(r=a??O)!==null&&r!==void 0?r:!1,[ke,Re]=Lie([ue,se]),F=T==="axis"?ce:void 0;XZe(T,b,de,F,P,se);var H=j??me;if(H==null||E==null||T==null)return null;var K=ue??az;se||(K=az),u&&K.length&&(K=Sie(K.filter(Y=>Y.value!=null&&(Y.hide!==!0||n.includeHidden)),A,eet));var L=K.length>0,W=g.createElement(XKe,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:se,coordinate:de,hasPayload:L,offset:f,position:h,reverseDirection:m,useTranslate3d:p,viewBox:E,wrapperStyle:x,lastBoundingBox:ke,innerRef:Re,hasPortalFromProps:!!j},tet(c,nz(nz({},n),{},{payload:K,label:F,active:se,activeIndex:P,coordinate:de,accessibilityLayer:B})));return g.createElement(g.Fragment,null,Mu.createPortal(W,H),se&&g.createElement(PZe,{cursor:v,tooltipEventType:T,coordinate:de,payload:K,index:P}))}var AN=t=>null;AN.displayName="Cell";function net(t,e,r){return(e=aet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aet(t){var e=set(t,"string");return typeof e=="symbol"?e:e+""}function set(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iet{constructor(e){net(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function iz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function oet(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iz(Object(r),!0).forEach(function(n){cet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cet(t,e,r){return(e=uet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uet(t){var e=det(t,"string");return typeof e=="symbol"?e:e+""}function det(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fet={cacheSize:2e3,enableCache:!0},rue=oet({},fet),oz=new iet(rue.cacheSize),het={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},lz="recharts_measurement_span";function Aet(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",s=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var cz=(t,e)=>{try{var r=document.getElementById(lz);r||(r=document.createElement("span"),r.setAttribute("id",lz),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,het,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Qb=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||zP.isSsr)return{width:0,height:0};if(!rue.enableCache)return cz(e,r);var n=Aet(e,r),a=oz.get(n);if(a)return a;var s=cz(e,r);return oz.set(n,s),s},nue;function met(t,e,r){return(e=pet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pet(t){var e=get(t,"string");return typeof e=="symbol"?e:e+""}function get(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,dz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,xet=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,vet=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,yet={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},bet=["cm","mm","pt","pc","in","Q","px"];function wet(t){return bet.includes(t)}var tv="NaN";function Net(t,e){return t*yet[e]}class bl{static parse(e){var r,[,n,a]=(r=vet.exec(e))!==null&&r!==void 0?r:[];return n==null?bl.NaN:new bl(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,uh(e)&&(this.unit=""),r!==""&&!xet.test(r)&&(this.num=NaN,this.unit=""),wet(r)&&(this.num=Net(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new bl(NaN,""):new bl(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new bl(NaN,""):new bl(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new bl(NaN,""):new bl(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new bl(NaN,""):new bl(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return uh(this.num)}}nue=bl;met(bl,"NaN",new nue(NaN,""));function aue(t){if(t==null||t.includes(tv))return tv;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,s]=(r=uz.exec(e))!==null&&r!==void 0?r:[],o=bl.parse(n??""),l=bl.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return tv;e=e.replace(uz,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,d,f,A]=(u=dz.exec(e))!==null&&u!==void 0?u:[],h=bl.parse(d??""),m=bl.parse(A??""),p=f==="+"?h.add(m):h.subtract(m);if(p.isNaN())return tv;e=e.replace(dz,p.toString())}return e}var fz=/\(([^()]*)\)/;function Cet(t){for(var e=t,r;(r=fz.exec(e))!=null;){var[,n]=r;e=e.replace(fz,aue(n))}return e}function _et(t){var e=t.replace(/\s+/g,"");return e=Cet(e),e=aue(e),e}function Eet(t){try{return _et(t)}catch{return tv}}function SB(t){var e=Eet(t.slice(5,-1));return e===tv?"":e}var Iet=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],jet=["dx","dy","angle","className","breakAll"];function hO(){return hO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},hO.apply(null,arguments)}function hz(t,e){if(t==null)return{};var r,n,a=Pet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Pet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var sue=/[ \f\n\r\t\v\u2028\u2029]+/,iue=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];sl(e)||(r?a=e.toString().split(""):a=e.toString().split(sue));var s=a.map(l=>({word:l,width:Qb(l,n).width})),o=r?0:Qb("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function Bet(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var oue=(t,e,r,n)=>t.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};a.push(u)}return a},[]),lue=t=>t.reduce((e,r)=>e.width>r.width?e:r),Tet="",Az=(t,e,r,n,a,s,o,l)=>{var c=t.slice(0,e),u=iue({breakAll:r,style:n,children:c+Tet});if(!u)return[!1,[]];var d=oue(u.wordsWithComputedWidth,s,o,l),f=d.length>a||lue(d).width>Number(s);return[f,d]},ket=(t,e,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=t,u=Cn(s),d=String(o),f=oue(e,n,r,a);if(!u||a)return f;var A=f.length>s||lue(f).width>Number(n);if(!A)return f;for(var h=0,m=d.length-1,p=0,x;h<=m&&p<=d.length-1;){var v=Math.floor((h+m)/2),y=v-1,[b,w]=Az(d,y,c,l,s,n,r,a),[j]=Az(d,v,c,l,s,n,r,a);if(!b&&!j&&(h=v+1),b&&j&&(m=v-1),!b&&j){x=w;break}p++}return x||f},mz=t=>{var e=sl(t)?[]:t.toString().split(sue);return[{words:e,width:void 0}]},Fet=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=t;if((e||r)&&!zP.isSsr){var l,c,u=iue({breakAll:s,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return mz(n);return ket({breakAll:s,children:n,maxLines:o,style:a},l,c,e,!!r)}return mz(n)},cue="#808080",Oet={angle:0,breakAll:!1,capHeight:"0.71em",fill:cue,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},A3=g.forwardRef((t,e)=>{var r=kl(t,Oet),{x:n,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=hz(r,Iet),A=g.useMemo(()=>Fet({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:p,className:x,breakAll:v}=f,y=hz(f,jet);if(!dh(n)||!dh(a)||A.length===0)return null;var b=Number(n)+(Cn(h)?h:0),w=Number(a)+(Cn(m)?m:0);if(!Ai(b)||!Ai(w))return null;var j;switch(d){case"start":j=SB("calc(".concat(o,")"));break;case"middle":j=SB("calc(".concat((A.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:j=SB("calc(".concat(A.length-1," * -").concat(s,")"));break}var I=[];if(c){var _=A[0].width,{width:S}=f;I.push("scale(".concat(Cn(S)&&Cn(_)?S/_:1,")"))}return p&&I.push("rotate(".concat(p,", ").concat(b,", ").concat(w,")")),I.length&&(y.transform=I.join(" ")),g.createElement("text",hO({},Dd(y),{ref:e,x:b,y:w,className:as("recharts-text",x),textAnchor:u,fill:l.includes("url")?cue:l}),A.map((E,B)=>{var T=E.words.join(v?"":" ");return g.createElement("tspan",{x:b,dy:B===0?j:s,key:"".concat(T,"-").concat(B)},T)}))});A3.displayName="Text";var Det=["labelRef"],Ret=["content"];function pz(t,e){if(t==null)return{};var r,n,a=Met(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Met(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function gz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Mi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gz(Object(r),!0).forEach(function(n){Let(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Let(t,e,r){return(e=Uet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uet(t){var e=Qet(t,"string");return typeof e=="symbol"?e:e+""}function Qet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hh(){return Hh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hh.apply(null,arguments)}var uue=g.createContext(null),Vet=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o,children:l}=t,c=g.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o}),[e,r,n,a,s,o]);return g.createElement(uue.Provider,{value:c},l)},due=()=>{var t=g.useContext(uue),e=HP();return t||_oe(e)},Het=g.createContext(null),$et=()=>{var t=g.useContext(Het),e=pn(ece);return t||e},Get=t=>{var{value:e,formatter:r}=t,n=sl(t.children)?e:t.children;return typeof r=="function"?r(n):n},S8=t=>t!=null&&typeof t=="function",Ket=(t,e)=>{var r=Pl(e-t),n=Math.min(Math.abs(e-t),360);return r*n},qet=(t,e,r,n,a)=>{var{offset:s,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:A,clockWise:h}=a,m=(u+d)/2,p=Ket(f,A),x=p>=0?1:-1,v,y;switch(e){case"insideStart":v=f+x*s,y=h;break;case"insideEnd":v=A-x*s,y=!h;break;case"end":v=A+x*s,y=h;break;default:throw new Error("Unsupported position ".concat(e))}y=p<=0?y:!y;var b=lo(l,c,m,v),w=lo(l,c,m,v+(y?1:-1)*359),j="M".concat(b.x,",").concat(b.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),I=sl(t.id)?W2("recharts-radial-line-"):t.id;return g.createElement("text",Hh({},n,{dominantBaseline:"central",className:as("recharts-radial-bar-label",o)}),g.createElement("defs",null,g.createElement("path",{id:I,d:j})),g.createElement("textPath",{xlinkHref:"#".concat(I)},r))},zet=(t,e,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=lo(n,a,o+e,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var A=(s+o)/2,{x:h,y:m}=lo(n,a,A,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},AO=t=>"cx"in t&&Cn(t.cx),Wet=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,s;r!=null&&!AO(r)&&(s=r);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:d}=e,f=o,A=o+(c-u)/2,h=(f+A)/2,m=(c+u)/2,p=f+c/2,x=d>=0?1:-1,v=x*n,y=x>0?"end":"start",b=x>0?"start":"end",w=c>=0?1:-1,j=w*n,I=w>0?"end":"start",_=w>0?"start":"end";if(a==="top"){var S={x:f+c/2,y:l-v,textAnchor:"middle",verticalAnchor:y};return Mi(Mi({},S),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var E={x:A+u/2,y:l+d+v,textAnchor:"middle",verticalAnchor:b};return Mi(Mi({},E),s?{height:Math.max(s.y+s.height-(l+d),0),width:u}:{})}if(a==="left"){var B={x:h-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"};return Mi(Mi({},B),s?{width:Math.max(B.x-s.x,0),height:d}:{})}if(a==="right"){var T={x:h+m+j,y:l+d/2,textAnchor:_,verticalAnchor:"middle"};return Mi(Mi({},T),s?{width:Math.max(s.x+s.width-T.x,0),height:d}:{})}var P=s?{width:m,height:d}:{};return a==="insideLeft"?Mi({x:h+j,y:l+d/2,textAnchor:_,verticalAnchor:"middle"},P):a==="insideRight"?Mi({x:h+m-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"},P):a==="insideTop"?Mi({x:f+c/2,y:l+v,textAnchor:"middle",verticalAnchor:b},P):a==="insideBottom"?Mi({x:A+u/2,y:l+d-v,textAnchor:"middle",verticalAnchor:y},P):a==="insideTopLeft"?Mi({x:f+j,y:l+v,textAnchor:_,verticalAnchor:b},P):a==="insideTopRight"?Mi({x:f+c-j,y:l+v,textAnchor:I,verticalAnchor:b},P):a==="insideBottomLeft"?Mi({x:A+j,y:l+d-v,textAnchor:_,verticalAnchor:y},P):a==="insideBottomRight"?Mi({x:A+u-j,y:l+d-v,textAnchor:I,verticalAnchor:y},P):a&&typeof a=="object"&&(Cn(a.x)||wA(a.x))&&(Cn(a.y)||wA(a.y))?Mi({x:o+ic(a.x,m),y:l+ic(a.y,d),textAnchor:"end",verticalAnchor:"end"},P):Mi({x:p,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},P)},Xet={angle:0,offset:5,zIndex:ac.label,position:"middle",textBreakAll:!1};function P0(t){var e=kl(t,Xet),{viewBox:r,position:n,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:u}=e,d=$et(),f=due(),A=n==="center"?f:d??f,h,m,p;if(r==null?h=A:AO(r)?h=r:h=_oe(r),!h||sl(a)&&sl(s)&&!g.isValidElement(o)&&typeof o!="function")return null;var x=Mi(Mi({},e),{},{viewBox:h});if(g.isValidElement(o)){var{labelRef:v}=x,y=pz(x,Det);return g.cloneElement(o,y)}if(typeof o=="function"){var{content:b}=x,w=pz(x,Ret);if(m=g.createElement(o,w),g.isValidElement(m))return m}else m=Get(e);var j=Dd(e);if(AO(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return qet(e,n,m,j,h);p=zet(h,e.offset,e.position)}else p=Wet(e,h);return g.createElement(vh,{zIndex:e.zIndex},g.createElement(A3,Hh({ref:u,className:as("recharts-label",l)},j,p,{textAnchor:Bet(j.textAnchor)?j.textAnchor:p.textAnchor,breakAll:c}),m))}P0.displayName="Label";var Yet=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?g.createElement(P0,Hh({key:"label-implicit"},n)):dh(t)?g.createElement(P0,Hh({key:"label-implicit",value:t},n)):g.isValidElement(t)?t.type===P0?g.cloneElement(t,Mi({key:"label-implicit"},n)):g.createElement(P0,Hh({key:"label-implicit",content:t},n)):S8(t)?g.createElement(P0,Hh({key:"label-implicit",content:t},n)):t&&typeof t=="object"?g.createElement(P0,Hh({},t,{key:"label-implicit"},n)):null};function Jet(t){var{label:e,labelRef:r}=t,n=due();return Yet(e,n,r)||null}var fue={},hue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(hue);var Aue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(Aue);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hue,r=Aue,n=EP;function a(s){if(n.isArrayLike(s))return e.last(r.toArray(s))}t.last=a})(fue);var Zet=fue.last;const ett=jA(Zet);var ttt=["valueAccessor"],rtt=["dataKey","clockWise","id","textBreakAll","zIndex"];function GI(){return GI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},GI.apply(null,arguments)}function xz(t,e){if(t==null)return{};var r,n,a=ntt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function ntt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var att=t=>Array.isArray(t.value)?ett(t.value):t.value,mue=g.createContext(void 0),stt=mue.Provider,pue=g.createContext(void 0),itt=pue.Provider;function ott(){return g.useContext(mue)}function ltt(){return g.useContext(pue)}function _E(t){var{valueAccessor:e=att}=t,r=xz(t,ttt),{dataKey:n,clockWise:a,id:s,textBreakAll:o,zIndex:l}=r,c=xz(r,rtt),u=ott(),d=ltt(),f=u||d;return!f||!f.length?null:g.createElement(vh,{zIndex:l??ac.label},g.createElement(Bc,{className:"recharts-label-list"},f.map((A,h)=>{var m,p=sl(n)?e(A,h):ks(A&&A.payload,n),x=sl(s)?{}:{id:"".concat(s,"-").concat(h)};return g.createElement(P0,GI({key:"label-".concat(h)},Dd(A),c,x,{fill:(m=r.fill)!==null&&m!==void 0?m:A.fill,parentViewBox:A.parentViewBox,value:p,textBreakAll:o,viewBox:A.viewBox,index:h,zIndex:0}))})))}_E.displayName="LabelList";function gue(t){var{label:e}=t;return e?e===!0?g.createElement(_E,{key:"labelList-implicit"}):g.isValidElement(e)||S8(e)?g.createElement(_E,{key:"labelList-implicit",content:e}):typeof e=="object"?g.createElement(_E,GI({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var xue=t=>t.graphicalItems.polarItems,ctt=er([Xs,iN],XM),m3=er([xue,mi,ctt],JM),utt=er([m3],ZM),p3=er([utt,n3],e8),dtt=er([p3,mi,m3],r8);er([p3,mi,m3],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var s,o=ks(n,(s=e.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:ks(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var vz=()=>{},ftt=er([p3,mi,m3,u3,Xs],i8),htt=er([mi,a8,s8,vz,ftt,vz,Ta,Xs],o8),vue=er([mi,Ta,p3,dtt,sN,Xs,htt],l8),Att=er([vue,mi,j1],d8);er([mi,vue,Att,Xs],h8);var mtt={radiusAxis:{},angleAxis:{}},yue=uu({name:"polarAxis",initialState:mtt,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:qit,removeRadiusAxis:zit,addAngleAxis:Wit,removeAngleAxis:Xit}=yue.actions,ptt=yue.reducer;function yz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yz(Object(r),!0).forEach(function(n){gtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gtt(t,e,r){return(e=xtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xtt(t){var e=vtt(t,"string");return typeof e=="symbol"?e:e+""}function vtt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ytt=(t,e)=>e,I8=er([xue,ytt],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),btt=[],j8=(t,e,r)=>(r==null?void 0:r.length)===0?btt:r,bue=er([n3,I8,j8],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if((e==null?void 0:e.data)!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>bz(bz({},e.presentationProps),s.props))),a!=null)return a}}),wtt=er([bue,I8,j8],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var s,o=ks(n,e.nameKey,e.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:MP(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),Ntt=er([bue,I8,j8,Ro],(t,e,r,n)=>{if(!(e==null||t==null))return _rt({offset:n,pieSettings:e,displayedData:t,cells:r})}),wue={exports:{}},ps={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P8=Symbol.for("react.transitional.element"),B8=Symbol.for("react.portal"),g3=Symbol.for("react.fragment"),x3=Symbol.for("react.strict_mode"),v3=Symbol.for("react.profiler"),y3=Symbol.for("react.consumer"),b3=Symbol.for("react.context"),w3=Symbol.for("react.forward_ref"),N3=Symbol.for("react.suspense"),C3=Symbol.for("react.suspense_list"),_3=Symbol.for("react.memo"),E3=Symbol.for("react.lazy"),Ctt=Symbol.for("react.view_transition"),_tt=Symbol.for("react.client.reference");function Hd(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case P8:switch(t=t.type,t){case g3:case v3:case x3:case N3:case C3:case Ctt:return t;default:switch(t=t&&t.$$typeof,t){case b3:case w3:case E3:case _3:return t;case y3:return t;default:return e}}case B8:return e}}}ps.ContextConsumer=y3;ps.ContextProvider=b3;ps.Element=P8;ps.ForwardRef=w3;ps.Fragment=g3;ps.Lazy=E3;ps.Memo=_3;ps.Portal=B8;ps.Profiler=v3;ps.StrictMode=x3;ps.Suspense=N3;ps.SuspenseList=C3;ps.isContextConsumer=function(t){return Hd(t)===y3};ps.isContextProvider=function(t){return Hd(t)===b3};ps.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===P8};ps.isForwardRef=function(t){return Hd(t)===w3};ps.isFragment=function(t){return Hd(t)===g3};ps.isLazy=function(t){return Hd(t)===E3};ps.isMemo=function(t){return Hd(t)===_3};ps.isPortal=function(t){return Hd(t)===B8};ps.isProfiler=function(t){return Hd(t)===v3};ps.isStrictMode=function(t){return Hd(t)===x3};ps.isSuspense=function(t){return Hd(t)===N3};ps.isSuspenseList=function(t){return Hd(t)===C3};ps.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===g3||t===v3||t===x3||t===N3||t===C3||typeof t=="object"&&t!==null&&(t.$$typeof===E3||t.$$typeof===_3||t.$$typeof===b3||t.$$typeof===y3||t.$$typeof===w3||t.$$typeof===_tt||t.getModuleId!==void 0)};ps.typeOf=Hd;wue.exports=ps;var Ett=wue.exports,wz=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",Nz=null,IB=null,Nue=t=>{if(t===Nz&&Array.isArray(IB))return IB;var e=[];return g.Children.forEach(t,r=>{sl(r)||(Ett.isFragment(r)?e=e.concat(Nue(r.props.children)):e.push(r))}),IB=e,Nz=t,e};function T8(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>wz(a)):n=[wz(e)],Nue(t).forEach(a=>{var s=vg(a,"type.displayName")||vg(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var Cue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(Cue);var Stt=Cue.isPlainObject;const Itt=jA(Stt);var Cz,_z,Ez,Sz,Iz;function jz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Pz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jz(Object(r),!0).forEach(function(n){jtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jtt(t,e,r){return(e=Ptt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ptt(t){var e=Btt(t,"string");return typeof e=="symbol"?e:e+""}function Btt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KI(){return KI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},KI.apply(null,arguments)}function Py(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Bz=(t,e,r,n,a)=>{var s=r-n,o;return o=Ni(Cz||(Cz=Py(["M ",",",""])),t,e),o+=Ni(_z||(_z=Py(["L ",",",""])),t+r,e),o+=Ni(Ez||(Ez=Py(["L ",",",""])),t+r-s/2,e+a),o+=Ni(Sz||(Sz=Py(["L ",",",""])),t+r-s/2-n,e+a),o+=Ni(Iz||(Iz=Py(["L ",","," Z"])),t,e),o},Ttt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ktt=t=>{var e=kl(t,Ttt),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=e,A=g.useRef(null),[h,m]=g.useState(-1),p=g.useRef(a),x=g.useRef(s),v=g.useRef(o),y=g.useRef(r),b=g.useRef(n),w=XP(t,"trapezoid-");if(g.useEffect(()=>{if(A.current&&A.current.getTotalLength)try{var z=A.current.getTotalLength();z&&m(z)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var j=as("recharts-trapezoid",l);if(!f)return g.createElement("g",null,g.createElement("path",KI({},Dd(e),{className:j,d:Bz(r,n,a,s,o)})));var I=p.current,_=x.current,S=v.current,E=y.current,B=b.current,T="0px ".concat(h===-1?1:h,"px"),P="".concat(h,"px 0px"),O=Loe(["strokeDasharray"],u,c);return g.createElement(WP,{animationId:w,key:w,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},z=>{var ce=Eo(I,a,z),de=Eo(_,s,z),ue=Eo(S,o,z),me=Eo(E,r,z),se=Eo(B,n,z);A.current&&(p.current=ce,x.current=de,v.current=ue,y.current=me,b.current=se);var ke=z>0?{transition:O,strokeDasharray:P}:{strokeDasharray:T};return g.createElement("path",KI({},Dd(e),{className:j,d:Bz(me,se,ce,de,ue),ref:A,style:Pz(Pz({},ke),e.style)}))})},Ftt=["option","shapeType","activeClassName"];function Ott(t,e){if(t==null)return{};var r,n,a=Dtt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Dtt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Tz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tz(Object(r),!0).forEach(function(n){Rtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Rtt(t,e,r){return(e=Mtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mtt(t){var e=Ltt(t,"string");return typeof e=="symbol"?e:e+""}function Ltt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Utt(t,e){return qI(qI({},e),t)}function Qtt(t,e){return t==="symbols"}function kz(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return g.createElement(Hoe,r);case"trapezoid":return g.createElement(ktt,r);case"sector":return g.createElement(qoe,r);case"symbols":if(Qtt(e))return g.createElement(qR,r);break;case"curve":return g.createElement(pM,r);default:return null}}function Vtt(t){return g.isValidElement(t)?t.props:t}function _ue(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,a=Ott(t,Ftt),s;if(g.isValidElement(e))s=g.cloneElement(e,qI(qI({},a),Vtt(e)));else if(typeof e=="function")s=e(a,a.index);else if(Itt(e)&&typeof e!="boolean"){var o=Utt(e,a);s=g.createElement(kz,{shapeType:r,elementProps:o})}else{var l=a;s=g.createElement(kz,{shapeType:r,elementProps:l})}return a.isActive?g.createElement(Bc,{className:n},s):s}var k8=(t,e,r)=>{var n=Cs();return(a,s)=>o=>{t==null||t(a,s,o),n(Bce({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},F8=t=>{var e=Cs();return(r,n)=>a=>{t==null||t(r,n,a),e(eJe())}},O8=(t,e,r)=>{var n=Cs();return(a,s)=>o=>{t==null||t(a,s,o),n(tJe({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function Eue(t){var{tooltipEntrySettings:e}=t,r=Cs(),n=qu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(XYe(e)):a.current!==e&&r(YYe({prev:a.current,next:e})),a.current=e)},[e,r,n]),g.useLayoutEffect(()=>()=>{a.current&&(r(JYe(a.current)),a.current=null)},[r]),null}function Htt(t){var{legendPayload:e}=t,r=Cs(),n=qu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(Ooe(e)):a.current!==e&&r(Doe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Roe(a.current)),a.current=null)},[r]),null}function $tt(t){var{legendPayload:e}=t,r=Cs(),n=pn(Ta),a=g.useRef(null);return g.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(Ooe(e)):a.current!==e&&r(Doe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Roe(a.current)),a.current=null)},[r]),null}var jB,Gtt=()=>{var[t]=g.useState(()=>W2("uid-"));return t},Ktt=(jB=ufe.useId)!==null&&jB!==void 0?jB:Gtt;function qtt(t,e){var r=Ktt();return e||(t?"".concat(t,"-").concat(r):r)}var ztt=g.createContext(void 0),Sue=t=>{var{id:e,type:r,children:n}=t,a=qtt("recharts-".concat(r),e);return g.createElement(ztt.Provider,{value:a},n(a))},Wtt={cartesianItems:[],polarItems:[]},Iue=uu({name:"graphicalItems",initialState:Wtt,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:Ls()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,a=vf(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},prepare:Ls()},removeCartesianGraphicalItem:{reducer(t,e){var r=vf(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Ls()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:Ls()},removePolarGraphicalItem:{reducer(t,e){var r=vf(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Ls()}}}),{addCartesianGraphicalItem:Xtt,replaceCartesianGraphicalItem:Ytt,removeCartesianGraphicalItem:Jtt,addPolarGraphicalItem:Ztt,removePolarGraphicalItem:ert}=Iue.actions,trt=Iue.reducer,rrt=t=>{var e=Cs(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Xtt(t)):r.current!==t&&e(Ytt({prev:r.current,next:t})),r.current=t},[e,t]),g.useLayoutEffect(()=>()=>{r.current&&(e(Jtt(r.current)),r.current=null)},[e]),null},nrt=g.memo(rrt);function art(t){var e=Cs();return g.useLayoutEffect(()=>(e(Ztt(t)),()=>{e(ert(t))}),[e,t]),null}var srt=["key"],irt=["onMouseEnter","onClick","onMouseLeave"],ort=["id"],lrt=["id"];function Fz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ei(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fz(Object(r),!0).forEach(function(n){crt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function crt(t,e,r){return(e=urt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function urt(t){var e=drt(t,"string");return typeof e=="symbol"?e:e+""}function drt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function km(){return km=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},km.apply(null,arguments)}function S3(t,e){if(t==null)return{};var r,n,a=frt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function frt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function hrt(t){var e=g.useMemo(()=>T8(t.children,AN),[t.children]),r=pn(n=>wtt(n,t.id,e));return r==null?null:g.createElement($tt,{legendPayload:r})}var Art=g.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=t,f={dataDefinedOnItem:n.map(A=>A.tooltipPayload),positions:n.map(A=>A.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:e,nameKey:r,name:MP(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return g.createElement(Eue,{tooltipEntrySettings:f})}),mrt=(t,e)=>t>e?"start":t<e?"end":"middle",prt=(t,e,r)=>ic(typeof e=="function"?e(t):e,r,r*.8),grt=(t,e,r)=>{var{top:n,left:a,width:s,height:o}=e,l=$oe(s,o),c=a+ic(t.cx,s,s/2),u=n+ic(t.cy,o,o/2),d=ic(t.innerRadius,l,0),f=prt(r,t.outerRadius,l),A=t.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:A}},xrt=(t,e)=>{var r=Pl(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function vrt(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var yrt=(t,e)=>{if(g.isValidElement(t))return g.cloneElement(t,e);if(typeof t=="function")return t(e);var r=as("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,a=S3(e,srt);return g.createElement(pM,km({},a,{type:"linear",className:r}))},brt=(t,e,r)=>{if(g.isValidElement(t))return g.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),g.isValidElement(n)))return n;var a=as("recharts-pie-label-text",vrt(t));return g.createElement(A3,km({},e,{alignmentBaseline:"middle",className:a}),n)};function wrt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!e)return null;var l=ch(r),c=z2(a),u=z2(s),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=e.map((A,h)=>{var m=(A.startAngle+A.endAngle)/2,p=lo(A.cx,A.cy,A.outerRadius+d,m),x=Ei(Ei(Ei(Ei({},l),A),{},{stroke:"none"},c),{},{index:h,textAnchor:mrt(p.x,A.cx)},p),v=Ei(Ei(Ei(Ei({},l),A),{},{fill:"none",stroke:A.fill},u),{},{index:h,points:[lo(A.cx,A.cy,A.outerRadius,m),p],key:"line"});return g.createElement(vh,{zIndex:ac.label,key:"label-".concat(A.startAngle,"-").concat(A.endAngle,"-").concat(A.midAngle,"-").concat(h)},g.createElement(Bc,null,s&&yrt(s,v),brt(a,x,ks(A,o))))});return g.createElement(Bc,{className:"recharts-pie-labels"},f)}function Nrt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?g.createElement(gue,{label:a}):g.createElement(wrt,{sectors:e,props:r,showLabels:n})}function Crt(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:o}=t,l=pn(Cg),c=pn(w8),u=pn(UJe),{onMouseEnter:d,onClick:f,onMouseLeave:A}=a,h=S3(a,irt),m=k8(d,a.dataKey,o),p=F8(A),x=O8(f,a.dataKey,o);return e==null||e.length===0?null:g.createElement(g.Fragment,null,e.map((v,y)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&e.length!==1)return null;var b=u==null||u===o,w=String(y)===l&&(c==null||a.dataKey===c)&&b,j=l?n:null,I=r&&w?r:j,_=Ei(Ei({},v),{},{stroke:v.stroke,tabIndex:-1,[goe]:y,[xoe]:o});return g.createElement(Bc,km({key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(y),tabIndex:-1,className:"recharts-pie-sector"},Ww(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),g.createElement(_ue,km({option:s??I,index:y,shapeType:"sector",isActive:w},_)))}))}function _rt(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:s}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,A=Math.abs(r.minAngle),h=xrt(l,c),m=Math.abs(h),p=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,x=n.filter(I=>ks(I,u,0)!==0).length,v=(m>=360?x:x-1)*p,y=m-x*A-v,b=n.reduce((I,_)=>{var S=ks(_,u,0);return I+(Cn(S)?S:0)},0),w;if(b>0){var j;w=n.map((I,_)=>{var S=ks(I,u,0),E=ks(I,d,_),B=grt(r,s,I),T=(Cn(S)?S:0)/b,P,O=Ei(Ei({},I),a&&a[_]&&a[_].props);_?P=j.endAngle+Pl(h)*p*(S!==0?1:0):P=l;var z=P+Pl(h)*((S!==0?A:0)+T*y),ce=(P+z)/2,de=(B.innerRadius+B.outerRadius)/2,ue=[{name:E,value:S,payload:O,dataKey:u,type:f,graphicalItemId:r.id}],me=lo(B.cx,B.cy,de,ce);return j=Ei(Ei(Ei(Ei({},r.presentationProps),{},{percent:T,cornerRadius:typeof o=="string"?parseFloat(o):o,name:E,tooltipPayload:ue,midAngle:ce,middleRadius:de,tooltipPosition:me},O),B),{},{value:S,dataKey:u,startAngle:P,endAngle:z,payload:O,paddingAngle:Pl(h)*p}),j})}return w}function Ert(t){var{showLabels:e,sectors:r,children:n}=t,a=g.useMemo(()=>!e||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,e]);return g.createElement(itt,{value:e?a:void 0},n)}function Srt(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:A}=e,h=XP(e,"recharts-pie-"),m=r.current,[p,x]=g.useState(!1),v=g.useCallback(()=>{typeof A=="function"&&A(),x(!1)},[A]),y=g.useCallback(()=>{typeof f=="function"&&f(),x(!0)},[f]);return g.createElement(Ert,{showLabels:!p,sectors:a},g.createElement(WP,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:y,onAnimationEnd:v,key:h},b=>{var w=[],j=a&&a[0],I=j==null?void 0:j.startAngle;return a==null||a.forEach((_,S)=>{var E=m&&m[S],B=S>0?vg(_,"paddingAngle",0):0;if(E){var T=Eo(E.endAngle-E.startAngle,_.endAngle-_.startAngle,b),P=Ei(Ei({},_),{},{startAngle:I+B,endAngle:I+T+B});w.push(P),I=P.endAngle}else{var{endAngle:O,startAngle:z}=_,ce=Eo(0,O-z,b),de=Ei(Ei({},_),{},{startAngle:I+B,endAngle:I+ce+B});w.push(de),I=de.endAngle}}),r.current=w,g.createElement(Bc,null,g.createElement(Crt,{sectors:w,activeShape:u,inactiveShape:d,allOtherPieProps:e,shape:e.shape,id:n}))}),g.createElement(Nrt,{showLabels:!p,sectors:a,props:e}),e.children)}var Irt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:ac.area};function jrt(t){var{id:e}=t,r=S3(t,ort),{hide:n,className:a,rootTabIndex:s}=t,o=g.useMemo(()=>T8(t.children,AN),[t.children]),l=pn(d=>Ntt(d,e,o)),c=g.useRef(null),u=as("recharts-pie",a);return n||l==null?(c.current=null,g.createElement(Bc,{tabIndex:s,className:u})):g.createElement(vh,{zIndex:t.zIndex},g.createElement(Art,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),g.createElement(Bc,{tabIndex:s,className:u},g.createElement(Srt,{props:Ei(Ei({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function jue(t){var e=kl(t,Irt),{id:r}=e,n=S3(e,lrt),a=ch(n);return g.createElement(Sue,{id:r,type:"pie"},s=>g.createElement(g.Fragment,null,g.createElement(art,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),g.createElement(hrt,km({},n,{id:s})),g.createElement(jrt,km({},n,{id:s}))))}jue.displayName="Pie";function Oz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Dz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oz(Object(r),!0).forEach(function(n){Prt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Prt(t,e,r){return(e=Brt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Brt(t){var e=Trt(t,"string");return typeof e=="symbol"?e:e+""}function Trt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pue=0,krt={xAxis:{},yAxis:{},zAxis:{}},Bue=uu({name:"cartesianAxis",initialState:krt,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:Ls()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:Ls()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:Ls()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:Ls()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:Ls()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:Ls()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:Ls()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:Ls()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:Ls()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,a=t.yAxis[r];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-s[0])<=1)return;var o=[...s,n].slice(-3);t.yAxis[r]=Dz(Dz({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:Frt,replaceXAxis:Ort,removeXAxis:Drt,addYAxis:Rrt,replaceYAxis:Mrt,removeYAxis:Lrt,addZAxis:Yit,replaceZAxis:Jit,removeZAxis:Zit,updateYAxisWidth:Urt}=Bue.actions,Qrt=Bue.reducer,Vrt=er([Ro],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),Hrt=er([Vrt,LA,UA],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),Tue=()=>pn(Hrt),Rz=(t,e,r)=>{var n=r??t;if(!sl(n))return ic(n,e,0)},$rt=(t,e,r)=>{var n={},a=t.filter(i3),s=t.filter(u=>u.stackId==null),o=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),l=Object.entries(o).map(u=>{var[d,f]=u,A=f.map(m=>m.dataKey),h=Rz(e,r,f[0].barSize);return{stackId:d,dataKeys:A,barSize:h}}),c=s.map(u=>{var d=[u.dataKey].filter(A=>A!=null),f=Rz(e,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function Mz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function P_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mz(Object(r),!0).forEach(function(n){Grt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Grt(t,e,r){return(e=Krt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Krt(t){var e=qrt(t,"string");return typeof e=="symbol"?e:e+""}function qrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zrt(t,e,r,n,a){var s=n.length;if(!(s<1)){var o=ic(t,r,0,!0),l,c=[];if(Ai(n[0].barSize)){var u=!1,d=r/s,f=n.reduce((v,y)=>v+(y.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&d>0&&(u=!0,d*=.9,f=s*d);var A=(r-f)/2>>0,h={offset:A-o,size:0};l=n.reduce((v,y)=>{var b,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h.offset+h.size+o,size:u?d:(b=y.barSize)!==null&&b!==void 0?b:0}},j=[...v,w];return h=j[j.length-1].position,j},c)}else{var m=ic(e,r,0,!0);r-2*m-(s-1)*o<=0&&(o=0);var p=(r-2*m-(s-1)*o)/s;p>1&&(p>>=0);var x=Ai(a)?Math.min(p,a):p;l=n.reduce((v,y,b)=>[...v,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m+(p+o)*b+(p-x)/2,size:x}}],c)}return l}}var Wrt=(t,e,r,n,a,s,o)=>{var l=sl(o)?e:o,c=zrt(r,n,a!==s?a:s,t,l);return a!==s&&c!=null&&(c=c.map(u=>P_(P_({},u),{},{position:P_(P_({},u.position),{},{offset:u.position.offset-a/2})}))),c},Xrt=(t,e)=>{var r=zM(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}};function Yrt(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Ai(t.zIndex)?t.zIndex:e}var kue=t=>{var{chartData:e}=t,r=Cs(),n=qu();return g.useEffect(()=>n?()=>{}:(r(ez(e)),()=>{r(ez(void 0))}),[e,r,n]),null},Lz={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Fue=uu({name:"brush",initialState:Lz,reducers:{setBrushSettings(t,e){return e.payload==null?Lz:e.payload}}}),{setBrushSettings:eot}=Fue.actions,Jrt=Fue.reducer;function Zrt(t,e,r){return(e=ent(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ent(t){var e=tnt(t,"string");return typeof e=="symbol"?e:e+""}function tnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D8{static create(e){return new D8(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}Zrt(D8,"EPS",1e-4);function rnt(t){return(t%180+180)%180}var nnt=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=rnt(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},ant={dots:[],areas:[],lines:[]},Oue=uu({name:"referenceElements",initialState:ant,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=vf(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=vf(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=vf(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:tot,removeDot:rot,addArea:not,removeArea:aot,addLine:sot,removeLine:iot}=Oue.actions,snt=Oue.reducer,int=g.createContext(void 0),ont=t=>{var{children:e}=t,[r]=g.useState("".concat(W2("recharts"),"-clip")),n=Tue();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return g.createElement(int.Provider,{value:r},g.createElement("defs",null,g.createElement("clipPath",{id:r},g.createElement("rect",{x:a,y:s,height:l,width:o}))),e)};function Due(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var a=t[n];a!==void 0&&r.push(a)}return r}function lnt(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return nnt(n,r)}function cnt(t,e,r){var n=r==="width",{x:a,y:s,width:o,height:l}=t;return e===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function cw(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var s=r();return t*(e-t*s/2-n)>=0&&t*(e+t*s/2-a)<=0}function unt(t,e){return Due(t,e+1)}function dnt(t,e,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:Due(n,u)};var p=c,x,v=()=>(x===void 0&&(x=r(m,p)),x),y=m.coordinate,b=c===0||cw(t,y,v,d,l);b||(c=0,d=o,u+=1),b&&(d=y+t*(v()/2+a),c+=u)},A;u<=s.length;)if(A=f(),A)return A.v;return[]}function fnt(t,e,r,n,a){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,A=!0,h=function(){var y=n[m],b=m,w,j=()=>(w===void 0&&(w=r(y,b)),w),I=y.coordinate,_=m===d||cw(t,I,j,f,c);if(!_)return A=!1,1;_&&(f=I+t*(j()/2+a))},m=d;m<o&&!h();m+=u);if(A){for(var p=[],x=d;x<o;x+=u)p.push(n[x]);return p}}return[]}function Uz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Yl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uz(Object(r),!0).forEach(function(n){hnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hnt(t,e,r){return(e=Ant(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ant(t){var e=mnt(t,"string");return typeof e=="symbol"?e:e+""}function mnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pnt(t,e,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=e,{end:c}=e,u=function(A){var h=s[A],m,p=()=>(m===void 0&&(m=r(h,A)),m);if(A===o-1){var x=t*(h.coordinate+t*p()/2-c);s[A]=h=Yl(Yl({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate})}else s[A]=h=Yl(Yl({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var v=cw(t,h.tickCoord,p,l,c);v&&(c=h.tickCoord-t*(p()/2+a),s[A]=Yl(Yl({},h),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function gnt(t,e,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(s){var d=n[l-1],f=r(d,l-1),A=t*(d.coordinate+t*f/2-u);if(o[l-1]=d=Yl(Yl({},d),{},{tickCoord:A>0?d.coordinate-A*t:d.coordinate}),d.tickCoord!=null){var h=cw(t,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-t*(f/2+a),o[l-1]=Yl(Yl({},d),{},{isShow:!0}))}}for(var m=s?l-1:l,p=function(y){var b=o[y],w,j=()=>(w===void 0&&(w=r(b,y)),w);if(y===0){var I=t*(b.coordinate-t*j()/2-c);o[y]=b=Yl(Yl({},b),{},{tickCoord:I<0?b.coordinate-I*t:b.coordinate})}else o[y]=b=Yl(Yl({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var _=cw(t,b.tickCoord,j,c,u);_&&(c=b.tickCoord+t*(j()/2+a),o[y]=Yl(Yl({},b),{},{isShow:!0}))}},x=0;x<m;x++)p(x);return o}function xnt(t,e,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=t;if(!a||!a.length||!n)return[];if(Cn(c)||zP.isSsr){var A;return(A=unt(a,Cn(c)?c:0))!==null&&A!==void 0?A:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",p=d&&m==="width"?Qb(d,{fontSize:e,letterSpacing:r}):{width:0,height:0},x=(b,w)=>{var j=typeof u=="function"?u(b.value,w):b.value;return m==="width"?lnt(Qb(j,{fontSize:e,letterSpacing:r}),p,f):Qb(j,{fontSize:e,letterSpacing:r})[m]},v=a.length>=2?Pl(a[1].coordinate-a[0].coordinate):1,y=cnt(s,v,m);return c==="equidistantPreserveStart"?dnt(v,y,x,a,o):c==="equidistantPreserveEnd"?fnt(v,y,x,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=gnt(v,y,x,a,o,c==="preserveStartEnd"):h=pnt(v,y,x,a,o),h.filter(b=>b.isShow))}var vnt=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=t,o=0;if(e){Array.from(e).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},ynt=["axisLine","width","height","className","hide","ticks","axisType"];function bnt(t,e){if(t==null)return{};var r,n,a=wnt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function wnt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function _g(){return _g=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_g.apply(null,arguments)}function Qz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ao(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qz(Object(r),!0).forEach(function(n){Nnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nnt(t,e,r){return(e=Cnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cnt(t){var e=_nt(t,"string");return typeof e=="symbol"?e:e+""}function _nt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zp={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:ac.axis};function Ent(t){var{x:e,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=ao(ao(ao({},c),ch(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=ao(ao({},u),{},{x1:e,y1:r+d*a,x2:e+n,y2:r+d*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=ao(ao({},u),{},{x1:e+f*n,y1:r,x2:e+f*n,y2:r+a})}return g.createElement("line",_g({},u,{className:as("recharts-cartesian-axis-line",vg(l,"className"))}))}function Snt(t,e,r,n,a,s,o,l,c){var u,d,f,A,h,m,p=l?-1:1,x=t.tickSize||o,v=Cn(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":u=d=t.coordinate,A=r+ +!l*a,f=A-p*x,m=f-p*c,h=v;break;case"left":f=A=t.coordinate,d=e+ +!l*n,u=d-p*x,h=u-p*c,m=v;break;case"right":f=A=t.coordinate,d=e+ +l*n,u=d+p*x,h=u+p*c,m=v;break;default:u=d=t.coordinate,A=r+ +l*a,f=A+p*x,m=f+p*c,h=v;break}return{line:{x1:u,y1:f,x2:d,y2:A},tick:{x:h,y:m}}}function Int(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function jnt(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function Pnt(t){var{option:e,tickProps:r,value:n}=t,a,s=as(r.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(e))a=g.cloneElement(e,ao(ao({},r),{},{className:s}));else if(typeof e=="function")a=e(ao(ao({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=as(o,e==null?void 0:e.className)),a=g.createElement(A3,_g({},r,{className:o}),n)}return a}var Bnt=g.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:A,y:h,width:m,height:p,tickSize:x,tickMargin:v,fontSize:y,letterSpacing:b,getTicksConfig:w,events:j,axisType:I}=t,_=xnt(ao(ao({},w),{},{ticks:r}),y,b),S=Int(d,f),E=jnt(d,f),B=ch(w),T=z2(n),P={};typeof a=="object"&&(P=a);var O=ao(ao({},B),{},{fill:"none"},P),z=_.map(ue=>ao({entry:ue},Snt(ue,A,h,m,p,d,x,f,v))),ce=z.map(ue=>{var{entry:me,line:se}=ue;return g.createElement(Bc,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(me.value,"-").concat(me.coordinate,"-").concat(me.tickCoord)},a&&g.createElement("line",_g({},O,se,{className:as("recharts-cartesian-axis-tick-line",vg(a,"className"))})))}),de=z.map((ue,me)=>{var{entry:se,tick:ke}=ue,Re=ao(ao(ao(ao({textAnchor:S,verticalAnchor:E},B),{},{stroke:"none",fill:s},T),ke),{},{index:me,payload:se,visibleTicksCount:_.length,tickFormatter:o,padding:c},u);return g.createElement(Bc,_g({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(se.value,"-").concat(se.coordinate,"-").concat(se.tickCoord)},Ww(j,se,me)),n&&g.createElement(Pnt,{option:n,tickProps:Re,value:"".concat(typeof o=="function"?o(se.value,me):se.value).concat(l||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(I,"-ticks")},de.length>0&&g.createElement(vh,{zIndex:ac.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(I,"-tick-labels"),ref:e},de)),ce.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(I,"-tick-lines")},ce))}),Tnt=g.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l,axisType:c}=t,u=bnt(t,ynt),[d,f]=g.useState(""),[A,h]=g.useState(""),m=g.useRef(null);g.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var x;return vnt({ticks:m.current,label:(x=t.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var p=g.useCallback(x=>{if(x){var v=x.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=v;var y=v[0];if(y){var b=window.getComputedStyle(y),w=b.fontSize,j=b.letterSpacing;(w!==d||j!==A)&&(f(w),h(j))}}},[d,A]);return o||n!=null&&n<=0||a!=null&&a<=0?null:g.createElement(vh,{zIndex:t.zIndex},g.createElement(Bc,{className:as("recharts-cartesian-axis",s)},g.createElement(Ent,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:ch(t)}),g.createElement(Bnt,{ref:p,axisType:c,events:u,fontSize:d,getTicksConfig:t,height:t.height,letterSpacing:A,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),g.createElement(Vet,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},g.createElement(Jet,{label:t.label,labelRef:t.labelRef}),t.children)))}),R8=g.forwardRef((t,e)=>{var r=kl(t,zp);return g.createElement(Tnt,_g({},r,{ref:e}))});R8.displayName="CartesianAxis";var knt={},Rue=uu({name:"errorBars",initialState:knt,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:oot,replaceErrorBar:lot,removeErrorBar:cot}=Rue.actions,Fnt=Rue.reducer,Ont=["children"];function Dnt(t,e){if(t==null)return{};var r,n,a=Rnt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Rnt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Mnt={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Lnt=g.createContext(Mnt);function Unt(t){var{children:e}=t,r=Dnt(t,Ont);return g.createElement(Lnt.Provider,{value:r},e)}function Mue(t,e){var r,n,a=pn(u=>HA(u,t)),s=pn(u=>$A(u,e)),o=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Go.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:Ko.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function Qnt(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=Tue(),{needClipX:s,needClipY:o,needClip:l}=Mue(e,r);if(!l||!a)return null;var{x:c,y:u,width:d,height:f}=a;return g.createElement("clipPath",{id:"clipPath-".concat(n)},g.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var Vnt={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mN=g;function Hnt(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $nt=typeof Object.is=="function"?Object.is:Hnt,Gnt=mN.useSyncExternalStore,Knt=mN.useRef,qnt=mN.useEffect,znt=mN.useMemo,Wnt=mN.useDebugValue;Vnt.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=Knt(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=znt(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,$nt(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=Gnt(t,s[0],s[1]);return qnt(function(){o.hasValue=!0,o.value=l},[l]),Wnt(l),l};function Xnt(t){t()}function Ynt(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Xnt(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var Vz={notify(){},get:()=>[]};function Jnt(t,e){let r,n=Vz,a=0,s=!1;function o(p){d();const x=n.subscribe(p);let v=!1;return()=>{v||(v=!0,x(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){a++,r||(r=t.subscribe(c),n=Ynt())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Vz)}function A(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:A,tryUnsubscribe:h,getListeners:()=>n};return m}var Znt=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eat=Znt(),tat=()=>typeof navigator<"u"&&navigator.product==="ReactNative",rat=tat(),nat=()=>eat||rat?g.useLayoutEffect:g.useEffect,aat=nat();function Hz(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function sat(t,e){if(Hz(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(e,r[a])||!Hz(t[r[a]],e[r[a]]))return!1;return!0}var PB=Symbol.for("react-redux-context"),BB=typeof globalThis<"u"?globalThis:{};function iat(){if(!g.createContext)return{};const t=BB[PB]??(BB[PB]=new Map);let e=t.get(g.createContext);return e||(e=g.createContext(null),t.set(g.createContext,e)),e}var oat=iat();function lat(t){const{children:e,context:r,serverState:n,store:a}=t,s=g.useMemo(()=>{const c=Jnt(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=g.useMemo(()=>a.getState(),[a]);aat(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||oat;return g.createElement(l.Provider,{value:s},e)}var cat=lat,uat=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function dat(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function M8(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(uat.has(n)){if(t[n]==null&&e[n]==null)continue;if(!sat(t[n],e[n]))return!1}else if(!dat(t[n],e[n]))return!1;return!0}function Kg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:Pue}function qg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:Pue}var fat="Invariant failed";function hat(t,e){throw new Error(fat)}function mO(){return mO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mO.apply(null,arguments)}function zI(t){return g.createElement(_ue,mO({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var Aat=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Cn(e))return e;var s=Cn(n)||sl(n);return s?e(n,a):(s||hat(),r)}},mat=(t,e,r)=>r,pat=(t,e)=>e,pN=er([YM,pat],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),gat=er([pN],t=>t==null?void 0:t.maxBarSize),xat=(t,e,r,n)=>n,vat=er([Ta,YM,Kg,qg,mat],(t,e,r,n,a)=>e.filter(s=>t==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),yat=(t,e,r)=>{var n=Ta(t),a=Kg(t,e),s=qg(t,e);if(!(a==null||s==null))return n==="horizontal"?lO(t,"yAxis",s,r):lO(t,"xAxis",a,r)},bat=(t,e)=>{var r=Ta(t),n=Kg(t,e),a=qg(t,e);if(!(n==null||a==null))return r==="horizontal"?Hq(t,"xAxis",n):Hq(t,"yAxis",a)},wat=er([vat,HXe,bat],$rt),Nat=(t,e,r)=>{var n,a,s=pN(t,e);if(s!=null){var o=Kg(t,e),l=qg(t,e);if(!(o==null||l==null)){var c=Ta(t),u=Kle(t),{maxBarSize:d}=s,f=sl(d)?u:d,A,h;return c==="horizontal"?(A=Jv(t,"xAxis",o,r),h=Yv(t,"xAxis",o,r)):(A=Jv(t,"yAxis",l,r),h=Yv(t,"yAxis",l,r)),(n=(a=wI(A,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0}}},Lue=(t,e,r)=>{var n=Ta(t),a=Kg(t,e),s=qg(t,e);if(!(a==null||s==null)){var o,l;return n==="horizontal"?(o=Jv(t,"xAxis",a,r),l=Yv(t,"xAxis",a,r)):(o=Jv(t,"yAxis",s,r),l=Yv(t,"yAxis",s,r)),wI(o,l)}},Cat=er([wat,Kle,VXe,qle,Nat,Lue,gat],Wrt),_at=(t,e,r)=>{var n=Kg(t,e);if(n!=null)return Jv(t,"xAxis",n,r)},Eat=(t,e,r)=>{var n=qg(t,e);if(n!=null)return Jv(t,"yAxis",n,r)},Sat=(t,e,r)=>{var n=Kg(t,e);if(n!=null)return Yv(t,"xAxis",n,r)},Iat=(t,e,r)=>{var n=qg(t,e);if(n!=null)return Yv(t,"yAxis",n,r)},jat=er([Cat,pN],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),Pat=er([yat,pN],Xrt),Bat=er([Ro,fM,_at,Eat,Sat,Iat,jat,Ta,PXe,Lue,Pat,pN,xat],(t,e,r,n,a,s,o,l,c,u,d,f,A)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:p}=c;if(!(f==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||u==null)){var{data:x}=f,v;if(x!=null&&x.length>0?v=x:v=h==null?void 0:h.slice(m,p+1),v!=null)return ist({layout:l,barSettings:f,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:v,offset:t,cells:A,dataStartIndex:m})}}),Tat=["index"];function pO(){return pO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pO.apply(null,arguments)}function kat(t,e){if(t==null)return{};var r,n,a=Fat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Fat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Uue=g.createContext(void 0),Oat=t=>{var e=g.useContext(Uue);if(e!=null)return e.stackId;if(t!=null)return BGe(t)},Dat=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),Rat=t=>{var e=g.useContext(Uue);if(e!=null){var{stackId:r}=e;return"url(#".concat(Dat(r,t),")")}},Mat=t=>{var{index:e}=t,r=kat(t,Tat),n=Rat(e);return g.createElement(Bc,pO({className:"recharts-bar-stack-layer",clipPath:n},r))},Lat=["onMouseEnter","onMouseLeave","onClick"],Uat=["value","background","tooltipPosition"],Qat=["id"],Vat=["onMouseEnter","onClick","onMouseLeave"];function IA(){return IA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IA.apply(null,arguments)}function $z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Cc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$z(Object(r),!0).forEach(function(n){Hat(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$z(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hat(t,e,r){return(e=$at(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $at(t){var e=Gat(t,"string");return typeof e=="symbol"?e:e+""}function Gat(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WI(t,e){if(t==null)return{};var r,n,a=Kat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Kat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var qat=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:s}=t;return[{inactive:s,dataKey:e,type:a,color:n,value:MP(r,e),payload:t}]},zat=g.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l,tooltipType:c,id:u}=t,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:MP(s,e),hide:o,type:c,color:a,unit:l,graphicalItemId:u}};return g.createElement(Eue,{tooltipEntrySettings:d})});function Wat(t){var e=pn(Cg),{data:r,dataKey:n,background:a,allOtherBarProps:s}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=WI(s,Lat),d=k8(o,n,s.id),f=F8(l),A=O8(c,n,s.id);if(!a||r==null)return null;var h=z2(a);return g.createElement(vh,{zIndex:Yrt(a,ac.barBackground)},r.map((m,p)=>{var{value:x,background:v,tooltipPosition:y}=m,b=WI(m,Uat);if(!v)return null;var w=d(m,p),j=f(m,p),I=A(m,p),_=Cc(Cc(Cc(Cc(Cc({option:a,isActive:String(p)===e},b),{},{fill:"#eee"},v),h),Ww(u,m,p)),{},{onMouseEnter:w,onMouseLeave:j,onClick:I,dataKey:n,index:p,className:"recharts-bar-background-rectangle"});return g.createElement(zI,IA({key:"background-bar-".concat(p)},_))}))}function Xat(t){var{showLabels:e,children:r,rects:n}=t,a=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Cc(Cc({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return g.createElement(stt,{value:e?a:void 0},r)}function Yat(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=t,l=pn(Cg),c=pn(w8),u=r&&String(s)===l&&(c==null||o===c),d=u?r:e;return u?g.createElement(vh,{zIndex:ac.activeBar},g.createElement(zI,IA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))):g.createElement(zI,IA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))}function Jat(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:s}=t;return g.createElement(zI,IA({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:a,dataKey:s}))}function Zat(t){var e,{data:r,props:n}=t,a=(e=ch(n))!==null&&e!==void 0?e:{},{id:s}=a,o=WI(a,Qat),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:A}=n,h=WI(n,Vat),m=k8(d,c,s),p=F8(A),x=O8(f,c,s);return r?g.createElement(g.Fragment,null,r.map((v,y)=>g.createElement(Mat,IA({index:y,key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(y),className:"recharts-bar-rectangle"},Ww(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),u?g.createElement(Yat,{shape:l,activeBar:u,baseProps:o,entry:v,index:y,dataKey:c}):g.createElement(Jat,{shape:l,baseProps:o,entry:v,index:y,dataKey:c})))):null}function est(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=e,f=r.current,A=XP(e,"recharts-bar-"),[h,m]=g.useState(!1),p=!h,x=g.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),v=g.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return g.createElement(Xat,{showLabels:p,rects:n},g.createElement(WP,{animationId:A,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:x,onAnimationStart:v,key:A},y=>{var b=y===1?n:n==null?void 0:n.map((w,j)=>{var I=f&&f[j];if(I)return Cc(Cc({},w),{},{x:Eo(I.x,w.x,y),y:Eo(I.y,w.y,y),width:Eo(I.width,w.width,y),height:Eo(I.height,w.height,y)});if(a==="horizontal"){var _=Eo(0,w.height,y),S=Eo(w.stackedBarStart,w.y,y);return Cc(Cc({},w),{},{y:S,height:_})}var E=Eo(0,w.width,y),B=Eo(w.stackedBarStart,w.x,y);return Cc(Cc({},w),{},{width:E,x:B})});return y>0&&(r.current=b??null),b==null?null:g.createElement(Bc,null,g.createElement(Zat,{props:e,data:b}))}),g.createElement(gue,{label:e.label}),e.children)}function tst(t){var e=g.useRef(null);return g.createElement(est,{previousRectanglesRef:e,props:t})}var Que=0,rst=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:ks(t,e)}};class nst extends g.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var d=as("recharts-bar",a),f=u;return g.createElement(Bc,{className:d,id:u},l&&g.createElement("defs",null,g.createElement(Qnt,{clipPathId:f,xAxisId:s,yAxisId:o})),g.createElement(Bc,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},g.createElement(Wat,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),g.createElement(tst,this.props)))}}var ast={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:Que,xAxisId:0,yAxisId:0,zIndex:ac.bar};function sst(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=t,{needClip:f}=Mue(e,r),A=Zw(),h=qu(),m=T8(t.children,AN),p=pn(y=>Bat(y,t.id,h,m));if(A!=="vertical"&&A!=="horizontal")return null;var x,v=p==null?void 0:p[0];return v==null||v.height==null||v.width==null?x=0:x=A==="vertical"?v.height/2:v.width/2,g.createElement(Unt,{xAxisId:e,yAxisId:r,data:p,dataPointFormatter:rst,errorBarOffset:x},g.createElement(nst,IA({},t,{layout:A,needClip:f,data:p,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function ist(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:A,cells:h,parentViewBox:m,dataStartIndex:p}=t,x=e==="horizontal"?l:o,v=d?x.scale.domain():null,y=TGe({numericAxis:x}),b=x.scale(y);return f.map((w,j)=>{var I,_,S,E,B,T;if(d){var P=d[j+p];if(P==null)return null;I=EGe(P,v)}else I=ks(w,r),Array.isArray(I)||(I=[y,I]);var O=Aat(n,Que)(I[1],j);if(e==="horizontal"){var z,[ce,de]=[l.scale(I[0]),l.scale(I[1])];_=ZG({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:w,index:j}),S=(z=de??ce)!==null&&z!==void 0?z:void 0,E=a.size;var ue=ce-de;if(B=uh(ue)?0:ue,T={x:_,y:A.top,width:E,height:A.height},Math.abs(O)>0&&Math.abs(B)<Math.abs(O)){var me=Pl(B||O)*(Math.abs(O)-Math.abs(B));S-=me,B+=me}}else{var[se,ke]=[o.scale(I[0]),o.scale(I[1])];if(_=se,S=ZG({axis:l,ticks:u,bandSize:s,offset:a.offset,entry:w,index:j}),E=ke-se,B=a.size,T={x:A.left,y:S,width:A.width,height:B},Math.abs(O)>0&&Math.abs(E)<Math.abs(O)){var Re=Pl(E||O)*(Math.abs(O)-Math.abs(E));E+=Re}}if(_==null||S==null||E==null||B==null)return null;var F=Cc(Cc({},w),{},{stackedBarStart:b,x:_,y:S,width:E,height:B,value:d?I:I[1],payload:w,background:T,tooltipPosition:{x:_+E/2,y:S+B/2},parentViewBox:m},h&&h[j]&&h[j].props);return F}).filter(Boolean)}function ost(t){var e=kl(t,ast),r=Oat(e.stackId),n=qu();return g.createElement(Sue,{id:e.id,type:"bar"},a=>g.createElement(g.Fragment,null,g.createElement(Htt,{legendPayload:qat(e)}),g.createElement(zat,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:a}),g.createElement(nrt,{type:"bar",id:a,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),g.createElement(vh,{zIndex:e.zIndex},g.createElement(sst,IA({},e,{id:a})))))}var gO=g.memo(ost,M8);gO.displayName="Bar";var lst=["domain","range"],cst=["domain","range"];function Gz(t,e){if(t==null)return{};var r,n,a=ust(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function ust(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Kz(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function Vue(t,e){if(t===e)return!0;var{domain:r,range:n}=t,a=Gz(t,lst),{domain:s,range:o}=e,l=Gz(e,cst);return!Kz(r,s)||!Kz(n,o)?!1:M8(a,l)}var dst=["dangerouslySetInnerHTML","ticks","scale"],fst=["id","scale"];function xO(){return xO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xO.apply(null,arguments)}function qz(t,e){if(t==null)return{};var r,n,a=hst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function hst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Ast(t){var e=Cs(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Frt(t)):r.current!==t&&e(Ort({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(Drt(r.current)),r.current=null)},[e]),null}var mst=t=>{var{xAxisId:e,className:r}=t,n=pn(fM),a=qu(),s="xAxis",o=pn(v=>_ce(v,s,e,a)),l=pn(v=>bce(v,e)),c=pn(v=>UYe(v,e)),u=pn(v=>rce(v,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:A}=t,h=qz(t,dst),{id:m,scale:p}=u,x=qz(u,fst);return g.createElement(R8,xO({},h,x,{x:c.x,y:c.y,width:l.width,height:l.height,className:as("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},pst={allowDataOverflow:Go.allowDataOverflow,allowDecimals:Go.allowDecimals,allowDuplicatedCategory:Go.allowDuplicatedCategory,angle:Go.angle,axisLine:zp.axisLine,height:Go.height,hide:!1,includeHidden:Go.includeHidden,interval:Go.interval,minTickGap:Go.minTickGap,mirror:Go.mirror,orientation:Go.orientation,padding:Go.padding,reversed:Go.reversed,scale:Go.scale,tick:Go.tick,tickCount:Go.tickCount,tickLine:zp.tickLine,tickSize:zp.tickSize,type:Go.type,xAxisId:0},gst=t=>{var e=kl(t,pst);return g.createElement(g.Fragment,null,g.createElement(Ast,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),g.createElement(mst,e))},Hue=g.memo(gst,Vue);Hue.displayName="XAxis";var xst=["dangerouslySetInnerHTML","ticks","scale"],vst=["id","scale"];function vO(){return vO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vO.apply(null,arguments)}function zz(t,e){if(t==null)return{};var r,n,a=yst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function yst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function bst(t){var e=Cs(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Rrt(t)):r.current!==t&&e(Mrt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(Lrt(r.current)),r.current=null)},[e]),null}var wst=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,s=g.useRef(null),o=g.useRef(null),l=pn(fM),c=qu(),u=Cs(),d="yAxis",f=pn(I=>wce(I,e)),A=pn(I=>VYe(I,e)),h=pn(I=>_ce(I,d,e,c)),m=pn(I=>nce(I,e));if(g.useLayoutEffect(()=>{if(!(n!=="auto"||!f||S8(a)||g.isValidElement(a)||m==null)){var I=s.current;if(I){var _=I.getCalculatedWidth();Math.round(f.width)!==Math.round(_)&&u(Urt({id:e,width:_}))}}},[h,f,u,a,e,n,m]),f==null||A==null||m==null)return null;var{dangerouslySetInnerHTML:p,ticks:x,scale:v}=t,y=zz(t,xst),{id:b,scale:w}=m,j=zz(m,vst);return g.createElement(R8,vO({},y,j,{ref:s,labelRef:o,x:A.x,y:A.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:as("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:h,axisType:d}))},Nst={allowDataOverflow:Ko.allowDataOverflow,allowDecimals:Ko.allowDecimals,allowDuplicatedCategory:Ko.allowDuplicatedCategory,angle:Ko.angle,axisLine:zp.axisLine,hide:!1,includeHidden:Ko.includeHidden,interval:Ko.interval,minTickGap:Ko.minTickGap,mirror:Ko.mirror,orientation:Ko.orientation,padding:Ko.padding,reversed:Ko.reversed,scale:Ko.scale,tick:Ko.tick,tickCount:Ko.tickCount,tickLine:zp.tickLine,tickSize:zp.tickSize,type:Ko.type,width:Ko.width,yAxisId:0},Cst=t=>{var e=kl(t,Nst);return g.createElement(g.Fragment,null,g.createElement(bst,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),g.createElement(wst,e))},$ue=g.memo(Cst,Vue);$ue.displayName="YAxis";var _st=(t,e)=>e,L8=er([_st,Ta,ece,Lo,Qce,GA,nZe,Ro],uZe),U8=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Gue=Rd("mouseClick"),Kue=Yw();Kue.startListening({actionCreator:Gue,effect:(t,e)=>{var r=t.payload,n=L8(e.getState(),U8(r));(n==null?void 0:n.activeIndex)!=null&&e.dispatch(rJe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var yO=Rd("mouseMove"),que=Yw(),B_=null;que.startListening({actionCreator:yO,effect:(t,e)=>{var r=t.payload;B_!==null&&cancelAnimationFrame(B_);var n=U8(r);B_=requestAnimationFrame(()=>{var a=e.getState(),s=p8(a,a.tooltip.settings.shared);if(s==="axis"){var o=L8(a,n);(o==null?void 0:o.activeIndex)!=null?e.dispatch(kce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(Tce())}B_=null})}});function Est(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var Wz={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},zue=uu({name:"rootProps",initialState:Wz,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:Wz.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),Sst=zue.reducer,{updateOptions:Ist}=zue.actions,Wue=uu({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:jst}=Wue.actions,Pst=Wue.reducer,Xue=Rd("keyDown"),Yue=Rd("focus"),Q8=Yw();Q8.startListening({actionCreator:Xue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=t.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=g8(a,T1(r),cN(r),fN(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=GA(r);if(s==="Enter"){var u=$I(r,"axis","hover",String(a.index));e.dispatch(uO({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=KYe(r),f=d==="left-to-right"?1:-1,A=s==="ArrowRight"?1:-1,h=l+A*f;if(!(c==null||h>=c.length||h<0)){var m=$I(r,"axis","hover",String(h));e.dispatch(uO({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});Q8.startListening({actionCreator:Yue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=$I(r,"axis","hover",String(s));e.dispatch(uO({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var fd=Rd("externalEvent"),Jue=Yw(),TB=new Map;Jue.startListening({actionCreator:fd,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var a=n.type,s=TB.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:VJe(l),activeDataKey:w8(l),activeIndex:Cg(l),activeLabel:$ce(l),activeTooltipIndex:Cg(l),isTooltipActive:HJe(l)};r(c,n)}finally{TB.delete(a)}});TB.set(a,o)}}});var Bst=er([P1],t=>t.tooltipItemPayloads),Tst=er([Bst,dN,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(l=>l.settings.graphicalItemId===n);if(a!=null){var{positions:s}=a;if(s!=null){var o=e(s,r);return o}}}),Zue=Rd("touchMove"),ede=Yw();ede.startListening({actionCreator:Zue,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),a=p8(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var o=L8(n,U8({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&e.dispatch(kce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(goe),f=(l=u.getAttribute(xoe))!==null&&l!==void 0?l:void 0,A=B1(n).find(p=>p.id===f);if(d==null||A==null||f==null)return;var{dataKey:h}=A,m=Tst(n,d,f);e.dispatch(Bce({activeDataKey:h,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var kst=Qie({brush:Jrt,cartesianAxis:Qrt,chartData:UZe,errorBars:Fnt,graphicalItems:trt,layout:yGe,legend:_Ke,options:OZe,polarAxis:ptt,polarOptions:Pst,referenceElements:snt,rootProps:Sst,tooltip:nJe,zIndex:CZe}),Fst=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return G$e({reducer:kst,preloadedState:e,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([Kue.middleware,que.middleware,Q8.middleware,Jue.middleware,ede.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(roe({type:"raf"}))},devTools:{serialize:{replacer:Est},name:"recharts-".concat(r)}})};function tde(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=qu(),s=g.useRef(null);if(a)return r;s.current==null&&(s.current=Fst(e,n));var o=nM;return g.createElement(cat,{context:o,store:s.current},r)}function Ost(t){var{layout:e,margin:r}=t,n=Cs(),a=qu();return g.useEffect(()=>{a||(n(gGe(e)),n(pGe(r)))},[n,a,e,r]),null}var rde=g.memo(Ost,M8);function nde(t){var e=Cs();return g.useEffect(()=>{e(Ist(t))},[e,t]),null}function Xz(t){var{zIndex:e,isPanorama:r}=t,n=g.useRef(null),a=Cs();return g.useLayoutEffect(()=>(n.current&&a(wZe({zIndex:e,element:n.current,isPanorama:r})),()=>{a(NZe({zIndex:e,isPanorama:r}))}),[a,e,r]),g.createElement("g",{tabIndex:-1,ref:n})}function Yz(t){var{children:e,isPanorama:r}=t,n=pn(fZe);if(!n||n.length===0)return e;var a=n.filter(o=>o<0),s=n.filter(o=>o>0);return g.createElement(g.Fragment,null,a.map(o=>g.createElement(Xz,{key:o,zIndex:o,isPanorama:r})),e,s.map(o=>g.createElement(Xz,{key:o,zIndex:o,isPanorama:r})))}var Dst=["children"];function Rst(t,e){if(t==null)return{};var r,n,a=Mst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Mst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function XI(){return XI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},XI.apply(null,arguments)}var Lst={width:"100%",height:"100%",display:"block"},Ust=g.forwardRef((t,e)=>{var r=Eoe(),n=Soe(),a=Moe();if(!Bm(r)||!Bm(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=t,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0),g.createElement(VR,XI({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:Lst,ref:e}),s)}),Qst=t=>{var{children:e}=t,r=pn(VP);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return g.createElement(VR,{width:n,height:a,x:o,y:s},e)},Jz=g.forwardRef((t,e)=>{var{children:r}=t,n=Rst(t,Dst),a=qu();return a?g.createElement(Qst,null,g.createElement(Yz,{isPanorama:!0},r)):g.createElement(Ust,XI({ref:e},n),g.createElement(Yz,{isPanorama:!1},r))});function Vst(){var t=Cs(),[e,r]=g.useState(null),n=pn(MGe);return g.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),s=a.width/e.offsetWidth;Ai(s)&&s!==n&&t(vGe(s))}},[e,t,n]),r}function Zz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Hst(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zz(Object(r),!0).forEach(function(n){$st(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $st(t,e,r){return(e=Gst(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gst(t){var e=Kst(t,"string");return typeof e=="symbol"?e:e+""}function Kst(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eg(){return Eg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Eg.apply(null,arguments)}var qst=()=>(WZe(),null);function YI(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var zst=g.forwardRef((t,e)=>{var r,n,a=g.useRef(null),[s,o]=g.useState({containerWidth:YI((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:YI((n=t.style)===null||n===void 0?void 0:n.height)}),l=g.useCallback((u,d)=>{o(f=>{var A=Math.round(u),h=Math.round(d);return f.containerWidth===A&&f.containerHeight===h?f:{containerWidth:A,containerHeight:h}})},[]),c=g.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var A=m=>{var{width:p,height:x}=m[0].contentRect;l(p,x)},h=new ResizeObserver(A);h.observe(u),a.current=h}},[e,l]);return g.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[l]),g.createElement(g.Fragment,null,g.createElement($P,{width:s.containerWidth,height:s.containerHeight}),g.createElement("div",Eg({ref:c},t)))}),Wst=g.forwardRef((t,e)=>{var{width:r,height:n}=t,[a,s]=g.useState({containerWidth:YI(r),containerHeight:YI(n)}),o=g.useCallback((c,u)=>{s(d=>{var f=Math.round(c),A=Math.round(u);return d.containerWidth===f&&d.containerHeight===A?d:{containerWidth:f,containerHeight:A}})},[]),l=g.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[e,o]);return g.createElement(g.Fragment,null,g.createElement($P,{width:a.containerWidth,height:a.containerHeight}),g.createElement("div",Eg({ref:l},t)))}),Xst=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return g.createElement(g.Fragment,null,g.createElement($P,{width:r,height:n}),g.createElement("div",Eg({ref:e},t)))}),Yst=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return wA(r)||wA(n)?g.createElement(Wst,Eg({},t,{ref:e})):g.createElement(Xst,Eg({},t,{ref:e}))});function Jst(t){return t===!0?zst:Yst}var Zst=g.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:A,onTouchEnd:h,onTouchMove:m,onTouchStart:p,style:x,width:v,responsive:y,dispatchTouchEvents:b=!0}=t,w=g.useRef(null),j=Cs(),[I,_]=g.useState(null),[S,E]=g.useState(null),B=Vst(),T=hM(),P=(T==null?void 0:T.width)>0?T.width:v,O=(T==null?void 0:T.height)>0?T.height:a,z=g.useCallback(Q=>{B(Q),typeof e=="function"&&e(Q),_(Q),E(Q),Q!=null&&(w.current=Q)},[B,e,_,E]),ce=g.useCallback(Q=>{j(Gue(Q)),j(fd({handler:s,reactEvent:Q}))},[j,s]),de=g.useCallback(Q=>{j(yO(Q)),j(fd({handler:u,reactEvent:Q}))},[j,u]),ue=g.useCallback(Q=>{j(Tce()),j(fd({handler:d,reactEvent:Q}))},[j,d]),me=g.useCallback(Q=>{j(yO(Q)),j(fd({handler:f,reactEvent:Q}))},[j,f]),se=g.useCallback(()=>{j(Yue())},[j]),ke=g.useCallback(Q=>{j(Xue(Q.key))},[j]),Re=g.useCallback(Q=>{j(fd({handler:o,reactEvent:Q}))},[j,o]),F=g.useCallback(Q=>{j(fd({handler:l,reactEvent:Q}))},[j,l]),H=g.useCallback(Q=>{j(fd({handler:c,reactEvent:Q}))},[j,c]),K=g.useCallback(Q=>{j(fd({handler:A,reactEvent:Q}))},[j,A]),L=g.useCallback(Q=>{j(fd({handler:p,reactEvent:Q}))},[j,p]),W=g.useCallback(Q=>{b&&j(Zue(Q)),j(fd({handler:m,reactEvent:Q}))},[j,b,m]),Y=g.useCallback(Q=>{j(fd({handler:h,reactEvent:Q}))},[j,h]),D=Jst(y);return g.createElement(Yce.Provider,{value:I},g.createElement(Vse.Provider,{value:S},g.createElement(D,{width:P??(x==null?void 0:x.width),height:O??(x==null?void 0:x.height),className:as("recharts-wrapper",n),style:Hst({position:"relative",cursor:"default",width:P,height:O},x),onClick:ce,onContextMenu:Re,onDoubleClick:F,onFocus:se,onKeyDown:ke,onMouseDown:H,onMouseEnter:de,onMouseLeave:ue,onMouseMove:me,onMouseUp:K,onTouchEnd:Y,onTouchMove:W,onTouchStart:L,ref:z},g.createElement(qst,null),r)))}),eit=["width","height","responsive","children","className","style","compact","title","desc"];function tit(t,e){if(t==null)return{};var r,n,a=rit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function rit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var ade=g.forwardRef((t,e)=>{var{width:r,height:n,responsive:a,children:s,className:o,style:l,compact:c,title:u,desc:d}=t,f=tit(t,eit),A=ch(f);return c?g.createElement(g.Fragment,null,g.createElement($P,{width:r,height:n}),g.createElement(Jz,{otherAttributes:A,title:u,desc:d},s)):g.createElement(Zst,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},g.createElement(Jz,{otherAttributes:A,title:u,desc:d,ref:e},g.createElement(ont,null,s)))});function bO(){return bO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bO.apply(null,arguments)}var nit={top:5,right:5,bottom:5,left:5},ait={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:nit,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},sit=g.forwardRef(function(e,r){var n,a=kl(e.categoricalChartProps,ait),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return g.createElement(tde,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},g.createElement(kue,{chartData:u.data}),g.createElement(rde,{layout:a.layout,margin:a.margin}),g.createElement(nde,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(ade,bO({},a,{ref:r})))}),iit=["axis","item"],oit=g.forwardRef((t,e)=>g.createElement(sit,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:iit,tooltipPayloadSearcher:Zce,categoricalChartProps:t,ref:e}));function lit(t){var e=Cs();return g.useEffect(()=>{e(jst(t))},[e,t]),null}var cit=["layout"];function wO(){return wO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wO.apply(null,arguments)}function uit(t,e){if(t==null)return{};var r,n,a=dit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function dit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var fit={top:5,right:5,bottom:5,left:5},sde={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:fit,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},hit=g.forwardRef(function(e,r){var n,a=kl(e.categoricalChartProps,sde),{layout:s}=a,o=uit(a,cit),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return g.createElement(tde,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},g.createElement(kue,{chartData:a.data}),g.createElement(rde,{layout:s,margin:a.margin}),g.createElement(nde,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(lit,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),g.createElement(ade,wO({},o,{ref:r})))});function eW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eW(Object(r),!0).forEach(function(n){Ait(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ait(t,e,r){return(e=mit(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mit(t){var e=pit(t,"string");return typeof e=="symbol"?e:e+""}function pit(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var git=["item"],xit=tW(tW({},sde),{},{layout:"centric",startAngle:0,endAngle:360}),vit=g.forwardRef((t,e)=>{var r=kl(t,xit);return g.createElement(hit,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:git,tooltipPayloadSearcher:Zce,categoricalChartProps:r,ref:e})});const yit="sellers_candies",T_="cash_deliveries_candies";function Oa(t){const e=typeof t=="number"?t:parseFloat(String(t??"").replace(/,/g,""));return Number.isFinite(e)?e:0}function Oi(t){return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function k_(t,e){return t*e/100}function F_(t,e,r){return t-e-r}function rW(t){return t?Mr(t.toDate(),"yyyy-MM-dd"):""}function O_(t){if(!t)return vr.fromDate(new Date);const[e,r,n]=t.split("-").map(s=>parseInt(s,10)),a=new Date(e,(r||1)-1,n||1,0,0,0,0);return vr.fromDate(a)}function bit(){const t=new Date,[e,r]=g.useState(Mr(Ud(t),"yyyy-MM-dd")),[n,a]=g.useState(Mr(Ld(t),"yyyy-MM-dd")),[s,o]=g.useState([]),l=g.useMemo(()=>{const D=new Map;return s.forEach(Q=>D.set(Q.id,Q)),D},[s]),[c,u]=g.useState([]),[d,f]=g.useState(!0),[A,h]=g.useState(()=>Mr(new Date,"yyyy-MM-dd")),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState("0"),[w,j]=g.useState(""),[I,_]=g.useState(null),[S,E]=g.useState({}),B=g.useRef(null);g.useEffect(()=>{const D=sr(yt(Ie,yit),In("name","asc")),Q=jd(D,ee=>{const ve=ee.docs.map(M=>{const Ye=M.data();return{id:M.id,name:String((Ye==null?void 0:Ye.name)??""),branch:Ye!=null&&Ye.branch?String(Ye.branch):"",commissionPercent:Oa((Ye==null?void 0:Ye.commissionPercent)??0)}});o(ve)},()=>o([]));return()=>Q()},[]),g.useEffect(()=>{f(!0);const D=O_(e),Q=new Date(O_(n).toDate().getTime());Q.setDate(Q.getDate()+1);const ee=vr.fromDate(Q),ve=sr(yt(Ie,T_),mr("date",">=",D),mr("date","<",ee),In("date","desc")),M=jd(ve,Ye=>{const ae=Ye.docs.map(X=>{const De=X.data();return{id:X.id,date:De==null?void 0:De.date,sellerId:String((De==null?void 0:De.sellerId)??""),sellerName:String((De==null?void 0:De.sellerName)??""),amountDelivered:Oa(De==null?void 0:De.amountDelivered),commissionPercent:Oa(De==null?void 0:De.commissionPercent),commissionPaid:Oa(De==null?void 0:De.commissionPaid),extraExpenses:Oa(De==null?void 0:De.extraExpenses),totalFinal:Oa(De==null?void 0:De.totalFinal),comment:String((De==null?void 0:De.comment)??""),createdAt:De==null?void 0:De.createdAt,updatedAt:De==null?void 0:De.updatedAt}});u(ae),f(!1)},Ye=>{console.error("Firestore deliveries query error:",Ye),u([]),f(!1),alert("Firestore query fall. Revis consola (probable ndice).")});return()=>M()},[e,n]);const T=g.useMemo(()=>m?l.get(m):void 0,[m,l]),P=Oa((T==null?void 0:T.commissionPercent)??0),O=Oa(x),z=Oa(y),ce=k_(O,P),de=F_(O,ce,z),ue=g.useMemo(()=>{var Q;const D=new Map;for(const ee of c){const ve=ee.sellerId||ee.sellerName||"UNKNOWN",M=D.get(ve)??{sellerId:ee.sellerId,sellerName:ee.sellerName||((Q=l.get(ee.sellerId))==null?void 0:Q.name)||"Sin nombre",delivered:0,commission:0,totalFinal:0};M.delivered+=Oa(ee.amountDelivered),M.commission+=Oa(ee.commissionPaid),M.totalFinal+=Oa(ee.totalFinal),D.set(ve,M)}return Array.from(D.values()).sort((ee,ve)=>ee.sellerName.localeCompare(ve.sellerName))},[c,l]),me=g.useMemo(()=>{let D=0,Q=0,ee=0,ve=0;for(const M of c)D+=Oa(M.amountDelivered),Q+=Oa(M.commissionPaid),ee+=Oa(M.extraExpenses),ve+=Oa(M.totalFinal);return{delivered:D,commission:Q,expenses:ee,totalFinal:ve}},[c]),se=g.useMemo(()=>ue.map(D=>({name:D.sellerName,Entregado:Number(D.delivered.toFixed(2)),Comision:Number(D.commission.toFixed(2))})),[ue]),ke=g.useMemo(()=>[{name:"Total Entregado (Bruto)",value:Number(me.delivered.toFixed(2))},{name:"Total Comisin",value:Number(me.commission.toFixed(2))},{name:"Total Gastos",value:Number(me.expenses.toFixed(2))}].filter(D=>D.value>0),[me]),Re=["#3B82F6","#F59E0B","#EF4444"];async function F(){if(!m)return alert("Seleccion un vendedor.");if(O<=0)return alert("Ingres un Monto entregado vlido (> 0).");const D=l.get(m),Q=(D==null?void 0:D.name)??"Sin nombre",ee=Oa((D==null?void 0:D.commissionPercent)??0),ve=k_(O,ee),M=F_(O,ve,z);await Jn(yt(Ie,T_),{date:O_(A),sellerId:m,sellerName:Q,amountDelivered:O,commissionPercent:ee,commissionPaid:ve,extraExpenses:z,totalFinal:M,comment:w??"",createdAt:vr.now()}),v(""),b("0"),j("")}function H(D){_(D.id),E({...D,dateInput:rW(D.date)})}function K(){_(null),E({})}async function L(D){const Q=S,ee=String(Q.sellerId??""),ve=l.get(ee),M=String(Q.sellerName??(ve==null?void 0:ve.name)??"Sin nombre"),Ye=Oa(Q.amountDelivered),ae=Oa(Q.extraExpenses),X=Oa(Q.commissionPercent??(ve==null?void 0:ve.commissionPercent)??0),De=k_(Ye,X),le=F_(Ye,De,ae),$e=O_(String(Q.dateInput??rW(Q.date)));await Fn(Zt(Ie,T_,D),{date:$e,sellerId:ee,sellerName:M,amountDelivered:Ye,commissionPercent:X,commissionPaid:De,extraExpenses:ae,totalFinal:le,comment:String(Q.comment??""),updatedAt:vr.now()}),K()}async function W(D){confirm("Eliminar este registro?")&&await Kn(Zt(Ie,T_,D))}async function Y(){if(!B.current)return;const D=await Fg(B.current,{scale:2,useCORS:!0,backgroundColor:"#ffffff",scrollX:0,scrollY:-window.scrollY}),Q=D.toDataURL("image/png"),ee=new rn("p","mm","a4"),ve=ee.internal.pageSize.getWidth(),M=ee.internal.pageSize.getHeight(),Ye=ve,ae=D.height*Ye/D.width;let X=ae,De=0;for(ee.addImage(Q,"PNG",0,De,Ye,ae),X-=M;X>0;)ee.addPage(),De=-(ae-X),ee.addImage(Q,"PNG",0,De,Ye,ae),X-=M;ee.save(`Entregas_Dulces_${e}_a_${n}.pdf`)}return i.jsxs("div",{className:"p-3 md:p-6 max-w-7xl mx-auto space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-2xl font-black text-gray-900",children:"Control Contable - Entregas de Vendedores (Dulces)"}),i.jsxs("p",{className:"text-xs md:text-sm text-gray-600",children:["Periodo: ",i.jsx("span",{className:"font-bold",children:e})," "," ",i.jsx("span",{className:"font-bold",children:n})]})]}),i.jsx("button",{onClick:Y,className:"h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Exportar a PDF"})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Filtros de periodo"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:e,onChange:D=>r(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:n,onChange:D=>a(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]})]}),i.jsxs("div",{ref:B,className:"space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"KPIs Consolidados"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Entradas (Neto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Oi(me.totalFinal)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Entregado - Comisin - Gastos"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Comisiones"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Oi(me.commission)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de comisin pagada"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Gastos extras"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Oi(me.expenses)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de gastos registrados"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"Total entregado (Bruto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Oi(me.delivered)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Sin restar nada"})]})]}),i.jsx("div",{className:"font-black text-sm text-gray-900 mt-4 mb-2",children:"KPI Vendedores (sumatoria del periodo)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[520px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"})]})}),i.jsx("tbody",{children:ue.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-2 text-gray-500",colSpan:4,children:"Sin datos en el periodo seleccionado."})}):ue.map(D=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Oi(D.delivered)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Oi(D.commission)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Oi(D.totalFinal)]})]},D.sellerId||D.sellerName))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Entregas y Comisin por vendedor (Barras)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(oK,{children:i.jsxs(oit,{data:se,children:[i.jsx(Hue,{dataKey:"name",interval:0,angle:-12,height:70}),i.jsx($ue,{}),i.jsx(sz,{}),i.jsx(KF,{}),i.jsx(gO,{dataKey:"Entregado"}),i.jsx(gO,{dataKey:"Comision"})]})})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Distribucin (Pastel)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(oK,{children:i.jsxs(vit,{children:[i.jsx(jue,{data:ke,dataKey:"value",nameKey:"name",outerRadius:110,label:!0,children:ke.map((D,Q)=>i.jsx(AN,{fill:Re[Q%Re.length]},Q))}),i.jsx(sz,{}),i.jsx(KF,{})]})})})]})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Agregar movimiento"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:A,onChange:D=>h(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:m,onChange:D=>p(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10 bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",inputMode:"decimal",value:x,onChange:D=>v(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin configurada"}),i.jsx("input",{value:`${P}%`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin pagada"}),i.jsx("input",{value:`$ ${Oi(ce)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",inputMode:"decimal",value:y,onChange:D=>b(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Total final"}),i.jsx("input",{value:`$ ${Oi(de)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-900 font-extrabold"})]}),i.jsxs("label",{className:"space-y-1 md:col-span-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{value:w,onChange:D=>j(D.target.value),placeholder:"Opcional...",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:F,className:"w-full md:w-auto h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Guardar movimiento"})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Registro detallado"}),d?i.jsx("div",{className:"text-sm text-gray-500",children:"Cargando..."}):c.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay registros en el periodo."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Monto entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin %"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin pagada"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Comentario"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Acciones"})]})}),i.jsx("tbody",{children:c.map(D=>{if(!(I===D.id))return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Mr(D.date.toDate(),"yyyy-MM-dd")}),i.jsx("td",{className:"p-2 font-semibold",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Oi(D.amountDelivered)]}),i.jsxs("td",{className:"p-2 text-right",children:[Oi(D.commissionPercent),"%"]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Oi(D.commissionPaid)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Oi(D.extraExpenses)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Oi(D.totalFinal)]}),i.jsx("td",{className:"p-2",children:D.comment}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>W(D.id),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},D.id);const ee=Oa(S.amountDelivered??D.amountDelivered),ve=Oa(S.commissionPercent??D.commissionPercent),M=Oa(S.extraExpenses??D.extraExpenses),Ye=k_(ee,ve),ae=F_(ee,Ye,M);return i.jsxs("tr",{className:"border-t bg-yellow-50/40",children:[i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:X=>E(De=>({...De,dateInput:X.target.value})),className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("select",{value:String(S.sellerId??D.sellerId),onChange:X=>{const De=X.target.value,le=l.get(De);E($e=>({...$e,sellerId:De,sellerName:(le==null?void 0:le.name)??"",commissionPercent:Oa((le==null?void 0:le.commissionPercent)??0)}))},className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(X=>i.jsxs("option",{value:X.id,children:[X.name," ",X.branch?`(${X.branch})`:""]},X.id))]})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(ee),onChange:X=>E(De=>({...De,amountDelivered:Oa(X.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(ve),onChange:X=>E(De=>({...De,commissionPercent:Oa(X.target.value)})),className:"h-9 w-24 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-semibold",children:["$ ",Oi(Ye)]}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(M),onChange:X=>E(De=>({...De,extraExpenses:Oa(X.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Oi(ae)]}),i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"text",value:String(S.comment??D.comment),onChange:X=>E(De=>({...De,comment:X.target.value})),className:"h-9 w-full px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>L(D.id),className:"h-8 px-3 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:K,className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})})]},D.id)})})]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[c.map(D=>i.jsxs("div",{className:"rounded-2xl border border-gray-100 p-3 bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-black text-gray-900",children:D.sellerName}),i.jsx("div",{className:"text-xs font-extrabold bg-gray-100 rounded-full px-3 py-1",children:Mr(D.date.toDate(),"yyyy-MM-dd")})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Monto entregado"}),i.jsxs("div",{className:"font-extrabold",children:["$ ",Oi(D.amountDelivered)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin %"}),i.jsxs("div",{className:"font-semibold",children:[Oi(D.commissionPercent),"%"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin pagada"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Oi(D.commissionPaid)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Gastos"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Oi(D.extraExpenses)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Total final"}),i.jsxs("div",{className:"text-base font-black",children:["$ ",Oi(D.totalFinal)]})]}),D.comment?i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comentario"}),i.jsx("div",{className:"text-sm text-gray-800",children:D.comment})]}):null]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>W(D.id),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})]},D.id)),I?i.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-3",children:[i.jsx("div",{className:"font-black text-gray-900 mb-3",children:"Editando registro"}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:D=>E(Q=>({...Q,dateInput:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:String(S.sellerId??""),onChange:D=>{const Q=D.target.value,ee=l.get(Q);E(ve=>({...ve,sellerId:Q,sellerName:(ee==null?void 0:ee.name)??"",commissionPercent:Oa((ee==null?void 0:ee.commissionPercent)??0)}))},className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",value:String(S.amountDelivered??""),onChange:D=>E(Q=>({...Q,amountDelivered:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",value:String(S.extraExpenses??""),onChange:D=>E(Q=>({...Q,extraExpenses:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin %"}),i.jsx("input",{type:"number",value:String(S.commissionPercent??""),onChange:D=>E(Q=>({...Q,commissionPercent:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{type:"text",value:String(S.comment??""),onChange:D=>E(Q=>({...Q,comment:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>L(I),className:"flex-1 h-10 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:K,className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})]})]}):null]})]})]})]})]})}const np=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function wit(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function nW(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Nit(t){const e=String(t||"").trim();if(!e)return 0;const r=Date.parse(e);return Number.isFinite(r)?r:0}function Cit({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new $2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function _it(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState("ANY"),[y,b]=g.useState(!1),[w,j]=g.useState({});g.useEffect(()=>{(async()=>{n(!0),s("");try{const Ee=await Ht(sr(yt(Ie,"candy_main_orders"))),Ze=new Map;Ee.forEach(Se=>{var Me,_e,U;const gt=Se.data(),Et=Nit(gt.date),Nt=((_e=(Me=gt==null?void 0:gt.createdAt)==null?void 0:Me.toMillis)==null?void 0:_e.call(Me))||((U=gt==null?void 0:gt.createdAt)!=null&&U.seconds?gt.createdAt.seconds*1e3:0)||0,Tt=Math.max(Et,Nt),Lt=Array.isArray(gt.items)?gt.items:[];for(const ye of Lt){const te=String((ye==null?void 0:ye.id)||(ye==null?void 0:ye.productId)||"").trim();if(!te)continue;const Ve=String((ye==null?void 0:ye.name)||(ye==null?void 0:ye.productName)||"").trim(),qe=String((ye==null?void 0:ye.category)||"").trim(),G=Number((ye==null?void 0:ye.unitPriceIsla)||0),V=Number((ye==null?void 0:ye.unitPriceRivas)||0),Z=Number((ye==null?void 0:ye.unitsPerPackage)||(ye==null?void 0:ye.unitsPerPack)||1),re=Ze.get(te);(!re||Tt>=re._sortKey)&&Ze.set(te,{productId:te,category:qe,productName:Ve,priceIsla:G,priceRivas:V,unitsPerPackage:Z,_sortKey:Tt})}});const xe=Array.from(Ze.values()).sort((Se,gt)=>Se.productName.localeCompare(gt.productName,"es"));l(xe)}catch(Ee){console.error(Ee),s(" Error cargando precios desde rdenes maestras."),l([])}finally{n(!1)}})()},[t]),g.useEffect(()=>{const Ee=yt(Ie,"products_candies"),Ze=sr(Ee),xe=jd(Ze,Se=>{const gt={},Et={},Nt={},Tt={};Se.forEach(Lt=>{const Me=Lt.data();gt[Lt.id]=Number((Me==null?void 0:Me.providerPrice)||(Me==null?void 0:Me.providerPricePerUnit)||0),Nt[Lt.id]=Number((Me==null?void 0:Me.unitsPerPackage)||(Me==null?void 0:Me.unitsPerPack)||1)||1;const _e=String((Me==null?void 0:Me.barcode)||"").trim();_e&&(Et[Lt.id]=_e);const U=String((Me==null?void 0:Me.packaging)||(Me==null?void 0:Me.empaque)||"").trim();U&&(Tt[Lt.id]=U)});try{const Lt=S.current||{};let Me=!1;for(const te of Object.keys(Et))if((Et[te]||"")!==(Lt[te]||"")){Me=!0;break}const _e=B.current||{};let U=!1;for(const te of Object.keys(Nt))if((Nt[te]||0)!==(_e[te]||0)){U=!0;break}z(gt),de(Nt);const ye={...Et,...Lt};_(ye),S.current=ye,B.current={...Nt},ke(Tt),l(te=>te.map(Ve=>({...Ve,unitsPerPackage:Nt[Ve.productId]??Ve.unitsPerPackage}))),!E.current&&Me&&(s(" Cdigo actualizado."),setTimeout(()=>s(""),3e3)),!E.current&&U&&(s(" Unidades x paquete actualizadas."),setTimeout(()=>s(""),3e3)),E.current=!1}catch{z(gt),de(Nt),_(Me=>({...Et,...Me})),B.current={...Nt},ke(Tt),l(Me=>Me.map(_e=>({..._e,unitsPerPackage:Nt[_e.productId]??_e.unitsPerPackage})))}},Se=>console.error(Se));return()=>xe()},[]);const[I,_]=g.useState({}),S=g.useRef({}),E=g.useRef(!0),B=g.useRef({}),T=g.useRef({}),P=g.useRef(!0),[O,z]=g.useState({}),[ce,de]=g.useState({}),[ue,me]=g.useState({}),[se,ke]=g.useState({}),[Re,F]=g.useState("");g.useEffect(()=>{const Ee=yt(Ie,"inventory_candies"),Ze=sr(Ee),xe=jd(Ze,Se=>{try{const gt={};Se.forEach(Nt=>{var ye,te,Ve;const Tt=Nt.data(),Lt=String(Tt.productId||"").trim();if(!Lt)return;const Me=Number(Tt.unitsPerPackage||Tt.unitsPerPack||0)||0,_e=((te=(ye=Tt==null?void 0:Tt.createdAt)==null?void 0:ye.toMillis)==null?void 0:te.call(ye))||((Ve=Tt==null?void 0:Tt.createdAt)!=null&&Ve.seconds?Tt.createdAt.seconds*1e3:0)||0,U=gt[Lt];(!U||_e>=U.ts)&&(gt[Lt]={val:Me||0,ts:_e})});const Et={};for(const Nt of Object.keys(gt))Et[Nt]=gt[Nt].val||0;me(Et);try{const Nt=T.current||{};let Tt=!1;for(const Lt of Object.keys(Et))if((Et[Lt]||0)!==(Nt[Lt]||0)){Tt=!0;break}T.current={...Et},!P.current&&Tt&&(s(" Inventario: unidades por paquete actualizadas."),setTimeout(()=>s(""),3e3)),P.current=!1}catch{}l(Nt=>Nt.map(Tt=>({...Tt,unitsPerPackage:Et[Tt.productId]??ce[Tt.productId]??Tt.unitsPerPackage})))}catch(gt){console.error("inventory_candies snapshot error:",gt)}},Se=>console.error(Se));return()=>xe()},[ce]),g.useEffect(()=>{l(Ee=>Ee.map(Ze=>({...Ze,unitsPerPackage:ue[Ze.productId]??ce[Ze.productId]??Ze.unitsPerPackage})))},[ce,ue]);const H=g.useMemo(()=>{const Ee=wit(c),Ze=String(d||"").trim(),xe=String(Re||"").trim().toLowerCase(),Se=A.trim()===""?null:nW(A,NaN),gt=m.trim()===""?null:nW(m,NaN);return o.filter(Et=>{const Nt=String(se[Et.productId]||"").trim().toLowerCase();if(xe)return Nt===xe;if(Ee&&!`${Et.category} ${Et.productName}`.toLowerCase().includes(Ee))return!1;if(Ze){const _e=String(Et.productId||""),U=String(I[Et.productId]||"");if(!_e.includes(Ze)&&!U.includes(Ze))return!1}const Tt=x==="ISLA"?[Et.priceIsla]:x==="RIVAS"?[Et.priceRivas]:[Et.priceIsla,Et.priceRivas],Lt=Se==null||!Number.isFinite(Se)?!0:Tt.some(_e=>_e>=Se),Me=gt==null||!Number.isFinite(gt)?!0:Tt.some(_e=>_e<=gt);return Lt&&Me})},[o,c,A,m,x,I,Re,se]),K=g.useMemo(()=>{const Ee=new Map;for(const Ze of H){const xe=(Ze.category||"Sin categora").trim()||"Sin categora",Se=Ee.get(xe)||[];Se.push(Ze),Ee.set(xe,Se)}return Array.from(Ee.entries()).sort(([Ze],[xe])=>Ze.localeCompare(xe,"es"))},[H]),L=5,[W,Y]=g.useState(1),D=Math.max(1,Math.ceil(K.length/L)),Q=g.useMemo(()=>{const Ee=(W-1)*L;return K.slice(Ee,Ee+L)},[K,W]);g.useEffect(()=>{Y(1)},[c,d,A,m,x,Re]),g.useEffect(()=>{Y(Ee=>Math.min(Ee,D))},[D]);const ee=()=>Y(1),ve=()=>Y(Ee=>Math.max(1,Ee-1)),M=()=>Y(Ee=>Math.min(D,Ee+1)),Ye=()=>Y(D),ae=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ee,disabled:W===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ve,disabled:W===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",W," de ",D]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:M,disabled:W===D,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ye,disabled:W===D,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[K.length," categora(s)"]})]}),X=Ee=>{j(Ze=>({...Ze,[Ee]:!Ze[Ee]}))},De=()=>{u(""),h(""),p(""),v("ANY"),F("")},[le,$e]=g.useState(!1),[Xe,it]=g.useState("search"),[xt,jt]=g.useState(null),[Mt,Ft]=g.useState(0),[$t,kt]=g.useState(0),[Ge,ie]=g.useState(null),[Ue,Ne]=g.useState(""),[be,Ce]=g.useState(""),Le=g.useMemo(()=>c.trim()!==""||A.trim()!==""||m.trim()!==""||x!=="ANY"||Re.trim()!=="",[c,A,m,x,Re]),[Ae,We]=g.useState(!1);g.useEffect(()=>{var xe;const Ee=window.matchMedia("(max-width: 900px)"),Ze=()=>We(Ee.matches);return Ze(),(xe=Ee.addEventListener)==null||xe.call(Ee,"change",Ze),()=>{var Se;return(Se=Ee.removeEventListener)==null?void 0:Se.call(Ee,"change",Ze)}},[]);const[ct,_t]=g.useState(!1);g.useEffect(()=>{const Ee=xj(Ec,async Ze=>{if(!Ze)return _t(!1);try{const xe=await zs(Zt(Ie,"users",Ze.uid)),Se=xe.exists()?xe.data():null,gt=Se?Array.isArray(Se.roles)?Se.roles:Se.role?[Se.role]:[]:[];_t(En(gt,"admin"))}catch(xe){console.error(xe),_t(!1)}});return()=>Ee()},[]);const pe=async Ee=>{var Ze;if(Xe==="search"){f(Ee);const xe=Object.keys(I).find(Et=>(I[Et]||"")===Ee),Se=(Ze=o.find(Et=>String(Et.productId||"").includes(Ee)))==null?void 0:Ze.productId,gt=xe||Se||null;gt&&(ie(gt),b(!1)),$e(!1);return}if(Xe==="edit"&&xt)try{const xe=yt(Ie,"products_candies"),Se=Zt(xe,xt);await Fn(Se,{barcode:Ee}),_(gt=>({...gt,[xt]:Ee})),Ne(Ee),$e(!1),it("search"),s(" Producto guardado.")}catch(xe){console.error(xe),s(" Error guardando el cdigo.")}},Pe=async Ee=>{l(Ze=>Ze.map(xe=>xe.productId===Ee?{...xe,priceIsla:Number(Mt||0),priceRivas:Number($t||0)}:xe));try{const Ze=String(be||"").trim();await Fn(Zt(yt(Ie,"products_candies"),Ee),{packaging:Ze||""}),ke(xe=>({...xe,[Ee]:Ze||""}))}catch(Ze){console.error("Error updating packaging:",Ze),s(" Error guardando empaque.")}jt(null),s(Ae?" Producto guardado.":"")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Precio Ventas"}),i.jsx("div",{className:"flex gap-2",children:i.jsx(Oc,{onClick:e,loading:r})})]}),i.jsxs("div",{className:"md:hidden mb-3",children:[i.jsxs("button",{type:"button",onClick:()=>b(Ee=>!Ee),className:`w-full px-3 py-3 rounded-xl border shadow-sm flex items-center justify-between ${Le?"bg-yellow-50 border-yellow-200":"bg-white"}`,children:[i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Filtros"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Le?"Activos":"Ninguno","  ","Mostrando ",i.jsx("b",{children:H.length})]})]}),i.jsx("div",{className:"text-sm font-semibold",children:y?"Cerrar":"Abrir"})]}),y&&i.jsx("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:c,onChange:Ee=>u(Ee.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:Re,onChange:Ee=>F(Ee.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por EAN"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:d,onChange:Ee=>f(Ee.target.value),placeholder:"Cdigo EAN"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{it("search"),$e(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{De(),f("")},children:"Limpiar filtros"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>b(!1),children:"Aplicar"})]})]})})]}),i.jsxs("div",{className:"hidden md:block bg-white p-3 rounded shadow border mb-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Filtrar por producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:Ee=>u(Ee.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Re,onChange:Ee=>F(Ee.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:A,onChange:Ee=>h(Ee.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:m,onChange:Ee=>p(Ee.target.value),placeholder:"0"})]}),i.jsx("div",{className:"text-right",children:i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:De,children:"Limpiar"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Fuente: ",i.jsx("b",{children:"candy_main_orders.items[]"}),"  Muestra el"," ",i.jsx("b",{children:"ltimo precio"})," registrado por producto."]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Mostrando:"})," ",i.jsx("b",{children:H.length})]})]})]}),i.jsxs("div",{className:"md:hidden",children:[r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):H.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):i.jsx("div",{className:"space-y-2",children:Q.map(([Ee,Ze])=>{const xe=!!w[Ee];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>X(Ee),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:Ee}),i.jsxs("div",{className:"text-[10px] text-gray-600 truncate",children:[Ze.length," ",Ze.length===1?"producto":"productos"]})]}),i.jsx("div",{className:"text-sm font-semibold",children:xe?"":"+"})]}),xe&&i.jsx("div",{className:"px-3 pb-3 border-t space-y-2",children:Ze.map(Se=>{const gt=Ge===Se.productId,Et=xt===Se.productId,Nt=O[Se.productId]||0,Tt=Se.priceIsla-Nt,Lt=Tt*.25;return i.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>ie(Me=>Me===Se.productId?null:Se.productId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:Se.productName}),i.jsx("div",{className:"text-[10px] text-gray-600 truncate",children:Se.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"P. Paquete"}),i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:np(Se.priceIsla)})]})]}),gt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Categora"}),i.jsx("div",{className:"text-sm",children:Se.category}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Unidades x paquete"}),i.jsx("div",{className:"text-sm",children:String(Se.unitsPerPackage||1)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Unidad"}),i.jsx("div",{className:"text-sm tabular-nums",children:np(Se.priceIsla/(Se.unitsPerPackage||1))})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Paquete"}),Et?i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:String(Mt),onChange:Me=>Ft(Number(Me.target.value||0))}):i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:np(Se.priceIsla)})]})]}),i.jsxs("div",{children:[ct&&i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-sm tabular-nums",children:np(Tt)})]}),i.jsxs("div",{className:"mt-1",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Comisin"}),i.jsx("div",{className:"text-sm tabular-nums",children:np(Lt)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Cdigo EAN"}),Et?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:Ue,readOnly:!0}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>{it("edit"),$e(!0)},type:"button",children:"Escanear"})]}):i.jsx("div",{children:I[Se.productId]||""})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Tipo Empaque"}),Et?i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:be,onChange:Me=>Ce(Me.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"text-sm",children:se[Se.productId]||""})]})]})]}),i.jsx("div",{className:"flex gap-2",children:Et?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white",onClick:()=>{Pe(Se.productId),ie(null)},type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{it("edit"),$e(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200",onClick:()=>jt(null),type:"button",children:"Cancelar"})]}):ct&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-yellow-400",onClick:()=>{jt(Se.productId),Ft(Se.priceIsla||0),kt(Se.priceRivas||0),Ne(I[Se.productId]||""),Ce(se[Se.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white",onClick:()=>l(Me=>Me.filter(_e=>_e.productId!==Se.productId)),type:"button",children:"Borrar"})]})})]})})]},Se.productId)})})]},Ee)})}),!r&&K.length>0&&ae(),a&&i.jsx("p",{className:"mt-2 text-sm",children:a})]}),i.jsx(Cit,{open:le,onClose:()=>$e(!1),onDetected:pe}),i.jsx("div",{className:"hidden md:block bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin resultados."})}):H.map(Ee=>i.jsxs("tr",{children:[i.jsx("td",{className:"p-2 border",children:Ee.category}),i.jsx("td",{className:"p-2 border",children:Ee.productName}),i.jsx("td",{className:"p-2 border",children:xt===Ee.productId?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:be,onChange:Ze=>Ce(Ze.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):se[Ee.productId]||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xt===Ee.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Mt),onChange:Ze=>Ft(Number(Ze.target.value||0))}):np(Ee.priceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xt===Ee.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String($t),onChange:Ze=>kt(Number(Ze.target.value||0))}):np(Ee.priceRivas)}),i.jsx("td",{className:"p-2 border text-right",children:xt===Ee.productId?i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white text-sm",onClick:()=>Pe(Ee.productId),type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 text-sm",onClick:()=>jt(null),type:"button",children:"Cancelar"})]}):ct&&i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-sm",onClick:()=>{jt(Ee.productId),Ft(Ee.priceIsla||0),kt(Ee.priceRivas||0),Ne(I[Ee.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white text-sm",onClick:()=>{jt(Ee.productId),it("edit"),$e(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white text-sm",onClick:()=>l(Ze=>Ze.filter(xe=>xe.productId!==Ee.productId)),type:"button",children:"Borrar"})]})})]},Ee.productId))})]})}),a&&i.jsx("p",{className:"hidden md:block mt-2 text-sm",children:a})]})}const D_=["Cuaderno","Block","Lapicero","Lpiz","Tajador","Borrador","Corrector","Cartucheras"],aW=["Lider","Scribe","Smarty","Pointer","Paper Mate","Otro"],kB=["Hombre","Mujer","Variado","NA"],Eit=["Universitario Cocido","5 Materia","2 Materia","Doble Raya","Rayado","Cuadriculado","Subrayado","Sublineado","Liso"],zl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function wo(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function yc(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function EE(t,e=1){const r=Math.floor(yc(t,e));return r>0?r:e}function ide(t){return!Number.isFinite(t)||t<=0?0:t}function FB(t){const e=String(t??"").trim();return e||""}function ef(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(wo(a),a));for(const a of e){const s=n.get(wo(a));if(s!=null)return t[s]}}function Sit(t){return Object.values(t||{}).every(r=>wo(r)==="")}function Nx(t){const e=Math.max(0,yc(t.providerPrice,0)),r=Math.max(1,EE(t.quantity,1)),n=ide(yc(t.margin,0)),a=Math.max(0,yc(t.salePrice,0)),s=n>0?e/n:e,o=a>0?a:s,l=o>0?e/o:n,c=e*r,u=(o-e)*r,d=o*r;return{providerPrice:e,quantity:r,margin:l,salePrice:o,facturado:c,gain:u,totalEsperado:d}}function Iit(){const{refreshKey:t,refresh:e}=Dc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(!1),[w,j]=g.useState(null),[I,_]=g.useState(!1),[S,E]=g.useState(null),[B,T]=g.useState(D_[0]),[P,O]=g.useState(aW[0]),[z,ce]=g.useState(""),[de,ue]=g.useState(0),[me,se]=g.useState(1),[ke,Re]=g.useState(.7),[F,H]=g.useState(0),[K,L]=g.useState("NA"),[W,Y]=g.useState(""),[D,Q]=g.useState(""),[ee,ve]=g.useState(!1),[M,Ye]=g.useState(""),[ae,X]=g.useState([]),[De,le]=g.useState([]),[$e,Xe]=g.useState(!1);g.useEffect(()=>{(async()=>{n(!0),s("");try{const pe=await Ht(sr(yt(Ie,"products_stationery"))),Pe=[];pe.forEach(Ee=>{const Ze=Ee.data();Pe.push({id:Ee.id,category:Ze.category||"",brand:Ze.brand||"",name:Ze.name||"",providerPrice:Number(Ze.providerPrice||0),quantity:Number(Ze.quantity||1),facturado:Number(Ze.facturado||0),margin:Number(Ze.margin||0),salePrice:Number(Ze.salePrice||0),gain:Number(Ze.gain||0),gender:Ze.gender||"NA",typeProduct:Ze.typeProduct||"",code:Ze.code??"",createdAt:Ze.createdAt,updatedAt:Ze.updatedAt,totalEsperado:Number(Ze.totalEsperado||Number(Ze.salePrice||0)*Number(Ze.quantity||1))})}),l(Pe)}catch(pe){console.error(pe),s(" Error cargando productos (papelera).")}finally{n(!1)}})()},[t]);const it=g.useMemo(()=>{const pe=wo(d),Pe=wo(A),Ee=m.trim()===""?null:yc(m,NaN),Ze=x.trim()===""?null:yc(x,NaN);return o.filter(xe=>!(pe&&!`${xe.category} ${xe.name}`.toLowerCase().includes(pe)||Pe&&!String(xe.code||"").toLowerCase().includes(Pe)||Ee!=null&&Number.isFinite(Ee)&&xe.salePrice<Ee||Ze!=null&&Number.isFinite(Ze)&&xe.salePrice>Ze))},[o,d,A,m,x]),xt=g.useMemo(()=>d.trim()!==""||A.trim()!==""||m.trim()!==""||x.trim()!=="",[d,A,m,x]),jt=g.useMemo(()=>{const pe=o.length,Pe=o.reduce((xe,Se)=>xe+(Se.facturado||0),0),Ee=o.reduce((xe,Se)=>xe+Number(Se.totalEsperado||Number(Se.salePrice||0)*Number(Se.quantity||1)),0),Ze=o.reduce((xe,Se)=>xe+(Se.gain||0),0);return{count:pe,sumFact:Pe,sumEsperado:Ee,sumGain:Ze}},[o]),Mt=()=>{T(D_[0]),ce(""),ue(0),se(1),Re(.7),H(0),L("NA"),Y(""),Q(""),j(null)},Ft=()=>{Mt(),b(!0)},$t=pe=>{j(pe),T(pe.category||D_[0]),O(pe.brand||aW[0]),ce(pe.name||""),ue(Number(pe.providerPrice||0)),se(Number(pe.quantity||1)),Re(Number(pe.margin||.7)),H(Number(pe.salePrice||0)),L(pe.gender||"NA"),Y(pe.typeProduct||""),Q(String(pe.code||"")),b(!0)},kt=async()=>{s("");const pe=String(B||"").trim(),Pe=String(P||"").trim(),Ee=String(z||"").trim(),{providerPrice:Ze,quantity:xe,margin:Se,salePrice:gt,facturado:Et,totalEsperado:Nt,gain:Tt}=Nx({providerPrice:de,quantity:me,margin:ke,salePrice:F});if(!pe)return s(" Categora requerida.");if(!Ee)return s(" Producto requerido.");if(Ze<=0)return s(" Precio proveedor debe ser > 0.");if(xe<=0)return s(" Cantidad debe ser > 0.");if(gt<=0)return s(" Precio venta invlido.");if(Se<=0)return s(" Margen invlido.");const Lt={category:pe,brand:Pe,name:Ee,providerPrice:Ze,quantity:xe,facturado:Et,margin:Se,salePrice:gt,gain:Tt,gender:K||"NA",typeProduct:String(W||"").trim(),code:FB(D)||null,updatedAt:vr.now(),totalEsperado:Nt};try{n(!0),w?(await Fn(Zt(Ie,"products_stationery",w.id),Lt),s(" Producto actualizado.")):(await Jn(yt(Ie,"products_stationery"),{...Lt,createdAt:vr.now()}),s(" Producto creado.")),b(!1),j(null),Mt(),e()}catch(Me){console.error(Me),s(" Error guardando producto.")}finally{n(!1)}},Ge=async()=>{var pe;try{const Pe=new $2,Ee=await $2.listVideoInputDevices(),Ze=(pe=Ee[Ee.length-1])==null?void 0:pe.deviceId;if(!Ze)return null;const xe=document.createElement("div");xe.className="fixed inset-0 z-[9999] bg-black/70 flex items-center justify-center p-3";const Se=document.createElement("div");Se.className="bg-white w-full max-w-md rounded-xl overflow-hidden shadow-xl";const gt=document.createElement("div");gt.className="p-3 flex items-center justify-between border-b",gt.innerHTML="<div style='font-weight:700'>Escanear cdigo</div>";const Et=document.createElement("button");Et.textContent="Cerrar",Et.className="px-3 py-1 rounded bg-gray-200";const Nt=document.createElement("div");Nt.className="p-3";const Tt=document.createElement("video");return Tt.style.width="100%",Tt.style.borderRadius="12px",Nt.appendChild(Tt),gt.appendChild(Et),Se.appendChild(gt),Se.appendChild(Nt),xe.appendChild(Se),document.body.appendChild(xe),await new Promise(async Lt=>{const Me=()=>{xe.remove(),Lt(null)};Et.onclick=Me;const _e=await Pe.decodeFromVideoDevice(Ze,Tt,U=>{if(U){const ye=U.getText();try{_e.stop()}catch{}xe.remove(),Lt(ye)}})})}catch(Pe){return console.error(Pe),null}},ie=async()=>{const pe=await Ge();pe&&Q(pe)},Ue=async()=>{const pe=await Ge();if(!pe)return;const Pe=o.find(Ee=>String(Ee.code||"")===String(pe));Pe?(E(Pe),_(!0),s("")):(E(null),_(!0),s(""))},Ne=(pe,Pe)=>{const Ee=pe.map(Se=>({Id:Se.id,Categoria:Se.category,brand:Se.brand,Producto:Se.name,PrecioProveedor:Se.providerPrice,Cantidad:Se.quantity,Facturado:Se.facturado,TotalEsperado:Se.totalEsperado||Se.salePrice*Se.quantity,Margen:Se.margin,PrecioVenta:Se.salePrice,Ganancia:Se.gain,Genero:Se.gender,TipoProducto:Se.typeProduct,Codigo:Se.code||""})),Ze=Qa.json_to_sheet(Ee),xe=Qa.book_new();Qa.book_append_sheet(xe,Ze,"Productos"),V2(xe,Pe)},be=()=>{const pe=[{Id:"",Categoria:"Cuaderno",brand:"Lider",Producto:"Cuaderno Norma 100 hojas",PrecioProveedor:120,Cantidad:12,Margen:.7,PrecioVenta:"",Genero:"NA",TipoProducto:"Universitario Cocido",Codigo:"1234567890123"}],Pe=Qa.json_to_sheet(pe),Ee=Qa.book_new();Qa.book_append_sheet(Ee,Pe,"Productos");const Ze=mP(Ee,{type:"array",bookType:"xlsx"}),xe=new Blob([Ze],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Se=URL.createObjectURL(xe),gt=document.createElement("a");gt.href=Se,gt.download="template_products_stationery.xlsx",document.body.appendChild(gt),gt.click(),gt.remove(),URL.revokeObjectURL(Se)},Ce=pe=>{const Pe=[],Ee=[];pe.forEach((xe,Se)=>{if(!xe||typeof xe!="object"||Sit(xe))return;const gt=Se+2,Et=String(ef(xe,["Id","ID","docId","DocId"])??"").trim(),Nt=String(ef(xe,["Categoria","Categora","Category","category"])??"").trim(),Tt=String(ef(xe,["Brand","Marca","brand","marca"])??"").trim(),Lt=String(ef(xe,["Producto","Product","Nombre","Name","name"])??"").trim(),Me=ef(xe,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Costo","providerPrice"]),_e=ef(xe,["Cantidad","Qty","quantity","cantidad"]),U=ef(xe,["Margen","Margin","margen","margin"]),ye=ef(xe,["PrecioVenta","Precio Venta","SalePrice","salePrice"]),te=String(ef(xe,["Genero","Gnero","Gender","gender"])??"NA").trim(),Ve=String(ef(xe,["TipoProducto","Tipo","TypeProduct","typeProduct","Tipo producto"])??"").trim(),qe=ef(xe,["Codigo","Cdigo","Code","Barcode","code"]),G=FB(qe),V=Math.max(0,yc(Me,0)),Z=Math.max(1,EE(_e,1)),re=ide(yc(U,0)),we=Math.max(0,yc(ye,0));Nt||Ee.push(`Fila ${gt}: falta Categoria.`),Lt||Ee.push(`Fila ${gt}: falta Producto.`),V<=0&&Ee.push(`Fila ${gt}: PrecioProveedor debe ser > 0.`),Z<=0&&Ee.push(`Fila ${gt}: Cantidad debe ser > 0.`),re<=0&&we<=0&&Ee.push(`Fila ${gt}: Margen debe ser > 0 (o enviar PrecioVenta).`);const st=kB.includes(te||"NA")?te:"NA";Nt&&Lt&&V>0&&Z>0&&(re>0||we>0)&&Pe.push({id:Et||void 0,category:Nt,brand:Tt,name:Lt,providerPrice:V,quantity:Z,margin:re>0?re:.7,salePrice:we>0?we:void 0,gender:st,typeProduct:Ve,code:G||"",_raw:xe})});const Ze=new Map;for(const xe of Pe){const Se=xe.id?`id::${xe.id}`:`${wo(xe.category)}::${wo(xe.name)}`;Ze.set(Se,xe)}return{rows:Array.from(Ze.values()),errors:Ee}},Le=async pe=>{if(s(""),le([]),X([]),Ye((pe==null?void 0:pe.name)||""),!pe)return;const Pe=pe.name.toLowerCase(),Ee=Pe.endsWith(".xlsx")||Pe.endsWith(".xls"),Ze=Pe.endsWith(".csv");if(!Ee&&!Ze){le(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Xe(!0);const xe=new FileReader,Se=await new Promise((_e,U)=>{xe.onerror=()=>U(new Error("No se pudo leer el archivo.")),xe.onload=()=>_e(xe.result),xe.readAsArrayBuffer(pe)}),gt=Vv(new Uint8Array(Se),{type:"array"}),Et=gt.SheetNames[0],Nt=gt.Sheets[Et],Tt=Qa.sheet_to_json(Nt,{defval:""}),{rows:Lt,errors:Me}=Ce(Tt);X(Lt),le(Me),Lt.length===0&&Me.length===0&&le(["No se encontraron filas vlidas para importar."])}catch(xe){console.error(xe),le(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Xe(!1)}},Ae=(pe,Pe)=>{X(Ee=>{const Ze=[...Ee],xe=Ze[pe];return xe?(Ze[pe]={...xe,...Pe},Ze):Ee})},We=g.useMemo(()=>{const pe=new Set(o.map(xe=>xe.id)),Pe=new Set(o.map(xe=>`${wo(xe.category)}::${wo(xe.name)}`));let Ee=0,Ze=0;for(const xe of ae){if(xe.id&&pe.has(xe.id)){Ee+=1;continue}const Se=`${wo(xe.category)}::${wo(xe.name)}`;Pe.has(Se)?Ee+=1:Ze+=1}return{total:ae.length,willCreate:Ze,willUpdate:Ee}},[ae,o]),ct=async()=>{if(s(""),De.length>0){s(" Correg los errores antes de importar.");return}if(ae.length===0){s(" No hay filas para importar.");return}try{Xe(!0);const pe={},Pe={};o.forEach(Se=>{pe[Se.id]=Se,Pe[`${wo(Se.category)}::${wo(Se.name)}`]=Se});const Ee=tu(Ie);let Ze=0,xe=0;for(const Se of ae){const gt=String(Se.category||"").trim(),Et=String(Se.name||"").trim(),{providerPrice:Nt,quantity:Tt,margin:Lt,salePrice:Me,facturado:_e,totalEsperado:U,gain:ye}=Nx({providerPrice:Se.providerPrice,quantity:Se.quantity,margin:Se.margin,salePrice:Se.salePrice});if(!gt||!Et||Nt<=0||Tt<=0||Me<=0||Lt<=0)continue;const te={category:gt,name:Et,providerPrice:Nt,quantity:Tt,facturado:_e,totalEsperado:U,margin:Lt,salePrice:Me,gain:ye,gender:Se.gender||"NA",typeProduct:String(Se.typeProduct||"").trim(),code:FB(Se.code)||null,updatedAt:vr.now()};let Ve;if(Se.id&&pe[Se.id])Ve=pe[Se.id];else{const qe=`${wo(gt)}::${wo(Et)}`;Ve=Pe[qe]}if(Ve)Ee.update(Zt(Ie,"products_stationery",Ve.id),te),xe+=1;else{const qe=Zt(yt(Ie,"products_stationery"));Ee.set(qe,{...te,createdAt:vr.now()}),Ze+=1}}await Ee.commit(),s(` Importacin lista. Creados: ${Ze}, Actualizados: ${xe}`),ve(!1),X([]),le([]),Ye(""),e()}catch(pe){console.error(pe),s(" Error importando productos a Firestore.")}finally{Xe(!1)}},_t=()=>{f(""),h(""),p(""),v("")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Papelera"}),i.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-900 text-white hover:bg-black",onClick:Ue,type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:Ft,type:"button",children:"+ Nuevo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{ve(!0),X([]),le([]),Ye("")},type:"button",children:"Importar (.xlsx)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ne(o,"products_stationery_todo.xlsx"),type:"button",children:"Exportar (todo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ne(it,"products_stationery_filtrado.xlsx"),type:"button",children:"Exportar (filtrado)"}),i.jsx(Oc,{onClick:e,loading:r||$e})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[i.jsx(R_,{label:"Productos",value:jt.count}),i.jsx(R_,{label:"Facturado",value:zl(jt.sumFact)}),i.jsx(R_,{label:"Esperado",value:zl(jt.sumEsperado)}),i.jsx(R_,{label:"Ganancia",value:zl(jt.sumGain)})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{className:`w-full md:w-auto px-3 py-2 rounded border bg-white hover:bg-gray-50 ${xt?"border-yellow-300 bg-yellow-50":""}`,type:"button",onClick:()=>u(pe=>!pe),children:[c?"Cerrar filtros":"Abrir filtros"," ",xt?"(activos)":""]}),c&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:d,onChange:pe=>f(pe.target.value),placeholder:"Ej: Cuaderno Norma"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:A,onChange:pe=>h(pe.target.value),placeholder:"Barcode"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:m,onChange:pe=>p(pe.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:x,onChange:pe=>v(pe.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"md:col-span-4 flex gap-2 justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:_t,children:"Limpiar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>u(!1),children:"Aplicar"})]})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-600",children:[i.jsxs("div",{children:["Mostrando: ",i.jsx("b",{children:it.length})]}),i.jsxs("div",{children:["Coleccin: ",i.jsx("b",{children:"products_stationery"})]})]})]})]}),i.jsx("div",{className:"md:hidden space-y-2",children:r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):it.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):it.map(pe=>i.jsxs("div",{className:"bg-white border rounded-xl p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:pe.category}),i.jsx("div",{className:"text-base font-bold leading-tight",children:pe.name}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(pe.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Esperado:"," ",i.jsx("b",{children:zl(pe.totalEsperado||pe.salePrice*pe.quantity)})]}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(pe.gain)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Cdigo: ",i.jsx("b",{children:pe.code||""})]}),i.jsx("div",{className:"mt-2 flex gap-2",children:i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>$t(pe),children:"Editar"})})]},pe.id))}),i.jsx("div",{className:"hidden md:block bg-white border rounded overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"Venta"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Cargando"})}):it.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Sin resultados."})}):it.map(pe=>i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:pe.category}),i.jsx("td",{className:"p-2 border",children:pe.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:pe.quantity}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.facturado)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.totalEsperado||pe.salePrice*pe.quantity)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Number(pe.margin||0).toFixed(2)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.salePrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:zl(pe.gain)}),i.jsx("td",{className:"p-2 border",children:pe.gender}),i.jsx("td",{className:"p-2 border",children:pe.typeProduct}),i.jsx("td",{className:"p-2 border",children:pe.code||""}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>$t(pe),children:"Editar"})})]},pe.id))})]})}),a&&i.jsx("p",{className:"mt-2 text-sm",children:a}),y&&i.jsxs(sW,{onClose:()=>b(!1),title:w?"Editar producto":"Nuevo producto",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:B,onChange:pe=>T(pe.target.value),children:D_.map(pe=>i.jsx("option",{value:pe,children:pe},pe))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:z,onChange:pe=>ce(pe.target.value),placeholder:"Ej: Cuaderno Norma..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(de)?"":de,onChange:pe=>ue(Math.max(0,yc(pe.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cantidad"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-2 text-right",value:me,onChange:pe=>se(EE(pe.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Facturado (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:zl(Nx({providerPrice:de,quantity:me,margin:ke,salePrice:F}).facturado)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Margen"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(ke)?"":ke,onChange:pe=>Re(Math.max(0,yc(pe.target.value,0)))}),i.jsx("div",{className:"text-[11px] text-gray-600 mt-1",children:"Ej: 0.70 / 0.80"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(Nx({providerPrice:de,quantity:me,margin:ke,salePrice:F}).salePrice)?"":Nx({providerPrice:de,quantity:me,margin:ke,salePrice:F}).salePrice,onChange:pe=>{H(Math.max(0,yc(pe.target.value,0)))}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Ganancia (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:zl(Nx({providerPrice:de,quantity:me,margin:ke,salePrice:F}).gain)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:K,onChange:pe=>L(pe.target.value),children:kB.map(pe=>i.jsx("option",{value:pe,children:pe},pe))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo producto"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:W,onChange:pe=>Y(pe.target.value),children:[i.jsx("option",{value:"",children:""}),Eit.map(pe=>i.jsx("option",{value:pe,children:pe},pe))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:D,onChange:pe=>Q(pe.target.value),placeholder:"Escane o peg el cdigo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:ie,children:"Escanear"})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:()=>{b(!1),j(null)},children:"Cancelar"}),i.jsx("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:kt,disabled:r,children:"Guardar"})]})]}),I&&i.jsx(sW,{onClose:()=>_(!1),title:"Resultado de escaneo",children:S?i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:S.category}),i.jsx("div",{className:"text-lg font-bold",children:S.name}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Precio venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(S.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:zl(S.gain)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Proveedor"}),i.jsx("div",{className:"font-semibold tabular-nums",children:zl(S.providerPrice)})]}),i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cantidad"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.quantity})]}),i.jsxs("div",{className:"rounded-lg border p-2 col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cdigo"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.code||""})]})]}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsx("button",{className:"px-4 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>{_(!1),$t(S)},children:"Editar"})})]}):i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-semibold",children:"No encontrado"}),i.jsxs("div",{className:"text-gray-600 mt-1",children:["Ese cdigo no existe en ",i.jsx("b",{children:"products_stationery"}),"."]})]})}),ee&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar papelera (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ve(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas: Id (opcional), Categoria, Producto, PrecioProveedor, Cantidad, Margen (o PrecioVenta), Genero, TipoProducto, Codigo."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:be,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:pe=>{var Pe;return Le(((Pe=pe.target.files)==null?void 0:Pe[0])||null)}}),M&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:M})]}),$e&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),De.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:De.slice(0,60).map((pe,Pe)=>i.jsx("li",{children:pe},Pe))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",We.total," filas (Crear:"," ",We.willCreate," / Actualizar:"," ",We.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:ct,disabled:$e||ae.length===0||De.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1500px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"PrecioVenta"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):ae.slice(0,300).map((pe,Pe)=>{const Ee=pe.id?o.some(Se=>Se.id===pe.id):!1,Ze=o.some(Se=>`${wo(Se.category)}::${wo(Se.name)}`==`${wo(pe.category)}::${wo(pe.name)}`),xe=Ee||Ze;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:pe.id||"",onChange:Se=>Ae(Pe,{id:Se.target.value.trim()||void 0}),placeholder:"docId (update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:pe.category,onChange:Se=>Ae(Pe,{category:Se.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:pe.name,onChange:Se=>Ae(Pe,{name:Se.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:pe.providerPrice,onChange:Se=>Ae(Pe,{providerPrice:Math.max(0,yc(Se.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:pe.quantity,onChange:Se=>Ae(Pe,{quantity:EE(Se.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-24 border rounded px-2 py-1 text-right",value:pe.margin,onChange:Se=>Ae(Pe,{margin:Math.max(0,yc(Se.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:pe.salePrice??"",onChange:Se=>Ae(Pe,{salePrice:Math.max(0,yc(Se.target.value,0))||void 0}),placeholder:"Opcional"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("select",{className:"w-28 border rounded px-2 py-1",value:pe.gender,onChange:Se=>Ae(Pe,{gender:Se.target.value}),children:kB.map(Se=>i.jsx("option",{value:Se,children:Se},Se))})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:pe.typeProduct,onChange:Se=>Ae(Pe,{typeProduct:Se.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:pe.code||"",onChange:Se=>Ae(Pe,{code:Se.target.value})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${xe?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:xe?"ACTUALIZA":"CREA"})})]},`${pe.id||""}-${Pe}`)})})]}),ae.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",ae.length," filas (importa todas)."]})]})]})]})})]})}function R_({label:t,value:e}){return i.jsxs("div",{className:"bg-white border rounded p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-extrabold",children:e})]})}function sW({title:t,children:e,onClose:r}){return i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-3xl p-4 relative",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:t}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),e]})})}const ld=t=>`C$ ${(Number(t)||0).toFixed(2)}`,w0=t=>Number(t||0).toFixed(3),OB=(t,e)=>{var a,s,o,l;const r=t._raw||{},n=t.customerName||r.customerName||((a=r.customer)==null?void 0:a.name)||r.clientName||((s=r.client)==null?void 0:s.name)||"";return t.type==="CONTADO"&&n?n:(t.customerId?e[t.customerId]:"")||t.customerName||r.customerName||((o=r.customer)==null?void 0:o.name)||r.clientName||((l=r.client)==null?void 0:l.name)||"Nombre cliente"},iW=t=>{const e=t._raw||{},r=lde(e)||t.date,n=rv(r);return isFinite(n)?n:NaN},DB=t=>String((t==null?void 0:t.status)||"").toUpperCase()==="PROCESADA"||t!=null&&t.closureId||t!=null&&t.closureDate||t!=null&&t.processedDate?"PROCESADA":"FLOTANTE",jit=t=>String(t??"").toLowerCase().trim(),oW=t=>["lb","lbs","libra","libras"].includes(jit(t)),lW=t=>Number((t==null?void 0:t.qty)??(t==null?void 0:t.quantity)??0)||0,Pit=t=>t?Array.isArray(t.items)&&t.items.length>0?t.items.reduce((e,r)=>oW((r==null?void 0:r.measurement)??(t==null?void 0:t.measurement))?e+lW(r):e,0):oW(t==null?void 0:t.measurement)?lW(t):0:0;function ode(t){if(!t)return"";if(t!=null&&t.toDate)return Mr(t.toDate(),"yyyy-MM-dd");const e=String(t).trim();if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const r=["dd/MM/yyyy","d/M/yyyy","MM/dd/yyyy","M/d/yyyy","yyyy/MM/dd","yyyy-M-d","yyyy/M/d","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSSX"];for(const a of r){const s=yS(e,a,new Date);if(P6(s))return Mr(s,"yyyy-MM-dd")}const n=new Date(e);return isNaN(n.getTime())?"":Mr(n,"yyyy-MM-dd")}function rv(t){const e=ode(t);if(!e)return NaN;const r=yS(e,"yyyy-MM-dd",new Date);return P6(r)?r.getTime():NaN}function lde(t){var n,a;const e=ode(t==null?void 0:t.date),r=(n=t==null?void 0:t.createdAt)!=null&&n.toDate?t.createdAt.toDate():null;if(e&&r){const s=rv(e),o=r.getTime();if(Math.abs(o-s)/(1e3*60*60*24)>30)return Mr(r,"yyyy-MM-dd")}return e||((a=t==null?void 0:t.timestamp)!=null&&a.toDate?Mr(t.timestamp.toDate(),"yyyy-MM-dd"):r?Mr(r,"yyyy-MM-dd"):"")}function Bit(t,e){var s,o,l,c;const r=lde(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((u,d)=>u+(Number(d.qty??d.quantity??d.lbs??0)||0),0),a=Number(t.amount??t.total??0)||0):(n=Number(t.quantity??t.lbs??t.weight??0)||0,a=Number(t.amount??t.total??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||((s=t.customer)==null?void 0:s.id)||((o=t.customer)==null?void 0:o.customerId)||t.clientId||void 0,customerName:t.customerName||((l=t.customer)==null?void 0:l.name)||t.clientName||((c=t.client)==null?void 0:c.name)||void 0,_raw:t}}async function Tit(t){const e=sr(yt(Ie,"ar_movements"),mr("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>Kn(Zt(Ie,"ar_movements",n.id))))}function kit({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=En(n,"vendedor_pollo"),s=En(n,"admin");if(!(En(n,"admin")||En(n,"vendedor_pollo")||En(n,"supervisor_pollo")||En(n,"contador")))return i.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center text-red-600",children:"Acceso restringido  Solo administradores, vendedores y supervisores de pollo."});const o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async be=>{c(!0),d(!0),A(be),m([]);try{const Ce=await zs(Zt(Ie,"salesV2",be)),Le=Ce.exists()?Ce.data():null;if(!Le){m([]);return}let Ae=[];if(Array.isArray(Le.items)&&Le.items.length>0)Ae=Le.items;else if(Le.items&&typeof Le.items=="object")try{Ae=Object.values(Le.items)}catch{Ae=[]}else Le.item?Ae=[Le.item]:Array.isArray(Le.products)&&Le.products.length>0?Ae=Le.products:Array.isArray(Le.lines)&&Le.lines.length>0?Ae=Le.lines:Array.isArray(Le.detalles)&&Le.detalles.length>0?Ae=Le.detalles:(Le.productName||Le.product)&&(Ae=[{productName:Le.productName||Le.product||"",qty:Le.qty??Le.quantity??Le.lbs??0,unitPrice:Le.unitPrice??Le.price??0,discount:Le.discount??0,total:Le.total??Le.amount??0}]);const We=Pe=>{if(Pe==null)return NaN;if(typeof Pe=="number")return Pe;let Ee=String(Pe).trim();if(!Ee)return NaN;if(Ee=Ee.replace(/[^0-9.,-]/g,""),!Ee)return NaN;Ee.indexOf(".")>-1&&Ee.indexOf(",")>-1?Ee=Ee.replace(/,/g,""):Ee.indexOf(",")>-1&&Ee.indexOf(".")===-1&&(Ee=Ee.replace(/,/g,"."));const Ze=Number(Ee);return isNaN(Ze)?NaN:Ze},ct=new Set;for(const Pe of Ae)if(Array.isArray(Pe==null?void 0:Pe.allocations))for(const Ee of Pe.allocations){const Ze=String((Ee==null?void 0:Ee.batchId)||"").trim();Ze&&ct.add(Ze)}else if(Pe!=null&&Pe.allocations&&typeof Pe.allocations=="object")try{for(const Ee of Object.values(Pe.allocations)){const Ze=String((Ee==null?void 0:Ee.batchId)||"").trim();Ze&&ct.add(Ze)}}catch{}if(Array.isArray(Le==null?void 0:Le.allocations))for(const Pe of Le.allocations){const Ee=String((Pe==null?void 0:Pe.batchId)||"").trim();Ee&&ct.add(Ee)}const _t={};ct.size>0&&await Promise.all(Array.from(ct).map(async Pe=>{try{const Ee=await zs(Zt(Ie,"inventory_batches",Pe));if(Ee.exists()){const Ze=Ee.data();_t[Pe]=Number(Ze.salePrice??Ze.sale_price??Ze.price??0)}}catch{}}));const pe=Ae.map(Pe=>{const Ee=String(Pe.productName||Pe.product||Pe.name||"(sin nombre)"),Ze=Number(Pe.qty??Pe.quantity??Pe.lbs??Pe.weight??0)||0,xe=We(Pe.total??Pe.lineFinal??Pe.amount??Pe.monto??Pe.line_total)||0;let Se=0;const gt=[Pe.unitPrice,Pe.unitPricePackage,Pe.salePrice,Pe.sale_price,Pe.price,Pe.unit_price,Pe.pricePerUnit,Pe.price_per_unit];for(const Tt of gt){const Lt=We(Tt);if(!isNaN(Lt)&&Lt!==0){Se=Lt;break}}if(!Se){const Tt=(Le==null?void 0:Le.salePrice)??(Le==null?void 0:Le.sale_price)??(Le==null?void 0:Le.unitPrice)??(Le==null?void 0:Le.unit_price)??(Le==null?void 0:Le.price)??(Le==null?void 0:Le.pricePerUnit),Lt=We(Tt);!isNaN(Lt)&&Lt!==0&&(Se=Lt)}if(!Se){const Tt=Array.isArray(Pe.allocations)?Pe.allocations[0]:Pe.allocations&&typeof Pe.allocations=="object"?Object.values(Pe.allocations)[0]:null,Lt=Tt?String(Tt.batchId||"").trim():"";Lt&&_t[Lt]&&(Se=_t[Lt]||0)}!Se&&Pe.productId&&(Se=productPriceMap[String(Pe.productId)]||0),(!Se||Se===0)&&xe>0&&Ze>0&&(Se=xe/Ze);const Et=We(Pe.discount??Pe.desc??0)||0;let Nt=xe;return(!Nt||Nt===0)&&(Nt=Number(Se*Ze||0)),Nt=Number(Nt)||0,{productName:Ee,qty:Ze,unitPrice:Se,discount:Et,total:Nt}});m(pe)}catch(Ce){console.error(Ce)}finally{d(!1)}},[x,v]=g.useState(Mr(new Date,"yyyy-MM-01")),[y,b]=g.useState(Mr(new Date,"yyyy-MM-dd")),[w,j]=g.useState([]),[I,_]=g.useState([]),[S,E]=g.useState([]),[B,T]=g.useState(!0),[P,O]=g.useState(""),{refreshKey:z,refresh:ce}=Dc(),[de,ue]=g.useState(""),[me,se]=g.useState(""),[ke,Re]=g.useState("ALL"),[F,H]=g.useState(""),[K,L]=g.useState(null),W=15,[Y,D]=g.useState(1),Q=g.useMemo(()=>{const be={};return w.forEach(Ce=>be[Ce.id]=Ce.name),be},[w]);g.useEffect(()=>{ke!=="ALL"&&!S.includes(ke)&&Re("ALL")},[S,ke]),g.useEffect(()=>{(async()=>{T(!0),O("");try{const be=[];if(a&&e){const xe=sr(yt(Ie,"customers_pollo"),mr("vendorId","==",e),In("createdAt","desc"));(await Ht(xe)).forEach(gt=>be.push({id:gt.id,name:gt.data().name||""}))}else(await Ht(sr(yt(Ie,"customers_pollo"),In("createdAt","desc")))).forEach(Se=>be.push({id:Se.id,name:Se.data().name||""}));j(be);const Ce={};be.forEach(xe=>{Ce[xe.id]=xe.name});const[Le,Ae,We]=await Promise.all([Ht(sr(yt(Ie,"salesV2"),In("timestamp","desc"))),Ht(sr(yt(Ie,"daily_closures"),In("createdAt","desc"))),Ht(sr(yt(Ie,"ar_movements_pollo"),mr("date",">=",x),mr("date","<=",y)))]),ct=new Map;We.forEach(xe=>{var Nt;const Se=xe.data(),gt=String(((Nt=Se==null?void 0:Se.ref)==null?void 0:Nt.saleId)||"").trim(),Et=String((Se==null?void 0:Se.customerId)||"").trim();gt&&Et&&ct.set(gt,Et)});const _t=new Map;Ae.forEach(xe=>{const Se=xe.data(),gt=Array.isArray(Se==null?void 0:Se.salesV2)?Se.salesV2:[];for(const Et of gt){const Nt=String((Et==null?void 0:Et.id)||"").trim();if(!Nt)continue;const Tt=Nt.split("#")[0];(String((Et==null?void 0:Et.status)||"").toUpperCase()==="PROCESADA"||Et!=null&&Et.closureDate||Et!=null&&Et.processedDate)&&_t.set(Tt,{closureDate:Et==null?void 0:Et.closureDate,processedDate:Et==null?void 0:Et.processedDate})}});const pe=[];Le.forEach(xe=>{const Se=xe.data(),gt=_t.get(xe.id),Et=ct.get(xe.id);!Se.customerId&&Et&&(Se.customerId=Et),!Se.customerName&&Et&&(Se.customerName=Ce[Et]||""),gt&&(Se.status="PROCESADA",!Se.closureDate&&gt.closureDate&&(Se.closureDate=gt.closureDate),!Se.processedDate&&gt.processedDate&&(Se.processedDate=gt.processedDate));const Nt=Bit(Se,xe.id);Nt&&pe.push(Nt)});const Pe=pe.sort((xe,Se)=>Se.date.localeCompare(xe.date));_(Pe);const Ee=rv(x),Ze=rv(y);E(Array.from(new Set(Pe.filter(xe=>{const Se=iW(xe);return!(!isFinite(Se)||isFinite(Ee)&&Se<Ee||isFinite(Ze)&&Se>Ze)}).map(xe=>{var Se,gt,Et,Nt;return((Se=xe._raw)==null?void 0:Se.productName)||((Nt=(Et=(gt=xe._raw)==null?void 0:gt.items)==null?void 0:Et[0])==null?void 0:Nt.productName)||"(sin producto)"}))).sort()),D(1)}catch(be){console.error(be),O(" Error cargando transacciones.")}finally{T(!1)}})()},[x,y,z]);const ee=g.useMemo(()=>{const be=rv(x),Ce=rv(y);return I.filter(Le=>{const Ae=iW(Le);return!(!isFinite(Ae)||isFinite(be)&&Ae<be||isFinite(Ce)&&Ae>Ce)})},[I,x,y]),ve=g.useMemo(()=>ee.filter(be=>{var Ce,Le,Ae,We;if(de&&be.customerId!==de||me&&be.type!==me)return!1;if(ke&&ke!=="ALL"){const ct=((Ce=be._raw)==null?void 0:Ce.productName)||((We=(Ae=(Le=be._raw)==null?void 0:Le.items)==null?void 0:Ae[0])==null?void 0:We.productName)||"";if(!ct||ct!==ke)return!1}return!(F&&DB(be._raw)!==F)}),[ee,de,me,ke,F]),M=g.useMemo(()=>{let be=0,Ce=0,Le=0,Ae=0;for(const _t of ve){const pe=Pit(_t._raw);_t.type==="CONTADO"?(be+=pe,Le+=_t.total):(Ce+=pe,Ae+=_t.total)}const We=be+Ce,ct=Le+Ae;return{packsCash:be,packsCredito:Ce,packsTotal:We,montoCash:Le,montoCredito:Ae,montoTotal:ct}},[ve]),Ye=g.useMemo(()=>{let be=0,Ce=0;for(const Ae of ve)Ae.type==="CONTADO"?be+=Ae.quantity:Ce+=Ae.quantity;const Le=be+Ce;return{unidadesCash:be,unidadesCredito:Ce,unidadesTotal:Le}},[ve]),ae=Math.max(1,Math.ceil(ve.length/W)),X=g.useMemo(()=>{const be=(Y-1)*W;return ve.slice(be,be+W)},[ve,Y]),[De,le]=g.useState(!1),[$e,Xe]=g.useState(!1),[it,xt]=g.useState(!1),jt=g.useMemo(()=>{const be=new Map;return X.forEach(Ce=>{var We,ct,_t,pe;const Le=((We=Ce._raw)==null?void 0:We.productName)||((pe=(_t=(ct=Ce._raw)==null?void 0:ct.items)==null?void 0:_t[0])==null?void 0:pe.productName)||"(sin producto)";be.has(Le)||be.set(Le,{cash:[],credit:[]});const Ae=be.get(Le);Ce.type==="CONTADO"?Ae.cash.push(Ce):Ae.credit.push(Ce)}),Array.from(be.entries()).sort((Ce,Le)=>Ce[0].localeCompare(Le[0]))},[X]);g.useMemo(()=>f&&I.find(be=>be.id===f)||null,[f,I]);const Mt=async be=>{if(s&&(L(null),!!window.confirm("Eliminar esta venta? Se restaurar el inventario asociado.")))try{T(!0),await Qre(be.id),await Tit(be.id),_(Ce=>Ce.filter(Le=>Le.id!==be.id)),O(" Venta eliminada")}catch(Ce){console.error(Ce),O(" No se pudo eliminar la venta.")}finally{T(!1)}},Ft=()=>{const be=`Ventas del dia  ${x} a ${y}`,Ce=ct=>(ct||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Le=ve.map(ct=>{var pe,Pe,Ee,Ze;const _t=OB(ct,Q);return(pe=ct._raw)!=null&&pe.productName||(Ze=(Ee=(Pe=ct._raw)==null?void 0:Pe.items)==null?void 0:Ee[0])!=null&&Ze.productName,`<tr>
          <td>${ct.date}</td>
          <td>${Ce(_t)}</td>
          <td>${ct.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${ct.quantity}</td>
          <td style="text-align:right">${ld(ct.total)}</td>
        </tr>`}).join(""),Ae=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Ce(be)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Ce(be)}</h1>
      <div class="kpis">

      
        <div><b>Unidades Cash:</b> ${w0(Ye.unidadesCash)}</div>
        <div><b>Unidades Crdito:</b> ${w0(Ye.unidadesCredito)}</div>
        <div><b>Total Unidades:</b> ${w0(Ye.unidadesTotal)}</div>
      </div>

      <div class="kpis">
        <div><b>Libras Cash:</b> ${M.packsCash}</div>
        <div><b>Libras Crdito:</b> ${M.packsCredito}</div>
        <div><b>Ventas Cash:</b> ${ld(M.montoCash)}</div>
        <div><b>Ventas Crdito:</b> ${ld(M.montoCredito)}</div>
      </div>

      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Libras</th><th>Ventas</th>
      </tr></thead><tbody>
      ${Le||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,We=window.open("","_blank");We&&(We.document.open(),We.document.write(Ae),We.document.close())},$t=()=>D(1),kt=()=>D(be=>Math.max(1,be-1)),Ge=()=>D(be=>Math.min(ae,be+1)),ie=()=>D(ae),Ue=()=>{const be=[];if(ae<=7)for(let Le=1;Le<=ae;Le++)be.push(Le);else{const Le=Math.max(1,Y-2),Ae=Math.min(ae,Y+2);be.push(1),Le>2&&be.push(-1);for(let We=Le;We<=Ae;We++)We!==1&&We!==ae&&be.push(We);Ae<ae-1&&be.push(-2),be.push(ae)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:$t,disabled:Y===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:kt,disabled:Y===1,children:" Anterior"}),be.map((Le,Ae)=>typeof Le=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${Le===Y?"bg-blue-600 text-white":""}`,onClick:()=>D(Le),children:Le},Ae):i.jsx("span",{className:"px-2",children:""},Ae)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ge,disabled:Y===ae,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ie,disabled:Y===ae,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Y," de ",ae,"  ",ve.length," transaccin(es)"]})]})},Ne=be=>{var We,ct,_t,pe;const Ce=OB(be,Q),Le=((We=be._raw)==null?void 0:We.productName)||((pe=(_t=(ct=be._raw)==null?void 0:ct.items)==null?void 0:_t[0])==null?void 0:pe.productName)||"(sin producto)",Ae=DB(be._raw);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Ce}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:be.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:`px-2 py-1 rounded-full border ${Ae==="PROCESADA"?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700"}`,children:Ae}),i.jsx("span",{className:`px-2 py-1 rounded-full border ${be.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:be.type==="CREDITO"?"Crdito":"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Libras:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:Pe=>{Pe.preventDefault(),p(be.id)},title:"Ver detalle",children:w0(be.quantity)})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",ld(be.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Ce})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Producto"}),i.jsx("span",{className:"font-medium text-right",children:Le})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:be.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Estado"}),i.jsx("span",{className:"font-medium",children:Ae})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:be.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Libras"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(be.id),title:"Ver detalle",children:w0(be.quantity)})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:ld(be.total)})]}),i.jsx("div",{className:"flex items-center justify-between",children:s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2 w-full",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>L(Pe=>Pe===be.id?null:be.id),children:" Acciones"}),K===be.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Mt(be),children:"Eliminar"})]})})]})})]})},be.id)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>le(be=>!be),"aria-expanded":De,children:[i.jsx("span",{children:"Filtros de bsqueda"}),i.jsx("span",{className:`transition-transform ${De?"rotate-180":""}`,children:""})]}),De&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-7 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:be=>{v(be.target.value),D(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:be=>{b(be.target.value),D(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:de,onChange:be=>{ue(be.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(be=>i.jsx("option",{value:be.id,children:be.name},be.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:me,onChange:be=>{se(be.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ke,onChange:be=>{Re(be.target.value),D(1)},children:[i.jsx("option",{value:"ALL",children:"Todos"}),S.map(be=>i.jsx("option",{value:be,children:be},be))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:F,onChange:be=>{H(be.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"FLOTANTE",children:"FLOTANTE"}),i.jsx("option",{value:"PROCESADA",children:"PROCESADA"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Ft,children:"Exportar PDF"}),i.jsx("div",{className:"sm:col-span-2 lg:col-span-1 flex",children:i.jsx(Oc,{onClick:ce,loading:B,className:"w-full justify-center"})})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Xe(be=>!be),"aria-expanded":$e,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${$e?"rotate-180":""}`,children:""})]}),$e&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:w0(M.packsCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:w0(M.packsCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ld(M.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:ld(M.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Total"}),i.jsx("div",{className:"text-xl font-semibold",children:ld(M.montoTotal)})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>xt(be=>!be),"aria-expanded":it,children:[i.jsx("span",{children:"Transacciones"}),i.jsx("span",{className:`transition-transform ${it?"rotate-180":""}`,children:""})]}),it&&i.jsxs("div",{className:"p-3 border-t space-y-4",children:[i.jsxs("div",{className:"block md:hidden space-y-3",children:[B?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):X.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):jt.map(([be,Ce])=>i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"font-semibold",children:["Categora: ",be]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ce.cash.length+Ce.credit.length," transaccin(es)"]})]}),i.jsxs("div",{className:"p-3 pt-0 space-y-3",children:[i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Cash"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ce.cash.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:Ce.cash.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):Ce.cash.map(Ne)})]})}),i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Crdito"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ce.credit.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:Ce.credit.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):Ce.credit.map(Ne)})]})})]})]})},be)),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:Ue()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):X.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):X.map(be=>{var We,ct,_t,pe;const Ce=OB(be,Q),Le=((We=be._raw)==null?void 0:We.productName)||((pe=(_t=(ct=be._raw)==null?void 0:ct.items)==null?void 0:_t[0])==null?void 0:pe.productName)||"(sin producto)",Ae=DB(be._raw);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be.date}),i.jsx("td",{className:"p-2 border",children:Ae}),i.jsx("td",{className:"p-2 border",children:Ce}),i.jsx("td",{className:"p-2 border",children:Le}),i.jsx("td",{className:"p-2 border",children:be.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(be.id),children:w0(be.quantity)})}),i.jsx("td",{className:"p-2 border",children:ld(be.total)}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>L(Pe=>Pe===be.id?null:be.id),title:"Acciones",children:""}),K===be.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Mt(be),children:"Eliminar"})})]})]},be.id)})})]}),Ue()]})]})]}),P&&i.jsx("p",{className:"mt-2 text-sm",children:P}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{children:i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," ",f?` #${f}`:""]})}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Libras"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((be,Ce)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:be.productName}),i.jsx("td",{className:"p-2 border text-right",children:be.qty}),i.jsx("td",{className:"p-2 border text-right",children:ld(be.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:ld(be.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:ld(be.total)})]},Ce))})]})})]})})]})}function Fit(){const[t,e]=g.useState(!1);return g.useEffect(()=>{var a;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(a=r.addEventListener)==null||a.call(r,"change",n),()=>{var s;return(s=r.removeEventListener)==null?void 0:s.call(r,"change",n)}},[]),t}function Oit(){const[t,e]=g.useState(null),[r,n]=g.useState(""),[a,s]=g.useState([]),[o,l]=g.useState(""),[c,u]=g.useState(!0),d=Fit(),f=g.useMemo(()=>d?i.jsx(nbe,{role:r,roles:a}):i.jsx(rbe,{role:r,roles:a}),[d,r,a]),A=(t==null?void 0:t.email)||"";if(g.useEffect(()=>{const m=xj(Ec,async p=>{if(u(!0),p){e(p);try{const x=Zt(Ie,"users",p.uid),v=await zs(x);if(v.exists()){const y=v.data(),b=Array.isArray(y.roles)?y.roles:y.role?[y.role]:[],w=y.sellerCandyId||"";s(b),n(b[0]||""),l(w||"")}else n(""),s([]),l("")}catch{n(""),l("")}}else e(null),n(""),l("");u(!1)});return()=>m()},[]),c)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const h=()=>{const m=a&&a.length?a:r;return En(m,"admin")?i.jsx(Dh,{to:"financialDashboard",replace:!0}):En(m,"vendedor_pollo")?i.jsx(Dh,{to:"salesV2",replace:!0}):En(m,"supervisor_pollo")?i.jsx(Dh,{to:"batches",replace:!0}):En(m,"contador")?i.jsx(Dh,{to:"batches",replace:!0}):En(m,"vendedor_ropa")?i.jsx(Dh,{to:"salesClothes",replace:!0}):En(m,"vendedor_dulces")?i.jsx(Dh,{to:"salesCandies",replace:!0}):i.jsx(Dh,{to:"/",replace:!0})};return i.jsx(O0e,{children:i.jsxs(f0e,{children:[i.jsx(Un,{path:"/",element:i.jsx(Jye,{})}),i.jsxs(Un,{path:"/admin",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"],children:f}),children:[i.jsx(Un,{index:!0,element:i.jsx(h,{})}),i.jsx(Un,{path:"bills",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(jPe,{role:r,roles:a})})}),i.jsx(Un,{path:"salesV2",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(XV,{user:t})})}),i.jsx(Un,{path:"financialDashboard",element:i.jsx(qn,{allowedRoles:["admin","contador","supervisor_pollo"],children:i.jsx(S3e,{})})}),i.jsx(Un,{path:"expenses",element:i.jsx(qn,{allowedRoles:["admin","contador"],children:i.jsx(I3e,{})})}),i.jsx(Un,{path:"polloCashAudits",element:i.jsx(qn,{allowedRoles:["admin","contador"],children:i.jsx($8e,{})})}),i.jsx(Un,{path:"transactionsPollo",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(kit,{role:r,roles:a})})}),i.jsx(Un,{path:"batches",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(C3e,{role:r,roles:a})})}),i.jsx(Un,{path:"paidBatches",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(O3e,{})})}),i.jsx(Un,{path:"fix",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(B3e,{})})}),i.jsx(Un,{path:"transactionclose",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(_3e,{})})}),i.jsx(Un,{path:"billhistoric",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(PPe,{})})}),i.jsx(Un,{path:"users",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(BPe,{})})}),i.jsx(Un,{path:"products",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(TPe,{})})}),i.jsx(Un,{path:"customersPollo",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(wLe,{role:r,roles:a,currentUserEmail:A,sellerPolloId:o})})}),i.jsx(Un,{path:"datacenter",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(xVe,{})})}),i.jsx(Un,{path:"productsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(xQe,{})})}),i.jsx(Un,{path:"mainordersCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(tVe,{})})}),i.jsx(Un,{path:"productsPricesCandies",element:i.jsx(qn,{roles:a,allowedRoles:["admin","vendedor_dulces"],children:i.jsx(_it,{})})}),i.jsx(Un,{path:"inventoryMainOrderCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(rVe,{})})}),i.jsx(Un,{path:"inventoryCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(_Qe,{})})}),i.jsx(Un,{path:"billingsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(fVe,{})})}),i.jsx(Un,{path:"cashDeliveries",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(bit,{})})}),i.jsx(Un,{path:"customersCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(EQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"salesCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(TQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"expensesCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(kQe,{})})}),i.jsx(Un,{path:"dashboardCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(VQe,{})})}),i.jsx(Un,{path:"transactionCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(RQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"vendorsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(HQe,{})})}),i.jsx(Un,{path:"productsVendorsCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(XQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"cierreVentasCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(sVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"reporteCierresCandies",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(AVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Un,{path:"consolidatedVendors",element:i.jsx(qn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(uVe,{})})}),i.jsx(Un,{path:"salesClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(uLe,{})})}),i.jsx(Un,{path:"notebooksInventory",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Iit,{})})}),i.jsx(Un,{path:"TransactionsReportClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(yLe,{})})}),i.jsx(Un,{path:"financialDashboardClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(hLe,{})})}),i.jsx(Un,{path:"ExpensesClothes",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(ALe,{})})}),i.jsx(Un,{path:"inventoryClothesBatches",element:i.jsx(qn,{allowedRoles:["admin"],children:i.jsx(z8e,{})})}),i.jsx(Un,{path:"productsClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(sLe,{})})}),i.jsx(Un,{path:"CustomersClothes",element:i.jsx(qn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(oLe,{})})})]}),i.jsx(Un,{path:"/salesV2",element:i.jsx(qn,{allowedRoles:["admin","vendedor_pollo","contador"],children:i.jsx(XV,{user:t})})}),i.jsx(Un,{path:"*",element:i.jsx(Dh,{to:"/"})})]})})}Yye.then(t=>{console.info("Auth persistence mode:",t)}).catch(()=>{}).finally(()=>{RB.createRoot(document.getElementById("root")).render(i.jsx(Ui.StrictMode,{children:i.jsx(Oit,{})}))});export{es as _,Rit as c,jA as g};
